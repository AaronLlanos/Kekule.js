module.exports=function(e){function t(i){if(r[i])return r[i].exports;var n=r[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,i){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=4)}([function(module,exports,__webpack_require__){"use strict";(function(global){function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function($jsRoot){function emptyFunction(){}function __$A__(e){if(!e)return[];if(e.toArray)return e.toArray();for(var t=e.length||0,r=new Array(t);t--;)r[t]=e[t];return r}var _Object$_extendSuppor,$setTimeout="undefined"==typeof window?setTimeout:window.setTimeout;"object"===("undefined"==typeof self?"undefined":_typeof(self))?$jsRoot=self:"object"===("undefined"==typeof window?"undefined":_typeof(window))&&window.document?$jsRoot=window:"object"===(void 0===global?"undefined":_typeof(global))&&($jsRoot=global);var Class={createCore:function(){function e(){this.initialize.apply(this,arguments)}var t=null,r=__$A__(arguments);if(!r[0]&&r.length>1){var i=r[1],n=i&&i.CLASS_NAME;throw"Can not create new class"+(n?" "+n:"")+" , base class not found"}if(Object.isFunction(r[0])&&(t=r.shift()),Object.extend(e,Class.Methods),e.superclass=t,e.subclasses=[],t){var a=function(){};a.prototype=t.prototype,e.prototype=new a,t.subclasses.push(e)}for(var o=0;o<r.length;o++)e.addMethods(r[o]);return e.prototype.initialize||(e.prototype.initialize=emptyFunction),e.prototype.constructor=e,e},create:function(){return Class.createCore.apply(this,arguments)},free:function(e){e.finalize&&e.finalize(),e=null}};Class.Methods={addMethods:function(e){if(!e)return this;var t=this.superclass&&this.superclass.prototype,r=Object.keys(e);Object.keys({toString:!0}).length||r.push("toString","valueOf");for(var i=function(){},n=0,a=r.length;n<a;n++){var o=r[n],s=e[o],l=Object.isFunction(s);if(t&&l&&"$super"===FunctionUtils.argumentNames(s)[0]){var d=s;s=function(e){return function(){return(t[e]||i).apply(this,arguments)}}(o).wrap(d),s.valueOf=d.valueOf.bind(d),s.toString=d.toString.bind(d)}this.prototype[o]=s}return this}},Object.extend=function(e,t,r,i){if(r||i)for(var n in t){var a=t[n];(!r||void 0!==a&&null!==a)&&(i&&""===a||(e[n]=a))}else for(var n in t)e[n]=t[n];return e},Object.extendEx=function(e,t,r){var i=r||{};for(var n in t){var a=t[n];if((!i.ignoreUnsetValue||void 0!==a&&null!==a)&&(!i.ignoreEmptyString||""!==a)){var o=e[n];if(!r.preserveExisted||!o){var s=o&&o.constructor&&o.constructor.prototype,l=a&&a.constructor&&a.constructor.prototype;o&&"object"===(void 0===o?"undefined":_typeof(o))&&s===l?Object.extendEx(o,a,r):e[n]=a}}}return e},Object._extendSupportMethods=function(e,t){return Object.extendEx(e,t,{ignoreUnsetValue:!0,preserveExisted:!0})},Object.getCascadeFieldValue=function(e,t,r){var i,n;if(n=e.length&&e.splice?e:e.split("."),!t)var t=$jsRoot||this;var a,o;if("Kekule"===n[0])for(n.shift(),a=0,o=n.length;a<o&&(i=r[n[a]]);++a)r=i;else for(a=0,o=n.length;a<o&&(i=t[n[a]]);++a)t=i;return i},Object.setCascadeFieldValue=function(e,t,r,i){var n;n=e.length&&e.splice?e:e.split(".");for(var a=r,o=0,s=n.length;o<s;++o){var l=n[o];if(o===s-1)return a[l]=t,t;var d=a[l];if(!d&&i&&(d={},a[l]=d),!d)return!1;a=d}},Object._inherit=function(e){function t(){}null===e&&(e={});var r=void 0===e?"undefined":_typeof(e);if(!DataType.isFunctionType(r)&&!DataType.isObjectType(r))throw TypeError();return t.prototype=e,new t},Object.create||(Object.create=Object._inherit),Object.copyValues=function(e,t,r){if(r){for(var i=0,n=r.length;i<n;++i){var a=r[i],o=t[a];void 0!==o&&(e[a]=o)}return e}return Object.extend(e,t)},Object._extendSupportMethods(Object,{keys:function(e){var t=[];for(var r in e)t.push(r);return t},isFunction:function(e){return"function"==typeof e},isUndefined:function(e){return void 0===e}}),Object.getOwnPropertyNames||(Object.getOwnPropertyNames=function(e){var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(r);return t});var FunctionUtils={argumentNames:function(e){var t=((e.toString().match(/^[\s\(]*function[^(]*\(([^\)]*)\)/)||[])[1]||"").replace(/\s+/g,"").split(",");return 1!=t.length||t[0]?t:[]}};Object._extendSupportMethods(Function.prototype,{argumentNames:function(){var e=this.toString().match(/^[\s\(]*function[^(]*\(([^\)]*)\)/)[1].replace(/\s+/g,"").split(",");return 1!=e.length||e[0]?e:[]},wrap:function(e){var t=this;return function(){return e.apply(this,[t.bind(this)].concat(__$A__(arguments)))}},methodize:function(){if(this._methodized)return this._methodized;var e=this;return this._methodized=function(){var t=Array.prototype.slice.call(arguments);return t.unshift(this),e.apply(null,t)}},bind:function(){if(arguments.length<2&&Object.isUndefined(arguments[0]))return this;var e=this,t=__$A__(arguments),r=t.shift();return function(){return e.apply(r,t.concat(__$A__(arguments)))}},delay:function(){var e=this,t=__$A__(arguments),r=t.shift();return $setTimeout(function(){return e.apply(e,t)},r)},defer:function(){var e=this,t=__$A__(arguments);t.shift();return $setTimeout(function(){return e.apply(e,t)},10)}}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){t||(t=0);var r=this.length;for(t<0&&(t=r+t);t<r;t++)if(this[t]===e)return t;return-1}),Array.prototype.lastIndexOf||(Array.prototype.lastIndexOf=function(e,t){t=isNaN(t)?this.length:(t<0?this.length+t:t)+1;var r=this.slice(0,t).reverse().indexOf(e);return r<0?r:t-r-1}),Object._extendSupportMethods(String.prototype,(_Object$_extendSuppor={toArray:function(){return this.split("")},camelize:function(){var e=this.split("-"),t=e.length;if(1==t)return e[0];for(var r="-"==this.charAt(0)?e[0].charAt(0).toUpperCase()+e[0].substring(1):e[0],i=1;i<t;i++)r+=e[i].charAt(0).toUpperCase()+e[i].substring(1);return r},capitalizeFirst:function(){return this.charAt(0).toUpperCase()+this.substring(1)},underscore:function(){return this.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/-/g,"_").toLowerCase()},dasherize:function(){return this.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1-$2").replace(/([a-z\d])([A-Z])/g,"$1-$2").replace(/-/g,"-").toLowerCase()},inspect:function(e){var t=this.gsub(/[\x00-\x1f\\]/,function(e){var t=String.specialChar[e[0]];return t||"\\u00"+e[0].charCodeAt().toPaddedString(2,16)});return e?'"'+t.replace(/"/g,'\\"')+'"':"'"+t.replace(/'/g,"\\'")+"'"},toJSON:function(){return this.inspect(!0)},unfilterJSON:function(e){return this.sub(e||Prototype.JSONFilter,"#{1}")},isJSON:function(){var e=this;return!e.blank()&&(e=this.replace(/\\./g,"@").replace(/"[^"\\\n\r]*"/g,""),/^[,:{}\[\]0-9.\-+Eaeflnr-u \n\r\t]*$/.test(e))},evalJSON:function evalJSON(sanitize){var json=this.unfilterJSON();try{if(!sanitize||json.isJSON())return eval("("+json+")")}catch(e){}throw new SyntaxError("Badly formed JSON string: "+this.inspect())},include:function(e){return this.indexOf(e)>-1},startsWith:function(e){return 0===this.indexOf(e)},endsWith:function(e){var t=this.length-e.length;return t>=0&&this.lastIndexOf(e)===t},empty:function(){return""==this}},_defineProperty(_Object$_extendSuppor,"startsWith",function(e){return 0===this.indexOf(e)}),_defineProperty(_Object$_extendSuppor,"endsWith",function(e){var t=this.length-e.length;return t>=0&&this.lastIndexOf(e)===t}),_Object$_extendSuppor)),Object._extendSupportMethods(String.prototype,{upperFirst:function(){return this.charAt(0).toUpperCase()+this.substring(1)},format:function(){for(var e=this,t=0;t<arguments.length;t++){var r=new RegExp("\\{"+t+"\\}","gi");e=e.replace(r,arguments[t])}return e},trim:function(){return this.replace(/^\s*|\s*$/g,"")},ltrim:function(){return this.replace(/^\s+/,"")},rtrim:function(){return this.replace(/\s+$/,"")},trimLeft:function(){return this.ltrim()},trimRight:function(){return this.rtrim()},pad:function(e,t,r){for(var i=t||" ",n=[],a=0,o=e-this.length;a<o;++a)n.push(i);var s=this;return r?s+n.join(""):n.join("")+s},lpad:function(e,t){return this.pad(e,t,!1)},rpad:function(e,t){return this.pad(e,t,!0)},reverse:function(){for(var e=this.length,t=[],r=e-1;r>=0;--r)t.push(this.charAt(r));return t.join("")},toCharArray:function(){for(var e=[],t=0,r=this.length;t<r;++t)e.push(this.charAt(t));return e},hyphenize:function(e){e||(e="-");for(var t=this.length,r=[],i=0;i<t;++i){var n=this.charAt(i);0!==i&&n>="A"&&n<="Z"?r.push(e+n.toLowerCase()):r.push(n)}return r.join("")}});var StringUtils={STRUE:"$TRUE",SFALSE:"$FALSE",SUNDEFINED:"$UNDEFINED",SNULL:"$NULL",SNAN:"$NAN",SPOSITIVE:"+",SNEGATIVE:"-",SDATEPREFIX:"@",isAllDigitalChar:function(e){for(var t=0,r=e.length;t<r;++t){var i=e.charAt(t);if(!(i>="0"&&i<="9")&&"."!=i)return!1}return!0},isNumbericStr:function(e){var t=Number(e);return!isNaN(t)},serializeValue:function(e,t){var r=t||[],i=DataType.getType(e);if(r.indexOf(i)>=0)return e.toString();if(null===e)return StringUtils.SNULL;if(void 0===e)return StringUtils.SUNDEFINED;if(e!=e)return StringUtils.SNAN;switch(i){case"boolean":return e?StringUtils.STRUE:StringUtils.SFALSE;case"number":case DataType.INT:case DataType.FLOAT:return(e>=0?StringUtils.SPOSITIVE:"")+e;case DataType.DATE:return StringUtils.SDATEPREFIX+e.toString();default:return e.toString()}},deserializeValue:function(e,t){if("string"!=typeof e)return e;switch(e){case StringUtils.STRUE:return!0;case StringUtils.SFALSE:return!1;case StringUtils.SNULL:return null;case StringUtils.SUNDEFINED:return;case StringUtils.SNAN:return NaN;default:if(t)switch(t){case DataType.FLOAT:return parseFloat(e);case DataType.INT:return parseInt(e);case"number":return parseFloat(e);case"boolean":return!!e;default:return e}else{switch(e.charAt(0)){case StringUtils.SPOSITIVE:case StringUtils.SNEGATIVE:var r=e.substring(1);return StringUtils.isNumbericStr(r)?parseFloat(e):e;case StringUtils.SDATEPREFIX:var r=e.substr(1);try{var i=new Date(r);return isNaN(i.getTime())?e:i}catch(t){return e}default:return e}}}}};Object.extend(Date.prototype,{copyFrom:function(e){this.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),this.setTime(e.getTime())}}),Math.sqr||(Math.sqr=function(e){return e*e}),Math.sign||(Math.sign=function(e){return e>0?1:e<0?-1:0}),$jsRoot=$jsRoot||"undefined"==typeof window?this||global:window,$jsRoot.Node||($jsRoot.Node={}),$jsRoot.Node.ELEMENT_NODE||Object.extend($jsRoot.Node,{ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12}),Class.PropertyScope={DEFAULT:3,PUBLISHED:3,PUBLIC:2,PRIVATE:1},Class.PropList=function(){this.props=[]},Class.PropList.prototype={addProperty:function(e,t){t||(t={});var r;return r=this.getPropInfo(e),r||(r={},this.props.push(r)),r=Object.extend(r,t),void 0===r.serializable&&(r.serializable=!0),r.name=e,r},removeProperty:function(e){var t=this.indexOf(e);t>=0&&this.props.splice(t,1)},removePropAt:function(e){if(e>=0){this.props[e]&&this.props.splice(e,1)}},getLength:function(){return this.props.length},indexOf:function(e){for(var t=0,r=this.props.length;t<r;++t)if(this.props[t].name===e)return t;return-1},getPropInfoAt:function(e){return e>=0?this.props[e]:null},getPropInfo:function(e){var t=this.indexOf(e);return this.getPropInfoAt(t)},hasProperty:function(e){return this.indexOf(e)>=0},clear:function(){this.props.clear()},clone:function(){var e=new Class.PropList;return e.props=this.props.slice(),e},appendList:function(e){for(var t=0,r=e.props.length;t<r;++t)this.props.push(e.props[t])}},Class.PropList.prototype.constructor=Class.PropList,Class.EventHandlerList=function(){this.handlers=[],this._$flag_="KekuleEventList"},Class.EventHandlerList.prototype={add:function(e,t){t||(t=null),this.handlers.push({thisArg:t,handler:e})},remove:function(e,t){var r=this.indexesOf(e,t);if(r.length>0)for(var i=r.length-1;i>=0;--i)this.removeAt(r[i])},removeAt:function(e){for(var t=e,r=this.handlers.length;t<r;++t)this.handlers[t]=this.handlers[t+1];this.handlers.length=this.handlers.length-1},clear:function(){this.handlers=[]},getHandlerInfo:function(e){return this.handlers[e]},indexOf:function(e,t){for(var r=0,i=this.handlers.length;r<i;++r)if(this.handlers[r].handler==e){if(void 0!==t&&this.handlers[r].thisArg===t)return r;if(void 0===t)return r}return-1},indexesOf:function(e,t){for(var r=[],i=0,n=this.handlers.length;i<n;++i)this.handlers[i].handler==e&&(void 0!==t&&this.handlers[i].thisArg===t?r.push(i):void 0===t&&r.push(i));return r},getLength:function(){return this.handlers.length}},Class.EventHandlerList.constructor=Class.EventHandlerList;var DataType={UNKNOWN:null,VARIANT:null,PRIMARY:"primary",UNDEFINED:"undefined",BOOL:"boolean",BOOLEAN:"boolean",NUMBER:"number",INT:"int",INTEGER:"int",FLOAT:"float",STRING:"string",ARRAY:"array",FUNCTION:"function",DATE:"date",HASH:"object",OBJECT:"object",OBJECTEX:"objectex",CLASS:"class",isSimpleType:function(e){return e==DataType.STRING||e==DataType.NUMBER||e==DataType.INT||e==DataType.FLOAT||e==DataType.BOOL||e==DataType.UNDEFINED||e==DataType.PRIMARY},isComplexType:function(e){return!(DataType.isSimpleType(e)||DataType.isFunctionType(e))},isFunctionType:function(e){return e==DataType.FUNCTION},isObjectType:function(e){return e==DataType.OBJECT},isDateType:function(e){return e==DataType.DATE},isObjectExType:function(e){var t=DataType.isComplexType(e)&&!DataType.isObjectType(e)&&!DataType.isDateType(e);if(t){var r=ClassEx.findClass(e);t=r&&ClassEx.isOrIsDescendantOf(r,ObjectEx)}return t},getType:function(e){var t=void 0===e?"undefined":_typeof(e);switch(t){case"undefined":return DataType.UNDEFINED;case"function":return DataType.FUNCTION;case"boolean":return DataType.BOOL;case"string":return DataType.STRING;case"number":return Math.floor(e)==e?DataType.INT:DataType.FLOAT;case"object":return this.isDateValue(e)?DataType.DATE:DataType.isArrayValue(e)?DataType.ARRAY:ClassEx.isClass(e)?DataType.CLASS:DataType.isObjectExValue(e)&&e.getClassName?e.getClassName():DataType.OBJECT;default:return t}},isSimpleValue:function(e){return DataType.isSimpleType(void 0===e?"undefined":_typeof(e))},isUndefinedValue:function(e){return void 0===e},isNullValue:function(e){return null===e},isFunctionValue:function(e){return"function"==typeof e},isObjectValue:function(e){return!!e&&("object"==(void 0===e?"undefined":_typeof(e))&&!DataType.isArrayValue(e)&&!DataType.isDateValue(e))},isDateValue:function(e){return!!e&&("object"==(void 0===e?"undefined":_typeof(e))&&void 0!==e.getFullYear)},isArrayValue:function(e){return!!e&&("object"==(void 0===e?"undefined":_typeof(e))&&void 0!==e.length)},isObjectExValue:function(e){return e instanceof ObjectEx},createInstance:function(e,t){switch(e){case DataType.UNDEFINED:return;case DataType.DATE:return new Date;case DataType.ARRAY:return new Array;case DataType.OBJECT:return new Object;case DataType.FUNCTION:return new Function;default:return new(ClassEx.findClass(e.capitalizeFirst(),void 0,t))}}},__definePropertyAvailable__=Object.defineProperty&&function(){try{return Object.defineProperty({},"x",{}),!0}catch(e){return!1}}(),ClassEx={isClass:function(e){return!!e&&!(!e.superclass&&!e.subclasses)},findClass:function(e,t,r){return Object.getCascadeFieldValue(e,t||$jsRoot,r)},getClassName:function(e){return e?e.prototype.CLASS_NAME:null},getClassLocalName:function(e){var t=ClassEx.getClassName(e),r=t.lastIndexOf(".");return r>=0?t.substring(r+1):t},getPrototype:function(e){return e.prototype},getSuperClass:function(e){return e.superclass||e.constructor.superclass},getSuperClassPrototype:function(e){return e.superclass?e.superclass.prototype:null},_getCommonSuperClass2:function(e,t){for(var r=e;r&&!ClassEx.isOrIsDescendantOf(t,r);)r=ClassEx.getSuperClass(r);return r},getCommonSuperClass:function(e){if(!e||!e.length)return null;var t=e[0].getClass?e[0].getClass():null;if(!t)return null;for(var r=1,i=e.length;r<i;++r){var n=e[r].getClass?e[r].getClass():null;if(!n)return null;t=ClassEx._getCommonSuperClass2(t,n)}return t},isDescendantOf:function(e,t){for(var r=ClassEx.getSuperClass(e);r&&r!==t;)r=ClassEx.getSuperClass(r);return!!r},isOrIsDescendantOf:function(e,t){return e===t||ClassEx.isDescendantOf(e,t)},isOrIsDescendantOfClasses:function(e,t){for(var r=0,i=t.length;r<i;++r)if(ClassEx.isOrIsDescendantOf(e,t[r]))return!0;return!1},_ensurePropertySystem:function(e){var t=ClassEx.getPrototype(e);if(t&&!t.hasOwnProperty("properties")){var r=ClassEx.getSuperClass(e);r&&ClassEx._ensurePropertySystem(r),ClassEx._createPropertyList(e),ClassEx._remapPropGetters(e),t.hasOwnProperty("initProperties")&&t.initProperties.apply(t)}},_createPropertyList:function(e){ClassEx.getPrototype(e).hasOwnProperty("properties")||(ClassEx.getPrototype(e).properties=new Class.PropList)},_remapPropGetters:function(e,t){for(var r=ClassEx.getPrototype(e),i=t||Object.getOwnPropertyNames(r),n=0,a=i.length;n<a;++n){var o=i[n];if(o.length>5&&o.startsWith("doGet")){var s=r[o];if("function"==typeof s){var l=o.charAt(5).toLowerCase()+o.substr(6);if(r.hasDirectProperty(l))continue;var d=ClassEx.getPropInfo(e,l);if(d&&d.getter){if(r["get"+l.capitalizeFirst()]=s,__definePropertyAvailable__){var u=Object.extend({},d.descriptor);u.get=s;try{Object.defineProperty(r,l,u)}catch(e){throw e}}}}}}},getOwnPropList:function(e){var t=ClassEx.getPrototype(e);return t?(t._initPropertySystem(),t.properties):null},getAllPropList:function(e){var t,r=ClassEx.getSuperClassPrototype(e);return r?(t=r.getAllPropList().clone(),t.appendList(ClassEx.getOwnPropList(e))):t=ClassEx.getOwnPropList(e),t},getPropListOfScopes:function(e,t){var r,i=function(e,t){var r=ClassEx.getOwnPropList(e).clone();if(r)for(var i=r.getLength()-1;i>=0;--i){var n=r.getPropInfoAt(i),a=n.scope||Class.PropertyScope.DEFAULT;t.indexOf(a)<0&&r.removePropAt(i)}return r},n=ClassEx.getSuperClass(e);return n?(r=ClassEx.getPropListOfScopes(n,t).clone(),r.appendList(i(e,t))):r=i(e,t),r},defineProp:function(e,t,r){return ClassEx._ensurePropertySystem(e),ClassEx.getPrototype(e).defineProp(t,r)},defineProps:function(e,t){ClassEx._ensurePropertySystem(e);for(var r=ClassEx.getPrototype(e),i=0,n=t.length;i<n;++i){var a=t[i],o=a.name,s=a;r.defineProp(o,s)}},getPropInfo:function(e,t,r){return ClassEx.getPrototype(e).getPropInfo(t,r)},defineEvent:function(e,t){return ClassEx.getPrototype(e).defineEvent(t)},getUnusedMethodName:function(e,t,r){for(var i=r||0,n=i,a=ClassEx.getPrototype(e),o=t+Number(n).toString();a[o];)++n,o=t+Number(n).toString();return o},extendMethod:function(e,t,r){var i=ClassEx.getPrototype(e),n=i[t],a=ClassEx.getUnusedMethodName(e,"__$changed$_"+t+"__");i[a]=n;var o=function(e){return function(){return i[e].apply(this,arguments)}}(a).wrap(r);i[t]=o,o.valueOf=r.valueOf.bind(r),o.toString=r.toString.bind(r)},extend:function(e,t){var r=ClassEx.getPrototype(e),i=ClassEx.getSuperClassPrototype(e),n=Object.keys(t);Object.keys({toString:!0}).length||n.push("toString","valueOf");for(var a=0,o=n.length;a<o;a++){var s=n[a],l=t[s];if("function"==typeof l){var d=FunctionUtils.argumentNames(l),u=d[0];if("$origin"==u){var c=l,h=r[s],m=ClassEx.getUnusedMethodName(e,"__$changed$_"+s+"__");r[m]=h,l=function(e){return function(){return r[e].apply(this,arguments)}}(m).wrap(c),l.valueOf=c.valueOf.bind(c),l.toString=c.toString.bind(c),d.shift(),u=d.first()}if("$super"==u){var c=l;l=function(e){return function(){return i[e].apply(this,arguments)}}(s).wrap(c),l.valueOf=c.valueOf.bind(c),l.toString=c.toString.bind(c)}}r[s]=l}return ClassEx._remapPropGetters(e,n),e}},ObjectEx=Class.create({CLASS_NAME:"ObjectEx",EVENT_HANDLERS_FIELD:"__$__k__eventhandlers__$__",initialize:function(){this._initPropertySystem(),this.initPropValues(),this._updateStatus=0,this._childChangeEventSuppressed=!1,this._modifiedProps=[],this._finalized=!1,this.afterInitialization()},afterInitialization:function(){},finalize:function(){this._finalized||(this.doFinalize(),this.invokeEvent("finalize",{obj:this}),this[this.EVENT_HANDLERS_FIELD]=null,this._finalized=!0)},doFinalize:function(){},initProperties:function(){this.defineProp("enablePropValueGetEvent",{dataType:DataType.BOOL,serializable:!1,scope:Class.PropertyScope.PUBLIC}),this.defineProp("enablePropValueSetEvent",{dataType:DataType.BOOL,serializable:!1,scope:Class.PropertyScope.PUBLIC}),this.defineProp("enableObjectChangeEvent",{dataType:DataType.BOOL,serializable:!1,scope:Class.PropertyScope.PUBLIC}),this.defineProp("bubbleEvent",{dataType:DataType.BOOL,serializable:!1,scope:Class.PropertyScope.PUBLIC}),this.defineProp("suppressChildChangeEventInUpdating",{dataType:DataType.BOOL,serializable:!1,scope:Class.PropertyScope.PUBLIC}),this.defineProp("eventHandlers",{dataType:DataType.HASH,serializable:!1,scope:Class.PropertyScope.PRIVATE,setter:null,getter:function(){var e=this[this.EVENT_HANDLERS_FIELD];return e||(e={},this[this.EVENT_HANDLERS_FIELD]=e),e}})},initPropValues:function(){},getHigherLevelObj:function(){return null},saved:function(){},loaded:function(){},_initPropertySystem:function(){ClassEx._ensurePropertySystem(this.getClass())},_createPropertyList:function(){ClassEx._createPropertyList(this.getClass())},_remapPropGetters:function(){ClassEx._remapPropGetters(this.getClass())},getClass:function(){return this.constructor},getSuperClass:function(){return this.getClass().superclass},getClassName:function(){return this.getPrototype().CLASS_NAME},getClassLocalName:function(){return ClassEx.getClassLocalName(this.getClass())},getSerializationName:function(){return this.getClassName()},getPrototype:function(){return this.prototype?this.prototype:this.constructor.prototype},getSuperClassPrototype:function(){return this.constructor&&this.constructor.superclass?this.constructor.superclass.prototype:null},__changeClass__:function(e){var t=ClassEx.getPrototype(e);return this.prototype=t,this.__proto__=t,this.constructor=e,this.objectChange(["__proto__"]),this},getOwnPropList:function(){return this._initPropertySystem(),this.getPrototype().properties},getAllPropList:function(){var e,t=this.getSuperClassPrototype();return t?(e=t.getAllPropList().clone(),e.appendList(this.getOwnPropList())):e=this.getOwnPropList().clone(),e},getPropListOfScopes:function(e){return ClassEx.getPropListOfScopes(this.getClass(),e)},getPropInfoHashKey:function(e){return ObjectEx._PROPINFO_HASHKEY_PREFIX+e},getDefPropStoreFieldName:function(e){return ObjectEx._PROP_STOREFIELD_PREFIX+e},defineProp:function(e,t){var r;r=t?Object.extend({},t):{},void 0===r.serializable&&(r.serializable=!0),r.storeField=this.getDefPropStoreFieldName(e);var i,n,a=this.getOwnPropList(),o=a.addProperty(e,r);if(null!==r.getter&&!1!==r.getter&&(i=this.createPropGetter(o,r.getter),o.getter=i.doGetterName),null!==r.setter&&!1!==r.setter&&(n=this.createPropSetter(o,r.setter),o.setter=n.doSetterName),this[this.getPropInfoHashKey(e)]=o,__definePropertyAvailable__){var s={enumerable:r.enumerable,configurable:!1};void 0===s.enumerable&&(s.enumerable=!0),i&&(s.get=this[i.getterName]),n&&(s.set=this[n.setterName]),o.descriptor=s;try{Object.defineProperty(this,e,s)}catch(e){throw e}}return o},createPropGetter:function(e,t){var r=e.name.toString().upperFirst(),i="get"+r,n="doGet"+r,a=this[n];return a||(a=t||new Function('return this["'+e.storeField+'"];'),this.getPrototype()[n]=a),this.getPrototype()[i]=a,{getterName:i,doGetterName:n}},createPropSetter:function(e,t){var r=e.name.toString(),i=r.upperFirst(),n="set"+i,a="doSet"+i,o=this[a];return this[a]||(o=t||new Function("value",'this["'+e.storeField+'"] = value;'),this.getPrototype()[a]=o),this.getPrototype()[n]=function(){var e=arguments[0];return this[a].apply(this,arguments),this.notifyPropSet(r,e),this},{setterName:n,doSetterName:a}},hasProperty:function(e){return null!=this.getPropInfo(e)},hasDirectProperty:function(e){return null!=this.getPropInfo(e,!0)},getPropInfo:function(e,t){var r,i=e||"";if(!t){r=this[this.getPropInfoHashKey(i)||""]}if(!r&&!(r=this.getOwnPropList().getPropInfo(i))&&!t){var n=this.getSuperClassPrototype();r=n&&n.getPropInfo?n.getPropInfo(i):null}return r},getPropertyDataType:function(e){var t=this.getPropInfo(e);return t?t.dataType:null},isPropertySerializable:function(e){var t=this.getPropInfo(e),r=t&&t.serializable;return void 0===r||!!r},getPropStoreFieldValue:function(e){return this[ObjectEx._PROP_STOREFIELD_PREFIX+e]},getPropValue:function(e){var t,r=this.getPropInfo(e);if(r){if(r.getter){var i=Array.prototype.slice.call(arguments);i.shift(),t=this[r.getter].apply(this,i)}else t=this[r.storeField];return t}return null},getPropValues:function(e){var t={};if(DataType.isArrayValue(e))for(var r=0,i=e.length;r<i;++r){var n=e[r];t[n]=this.getPropValue(n)}else if(DataType.isObjectValue(e))for(var n in e)e.hasOwnProperty(n)&&"function"!=typeof e[n]&&(t[n]=this.getPropValue(n));return t},setPropStoreFieldValue:function(e,t){this[ObjectEx._PROP_STOREFIELD_PREFIX+e]=t},setPropValue:function(e,t,r){var i=this.getPropInfo(e);return i&&(i.setter?this[i.setter].apply(this,[t]):r&&(this[i.storeField]=t),this.notifyPropSet(e,t)),this},setPropValueX:function(){var e=Array.prototype.slice.call(arguments),t=e.shift(),r=this.getPropInfo(t);return r&&(r.setter&&this[r.setter].apply(this,e),this.notifyPropSet(t,this.getPropValue(t))),this},setPropValues:function(e,t){for(var r in e)if(e.hasOwnProperty(r)&&this.hasProperty(r)){var i=e[r];this.setPropValue(r,i,t)}return this},_isPropGetOrSetEvent:function(e){return"propValueGet"==e||"propValueSet"==e},notifyPropSet:function(e,t,r){if(this.isUpdating())return void(this._modifiedProps.indexOf(e)<0&&this._modifiedProps.push(e));this._isPropGetOrSetEvent(e)||this.isEventPropName(e)||(this.doPropChanged(e,t),this.getPropStoreFieldValue("enablePropValueSetEvent")&&this.invokeEvent("propValueSet",{propName:e,propValue:t}),r||this.objectChange([e]))},objectChange:function(e){this.doObjectChange(e),this.getEnableObjectChangeEvent()&&this.invokeEvent("change",{changedPropNames:e})},doObjectChange:function(e){},doPropChanged:function(e,t){},defineEvent:function(e){return},eventNameToPropName:function(e){return"__event_"+e},isEventPropName:function(e){return"string"==typeof e&&e.indexOf("__event_")>=0},isEventHandlerList:function(e){return e&&"object"==(void 0===e?"undefined":_typeof(e))&&e instanceof Class.EventHandlerList},getEventHandlerList:function(e){var t=this.getEventHandlers(),r=t[e];return r||(r=new Class.EventHandlerList,t[e]=r),r},addEventListener:function(e,t,r){var i=this.getEventHandlerList(e);return this.isEventHandlerList(i)?("change"===e&&this.setEnableObjectChangeEvent(!0),i.add(t,r)):null},addOnceEventListener:function(e,t,r){var i=this,n=function n(a){i.removeEventListener(e,n,r),t(a)};return this.addEventListener(e,n,r)},removeEventListener:function(e,t,r){var i=this.getEventHandlerList(e);if(this.isEventHandlerList(i))return i.remove(t,r)},on:function(e,t,r){return this.addEventListener(e,t,r)},once:function(e,t,r){return this.addOnceEventListener(e,t,r)},off:function(e,t,r){return this.removeEventListener(e,t,r)},invokeEvent:function(e,t){t?(t.name=e,t.target=this):t={name:e,target:this},t.stopImmediatePropagation||(t.stopImmediatePropagation=this._eventStopImmediatePropagation),t.stopPropagation||(t.stopPropagation=this._eventCancelBubble),t.preventDefault||(t.preventDefault=this._eventPreventDefault),this.dispatchEvent(e,t)},_eventStopImmediatePropagation:function(){this._stopImmediatePropagation=!0,this._cancelBubble=!0},_eventCancelBubble:function(){this._cancelBubble=!0},_eventPreventDefault:function(){this._preventDefault=!0},relayEvent:function(e,t){t.currentTarget=this,"change"===e&&this.getSuppressChildChangeEventInUpdating()&&this.isUpdating()?this._childChangeEventSuppressed=!0:this.dispatchEvent(e,t)},dispatchEvent:function(e,t){for(var r=this.getEventHandlerList(e),i=0,n=r.getLength();i<n&&!t._stopImmediatePropagation;++i){var a=r.getHandlerInfo(i);a&&a.handler.apply(a.thisArg,[t])}if(!t._cancelBubble&&this.getBubbleEvent()){var o=this.getHigherLevelObj();o&&o.relayEvent&&o.relayEvent(e,t)}},stopEventPropagation:function(e){e.cancelBubble=!0},overwriteMethod:function(e,t){var r=this,i=this[e];return this[e]=function(){var e=Array.prototype.slice.call(arguments);return e.unshift(i&&i.bind(r)),t.apply(r,e)},this},assign:function(e){return e.assignTo(this)},assignTo:function(e,t){var r={};this.saveObj(r,"json"),e.loadObj(r,"json",t)},clone:function(){var e=this.getClass(),t=new e;return this.assignTo(t),t},beginUpdate:function(){++this._updateStatus},endUpdate:function(){if(--this._updateStatus,this.checkUpdateStatus(),!this.isUpdating()){var e=this._modifiedProps||[];this._modifiedProps=[],this._childChangeEventSuppressed&&(e.push("[children]"),this._childChangeEventSuppressed=!1),this.doEndUpdate(e)}},doEndUpdate:function(e){if(e.length){if(this.getPropStoreFieldValue("enablePropValueSetEvent"))for(var t=0,r=e.length;t<r;++t){var i=e[t],n=this.getPropValue(i);this.notifyPropSet(i,n,!0)}this.objectChange(e)}},isUpdating:function(){return this._updateStatus>0},isPropUpdated:function(e){return this._modifiedProps.indexOf(e)>=0},checkUpdateStatus:function(){this._updateStatus<=0&&(this._updateStatus=0)},copyPropsTo:function(e){for(var t=this.getAllPropList(),r=0,i=t.getLength();r<i;++r){var n=t.getPropInfoAt(r).name;if(e.hasProperty(n)){var a=this.getPropValue(n);e.setPropValue(n,a,!0)}}}});ObjectEx._PROPINFO_HASHKEY_PREFIX="__$propInfo__",ObjectEx._PROP_STOREFIELD_PREFIX="__$__k__p__",$jsRoot.Class=Class,$jsRoot.ClassEx=ClassEx,$jsRoot.ObjectEx=ObjectEx,$jsRoot.DataType=DataType,DataType.JsonUtility=__webpack_require__(1).JsonUtility,DataType.XmlUtility=__webpack_require__(1).XmlUtility,module.exports={Class:Class,ClassEx:ClassEx,ObjectEx:ObjectEx,DataType:DataType}}(void 0)}).call(exports,__webpack_require__(3))},function(module,exports,__webpack_require__){"use strict";var JsonUtility={DEF_LOAD_TIMEOUT:2e4,FILE_EXT_JSON:".json",FILE_EXT_JSON_JS_WRAPPER:".jsonjs",DEF_SERIALIZE_TO_JSCODE_VARNAME:"__jsonvar__",parse:function(e){return JSON.parse(e)},parseFromJsWrappedCode:function parseFromJsWrappedCode(code,jsVarName){return jsVarName||(jsVarName=JsonUtility.DEF_SERIALIZE_TO_JSCODE_VARNAME),eval(code),JsonUtility.parse(eval(jsVarName))},load:function(e,t,r){return WebShow.URL.getFileExt(e).toLowerCase()==JsonUtility.FILE_EXT_JSON_JS_WRAPPER?JsonUtility.loadJsWrapper(e,t,r):JsonUtility.loadJson(e,t,r)},loadJsWrapper:function loadJsWrapper(url,callback,options){var loptions=options||{},wrapperVarName=loptions.wrapperVarName||JsonUtility.DEF_SERIALIZE_TO_JSCODE_VARNAME;loptions.timeout||(loptions.timeout=JsonUtility.DEF_LOAD_TIMEOUT);var runCallBack=function(e,t){callback&&callback(e,t)},wrapperCallback=function wrapperCallback(src,isSuccess){var jsonObj=null;if(isSuccess){var wrapperVar=eval(wrapperVarName);wrapperVar&&(jsonObj="string"==typeof wrapperVar?JsonUtility.parse(wrapperVar):wrapperVar),runCallBack(jsonObj,!0)}else runCallBack(null,!1)};WebShow.ScriptLoader.load(url,wrapperCallback,loptions)},loadJson:function(e,t,r){var i=r||{};i.timeout||(i.timeout=JsonUtility.DEF_LOAD_TIMEOUT),i.resultType=WebShow.FileLoader.ResultType.TEXT,i.extractBody=!1;var n=function(e,r,i){if(r){var n=JsonUtility.parse(e);t(n,!0)}else t(null,!1)};(new WebShow.XHRLoader).load(e,n,i)},serializeToStr:function(e,t){return t&&t.prettyPrint?JSON.stringify(e,null,t.indentSpaces||2):JSON.stringify(e)},serializeToJsCode:function(e,t,r){r||(r="'"),t||(t=JsonUtility.DEF_SERIALIZE_TO_JSCODE_VARNAME);var i=JsonUtility.serializeToStr(e),n=new RegExp(r,"g");return i=i.replace(n,"\\"+r),"var "+t+" = "+r+i+r}},XmlUtility={DOM_PARSER:null,DOM_IMPLEMENTATION:null,XML_SERIALIZER:null,DEF_INCLUDE_TAG_NAME:"include",DEF_INCLUDE_SRC_ATTRIB:"src",DEF_LOAD_TIMEOUT:2e4,DEF_BYPASS_ROOT_ELEM:!0,DEF_SERIALIZE_TO_JSCODE_VARNAME:"__xmlStr__",FILE_EXT_XML:".xml",FILE_EXT_XML_JS_WRAPPER:".xmljs",newDocument:function(e,t){if(e||(e=""),t||(t=""),XmlUtility.DOM_IMPLEMENTATION){var r=(new XmlUtility.DOM_IMPLEMENTATION).createDocument(t,e,null);return r}if("undefined"!=typeof document){if(document.implementation&&document.implementation.createDocument){var r=document.implementation.createDocument(t,e,null);return r}if("undefined"!=typeof ActiveXObject){var r=new ActiveXObject("MSXML2.DOMDocument");if(e){var i="",n=e,a=e.indexOf(":");-1!=a&&(i=e.substring(0,a),n=e.substring(a+1));var o="<"+(i?i+":":"")+n+(t?(i?" xmlns:":" xmlns")+i+'="'+t+'"':"")+"/>";r.loadXML(o)}return r}}},parse:function(e){if(XmlUtility.DOM_PARSER)return(new XmlUtility.DOM_PARSER).parseFromString(e,"application/xml");if("undefined"!=typeof document){if("undefined"!=typeof DOMParser)return(new DOMParser).parseFromString(e,"application/xml");if("undefined"!=typeof ActiveXObject){var t=XmlUtility.newDocument();return t.loadXML(e),t}var r="data:text/xml;charset=utf-8,"+encodeURIComponent(e),i=new XMLHttpRequest;return i.open("GET",r,!1),i.send(null),i.responseXML}},load:function(e,t,r){return e.lastIndexOf(XmlUtility.FILE_EXT_XML_JS_WRAPPER)===e.length-XmlUtility.FILE_EXT_XML_JS_WRAPPER.length?XmlUtility.loadHelper.loadJsWrapper(e,t,r):(r||(r={disableInclude:!1}),r.disableInclude?XmlUtility.loadHelper.loadSimple(e,t,r.timeout):XmlUtility.loadHelper.loadAndHandleIncludeElement(e,t,r))},loadHelper:{loadSimple:function(e,t,r){var i=null!=t;if(null!==r&&void 0!==r||(r=XmlUtility.DEF_LOAD_TIMEOUT),document.implementation&&document.implementation.createDocument){var n=new XMLHttpRequest,a=null;r&&(a=setTimeout(function(){o(null,!1)},r));var o=function(e,r){a&&clearTimeout(a),t&&t(e,r)};i&&(n.onreadystatechange=function(){if(4==n.readyState){var e=n.responseXML;e&&e.documentElement?o(e,!0):o(null,!1)}});try{n.open("get",e,i),n.send(null)}catch(e){WebShow.reportError(e),o(null,!1)}var s=n.responseXML;return s&&s.documentElement?s:null}return XmlUtility.loadHelper.loadSimpleViaDoc(e,t)},loadSimpleViaDoc:function(e,t){var r=null!=t,i=XmlUtility.newDocument("dummy_dummy_dummy_dummy");return i.async=r,r&&(i.onreadystatechange=function(){4==i.readyState&&(i.documentElement&&"dummy_dummy_dummy_dummy"!=i.documentElement.tag?t(i,!0):t(i,!1))}),i.load(e),i},loadAndHandleIncludeElement:function(e,t,r){var i;if(i=r?r.timeout:null,null==t){var n=XmlUtility.loadHelper.loadSimple(e,null,i);return n&&n.documentElement?(XmlUtility.loadHelper.handleIncludedXmlInElement(n.documentElement,null,r),n):null}return XmlUtility.loadHelper.loadSimple(e,function(e,i){i?XmlUtility.loadHelper.handleIncludedXmlInElement(e.documentElement,function(r){t(e,!0)},r):t(e,!1)},i)},loadJsWrapper:function loadJsWrapper(url,callback,options){options=options||{};var wrapperVarName=options.wrapperVarName||XmlUtility.DEF_SERIALIZE_TO_JSCODE_VARNAME,loadTimeout=options.timeout;null!==loadTimeout&&void 0!==loadTimeout||(loadTimeout=XmlUtility.DEF_LOAD_TIMEOUT);var runCallBack=function(e,t){callback&&callback(e,t)},wrapperCallback=function wrapperCallback(src,isSuccess){if(isSuccess){var xmlContent=eval(wrapperVarName),doc=XmlUtility.parse(xmlContent);runCallBack(doc,!0)}else runCallBack(null,!1)};options.timeout=loadTimeout,WebShow.ScriptLoader.load(url,wrapperCallback,options)},getIncludeElements:function(e,t){return t||(t=XmlUtility.DEF_INCLUDE_TAG_NAME),e.getElementsByTagName(t)},handleIncludedXmlInElement:function(e,t,r){r||(r={});var i=r.includeTagName||XmlUtility.DEF_INCLUDE_TAG_NAME,n=r.srcAttribName||XmlUtility.DEF_INCLUDE_SRC_ATTRIB,a=null!=r.bypassRootElem?r.bypassRootElem:XmlUtility.DEF_BYPASS_ROOT_ELEM,o=null==t,s=XmlUtility.getXmlDocUrl(e.ownerDocument),l=XmlUtility.loadHelper.getIncludeElements(e,i);if(!n)var d=null;var u=null,c=0,h=l.length;if(h<=0)return t&&t(0),null;for(var m,g=l.length-1;g>=0;--g)u=l[g],(d=u.getAttribute(n))&&(d=WebShow.URL.mergePath(d,s),o?(m=XmlUtility.loadHelper.loadSimple(d))&&XmlUtility.loadHelper.insertIncludedSection(m,u,a):XmlUtility.loadHelper.loadSimple(d,function(e,r,i){i&&r&&(m=r,XmlUtility.loadHelper.insertIncludedSection(m,e,a)),++c==h&&t(c)}.bind(this,u)));return e},insertIncludedSection:function(e,t,r){var i=[];if(r)for(var n=e.documentElement.firstChild;n;)n.nodeType==Node.ELEMENT_NODE&&i.push(n),n=n.nextSibling;else i.push(e.documentElement);for(var a,o=t.ownerDocument,s=(o.documentElement,0),l=i.length;s<l;++s){var a=i[s];o.importNode&&(a=o.importNode(a,!0)),t.parentNode.insertBefore(a,t)}return t.parentNode.removeChild(t),o}},serializeNode:function(e,t){if(t&&t.prettyPrint)return XmlUtility.serializeNodePretty(e);if(XmlUtility.XML_SERIALIZER)return(new XmlUtility.XML_SERIALIZER).serializeToString(e);if("undefined"!=typeof XMLSerializer)return(new XMLSerializer).serializeToString(e);if(e.xml)return e.xml;throw"XML.serialize is not supported or can't serialize "+e},serializeNodePretty:function(e){try{return XmlUtility.XML_SERIALIZER?(new XmlUtility.XML_SERIALIZER).serializeToString(e).toXMLString():(new XMLSerializer).serializeToString(e).toXMLString()}catch(t){return XmlUtility.serializeNode(e)}},serializeNodeToJsCode:function(e,t,r){r||(r="'"),t||(t=XmlUtility.DEF_SERIALIZE_TO_JSCODE_VARNAME);var i=XmlUtility.serializeNode(e),n=new RegExp(r,"g");return i=i.replace(n,"\\"+r),"var "+t+" = "+r+i+r+";"},parseFromJsWrappedCode:function parseFromJsWrappedCode(code,jsVarName){eval(code);var xmlText=eval(jsVarName);return XmlUtility.parse(xmlText)},getXmlDocUrl:function(e){return e.url||e.documentURI||e.URL||e.location}};module.exports={JsonUtility:JsonUtility,XmlUtility:XmlUtility}},function(e,t,r){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=r(0).Class,a=r(0).ClassEx,o=r(0).ObjectEx,s=r(0).DataType,l=n.create({CLASS_NAME:"ObjSerializer",serializeValue:function(e){return e},deserializeValue:function(e,t){return e},propNameToStorageName:function(e){return e},storageNameToPropName:function(e){return e},getObjCustomSaveMethod:function(e){return e.doSaveObj},getObjCustomLoadMethod:function(e){return e.doLoadObj},getObjCustomPropSaveMethod:function(e){return e.doSaveProp},getObjCustomPropLoadMethod:function(e){return e.doLoadProp},isUndefined:function(e){return s.isUndefinedValue(e)},isNull:function(e){return null===e},isNaN:function(e){return e!=e},isFunction:function(e){return s.isFunctionValue(e)},isArray:function(e){return s.isArrayValue(e)},isDate:function(e){return s.isDateValue(e)},isObject:function(e){return s.isObjectValue(e)},isObjectEx:function(e){return s.isObjectExValue(e)},isSimpleType:function(e){var t=void 0===e?"undefined":i(e);return"string"==t||"number"==t||"boolean"==t||"undefined"==t||this.isNull(e)},isComplexType:function(e){return!this.isSimpleType(e)},createChildStorageNode:function(e,t,r){},appendArrayItemStorageNode:function(e,t,r){},getNameForArrayItemStorageNode:function(e){return this.getDefaultArrayItemStorageName()},getChildStorageNode:function(e,t){},getAllArrayItemStorageNodes:function(e){},getAllStoredStorageNames:function(e){},setStorageNodeExplicitType:function(e,t){},getStorageNodeExplicitType:function(e){},getStorageNodeName:function(e){},isComplexStorageNode:function(e){},isComplexArrayItemStorageNode:function(e){},isSimpleStorageNode:function(e){},getValueExplicitType:function(e){return e instanceof o?e.getClassName():this.isObject(e)?s.OBJECT:this.isArray(e)?s.ARRAY:this.isDate(e)?s.DATE:void 0===e?"undefined":i(e)},getDefaultArrayItemStorageName:function(){return"item"},getDefaultDateStorageName:function(){return"date"},save:function(e,t,r){if("object"==(void 0===e?"undefined":i(e))){var n=this.getObjCustomSaveMethod(e);if(n)return n(e,t,this)}var a=this.doSave(e,t,r||{});return a&&this.isFunction(e.saved)&&e.saved(),a},doSave:function(e,t,r){return"object"==(void 0===e?"undefined":i(e))&&(e instanceof o?this.doSaveObjectEx(e,t,r):this.isArray(e)?this.doSaveArray(e,t):this.isDate(e)?this.doSaveDate(e,t):this.doSaveSimpleObject(e,t)),this.setStorageNodeExplicitType(t,this.getValueExplicitType(e)),e},doSaveSimpleObject:function(e,t){for(var r in e)if(e.hasOwnProperty(r)){var i,n=e[r];this.isComplexType(n)&&(i=this.getValueExplicitType(n)),this.doSaveFieldValue(e,r,n,t,i)}},doSaveArray:function(e,t){for(var r=0,n=e.length;r<n;++r){var a=e[r],o=this.getNameForArrayItemStorageNode(a);if(this.isComplexType(a)){var s=this.appendArrayItemStorageNode(t,this.propNameToStorageName(o),this.isArray(a));this.setStorageNodeExplicitType(s,this.getValueExplicitType(a)),this.save(a,s)}else this.doAppendArrayItemSimpleValue(this.serializeValue(a),void 0===a?"undefined":i(a),t)}},doSaveDate:function(e,t){var r=e.toUTCString();this.doSaveSimpleValue(e,this.propNameToStorageName(this.getDefaultDateStorageName()),this.serializeValue(r),s.DATE,t)},doSaveObjectEx:function(e,t,r){for(var i=e.getAllPropList(),n=r.propFilter,a=0,o=i.getLength();a<o;++a){var s=i.getPropInfoAt(a);if(!n||n(s,e)){var l=this.getObjCustomPropSaveMethod(e),d=!1;if(l&&(d=l(e,s,t,this)),!d&&s.serializable){("function"==typeof s.serializable?s.serializable.apply(e):s.serializable)&&this.doSaveObjectExProp(e,s,t,r)}}}},doSaveObjectExProp:function(e,t,r,i){var n=t.name,a=t.dataType,s=e.getPropValue(n);if(i.saveDefaultValues||s!==t.defaultValue){var l;s instanceof o?s.getClassName()!=a&&(l=s.getClassName()):this.isComplexType(s)&&(l=this.getValueExplicitType(s))==a&&(l=void 0),this.doSaveFieldValue(e,n,s,r,l)}},doSaveFieldValue:function(e,t,r,i,n){if("function"!=typeof r)if(this.isComplexType(r)){var a=this.createChildStorageNode(i,this.propNameToStorageName(t),this.isArray(r));n&&this.setStorageNodeExplicitType(a,n),this.save(r,a)}else this.doSaveSimpleValue(e,this.propNameToStorageName(t),this.serializeValue(r),this.getValueExplicitType(r),i)},doSaveSimpleValue:function(e,t,r,i,n){},doAppendArrayItemSimpleValue:function(e,t,r){},load:function(e,t,r){if(!e){var n=this.getStorageNodeExplicitType(t);if(!n)return this.doLoadUntypedNode?this.doLoadUntypedNode(t):null;e=s.createInstance(n,r)}if("object"===(void 0===e?"undefined":i(e))){var a=this.getObjCustomLoadMethod(e);if(a)return a(e,t,this)}var o=this.doLoad(e,t,r);return o&&this.isFunction(e.loaded)&&e.loaded(),o},doLoad:function(e,t,r){this.getStorageNodeExplicitType(t);if("object"==(void 0===e?"undefined":i(e)))if(e instanceof o){e.beginUpdate();try{e=this.doLoadObjectEx(e,t,r)}finally{e.endUpdate()}}else e=this.isArray(e)?this.doLoadArray(e,t,r):this.isDate(e)?this.doLoadDate(e,t):this.doLoadSimpleObject(e,t);return e},doLoadArray:function(e,t,r){for(var i=this.getAllArrayItemStorageNodes(t),n=0,a=i.length;n<a;++n){var o=i[n];if(this.isComplexArrayItemStorageNode(o)){var l,d=this.getStorageNodeExplicitType(o)||this.getStorageNodeName(o);d?(l=s.createInstance(d,r),this.load(l,o,r)):(l={},this.load(l,o,r)),e.push(l)}else{var u=this.deserializeValue(this.doGetArrayItemSimpleStorageValue(o));e.push(u)}}return e},doLoadDate:function(e,t){var r=this.propNameToStorageName(this.getDefaultDateStorageName()),i=this.doLoadSimpleValue(e,r,s.DATE,t);if(i){var n=new Date(i);return e.copyFrom(n),e}},doLoadSimpleObject:function(e,t,r){for(var i=this.getAllStoredStorageNames(t),n=0,a=i.length;n<a;++n){var o=i[n],l=this.storageNameToPropName(o),d=this.getChildStorageNode(t,o);if(d){var u,c=this.getStorageNodeExplicitType(d);u=c?s.createInstance(c,r):{},this.load(u,d,r),e[l]=u}else{var h=this.doLoadSimpleValue(e,o,null,t);e[l]=h}}return e},doLoadObjectEx:function(e,t,r){for(var i=e.getAllPropList(),n=0,a=i.getLength();n<a;++n){var o=i.getPropInfoAt(n);if(o.serializable){var s=this.getObjCustomPropLoadMethod(e),l=!1;s&&(l=s(e,o,t,this)),l||this.doLoadObjectExProp(e,o,t,r)}}return e},doLoadObjectExProp:function(e,t,r,i){var n=t.name,a=t.dataType,o=this.doLoadFieldValue(e,n,r,a,i);null!==o&&void 0!==o&&e.setPropValue(n,o,!0)},doLoadFieldValue:function(e,t,r,i,n){var a,o=!1;if(s.isComplexType(i)){var l=this.getChildStorageNode(r,this.propNameToStorageName(t));if(l){var d=this.getStorageNodeExplicitType(l);a=d&&d!=i?s.createInstance(d,n):s.createInstance(i,n),this.load(a,l,n),o=!0}}return!s.isSimpleType(i)&&o||(a=this.doLoadSimpleValue(e,this.propNameToStorageName(t),i,r,n)),a},doLoadSimpleValue:function(e,t,r,i){var n=this.doLoadSimpleStorageValue(t,i);return this.deserializeValue(n,r)},doLoadSimpleStorageValue:function(e,t){},doGetArrayItemSimpleStorageValue:function(e){}}),d=n.create(l,{CLASS_NAME:"JsonObjSerializer",TYPE_TAG_NAME:"__type__",createChildStorageNode:function(e,t,r){var i=r?[]:{};return e[t]=i,i},appendArrayItemStorageNode:function(e,t,r){var i=r?[]:{};return e.push(i),i},getChildStorageNode:function(e,t){var r=e[t];return this.isSimpleType(r)&&(r=null),r},getAllArrayItemStorageNodes:function(e){return Array.prototype.slice.call(e)},getAllStoredStorageNames:function(e){var t=[];for(var r in e)e.hasOwnProperty(r)&&r!=this.TYPE_TAG_NAME&&t.push(r);return t},isComplexStorageNode:function(e){return this.isComplexType(e)},isComplexArrayItemStorageNode:function(e){return this.isComplexStorageNode(e)},isSimpleStorageNode:function(e){return this.isSimpleType(e)},setStorageNodeExplicitType:function(e,t){this.isArray(e)||(e[this.TYPE_TAG_NAME]=t)},getStorageNodeExplicitType:function(e){var t=e[this.TYPE_TAG_NAME]||null;return!t&&this.isArray(e)?s.ARRAY:t},doSaveSimpleValue:function(e,t,r,i,n){n[t]=r},doAppendArrayItemSimpleValue:function(e,t,r){return r.push(e)},doLoadSimpleStorageValue:function(e,t){return t[e]},doLoadUntypedNode:function(e){return e},doGetArrayItemSimpleStorageValue:function(e){return e}}),u=n.create(l,{CLASS_NAME:"XmlObjSerializer",TYPE_TAG_NAME:"dataType",UNSUIT_PROPNAME_PREFIX:"__.",getLocalName:function(e){return e.localName||e.baseName||e.nodeName},getElemTextValue:function(e){for(var t="",r=0,i=e.childNodes.length;r<i;++r)e.childNodes[r].nodeType==Node.TEXT_NODE&&(t+=e.childNodes[r].nodeValue);return t},serializeValue:function(e){return s.StringUtils.serializeValue(e)},deserializeValue:function(e,t){return s.StringUtils.deserializeValue(e,t)},propNameToStorageName:function(e){var t=e.toString().charAt(0).toLowerCase();return"_"===t||t>="a"&&t<="z"?e:this.UNSUIT_PROPNAME_PREFIX+e},storageNameToPropName:function(e){if("string"!=typeof e)return e;if(0===e.indexOf(this.UNSUIT_PROPNAME_PREFIX)){return e.substr(this.UNSUIT_PROPNAME_PREFIX.length)}return e},createChildStorageNode:function(e,t,r){var i=e.ownerDocument.createElement(t);return e.appendChild(i),i},appendArrayItemStorageNode:function(e,t,r){return this.createChildStorageNode(e,t,r)},getAllArrayItemStorageNodes:function(e){for(var t=[],r=0,i=e.childNodes.length;r<i;++r){var n=e.childNodes[r];n.nodeType==Node.ELEMENT_NODE&&t.push(n)}return t},getAllStoredStorageNames:function(e){for(var t=[],r=0,i=e.childNodes.length;r<i;++r){var n=e.childNodes[r];n.nodeType==Node.ELEMENT_NODE&&this.getLocalName(n)!=this.TYPE_TAG_NAME&&t.push(this.getLocalName(n))}for(var r=0,i=e.attributes.length;r<i;++r){var a=e.attributes[r];this.getLocalName(a)!=this.TYPE_TAG_NAME&&t.push(this.getLocalName(a))}return t},getChildStorageNode:function(e,t){for(var r=null,i=0,n=e.childNodes.length;i<n;++i){var a=e.childNodes[i];a.nodeType==Node.ELEMENT_NODE&&this.getLocalName(a)==t&&(r=a)}return r},isComplexStorageNode:function(e){return e.nodeType==Node.ELEMENT_NODE},isComplexArrayItemStorageNode:function(e){return this.isComplexStorageNode(e)&&e.attributes.length&&!this.getElemTextValue(e).trim()},isSimpleStorageNode:function(e){return e.nodeType==Node.ATTRIBUTE_NODE},setStorageNodeExplicitType:function(e,t){e.setAttribute(this.TYPE_TAG_NAME,t)},getStorageNodeExplicitType:function(e){return e.getAttribute(this.TYPE_TAG_NAME)||null},getStorageNodeName:function(e){var t=e.tagName;return t==this.getDefaultArrayItemStorageName()?null:t},doSaveSimpleObject:function($super,e,t){$super(e,t)},doSaveArray:function($super,e,t){$super(e,t)},doSaveSimpleValue:function(e,t,r,i,n){n.setAttribute(t,r)},doAppendArrayItemSimpleValue:function(e,t,r){var i=this.appendArrayItemStorageNode(r,this.propNameToStorageName(this.getDefaultArrayItemStorageName()),!1),n=i.ownerDocument.createTextNode(e);i.appendChild(n)},doLoadSimpleStorageValue:function(e,t){return t.getAttribute(e)},doGetArrayItemSimpleStorageValue:function(e){return this.getElemTextValue(e)}}),c={_serializerClasses:{},_defaultName:null,registerSerializer:function(e,t,r){var i="string"==typeof t?a.findClass(t):t;c._serializerClasses[e]=i,r&&(c._defaultName=e)},getSerializer:function(e){var t=e||c._defaultName;if(t){var r=c._serializerClasses[t];return r?new r:null}return null}};!function(){c.registerSerializer("json",d,!0),c.registerSerializer("xml",u)}(),n.ObjSerializerFactory=c,a.extend(o,{saveObj:function(e,t,r){var i;return i=t?"string"==typeof t?c.getSerializer(t):t:c.getSerializer(),i.save(this,e,r)},loadObj:function(e,t,r){var i;i=t?"string"==typeof t?c.getSerializer(t):t:c.getSerializer();var n;this.beginUpdate();try{n=i.load(this,e,r)}finally{this.endUpdate()}return n}}),Object.extend(a,{saveObj:function(e,t,r,i){var n;return n=r?"string"==typeof r?c.getSerializer(r):r:c.getSerializer(),n.save(e,t,i)},loadObj:function(e,t,r){var i;return i=r?"string"==typeof r?c.getSerializer(r):r:c.getSerializer(),i.load(e,t)}}),Object.extend(s,{valueToJson:function(e,t){if(s.isSimpleValue(e))return JSON.stringify(e);var r=s.isArrayValue(e)?[]:{};return a.saveObj(e,r,"json",t),JSON.stringify(r)},jsonToValue:function(e){var t=JSON.parse(e);return!t||s.isSimpleValue(t)?t:a.loadObj(null,t,"json")}}),e.exports={ObjSerializerFactory:c}},function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){"use strict";r(0),r(1),r(2);var i={};i=r(5)(i),i=r(7)(i),i=r(8)(i),i=r(9)(i),i=r(38)(i),i=r(39)(i),i=r(40)(i),i=r(41)(i),i=r(42)(i),i=r(46)(i),i=r(47)(i),i=r(48)(i),i=r(49)(i),i=r(50)(i),i=r(51)(i),i=r(52)(i),i=r(53)(i),i=r(54)(i),i=r(55)(i),i=r(56)(i),i=r(57)(i),i=r(58)(i),i=r(59)(i),i=r(60)(i),i=r(61)(i),i=r(62)(i),i=r(63)(i),i=r(64)(i),i=r(65)(i),i=r(66)(i),i=r(67)(i),i=r(68)(i),i=r(69)(i),i=r(70)(i),i=r(71)(i),i=r(72)(i),i=r(73)(i),i=r(74)(i),i=r(75)(i),i=r(76)(i),i=r(77)(i),i=r(78)(i),i=r(79)(i),i=r(80)(i),i=r(81)(i),i=r(82)(i),i=r(83)(i),i=r(84)(i),i=r(85)(i),i=r(86)(i),i=r(87)(i),i=r(88)(i),i=r(89)(i),i=r(90)(i),i=r(91)(i),i=r(92)(i),i=r(93)(i),i=r(94)(i),i=r(96)(i),i=r(97)(i),i=r(98)(i),i=r(99)(i),i=r(100)(i),i=r(101)(i),i=r(102)(i),i=r(103)(i),i=r(104)(i),i=r(105)(i),i=r(106)(i),i=r(107)(i),i=r(108)(i),i=r(109)(i),i=r(110)(i),i=r(111)(i),i=r(112)(i),i=r(113)(i),i=r(114)(i),i=r(115)(i),i=r(116)(i),i=r(117)(i),i=r(118)(i),i=r(119)(i),i=r(120)(i),i=r(121)(i),i=r(122)(i),i=r(123)(i),i=r(124)(i),i=r(125)(i),i=r(126)(i),i=r(127)(i),i=r(128)(i),i=r(129)(i),i=r(130)(i),i=r(131)(i),i=r(132)(i),i=r(133)(i),i=r(134)(i),i=r(135)(i),i=r(136)(i),i=r(137)(i),i=r(138)(i),i=r(139)(i),i=r(140)(i),i=r(141)(i),i=r(142)(i),i=r(143)(i),i=r(144)(i),i=r(145)(i),i=r(146)(i),i=r(147)(i),i=r(148)(i),i=r(149)(i),i=r(150)(i),i=r(151)(i),i=r(152)(i),i=r(153)(i),i=r(154)(i),i=r(155)(i),i=r(156)(i),i=r(157)(i),i=r(158)(i),i=r(159)(i),i=r(160)(i),i=r(161)(i),i=r(162)(i),i=r(163)(i),i=r(164)(i),i=r(165)(i),i=r(166)(i),i=r(167)(i),i=r(168)(i),i=r(169)(i),i=r(170)(i),i._loaded();var n=r(0).Class,a=r(0).ClassEx,o=r(0).ObjectEx,s=r(0).DataType;t.Kekule=i,t.Class=n,t.ClassEx=a,t.ObjectEx=o,t.DataType=s},function(e,t,r){"use strict";(function(t,r){var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports=function(e){var e={LIBNAME:"Kekule.js",LIBNAME_CORE:"Kekule",VERSION:"0.9.5.20022800",LOADED:!1,_afterLoadSysProcedures:[],_afterLoadUserProcedures:[],PROP_AUTO_TITLE:!0};return e._loaded=function(){if(!e.LOADED){e.LOADED=!0;for(var t=e._afterLoadSysProcedures;t.length;){var r=t.shift();r&&r()}for(var t=e._afterLoadUserProcedures;t.length;){var r=t.shift();r&&r()}var i=e.$jsRoot&&e.$jsRoot.document;if(i&&i.createEvent&&i.body&&i.body.dispatchEvent){var n=i.createEvent("Event");n.initEvent("kekuleload",!0,!0),i.body.dispatchEvent(n)}}},e._isLoaded=function(){return e.LOADED},e._registerAfterLoadSysProc=function(t){t&&(e.LOADED?t():e._afterLoadSysProcedures.push(t))},e._ready=function(t){t&&(e.LOADED?t():e._afterLoadUserProcedures.push(t))},e._registerAfterLoadProc=e._ready,e.$jsRoot=this||("undefined"!=typeof window?window:{}),"object"===("undefined"==typeof self?"undefined":i(self))?e.$jsRoot=self:"object"===("undefined"==typeof window?"undefined":i(window))&&window&&window.document?e.$jsRoot=window:"object"===(void 0===t?"undefined":i(t))&&(e.$jsRoot=t),e.$jsRoot.Kekule=e,e.$document=e.$jsRoot&&e.$jsRoot.document||{},e.scriptSrcInfo||(e.scriptSrcInfo=e.$jsRoot.__$kekule_load_info__),e.scriptSrcInfo&&e.scriptSrcInfo.language&&(e.language=e.scriptSrcInfo.language),!e.scriptSrcInfo&&e.$jsRoot.document&&(e.scriptSrcInfo=function(){for(var e=/^(.*\/?)kekule\..*\.js(\?.*)?$/,t=document.getElementsByTagName("script"),r=t.length-1;r>=0;--r){var i=t[r];if(i.src){var n=i.src.match(e);if(n){var a=n[2];a&&(a=a.substr(1));return{src:i.src,path:n[1],paramStr:a,useMinFile:!0}}}}return null}()),e.environment={isNode:!("object"!==(void 0===r?"undefined":i(r))||"object"!==i(r.versions)||void 0===r.versions.node),isWeb:!("object"!==("undefined"==typeof window?"undefined":i(window))||!window.document)},e.scriptSrcInfo&&(e.environment.nodeModule=e.scriptSrcInfo.nodeModule,e.environment.nodeRequire=e.scriptSrcInfo.nodeRequire),e.$jsRoot.__$kekule_scriptfile_utils__&&(e._ScriptFileUtils_=e.$jsRoot.__$kekule_scriptfile_utils__,e.ScriptFileUtils=e._ScriptFileUtils_,e.modules=function(t,r){var i=[];i="string"==typeof t?[t]:t;var n=e.scriptSrcInfo;if(n){e._ScriptFileUtils_.loadModuleScriptFiles(i,n.useMinFile,e.scriptSrcInfo.path,n,function(e){r&&r(e)});return this}return this},e.loadModules=e.modules),e.getScriptPath=function(){return e.scriptSrcInfo.path},e.getScriptSrc=function(){return e.scriptSrcInfo.src},e.getStyleSheetPath=function(){var t=e.scriptSrcInfo;return t.useMinFile?t.path:t.path+"widgets/"},e.getStyleSheetUrl=function(){return e.getStyleSheetPath()+"themes/default/kekule.css"},e.$jsRoot&&e.$jsRoot.addEventListener&&e.$jsRoot.postMessage&&e.$jsRoot.addEventListener("message",function(t){"kekule-sys-info-query"===t.data&&e.$jsRoot.postMessage({msg:"kekule-sys-info-result",libName:e.LIBNAME,version:e.VERSION},"*")},!1),e.Dev={},e}}).call(t,r(3),r(6))},function(e,t){function r(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function n(e){if(u===setTimeout)return setTimeout(e,0);if((u===r||!u)&&setTimeout)return u=setTimeout,setTimeout(e,0);try{return u(e,0)}catch(t){try{return u.call(null,e,0)}catch(t){return u.call(this,e,0)}}}function a(e){if(c===clearTimeout)return clearTimeout(e);if((c===i||!c)&&clearTimeout)return c=clearTimeout,clearTimeout(e);try{return c(e)}catch(t){try{return c.call(null,e)}catch(t){return c.call(this,e)}}}function o(){f&&m&&(f=!1,m.length?g=m.concat(g):p=-1,g.length&&s())}function s(){if(!f){var e=n(o);f=!0;for(var t=g.length;t;){for(m=g,g=[];++p<t;)m&&m[p].run();p=-1,t=g.length}m=null,f=!1,a(e)}}function l(e,t){this.fun=e,this.array=t}function d(){}var u,c,h=e.exports={};!function(){try{u="function"==typeof setTimeout?setTimeout:r}catch(e){u=r}try{c="function"==typeof clearTimeout?clearTimeout:i}catch(e){c=i}}();var m,g=[],f=!1,p=-1;h.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];g.push(new l(e,t)),1!==g.length||f||n(s)},l.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=d,h.addListener=d,h.once=d,h.off=d,h.removeListener=d,h.removeAllListeners=d,h.emit=d,h.prependListener=d,h.prependOnceListener=d,h.listeners=function(e){return[]},h.binding=function(e){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(e){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},function(e,t,r){"use strict";e.exports=function(e){function t(e){var t=e.split("-");return{language:t[0],local:t[1]}}function r(){var e=[];for(var t in N)e.push(t);return e}function i(e,t,r){var i=r||N[e];return!i&&t&&(i={},N[e]=i),i}function n(t,r,n){var a=i(r,!1,n);if(a){var o=Object.getCascadeFieldValue(t,a,e);if(void 0!==o)return o}}function a(e,t,r){for(var i=(t?[t]:[]).concat(b),a=0,o=i.length;a<o;++a){var s=i[a],l=n(e,s,r);if(void 0!==l)return l}}function o(t,r,i){var n=a(t,r,i);if(void 0!==n)return n;e.error("Can not find localization resource: "+t)}function s(e,t,r,n,a){var o=i(r,n,a);return!!o&&Object.setCascadeFieldValue(e,t,o,n)}function l(e){E=e,T.indexOf(e)<0&&T.push(e)}function d(t,r){var t=t||"GLOBAL",i=Object.getCascadeFieldValue(t,_,e);return!i&&r&&(i=Object.setCascadeFieldValue(t,{},_,!0)),i}function u(){return T}function c(e,t,r,i){if(r){var a,o=n(t,e,i);a=o?Object.extendEx(o,r,{cascade:!0}):JSON.parse(JSON.stringify(r)),s(t,a,e,!0,i)}}function h(){return _}var m=e.$jsRoot;m||(m={});var g=e,f=e.language||(m&&m.navigator?navigator.language||navigator.browserLanguage:"en-US");g.language=f;var p=t(f),C=t("en-US"),b=[p.language+"_"+p.local,p.language,C.language+C.local,C.language];e.Localization={},e.LocalizationRes={};var E,N=e.LocalizationRes,T=[],O=!!(m||m.window).__kekuleMarkLocalizationModuleInfo__,_={};return e.$L=o,e.Localization.getLanguages=r,e.Localization.getValue=o,e.Localization.findValue=a,e.Localization.getModuleInfos=h,e.Localization.setCurrModule=l,e.Localization.getModuleNames=u,e.Localization.addResource=function(e,t,r){if(c(e,t,r),O){c(e,t,r,d(E,!0))}},e}},function(e,t,r){"use strict";e.exports=function(e){return e.LOCAL_RES=!0,e.Localization.setCurrModule("general"),e.Localization.addResource("en","Texts",{UNNAMED:"unnamed"}),e.Localization.addResource("en","ErrorMsg",{MODULE_NOT_LOADED:"Module {0} is not loaded",NON_OWN_PROPERTY_CANNOT_BE_REPLACED:"Only directly owned property of object can be replaced",EMPTY_DOC:"Document is empty",ELEMENT_NOTSET:"Element not set",EMPTY_RESURI:"Resource URI is empty",CANNOT_LOAD_RES_OF_URI:"Can not load resource of URI: ",LIST_ITEM_CLASS_MISMATCH:"Mismatched item class, can not add to list",CANNOT_CLEAR_WEAKMAP:"Can not clear a weak map",CANNOT_GET_KEY_LIST_IN_WEAKMAP:"Can not get key array from a weak map",CANNOT_GET_VALUE_LIST_IN_WEAKMAP:"Can not get value array from a weak map",INVALID_CHEMELEMENT:"Invalid chemical element",INVALID_ISOTOPE:"Invalid isotope",COORD_STICK_NOT_ALLOWED_ON_CLASS:"Coordinate sticking is not allowed in this type of object",INVALID_STICK_TARGET_OBJ:"Invalid sticking target",UNABLE_TO_STICK_TO_OTHER_OWNER_OBJ:"Unable to stick to object with a different owner",UNABLE_TO_STICK_TO_OBJ_WITHOUT_ABS_COORD:"Unable to stick to object without absolute coordinates",STICK_RECURSION_NOT_ALLOWED:"Stick recursion is not allowed",UNABLE_ADD_MISTYPED_NODE:"Unable to link mistyped node to connector",UNABLE_ADD_DIFF_OWNER_OBJ:"Object with different owner can not be linked to connector",CHEMSTRUCTUREOBJECTGROUP_ITEMCLASS_MISMATCH:"Mismatched group item class",SORT_FUNC_UNSET:"Sort function is not set",SOURCE_FRAGMENT_NOT_SET:"Source structure fragment not set",UNABLE_ADD_NONMOLECULE_MAP:"Unable to add non-molecule to reactants or products",CANNOT_ADD_NON_NODE_NOR_CONNECTOR_TO_STRUCT_CONTAINER:"Can not add object other than node or connector to structure object container",REGISTERED_CANONICALIZATION_EXECUTOR_NOT_FOUND:"Can not find registered canonicalization executor",ERROR_LOADING_FILE:"Error loading file: ",READER_ID_ALREADY_EXISTS:"Can not register reader: id already exists",WRITER_ID_ALREADY_EXISTS:"Can not register writer: id already exists",FAIL_TO_READ_FORMAT:"Fail to load data of format: ",NO_SUITABLE_READER_FOR_FORMAT:"Can not read data of format: ",NO_SUITABLE_READER_FOR_MIMETYPE:"Can not read data of MIME type: ",NO_SUITABLE_READER_FOR_FILEEXT:"Can not read data of file extension: ",NO_SUITABLE_WRITER_FOR_FORMAT:"Can not write data of format: ",NO_SUITABLE_WRITER_FOR_MIMETYPE:"Can not write data of MIME type: ",NO_SUITABLE_WRITER_FOR_FILEEXT:"Can not write data of file extension: ",AJAX_FILELOADER_NOT_FOUND:"AJAX file loader not found, can not load URL",FAIL_TO_LOAD_FILE_URL:"Fail to load file of URL: ",CML_ELEM_READER_NOT_FOUND:"Reader for element <{0}> not found",ATOMID_NOT_EXISTS:"Atom id not exists: ",BONDID_NOT_EXISTS:"Bond id not exists: ",CML_ELEM_WRITER_TYPE_INPROPER:"{0} is not a proper CML element writer for {1}",CML_CAN_NOT_OUTPUT_TO_EMPTY_ELEMENT:"Can not output content to empty element",UNABLE_TO_OUTPUT_AS_CML:"Unable to output object <{0}> to CML data",MDL_CTAB_ATOM_CANNOT_CREATE:"Can not create atom from source MDL format data",MDL_CTAB_BOND_CANNOT_CREATE:"Can not create bond from source MDL format data",CAN_NOT_WRITE_NON_MOLECULE_TO_MOL:"Object is not a molecule and can not be output to connection table",MOLECULE_HAS_NO_CTAB_TO_OUTPUT:"Molecule has no connection table and can not be output to MDL format",NOT_MDL2000_FORMAT_DATA:"Data format wrong: not MDL 2000",NOT_MDL_RXN_DATA:"Not MDL Reaction(RXN) data",MALFORMED_MDL3000_COUNTLINE:"Malformed MDL 3000 count line",MDL3000_ATOMBLOCK_NOT_FOUND:"Atom block not found, malformed MDL 3000 data?",NOT_MDL_FORMAT_DATA:"Data format wrong: not MDL 2000 or 3000",NOT_MDL2000_RXN_DATA:"Not MDL RXN 2000 data",NOT_MDL3000_RXN_DATA:"Not MDL RXN 3000 data",NOT_MDL3000_RXN_COUNTLINE:"Error in reading RXN 3000 count line",MDL_OUTPUT_DATATYPE_NOT_TEXT:"MDL data can not be output to non text format",MDL_INPUT_DATATYPE_NOT_TEXT:"Non text format is not a legal MDL source data",UNABLE_TO_OUTPUT_AS_MDL:"Unable to output object <{0}> to MDL data",KCJ_INPUT_DATATYPE_NOT_JSON_OR_TEXT:"Non text or JSON format data is not a legal KCJ source",KCJ_OUTPUT_DATATYPE_NOT_JSON_OR_TEXT:"Can not output as non text or JSON data",KCX_INPUT_DATATYPE_NOT_DOM_OR_TEXT:"Non text or DOM data is not a legal KCX source",KCX_OUTPUT_DATATYPE_NOT_DOM_OR_TEXT:"Can not output as non text or DOM data",JSON_SERIALIZER_NOT_EXISTS:"Serializer for JSON not exists",XML_SERIALIZER_NOT_EXISTS:"Serializer for XML not exists",INAVAILABLE_AUTOSCALE_REF_LENGTH:"Can not determine the length for calculation of auto scale",FORMULA_RENDERER_3D_NOT_AVAILABLE:"3D renderer for molecule formula is not available",CANNOT_FIND_SUITABLE_RENDERER_FOR_OBJ:"Can not find suitable renderer for object",CALC_TERMINATED_BY_USER:"Calculation terminated by user",CALC_SERVICE_UNAVAILABLE:'Calculation service "{0}" is unavailable'}),e}},function(e,t,r){"use strict";var i=r(10),n=r(11),a=r(12),o=r(13),s=r(14),l=r(15),d=r(16),u=r(17),c=r(18),h=r(19),m=r(20),g=r(21),f=r(22),p=r(23),C=r(24),b=r(25),E=r(26),N=r(27),T=r(28),O=r(29),_=r(30),S=r(31),v=r(32),y=r(33),A=r(34),M=r(35),I=r(36),R=r(37);e.exports=function(e){return e.LOCAL_RES=!0,e.Localization.setCurrModule("widget"),e.Localization.addResource("en","WidgetTexts",{CAPTION_OK:"OK",CAPTION_CANCEL:"Cancel",CAPTION_YES:"Yes",CAPTION_NO:"No",CAPTION_BROWSE_COLOR:"Browse colors",HINT_BROWSE_COLOR:"Browse more colors",S_COLOR_UNSET:"(unset)",S_COLOR_DEFAULT:"(default)",S_COLOR_MIXED:"(mixed)",S_COLOR_TRANSPARENT:"(transparent)",S_OBJECT_UNSET:"(none)",S_ITEMS:"item(s)",S_OBJECT:"object",S_VALUE_UNSET:"(Unset)",CAPTION_MENU:"Menu",HINT_MENU:"Open menu",S_INSPECT_NONE:"(none)",S_INSPECT_OBJECTS:"({0} objects)",S_INSPECT_ID_OBJECT:"{0}: {1}",S_INSPECT_ANONYMOUS_OBJECT:"({0})",CAPTION_TOGGLE_TEXTWRAP:"Toggle text wrapping",CAPTION_INC_TEXT_SIZE:"Increase text size",CAPTION_DEC_TEXT_SIZE:"Decrease text size",HINT_TOGGLE_TEXTWRAP:"Toggle the state of text wrapping",HINT_INC_TEXT_SIZE:"Increase text size",HINT_DEC_TEXT_SIZE:"Decrease text size",HINT_CHOOSE_FONT_FAMILY:"Choose font family",CAPTION_FIRST_PAGE:"First",CAPTION_LAST_PAGE:"Last",CAPTION_PREV_PAGE:"Prev",CAPTION_NEXT_PAGE:"Next",HINT_FIRST_PAGE:"First page",HINT_LAST_PAGE:"Last page",HINT_PREV_PAGE:"Previous page",HINT_NEXT_PAGE:"Next page",HINT_CURR_PAGE:"Current page",MSG_RETRIEVING_DATA:"Loading data...",CAPTION_DATATABLE_EDIT:"Edit",CAPTION_DATATABLE_DELETE:"Delete",CAPTION_DATATABLE_INSERT:"Insert",HINT_DATATABLE_EDIT:"Edit",HINT_DATATABLE_DELETE:"Delete",HINT_DATATABLE_INSERT:"Insert",CAPTION_ADD_CELL:"+",HINT_ADD_CELL:"Add new cell",CAPTION_REMOVE_CELL:"Remove",HINT_REMOVE_CELL:"Remove cell",CAPTION_CONFIG:"Settings...",HINT_CONFIG:"Change settings",TITLE_IMG_FORMAT_PNG:"PNG format image",TITLE_IMG_FORMAT_JPG:"Jpeg format image",TITLE_IMG_FORMAT_GIF:"GIF format image",TITLE_IMG_FORMAT_SVG:"SVG format image"}),e.Localization.addResource("en","ChemWidgetTexts",{CAPTION_CLEAROBJS:"Clear",CAPTION_LOADFILE:"Load...",CAPTION_LOADDATA:"Load...",CAPTION_SAVEFILE:"Save...",CAPTION_ZOOMIN:l,CAPTION_ZOOMOUT:d,CAPTION_RESETZOOM:u,CAPTION_RESETVIEW:u,CAPTION_ROTATE:"Rotate",CAPTION_ROTATELEFT:"Left Rotate",CAPTION_ROTATERIGHT:"Right Rotate",CAPTION_ROTATEX:"X Rotate",CAPTION_ROTATEY:"Y Rotate",CAPTION_ROTATEZ:"Z Rotate",CAPTION_MOL_DISPLAY_TYPE:"Molecule Display Style",CAPTION_SKELETAL:"Skeletal",CAPTION_CONDENSED:"Condensed",CAPTION_WIRE:"Wire Frame",CAPTION_STICKS:"Sticks",CAPTION_BALLSTICK:"Ball Stick",CAPTION_SPACEFILL:"Space Fill",CAPTION_HIDEHYDROGENS:"Show/hide hydrogens",CAPTION_OPENEDITOR:"Edit...",CAPTION_EDITOR_DONE:"Done",CAPTION_EDITOR_CANCEL:"Cancel",CAPTION_EDIT_OBJ:"Edit",HINT_CLEAROBJS:"Clear objects",HINT_LOADFILE:"Load from file",HINT_LOADDATA:"Load data",HINT_SAVEFILE:"Save to file",HINT_ZOOMIN:"Zoom in",HINT_ZOOMOUT:"Zoom out",HINT_RESETZOOM:"Reset zoom",HINT_RESETVIEW:"Reset zoom and rotation",HINT_ROTATE:"Rotate",HINT_ROTATELEFT:"Rotate in anticlockwise direction",HINT_ROTATERIGHT:"Rotate in clockwise direction",HINT_ROTATEX:"Rotate around X axis",HINT_ROTATEY:"Rotate around Y axis",HINT_ROTATEZ:"Rotate around Z axis",HINT_MOL_DISPLAY_TYPE:"Change molecule display style",HINT_SKELETAL:"Show molecule in skeletal style",HINT_CONDENSED:"Show molecule in condensed style",HINT_WIRE:"Show molecule in wire frame style",HINT_STICKS:"Show molecule in sticks style",HINT_BALLSTICK:"Show molecule in ball-stick style",HINT_SPACEFILL:"Show molecule in space-fill style",HINT_HIDEHYDROGENS:"Show/hide hydrogen atoms in model",HINT_OPENEDITOR:"Open an editor to modify displayed object",HINT_EDITOR_DONE:"Save the modification",HINT_EDITOR_CANCEL:"Discard the modification",CAPTION_NEWDOC:"New",CAPTION_UNDO:c,CAPTION_REDO:h,CAPTION_COPY:"Copy",CAPTION_CUT:"Cut",CAPTION_PASTE:"Paste",CAPTION_TOGGLE_SELECT:"Toggle select",CAPTION_CLONE_SELECTION:"Clone selection",CAPTION_TOGGLE_INSPECTOR:"Object inspector",CAPTION_MANIPULATE:"Select",CAPTION_MANIPULATE_MARQUEE:"Marquee select",CAPTION_MANIPULATE_LASSO:"Lasso select",CAPTION_MANIPULATE_BRUSH:"Brush select",CAPTION_MANIPULATE_ANCESTOR:"Select molecule",CAPTION_CLIENT_DRAGSCROLL:"Scroll",CAPTION_ERASE:"Erase",CAPTION_TRACK_INPUT:"Track",CAPTION_MOL_BOND:"Bond",CAPTION_MOL_BOND_SINGLE:i,CAPTION_MOL_BOND_DOUBLE:n,CAPTION_MOL_BOND_TRIPLE:a,CAPTION_MOL_BOND_QUAD:"Quad bond",CAPTION_MOL_BOND_EXPLICIT_AROMATIC:"Aromatic bond",CAPTION_MOL_BOND_WEDGEUP:o,CAPTION_MOL_BOND_WEDGEUP_INVERTED:"Wedge up bond 2",CAPTION_MOL_BOND_WEDGEDOWN:s,CAPTION_MOL_BOND_WEDGEDOWN_INVERTED:"Wedge down bond 2",CAPTION_MOL_BOND_CLOSER:"Outer bond",CAPTION_MOL_BOND_WAVY:"Wavy bond",CAPTION_MOL_BOND_DOUBLE_EITHER:"Double Either bond",CAPTION_MOL_BOND_IONIC:"Ionic bond",CAPTION_MOL_BOND_COORDINATE:"Coordinate bond",CAPTION_MOL_BOND_METALLIC:"Metallic bond",CAPTION_MOL_BOND_HYDROGEN:"Hydrogen bond",CAPTION_MOL_BOND_KEKULIZE:"Kekulize",CAPTION_MOL_BOND_HUCKLIZE:"Hucklize",CAPTION_MOL_ATOM:"Atom",CAPTION_MOL_FORMULA:"Formula",CAPTION_MOL_ATOM_AND_FORMULA:"Atom & formula",CAPTION_MOL_CHARGE:"Charge",CAPTION_MOL_CHARGE_CLEAR:"Charge clear",CAPTION_MOL_CHARGE_POSITIVE:A,CAPTION_MOL_CHARGE_NEGATIVE:M,CAPTION_MOL_CHARGE_SINGLET:v,CAPTION_MOL_CHARGE_DOUBLET:"Monoradical",CAPTION_MOL_CHARGE_TRIPLET:"Triplet radical",CAPTION_MOL_ELECTRON_LONEPAIR:y,CAPTION_MOL_ELECTRON_SINGLE:v,CAPTION_TEXT_BLOCK:"Text block",CAPTION_IMAGE_BLOCK:"Image block",CAPTION_TEXT_IMAGE:"Text & image",CAPTION_MOL_FLEXCHAIN:"Flex chain",CAPTION_MOL_FLEXRING:N,CAPTION_REPOSITORY_RING:"Rings",CAPTION_REPOSITORY_RING_3:T,CAPTION_REPOSITORY_RING_4:O,CAPTION_REPOSITORY_RING_5:_,CAPTION_REPOSITORY_RING_6:S,CAPTION_REPOSITORY_RING_7:"Cycloheptane",CAPTION_REPOSITORY_RING_8:"Cyclooctane",CAPTION_REPOSITORY_RING_AR_6:E,CAPTION_REPOSITORY_RING_AR_5:"Cyclopentadiene",CAPTION_REPOSITORY_CYCLOHEXANE_CHAIR1:"Cyclohexane chair 1",CAPTION_REPOSITORY_CYCLOHEXANE_CHAIR2:"Cyclohexane chair 2",CAPTION_REPOSITORY_CYCLOHEXANE_HARWORTH1:"Cyclohexane Haworth 1",CAPTION_REPOSITORY_CYCLOHEXANE_HARWORTH2:"Cyclohexane Haworth 2",CAPTION_REPOSITORY_CYCLOPENTANE_HARWORTH1:"Cyclopentane Haworth 1",CAPTION_REPOSITORY_CYCLOPENTANE_HARWORTH2:"Cyclopentane Haworth 2",CAPTION_REPOSITORY_METHANE:"Methane",CAPTION_REPOSITORY_FISCHER1:"Fischer projection 1",CAPTION_REPOSITORY_FISCHER2:"Fischer projection 2",CAPTION_REPOSITORY_FISCHER3:"Fischer projection 3",CAPTION_REPOSITORY_SAWHORSE_STAGGERED:"Sawhorse staggered",CAPTION_REPOSITORY_SAWHORSE_ECLIPSED:"Sawhorse eclipsed",CAPTION_REPOSITORY_SUBBOND_MARK:"Substituent bond",CAPTION_REPOSITORY_ARROWLINE:"Arrows & symbols",CAPTION_REPOSITORY_GLYPH:"Glyphs",CAPTION_REPOSITORY_GLYPH_LINE:"Line",CAPTION_REPOSITORY_GLYPH_OPEN_ARROW_LINE:m,CAPTION_REPOSITORY_GLYPH_TRIANGLE_ARROW_LINE:"Triangle arrow line",CAPTION_REPOSITORY_GLYPH_DI_OPEN_ARROW_LINE:g,CAPTION_REPOSITORY_GLYPH_DI_TRIANGLE_ARROW_LINE:"Bidirectional triangle arrow line",CAPTION_REPOSITORY_GLYPH_REV_ARROW_LINE:f,CAPTION_REPOSITORY_GLYPH_OPEN_ARROW_DILINE:p,CAPTION_REPOSITORY_GLYPH_OPEN_ARROW_ARC:R,CAPTION_REPOSITORY_GLYPH_SINGLE_SIDE_OPEN_ARROW_ARC:I,CAPTION_REPOSITORY_ELECTRON_PUSHING_ARROW:"Electron pushing arrow",CAPTION_ELECTRON_PUSHING_ARROW:"Electron pushing arrow",CAPTION_ELECTRON_PUSHING_ARROW_DOUBLE:"Double electron pushing arrow",CAPTION_ELECTRON_PUSHING_ARROW_SINGLE:"Single electron pushing arrow",CAPTION_REPOSITORY_HEAT_SYMBOL:C,CAPTION_REPOSITORY_ADD_SYMBOL:b,CAPTION_TEXT_FORMAT:"Text format",CAPTION_PICK_COLOR:"Color",CAPTION_FONTNAME:"Font name",CAPTION_FONTSIZE:"Font size",CAPTION_TEXT_DIRECTION:"Text direction",CAPTION_TEXT_DIRECTION_DEFAULT:"Default",CAPTION_TEXT_DIRECTION_LTR:"Left to right",CAPTION_TEXT_DIRECTION_RTL:"Right to left",CAPTION_TEXT_DIRECTION_TTB:"Top to bottom",CAPTION_TEXT_DIRECTION_BTT:"Bottom to top",CAPTION_TEXT_HORIZONTAL_ALIGN:"Text horizontal alignment",CAPTION_TEXT_VERTICAL_ALIGN:"Text vertical alignment",CAPTION_TEXT_ALIGN_DEFAULT:"Default",CAPTION_TEXT_ALIGN_LEADING:"Leading",CAPTION_TEXT_ALIGN_TRAILING:"Trailing",CAPTION_TEXT_ALIGN_CENTER:"Center",CAPTION_TEXT_ALIGN_LEFT:"Left",CAPTION_TEXT_ALIGN_RIGHT:"Right",CAPTION_TEXT_ALIGN_TOP:"Top",CAPTION_TEXT_ALIGN_BOTTOM:"Bottom",CAPTION_NODE_LABEL_DISPLAY_MODE:"Atom label display mode",CAPTION_NODE_LABEL_DISPLAY_MODE_DEFAULT:"Default",CAPTION_NODE_LABEL_DISPLAY_MODE_SHOWN:"Show label",CAPTION_NODE_LABEL_DISPLAY_MODE_HIDDEN:"Hide label",CAPTION_NODE_LABEL_DISPLAY_MODE_SMART:"Smart",CAPTION_ATOM_MODIFIER:"Atom",CAPTION_ATOM_MODIFIER_MIXED:"[A]",CAPTION_BOND_MODIFIER:"Bond",CAPTION_CHARGE_MODIFIER:"Charge",CAPTION_GLYPH_PATH_MODIFIER:"Path",CAPTION_REACTION_ARROW_AND_SEGMENT_PATH_MODIFIER:"Reaction arrow & segment",CAPTION_ARC_PATH_MODIFIER:"Arc",CAPTION_MULTI_ARC_PATH_MODIFIER:"Multi-Arc",CAPTION_ELECTRON_PUSHING_ARROW_MODIFIER:"Electron pushing arrow",CAPTION_BOND_FORMING_ELECTRON_PUSHING_ARROW_MODIFIER:"Bond forming arrow",TEXT_CHARGE_POSITIVE:"+",TEXT_CHARGE_NEGATIVE:"-",TEXT_CHARGE_UNKNOWN:"<sup>+</sup>/<sub>-</sub>",TEXT_CHARGE_NONE:"&#8709;",HINT_NEWDOC:"Create new document",HINT_UNDO:"Undo",HINT_REDO:"Redo",HINT_COPY:"Copy selection to internal clipboard",HINT_CUT:"Cut selection to internal clipboard",HINT_PASTE:"Paste from internal clipboard",HINT_CLONE_SELECTION:"Clone selection",HINT_TOGGLE_SELECT:"Toggle select",HINT_TOGGLE_INSPECTOR:"Show or hide object inspector panel",HINT_MANIPULATE:"Select tool",HINT_MANIPULATE_MARQUEE:"Marquee select",HINT_MANIPULATE_LASSO:"Lasso select",HINT_MANIPULATE_BRUSH:"Brush select",HINT_MANIPULATE_ANCESTOR:"Select molecule",HINT_CLIENT_DRAGSCROLL:"Scroll",HINT_ERASE:"Erase tool",HINT_TRACK_INPUT:"Track tool",HINT_MOL_BOND:"Bond tool",HINT_MOL_BOND_SINGLE:"Single bond",HINT_MOL_BOND_DOUBLE:"Double bond",HINT_MOL_BOND_TRIPLE:"Triple bond",HINT_MOL_BOND_QUAD:"Quad bond",HINT_MOL_BOND_EXPLICIT_AROMATIC:"Explicit aromatic bond",HINT_MOL_BOND_WEDGEUP:"Wedge up bond",HINT_MOL_BOND_WEDGEUP_INVERTED:"Wedge up bond 2",HINT_MOL_BOND_WEDGEDOWN:"Wedge down bond",HINT_MOL_BOND_WEDGEDOWN_INVERTED:"Wedge down bond 2",HINT_MOL_BOND_CLOSER:"Outer bond",HINT_MOL_BOND_WAVY:"Wavy bond",HINT_MOL_BOND_DOUBLE_EITHER:"Double either bond",HINT_MOL_BOND_IONIC:"Ionic bond",HINT_MOL_BOND_COORDINATE:"Coordinate bond",HINT_MOL_BOND_METALLIC:"Metallic bond",HINT_MOL_BOND_HYDROGEN:"Hydrogen bond",HINT_MOL_BOND_KEKULIZE:"Kekulize, convert explicit aromatic bonds to compartmental single and double ones",HINT_MOL_BOND_HUCKLIZE:"Hucklize, mark bonds on aromatic rings as explicit aromatic ones",HINT_MOL_ATOM:"Atom tool",HINT_MOL_FORMULA:"Formula tool",HINT_MOL_ATOM_AND_FORMULA:"Atom and formula tool",HINT_MOL_CHARGE:"Charge tool",HINT_MOL_CHARGE_CLEAR:"Clear charge and radical",HINT_MOL_CHARGE_POSITIVE:"Positive charge",HINT_MOL_CHARGE_NEGATIVE:"Negative charge",HINT_MOL_CHARGE_SINGLET:"Singlet radical",HINT_MOL_CHARGE_DOUBLET:"Monoradical",HINT_MOL_CHARGE_TRIPLET:"Triplet radical",HINT_MOL_ELECTRON_LONEPAIR:"Lone pair electrons",HINT_MOL_ELECTRON_SINGLE:"Single electron",HINT_TEXT_BLOCK:"Text block tool",HINT_IMAGE_BLOCK:"Image block tool",HINT_TEXT_IMAGE:"Text and image tool",HINT_MOL_FLEXCHAIN:"Flex carbon chain",HINT_MOL_FLEXRING:"Flex carbon ring",HINT_REPOSITORY_RING:"Ring structures tool",HINT_REPOSITORY_RING_3:"Cyclopropane",HINT_REPOSITORY_RING_4:"Cyclobutane",HINT_REPOSITORY_RING_5:"Cyclopentane",HINT_REPOSITORY_RING_6:"Cyclohexane",HINT_REPOSITORY_RING_7:"Cycloheptane",HINT_REPOSITORY_RING_8:"Cyclooctane",HINT_REPOSITORY_RING_AR_6:"Benzene",HINT_REPOSITORY_RING_AR_5:"Cyclopentadiene",HINT_REPOSITORY_CYCLOHEXANE_CHAIR1:"Cyclohexane chair 1",HINT_REPOSITORY_CYCLOHEXANE_CHAIR2:"Cyclohexane chair 2",HINT_REPOSITORY_CYCLOHEXANE_HARWORTH1:"Cyclohexane Haworth 1",HINT_REPOSITORY_CYCLOHEXANE_HARWORTH2:"Cyclohexane Haworth 2",HINT_REPOSITORY_CYCLOPENTANE_HARWORTH1:"Cyclopentane Haworth 1",HINT_REPOSITORY_CYCLOPENTANE_HARWORTH2:"Cyclopentane Haworth 2",HINT_REPOSITORY_SUBBOND_MARK:"Substituent bond",HINT_REPOSITORY_METHANE:"Methane",HINT_REPOSITORY_FISCHER1:"Fischer projection with one chiral center",HINT_REPOSITORY_FISCHER2:"Fischer projection with two chiral centers",HINT_REPOSITORY_FISCHER3:"Fischer projection with three chiral centers",HINT_REPOSITORY_SAWHORSE_STAGGERED:"Sawhorse staggered",HINT_REPOSITORY_SAWHORSE_ECLIPSED:"Sawhorse eclipsed",HINT_REPOSITORY_ARROWLINE:"Arrows and symbols tool",HINT_REPOSITORY_GLYPH:"Glyphs",HINT_REPOSITORY_GLYPH_LINE:"Line",HINT_REPOSITORY_GLYPH_OPEN_ARROW_LINE:"Open arrow line",HINT_REPOSITORY_GLYPH_TRIANGLE_ARROW_LINE:"Triangle arrow line",HINT_REPOSITORY_GLYPH_DI_OPEN_ARROW_LINE:"Bidirectional open arrow line",HINT_REPOSITORY_GLYPH_DI_TRIANGLE_ARROW_LINE:"Bidirectional triangle arrow line",HINT_REPOSITORY_GLYPH_REV_ARROW_LINE:"Reversible arrow line",HINT_REPOSITORY_GLYPH_OPEN_ARROW_DILINE:"Open arrow double line",HINT_REPOSITORY_GLYPH_OPEN_ARROW_ARC:"Open arrow arc",HINT_REPOSITORY_GLYPH_SINGLE_SIDE_OPEN_ARROW_ARC:"Single side open arrow arc",HINT_REPOSITORY_HEAT_SYMBOL:"Heat symbol",HINT_REPOSITORY_ADD_SYMBOL:"Add symbol",HINT_ELECTRON_PUSHING_ARROW:"Electron pushing arrow",HINT_NODE_LABEL_DISPLAY_MODE:"Atom label display mode",HINT_TEXT_FORMAT:"Set text format",HINT_FONTNAME:"Set font name",HINT_FONTSIZE:"Set font size",HINT_PICK_COLOR:"Select color",HINT_TEXT_DIRECTION:"Set text direction",HINT_TEXT_HORIZONTAL_ALIGN:"Set text horizontal alignment",HINT_TEXT_VERTICAL_ALIGN:"Set text vertical alignment",HINT_CHARGE_NONE:"No charge",HINT_ATOM_MODIFIER:"Set atom",HINT_BOND_MODIFIER:"Set bond",HINT_CHARGE_MODIFIER:"Set charge",HINT_GLYPH_PATH_MODIFIER:"Set path properties",HINT_REACTION_ARROW_AND_SEGMENT_PATH_MODIFIER:"Set reaction arrow and segment properties",HINT_ARC_PATH_MODIFIER:"Set arc properties",HINT_MULTI_ARC_PATH_MODIFIER:"Set multi-arc properties",HINT_ELECTRON_PUSHING_ARROW_MODIFIER:"Set electron pushing arrow properties",HINT_BOND_FORMING_ELECTRON_PUSHING_ARROW_MODIFIER:"Set bond forming arrow properties",HINT_USE_ATOM_CUSTOM_COLOR:"(use atom custom color)",CAPTION_LOADDATA_DIALOG:"Load data",CAPTION_LOADDATA_DIALOG_APPENDMODE:"Append to current",CAPTION_SAVEDATA_DIALOG:"Save data",CAPTION_DATA_FORMAT:"Data format:",CAPTION_DATA_SRC:"Input or paste data below:",CAPTION_LOADDATA_FROM_FILE:"Load from file",CAPTION_CHOOSEFILEFORMAT:"Choose file format",CAPTION_SELECT_FORMAT:"Select format:",CAPTION_PREVIEW_FILE_CONTENT:"Preview: ",S_DEF_SAVE_FILENAME:"Unnamed",CAPTION_ATOMLIST_PERIODIC_TABLE:"more...",CAPTION_RGROUP:"Sub group",CAPTION_VARIABLE_ATOM:"Variable Atom (list)",CAPTION_VARIABLE_NOT_ATOM:"Variable Atom (not list)",CAPTION_PSEUDOATOM:"Pseudoatom",CAPTION_DUMMY_ATOM:"Dummy Atom",CAPTION_HETERO_ATOM:"Hetero Atom",CAPTION_ANY_ATOM:"Any Atom",CAPTION_ATOM:"Atom",CAPTION_SUBGROUP:"Subgroup",CAPTION_PERIODIC_TABLE_DIALOG:"Periodic table",CAPTION_PERIODIC_TABLE_DIALOG_SEL_ELEM:"Select element",CAPTION_PERIODIC_TABLE_DIALOG_SEL_ELEMS:"Select elements",CAPTION_TEXTBLOCK_INIT:"Enter text here",CAPTION_WIDTH:"Width",CAPTION_LENGTH:"Length",CAPTION_PATH_INDEX:"Path {0}",HINT_PATH_INDEX:"Path {0}",CAPTION_REACTION_ARROW_UNSET:"(Unset)",CAPTION_REACTION_ARROW_CUSTOM:"Custom",CAPTION_REACTION_ARROW_NORMAL:"Normal",CAPTION_REACTION_ARROW_RESONANCE:"Resonance",CAPTION_REACTION_ARROW_REVERSIBLE:"Reversible",CAPTION_REACTION_ARROW_RETROSYNTHESIS:"Retrosynthesis",HINT_REACTION_ARROW_UNSET:"Unset",HINT_REACTION_ARROW_CUSTOM:"Custom",HINT_REACTION_ARROW_NORMAL:"Normal arrow",HINT_REACTION_ARROW_RESONANCE:"Resonance arrow",HINT_REACTION_ARROW_REVERSIBLE:"Reversible arrow",HINT_REACTION_ARROW_RETROSYNTHESIS:"Retrosynthesis arrow",CAPTION_LINE_COUNT:"Line count",CAPTION_LINE_GAP:"Line gap",CAPTION_LINE:"Line",CAPTION_STARTING_ARROW:"Starting arrow",CAPTION_ENDING_ARROW:"Ending arrow",CAPTION_REACTION_ARROW_TYPE:"Reaction arrow type",CAPTION_ELECTRON_PUSHING_ARROW_TYPE:"Arrow type",CAPTION_OPPOSITE_ARROW_SIDES:"Opposite arrow sides",CAPTION_SAME_ARROW_SIDES:"Same arrow sides",CAPTION_ELECTRON_PUSHING_ARROW_1:"Single electron pushing arrow",CAPTION_ELECTRON_PUSHING_ARROW_1_ABBR:"Single",HINT_ELECTRON_PUSHING_ARROW_1:"Single electron pushing arrow",CAPTION_ELECTRON_PUSHING_ARROW_2:"Double electron pushing arrow",CAPTION_ELECTRON_PUSHING_ARROW_2_ABBR:"Double",HINT_ELECTRON_PUSHING_ARROW_2:"Double electron pushing arrow",CAPTION_BOND_FORMING_ELECTRON_PUSHING_ARROW_1:"Bond forming electron pushing arrow",HINT_BOND_FORMING_ELECTRON_PUSHING_ARROW_1:"Bond forming electron pushing arrow",LEGEND_CAPTION:"Legend",LEGEND_ELEM_SYMBOL:"Symbol",LEGEND_ELEM_NAME:"name",LEGEND_ATOMIC_NUM:"atomic number",LEGEND_ATOMIC_WEIGHT:"atomic weight",CAPTION_2D:"2D",CAPTION_3D:"3D",CAPTION_AUTOSIZE:"Autosize",CAPTION_AUTOFIT:"Autofit",CAPTION_SHOWSIZEINFO:"Show size info",CAPTION_LABEL_SIZE:"Size: ",CAPTION_BACKGROUND_COLOR:"Background color: ",CAPTION_WIDTH_HEIGHT:"width: {0}, height: {1}",PLACEHOLDER_WIDTH:"width",PLACEHOLDER_HEIGHT:"height",HINT_AUTOSIZE:"Whether graph size is determined by object automatically",HINT_AUTOFIT:"Whether object is zoomed to fullfill the whole graph",S_VALUE_DEFAULT:"(Default)"}),e.Localization.addResource("en","ErrorMsg",{WIDGET_CLASS_NOT_FOUND:"Widget class not found",WIDGET_CAN_NOT_BIND_TO_ELEM:"Widget {0} can not be binded to element <{1}>",LOAD_CHEMDATA_FAILED:"Failed to load data",FILE_API_NOT_SUPPORTED:"File operations are not supported by your current web browser. Please update it.",DRAW_BRIDGE_NOT_SUPPORTED:"It seems that your web browser is not modern enough to support the drawing function. Please update it.",COMMAND_NOT_REVERSIBLE:"Command can not be undone",PAGE_INDEX_OUTOF_RANGE:"Page index out of range",FETCH_DATA_TIMEOUT:"Time out to fetch data",RENDER_TYPE_CHANGE_NOT_ALLOWED:"It is not allowed to change render type",CAN_NOT_CREATE_EDITOR:"Creating editor failed",CAN_NOT_SET_COORD_OF_CLASS:"Can not set coordinate of instance of {0}.",CAN_NOT_SET_DIMENSION_OF_CLASS:"Can not set dimension of instance of {0}.",CAN_NOT_MERGE_CONNECTORS:"Specified connectors can not be merged.",NOT_A_VALID_ATOM:"Not a valid atom",INVALID_ATOM_SYMBOL:"Invalid atom symbol",INVALID_OR_EMPTY_IMAGE:"Image is empty or invalidate"}),e}},function(e,t){e.exports='<svg viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g stroke="none" stroke-width="1" fill-rule="evenodd" stroke-linecap="square"><path d="M17,4 L6,21" stroke-width="2" fill-rule="nonzero"></path></g></svg>'},function(e,t){e.exports='<svg viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><path d="M7.81235136,3.59047897 L9.81235136,3.59047897 L9.81235136,21.5768071 L7.81235136,21.5768071 L7.81235136,3.59047897 Z M12.8123514,3.59047897 L14.8123514,3.59047897 L14.8123514,21.5768071 L12.8123514,21.5768071 L12.8123514,3.59047897 Z" id="Combined-Shape-Copy" fill="#00758E" transform="translate(11.312351, 12.583643) rotate(28.000000) translate(-11.312351, -12.583643) "></path></g></svg>'},function(e,t){e.exports='<svg viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><path d="M5.51972034,3.76415788 L7.51972034,3.76415788 L7.51972034,21.750486 L5.51972034,21.750486 L5.51972034,3.76415788 Z M10.5197203,3.76415788 L12.5197203,3.76415788 L12.5197203,21.750486 L10.5197203,21.750486 L10.5197203,3.76415788 Z M15.5197203,3.76415788 L17.5197203,3.76415788 L17.5197203,21.750486 L15.5197203,21.750486 L15.5197203,3.76415788 Z" id="Combined-Shape" fill="#00758E" transform="translate(11.519720, 12.757322) rotate(28.000000) translate(-11.519720, -12.757322) "></path></g></svg>'},function(e,t){e.exports='<svg viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><polygon id="Triangle" fill="#00758E" points="4 23 11.5117902 1 19.8386314 5.36328658"></polygon></g></svg>'},function(e,t){e.exports='<svg viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><path d="M12.8691286,1 L20.5672724,5.03384746 L18.5233585,7.39289343 L11.8359469,3.88867227 L12.8691286,1 Z M11.1471591,5.81445379 L17.1607492,8.96559075 L15.1168353,11.3246367 L10.1139774,8.70312606 L11.1471591,5.81445379 Z M9.42518954,10.6289076 L13.754226,12.897334 L11.7103121,15.25638 L8.39200782,13.5175798 L9.42518954,10.6289076 Z M7.70322,15.4433614 L10.3477029,16.8290773 L8.30378899,19.1881233 L6.67003827,18.3320336 L7.70322,15.4433614 Z M5.98125045,20.2578151 L5,23.0012928 L6.94117972,20.7608206 L5.98125045,20.2578151 Z" id="Combined-Shape" fill="#00758E"></path></g></svg>'},function(e,t){e.exports='<svg viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M9.20339279,5.17457105 L7.07581979,5.17457105 L7.07581979,7.9941051 L4.22200792,7.9941051 L4.22200792,10.0961233 L7.07581979,10.0961233 L7.07581979,12.9156574 L9.20339279,12.9156574 L9.20339279,10.0961233 L12.0572047,10.0961233 L12.0572047,7.9941051 L9.20339279,7.9941051 L9.20339279,5.17457105 Z M8.18052115,0.920005336 C4.63839529,0.9671487 1.5291868,3.26074972 0.477038359,6.60271078 C-0.575110078,9.94467184 0.668747851,13.5760228 3.55886391,15.5998718 C6.44897996,17.6237208 10.3289994,17.5804453 13.1721347,15.4926508 L18.6649554,20.919496 L20.1072044,19.4945701 L14.6348412,14.0879368 C16.6281346,11.6527396 17.0185634,8.29920844 15.6369492,5.48047596 C14.2553349,2.66174349 11.3502548,0.884949991 8.18052115,0.920005336 Z M8.18052115,15.1490517 C4.79102272,15.1490517 2.04329133,12.434324 2.04329133,9.08553763 C2.04329133,5.73675128 4.79102272,3.02202355 8.18052115,3.02202355 C11.5700196,3.02202355 14.317751,5.73675128 14.317751,9.08553763 C14.317751,12.434324 11.5700196,15.1490517 8.18052115,15.1490517 Z" id="path-1"></path></defs><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g transform="translate(2.000000, 1.000000)"><mask id="mask-2" fill="white"><use xlink:href="#path-1"></use></mask><use id="Mask" fill="#00758E" fill-rule="nonzero" xlink:href="#path-1"></use><g mask="url(#mask-2)" fill="#00758E"><g transform="translate(-1.000000, -1.000000)" id="Rectangle-2"><rect x="0" y="0" width="22" height="23"></rect></g></g></g></g></svg>'},function(e,t){e.exports='<svg viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M6.08903461,9.16194272 L14.2720077,9.16194272 L14.2720077,11.207686 L6.08903461,11.207686 L6.08903461,9.16194272 Z M10.1805212,1.92001153 C6.63839529,1.96772803 3.5291868,4.28921296 2.47703836,7.67180312 C1.42488992,11.0543933 2.66874785,14.7298915 5.55886391,16.778345 C8.44897996,18.8267985 12.3289994,18.7829969 15.1721347,16.6698205 L20.6649554,22.1626412 L22.1072044,20.7203922 L16.6348412,15.248029 C18.6281346,12.7832265 19.0185634,9.38892555 17.6369492,6.535925 C16.2553349,3.68292445 13.3502548,1.88453001 10.1805212,1.92001153 Z M10.1805212,16.3220442 C6.79102272,16.3220442 4.04329133,13.5743128 4.04329133,10.1848144 C4.04329133,6.79531592 6.79102272,4.04758453 10.1805212,4.04758453 C13.5700196,4.04758453 16.317751,6.79531592 16.317751,10.1848144 C16.317751,13.5743128 13.5700196,16.3220442 10.1805212,16.3220442 Z" id="path-2"></path></defs><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><mask id="mask-3" fill="white"><use xlink:href="#path-2"></use></mask><use id="Mask" fill="#00758E" fill-rule="nonzero" xlink:href="#path-2"></use><g mask="url(#mask-3)" fill="#00758E"><g transform="translate(4.000000, 3.000000)" id="Rectangle-2"><rect x="0" y="0" width="21" height="22"></rect></g></g></g></svg>'},function(e,t){e.exports='<svg viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M12.6923076,10.2144866 C12.6923076,7.54642238 10.3631971,5.37604558 7.5,5.37604558 L7.5,8.60167292 L1.73076924,4.30083646 L7.5,5.68434189e-12 L7.5,3.22562735 C11.6353846,3.22562735 15,6.36097072 15,10.2144866 C15,14.0680361 11.6353846,17.2033458 7.5,17.2033458 C7.26179909,17.2033458 6.92723993,17.187739 6.49632252,17.1565255 L4.54514393,24 L2.49771443,23.4866612 C3.79962364,18.9142424 4.44271909,16.6151761 4.42700078,16.5894623 C1.81951259,15.493672 -3.7866685e-12,13.0482816 -3.97903932e-12,10.2144866 L2.3076923,10.2144866 C2.3076923,12.8825508 4.63680288,15.0529276 7.5,15.0529276 C10.3631971,15.0529276 12.6923076,12.8825508 12.6923076,10.2144866 Z" id="path-3"></path></defs><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="reset" transform="translate(12.142305, 11.629165) rotate(-60.000000) translate(-12.142305, -11.629165) translate(4.642305, -0.370835)"><mask id="mask-4" fill="white"><use xlink:href="#path-3"></use></mask><use id="Mask" fill="#00758E" xlink:href="#path-3"></use><g mask="url(#mask-4)" fill="#00758E"><g transform="translate(5.277568, 11.705771) rotate(-30.000000) translate(-5.277568, -11.705771) translate(-5.222432, 0.705771)" id="Rectangle-2"><rect x="0" y="0" width="21" height="22"></rect></g></g></g></g></svg>'},function(e,t){e.exports='<svg viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="undo" transform="translate(5.000000, 3.000000)" fill="#00758E"><path d="M7,14.875 C9.67231731,14.875 11.8461538,12.7302773 11.8461538,10.09375 C11.8461538,7.45722266 9.67231731,5.3125 7,5.3125 L7,8.5 L1.61538462,4.25 L7,0 L7,3.1875 C10.8596923,3.1875 14,6.2857832 14,10.09375 C14,13.90175 10.8596923,17 7,17 C3.14034135,17 0,13.90175 0,10.09375 L2.15384615,10.09375 C2.15384615,12.7302773 4.32768269,14.875 7,14.875 Z" id="Shape"></path></g></g></svg>'},function(e,t){e.exports='<svg viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><path d="M12.0000533,18.8749168 C9.32769113,18.8749168 7.15377786,16.7303885 7.15377786,14.0937073 C7.15377786,11.4571662 9.32769113,9.31246278 12.0000533,9.31246278 L12.0000533,12.4999825 L17.3847287,8.25002629 L12.0000533,4 L12.0000533,7.18751971 C8.14034158,7.18751971 5,10.2858374 5,14.0937424 C5,17.9018576 8.14034158,21 12.0000533,21 C15.859765,21 19,17.9018576 19,14.0937424 L16.8463642,14.0937424 C16.8463997,16.7303885 14.6724154,18.8749168 12.0000533,18.8749168 Z" id="Shape" fill="#00758E"></path></g></svg>'},function(e,t){e.exports='<svg viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="Arrow-Copy" transform="translate(4.000000, 8.000000)" stroke="#00758E"><path d="M0,3.31737688 C6.49870339,3.31737688 12.5514599,3.40141812 14.2130992,3.40141812 C16.2130992,3.40141812 15.9185143,3.40141812 15.9185143,3.40141812 L9.80492354,6.4631733 L15.9185143,3.40141812 L9.80492354,0" id="Path-4"></path></g></g></svg>'},function(e,t){e.exports='<svg viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><polyline id="Path-2" stroke="#00758E" points="10.1426197 14.381574 4 11.3409653 10.1426197 8"></polyline><path d="M4,11.3173769 C10.4987034,11.3173769 16.5514599,11.4014181 18.2130992,11.4014181 C20.2130992,11.4014181 19.9185143,11.4014181 19.9185143,11.4014181 L13.8049235,14.4631733 L19.9185143,11.4014181 L13.8049235,8" id="Path-4" stroke="#00758E"></path></g></svg>'},function(e,t){e.exports='<svg viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><path d="M4,10.705546 C10.4987034,10.705546 14.5788747,10.705546 16.240514,10.705546 C18.1968984,10.705546 19.1750906,10.705546 19.1750906,10.705546 C19.1750906,10.705546 17.7388484,9.80369733 14.8663638,8" id="Path-4" stroke="#00758E"></path><path d="M5,15.705546 C11.4987034,15.705546 15.5788747,15.705546 17.240514,15.705546 C19.1968984,15.705546 20.1750906,15.705546 20.1750906,15.705546 C20.1750906,15.705546 18.7388484,14.8036973 15.8663638,13" id="Path-4" stroke="#00758E" transform="translate(12.587545, 14.352773) scale(-1, -1) translate(-12.587545, -14.352773) "></path></g></svg>'},function(e,t){e.exports='<svg viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g transform="translate(4.000000, 8.000000)" fill-rule="nonzero" stroke="#00758E"><path d="M13.5,2 L0,2" id="Path"></path><path d="M13.5,5 L0,5" id="Path-2"></path><polyline id="Path-8" points="10 0 16 3.5 10 7"></polyline></g></g></svg>'},function(e,t){e.exports='<svg viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><polygon id="Triangle" stroke="#00758E" points="12 4 20 19 4 19"></polygon></g></svg>'},function(e,t){e.exports='<svg viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" font-family="PingFangSC-Semibold, PingFang SC" font-size="18" font-weight="500"><text id="+" fill="#00758E"><tspan x="7" y="18">+</tspan></text></g></svg>'},function(e,t){e.exports='<svg viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><polygon stroke="#00758E" points="12 3 19.7942286 7.5 19.7942286 16.5 12 21 4.20577137 16.5 4.20577137 7.5"></polygon><path d="M11.5410156,18.6914062 L17.1885156,15.6914062" stroke="#00758E" stroke-linecap="square" transform="translate(14.541016, 17.191406) rotate(-180.000000) translate(-14.541016, -17.191406) "></path><path d="M12.5410156,5.69140625 L17.5410156,8.69140625" stroke="#00758E" stroke-linecap="square" transform="translate(15.041016, 7.191406) rotate(-180.000000) translate(-15.041016, -7.191406) "></path><path d="M6.5,8.5 L6.5,15" stroke="#00758E" stroke-linecap="square"></path></g></svg>'},function(e,t){e.exports='<svg viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><polygon stroke="#00758E" points="12 3 19.7942286 7.5 19.7942286 16.5 12 21 4.20577137 16.5 4.20577137 7.5"></polygon><path d="M9.23,8.71 L10.25,8.71 L10.355,9.76 L10.4,9.76 C10.7500017,9.40999825 11.1174981,9.11750118 11.5025,8.8825 C11.8875019,8.64749883 12.3349974,8.53 12.845,8.53 C13.6150039,8.53 14.1774982,8.7699976 14.5325,9.25 C14.8875018,9.7300024 15.065,10.4399953 15.065,11.38 L15.065,16 L13.835,16 L13.835,11.545 C13.835,10.8549965 13.7250011,10.3575015 13.505,10.0525 C13.2849989,9.74749848 12.9350024,9.595 12.455,9.595 C12.0749981,9.595 11.7400014,9.68999905 11.45,9.88 C11.1599985,10.0700009 10.8300018,10.3499982 10.46,10.72 L10.46,16 L9.23,16 L9.23,8.71 Z" id="n" fill="#00758E"></path></g></svg>'},function(e,t){e.exports='<svg viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><polygon id="Triangle" stroke="#00758E" points="12 4 20 19 4 19"></polygon></g></svg>'},function(e,t){e.exports='<svg viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><rect id="Rectangle" stroke="#00758E" x="4.5" y="3.5" width="15" height="16"></rect></g></svg>'},function(e,t){e.exports='<svg viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><polygon id="Polygon" stroke="#00758E" points="12.5 3 20.5839804 9.21884705 17.4961746 19.2811529 7.50382536 19.2811529 4.41601961 9.21884705"></polygon></g></svg>'},function(e,t){e.exports='<svg viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><polygon id="Polygon-Copy" stroke="#00758E" points="12 3 19.7942286 7.5 19.7942286 16.5 12 21 4.20577137 16.5 4.20577137 7.5"></polygon></g></svg>'},function(e,t){e.exports='<svg viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" fill-opacity="0.5"><circle id="Oval-Copy-28" fill="#00758E" cx="8" cy="12" r="2.5"></circle></g></svg>'},function(e,t){e.exports='<svg viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" fill-opacity="0.5"><circle id="Oval-Copy-11" fill="#00758E" cx="8" cy="16" r="2.5"></circle><circle id="Oval-Copy-25" fill="#00758E" cx="16" cy="9" r="2.5"></circle></g></svg>'},function(e,t){e.exports='<svg viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" font-family="PingFangSC-Semibold, PingFang SC" font-size="18" font-weight="500"><text id="+" fill="#00758E"><tspan x="7" y="18">+</tspan></text></g></svg>'},function(e,t){e.exports='<svg viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" font-family="PingFangSC-Semibold, PingFang SC" font-size="18" font-weight="500"><text id="－" fill="#00758E"><tspan x="3" y="19">－</tspan></text></g></svg>'},function(e,t){e.exports='<svg viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g stroke-width="1" class="no-fill" fill="none" fill-rule="evenodd"><path d="M1,13.8449129 C3.64730613,9.9483043 7.08740669,8 11.3203017,8 C15.5531967,8 19.3090784,10.0689057 22.5879468,14.2067171 L21.2853296,12.7124572 L22.5622644,14.2067171 L22.0598134,9.12674916" id="Path-13"></path></g></svg>'},function(e,t){e.exports='<svg viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g class="no-fill" stroke-width="1" fill="none" fill-rule="evenodd"><path d="M1,13.8449129 C3.64730613,9.9483043 6.6406034,8 11.3203017,8 C16,8 22,14 22,15 L17,13 L22,15 L22,9" id="Path-11"></path></g></svg>'},function(e,t,r){"use strict";e.exports=function(e){return e.LOCAL_RES=!0,e.Localization.setCurrModule("objDefines"),e.OBJDEF_TEXTS={},e.Localization.addResource("en","OBJDEF_TEXTS",{TITLE_PREFIX:"TITLE_",DESCRIPTION_PREFIX:"DES_",DES_ID:"Unique ID for object.",Render:{GeneralConfigs:{TITLE_drawOpacity:"Opacity",DES_drawOpacity:"Opacity (between 0-1) to draw objects"},Render2DConfigs:{TITLE_generalConfigs:"General render settings",DES_generalConfigs:"General render settings",TITLE_moleculeDisplayConfigs:"Molecule display settings",DES_moleculeDisplayConfigs:"Settings about molecule display styles",TITLE_displayLabelConfigs:"Display label settings",DES_displayLabelConfigs:"Settings of displayed label in molecule/chem object",TITLE_textFontConfigs:"Text and font settings",DES_textFontConfigs:"Settings about text and font of display",TITLE_lengthConfigs:"Lengths settings",DES_lengthConfigs:"Lengths to display molecule/chem object",TITLE_colorConfigs:"Color settings",DES_colorConfigs:"Color settings to display molecule/chem object"},MoleculeDisplayConfigs:{TITLE_defMoleculeDisplayType:"Default molecule display mode",DES_defMoleculeDisplayType:"Default display type of molecule: in skeletal or in condensed mode",TITLE_defNodeDisplayMode:"Default atom display mode",DES_defNodeDisplayMode:"Default mode to display atom in molecule",TITLE_defHydrogenDisplayLevel:"Default hydrogen display level",DES_defHydrogenDisplayLevel:"How to display explicit or implicit hydrogens of atom",TITLE_defChargeMarkType:"Default charge mark type",DES_defChargeMarkType:null,TITLE_partialChargeDecimalsLength:"Decimal length of partial charge",DES_partialChargeDecimalsLength:"If an atom has a partical charge (e.g., +1.5), how many digits after decimal point should be displayed"},DisplayLabelConfigs:{TITLE_enableIsotopeAlias:"Enable isotope alias",DES_enableIsotopeAlias:"Whether isotope alias (e.g. D for 2H) is used to display atom label.",TITLE_unsetElement:"Unset element",DES_unsetElement:"Label for unset or unknown element",TITLE_dummyAtom:"Dummy atom",DES_dummyAtom:"Label for dummy atom",TITLE_heteroAtom:"Hetero atom",DES_heteroAtom:"Label for general hetero atom",TITLE_anyAtom:"Any atom",DES_anyAtom:"Label for atom wildcard",TITLE_variableAtom:"Variable atom",DES_variableAtom:"Label for variable atom or atom list",TITLE_rgroup:"RGroup",DES_rgroup:"Label for RGroup",TITLE_isoListLeadingBracket:"Atom list leading bracket",TITLE_isoListTailingBracket:"Atom list tailing bracket",TITLE_isoListDelimiter:"Atom delimiter in list",TITLE_isoListDisallowPrefix:"Prefix of not-atom list"},TextFontConfigs:{TITLE_labelFontFamily:"Label font",DES_labelFontFamily:"Font to draw general label",TITLE_atomFontFamily:"Atom font",DES_atomFontFamily:"Font to draw atom label",TITLE_supFontSizeRatio:"Superscript font size ratio",DES_supFontSizeRatio:"Ratio of Superscript text size to normal text size",TITLE_subFontSizeRatio:"Subscript font size ratio",DES_subFontSizeRatio:"Ratio of Subscript text size to normal text size",TITLE_superscriptOverhang:"Superscript text overhang",DES_superscriptOverhang:null,TITLE_subscriptOversink:"Subscript text oversink",DES_subscriptOversink:null,TITLE_textCharDirection:"Text direction",DES_textCharDirection:"Default text direction",TITLE_textHorizontalAlign:"Horizontal text alignment",DES_textHorizontalAlign:"Default horizontal text alignment of label",TITLE_textVerticalAlign:"Vertical text alignment",DES_textVerticalAlign:"Default vertical text alignment of label"},LengthConfigs:{TITLE_labelFontSize:"Label text size",DES_labelFontSize:"Size of general label text",TITLE_atomFontSize:"Atom text size",DES_atomFontSize:"Size of atom label text",TITLE_allenCenterAtomRadius:"Allen center radius",DES_allenCenterAtomRadius:"Radius to draw dot on center carbon atom in allen",TITLE_chargeMarkFontSize:"Charge mark size",DES_chargeMarkFontSize:"Font size of charge mark",TITLE_chargeMarkMargin:"Charge mark margin",DES_chargeMarkMargin:"Margin between charge mark and atom",TITLE_defBondLength:"Default bond length",DES_defBondLength:"Default length of a chemical bond",TITLE_bondLineWidth:"Bond line width",DES_bondLineWidth:"Line width to draw a chemical bond",TITLE_hashSpacing:"Hash spacing",DES_hashSpacing:"Spacing between small lines in hash bond",TITLE_multipleBondSpacingRatio:"Multiple bond spacing ratio",DES_multipleBondSpacingRatio:"Ratio of spacing between two lines in double or triple bond to bond length.",TITLE_multipleBondMaxAbsSpacing:"Max multiple bond spacing",DES_multipleBondMaxAbsSpacing:"Maximum spacing between multiple bond",TITLE_bondArrowLength:"Bond arrow length",DES_bondArrowLength:"The length of end triangle in arrow bond",TITLE_bondArrowWidth:"Bond arrow width",DES_bondArrowWidth:"The width of end triangle in arrow bond",TITLE_bondWedgeWidth:"Bond wedge max width",DES_bondWedgeWidth:"The width of ending point in wedge bond",TITLE_bondWedgeHashMinWidth:"Bond wedge min width",DES_bondWedgeHashMinWidth:"The width of starting point in wedge bond",TITLE_bondWavyRadius:"Bond wavy radius",DES_bondWavyRadius:"Radius to draw arc of wavy bond",TITLE_glyphStrokeWidth:"Glyph stroke width",DES_glyphStrokeWidth:"The default width of glyph strokes",TITLE_autofitContextPadding:"Autofit context padding",DES_autofitContextPadding:"Padding of autofit widget edge and drawn object"},ColorConfigs:{TITLE_useAtomSpecifiedColor:"Use element specified color",DES_useAtomSpecifiedColor:"Whether use different color on different element",TITLE_labelColor:"Label color",DES_labelColor:"Default color of general label",TITLE_atomColor:"Atom color",DES_atomColor:"Default color of atom label",TITLE_bondColor:"Bond color",DES_bondColor:"Default color of bond",TITLE_glyphStrokeColor:"Glyph stroke color",DES_glyphStrokeColor:"Default stroke color of glyph",TITLE_glyphFillColor:"Glyph fill color",DES_glyphFillColor:"Default fill color of glyph"},Render3DConfigs:{TITLE_generalConfigs:"General render settings",DES_generalConfigs:"General render settings",TITLE_moleculeDisplayConfigs:"Molecule display settings",DES_moleculeDisplayConfigs:"Settings about molecule display styles",TITLE_environmentConfigs:"3D environment settings",DES_environmentConfigs:"Settings of 3D environment",TITLE_modelConfigs:"3D model settings",DES_modelConfigs:"Settings to render a 3D molecule model",TITLE_lengthConfigs:"Lengths settings",DES_lengthConfigs:"Lengths to display molecule"},Render3DEnvironmentConfigs:{TITLE_graphicQuality:"Graphic quality",DES_graphicQuality:"Quality of 3D graphic"},Molecule3DDisplayConfigs:{TITLE_defMoleculeDisplayType:"Default molecule display type",DES_defMoleculeDisplayType:"Draw molecule in wire, stick, ball stick or space fill mode",TITLE_defBondSpliceMode:"Bond splice mode",DES_defBondSpliceMode:"How to draw a splice mode between two atoms with different color",TITLE_defDisplayMultipleBond:"Display multiple bond",DES_defDisplayMultipleBond:"Whether draw multiple bond lines for double or triple bond",TITLE_defBondColor:"Default bond color",DES_defBondColor:"Default bond color",TITLE_defAtomColor:"Default atom color",DES_defAtomColor:"Default atom color",TITLE_useAtomSpecifiedColor:"Use element specified color",DES_useAtomSpecifiedColor:"Whether use different color on different element"},Model3DConfigs:{TITLE_hideHydrogens:"Hide hydrogens",DES_hideHydrogens:"Whether hide all hydrogen atoms in 3D model",TITLE_useVdWRadius:"Use von dar Waals radius",DES_useVdWRadius:"Whether use atom's von dar Waals radius to draw 3D model",TITLE_multiConnectorRadiusRatio:"Multi-bond radius ratio",DES_multiConnectorRadiusRatio:"If use multi-cylinder for multibond, this value is the radius ratio between multi and single bond",TITLE_multiConnectorMarginRatio:"Multi-bond margin ratio",DES_multiConnectorMarginRatio:"If multi-cylinder is used for multibond, ratio of margin between cylinders and radius of cylinder"},Length3DConfigs:{TITLE_fixedNodeRadius:"Fixed atom radius",DES_fixedNodeRadius:"If vdW radius of atom is not used, this value will be used for all atom's radius",TITLE_connectorRadius:"Bond radius",DES_connectorRadius:"Bond will be draw based on this radius in stick or ball_stick mode",TITLE_connectorLineWidth:"Bond line width",DES_connectorLineWidth:"Bond will be draw on this width in wire mode"}},Widget:{BaseWidget:{TITLE_settingFacade:"General settings",DES_settingFacade:"General settings"}},ChemWidget:{ChemObjDisplayer:{TITLE_enableLoadNewFile:"Enable load data",DES_enableLoadNewFile:"Whether loading new data is enabled"},ChemObjDisplayerConfigs:{TITLE_ioConfigs:"I/O settings",DES_ioConfigs:"Settings of input/output"},ChemObjDisplayerIOConfigs:{TITLE_canonicalizeBeforeSave:"Canonicalize before save",DES_canonicalizeBeforeSave:"Whether canonicalize molecule before saving it"},Viewer:{TITLE_enableDirectInteraction:"Enable direct interaction",DES_enableDirectInteraction:"Whether interaction with chem object in viewer is enabled",TITLE_enableTouchInteraction:"Enable touch interaction",DES_enableTouchInteraction:"Whether touch interaction is enabled",TITLE_enableToolbar:"Enable toolbar",DES_enableToolbar:"Whether toolbar of viewer is displayed",TITLE_toolbarPos:"Toolbar Position",DES_toolbarPos:"Position of toolbar in viewer",TITLE_toolbarMarginHorizontal:"Toolbar horizontal margin",DES_toolbarMarginHorizontal:"Horizontal margin of toolbar to viewer edge",TITLE_toolbarMarginVertical:"Toolbar vertical margin",DES_toolbarMarginVertical:"Vertical margin of toolbar to viewer edge",TITLE_enableEdit:"Enable editing",DES_enableEdit:"Whether edit chem object in viewer is enabled",TITLE_modalEdit:"Modal editing",DES_modalEdit:"Using modal dialog or popup dialog to edit chem object"}},Editor:{BaseEditorConfigs:{TITLE_uiMarkerConfigs:"UI marker settings",DES_uiMarkerConfigs:"Settings of interaction marker",TITLE_interactionConfigs:"Interaction settings",DES_interactionConfigs:"Settings about interaction of editor",TITLE_structureConfigs:"Structure settings",DES_structureConfigs:"Settings about creating molecule structure"},ChemSpaceEditorConfigs:{TITLE_chemSpaceConfigs:"Chem space settings",DES_chemSpaceConfigs:"Settings about chem space/chem document",TITLE_styleSetterConfigs:"Style setter settings",DES_styleSetterConfigs:"Settings of style toolbar of editor"},InteractionConfigs:{TITLE_enableTrackOnNearest:"Enale track on nearest",DES_enableTrackOnNearest:"If setting to true, hot track or selection will focus on nearest object to current position, otherwise, the topmost object around will be focused.",TITLE_enableHotTrack:"Enable hot track",DES_enableHotTrack:"Whether highlighting objects under mouse position",TITLE_autoSelectNewlyInsertedObjects:"Auto select new inserted objects",DES_autoSelectNewlyInsertedObjects:"Whether select objects newly inserted or modified in editor automatically",TITLE_objBoundTrackMinInflation:"Object bound minimal inflation (default)",DES_objBoundTrackMinInflation:"The default minimal inflation of the bound of object to make it easier to select",TITLE_objBoundTrackMinInflationMouse:"Object bound minimal inflation (mouse)",DES_objBoundTrackMinInflationMouse:"The minimal inflation of the bound of object to make it easier to select when using mouse as pointer device",TITLE_objBoundTrackMinInflationTouch:"Object bound minimal inflation (touch)",DES_objBoundTrackMinInflationTouch:"The minimal inflation of the bound of object to make it easier to select when touching on screen",TITLE_objBoundTrackMinInflationPen:"Object bound minimal inflation (pen)",DES_objBoundTrackMinInflationPen:"The minimal inflation of the bound of object to make it easier to select when using pen as pointer device",TITLE_objBoundTrackInflationRatio:"Object bound inflation ratio (default)",DES_objBoundTrackInflationRatio:"The default inflation ratio (compaing with the default bond length) of the bound of object to make it easier to select",TITLE_objBoundTrackInflationRatioMouse:"Object bound inflation ratio (mouse)",DES_objBoundTrackInflationRatioMouse:"The inflation ratio (compaing with the default bond length) of the bound of object to make it easier to select when using mouse as pointer device",TITLE_objBoundTrackInflationRatioPen:"Object bound inflation ratio (pen)",DES_objBoundTrackInflationRatioPen:"The inflation ratio (compaing with the default bond length) of the bound of object to make it easier to select when using pen as pointer device",TITLE_objBoundTrackInflationRatioTouch:"Object bound inflation ratio (touch)",DES_objBoundTrackInflationRatioTouch:"The inflation ratio (compaing with the default bond length) of the bound of object to make it easier to select when touching on screen",TITLE_selectionMarkerInflation:"Selection marker inflation",DES_selectionMarkerInflation:"Inflation of object selection mark, makes it easier to see the containing objects",TITLE_selectionMarkerEdgeInflation:"Selection edge inflation",DES_selectionMarkerEdgeInflation:"Inflation when judging if a coord is on selection mark edge",TITLE_constrainedRotateStep:"Constrained rotation step",DES_constrainedRotateStep:"Constrained rotation step, in arc",TITLE_rotationLocationPointDistanceThreshold:"Rotation starting min distance",DES_rotationLocationPointDistanceThreshold:"Rotation will occur only when mouse point distance (from rotation center) larger than this value",TITLE_directedMoveDistanceThreshold:"Direct move min distance",DES_directedMoveDistanceThreshold:"Direct moving will only be done if moved distance large than this value",TITLE_enablePartialAreaSelecting:"Enable partial selecting",DES_enablePartialAreaSelecting:"If this value is true, when drag a selecting rubber band, object partly in the band will be totally selected",TITLE_selectingBrushWidth:"Brush selecting Width",DES_selectingBrushWidth:"Width of brush in brush selecting",TITLE_enableOffSelectionManipulation:"Enable off-selection manipulation",DES_enableOffSelectionManipulation:"When setting to true, you can still move, resize or rotate selected objects by holding mouse or touch outside selection for a while",TITLE_offSelectionManipulationActivatingTimeThreshold:"Off-selection manipulation hold time",DES_offSelectionManipulationActivatingTimeThreshold:"The minimal time (in ms) need for holding mouse or touch to invoke off-selection manipulation",TITLE_selectionMarkerDefPulseDuration:"Default selection mark pulse duration",DES_selectionMarkerDefPulseDuration:"The duration (in ms) of selection mark pulse when the selection is been emphasised",TITLE_selectionMarkerDefPulseCount:"Default selection mark pulse count",DES_selectionMarkerDefPulseCount:"The pulse count when the selection is been emphasised",TITLE_rotationRegionInflation:"Rotation region inflation",DES_rotationRegionInflation:"User can rotate the selected objects by pressing and move mouse in this inflated region outside selection",TITLE_enableMergePreview:"Enable merge preview",DES_enableMergePreview:"Whether a preview operation is used rather then the actual merge operation when merge two objects in editor during manipulation. Turn on this option may improve the performance of object manipulation.",TITLE_enableGestureManipulation:"Enable gesture manipulation",DES_enableGestureManipulation:"Whether user can use touch gestures (e.g. pinch) to scale or rotate selected objects in editor",TITLE_enableGestureZoomOnEditor:"Enable gesture zoom on editor",DES_enableGestureZoomOnEditor:"Whether user can use pinch gesture to zoom in or out the editor when there is no selection existed",TITLE_trackSimplifierDistanceThreshold:"Track-input curve simplification threshold",DES_trackSimplifierDistanceThreshold:"Distance threshold in simplifying curve drawn by track-input tool",TITLE_trackSimplifierIgnoreSegmentThreshold:"Track-input ignored segment threshold",DES_trackSimplifierIgnoreSegmentThreshold:"Segment length less than this threshold drawn by track-input will be ignored in parsing",TITLE_trackMergeDistanceThreshold:"Track-input merge distance threshold",DES_trackMergeDistanceThreshold:"If a joint or end point of line segment drawn by track-inpu tool is close to another line segment (less than this threshold), it will be regarded on that line.",TITLE_trackOptimizationAngleConstraint:"Track-input optimization line cross angle constraint",DES_trackOptimizationAngleConstraint:null,TITLE_trackOptimizationDistanceConstraints:"Track-input optimization line length constraint",DES_trackOptimizationDistanceConstraints:null,TITLE_trackOptimizationPrimaryDistanceConstraint:"Track-input optimization primary line length",DES_trackOptimizationPrimaryDistanceConstraint:null,TITLE_autoAdjustZoomLevelOnTrackTouching:null,DES_autoAdjustZoomLevelOnTrackTouching:null,TITLE_editorInitialZoom:"Editor initial zoom level",DES_editorInitialZoom:"The initial zoom level of editor",TITLE_atomSetterFontSize:"Atom setter font size",DES_atomSetterFontSize:"Font size of atom setter",TITLE_allowUnknownAtomSymbol:"Allow unknown atom symbol",DES_allowUnknownAtomSymbol:"Allow inputting unknown symbol and handle it as pseudo atom in atom setter",TITLE_clonedObjectScreenOffset:"Copied object coord offset",DES_clonedObjectScreenOffset:"The distance between copied objects and origin objects when doing paste selection action in editor"},UiMarkerConfigs:{TITLE_hotTrackerColor:"Hot track mark color",DES_hotTrackerColor:"Color of hot track mark",TITLE_hotTrackerOpacity:"Hot track mark opacity",DES_hotTrackerOpacity:"Opacity of hot track marker, value from 0 to 1",TITLE_selectionMarkerStrokeColor:"Selection mark stroke color",DES_selectionMarkerStrokeColor:"Stroke color of selection mark",TITLE_selectionMarkerStrokeWidth:"Selection mark stroke width",DES_selectionMarkerStrokeWidth:"Width of selection mark stroke",TITLE_selectionMarkerFillColor:"Selection mark fill color",DES_selectionMarkerFillColor:"Fill color of selection mark.",TITLE_selectionMarkerOpacity:"Selection mark opacity",DES_selectionMarkerOpacity:"Opacity of selection mark, value from 0 to 1",TITLE_selectionMarkerEmphasisOpacity:"Emphasised selection mark opacity",DES_selectionMarkerEmphasisOpacity:"Opacity of emphasised selection marker, value from 0 to 1",TITLE_selectingMarkerStrokeColor:"Selecting mark stroke color",DES_selectingMarkerStrokeColor:"Stroke color of selecting rubber band mark",TITLE_selectingMarkerStrokeWidth:"Selecting mark stroke width",DES_selectingMarkerStrokeWidth:"Stroke width of selection rubber band",TITLE_selectingMarkerStrokeDash:"Selecting mark dash style",DES_selectingMarkerStrokeDash:"Dash style of selecting rubber band",TITLE_selectingMarkerFillColor:"Selecting mark fill color",DES_selectingMarkerFillColor:"Fill color of selecting mark. Usually this value should be left blank (not filled)",TITLE_selectingMarkerOpacity:"Selecting mark opacity",DES_selectingMarkerOpacity:"Opacity of selecting mark, value from 0 to 1",TITLE_selectingBrushMarkerStrokeColor:"Brush selecting mark stroke color",DES_selectingBrushMarkerStrokeColor:"Stroke color of brush selecting mark",TITLE_selectingBrushMarkerStrokeDash:"Brush selecting mark dash style",DES_selectingBrushMarkerStrokeDash:"Dash style of brush selecting track",TITLE_selectingBrushMarkerStrokeLineCap:"Brushing selecting mark line-cap style",DES_selectingBrushMarkerStrokeLineCap:"Line-cap style of both ends of brush selecting track",TITLE_selectingBrushMarkerStrokeLineJoin:"Brushing selecting mark join point style",DES_selectingBrushMarkerStrokeLineJoin:"Join style of brush selection track segments",TITLE_selectingBrushMarkerOpacity:"Brush selecting mark opacity",DES_selectingBrushMarkerOpacity:"Opacity of brush selecting mark, value from 0 to 1",TITLE_trackMarkerStrokeColor:"Track-input mark stroke color",DES_trackMarkerStrokeColor:"Stroke color of track mark when using track-input tool to draw a structure",TITLE_trackMarkerStrokeWidth:"Track-input mark stroke width",DES_trackMarkerStrokeWidth:"Stroke width of track mark when using track-input tool to draw a structure",TITLE_trackMarkerStrokeDash:"Track-input mark dash style",DES_trackMarkerStrokeDash:"Dash style of track mark when using track-input tool to draw a structure",TITLE_trackMarkerOpacity:"Track-input mark opacity",DES_trackMarkerOpacity:"Opacity of track mark when using track-input tool to draw a structure",TITLE_flexStructureAssocMarkerColor:"Flex structure association mark color",DES_flexStructureAssocMarkerColor:"Color of mark showing atom count of flex ring/chain tool",TITLE_flexStructureAssocMarkerOpacity:"Flex structure association mark opacity",DES_flexStructureAssocMarkerOpacity:"Opacity of mark showing atom count of flex ring/chain tool",TITLE_flexStructureAssocMarkerFontSize:"Flex structure association mark font size",DES_flexStructureAssocMarkerFontSize:"Font size of mark showing atom count of flex ring/chain tool",TITLE_flexStructureAssocMarkerFontFamily:"Flex structure association mark font family",DES_flexStructureAssocMarkerFontFamily:"Font family of mark showing atom count of flex ring/chain tool"},StructureConfigs:{TITLE_defBondType:"Default bond type",DES_defBondType:"Default type of bond",TITLE_defBondOrder:"Default bond order",DES_defBondOrder:"Default bond order",TITLE_defBondLength:"Default bond length",DES_defBondLength:"Default bond length",TITLE_defIsotopeId:"Default isotope",DES_defIsotopeId:"Default isotope when adding a new atom",TITLE_maxFlexChainAtomCount:"Maximum flex chain atom count",DES_maxFlexChainAtomCount:"Maximum atom count when inputting with flex chain tool",TITLE_minFlexChainAtomCount:"Minimal flex chain atom count",DES_minFlexChainAtomCount:"Minimal atom count when inputting with flex chain tool",TITLE_maxFlexRingAtomCount:"Maximum flex ring atom count",DES_maxFlexRingAtomCount:"Maximum atom count when inputting with flex ring tool",TITLE_minFlexRingAtomCount:"Minimal flex ring atom count",DES_minFlexRingAtomCount:"Minimal atom count when inputting with flex ring tool",TITLE_enabledNonAtomNodeTypes:"Available non-atom structure node types",DES_enabledNonAtomNodeTypes:"Non-atom structure node types available in editor",TITLE_enabledBondForms:"Available bond forms",DES_enabledBondForms:"Bond forms available in editor"},ChemSpaceConfigs:{TITLE_defScreenSize2D:"Default 2D screen size",TITLE_defScreenSize3D:"Default 3D screen size",TITLE_defPadding:"Default padding",DES_defPadding:"Padding on top when adding an unpositioned object to container chem space"},BaseEditor:{TITLE_enableCreateNewDoc:"Enable create new document",DES_enableCreateNewDoc:"Whether creating a new document is allowed",TITLE_initOnNewDoc:"Starts with a new document",DES_initOnNewDoc:"Whether create a new document automatically when composer is initialized",TITLE_enableOperHistory:"Enable undo",DES_enableOperHistory:"Whether undo/redo is enabled"},Composer:{TITLE_enableStyleToolbar:"Enable style toolbar",DES_enableStyleToolbar:"Whether display style toolbar to set color, font and size of objects",TITLE_allowCreateNewChild:"Enable create new child object",DES_allowCreateNewChild:"Whether new direct child of document can be created"}}}),e}},function(e,t,r){"use strict";function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=r(0).Class,o=r(0).ClassEx,s=r(0).ObjectEx,l=r(0).DataType;e.exports=function(e){var t,r;if(e.PROP_AUTO_TITLE){var d=o.getPrototype(s).defineProp,u=function(t,r){if(!r.title&&!r.description){var i=this.getClassName();i.startsWith("Kekule.")&&(i=i.substr(7));var n="TITLE_"+t,a="DES_"+t,o=e.Localization.findValue("OBJDEF_TEXTS."+i+"."+n),s=e.Localization.findValue("OBJDEF_TEXTS."+i+"."+a);r.title=o,r.description=s}return d.apply(this,[t,r])};o.getPrototype(s).defineProp=u}e.ExceptionLevel={ERROR:-1,WARNING:-2,NOTE:-3,LOG:-4},e.throwException=function(t,r){if(e.exceptionHandler)return e.exceptionHandler.throwException(t,r);var i=e.ExceptionLevel;if(!r||r===i.ERROR)throw"string"==typeof t&&(t=new e.Exception(t)),t;if("undefined"!=typeof console){"string"!=typeof t&&(t=t.message);var n=r===i.WARNING?console.warn:r===i.NOTE?console.info:console.log;n?n(t):console.log(t)}},e.getExceptionMsg=function(e){return"string"==typeof e?e:"object"===(void 0===e?"undefined":n(e))?e.message:""},e.raise=e.throwException,e.error=function(t){return e.raise(t,e.ExceptionLevel.ERROR)},e.chemError=function(t){return"string"==typeof t&&(t=new e.ChemError(t)),e.error(t)},e.warn=function(t){return e.raise(t,e.ExceptionLevel.WARNING)},e.notify=function(t){return e.raise(t,e.ExceptionLevel.NOTE)},e.log=function(t){return e.raise(t,e.ExceptionLevel.LOG)},e.hasLocalRes=function(){return!!e.LOCAL_RES},e.globalOptions={add:function(t,r){var i=Object.getCascadeFieldValue(t,e.globalOptions);i&&l.isObjectValue(i)&&l.isObjectValue(r)?Object.extend(i,r):Object.setCascadeFieldValue(t,r,e.globalOptions,!0)}},e.HashEx=a.create({CLASS_NAME:"Kekule.HashEx",PROP_NAME_PREFIX:"__$key$__",initialize:function(){this._map={}},finalize:function(){this._map=null},keyToPropName:function(e){return this.PROP_NAME_PREFIX+e},has:function(e){return this._map.hasOwnProperty(this.keyToPropName(e))},set:function(e,t){return this._map[this.keyToPropName(e)]=t,this},get:function(e,t){var r=this.keyToPropName(e);return this._map.hasOwnProperty(r)?this._map[r]:t},remove:function(e){var t=this.keyToPropName(e);return this._map.hasOwnProperty(t)&&delete this._map[t],this},clear:function(){this._map={}}}),e.MapEx=a.create({CLASS_NAME:"Kekule.MapEx",initialize:function(t,r){this.isWeak=!t,e.MapEx._inited||e.MapEx._init();var i=t?e.MapEx._implementationNonWeak:e.MapEx._implementationWeak;i?this._implementation=new i:(this._keys=[],this._values=[]),r&&(this._cache={})},finalize:function($super){this._implementation||(this._keys=null,this._values=null,this._cache=null)},set:function(e,t){if(this._implementation)this._implementation.set(e,t);else{var r=this._keys.indexOf(e);r>=0?this._values[r]=t:(this._keys.push(e),this._values.push(t))}return this._cache&&this._cache.key===e&&(this._cache.value=t),this},get:function(e,t){if(this._cache&&this._cache.key===e)return this._cache.value;var r,i=!1;if(this._implementation)this._implementation.has(e)&&(r=this._implementation.get(e),i=!0);else{var n=this._keys.indexOf(e);n>=0&&(r=this._values[n],i=!0)}return i&&this._cache&&(this._cache.key=e,this._cache.value=r),i?r:t},has:function(e){return this._implementation?this._implementation.has(e):this._keys.indexOf(e)>=0},remove:function(e){if(this._cache&&this._cache.key===e&&(this._cache={}),this._implementation)return this._implementation[!this._implementation||"delete"](e);var t=this._keys.indexOf(e);return t>=0&&(this._keys.splice(t,1),this._values.splice(t,1)),this},clear:function(){return this._cache&&(this._cache={}),this._implementation&&!this._debug||(this._keys=[],this._values=[]),this._implementation&&(this.isWeak?e.error(e.$L("ErrorMsg.CANNOT_CLEAR_WEAKMAP")):this._implementation.clear()),this},getKeys:function(){if(this._implementation){if(this.isWeak)return e.error(e.$L("ErrorMsg.CANNOT_GET_KEY_LIST_IN_WEAKMAP")),[];var t,r=this._implementation.keys();if(Array.from)t=Array.from(r);else if(r.next){t=[];for(var i=r.next();!i.done;)t.push(i.value),i=r.next()}else{t=[];for(var n in r)t.push(n)}return t}return[].concat(this._keys)},getValues:function(){if(this._implementation){if(this.isWeak)return e.error(e.$L("ErrorMsg.CANNOT_GET_VALUE_LIST_IN_WEAKMAP")),[];var t,r=this._implementation.values();if(Array.from)t=Array.from(r);else if(r.next){t=[];for(var i=r.next();!i.done;)t.push(i.value),i=r.next()}else{t=[];for(var n in r)t.push(n)}return t}return this._values},getLength:function(){return this.getKeys().length}}),e.MapEx._init=function(){e.MapEx._implementationWeak=null,e.MapEx._implementationNonWeak=null,e.$jsRoot.WeakMap&&(e.MapEx._implementationWeak=e.$jsRoot.WeakMap),e.$jsRoot.Map&&e.$jsRoot.Map.prototype.keys&&(e.MapEx._implementationNonWeak=e.$jsRoot.Map),e.MapEx._inited=!0},e.MapEx._inited=!1,e.TwoTupleMapEx=a.create({CLASS_NAME:"Kekule.TwoTupleMapEx",initialize:function(t,r){this.nonWeak=t,this.map=new e.MapEx(t,r),r&&(this._level1Cache={})},finalize:function(){this._level1Cache=null,this.map.finalize()},getSecondLevelMap:function(t,r){if(t&&this._level1Cache&&t===this._level1Cache.key&&this._level1Cache.value)return this._level1Cache.value;var i=this.map.get(t);return!i&&r&&(i=new e.MapEx(this.nonWeak),this.map.set(t,i)),i},set:function(e,t,r){return this.getSecondLevelMap(e,!0).set(t,r),this},get:function(e,t,r){var i=this.getSecondLevelMap(e,!1);return i?i.get(t,r):r},has:function(e,t){var r=this.getSecondLevelMap(e,!1);return!!r&&r.has(t)},remove:function(e,t){var r=this.getSecondLevelMap(e,!1);if(r)return r.remove(t)},clear:function(){this.map.clear(),this._level1Cache&&(this._level1Cache={})}}),e.CoordMode={UNKNOWN:0,COORD2D:2,COORD3D:3},e.ClassDefineUtils={CommonSizeMethods:{getSizeOfMode:function(t,r){return t===e.CoordMode.COORD3D?this.getSize3D(r):this.getSize2D(r)},setSizeOfMode:function(t,r){return r===e.CoordMode.COORD3D?this.setSize3D(t):this.setSize2D(t)},getBoxOfMode:function(t,r){return t===e.CoordMode.COORD3D?this.getBox3D(r):this.getBox2D(r)}},Size2DMethods:{fetchSize2D:function(){var e=this.getPropStoreFieldValue("size2D");return e||(e={},this.setPropStoreFieldValue("size2D",e)),e},notifySize2DChanged:function(e){this.notifyPropSet("size2D",e)},hasSize2D:function(e){var t=this.getPropStoreFieldValue("size2D"),r=t&&(void 0!==t.x||void 0!==t.y);return!r&&e&&(r=!!this.hasSize3D&&this.hasSize3D()),r},getBox2D:function(t){var r=this.getCoord2D(t)||{x:0,y:0},i=this.getSize2D(t);if(i&&(i.x||i.y)){var n={x:i.x,y:-i.y},a=e.CoordUtils.add(r,n);return{x1:r.x,y1:r.y,x2:a.x,y2:a.y}}return{x1:r.x,y1:r.y,x2:r.x,y2:r.y}},get2DSizeX:function(e){var t=this.getSize2D(e);return t?t.x||0:0},set2DSizeX:function(e){var t=this.fetchSize2D();t.x!=e&&(t.x=e,this.notifySize2DChanged(t))},get2DSizeY:function(e){var t=this.getSize2D(e);return t?t.y||0:0},set2DSizeY:function(e){var t=this.fetchSize2D();t.y!=e&&(t.y=e,this.notifySize2DChanged(t))}},Size3DMethods:{fetchSize3D:function(){var e=this.getPropStoreFieldValue("size3D");return e||(e={},this.setPropStoreFieldValue("size3D",e)),e},notifySize3DChanged:function(e){this.notifyPropSet("size3D",e)},hasSize3D:function(e){var t=this.getPropStoreFieldValue("size3D"),r=t&&(void 0!==t.x||void 0!==t.y||void 0!==t.z);return!r&&e&&(r=!!this.hasSize2D&&this.hasSize2D()),r},getBox3D:function(t){var r=this.getCoord3D(t),i=this.getSize3D(t);if(r&&i){var n=e.CoordUtils.add(r,i);return{x1:r.x,y1:r.y,z1:r.z,x2:n.x,y2:n.y,z2:n.z}}},get3DSizeX:function(e){var t=this.getSize3D(e);return t?t.x||0:0},set3DSizeX:function(e){var t=this.fetchSize3D();t.x!=e&&(t.x=e,this.notifySize3DChanged(t))},get3DSizeY:function(e){var t=this.getSize3D(e);return t?t.y||0:0},set3DSizeY:function(e){var t=this.fetchSize3D();t.y!=e&&(t.y=e,this.notifySize3DChanged(t))},get3DSizeZ:function(e){var t=this.getSize3D(e);return t?t.z||0:0},set3DSizeZ:function(e){var t=this.fetchSize3D();t.z!=e&&(t.z=e,this.notifySize3DChanged(t))}},addStandardSizeSupport:function(t,r){o.extend(t,e.ClassDefineUtils.CommonSizeMethods),(!r||r.indexOf("size2D")>=0)&&(o.defineProp(t,"size2D",{dataType:l.HASH,getter:function(t,r){var i=this.getPropStoreFieldValue("size2D");!i&&t&&this.hasSize3D()&&(i=this.getSize3D()),!i&&r&&(i={x:0,y:0},this.setPropStoreFieldValue("size2D",i));var n=i?{x:i.x,y:i.y}:void 0;return n&&(n=e.CoordUtils.absValue(n)),n},setter:function(e){var t=this.fetchSize2D();void 0!==e.x&&(t.x=e.x),void 0!==e.y&&(t.y=e.y),this.notifySize2DChanged(t)}}),o.extend(t,e.ClassDefineUtils.Size2DMethods)),(!r||r.indexOf("size3D")>=0)&&(o.defineProp(t,"size3D",{dataType:l.HASH,getter:function(e,t){var r=this.getPropStoreFieldValue("size3D");return!r&&e&&this.hasSize2D()&&(r=this.getSize2D(),r.z=0),!r&&t&&(r={x:0,y:0,z:0},this.setPropStoreFieldValue("size3D",r)),r?{x:r.x,y:r.y,z:r.z}:void 0},setter:function(e){var t=this.fetchSize3D();void 0!==e.x&&(t.x=e.x),void 0!==e.y&&(t.y=e.y),void 0!==e.z&&(t.z=e.z),this.notifySize3DChanged(t)}}),o.extend(t,e.ClassDefineUtils.Size3DMethods))},CommonCoordMethods:{getCoordParent:function(e){return this.getParent&&this.getParent()||null},getCoordOfMode:function(t,r){return t===e.CoordMode.COORD3D?this.getCoord3D(r):this.getCoord2D(r)},setCoordOfMode:function(t,r){return r===e.CoordMode.COORD3D?this.setCoord3D(t):this.setCoord2D(t)},getAbsCoordOfMode:function(t,r){return t===e.CoordMode.COORD3D?this.getAbsCoord3D(r):this.getAbsCoord2D(r)},setAbsCoordOfMode:function(t,r){return r===e.CoordMode.COORD3D?this.setAbsCoord3D(t):this.setAbsCoord2D(t)},getIndirectCoordStorageOfMode:function(e){var t=this.getIndirectCoordStorage&&this.getIndirectCoordStorage();return t&&t[e]},setIndirectCoordStorageOfMode:function(e,t){var r=this.getIndirectCoordStorage&&this.getIndirectCoordStorage();return r&&(r[e]=t),this},calcIndirectCoordValue:function(t,r){var i=["x","y"];t===e.CoordMode.COORD3D&&i.push("z");var n=this.getIndirectCoordStorage()[t],a=this.getIndirectCoordRefCoords(t,r);e.ArrayUtils.isArray(a)&&(a=a[0]);var o=this.getIndirectCoordRefLengths(t,r);if(n&&a&&o){for(var s={},l=e.ObjUtils.notUnset,d=0,u=i.length;d<u;++d){var c=i[d],h=n[c],m=a[c],g=o[c];if(l(h)&&l(m)&&l(g)){var f;f=0===g?m:m+g*h,s[c]=f}}return s}return null},calcIndirectCoordStorage:function(t,r,i,n){var a=["x","y"];t===e.CoordMode.COORD3D&&a.push("z");var o=this.getIndirectCoordStorageOfMode(t),s=this.getIndirectCoordRefCoords(t,n);e.ArrayUtils.isArray(s)&&(s=s[0]);var l=this.getIndirectCoordRefLengths(t,n);if(o&&s&&l){for(var d={},u=e.ObjUtils.notUnset,c=0,h=a.length;c<h;++c){var m=a[c],g=r[m],f=s[m],p=l[m];if(!(u(g)&&u(f)&&u(p)))return null;var C;C=0!==p?(g-f)/p:1,d[m]=C}return d}return null},saveIndirectCoordValue:function(e,t,r,i){if(t){var n=this.calcIndirectCoordStorage(e,t,r,i);if(n)return this.setIndirectCoordStorageOfMode(e,n),n}return null},getIndirectCoordRefLengths:function(e,t){return null},getIndirectCoordRefCoords:function(e,t){return null}},Coord2DMethods:{fetchCoord2D:function(){var e=this.getPropStoreFieldValue("coord2D");return e||(e={},this.setPropStoreFieldValue("coord2D",e)),e},notifyCoord2DChanged:function(e){this.notifyPropSet("coord2D",e)},hasCoord2D:function(e){var t=this.getPropStoreFieldValue("coord2D"),r=t&&(void 0!==t.x||void 0!==t.y);return!r&&e&&(r=!!this.hasCoord3D&&this.hasCoord3D()),r},get2DX:function(e){var t=this.getCoord2D(e);return t?t.x||0:0},set2DX:function(e){var t=this.fetchCoord2D();t.x!=e&&(t.x=e,this.notifyCoord2DChanged(t))},get2DY:function(e){var t=this.getCoord2D(e);return t?t.y||0:0},set2DY:function(e){var t=this.fetchCoord2D();t.y!=e&&(t.y=e,this.notifyCoord2DChanged(t))}},Coord3DMethods:{fetchCoord3D:function(){var e=this.getPropStoreFieldValue("coord3D");return e||(e={},this.setPropStoreFieldValue("coord3D",e)),e},notifyCoord3DChanged:function(e){this.notifyPropSet("coord3D",e)},hasCoord3D:function(e){var t=this.getPropStoreFieldValue("coord3D"),r=t&&(void 0!==t.x||void 0!==t.y||void 0!==t.z);return!r&&e&&(r=!!this.hasCoord2D&&this.hasCoord2D()),r},get3DX:function(e){var t=this.getCoord3D(e);return t?t.x||0:0},set3DX:function(e){var t=this.fetchCoord3D();t.x!=e&&(t.x=e,this.notifyCoord3DChanged(t))},get3DY:function(e){var t=this.getCoord3D(e);return t?t.y||0:0},set3DY:function(e){var t=this.fetchCoord3D();t.y!=e&&(t.y=e,this.notifyCoord3DChanged(t))},get3DZ:function(e){var t=this.getCoord3D(e);return t?t.z||0:0},set3DZ:function(e){var t=this.fetchCoord3D();t.z!=e&&(t.z=e,this.notifyCoord3DChanged(t))}},addStandardCoordSupport:function(t,r){o.extend(t,e.ClassDefineUtils.CommonCoordMethods),(!r||r.indexOf("coord2D")>=0)&&(o.defineProp(t,"coord2D",{dataType:l.HASH,getter:function(t,r){if(this.getEnableIndirectCoord()){var i=this.calcIndirectCoordValue(e.CoordMode.COORD2D,t);if(i)return i}var n=this.getPropStoreFieldValue("coord2D");return!n&&t&&this.hasCoord3D()&&(n=this.getCoord3D()),!n&&r&&(n={x:0,y:0},this.setPropStoreFieldValue("coord2D",n)),n?{x:n.x,y:n.y}:void 0},setter:function(t){var r=this.fetchCoord2D();this.getEnableIndirectCoord()&&this.saveIndirectCoordValue(e.CoordMode.COORD2D,t,r),void 0!==t.x&&(r.x=t.x),void 0!==t.y&&(r.y=t.y),this.notifyCoord2DChanged(r)}}),o.extend(t,e.ClassDefineUtils.Coord2DMethods)),(!r||r.indexOf("coord3D")>=0)&&(o.defineProp(t,"coord3D",{dataType:l.HASH,getter:function(t,r){if(this.getEnableIndirectCoord()){var i=this.calcIndirectCoordValue(e.CoordMode.COORD2D,t);if(i)return i}var n=this.getPropStoreFieldValue("coord3D");return!n&&t&&this.hasCoord2D()&&(n=this.getCoord2D(),n.z=0),!n&&r&&(n={x:0,y:0,z:0},this.setPropStoreFieldValue("coord3D",n)),n?{x:n.x,y:n.y,z:n.z}:void 0},setter:function(t){var r=this.fetchCoord3D();this.getEnableIndirectCoord()&&this.saveIndirectCoordValue(e.CoordMode.COORD3D,t,r),void 0!==t.x&&(r.x=t.x),void 0!==t.y&&(r.y=t.y),void 0!==t.z&&(r.z=t.z),this.notifyCoord3DChanged(r)}}),o.extend(t,e.ClassDefineUtils.Coord3DMethods)),(!r||r.indexOf("absCoord2D")>=0)&&o.defineProp(t,"absCoord2D",{dataType:l.HASH,serializable:!1,getter:function(t){var r=this.getCoord2D(t)||{},i=this.getCoordParent(e.CoordMode.COORD2D);return i&&i.getAbsCoord2D?e.CoordUtils.add(r,i.getAbsCoord2D(t)||{}):{x:r.x,y:r.y}},setter:function(t,r){var i=t,n=this.getCoordParent(e.CoordMode.COORD2D);n&&n.getAbsCoord2D&&(i=e.CoordUtils.substract(t,n.getAbsCoord2D(r))),this.setCoord2D(i)}}),(!r||r.indexOf("absCoord3D")>=0)&&o.defineProp(t,"absCoord3D",{dataType:l.HASH,serializable:!1,getter:function(t){var r=this.getCoord3D(t)||{},i=this.getCoordParent(e.CoordMode.COORD3D);return i&&i.getAbsCoord3D?e.CoordUtils.add(r,i.getAbsCoord3D(t)||{}):{x:r.x,y:r.y,z:r.z}},setter:function(t,r){var i=t,n=this.getCoordParent(e.CoordMode.COORD2D);n&&n.getAbsCoord3D&&(i=e.CoordUtils.substract(t,n.getAbsCoord3D(r))),this.setCoord3D(i)}}),(!r||r.indexOf("enableIndirectCoord")>=0)&&o.defineProp(t,"enableIndirectCoord",{scope:a.PropertyScope.PUBLIC,dataType:l.BOOL,serializable:!0,setter:function(t){if(this.getPropStoreFieldValue("enableIndirectCoord")!=t){if(t){var r=this.getCoord2D(),i=this.getCoord3D();r&&this.saveIndirectCoordValue(e.CoordMode.COORD2D,r,r,!0),i&&this.saveIndirectCoordValue(e.CoordMode.COORD3D,i,i,!0)}this.setPropStoreFieldValue("enableIndirectCoord",t)}}}),(!r||r.indexOf("indirectCoordStorage")>=0)&&o.defineProp(t,"indirectCoordStorage",{dataType:l.HASH,serializable:function(){return!!this.getEnableIndirectCoord()},setter:null,getter:function(){var t=this.getPropStoreFieldValue("indirectCoordStorage");return t||(t={},t[e.CoordMode.COORD2D]={},t[e.CoordMode.COORD3D]={},this.setPropStoreFieldValue("indirectCoordStorage",t)),t}})},ExtraObjMapMethods:{getExtraProp:function(e,t){var r=this.getExtraObjMap().get(e);return r?t?r[t]:r:void 0},setExtraProp:function(e,t,r){var i=this.getExtraProp(e);if(i)i[t]=r;else{var i={};i[t]=r,this.getExtraObjMap().set(e,i)}},removeExtraProp:function(e,t){if(t){var r=this.getExtraProp(e);r[t]=void 0,delete r[t]}else this.getExtraObjMap().remove(e)}},addExtraObjMapSupport:function(t){o.defineProp(t,"extraObjMap",{dataType:"Kekule.MapEx",serializable:!1,getter:function(){var t=this.getPropStoreFieldValue("extraObjMap");return t||(t=new e.MapEx(!0,!0),this.setPropStoreFieldValue("extraObjMap",t)),t}}),o.extend(t,e.ClassDefineUtils.ExtraObjMapMethods)},ExtraTwoTupleObjMapMethods:{getExtraProp2:function(e,t,r){var i=(this.__$__k__extraTwoTupleObjMap__$__||this.getExtraTwoTupleObjMap()).get(e,t);return i?r?i[r]:i:void 0},setExtraProp2:function(e,t,r,i){var n=this.getExtraProp2(e,t);if(n)n[r]=i;else{var n={};n[r]=i,(this.__$__k__extraTwoTupleObjMap__$__||this.getExtraTwoTupleObjMap()).set(e,t,n)}},removeExtraProp2:function(e,t,r){if(r){var i=this.getExtraProp2(e,t);i[r]=void 0,delete i[r]}else this.getExtraTwoTupleObjMap().remove(e,t)}},addExtraTwoTupleObjMapSupport:function(t){var r="extraTwoTupleObjMap";o.defineProp(t,r,{dataType:"Kekule.TwoTupleMapEx",serializable:!1,getter:function(){var t=this.getPropStoreFieldValue(r);return t||(t=new e.TwoTupleMapEx(!0,!0),this.setPropStoreFieldValue(r,t),this.__$__k__extraTwoTupleObjMap__$__=t),t}}),o.extend(t,e.ClassDefineUtils.ExtraTwoTupleObjMapMethods)}},e.ObjPropSettingManager={_items:new e.MapEx(!0),register:function(t,r){e.ObjPropSettingManager._items.set(t,r)},unregister:function(t){e.ObjPropSettingManager._items.remove(t)},getSetting:function(t){return e.ObjPropSettingManager._items.get(t)}},o.defineProp(s,"predefinedSetting",{dataType:l.STRING,scope:a.PropertyScope.PUBLIC,setter:function(t){var r=e.StrUtils.splitTokens(t||"",",");if(r.length){for(var i=0,n=r.length;i<n;++i){for(var a=this.getClass(),s=r[i],l=null,d="";a&&!l;){var u=o.getClassName(a),d=u+"."+s,l=e.ObjPropSettingManager.getSetting(d);a=o.getSuperClass(a)}l||(l=e.ObjPropSettingManager.getSetting(s)),l&&this.setPropValues(l)}this.setPropStoreFieldValue("predefinedSetting",d)}}}),e.ObjectTreeOperation={MODIFY:0,ADD:1,REMOVE:2},e.ChemObjInteractMode={DEFAULT:0,UNMOVABLE:1,UNSELECTABLE:2,HIDDEN:3},e.ComparisonMethod={DEFAULT:0,PROPERTIES:1,CHEM_STRUCTURE:10},e.ObjComparer={equal:function(t,r,i){return 0===e.ObjComparer.compare(t,r,i)},compare:function(t,r,i){return e.ObjComparer._compareValue(t,r,i)},_compareValue:function(t,r,i){var n=l;if(t===r)return 0;if(t<r&&!(t>r))return-1;if(t>r&&!(t<r))return 1;var a=null,o=n.getType(t),s=n.getType(r);if(o!==s){var d=[n.UNKNOWN,n.VARIANT,n.UNDEFINED,n.BOOL,n.NUMBER,n.INT,n.FLOAT,n.STRING,n.ARRAY,n.FUNCTION,n.DATE,n.OBJECT,n.OBJECTEX,n.CLASS],u=d.indexOf(o),c=d.indexOf(s);a=u<0&&c<0?null:u-c}else if(!t&&r)a=-1;else if(t&&!r)a=1;else if(t.doCompare)a=t.doCompare(r,i);else if(r.doCompare)a=-r.doCompare(t,i);else if(o===l.ARRAY){if(!(a=t.length-r.length))for(var h=0,m=t.length;h<m&&!(a=e.ObjComparer._compareValue(t[h],r[h],i));++h);}else if(o===l.OBJECT){var g=JSON.toString(t),f=JSON.toString(r);a=g<f?-1:g>f?1:0}else a=null;if(null===a){var g=t.toString&&t.toString()||"",f=r.toString&&r.toString()||"";a=g<f?-1:g>f?1:null,null===a&&(a=-1)}return a}};return e.ChemObject=a.create(s,(t={CLASS_NAME:"Kekule.ChemObject",initialize:function($super,e){$super(),e&&this.setId(e),this.setBubbleEvent(!0),this.__load_owner_objRef_props__=null,this.__load_parent_objRef_props__=null,this.addEventListener("change",function(e){var t=this.getPropStoreFieldValue("srcInfo");if(t&&t.data){for(var r=e.target,i=e.changedPropNames,n=!1,a=0,o=i.length;a<o;++a){var s=i[a];if(s&&"srcInfo"!==s&&r.isPropertySerializable(s)){n=!0;break}if("[children]"===s){n=!0;break}}n&&(t.data=null)}},this)},doFinalize:function($super){this.__load_owner_objRef_props__=null,this.__load_parent_objRef_props__=null,this.setPropStoreFieldValue("attachedCoordStickNodes",null),this.removeSelf(),$super()},initProperties:function(){this.defineProp("id",{dataType:l.STRING}),this.defineProp("interactMode",{dataType:l.INT,enumSource:e.ChemObjInteractMode}),this.defineProp("info",{dataType:l.HASH,getter:function(e){var t=this.getPropStoreFieldValue("info");return!t&&e&&(t={},this.setPropStoreFieldValue("info",t)),t}}),this.defineProp("attachedArcNodeIds",{dataType:l.HASH,getter:function(){var e=this.getPropStoreFieldValue("attachedArcNodeIds");return e||(e={},this.setPropStoreFieldValue("attachedArcNodeIds",e)),e}}),this.defineProp("scalarAttribs",{dataType:l.ARRAY,setter:null}),this.defineProp("parent",{dataType:"Kekule.ChemObject",serializable:!1,scope:a.PropertyScope.PUBLIC,setter:function(e){var t=this.getParent();t!==e&&(t&&t._removeChildObj&&(t._removeChildObj(this),this.invokeEvent("removeFromObjTree",{obj:this,parent:t})),this.setPropStoreFieldValue("parent",e),e&&e._appendChildObj&&(e._appendChildObj(this),this.invokeEvent("addToObjTree",{obj:this,parent:e})),this.parentChanged(e,t))}}),this.defineProp("owner",{dataType:"Kekule.ChemSpace",serializable:!1,scope:a.PropertyScope.PUBLIC,setter:function(e){var t=this.getOwner();t!==e&&(t&&(t._removeOwnedObj(this),this.invokeEvent("removeFromSpace",{obj:this,owner:t})),this.setPropStoreFieldValue("owner",e),e&&(e._appendOwnedObj(this),this.invokeEvent("addToSpace",{obj:this,owner:t})),this.ownerChanged(e,t))}}),this.defineProp("srcInfo",{dataType:l.OBJECT,serializable:!1,scope:a.PropertyScope.PUBLISHED,getter:function(){var e=this.getPropStoreFieldValue("srcInfo");return e||(e={},this.setPropStoreFieldValue("srcInfo",e)),e}}),this.defineProp("isEditing",{dataType:l.BOOL,serializable:!1,scope:a.PropertyScope.PUBLIC,getter:function(){var e=this.getOwner();return e&&e.getIsEditing?e.getIsEditing():this.getPropStoreFieldValue("isEditing")}}),this.defineProp("attachedCoordStickNodes",{dataType:l.ARRAY,serializable:!1,getter:function(){var e=this.getPropStoreFieldValue("attachedCoordStickNodes");return e||(e=[],this.setPropStoreFieldValue("attachedCoordStickNodes",e)),e}})},initPropValues:function($super){$super(),this.setEnableObjectChangeEvent(!0)},getHigherLevelObj:function(){return this.getParent()||this.getOwner()},getAutoIdPrefix:function(){return"o"},_parentObjectLoaded:function(e){this._handleObjRefProps(e,this.__load_parent_objRef_props__)},_ownerObjectLoaded:function(e){this._handleObjRefProps(e,this.__load_owner_objRef_props__)},_handleObjRefProps:function(t,r){var i=r;if(i&&t&&t.getChildAtIndexStack)for(var n=e.ObjUtils.getOwnedFieldNames(i),a=0,o=n.length;a<o;++a){var s=n[a],d=i[s];if(l.isArrayValue(d)){for(var u=[],a=0,o=d.length;a<o;++a){var c=this._doUnwrapObjRefSerializationStr(this,d[a]);if(c){var h=t.getChildAtIndexStack(c);u.push(h)}else u.push(void 0)}this.setPropValue(s,u)}else{var m,c=this._doUnwrapObjRefSerializationStr(this,d);c&&(m=t.getChildAtIndexStack(c)),m&&this.setPropValue(s,m)}try{delete i[s]}catch(e){}}},doSaveProp:function(t,r,i,n){if(r.serializable&&t._doGetObjRefSerializationValue){if(!!r.objRef){var a="parent"===r.objRefRoot,o=a?t.getParent():t.getOwner();if(o){var s=t.getPropValue(r.name);if(s){if(e.ArrayUtils.isArray(s)){for(var l=[],d=0,u=s.length;d<u;++d){var c=t._doGetObjRefSerializationValue(o,t,s[d]);c?l.push(c):l.push(s[d])}return n.doSaveFieldValue(t,r.name,l,i,n.getValueExplicitType(l)),!0}var h=t._doGetObjRefSerializationValue(o,t,s);if(h)return n.doSaveFieldValue(t,r.name,h,i,n.getValueExplicitType(h)),!0}}}}},_doGetObjRefSerializationValue:function(e,t,r){var i=e.indexStackOfChild(r);if(i&&i.length){return"@"+JSON.stringify(i)}return null},doLoadProp:function(e,t,r,i){if(t.serializable){if(!!t.objRef){var n="parent"===t.objRefRoot,a=n?e.__load_parent_objRef_props__:e.__load_owner_objRef_props__;a||(a={},n?e.__load_parent_objRef_props__=a:e.__load_owner_objRef_props__=a);var o=i.doLoadFieldValue(e,t.name,r);if(o){if("string"==typeof o&&o.startsWith("@"))return a[t.name]=o,!0;if(l.isArrayValue(o))return a[t.name]=o,!0}}}},_doUnwrapObjRefSerializationStr:function(t,r){try{var i=r.substr(1),n=JSON.parse(i);return l.isArrayValue(n)?n:null}catch(t){e.error(t)}},loaded:function($super){$super(),this.notifyParentLoaded()},notifyParentLoaded:function(){for(var e=0,t=this.getChildCount();e<t;++e){var r=this.getChildAt(e);r&&r._parentObjectLoaded&&r._parentObjectLoaded(this)}},isObjRefProperty:function(e){return!(!e||!e.objRef)},notifyPropSet:function($super,e,t,r){$super(e,t,r);var i=this.getPropInfo(e);if(i&&this.isObjRefProperty(i)){var n=this.getOwner();n&&n.modifyObjRefRelation&&n.modifyObjRefRelation(this,i,this.getPropValue(i.name))}},getObjRefProperties:function(){for(var e=[],t=this.getAllPropList(),r=0,i=t.getLength();r<i;++r){var n=t.getPropInfoAt(r);this.isObjRefProperty(n)&&e.push(n)}return e},_registerObjRefRelations:function(e){if(e&&e.modifyObjRefRelation){var t=this.getObjRefProperties();if(t.length)for(var r=0,i=t.length;r<i;++r){var n=t[r],a=this.getPropValue(n.name);e.modifyObjRefRelation(this,n,a)}}},_unregisterObjRefRelations:function(e){if(e&&e.releaseObjRefRelation){var t=this.getObjRefProperties();if(t.length)for(var r=0,i=t.length;r<i;++r){var n=t[r];e.releaseObjRefRelation(this,n)}}},isSelectable:function(){var t=e.ChemObjInteractMode;return!((this.getInteractMode()||t.DEFAULT)&t.UNSELECTABLE)},isMovable:function(){var t=e.ChemObjInteractMode;return!((this.getInteractMode()||t.DEFAULT)&t.UNMOVABLE)},getNearestSelectableObject:function(){return this.isSelectable()?this:this.getParent()?this.getParent().getNearestSelectableObject():null},getNearestMovableObject:function(){return this.isMovable()?this:this.getParent()?this.getParent().getNearestMovableObject():null},getNearestAncestorOfType:function(e){var t=this.getParent();return t?t instanceof e?t:t.getNearestAncestorOfType?t.getNearestAncestorOfType(e):null:null},removeSelf:function(){this.setParent(null),this.setOwner(null)},notifyScalarAttribsChange:function(){this.notifyPropSet("scalarAttribs",this.getPropStoreFieldValue("scalarAttribs"))},notifyInfoChange:function(){this.notifyPropSet("info",this.getPropStoreFieldValue("info"))},_removeChildObj:function(t){this._notifyOwnerObjTreeOperation(t,this,e.ObjectTreeOperation.REMOVE)},_appendChildObj:function(t){this._notifyOwnerObjTreeOperation(t,this,e.ObjectTreeOperation.ADD)},_notifyOwnerObjTreeOperation:function(e,t,r){var i=this.getOwner();i&&i._notifyObjTreeOperation&&i._notifyObjTreeOperation(e,t,r)},objTreeOfOwnerUpdated:function(e,t,r){},objSpaceOfOwnerUpdated:function(e,t,r){},ownerChanged:function(e,t){if(prop.serializable){if(!!prop.objRef){var r="parent"===prop.objRefRoot,i=r?obj.__load_parent_objRef_props__:obj.__load_owner_objRef_props__;i||(i={},r?obj.__load_parent_objRef_props__=i:obj.__load_owner_objRef_props__=i);var n=serializer.doLoadFieldValue(obj,prop.name,storageNode);if(n){if("string"==typeof n&&n.startsWith("@"))return i[prop.name]=n,!0;if(l.isArrayValue(n))return i[prop.name]=n,!0}}}}},i(t,"_doUnwrapObjRefSerializationStr",function(t,r){try{var i=r.substr(1),n=JSON.parse(i);return l.isArrayValue(n)?n:null}catch(t){e.error(t)}}),i(t,"loaded",function($super){$super(),this.notifyParentLoaded()}),i(t,"notifyParentLoaded",function(){for(var e=0,t=this.getChildCount();e<t;++e){var r=this.getChildAt(e);r&&r._parentObjectLoaded&&r._parentObjectLoaded(this)}}),i(t,"isObjRefProperty",function(e){return!(!e||!e.objRef)}),i(t,"notifyPropSet",function($super,e,t,r){$super(e,t,r);var i=this.getPropInfo(e);if(i&&this.isObjRefProperty(i)){var n=this.getOwner();n&&n.modifyObjRefRelation&&n.modifyObjRefRelation(this,i,this.getPropValue(i.name))}}),i(t,"getObjRefProperties",function(){for(var e=[],t=this.getAllPropList(),r=0,i=t.getLength();r<i;++r){var n=t.getPropInfoAt(r);this.isObjRefProperty(n)&&e.push(n)}return e}),i(t,"_registerObjRefRelations",function(e){if(e&&e.modifyObjRefRelation){var t=this.getObjRefProperties();if(t.length)for(var r=0,i=t.length;r<i;++r){var n=t[r],a=this.getPropValue(n.name);e.modifyObjRefRelation(this,n,a)}}}),i(t,"_unregisterObjRefRelations",function(e){if(e&&e.releaseObjRefRelation){var t=this.getObjRefProperties();if(t.length)for(var r=0,i=t.length;r<i;++r){var n=t[r];e.releaseObjRefRelation(this,n)}}}),i(t,"isSelectable",function(){var t=e.ChemObjInteractMode;return!((this.getInteractMode()||t.DEFAULT)&t.UNSELECTABLE)}),i(t,"isMovable",function(){var t=e.ChemObjInteractMode;return!((this.getInteractMode()||t.DEFAULT)&t.UNMOVABLE)}),i(t,"getNearestSelectableObject",function(){return this.isSelectable()?this:this.getParent()?this.getParent().getNearestSelectableObject():null}),i(t,"getNearestMovableObject",function(){return this.isMovable()?this:this.getParent()?this.getParent().getNearestMovableObject():null}),i(t,"getNearestAncestorOfType",function(e){var t=this.getParent();return t?t instanceof e?t:t.getNearestAncestorOfType?t.getNearestAncestorOfType(e):null:null}),i(t,"removeSelf",function(){this.setParent(null),this.setOwner(null)}),i(t,"notifyScalarAttribsChange",function(){this.notifyPropSet("scalarAttribs",this.getPropStoreFieldValue("scalarAttribs"))}),i(t,"notifyInfoChange",function(){this.notifyPropSet("info",this.getPropStoreFieldValue("info"))}),i(t,"_removeChildObj",function(t){this._notifyOwnerObjTreeOperation(t,this,e.ObjectTreeOperation.REMOVE)}),i(t,"_appendChildObj",function(t){this._notifyOwnerObjTreeOperation(t,this,e.ObjectTreeOperation.ADD)}),i(t,"_notifyOwnerObjTreeOperation",function(e,t,r){var i=this.getOwner();i&&i._notifyObjTreeOperation&&i._notifyObjTreeOperation(e,t,r)}),i(t,"objTreeOfOwnerUpdated",function(e,t,r){}),i(t,"objSpaceOfOwnerUpdated",function(e,t,r){}),i(t,"ownerChanged",function(e,t){for(var r=0,i=this.getScalarAttribCount();r<i;++r)this.getScalarAttribAt(r).setOwner(e);for(var r=0,i=this.getChildCount();r<i;++r){var n=this.getChildAt(r);n&&n.setOwner&&n.setOwner(e)}}),i(t,"parentChanged",function(e,t){}),i(t,"getParentList",function(){var e=[],t=this.getParent();return t&&(t.getParentList&&(e=t.getParentList()||[]),e.unshift(t)),e}),i(t,"isChildOf",function(e){for(var t=this.getParent();t&&t!==e;)t=t.getParent?t.getParent():null;return!!t}),i(t,"getNextSibling",function(){var e=this.getParent();return e&&e.getNextSiblingOfChild?e.getNextSiblingOfChild(this):null}),i(t,"isSiblingWith",function(e){var t=this.getParent(),r=e.getParent&&e.getParent();return t&&r&&t===r}),i(t,"getChildHolder",function(){return this}),i(t,"getChildSubgroupNames",function(){return[]}),i(t,"getBelongChildSubGroupName",function(e){return null}),i(t,"_getPrevSubgroupChildrenCount",function(e){for(var t=this.getChildSubgroupNames(),r=0,i=0,n=t.length;i<n;++i){if(t[i]===e)return r;var a=this._getSubGroupChildCountMethod(t[i]);r+=a&&a.apply(this)||0}return r}),i(t,"_getSubgroupChildIndexInfoFromChildIndex",function(e){for(var t=this.getChildSubgroupNames(),r=0,i=0,n=t.length;i<n;++i){var a=this._getSubGroupChildCountMethod(t[i]),o=a&&a.apply(this)||0;if(e<r+o)return{name:t[i],index:e-r};r+=o}return null}),i(t,"_getSubGroupChildCountMethod",function(e){return this["get"+e.upperFirst()+"Count"]}),i(t,"_getSubGroupChildAtMethod",function(e){return this["get"+e.upperFirst()+"At"]}),i(t,"_getSubGroupChildIndexOfMethod",function(e){return this["indexOf"+e.upperFirst()]}),i(t,"_getSubGroupChildRemoveMethod",function(e){return this["remove"+e.upperFirst()]}),i(t,"_getSubGroupChildRemoveAtMethod",function(e){return this["remove"+e.upperFirst()+"At"]}),i(t,"getParentList",function(){var e=[],t=this.getParent();return t&&(t.getParentList&&(e=t.getParentList()||[]),e.unshift(t)),e}),i(t,"isChildOf",function(e){for(var t=this.getParent();t&&t!==e;)t=t.getParent?t.getParent():null;return!!t}),i(t,"getNextSibling",function(){var e=this.getParent();return e&&e.getNextSiblingOfChild?e.getNextSiblingOfChild(this):null}),i(t,"isSiblingWith",function(e){var t=this.getParent(),r=e.getParent&&e.getParent();return t&&r&&t===r}),i(t,"getChildHolder",function(){return this}),i(t,"getChildSubgroupNames",function(){return[]}),i(t,"getBelongChildSubGroupName",function(e){return null}),i(t,"_getPrevSubgroupChildrenCount",function(e){for(var t=this.getChildSubgroupNames(),r=0,i=0,n=t.length;i<n;++i){if(t[i]===e)return r;var a=this._getSubGroupChildCountMethod(t[i]);r+=a&&a.apply(this)||0}return r}),i(t,"_getSubgroupChildIndexInfoFromChildIndex",function(e){for(var t=this.getChildSubgroupNames(),r=0,i=0,n=t.length;i<n;++i){var a=this._getSubGroupChildCountMethod(t[i]),o=a&&a.apply(this)||0;if(e<r+o)return{name:t[i],index:e-r};r+=o}return null}),i(t,"_getSubGroupChildCountMethod",function(e){return this["get"+e.upperFirst()+"Count"]}),i(t,"_getSubGroupChildAtMethod",function(e){return this["get"+e.upperFirst()+"At"]}),i(t,"_getSubGroupChildIndexOfMethod",function(e){return this["indexOf"+e.upperFirst()]}),i(t,"_getSubGroupChildRemoveMethod",function(e){return this["remove"+e.upperFirst()]}),i(t,"_getSubGroupChildRemoveAtMethod",function(e){return this["remove"+e.upperFirst()+"At"]}),i(t,"_getSubGroupChildAppendMethod",function(e){return this["append"+e.upperFirst()]}),i(t,"_getSubGroupChildInsertBeforeMethod",function(e){return this["insert"+e.upperFirst()+"Before"]}),i(t,"_getSubGroupChildInsertAtMethod",function(e){return this["insert"+e.upperFirst()+"At"]}),i(t,"_ensureSubGroupChildMethodsExist",function(){for(var t=["_getSubGroupChildCountMethod","_getSubGroupChildAtMethod","_getSubGroupChildIndexOfMethod","_getSubGroupChildRemoveMethod","_getSubGroupChildRemoveAtMethod","_getSubGroupChildInsertBeforeMethod","_getSubGroupChildInsertAtMethod"],r=this.getChildSubgroupNames(),i=0,n=r.length;i<n;++i)for(var a=0,o=t.length;a<o;++a){var s=this[t[a]].apply(this,[r[i]]);s||e.warn("Subgroup child method not exisits: "+t[a]+" / "+this.getClassName())}}),i(t,"getChildCount",function(){var e=this.getChildHolder();return e&&e!==this?e.getChildCount():this.doGetChildCount()}),i(t,"doGetChildCount",function(){for(var e=0,t=this.getChildSubgroupNames(),r=0,i=t.length;r<i;++r){var n=this._getSubGroupChildCountMethod(t[r]);n&&(e+=n.apply(this))}return e}),i(t,"getChildAt",function(e){var t=this.getChildHolder();return t&&t!==this?t.getChildAt(e):this.doGetChildAt(e)}),i(t,"doGetChildAt",function(e){var t=this._getSubgroupChildIndexInfoFromChildIndex(e);if(t){var r=this._getSubGroupChildAtMethod(t.name);return r&&r.apply(this,[t.index])}return null}),i(t,"indexOfChild",function(e){var t=this.getChildHolder();return t&&t!==this?t.indexOfChild(e):this.doIndexOfChild(e)}),i(t,"doIndexOfChild",function(e){for(var t=this.getChildSubgroupNames(),r=0,i=t.length;r<i;++r){var n=this._getSubGroupChildIndexOfMethod(t[r]);if(n){var a=n.apply(this,[e]);if(a>=0)return this._getPrevSubgroupChildrenCount(t[r])+a}}return-1}),i(t,"hasChild",function(e){return this.indexOfChild(e)>=0}),i(t,"removeChildAt",function(e){return this.doRemoveChildAt(e)}),i(t,"doRemoveChildAt",function(e){var t=this._getSubgroupChildIndexInfoFromChildIndex(e);if(t){var r=this._getSubGroupChildRemoveAtMethod(t.name);return r&&r.apply(this,[t.index])}return null}),i(t,"removeChild",function(e){var t=this.getChildHolder();return t&&t!==this?t.removeChild(e):this.doRemoveChild(e)}),i(t,"doRemoveChild",function(e){for(var t,r=this.getChildSubgroupNames(),i=0,n=r.length;i<n;++i){var a=this._getSubGroupChildRemoveMethod(r[i]);if(a&&(t=a.apply(this,[e])))return t}return null}),i(t,"removeChildren",function(e){for(var t=e.length-1;t>=0;--t)this.removeChild(e[t])}),i(t,"insertChildAt",function(e,t){var r=this.getChildHolder();return r&&r!==this?r.insertChildAt(e,t):this.doInsertChildAt(e,t)}),i(t,"doInsertChildAt",function(e,t){if(t>=this.getChildCount())return this.appendChild(e);var r=this._getSubgroupChildIndexInfoFromChildIndex(t);if(r){var i=this._getSubGroupChildInsertAtMethod(r.name);if(i){var n=i.apply(this,[e,r.index]);if(n>=0)return this._getPrevSubgroupChildrenCount(r.name)+n}}return-1}),i(t,"insertBefore",function(e,t){return this.insertChildBefore(e,t)}),i(t,"insertChildBefore",function(e,t){var r=this.getChildHolder();return r&&r!==this?r.insertChildBefore(e,t):this.doInsertChildBefore(e,t)}),i(t,"doInsertChildBefore",function(e,t){var r=this.getBelongChildSubGroupName(e);if(!r)return-1;if(t&&r!==this.getBelongChildSubGroupName(t))return-1;var i=(this.getChildSubgroupNames(),this._getSubGroupChildInsertBeforeMethod(r));if(i){return this._getPrevSubgroupChildrenCount(r)+i.apply(this,[e,t])}return-1}),i(t,"appendChild",function(e){return this.insertChildBefore(e,null)}),i(t,"appendChildren",function(e){for(var t=0,r=e.length;t<r;++t)this.appendChild(e[t])}),i(t,"cascadeOnChildren",function(e){if(!e)return this;for(var t=0,r=this.getChildCount();t<r;++t){var i=this.getChildAt(t);i.cascadeOnChildren&&i.cascadeOnChildren(e),e(i)}return this}),i(t,"cascade",function(e){return e?(this.cascadeOnChildren(e),e(this),this):this}),i(t,"indexStackOfChild",function(e){var t=e.getParentList&&e.getParentList(),r=-1;if(t&&t.length&&(r=t.indexOf(this)),r<0)return null;for(var i,n=[],a=this,o=r-1;o>=0;--o){var s=t[o];if(!((i=a.indexOfChild(s))>=0))return null;n.push(i),a=s}return(i=a.indexOfChild(e))>=0?(n.push(i),n):null}),i(t,"getChildAtIndexStack",function(t){if(!t)return null;if(t=e.ArrayUtils.toArray(t),t.length<=0)return null;for(var r=this.getChildAt(t[0]),i=1,n=t.length;i<n;++i){if(!r||!r.getChildAt)return null;r=r.getChildAt(t[i])}return r}),i(t,"isEmpty",function(){return!1}),i(t,"clearIds",function(){this.setId(void 0);for(var e=0,t=this.getChildCount();e<t;++e){var r=this.getChildAt(e);r.clearIds&&r.clearIds()}}),i(t,"assignTo",function($super,t,r){var i=$super(t,e);return!r&&t.clearIds&&t.clearIds(),i}),i(t,"assign",function(e,t){return e.assignTo(this,t)}),i(t,"clone",function(e){var t=this.getClass(),r=new t;return this.assignTo(r,e),r}),i(t,"getScalarAttribCount",function(){var e=this.getScalarAttribs();return e?e.length:0}),i(t,"getScalarAttribAt",function(e){var t=this.getScalarAttribs();return t?t[e]:null}),i(t,"appendScalarAttrib",function(t){this.getScalarAttribs()||this.setPropStoreFieldValue("scalarAttribs",[]);var r=e.ArrayUtils.pushUniqueEx(this.getScalarAttribs(),t);return r.isPushed&&(t.setParent(this),this.notifyScalarAttribsChange()),r.index}),i(t,"removeScalarAttribAt",function(t){if(this.getScalarAttribs()){var r=e.ArrayUtils.removeAt(this.getScalarAttribs(),t);return r&&(r.setParent(null),this.notifyScalarAttribsChange()),r}return null}),i(t,"removeScalarAttrib",function(t){if(this.getScalarAttribs()){var r=e.ArrayUtils.remove(this.getScalarAttribs(),t);return r&&(r.setParent(null),this.notifyScalarAttribsChange()),r}return null}),i(t,"getInfoKeys",function(){return this.getInfo()?e.ObjUtils.getOwnedFieldNames(this.getInfo()):[]}),i(t,"getInfoValue",function(e){return this.getInfo()?this.getInfo()[e]:null}),i(t,"setInfoValue",function(e,t){this.doGetInfo(!0)[e]=t,this.notifyInfoChange()}),i(t,"getContainerBox",function(t,r){if(this.getAbsCoordOfMode){var i=this.getAbsCoordOfMode(t,r)||{},n=i;if(this.getSizeOfMode){var a=this.getSizeOfMode(t,r)||{};if(t===e.CoordMode.COORD3D)var n=e.CoordUtils.add(i,this.getSizeOfMode(t,r)||{});else n={x:i.x+a.x,y:i.y-a.y}}return e.BoxUtils.createBox(i,n)}return null}),i(t,"equal",function(e,t){return 0===this.compare(e,t)}),i(t,"compare",function(e,t){if(e===this)return 0;if(!e)return 1;var r,i=this.doGetActualCompareOptions(t);return r=i.customMethod?i.customMethod(this,e,i):this.doCompare(e,i),0===r?0:r<0?-1:1}),i(t,"doGetActualCompareOptions",function(e){return e||{}}),i(t,"doCompare",function(e,t){if(e===this)return 0;if(this.getClass()!==(e.getClass&&e.getClass()))return this.getClassName()<(e.getClassName&&e.getClassName()||"")?-1:1;var r=this.doCompareOnProperties(e,t);if(!r&&t.extraComparisonProperties)for(var i=0,n=t.extraComparisonProperties.length;i<n;++i){var a=t.extraComparisonProperties[i];if(this.hasProperty(a)&&e.hasProperty&&e.hasProperty(a)){var o=this.getPropValue(a),s=e.getPropValue(a);if(!(r=this.doCompareOnValue(o,s,t)))break}}return r}),i(t,"doCompareOnProperties",function(e,t){var r;t.properties?r=t.properties:(r=this.doGetComparisonPropNames(t))||(r=this.doGetDefaultComparisonPropNames());for(var i=0,n=0,a=r.length;n<a;++n)if(0!==(i=this.doCompareProperty(e,r[n],t)))return i;return 0}),i(t,"doGetComparisonPropNames",function(e){return[]}),i(t,"doGetDefaultComparisonPropNames",function(){for(var e=[],t=this.getPropListOfScopes([a.PropertyScope.PUBLIC,a.PropertyScope.PUBLISHED]),r=0,i=t.getLength();r<i;++r){var n=t.getPropInfoAt(r);e.push(n.name)}return e}),i(t,"doCompareProperty",function(e,t,r){var i=e.getPropValue&&e.getPropValue(t),n=this.getPropValue(t);return n===i?0:this.doCompareOnValue(n,i,r)}),i(t,"doCompareOnValue",function(t,r,i){return e.ObjComparer._compareValue(t,r,i)}),i(t,"attachCoordStickNodes",function(t){var r=e.ArrayUtils,i=r.toArray(t),n=this.getAttachedCoordStickNodes();return r.pushUnique(n,i),this}),i(t,"detachCoordStickNodes",function(t){for(var r=e.ArrayUtils,i=r.toArray(t),n=this.getAttachedCoordStickNodes(),a=0,o=i.length;a<o;++a)r.remove(n,i[a]);return this}),t)),e.Scalar=a.create(e.ChemObject,{CLASS_NAME:"Kekule.Scalar",initialize:function($super,e,t,r,i){$super(e),t&&this.setName(t),void 0!==r&&this.setValue(r),i&&this.setUnit(i)},initProperties:function(){this.defineProp("name",{dataType:l.STRING}),this.defineProp("value",{dataType:l.PRIMARY}),this.defineProp("errorValue",{dataType:l.PRIMARY}),this.defineProp("unit",{dataType:l.STRING}),this.defineProp("title",{dataType:l.STRING})}}),e.ChemObjList=a.create(e.ChemObject,(r={CLASS_NAME:"Kekule.ChemObjList",initialize:function($super,e,t,r){$super(e),this.setPropStoreFieldValue("itemBaseClass",t),this.setPropStoreFieldValue("items",[]),this._transparent=!!r},initProperties:function(){this.defineProp("itemBaseClass",{dataType:l.CLASS,serializable:!1,scope:a.PropertyScope.PUBLIC}),this.defineProp("items",{dataType:l.ARRAY,scope:a.PropertyScope.PUBLIC,setter:null,getter:function(e){var t=this.getPropStoreFieldValue("items");return!t&&e&&(t=[],this.setPropStoreFieldValue("items",t)),t}})},loaded:function($super){this.ownerChanged(this.getOwner()),this.parentChanged(this.getParent()),$super()},parentChanged:function($super,e,t){this.changeAllItemsParent(),$super(e,t)},isEmpty:function(){return this.getItemCount()<=0},isValidItemType:function(e){var t=this.getItemBaseClass();return!t||e instanceof t},checkItemType:function(t){var r=this.isValidItemType(t);return r||e.raise(e.$L("ErrorMsg.LIST_ITEM_CLASS_MISMATCH")),r},notifyItemsChange:function(){this.notifyPropSet("items",this.getPropStoreFieldValue("items"))},getItemOwner:function(){return this.getOwner()},changeAllItemsOwner:function(){var e=this.getItems();if(e)for(var t=this.getItemOwner(),r=0,i=e.length;r<i;++r){var n=e[r];n&&n.setOwner&&n.setOwner(t)}},getItemParent:function(){return this._transparent?this.getParent()||this:this},changeAllItemsParent:function(){var e=this.getItems();if(e)for(var t=this.getItemParent(),r=0,i=e.length;r<i;++r){var n=e[r];n&&n.setParent&&n.setParent(t)}},getItemCount:function(){var e=this.getPropStoreFieldValue("items");return e?e.length:0},getItemAt:function(e){var t=this.getPropStoreFieldValue("items");return t?t[e]:null},indexOf:function(e){var t=this.getPropStoreFieldValue("items");return t?t.indexOf(e):-1},indexOfItem:function(e){return this.indexOf(e)},getNextSiblingOfChild:function(e){var t=this.indexOf(e);return t>=0?this.getItemAt(t+1):null},getChildSubgroupNames:function($super){return["item"].concat($super())},getBelongChildSubGroupName:function($super,e){return this.isValidItemType(e)?"item":$super(e)},append:function(t){if(this.checkItemType(t),t){var r=e.ArrayUtils.pushUniqueEx(this.doGetItems(!0),t);return r.isPushed&&(this.notifyItemsChange(),t.setOwner&&t.setOwner(this.getItemOwner()),t.setParent&&t.setParent(this.getItemParent())),r.index}return-1},insert:function(t,r){if(this.checkItemType(t),t){var i=e.ArrayUtils.insertUniqueEx(this.doGetItems(!0),t,r);return i.isInserted&&(this.notifyItemsChange(),t.setOwner&&t.setOwner(this.getItemOwner()),t.setParent&&t.setParent(this.getItemParent())),i.index}return-1},insertItemAt:function(e,t){return this.insert(e,t)},insertItemBefore:function(e,t){if(t){var r=this.indexOfItem(t);return r>=0?this.insertItemAt(e,r):this.appendItem(e)}return this.append(e)},removeAt:function(t){if(this.getItems()){var r=e.ArrayUtils.removeAt(this.getItems(),t);return r&&(r.setOwner&&r.setOwner(null),r.setParent&&r.setParent(null),this.notifyItemsChange()),r}},removeItemAt:function(e){return this.removeAt(e)}},i(r,"removeItemAt",function(e){return this.removeAt(e)}),i(r,"remove",function(t){if(this.getItems()){var r=e.ArrayUtils.remove(this.getItems(),t);return r&&(r.setOwner&&r.setOwner(null),r.setParent&&r.setParent(null),this.notifyItemsChange()),r}}),i(r,"removeItem",function(e){return this.remove(e)}),i(r,"toArray",function(){return this.getItems()||[]}),i(r,"getContainerBox",function(t,r){for(var i,n=this.toArray(),a=0,o=n.length;a<o;++a){var s=n[a],l=s.getContainerBox?s.getContainerBox(t,r):null;l&&(i=i?e.BoxUtils.getContainerBox(i,l):e.BoxUtils.clone(l))}return i}),r)),e.ChemSpaceElement=a.create(e.ChemObject,{CLASS_NAME:"Kekule.ChemSpaceElement",initialize:function($super,t){$super(t);var r=new e.ChemObjList(null,e.ChemObject,!0);r.setParent(this),r.addEventListener("change",function(){this.objectChange(["children"])},this),this.setPropStoreFieldValue("children",r)},initProperties:function(){this.defineProp("children",{dataType:"Kekule.ChemObjList",scope:a.PropertyScope.PUBLIC,setter:function(e){var t=this.getChildren();t&&t.finalize(),e&&(e.setParent(this),e.setOwner(this.getOwner()),e._transparent=!0),this.setPropStoreFieldValue("children",e)}})},loaded:function($super){var e=this.getChildren();e&&(e.parentChanged(this),e.ownerChanged(this.getOwner())),$super()},ownerChanged:function($super,e,t){this.getChildren().setOwner(e),$super(e,t)},_removeChildObj:function($super,e){var t=this.indexOfChild(e);t>=0&&this.removeChildAt(t),$super(e)},getChildHolder:function(){return this.getChildren()},getNextSiblingOfChild:function(e){return this.getChildren().getNextSiblingOfChild(e)},insertChild:function(e,t){return this.getChildren().insert(e,t)}}),e.ChemSpace=a.create(e.ChemObject,{CLASS_NAME:"Kekule.ChemSpace",initialize:function($super,t){$super(t),this._autoIdMap={},this._enableObjRefRelations=!0,this._autoUpdateObjRefRelations=!0,this.setPropStoreFieldValue("enableAutoId",!0),this.setPropStoreFieldValue("ownedObjs",[]);var r=new e.ChemSpaceElement;this.setPropStoreFieldValue("root",r),this.setPropStoreFieldValue("objRefRelationManager",new e.ObjRefRelationManager(this)),r.setParent(this),r.setOwner(this)},initProperties:function(){this.defineProp("ownedObjs",{dataType:l.ARRAY,serializable:!1,setter:null,scope:a.PropertyScope.PUBLIC}),this.defineProp("root",{dataType:"Kekule.ChemSpaceElement",setter:null}),this.defineProp("enableAutoId",{dataType:l.BOOL}),this.defineProp("objScreenLengthRatio",{dataType:l.FLOAT,serializable:!1,scope:a.PropertyScope.PRIVATE}),this.defineProp("screenSize",{dataType:l.HASH,getter:function(){this.getPropStoreFieldValue("screenSize");return{x:1500,y:1e3}},setter:function(e){var t=this.getPropStoreFieldValue("screenSize");t||(t={},this.setPropStoreFieldValue("screenSize",t)),t.x=e.x,t.y=e.y}}),this.defineProp("objRefRelationManager",{dataType:"Kekule.ObjRefRelationManager",serializable:!1,scope:a.PropertyScope.PRIVATE,setter:null})},loaded:function($super){var e=this.getRoot();e&&(e.setParent(this),e.setOwner(this)),$super(),this.notifyOwnerLoaded()},notifyOwnedObjsChange:function(){this.notifyPropSet("ownedObjs",this.getPropStoreFieldValue("ownedObjs"))},_notifyOwnedObjsSpaceUpdate:function(t,r,i){for(var n=0,a=this.getOwnedObjCount();n<a;++n){var o=this.getOwnedObjAt(n);o&&o.objSpaceOfOwnerUpdated&&o.objSpaceOfOwnerUpdated(t,r,i)}if(this._enableObjRefRelations&&this._autoUpdateObjRefRelations&&i===e.ObjectTreeOperation.REMOVE)for(var s=e.ArrayUtils,l=this.findObjRefRelations({dest:t})||[],n=0,a=l.length;n<a;++n){var d=l[n];if(d.srcProp.autoUpdate){var u=d.dest,c=s.isArray(u)?s.exclude(u,[t]):null;d.srcObj.setPropValue(d.srcProp.name,c)}}},notifyOwnerLoaded:function(){for(var e=this.getOwnedObjs()||[],t=0,r=e.length;t<r;++t){var i=e[t];i&&i._ownerObjectLoaded&&i._ownerObjectLoaded(this)}},getChildren:function(){return this.getRoot().getChildren().toArray()},getChildHolder:function(){return this.getRoot()},getNextSiblingOfChild:function(e){return this.getRoot().getNextSiblingOfChild(e)},insertChild:function(e,t){return this.getRoot().insertChild(e,t)},indexStackOfChild:function(e){return this.getRoot().indexStackOfChild(e)},getChildAtIndexStack:function(e){return this.getRoot().getChildAtIndexStack(e)},getObjById:function(e){for(var t=0,r=this.getOwnedObjCount();t<r;++t){var i=this.getOwnedObjAt(t);if(i.getId&&i.getId()===e)return i}return null},getAutoId:function(t,r){var i;i=t&&t.getAutoIdPrefix?t.getAutoIdPrefix():"o";var n,i=t.getAutoIdPrefix?t.getAutoIdPrefix():"o";n=e.ObjUtils.notUnset(r)?r:1;var n=this._getAutoIdIndex(i,n);return this._autoIdMap[i]=n,i+Number(n).toString()},_getAutoIdIndex:function(e,t){for(var r=t||0,i=r,n=e+Number(i).toString();this.getObjById(n);)++i,n=e+Number(i).toString();return i},assignAutoIdToObj:function(e){if(e.setId){var t=this.getAutoId(e);e.setId(t)}},getOwnedObjCount:function(){return this.getOwnedObjs().length},getOwnedObjAt:function(e){return this.getOwnedObjs()[e]},indexOfOwnedObj:function(e){return this.getOwnedObjs().indexOf(e)},_appendOwnedObj:function(t){this.indexOfOwnedObj(t)>=0||(this.getEnableAutoId()&&t.getId&&!t.getId()&&this.assignAutoIdToObj(t),this.getOwnedObjs().push(t),t._registerObjRefRelations&&t._registerObjRefRelations(this),this._notifyOwnedObjsSpaceUpdate(t,this,e.ObjectTreeOperation.ADD),this.notifyOwnedObjsChange())},_removeOwnedObjAt:function(t){var r=this.getOwnedObjAt(t);r&&(this.getOwnedObjs().splice(t,1),r._unregisterObjRefRelations&&r._unregisterObjRefRelations(this),this._notifyOwnedObjsSpaceUpdate(r,this,e.ObjectTreeOperation.REMOVE),this.notifyOwnedObjsChange())},_removeOwnedObj:function(e){var t=this.getOwnedObjs().indexOf(e);t>=0&&this._removeOwnedObjAt(t)},_notifyObjTreeOperation:function(e,t,r){for(var i=0,n=this.getOwnedObjCount();i<n;++i){var a=this.getOwnedObjAt(i);a.objTreeOfOwnerUpdated&&a.objTreeOfOwnerUpdated(e,t,r)}},getObjRefRelations:function(){return this._enableObjRefRelations?this.getObjRefRelationManager().getRelations():null},createObjRefRelation:function(e,t,r){return this._enableObjRefRelations?this.getObjRefRelationManager().createRelation(e,t,r):null},modifyObjRefRelation:function(e,t,r){return this._enableObjRefRelations?this.getObjRefRelationManager().modifyRelation(e,t,r):null},getObjRefRelationIndex:function(e,t){return this._enableObjRefRelations?this.getObjRefRelationManager().getRelationIndex(e,t):-1},getObjRefRelation:function(e,t){return this._enableObjRefRelations?this.getObjRefRelationManager().getRelation(e,t):null},releaseObjRefRelation:function(e,t){return this._enableObjRefRelations?this.getObjRefRelationManager().releaseRelation(e,t):null},findObjRefRelations:function(e,t){return this._enableObjRefRelations?this.getObjRefRelationManager().findRelations(e,t):[]}}),e.ClassDefineUtils.addStandardSizeSupport(e.ChemSpace),e.IntermediateChemSpace=a.create(e.ChemSpace,{CLASS_NAME:"Kekule.IntermediateChemSpace",initialize:function($super,e){$super(e),this.setPropStoreFieldValue("enableAutoId",!1),this._enableObjRefRelations=!1,this._autoUpdateObjRefRelations=!1}}),e.ChemDocument=a.create(e.ChemSpace,{CLASS_NAME:"Kekule.ChemDocument",initProperties:function(){},getAutoIdPrefix:function(){return"d"}}),e.ObjRefRelationManager=a.create(s,{CLASS_NAME:"Kekule.ObjRefRelationManager",initialize:function($super,e){$super(),this.setOwner(e),this.setPropStoreFieldValue("relations",[])},initProperties:function(){this.defineProp("owner",{dataType:"Kekule.ChemObject",serializable:!1}),this.defineProp("relations",{dataType:l.ARRAY,serializable:!1,setter:null})},createRelation:function(e,t,r){var i={srcObj:e,srcProp:t,dest:r};return this.getRelations().push(i),i},modifyRelation:function(t,r,i){var n=!i||e.ArrayUtils.isArray(i)&&!i.length,a=this.getRelation(t,r);return n?(a&&this.removeRelation(a),null):(a?a.dest=i:a=this.createRelation(t,r,i),a)},getRelationIndex:function(e,t){for(var r=this.getRelations(),i=0,n=r.length;i<n;++i){var a=r[i];if(a.srcObj===e&&a.srcProp===t)return i}return-1},getRelation:function(e,t){var r=this.getRelations(),i=this.getRelationIndex(e,t);return i>=0?r[i]:null},releaseRelation:function(e,t){var r=this.getRelations(),i=this.getRelationIndex(e,t);i>=0&&r.splice(i,1)},removeRelation:function(e){var t=this.getRelations(),r=t.indexOf(e);r>=0&&t.splice(r,1)},findRelations:function(t,r){var i,n=r||{},a=[],o=Object.extend({},t),s=!1;o.dest&&(delete o.dest,s=!0,i=e.ArrayUtils.toArray(t.dest));for(var l=this.getRelations(),d=0,u=l.length;d<u;++d){var c=l[d],h=!1;if((h=e.ObjUtils.match(c,o))&&s){var m=e.ArrayUtils.toArray(c.dest);h=n.checkDestChildren?this._hasChildOrSelfOfParents(m,i):e.ArrayUtils.intersect(m,i).length===i.length}h&&a.push(c)}return a},_hasChildOrSelfOfParents:function(e,t){for(var r=0,i=e.length;r<i;++r)for(var n=e[r],a=0,o=t.length;a<o;++a){var s=t[a];if(n===s||n.isChildOf&&n.isChildOf(s))return!0}return!1}}),e.ObjRefRelationManager=a.create(s,{CLASS_NAME:"Kekule.ObjRefRelationManager",initialize:function($super,e){$super(),this.setOwner(e),this.setPropStoreFieldValue("relations",[])},initProperties:function(){this.defineProp("owner",{dataType:"Kekule.ChemObject",serializable:!1}),this.defineProp("relations",{dataType:l.ARRAY,serializable:!1,setter:null})},createRelation:function(e,t,r){var i={srcObj:e,srcProp:t,dest:r};return this.getRelations().push(i),i},modifyRelation:function(t,r,i){var n=!i||e.ArrayUtils.isArray(i)&&!i.length,a=this.getRelation(t,r);return n?(a&&this.removeRelation(a),null):(a?a.dest=i:a=this.createRelation(t,r,i),a)},getRelationIndex:function(e,t){for(var r=this.getRelations(),i=0,n=r.length;i<n;++i){var a=r[i];if(a.srcObj===e&&a.srcProp===t)return i}return-1},getRelation:function(e,t){var r=this.getRelations(),i=this.getRelationIndex(e,t);return i>=0?r[i]:null},releaseRelation:function(e,t){var r=this.getRelations(),i=this.getRelationIndex(e,t);i>=0&&r.splice(i,1)},removeRelation:function(e){var t=this.getRelations(),r=t.indexOf(e);r>=0&&t.splice(r,1)},findRelations:function(t,r){var i,n=r||{},a=[],o=Object.extend({},t),s=!1;o.dest&&(delete o.dest,s=!0,i=e.ArrayUtils.toArray(t.dest));for(var l=this.getRelations(),d=0,u=l.length;d<u;++d){var c=l[d],h=!1;if((h=e.ObjUtils.match(c,o))&&s){var m=e.ArrayUtils.toArray(c.dest);h=n.checkDestChildren?this._hasChildOrSelfOfParents(m,i):e.ArrayUtils.intersect(m,i).length===i.length}h&&a.push(c)}return a},_hasChildOrSelfOfParents:function(e,t){for(var r=0,i=e.length;r<i;++r)for(var n=e[r],a=0,o=t.length;a<o;++a){var s=t[a];if(n===s||n.isChildOf&&n.isChildOf(s))return!0}return!1}}),e}},function(e,t,r){"use strict";var i=r(0).Class,n=r(0).ObjectEx;e.exports=function(e){return e.ExceptionHandler=i.create(n,{CLASS_NAME:"Kekule.ExceptionHandler",initProperties:function(){this.defineEvent("exceptionThrown")},notifyExceptionThrown:function(e,t){var r={exception:e,level:t};return this.invokeEvent("exceptionThrown",r),r},throwException:function(t,r){var i=e.ExceptionLevel;if(r||(r=i.ERROR),!this.notifyExceptionThrown(t,r||i.ERROR).stop){if(!r||r===i.ERROR){var n=t;throw"string"==typeof t&&(n=new e.Exception(t)),n}if("undefined"!=typeof console){"string"!=typeof t&&(t=t.message);var a=r===i.WARNING?"warn":r===i.NOTE?"info":"log";a?console[a](t):console.log(t)}}},raise:function(t,r){return this.throwException(t,r||e.ExceptionLevel.ERROR)}}),e.ExceptionHandler.getInstance=function(){return this.instance||(this.instance=new e.ExceptionHandler),this.instance},e.exceptionHandler=e.ExceptionHandler.getInstance(),e.Exception=function(e,t){this.message=e,this.name=t},e.Exception.prototype=new Error,e.Exception.prototype.constructor=e.Exception,Object.extend(e.Exception.prototype,{getMessage:function(){return this.message}}),e.Error=function(e,t){this.message=e,this.name=t},e.Error.prototype=e.Exception.prototype,e.Error.prototype.constructor=e.Error,e.ChemError=function(e,t){this.message=e,this.name=t},e.ChemError.prototype=e.Error.prototype,e.ChemError.prototype.constructor=e.ChemError,"undefined"==typeof console&&(console={log:function(){},warn:function(){},info:function(){},error:function(){}}),e}},function(e,t,r){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=(r(0).Class,r(0).ClassEx),a=(r(0).ObjectEx,r(0).DataType);e.exports=function(e){return e.oneOf=function(){for(var t=arguments,r=e.ObjUtils.notUnset,i=0,n=t.length;i<n;++i)if(r(t[i]))return t[i];return null},e.ClassUtils={getShortClassName:function(e){var t=e.indexOf(".");return t>=0?e.substring(t+1):e},getLastClassName:function(e){var t=e.lastIndexOf(".");return t>=0?e.substring(t+1):e},makeSingleton:function(e){return Object.extend(e,{_instance:null,getInstance:function(t,r,i,n,a,o,s,l,d,u){return e._instance||(e._instance=new e(t,r,i,n,a,o,s,l,d,u)),e._instance}})}},e.NumUtils={isInteger:function(e){return"number"==typeof e&&parseInt(e,10)===parseFloat(e)},toDecimals:function(t,r){if(e.NumUtils.isInteger(t))return t.toString();var i=Math.pow(10,r),n=Math.round(t*i);n/=i;var a=parseInt(n),o=n-a,s=o.toString();return s.length>r+2?(s=s.substr(2,r),a.toString()+"."+s):n.toString()},isFloatEqual:function(t,r,i){return e.ObjUtils.isUnset(i)&&(i=1e-100),Math.abs(t-r)<=i},getPrimes:function(e){var t,r,i=[],n=[];for(t=2;t<=e;++t)if(!i[t])for(n.push(t),r=t<<1;r<=e;r+=t)i[r]=!0;return n}},e.ObjUtils={getPrototypeOf:function(e){return Object.getPrototypeOf?Object.getPrototypeOf(e):e.prototype||e.__proto__},getPropertyDescriptor:function(t,r,i){var n=Object.getOwnPropertyDescriptor;if(n){var a=n(t,r);return!a&&i&&(t.prototype||t.__proto__)&&(a=e.ObjUtils.getPropertyDescriptor(t.prototype||t.__proto__,r,i)),a}return null},getOwnedFieldNames:function(e,t){var r=[];for(var i in e)e.hasOwnProperty(i)&&(t||"function"!=typeof e[i])&&r.push(i);return r},replacePropName:function(t,r,i){return void 0!==t[r]&&(t.hasOwnProperty(r)?(t[i]=t[r],delete t[r]):e.raise(e.$L("ErrorMsg.NON_OWN_PROPERTY_CANNOT_BE_REPLACED"))),t},isUnset:function(e){return null===e||void 0===e},notUnset:function(e){return null!==e&&void 0!==e},equal:function(e,t,r){for(var i in e)if(!(r&&r.indexOf(i)>=0)&&e[i]!==t[i])return!1;return!0},match:function(e,t){for(var r in t)if(t.hasOwnProperty(r)&&e[r]!==t[r])return!1;return!0},isInstanceOf:function(e,t){if(a.isArrayValue(t)){for(var r=0,i=t.length;r<i;++r)if(e instanceof t[r])return!0;return!1}return e instanceof t},getLeafFieldCascadeNames:function(e,t){var r=[];return function e(t,r,n,a){for(var o in n)if(n.hasOwnProperty(o)&&(a||"function"!=typeof n[o])){var s=n[o];"object"===(void 0===s?"undefined":i(s))?e(t,r+o+".",s,a):t.push(r+o)}}(r,"",e,t),r}},e.ArrayUtils={isArray:function(e){return!!e&&("object"==(void 0===e?"undefined":i(e))&&void 0!==e.length)},toArray:function(t){return e.ArrayUtils.isArray(t)?t:[t]},clone:function(e){return e.slice(0)},filter:function(t,r,i){if(!r)return e.ArrayUtils.clone(t);if(t.filter)return t.filter(r,i);for(var n=[],a=0,o=t.length;a<o;++a){var s=t[a];r.apply(i,[s,a,t])&&n.push(s)}return n},divide:function(e,t){for(var r=[],i=[],n=0,a=0,o=e.length;a<o;++a)i.push(e[a]),++n>=t&&(r.push(i),i=[],n=0);return i.length&&r.push(i),r},pushUnique:function(t,r){var i=e.ArrayUtils.pushUniqueEx(t,r);return i?i.index:null},pushUniqueEx:function(t,r){if(a.isArrayValue(r)){for(var i,n=0,o=r.length;n<o;++n)e.ObjUtils.isUnset(i)?i=e.ArrayUtils.pushUniqueEx(t,r[n]):e.ArrayUtils.pushUniqueEx(t,r[n]);return i}if(!r)return{index:-1,isPushed:!1};var s=t.indexOf(r);return s<0?{index:t.push(r),isPushed:!0}:{index:s,isPushed:!1}},insertUnique:function(t,r,i){return e.ArrayUtils.insertUniqueEx(t,r,i).index},insertUniqueEx:function(t,r,i){if(!r)return{index:-1,isInserted:!1};(e.ObjUtils.isUnset(i)||i<0)&&(i=t.length);var n=t.indexOf(r);return n<0?(t.splice(i,0,r),{index:i,isInserted:!0}):n!=i?(t.splice(n,1),t.splice(i,0,r),{index:i,isInserted:!1}):void 0},removeAt:function(e,t){var r=e[t];return void 0!==r?(e.splice(t,1),r):null},remove:function(t,r,i){var n=t.indexOf(r);return n>=0?(e.ArrayUtils.removeAt(t,n),i&&e.ArrayUtils.remove(t,r,i),r):null},replace:function(t,r,i,n){var a=t.indexOf(r);return a>=0?(t[a]=i,n&&e.ArrayUtils.replace(t,r,i,n),r):null},changeIndex:function(e,t,r){if(t>=0&&t<=e.length){var i=e[t];return e.splice(t,1),e.splice(r,0,i),i}return null},changeItemIndex:function(t,r,i){var n=t.indexOf(r);return e.ArrayUtils.changeIndex(t,n,i)},toUnique:function(e){for(var t=[],r=0,i=e.length;r<i;++r){var n=e[r];t.indexOf(n)<0&&t.push(n)}return t},getUniqueElemCount:function(t){return e.ArrayUtils.toUnique(t).length},reverse:function(t){for(var r=[],i=0,n=t.length;i<n;++i)e.ObjUtils.notUnset(t[i])&&(r[n-i-1]=t[i]);return r},randomize:function(e){if(!e)return null;if(!e.length)return[];for(var t=[],r=e.slice(0);r.length>1;){var i=Math.round(Math.random()*(r.length-1));t.push(r.splice(i,1)[0])}return t.push(r[0]),t},exclude:function(t,r){for(var i=[],n=e.ArrayUtils.toArray(r),a=0,o=t.length;a<o;++a){var s=t[a];n.indexOf(s)<0&&i.push(s)}return i},intersect:function(e,t){for(var r=[],i=0,n=e.length;i<n;++i)t.indexOf(e[i])>=0&&r.push(e[i]);return r},flatten:function(t){for(var r=[],i=0,n=t.length;i<n;++i){var a=t[i];if(e.ArrayUtils.isArray(a)){var o=e.ArrayUtils.flatten(a);r=r.concat(o)}else r.push(a)}return r},compare:function(e,t,r){r||(r=function(e,t){return e>t?1:e<t?-1:0});for(var i=Math.min(e.length,t.length),n=0;n<i;++n){var a=e[n],o=t[n],s=r(a,o);if(0!==s)return s}return e.length>i?1:t.length>i?-1:0},compareNestedArray:function(t,r,i){var n=Math.min(t.length,r.length);i||(i=function(e,t){return e-t});for(var o=0;o<n;++o){var s=0,l=t[o],d=r[o],u=a.isArrayValue(l),c=a.isArrayValue(d);if(0!=(s=u&&c?e.ArrayUtils.compareNestedArray(l,d,i):u?1:c?-1:i(l,d)))return s}return t.length>n?1:r.length>n?-1:0},group:function(t,r){r||(r=function(e,t){return e<t?-1:e>t?1:0});var i=e.ArrayUtils.clone(t);i.sort(r);for(var n,a=[],o=0,s=i.length;o<s;++o){var l=i[o];if(n&&0===r(l,n)){var d=a.length?a[a.length-1]:null;e.ArrayUtils.isArray(d)||(a.pop(),d=[n],a.push(d)),d.push(l)}else a.push(l);n=l}return a},indexStackOfElem:function(t,r){for(var i=0,n=r.length;i<n;++i){var a=r[i];if(a===t)return[i];if(e.ArrayUtils.isArray(a)){var o=e.ArrayUtils.indexStackOfElem(t,a);if(o)return o.unshift(i),o}}return null},getElemByIndexStack:function(t,r){var i=e.ArrayUtils.isArray(r)?e.ArrayUtils.clone(r):[r],n=i.shift(),a=t[n];return a?i.length?e.ArrayUtils.isArray(a)?e.ArrayUtils.getElemByIndexStack(a,i):null:a:null},getMedian:function(e){var t=[].concat(e),r=t.length;return 0===r?null:r<=1?t[0]:(t.sort(function(e,t){return e-t}),r%2?t[r+1>>1]:(t[r>>1]+t[(r>>1)-1])/2)},sortHashArray:function(e,t){for(var r=[],i=0,n=t.length;i<n;++i){var a={},o=t[i]||"";o.startsWith("!")?(a.field=o.substr(1),a.desc=!0):(a.field=o,a.desc=!1),r.push(a)}var s=function(e,t){for(var i=0,n=0,a=r.length;n<a;++n){var o=r[n].field,s=e[o]||"",l=t[o]||"";if(i=s>l?1:s<l?-1:0,r[n].desc&&(i=-i),0!==i)break}return i};return e.sort(s),e}},e.StrUtils={STR_TRUES:["true","yes","t","y"],STR_FALSES:["false","no","f","n"],trim:function(e){return e.replace(/^\s*|\s*$/g,"")},normalizeSpace:function(e){return e.replace(/^\s*|\s(?=\s)|\s*$/g,"")},convertToStr:function(e){return""+e},convertToType:function(t,r){if("string"!=typeof t)return t;switch(r){case a.FLOAT:case a.NUMBER:return parseFloat(t);case a.INT:return parseInt(t);case a.BOOL:return e.StrUtils.strToBool(t);default:return t}},boolToStr:function(t){return t?e.StrUtils.STR_TRUES[0]:e.StrUtils.STR_FALSES[0]},strToBool:function(t){for(var r=t.toLowerCase(),i=0,n=e.StrUtils.STR_FALSES.length;i<n;++i)if(r==e.StrUtils.STR_FALSES[i])return!1;return!!t},removeAroundPair:function(e,t,r){return e.startsWith(t)&&e.endsWith(r)?e.substring(t.length,e.length-t.length-r.length+1):e},unquote:function(t){var r=e.StrUtils.removeAroundPair,i=t;return i=r(i,"'","'"),i=r(i,'"','"')},splitTokens:function(e,t){if(!e)return[];if(a.isArrayValue(e))return e;var r=t?new RegExp(t,"g"):/\s+/g;return e.split(r)},hasToken:function(t,r,i){return e.StrUtils.splitTokens(t,i).indexOf(r)>=0},addTokens:function(t,r,i){for(var n=e.StrUtils.splitTokens(t,i),a=e.StrUtils.splitTokens(r,i),o=0,s=a.length;o<s;++o)n.indexOf(a[o])<0&&n.push(a[o]);return n.join(i||" ")},removeTokens:function(t,r,i){for(var n=e.StrUtils.splitTokens(t,i),a=e.StrUtils.splitTokens(r,i),o=0,s=a.length;o<s;++o){var l=n.indexOf(a[o]);l>=0&&n.splice(l,1)}return n.join(i||" ")},toggleTokens:function(t,r,i){for(var n=e.StrUtils.splitTokens(t,i),a=e.StrUtils.splitTokens(r,i),o=[],s=0,l=a.length;s<l;++s){var d=n.indexOf(a[s]);d>=0?n.splice(d,1):o.push(a[s])}return n=n.concat(o),n.join(i||" ")},getLineCount:function(e,t){return t||(t="\n"),e.split(t).length},getMaxLineCharCount:function(e,t){t||(t="\n");for(var r=e.split(t),i=0,n=0,a=r.length;n<a;++n){var o=r[n];i=Math.max(o.length,i)}return i},isNumbericStr:function(e){var t=Number(e);return!isNaN(t)},splitIndexEndingStr:function(t){for(var r=t.length-1,i=t.charAt(r),n="";i&&e.StrUtils.isNumbericStr(i);)--r,n=i+n,i=t.charAt(r);return n?{prefix:t.substring(0,r+1),index:parseInt(n)}:null}},e.RoleMapUtils={KEY_ITEM:"item",KEY_ROLE:"role",NON_EXPLICIT_ROLE:null,createMap:function(t,r){var i={};return r=r||e.RoleMapUtils.NON_EXPLICIT_ROLE,i[e.RoleMapUtils.KEY_ITEM]=t,i[e.RoleMapUtils.KEY_ROLE]=r,i},getItem:function(t){return t[e.RoleMapUtils.KEY_ITEM]},setItem:function(t,r){t[e.RoleMapUtils.KEY_ITEM]=r},getRole:function(t){return t[e.RoleMapUtils.KEY_ROLE]},setRole:function(t,r){t[e.RoleMapUtils.KEY_ROLE]=r}},e.FactoryUtils={MATCH_EXACTLY:0,MATCH_BY_CLASS:1,DEF_ITEM_STORE_FIELD_NAME:"_items",createSimpleFactory:function(t){var r=e.FactoryUtils,i={_items:new e.MapEx(!0),_matchMethod:t||e.FactoryUtils.MATCH_EXACTLY,register:function(e,t){i._items.set(e,t)},unregister:function(e){i._items.remove(e)},getClass:function(e){if(i._matchMethod===r.MATCH_EXACTLY)return i._items.get(e);if(i._matchMethod===r.MATCH_BY_CLASS){var t=i._items.get(e);if(!t){var a=n.getSuperClass(e);a&&(t=i.getClass(a))}return t}},getInstance:function(e,t,r,n,a,o,s,l,d,u){var c=i.getClass(e);if(c)return new c(t,r,n,a,o,s,l,d,u)}};return i}},e.UrlUtils={EXT_DELIMITER:".",PATH_DELIMITER:"/",SEARCH_DELIMITER:"?",SEARCH_PAIR_DELIMITER:"&",KEY_VALUE_DELIMITER:"=",HASH_DELIMITER:"#",extractFileName:function(t){if(!t)return null;var r=t.lastIndexOf(e.UrlUtils.PATH_DELIMITER);return r>=0?t.substr(r+1):t},extractFileExt:function(t){var r=e.UrlUtils.extractFileName(t);if(r){var i=r.lastIndexOf(e.UrlUtils.EXT_DELIMITER);return i>=0?r.substr(i+1):""}return null},extractFileCoreName:function(t){var r=e.UrlUtils.extractFileName(t);if(r){var i=r.lastIndexOf(e.UrlUtils.EXT_DELIMITER);return i>=0?r.substr(0,i):""}return null},extractSearch:function(t){if(!t)return null;var r=t.lastIndexOf(e.UrlUtils.SEARCH_DELIMITER);return r>=0?t.substr(r):null},analysisSearch:function(t,r){var i=e.UrlUtils.extractSearch(t)||"";i=i.substr(1);for(var n=i.split(e.UrlUtils.SEARCH_PAIR_DELIMITER),a=r?{}:[],o=0,s=n.length;o<s;++o){var l=n[o],d=l.split(e.UrlUtils.KEY_VALUE_DELIMITER);d[0]&&(r?a[d[0]]=d[1]:a.push({key:d[0],value:d[1]}))}return a},generateSearchString:function(t){for(var r=e.UrlUtils,i=[],n=e.ObjUtils.getOwnedFieldNames(t),a=0,o=n.length;a<o;++a){var s=n[a],l=t[s];if(e.ObjUtils.notUnset(l)){var l=encodeURIComponent(""+l);i.push(s+r.KEY_VALUE_DELIMITER+l)}}return i.join(r.SEARCH_PAIR_DELIMITER)},generateUrl:function(t,r,i){var n=e.UrlUtils,a=t;if(r){var o=n.generateSearchString(r);a+=n.SEARCH_DELIMITER+o}return i&&(a+=n.HASH_DELIMITER+i),a}},e.MatrixUtils={create:function(t,r,i){var n=!1,a=!1,o=e.ObjUtils;o.notUnset(i)&&(n=!0,e.ArrayUtils.isArray(i)&&(a=!0));for(var s=0,l=new Array(t),d=0,u=l.length;d<u;++d){var c=new Array(r);if(n)for(var h=0,m=c.length;h<m;++h)a&&o.notUnset(i[s])?(c[h]=i[s],++s):c[h]=i;l[d]=c}return l},createIdentity:function(t){for(var r=e.MatrixUtils.create(t,t,0),i=0;i<t-1;++i)r[i][i]=1;return r},getRowCount:function(e){return e.length},getColCount:function(t){return e.MatrixUtils.getRowCount(t)>0?t[0].length:0},getValue:function(e,t,r){return e[t-1][r-1]||0},setValue:function(e,t,r,i){e[t-1][r-1]=i},transpose:function(t){for(var r=e.MatrixUtils,i=r.getColCount(t),n=r.getRowCount(t),a=r.create(i,n),o=1;o<=i;++o)for(var s=a[o-1],l=1;l<=n;++l)s[l-1]=r.getValue(t,l,o);return a},minus:function(t){for(var r=e.MatrixUtils,i=r.getRowCount(t),n=r.getColCount(t),a=this.create(i,n),o=0;o<i;++o)for(var s=a[o],l=t[o],d=0;d<n;++d)s[d]=-(l[d]||0);return a},add:function(t,r){for(var i=e.MatrixUtils,n=i.getRowCount(t),a=i.getColCount(t),o=this.create(n,a),s=1;s<=n;++s)for(var l=1;l<=a;++l)i.setValue(o,s,l,i.getValue(t,s,l)+i.getValue(r,s,l));return o},substract:function(t,r){var i=e.MatrixUtils;return i.add(t,i.minus(r))},multiply:function(t,r){for(var i=e.MatrixUtils,n=i.getRowCount(t),a=i.getColCount(r),o=i.create(n,a),s=1;s<=n;++s)for(var l=1;l<=a;++l){for(var d=0,u=1;u<=n;++u)d+=i.getValue(t,s,u)*i.getValue(r,u,l);i.setValue(o,s,l,d)}return o}},e.CoordUtils={create:function(e,t,r){var i={x:e,y:t};return(r||0===r)&&(i.z=r),i},clone:function(e){var t={x:e.x,y:e.y};return(e.z||0===e.z)&&(t.z=e.z),t},is3D:function(e){return e.z||0===e.z},isEqual:function(t,r){var i=t.x===r.x&&t.y===r.y,n=e.ObjUtils;return i&&(n.notUnset(t.z)||n.notUnset(r.z))&&(i=t.z===r.z),i},isZero:function(t,r){var i=e.ObjUtils.notUnset(r)?r:0;return Math.abs(t.x||0)<=i&&Math.abs(t.y||0)<=i&&Math.abs(t.z||0)<=i},absValue:function(t){if(t){var r={};return e.ObjUtils.isUnset(t.x)||(r.x=Math.abs(t.x)),e.ObjUtils.isUnset(t.y)||(r.y=Math.abs(t.y)),e.ObjUtils.isUnset(t.z)||(r.z=Math.abs(t.z)),r}},add:function(t,r){var i={};return e.ObjUtils.isUnset(t.x)&&e.ObjUtils.isUnset(r.x)||(i.x=(t.x||0)+(r.x||0)),e.ObjUtils.isUnset(t.y)&&e.ObjUtils.isUnset(r.y)||(i.y=(t.y||0)+(r.y||0)),e.ObjUtils.isUnset(t.z)&&e.ObjUtils.isUnset(r.z)||(i.z=(t.z||0)+(r.z||0)),i},substract:function(t,r){var i={};return e.ObjUtils.isUnset(t.x)&&e.ObjUtils.isUnset(r.x)||(i.x=(t.x||0)-(r.x||0)),e.ObjUtils.isUnset(t.y)&&e.ObjUtils.isUnset(r.y)||(i.y=(t.y||0)-(r.y||0)),e.ObjUtils.isUnset(t.z)&&e.ObjUtils.isUnset(r.z)||(i.z=(t.z||0)-(r.z||0)),i},multiply:function(t,r){var i={};return e.ObjUtils.isUnset(t.x)||(i.x=t.x*r),e.ObjUtils.isUnset(t.y)||(i.y=t.y*r),e.ObjUtils.isUnset(t.z)||(i.z=t.z*r),i},divide:function(t,r){return e.CoordUtils.multiply(t,1/r)},standardize:function(t){var r=Math.sqrt(Math.sqr(t.x||0)+Math.sqr(t.y||0)+Math.sqr(t.z||0));return e.CoordUtils.divide(t,r||1)},toArray:function(t){var r=[];r.push(t.x,t.y),e.CoordUtils.is3D(t)&&r.push(t.z)},isSameTransform2DOptions:function(t,r,i){var n=e.ObjUtils.isUnset,a=e.NumUtils.isFloatEqual;i||(i={});var o=i.translate||.01,s=i.scale||.01,l=i.rotate||.01,d=!1,u=t.center,c=r.center;if(d=!(!u||!c)&&(a(u.x,c.x,o)&&a(u.y,c.y,o)))for(var h=["scale","scaleX","scaleY","rotateAngle","translateX","translateY"],m=0,g=h.length;m<g;++m){var f=h[m],p=t[f],C=r[f];if(!n(p)||!n(C)){if(n(p)||n(C))d=!1;else{var b=0===f.indexOf("scale")?s:0===f.indexOf("rotate")?l:o;d=a(p,C,b)}if(!d)break}}return d},isSameTransform3DOptions:function(t,r,i){var n=e.ObjUtils.isUnset,a=e.NumUtils.isFloatEqual;i||(i={});var o=i.translate||.01,s=i.scale||.01,l=i.rotate||.01,d=!1,u=t.center,c=r.center;if(d=u&&c?a(u.x,c.x,o)&&a(u.y,c.y,o)&&a(u.z,c.z,o):!u&&!c){var h=t.rotateAxisVector,m=r.rotateAxisVector;d=h&&m?a(h.x,m.x,o)&&a(h.y,m.y,o)&&a(h.z,m.z,o):!h&&!m}if(d)for(var g=["scale","scaleX","scaleY","scaleZ","rotateAngle","rotateX","rotateY","rotateZ","translateX","translateY","translateZ"],f=0,p=g.length;f<p;++f){var C=g[f],b=t[C],E=r[C];if(!n(b)||!n(E)){if(n(b)||n(E))d=!1;else{var N=0===C.indexOf("scale")?s:0===C.indexOf("rotate")?l:o;d=a(b,E,N)}if(!d)break}}return d},transform2D:function(t,r){var i=e.CoordUtils.calcTransform2DMatrix(r);return e.CoordUtils.transform2DByMatrix(t,i)},inverseTransform2D:function(t,r){var i=e.CoordUtils.calcInverseTransform2DMatrix(r);return e.CoordUtils.transform2DByMatrix(t,i)},transform2DByMatrix:function(t,r){var i=e.MatrixUtils,n=i.create(3,1,[t.x||0,t.y||0,1]);return n=i.multiply(r,n),{x:n[0][0],y:n[1][0]}},calcTransform2DMatrix:function(t,r){var i=e.MatrixUtils,n=t||{},a=n.center;if(a)var o=i.create(3,3,[1,0,-(a.x||0),0,1,-(a.y||0),0,0,1]),s=i.create(3,3,[1,0,a.x||0,0,1,a.y||0,0,0,1]);if(n.rotateAngle)var l=n.rotateAngle,d=Math.cos(l),u=Math.sin(l),c=i.create(3,3,[d,-u,0,u,d,0,0,0,1]);var h=n.scale,m=n.scaleX,g=n.scaleY,f=h||1;if(h||m||g){var p=i.create(3,3);i.setValue(p,1,1,m||f),i.setValue(p,2,2,g||f),i.setValue(p,3,3,1)}var C=n.translateX,b=n.translateY;if(C||b){var E=i.create(3,3);i.setValue(E,1,1,1),i.setValue(E,2,2,1),i.setValue(E,3,3,1),i.setValue(E,1,3,C||0),i.setValue(E,2,3,b||0)}var N=i.create(3,3,[1,0,0,0,1,0,0,0,1]);return r?(o&&(N=i.multiply(o,N)),E&&(N=i.multiply(E,N)),p&&(N=i.multiply(p,N)),c&&(N=i.multiply(c,N)),s&&(N=i.multiply(s,N))):(o&&(N=i.multiply(o,N)),c&&(N=i.multiply(c,N)),p&&(N=i.multiply(p,N)),E&&(N=i.multiply(E,N)),s&&(N=i.multiply(s,N))),N},calcInverseTransform2DMatrix:function(t){var r=Object.create(t);return t.center&&(r.center={x:t.center.x,y:t.center.y}),r.scale&&(r.scale=1/r.scale),r.scaleX&&(r.scaleX=1/r.scaleX),r.scaleY&&(r.scaleY=1/r.scaleY),r.translateX&&(r.translateX=-r.translateX),r.translateY&&(r.translateY=-r.translateY),r.rotateAngle&&(r.rotateAngle=-r.rotateAngle),e.CoordUtils.calcTransform2DMatrix(r,!0)},transform3D:function(t,r){var i=e.CoordUtils.calcTransform3DMatrix(r);return e.CoordUtils.transform3DByMatrix(t,i)},transform3DByMatrix:function(t,r){var i=e.MatrixUtils,n=i.create(4,1,[t.x||0,t.y||0,t.z||0,1]);return n=i.multiply(r,n),{x:n[0][0],y:n[1][0],z:n[2][0]}},_calcRotateXYZ3DMatrixCore:function(t){var r=e.MatrixUtils,i=r.create(4,4,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),n=[];if(t.rotateAngle&&t.rotateAxisVector){var a=e.CoordUtils.standardize(t.rotateAxisVector);n.push({vector:[a.x,a.y,a.z],angle:-t.rotateAngle})}else{var o=t.rotateX,s=t.rotateY,l=t.rotateZ;o&&n.push({vector:[1,0,0],angle:-o}),s&&n.push({vector:[0,1,0],angle:-s}),l&&n.push({vector:[0,0,1],angle:-l})}for(var d=0,u=n.length;d<u;++d){for(var c,h=r.create(4,4),m=n[d].angle,g=n[d].vector,f=Math.cos(m),p=Math.sin(m),d=1;d<=4;++d)for(var C=1;C<=4;++C){if(d<4&&C<4){for(var b=1;b<=3&&(b===d||b===C);++b);var E=g[d-1]*g[C-1];c=d<C?E*(1-f)-Math.pow(-1,d+C)*g[b-1]*p:d>C?E*(1-f)+Math.pow(-1,d+C)*g[b-1]*p:E+(1-E)*f}else c=d===C?1:0;r.setValue(h,d,C,c)}i=r.multiply(h,i)}return i},calcRotate3DMatrix:function(t){var r,i=e.MatrixUtils,n=Object.create(t||{});if(n.rotateMatrix)r=n.rotateMatrix;else{var a=n.center;if(a)var o=i.create(4,4,[1,0,0,-(a.x||0),0,1,0,-(a.y||0),0,0,1,-(a.z||0),0,0,0,1]),s=i.create(4,4,[1,0,0,a.x||0,0,1,0,a.y||0,0,0,1,a.z||0,0,0,0,1]);var r=e.CoordUtils._calcRotateXYZ3DMatrixCore(t);o&&(r=i.multiply(o,r)),s&&(r=i.multiply(s,r))}return r},calcTransform3DMatrix:function(t){var r=e.MatrixUtils,i=t||{},n=i.center;if(n)var a=r.create(4,4,[1,0,0,-(n.x||0),0,1,0,-(n.y||0),0,0,1,-(n.z||0),0,0,0,1]),o=r.create(4,4,[1,0,0,n.x||0,0,1,0,n.y||0,0,0,1,n.z||0,0,0,0,1]);var s=["rotateX","rotateY","rotateZ","rotateAngle","rotateAxisVector","rotateMatrix"],l=Object.copyValues({},i,s),d=e.CoordUtils.calcRotate3DMatrix(l),u=i.scale,c=i.scaleX,h=i.scaleY,m=i.scaleZ;if(u||c||h||m){var g=u||1,f=r.create(4,4);r.setValue(f,1,1,c||g),r.setValue(f,2,2,h||g),r.setValue(f,3,3,m||g),r.setValue(f,4,4,1)}var p=i.translateX,C=i.translateY,b=i.translateZ;if(p||C||b){var E=r.create(4,4);r.setValue(E,1,1,1),r.setValue(E,2,2,1),r.setValue(E,3,3,1),r.setValue(E,4,4,1),r.setValue(E,1,4,p||0),r.setValue(E,2,4,C||0),r.setValue(E,3,4,b||0)}var N=r.create(4,4,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);return a&&(N=r.multiply(a,N)),d&&(N=r.multiply(d,N)),f&&(N=r.multiply(f,N)),E&&(N=r.multiply(E,N)),o&&(N=r.multiply(o,N)),N},calcInverseTransform3DMatrix:function(t){var r=Object.create(t);return t.center&&(r.center={x:t.center.x,y:t.center.y,z:t.center.z}),r.scale&&(r.scale=1/r.scale),r.scaleX&&(r.scaleX=1/r.scaleX),r.scaleY&&(r.scaleY=1/r.scaleY),r.scaleZ&&(r.scaleZ=1/r.scaleZ),r.translateX&&(r.translateX=-r.translateX),r.translateY&&(r.translateY=-r.translateY),r.translateZ&&(r.translateZ=-r.translateZ),r.rotateAngle&&(r.rotateAngle=-r.rotateAngle),r.rotateX&&(r.rotateX=-r.rotateX),r.rotateX&&(r.rotateY=-r.rotateY),r.rotateZ&&(r.rotateZ=-r.rotateZ),e.CoordUtils.calcTransform3DMatrix(r,!0)},calcCoordGroup2DTransformParams:function(t,r,i,n){var a=e.CoordUtils,o=a.getDistance(t,r),s=a.substract(r,t),l=Math.atan2(s.y,s.x),d=a.getDistance(i,n),u=a.substract(n,i),c=Math.atan2(u.y,u.x),h=a.substract(i,t);return{translateX:h.x,translateY:h.y,scale:d/o,rotateAngle:c-l,center:t}},getDistance:function(t,r){r||(r={x:0,y:0,z:0});var i=Math.sqr(r.x-t.x)+Math.sqr(r.y-t.y);return e.ObjUtils.notUnset(t.z)&&e.ObjUtils.notUnset(r.z)&&(i+=Math.sqr(r.z-t.z)),Math.sqrt(i)},getCenter:function(t){var r=t.length;if(r<=0)return null;for(var i=Object.extend(t[0]),n=1;n<r;++n)i=e.CoordUtils.add(i,t[n]);return e.CoordUtils.divide(i,r)},insideRect:function(e,t,r){return(e.x-t.x)*(e.x-r.x)<=0&&(e.y-t.y)*(e.y-r.y)<=0},isInsideBox:function(t,r){var i=r,n=Math.sign(t.x-i.x1)*Math.sign(t.x-i.x2)<=0&&Math.sign(t.y-i.y1)*Math.sign(t.y-i.y2)<=0;return e.ObjUtils.notUnset(t.z)&&(n=n&&Math.sign(t.z-i.z1)*Math.sign(t.z-i.z2)<=0),n},getContainerBox:function(t){var r={},i={},n=t.length;if(!(n>0))return null;r=e.CoordUtils.clone(t[0]),i=e.CoordUtils.clone(t[0]);for(var a=1;a<n;++a){var o=t[a];r.x=Math.min(r.x,o.x),r.y=Math.min(r.y,o.y),i.x=Math.max(i.x,o.x),i.y=Math.max(i.y,o.y),e.ObjUtils.notUnset(r.z)&&(r.z=Math.min(r.z,o.z),i.z=Math.max(i.z,o.z))}return e.BoxUtils.createBox(r,i)}},e.GeometryUtils={standardizeAngle:function(e,t,r){t=t||0;Math.PI;return e-Math.floor((e-t)/Math.PI/2)*Math.PI*2},polarToCartesian:function(e,t,r,i){return{x:e+r*Math.cos(i),y:t+r*Math.sin(i)}},getVectorScalarProduct:function(e,t){return(e.x||0)*(t.x||0)+(e.y||0)*(t.y||0)+(e.z||0)*(t.z||0)},getVectorCrossProduct:function(e,t){return{x:(e.y||0)*(t.z||0)-(e.z||0)*(t.y||0),y:(e.z||0)*(t.x||0)-(e.x||0)*(t.z||0),z:(e.x||0)*(t.y||0)-(e.y||0)*(t.x||0)}},getVectorIncludedAngle:function(t,r){var i=e.CoordUtils,n=e.GeometryUtils.getVectorCrossProduct(t,r),a={x:0,y:0,z:0},o=i.getDistance(t,a)*i.getDistance(r,a),s=i.getDistance(n,a)/o;return Math.asin(s)},getVectorIncludedAngle2:function(t,r){return e.GeometryUtils.standardizeAngle(Math.atan2(r.y,r.x)-Math.atan2(t.y,t.x))},getDihedralAngleOfVectors:function(t,r,i){var n=e.CoordUtils,a=e.GeometryUtils,o=a.getVectorCrossProduct(t,r),s=a.getVectorCrossProduct(r,i),l=n.getDistance(r)/1e5;if(n.isZero(o,l)||n.isZero(s,l))return-1;var d=n.standardize(r),u=a.getVectorScalarProduct(a.getVectorCrossProduct(o,s),d),c=a.getVectorScalarProduct(o,s),h=Math.atan2(u,c);return h<0&&(h+=2*Math.PI),h},getDihedralAngleOfPoints:function(t,r,i,n){var a=e.CoordUtils,o=a.substract(r,t),s=a.substract(i,r),l=a.substract(n,i);return e.GeometryUtils.getDihedralAngleOfVectors(o,s,l)},getPerpendicularCrossPointFromCoordToLine:function(e,t,r,i){var n={};if(Math.abs(t.x-r.x)<1e-10)n.x=t.x,n.y=e.y;else{var a=(r.y-t.y)/(r.x-t.x);n.x=(a*a*t.x+a*(e.y-t.y)+e.x)/(a*a+1),n.y=a*(n.x-t.x)+t.y}var o;if(i)o=!0;else{var s={x:t.x-r.x,y:t.y-r.y};o=Math.abs(s.y)>Math.abs(s.x)?Math.sign(n.y-t.y)*Math.sign(n.y-r.y)<=0:Math.sign(n.x-t.x)*Math.sign(n.x-r.x)<=0}return o?n:null},getDistanceFromPointToLine:function(t,r,i,n){var a=e.GeometryUtils.getPerpendicularCrossPointFromCoordToLine(t,r,i,n);if(a){return e.CoordUtils.getDistance(t,a)}var o=e.CoordUtils.getDistance(t,r),s=e.CoordUtils.getDistance(t,i);return Math.min(o,s)},getCrossPointOfLines:function(e,t,r,i){var n=(e.x-r.x)*(t.y-r.y)-(e.y-r.y)*(t.x-r.x),a=(e.x-i.x)*(t.y-i.y)-(e.y-i.y)*(t.x-i.x);if(n*a>=0)return null;var o=(r.x-e.x)*(i.y-e.y)-(r.y-e.y)*(i.x-e.x);if(o*(o+n-a)>=0)return null;var s=o/(a-n),l=s*(t.x-e.x),d=s*(t.y-e.y);return{x:e.x+l,y:e.y+d}},getCrossPointOfVectors:function(t,r){return e.GeometryUtils.getCrossPointOfLines(t[0],t[1],r[0],r[1])},getCrossPointsOfVectorToCircle:function(t,r,i,n){var a=[],o=e.CoordUtils,s=e.NumUtils.isFloatEqual,l=n,d=[o.substract(t[0],r),o.substract(t[1],r)],u=d[1].y-d[0].y,c=d[0].x-d[1].x,h=d[1].x*d[0].y-d[0].x*d[1].y,m=i,g=[],f=4*u*u*h*h-4*(u*u+c*c)*(h*h-m*m*c*c);if(s(f,0,l))g=[-u*h/(u*u+c*c)];else if(f<0)g=[];else{var p=Math.sqrt(f);g=[(-2*u*h+p)/(2*(u*u+c*c)),(-2*u*h-p)/(2*(u*u+c*c))]}if(g&&g.length){var C=[];if(1===g.length&&s(c,0,l)){var b=Math.sqrt(m*m-g[0]*g[0]);s(b,0,l)?C=[0]:(C[0]=b,C[1]=-b,g[1]=g[0])}else for(var E=0,N=g.length;E<N;++E)C[E]=-(u*g[E]+h)/c;for(var E=0,N=g.length;E<N;++E){var T=(g[E]-d[0].x)*(g[E]-d[1].x),O=(C[E]-d[0].y)*(C[E]-d[1].y);(s(u,0,l)&&T<=0||s(c,0,l)&&O<=0||T<=0&&O<=0)&&a.push(o.add({x:g[E],y:C[E]},r))}}return a},getCrossPointsOfCircles:function(t,r,i,n,a){if(e.CoordUtils.getDistance(t,i)>r+n)return[];for(var o=r,s=n,l=t.x,d=i.x,u=t.y,c=i.y,h=o*o-s*s+(d*d-l*l)+(c*c-u*u),m=h/(2*(c-u)),g=(d-l)/(c-u),f=1+g*g,p=-(2*l+2*(m-u)*g),C=l*l+Math.sqr(m-u)-o*o,b=Math.sqrt(p*p-4*f*C),E=2*f,N=e.NumUtils.isFloatEqual(b,0,a)?[-p]:[(-p+b)/E,(-p-b)/E],T=[],O=[],_=0,S=N.length;_<S;++_)T[_]=m-g*N[_],O.push({x:N[_],y:T[_]});return O},simplifyCurveToLineSegments:function(t,r){return r?t.length<=2?e.ArrayUtils.clone(t):e.GeometryUtils._simplifyCurvePartToLineSegments(t,0,t.length-1,r):t},_simplifyCurvePartToLineSegments:function(t,r,i,n){var a=e.GeometryUtils,o=t[r],s=t[i];if(i-r<=1)return[o,s];for(var l=n,d=null,u=r+1;u<i;++u){var c=e.GeometryUtils.getDistanceFromPointToLine(t[u],o,s);c>l&&(l=c,d=u)}if(null===d)return[o,s];var h=a._simplifyCurvePartToLineSegments(t,r,d,n),m=a._simplifyCurvePartToLineSegments(t,d,i,n);return m.shift(),[].concat(h).concat(m)}},e.BoxUtils={createBox:function(t,r){var i={},n=t.x||0,a=t.y||0,o=r.x||0,s=r.y||0;return n<=o?(i.x1=n,i.x2=o):(i.x1=o,i.x2=n),a<=s?(i.y1=a,i.y2=s):(i.y1=s,i.y2=a),e.ObjUtils.notUnset(t.z)&&e.ObjUtils.notUnset(r.z)&&(t.z<=r.z?(i.z1=t.z,i.z2=r.z):(i.z1=r.z,i.z2=t.z)),i},clone:function(t){var r={x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2};return e.ObjUtils.notUnset(t.z1)&&e.ObjUtils.notUnset(t.z2)&&(r.z1=t.z1,r.z2=t.z2),r},convertToRect:function(t){var r=e.BoxUtils.normalize(t);return e.RectUtils.createRect(r.x1,r.y1,r.x2-r.x1,r.y2-r.y1)},normalize:function(t){var r={x1:Math.min(t.x1,t.x2),y1:Math.min(t.y1,t.y2),x2:Math.max(t.x1,t.x2),y2:Math.max(t.y1,t.y2)};return e.ObjUtils.notUnset(t.z1)&&e.ObjUtils.notUnset(t.z2)&&(r.z1=Math.min(t.z1,t.z2),r.z2=Math.max(t.z1,t.z2)),r},shiftBox:function(t,r,i,n){var a=r||0,o=i||0,s=n||0,l={x:t.x1+a,y:t.y1+o},d={x:t.x2+a,y:t.y2+o};return e.ObjUtils.notUnset(t.z1)&&e.ObjUtils.notUnset(t.z2)&&(l.z=t.z1+s,d.z=t.z2+s),e.BoxUtils.createBox(l,d)},inflateBox:function(t,r,i,n){e.ObjUtils.isUnset(i)&&(i=r),e.ObjUtils.isUnset(n)&&(n=r);var a=e.BoxUtils.normalize(t),a={x1:a.x1-r,y1:a.y1-i,x2:a.x2+r,y2:a.y2+i};return e.ObjUtils.notUnset(a.z1)&&e.ObjUtils.notUnset(a.z2)&&(a.z1=a.z1-n,a.z2=a.z2+n),a},getContainerBox:function(t,r){if(!t)return e.BoxUtils.clone(r);if(!r)return e.BoxUtils.clone(t);var i=e.BoxUtils.normalize(t),n=e.BoxUtils.normalize(r),a={x1:Math.min(i.x1,n.x1),y1:Math.min(i.y1,n.y1),x2:Math.max(i.x2,n.x2),y2:Math.max(i.y2,n.y2)};return e.ObjUtils.notUnset(i.z1)&&e.ObjUtils.notUnset(i.z2)&&e.ObjUtils.notUnset(n.z1)&&e.ObjUtils.notUnset(n.z2)&&(a.z1=Math.min(i.z1,n.z1),a.z2=Math.max(i.z2,n.z2)),a},getIntersection:function(t,r){var i=e.BoxUtils.normalize(t),n=e.BoxUtils.normalize(r),a={x1:Math.max(i.x1,n.x1),y1:Math.max(i.y1,n.y1),x2:Math.min(i.x2,n.x2),y2:Math.min(i.y2,n.y2)};return a.x1>a.x2||a.y1>a.y2?null:e.ObjUtils.notUnset(i.z1)&&e.ObjUtils.notUnset(i.z2)&&e.ObjUtils.notUnset(n.z1)&&e.ObjUtils.notUnset(n.z2)&&(a.z1=Math.max(i.z1,n.z1),a.z2=Math.min(i.z2,n.z2),a.z1>a.z2)?null:a},hasIntersection:function(t,r){return!!e.BoxUtils.getIntersection(t,r)},isEqual:function(e,t){return Math.min(e.x1,e.x2)===Math.min(t.x1,t.x2)&&Math.max(e.x1,e.x2)===Math.max(t.x1,t.x2)&&Math.min(e.y1,e.y2)===Math.min(t.y1,t.y2)&&Math.max(e.y1,e.y2)===Math.max(t.y1,t.y2)},isInside:function(e,t){var r=e,i=t;return Math.min(r.x1,r.x2)>=Math.min(i.x1,i.x2)&&Math.max(r.x1,r.x2)<=Math.max(i.x1,i.x2)&&Math.min(r.y1,r.y2)>=Math.min(i.y1,i.y2)&&Math.max(r.y1,r.y2)<=Math.max(i.y1,i.y2)},getCenterCoord:function(t){var r={x:((t.x1||0)+(t.x2||0))/2,y:((t.y1||0)+(t.y2||0))/2};return(e.ObjUtils.notUnset(t.z1)||e.ObjUtils.notUnset(t.z2))&&(r.z=(t.z1||0+t.z2||0)/2),r},getMinMaxCoords:function(t){var r=e.BoxUtils.normalize(t),i={min:{x:r.x1,y:r.y1},max:{x:r.x2,y:r.y2}};return e.ObjUtils.notUnset(r.z1)&&(i.min.z=r.z1,i.max.z=r.z2),i},getCornerCoords:function(t){var r=e.BoxUtils.normalize(t);return e.ObjUtils.isUnset(r.z1)?[{x:r.x1,y:r.y1},{x:r.x1,y:r.y2},{x:r.x2,y:r.y1},{x:r.x2,y:r.y2}]:[{x:r.x1,y:r.y1,z:r.z1},{x:r.x1,y:r.y2,z:r.z1},{x:r.x2,y:r.y1,z:r.z1},{x:r.x2,y:r.y2,z:r.z1},{x:r.x1,y:r.y1,z:r.z2},{x:r.x1,y:r.y2,z:r.z2},{x:r.x2,y:r.y1,z:r.z2},{x:r.x2,y:r.y2,z:r.z2}]},transform2D:function(t,r){for(var i=e.BoxUtils.getCornerCoords(t),n=[],a=0,o=i.length;a<o;++a)n.push(e.CoordUtils.transform2D(i[a],r));return e.CoordUtils.getContainerBox(n)},transform3D:function(t,r){for(var i=e.BoxUtils.getCornerCoords(t),n=[],a=0,o=i.length;a<o;++a)n.push(e.CoordUtils.transform3D(i[a],r));return e.CoordUtils.getContainerBox(n)}},e.RectUtils={createRect:function(e,t,r,i){return{left:e,top:t,width:r,height:i}},clone:function(e){return{left:e.left,top:e.top,width:e.width,height:e.height}},isZero:function(e){return 0===e.width&&0===e.height},convertToBox:function(t){var r=e.CoordUtils.create(t.left,t.top),i=e.CoordUtils.create(t.left+t.width,t.top+t.height);return e.BoxUtils.createBox(r,i)},inflateRect:function(t,r,i){return e.ObjUtils.isUnset(i)&&(i=r),e.RectUtils.createRect(t.left,t.top,t.width+r,t.height+i)},shiftRect:function(t,r,i){var n=r||0,a=i||0;return e.RectUtils.createRect(t.left+n,t.top+a,t.width,t.height)},getContainerRect:function(t,r){var i=e.RectUtils.convertToBox(t),n=e.RectUtils.convertToBox(r),a=e.BoxUtils.getContainerBox(i,n);return e.BoxUtils.convertToRect(a)},getIntersection:function(t,r){var i=e.RectUtils.convertToBox(t),n=e.RectUtils.convertToBox(r),a=e.BoxUtils.getIntersection(i,n);return a?e.BoxUtils.convertToRect(a):null},hasIntersection:function(t,r){return!!e.RectUtils.getIntersection(t,r)}},e.ZoomUtils={PREDEFINED_ZOOM_RATIOS:[.01,.1,.2,.33,.45,.55,.66,.8,.9,1,1.1,1.25,1.5,1.75,2,2.5,3,4,5,7,10,15,20],getNearestZoomLevel:function(t,r){var i=r||e.ZoomUtils.PREDEFINED_ZOOM_RATIOS,n=i.length;if(t>i[n-1])return i[n-1];if(t<i[0])return i[0];for(var a=0;a<n-1;++a){var o=i[a],s=i[a+1];if(t>=o&&t<=s){if(1===o||1===s)return 1;return(t-o)/(s-o)<=.5?o:s}}},getNextZoomInRatio:function(t,r,i){r||(r=1);var n=i||e.ZoomUtils.PREDEFINED_ZOOM_RATIOS,a=n.length;if(t<n[a-1])for(var o=0;o<a;++o)if(n[o]>t)return n[Math.min(o+r,a)-1];return t},getNextZoomOutRatio:function(t,r,i){r||(r=1);var n=i||e.ZoomUtils.PREDEFINED_ZOOM_RATIOS,a=n.length;if(t>n[0])for(var o=a-1;o>=0;--o)if(n[o]<t)return n[Math.max(o-r+1,0)];return t}},e}},function(e,t,r){"use strict";e.exports=function(e){return e.chemicalElementsData=r(43),e.isotopesData=r(44),e.structGenAtomTypesData=r(45),e.ChemicalElementsDataUtil={_getElementInfoBySymbol:function(t){for(var r,i=0,n=e.chemicalElementsData.length;i<n;++i)if((r=e.chemicalElementsData[i])&&r.symbol==t)return r;return null},_getElementInfoByAtomicNumber:function(t){var r=e.chemicalElementsData[t-1];if(r&&r.atomicNumber==t)return r;if(!r||r.atomicNumber<t){for(var i=t,n=e.chemicalElementsData.length;i<n;++i)if((r=e.chemicalElementsData[i])&&r.atomicNumber==t)return r;for(var i=t-2;i>=0;--i)if((r=e.chemicalElementsData[i])&&r.atomicNumber==t)return r}else{for(var i=t-2;i>=0;--i)if((r=e.chemicalElementsData[i])&&r.atomicNumber==t)return r;for(var i=t,n=e.chemicalElementsData.length;i<n;++i)if((r=e.chemicalElementsData[i])&&r.atomicNumber==t)return r}return null},getElementInfo:function(t){return"number"==typeof t?e.ChemicalElementsDataUtil._getElementInfoByAtomicNumber(t):e.ChemicalElementsDataUtil._getElementInfoBySymbol(t)},getElementProp:function(t,r){var i=e.ChemicalElementsDataUtil.getElementInfo(t);return i?i[r]:null},getAtomicNumber:function(t){var r=e.ChemicalElementsDataUtil._getElementInfoBySymbol(t);return r?r.atomicNumber:0},getElementSymbol:function(t){var r=e.ChemicalElementsDataUtil._getElementInfoByAtomicNumber(t);return r?r.symbol:null},isAtomicNumberAvailable:function(t){return!!e.ChemicalElementsDataUtil._getElementInfoByAtomicNumber(t)},isElementSymbolAvailable:function(t){return e.ChemicalElementsDataUtil.getAtomicNumber(t)>0},setMultiAtomElement:function(t){var r=e.chemicalElementsData.length+1,i={symbol:t.multiatom,atomicNumber:r,name:t.meta},n={elementSymbol:t.multiatom,atomicNumber:r,isotopes:[]};e.chemicalElementsData.push(i),e.isotopesData.push(n)}},e.IsotopeAliasUtil={enableAlias:!0,ALIAS:[{alias:"D",atomicNumber:1,massNumber:2}],getAllAlias:function(){return e.IsotopeAliasUtil.enableAlias?e.IsotopeAliasUtil.ALIAS:[]},getAliasInfo:function(t){for(var r=e.IsotopeAliasUtil.getAllAlias(),i=0,n=r.length;i<n;++i){var a=r[i];if(a.alias===t)return Object.extend(e.IsotopesDataUtil.getIsotopeInfo(a.atomicNumber,a.massNumber),{isotopeAlias:t})}return null},getAlias:function(t,r){for(var i=e.IsotopeAliasUtil.getAllAlias(),n=0,a=i.length;n<a;++n){var o=i[n];if(o.atomicNumber===t&&o.massNumber===r)return o.alias}return null}},e.IsotopesDataUtil={_getElementItem:function(t){var r;r="number"==typeof t?t:e.ChemicalElementsDataUtil.getAtomicNumber(t);var i=e.isotopesData[r-1];if(!i||i.atomicNumber!=r)for(var n=0,a=e.isotopesData.length;n<a;++n){var i=e.isotopesData[n];if(i&&i.atomicNumber==r)break}return i},getAllIsotopeInfos:function(t){var r=e.IsotopesDataUtil._getElementItem(t);return r?r.isotopes:null},getIsotopeInfo:function(t,r){var i=null;if(!r&&"string"==typeof t&&(i=e.IsotopeAliasUtil.getAliasInfo(t)))return i;var n=e.IsotopesDataUtil._getElementItem(t),a=n.isotopes;if(a){if(r)for(var o=0,s=a.length;o<s&&(!(i=a[o])||i.massNumber!=r);++o);else 1===a.length&&(i=a[0]);if(i)return i.elementSymbol=n.elementSymbol,i}return null},getIsotopeInfoById:function(t){var r=e.IsotopesDataUtil.getIsotopeIdDetail(t);return e.IsotopesDataUtil.getIsotopeInfo(r.symbol,r.massNumber)},isMassNumberAvailable:function(t,r){return!!e.IsotopesDataUtil.getIsotopeInfo(t,r)},getIsotopeId:function(t,r){if("string"!=typeof t||r){var i=e.IsotopeAliasUtil.getAlias(t,r);if(i)return i}else{if(e.IsotopeAliasUtil.getAliasInfo(t))return t}var n=e.ChemicalElementsDataUtil.getElementInfo(t);if(!n)return null;var a=n.symbol;return r?a+r.toString():a},getIsotopeIdDetail:function(e){if(!e)return null;for(var t="",r="",i=0,n=e.length;i<n;++i){var a=e.charAt(i);a>="0"&&a<="9"?r+=a:t+=a}var o=r?parseInt(r,10):null,s={symbol:t};return o&&(s.massNumber=o),s},isIsotopeIdAvailable:function(t){var r=e.IsotopesDataUtil.getIsotopeIdDetail(t);if(e.IsotopeAliasUtil.getAliasInfo(t))return!0;var i=e.ChemicalElementsDataUtil.isElementSymbolAvailable(r.symbol);if(i&&r.massNum){i=!!e.IsotopesDataUtil.getIsotopeInfo(r.symbol,r.massNum)}return i}},e.AtomTypeDataUtil={getAtomTypeInfoObj:function(t){var r;r="number"==typeof t?t:e.ChemicalElementsDataUtil.getAtomicNumber(t);var i=e.structGenAtomTypesData[r-1];if(i&&i.atomicNumber==r)return i;for(var n=0,a=e.structGenAtomTypesData.length;n<a;++n)if((i=e.structGenAtomTypesData[n])&&i.atomicNumber==r)return i;return null},getAllAtomTypes:function(t){var r=e.AtomTypeDataUtil.getAtomTypeInfoObj(t);return r?r.atomTypes:null},getAtomTypeFromId:function(t,r){if(!t){for(var i="",n=0,a=r.length;n<a;++n){var o=r.chatAt(n);(o<"0"||o>"9")&&(i+=o)}t=i}if(t)for(var s=e.AtomTypeDataUtil.getAllAtomTypes(t),n=0,a=s.length;n<a;++n)if(s[n].id==r)return s[n];return null}},e}},function(e,t,r){"use strict";e.exports=[{symbol:"H",casId:"1333-74-0",group:1,period:1,name:"Hydrogen",atomicNumber:1,chemicalSerie:"Nonmetals",phase:"Gas",radiiCova:.37,radiiVdw:1.2,paulingE:2.2,naturalMass:1.00794075382579},{symbol:"He",casId:"7440-59-7",group:18,period:1,name:"Helium",atomicNumber:2,chemicalSerie:"Noble Gasses",phase:"Gas",radiiCova:.32,radiiVdw:1.4,naturalMass:4.002601902393709},{symbol:"Li",casId:"7439-93-2",group:1,period:2,name:"Lithium",atomicNumber:3,chemicalSerie:"Alkali Metals",phase:"Solid",radiiCova:.32,radiiVdw:2.2,paulingE:.98,naturalMass:6.9400376247955},{symbol:"Be",casId:"7440-41-7",group:2,period:2,name:"Beryllium",atomicNumber:4,chemicalSerie:"Alkali Earth Metals",phase:"Solid",radiiCova:.9,radiiVdw:1.9,paulingE:1.57,naturalMass:9.0121822},{symbol:"B",casId:"7440-42-8",group:13,period:2,name:"Boron",atomicNumber:5,chemicalSerie:"Metalloids",phase:"Solid",radiiCova:.82,radiiVdw:1.8,paulingE:2.04,naturalMass:10.811028088400002},{symbol:"C",casId:"7440-44-0",group:14,period:2,name:"Carbon",atomicNumber:6,chemicalSerie:"Nonmetals",phase:"Solid",radiiCova:.77,radiiVdw:1.7,paulingE:2.55,naturalMass:12.010735896788},{symbol:"N",casId:"7727-37-9",group:15,period:2,name:"Nitrogen",atomicNumber:7,chemicalSerie:"Nonmetals",phase:"Gas",radiiCova:.77,radiiVdw:1.6,paulingE:3.04,naturalMass:14.006743088432001},{symbol:"O",casId:"7782-44-7",group:16,period:2,name:"Oxygen",atomicNumber:8,chemicalSerie:"Nonmetals",phase:"Gas",radiiCova:.73,radiiVdw:1.55,paulingE:3.44,naturalMass:15.999404927569397},{symbol:"F",casId:"7782-41-4",group:17,period:2,name:"Fluorine",atomicNumber:9,chemicalSerie:"Halogens",phase:"Gas",radiiCova:.73,radiiVdw:1.5,paulingE:3.98,naturalMass:18.99840322},{symbol:"Ne",casId:"7440-01-9",group:18,period:2,name:"Neon",atomicNumber:10,chemicalSerie:"Noble Gasses",phase:"Gas",radiiCova:.69,radiiVdw:1.54,naturalMass:20.180046383574997},{symbol:"Na",casId:"7440-23-5",group:1,period:3,name:"Sodium",atomicNumber:11,chemicalSerie:"Alkali Metals",phase:"Solid",radiiCova:1.54,radiiVdw:2.4,paulingE:.93,naturalMass:22.98976928},{symbol:"Mg",casId:"7439-95-4",group:2,period:3,name:"Magnesium",atomicNumber:12,chemicalSerie:"Alkali Earth Metals",phase:"Solid",radiiCova:1.3,radiiVdw:2.2,paulingE:1.31,naturalMass:24.305051612423004},{symbol:"Al",casId:"7429-90-5",group:13,period:3,name:"Aluminum",atomicNumber:13,chemicalSerie:"Metals",phase:"Solid",radiiCova:1.18,radiiVdw:2.1,paulingE:1.61,naturalMass:26.98153863},{symbol:"Si",casId:"7440-21-3",group:14,period:3,name:"Silicon",atomicNumber:14,chemicalSerie:"Metalloids",phase:"Solid",radiiCova:1.11,radiiVdw:2.1,paulingE:1.9,naturalMass:28.085384754933294},{symbol:"P",casId:"7723-14-0",group:15,period:3,name:"Phosphorus",atomicNumber:15,chemicalSerie:"Nonmetals",phase:"Solid",radiiCova:1.06,radiiVdw:1.95,paulingE:2.19,naturalMass:30.97376163},{symbol:"S",casId:"7704-34-9",group:16,period:3,name:"Sulfur",atomicNumber:16,chemicalSerie:"Nonmetals",phase:"Solid",radiiCova:1.02,radiiVdw:1.8,paulingE:2.58,naturalMass:32.066084993038},{symbol:"Cl",casId:"7782-50-5",group:17,period:3,name:"Chlorine",atomicNumber:17,chemicalSerie:"Halogens",phase:"Gas",radiiCova:.99,radiiVdw:1.8,paulingE:3.16,naturalMass:35.452538168202},{symbol:"Ar",casId:"7440-37-1",group:18,period:3,name:"Argon",atomicNumber:18,chemicalSerie:"Noble Gasses",phase:"Gas",radiiCova:.97,radiiVdw:1.8,naturalMass:39.947676710841314},{symbol:"K",casId:"7440-09-7",group:1,period:4,name:"Potassium",atomicNumber:19,chemicalSerie:"Alkali Metals",phase:"Solid",radiiCova:1.96,radiiVdw:2.8,paulingE:.82,naturalMass:39.09830112446276},{symbol:"Ca",casId:"7440-70-2",group:2,period:4,name:"Calcium",atomicNumber:20,chemicalSerie:"Alkali Earth Metals",phase:"Solid",radiiCova:1.74,radiiVdw:2.4,paulingE:1,naturalMass:40.078022651988505},{symbol:"Sc",casId:"7440-20-2",group:3,period:4,name:"Scandium",atomicNumber:21,chemicalSerie:"Transition metals",phase:"Solid",radiiCova:1.44,radiiVdw:2.3,paulingE:1.36,naturalMass:44.9559119},{symbol:"Ti",casId:"7440-32-6",group:4,period:4,name:"Titanium",atomicNumber:22,chemicalSerie:"Transition metals",phase:"Solid",radiiCova:1.44,radiiVdw:2.15,paulingE:1.54,naturalMass:47.866749245159994},{symbol:"V",casId:"7440-62-2",group:5,period:4,name:"Vanadium",atomicNumber:23,chemicalSerie:"Transition metals",phase:"Solid",radiiCova:1.25,radiiVdw:2.05,paulingE:1.63,naturalMass:50.94146749750001},{symbol:"Cr",casId:"7440-47-3",group:6,period:4,name:"Chromium",atomicNumber:24,chemicalSerie:"Transition metals",phase:"Solid",radiiCova:1.27,radiiVdw:2.05,paulingE:1.66,naturalMass:51.996133070619},{symbol:"Mn",casId:"7439-96-5",group:7,period:4,name:"Manganese",atomicNumber:25,chemicalSerie:"Transition metals",phase:"Solid",radiiCova:1.39,radiiVdw:2.05,paulingE:1.55,naturalMass:54.9380451},{symbol:"Fe",casId:"7439-89-6",group:8,period:4,name:"Iron",atomicNumber:26,chemicalSerie:"Transition metals",phase:"Solid",radiiCova:1.25,radiiVdw:2.05,paulingE:1.83,naturalMass:55.845145623527},{symbol:"Co",casId:"7440-48-4",group:9,period:4,name:"Cobalt",atomicNumber:27,chemicalSerie:"Transition metals",phase:"Solid",radiiCova:1.26,radiiVdw:2,paulingE:1.88,naturalMass:58.933195},{symbol:"Ni",casId:"7440-02-0",group:10,period:4,name:"Nickel",atomicNumber:28,chemicalSerie:"Transition metals",phase:"Solid",radiiCova:1.21,radiiVdw:2,paulingE:1.91,naturalMass:58.693351562447994},{symbol:"Cu",casId:"7440-50-8",group:11,period:4,name:"Copper",atomicNumber:29,chemicalSerie:"Transition metals",phase:"Solid",radiiCova:1.38,radiiVdw:2,paulingE:1.9,naturalMass:63.5456400936},{symbol:"Zn",casId:"7440-66-6",group:12,period:4,name:"Zinc",atomicNumber:30,chemicalSerie:"Transition metals",phase:"Solid",radiiCova:1.31,radiiVdw:2.1,paulingE:1.65,naturalMass:65.39556265691999},{symbol:"Ga",casId:"7440-55-3",group:13,period:4,name:"Gallium",atomicNumber:31,chemicalSerie:"Metals",phase:"Solid",radiiVdw:2.1,paulingE:1.81,naturalMass:69.723065622084},{symbol:"Ge",casId:"7440-56-4",group:14,period:4,name:"Germanium",atomicNumber:32,chemicalSerie:"Metalloids",phase:"Solid",radiiCova:1.22,radiiVdw:2.1,paulingE:2.01,naturalMass:72.61275825015},{symbol:"As",casId:"7440-38-2",group:15,period:4,name:"Arsenic",atomicNumber:33,chemicalSerie:"Metalloids",phase:"Solid",radiiCova:1.19,radiiVdw:2.05,paulingE:2.18,naturalMass:74.9215965},{symbol:"Se",casId:"7782-49-2",group:16,period:4,name:"Selenium",atomicNumber:34,chemicalSerie:"Nonmetals",phase:"Solid",radiiCova:1.16,radiiVdw:1.9,paulingE:2.55,naturalMass:78.9593882401},{symbol:"Br",casId:"7726-95-6",group:17,period:4,name:"Bromine",atomicNumber:35,chemicalSerie:"Halogens",phase:"Liquid",radiiCova:1.14,radiiVdw:1.9,paulingE:2.96,naturalMass:79.90352797085},{symbol:"Kr",casId:"7439-90-9",group:18,period:4,name:"Krypton",atomicNumber:36,chemicalSerie:"Noble Gasses",phase:"Gas",radiiCova:1.1,radiiVdw:2.02,paulingE:3,naturalMass:83.79932499157},{symbol:"Rb",casId:"7440-17-7",group:1,period:5,name:"Rubidium",atomicNumber:37,chemicalSerie:"Alkali Metals",phase:"Solid",radiiCova:2.11,radiiVdw:2.9,paulingE:.82,naturalMass:85.46766359685701},{symbol:"Sr",casId:"7440-24-6",group:2,period:5,name:"Strontium",atomicNumber:38,chemicalSerie:"Alkali Earth Metals",phase:"Solid",radiiCova:1.92,radiiVdw:2.55,paulingE:.95,naturalMass:87.61664410489999},{symbol:"Y",casId:"7440-65-5",group:3,period:5,name:"Yttrium",atomicNumber:39,chemicalSerie:"Transition metals",phase:"Solid",naturalMass:88.9058483},{symbol:"Zr",casId:"7440-67-7",group:4,period:5,name:"Zirconium",atomicNumber:40,chemicalSerie:"Transition metals",phase:"Solid",radiiCova:1.48,radiiVdw:2.3,naturalMass:91.22364760672002},{symbol:"Nb",casId:"7440-03-1",group:5,period:5,name:"Niobium",atomicNumber:41,chemicalSerie:"Transition metals",phase:"Solid",radiiCova:1.37,radiiVdw:2.15,naturalMass:92.9063781},{symbol:"Mo",casId:"7439-98-7",group:6,period:5,name:"Molybdenum",atomicNumber:42,chemicalSerie:"Transition metals",phase:"Solid",radiiCova:1.45,radiiVdw:2.1,naturalMass:95.93129211008},{symbol:"Tc",casId:"7440-26-8",group:7,period:5,name:"Technetium",atomicNumber:43,chemicalSerie:"Transition metals",phase:"Synthetic",radiiCova:1.56,radiiVdw:2.05},{symbol:"Ru",casId:"7440-18-8",group:8,period:5,name:"Ruthenium",atomicNumber:44,chemicalSerie:"Transition metals",phase:"Solid",radiiCova:1.26,radiiVdw:2.05,naturalMass:101.06494544279},{symbol:"Rh",casId:"7440-16-6",group:9,period:5,name:"Rhodium",atomicNumber:45,chemicalSerie:"Transition metals",phase:"Solid",radiiCova:1.35,radiiVdw:2,naturalMass:102.905504},{symbol:"Pd",casId:"7440-05-3",group:10,period:5,name:"Palladium",atomicNumber:46,chemicalSerie:"Transition metals",phase:"Solid",radiiCova:1.31,radiiVdw:2.05,naturalMass:106.41532878129999},{symbol:"Ag",casId:"7440-22-4",group:11,period:5,name:"Silver",atomicNumber:47,chemicalSerie:"Transition metals",phase:"Solid",radiiCova:1.53,radiiVdw:2.1,naturalMass:107.86815084455},{symbol:"Cd",casId:"7440-43-9",group:12,period:5,name:"Cadmium",atomicNumber:48,chemicalSerie:"Transition metals",phase:"Solid",radiiCova:1.48,radiiVdw:2.2,naturalMass:112.41155220052002},{symbol:"In",casId:"7440-74-6",group:13,period:5,name:"Indium",atomicNumber:49,chemicalSerie:"Metals",phase:"Solid",radiiVdw:2.25,naturalMass:114.818085722},{symbol:"Sn",casId:"7440-31-5",group:14,period:5,name:"Tin",atomicNumber:50,chemicalSerie:"Metals",phase:"Solid",radiiCova:1.41,radiiVdw:2.25,naturalMass:118.71010831537001},{symbol:"Sb",casId:"7440-36-0",group:15,period:5,name:"Antimony",atomicNumber:51,chemicalSerie:"Metalloids",phase:"Solid",radiiCova:1.38,radiiVdw:2.2,naturalMass:121.75978613257},{symbol:"Te",casId:"13494-80-9",group:16,period:5,name:"Tellurium",atomicNumber:52,chemicalSerie:"Metalloids",phase:"Solid",radiiCova:1.35,radiiVdw:2.1,naturalMass:127.60312784714},{symbol:"I",casId:"7553-56-2",group:17,period:5,name:"Iodine",atomicNumber:53,chemicalSerie:"Halogens",phase:"Solid",radiiCova:1.33,radiiVdw:2.1,naturalMass:126.904473},{symbol:"Xe",casId:"7440-63-3",group:18,period:5,name:"Xenon",atomicNumber:54,chemicalSerie:"Noble Gasses",phase:"Gas",radiiCova:1.3,radiiVdw:2.16,naturalMass:131.29248059059},{symbol:"Cs",casId:"7440-46-2",group:1,period:6,name:"Cesium",atomicNumber:55,chemicalSerie:"Alkali Metals",phase:"Solid",radiiCova:2.25,radiiVdw:3,naturalMass:132.9054519},{symbol:"Ba",casId:"7440-39-3",group:2,period:6,name:"Barium",atomicNumber:56,chemicalSerie:"Alkali Earth Metals",phase:"Solid",radiiCova:1.98,radiiVdw:2.7,naturalMass:137.32689183471098},{symbol:"La",casId:"7439-91-0",group:3,period:6,name:"Lanthanum",atomicNumber:57,chemicalSerie:"Lanthanides",phase:"Solid",radiiCova:1.69,radiiVdw:2.5,naturalMass:138.90545398283},{symbol:"Ce",casId:"7440-45-1",period:6,name:"Cerium",atomicNumber:58,chemicalSerie:"Lanthanides",phase:"Solid",radiiVdw:2.48,naturalMass:140.11572621392},{symbol:"Pr",casId:"7440-10-0",period:6,name:"Praseodymium",atomicNumber:59,chemicalSerie:"Lanthanides",phase:"Solid",radiiVdw:2.47,naturalMass:140.9076528},{symbol:"Nd",casId:"7440-00-8",period:6,name:"Neodymium",atomicNumber:60,chemicalSerie:"Lanthanides",phase:"Solid",radiiVdw:2.47,naturalMass:144.23613137220002},{symbol:"Pm",casId:"7440-12-2",period:6,name:"Promethium",atomicNumber:61,chemicalSerie:"Lanthanides",phase:"Synthetic",radiiVdw:2.43},{symbol:"Sm",casId:"7440-19-9",period:6,name:"Samarium",atomicNumber:62,chemicalSerie:"Lanthanides",phase:"Solid",radiiVdw:2.43,naturalMass:150.36634852618},{symbol:"Eu",casId:"7440-53-1",period:6,name:"Europium",atomicNumber:63,chemicalSerie:"Lanthanides",phase:"Solid",radiiCova:2.4,naturalMass:151.96437047419},{symbol:"Gd",casId:"7440-54-2",period:6,name:"Gadolinium",atomicNumber:64,chemicalSerie:"Lanthanides",phase:"Solid",radiiVdw:2.38,naturalMass:157.25212221544},{symbol:"Tb",casId:"7440-27-9",period:6,name:"Terbium",atomicNumber:65,chemicalSerie:"Lanthanides",phase:"Solid",radiiVdw:2.37,naturalMass:158.9253468},{symbol:"Dy",casId:"7429-91-6",period:6,name:"Dysprosium",atomicNumber:66,chemicalSerie:"Lanthanides",phase:"Solid",radiiVdw:2.35,naturalMass:162.49703350552},{symbol:"Ho",casId:"7440-60-0",period:6,name:"Holmium",atomicNumber:67,chemicalSerie:"Lanthanides",phase:"Solid",radiiVdw:2.33,naturalMass:164.9303221},{symbol:"Er",casId:"7440-52-0",period:6,name:"Erbium",atomicNumber:68,chemicalSerie:"Lanthanides",phase:"Solid",radiiVdw:2.32,naturalMass:167.25630413192},{symbol:"Tm",casId:"7440-30-4",period:6,name:"Thulium",atomicNumber:69,chemicalSerie:"Lanthanides",phase:"Solid",radiiVdw:2.3,naturalMass:168.9342133},{symbol:"Yb",casId:"7440-64-4",period:6,name:"Ytterbium",atomicNumber:70,chemicalSerie:"Lanthanides",phase:"Solid",radiiVdw:2.28,naturalMass:173.03769558789998},{symbol:"Lu",casId:"7439-94-3",period:6,name:"Lutetium",atomicNumber:71,chemicalSerie:"Lanthanides",phase:"Solid",radiiCova:1.6,radiiVdw:2.27,naturalMass:174.96672138555},{symbol:"Hf",casId:"7440-58-6",group:4,period:6,name:"Hafnium",atomicNumber:72,chemicalSerie:"Transition metals",phase:"Solid",radiiCova:1.5,radiiVdw:2.25,naturalMass:178.48497214162},{symbol:"Ta",casId:"7440-25-7",group:5,period:6,name:"Tantalum",atomicNumber:73,chemicalSerie:"Transition metals",phase:"Solid",radiiCova:1.38,radiiVdw:2.2,naturalMass:180.94787573628},{symbol:"W",casId:"7440-33-7",group:6,period:6,name:"Tungsten",atomicNumber:74,chemicalSerie:"Transition metals",phase:"Solid",radiiCova:1.46,radiiVdw:2.1,naturalMass:183.84177810241},{symbol:"Re",casId:"7440-15-5",group:7,period:6,name:"Rhenium",atomicNumber:75,chemicalSerie:"Transition metals",phase:"Solid",radiiCova:1.59,radiiVdw:2.05,naturalMass:186.2067066106},{symbol:"Os",casId:"7440-04-2",group:8,period:6,name:"Osmium",atomicNumber:76,chemicalSerie:"Transition metals",phase:"Solid",radiiCova:1.28,radiiVdw:2,naturalMass:190.22486304558998},{symbol:"Ir",casId:"7439-88-5",group:9,period:6,name:"Iridium",atomicNumber:77,chemicalSerie:"Transition metals",phase:"Solid",radiiCova:1.37,radiiVdw:2,naturalMass:192.2160564148},{symbol:"Pt",casId:"7440-06-4",group:10,period:6,name:"Platinum",atomicNumber:78,chemicalSerie:"Transition metals",phase:"Solid",radiiCova:1.28,radiiVdw:2.05,naturalMass:195.07780788031297},{symbol:"Au",casId:"7440-57-5",group:11,period:6,name:"Gold",atomicNumber:79,chemicalSerie:"Transition metals",phase:"Solid",radiiCova:1.44,radiiVdw:2.1,naturalMass:196.9665687},{symbol:"Hg",casId:"7439-97-6",group:12,period:6,name:"Mercury",atomicNumber:80,chemicalSerie:"Transition metals",phase:"Liquid",radiiCova:1.49,radiiVdw:2.05,naturalMass:200.59916661780002},{symbol:"Tl",casId:"7440-28-0",group:13,period:6,name:"Thallium",atomicNumber:81,chemicalSerie:"Metals",phase:"Solid",radiiCova:1.49,radiiVdw:2.2,naturalMass:204.38333242650796},{symbol:"Pb",casId:"7439-92-1",group:14,period:6,name:"Lead",atomicNumber:82,chemicalSerie:"Metals",phase:"Solid",radiiCova:1.48,radiiVdw:2.3,naturalMass:207.21690766300003},{symbol:"Bi",casId:"7440-69-9",group:15,period:6,name:"Bismuth",atomicNumber:83,chemicalSerie:"Metals",phase:"Solid",radiiCova:1.47,radiiVdw:2.3,naturalMass:208.9803987},{symbol:"Po",casId:"7440-08-6",group:16,period:6,name:"Polonium",atomicNumber:84,chemicalSerie:"Metalloids",phase:"Solid",radiiCova:1.46,radiiVdw:2},{symbol:"At",casId:"7440-08-6",group:17,period:6,name:"Astatine",atomicNumber:85,chemicalSerie:"Halogens",phase:"Solid",radiiVdw:2},{symbol:"Rn",casId:"10043-92-2",group:18,period:6,name:"Radon",atomicNumber:86,chemicalSerie:"Noble Gasses",phase:"Gas",radiiCova:1.45,radiiVdw:2},{symbol:"Fr",casId:"7440-73-5",group:1,period:7,name:"Francium",atomicNumber:87,chemicalSerie:"Alkali Metals",phase:"Solid",radiiVdw:2},{symbol:"Ra",casId:"7440-14-4",group:2,period:7,name:"Radium",atomicNumber:88,chemicalSerie:"Alkali Earth Metals",phase:"Solid",radiiVdw:2},{symbol:"Ac",casId:"7440-34-8",group:3,period:7,name:"Actinium",atomicNumber:89,chemicalSerie:"Actinides",phase:"Synthetic",radiiVdw:2},{symbol:"Th",casId:"7440-29-1",period:7,name:"Thorium",atomicNumber:90,chemicalSerie:"Actinides",phase:"Solid",radiiVdw:2.3,naturalMass:232.0380553},{symbol:"Pa",casId:"7440-13-3",period:7,name:"Protactinium",atomicNumber:91,chemicalSerie:"Actinides",phase:"Solid",radiiVdw:2,naturalMass:231.035884},{symbol:"U",casId:"7440-61-1",period:7,name:"Uranium",atomicNumber:92,chemicalSerie:"Actinides",phase:"Solid",radiiVdw:2.3,naturalMass:238.0289182792545},{symbol:"Np",casId:"7439-99-8",period:7,name:"Neptunium",atomicNumber:93,chemicalSerie:"Actinides",phase:"Synthetic",radiiVdw:2},{symbol:"Pu",casId:"7440-07-5",period:7,name:"Plutonium",atomicNumber:94,chemicalSerie:"Actinides",phase:"Synthetic",radiiVdw:2},{symbol:"Am",casId:"7440-35-9",period:7,name:"Americium",atomicNumber:95,chemicalSerie:"Actinides",phase:"Synthetic",radiiVdw:2},{symbol:"Cm",casId:"7440-51-9",period:7,name:"Curium",atomicNumber:96,chemicalSerie:"Actinides",phase:"Synthetic",radiiVdw:2},{symbol:"Bk",casId:"7440-40-6",period:7,name:"Berkelium",atomicNumber:97,chemicalSerie:"Actinides",phase:"Synthetic",radiiVdw:2},{symbol:"Cf",casId:"7440-71-3",period:7,name:"Californium",atomicNumber:98,chemicalSerie:"Actinides",phase:"Synthetic",radiiVdw:2},{symbol:"Es",casId:"7429-92-7",period:7,name:"Einsteinium",atomicNumber:99,chemicalSerie:"Actinides",phase:"Synthetic",radiiVdw:2},{symbol:"Fm",casId:"7440-72-4",period:7,name:"Fermium",atomicNumber:100,chemicalSerie:"Actinides",phase:"Synthetic",radiiVdw:2},{symbol:"Md",casId:"7440-11-1",period:7,name:"Mendelevium",atomicNumber:101,chemicalSerie:"Actinides",phase:"Synthetic",radiiVdw:2},{symbol:"No",casId:"10028-14-5",period:7,name:"Nobelium",atomicNumber:102,chemicalSerie:"Actinides",phase:"Synthetic",radiiVdw:2},{symbol:"Lr",casId:"22537-19-5",period:7,name:"Lawrencium",atomicNumber:103,chemicalSerie:"Actinides",phase:"Synthetic",radiiVdw:2},{symbol:"Rf",casId:"53850-36-5",group:4,period:7,name:"Rutherfordium",atomicNumber:104,chemicalSerie:"Transition metals",phase:"Synthetic"},{symbol:"Db",casId:"53850-35-4",group:5,period:7,name:"Dubnium",atomicNumber:105,chemicalSerie:"Transition metals",phase:"Synthetic"},{symbol:"Sg",casId:"54038-81-2",group:6,period:7,name:"Seaborgium",atomicNumber:106,chemicalSerie:"Transition metals",phase:"Synthetic"},{symbol:"Bh",casId:"54037-14-8",group:7,period:7,name:"Bohrium",atomicNumber:107,chemicalSerie:"Transition metals",phase:"Synthetic"},{symbol:"Hs",casId:"54037-57-9",group:8,period:7,name:"Hassium",atomicNumber:108,chemicalSerie:"Transition metals",phase:"Synthetic"},{symbol:"Mt",casId:"54038-01-6",group:9,period:7,name:"Meitnerium",atomicNumber:109,chemicalSerie:"Transition metals",phase:"Synthetic"},{symbol:"Ds",casId:"54083-77-1",group:10,period:7,name:"Darmstadtium",atomicNumber:110,chemicalSerie:"Transition metals",phase:"Synthetic"},{symbol:"Rg",casId:"54386-24-2",group:11,period:7,name:"Roentgenium",atomicNumber:111,chemicalSerie:"Transition metals",phase:"Synthetic"},{symbol:"Uub",group:12,period:7,name:"Ununbium",atomicNumber:112,chemicalSerie:"Transition metals",phase:"Synthetic"}]},function(e,t,r){"use strict";e.exports=[{elementSymbol:"H",atomicNumber:1,isotopes:[{id:"H1",massNumber:1,relativeAbundance:.999885,atomicNumber:1,exactMass:1.007825032,spin:"1/2+",magneticMoment:"+2.792846",halfLife:-1},{id:"H2",massNumber:2,relativeAbundance:115e-6,atomicNumber:1,exactMass:2.014101778,spin:"1+",magneticMoment:"+0.857438",halfLife:-1},{id:"H3",massNumber:3,exactMass:3.016049278,atomicNumber:1,spin:"1/2+",magneticMoment:"+2.978960",halfLife:388839e3,betaminusDecay:"0.01861",betaminusDecayLikeliness:"100.0"},{id:"H4",massNumber:4,exactMass:4.02781,atomicNumber:1},{id:"H5",massNumber:5,exactMass:5.03531,atomicNumber:1},{id:"H6",massNumber:6,exactMass:6.04494,atomicNumber:1},{id:"H7",massNumber:7,exactMass:7.05275,atomicNumber:1}]},{elementSymbol:"He",atomicNumber:2,isotopes:[{id:"He3",massNumber:3,relativeAbundance:137e-8,atomicNumber:2,exactMass:3.016029319,spin:"1/2+",magneticMoment:"-2.127624",halfLife:-1},{id:"He4",massNumber:4,relativeAbundance:.99999863,atomicNumber:2,exactMass:4.002603254,spin:"0+",halfLife:-1},{id:"He5",massNumber:5,exactMass:5.01222,atomicNumber:2},{id:"He6",massNumber:6,exactMass:6.0188891,atomicNumber:2,halfLife:.8067},{id:"He7",massNumber:7,exactMass:7.028021,atomicNumber:2},{id:"He8",massNumber:8,exactMass:8.033922,atomicNumber:2,halfLife:.119},{id:"He9",massNumber:9,exactMass:9.04395,atomicNumber:2},{id:"He10",massNumber:10,exactMass:10.0524,atomicNumber:2}]},{elementSymbol:"Li",atomicNumber:3,isotopes:[{id:"Li3",massNumber:3,exactMass:3.03078,atomicNumber:3},{id:"Li4",massNumber:4,exactMass:4.02719,atomicNumber:3},{id:"Li5",massNumber:5,exactMass:5.01254,atomicNumber:3},{id:"Li6",massNumber:6,relativeAbundance:.0759,atomicNumber:3,exactMass:6.015122795,spin:"1+",magneticMoment:"+0.822056",halfLife:-1},{id:"Li7",massNumber:7,relativeAbundance:.9240999999999999,atomicNumber:3,exactMass:7.01600455,spin:"3/2-",magneticMoment:"+3.25644",halfLife:-1},{id:"Li8",massNumber:8,exactMass:8.02248736,atomicNumber:3,halfLife:.838},{id:"Li9",massNumber:9,exactMass:9.0267895,atomicNumber:3,halfLife:.1783},{id:"Li10",massNumber:10,exactMass:10.035481,atomicNumber:3},{id:"Li11",massNumber:11,exactMass:11.043798,atomicNumber:3,halfLife:.0085},{id:"Li12",massNumber:12,exactMass:12.05378,atomicNumber:3}]},{elementSymbol:"Be",atomicNumber:4,isotopes:[{id:"Be5",massNumber:5,exactMass:5.04079,atomicNumber:4},{id:"Be6",massNumber:6,exactMass:6.019726,atomicNumber:4},{id:"Be7",massNumber:7,exactMass:7.01692983,atomicNumber:4,spin:"3/2-",halfLife:4589570,ecDecay:"0.862",ecDecayLikeliness:"100.0"},{id:"Be8",massNumber:8,exactMass:8.0053051,atomicNumber:4},{id:"Be9",massNumber:9,relativeAbundance:1,atomicNumber:4,exactMass:9.0121822,spin:"3/2-",magneticMoment:"-1.1776",halfLife:-1},{id:"Be10",massNumber:10,exactMass:10.0135338,atomicNumber:4,spin:"0+",halfLife:476194e8,betaminusDecay:"0.555",betaminusDecayLikeliness:"100.0"},{id:"Be11",massNumber:11,exactMass:11.021658,atomicNumber:4,halfLife:13.81},{id:"Be12",massNumber:12,exactMass:12.026921,atomicNumber:4,halfLife:.0236},{id:"Be13",massNumber:13,exactMass:13.03569,atomicNumber:4},{id:"Be14",massNumber:14,exactMass:14.04289,atomicNumber:4,halfLife:.00435},{id:"Be15",massNumber:15,exactMass:15.05346,atomicNumber:4},{id:"Be16",massNumber:16,exactMass:16.06192,atomicNumber:4}]},{elementSymbol:"B",atomicNumber:5,isotopes:[{id:"B6",massNumber:6,exactMass:6.04681,atomicNumber:5},{id:"B7",massNumber:7,exactMass:7.02992,atomicNumber:5},{id:"B8",massNumber:8,exactMass:8.0246072,atomicNumber:5,halfLife:.77},{id:"B9",massNumber:9,exactMass:9.0133288,atomicNumber:5},{id:"B10",massNumber:10,relativeAbundance:.19899999999999998,atomicNumber:5,exactMass:10.012937,spin:"3+",magneticMoment:"+1.80065",halfLife:-1},{id:"B11",massNumber:11,relativeAbundance:.8009999999999999,atomicNumber:5,exactMass:11.0093054,spin:"3/2-",magneticMoment:"+2.688637",halfLife:-1},{id:"B12",massNumber:12,exactMass:12.0143521,atomicNumber:5,halfLife:.0202},{id:"B13",massNumber:13,exactMass:13.0177802,atomicNumber:5,halfLife:.01736},{id:"B14",massNumber:14,exactMass:14.025404,atomicNumber:5,halfLife:.0138},{id:"B15",massNumber:15,exactMass:15.031103,atomicNumber:5,halfLife:.0105},{id:"B16",massNumber:16,exactMass:16.03981,atomicNumber:5},{id:"B17",massNumber:17,exactMass:17.04699,atomicNumber:5,halfLife:.00508},{id:"B18",massNumber:18,exactMass:18.05617,atomicNumber:5},{id:"B19",massNumber:19,exactMass:19.06373,atomicNumber:5}]},{elementSymbol:"C",atomicNumber:6,isotopes:[{id:"C8",massNumber:8,exactMass:8.037675,atomicNumber:6},{id:"C9",massNumber:9,exactMass:9.0310367,atomicNumber:6,halfLife:.126},{id:"C10",massNumber:10,exactMass:10.0168532,atomicNumber:6,halfLife:19.255},{id:"C11",massNumber:11,exactMass:11.0114336,atomicNumber:6,spin:"3/2-",halfLife:1223.4,betaplusDecay:"0.96",betaplusDecayLikeliness:"100.0"},{id:"C12",massNumber:12,relativeAbundance:.9893000000000001,atomicNumber:6,exactMass:12,spin:"0+",halfLife:-1},{id:"C13",massNumber:13,relativeAbundance:.010700000000000001,atomicNumber:6,exactMass:13.00335484,spin:"1/2-",magneticMoment:"+0.702411",halfLife:-1},{id:"C14",massNumber:14,exactMass:14.00324199,atomicNumber:6,halfLife:180701e6,betaminusDecay:"0.15648",betaminusDecayLikeliness:"100.0"},{id:"C15",massNumber:15,exactMass:15.0105993,atomicNumber:6,halfLife:2.449},{id:"C16",massNumber:16,exactMass:16.014701,atomicNumber:6,halfLife:.747},{id:"C17",massNumber:17,exactMass:17.022586,atomicNumber:6,halfLife:.193},{id:"C18",massNumber:18,exactMass:18.02676,atomicNumber:6,halfLife:.095},{id:"C19",massNumber:19,exactMass:19.03481,atomicNumber:6,halfLife:.046},{id:"C20",massNumber:20,exactMass:20.04032,atomicNumber:6,halfLife:.014},{id:"C21",massNumber:21,exactMass:21.04934,atomicNumber:6},{id:"C22",massNumber:22,exactMass:22.0572,atomicNumber:6}]},{elementSymbol:"N",atomicNumber:7,isotopes:[{id:"N10",massNumber:10,exactMass:10.04165,atomicNumber:7},{id:"N11",massNumber:11,exactMass:11.02609,atomicNumber:7},{id:"N12",massNumber:12,exactMass:12.0186132,atomicNumber:7,halfLife:.011},{id:"N13",massNumber:13,exactMass:13.00573861,atomicNumber:7,halfLife:597.9},{id:"N14",massNumber:14,relativeAbundance:.9963200000000001,atomicNumber:7,exactMass:14.003074,spin:"1+",magneticMoment:"+0.403761",halfLife:-1},{id:"N15",massNumber:15,relativeAbundance:.00368,atomicNumber:7,exactMass:15.0001089,spin:"1/2-",magneticMoment:"-0.283189",halfLife:-1},{id:"N16",massNumber:16,exactMass:16.0061017,atomicNumber:7,halfLife:7.13},{id:"N17",massNumber:17,exactMass:17.00845,atomicNumber:7,halfLife:4.173},{id:"N18",massNumber:18,exactMass:18.014079,atomicNumber:7,halfLife:.624},{id:"N19",massNumber:19,exactMass:19.017029,atomicNumber:7,halfLife:.304},{id:"N20",massNumber:20,exactMass:20.02337,atomicNumber:7,halfLife:.1},{id:"N21",massNumber:21,exactMass:21.02711,atomicNumber:7,halfLife:.085},{id:"N22",massNumber:22,exactMass:22.03439,atomicNumber:7,halfLife:.024},{id:"N23",massNumber:23,exactMass:23.04122,atomicNumber:7},{id:"N24",massNumber:24,exactMass:24.05104,atomicNumber:7},{id:"N25",massNumber:25,exactMass:25.06066,atomicNumber:7}]},{elementSymbol:"O",atomicNumber:8,isotopes:[{id:"O12",massNumber:12,exactMass:12.034405,atomicNumber:8},{id:"O13",massNumber:13,exactMass:13.024812,atomicNumber:8,halfLife:.00858},{id:"O14",massNumber:14,exactMass:14.00859625,atomicNumber:8,halfLife:70.606},{id:"O15",massNumber:15,exactMass:15.0030656,atomicNumber:8,halfLife:122.24},{id:"O16",massNumber:16,relativeAbundance:.9975700000000001,atomicNumber:8,exactMass:15.99491462,spin:"0+",halfLife:-1},{id:"O17",massNumber:17,relativeAbundance:.00037999999999999997,atomicNumber:8,exactMass:16.9991317,spin:"5/2+",magneticMoment:"-1.89379",halfLife:-1},{id:"O18",massNumber:18,relativeAbundance:.0020499999999999997,atomicNumber:8,exactMass:17.999161,spin:"0+",halfLife:-1},{id:"O19",massNumber:19,exactMass:19.00358,atomicNumber:8,halfLife:26.91},{id:"O20",massNumber:20,exactMass:20.0040767,atomicNumber:8,halfLife:13.51},{id:"O21",massNumber:21,exactMass:21.008656,atomicNumber:8,halfLife:3.42},{id:"O22",massNumber:22,exactMass:22.00997,atomicNumber:8,halfLife:2.25},{id:"O23",massNumber:23,exactMass:23.01569,atomicNumber:8,halfLife:.082},{id:"O24",massNumber:24,exactMass:24.02047,atomicNumber:8,halfLife:.061},{id:"O25",massNumber:25,exactMass:25.02946,atomicNumber:8},{id:"O26",massNumber:26,exactMass:26.03834,atomicNumber:8},{id:"O27",massNumber:27,exactMass:27.04826,atomicNumber:8},{id:"O28",massNumber:28,exactMass:28.05781,atomicNumber:8}]},{elementSymbol:"F",atomicNumber:9,isotopes:[{id:"F14",massNumber:14,exactMass:14.03506,atomicNumber:9},{id:"F15",massNumber:15,exactMass:15.01801,atomicNumber:9,halfLife:-1},{id:"F16",massNumber:16,exactMass:16.011466,atomicNumber:9},{id:"F17",massNumber:17,exactMass:17.00209524,atomicNumber:9,halfLife:64.49},{id:"F18",massNumber:18,exactMass:18.000938,atomicNumber:9,spin:"1+",halfLife:6586.2,betaplusDecay:"0.64",betaplusDecayLikeliness:"97.0",ecDecay:"",ecDecayLikeliness:"3.0"},{id:"F19",massNumber:19,relativeAbundance:1,atomicNumber:9,exactMass:18.99840322,spin:"1/2+",magneticMoment:"+2.628866",halfLife:-1},{id:"F20",massNumber:20,exactMass:19.99998132,atomicNumber:9,halfLife:11},{id:"F21",massNumber:21,exactMass:20.999949,atomicNumber:9,halfLife:4.158},{id:"F22",massNumber:22,exactMass:22.002999,atomicNumber:9,halfLife:4.23},{id:"F23",massNumber:23,exactMass:23.00357,atomicNumber:9,halfLife:2.23},{id:"F24",massNumber:24,exactMass:24.00812,atomicNumber:9,halfLife:.34},{id:"F25",massNumber:25,exactMass:25.0121,atomicNumber:9,halfLife:.059},{id:"F26",massNumber:26,exactMass:26.01962,atomicNumber:9},{id:"F27",massNumber:27,exactMass:27.02676,atomicNumber:9},{id:"F28",massNumber:28,exactMass:28.03567,atomicNumber:9},{id:"F29",massNumber:29,exactMass:29.04326,atomicNumber:9},{id:"F30",massNumber:30,exactMass:30.0525,atomicNumber:9},{id:"F31",massNumber:31,exactMass:31.06043,atomicNumber:9}]},{elementSymbol:"Ne",atomicNumber:10,isotopes:[{id:"Ne16",massNumber:16,exactMass:16.025761,atomicNumber:10},{id:"Ne17",massNumber:17,exactMass:17.017672,atomicNumber:10,halfLife:.1092},{id:"Ne18",massNumber:18,exactMass:18.0057082,atomicNumber:10,halfLife:1.672},{id:"Ne19",massNumber:19,exactMass:19.0018802,atomicNumber:10,halfLife:17.22},{id:"Ne20",massNumber:20,relativeAbundance:.9048,atomicNumber:10,exactMass:19.99244018,spin:"0+",halfLife:-1},{id:"Ne21",massNumber:21,relativeAbundance:.0027,atomicNumber:10,exactMass:20.99384668,spin:"3/2",magneticMoment:"-0.661796",halfLife:-1},{id:"Ne22",massNumber:22,relativeAbundance:.0925,atomicNumber:10,exactMass:21.99138511,spin:"0+",halfLife:-1},{id:"Ne23",massNumber:23,exactMass:22.9944669,atomicNumber:10,halfLife:37.24},{id:"Ne24",massNumber:24,exactMass:23.9936108,atomicNumber:10,halfLife:202.8},{id:"Ne25",massNumber:25,exactMass:24.997737,atomicNumber:10,halfLife:.602},{id:"Ne26",massNumber:26,exactMass:26.000461,atomicNumber:10,halfLife:.197},{id:"Ne27",massNumber:27,exactMass:27.00759,atomicNumber:10,halfLife:.032},{id:"Ne28",massNumber:28,exactMass:28.01207,atomicNumber:10,halfLife:.017},{id:"Ne29",massNumber:29,exactMass:29.01939,atomicNumber:10,halfLife:.2},{id:"Ne30",massNumber:30,exactMass:30.0248,atomicNumber:10},{id:"Ne31",massNumber:31,exactMass:31.03311,atomicNumber:10},{id:"Ne32",massNumber:32,exactMass:32.04002,atomicNumber:10},{id:"Ne33",massNumber:33,exactMass:33.04938,atomicNumber:10},{id:"Ne34",massNumber:34,exactMass:34.05703,atomicNumber:10}]},{elementSymbol:"Na",atomicNumber:11,isotopes:[{id:"Na18",massNumber:18,exactMass:18.02597,atomicNumber:11},{id:"Na19",massNumber:19,exactMass:19.013877,atomicNumber:11},{id:"Na20",massNumber:20,exactMass:20.007351,atomicNumber:11,halfLife:.4479},{id:"Na21",massNumber:21,exactMass:20.9976552,atomicNumber:11,halfLife:22.49},{id:"Na22",massNumber:22,exactMass:21.9944364,atomicNumber:11,spin:"3+",magneticMoment:"+1.746",halfLife:82053500,betaplusDecay:"2.842",betaplusDecayLikeliness:"100.0",ecDecay:"",ecDecayLikeliness:"100.0"},{id:"Na23",massNumber:23,relativeAbundance:1,atomicNumber:11,exactMass:22.98976928,spin:"3/2+",magneticMoment:"-2.217520",halfLife:-1},{id:"Na24",massNumber:24,exactMass:23.99096278,atomicNumber:11,spin:"4+",magneticMoment:"+1.6903",halfLife:14.959,betaminusDecay:"5.514",betaminusDecayLikeliness:"100.0"},{id:"Na25",massNumber:25,exactMass:24.989954,atomicNumber:11,halfLife:59.1},{id:"Na26",massNumber:26,exactMass:25.992633,atomicNumber:11,halfLife:1.072},{id:"Na27",massNumber:27,exactMass:26.994077,atomicNumber:11,halfLife:.301},{id:"Na28",massNumber:28,exactMass:27.998938,atomicNumber:11,halfLife:.0305},{id:"Na29",massNumber:29,exactMass:29.002861,atomicNumber:11,halfLife:.0449},{id:"Na30",massNumber:30,exactMass:30.008976,atomicNumber:11,halfLife:.048},{id:"Na31",massNumber:31,exactMass:31.01359,atomicNumber:11,halfLife:.017},{id:"Na32",massNumber:32,exactMass:32.02047,atomicNumber:11,halfLife:.0132},{id:"Na33",massNumber:33,exactMass:33.02672,atomicNumber:11,halfLife:.0082},{id:"Na34",massNumber:34,exactMass:34.03517,atomicNumber:11,halfLife:.0055},{id:"Na35",massNumber:35,exactMass:35.04249,atomicNumber:11,halfLife:.0015},{id:"Na36",massNumber:36,exactMass:36.05148,atomicNumber:11},{id:"Na37",massNumber:37,exactMass:37.05934,atomicNumber:11}]},{elementSymbol:"Mg",atomicNumber:12,isotopes:[{id:"Mg19",massNumber:19,exactMass:19.03547,atomicNumber:12},{id:"Mg20",massNumber:20,exactMass:20.018863,atomicNumber:12,halfLife:.095},{id:"Mg21",massNumber:21,exactMass:21.011713,atomicNumber:12,halfLife:.122},{id:"Mg22",massNumber:22,exactMass:21.9995738,atomicNumber:12,halfLife:3.857},{id:"Mg23",massNumber:23,exactMass:22.9941237,atomicNumber:12,halfLife:11.317},{id:"Mg24",massNumber:24,relativeAbundance:.7898999999999999,atomicNumber:12,exactMass:23.9850417,spin:"0+",halfLife:-1},{id:"Mg25",massNumber:25,relativeAbundance:.1,atomicNumber:12,exactMass:24.98583692,spin:"5/2+",magneticMoment:"-0.85545",halfLife:-1},{id:"Mg26",massNumber:26,relativeAbundance:.1101,atomicNumber:12,exactMass:25.98259293,spin:"0+",halfLife:-1},{id:"Mg27",massNumber:27,exactMass:26.98434059,atomicNumber:12,halfLife:567.48},{id:"Mg28",massNumber:28,exactMass:27.9838768,atomicNumber:12,halfLife:75276},{id:"Mg29",massNumber:29,exactMass:28.9886,atomicNumber:12,halfLife:1.3},{id:"Mg30",massNumber:30,exactMass:29.990434,atomicNumber:12,halfLife:.335},{id:"Mg31",massNumber:31,exactMass:30.996546,atomicNumber:12,halfLife:.23},{id:"Mg32",massNumber:32,exactMass:31.998975,atomicNumber:12,halfLife:.12},{id:"Mg33",massNumber:33,exactMass:33.005254,atomicNumber:12,halfLife:.09},{id:"Mg34",massNumber:34,exactMass:34.00946,atomicNumber:12,halfLife:.02},{id:"Mg35",massNumber:35,exactMass:35.01734,atomicNumber:12},{id:"Mg36",massNumber:36,exactMass:36.023,atomicNumber:12},{id:"Mg37",massNumber:37,exactMass:37.0314,atomicNumber:12},{id:"Mg38",massNumber:38,exactMass:38.03757,atomicNumber:12},{id:"Mg39",massNumber:39,exactMass:39.04677,atomicNumber:12},{id:"Mg40",massNumber:40,exactMass:40.05393,atomicNumber:12}]},{elementSymbol:"Al",atomicNumber:13,isotopes:[{id:"Al21",massNumber:21,exactMass:21.02804,atomicNumber:13},{id:"Al22",massNumber:22,exactMass:22.01952,atomicNumber:13,halfLife:.07},{id:"Al23",massNumber:23,exactMass:23.007267,atomicNumber:13,halfLife:.47},{id:"Al24",massNumber:24,exactMass:23.9999389,atomicNumber:13,halfLife:2.053},{id:"Al25",massNumber:25,exactMass:24.9904281,atomicNumber:13,halfLife:7.183},{id:"Al26",massNumber:26,exactMass:25.98689169,atomicNumber:13,spin:"5+",halfLife:74e4,betaplusDecay:"4.003",betaplusDecayLikeliness:"82",ecDecay:"",ecDecayLikeliness:"18"},{id:"Al27",massNumber:27,relativeAbundance:1,atomicNumber:13,exactMass:26.98153863,spin:"5/2+",magneticMoment:"+3.641504",halfLife:-1},{id:"Al28",massNumber:28,exactMass:27.98191031,atomicNumber:13,halfLife:134.484},{id:"Al29",massNumber:29,exactMass:28.980445,atomicNumber:13,halfLife:393.6},{id:"Al30",massNumber:30,exactMass:29.98296,atomicNumber:13,halfLife:3.6},{id:"Al31",massNumber:31,exactMass:30.983947,atomicNumber:13,halfLife:.644},{id:"Al32",massNumber:32,exactMass:31.98812,atomicNumber:13,halfLife:.033},{id:"Al33",massNumber:33,exactMass:32.99084,atomicNumber:13},{id:"Al34",massNumber:34,exactMass:33.99685,atomicNumber:13},{id:"Al35",massNumber:35,exactMass:34.99986,atomicNumber:13},{id:"Al36",massNumber:36,exactMass:36.00621,atomicNumber:13},{id:"Al37",massNumber:37,exactMass:37.01068,atomicNumber:13},{id:"Al38",massNumber:38,exactMass:38.01723,atomicNumber:13},{id:"Al39",massNumber:39,exactMass:39.02297,atomicNumber:13},{id:"Al40",massNumber:40,exactMass:40.03145,atomicNumber:13},{id:"Al41",massNumber:41,exactMass:41.03833,atomicNumber:13},{id:"Al42",massNumber:42,exactMass:42.04689,atomicNumber:13}]},{elementSymbol:"Si",atomicNumber:14,isotopes:[{id:"Si22",massNumber:22,exactMass:22.03453,atomicNumber:14,halfLife:.006},{id:"Si23",massNumber:23,exactMass:23.02552,atomicNumber:14},{id:"Si24",massNumber:24,exactMass:24.011546,atomicNumber:14,halfLife:.102},{id:"Si25",massNumber:25,exactMass:25.004106,atomicNumber:14,halfLife:.22},{id:"Si26",massNumber:26,exactMass:25.99233,atomicNumber:14,halfLife:2.234},{id:"Si27",massNumber:27,exactMass:26.98670491,atomicNumber:14,halfLife:4.16},{id:"Si28",massNumber:28,relativeAbundance:.9222969999999999,atomicNumber:14,exactMass:27.97692653,spin:"0+",halfLife:-1},{id:"Si29",massNumber:29,relativeAbundance:.046832000000000006,atomicNumber:14,exactMass:28.9764947,spin:"1/2+",magneticMoment:"-0.55529",halfLife:-1},{id:"Si30",massNumber:30,relativeAbundance:.030872,atomicNumber:14,exactMass:29.97377017,spin:"0+",halfLife:-1},{id:"Si31",massNumber:31,exactMass:30.97536323,atomicNumber:14,halfLife:9438},{id:"Si32",massNumber:32,exactMass:31.97414808,atomicNumber:14,halfLife:47304e5},{id:"Si33",massNumber:33,exactMass:32.978,atomicNumber:14,halfLife:6.18},{id:"Si34",massNumber:34,exactMass:33.978576,atomicNumber:14,halfLife:2.77},{id:"Si35",massNumber:35,exactMass:34.98458,atomicNumber:14,halfLife:.78},{id:"Si36",massNumber:36,exactMass:35.9866,atomicNumber:14,halfLife:.45},{id:"Si37",massNumber:37,exactMass:36.99294,atomicNumber:14},{id:"Si38",massNumber:38,exactMass:37.99563,atomicNumber:14},{id:"Si39",massNumber:39,exactMass:39.00207,atomicNumber:14},{id:"Si40",massNumber:40,exactMass:40.00587,atomicNumber:14},{id:"Si41",massNumber:41,exactMass:41.01456,atomicNumber:14},{id:"Si42",massNumber:42,exactMass:42.01979,atomicNumber:14},{id:"Si43",massNumber:43,exactMass:43.02866,atomicNumber:14},{id:"Si44",massNumber:44,exactMass:44.03526,atomicNumber:14}]},{elementSymbol:"P",atomicNumber:15,isotopes:[{id:"P24",massNumber:24,exactMass:24.03435,atomicNumber:15},{id:"P25",massNumber:25,exactMass:25.02026,atomicNumber:15},{id:"P26",massNumber:26,exactMass:26.01178,atomicNumber:15,halfLife:.02},{id:"P27",massNumber:27,exactMass:26.99923,atomicNumber:15,halfLife:.26},{id:"P28",massNumber:28,exactMass:27.992315,atomicNumber:15,halfLife:.2703},{id:"P29",massNumber:29,exactMass:28.9818006,atomicNumber:15,halfLife:4.14},{id:"P30",massNumber:30,exactMass:29.9783138,atomicNumber:15,halfLife:149.88},{id:"P31",massNumber:31,relativeAbundance:1,atomicNumber:15,exactMass:30.97376163,spin:"1/2+",magneticMoment:"+1.13160",halfLife:-1},{id:"P32",massNumber:32,exactMass:31.97390727,atomicNumber:15,spin:"1+",magneticMoment:"-0.2524",halfLife:1232240,betaminusDecay:"1.710",betaminusDecayLikeliness:"100.0"},{id:"P33",massNumber:33,exactMass:32.9717255,atomicNumber:15,halfLife:2189380},{id:"P34",massNumber:34,exactMass:33.973636,atomicNumber:15,halfLife:12.43},{id:"P35",massNumber:35,exactMass:34.9733141,atomicNumber:15,halfLife:47.3},{id:"P36",massNumber:36,exactMass:35.97826,atomicNumber:15,halfLife:5.6},{id:"P37",massNumber:37,exactMass:36.97961,atomicNumber:15,halfLife:2.31},{id:"P38",massNumber:38,exactMass:37.98416,atomicNumber:15,halfLife:.64},{id:"P39",massNumber:39,exactMass:38.98618,atomicNumber:15,halfLife:.16},{id:"P40",massNumber:40,exactMass:39.9913,atomicNumber:15,halfLife:.26},{id:"P41",massNumber:41,exactMass:40.99434,atomicNumber:15,halfLife:.12},{id:"P42",massNumber:42,exactMass:42.00101,atomicNumber:15,halfLife:.11},{id:"P43",massNumber:43,exactMass:43.00619,atomicNumber:15,halfLife:.033},{id:"P44",massNumber:44,exactMass:44.01299,atomicNumber:15},{id:"P45",massNumber:45,exactMass:45.01922,atomicNumber:15},{id:"P46",massNumber:46,exactMass:46.02738,atomicNumber:15}]},{elementSymbol:"S",atomicNumber:16,isotopes:[{id:"S26",massNumber:26,exactMass:26.02788,atomicNumber:16},{id:"S27",massNumber:27,exactMass:27.01883,atomicNumber:16,halfLife:.021},{id:"S28",massNumber:28,exactMass:28.00437,atomicNumber:16,halfLife:.125},{id:"S29",massNumber:29,exactMass:28.99661,atomicNumber:16,halfLife:.187},{id:"S30",massNumber:30,exactMass:29.984903,atomicNumber:16,halfLife:1.178},{id:"S31",massNumber:31,exactMass:30.9795547,atomicNumber:16,halfLife:2.572},{id:"S32",massNumber:32,relativeAbundance:.9493,atomicNumber:16,exactMass:31.972071,spin:"0+",halfLife:-1},{id:"S33",massNumber:33,relativeAbundance:.0076,atomicNumber:16,exactMass:32.97145876,spin:"3/2+",magneticMoment:"+0.643821",halfLife:-1},{id:"S34",massNumber:34,relativeAbundance:.0429,atomicNumber:16,exactMass:33.9678669,spin:"0+",halfLife:-1},{id:"S35",massNumber:35,exactMass:34.96903216,atomicNumber:16,spin:"3/2+",magneticMoment:"+1",halfLife:7544450,betaminusDecay:"0.1674",betaminusDecayLikeliness:"100.0"},{id:"S36",massNumber:36,relativeAbundance:2e-4,atomicNumber:16,exactMass:35.96708076,spin:"0+",halfLife:-1},{id:"S37",massNumber:37,exactMass:36.97112557,atomicNumber:16,halfLife:303},{id:"S38",massNumber:38,exactMass:37.971163,atomicNumber:16,halfLife:10218},{id:"S39",massNumber:39,exactMass:38.97513,atomicNumber:16,halfLife:11.5},{id:"S40",massNumber:40,exactMass:39.97545,atomicNumber:16,halfLife:8.8},{id:"S41",massNumber:41,exactMass:40.97958,atomicNumber:16},{id:"S42",massNumber:42,exactMass:41.98102,atomicNumber:16,halfLife:.56},{id:"S43",massNumber:43,exactMass:42.98715,atomicNumber:16,halfLife:.22},{id:"S44",massNumber:44,exactMass:43.99021,atomicNumber:16,halfLife:.123},{id:"S45",massNumber:45,exactMass:44.99651,atomicNumber:16,halfLife:.082},{id:"S46",massNumber:46,exactMass:46.00075,atomicNumber:16},{id:"S47",massNumber:47,exactMass:47.00859,atomicNumber:16},{id:"S48",massNumber:48,exactMass:48.01417,atomicNumber:16},{id:"S49",massNumber:49,exactMass:49.02362,atomicNumber:16}]},{elementSymbol:"Cl",atomicNumber:17,isotopes:[{id:"Cl28",massNumber:28,exactMass:28.02851,atomicNumber:17},{id:"Cl29",massNumber:29,exactMass:29.01411,atomicNumber:17},{id:"Cl30",massNumber:30,exactMass:30.00477,atomicNumber:17},{id:"Cl31",massNumber:31,exactMass:30.99241,atomicNumber:17,halfLife:.15},{id:"Cl32",massNumber:32,exactMass:31.98569,atomicNumber:17,halfLife:.298},{id:"Cl33",massNumber:33,exactMass:32.9774519,atomicNumber:17,halfLife:2.511},{id:"Cl34",massNumber:34,exactMass:33.97376282,atomicNumber:17,halfLife:1.5264},{id:"Cl35",massNumber:35,relativeAbundance:.7578,atomicNumber:17,exactMass:34.96885268,spin:"3/2+",magneticMoment:"+0.82187",halfLife:-1},{id:"Cl36",massNumber:36,exactMass:35.96830698,atomicNumber:17},{id:"Cl37",massNumber:37,relativeAbundance:.2422,atomicNumber:17,exactMass:36.96590259,spin:"3/2+",magneticMoment:"+0.68412",halfLife:-1},{id:"Cl38",massNumber:38,exactMass:37.96801043,atomicNumber:17,halfLife:2234.4},{id:"Cl39",massNumber:39,exactMass:38.9680082,atomicNumber:17,halfLife:3336},{id:"Cl40",massNumber:40,exactMass:39.97042,atomicNumber:17,halfLife:81},{id:"Cl41",massNumber:41,exactMass:40.97068,atomicNumber:17,halfLife:38.4},{id:"Cl42",massNumber:42,exactMass:41.97325,atomicNumber:17,halfLife:6.8},{id:"Cl43",massNumber:43,exactMass:42.97405,atomicNumber:17,halfLife:3.3},{id:"Cl44",massNumber:44,exactMass:43.97828,atomicNumber:17,halfLife:.434},{id:"Cl45",massNumber:45,exactMass:44.98029,atomicNumber:17,halfLife:.4},{id:"Cl46",massNumber:46,exactMass:45.98421,atomicNumber:17,halfLife:.223},{id:"Cl47",massNumber:47,exactMass:46.98871,atomicNumber:17},{id:"Cl48",massNumber:48,exactMass:47.99495,atomicNumber:17},{id:"Cl49",massNumber:49,exactMass:49.00032,atomicNumber:17},{id:"Cl50",massNumber:50,exactMass:50.00784,atomicNumber:17},{id:"Cl51",massNumber:51,exactMass:51.01449,atomicNumber:17}]},{elementSymbol:"Ar",atomicNumber:18,isotopes:[{id:"Ar30",massNumber:30,exactMass:30.02156,atomicNumber:18,halfLife:2e-8},{id:"Ar31",massNumber:31,exactMass:31.01212,atomicNumber:18,halfLife:.0151},{id:"Ar32",massNumber:32,exactMass:31.997638,atomicNumber:18,halfLife:.098},{id:"Ar33",massNumber:33,exactMass:32.9899257,atomicNumber:18,halfLife:.173},{id:"Ar34",massNumber:34,exactMass:33.9802712,atomicNumber:18,halfLife:.8445},{id:"Ar35",massNumber:35,exactMass:34.9752576,atomicNumber:18,halfLife:1.775},{id:"Ar36",massNumber:36,relativeAbundance:.0033650000000000004,atomicNumber:18,exactMass:35.96754511,spin:"0+",halfLife:-1},{id:"Ar37",massNumber:37,exactMass:36.96677632,atomicNumber:18,halfLife:3027460},{id:"Ar38",massNumber:38,relativeAbundance:.0006320000000000001,atomicNumber:18,exactMass:37.9627324,spin:"0+",halfLife:-1},{id:"Ar39",massNumber:39,exactMass:38.964313,atomicNumber:18,halfLife:848318e4},{id:"Ar40",massNumber:40,relativeAbundance:.9960030000000001,atomicNumber:18,exactMass:39.96238312,spin:"0+",halfLife:-1},{id:"Ar41",massNumber:41,exactMass:40.9645006,atomicNumber:18,halfLife:6560.4},{id:"Ar42",massNumber:42,exactMass:41.963046,atomicNumber:18,halfLife:103753e4},{id:"Ar43",massNumber:43,exactMass:42.965636,atomicNumber:18,halfLife:322.2},{id:"Ar44",massNumber:44,exactMass:43.964924,atomicNumber:18,halfLife:712.2},{id:"Ar45",massNumber:45,exactMass:44.96804,atomicNumber:18,halfLife:21.48},{id:"Ar46",massNumber:46,exactMass:45.96809,atomicNumber:18,halfLife:8.4},{id:"Ar47",massNumber:47,exactMass:46.97219,atomicNumber:18,halfLife:.7},{id:"Ar48",massNumber:48,exactMass:47.97454,atomicNumber:18},{id:"Ar49",massNumber:49,exactMass:48.98052,atomicNumber:18},{id:"Ar50",massNumber:50,exactMass:49.98443,atomicNumber:18},{id:"Ar51",massNumber:51,exactMass:50.99163,atomicNumber:18},{id:"Ar52",massNumber:52,exactMass:51.99678,atomicNumber:18},{id:"Ar53",massNumber:53,exactMass:53.00494,atomicNumber:18}]},{elementSymbol:"K",atomicNumber:19,isotopes:[{id:"K32",massNumber:32,exactMass:32.02192,atomicNumber:19},{id:"K33",massNumber:33,exactMass:33.00726,atomicNumber:19},{id:"K34",massNumber:34,exactMass:33.99841,atomicNumber:19},{id:"K35",massNumber:35,exactMass:34.98801,atomicNumber:19,halfLife:.19},{id:"K36",massNumber:36,exactMass:35.981292,atomicNumber:19,halfLife:.342},{id:"K37",massNumber:37,exactMass:36.97337589,atomicNumber:19,halfLife:1.226},{id:"K38",massNumber:38,exactMass:37.9690812,atomicNumber:19,halfLife:458.16},{id:"K39",massNumber:39,relativeAbundance:.932581,atomicNumber:19,exactMass:38.96370668,spin:"3/2+",magneticMoment:"+0.391466",halfLife:-1},{id:"K40",massNumber:40,relativeAbundance:117e-6,atomicNumber:19,exactMass:39.96399848,spin:"4-",magneticMoment:"-1.298099",halfLife:1277e6,betaminusDecay:"1.32",betaminusDecayLikeliness:"89.33",ecDecay:"",ecDecayLikeliness:"10.67"},{id:"K41",massNumber:41,relativeAbundance:.067302,atomicNumber:19,exactMass:40.96182576,spin:"3/2+",magneticMoment:"+0.2148699",halfLife:-1},{id:"K42",massNumber:42,exactMass:41.96240281,atomicNumber:19,halfLife:44496},{id:"K43",massNumber:43,exactMass:42.960716,atomicNumber:19,halfLife:80280},{id:"K44",massNumber:44,exactMass:43.96156,atomicNumber:19,halfLife:1327.8},{id:"K45",massNumber:45,exactMass:44.960699,atomicNumber:19,halfLife:1038},{id:"K46",massNumber:46,exactMass:45.961977,atomicNumber:19,halfLife:105},{id:"K47",massNumber:47,exactMass:46.961678,atomicNumber:19,halfLife:17.5},{id:"K48",massNumber:48,exactMass:47.965514,atomicNumber:19,halfLife:6.8},{id:"K49",massNumber:49,exactMass:48.96745,atomicNumber:19,halfLife:1.26},{id:"K50",massNumber:50,exactMass:49.97278,atomicNumber:19,halfLife:.472},{id:"K51",massNumber:51,exactMass:50.97638,atomicNumber:19,halfLife:.365},{id:"K52",massNumber:52,exactMass:51.98261,atomicNumber:19,halfLife:.105},{id:"K53",massNumber:53,exactMass:52.98712,atomicNumber:19,halfLife:.03},{id:"K54",massNumber:54,exactMass:53.9942,atomicNumber:19,halfLife:.01},{id:"K55",massNumber:55,exactMass:54.99971,atomicNumber:19}]},{elementSymbol:"Ca",atomicNumber:20,isotopes:[{id:"Ca34",massNumber:34,exactMass:34.01412,atomicNumber:20},{id:"Ca35",massNumber:35,exactMass:35.00494,atomicNumber:20,halfLife:.05},{id:"Ca36",massNumber:36,exactMass:35.99309,atomicNumber:20,halfLife:.102},{id:"Ca37",massNumber:37,exactMass:36.98587,atomicNumber:20,halfLife:.1811},{id:"Ca38",massNumber:38,exactMass:37.976318,atomicNumber:20,halfLife:.44},{id:"Ca39",massNumber:39,exactMass:38.9707197,atomicNumber:20,halfLife:.8596},{id:"Ca40",massNumber:40,relativeAbundance:.96941,atomicNumber:20,exactMass:39.96259098,spin:"0+",halfLife:-1},{id:"Ca41",massNumber:41,exactMass:40.96227806,atomicNumber:20},{id:"Ca42",massNumber:42,relativeAbundance:.00647,atomicNumber:20,exactMass:41.95861801,spin:"0+",halfLife:-1},{id:"Ca43",massNumber:43,relativeAbundance:.00135,atomicNumber:20,exactMass:42.9587666,spin:"7/2-",magneticMoment:"+1.31725",halfLife:-1},{id:"Ca44",massNumber:44,relativeAbundance:.02086,atomicNumber:20,exactMass:43.9554818,spin:"0+",halfLife:-1},{id:"Ca45",massNumber:45,exactMass:44.9561866,atomicNumber:20,spin:"7/2-",halfLife:14049500},{id:"Ca46",massNumber:46,relativeAbundance:4e-5,atomicNumber:20,exactMass:45.9536926,halfLife:-1,betaminusDecay:"0.257",betaminusDecayLikeliness:"100.0"},{id:"Ca47",massNumber:47,exactMass:46.954546,atomicNumber:20,halfLife:391910},{id:"Ca48",massNumber:48,relativeAbundance:.00187,atomicNumber:20,exactMass:47.952534,spin:"0+"},{id:"Ca49",massNumber:49,exactMass:48.955674,atomicNumber:20,halfLife:523.08},{id:"Ca50",massNumber:50,exactMass:49.957519,atomicNumber:20,halfLife:13.9},{id:"Ca51",massNumber:51,exactMass:50.9615,atomicNumber:20,halfLife:10},{id:"Ca52",massNumber:52,exactMass:51.9651,atomicNumber:20,halfLife:4.6},{id:"Ca53",massNumber:53,exactMass:52.97005,atomicNumber:20,halfLife:.09},{id:"Ca54",massNumber:54,exactMass:53.97435,atomicNumber:20},{id:"Ca55",massNumber:55,exactMass:54.98055,atomicNumber:20},{id:"Ca56",massNumber:56,exactMass:55.98557,atomicNumber:20},{id:"Ca57",massNumber:57,exactMass:56.99236,atomicNumber:20}]},{elementSymbol:"Sc",atomicNumber:21,isotopes:[{id:"Sc36",massNumber:36,exactMass:36.01492,atomicNumber:21},{id:"Sc37",massNumber:37,exactMass:37.00305,atomicNumber:21},{id:"Sc38",massNumber:38,exactMass:37.9947,atomicNumber:21},{id:"Sc39",massNumber:39,exactMass:38.98479,atomicNumber:21},{id:"Sc40",massNumber:40,exactMass:39.977967,atomicNumber:21,halfLife:.1823},{id:"Sc41",massNumber:41,exactMass:40.96925113,atomicNumber:21,halfLife:.5963},{id:"Sc42",massNumber:42,exactMass:41.96551643,atomicNumber:21,halfLife:.6813},{id:"Sc43",massNumber:43,exactMass:42.9611507,atomicNumber:21,halfLife:14007.6},{id:"Sc44",massNumber:44,exactMass:43.9594028,atomicNumber:21,halfLife:14137.2},{id:"Sc45",massNumber:45,relativeAbundance:1,atomicNumber:21,exactMass:44.9559119,spin:"7/2-",magneticMoment:"+4.756483",halfLife:-1},{id:"Sc46",massNumber:46,exactMass:45.9551719,atomicNumber:21,spin:"4+",halfLife:7239460,betaminusDecay:"2.367",betaminusDecayLikeliness:"100.0"},{id:"Sc47",massNumber:47,exactMass:46.9524075,atomicNumber:21,spin:"7/2-",halfLife:289371,betaminusDecay:"0.601",betaminusDecayLikeliness:"100.0"},{id:"Sc48",massNumber:48,exactMass:47.952231,atomicNumber:21,spin:"6+",halfLife:157212,betaminusDecay:"4.0",betaminusDecayLikeliness:"100.0"},{id:"Sc49",massNumber:49,exactMass:48.950024,atomicNumber:21,halfLife:3432},{id:"Sc50",massNumber:50,exactMass:49.952188,atomicNumber:21,halfLife:102.5},{id:"Sc51",massNumber:51,exactMass:50.953603,atomicNumber:21,halfLife:12.4},{id:"Sc52",massNumber:52,exactMass:51.95668,atomicNumber:21,halfLife:8.2},{id:"Sc53",massNumber:53,exactMass:52.95961,atomicNumber:21},{id:"Sc54",massNumber:54,exactMass:53.96326,atomicNumber:21},{id:"Sc55",massNumber:55,exactMass:54.96824,atomicNumber:21},{id:"Sc56",massNumber:56,exactMass:55.97287,atomicNumber:21},{id:"Sc57",massNumber:57,exactMass:56.97779,atomicNumber:21},{id:"Sc58",massNumber:58,exactMass:57.98371,atomicNumber:21},{id:"Sc59",massNumber:59,exactMass:58.98922,atomicNumber:21},{id:"Sc60",massNumber:60,exactMass:59.99571,atomicNumber:21}]},{elementSymbol:"Ti",atomicNumber:22,isotopes:[{id:"Ti38",massNumber:38,exactMass:38.00977,atomicNumber:22},{id:"Ti39",massNumber:39,exactMass:39.00161,atomicNumber:22,halfLife:.026},{id:"Ti40",massNumber:40,exactMass:39.9905,atomicNumber:22,halfLife:.05},{id:"Ti41",massNumber:41,exactMass:40.98315,atomicNumber:22,halfLife:.08},{id:"Ti42",massNumber:42,exactMass:41.973031,atomicNumber:22,halfLife:.199},{id:"Ti43",massNumber:43,exactMass:42.968522,atomicNumber:22,halfLife:.509},{id:"Ti44",massNumber:44,exactMass:43.9596901,atomicNumber:22,halfLife:198677e4},{id:"Ti45",massNumber:45,exactMass:44.9581256,atomicNumber:22,halfLife:11088},{id:"Ti46",massNumber:46,relativeAbundance:.0825,atomicNumber:22,exactMass:45.9526316,spin:"0+",halfLife:-1},{id:"Ti47",massNumber:47,relativeAbundance:.07440000000000001,atomicNumber:22,exactMass:46.9517631,spin:"5/2-",magneticMoment:"-0.78848",halfLife:-1},{id:"Ti48",massNumber:48,relativeAbundance:.7372,atomicNumber:22,exactMass:47.9479463,spin:"0+",halfLife:-1},{id:"Ti49",massNumber:49,relativeAbundance:.0541,atomicNumber:22,exactMass:48.94787,spin:"7/2-",magneticMoment:"-1.10417",halfLife:-1},{id:"Ti50",massNumber:50,relativeAbundance:.0518,atomicNumber:22,exactMass:49.9447912,spin:"0+",halfLife:-1},{id:"Ti51",massNumber:51,exactMass:50.946615,atomicNumber:22,halfLife:345.6},{id:"Ti52",massNumber:52,exactMass:51.946897,atomicNumber:22,halfLife:102},{id:"Ti53",massNumber:53,exactMass:52.94973,atomicNumber:22,halfLife:32.7},{id:"Ti54",massNumber:54,exactMass:53.95105,atomicNumber:22},{id:"Ti55",massNumber:55,exactMass:54.95527,atomicNumber:22,halfLife:.32},{id:"Ti56",massNumber:56,exactMass:55.9582,atomicNumber:22,halfLife:.16},{id:"Ti57",massNumber:57,exactMass:56.96399,atomicNumber:22,halfLife:.18},{id:"Ti58",massNumber:58,exactMass:57.96697,atomicNumber:22},{id:"Ti59",massNumber:59,exactMass:58.97293,atomicNumber:22},{id:"Ti60",massNumber:60,exactMass:59.97676,atomicNumber:22},{id:"Ti61",massNumber:61,exactMass:60.9832,atomicNumber:22},{id:"Ti62",massNumber:62,exactMass:61.98749,atomicNumber:22},{id:"Ti63",massNumber:63,exactMass:62.99442,atomicNumber:22}]},{elementSymbol:"V",atomicNumber:23,isotopes:[{id:"V40",massNumber:40,exactMass:40.01109,atomicNumber:23},{id:"V41",massNumber:41,exactMass:40.99978,atomicNumber:23},{id:"V42",massNumber:42,exactMass:41.99123,atomicNumber:23},{id:"V43",massNumber:43,exactMass:42.98065,atomicNumber:23,halfLife:.8},{id:"V44",massNumber:44,exactMass:43.97411,atomicNumber:23,halfLife:.09},{id:"V45",massNumber:45,exactMass:44.965776,atomicNumber:23,halfLife:.547},{id:"V46",massNumber:46,exactMass:45.9602005,atomicNumber:23,halfLife:.42237},{id:"V47",massNumber:47,exactMass:46.9549089,atomicNumber:23,halfLife:1956},{id:"V48",massNumber:48,exactMass:47.9522537,atomicNumber:23,halfLife:1380110},{id:"V49",massNumber:49,exactMass:48.9485161,atomicNumber:23,halfLife:28512e3},{id:"V50",massNumber:50,relativeAbundance:.0025,atomicNumber:23,exactMass:49.9471585,spin:"6+",magneticMoment:"+3.34745",halfLife:14e16,betaminusDecay:"",betaminusDecayLikeliness:"17.0",ecDecay:"",ecDecayLikeliness:"83"},{id:"V51",massNumber:51,relativeAbundance:.9975,atomicNumber:23,exactMass:50.9439595,spin:"7/2-",magneticMoment:"+5.1574",halfLife:-1},{id:"V52",massNumber:52,exactMass:51.9447755,atomicNumber:23,halfLife:224.58},{id:"V53",massNumber:53,exactMass:52.944338,atomicNumber:23,halfLife:96.6},{id:"V54",massNumber:54,exactMass:53.94644,atomicNumber:23,halfLife:49.8},{id:"V55",massNumber:55,exactMass:54.94723,atomicNumber:23,halfLife:6.54},{id:"V56",massNumber:56,exactMass:55.95053,atomicNumber:23,halfLife:.23},{id:"V57",massNumber:57,exactMass:56.95256,atomicNumber:23,halfLife:.32},{id:"V58",massNumber:58,exactMass:57.95683,atomicNumber:23,halfLife:.2},{id:"V59",massNumber:59,exactMass:58.96021,atomicNumber:23,halfLife:.13},{id:"V60",massNumber:60,exactMass:59.96503,atomicNumber:23,halfLife:.2},{id:"V61",massNumber:61,exactMass:60.96848,atomicNumber:23},{id:"V62",massNumber:62,exactMass:61.97378,atomicNumber:23},{id:"V63",massNumber:63,exactMass:62.97755,atomicNumber:23},{id:"V64",massNumber:64,exactMass:63.98347,atomicNumber:23},{id:"V65",massNumber:65,exactMass:64.98792,atomicNumber:23}]},{elementSymbol:"Cr",atomicNumber:24,isotopes:[{id:"Cr42",massNumber:42,exactMass:42.00643,atomicNumber:24},{id:"Cr43",massNumber:43,exactMass:42.99771,atomicNumber:24,halfLife:.021},{id:"Cr44",massNumber:44,exactMass:43.98555,atomicNumber:24,halfLife:.053},{id:"Cr45",massNumber:45,exactMass:44.97964,atomicNumber:24,halfLife:.05},{id:"Cr46",massNumber:46,exactMass:45.968359,atomicNumber:24,halfLife:.26},{id:"Cr47",massNumber:47,exactMass:46.9629,atomicNumber:24,halfLife:.5},{id:"Cr48",massNumber:48,exactMass:47.954032,atomicNumber:24,halfLife:77616},{id:"Cr49",massNumber:49,exactMass:48.9513357,atomicNumber:24,halfLife:2538},{id:"Cr50",massNumber:50,relativeAbundance:.043449999999999996,atomicNumber:24,exactMass:49.9460442,spin:"0+"},{id:"Cr51",massNumber:51,exactMass:50.9447674,atomicNumber:24,halfLife:2393500},{id:"Cr52",massNumber:52,relativeAbundance:.83789,atomicNumber:24,exactMass:51.9405075,spin:"0+",halfLife:-1},{id:"Cr53",massNumber:53,relativeAbundance:.09501,atomicNumber:24,exactMass:52.9406494,spin:"3/2-",magneticMoment:"-0.47454",halfLife:-1},{id:"Cr54",massNumber:54,relativeAbundance:.02365,atomicNumber:24,exactMass:53.9388804,spin:"0+",halfLife:-1},{id:"Cr55",massNumber:55,exactMass:54.9408397,atomicNumber:24,halfLife:209.82},{id:"Cr56",massNumber:56,exactMass:55.9406531,atomicNumber:24,halfLife:356.4},{id:"Cr57",massNumber:57,exactMass:56.943613,atomicNumber:24,halfLife:21.1},{id:"Cr58",massNumber:58,exactMass:57.94435,atomicNumber:24,halfLife:7},{id:"Cr59",massNumber:59,exactMass:58.94859,atomicNumber:24,halfLife:.74},{id:"Cr60",massNumber:60,exactMass:59.95008,atomicNumber:24,halfLife:.57},{id:"Cr61",massNumber:61,exactMass:60.95472,atomicNumber:24,halfLife:.27},{id:"Cr62",massNumber:62,exactMass:61.95661,atomicNumber:24,halfLife:.19},{id:"Cr63",massNumber:63,exactMass:62.96186,atomicNumber:24,halfLife:.11},{id:"Cr64",massNumber:64,exactMass:63.96441,atomicNumber:24},{id:"Cr65",massNumber:65,exactMass:64.97016,atomicNumber:24},{id:"Cr66",massNumber:66,exactMass:65.97338,atomicNumber:24},{id:"Cr67",massNumber:67,exactMass:66.97955,atomicNumber:24}]},{elementSymbol:"Mn",atomicNumber:25,isotopes:[{id:"Mn44",massNumber:44,exactMass:44.00687,atomicNumber:25},{id:"Mn45",massNumber:45,exactMass:44.99451,atomicNumber:25},{id:"Mn46",massNumber:46,exactMass:45.98672,atomicNumber:25,halfLife:.041},{id:"Mn47",massNumber:47,exactMass:46.9761,atomicNumber:25,halfLife:.1},{id:"Mn48",massNumber:48,exactMass:47.96852,atomicNumber:25,halfLife:.1581},{id:"Mn49",massNumber:49,exactMass:48.959618,atomicNumber:25,halfLife:.382},{id:"Mn50",massNumber:50,exactMass:49.9542382,atomicNumber:25,halfLife:.28388},{id:"Mn51",massNumber:51,exactMass:50.9482108,atomicNumber:25,halfLife:2772},{id:"Mn52",massNumber:52,exactMass:51.9455655,atomicNumber:25,halfLife:483062},{id:"Mn53",massNumber:53,exactMass:52.9412901,atomicNumber:25},{id:"Mn54",massNumber:54,exactMass:53.9403589,atomicNumber:25,spin:"3+",magneticMoment:"+3.2818",halfLife:26982700,ecDecay:"1.377",ecDecayLikeliness:"100.0"},{id:"Mn55",massNumber:55,relativeAbundance:1,atomicNumber:25,exactMass:54.9380451,spin:"5/2-",magneticMoment:"+3.4687",halfLife:-1},{id:"Mn56",massNumber:56,exactMass:55.9389049,atomicNumber:25,halfLife:9282.6},{id:"Mn57",massNumber:57,exactMass:56.9382854,atomicNumber:25,halfLife:85.4},{id:"Mn58",massNumber:58,exactMass:57.93998,atomicNumber:25,halfLife:3},{id:"Mn59",massNumber:59,exactMass:58.94044,atomicNumber:25,halfLife:4.6},{id:"Mn60",massNumber:60,exactMass:59.94291,atomicNumber:25,halfLife:51},{id:"Mn61",massNumber:61,exactMass:60.94465,atomicNumber:25,halfLife:.71},{id:"Mn62",massNumber:62,exactMass:61.94843,atomicNumber:25,halfLife:.88},{id:"Mn63",massNumber:63,exactMass:62.95024,atomicNumber:25,halfLife:.25},{id:"Mn64",massNumber:64,exactMass:63.95425,atomicNumber:25,halfLife:.14},{id:"Mn65",massNumber:65,exactMass:64.95634,atomicNumber:25,halfLife:.11},{id:"Mn66",massNumber:66,exactMass:65.96108,atomicNumber:25,halfLife:.09},{id:"Mn67",massNumber:67,exactMass:66.96414,atomicNumber:25},{id:"Mn68",massNumber:68,exactMass:67.9693,atomicNumber:25},{id:"Mn69",massNumber:69,exactMass:68.97284,atomicNumber:25}]},{elementSymbol:"Fe",atomicNumber:26,isotopes:[{id:"Fe45",massNumber:45,exactMass:45.01458,atomicNumber:26},{id:"Fe46",massNumber:46,exactMass:46.00081,atomicNumber:26,halfLife:.02},{id:"Fe47",massNumber:47,exactMass:46.99289,atomicNumber:26,halfLife:.027},{id:"Fe48",massNumber:48,exactMass:47.9805,atomicNumber:26,halfLife:.044},{id:"Fe49",massNumber:49,exactMass:48.97361,atomicNumber:26,halfLife:.07},{id:"Fe50",massNumber:50,exactMass:49.96299,atomicNumber:26,halfLife:.15},{id:"Fe51",massNumber:51,exactMass:50.95682,atomicNumber:26,halfLife:.305},{id:"Fe52",massNumber:52,exactMass:51.948114,atomicNumber:26,halfLife:29790},{id:"Fe53",massNumber:53,exactMass:52.9453079,atomicNumber:26,halfLife:510.6},{id:"Fe54",massNumber:54,relativeAbundance:.058449999999999995,atomicNumber:26,exactMass:53.9396105,spin:"0+",halfLife:-1},{id:"Fe55",massNumber:55,exactMass:54.9382934,atomicNumber:26,halfLife:86093300},{id:"Fe56",massNumber:56,relativeAbundance:.91754,atomicNumber:26,exactMass:55.9349375,spin:"0+",halfLife:-1},{id:"Fe57",massNumber:57,relativeAbundance:.02119,atomicNumber:26,exactMass:56.935394,spin:"1/2-",magneticMoment:"+0.09044",halfLife:-1},{id:"Fe58",massNumber:58,relativeAbundance:.0028199999999999996,atomicNumber:26,exactMass:57.9332756,spin:"0+",halfLife:-1},{id:"Fe59",massNumber:59,exactMass:58.9348755,atomicNumber:26,halfLife:3845060},{id:"Fe60",massNumber:60,exactMass:59.934072,atomicNumber:26},{id:"Fe61",massNumber:61,exactMass:60.936745,atomicNumber:26,halfLife:358.8},{id:"Fe62",massNumber:62,exactMass:61.936767,atomicNumber:26,halfLife:68},{id:"Fe63",massNumber:63,exactMass:62.94037,atomicNumber:26,halfLife:6.1},{id:"Fe64",massNumber:64,exactMass:63.9412,atomicNumber:26},{id:"Fe65",massNumber:65,exactMass:64.94538,atomicNumber:26,halfLife:.4},{id:"Fe66",massNumber:66,exactMass:65.94678,atomicNumber:26,halfLife:.44},{id:"Fe67",massNumber:67,exactMass:66.95095,atomicNumber:26,halfLife:.47},{id:"Fe68",massNumber:68,exactMass:67.9537,atomicNumber:26,halfLife:.1},{id:"Fe69",massNumber:69,exactMass:68.95878,atomicNumber:26,halfLife:.17},{id:"Fe70",massNumber:70,exactMass:69.96146,atomicNumber:26},{id:"Fe71",massNumber:71,exactMass:70.96672,atomicNumber:26},{id:"Fe72",massNumber:72,exactMass:71.96962,atomicNumber:26}]},{elementSymbol:"Co",atomicNumber:27,isotopes:[{id:"Co47",massNumber:47,exactMass:47.01149,atomicNumber:27},{id:"Co48",massNumber:48,exactMass:48.00176,atomicNumber:27},{id:"Co49",massNumber:49,exactMass:48.98972,atomicNumber:27},{id:"Co50",massNumber:50,exactMass:49.98154,atomicNumber:27,halfLife:.044},{id:"Co51",massNumber:51,exactMass:50.97072,atomicNumber:27},{id:"Co52",massNumber:52,exactMass:51.96359,atomicNumber:27,halfLife:.018},{id:"Co53",massNumber:53,exactMass:52.954219,atomicNumber:27,halfLife:.24},{id:"Co54",massNumber:54,exactMass:53.9484596,atomicNumber:27,halfLife:.19323},{id:"Co55",massNumber:55,exactMass:54.941999,atomicNumber:27,halfLife:63108},{id:"Co56",massNumber:56,exactMass:55.9398393,atomicNumber:27,spin:"4+",halfLife:6676130,betaplusDecay:"4.566",betaplusDecayLikeliness:"100.0",ecDecay:"",ecDecayLikeliness:"100.0"},{id:"Co57",massNumber:57,exactMass:56.9362914,atomicNumber:27,spin:"7/2-",halfLife:23482700,ecDecay:"0.836",ecDecayLikeliness:"100.0"},{id:"Co58",massNumber:58,exactMass:57.9357528,atomicNumber:27,spin:"2+",halfLife:6122300,betaplusDecay:"2.3",betaplusDecayLikeliness:"100.0",ecDecay:"",ecDecayLikeliness:"100.0"},{id:"Co59",massNumber:59,relativeAbundance:1,atomicNumber:27,exactMass:58.933195,spin:"7/2-",magneticMoment:"+4.627",halfLife:-1},{id:"Co60",massNumber:60,exactMass:59.9338171,atomicNumber:27,spin:"5+",magneticMoment:"+3.799",halfLife:166239e3,betaminusDecay:"2.824",betaminusDecayLikeliness:"100.0"},{id:"Co61",massNumber:61,exactMass:60.9324758,atomicNumber:27,halfLife:5940},{id:"Co62",massNumber:62,exactMass:61.934051,atomicNumber:27,halfLife:90},{id:"Co63",massNumber:63,exactMass:62.933612,atomicNumber:27,halfLife:27.4},{id:"Co64",massNumber:64,exactMass:63.93581,atomicNumber:27,halfLife:.3},{id:"Co65",massNumber:65,exactMass:64.936478,atomicNumber:27,halfLife:1.2},{id:"Co66",massNumber:66,exactMass:65.93976,atomicNumber:27,halfLife:.233},{id:"Co67",massNumber:67,exactMass:66.94089,atomicNumber:27,halfLife:.42},{id:"Co68",massNumber:68,exactMass:67.94487,atomicNumber:27,halfLife:.18},{id:"Co69",massNumber:69,exactMass:68.94632,atomicNumber:27,halfLife:.27},{id:"Co70",massNumber:70,exactMass:69.951,atomicNumber:27,halfLife:.15},{id:"Co71",massNumber:71,exactMass:70.9529,atomicNumber:27,halfLife:.21},{id:"Co72",massNumber:72,exactMass:71.95781,atomicNumber:27,halfLife:.09},{id:"Co73",massNumber:73,exactMass:72.96024,atomicNumber:27},{id:"Co74",massNumber:74,exactMass:73.96538,atomicNumber:27},{id:"Co75",massNumber:75,exactMass:74.96833,atomicNumber:27}]},{elementSymbol:"Ni",atomicNumber:28,isotopes:[{id:"Ni48",massNumber:48,exactMass:48.01975,atomicNumber:28},{id:"Ni49",massNumber:49,exactMass:49.00966,atomicNumber:28},{id:"Ni50",massNumber:50,exactMass:49.99593,atomicNumber:28},{id:"Ni51",massNumber:51,exactMass:50.98772,atomicNumber:28},{id:"Ni52",massNumber:52,exactMass:51.97568,atomicNumber:28,halfLife:.038},{id:"Ni53",massNumber:53,exactMass:52.96847,atomicNumber:28,halfLife:.045},{id:"Ni54",massNumber:54,exactMass:53.95791,atomicNumber:28},{id:"Ni55",massNumber:55,exactMass:54.95133,atomicNumber:28,halfLife:.2121},{id:"Ni56",massNumber:56,exactMass:55.942132,atomicNumber:28,halfLife:525053},{id:"Ni57",massNumber:57,exactMass:56.9397935,atomicNumber:28,halfLife:128160},{id:"Ni58",massNumber:58,relativeAbundance:.680769,atomicNumber:28,exactMass:57.9353429,spin:"0+",halfLife:-1},{id:"Ni59",massNumber:59,exactMass:58.9343467,atomicNumber:28,spin:"3/2-",halfLife:75e3,ecDecay:"1.072",ecDecayLikeliness:"100.0"},{id:"Ni60",massNumber:60,relativeAbundance:.262231,atomicNumber:28,exactMass:59.9307864,spin:"0+",halfLife:-1},{id:"Ni61",massNumber:61,relativeAbundance:.011399,atomicNumber:28,exactMass:60.931056,spin:"3/2-",magneticMoment:"-0.75002",halfLife:-1},{id:"Ni62",massNumber:62,relativeAbundance:.036345,atomicNumber:28,exactMass:61.9283451,spin:"0+",halfLife:-1},{id:"Ni63",massNumber:63,exactMass:62.9296694,atomicNumber:28,spin:"1/2-",halfLife:315675e4,betaminusDecay:"0.065",betaminusDecayLikeliness:"100.0"},{id:"Ni64",massNumber:64,relativeAbundance:.009256,atomicNumber:28,exactMass:63.927966,spin:"0+",halfLife:-1},{id:"Ni65",massNumber:65,exactMass:64.9300843,atomicNumber:28,halfLife:9061.92},{id:"Ni66",massNumber:66,exactMass:65.9291393,atomicNumber:28,halfLife:196560},{id:"Ni67",massNumber:67,exactMass:66.931569,atomicNumber:28,halfLife:21},{id:"Ni68",massNumber:68,exactMass:67.931869,atomicNumber:28,halfLife:19},{id:"Ni69",massNumber:69,exactMass:68.93561,atomicNumber:28,halfLife:11.4},{id:"Ni70",massNumber:70,exactMass:69.9365,atomicNumber:28},{id:"Ni71",massNumber:71,exactMass:70.94074,atomicNumber:28,halfLife:1.86},{id:"Ni72",massNumber:72,exactMass:71.94209,atomicNumber:28,halfLife:2.1},{id:"Ni73",massNumber:73,exactMass:72.94647,atomicNumber:28,halfLife:.7},{id:"Ni74",massNumber:74,exactMass:73.94807,atomicNumber:28,halfLife:.54},{id:"Ni75",massNumber:75,exactMass:74.95287,atomicNumber:28,halfLife:.6},{id:"Ni76",massNumber:76,exactMass:75.95533,atomicNumber:28,halfLife:.24},{id:"Ni77",massNumber:77,exactMass:76.96055,atomicNumber:28},{id:"Ni78",massNumber:78,exactMass:77.96318,atomicNumber:28}]},{elementSymbol:"Cu",atomicNumber:29,isotopes:[{id:"Cu52",massNumber:52,exactMass:51.99718,atomicNumber:29},{id:"Cu53",massNumber:53,exactMass:52.98555,atomicNumber:29},{id:"Cu54",massNumber:54,exactMass:53.97671,atomicNumber:29},{id:"Cu55",massNumber:55,exactMass:54.96605,atomicNumber:29},{id:"Cu56",massNumber:56,exactMass:55.95856,atomicNumber:29},{id:"Cu57",massNumber:57,exactMass:56.949211,atomicNumber:29,halfLife:.1994},{id:"Cu58",massNumber:58,exactMass:57.9445385,atomicNumber:29,halfLife:3.204},{id:"Cu59",massNumber:59,exactMass:58.939498,atomicNumber:29,halfLife:81.5},{id:"Cu60",massNumber:60,exactMass:59.937365,atomicNumber:29,halfLife:1422},{id:"Cu61",massNumber:61,exactMass:60.9334578,atomicNumber:29,halfLife:11998.8},{id:"Cu62",massNumber:62,exactMass:61.932584,atomicNumber:29,halfLife:584.4},{id:"Cu63",massNumber:63,relativeAbundance:.6917,atomicNumber:29,exactMass:62.9295975,spin:"3/2-",magneticMoment:"+2.2233",halfLife:-1},{id:"Cu64",massNumber:64,exactMass:63.9297642,atomicNumber:29,spin:"1+",magneticMoment:"-0.217",halfLife:45720,betaplusDecay:"1.7",betaplusDecayLikeliness:"19.0",betaminusDecay:"0.578",betaminusDecayLikeliness:"39.0",ecDecay:"1.675",ecDecayLikeliness:"41.0"},{id:"Cu65",massNumber:65,relativeAbundance:.30829999999999996,atomicNumber:29,exactMass:64.9277895,spin:"3/2-",magneticMoment:"+2.3817",halfLife:-1},{id:"Cu66",massNumber:66,exactMass:65.9288688,atomicNumber:29,halfLife:307.2},{id:"Cu67",massNumber:67,exactMass:66.9277303,atomicNumber:29,halfLife:222588},{id:"Cu68",massNumber:68,exactMass:67.9296109,atomicNumber:29,halfLife:31.1},{id:"Cu69",massNumber:69,exactMass:68.9294293,atomicNumber:29,halfLife:171},{id:"Cu70",massNumber:70,exactMass:69.9323923,atomicNumber:29,halfLife:4.5},{id:"Cu71",massNumber:71,exactMass:70.9326768,atomicNumber:29,halfLife:19.5},{id:"Cu72",massNumber:72,exactMass:71.9358203,atomicNumber:29,halfLife:6.6},{id:"Cu73",massNumber:73,exactMass:72.936675,atomicNumber:29,halfLife:3.9},{id:"Cu74",massNumber:74,exactMass:73.939875,atomicNumber:29,halfLife:1.594},{id:"Cu75",massNumber:75,exactMass:74.9419,atomicNumber:29,halfLife:1.224},{id:"Cu76",massNumber:76,exactMass:75.945275,atomicNumber:29,halfLife:.641},{id:"Cu77",massNumber:77,exactMass:76.94785,atomicNumber:29,halfLife:.469},{id:"Cu78",massNumber:78,exactMass:77.95196,atomicNumber:29,halfLife:.342},{id:"Cu79",massNumber:79,exactMass:78.95456,atomicNumber:29,halfLife:.188},{id:"Cu80",massNumber:80,exactMass:79.96087,atomicNumber:29}]},{elementSymbol:"Zn",atomicNumber:30,isotopes:[{id:"Zn54",massNumber:54,exactMass:53.99295,atomicNumber:30},{id:"Zn55",massNumber:55,exactMass:54.98398,atomicNumber:30},{id:"Zn56",massNumber:56,exactMass:55.97238,atomicNumber:30},{id:"Zn57",massNumber:57,exactMass:56.96479,atomicNumber:30,halfLife:.04},{id:"Zn58",massNumber:58,exactMass:57.95459,atomicNumber:30,halfLife:.065},{id:"Zn59",massNumber:59,exactMass:58.94926,atomicNumber:30,halfLife:.182},{id:"Zn60",massNumber:60,exactMass:59.941827,atomicNumber:30,halfLife:142.8},{id:"Zn61",massNumber:61,exactMass:60.939511,atomicNumber:30,halfLife:89.1},{id:"Zn62",massNumber:62,exactMass:61.93433,atomicNumber:30,halfLife:33069.6},{id:"Zn63",massNumber:63,exactMass:62.9332116,atomicNumber:30,halfLife:2308.2},{id:"Zn64",massNumber:64,relativeAbundance:.4863,atomicNumber:30,exactMass:63.9291422,spin:"0+",halfLife:-1},{id:"Zn65",massNumber:65,exactMass:64.929241,atomicNumber:30,spin:"5/2-",magneticMoment:"+0.7690",halfLife:21104100,betaplusDecay:"1.352",betaplusDecayLikeliness:"98.0",ecDecay:"",ecDecayLikeliness:"1.5"},{id:"Zn66",massNumber:66,relativeAbundance:.27899999999999997,atomicNumber:30,exactMass:65.9260334,spin:"0+",halfLife:-1},{id:"Zn67",massNumber:67,relativeAbundance:.040999999999999995,atomicNumber:30,exactMass:66.9271273,spin:"5/2-",magneticMoment:"+0.87515",halfLife:-1},{id:"Zn68",massNumber:68,relativeAbundance:.1875,atomicNumber:30,exactMass:67.9248442,spin:"0+",halfLife:-1},{id:"Zn69",massNumber:69,exactMass:68.9265503,atomicNumber:30,halfLife:3384},{id:"Zn70",massNumber:70,relativeAbundance:.0062,atomicNumber:30,exactMass:69.9253193,spin:"0+"},{id:"Zn71",massNumber:71,exactMass:70.927722,atomicNumber:30,halfLife:147},{id:"Zn72",massNumber:72,exactMass:71.926858,atomicNumber:30,halfLife:167400},{id:"Zn73",massNumber:73,exactMass:72.92978,atomicNumber:30,halfLife:23.5},{id:"Zn74",massNumber:74,exactMass:73.92946,atomicNumber:30,halfLife:95.6},{id:"Zn75",massNumber:75,exactMass:74.93294,atomicNumber:30,halfLife:10.2},{id:"Zn76",massNumber:76,exactMass:75.93329,atomicNumber:30,halfLife:5.7},{id:"Zn77",massNumber:77,exactMass:76.93696,atomicNumber:30,halfLife:2.08},{id:"Zn78",massNumber:78,exactMass:77.93844,atomicNumber:30,halfLife:1.47},{id:"Zn79",massNumber:79,exactMass:78.94265,atomicNumber:30,halfLife:.995},{id:"Zn80",massNumber:80,exactMass:79.94434,atomicNumber:30,halfLife:.545},{id:"Zn81",massNumber:81,exactMass:80.95048,atomicNumber:30,halfLife:.29},{id:"Zn82",massNumber:82,exactMass:81.95442,atomicNumber:30},{id:"Zn83",massNumber:83,exactMass:82.96103,atomicNumber:30}]},{elementSymbol:"Ga",atomicNumber:31,isotopes:[{id:"Ga56",massNumber:56,exactMass:55.99491,atomicNumber:31},{id:"Ga57",massNumber:57,exactMass:56.98293,atomicNumber:31},{id:"Ga58",massNumber:58,exactMass:57.97425,atomicNumber:31},{id:"Ga59",massNumber:59,exactMass:58.96337,atomicNumber:31},{id:"Ga60",massNumber:60,exactMass:59.95706,atomicNumber:31},{id:"Ga61",massNumber:61,exactMass:60.94945,atomicNumber:31,halfLife:.15},{id:"Ga62",massNumber:62,exactMass:61.944175,atomicNumber:31,halfLife:.11612},{id:"Ga63",massNumber:63,exactMass:62.9392942,atomicNumber:31,halfLife:32.4},{id:"Ga64",massNumber:64,exactMass:63.9368387,atomicNumber:31,halfLife:157.62},{id:"Ga65",massNumber:65,exactMass:64.9327348,atomicNumber:31,halfLife:912},{id:"Ga66",massNumber:66,exactMass:65.931589,atomicNumber:31,halfLife:34164},{id:"Ga67",massNumber:67,exactMass:66.9282017,atomicNumber:31,halfLife:281768},{id:"Ga68",massNumber:68,exactMass:67.9279801,atomicNumber:31,halfLife:4057.74},{id:"Ga69",massNumber:69,relativeAbundance:.60108,atomicNumber:31,exactMass:68.9255736,spin:"3/2-",magneticMoment:"+2.01659",halfLife:-1},{id:"Ga70",massNumber:70,exactMass:69.926022,atomicNumber:31,halfLife:1268.4},{id:"Ga71",massNumber:71,relativeAbundance:.39892000000000005,atomicNumber:31,exactMass:70.9247013,spin:"3/2-",magneticMoment:"2.56227",halfLife:-1},{id:"Ga72",massNumber:72,exactMass:71.9263663,atomicNumber:31,halfLife:50760},{id:"Ga73",massNumber:73,exactMass:72.9251747,atomicNumber:31,halfLife:17496},{id:"Ga74",massNumber:74,exactMass:73.926946,atomicNumber:31,halfLife:487.2},{id:"Ga75",massNumber:75,exactMass:74.9265002,atomicNumber:31,halfLife:126},{id:"Ga76",massNumber:76,exactMass:75.9288276,atomicNumber:31,halfLife:32.6},{id:"Ga77",massNumber:77,exactMass:76.9291543,atomicNumber:31,halfLife:13.2},{id:"Ga78",massNumber:78,exactMass:77.9316082,atomicNumber:31,halfLife:5.09},{id:"Ga79",massNumber:79,exactMass:78.93289,atomicNumber:31,halfLife:2.847},{id:"Ga80",massNumber:80,exactMass:79.93652,atomicNumber:31,halfLife:1.697},{id:"Ga81",massNumber:81,exactMass:80.93775,atomicNumber:31,halfLife:1.217},{id:"Ga82",massNumber:82,exactMass:81.94299,atomicNumber:31,halfLife:.599},{id:"Ga83",massNumber:83,exactMass:82.94698,atomicNumber:31,halfLife:.31},{id:"Ga84",massNumber:84,exactMass:83.95265,atomicNumber:31,halfLife:.085},{id:"Ga85",massNumber:85,exactMass:84.957,atomicNumber:31},{id:"Ga86",massNumber:86,exactMass:85.96312,atomicNumber:31}]},{elementSymbol:"Ge",atomicNumber:32,isotopes:[{id:"Ge58",massNumber:58,exactMass:57.99101,atomicNumber:32},{id:"Ge59",massNumber:59,exactMass:58.98175,atomicNumber:32},{id:"Ge60",massNumber:60,exactMass:59.97019,atomicNumber:32},{id:"Ge61",massNumber:61,exactMass:60.96379,atomicNumber:32,halfLife:.04},{id:"Ge62",massNumber:62,exactMass:61.95465,atomicNumber:32},{id:"Ge63",massNumber:63,exactMass:62.94964,atomicNumber:32,halfLife:.095},{id:"Ge64",massNumber:64,exactMass:63.94165,atomicNumber:32,halfLife:63.7},{id:"Ge65",massNumber:65,exactMass:64.93944,atomicNumber:32,halfLife:30.9},{id:"Ge66",massNumber:66,exactMass:65.93384,atomicNumber:32,halfLife:8136},{id:"Ge67",massNumber:67,exactMass:66.932734,atomicNumber:32,halfLife:1134},{id:"Ge68",massNumber:68,exactMass:67.928094,atomicNumber:32,halfLife:23397100},{id:"Ge69",massNumber:69,exactMass:68.9279645,atomicNumber:32,halfLife:140580},{id:"Ge70",massNumber:70,relativeAbundance:.2084,atomicNumber:32,exactMass:69.9242474,spin:"0+",halfLife:-1},{id:"Ge71",massNumber:71,exactMass:70.924951,atomicNumber:32,halfLife:987552},{id:"Ge72",massNumber:72,relativeAbundance:.2754,atomicNumber:32,exactMass:71.9220758,spin:"0+",halfLife:-1},{id:"Ge73",massNumber:73,relativeAbundance:.07730000000000001,atomicNumber:32,exactMass:72.9234589,spin:"9/2+",magneticMoment:"-0.879467",halfLife:-1},{id:"Ge74",massNumber:74,relativeAbundance:.3628,atomicNumber:32,exactMass:73.9211778,spin:"0+",halfLife:-1},{id:"Ge75",massNumber:75,exactMass:74.9228589,atomicNumber:32,halfLife:4966.8},{id:"Ge76",massNumber:76,relativeAbundance:.0761,atomicNumber:32,exactMass:75.9214026,spin:"0+",halfLife:-1},{id:"Ge77",massNumber:77,exactMass:76.9235486,atomicNumber:32,halfLife:40680},{id:"Ge78",massNumber:78,exactMass:77.922853,atomicNumber:32,halfLife:5280},{id:"Ge79",massNumber:79,exactMass:78.9254,atomicNumber:32,halfLife:18.98},{id:"Ge80",massNumber:80,exactMass:79.92537,atomicNumber:32,halfLife:29.5},{id:"Ge81",massNumber:81,exactMass:80.92882,atomicNumber:32,halfLife:7.6},{id:"Ge82",massNumber:82,exactMass:81.92955,atomicNumber:32,halfLife:4.6},{id:"Ge83",massNumber:83,exactMass:82.93462,atomicNumber:32,halfLife:1.85},{id:"Ge84",massNumber:84,exactMass:83.93747,atomicNumber:32},{id:"Ge85",massNumber:85,exactMass:84.94303,atomicNumber:32},{id:"Ge86",massNumber:86,exactMass:85.94649,atomicNumber:32},{id:"Ge87",massNumber:87,exactMass:86.95251,atomicNumber:32},{id:"Ge88",massNumber:88,exactMass:87.95691,atomicNumber:32},{id:"Ge89",massNumber:89,exactMass:88.96383,atomicNumber:32}]},{elementSymbol:"As",atomicNumber:33,isotopes:[{id:"As60",massNumber:60,exactMass:59.99313,atomicNumber:33},{id:"As61",massNumber:61,exactMass:60.98062,atomicNumber:33},{id:"As62",massNumber:62,exactMass:61.9732,atomicNumber:33},{id:"As63",massNumber:63,exactMass:62.96369,atomicNumber:33},{id:"As64",massNumber:64,exactMass:63.95757,atomicNumber:33},{id:"As65",massNumber:65,exactMass:64.94956,atomicNumber:33,halfLife:.19},{id:"As66",massNumber:66,exactMass:65.94471,atomicNumber:33,halfLife:.09577},{id:"As67",massNumber:67,exactMass:66.93919,atomicNumber:33,halfLife:42.5},{id:"As68",massNumber:68,exactMass:67.93677,atomicNumber:33,halfLife:151.6},{id:"As69",massNumber:69,exactMass:68.93227,atomicNumber:33,halfLife:912},{id:"As70",massNumber:70,exactMass:69.93092,atomicNumber:33,halfLife:3156},{id:"As71",massNumber:71,exactMass:70.927112,atomicNumber:33,halfLife:235008},{id:"As72",massNumber:72,exactMass:71.926752,atomicNumber:33,halfLife:93600},{id:"As73",massNumber:73,exactMass:72.923825,atomicNumber:33,halfLife:6937920},{id:"As74",massNumber:74,exactMass:73.9239287,atomicNumber:33,halfLife:1535330},{id:"As75",massNumber:75,relativeAbundance:1,atomicNumber:33,exactMass:74.9215965,spin:"3/2-",magneticMoment:"+1.43947",halfLife:-1},{id:"As76",massNumber:76,exactMass:75.922394,atomicNumber:33,spin:"2-",magneticMoment:"-0.906",halfLife:93121.9,betaminusDecay:"2.97",betaminusDecayLikeliness:"100.0"},{id:"As77",massNumber:77,exactMass:76.9206473,atomicNumber:33,halfLife:139788},{id:"As78",massNumber:78,exactMass:77.921827,atomicNumber:33,halfLife:5442},{id:"As79",massNumber:79,exactMass:78.920948,atomicNumber:33,halfLife:540.6},{id:"As80",massNumber:80,exactMass:79.922534,atomicNumber:33,halfLife:15.2},{id:"As81",massNumber:81,exactMass:80.922132,atomicNumber:33,halfLife:33.3},{id:"As82",massNumber:82,exactMass:81.9245,atomicNumber:33,halfLife:19.1},{id:"As83",massNumber:83,exactMass:82.92498,atomicNumber:33,halfLife:13.4},{id:"As84",massNumber:84,exactMass:83.92906,atomicNumber:33,halfLife:4.5},{id:"As85",massNumber:85,exactMass:84.93202,atomicNumber:33,halfLife:2.021},{id:"As86",massNumber:86,exactMass:85.9365,atomicNumber:33,halfLife:.945},{id:"As87",massNumber:87,exactMass:86.9399,atomicNumber:33,halfLife:.48},{id:"As88",massNumber:88,exactMass:87.94494,atomicNumber:33},{id:"As89",massNumber:89,exactMass:88.94939,atomicNumber:33},{id:"As90",massNumber:90,exactMass:89.9555,atomicNumber:33},{id:"As91",massNumber:91,exactMass:90.96043,atomicNumber:33},{id:"As92",massNumber:92,exactMass:91.9668,atomicNumber:33}]},{elementSymbol:"Se",atomicNumber:34,isotopes:[{id:"Se65",massNumber:65,exactMass:64.96466,atomicNumber:34},{id:"Se66",massNumber:66,exactMass:65.95521,atomicNumber:34},{id:"Se67",massNumber:67,exactMass:66.95009,atomicNumber:34,halfLife:.06},{id:"Se68",massNumber:68,exactMass:67.9418,atomicNumber:34,halfLife:35.5},{id:"Se69",massNumber:69,exactMass:68.93956,atomicNumber:34,halfLife:27.4},{id:"Se70",massNumber:70,exactMass:69.93339,atomicNumber:34,halfLife:2466},{id:"Se71",massNumber:71,exactMass:70.93224,atomicNumber:34,halfLife:284.4},{id:"Se72",massNumber:72,exactMass:71.927112,atomicNumber:34,halfLife:725760},{id:"Se73",massNumber:73,exactMass:72.926765,atomicNumber:34,halfLife:25740},{id:"Se74",massNumber:74,relativeAbundance:.0089,atomicNumber:34,exactMass:73.9224764,spin:"0+",halfLife:-1},{id:"Se75",massNumber:75,exactMass:74.9225234,atomicNumber:34,halfLife:10348900},{id:"Se76",massNumber:76,relativeAbundance:.09369999999999999,atomicNumber:34,exactMass:75.9192136,spin:"0+",halfLife:-1},{id:"Se77",massNumber:77,relativeAbundance:.07629999999999999,atomicNumber:34,exactMass:76.919914,spin:"1/2-",magneticMoment:"+0.535506",halfLife:-1},{id:"Se78",massNumber:78,relativeAbundance:.2377,atomicNumber:34,exactMass:77.9173091,spin:"0+",halfLife:-1},{id:"Se79",massNumber:79,exactMass:78.9184991,atomicNumber:34},{id:"Se80",massNumber:80,relativeAbundance:.4961,atomicNumber:34,exactMass:79.9165213,spin:"0+",halfLife:-1},{id:"Se81",massNumber:81,exactMass:80.9179925,atomicNumber:34,halfLife:1107},{id:"Se82",massNumber:82,relativeAbundance:.0873,atomicNumber:34,exactMass:81.9166994,spin:"0+"},{id:"Se83",massNumber:83,exactMass:82.919118,atomicNumber:34,halfLife:1338},{id:"Se84",massNumber:84,exactMass:83.918462,atomicNumber:34,halfLife:186},{id:"Se85",massNumber:85,exactMass:84.92225,atomicNumber:34,halfLife:31.7},{id:"Se86",massNumber:86,exactMass:85.924272,atomicNumber:34,halfLife:15.3},{id:"Se87",massNumber:87,exactMass:86.92852,atomicNumber:34,halfLife:5.29},{id:"Se88",massNumber:88,exactMass:87.93142,atomicNumber:34,halfLife:1.53},{id:"Se89",massNumber:89,exactMass:88.93645,atomicNumber:34,halfLife:.41},{id:"Se90",massNumber:90,exactMass:89.93996,atomicNumber:34},{id:"Se91",massNumber:91,exactMass:90.94596,atomicNumber:34,halfLife:.27},{id:"Se92",massNumber:92,exactMass:91.94992,atomicNumber:34},{id:"Se93",massNumber:93,exactMass:92.95629,atomicNumber:34},{id:"Se94",massNumber:94,exactMass:93.96049,atomicNumber:34}]},{elementSymbol:"Br",atomicNumber:35,isotopes:[{id:"Br67",massNumber:67,exactMass:66.96479,atomicNumber:35},{id:"Br68",massNumber:68,exactMass:67.95852,atomicNumber:35},{id:"Br69",massNumber:69,exactMass:68.95011,atomicNumber:35},{id:"Br70",massNumber:70,exactMass:69.94479,atomicNumber:35,halfLife:.0791},{id:"Br71",massNumber:71,exactMass:70.93874,atomicNumber:35,halfLife:21.4},{id:"Br72",massNumber:72,exactMass:71.93664,atomicNumber:35,halfLife:78.6},{id:"Br73",massNumber:73,exactMass:72.93169,atomicNumber:35,halfLife:204},{id:"Br74",massNumber:74,exactMass:73.929891,atomicNumber:35,halfLife:1524},{id:"Br75",massNumber:75,exactMass:74.925776,atomicNumber:35,halfLife:5802},{id:"Br76",massNumber:76,exactMass:75.924541,atomicNumber:35,halfLife:58320},{id:"Br77",massNumber:77,exactMass:76.921379,atomicNumber:35,halfLife:205330},{id:"Br78",massNumber:78,exactMass:77.921146,atomicNumber:35,halfLife:387.6},{id:"Br79",massNumber:79,relativeAbundance:.5069,atomicNumber:35,exactMass:78.9183371,spin:"3/2-",magneticMoment:"+2.1064",halfLife:-1},{id:"Br80",massNumber:80,exactMass:79.9185293,atomicNumber:35,halfLife:1060.8},{id:"Br81",massNumber:81,relativeAbundance:.49310000000000004,atomicNumber:35,exactMass:80.9162906,spin:"3/2-",magneticMoment:"+2.2706",halfLife:-1},{id:"Br82",massNumber:82,exactMass:81.9168041,atomicNumber:35,halfLife:127080},{id:"Br83",massNumber:83,exactMass:82.91518,atomicNumber:35,halfLife:8640},{id:"Br84",massNumber:84,exactMass:83.916479,atomicNumber:35,halfLife:1908},{id:"Br85",massNumber:85,exactMass:84.915608,atomicNumber:35,halfLife:174},{id:"Br86",massNumber:86,exactMass:85.918798,atomicNumber:35,halfLife:55.1},{id:"Br87",massNumber:87,exactMass:86.920711,atomicNumber:35,halfLife:55.6},{id:"Br88",massNumber:88,exactMass:87.92407,atomicNumber:35,halfLife:16.34},{id:"Br89",massNumber:89,exactMass:88.92639,atomicNumber:35,halfLife:4.348},{id:"Br90",massNumber:90,exactMass:89.93063,atomicNumber:35,halfLife:1.91},{id:"Br91",massNumber:91,exactMass:90.93397,atomicNumber:35,halfLife:.541},{id:"Br92",massNumber:92,exactMass:91.93926,atomicNumber:35,halfLife:.343},{id:"Br93",massNumber:93,exactMass:92.94305,atomicNumber:35,halfLife:.102},{id:"Br94",massNumber:94,exactMass:93.94868,atomicNumber:35,halfLife:.07},{id:"Br95",massNumber:95,exactMass:94.95287,atomicNumber:35},{id:"Br96",massNumber:96,exactMass:95.95853,atomicNumber:35},{id:"Br97",massNumber:97,exactMass:96.9628,atomicNumber:35}]},{elementSymbol:"Kr",atomicNumber:36,isotopes:[{id:"Kr69",massNumber:69,exactMass:68.96518,atomicNumber:36},{id:"Kr70",massNumber:70,exactMass:69.95526,atomicNumber:36},{id:"Kr71",massNumber:71,exactMass:70.94963,atomicNumber:36,halfLife:.064},{id:"Kr72",massNumber:72,exactMass:71.942092,atomicNumber:36,halfLife:17.2},{id:"Kr73",massNumber:73,exactMass:72.939289,atomicNumber:36,halfLife:27},{id:"Kr74",massNumber:74,exactMass:73.9330844,atomicNumber:36,halfLife:690},{id:"Kr75",massNumber:75,exactMass:74.930946,atomicNumber:36,halfLife:258},{id:"Kr76",massNumber:76,exactMass:75.92591,atomicNumber:36,halfLife:53280},{id:"Kr77",massNumber:77,exactMass:76.92467,atomicNumber:36,halfLife:4464},{id:"Kr78",massNumber:78,relativeAbundance:.0034999999999999996,atomicNumber:36,exactMass:77.9203648,spin:"0+",halfLife:-1},{id:"Kr79",massNumber:79,exactMass:78.920082,atomicNumber:36,halfLife:126144},{id:"Kr80",massNumber:80,relativeAbundance:.022799999999999997,atomicNumber:36,exactMass:79.916379,spin:"0+",halfLife:-1},{id:"Kr81",massNumber:81,exactMass:80.916592,atomicNumber:36},{id:"Kr82",massNumber:82,relativeAbundance:.1158,atomicNumber:36,exactMass:81.9134836,spin:"0+",halfLife:-1},{id:"Kr83",massNumber:83,relativeAbundance:.1149,atomicNumber:36,exactMass:82.914136,spin:"9/2+",magneticMoment:"-0.970669",halfLife:-1},{id:"Kr84",massNumber:84,relativeAbundance:.57,atomicNumber:36,exactMass:83.911507,spin:"0+",halfLife:-1},{id:"Kr85",massNumber:85,exactMass:84.9125273,atomicNumber:36,halfLife:339201e3},{id:"Kr86",massNumber:86,relativeAbundance:.17300000000000001,atomicNumber:36,exactMass:85.91061073,spin:"0+",halfLife:-1},{id:"Kr87",massNumber:87,exactMass:86.91335486,atomicNumber:36,halfLife:4578},{id:"Kr88",massNumber:88,exactMass:87.914447,atomicNumber:36,halfLife:10224},{id:"Kr89",massNumber:89,exactMass:88.91763,atomicNumber:36,halfLife:189},{id:"Kr90",massNumber:90,exactMass:89.919517,atomicNumber:36,halfLife:32.32},{id:"Kr91",massNumber:91,exactMass:90.92345,atomicNumber:36,halfLife:8.57},{id:"Kr92",massNumber:92,exactMass:91.926156,atomicNumber:36,halfLife:1.84},{id:"Kr93",massNumber:93,exactMass:92.93127,atomicNumber:36,halfLife:1.286},{id:"Kr94",massNumber:94,exactMass:93.93436,atomicNumber:36,halfLife:.2},{id:"Kr95",massNumber:95,exactMass:94.93984,atomicNumber:36,halfLife:.78},{id:"Kr96",massNumber:96,exactMass:95.94307,atomicNumber:36},{id:"Kr97",massNumber:97,exactMass:96.94856,atomicNumber:36},{id:"Kr98",massNumber:98,exactMass:97.95191,atomicNumber:36},{id:"Kr99",massNumber:99,exactMass:98.9576,atomicNumber:36},{id:"Kr100",massNumber:100,exactMass:99.96114,atomicNumber:36}]},{elementSymbol:"Rb",atomicNumber:37,isotopes:[{id:"Rb71",massNumber:71,exactMass:70.96532,atomicNumber:37},{id:"Rb72",massNumber:72,exactMass:71.95908,atomicNumber:37},{id:"Rb73",massNumber:73,exactMass:72.95056,atomicNumber:37},{id:"Rb74",massNumber:74,exactMass:73.944265,atomicNumber:37,halfLife:.0649},{id:"Rb75",massNumber:75,exactMass:74.93857,atomicNumber:37,halfLife:19},{id:"Rb76",massNumber:76,exactMass:75.9350722,atomicNumber:37,halfLife:36.5},{id:"Rb77",massNumber:77,exactMass:76.930408,atomicNumber:37,halfLife:226.2},{id:"Rb78",massNumber:78,exactMass:77.928141,atomicNumber:37,halfLife:1059.6},{id:"Rb79",massNumber:79,exactMass:78.923989,atomicNumber:37,halfLife:1374},{id:"Rb80",massNumber:80,exactMass:79.922519,atomicNumber:37,halfLife:34},{id:"Rb81",massNumber:81,exactMass:80.918996,atomicNumber:37,halfLife:16473.6},{id:"Rb82",massNumber:82,exactMass:81.9182086,atomicNumber:37,halfLife:76.38},{id:"Rb83",massNumber:83,exactMass:82.91511,atomicNumber:37,halfLife:7447680},{id:"Rb84",massNumber:84,exactMass:83.914385,atomicNumber:37,halfLife:2831330},{id:"Rb85",massNumber:85,relativeAbundance:.7217,atomicNumber:37,exactMass:84.91178974,spin:"5/2-",magneticMoment:"+1.3530",halfLife:-1},{id:"Rb86",massNumber:86,exactMass:85.91116742,atomicNumber:37,magneticMoment:"-1.6920",halfLife:1609720,betaminusDecay:"1.774",betaminusDecayLikeliness:"99.99",ecDecay:"",ecDecayLikeliness:"0.0052"},{id:"Rb87",massNumber:87,relativeAbundance:.2783,atomicNumber:37,exactMass:86.90918053,spin:"3/2-",magneticMoment:"+2.75124",halfLife:475e8},{id:"Rb88",massNumber:88,exactMass:87.91131559,atomicNumber:37,halfLife:1066.8},{id:"Rb89",massNumber:89,exactMass:88.912278,atomicNumber:37,halfLife:909},{id:"Rb90",massNumber:90,exactMass:89.914802,atomicNumber:37,halfLife:158},{id:"Rb91",massNumber:91,exactMass:90.916537,atomicNumber:37,halfLife:58.4},{id:"Rb92",massNumber:92,exactMass:91.919729,atomicNumber:37,halfLife:4.492},{id:"Rb93",massNumber:93,exactMass:92.922042,atomicNumber:37,halfLife:5.84},{id:"Rb94",massNumber:94,exactMass:93.926405,atomicNumber:37,halfLife:2.702},{id:"Rb95",massNumber:95,exactMass:94.929303,atomicNumber:37,halfLife:.3775},{id:"Rb96",massNumber:96,exactMass:95.93427,atomicNumber:37,halfLife:.199},{id:"Rb97",massNumber:97,exactMass:96.93735,atomicNumber:37,halfLife:.1699},{id:"Rb98",massNumber:98,exactMass:97.94179,atomicNumber:37,halfLife:.114},{id:"Rb99",massNumber:99,exactMass:98.94538,atomicNumber:37,halfLife:.0503},{id:"Rb100",massNumber:100,exactMass:99.94987,atomicNumber:37,halfLife:.051},{id:"Rb101",massNumber:101,exactMass:100.9532,atomicNumber:37,halfLife:.032},{id:"Rb102",massNumber:102,exactMass:101.95887,atomicNumber:37,halfLife:.037}]},{elementSymbol:"Sr",atomicNumber:38,isotopes:[{id:"Sr73",massNumber:73,exactMass:72.96597,atomicNumber:38},{id:"Sr74",massNumber:74,exactMass:73.95631,atomicNumber:38},{id:"Sr75",massNumber:75,exactMass:74.94995,atomicNumber:38,halfLife:.071},{id:"Sr76",massNumber:76,exactMass:75.94177,atomicNumber:38,halfLife:8.9},{id:"Sr77",massNumber:77,exactMass:76.937945,atomicNumber:38,halfLife:9},{id:"Sr78",massNumber:78,exactMass:77.93218,atomicNumber:38,halfLife:150},{id:"Sr79",massNumber:79,exactMass:78.929708,atomicNumber:38,halfLife:135},{id:"Sr80",massNumber:80,exactMass:79.924521,atomicNumber:38,halfLife:6378},{id:"Sr81",massNumber:81,exactMass:80.923212,atomicNumber:38,halfLife:1338},{id:"Sr82",massNumber:82,exactMass:81.918402,atomicNumber:38,halfLife:2207520},{id:"Sr83",massNumber:83,exactMass:82.917557,atomicNumber:38,halfLife:116676},{id:"Sr84",massNumber:84,relativeAbundance:.005600000000000001,atomicNumber:38,exactMass:83.913425,spin:"0+",halfLife:-1},{id:"Sr85",massNumber:85,exactMass:84.912933,atomicNumber:38,spin:"9/2+",halfLife:5602180,ecDecay:"1.08",ecDecayLikeliness:"100"},{id:"Sr86",massNumber:86,relativeAbundance:.0986,atomicNumber:38,exactMass:85.9092602,spin:"0+",halfLife:-1},{id:"Sr87",massNumber:87,relativeAbundance:.07,atomicNumber:38,exactMass:86.9088771,spin:"9/2+",magneticMoment:"-1.093",halfLife:-1},{id:"Sr88",massNumber:88,relativeAbundance:.8258,atomicNumber:38,exactMass:87.9056121,spin:"0+",halfLife:-1},{id:"Sr89",massNumber:89,exactMass:88.9074507,atomicNumber:38,halfLife:4365790},{id:"Sr90",massNumber:90,exactMass:89.907738,atomicNumber:38,halfLife:907921e3},{id:"Sr91",massNumber:91,exactMass:90.910203,atomicNumber:38,halfLife:34668},{id:"Sr92",massNumber:92,exactMass:91.911038,atomicNumber:38,halfLife:9756},{id:"Sr93",massNumber:93,exactMass:92.914026,atomicNumber:38,halfLife:445.38},{id:"Sr94",massNumber:94,exactMass:93.915361,atomicNumber:38,halfLife:75.3},{id:"Sr95",massNumber:95,exactMass:94.919359,atomicNumber:38,halfLife:23.9},{id:"Sr96",massNumber:96,exactMass:95.921697,atomicNumber:38,halfLife:1.07},{id:"Sr97",massNumber:97,exactMass:96.926153,atomicNumber:38,halfLife:.426},{id:"Sr98",massNumber:98,exactMass:97.928453,atomicNumber:38,halfLife:.653},{id:"Sr99",massNumber:99,exactMass:98.93324,atomicNumber:38,halfLife:.269},{id:"Sr100",massNumber:100,exactMass:99.93535,atomicNumber:38,halfLife:.202},{id:"Sr101",massNumber:101,exactMass:100.94052,atomicNumber:38,halfLife:.118},{id:"Sr102",massNumber:102,exactMass:101.94302,atomicNumber:38},{id:"Sr103",massNumber:103,exactMass:102.94895,atomicNumber:38},{id:"Sr104",massNumber:104,exactMass:103.95233,atomicNumber:38},{id:"Sr105",massNumber:105,exactMass:104.95858,atomicNumber:38}]},{elementSymbol:"Y",atomicNumber:39,isotopes:[{id:"Y76",massNumber:76,exactMass:75.95845,atomicNumber:39},{id:"Y77",massNumber:77,exactMass:76.94965,atomicNumber:39},{id:"Y78",massNumber:78,exactMass:77.94361,atomicNumber:39},{id:"Y79",massNumber:79,exactMass:78.93735,atomicNumber:39,halfLife:14.8},{id:"Y80",massNumber:80,exactMass:79.93428,atomicNumber:39,halfLife:35},{id:"Y81",massNumber:81,exactMass:80.92913,atomicNumber:39,halfLife:70.4},{id:"Y82",massNumber:82,exactMass:81.92679,atomicNumber:39,halfLife:9.5},{id:"Y83",massNumber:83,exactMass:82.92235,atomicNumber:39,halfLife:424.8},{id:"Y84",massNumber:84,exactMass:83.92039,atomicNumber:39,halfLife:4.6},{id:"Y85",massNumber:85,exactMass:84.916433,atomicNumber:39,halfLife:9648},{id:"Y86",massNumber:86,exactMass:85.914886,atomicNumber:39,halfLife:53064},{id:"Y87",massNumber:87,exactMass:86.9108757,atomicNumber:39,halfLife:287280},{id:"Y88",massNumber:88,exactMass:87.9095011,atomicNumber:39,halfLife:9214560},{id:"Y89",massNumber:89,relativeAbundance:1,atomicNumber:39,exactMass:88.9058483,spin:"1/2-",magneticMoment:"-0.1374153",halfLife:-1},{id:"Y90",massNumber:90,exactMass:89.9071519,atomicNumber:39,spin:"2-",magneticMoment:"-1.630",halfLife:230400,betaminusDecay:"2.283",betaminusDecayLikeliness:"100.0"},{id:"Y91",massNumber:91,exactMass:90.907305,atomicNumber:39,halfLife:5055260},{id:"Y92",massNumber:92,exactMass:91.908949,atomicNumber:39,halfLife:12744},{id:"Y93",massNumber:93,exactMass:92.909583,atomicNumber:39,halfLife:36648},{id:"Y94",massNumber:94,exactMass:93.911595,atomicNumber:39,halfLife:1122},{id:"Y95",massNumber:95,exactMass:94.912821,atomicNumber:39,halfLife:618},{id:"Y96",massNumber:96,exactMass:95.915891,atomicNumber:39,halfLife:5.34},{id:"Y97",massNumber:97,exactMass:96.918134,atomicNumber:39,halfLife:3.75},{id:"Y98",massNumber:98,exactMass:97.922203,atomicNumber:39},{id:"Y99",massNumber:99,exactMass:98.924636,atomicNumber:39},{id:"Y100",massNumber:100,exactMass:99.92776,atomicNumber:39},{id:"Y101",massNumber:101,exactMass:100.93031,atomicNumber:39},{id:"Y102",massNumber:102,exactMass:101.93356,atomicNumber:39},{id:"Y103",massNumber:103,exactMass:102.93673,atomicNumber:39},{id:"Y104",massNumber:104,exactMass:103.94105,atomicNumber:39},{id:"Y105",massNumber:105,exactMass:104.94487,atomicNumber:39},{id:"Y106",massNumber:106,exactMass:105.94979,atomicNumber:39},{id:"Y107",massNumber:107,exactMass:106.95414,atomicNumber:39},{id:"Y108",massNumber:108,exactMass:107.95948,atomicNumber:39}]},{elementSymbol:"Zr",atomicNumber:40,isotopes:[{id:"Zr78",massNumber:78,exactMass:77.95523,atomicNumber:40},{id:"Zr79",massNumber:79,exactMass:78.94916,atomicNumber:40},{id:"Zr80",massNumber:80,exactMass:79.9404,atomicNumber:40},{id:"Zr81",massNumber:81,exactMass:80.93721,atomicNumber:40,halfLife:15},{id:"Zr82",massNumber:82,exactMass:81.93109,atomicNumber:40,halfLife:32},{id:"Zr83",massNumber:83,exactMass:82.92865,atomicNumber:40,halfLife:44},{id:"Zr84",massNumber:84,exactMass:83.92325,atomicNumber:40,halfLife:1554},{id:"Zr85",massNumber:85,exactMass:84.92147,atomicNumber:40,halfLife:471.6},{id:"Zr86",massNumber:86,exactMass:85.91647,atomicNumber:40,halfLife:59400},{id:"Zr87",massNumber:87,exactMass:86.914816,atomicNumber:40,halfLife:6048},{id:"Zr88",massNumber:88,exactMass:87.910227,atomicNumber:40,halfLife:7205760},{id:"Zr89",massNumber:89,exactMass:88.90889,atomicNumber:40,halfLife:282276},{id:"Zr90",massNumber:90,relativeAbundance:.5145000000000001,atomicNumber:40,exactMass:89.9047044,spin:"0+",halfLife:-1},{id:"Zr91",massNumber:91,relativeAbundance:.11220000000000001,atomicNumber:40,exactMass:90.9056458,spin:"5/2+",magneticMoment:"-1.30362",halfLife:-1},{id:"Zr92",massNumber:92,relativeAbundance:.17149999999999999,atomicNumber:40,exactMass:91.9050408,spin:"0+",halfLife:-1},{id:"Zr93",massNumber:93,exactMass:92.906476,atomicNumber:40,spin:"5/2+",halfLife:153e4,betaminusDecay:"0.09",betaminusDecayLikeliness:"100.0"},{id:"Zr94",massNumber:94,relativeAbundance:.17379999999999998,atomicNumber:40,exactMass:93.9063152,spin:"0+",halfLife:-1},{id:"Zr95",massNumber:95,exactMass:94.9080426,atomicNumber:40,spin:"5/2+",halfLife:5531330,betaminusDecay:"1.121",betaminusDecayLikeliness:"100.0"},{id:"Zr96",massNumber:96,relativeAbundance:.027999999999999997,atomicNumber:40,exactMass:95.9082734,spin:"0+"},{id:"Zr97",massNumber:97,exactMass:96.9109531,atomicNumber:40,halfLife:60876},{id:"Zr98",massNumber:98,exactMass:97.912735,atomicNumber:40,halfLife:30.7},{id:"Zr99",massNumber:99,exactMass:98.916512,atomicNumber:40,halfLife:2.1},{id:"Zr100",massNumber:100,exactMass:99.91776,atomicNumber:40,halfLife:7.1},{id:"Zr101",massNumber:101,exactMass:100.92114,atomicNumber:40,halfLife:2.3},{id:"Zr102",massNumber:102,exactMass:101.92298,atomicNumber:40,halfLife:2.9},{id:"Zr103",massNumber:103,exactMass:102.9266,atomicNumber:40,halfLife:1.3},{id:"Zr104",massNumber:104,exactMass:103.92878,atomicNumber:40,halfLife:1.2},{id:"Zr105",massNumber:105,exactMass:104.93305,atomicNumber:40},{id:"Zr106",massNumber:106,exactMass:105.93591,atomicNumber:40},{id:"Zr107",massNumber:107,exactMass:106.94075,atomicNumber:40},{id:"Zr108",massNumber:108,exactMass:107.94396,atomicNumber:40},{id:"Zr109",massNumber:109,exactMass:108.94924,atomicNumber:40},{id:"Zr110",massNumber:110,exactMass:109.95287,atomicNumber:40}]},{elementSymbol:"Nb",atomicNumber:41,isotopes:[{id:"Nb81",massNumber:81,exactMass:80.94903,atomicNumber:41},{id:"Nb82",massNumber:82,exactMass:81.94313,atomicNumber:41},{id:"Nb83",massNumber:83,exactMass:82.93671,atomicNumber:41,halfLife:4.1},{id:"Nb84",massNumber:84,exactMass:83.93357,atomicNumber:41,halfLife:12},{id:"Nb85",massNumber:85,exactMass:84.92791,atomicNumber:41,halfLife:20.9},{id:"Nb86",massNumber:86,exactMass:85.92504,atomicNumber:41,halfLife:88},{id:"Nb87",massNumber:87,exactMass:86.92036,atomicNumber:41,halfLife:156},{id:"Nb88",massNumber:88,exactMass:87.91833,atomicNumber:41,halfLife:870},{id:"Nb89",massNumber:89,exactMass:88.913418,atomicNumber:41,halfLife:6840},{id:"Nb90",massNumber:90,exactMass:89.911265,atomicNumber:41,halfLife:52560},{id:"Nb91",massNumber:91,exactMass:90.906996,atomicNumber:41,halfLife:214445e5},{id:"Nb92",massNumber:92,exactMass:91.907194,atomicNumber:41},{id:"Nb93",massNumber:93,relativeAbundance:1,atomicNumber:41,exactMass:92.9063781,spin:"9/2+",halfLife:-1},{id:"Nb94",massNumber:94,exactMass:93.9072839,atomicNumber:41},{id:"Nb95",massNumber:95,exactMass:94.9068358,atomicNumber:41,spin:"9/2+",magneticMoment:"+6.123",halfLife:3021840,betaminusDecay:"0.925",betaminusDecayLikeliness:"100.0"},{id:"Nb96",massNumber:96,exactMass:95.908101,atomicNumber:41,halfLife:84060},{id:"Nb97",massNumber:97,exactMass:96.9080986,atomicNumber:41,halfLife:4326},{id:"Nb98",massNumber:98,exactMass:97.910328,atomicNumber:41,halfLife:2.86},{id:"Nb99",massNumber:99,exactMass:98.911618,atomicNumber:41,halfLife:15},{id:"Nb100",massNumber:100,exactMass:99.914182,atomicNumber:41},{id:"Nb101",massNumber:101,exactMass:100.915252,atomicNumber:41},{id:"Nb102",massNumber:102,exactMass:101.91804,atomicNumber:41},{id:"Nb103",massNumber:103,exactMass:102.91914,atomicNumber:41},{id:"Nb104",massNumber:104,exactMass:103.92246,atomicNumber:41},{id:"Nb105",massNumber:105,exactMass:104.92394,atomicNumber:41},{id:"Nb106",massNumber:106,exactMass:105.92797,atomicNumber:41},{id:"Nb107",massNumber:107,exactMass:106.93031,atomicNumber:41},{id:"Nb108",massNumber:108,exactMass:107.93484,atomicNumber:41},{id:"Nb109",massNumber:109,exactMass:108.93763,atomicNumber:41},{id:"Nb110",massNumber:110,exactMass:109.94244,atomicNumber:41},{id:"Nb111",massNumber:111,exactMass:110.94565,atomicNumber:41},{id:"Nb112",massNumber:112,exactMass:111.95083,atomicNumber:41},{id:"Nb113",massNumber:113,exactMass:112.9547,atomicNumber:41}]},{elementSymbol:"Mo",atomicNumber:42,isotopes:[{id:"Mo83",massNumber:83,exactMass:82.94874,atomicNumber:42},{id:"Mo84",massNumber:84,exactMass:83.94009,atomicNumber:42},{id:"Mo85",massNumber:85,exactMass:84.93655,atomicNumber:42},{id:"Mo86",massNumber:86,exactMass:85.9307,atomicNumber:42,halfLife:19.6},{id:"Mo87",massNumber:87,exactMass:86.92733,atomicNumber:42,halfLife:13.4},{id:"Mo88",massNumber:88,exactMass:87.921953,atomicNumber:42,halfLife:480},{id:"Mo89",massNumber:89,exactMass:88.91948,atomicNumber:42,halfLife:122.4},{id:"Mo90",massNumber:90,exactMass:89.913937,atomicNumber:42,halfLife:20016},{id:"Mo91",massNumber:91,exactMass:90.91175,atomicNumber:42,halfLife:929.4},{id:"Mo92",massNumber:92,relativeAbundance:.1484,atomicNumber:42,exactMass:91.906811,spin:"0+",halfLife:-1},{id:"Mo93",massNumber:93,exactMass:92.906813,atomicNumber:42,spin:"5/2+",halfLife:3500,ecDecay:"",ecDecayLikeliness:"100.0"},{id:"Mo94",massNumber:94,relativeAbundance:.0925,atomicNumber:42,exactMass:93.9050883,spin:"0+",halfLife:-1},{id:"Mo95",massNumber:95,relativeAbundance:.1592,atomicNumber:42,exactMass:94.9058421,spin:"5/2+",magneticMoment:"-0.9133",halfLife:-1},{id:"Mo96",massNumber:96,relativeAbundance:.1668,atomicNumber:42,exactMass:95.9046795,spin:"0+",halfLife:-1},{id:"Mo97",massNumber:97,relativeAbundance:.0955,atomicNumber:42,exactMass:96.9060215,spin:"5/2+",magneticMoment:"-0.9133",halfLife:-1},{id:"Mo98",massNumber:98,relativeAbundance:.2413,atomicNumber:42,exactMass:97.9054082,spin:"0+",halfLife:-1},{id:"Mo99",massNumber:99,exactMass:98.9077119,atomicNumber:42,spin:"1/2+",halfLife:237384,betaminusDecay:"1.357",betaminusDecayLikeliness:"100.0"},{id:"Mo100",massNumber:100,relativeAbundance:.09630000000000001,atomicNumber:42,exactMass:99.907477,spin:"0+",halfLife:-1},{id:"Mo101",massNumber:101,exactMass:100.910347,atomicNumber:42,halfLife:876.6},{id:"Mo102",massNumber:102,exactMass:101.910297,atomicNumber:42,halfLife:678},{id:"Mo103",massNumber:103,exactMass:102.91321,atomicNumber:42,halfLife:67.5},{id:"Mo104",massNumber:104,exactMass:103.91376,atomicNumber:42,halfLife:60},{id:"Mo105",massNumber:105,exactMass:104.91697,atomicNumber:42,halfLife:35.6},{id:"Mo106",massNumber:106,exactMass:105.918137,atomicNumber:42,halfLife:8.4},{id:"Mo107",massNumber:107,exactMass:106.92169,atomicNumber:42,halfLife:3.5},{id:"Mo108",massNumber:108,exactMass:107.92345,atomicNumber:42,halfLife:1.09},{id:"Mo109",massNumber:109,exactMass:108.92781,atomicNumber:42,halfLife:.53},{id:"Mo110",massNumber:110,exactMass:109.92973,atomicNumber:42,halfLife:.3},{id:"Mo111",massNumber:111,exactMass:110.93441,atomicNumber:42},{id:"Mo112",massNumber:112,exactMass:111.93684,atomicNumber:42},{id:"Mo113",massNumber:113,exactMass:112.94188,atomicNumber:42},{id:"Mo114",massNumber:114,exactMass:113.94492,atomicNumber:42},{id:"Mo115",massNumber:115,exactMass:114.95029,atomicNumber:42}]},{elementSymbol:"Tc",atomicNumber:43,isotopes:[{id:"Tc85",massNumber:85,exactMass:84.94883,atomicNumber:43},{id:"Tc86",massNumber:86,exactMass:85.94288,atomicNumber:43},{id:"Tc87",massNumber:87,exactMass:86.93653,atomicNumber:43},{id:"Tc88",massNumber:88,exactMass:87.93268,atomicNumber:43,halfLife:6.4},{id:"Tc89",massNumber:89,exactMass:88.92717,atomicNumber:43,halfLife:12.8},{id:"Tc90",massNumber:90,exactMass:89.92356,atomicNumber:43,halfLife:49.2},{id:"Tc91",massNumber:91,exactMass:90.91843,atomicNumber:43,halfLife:188.4},{id:"Tc92",massNumber:92,exactMass:91.91526,atomicNumber:43,halfLife:253.8},{id:"Tc93",massNumber:93,exactMass:92.910249,atomicNumber:43,halfLife:9900},{id:"Tc94",massNumber:94,exactMass:93.909657,atomicNumber:43,halfLife:17580},{id:"Tc95",massNumber:95,exactMass:94.907657,atomicNumber:43,halfLife:72e3},{id:"Tc96",massNumber:96,exactMass:95.907871,atomicNumber:43,halfLife:369792},{id:"Tc97",massNumber:97,exactMass:96.906365,atomicNumber:43,spin:"9/2+",halfLife:26e5,ecDecay:"0.32",ecDecayLikeliness:"100.0"},{id:"Tc98",massNumber:98,exactMass:97.907216,atomicNumber:43},{id:"Tc99",massNumber:99,exactMass:98.9062547,atomicNumber:43,spin:"9/2+",magneticMoment:"+5.6847",halfLife:211100,betaminusDecay:"0.293",betaminusDecayLikeliness:"100.0"},{id:"Tc100",massNumber:100,exactMass:99.9076578,atomicNumber:43,halfLife:15.8},{id:"Tc101",massNumber:101,exactMass:100.907315,atomicNumber:43,halfLife:853.2},{id:"Tc102",massNumber:102,exactMass:101.909215,atomicNumber:43,halfLife:5.28},{id:"Tc103",massNumber:103,exactMass:102.909181,atomicNumber:43,halfLife:54.2},{id:"Tc104",massNumber:104,exactMass:103.91145,atomicNumber:43,halfLife:1098},{id:"Tc105",massNumber:105,exactMass:104.91166,atomicNumber:43,halfLife:456},{id:"Tc106",massNumber:106,exactMass:105.914358,atomicNumber:43},{id:"Tc107",massNumber:107,exactMass:106.91508,atomicNumber:43},{id:"Tc108",massNumber:108,exactMass:107.91846,atomicNumber:43},{id:"Tc109",massNumber:109,exactMass:108.91998,atomicNumber:43},{id:"Tc110",massNumber:110,exactMass:109.92382,atomicNumber:43},{id:"Tc111",massNumber:111,exactMass:110.92569,atomicNumber:43},{id:"Tc112",massNumber:112,exactMass:111.92915,atomicNumber:43},{id:"Tc113",massNumber:113,exactMass:112.93159,atomicNumber:43},{id:"Tc114",massNumber:114,exactMass:113.93588,atomicNumber:43},{id:"Tc115",massNumber:115,exactMass:114.93869,atomicNumber:43},{id:"Tc116",massNumber:116,exactMass:115.94337,atomicNumber:43},{id:"Tc117",massNumber:117,exactMass:116.94648,atomicNumber:43},{id:"Tc118",massNumber:118,exactMass:117.95148,atomicNumber:43}]},{elementSymbol:"Ru",atomicNumber:44,isotopes:[{id:"Ru87",massNumber:87,exactMass:86.94918,atomicNumber:44},{id:"Ru88",massNumber:88,exactMass:87.94026,atomicNumber:44},{id:"Ru89",massNumber:89,exactMass:88.93611,atomicNumber:44},{id:"Ru90",massNumber:90,exactMass:89.92989,atomicNumber:44,halfLife:11},{id:"Ru91",massNumber:91,exactMass:90.92629,atomicNumber:44,halfLife:9},{id:"Ru92",massNumber:92,exactMass:91.92012,atomicNumber:44,halfLife:219},{id:"Ru93",massNumber:93,exactMass:92.91705,atomicNumber:44,halfLife:59.7},{id:"Ru94",massNumber:94,exactMass:93.91136,atomicNumber:44,halfLife:3108},{id:"Ru95",massNumber:95,exactMass:94.910413,atomicNumber:44,halfLife:5914.8},{id:"Ru96",massNumber:96,relativeAbundance:.0554,atomicNumber:44,exactMass:95.907598,spin:"0+",halfLife:-1},{id:"Ru97",massNumber:97,exactMass:96.907555,atomicNumber:44,spin:"5/2+",magneticMoment:"+0.687",halfLife:250560,ecDecay:"1.2",ecDecayLikeliness:"100.0"},{id:"Ru98",massNumber:98,relativeAbundance:.0187,atomicNumber:44,exactMass:97.905287,spin:"0+",halfLife:-1},{id:"Ru99",massNumber:99,relativeAbundance:.1276,atomicNumber:44,exactMass:98.9059393,spin:"5/2+",magneticMoment:"+0.6413",halfLife:-1},{id:"Ru100",massNumber:100,relativeAbundance:.126,atomicNumber:44,exactMass:99.9042195,spin:"0+",halfLife:-1},{id:"Ru101",massNumber:101,relativeAbundance:.17059999999999997,atomicNumber:44,exactMass:100.9055821,spin:"5/2+",magneticMoment:"-0.7188",halfLife:-1},{id:"Ru102",massNumber:102,relativeAbundance:.3155,atomicNumber:44,exactMass:101.9043493,spin:"0+",halfLife:-1},{id:"Ru103",massNumber:103,exactMass:102.9063238,atomicNumber:44,spin:"5/2+",magneticMoment:"+0.67",halfLife:3392060,betaminusDecay:"0.767",betaminusDecayLikeliness:"100.0"},{id:"Ru104",massNumber:104,relativeAbundance:.1862,atomicNumber:44,exactMass:103.905433,spin:"0+",halfLife:-1},{id:"Ru105",massNumber:105,exactMass:104.907753,atomicNumber:44,halfLife:15984},{id:"Ru106",massNumber:106,exactMass:105.907329,atomicNumber:44,halfLife:32278200},{id:"Ru107",massNumber:107,exactMass:106.90991,atomicNumber:44,halfLife:225},{id:"Ru108",massNumber:108,exactMass:107.91017,atomicNumber:44,halfLife:273},{id:"Ru109",massNumber:109,exactMass:108.9132,atomicNumber:44,halfLife:34.5},{id:"Ru110",massNumber:110,exactMass:109.91414,atomicNumber:44,halfLife:14.6},{id:"Ru111",massNumber:111,exactMass:110.9177,atomicNumber:44,halfLife:2.12},{id:"Ru112",massNumber:112,exactMass:111.91897,atomicNumber:44,halfLife:1.75},{id:"Ru113",massNumber:113,exactMass:112.92249,atomicNumber:44,halfLife:.8},{id:"Ru114",massNumber:114,exactMass:113.92428,atomicNumber:44,halfLife:.53},{id:"Ru115",massNumber:115,exactMass:114.92869,atomicNumber:44,halfLife:.4},{id:"Ru116",massNumber:116,exactMass:115.93081,atomicNumber:44},{id:"Ru117",massNumber:117,exactMass:116.93558,atomicNumber:44},{id:"Ru118",massNumber:118,exactMass:117.93782,atomicNumber:44},{id:"Ru119",massNumber:119,exactMass:118.94284,atomicNumber:44},{id:"Ru120",massNumber:120,exactMass:119.94531,atomicNumber:44}]},{elementSymbol:"Rh",atomicNumber:45,isotopes:[{id:"Rh89",massNumber:89,exactMass:88.94884,atomicNumber:45},{id:"Rh90",massNumber:90,exactMass:89.94287,atomicNumber:45},{id:"Rh91",massNumber:91,exactMass:90.93655,atomicNumber:45},{id:"Rh92",massNumber:92,exactMass:91.93198,atomicNumber:45},{id:"Rh93",massNumber:93,exactMass:92.92574,atomicNumber:45},{id:"Rh94",massNumber:94,exactMass:93.9217,atomicNumber:45,halfLife:70.6},{id:"Rh95",massNumber:95,exactMass:94.9159,atomicNumber:45,halfLife:301.2},{id:"Rh96",massNumber:96,exactMass:95.914461,atomicNumber:45,halfLife:594},{id:"Rh97",massNumber:97,exactMass:96.91134,atomicNumber:45,halfLife:1842},{id:"Rh98",massNumber:98,exactMass:97.910708,atomicNumber:45,halfLife:522},{id:"Rh99",massNumber:99,exactMass:98.908132,atomicNumber:45,halfLife:1391040},{id:"Rh100",massNumber:100,exactMass:99.908122,atomicNumber:45,halfLife:74880},{id:"Rh101",massNumber:101,exactMass:100.906164,atomicNumber:45,halfLife:104069e3},{id:"Rh102",massNumber:102,exactMass:101.906843,atomicNumber:45,halfLife:17884800},{id:"Rh103",massNumber:103,relativeAbundance:1,atomicNumber:45,exactMass:102.905504,spin:"1/2-",magneticMoment:"-0.08840",halfLife:-1},{id:"Rh104",massNumber:104,exactMass:103.906656,atomicNumber:45,halfLife:42.3},{id:"Rh105",massNumber:105,exactMass:104.905694,atomicNumber:45,halfLife:127296},{id:"Rh106",massNumber:106,exactMass:105.907287,atomicNumber:45,halfLife:29.8},{id:"Rh107",massNumber:107,exactMass:106.906748,atomicNumber:45,halfLife:1302},{id:"Rh108",massNumber:108,exactMass:107.90873,atomicNumber:45,halfLife:16.8},{id:"Rh109",massNumber:109,exactMass:108.908737,atomicNumber:45,halfLife:80},{id:"Rh110",massNumber:110,exactMass:109.91114,atomicNumber:45},{id:"Rh111",massNumber:111,exactMass:110.91159,atomicNumber:45},{id:"Rh112",massNumber:112,exactMass:111.91439,atomicNumber:45},{id:"Rh113",massNumber:113,exactMass:112.91553,atomicNumber:45},{id:"Rh114",massNumber:114,exactMass:113.91881,atomicNumber:45},{id:"Rh115",massNumber:115,exactMass:114.92033,atomicNumber:45},{id:"Rh116",massNumber:116,exactMass:115.92406,atomicNumber:45},{id:"Rh117",massNumber:117,exactMass:116.92598,atomicNumber:45},{id:"Rh118",massNumber:118,exactMass:117.93007,atomicNumber:45},{id:"Rh119",massNumber:119,exactMass:118.93211,atomicNumber:45},{id:"Rh120",massNumber:120,exactMass:119.93641,atomicNumber:45},{id:"Rh121",massNumber:121,exactMass:120.93872,atomicNumber:45},{id:"Rh122",massNumber:122,exactMass:121.94321,atomicNumber:45}]},{elementSymbol:"Pd",atomicNumber:46,isotopes:[{id:"Pd91",massNumber:91,exactMass:90.94911,atomicNumber:46},{id:"Pd92",massNumber:92,exactMass:91.94042,atomicNumber:46},{id:"Pd93",massNumber:93,exactMass:92.93591,atomicNumber:46},{id:"Pd94",massNumber:94,exactMass:93.92877,atomicNumber:46},{id:"Pd95",massNumber:95,exactMass:94.92469,atomicNumber:46},{id:"Pd96",massNumber:96,exactMass:95.91816,atomicNumber:46,halfLife:122},{id:"Pd97",massNumber:97,exactMass:96.91648,atomicNumber:46,halfLife:186},{id:"Pd98",massNumber:98,exactMass:97.912721,atomicNumber:46,halfLife:1062},{id:"Pd99",massNumber:99,exactMass:98.911768,atomicNumber:46,halfLife:1284},{id:"Pd100",massNumber:100,exactMass:99.908506,atomicNumber:46,halfLife:313632},{id:"Pd101",massNumber:101,exactMass:100.908289,atomicNumber:46,halfLife:30492},{id:"Pd102",massNumber:102,relativeAbundance:.0102,atomicNumber:46,exactMass:101.905609,spin:"0+",halfLife:-1},{id:"Pd103",massNumber:103,exactMass:102.906087,atomicNumber:46,spin:"5/2+",halfLife:1468020,ecDecay:"0.56",ecDecayLikeliness:"100.0"},{id:"Pd104",massNumber:104,relativeAbundance:.1114,atomicNumber:46,exactMass:103.904036,spin:"0+",halfLife:-1},{id:"Pd105",massNumber:105,relativeAbundance:.22329999999999997,atomicNumber:46,exactMass:104.905085,spin:"5/2+",magneticMoment:"-0.642",halfLife:-1},{id:"Pd106",massNumber:106,relativeAbundance:.2733,atomicNumber:46,exactMass:105.903486,spin:"0+",halfLife:-1},{id:"Pd107",massNumber:107,exactMass:106.905133,atomicNumber:46,spin:"5/2+",halfLife:65e5,betaminusDecay:"0.035",betaminusDecayLikeliness:"100.0"},{id:"Pd108",massNumber:108,relativeAbundance:.2646,atomicNumber:46,exactMass:107.903892,spin:"0+",halfLife:-1},{id:"Pd109",massNumber:109,exactMass:108.90595,atomicNumber:46,spin:"5/2+",halfLife:49324.3,betaminusDecay:"1.116",betaminusDecayLikeliness:"100.0"},{id:"Pd110",massNumber:110,relativeAbundance:.11720000000000001,atomicNumber:46,exactMass:109.905153,spin:"0+",halfLife:-1},{id:"Pd111",massNumber:111,exactMass:110.907671,atomicNumber:46,halfLife:1404},{id:"Pd112",massNumber:112,exactMass:111.907314,atomicNumber:46,halfLife:75708},{id:"Pd113",massNumber:113,exactMass:112.91015,atomicNumber:46,halfLife:93},{id:"Pd114",massNumber:114,exactMass:113.910363,atomicNumber:46,halfLife:145.2},{id:"Pd115",massNumber:115,exactMass:114.91368,atomicNumber:46,halfLife:25},{id:"Pd116",massNumber:116,exactMass:115.91416,atomicNumber:46,halfLife:11.8},{id:"Pd117",massNumber:117,exactMass:116.91784,atomicNumber:46,halfLife:4.3},{id:"Pd118",massNumber:118,exactMass:117.91898,atomicNumber:46,halfLife:1.9},{id:"Pd119",massNumber:119,exactMass:118.92311,atomicNumber:46,halfLife:.92},{id:"Pd120",massNumber:120,exactMass:119.92469,atomicNumber:46,halfLife:.5},{id:"Pd121",massNumber:121,exactMass:120.92887,atomicNumber:46},{id:"Pd122",massNumber:122,exactMass:121.93055,atomicNumber:46},{id:"Pd123",massNumber:123,exactMass:122.93493,atomicNumber:46},{id:"Pd124",massNumber:124,exactMass:123.93688,atomicNumber:46}]},{elementSymbol:"Ag",atomicNumber:47,isotopes:[{id:"Ag93",massNumber:93,exactMass:92.94978,atomicNumber:47},{id:"Ag94",massNumber:94,exactMass:93.94278,atomicNumber:47,halfLife:.01},{id:"Ag95",massNumber:95,exactMass:94.93548,atomicNumber:47},{id:"Ag96",massNumber:96,exactMass:95.93068,atomicNumber:47,halfLife:5.1},{id:"Ag97",massNumber:97,exactMass:96.92397,atomicNumber:47,halfLife:19},{id:"Ag98",massNumber:98,exactMass:97.92157,atomicNumber:47,halfLife:46.7},{id:"Ag99",massNumber:99,exactMass:98.9176,atomicNumber:47,halfLife:124},{id:"Ag100",massNumber:100,exactMass:99.9161,atomicNumber:47,halfLife:120.6},{id:"Ag101",massNumber:101,exactMass:100.9128,atomicNumber:47,halfLife:666},{id:"Ag102",massNumber:102,exactMass:101.91169,atomicNumber:47,halfLife:774},{id:"Ag103",massNumber:103,exactMass:102.908973,atomicNumber:47,halfLife:3942},{id:"Ag104",massNumber:104,exactMass:103.908629,atomicNumber:47,halfLife:4152},{id:"Ag105",massNumber:105,exactMass:104.906529,atomicNumber:47,spin:"1/2-",halfLife:3567460},{id:"Ag106",massNumber:106,exactMass:105.906669,atomicNumber:47,spin:"1+",halfLife:1437.6},{id:"Ag107",massNumber:107,relativeAbundance:.51839,atomicNumber:47,exactMass:106.905097,spin:"1/2-",magneticMoment:"-0.113570",halfLife:-1},{id:"Ag108",massNumber:108,exactMass:107.905956,atomicNumber:47,spin:"1+",halfLife:142.2},{id:"Ag109",massNumber:109,relativeAbundance:.48161000000000004,atomicNumber:47,exactMass:108.904752,spin:"1/2-",magneticMoment:"-0.1306905",halfLife:-1},{id:"Ag110",massNumber:110,exactMass:109.906107,atomicNumber:47,spin:"1+",halfLife:24.6},{id:"Ag111",massNumber:111,exactMass:110.905291,atomicNumber:47,halfLife:643680},{id:"Ag112",massNumber:112,exactMass:111.907005,atomicNumber:47,halfLife:11268},{id:"Ag113",massNumber:113,exactMass:112.906567,atomicNumber:47,halfLife:19332},{id:"Ag114",massNumber:114,exactMass:113.908804,atomicNumber:47,halfLife:4.6},{id:"Ag115",massNumber:115,exactMass:114.90876,atomicNumber:47,halfLife:1200},{id:"Ag116",massNumber:116,exactMass:115.91136,atomicNumber:47,halfLife:160.8},{id:"Ag117",massNumber:117,exactMass:116.91168,atomicNumber:47,halfLife:72.8},{id:"Ag118",massNumber:118,exactMass:117.91458,atomicNumber:47,halfLife:3.76},{id:"Ag119",massNumber:119,exactMass:118.91567,atomicNumber:47,halfLife:2.1},{id:"Ag120",massNumber:120,exactMass:119.91879,atomicNumber:47,halfLife:1.23},{id:"Ag121",massNumber:121,exactMass:120.91985,atomicNumber:47,halfLife:.78},{id:"Ag122",massNumber:122,exactMass:121.92353,atomicNumber:47,halfLife:.48},{id:"Ag123",massNumber:123,exactMass:122.9249,atomicNumber:47,halfLife:.309},{id:"Ag124",massNumber:124,exactMass:123.92864,atomicNumber:47,halfLife:.172},{id:"Ag125",massNumber:125,exactMass:124.93043,atomicNumber:47,halfLife:.166},{id:"Ag126",massNumber:126,exactMass:125.9345,atomicNumber:47,halfLife:.107},{id:"Ag127",massNumber:127,exactMass:126.93677,atomicNumber:47,halfLife:.109},{id:"Ag128",massNumber:128,exactMass:127.94117,atomicNumber:47,halfLife:.058},{id:"Ag129",massNumber:129,exactMass:128.94369,atomicNumber:47},{id:"Ag130",massNumber:130,exactMass:129.95045,atomicNumber:47}]},{elementSymbol:"Cd",atomicNumber:48,isotopes:[{id:"Cd95",massNumber:95,exactMass:94.94987,atomicNumber:48},{id:"Cd96",massNumber:96,exactMass:95.93977,atomicNumber:48},{id:"Cd97",massNumber:97,exactMass:96.93494,atomicNumber:48,halfLife:3},{id:"Cd98",massNumber:98,exactMass:97.9274,atomicNumber:48,halfLife:9.2},{id:"Cd99",massNumber:99,exactMass:98.92501,atomicNumber:48,halfLife:16},{id:"Cd100",massNumber:100,exactMass:99.92029,atomicNumber:48,halfLife:49.1},{id:"Cd101",massNumber:101,exactMass:100.91868,atomicNumber:48,halfLife:81.6},{id:"Cd102",massNumber:102,exactMass:101.91446,atomicNumber:48,halfLife:330},{id:"Cd103",massNumber:103,exactMass:102.913419,atomicNumber:48,halfLife:438},{id:"Cd104",massNumber:104,exactMass:103.909849,atomicNumber:48,halfLife:3462},{id:"Cd105",massNumber:105,exactMass:104.909468,atomicNumber:48,halfLife:3330},{id:"Cd106",massNumber:106,relativeAbundance:.0125,atomicNumber:48,exactMass:105.906459,spin:"0+",halfLife:-1},{id:"Cd107",massNumber:107,exactMass:106.906618,atomicNumber:48,spin:"5/2+",halfLife:23400,ecDecay:"",ecDecayLikeliness:"100.0"},{id:"Cd108",massNumber:108,relativeAbundance:.0089,atomicNumber:48,exactMass:107.904184,spin:"0+",halfLife:-1},{id:"Cd109",massNumber:109,exactMass:108.904982,atomicNumber:48,spin:"5/2+",magneticMoment:"-0.8270",halfLife:39968600,ecDecay:"0.16",ecDecayLikeliness:"100.0"},{id:"Cd110",massNumber:110,relativeAbundance:.1249,atomicNumber:48,exactMass:109.9030021,spin:"0+",halfLife:-1},{id:"Cd111",massNumber:111,relativeAbundance:.128,atomicNumber:48,exactMass:110.9041781,spin:"1/2+",magneticMoment:"-0.5943",halfLife:-1},{id:"Cd112",massNumber:112,relativeAbundance:.2413,atomicNumber:48,exactMass:111.9027578,spin:"0+",halfLife:-1},{id:"Cd113",massNumber:113,relativeAbundance:.1222,atomicNumber:48,exactMass:112.9044017,spin:"1/2+",magneticMoment:"-0.6217"},{id:"Cd114",massNumber:114,relativeAbundance:.2873,atomicNumber:48,exactMass:113.9033585,spin:"0+",halfLife:-1},{id:"Cd115",massNumber:115,exactMass:114.905431,atomicNumber:48,spin:"1/2+",magneticMoment:"-0.648",halfLife:192456},{id:"Cd116",massNumber:116,relativeAbundance:.07490000000000001,atomicNumber:48,exactMass:115.904756,spin:"0+",halfLife:-1},{id:"Cd117",massNumber:117,exactMass:116.907219,atomicNumber:48,halfLife:8964},{id:"Cd118",massNumber:118,exactMass:117.906915,atomicNumber:48,halfLife:3018},{id:"Cd119",massNumber:119,exactMass:118.90992,atomicNumber:48,halfLife:161.4},{id:"Cd120",massNumber:120,exactMass:119.90985,atomicNumber:48,halfLife:50.8},{id:"Cd121",massNumber:121,exactMass:120.91298,atomicNumber:48,halfLife:13.5},{id:"Cd122",massNumber:122,exactMass:121.91333,atomicNumber:48,halfLife:5.24},{id:"Cd123",massNumber:123,exactMass:122.917,atomicNumber:48,halfLife:2.1},{id:"Cd124",massNumber:124,exactMass:123.91765,atomicNumber:48,halfLife:1.25},{id:"Cd125",massNumber:125,exactMass:124.92125,atomicNumber:48,halfLife:.65},{id:"Cd126",massNumber:126,exactMass:125.92235,atomicNumber:48,halfLife:.506},{id:"Cd127",massNumber:127,exactMass:126.92644,atomicNumber:48,halfLife:.37},{id:"Cd128",massNumber:128,exactMass:127.92776,atomicNumber:48,halfLife:.34},{id:"Cd129",massNumber:129,exactMass:128.93215,atomicNumber:48,halfLife:.27},{id:"Cd130",massNumber:130,exactMass:129.9339,atomicNumber:48,halfLife:.2},{id:"Cd131",massNumber:131,exactMass:130.94067,atomicNumber:48},{id:"Cd132",massNumber:132,exactMass:131.94555,atomicNumber:48}]},{elementSymbol:"In",atomicNumber:49,isotopes:[{id:"In97",massNumber:97,exactMass:96.94954,atomicNumber:49},{id:"In98",massNumber:98,exactMass:97.94214,atomicNumber:49},{id:"In99",massNumber:99,exactMass:98.93422,atomicNumber:49},{id:"In100",massNumber:100,exactMass:99.93111,atomicNumber:49,halfLife:7},{id:"In101",massNumber:101,exactMass:100.92634,atomicNumber:49,halfLife:15.1},{id:"In102",massNumber:102,exactMass:101.92409,atomicNumber:49,halfLife:22},{id:"In103",massNumber:103,exactMass:102.919914,atomicNumber:49,halfLife:65},{id:"In104",massNumber:104,exactMass:103.9183,atomicNumber:49,halfLife:108},{id:"In105",massNumber:105,exactMass:104.914674,atomicNumber:49,halfLife:304.2},{id:"In106",massNumber:106,exactMass:105.913465,atomicNumber:49,halfLife:372},{id:"In107",massNumber:107,exactMass:106.910295,atomicNumber:49,halfLife:1944},{id:"In108",massNumber:108,exactMass:107.909698,atomicNumber:49,halfLife:3480},{id:"In109",massNumber:109,exactMass:108.907151,atomicNumber:49,halfLife:15120},{id:"In110",massNumber:110,exactMass:109.907165,atomicNumber:49,halfLife:17640},{id:"In111",massNumber:111,exactMass:110.905103,atomicNumber:49,spin:"9/2+",halfLife:242326},{id:"In112",massNumber:112,exactMass:111.905532,atomicNumber:49,spin:"1+",halfLife:898.2},{id:"In113",massNumber:113,relativeAbundance:.0429,atomicNumber:49,exactMass:112.904058,spin:"1/2-",magneticMoment:"+5.5229",halfLife:-1},{id:"In114",massNumber:114,exactMass:113.904914,atomicNumber:49,spin:"5+",halfLife:71.9},{id:"In115",massNumber:115,relativeAbundance:.9571,atomicNumber:49,exactMass:114.903878,spin:"9/2+",magneticMoment:"+5.534"},{id:"In116",massNumber:116,exactMass:115.90526,atomicNumber:49,spin:"1+",halfLife:14.1},{id:"In117",massNumber:117,exactMass:116.904514,atomicNumber:49,halfLife:2592},{id:"In118",massNumber:118,exactMass:117.906354,atomicNumber:49,halfLife:5},{id:"In119",massNumber:119,exactMass:118.905845,atomicNumber:49,halfLife:144},{id:"In120",massNumber:120,exactMass:119.90796,atomicNumber:49,halfLife:3.08},{id:"In121",massNumber:121,exactMass:120.907846,atomicNumber:49,halfLife:23.1},{id:"In122",massNumber:122,exactMass:121.91028,atomicNumber:49,halfLife:1.5},{id:"In123",massNumber:123,exactMass:122.910438,atomicNumber:49,halfLife:5.98},{id:"In124",massNumber:124,exactMass:123.91318,atomicNumber:49,halfLife:3.11},{id:"In125",massNumber:125,exactMass:124.9136,atomicNumber:49,halfLife:2.36},{id:"In126",massNumber:126,exactMass:125.91646,atomicNumber:49,halfLife:1.6},{id:"In127",massNumber:127,exactMass:126.91735,atomicNumber:49,halfLife:1.09},{id:"In128",massNumber:128,exactMass:127.92017,atomicNumber:49,halfLife:.84},{id:"In129",massNumber:129,exactMass:128.9217,atomicNumber:49,halfLife:.61},{id:"In130",massNumber:130,exactMass:129.92497,atomicNumber:49,halfLife:.32},{id:"In131",massNumber:131,exactMass:130.92685,atomicNumber:49,halfLife:.282},{id:"In132",massNumber:132,exactMass:131.93299,atomicNumber:49,halfLife:.201},{id:"In133",massNumber:133,exactMass:132.93781,atomicNumber:49,halfLife:.18},{id:"In134",massNumber:134,exactMass:133.94415,atomicNumber:49,halfLife:.138},{id:"In135",massNumber:135,exactMass:134.94933,atomicNumber:49}]},{elementSymbol:"Sn",atomicNumber:50,isotopes:[{id:"Sn99",massNumber:99,exactMass:98.94933,atomicNumber:50},{id:"Sn100",massNumber:100,exactMass:99.93904,atomicNumber:50,halfLife:.94},{id:"Sn101",massNumber:101,exactMass:100.93606,atomicNumber:50,halfLife:3},{id:"Sn102",massNumber:102,exactMass:101.9303,atomicNumber:50,halfLife:4.5},{id:"Sn103",massNumber:103,exactMass:102.9281,atomicNumber:50,halfLife:7},{id:"Sn104",massNumber:104,exactMass:103.92314,atomicNumber:50,halfLife:20.8},{id:"Sn105",massNumber:105,exactMass:104.92135,atomicNumber:50,halfLife:31},{id:"Sn106",massNumber:106,exactMass:105.91688,atomicNumber:50,halfLife:115},{id:"Sn107",massNumber:107,exactMass:106.91564,atomicNumber:50,halfLife:174},{id:"Sn108",massNumber:108,exactMass:107.911925,atomicNumber:50,halfLife:618},{id:"Sn109",massNumber:109,exactMass:108.911283,atomicNumber:50,halfLife:1080},{id:"Sn110",massNumber:110,exactMass:109.907843,atomicNumber:50,halfLife:14796},{id:"Sn111",massNumber:111,exactMass:110.907734,atomicNumber:50,halfLife:2118},{id:"Sn112",massNumber:112,relativeAbundance:.0097,atomicNumber:50,exactMass:111.904818,spin:"0+",halfLife:-1},{id:"Sn113",massNumber:113,exactMass:112.905171,atomicNumber:50,spin:"1/2+",halfLife:9943780,ecDecay:"1.02",ecDecayLikeliness:"100.0"},{id:"Sn114",massNumber:114,relativeAbundance:.0066,atomicNumber:50,exactMass:113.902779,spin:"0+",halfLife:-1},{id:"Sn115",massNumber:115,relativeAbundance:.0034000000000000002,atomicNumber:50,exactMass:114.903342,spin:"1/2+",magneticMoment:"-0.91883",halfLife:-1},{id:"Sn116",massNumber:116,relativeAbundance:.1454,atomicNumber:50,exactMass:115.901741,spin:"0+",halfLife:-1},{id:"Sn117",massNumber:117,relativeAbundance:.0768,atomicNumber:50,exactMass:116.902952,spin:"1/2+",magneticMoment:"1.00104",halfLife:-1},{id:"Sn118",massNumber:118,relativeAbundance:.2422,atomicNumber:50,exactMass:117.901603,spin:"0+",halfLife:-1},{id:"Sn119",massNumber:119,relativeAbundance:.0859,atomicNumber:50,exactMass:118.903308,spin:"1/2+",magneticMoment:"-1.04728",halfLife:-1},{id:"Sn120",massNumber:120,relativeAbundance:.3258,atomicNumber:50,exactMass:119.9021947,spin:"0+",halfLife:-1},{id:"Sn121",massNumber:121,exactMass:120.9042355,atomicNumber:50,spin:"11/2-",halfLife:97416},{id:"Sn122",massNumber:122,relativeAbundance:.0463,atomicNumber:50,exactMass:121.903439,spin:"0+",halfLife:-1},{id:"Sn123",massNumber:123,exactMass:122.9057208,atomicNumber:50,spin:"11/2-",halfLife:11162900},{id:"Sn124",massNumber:124,relativeAbundance:.0579,atomicNumber:50,exactMass:123.9052739,spin:"0+",halfLife:-1},{id:"Sn125",massNumber:125,exactMass:124.9077841,atomicNumber:50,halfLife:832896},{id:"Sn126",massNumber:126,exactMass:125.907653,atomicNumber:50,halfLife:-1},{id:"Sn127",massNumber:127,exactMass:126.91036,atomicNumber:50,halfLife:7560},{id:"Sn128",massNumber:128,exactMass:127.910537,atomicNumber:50,halfLife:3544.2},{id:"Sn129",massNumber:129,exactMass:128.91348,atomicNumber:50,halfLife:133.8},{id:"Sn130",massNumber:130,exactMass:129.913967,atomicNumber:50,halfLife:223.2},{id:"Sn131",massNumber:131,exactMass:130.917,atomicNumber:50,halfLife:56},{id:"Sn132",massNumber:132,exactMass:131.917816,atomicNumber:50,halfLife:39.7},{id:"Sn133",massNumber:133,exactMass:132.92383,atomicNumber:50,halfLife:1.45},{id:"Sn134",massNumber:134,exactMass:133.92829,atomicNumber:50,halfLife:1.12},{id:"Sn135",massNumber:135,exactMass:134.93473,atomicNumber:50},{id:"Sn136",massNumber:136,exactMass:135.93934,atomicNumber:50},{id:"Sn137",massNumber:137,exactMass:136.94599,atomicNumber:50}]},{elementSymbol:"Sb",atomicNumber:51,isotopes:[{id:"Sb103",massNumber:103,exactMass:102.93969,atomicNumber:51},{id:"Sb104",massNumber:104,exactMass:103.93647,atomicNumber:51},{id:"Sb105",massNumber:105,exactMass:104.93149,atomicNumber:51},{id:"Sb106",massNumber:106,exactMass:105.92879,atomicNumber:51},{id:"Sb107",massNumber:107,exactMass:106.92415,atomicNumber:51},{id:"Sb108",massNumber:108,exactMass:107.92216,atomicNumber:51,halfLife:7.4},{id:"Sb109",massNumber:109,exactMass:108.918132,atomicNumber:51,halfLife:17},{id:"Sb110",massNumber:110,exactMass:109.91675,atomicNumber:51,halfLife:23},{id:"Sb111",massNumber:111,exactMass:110.91316,atomicNumber:51,halfLife:75},{id:"Sb112",massNumber:112,exactMass:111.912398,atomicNumber:51,halfLife:51.4},{id:"Sb113",massNumber:113,exactMass:112.909372,atomicNumber:51,halfLife:400.2},{id:"Sb114",massNumber:114,exactMass:113.90927,atomicNumber:51,halfLife:209.4},{id:"Sb115",massNumber:115,exactMass:114.906598,atomicNumber:51,halfLife:1926},{id:"Sb116",massNumber:116,exactMass:115.906794,atomicNumber:51,halfLife:948},{id:"Sb117",massNumber:117,exactMass:116.904836,atomicNumber:51,halfLife:10080},{id:"Sb118",massNumber:118,exactMass:117.905529,atomicNumber:51,halfLife:216},{id:"Sb119",massNumber:119,exactMass:118.903942,atomicNumber:51,halfLife:137484},{id:"Sb120",massNumber:120,exactMass:119.905072,atomicNumber:51,spin:"1+",halfLife:953.4},{id:"Sb121",massNumber:121,relativeAbundance:.5721,atomicNumber:51,exactMass:120.9038157,spin:"5/2+",magneticMoment:"+3.3592",halfLife:-1},{id:"Sb122",massNumber:122,exactMass:121.9051737,atomicNumber:51,spin:"2-",halfLife:235336},{id:"Sb123",massNumber:123,relativeAbundance:.4279,atomicNumber:51,exactMass:122.904214,spin:"7/2+",magneticMoment:"+2.5466",halfLife:-1},{id:"Sb124",massNumber:124,exactMass:123.9059357,atomicNumber:51,spin:"3-",halfLife:5201280},{id:"Sb125",massNumber:125,exactMass:124.9052538,atomicNumber:51,halfLife:86982600},{id:"Sb126",massNumber:126,exactMass:125.90725,atomicNumber:51,halfLife:1076540},{id:"Sb127",massNumber:127,exactMass:126.906924,atomicNumber:51,halfLife:332640},{id:"Sb128",massNumber:128,exactMass:127.909169,atomicNumber:51,halfLife:32436},{id:"Sb129",massNumber:129,exactMass:128.909148,atomicNumber:51,halfLife:15840},{id:"Sb130",massNumber:130,exactMass:129.911656,atomicNumber:51,halfLife:2370},{id:"Sb131",massNumber:131,exactMass:130.911982,atomicNumber:51,halfLife:1381.8},{id:"Sb132",massNumber:132,exactMass:131.914467,atomicNumber:51,halfLife:167.4},{id:"Sb133",massNumber:133,exactMass:132.915252,atomicNumber:51,halfLife:150},{id:"Sb134",massNumber:134,exactMass:133.92038,atomicNumber:51,halfLife:.78},{id:"Sb135",massNumber:135,exactMass:134.92517,atomicNumber:51,halfLife:1.71},{id:"Sb136",massNumber:136,exactMass:135.93035,atomicNumber:51,halfLife:.82},{id:"Sb137",massNumber:137,exactMass:136.93531,atomicNumber:51},{id:"Sb138",massNumber:138,exactMass:137.94079,atomicNumber:51},{id:"Sb139",massNumber:139,exactMass:138.94598,atomicNumber:51}]},{elementSymbol:"Te",atomicNumber:52,isotopes:[{id:"Te105",massNumber:105,exactMass:104.94364,atomicNumber:52},{id:"Te106",massNumber:106,exactMass:105.9375,atomicNumber:52,halfLife:6e-5},{id:"Te107",massNumber:107,exactMass:106.93501,atomicNumber:52,halfLife:.0031},{id:"Te108",massNumber:108,exactMass:107.92944,atomicNumber:52,halfLife:2.1},{id:"Te109",massNumber:109,exactMass:108.92742,atomicNumber:52,halfLife:4.6},{id:"Te110",massNumber:110,exactMass:109.92241,atomicNumber:52,halfLife:18.6},{id:"Te111",massNumber:111,exactMass:110.92111,atomicNumber:52,halfLife:19.3},{id:"Te112",massNumber:112,exactMass:111.91701,atomicNumber:52},{id:"Te113",massNumber:113,exactMass:112.91589,atomicNumber:52,halfLife:102},{id:"Te114",massNumber:114,exactMass:113.91209,atomicNumber:52,halfLife:912},{id:"Te115",massNumber:115,exactMass:114.9119,atomicNumber:52,halfLife:348},{id:"Te116",massNumber:116,exactMass:115.90846,atomicNumber:52,halfLife:8964},{id:"Te117",massNumber:117,exactMass:116.908645,atomicNumber:52,halfLife:3720},{id:"Te118",massNumber:118,exactMass:117.905828,atomicNumber:52,halfLife:518400},{id:"Te119",massNumber:119,exactMass:118.906404,atomicNumber:52,halfLife:57708},{id:"Te120",massNumber:120,relativeAbundance:9e-4,atomicNumber:52,exactMass:119.90402,spin:"0+",halfLife:-1},{id:"Te121",massNumber:121,exactMass:120.904936,atomicNumber:52,spin:"1/2+",halfLife:1449790},{id:"Te122",massNumber:122,relativeAbundance:.0255,atomicNumber:52,exactMass:121.9030439,spin:"0+",magneticMoment:"-0.7359",halfLife:-1,ecDecay:"0.052",ecDecayLikeliness:"100.0"},{id:"Te123",massNumber:123,relativeAbundance:.0089,atomicNumber:52,exactMass:122.90427,spin:"1/2+",halfLife:-1},{id:"Te124",massNumber:124,relativeAbundance:.047400000000000005,atomicNumber:52,exactMass:123.9028179,spin:"0+",magneticMoment:"-0.8871",halfLife:-1},{id:"Te125",massNumber:125,relativeAbundance:.0707,atomicNumber:52,exactMass:124.9044307,spin:"1/2+",halfLife:-1},{id:"Te126",massNumber:126,relativeAbundance:.1884,atomicNumber:52,exactMass:125.9033117,spin:"0+",halfLife:-1,betaminusDecay:"0.697",betaminusDecayLikeliness:"100.0"},{id:"Te127",massNumber:127,exactMass:126.9052263,atomicNumber:52,spin:"3/2+",halfLife:33660},{id:"Te128",massNumber:128,relativeAbundance:.31739999999999996,atomicNumber:52,exactMass:127.9044631,spin:"0+"},{id:"Te129",massNumber:129,exactMass:128.9065982,atomicNumber:52,spin:"3/2+",halfLife:4176},{id:"Te130",massNumber:130,relativeAbundance:.3408,atomicNumber:52,exactMass:129.9062244,spin:"0+"},{id:"Te131",massNumber:131,exactMass:130.9085239,atomicNumber:52,halfLife:1500},{id:"Te132",massNumber:132,exactMass:131.908553,atomicNumber:52,halfLife:276826},{id:"Te133",massNumber:133,exactMass:132.910955,atomicNumber:52,halfLife:750},{id:"Te134",massNumber:134,exactMass:133.911369,atomicNumber:52,halfLife:2508},{id:"Te135",massNumber:135,exactMass:134.91645,atomicNumber:52,halfLife:19},{id:"Te136",massNumber:136,exactMass:135.9201,atomicNumber:52,halfLife:17.5},{id:"Te137",massNumber:137,exactMass:136.92532,atomicNumber:52,halfLife:2.49},{id:"Te138",massNumber:138,exactMass:137.92922,atomicNumber:52,halfLife:1.4},{id:"Te139",massNumber:139,exactMass:138.93473,atomicNumber:52},{id:"Te140",massNumber:140,exactMass:139.93885,atomicNumber:52},{id:"Te141",massNumber:141,exactMass:140.94465,atomicNumber:52},{id:"Te142",massNumber:142,exactMass:141.94908,atomicNumber:52}]},{elementSymbol:"I",atomicNumber:53,isotopes:[{id:"I108",massNumber:108,exactMass:107.94348,atomicNumber:53,halfLife:.036},{id:"I109",massNumber:109,exactMass:108.93815,atomicNumber:53,halfLife:1e-4},{id:"I110",massNumber:110,exactMass:109.93524,atomicNumber:53,halfLife:.65},{id:"I111",massNumber:111,exactMass:110.93028,atomicNumber:53,halfLife:2.5},{id:"I112",massNumber:112,exactMass:111.92797,atomicNumber:53,halfLife:3.42},{id:"I113",massNumber:113,exactMass:112.92364,atomicNumber:53,halfLife:6.6},{id:"I114",massNumber:114,exactMass:113.92185,atomicNumber:53,halfLife:2.1},{id:"I115",massNumber:115,exactMass:114.91805,atomicNumber:53,halfLife:78},{id:"I116",massNumber:116,exactMass:115.91681,atomicNumber:53,halfLife:2.91},{id:"I117",massNumber:117,exactMass:116.91365,atomicNumber:53,halfLife:133.2},{id:"I118",massNumber:118,exactMass:117.913074,atomicNumber:53,halfLife:822},{id:"I119",massNumber:119,exactMass:118.91007,atomicNumber:53,halfLife:1146},{id:"I120",massNumber:120,exactMass:119.910048,atomicNumber:53,halfLife:4860},{id:"I121",massNumber:121,exactMass:120.907367,atomicNumber:53,halfLife:7632},{id:"I122",massNumber:122,exactMass:121.907589,atomicNumber:53,halfLife:217.8},{id:"I123",massNumber:123,exactMass:122.905589,atomicNumber:53,halfLife:47772},{id:"I124",massNumber:124,exactMass:123.9062099,atomicNumber:53,halfLife:360806},{id:"I125",massNumber:125,exactMass:124.9046302,atomicNumber:53,spin:"5/2+",halfLife:5132850},{id:"I126",massNumber:126,exactMass:125.905624,atomicNumber:53,spin:"2-",halfLife:1132700},{id:"I127",massNumber:127,relativeAbundance:1,atomicNumber:53,exactMass:126.904473,spin:"5/2+",magneticMoment:"+2.808",halfLife:-1},{id:"I128",massNumber:128,exactMass:127.905809,atomicNumber:53,spin:"1+",halfLife:1499.4},{id:"I129",massNumber:129,exactMass:128.904988,atomicNumber:53,magneticMoment:"+2.617",halfLife:157e5,betaminusDecay:"0.193",betaminusDecayLikeliness:"100.0"},{id:"I130",massNumber:130,exactMass:129.906674,atomicNumber:53,halfLife:44496},{id:"I131",massNumber:131,exactMass:130.9061246,atomicNumber:53,halfLife:692988},{id:"I132",massNumber:132,exactMass:131.907997,atomicNumber:53,halfLife:8262},{id:"I133",massNumber:133,exactMass:132.907797,atomicNumber:53,halfLife:74880},{id:"I134",massNumber:134,exactMass:133.909744,atomicNumber:53,halfLife:3150},{id:"I135",massNumber:135,exactMass:134.910048,atomicNumber:53,halfLife:23652},{id:"I136",massNumber:136,exactMass:135.91465,atomicNumber:53,halfLife:83.4},{id:"I137",massNumber:137,exactMass:136.917871,atomicNumber:53,halfLife:24.5},{id:"I138",massNumber:138,exactMass:137.92235,atomicNumber:53,halfLife:6.49},{id:"I139",massNumber:139,exactMass:138.9261,atomicNumber:53,halfLife:2.29},{id:"I140",massNumber:140,exactMass:139.931,atomicNumber:53,halfLife:.86},{id:"I141",massNumber:141,exactMass:140.93503,atomicNumber:53,halfLife:.43},{id:"I142",massNumber:142,exactMass:141.94018,atomicNumber:53},{id:"I143",massNumber:143,exactMass:142.94456,atomicNumber:53},{id:"I144",massNumber:144,exactMass:143.94999,atomicNumber:53}]},{elementSymbol:"Xe",atomicNumber:54,isotopes:[{id:"Xe110",massNumber:110,exactMass:109.94428,atomicNumber:54,halfLife:6e-7},{id:"Xe111",massNumber:111,exactMass:110.9416,atomicNumber:54,halfLife:.74},{id:"Xe112",massNumber:112,exactMass:111.93562,atomicNumber:54,halfLife:2.7},{id:"Xe113",massNumber:113,exactMass:112.93334,atomicNumber:54,halfLife:2.74},{id:"Xe114",massNumber:114,exactMass:113.92798,atomicNumber:54,halfLife:10},{id:"Xe115",massNumber:115,exactMass:114.926294,atomicNumber:54,halfLife:18},{id:"Xe116",massNumber:116,exactMass:115.921581,atomicNumber:54,halfLife:59},{id:"Xe117",massNumber:117,exactMass:116.920359,atomicNumber:54,halfLife:61},{id:"Xe118",massNumber:118,exactMass:117.916179,atomicNumber:54,halfLife:228},{id:"Xe119",massNumber:119,exactMass:118.915411,atomicNumber:54,halfLife:348},{id:"Xe120",massNumber:120,exactMass:119.911784,atomicNumber:54,halfLife:2400},{id:"Xe121",massNumber:121,exactMass:120.911462,atomicNumber:54,halfLife:2406},{id:"Xe122",massNumber:122,exactMass:121.908368,atomicNumber:54,halfLife:72360},{id:"Xe123",massNumber:123,exactMass:122.908482,atomicNumber:54,halfLife:7488},{id:"Xe124",massNumber:124,relativeAbundance:9e-4,atomicNumber:54,exactMass:123.905893,spin:"0+"},{id:"Xe125",massNumber:125,exactMass:124.9063955,atomicNumber:54,spin:"1/2+",halfLife:60840,ecDecay:"",ecDecayLikeliness:"100.0"},{id:"Xe126",massNumber:126,relativeAbundance:9e-4,atomicNumber:54,exactMass:125.904274,spin:"0+",halfLife:-1},{id:"Xe127",massNumber:127,exactMass:126.905184,atomicNumber:54,spin:"1/2+",halfLife:3144960,ecDecay:"0.44",ecDecayLikeliness:"100.0"},{id:"Xe128",massNumber:128,relativeAbundance:.0192,atomicNumber:54,exactMass:127.9035313,spin:"0+",halfLife:-1},{id:"Xe129",massNumber:129,relativeAbundance:.2644,atomicNumber:54,exactMass:128.9047794,spin:"1/2+",magneticMoment:"-0.7768",halfLife:-1},{id:"Xe130",massNumber:130,relativeAbundance:.0408,atomicNumber:54,exactMass:129.903508,spin:"0+",halfLife:-1},{id:"Xe131",massNumber:131,relativeAbundance:.2118,atomicNumber:54,exactMass:130.9050824,spin:"3/2+",magneticMoment:"+0.691861",halfLife:-1},{id:"Xe132",massNumber:132,relativeAbundance:.26890000000000003,atomicNumber:54,exactMass:131.9041535,spin:"0+",halfLife:-1},{id:"Xe133",massNumber:133,exactMass:132.9059107,atomicNumber:54,spin:"3/2+",halfLife:452995},{id:"Xe134",massNumber:134,relativeAbundance:.10439999999999999,atomicNumber:54,exactMass:133.9053945,spin:"0+",halfLife:-1},{id:"Xe135",massNumber:135,exactMass:134.907227,atomicNumber:54,spin:"3/2+",halfLife:32904},{id:"Xe136",massNumber:136,relativeAbundance:.08869999999999999,atomicNumber:54,exactMass:135.907219,spin:"0+"},{id:"Xe137",massNumber:137,exactMass:136.911562,atomicNumber:54,halfLife:229.08},{id:"Xe138",massNumber:138,exactMass:137.91395,atomicNumber:54,halfLife:844.8},{id:"Xe139",massNumber:139,exactMass:138.918793,atomicNumber:54,halfLife:39.68},{id:"Xe140",massNumber:140,exactMass:139.92164,atomicNumber:54,halfLife:13.6},{id:"Xe141",massNumber:141,exactMass:140.92665,atomicNumber:54,halfLife:1.73},{id:"Xe142",massNumber:142,exactMass:141.92971,atomicNumber:54,halfLife:1.22},{id:"Xe143",massNumber:143,exactMass:142.93511,atomicNumber:54,halfLife:.3},{id:"Xe144",massNumber:144,exactMass:143.93851,atomicNumber:54,halfLife:1.15},{id:"Xe145",massNumber:145,exactMass:144.94407,atomicNumber:54,halfLife:.9},{id:"Xe146",massNumber:146,exactMass:145.94775,atomicNumber:54},{id:"Xe147",massNumber:147,exactMass:146.95356,atomicNumber:54}]},{elementSymbol:"Cs",atomicNumber:55,isotopes:[{id:"Cs112",massNumber:112,exactMass:111.9503,atomicNumber:55},{id:"Cs113",massNumber:113,exactMass:112.94449,atomicNumber:55,halfLife:17e-6},{id:"Cs114",massNumber:114,exactMass:113.94145,atomicNumber:55,halfLife:.57},{id:"Cs115",massNumber:115,exactMass:114.93591,atomicNumber:55,halfLife:1.4},{id:"Cs116",massNumber:116,exactMass:115.93337,atomicNumber:55,halfLife:3.84},{id:"Cs117",massNumber:117,exactMass:116.92867,atomicNumber:55,halfLife:8.4},{id:"Cs118",massNumber:118,exactMass:117.926559,atomicNumber:55,halfLife:14},{id:"Cs119",massNumber:119,exactMass:118.922377,atomicNumber:55,halfLife:43},{id:"Cs120",massNumber:120,exactMass:119.920677,atomicNumber:55,halfLife:64},{id:"Cs121",massNumber:121,exactMass:120.917229,atomicNumber:55,halfLife:155},{id:"Cs122",massNumber:122,exactMass:121.91611,atomicNumber:55,halfLife:21},{id:"Cs123",massNumber:123,exactMass:122.912996,atomicNumber:55,halfLife:356.4},{id:"Cs124",massNumber:124,exactMass:123.912258,atomicNumber:55,halfLife:30.8},{id:"Cs125",massNumber:125,exactMass:124.909728,atomicNumber:55,halfLife:2700},{id:"Cs126",massNumber:126,exactMass:125.909452,atomicNumber:55,halfLife:98.4},{id:"Cs127",massNumber:127,exactMass:126.907418,atomicNumber:55,halfLife:22500},{id:"Cs128",massNumber:128,exactMass:127.907749,atomicNumber:55,halfLife:219.6},{id:"Cs129",massNumber:129,exactMass:128.906064,atomicNumber:55,halfLife:115416},{id:"Cs130",massNumber:130,exactMass:129.906709,atomicNumber:55,halfLife:1752.6},{id:"Cs131",massNumber:131,exactMass:130.905464,atomicNumber:55,halfLife:837130},{id:"Cs132",massNumber:132,exactMass:131.9064343,atomicNumber:55,halfLife:559786},{id:"Cs133",massNumber:133,relativeAbundance:1,atomicNumber:55,exactMass:132.9054519,spin:"7/2+",magneticMoment:"+2.579",halfLife:-1},{id:"Cs134",massNumber:134,exactMass:133.9067185,atomicNumber:55,spin:"4+",halfLife:65115500},{id:"Cs135",massNumber:135,exactMass:134.905977,atomicNumber:55,spin:"7/2+",magneticMoment:"+2.729",halfLife:23e5,betaminusDecay:"2.05",betaminusDecayLikeliness:"100.0"},{id:"Cs136",massNumber:136,exactMass:135.9073116,atomicNumber:55,halfLife:1137020},{id:"Cs137",massNumber:137,exactMass:136.9070895,atomicNumber:55,halfLife:948288e3},{id:"Cs138",massNumber:138,exactMass:137.911017,atomicNumber:55,halfLife:2004.6},{id:"Cs139",massNumber:139,exactMass:138.913364,atomicNumber:55,halfLife:556.2},{id:"Cs140",massNumber:140,exactMass:139.917282,atomicNumber:55,halfLife:63.7},{id:"Cs141",massNumber:141,exactMass:140.920046,atomicNumber:55,halfLife:24.94},{id:"Cs142",massNumber:142,exactMass:141.924299,atomicNumber:55,halfLife:1.7},{id:"Cs143",massNumber:143,exactMass:142.927352,atomicNumber:55,halfLife:1.78},{id:"Cs144",massNumber:144,exactMass:143.932077,atomicNumber:55,halfLife:1.01},{id:"Cs145",massNumber:145,exactMass:144.935526,atomicNumber:55,halfLife:.594},{id:"Cs146",massNumber:146,exactMass:145.94029,atomicNumber:55,halfLife:.321},{id:"Cs147",massNumber:147,exactMass:146.94416,atomicNumber:55,halfLife:.225},{id:"Cs148",massNumber:148,exactMass:147.94922,atomicNumber:55,halfLife:.158},{id:"Cs149",massNumber:149,exactMass:148.95293,atomicNumber:55},{id:"Cs150",massNumber:150,exactMass:149.95817,atomicNumber:55},{id:"Cs151",massNumber:151,exactMass:150.96219,atomicNumber:55}]},{elementSymbol:"Ba",atomicNumber:56,isotopes:[{id:"Ba114",massNumber:114,exactMass:113.95068,atomicNumber:56,halfLife:.43},{id:"Ba115",massNumber:115,exactMass:114.94737,atomicNumber:56,halfLife:.4},{id:"Ba116",massNumber:116,exactMass:115.94138,atomicNumber:56,halfLife:.3},{id:"Ba117",massNumber:117,exactMass:116.9385,atomicNumber:56,halfLife:1.75},{id:"Ba118",massNumber:118,exactMass:117.93304,atomicNumber:56,halfLife:5.5},{id:"Ba119",massNumber:119,exactMass:118.93066,atomicNumber:56,halfLife:5.4},{id:"Ba120",massNumber:120,exactMass:119.92604,atomicNumber:56,halfLife:32},{id:"Ba121",massNumber:121,exactMass:120.92405,atomicNumber:56,halfLife:29.7},{id:"Ba122",massNumber:122,exactMass:121.9199,atomicNumber:56,halfLife:117},{id:"Ba123",massNumber:123,exactMass:122.918781,atomicNumber:56,halfLife:162},{id:"Ba124",massNumber:124,exactMass:123.915094,atomicNumber:56,halfLife:660},{id:"Ba125",massNumber:125,exactMass:124.914473,atomicNumber:56,halfLife:210},{id:"Ba126",massNumber:126,exactMass:125.91125,atomicNumber:56,halfLife:6e3},{id:"Ba127",massNumber:127,exactMass:126.911094,atomicNumber:56,halfLife:762},{id:"Ba128",massNumber:128,exactMass:127.908318,atomicNumber:56,halfLife:209952},{id:"Ba129",massNumber:129,exactMass:128.908679,atomicNumber:56,halfLife:8028},{id:"Ba130",massNumber:130,relativeAbundance:.00106,atomicNumber:56,exactMass:129.9063208,spin:"0+",halfLife:-1},{id:"Ba131",massNumber:131,exactMass:130.906941,atomicNumber:56,spin:"1/2+",halfLife:993600,ecDecay:"1.16",ecDecayLikeliness:"100.0"},{id:"Ba132",massNumber:132,relativeAbundance:.00101,atomicNumber:56,exactMass:131.9050613,spin:"0+",halfLife:-1},{id:"Ba133",massNumber:133,exactMass:132.9060075,atomicNumber:56,spin:"1/2+",halfLife:331443e3},{id:"Ba134",massNumber:134,relativeAbundance:.024169999999999997,atomicNumber:56,exactMass:133.9045084,spin:"0+",halfLife:-1},{id:"Ba135",massNumber:135,relativeAbundance:.06591999999999999,atomicNumber:56,exactMass:134.9056886,spin:"3/2+",magneticMoment:"+0.8365",halfLife:-1},{id:"Ba136",massNumber:136,relativeAbundance:.07854,atomicNumber:56,exactMass:135.9045759,spin:"0+",halfLife:-1},{id:"Ba137",massNumber:137,relativeAbundance:.11231999999999999,atomicNumber:56,exactMass:136.9058274,spin:"3/2+",magneticMoment:"+0.9357",halfLife:-1},{id:"Ba138",massNumber:138,relativeAbundance:.71698,atomicNumber:56,exactMass:137.9052472,spin:"0+",halfLife:-1},{id:"Ba139",massNumber:139,exactMass:138.9088413,atomicNumber:56,halfLife:4983.6},{id:"Ba140",massNumber:140,exactMass:139.910605,atomicNumber:56,halfLife:1101770},{id:"Ba141",massNumber:141,exactMass:140.914411,atomicNumber:56,halfLife:1096.2},{id:"Ba142",massNumber:142,exactMass:141.916453,atomicNumber:56,halfLife:636},{id:"Ba143",massNumber:143,exactMass:142.920627,atomicNumber:56,halfLife:14.33},{id:"Ba144",massNumber:144,exactMass:143.922953,atomicNumber:56,halfLife:11.5},{id:"Ba145",massNumber:145,exactMass:144.92763,atomicNumber:56,halfLife:4.31},{id:"Ba146",massNumber:146,exactMass:145.93022,atomicNumber:56,halfLife:2.22},{id:"Ba147",massNumber:147,exactMass:146.93495,atomicNumber:56,halfLife:.893},{id:"Ba148",massNumber:148,exactMass:147.93772,atomicNumber:56,halfLife:.607},{id:"Ba149",massNumber:149,exactMass:148.94258,atomicNumber:56,halfLife:.344},{id:"Ba150",massNumber:150,exactMass:149.94568,atomicNumber:56,halfLife:.3},{id:"Ba151",massNumber:151,exactMass:150.95081,atomicNumber:56},{id:"Ba152",massNumber:152,exactMass:151.95427,atomicNumber:56},{id:"Ba153",massNumber:153,exactMass:152.95961,atomicNumber:56}]},{elementSymbol:"La",atomicNumber:57,isotopes:[{id:"La117",massNumber:117,exactMass:116.95007,atomicNumber:57},{id:"La118",massNumber:118,exactMass:117.94673,atomicNumber:57},{id:"La119",massNumber:119,exactMass:118.94099,atomicNumber:57},{id:"La120",massNumber:120,exactMass:119.93807,atomicNumber:57,halfLife:2.8},{id:"La121",massNumber:121,exactMass:120.93301,atomicNumber:57,halfLife:5.3},{id:"La122",massNumber:122,exactMass:121.93071,atomicNumber:57,halfLife:8.7},{id:"La123",massNumber:123,exactMass:122.92624,atomicNumber:57,halfLife:17},{id:"La124",massNumber:124,exactMass:123.92457,atomicNumber:57,halfLife:29},{id:"La125",massNumber:125,exactMass:124.920816,atomicNumber:57,halfLife:76},{id:"La126",massNumber:126,exactMass:125.91951,atomicNumber:57,halfLife:54},{id:"La127",massNumber:127,exactMass:126.916375,atomicNumber:57,halfLife:306},{id:"La128",massNumber:128,exactMass:127.91559,atomicNumber:57,halfLife:300},{id:"La129",massNumber:129,exactMass:128.912693,atomicNumber:57,halfLife:696},{id:"La130",massNumber:130,exactMass:129.912369,atomicNumber:57,halfLife:522},{id:"La131",massNumber:131,exactMass:130.91007,atomicNumber:57,halfLife:3540},{id:"La132",massNumber:132,exactMass:131.9101,atomicNumber:57,halfLife:17280},{id:"La133",massNumber:133,exactMass:132.90822,atomicNumber:57,halfLife:14083.2},{id:"La134",massNumber:134,exactMass:133.908514,atomicNumber:57,halfLife:387},{id:"La135",massNumber:135,exactMass:134.906977,atomicNumber:57,halfLife:70200},{id:"La136",massNumber:136,exactMass:135.90764,atomicNumber:57,halfLife:592.2},{id:"La137",massNumber:137,exactMass:136.906494,atomicNumber:57},{id:"La138",massNumber:138,relativeAbundance:9e-4,atomicNumber:57,exactMass:137.907112,spin:"5-",magneticMoment:"+3.707",halfLife:105e9,betaminusDecay:"1.04",betaminusDecayLikeliness:"33.6",ecDecay:"1.75",ecDecayLikeliness:"66.4"},{id:"La139",massNumber:139,relativeAbundance:.9991,atomicNumber:57,exactMass:138.9063533,spin:"7/2+",magneticMoment:"+2.778",halfLife:-1},{id:"La140",massNumber:140,exactMass:139.9094776,atomicNumber:57,spin:"3-",magneticMoment:"+0.73",halfLife:144988,betaminusDecay:"3.761",betaminusDecayLikeliness:"100.0"},{id:"La141",massNumber:141,exactMass:140.910962,atomicNumber:57,halfLife:14112},{id:"La142",massNumber:142,exactMass:141.914079,atomicNumber:57,halfLife:5466},{id:"La143",massNumber:143,exactMass:142.916063,atomicNumber:57,halfLife:852},{id:"La144",massNumber:144,exactMass:143.9196,atomicNumber:57,halfLife:40.8},{id:"La145",massNumber:145,exactMass:144.92165,atomicNumber:57,halfLife:24.8},{id:"La146",massNumber:146,exactMass:145.92579,atomicNumber:57,halfLife:6.27},{id:"La147",massNumber:147,exactMass:146.92824,atomicNumber:57,halfLife:4.015},{id:"La148",massNumber:148,exactMass:147.93223,atomicNumber:57,halfLife:1.05},{id:"La149",massNumber:149,exactMass:148.93473,atomicNumber:57,halfLife:1.05},{id:"La150",massNumber:150,exactMass:149.93877,atomicNumber:57,halfLife:.86},{id:"La151",massNumber:151,exactMass:150.94172,atomicNumber:57},{id:"La152",massNumber:152,exactMass:151.94625,atomicNumber:57},{id:"La153",massNumber:153,exactMass:152.94962,atomicNumber:57},{id:"La154",massNumber:154,exactMass:153.9545,atomicNumber:57},{id:"La155",massNumber:155,exactMass:154.95835,atomicNumber:57}]},{elementSymbol:"Ce",atomicNumber:58,isotopes:[{id:"Ce119",massNumber:119,exactMass:118.95276,atomicNumber:58},{id:"Ce120",massNumber:120,exactMass:119.94664,atomicNumber:58},{id:"Ce121",massNumber:121,exactMass:120.94342,atomicNumber:58},{id:"Ce122",massNumber:122,exactMass:121.93791,atomicNumber:58},{id:"Ce123",massNumber:123,exactMass:122.9354,atomicNumber:58,halfLife:3.2},{id:"Ce124",massNumber:124,exactMass:123.93041,atomicNumber:58,halfLife:6},{id:"Ce125",massNumber:125,exactMass:124.92844,atomicNumber:58,halfLife:9},{id:"Ce126",massNumber:126,exactMass:125.92397,atomicNumber:58,halfLife:50},{id:"Ce127",massNumber:127,exactMass:126.92273,atomicNumber:58,halfLife:31},{id:"Ce128",massNumber:128,exactMass:127.91891,atomicNumber:58,halfLife:4.1},{id:"Ce129",massNumber:129,exactMass:128.9181,atomicNumber:58,halfLife:210},{id:"Ce130",massNumber:130,exactMass:129.91474,atomicNumber:58,halfLife:1500},{id:"Ce131",massNumber:131,exactMass:130.91442,atomicNumber:58,halfLife:612},{id:"Ce132",massNumber:132,exactMass:131.91146,atomicNumber:58,halfLife:12636},{id:"Ce133",massNumber:133,exactMass:132.911515,atomicNumber:58,halfLife:5820},{id:"Ce134",massNumber:134,exactMass:133.908925,atomicNumber:58,halfLife:273024},{id:"Ce135",massNumber:135,exactMass:134.909151,atomicNumber:58,halfLife:63720},{id:"Ce136",massNumber:136,relativeAbundance:.00185,atomicNumber:58,exactMass:135.907172,spin:"0+",halfLife:-1},{id:"Ce137",massNumber:137,exactMass:136.907806,atomicNumber:58,spin:"3/2+",halfLife:32400,betaplusDecay:"",betaplusDecayLikeliness:"100.0",ecDecay:"",ecDecayLikeliness:"100.0"},{id:"Ce138",massNumber:138,relativeAbundance:.00251,atomicNumber:58,exactMass:137.905991,spin:"0+",halfLife:-1},{id:"Ce139",massNumber:139,exactMass:138.906653,atomicNumber:58,magneticMoment:"0.9",halfLife:11892100,ecDecay:"0.27",ecDecayLikeliness:"100.0"},{id:"Ce140",massNumber:140,relativeAbundance:.8845000000000001,atomicNumber:58,exactMass:139.9054387,spin:"0+",halfLife:-1},{id:"Ce141",massNumber:141,exactMass:140.9082763,atomicNumber:58,spin:"7/2-",magneticMoment:"0.97",halfLife:2808090,betaminusDecay:"0.581",betaminusDecayLikeliness:"100.0"},{id:"Ce142",massNumber:142,relativeAbundance:.11114,atomicNumber:58,exactMass:141.909244,spin:"0+"},{id:"Ce143",massNumber:143,exactMass:142.912386,atomicNumber:58,halfLife:118940},{id:"Ce144",massNumber:144,exactMass:143.913647,atomicNumber:58,halfLife:24614800},{id:"Ce145",massNumber:145,exactMass:144.91723,atomicNumber:58,halfLife:180.6},{id:"Ce146",massNumber:146,exactMass:145.91876,atomicNumber:58,halfLife:811.2},{id:"Ce147",massNumber:147,exactMass:146.92267,atomicNumber:58,halfLife:56.4},{id:"Ce148",massNumber:148,exactMass:147.92443,atomicNumber:58,halfLife:56},{id:"Ce149",massNumber:149,exactMass:148.9284,atomicNumber:58,halfLife:5.3},{id:"Ce150",massNumber:150,exactMass:149.93041,atomicNumber:58,halfLife:4},{id:"Ce151",massNumber:151,exactMass:150.93398,atomicNumber:58,halfLife:1.02},{id:"Ce152",massNumber:152,exactMass:151.93654,atomicNumber:58,halfLife:1.4},{id:"Ce153",massNumber:153,exactMass:152.94058,atomicNumber:58},{id:"Ce154",massNumber:154,exactMass:153.94342,atomicNumber:58},{id:"Ce155",massNumber:155,exactMass:154.94804,atomicNumber:58},{id:"Ce156",massNumber:156,exactMass:155.95126,atomicNumber:58},{id:"Ce157",massNumber:157,exactMass:156.95634,atomicNumber:58}]},{elementSymbol:"Pr",atomicNumber:59,isotopes:[{id:"Pr121",massNumber:121,exactMass:120.95536,atomicNumber:59},{id:"Pr122",massNumber:122,exactMass:121.95181,atomicNumber:59},{id:"Pr123",massNumber:123,exactMass:122.94596,atomicNumber:59},{id:"Pr124",massNumber:124,exactMass:123.94296,atomicNumber:59,halfLife:1.2},{id:"Pr125",massNumber:125,exactMass:124.93783,atomicNumber:59,halfLife:3.3},{id:"Pr126",massNumber:126,exactMass:125.93531,atomicNumber:59,halfLife:3.14},{id:"Pr127",massNumber:127,exactMass:126.93083,atomicNumber:59,halfLife:4.2},{id:"Pr128",massNumber:128,exactMass:127.92879,atomicNumber:59,halfLife:3.1},{id:"Pr129",massNumber:129,exactMass:128.9251,atomicNumber:59,halfLife:30},{id:"Pr130",massNumber:130,exactMass:129.92359,atomicNumber:59,halfLife:40},{id:"Pr131",massNumber:131,exactMass:130.92026,atomicNumber:59,halfLife:91.8},{id:"Pr132",massNumber:132,exactMass:131.91926,atomicNumber:59,halfLife:96},{id:"Pr133",massNumber:133,exactMass:132.916331,atomicNumber:59,halfLife:390},{id:"Pr134",massNumber:134,exactMass:133.91571,atomicNumber:59,halfLife:1020},{id:"Pr135",massNumber:135,exactMass:134.913112,atomicNumber:59,halfLife:1440},{id:"Pr136",massNumber:136,exactMass:135.912692,atomicNumber:59,halfLife:786},{id:"Pr137",massNumber:137,exactMass:136.910705,atomicNumber:59,halfLife:4608},{id:"Pr138",massNumber:138,exactMass:137.910755,atomicNumber:59,halfLife:87},{id:"Pr139",massNumber:139,exactMass:138.908938,atomicNumber:59,halfLife:15876},{id:"Pr140",massNumber:140,exactMass:139.909076,atomicNumber:59,halfLife:203.4},{id:"Pr141",massNumber:141,relativeAbundance:1,atomicNumber:59,exactMass:140.9076528,spin:"5/2+",magneticMoment:"+4.3",halfLife:-1},{id:"Pr142",massNumber:142,exactMass:141.9100448,atomicNumber:59,spin:"2-",halfLife:68832,betaminusDecay:"2.160",betaminusDecayLikeliness:"99.98",ecDecay:"",ecDecayLikeliness:"0.02"},{id:"Pr143",massNumber:143,exactMass:142.9108169,atomicNumber:59,halfLife:1172450},{id:"Pr144",massNumber:144,exactMass:143.913305,atomicNumber:59,halfLife:1036.8},{id:"Pr145",massNumber:145,exactMass:144.914512,atomicNumber:59,halfLife:21542.4},{id:"Pr146",massNumber:146,exactMass:145.91764,atomicNumber:59,halfLife:1449},{id:"Pr147",massNumber:147,exactMass:146.918996,atomicNumber:59,halfLife:804},{id:"Pr148",massNumber:148,exactMass:147.922135,atomicNumber:59,halfLife:136.2},{id:"Pr149",massNumber:149,exactMass:148.92372,atomicNumber:59,halfLife:135.6},{id:"Pr150",massNumber:150,exactMass:149.926673,atomicNumber:59,halfLife:6.19},{id:"Pr151",massNumber:151,exactMass:150.928319,atomicNumber:59,halfLife:18.9},{id:"Pr152",massNumber:152,exactMass:151.9315,atomicNumber:59,halfLife:3.63},{id:"Pr153",massNumber:153,exactMass:152.93384,atomicNumber:59,halfLife:4.28},{id:"Pr154",massNumber:154,exactMass:153.93752,atomicNumber:59,halfLife:2.3},{id:"Pr155",massNumber:155,exactMass:154.94012,atomicNumber:59},{id:"Pr156",massNumber:156,exactMass:155.94427,atomicNumber:59},{id:"Pr157",massNumber:157,exactMass:156.94743,atomicNumber:59},{id:"Pr158",massNumber:158,exactMass:157.95198,atomicNumber:59},{id:"Pr159",massNumber:159,exactMass:158.9555,atomicNumber:59}]},{elementSymbol:"Nd",atomicNumber:60,isotopes:[{id:"Nd124",massNumber:124,exactMass:123.95223,atomicNumber:60},{id:"Nd125",massNumber:125,exactMass:124.94888,atomicNumber:60},{id:"Nd126",massNumber:126,exactMass:125.94322,atomicNumber:60},{id:"Nd127",massNumber:127,exactMass:126.9405,atomicNumber:60,halfLife:1.8},{id:"Nd128",massNumber:128,exactMass:127.93539,atomicNumber:60,halfLife:4},{id:"Nd129",massNumber:129,exactMass:128.93319,atomicNumber:60,halfLife:7},{id:"Nd130",massNumber:130,exactMass:129.92851,atomicNumber:60,halfLife:28},{id:"Nd131",massNumber:131,exactMass:130.92725,atomicNumber:60,halfLife:27},{id:"Nd132",massNumber:132,exactMass:131.923321,atomicNumber:60,halfLife:105},{id:"Nd133",massNumber:133,exactMass:132.92235,atomicNumber:60,halfLife:70},{id:"Nd134",massNumber:134,exactMass:133.91879,atomicNumber:60,halfLife:510},{id:"Nd135",massNumber:135,exactMass:134.918181,atomicNumber:60,halfLife:744},{id:"Nd136",massNumber:136,exactMass:135.914976,atomicNumber:60,halfLife:3039},{id:"Nd137",massNumber:137,exactMass:136.914567,atomicNumber:60,halfLife:2310},{id:"Nd138",massNumber:138,exactMass:137.91195,atomicNumber:60,halfLife:18144},{id:"Nd139",massNumber:139,exactMass:138.911978,atomicNumber:60,halfLife:1782},{id:"Nd140",massNumber:140,exactMass:139.90955,atomicNumber:60,halfLife:291168},{id:"Nd141",massNumber:141,exactMass:140.90961,atomicNumber:60,halfLife:8964},{id:"Nd142",massNumber:142,relativeAbundance:.272,atomicNumber:60,exactMass:141.9077233,spin:"0+",halfLife:-1},{id:"Nd143",massNumber:143,relativeAbundance:.122,atomicNumber:60,exactMass:142.9098143,spin:"7/2-",magneticMoment:"-1.08",halfLife:-1},{id:"Nd144",massNumber:144,relativeAbundance:.23800000000000002,atomicNumber:60,exactMass:143.9100873,spin:"0+",halfLife:229e13,alphaDecay:"1.83",alphaDecayLikeliness:"100.0"},{id:"Nd145",massNumber:145,relativeAbundance:.083,atomicNumber:60,exactMass:144.9125736,spin:"7/2-",magneticMoment:"-0.66",halfLife:-1},{id:"Nd146",massNumber:146,relativeAbundance:.172,atomicNumber:60,exactMass:145.9131169,spin:"0+",halfLife:-1},{id:"Nd147",massNumber:147,exactMass:146.9161004,atomicNumber:60,spin:"5/2-",magneticMoment:"0.59",halfLife:948672,betaminusDecay:"0.91",betaminusDecayLikeliness:"100.0"},{id:"Nd148",massNumber:148,relativeAbundance:.057,atomicNumber:60,exactMass:147.916893,spin:"0+",halfLife:-1},{id:"Nd149",massNumber:149,exactMass:148.920149,atomicNumber:60,spin:"5/2-",halfLife:6220.8,betaminusDecay:"1.66",betaminusDecayLikeliness:"100.0"},{id:"Nd150",massNumber:150,relativeAbundance:.055999999999999994,atomicNumber:60,exactMass:149.920891,spin:"0+"},{id:"Nd151",massNumber:151,exactMass:150.923829,atomicNumber:60,halfLife:746.4},{id:"Nd152",massNumber:152,exactMass:151.924682,atomicNumber:60,halfLife:684},{id:"Nd153",massNumber:153,exactMass:152.927698,atomicNumber:60,halfLife:31.6},{id:"Nd154",massNumber:154,exactMass:153.92948,atomicNumber:60,halfLife:25.9},{id:"Nd155",massNumber:155,exactMass:154.93293,atomicNumber:60,halfLife:8.9},{id:"Nd156",massNumber:156,exactMass:155.93502,atomicNumber:60,halfLife:5.47},{id:"Nd157",massNumber:157,exactMass:156.93903,atomicNumber:60},{id:"Nd158",massNumber:158,exactMass:157.9416,atomicNumber:60},{id:"Nd159",massNumber:159,exactMass:158.94609,atomicNumber:60},{id:"Nd160",massNumber:160,exactMass:159.94909,atomicNumber:60},{id:"Nd161",massNumber:161,exactMass:160.95388,atomicNumber:60}]},{elementSymbol:"Pm",atomicNumber:61,isotopes:[{id:"Pm126",massNumber:126,exactMass:125.95752,atomicNumber:61},{id:"Pm127",massNumber:127,exactMass:126.95163,atomicNumber:61},{id:"Pm128",massNumber:128,exactMass:127.94842,atomicNumber:61},{id:"Pm129",massNumber:129,exactMass:128.94316,atomicNumber:61},{id:"Pm130",massNumber:130,exactMass:129.94045,atomicNumber:61},{id:"Pm131",massNumber:131,exactMass:130.93587,atomicNumber:61},{id:"Pm132",massNumber:132,exactMass:131.93375,atomicNumber:61,halfLife:6.3},{id:"Pm133",massNumber:133,exactMass:132.92978,atomicNumber:61},{id:"Pm134",massNumber:134,exactMass:133.92835,atomicNumber:61,halfLife:5},{id:"Pm135",massNumber:135,exactMass:134.92488,atomicNumber:61,halfLife:45},{id:"Pm136",massNumber:136,exactMass:135.92357,atomicNumber:61,halfLife:47},{id:"Pm137",massNumber:137,exactMass:136.920479,atomicNumber:61,halfLife:144},{id:"Pm138",massNumber:138,exactMass:137.919548,atomicNumber:61,halfLife:10},{id:"Pm139",massNumber:139,exactMass:138.916804,atomicNumber:61,halfLife:249},{id:"Pm140",massNumber:140,exactMass:139.91604,atomicNumber:61,halfLife:9.2},{id:"Pm141",massNumber:141,exactMass:140.913555,atomicNumber:61,halfLife:1254},{id:"Pm142",massNumber:142,exactMass:141.912874,atomicNumber:61,halfLife:40.5},{id:"Pm143",massNumber:143,exactMass:142.910933,atomicNumber:61,halfLife:22896e3},{id:"Pm144",massNumber:144,exactMass:143.912591,atomicNumber:61,halfLife:31363200},{id:"Pm145",massNumber:145,exactMass:144.912749,atomicNumber:61,halfLife:558187e3},{id:"Pm146",massNumber:146,exactMass:145.914696,atomicNumber:61,halfLife:174394e3},{id:"Pm147",massNumber:147,exactMass:146.9151385,atomicNumber:61,magneticMoment:"+2.7",halfLife:82731500,betaminusDecay:"0.224",betaminusDecayLikeliness:"100.0"},{id:"Pm148",massNumber:148,exactMass:147.917475,atomicNumber:61,halfLife:463968,betaminusDecay:"2.46",betaminusDecayLikeliness:"100.0"},{id:"Pm149",massNumber:149,exactMass:148.918334,atomicNumber:61,magneticMoment:"3.3",halfLife:191088,betaminusDecay:"1.073",betaminusDecayLikeliness:"100.0"},{id:"Pm150",massNumber:150,exactMass:149.920984,atomicNumber:61,halfLife:9648,betaminusDecay:"3.43",betaminusDecayLikeliness:"100.0"},{id:"Pm151",massNumber:151,exactMass:150.921207,atomicNumber:61,halfLife:102240},{id:"Pm152",massNumber:152,exactMass:151.923497,atomicNumber:61,halfLife:247.2},{id:"Pm153",massNumber:153,exactMass:152.924117,atomicNumber:61,halfLife:315},{id:"Pm154",massNumber:154,exactMass:153.92646,atomicNumber:61,halfLife:103.8},{id:"Pm155",massNumber:155,exactMass:154.9281,atomicNumber:61,halfLife:41.5},{id:"Pm156",massNumber:156,exactMass:155.93106,atomicNumber:61,halfLife:26.7},{id:"Pm157",massNumber:157,exactMass:156.93304,atomicNumber:61,halfLife:10.56},{id:"Pm158",massNumber:158,exactMass:157.93656,atomicNumber:61,halfLife:4.8},{id:"Pm159",massNumber:159,exactMass:158.93897,atomicNumber:61},{id:"Pm160",massNumber:160,exactMass:159.94299,atomicNumber:61},{id:"Pm161",massNumber:161,exactMass:160.94586,atomicNumber:61},{id:"Pm162",massNumber:162,exactMass:161.95029,atomicNumber:61},{id:"Pm163",massNumber:163,exactMass:162.95368,atomicNumber:61}]},{elementSymbol:"Sm",atomicNumber:62,isotopes:[{id:"Sm128",massNumber:128,exactMass:127.95808,atomicNumber:62},{id:"Sm129",massNumber:129,exactMass:128.95464,atomicNumber:62},{id:"Sm130",massNumber:130,exactMass:129.94892,atomicNumber:62},{id:"Sm131",massNumber:131,exactMass:130.94611,atomicNumber:62,halfLife:1.2},{id:"Sm132",massNumber:132,exactMass:131.94069,atomicNumber:62,halfLife:4},{id:"Sm133",massNumber:133,exactMass:132.93867,atomicNumber:62,halfLife:3.7},{id:"Sm134",massNumber:134,exactMass:133.93397,atomicNumber:62,halfLife:10},{id:"Sm135",massNumber:135,exactMass:134.93252,atomicNumber:62,halfLife:10.3},{id:"Sm136",massNumber:136,exactMass:135.928276,atomicNumber:62,halfLife:47},{id:"Sm137",massNumber:137,exactMass:136.92697,atomicNumber:62,halfLife:45},{id:"Sm138",massNumber:138,exactMass:137.923244,atomicNumber:62,halfLife:186},{id:"Sm139",massNumber:139,exactMass:138.922297,atomicNumber:62,halfLife:154.2},{id:"Sm140",massNumber:140,exactMass:139.918995,atomicNumber:62,halfLife:889.2},{id:"Sm141",massNumber:141,exactMass:140.918476,atomicNumber:62,halfLife:612},{id:"Sm142",massNumber:142,exactMass:141.915198,atomicNumber:62,halfLife:4349.4},{id:"Sm143",massNumber:143,exactMass:142.914628,atomicNumber:62,halfLife:529.8},{id:"Sm144",massNumber:144,relativeAbundance:.030699999999999998,atomicNumber:62,exactMass:143.911999,spin:"0+",halfLife:-1},{id:"Sm145",massNumber:145,exactMass:144.91341,atomicNumber:62,spin:"7/2-",halfLife:29376e3,ecDecay:"0.65",ecDecayLikeliness:"100.0"},{id:"Sm146",massNumber:146,exactMass:145.913041,atomicNumber:62,spin:"0+",halfLife:1031e5,alphaDecay:"2.55",alphaDecayLikeliness:"100.0"},{id:"Sm147",massNumber:147,relativeAbundance:.1499,atomicNumber:62,exactMass:146.9148979,spin:"7/2-",magneticMoment:"-0.813",halfLife:106e9,alphaDecay:"2.31",alphaDecayLikeliness:"100.0"},{id:"Sm148",massNumber:148,relativeAbundance:.1124,atomicNumber:62,exactMass:147.9148227,spin:"0+",halfLife:12e12,alphaDecay:"2.00",alphaDecayLikeliness:"100.0"},{id:"Sm149",massNumber:149,relativeAbundance:.1382,atomicNumber:62,exactMass:148.9171847,spin:"7/2-",magneticMoment:"-0.670",halfLife:4e14,alphaDecay:"1.9",alphaDecayLikeliness:"100.0"},{id:"Sm150",massNumber:150,relativeAbundance:.0738,atomicNumber:62,exactMass:149.9172755,spin:"0+",halfLife:-1},{id:"Sm151",massNumber:151,exactMass:150.9199324,atomicNumber:62,spin:"7/2-",halfLife:283824e4,betaminusDecay:"0.076",betaminusDecayLikeliness:"100.0"},{id:"Sm152",massNumber:152,relativeAbundance:.2675,atomicNumber:62,exactMass:151.9197324,spin:"0+",halfLife:-1},{id:"Sm153",massNumber:153,exactMass:152.9220974,atomicNumber:62,spin:"3/2+",halfLife:166622},{id:"Sm154",massNumber:154,relativeAbundance:.2275,atomicNumber:62,exactMass:153.9222093,spin:"0+",halfLife:-1},{id:"Sm155",massNumber:155,exactMass:154.9246402,atomicNumber:62,halfLife:1338},{id:"Sm156",massNumber:156,exactMass:155.925528,atomicNumber:62,halfLife:33840},{id:"Sm157",massNumber:157,exactMass:156.92836,atomicNumber:62,halfLife:482},{id:"Sm158",massNumber:158,exactMass:157.92999,atomicNumber:62,halfLife:318},{id:"Sm159",massNumber:159,exactMass:158.93321,atomicNumber:62,halfLife:11.37},{id:"Sm160",massNumber:160,exactMass:159.93514,atomicNumber:62,halfLife:9.6},{id:"Sm161",massNumber:161,exactMass:160.93883,atomicNumber:62},{id:"Sm162",massNumber:162,exactMass:161.94122,atomicNumber:62},{id:"Sm163",massNumber:163,exactMass:162.94536,atomicNumber:62},{id:"Sm164",massNumber:164,exactMass:163.94828,atomicNumber:62},{id:"Sm165",massNumber:165,exactMass:164.95298,atomicNumber:62}]},{elementSymbol:"Eu",atomicNumber:63,isotopes:[{id:"Eu130",massNumber:130,exactMass:129.96357,atomicNumber:63},{id:"Eu131",massNumber:131,exactMass:130.95775,atomicNumber:63},{id:"Eu132",massNumber:132,exactMass:131.95437,atomicNumber:63},{id:"Eu133",massNumber:133,exactMass:132.94924,atomicNumber:63},{id:"Eu134",massNumber:134,exactMass:133.94651,atomicNumber:63,halfLife:.5},{id:"Eu135",massNumber:135,exactMass:134.94182,atomicNumber:63,halfLife:1.5},{id:"Eu136",massNumber:136,exactMass:135.9396,atomicNumber:63,halfLife:3.3},{id:"Eu137",massNumber:137,exactMass:136.93557,atomicNumber:63,halfLife:11},{id:"Eu138",massNumber:138,exactMass:137.93371,atomicNumber:63,halfLife:12.1},{id:"Eu139",massNumber:139,exactMass:138.929792,atomicNumber:63,halfLife:17.9},{id:"Eu140",massNumber:140,exactMass:139.92809,atomicNumber:63,halfLife:1.51},{id:"Eu141",massNumber:141,exactMass:140.924931,atomicNumber:63,halfLife:40.7},{id:"Eu142",massNumber:142,exactMass:141.92343,atomicNumber:63,halfLife:2.34},{id:"Eu143",massNumber:143,exactMass:142.920298,atomicNumber:63,halfLife:157.8},{id:"Eu144",massNumber:144,exactMass:143.918817,atomicNumber:63,halfLife:10.2},{id:"Eu145",massNumber:145,exactMass:144.916265,atomicNumber:63,halfLife:512352},{id:"Eu146",massNumber:146,exactMass:145.917206,atomicNumber:63,halfLife:398304},{id:"Eu147",massNumber:147,exactMass:146.916746,atomicNumber:63,halfLife:2082240},{id:"Eu148",massNumber:148,exactMass:147.918086,atomicNumber:63,halfLife:4708800},{id:"Eu149",massNumber:149,exactMass:148.917931,atomicNumber:63,halfLife:8043840},{id:"Eu150",massNumber:150,exactMass:149.919702,atomicNumber:63,halfLife:116368e4},{id:"Eu151",massNumber:151,relativeAbundance:.4781,atomicNumber:63,exactMass:150.9198502,spin:"5/2+",magneticMoment:"+3.464",halfLife:-1},{id:"Eu152",massNumber:152,exactMass:151.9217445,atomicNumber:63,spin:"3-",halfLife:426903e3},{id:"Eu153",massNumber:153,relativeAbundance:.5219,atomicNumber:63,exactMass:152.9212303,spin:"5/2+",magneticMoment:"+1.530",halfLife:-1},{id:"Eu154",massNumber:154,exactMass:153.9229792,atomicNumber:63,halfLife:270989e3},{id:"Eu155",massNumber:155,exactMass:154.9228933,atomicNumber:63,halfLife:150146e3},{id:"Eu156",massNumber:156,exactMass:155.924752,atomicNumber:63,halfLife:1312420},{id:"Eu157",massNumber:157,exactMass:156.925424,atomicNumber:63,halfLife:54648},{id:"Eu158",massNumber:158,exactMass:157.92785,atomicNumber:63,halfLife:2754},{id:"Eu159",massNumber:159,exactMass:158.929089,atomicNumber:63,halfLife:1086},{id:"Eu160",massNumber:160,exactMass:159.93197,atomicNumber:63,halfLife:38},{id:"Eu161",massNumber:161,exactMass:160.93368,atomicNumber:63,halfLife:26},{id:"Eu162",massNumber:162,exactMass:161.93704,atomicNumber:63,halfLife:10.6},{id:"Eu163",massNumber:163,exactMass:162.93921,atomicNumber:63},{id:"Eu164",massNumber:164,exactMass:163.94299,atomicNumber:63},{id:"Eu165",massNumber:165,exactMass:164.94572,atomicNumber:63},{id:"Eu166",massNumber:166,exactMass:165.94997,atomicNumber:63},{id:"Eu167",massNumber:167,exactMass:166.95321,atomicNumber:63}]},{elementSymbol:"Gd",atomicNumber:64,isotopes:[{id:"Gd134",massNumber:134,exactMass:133.95537,atomicNumber:64},{id:"Gd135",massNumber:135,exactMass:134.95257,atomicNumber:64},{id:"Gd136",massNumber:136,exactMass:135.94734,atomicNumber:64},{id:"Gd137",massNumber:137,exactMass:136.94502,atomicNumber:64},{id:"Gd138",massNumber:138,exactMass:137.94012,atomicNumber:64},{id:"Gd139",massNumber:139,exactMass:138.93824,atomicNumber:64,halfLife:4.9},{id:"Gd140",massNumber:140,exactMass:139.93367,atomicNumber:64,halfLife:15.8},{id:"Gd141",massNumber:141,exactMass:140.932126,atomicNumber:64,halfLife:14},{id:"Gd142",massNumber:142,exactMass:141.92812,atomicNumber:64,halfLife:70.2},{id:"Gd143",massNumber:143,exactMass:142.92675,atomicNumber:64,halfLife:39},{id:"Gd144",massNumber:144,exactMass:143.92296,atomicNumber:64,halfLife:270},{id:"Gd145",massNumber:145,exactMass:144.921709,atomicNumber:64,halfLife:1380},{id:"Gd146",massNumber:146,exactMass:145.918311,atomicNumber:64,halfLife:4170530},{id:"Gd147",massNumber:147,exactMass:146.919094,atomicNumber:64,halfLife:137016},{id:"Gd148",massNumber:148,exactMass:147.918115,atomicNumber:64,halfLife:235259e4},{id:"Gd149",massNumber:149,exactMass:148.919341,atomicNumber:64,halfLife:801792},{id:"Gd150",massNumber:150,exactMass:149.918659,atomicNumber:64},{id:"Gd151",massNumber:151,exactMass:150.920348,atomicNumber:64,halfLife:10713600},{id:"Gd152",massNumber:152,relativeAbundance:.002,atomicNumber:64,exactMass:151.919791,spin:"0+",halfLife:108e12,alphaDecay:"2.24",alphaDecayLikeliness:"100.0"},{id:"Gd153",massNumber:153,exactMass:152.9217495,atomicNumber:64,spin:"3/2+",halfLife:20770600},{id:"Gd154",massNumber:154,relativeAbundance:.0218,atomicNumber:64,exactMass:153.9208656,spin:"0+",halfLife:-1},{id:"Gd155",massNumber:155,relativeAbundance:.14800000000000002,atomicNumber:64,exactMass:154.922622,spin:"3/2-",magneticMoment:"-0.27",halfLife:-1},{id:"Gd156",massNumber:156,relativeAbundance:.2047,atomicNumber:64,exactMass:155.9221227,spin:"0+",halfLife:-1},{id:"Gd157",massNumber:157,relativeAbundance:.1565,atomicNumber:64,exactMass:156.9239601,spin:"3/2-",magneticMoment:"-0.36",halfLife:-1},{id:"Gd158",massNumber:158,relativeAbundance:.2484,atomicNumber:64,exactMass:157.9241039,spin:"0+",halfLife:-1},{id:"Gd159",massNumber:159,exactMass:158.9263887,atomicNumber:64,spin:"3/2-",halfLife:66524.4,betaminusDecay:"0.95",betaminusDecayLikeliness:"100.0"},{id:"Gd160",massNumber:160,relativeAbundance:.2186,atomicNumber:64,exactMass:159.9270541,spin:"0+"},{id:"Gd161",massNumber:161,exactMass:160.9296692,atomicNumber:64,halfLife:219.6},{id:"Gd162",massNumber:162,exactMass:161.930985,atomicNumber:64,halfLife:504},{id:"Gd163",massNumber:163,exactMass:162.93399,atomicNumber:64,halfLife:68},{id:"Gd164",massNumber:164,exactMass:163.93586,atomicNumber:64,halfLife:45},{id:"Gd165",massNumber:165,exactMass:164.93938,atomicNumber:64},{id:"Gd166",massNumber:166,exactMass:165.9416,atomicNumber:64},{id:"Gd167",massNumber:167,exactMass:166.94557,atomicNumber:64},{id:"Gd168",massNumber:168,exactMass:167.94836,atomicNumber:64},{id:"Gd169",massNumber:169,exactMass:168.95287,atomicNumber:64}]},{elementSymbol:"Tb",atomicNumber:65,isotopes:[{id:"Tb136",massNumber:136,exactMass:135.96138,atomicNumber:65},{id:"Tb137",massNumber:137,exactMass:136.95598,atomicNumber:65},{id:"Tb138",massNumber:138,exactMass:137.95316,atomicNumber:65},{id:"Tb139",massNumber:139,exactMass:138.94829,atomicNumber:65},{id:"Tb140",massNumber:140,exactMass:139.94581,atomicNumber:65,halfLife:2.4},{id:"Tb141",massNumber:141,exactMass:140.94145,atomicNumber:65,halfLife:3.5},{id:"Tb142",massNumber:142,exactMass:141.93874,atomicNumber:65,halfLife:.597},{id:"Tb143",massNumber:143,exactMass:142.93512,atomicNumber:65,halfLife:12},{id:"Tb144",massNumber:144,exactMass:143.93305,atomicNumber:65,halfLife:-1},{id:"Tb145",massNumber:145,exactMass:144.92927,atomicNumber:65},{id:"Tb146",massNumber:146,exactMass:145.92725,atomicNumber:65,halfLife:8},{id:"Tb147",massNumber:147,exactMass:146.924045,atomicNumber:65,halfLife:6120},{id:"Tb148",massNumber:148,exactMass:147.924272,atomicNumber:65,halfLife:3600},{id:"Tb149",massNumber:149,exactMass:148.923246,atomicNumber:65,halfLife:14824.8},{id:"Tb150",massNumber:150,exactMass:149.92366,atomicNumber:65,halfLife:12528},{id:"Tb151",massNumber:151,exactMass:150.923103,atomicNumber:65,halfLife:63392.4},{id:"Tb152",massNumber:152,exactMass:151.92407,atomicNumber:65,halfLife:63e3},{id:"Tb153",massNumber:153,exactMass:152.923435,atomicNumber:65,halfLife:202176},{id:"Tb154",massNumber:154,exactMass:153.92468,atomicNumber:65,halfLife:77400},{id:"Tb155",massNumber:155,exactMass:154.923505,atomicNumber:65,halfLife:459648},{id:"Tb156",massNumber:156,exactMass:155.924747,atomicNumber:65,halfLife:462240},{id:"Tb157",massNumber:157,exactMass:156.9240246,atomicNumber:65,halfLife:223906e4},{id:"Tb158",massNumber:158,exactMass:157.9254131,atomicNumber:65,halfLife:567648e4},{id:"Tb159",massNumber:159,relativeAbundance:1,atomicNumber:65,exactMass:158.9253468,spin:"3/2+",magneticMoment:"+1.95",halfLife:-1},{id:"Tb160",massNumber:160,exactMass:159.9271676,atomicNumber:65,spin:"3-",magneticMoment:"+1.702",halfLife:6246720,betaminusDecay:"1.72",betaminusDecayLikeliness:"100.0"},{id:"Tb161",massNumber:161,exactMass:160.9275699,atomicNumber:65,spin:"3/2+",halfLife:594432},{id:"Tb162",massNumber:162,exactMass:161.92949,atomicNumber:65,halfLife:456},{id:"Tb163",massNumber:163,exactMass:162.930648,atomicNumber:65,halfLife:1170},{id:"Tb164",massNumber:164,exactMass:163.93335,atomicNumber:65,halfLife:180},{id:"Tb165",massNumber:165,exactMass:164.93488,atomicNumber:65,halfLife:126.6},{id:"Tb166",massNumber:166,exactMass:165.93799,atomicNumber:65},{id:"Tb167",massNumber:167,exactMass:166.94005,atomicNumber:65},{id:"Tb168",massNumber:168,exactMass:167.94364,atomicNumber:65},{id:"Tb169",massNumber:169,exactMass:168.94622,atomicNumber:65},{id:"Tb170",massNumber:170,exactMass:169.95025,atomicNumber:65},{id:"Tb171",massNumber:171,exactMass:170.9533,atomicNumber:65}]},{elementSymbol:"Dy",atomicNumber:66,isotopes:[{id:"Dy138",massNumber:138,exactMass:137.96249,atomicNumber:66},{id:"Dy139",massNumber:139,exactMass:138.95954,atomicNumber:66},{id:"Dy140",massNumber:140,exactMass:139.95401,atomicNumber:66},{id:"Dy141",massNumber:141,exactMass:140.95135,atomicNumber:66,halfLife:.9},{id:"Dy142",massNumber:142,exactMass:141.94637,atomicNumber:66,halfLife:2.3},{id:"Dy143",massNumber:143,exactMass:142.94383,atomicNumber:66,halfLife:4.1},{id:"Dy144",massNumber:144,exactMass:143.93925,atomicNumber:66,halfLife:9.1},{id:"Dy145",massNumber:145,exactMass:144.93743,atomicNumber:66,halfLife:10},{id:"Dy146",massNumber:146,exactMass:145.932845,atomicNumber:66,halfLife:29},{id:"Dy147",massNumber:147,exactMass:146.931092,atomicNumber:66,halfLife:40},{id:"Dy148",massNumber:148,exactMass:147.92715,atomicNumber:66,halfLife:186},{id:"Dy149",massNumber:149,exactMass:148.927305,atomicNumber:66,halfLife:252},{id:"Dy150",massNumber:150,exactMass:149.925585,atomicNumber:66,halfLife:430.2},{id:"Dy151",massNumber:151,exactMass:150.926185,atomicNumber:66,halfLife:1074},{id:"Dy152",massNumber:152,exactMass:151.924718,atomicNumber:66,halfLife:8568},{id:"Dy153",massNumber:153,exactMass:152.925765,atomicNumber:66,halfLife:23040},{id:"Dy154",massNumber:154,exactMass:153.924424,atomicNumber:66},{id:"Dy155",massNumber:155,exactMass:154.925754,atomicNumber:66,halfLife:35640},{id:"Dy156",massNumber:156,relativeAbundance:6e-4,atomicNumber:66,exactMass:155.924283,spin:"0+",halfLife:-1},{id:"Dy157",massNumber:157,exactMass:156.925466,atomicNumber:66,spin:"3/2-",halfLife:29304},{id:"Dy158",massNumber:158,relativeAbundance:.001,atomicNumber:66,exactMass:157.924409,spin:"0+",halfLife:-1},{id:"Dy159",massNumber:159,exactMass:158.9257392,atomicNumber:66,spin:"3/2-",halfLife:12476200},{id:"Dy160",massNumber:160,relativeAbundance:.023399999999999997,atomicNumber:66,exactMass:159.9251975,spin:"0+",halfLife:-1},{id:"Dy161",massNumber:161,relativeAbundance:.1891,atomicNumber:66,exactMass:160.9269334,spin:"5/2+",magneticMoment:"-0.4805",halfLife:-1},{id:"Dy162",massNumber:162,relativeAbundance:.2551,atomicNumber:66,exactMass:161.9267984,spin:"0+",halfLife:-1},{id:"Dy163",massNumber:163,relativeAbundance:.249,atomicNumber:66,exactMass:162.9287312,spin:"5/2-",magneticMoment:"+0.6726",halfLife:-1},{id:"Dy164",massNumber:164,relativeAbundance:.2818,atomicNumber:66,exactMass:163.9291748,spin:"0+",halfLife:-1,betaminusDecay:"1.3",betaminusDecayLikeliness:"100.0"},{id:"Dy165",massNumber:165,exactMass:164.9317033,atomicNumber:66,halfLife:8402.4},{id:"Dy166",massNumber:166,exactMass:165.9328067,atomicNumber:66,halfLife:293760},{id:"Dy167",massNumber:167,exactMass:166.93566,atomicNumber:66,halfLife:372},{id:"Dy168",massNumber:168,exactMass:167.93713,atomicNumber:66,halfLife:522},{id:"Dy169",massNumber:169,exactMass:168.94031,atomicNumber:66,halfLife:39},{id:"Dy170",massNumber:170,exactMass:169.94239,atomicNumber:66},{id:"Dy171",massNumber:171,exactMass:170.9462,atomicNumber:66},{id:"Dy172",massNumber:172,exactMass:171.94876,atomicNumber:66},{id:"Dy173",massNumber:173,exactMass:172.953,atomicNumber:66}]},{elementSymbol:"Ho",atomicNumber:67,isotopes:[{id:"Ho140",massNumber:140,exactMass:139.96854,atomicNumber:67},{id:"Ho141",massNumber:141,exactMass:140.9631,atomicNumber:67},{id:"Ho142",massNumber:142,exactMass:141.95977,atomicNumber:67},{id:"Ho143",massNumber:143,exactMass:142.95461,atomicNumber:67},{id:"Ho144",massNumber:144,exactMass:143.95148,atomicNumber:67,halfLife:.7},{id:"Ho145",massNumber:145,exactMass:144.9472,atomicNumber:67,halfLife:2.4},{id:"Ho146",massNumber:146,exactMass:145.94464,atomicNumber:67,halfLife:3.6},{id:"Ho147",massNumber:147,exactMass:146.94006,atomicNumber:67,halfLife:5.8},{id:"Ho148",massNumber:148,exactMass:147.93772,atomicNumber:67,halfLife:2.2},{id:"Ho149",massNumber:149,exactMass:148.933775,atomicNumber:67,halfLife:21.1},{id:"Ho150",massNumber:150,exactMass:149.933496,atomicNumber:67,halfLife:72},{id:"Ho151",massNumber:151,exactMass:150.931688,atomicNumber:67,halfLife:35.2},{id:"Ho152",massNumber:152,exactMass:151.931714,atomicNumber:67,halfLife:161.8},{id:"Ho153",massNumber:153,exactMass:152.930199,atomicNumber:67,halfLife:120.6},{id:"Ho154",massNumber:154,exactMass:153.930602,atomicNumber:67,halfLife:705.6},{id:"Ho155",massNumber:155,exactMass:154.929103,atomicNumber:67,halfLife:2880},{id:"Ho156",massNumber:156,exactMass:155.92984,atomicNumber:67,halfLife:3360},{id:"Ho157",massNumber:157,exactMass:156.928256,atomicNumber:67,halfLife:756},{id:"Ho158",massNumber:158,exactMass:157.928941,atomicNumber:67,halfLife:678},{id:"Ho159",massNumber:159,exactMass:158.927712,atomicNumber:67,halfLife:1983},{id:"Ho160",massNumber:160,exactMass:159.928729,atomicNumber:67,halfLife:1536},{id:"Ho161",massNumber:161,exactMass:160.927855,atomicNumber:67,halfLife:8928},{id:"Ho162",massNumber:162,exactMass:161.929096,atomicNumber:67,halfLife:900},{id:"Ho163",massNumber:163,exactMass:162.9287339,atomicNumber:67,halfLife:14412e7},{id:"Ho164",massNumber:164,exactMass:163.9302335,atomicNumber:67,halfLife:1740},{id:"Ho165",massNumber:165,relativeAbundance:1,atomicNumber:67,exactMass:164.9303221,spin:"7/2-",magneticMoment:"+4.173",halfLife:-1},{id:"Ho166",massNumber:166,exactMass:165.9322842,atomicNumber:67,spin:"0-",halfLife:96588,betaminusDecay:"1.85",betaminusDecayLikeliness:"100.0"},{id:"Ho167",massNumber:167,exactMass:166.933133,atomicNumber:67,halfLife:11160},{id:"Ho168",massNumber:168,exactMass:167.93552,atomicNumber:67,halfLife:179.4},{id:"Ho169",massNumber:169,exactMass:168.936872,atomicNumber:67,halfLife:282},{id:"Ho170",massNumber:170,exactMass:169.93962,atomicNumber:67,halfLife:165.6},{id:"Ho171",massNumber:171,exactMass:170.94147,atomicNumber:67,halfLife:53},{id:"Ho172",massNumber:172,exactMass:171.94482,atomicNumber:67,halfLife:25},{id:"Ho173",massNumber:173,exactMass:172.94729,atomicNumber:67},{id:"Ho174",massNumber:174,exactMass:173.95115,atomicNumber:67},{id:"Ho175",massNumber:175,exactMass:174.95405,atomicNumber:67}]},{elementSymbol:"Er",atomicNumber:68,isotopes:[{id:"Er143",massNumber:143,exactMass:142.96634,atomicNumber:68},{id:"Er144",massNumber:144,exactMass:143.96038,atomicNumber:68},{id:"Er145",massNumber:145,exactMass:144.95739,atomicNumber:68,halfLife:.9},{id:"Er146",massNumber:146,exactMass:145.952,atomicNumber:68,halfLife:1.7},{id:"Er147",massNumber:147,exactMass:146.94949,atomicNumber:68,halfLife:2.5},{id:"Er148",massNumber:148,exactMass:147.94455,atomicNumber:68,halfLife:4.6},{id:"Er149",massNumber:149,exactMass:148.94231,atomicNumber:68,halfLife:4},{id:"Er150",massNumber:150,exactMass:149.937914,atomicNumber:68,halfLife:18.5},{id:"Er151",massNumber:151,exactMass:150.937449,atomicNumber:68,halfLife:23.5},{id:"Er152",massNumber:152,exactMass:151.93505,atomicNumber:68,halfLife:10.3},{id:"Er153",massNumber:153,exactMass:152.935063,atomicNumber:68,halfLife:37.1},{id:"Er154",massNumber:154,exactMass:153.932783,atomicNumber:68,halfLife:223.8},{id:"Er155",massNumber:155,exactMass:154.933209,atomicNumber:68,halfLife:318},{id:"Er156",massNumber:156,exactMass:155.931065,atomicNumber:68,halfLife:1170},{id:"Er157",massNumber:157,exactMass:156.93192,atomicNumber:68,halfLife:1119},{id:"Er158",massNumber:158,exactMass:157.929893,atomicNumber:68,halfLife:8244},{id:"Er159",massNumber:159,exactMass:158.930684,atomicNumber:68,halfLife:2160},{id:"Er160",massNumber:160,exactMass:159.929083,atomicNumber:68,halfLife:102888},{id:"Er161",massNumber:161,exactMass:160.929995,atomicNumber:68,halfLife:11556},{id:"Er162",massNumber:162,relativeAbundance:.0014000000000000002,atomicNumber:68,exactMass:161.928778,spin:"0+",halfLife:-1},{id:"Er163",massNumber:163,exactMass:162.930033,atomicNumber:68,spin:"5/2-",halfLife:4500},{id:"Er164",massNumber:164,relativeAbundance:.0161,atomicNumber:68,exactMass:163.9292,spin:"0+",halfLife:-1},{id:"Er165",massNumber:165,exactMass:164.930726,atomicNumber:68,spin:"5/2-",halfLife:37296},{id:"Er166",massNumber:166,relativeAbundance:.3361,atomicNumber:68,exactMass:165.9302931,spin:"0+",halfLife:-1},{id:"Er167",massNumber:167,relativeAbundance:.2293,atomicNumber:68,exactMass:166.9320482,spin:"7/2+",magneticMoment:"-0.5665",halfLife:-1},{id:"Er168",massNumber:168,relativeAbundance:.26780000000000004,atomicNumber:68,exactMass:167.9323702,spin:"0+",halfLife:-1},{id:"Er169",massNumber:169,exactMass:168.9345904,atomicNumber:68,spin:"1/2-",halfLife:812160},{id:"Er170",massNumber:170,relativeAbundance:.1493,atomicNumber:68,exactMass:169.9354643,spin:"0+",halfLife:-1},{id:"Er171",massNumber:171,exactMass:170.9380298,atomicNumber:68,halfLife:27057.6},{id:"Er172",massNumber:172,exactMass:171.939356,atomicNumber:68,halfLife:177480},{id:"Er173",massNumber:173,exactMass:172.9424,atomicNumber:68,halfLife:84},{id:"Er174",massNumber:174,exactMass:173.94423,atomicNumber:68,halfLife:198},{id:"Er175",massNumber:175,exactMass:174.94777,atomicNumber:68,halfLife:72},{id:"Er176",massNumber:176,exactMass:175.95008,atomicNumber:68},{id:"Er177",massNumber:177,exactMass:176.95405,atomicNumber:68}]},{elementSymbol:"Tm",atomicNumber:69,isotopes:[{id:"Tm145",massNumber:145,exactMass:144.97007,atomicNumber:69},{id:"Tm146",massNumber:146,exactMass:145.96643,atomicNumber:69,halfLife:.235},{id:"Tm147",massNumber:147,exactMass:146.96096,atomicNumber:69,halfLife:.56},{id:"Tm148",massNumber:148,exactMass:147.95784,atomicNumber:69,halfLife:.7},{id:"Tm149",massNumber:149,exactMass:148.95272,atomicNumber:69,halfLife:.9},{id:"Tm150",massNumber:150,exactMass:149.94996,atomicNumber:69,halfLife:2.2},{id:"Tm151",massNumber:151,exactMass:150.945483,atomicNumber:69,halfLife:4.17},{id:"Tm152",massNumber:152,exactMass:151.94442,atomicNumber:69,halfLife:8},{id:"Tm153",massNumber:153,exactMass:152.942012,atomicNumber:69,halfLife:1.48},{id:"Tm154",massNumber:154,exactMass:153.941568,atomicNumber:69,halfLife:8.1},{id:"Tm155",massNumber:155,exactMass:154.939199,atomicNumber:69,halfLife:21.6},{id:"Tm156",massNumber:156,exactMass:155.93898,atomicNumber:69,halfLife:83.8},{id:"Tm157",massNumber:157,exactMass:156.93697,atomicNumber:69,halfLife:217.8},{id:"Tm158",massNumber:158,exactMass:157.93698,atomicNumber:69,halfLife:238.8},{id:"Tm159",massNumber:159,exactMass:158.93498,atomicNumber:69,halfLife:547.8},{id:"Tm160",massNumber:160,exactMass:159.93526,atomicNumber:69,halfLife:564},{id:"Tm161",massNumber:161,exactMass:160.93355,atomicNumber:69,halfLife:1980},{id:"Tm162",massNumber:162,exactMass:161.933995,atomicNumber:69,halfLife:1302},{id:"Tm163",massNumber:163,exactMass:162.932651,atomicNumber:69,halfLife:6516},{id:"Tm164",massNumber:164,exactMass:163.93356,atomicNumber:69},{id:"Tm165",massNumber:165,exactMass:164.932435,atomicNumber:69,halfLife:108216},{id:"Tm166",massNumber:166,exactMass:165.933554,atomicNumber:69,halfLife:27720},{id:"Tm167",massNumber:167,exactMass:166.9328516,atomicNumber:69,halfLife:799200},{id:"Tm168",massNumber:168,exactMass:167.934173,atomicNumber:69,halfLife:8043840},{id:"Tm169",massNumber:169,relativeAbundance:1,atomicNumber:69,exactMass:168.9342133,spin:"1/2+",magneticMoment:"-0.2316",halfLife:-1},{id:"Tm170",massNumber:170,exactMass:169.9358014,atomicNumber:69,spin:"1-",halfLife:11111e3},{id:"Tm171",massNumber:171,exactMass:170.9364294,atomicNumber:69,spin:"1/2+",halfLife:60549100},{id:"Tm172",massNumber:172,exactMass:171.9384,atomicNumber:69,halfLife:228960},{id:"Tm173",massNumber:173,exactMass:172.939604,atomicNumber:69,halfLife:29664},{id:"Tm174",massNumber:174,exactMass:173.94217,atomicNumber:69,halfLife:324},{id:"Tm175",massNumber:175,exactMass:174.94384,atomicNumber:69,halfLife:912},{id:"Tm176",massNumber:176,exactMass:175.94699,atomicNumber:69,halfLife:114},{id:"Tm177",massNumber:177,exactMass:176.94904,atomicNumber:69,halfLife:85},{id:"Tm178",massNumber:178,exactMass:177.95264,atomicNumber:69},{id:"Tm179",massNumber:179,exactMass:178.95534,atomicNumber:69}]},{elementSymbol:"Yb",atomicNumber:70,isotopes:[{id:"Yb148",massNumber:148,exactMass:147.96742,atomicNumber:70},{id:"Yb149",massNumber:149,exactMass:148.96404,atomicNumber:70},{id:"Yb150",massNumber:150,exactMass:149.95842,atomicNumber:70},{id:"Yb151",massNumber:151,exactMass:150.9554,atomicNumber:70,halfLife:1.6},{id:"Yb152",massNumber:152,exactMass:151.95029,atomicNumber:70,halfLife:3.04},{id:"Yb153",massNumber:153,exactMass:152.94948,atomicNumber:70,halfLife:4.2},{id:"Yb154",massNumber:154,exactMass:153.946394,atomicNumber:70,halfLife:.409},{id:"Yb155",massNumber:155,exactMass:154.945782,atomicNumber:70,halfLife:1.8},{id:"Yb156",massNumber:156,exactMass:155.942818,atomicNumber:70,halfLife:26.1},{id:"Yb157",massNumber:157,exactMass:156.942628,atomicNumber:70,halfLife:38.6},{id:"Yb158",massNumber:158,exactMass:157.939866,atomicNumber:70,halfLife:89.4},{id:"Yb159",massNumber:159,exactMass:158.94005,atomicNumber:70,halfLife:94.8},{id:"Yb160",massNumber:160,exactMass:159.937552,atomicNumber:70,halfLife:288},{id:"Yb161",massNumber:161,exactMass:160.937902,atomicNumber:70,halfLife:252},{id:"Yb162",massNumber:162,exactMass:161.935768,atomicNumber:70,halfLife:1132.2},{id:"Yb163",massNumber:163,exactMass:162.936334,atomicNumber:70,halfLife:663},{id:"Yb164",massNumber:164,exactMass:163.934489,atomicNumber:70,halfLife:4548},{id:"Yb165",massNumber:165,exactMass:164.93528,atomicNumber:70,halfLife:594},{id:"Yb166",massNumber:166,exactMass:165.933882,atomicNumber:70,halfLife:204120},{id:"Yb167",massNumber:167,exactMass:166.93495,atomicNumber:70,halfLife:1050},{id:"Yb168",massNumber:168,relativeAbundance:.0013,atomicNumber:70,exactMass:167.933897,spin:"0+",halfLife:-1},{id:"Yb169",massNumber:169,exactMass:168.93519,atomicNumber:70,spin:"7/2+",halfLife:2767050},{id:"Yb170",massNumber:170,relativeAbundance:.0304,atomicNumber:70,exactMass:169.9347618,spin:"0+",halfLife:-1},{id:"Yb171",massNumber:171,relativeAbundance:.14279999999999998,atomicNumber:70,exactMass:170.9363258,spin:"1/2-",magneticMoment:"+0.4919",halfLife:-1},{id:"Yb172",massNumber:172,relativeAbundance:.2183,atomicNumber:70,exactMass:171.9363815,spin:"0+",halfLife:-1},{id:"Yb173",massNumber:173,relativeAbundance:.1613,atomicNumber:70,exactMass:172.9382108,spin:"5/2-",magneticMoment:"-0.6776",halfLife:-1},{id:"Yb174",massNumber:174,relativeAbundance:.31829999999999997,atomicNumber:70,exactMass:173.9388621,spin:"0+",halfLife:-1},{id:"Yb175",massNumber:175,exactMass:174.9412765,atomicNumber:70,spin:"7/2-",magneticMoment:"0.3",halfLife:361584,betaminusDecay:"0.467",betaminusDecayLikeliness:"100.0"},{id:"Yb176",massNumber:176,relativeAbundance:.1276,atomicNumber:70,exactMass:175.9425717,spin:"0+",halfLife:-1},{id:"Yb177",massNumber:177,exactMass:176.9452608,atomicNumber:70,halfLife:6879.6},{id:"Yb178",massNumber:178,exactMass:177.946647,atomicNumber:70,halfLife:4440},{id:"Yb179",massNumber:179,exactMass:178.95017,atomicNumber:70,halfLife:480},{id:"Yb180",massNumber:180,exactMass:179.95233,atomicNumber:70,halfLife:144},{id:"Yb181",massNumber:181,exactMass:180.95615,atomicNumber:70}]},{elementSymbol:"Lu",atomicNumber:71,isotopes:[{id:"Lu150",massNumber:150,exactMass:149.97323,atomicNumber:71,halfLife:.035},{id:"Lu151",massNumber:151,exactMass:150.96758,atomicNumber:71,halfLife:.088},{id:"Lu152",massNumber:152,exactMass:151.96412,atomicNumber:71,halfLife:.7},{id:"Lu153",massNumber:153,exactMass:152.95877,atomicNumber:71,halfLife:.9},{id:"Lu154",massNumber:154,exactMass:153.95752,atomicNumber:71},{id:"Lu155",massNumber:155,exactMass:154.954316,atomicNumber:71,halfLife:.14},{id:"Lu156",massNumber:156,exactMass:155.95303,atomicNumber:71,halfLife:.198},{id:"Lu157",massNumber:157,exactMass:156.950098,atomicNumber:71,halfLife:6.8},{id:"Lu158",massNumber:158,exactMass:157.949313,atomicNumber:71,halfLife:10.6},{id:"Lu159",massNumber:159,exactMass:158.94663,atomicNumber:71,halfLife:12.1},{id:"Lu160",massNumber:160,exactMass:159.94603,atomicNumber:71,halfLife:36.1},{id:"Lu161",massNumber:161,exactMass:160.94357,atomicNumber:71,halfLife:77},{id:"Lu162",massNumber:162,exactMass:161.94328,atomicNumber:71,halfLife:82.2},{id:"Lu163",massNumber:163,exactMass:162.94118,atomicNumber:71,halfLife:238},{id:"Lu164",massNumber:164,exactMass:163.94134,atomicNumber:71,halfLife:188.4},{id:"Lu165",massNumber:165,exactMass:164.939407,atomicNumber:71,halfLife:644.4},{id:"Lu166",massNumber:166,exactMass:165.93986,atomicNumber:71,halfLife:159},{id:"Lu167",massNumber:167,exactMass:166.93827,atomicNumber:71,halfLife:3090},{id:"Lu168",massNumber:168,exactMass:167.93874,atomicNumber:71,halfLife:330},{id:"Lu169",massNumber:169,exactMass:168.937651,atomicNumber:71,halfLife:122616},{id:"Lu170",massNumber:170,exactMass:169.938475,atomicNumber:71,halfLife:173837},{id:"Lu171",massNumber:171,exactMass:170.9379131,atomicNumber:71,halfLife:711936},{id:"Lu172",massNumber:172,exactMass:171.939086,atomicNumber:71,halfLife:578880},{id:"Lu173",massNumber:173,exactMass:172.9389306,atomicNumber:71,halfLife:43204300},{id:"Lu174",massNumber:174,exactMass:173.9403375,atomicNumber:71,halfLife:104384e3},{id:"Lu175",massNumber:175,relativeAbundance:.9741,atomicNumber:71,exactMass:174.9407718,spin:"7/2+",magneticMoment:"+2.2327",halfLife:-1},{id:"Lu176",massNumber:176,relativeAbundance:.0259,atomicNumber:71,exactMass:175.9426863,spin:"1-",magneticMoment:"3.19"},{id:"Lu177",massNumber:177,exactMass:176.9437581,atomicNumber:71,magneticMoment:"+2.239",halfLife:581818},{id:"Lu178",massNumber:178,exactMass:177.945955,atomicNumber:71,halfLife:1704},{id:"Lu179",massNumber:179,exactMass:178.947327,atomicNumber:71,halfLife:16524},{id:"Lu180",massNumber:180,exactMass:179.94988,atomicNumber:71,halfLife:342},{id:"Lu181",massNumber:181,exactMass:180.95197,atomicNumber:71,halfLife:210},{id:"Lu182",massNumber:182,exactMass:181.95504,atomicNumber:71},{id:"Lu183",massNumber:183,exactMass:182.95757,atomicNumber:71,halfLife:58},{id:"Lu184",massNumber:184,exactMass:183.96091,atomicNumber:71,halfLife:20}]},{elementSymbol:"Hf",atomicNumber:72,isotopes:[{id:"Hf153",massNumber:153,exactMass:152.97069,atomicNumber:72},{id:"Hf154",massNumber:154,exactMass:153.96486,atomicNumber:72},{id:"Hf155",massNumber:155,exactMass:154.96339,atomicNumber:72,halfLife:.89},{id:"Hf156",massNumber:156,exactMass:155.95936,atomicNumber:72,halfLife:.025},{id:"Hf157",massNumber:157,exactMass:156.9584,atomicNumber:72,halfLife:.11},{id:"Hf158",massNumber:158,exactMass:157.954799,atomicNumber:72,halfLife:2.85},{id:"Hf159",massNumber:159,exactMass:158.953995,atomicNumber:72,halfLife:5.6},{id:"Hf160",massNumber:160,exactMass:159.950684,atomicNumber:72,halfLife:13.6},{id:"Hf161",massNumber:161,exactMass:160.950275,atomicNumber:72,halfLife:16.8},{id:"Hf162",massNumber:162,exactMass:161.94721,atomicNumber:72,halfLife:37.6},{id:"Hf163",massNumber:163,exactMass:162.94709,atomicNumber:72,halfLife:40},{id:"Hf164",massNumber:164,exactMass:163.944367,atomicNumber:72,halfLife:111},{id:"Hf165",massNumber:165,exactMass:164.94457,atomicNumber:72,halfLife:76},{id:"Hf166",massNumber:166,exactMass:165.94218,atomicNumber:72,halfLife:406.2},{id:"Hf167",massNumber:167,exactMass:166.9426,atomicNumber:72,halfLife:123},{id:"Hf168",massNumber:168,exactMass:167.94057,atomicNumber:72,halfLife:1557},{id:"Hf169",massNumber:169,exactMass:168.94126,atomicNumber:72,halfLife:194.4},{id:"Hf170",massNumber:170,exactMass:169.93961,atomicNumber:72,halfLife:57636},{id:"Hf171",massNumber:171,exactMass:170.94049,atomicNumber:72,halfLife:43560},{id:"Hf172",massNumber:172,exactMass:171.939448,atomicNumber:72,halfLife:58972300},{id:"Hf173",massNumber:173,exactMass:172.94051,atomicNumber:72,halfLife:84960},{id:"Hf174",massNumber:174,relativeAbundance:.0016,atomicNumber:72,exactMass:173.940046,spin:"0+",halfLife:2e15,alphaDecay:"2.55",alphaDecayLikeliness:"100.0"},{id:"Hf175",massNumber:175,exactMass:174.941509,atomicNumber:72,spin:"5/2-",magneticMoment:"0.70",halfLife:6048e3,ecDecay:"0.59",ecDecayLikeliness:"100.0"},{id:"Hf176",massNumber:176,relativeAbundance:.0526,atomicNumber:72,exactMass:175.9414086,spin:"0+",halfLife:-1},{id:"Hf177",massNumber:177,relativeAbundance:.18600000000000003,atomicNumber:72,exactMass:176.9432207,spin:"7/2-",magneticMoment:"+0.7935",halfLife:-1},{id:"Hf178",massNumber:178,relativeAbundance:.2728,atomicNumber:72,exactMass:177.9436988,spin:"0+",halfLife:-1},{id:"Hf179",massNumber:179,relativeAbundance:.1362,atomicNumber:72,exactMass:178.9458161,spin:"9/2+",magneticMoment:"-0.6409",halfLife:-1},{id:"Hf180",massNumber:180,relativeAbundance:.3508,atomicNumber:72,exactMass:179.94655,spin:"0+",halfLife:-1},{id:"Hf181",massNumber:181,exactMass:180.9491012,atomicNumber:72,halfLife:3662500},{id:"Hf182",massNumber:182,exactMass:181.950554,atomicNumber:72},{id:"Hf183",massNumber:183,exactMass:182.95353,atomicNumber:72,halfLife:3841.2},{id:"Hf184",massNumber:184,exactMass:183.95545,atomicNumber:72,halfLife:14832},{id:"Hf185",massNumber:185,exactMass:184.95882,atomicNumber:72,halfLife:210},{id:"Hf186",massNumber:186,exactMass:185.96089,atomicNumber:72},{id:"Hf187",massNumber:187,exactMass:186.96459,atomicNumber:72},{id:"Hf188",massNumber:188,exactMass:187.96685,atomicNumber:72}]},{elementSymbol:"Ta",atomicNumber:73,isotopes:[{id:"Ta155",massNumber:155,exactMass:154.97459,atomicNumber:73},{id:"Ta156",massNumber:156,exactMass:155.9723,atomicNumber:73,halfLife:.144},{id:"Ta157",massNumber:157,exactMass:156.96819,atomicNumber:73,halfLife:.0101},{id:"Ta158",massNumber:158,exactMass:157.9667,atomicNumber:73,halfLife:.0365},{id:"Ta159",massNumber:159,exactMass:158.963018,atomicNumber:73,halfLife:.57},{id:"Ta160",massNumber:160,exactMass:159.96149,atomicNumber:73,halfLife:1.55},{id:"Ta161",massNumber:161,exactMass:160.95842,atomicNumber:73,halfLife:2.7},{id:"Ta162",massNumber:162,exactMass:161.95729,atomicNumber:73,halfLife:3.52},{id:"Ta163",massNumber:163,exactMass:162.95433,atomicNumber:73,halfLife:10.6},{id:"Ta164",massNumber:164,exactMass:163.95353,atomicNumber:73,halfLife:14.2},{id:"Ta165",massNumber:165,exactMass:164.950773,atomicNumber:73,halfLife:31},{id:"Ta166",massNumber:166,exactMass:165.95051,atomicNumber:73,halfLife:34.4},{id:"Ta167",massNumber:167,exactMass:166.94809,atomicNumber:73,halfLife:84},{id:"Ta168",massNumber:168,exactMass:167.94805,atomicNumber:73},{id:"Ta169",massNumber:169,exactMass:168.94601,atomicNumber:73,halfLife:294},{id:"Ta170",massNumber:170,exactMass:169.94618,atomicNumber:73,halfLife:405.6},{id:"Ta171",massNumber:171,exactMass:170.94448,atomicNumber:73,halfLife:1398},{id:"Ta172",massNumber:172,exactMass:171.9449,atomicNumber:73,halfLife:2208},{id:"Ta173",massNumber:173,exactMass:172.94375,atomicNumber:73,halfLife:11304},{id:"Ta174",massNumber:174,exactMass:173.94445,atomicNumber:73,halfLife:3780},{id:"Ta175",massNumber:175,exactMass:174.94374,atomicNumber:73,halfLife:37800},{id:"Ta176",massNumber:176,exactMass:175.94486,atomicNumber:73,halfLife:29124},{id:"Ta177",massNumber:177,exactMass:176.944472,atomicNumber:73,halfLife:203616},{id:"Ta178",massNumber:178,exactMass:177.945778,atomicNumber:73,halfLife:558.6},{id:"Ta179",massNumber:179,exactMass:178.9459295,atomicNumber:73,halfLife:57395500},{id:"Ta180",massNumber:180,relativeAbundance:12e-5,atomicNumber:73,exactMass:179.9474648,spin:"1-",halfLife:29347.2,betaminusDecay:"",betaminusDecayLikeliness:"14.0",ecDecay:"",ecDecayLikeliness:"86.0"},{id:"Ta181",massNumber:181,relativeAbundance:.99988,atomicNumber:73,exactMass:180.9479958,spin:"7/2+",magneticMoment:"+2.370",halfLife:-1},{id:"Ta182",massNumber:182,exactMass:181.9501518,atomicNumber:73,spin:"3-",magneticMoment:"2.6",halfLife:9886750,betaminusDecay:"1.811",betaminusDecayLikeliness:"100.0"},{id:"Ta183",massNumber:183,exactMass:182.9513726,atomicNumber:73,halfLife:440640},{id:"Ta184",massNumber:184,exactMass:183.954008,atomicNumber:73,halfLife:31320},{id:"Ta185",massNumber:185,exactMass:184.955559,atomicNumber:73,halfLife:2964},{id:"Ta186",massNumber:186,exactMass:185.95855,atomicNumber:73,halfLife:630},{id:"Ta187",massNumber:187,exactMass:186.96053,atomicNumber:73},{id:"Ta188",massNumber:188,exactMass:187.9637,atomicNumber:73},{id:"Ta189",massNumber:189,exactMass:188.96583,atomicNumber:73},{id:"Ta190",massNumber:190,exactMass:189.96923,atomicNumber:73}]},{elementSymbol:"W",atomicNumber:74,isotopes:[{id:"W158",massNumber:158,exactMass:157.97456,atomicNumber:74,halfLife:9e-4},{id:"W159",massNumber:159,exactMass:158.97292,atomicNumber:74,halfLife:.0073},{id:"W160",massNumber:160,exactMass:159.96848,atomicNumber:74,halfLife:.091},{id:"W161",massNumber:161,exactMass:160.96736,atomicNumber:74,halfLife:.41},{id:"W162",massNumber:162,exactMass:161.963497,atomicNumber:74,halfLife:1.39},{id:"W163",massNumber:163,exactMass:162.96252,atomicNumber:74,halfLife:2.75},{id:"W164",massNumber:164,exactMass:163.958954,atomicNumber:74,halfLife:6},{id:"W165",massNumber:165,exactMass:164.95828,atomicNumber:74,halfLife:5.1},{id:"W166",massNumber:166,exactMass:165.955027,atomicNumber:74,halfLife:18.8},{id:"W167",massNumber:167,exactMass:166.954816,atomicNumber:74,halfLife:19.9},{id:"W168",massNumber:168,exactMass:167.951808,atomicNumber:74,halfLife:53},{id:"W169",massNumber:169,exactMass:168.951779,atomicNumber:74,halfLife:76},{id:"W170",massNumber:170,exactMass:169.949228,atomicNumber:74,halfLife:145.2},{id:"W171",massNumber:171,exactMass:170.94945,atomicNumber:74,halfLife:142.8},{id:"W172",massNumber:172,exactMass:171.94729,atomicNumber:74,halfLife:396},{id:"W173",massNumber:173,exactMass:172.94769,atomicNumber:74,halfLife:456},{id:"W174",massNumber:174,exactMass:173.94608,atomicNumber:74,halfLife:1860},{id:"W175",massNumber:175,exactMass:174.94672,atomicNumber:74,halfLife:2112},{id:"W176",massNumber:176,exactMass:175.94563,atomicNumber:74,halfLife:9e3},{id:"W177",massNumber:177,exactMass:176.94664,atomicNumber:74,halfLife:8100},{id:"W178",massNumber:178,exactMass:177.945876,atomicNumber:74,halfLife:1866240},{id:"W179",massNumber:179,exactMass:178.94707,atomicNumber:74,halfLife:2223},{id:"W180",massNumber:180,relativeAbundance:.0012,atomicNumber:74,exactMass:179.946704,spin:"0+",halfLife:-1},{id:"W181",massNumber:181,exactMass:180.948197,atomicNumber:74,spin:"9/2+",halfLife:10471700,ecDecay:"0.19",ecDecayLikeliness:"100.0"},{id:"W182",massNumber:182,relativeAbundance:.265,atomicNumber:74,exactMass:181.9482042,spin:"0+",magneticMoment:"0+",halfLife:-1},{id:"W183",massNumber:183,relativeAbundance:.1431,atomicNumber:74,exactMass:182.950223,spin:"1/2-",magneticMoment:"+0.1177847"},{id:"W184",massNumber:184,relativeAbundance:.3064,atomicNumber:74,exactMass:183.9509312,spin:"0+"},{id:"W185",massNumber:185,exactMass:184.9534193,atomicNumber:74,halfLife:6488640,betaminusDecay:"0.432",betaminusDecayLikeliness:"100.0"},{id:"W186",massNumber:186,relativeAbundance:.2843,atomicNumber:74,exactMass:185.9543641,spin:"3/2-",halfLife:-1},{id:"W187",massNumber:187,exactMass:186.9571605,atomicNumber:74,magneticMoment:"0.688",halfLife:85392,betaminusDecay:"1.321",betaminusDecayLikeliness:"100.0"},{id:"W188",massNumber:188,exactMass:187.958489,atomicNumber:74,halfLife:5996160},{id:"W189",massNumber:189,exactMass:188.96191,atomicNumber:74,halfLife:690},{id:"W190",massNumber:190,exactMass:189.96318,atomicNumber:74,halfLife:1800},{id:"W191",massNumber:191,exactMass:190.9666,atomicNumber:74},{id:"W192",massNumber:192,exactMass:191.96817,atomicNumber:74}]},{elementSymbol:"Re",atomicNumber:75,isotopes:[{id:"Re160",massNumber:160,exactMass:159.98212,atomicNumber:75,halfLife:79e-5},{id:"Re161",massNumber:161,exactMass:160.97759,atomicNumber:75,halfLife:37e-5},{id:"Re162",massNumber:162,exactMass:161.976,atomicNumber:75,halfLife:.107},{id:"Re163",massNumber:163,exactMass:162.972081,atomicNumber:75,halfLife:.26},{id:"Re164",massNumber:164,exactMass:163.97032,atomicNumber:75,halfLife:.38},{id:"Re165",massNumber:165,exactMass:164.967089,atomicNumber:75,halfLife:2.4},{id:"Re166",massNumber:166,exactMass:165.96581,atomicNumber:75,halfLife:2.8},{id:"Re167",massNumber:167,exactMass:166.9626,atomicNumber:75,halfLife:6.1},{id:"Re168",massNumber:168,exactMass:167.96157,atomicNumber:75,halfLife:4.4},{id:"Re169",massNumber:169,exactMass:168.95879,atomicNumber:75},{id:"Re170",massNumber:170,exactMass:169.95822,atomicNumber:75,halfLife:9.2},{id:"Re171",massNumber:171,exactMass:170.95572,atomicNumber:75,halfLife:15.2},{id:"Re172",massNumber:172,exactMass:171.95542,atomicNumber:75,halfLife:15},{id:"Re173",massNumber:173,exactMass:172.95324,atomicNumber:75,halfLife:118.8},{id:"Re174",massNumber:174,exactMass:173.95312,atomicNumber:75,halfLife:144},{id:"Re175",massNumber:175,exactMass:174.95138,atomicNumber:75,halfLife:353.4},{id:"Re176",massNumber:176,exactMass:175.95162,atomicNumber:75,halfLife:318},{id:"Re177",massNumber:177,exactMass:176.95033,atomicNumber:75,halfLife:840},{id:"Re178",massNumber:178,exactMass:177.95099,atomicNumber:75,halfLife:792},{id:"Re179",massNumber:179,exactMass:178.949988,atomicNumber:75,halfLife:1170},{id:"Re180",massNumber:180,exactMass:179.950789,atomicNumber:75,halfLife:146.4},{id:"Re181",massNumber:181,exactMass:180.950068,atomicNumber:75,halfLife:71640},{id:"Re182",massNumber:182,exactMass:181.95121,atomicNumber:75,halfLife:230400},{id:"Re183",massNumber:183,exactMass:182.95082,atomicNumber:75,halfLife:6048e3},{id:"Re184",massNumber:184,exactMass:183.952521,atomicNumber:75,halfLife:3283200},{id:"Re185",massNumber:185,relativeAbundance:.374,atomicNumber:75,exactMass:184.952955,spin:"5/2+",magneticMoment:"+3.172",halfLife:-1},{id:"Re186",massNumber:186,exactMass:185.9549861,atomicNumber:75,spin:"1-",magneticMoment:"+1.739",halfLife:321261,betaminusDecay:"1.071",betaminusDecayLikeliness:"93.1",ecDecay:"",ecDecayLikeliness:"6.9"},{id:"Re187",massNumber:187,relativeAbundance:.626,atomicNumber:75,exactMass:186.9557531,spin:"5/2+",magneticMoment:"+3.2197",halfLife:435e8,betaminusDecay:"0.00251",betaminusDecayLikeliness:"100.0"},{id:"Re188",massNumber:188,exactMass:187.9581144,atomicNumber:75,spin:"1-",magneticMoment:"+1.788",halfLife:61218,betaminusDecay:"2.12",betaminusDecayLikeliness:"100.0"},{id:"Re189",massNumber:189,exactMass:188.959229,atomicNumber:75,halfLife:87480},{id:"Re190",massNumber:190,exactMass:189.96182,atomicNumber:75,halfLife:186},{id:"Re191",massNumber:191,exactMass:190.963125,atomicNumber:75,halfLife:588},{id:"Re192",massNumber:192,exactMass:191.96596,atomicNumber:75,halfLife:16},{id:"Re193",massNumber:193,exactMass:192.96747,atomicNumber:75},{id:"Re194",massNumber:194,exactMass:193.97042,atomicNumber:75}]},{elementSymbol:"Os",atomicNumber:76,isotopes:[{id:"Os162",massNumber:162,exactMass:161.98443,atomicNumber:76,halfLife:.0019},{id:"Os163",massNumber:163,exactMass:162.98269,atomicNumber:76},{id:"Os164",massNumber:164,exactMass:163.97804,atomicNumber:76,halfLife:.021},{id:"Os165",massNumber:165,exactMass:164.97676,atomicNumber:76,halfLife:.071},{id:"Os166",massNumber:166,exactMass:165.972691,atomicNumber:76,halfLife:.181},{id:"Os167",massNumber:167,exactMass:166.97155,atomicNumber:76,halfLife:.83},{id:"Os168",massNumber:168,exactMass:167.967804,atomicNumber:76,halfLife:2.1},{id:"Os169",massNumber:169,exactMass:168.967019,atomicNumber:76,halfLife:3.4},{id:"Os170",massNumber:170,exactMass:169.963577,atomicNumber:76,halfLife:7.3},{id:"Os171",massNumber:171,exactMass:170.963185,atomicNumber:76,halfLife:8},{id:"Os172",massNumber:172,exactMass:171.960023,atomicNumber:76,halfLife:19.2},{id:"Os173",massNumber:173,exactMass:172.959808,atomicNumber:76,halfLife:16},{id:"Os174",massNumber:174,exactMass:173.957062,atomicNumber:76,halfLife:44},{id:"Os175",massNumber:175,exactMass:174.956946,atomicNumber:76,halfLife:84},{id:"Os176",massNumber:176,exactMass:175.95481,atomicNumber:76,halfLife:216},{id:"Os177",massNumber:177,exactMass:176.954965,atomicNumber:76,halfLife:168},{id:"Os178",massNumber:178,exactMass:177.953251,atomicNumber:76,halfLife:300},{id:"Os179",massNumber:179,exactMass:178.953816,atomicNumber:76,halfLife:390},{id:"Os180",massNumber:180,exactMass:179.952379,atomicNumber:76,halfLife:1290},{id:"Os181",massNumber:181,exactMass:180.95324,atomicNumber:76,halfLife:6300},{id:"Os182",massNumber:182,exactMass:181.95211,atomicNumber:76,halfLife:79560},{id:"Os183",massNumber:183,exactMass:182.95313,atomicNumber:76,halfLife:46800},{id:"Os184",massNumber:184,relativeAbundance:2e-4,atomicNumber:76,exactMass:183.9524891,spin:"0+"},{id:"Os185",massNumber:185,exactMass:184.9540423,atomicNumber:76,spin:"1/2-",halfLife:8087040,ecDecay:"0.98",ecDecayLikeliness:"100.0"},{id:"Os186",massNumber:186,relativeAbundance:.0159,atomicNumber:76,exactMass:185.9538382,spin:"0+",halfLife:2e15,alphaDecay:"",alphaDecayLikeliness:"100.0"},{id:"Os187",massNumber:187,relativeAbundance:.0196,atomicNumber:76,exactMass:186.9557505,spin:"1/2-",magneticMoment:"+0.06465",halfLife:-1},{id:"Os188",massNumber:188,relativeAbundance:.1324,atomicNumber:76,exactMass:187.9558382,spin:"0+",halfLife:-1},{id:"Os189",massNumber:189,relativeAbundance:.16149999999999998,atomicNumber:76,exactMass:188.9581475,spin:"3/2-",magneticMoment:"+0.659933",halfLife:-1},{id:"Os190",massNumber:190,relativeAbundance:.2626,atomicNumber:76,exactMass:189.958447,spin:"0+",halfLife:-1},{id:"Os191",massNumber:191,exactMass:190.9609297,atomicNumber:76,spin:"9/2-",halfLife:1330560,betaminusDecay:"0.313",betaminusDecayLikeliness:"100.0"},{id:"Os192",massNumber:192,relativeAbundance:.4078,atomicNumber:76,exactMass:191.9614807,spin:"0+",halfLife:-1},{id:"Os193",massNumber:193,exactMass:192.9641516,atomicNumber:76,halfLife:108396},{id:"Os194",massNumber:194,exactMass:193.9651821,atomicNumber:76,halfLife:189216e3},{id:"Os195",massNumber:195,exactMass:194.96813,atomicNumber:76,halfLife:390},{id:"Os196",massNumber:196,exactMass:195.96964,atomicNumber:76,halfLife:2094}]},{elementSymbol:"Ir",atomicNumber:77,isotopes:[{id:"Ir164",massNumber:164,exactMass:163.9922,atomicNumber:77},{id:"Ir165",massNumber:165,exactMass:164.98752,atomicNumber:77,halfLife:3e-4},{id:"Ir166",massNumber:166,exactMass:165.98582,atomicNumber:77,halfLife:.0105},{id:"Ir167",massNumber:167,exactMass:166.981665,atomicNumber:77,halfLife:.005},{id:"Ir168",massNumber:168,exactMass:167.97988,atomicNumber:77,halfLife:.161},{id:"Ir169",massNumber:169,exactMass:168.976295,atomicNumber:77,halfLife:.4},{id:"Ir170",massNumber:170,exactMass:169.97497,atomicNumber:77,halfLife:1.05},{id:"Ir171",massNumber:171,exactMass:170.97163,atomicNumber:77,halfLife:1.5},{id:"Ir172",massNumber:172,exactMass:171.97046,atomicNumber:77,halfLife:4.4},{id:"Ir173",massNumber:173,exactMass:172.967502,atomicNumber:77,halfLife:9},{id:"Ir174",massNumber:174,exactMass:173.966861,atomicNumber:77,halfLife:9},{id:"Ir175",massNumber:175,exactMass:174.964113,atomicNumber:77,halfLife:9},{id:"Ir176",massNumber:176,exactMass:175.963649,atomicNumber:77,halfLife:8},{id:"Ir177",massNumber:177,exactMass:176.961302,atomicNumber:77,halfLife:30},{id:"Ir178",massNumber:178,exactMass:177.961082,atomicNumber:77,halfLife:12},{id:"Ir179",massNumber:179,exactMass:178.959122,atomicNumber:77,halfLife:79},{id:"Ir180",massNumber:180,exactMass:179.959229,atomicNumber:77,halfLife:90},{id:"Ir181",massNumber:181,exactMass:180.957625,atomicNumber:77,halfLife:294},{id:"Ir182",massNumber:182,exactMass:181.958076,atomicNumber:77,halfLife:900},{id:"Ir183",massNumber:183,exactMass:182.956846,atomicNumber:77,halfLife:3480},{id:"Ir184",massNumber:184,exactMass:183.95748,atomicNumber:77,halfLife:11124},{id:"Ir185",massNumber:185,exactMass:184.9567,atomicNumber:77,halfLife:51840},{id:"Ir186",massNumber:186,exactMass:185.957946,atomicNumber:77,halfLife:59904},{id:"Ir187",massNumber:187,exactMass:186.957363,atomicNumber:77,halfLife:37800},{id:"Ir188",massNumber:188,exactMass:187.958853,atomicNumber:77,halfLife:149400},{id:"Ir189",massNumber:189,exactMass:188.958719,atomicNumber:77,halfLife:1140480},{id:"Ir190",massNumber:190,exactMass:189.960546,atomicNumber:77,halfLife:1017790},{id:"Ir191",massNumber:191,relativeAbundance:.373,atomicNumber:77,exactMass:190.960594,spin:"3/2+",magneticMoment:"+0.1461",halfLife:-1},{id:"Ir192",massNumber:192,exactMass:191.962605,atomicNumber:77,spin:"4-",magneticMoment:"+1.880",halfLife:6379e3,betaplusDecay:"1.2",betaplusDecayLikeliness:"4.6",betaminusDecay:"1.454",betaminusDecayLikeliness:"95.4",ecDecay:"",ecDecayLikeliness:"4.6"},{id:"Ir193",massNumber:193,relativeAbundance:.627,atomicNumber:77,exactMass:192.9629264,spin:"3/2+",magneticMoment:"+0.1591",halfLife:-1},{id:"Ir194",massNumber:194,exactMass:193.9650784,atomicNumber:77,spin:"1-",halfLife:69408},{id:"Ir195",massNumber:195,exactMass:194.9659796,atomicNumber:77,halfLife:9e3},{id:"Ir196",massNumber:196,exactMass:195.9684,atomicNumber:77,halfLife:52},{id:"Ir197",massNumber:197,exactMass:196.969653,atomicNumber:77,halfLife:348},{id:"Ir198",massNumber:198,exactMass:197.97228,atomicNumber:77,halfLife:8},{id:"Ir199",massNumber:199,exactMass:198.9738,atomicNumber:77}]},{elementSymbol:"Pt",atomicNumber:78,isotopes:[{id:"Pt166",massNumber:166,exactMass:165.99486,atomicNumber:78},{id:"Pt167",massNumber:167,exactMass:166.99298,atomicNumber:78},{id:"Pt168",massNumber:168,exactMass:167.98815,atomicNumber:78},{id:"Pt169",massNumber:169,exactMass:168.98672,atomicNumber:78,halfLife:.005},{id:"Pt170",massNumber:170,exactMass:169.982495,atomicNumber:78,halfLife:.006},{id:"Pt171",massNumber:171,exactMass:170.98124,atomicNumber:78,halfLife:.025},{id:"Pt172",massNumber:172,exactMass:171.977347,atomicNumber:78,halfLife:.096},{id:"Pt173",massNumber:173,exactMass:172.97644,atomicNumber:78,halfLife:.342},{id:"Pt174",massNumber:174,exactMass:173.972819,atomicNumber:78,halfLife:.9},{id:"Pt175",massNumber:175,exactMass:174.972421,atomicNumber:78,halfLife:2.52},{id:"Pt176",massNumber:176,exactMass:175.968945,atomicNumber:78,halfLife:6.33},{id:"Pt177",massNumber:177,exactMass:176.968469,atomicNumber:78,halfLife:11},{id:"Pt178",massNumber:178,exactMass:177.965649,atomicNumber:78,halfLife:21.1},{id:"Pt179",massNumber:179,exactMass:178.965363,atomicNumber:78,halfLife:21.2},{id:"Pt180",massNumber:180,exactMass:179.963031,atomicNumber:78,halfLife:52},{id:"Pt181",massNumber:181,exactMass:180.963097,atomicNumber:78,halfLife:51},{id:"Pt182",massNumber:182,exactMass:181.961171,atomicNumber:78,halfLife:180},{id:"Pt183",massNumber:183,exactMass:182.961597,atomicNumber:78,halfLife:390},{id:"Pt184",massNumber:184,exactMass:183.959922,atomicNumber:78,halfLife:1038},{id:"Pt185",massNumber:185,exactMass:184.96062,atomicNumber:78,halfLife:4254},{id:"Pt186",massNumber:186,exactMass:185.959351,atomicNumber:78,halfLife:7920},{id:"Pt187",massNumber:187,exactMass:186.96059,atomicNumber:78,halfLife:8460},{id:"Pt188",massNumber:188,exactMass:187.959395,atomicNumber:78,halfLife:881280},{id:"Pt189",massNumber:189,exactMass:188.960834,atomicNumber:78,halfLife:39132},{id:"Pt190",massNumber:190,relativeAbundance:.00014000000000000001,atomicNumber:78,exactMass:189.959932,spin:"0+",halfLife:65e10,alphaDecay:"3.18",alphaDecayLikeliness:"100.0"},{id:"Pt191",massNumber:191,exactMass:190.961677,atomicNumber:78,spin:"3/2-",halfLife:242093},{id:"Pt192",massNumber:192,relativeAbundance:.00782,atomicNumber:78,exactMass:191.961038,spin:"0+",halfLife:-1,alphaDecay:"2.6",alphaDecayLikeliness:"100.0"},{id:"Pt193",massNumber:193,exactMass:192.9629874,atomicNumber:78,halfLife:15768e5},{id:"Pt194",massNumber:194,relativeAbundance:.32966999999999996,atomicNumber:78,exactMass:193.9626803,spin:"0+",halfLife:-1},{id:"Pt195",massNumber:195,relativeAbundance:.33832,atomicNumber:78,exactMass:194.9647911,spin:"1/2-",magneticMoment:"+0.60949",halfLife:-1},{id:"Pt196",massNumber:196,relativeAbundance:.25242000000000003,atomicNumber:78,exactMass:195.9649515,spin:"0+",halfLife:-1},{id:"Pt197",massNumber:197,exactMass:196.9673402,atomicNumber:78,spin:"1/2-",magneticMoment:"-0.51",halfLife:71609.4,betaminusDecay:"0.75",betaminusDecayLikeliness:"100.0"},{id:"Pt198",massNumber:198,relativeAbundance:.07163,atomicNumber:78,exactMass:197.967893,spin:"0+",halfLife:-1},{id:"Pt199",massNumber:199,exactMass:198.970593,atomicNumber:78,halfLife:1848},{id:"Pt200",massNumber:200,exactMass:199.971441,atomicNumber:78,halfLife:45e3},{id:"Pt201",massNumber:201,exactMass:200.97451,atomicNumber:78,halfLife:150},{id:"Pt202",massNumber:202,exactMass:201.97574,atomicNumber:78,halfLife:158400}]},{elementSymbol:"Au",atomicNumber:79,isotopes:[{id:"Au169",massNumber:169,exactMass:168.99808,atomicNumber:79},{id:"Au170",massNumber:170,exactMass:169.99612,atomicNumber:79},{id:"Au171",massNumber:171,exactMass:170.991879,atomicNumber:79},{id:"Au172",massNumber:172,exactMass:171.99004,atomicNumber:79,halfLife:.0063},{id:"Au173",massNumber:173,exactMass:172.986237,atomicNumber:79,halfLife:.059},{id:"Au174",massNumber:174,exactMass:173.98476,atomicNumber:79,halfLife:.12},{id:"Au175",massNumber:175,exactMass:174.98127,atomicNumber:79,halfLife:.2},{id:"Au176",massNumber:176,exactMass:175.9801,atomicNumber:79,halfLife:1.08},{id:"Au177",massNumber:177,exactMass:176.976865,atomicNumber:79,halfLife:1.18},{id:"Au178",massNumber:178,exactMass:177.97603,atomicNumber:79,halfLife:2.6},{id:"Au179",massNumber:179,exactMass:178.973213,atomicNumber:79,halfLife:7.1},{id:"Au180",massNumber:180,exactMass:179.972521,atomicNumber:79,halfLife:8.1},{id:"Au181",massNumber:181,exactMass:180.970079,atomicNumber:79,halfLife:11.4},{id:"Au182",massNumber:182,exactMass:181.969618,atomicNumber:79,halfLife:15.6},{id:"Au183",massNumber:183,exactMass:182.967593,atomicNumber:79,halfLife:42},{id:"Au184",massNumber:184,exactMass:183.967452,atomicNumber:79,halfLife:53},{id:"Au185",massNumber:185,exactMass:184.965789,atomicNumber:79,halfLife:255},{id:"Au186",massNumber:186,exactMass:185.965953,atomicNumber:79,halfLife:642},{id:"Au187",massNumber:187,exactMass:186.964568,atomicNumber:79,halfLife:504},{id:"Au188",massNumber:188,exactMass:187.965324,atomicNumber:79,halfLife:530.4},{id:"Au189",massNumber:189,exactMass:188.963948,atomicNumber:79,halfLife:1722},{id:"Au190",massNumber:190,exactMass:189.9647,atomicNumber:79,halfLife:2568},{id:"Au191",massNumber:191,exactMass:190.9637,atomicNumber:79,halfLife:11448},{id:"Au192",massNumber:192,exactMass:191.964813,atomicNumber:79,halfLife:17784},{id:"Au193",massNumber:193,exactMass:192.96415,atomicNumber:79,halfLife:63540},{id:"Au194",massNumber:194,exactMass:193.965365,atomicNumber:79,halfLife:136872},{id:"Au195",massNumber:195,exactMass:194.9650346,atomicNumber:79,magneticMoment:"0.148",halfLife:16078200,ecDecay:"0.230",ecDecayLikeliness:"100.0"},{id:"Au196",massNumber:196,exactMass:195.96657,atomicNumber:79,halfLife:534211},{id:"Au197",massNumber:197,relativeAbundance:1,atomicNumber:79,exactMass:196.9665687,spin:"3/2+",magneticMoment:"+0.1457",halfLife:-1},{id:"Au198",massNumber:198,exactMass:197.9682423,atomicNumber:79,spin:"2-",magneticMoment:"+0.5934",halfLife:232863,betaminusDecay:"1.372",betaminusDecayLikeliness:"100.0"},{id:"Au199",massNumber:199,exactMass:198.9687652,atomicNumber:79,spin:"3/2+",magneticMoment:"+0.2715",halfLife:271210,betaminusDecay:"0.453",betaminusDecayLikeliness:"100.0"},{id:"Au200",massNumber:200,exactMass:199.97073,atomicNumber:79,halfLife:2904},{id:"Au201",massNumber:201,exactMass:200.971657,atomicNumber:79,halfLife:1560},{id:"Au202",massNumber:202,exactMass:201.97381,atomicNumber:79,halfLife:28.8},{id:"Au203",massNumber:203,exactMass:202.975155,atomicNumber:79,halfLife:53},{id:"Au204",massNumber:204,exactMass:203.97772,atomicNumber:79,halfLife:39.8},{id:"Au205",massNumber:205,exactMass:204.97987,atomicNumber:79,halfLife:31}]},{elementSymbol:"Hg",atomicNumber:80,isotopes:[{id:"Hg171",massNumber:171,exactMass:171.00376,atomicNumber:80},{id:"Hg172",massNumber:172,exactMass:171.99883,atomicNumber:80},{id:"Hg173",massNumber:173,exactMass:172.99724,atomicNumber:80},{id:"Hg174",massNumber:174,exactMass:173.992864,atomicNumber:80},{id:"Hg175",massNumber:175,exactMass:174.99142,atomicNumber:80,halfLife:.02},{id:"Hg176",massNumber:176,exactMass:175.987355,atomicNumber:80,halfLife:.018},{id:"Hg177",massNumber:177,exactMass:176.98628,atomicNumber:80,halfLife:.13},{id:"Hg178",massNumber:178,exactMass:177.982483,atomicNumber:80,halfLife:.266},{id:"Hg179",massNumber:179,exactMass:178.981834,atomicNumber:80,halfLife:1.09},{id:"Hg180",massNumber:180,exactMass:179.978266,atomicNumber:80,halfLife:2.8},{id:"Hg181",massNumber:181,exactMass:180.977819,atomicNumber:80,halfLife:3.6},{id:"Hg182",massNumber:182,exactMass:181.97469,atomicNumber:80,halfLife:10.83},{id:"Hg183",massNumber:183,exactMass:182.97445,atomicNumber:80,halfLife:9.4},{id:"Hg184",massNumber:184,exactMass:183.971713,atomicNumber:80,halfLife:30.9},{id:"Hg185",massNumber:185,exactMass:184.971899,atomicNumber:80,halfLife:49.1},{id:"Hg186",massNumber:186,exactMass:185.969362,atomicNumber:80,halfLife:82.8},{id:"Hg187",massNumber:187,exactMass:186.969814,atomicNumber:80,halfLife:144},{id:"Hg188",massNumber:188,exactMass:187.967577,atomicNumber:80,halfLife:195},{id:"Hg189",massNumber:189,exactMass:188.96819,atomicNumber:80,halfLife:456},{id:"Hg190",massNumber:190,exactMass:189.966322,atomicNumber:80,halfLife:1200},{id:"Hg191",massNumber:191,exactMass:190.967157,atomicNumber:80,halfLife:2940},{id:"Hg192",massNumber:192,exactMass:191.965634,atomicNumber:80,halfLife:17460},{id:"Hg193",massNumber:193,exactMass:192.966665,atomicNumber:80,halfLife:13680},{id:"Hg194",massNumber:194,exactMass:193.965439,atomicNumber:80,halfLife:14002e6},{id:"Hg195",massNumber:195,exactMass:194.96672,atomicNumber:80,halfLife:35640},{id:"Hg196",massNumber:196,relativeAbundance:.0015,atomicNumber:80,exactMass:195.965833,spin:"0+",halfLife:-1},{id:"Hg197",massNumber:197,exactMass:196.967213,atomicNumber:80,spin:"1/2-",magneticMoment:"+0.5274",halfLife:230904,ecDecay:"0.42",ecDecayLikeliness:"100.0"},{id:"Hg198",massNumber:198,relativeAbundance:.09970000000000001,atomicNumber:80,exactMass:197.966769,spin:"0+",halfLife:-1},{id:"Hg199",massNumber:199,relativeAbundance:.16870000000000002,atomicNumber:80,exactMass:198.9682799,spin:"1/2-",magneticMoment:"+0.5058851",halfLife:-1},{id:"Hg200",massNumber:200,relativeAbundance:.231,atomicNumber:80,exactMass:199.968326,spin:"0+",halfLife:-1},{id:"Hg201",massNumber:201,relativeAbundance:.1318,atomicNumber:80,exactMass:200.9703023,spin:"3/2-",magneticMoment:"-0.560225",halfLife:-1},{id:"Hg202",massNumber:202,relativeAbundance:.2986,atomicNumber:80,exactMass:201.970643,spin:"0+",halfLife:-1},{id:"Hg203",massNumber:203,exactMass:202.9728725,atomicNumber:80,spin:"5/2-",magneticMoment:"+0.8489",halfLife:4027280,betaminusDecay:"0.492",betaminusDecayLikeliness:"100.0"},{id:"Hg204",massNumber:204,relativeAbundance:.0687,atomicNumber:80,exactMass:203.9734939,spin:"0+",halfLife:-1},{id:"Hg205",massNumber:205,exactMass:204.976073,atomicNumber:80,halfLife:312},{id:"Hg206",massNumber:206,exactMass:205.977514,atomicNumber:80,halfLife:489},{id:"Hg207",massNumber:207,exactMass:206.98259,atomicNumber:80,halfLife:174},{id:"Hg208",massNumber:208,exactMass:207.98594,atomicNumber:80,halfLife:2520},{id:"Hg209",massNumber:209,exactMass:208.99104,atomicNumber:80},{id:"Hg210",massNumber:210,exactMass:209.99451,atomicNumber:80}]},{elementSymbol:"Tl",atomicNumber:81,isotopes:[{id:"Tl176",massNumber:176,exactMass:176.00059,atomicNumber:81},{id:"Tl177",massNumber:177,exactMass:176.996427,atomicNumber:81},{id:"Tl178",massNumber:178,exactMass:177.9949,atomicNumber:81},{id:"Tl179",massNumber:179,exactMass:178.99109,atomicNumber:81,halfLife:.16},{id:"Tl180",massNumber:180,exactMass:179.98991,atomicNumber:81,halfLife:.7},{id:"Tl181",massNumber:181,exactMass:180.986257,atomicNumber:81},{id:"Tl182",massNumber:182,exactMass:181.98567,atomicNumber:81,halfLife:3.1},{id:"Tl183",massNumber:183,exactMass:182.982193,atomicNumber:81},{id:"Tl184",massNumber:184,exactMass:183.98187,atomicNumber:81,halfLife:11},{id:"Tl185",massNumber:185,exactMass:184.97879,atomicNumber:81,halfLife:19.5},{id:"Tl186",massNumber:186,exactMass:185.97833,atomicNumber:81,halfLife:27.5},{id:"Tl187",massNumber:187,exactMass:186.975906,atomicNumber:81,halfLife:51},{id:"Tl188",massNumber:188,exactMass:187.97601,atomicNumber:81,halfLife:71},{id:"Tl189",massNumber:189,exactMass:188.973588,atomicNumber:81,halfLife:138},{id:"Tl190",massNumber:190,exactMass:189.97388,atomicNumber:81,halfLife:156},{id:"Tl191",massNumber:191,exactMass:190.971786,atomicNumber:81},{id:"Tl192",massNumber:192,exactMass:191.97223,atomicNumber:81,halfLife:576},{id:"Tl193",massNumber:193,exactMass:192.97067,atomicNumber:81,halfLife:1296},{id:"Tl194",massNumber:194,exactMass:193.9712,atomicNumber:81,halfLife:1980},{id:"Tl195",massNumber:195,exactMass:194.969774,atomicNumber:81,halfLife:4176},{id:"Tl196",massNumber:196,exactMass:195.970481,atomicNumber:81,halfLife:6624},{id:"Tl197",massNumber:197,exactMass:196.969575,atomicNumber:81,halfLife:10224},{id:"Tl198",massNumber:198,exactMass:197.97048,atomicNumber:81,halfLife:19080},{id:"Tl199",massNumber:199,exactMass:198.96988,atomicNumber:81,halfLife:26712},{id:"Tl200",massNumber:200,exactMass:199.970963,atomicNumber:81,halfLife:93960},{id:"Tl201",massNumber:201,exactMass:200.970819,atomicNumber:81,halfLife:262483},{id:"Tl202",massNumber:202,exactMass:201.972106,atomicNumber:81,halfLife:1056670},{id:"Tl203",massNumber:203,relativeAbundance:.29524,atomicNumber:81,exactMass:202.9723442,spin:"1/2+",magneticMoment:"+1.622257",halfLife:-1},{id:"Tl204",massNumber:204,exactMass:203.9738635,atomicNumber:81,spin:"2-",magneticMoment:"-0.06",halfLife:119206e3,betaminusDecay:"0.763",betaminusDecayLikeliness:"97.43",ecDecay:"0.345",ecDecayLikeliness:"2.57"},{id:"Tl205",massNumber:205,relativeAbundance:.7047599999999999,atomicNumber:81,exactMass:204.9744275,spin:"1/2+",magneticMoment:"+1.6382134",halfLife:-1},{id:"Tl206",massNumber:206,exactMass:205.9761103,atomicNumber:81,spin:"0-",halfLife:251.94},{id:"Tl207",massNumber:207,exactMass:206.977419,atomicNumber:81,halfLife:286.2},{id:"Tl208",massNumber:208,exactMass:207.9820187,atomicNumber:81,halfLife:183.18},{id:"Tl209",massNumber:209,exactMass:208.985359,atomicNumber:81,halfLife:132},{id:"Tl210",massNumber:210,exactMass:209.990074,atomicNumber:81,halfLife:78},{id:"Tl211",massNumber:211,exactMass:210.99348,atomicNumber:81},{id:"Tl212",massNumber:212,exactMass:211.99823,atomicNumber:81}]},{elementSymbol:"Pb",atomicNumber:82,isotopes:[{id:"Pb178",massNumber:178,exactMass:178.00383,atomicNumber:82},{id:"Pb179",massNumber:179,exactMass:179.00215,atomicNumber:82},{id:"Pb180",massNumber:180,exactMass:179.997918,atomicNumber:82},{id:"Pb181",massNumber:181,exactMass:180.99662,atomicNumber:82,halfLife:.045},{id:"Pb182",massNumber:182,exactMass:181.992672,atomicNumber:82,halfLife:.055},{id:"Pb183",massNumber:183,exactMass:182.99187,atomicNumber:82,halfLife:.3},{id:"Pb184",massNumber:184,exactMass:183.988142,atomicNumber:82,halfLife:.55},{id:"Pb185",massNumber:185,exactMass:184.98761,atomicNumber:82,halfLife:4.1},{id:"Pb186",massNumber:186,exactMass:185.984239,atomicNumber:82,halfLife:4.83},{id:"Pb187",massNumber:187,exactMass:186.983918,atomicNumber:82,halfLife:18.3},{id:"Pb188",massNumber:188,exactMass:187.980874,atomicNumber:82,halfLife:24},{id:"Pb189",massNumber:189,exactMass:188.98081,atomicNumber:82,halfLife:51},{id:"Pb190",massNumber:190,exactMass:189.978082,atomicNumber:82,halfLife:72},{id:"Pb191",massNumber:191,exactMass:190.97827,atomicNumber:82,halfLife:79.8},{id:"Pb192",massNumber:192,exactMass:191.975785,atomicNumber:82,halfLife:210},{id:"Pb193",massNumber:193,exactMass:192.97617,atomicNumber:82},{id:"Pb194",massNumber:194,exactMass:193.974012,atomicNumber:82,halfLife:720},{id:"Pb195",massNumber:195,exactMass:194.974542,atomicNumber:82,halfLife:900},{id:"Pb196",massNumber:196,exactMass:195.972774,atomicNumber:82,halfLife:2220},{id:"Pb197",massNumber:197,exactMass:196.973431,atomicNumber:82,halfLife:480},{id:"Pb198",massNumber:198,exactMass:197.972034,atomicNumber:82,halfLife:8640},{id:"Pb199",massNumber:199,exactMass:198.972917,atomicNumber:82,halfLife:5400},{id:"Pb200",massNumber:200,exactMass:199.971827,atomicNumber:82,halfLife:77400},{id:"Pb201",massNumber:201,exactMass:200.972885,atomicNumber:82,halfLife:33588},{id:"Pb202",massNumber:202,exactMass:201.972159,atomicNumber:82},{id:"Pb203",massNumber:203,exactMass:202.973391,atomicNumber:82,halfLife:186743},{id:"Pb204",massNumber:204,relativeAbundance:.013999999999999999,atomicNumber:82,exactMass:203.9730436,spin:"0+"},{id:"Pb205",massNumber:205,exactMass:204.9744818,atomicNumber:82,spin:"5/2-"},{id:"Pb206",massNumber:206,relativeAbundance:.24100000000000002,atomicNumber:82,exactMass:205.9744653,spin:"0+",halfLife:-1},{id:"Pb207",massNumber:207,relativeAbundance:.221,atomicNumber:82,exactMass:206.9758969,spin:"1/2-",magneticMoment:"+0.5926",halfLife:-1},{id:"Pb208",massNumber:208,relativeAbundance:.524,atomicNumber:82,exactMass:207.9766521,spin:"0+",halfLife:-1},{id:"Pb209",massNumber:209,exactMass:208.9810901,atomicNumber:82,spin:"9/2+",halfLife:11710.8},{id:"Pb210",massNumber:210,exactMass:209.9841885,atomicNumber:82,halfLife:703253e3},{id:"Pb211",massNumber:211,exactMass:210.988737,atomicNumber:82,halfLife:2166},{id:"Pb212",massNumber:212,exactMass:211.9918975,atomicNumber:82,halfLife:38304},{id:"Pb213",massNumber:213,exactMass:212.996581,atomicNumber:82,halfLife:612},{id:"Pb214",massNumber:214,exactMass:213.9998054,atomicNumber:82,halfLife:1608},{id:"Pb215",massNumber:215,exactMass:215.00481,atomicNumber:82,halfLife:36}]},{elementSymbol:"Bi",atomicNumber:83,isotopes:[{id:"Bi184",massNumber:184,exactMass:184.00112,atomicNumber:83},{id:"Bi185",massNumber:185,exactMass:184.99763,atomicNumber:83,halfLife:44e-6},{id:"Bi186",massNumber:186,exactMass:185.9966,atomicNumber:83,halfLife:.015},{id:"Bi187",massNumber:187,exactMass:186.993158,atomicNumber:83,halfLife:.035},{id:"Bi188",massNumber:188,exactMass:187.99227,atomicNumber:83,halfLife:.21},{id:"Bi189",massNumber:189,exactMass:188.9892,atomicNumber:83,halfLife:.68},{id:"Bi190",massNumber:190,exactMass:189.9883,atomicNumber:83,halfLife:6.3},{id:"Bi191",massNumber:191,exactMass:190.985786,atomicNumber:83,halfLife:12},{id:"Bi192",massNumber:192,exactMass:191.98546,atomicNumber:83,halfLife:37},{id:"Bi193",massNumber:193,exactMass:192.98296,atomicNumber:83,halfLife:67},{id:"Bi194",massNumber:194,exactMass:193.98283,atomicNumber:83,halfLife:95},{id:"Bi195",massNumber:195,exactMass:194.980651,atomicNumber:83,halfLife:183},{id:"Bi196",massNumber:196,exactMass:195.980667,atomicNumber:83,halfLife:308},{id:"Bi197",massNumber:197,exactMass:196.978864,atomicNumber:83,halfLife:559.8},{id:"Bi198",massNumber:198,exactMass:197.97921,atomicNumber:83,halfLife:618},{id:"Bi199",massNumber:199,exactMass:198.977672,atomicNumber:83,halfLife:1620},{id:"Bi200",massNumber:200,exactMass:199.978132,atomicNumber:83,halfLife:2184},{id:"Bi201",massNumber:201,exactMass:200.977009,atomicNumber:83,halfLife:6480},{id:"Bi202",massNumber:202,exactMass:201.977742,atomicNumber:83,halfLife:6192},{id:"Bi203",massNumber:203,exactMass:202.976876,atomicNumber:83,halfLife:42336},{id:"Bi204",massNumber:204,exactMass:203.977813,atomicNumber:83,halfLife:40392},{id:"Bi205",massNumber:205,exactMass:204.977389,atomicNumber:83,halfLife:1322780},{id:"Bi206",massNumber:206,exactMass:205.978499,atomicNumber:83,halfLife:539395},{id:"Bi207",massNumber:207,exactMass:206.9784707,atomicNumber:83,halfLife:994961e3},{id:"Bi208",massNumber:208,exactMass:207.9797422,atomicNumber:83},{id:"Bi209",massNumber:209,relativeAbundance:1,atomicNumber:83,exactMass:208.9803987,spin:"9/2-",magneticMoment:"+4.11"},{id:"Bi210",massNumber:210,exactMass:209.9841204,atomicNumber:83,spin:"1-",magneticMoment:"-0.044",halfLife:433123,alphaDecay:"5.04",alphaDecayLikeliness:"100.0",betaminusDecay:"1.16",betaminusDecayLikeliness:"100.0"},{id:"Bi211",massNumber:211,exactMass:210.987269,atomicNumber:83,spin:"9/2-",halfLife:128.4},{id:"Bi212",massNumber:212,exactMass:211.9912857,atomicNumber:83,halfLife:3633},{id:"Bi213",massNumber:213,exactMass:212.994385,atomicNumber:83,halfLife:2735.4},{id:"Bi214",massNumber:214,exactMass:213.998712,atomicNumber:83,halfLife:1194},{id:"Bi215",massNumber:215,exactMass:215.00177,atomicNumber:83,halfLife:456},{id:"Bi216",massNumber:216,exactMass:216.006306,atomicNumber:83,halfLife:216},{id:"Bi217",massNumber:217,exactMass:217.00947,atomicNumber:83,halfLife:97},{id:"Bi218",massNumber:218,exactMass:218.01432,atomicNumber:83}]},{elementSymbol:"Po",atomicNumber:84,isotopes:[{id:"Po188",massNumber:188,exactMass:187.999422,atomicNumber:84},{id:"Po189",massNumber:189,exactMass:188.998481,atomicNumber:84},{id:"Po190",massNumber:190,exactMass:189.995101,atomicNumber:84},{id:"Po191",massNumber:191,exactMass:190.994574,atomicNumber:84,halfLife:.0155},{id:"Po192",massNumber:192,exactMass:191.991335,atomicNumber:84,halfLife:.0332},{id:"Po193",massNumber:193,exactMass:192.99103,atomicNumber:84,halfLife:.42},{id:"Po194",massNumber:194,exactMass:193.988186,atomicNumber:84,halfLife:.392},{id:"Po195",massNumber:195,exactMass:194.98811,atomicNumber:84,halfLife:4.64},{id:"Po196",massNumber:196,exactMass:195.985535,atomicNumber:84,halfLife:5.8},{id:"Po197",massNumber:197,exactMass:196.98566,atomicNumber:84,halfLife:53.6},{id:"Po198",massNumber:198,exactMass:197.983389,atomicNumber:84,halfLife:106.2},{id:"Po199",massNumber:199,exactMass:198.983666,atomicNumber:84,halfLife:328.8},{id:"Po200",massNumber:200,exactMass:199.981799,atomicNumber:84,halfLife:690},{id:"Po201",massNumber:201,exactMass:200.98226,atomicNumber:84,halfLife:918},{id:"Po202",massNumber:202,exactMass:201.980758,atomicNumber:84,halfLife:2682},{id:"Po203",massNumber:203,exactMass:202.98142,atomicNumber:84,halfLife:2202},{id:"Po204",massNumber:204,exactMass:203.980318,atomicNumber:84,halfLife:12708},{id:"Po205",massNumber:205,exactMass:204.981203,atomicNumber:84,halfLife:5976},{id:"Po206",massNumber:206,exactMass:205.980481,atomicNumber:84,halfLife:760320},{id:"Po207",massNumber:207,exactMass:206.981593,atomicNumber:84,halfLife:20880},{id:"Po208",massNumber:208,exactMass:207.9812457,atomicNumber:84,halfLife:91391300},{id:"Po209",massNumber:209,exactMass:208.9824304,atomicNumber:84,magneticMoment:"+0.77",halfLife:321667e4,alphaDecay:"4.976",alphaDecayLikeliness:"99.74",ecDecay:"",ecDecayLikeliness:"0.26"},{id:"Po210",massNumber:210,exactMass:209.9828737,atomicNumber:84,spin:"0+",halfLife:11955700,alphaDecay:"5.407",alphaDecayLikeliness:"100.0"},{id:"Po211",massNumber:211,exactMass:210.9866532,atomicNumber:84,spin:"9/2+",halfLife:.516,alphaDecay:"7.594",alphaDecayLikeliness:"100.0"},{id:"Po212",massNumber:212,exactMass:211.988868,atomicNumber:84,spin:"0+",halfLife:2.99e-7,alphaDecay:"",alphaDecayLikeliness:"100.0"},{id:"Po213",massNumber:213,exactMass:212.992857,atomicNumber:84,halfLife:42e-7},{id:"Po214",massNumber:214,exactMass:213.9952014,atomicNumber:84,spin:"0+",halfLife:1643e-7},{id:"Po215",massNumber:215,exactMass:214.99942,atomicNumber:84,spin:"9/2+",halfLife:.001781,alphaDecay:"",alphaDecayLikeliness:"99.9998",betaminusDecay:"",betaminusDecayLikeliness:"0.0002"},{id:"Po216",massNumber:216,exactMass:216.001915,atomicNumber:84,halfLife:.145,alphaDecay:"6.906",alphaDecayLikeliness:"100.0"},{id:"Po217",massNumber:217,exactMass:217.006335,atomicNumber:84,halfLife:10},{id:"Po218",massNumber:218,exactMass:218.008973,atomicNumber:84,halfLife:186,alphaDecay:"6.114",alphaDecayLikeliness:"99.98",betaminusDecay:"",betaminusDecayLikeliness:"0.02"},{id:"Po219",massNumber:219,exactMass:219.01374,atomicNumber:84},{id:"Po220",massNumber:220,exactMass:220.0166,atomicNumber:84}]},{elementSymbol:"At",atomicNumber:85,isotopes:[{id:"At193",massNumber:193,exactMass:192.99984,atomicNumber:85,halfLife:.04},{id:"At194",massNumber:194,exactMass:193.99873,atomicNumber:85,halfLife:.04},{id:"At195",massNumber:195,exactMass:194.996268,atomicNumber:85,halfLife:.63},{id:"At196",massNumber:196,exactMass:195.99579,atomicNumber:85,halfLife:.253},{id:"At197",massNumber:197,exactMass:196.99319,atomicNumber:85,halfLife:.35},{id:"At198",massNumber:198,exactMass:197.99284,atomicNumber:85,halfLife:4.2},{id:"At199",massNumber:199,exactMass:198.99053,atomicNumber:85,halfLife:7.2},{id:"At200",massNumber:200,exactMass:199.990351,atomicNumber:85,halfLife:43},{id:"At201",massNumber:201,exactMass:200.988417,atomicNumber:85,halfLife:89},{id:"At202",massNumber:202,exactMass:201.98863,atomicNumber:85,halfLife:184},{id:"At203",massNumber:203,exactMass:202.986942,atomicNumber:85,halfLife:444},{id:"At204",massNumber:204,exactMass:203.987251,atomicNumber:85,halfLife:552},{id:"At205",massNumber:205,exactMass:204.986074,atomicNumber:85,halfLife:1572},{id:"At206",massNumber:206,exactMass:205.986667,atomicNumber:85,halfLife:1800},{id:"At207",massNumber:207,exactMass:206.985784,atomicNumber:85,halfLife:6480},{id:"At208",massNumber:208,exactMass:207.98659,atomicNumber:85,halfLife:5868},{id:"At209",massNumber:209,exactMass:208.986173,atomicNumber:85,spin:"9/2+",halfLife:19476},{id:"At210",massNumber:210,exactMass:209.987148,atomicNumber:85,spin:"5+",halfLife:29160,alphaDecay:"5.63",alphaDecayLikeliness:"0.18",ecDecay:"3.98",ecDecayLikeliness:"99.82"},{id:"At211",massNumber:211,exactMass:210.9874963,atomicNumber:85,spin:"9/2-",halfLife:25970.4,alphaDecay:"5.981",alphaDecayLikeliness:"41.7",ecDecay:"0.784",ecDecayLikeliness:"58.3"},{id:"At212",massNumber:212,exactMass:211.990745,atomicNumber:85,halfLife:.314},{id:"At213",massNumber:213,exactMass:212.992937,atomicNumber:85,halfLife:1.25e-7},{id:"At214",massNumber:214,exactMass:213.996372,atomicNumber:85,halfLife:5.58e-7},{id:"At215",massNumber:215,exactMass:214.998653,atomicNumber:85,halfLife:1e-4,alphaDecay:"",alphaDecayLikeliness:"100.0"},{id:"At216",massNumber:216,exactMass:216.002423,atomicNumber:85,halfLife:3e-4,alphaDecay:"",alphaDecayLikeliness:"100"},{id:"At217",massNumber:217,exactMass:217.004719,atomicNumber:85,halfLife:.0323},{id:"At218",massNumber:218,exactMass:218.008694,atomicNumber:85,halfLife:1.5,alphaDecay:"",alphaDecayLikeliness:"99.99",betaminusDecay:"",betaminusDecayLikeliness:"0.01"},{id:"At219",massNumber:219,exactMass:219.011162,atomicNumber:85,halfLife:56,alphaDecay:"",alphaDecayLikeliness:"99.9",betaminusDecay:"",betaminusDecayLikeliness:"0.1"},{id:"At220",massNumber:220,exactMass:220.01541,atomicNumber:85,halfLife:222.6},{id:"At221",massNumber:221,exactMass:221.01805,atomicNumber:85,halfLife:138},{id:"At222",massNumber:222,exactMass:222.02233,atomicNumber:85,halfLife:54},{id:"At223",massNumber:223,exactMass:223.02519,atomicNumber:85,halfLife:50}]},{elementSymbol:"Rn",atomicNumber:86,isotopes:[{id:"Rn195",massNumber:195,exactMass:195.00544,atomicNumber:86},{id:"Rn196",massNumber:196,exactMass:196.002115,atomicNumber:86,halfLife:.003},{id:"Rn197",massNumber:197,exactMass:197.00158,atomicNumber:86,halfLife:.065},{id:"Rn198",massNumber:198,exactMass:197.998679,atomicNumber:86,halfLife:.064},{id:"Rn199",massNumber:199,exactMass:198.99837,atomicNumber:86,halfLife:.62},{id:"Rn200",massNumber:200,exactMass:199.995699,atomicNumber:86,halfLife:.96},{id:"Rn201",massNumber:201,exactMass:200.99563,atomicNumber:86,halfLife:7},{id:"Rn202",massNumber:202,exactMass:201.993263,atomicNumber:86,halfLife:10},{id:"Rn203",massNumber:203,exactMass:202.993387,atomicNumber:86,halfLife:45},{id:"Rn204",massNumber:204,exactMass:203.991429,atomicNumber:86,halfLife:74.4},{id:"Rn205",massNumber:205,exactMass:204.99172,atomicNumber:86,halfLife:168},{id:"Rn206",massNumber:206,exactMass:205.990214,atomicNumber:86,halfLife:340.2},{id:"Rn207",massNumber:207,exactMass:206.990734,atomicNumber:86,halfLife:555},{id:"Rn208",massNumber:208,exactMass:207.989642,atomicNumber:86,halfLife:1461},{id:"Rn209",massNumber:209,exactMass:208.990415,atomicNumber:86,halfLife:1710},{id:"Rn210",massNumber:210,exactMass:209.989696,atomicNumber:86,halfLife:8640},{id:"Rn211",massNumber:211,exactMass:210.990601,atomicNumber:86,halfLife:52560},{id:"Rn212",massNumber:212,exactMass:211.990704,atomicNumber:86,halfLife:1434},{id:"Rn213",massNumber:213,exactMass:212.993883,atomicNumber:86,halfLife:.025},{id:"Rn214",massNumber:214,exactMass:213.995363,atomicNumber:86,halfLife:2.7e-7},{id:"Rn215",massNumber:215,exactMass:214.998745,atomicNumber:86,halfLife:23e-7},{id:"Rn216",massNumber:216,exactMass:216.000274,atomicNumber:86,halfLife:45e-6},{id:"Rn217",massNumber:217,exactMass:217.003928,atomicNumber:86,halfLife:54e-5},{id:"Rn218",massNumber:218,exactMass:218.0056013,atomicNumber:86,halfLife:.035},{id:"Rn219",massNumber:219,exactMass:219.0094802,atomicNumber:86,halfLife:3.96},{id:"Rn220",massNumber:220,exactMass:220.011394,atomicNumber:86,spin:"0+",halfLife:55.6},{id:"Rn221",massNumber:221,exactMass:221.015537,atomicNumber:86,halfLife:1500},{id:"Rn222",massNumber:222,exactMass:222.0175777,atomicNumber:86,spin:"0+",halfLife:330350},{id:"Rn223",massNumber:223,exactMass:223.02179,atomicNumber:86,halfLife:1392},{id:"Rn224",massNumber:224,exactMass:224.02409,atomicNumber:86,halfLife:6420},{id:"Rn225",massNumber:225,exactMass:225.02844,atomicNumber:86,halfLife:270},{id:"Rn226",massNumber:226,exactMass:226.03089,atomicNumber:86,halfLife:444},{id:"Rn227",massNumber:227,exactMass:227.03541,atomicNumber:86,halfLife:22.5},{id:"Rn228",massNumber:228,exactMass:228.03799,atomicNumber:86,halfLife:65}]},{elementSymbol:"Fr",atomicNumber:87,isotopes:[{id:"Fr199",massNumber:199,exactMass:199.00726,atomicNumber:87},{id:"Fr200",massNumber:200,exactMass:200.00657,atomicNumber:87,halfLife:.019},{id:"Fr201",massNumber:201,exactMass:201.00386,atomicNumber:87,halfLife:.048},{id:"Fr202",massNumber:202,exactMass:202.00337,atomicNumber:87,halfLife:.34},{id:"Fr203",massNumber:203,exactMass:203.000925,atomicNumber:87,halfLife:.55},{id:"Fr204",massNumber:204,exactMass:204.000653,atomicNumber:87,halfLife:1.7},{id:"Fr205",massNumber:205,exactMass:204.998594,atomicNumber:87,halfLife:3.85},{id:"Fr206",massNumber:206,exactMass:205.99867,atomicNumber:87,halfLife:15.9},{id:"Fr207",massNumber:207,exactMass:206.99695,atomicNumber:87,halfLife:14.8},{id:"Fr208",massNumber:208,exactMass:207.99714,atomicNumber:87,halfLife:59.1},{id:"Fr209",massNumber:209,exactMass:208.995954,atomicNumber:87,halfLife:50},{id:"Fr210",massNumber:210,exactMass:209.996408,atomicNumber:87,halfLife:190.8},{id:"Fr211",massNumber:211,exactMass:210.995537,atomicNumber:87,halfLife:186},{id:"Fr212",massNumber:212,exactMass:211.996202,atomicNumber:87,halfLife:1200},{id:"Fr213",massNumber:213,exactMass:212.996189,atomicNumber:87,halfLife:34.6},{id:"Fr214",massNumber:214,exactMass:213.998971,atomicNumber:87,halfLife:.005},{id:"Fr215",massNumber:215,exactMass:215.000341,atomicNumber:87,halfLife:8.6e-8},{id:"Fr216",massNumber:216,exactMass:216.003198,atomicNumber:87,halfLife:7e-7},{id:"Fr217",massNumber:217,exactMass:217.004632,atomicNumber:87,halfLife:22e-6},{id:"Fr218",massNumber:218,exactMass:218.007578,atomicNumber:87,halfLife:-1},{id:"Fr219",massNumber:219,exactMass:219.009252,atomicNumber:87,halfLife:.02},{id:"Fr220",massNumber:220,exactMass:220.012327,atomicNumber:87,halfLife:27.4},{id:"Fr221",massNumber:221,exactMass:221.014255,atomicNumber:87,halfLife:294},{id:"Fr222",massNumber:222,exactMass:222.017552,atomicNumber:87,halfLife:852},{id:"Fr223",massNumber:223,exactMass:223.0197359,atomicNumber:87,spin:"3/2+",halfLife:1308},{id:"Fr224",massNumber:224,exactMass:224.02325,atomicNumber:87,halfLife:199.8},{id:"Fr225",massNumber:225,exactMass:225.02557,atomicNumber:87,halfLife:240},{id:"Fr226",massNumber:226,exactMass:226.02939,atomicNumber:87,halfLife:49},{id:"Fr227",massNumber:227,exactMass:227.03184,atomicNumber:87,halfLife:148.2},{id:"Fr228",massNumber:228,exactMass:228.03573,atomicNumber:87,halfLife:38},{id:"Fr229",massNumber:229,exactMass:229.03845,atomicNumber:87,halfLife:50},{id:"Fr230",massNumber:230,exactMass:230.04251,atomicNumber:87,halfLife:19.1},{id:"Fr231",massNumber:231,exactMass:231.04544,atomicNumber:87,halfLife:17.5},{id:"Fr232",massNumber:232,exactMass:232.04977,atomicNumber:87,halfLife:5}]},{elementSymbol:"Ra",atomicNumber:88,isotopes:[{id:"Ra202",massNumber:202,exactMass:202.00989,atomicNumber:88,halfLife:7e-4},{id:"Ra203",massNumber:203,exactMass:203.00927,atomicNumber:88,halfLife:-1},{id:"Ra204",massNumber:204,exactMass:204.0065,atomicNumber:88,halfLife:.059},{id:"Ra205",massNumber:205,exactMass:205.00627,atomicNumber:88,halfLife:.21},{id:"Ra206",massNumber:206,exactMass:206.003827,atomicNumber:88,halfLife:.24},{id:"Ra207",massNumber:207,exactMass:207.0038,atomicNumber:88,halfLife:1.3},{id:"Ra208",massNumber:208,exactMass:208.00184,atomicNumber:88,halfLife:1.3},{id:"Ra209",massNumber:209,exactMass:209.00199,atomicNumber:88,halfLife:4.6},{id:"Ra210",massNumber:210,exactMass:210.000495,atomicNumber:88,halfLife:3.7},{id:"Ra211",massNumber:211,exactMass:211.000898,atomicNumber:88,halfLife:13},{id:"Ra212",massNumber:212,exactMass:211.999794,atomicNumber:88,halfLife:13},{id:"Ra213",massNumber:213,exactMass:213.000384,atomicNumber:88,halfLife:164.4},{id:"Ra214",massNumber:214,exactMass:214.000108,atomicNumber:88,halfLife:2.46},{id:"Ra215",massNumber:215,exactMass:215.00272,atomicNumber:88,halfLife:.00159},{id:"Ra216",massNumber:216,exactMass:216.003533,atomicNumber:88,halfLife:1.82e-7},{id:"Ra217",massNumber:217,exactMass:217.00632,atomicNumber:88,halfLife:16e-7},{id:"Ra218",massNumber:218,exactMass:218.00714,atomicNumber:88,halfLife:256e-7},{id:"Ra219",massNumber:219,exactMass:219.010085,atomicNumber:88,halfLife:.01},{id:"Ra220",massNumber:220,exactMass:220.011028,atomicNumber:88,halfLife:.018},{id:"Ra221",massNumber:221,exactMass:221.013917,atomicNumber:88,halfLife:28},{id:"Ra222",massNumber:222,exactMass:222.015375,atomicNumber:88,halfLife:38},{id:"Ra223",massNumber:223,exactMass:223.0185022,atomicNumber:88,spin:"1/2+",halfLife:987984},{id:"Ra224",massNumber:224,exactMass:224.0202118,atomicNumber:88,spin:"0+",halfLife:316224},{id:"Ra225",massNumber:225,exactMass:225.023612,atomicNumber:88,halfLife:1287360},{id:"Ra226",massNumber:226,exactMass:226.0254098,atomicNumber:88,spin:"0+",halfLife:504576e5},{id:"Ra227",massNumber:227,exactMass:227.0291778,atomicNumber:88,halfLife:2532},{id:"Ra228",massNumber:228,exactMass:228.0310703,atomicNumber:88,spin:"0+",halfLife:181332e3},{id:"Ra229",massNumber:229,exactMass:229.034958,atomicNumber:88,halfLife:240},{id:"Ra230",massNumber:230,exactMass:230.037056,atomicNumber:88,halfLife:5580},{id:"Ra231",massNumber:231,exactMass:231.04122,atomicNumber:88,halfLife:103},{id:"Ra232",massNumber:232,exactMass:232.04364,atomicNumber:88,halfLife:250},{id:"Ra233",massNumber:233,exactMass:233.04806,atomicNumber:88,halfLife:30},{id:"Ra234",massNumber:234,exactMass:234.0507,atomicNumber:88,halfLife:30}]},{elementSymbol:"Ac",atomicNumber:89,isotopes:[{id:"Ac206",massNumber:206,exactMass:206.0145,atomicNumber:89,halfLife:.022},{id:"Ac207",massNumber:207,exactMass:207.01195,atomicNumber:89,halfLife:.022},{id:"Ac208",massNumber:208,exactMass:208.01155,atomicNumber:89,halfLife:.095},{id:"Ac209",massNumber:209,exactMass:209.00949,atomicNumber:89,halfLife:.1},{id:"Ac210",massNumber:210,exactMass:210.00944,atomicNumber:89,halfLife:.35},{id:"Ac211",massNumber:211,exactMass:211.00773,atomicNumber:89,halfLife:.25},{id:"Ac212",massNumber:212,exactMass:212.00781,atomicNumber:89,halfLife:.93},{id:"Ac213",massNumber:213,exactMass:213.00661,atomicNumber:89,halfLife:.8},{id:"Ac214",massNumber:214,exactMass:214.006902,atomicNumber:89,halfLife:8.2},{id:"Ac215",massNumber:215,exactMass:215.006454,atomicNumber:89,halfLife:.17},{id:"Ac216",massNumber:216,exactMass:216.00872,atomicNumber:89,halfLife:33e-5},{id:"Ac217",massNumber:217,exactMass:217.009347,atomicNumber:89,halfLife:6.9e-8},{id:"Ac218",massNumber:218,exactMass:218.01164,atomicNumber:89,halfLife:108e-8},{id:"Ac219",massNumber:219,exactMass:219.01242,atomicNumber:89,halfLife:118e-7},{id:"Ac220",massNumber:220,exactMass:220.014763,atomicNumber:89,halfLife:.0264},{id:"Ac221",massNumber:221,exactMass:221.01559,atomicNumber:89,halfLife:.052},{id:"Ac222",massNumber:222,exactMass:222.017844,atomicNumber:89,halfLife:5},{id:"Ac223",massNumber:223,exactMass:223.019137,atomicNumber:89,halfLife:126},{id:"Ac224",massNumber:224,exactMass:224.021723,atomicNumber:89,halfLife:10008},{id:"Ac225",massNumber:225,exactMass:225.02323,atomicNumber:89,halfLife:864e3},{id:"Ac226",massNumber:226,exactMass:226.026098,atomicNumber:89,halfLife:105732},{id:"Ac227",massNumber:227,exactMass:227.0277521,atomicNumber:89,spin:"3/2+",halfLife:686633e3},{id:"Ac228",massNumber:228,exactMass:228.0310211,atomicNumber:89,halfLife:22140},{id:"Ac229",massNumber:229,exactMass:229.03302,atomicNumber:89,halfLife:3762},{id:"Ac230",massNumber:230,exactMass:230.03629,atomicNumber:89,halfLife:122},{id:"Ac231",massNumber:231,exactMass:231.03856,atomicNumber:89,halfLife:450},{id:"Ac232",massNumber:232,exactMass:232.04203,atomicNumber:89,halfLife:119},{id:"Ac233",massNumber:233,exactMass:233.04455,atomicNumber:89,halfLife:145},{id:"Ac234",massNumber:234,exactMass:234.04842,atomicNumber:89,halfLife:44},{id:"Ac235",massNumber:235,exactMass:235.05123,atomicNumber:89},{id:"Ac236",massNumber:236,exactMass:236.0553,atomicNumber:89}]},{elementSymbol:"Th",atomicNumber:90,isotopes:[{id:"Th209",massNumber:209,exactMass:209.01772,atomicNumber:90},{id:"Th210",massNumber:210,exactMass:210.015075,atomicNumber:90,halfLife:.009},{id:"Th211",massNumber:211,exactMass:211.01493,atomicNumber:90,halfLife:.037},{id:"Th212",massNumber:212,exactMass:212.01298,atomicNumber:90,halfLife:.03},{id:"Th213",massNumber:213,exactMass:213.01301,atomicNumber:90,halfLife:.14},{id:"Th214",massNumber:214,exactMass:214.0115,atomicNumber:90,halfLife:.1},{id:"Th215",massNumber:215,exactMass:215.01173,atomicNumber:90,halfLife:1.2},{id:"Th216",massNumber:216,exactMass:216.011062,atomicNumber:90,halfLife:.028},{id:"Th217",massNumber:217,exactMass:217.013114,atomicNumber:90,halfLife:252e-6},{id:"Th218",massNumber:218,exactMass:218.013284,atomicNumber:90,halfLife:1.09e-7},{id:"Th219",massNumber:219,exactMass:219.01554,atomicNumber:90,halfLife:105e-8},{id:"Th220",massNumber:220,exactMass:220.015748,atomicNumber:90,halfLife:97e-7},{id:"Th221",massNumber:221,exactMass:221.018184,atomicNumber:90,halfLife:.00168},{id:"Th222",massNumber:222,exactMass:222.018468,atomicNumber:90,halfLife:.0028},{id:"Th223",massNumber:223,exactMass:223.020811,atomicNumber:90,halfLife:.6},{id:"Th224",massNumber:224,exactMass:224.021467,atomicNumber:90,halfLife:1.05},{id:"Th225",massNumber:225,exactMass:225.023951,atomicNumber:90,halfLife:523.2},{id:"Th226",massNumber:226,exactMass:226.024903,atomicNumber:90,halfLife:1834.2},{id:"Th227",massNumber:227,exactMass:227.0277041,atomicNumber:90,spin:"3/2+",halfLife:1617410,alphaDecay:"6.145",alphaDecayLikeliness:"100.0"},{id:"Th228",massNumber:228,exactMass:228.0287411,atomicNumber:90,spin:"0+",halfLife:60284200,alphaDecay:"5.52",alphaDecayLikeliness:"100.0"},{id:"Th229",massNumber:229,exactMass:229.031762,atomicNumber:90,magneticMoment:"+0.46",halfLife:231474e6,alphaDecay:"5.17",alphaDecayLikeliness:"100.0"},{id:"Th230",massNumber:230,exactMass:230.0331338,atomicNumber:90,spin:"0+",halfLife:75380,alphaDecay:"4.77",alphaDecayLikeliness:"100.0"},{id:"Th231",massNumber:231,exactMass:231.0363043,atomicNumber:90,spin:"5/2+",halfLife:91872,betaminusDecay:"0.389",betaminusDecayLikeliness:"100.0"},{id:"Th232",massNumber:232,relativeAbundance:1,atomicNumber:90,exactMass:232.0380553,spin:"0+",halfLife:14e9,alphaDecay:"4.081",alphaDecayLikeliness:"100.0"},{id:"Th233",massNumber:233,exactMass:233.0415818,atomicNumber:90,halfLife:1338},{id:"Th234",massNumber:234,exactMass:234.043601,atomicNumber:90,spin:"0+",halfLife:2082240,betaminusDecay:"0.27",betaminusDecayLikeliness:"100.0"},{id:"Th235",massNumber:235,exactMass:235.04751,atomicNumber:90,halfLife:426},{id:"Th236",massNumber:236,exactMass:236.04987,atomicNumber:90,halfLife:2250},{id:"Th237",massNumber:237,exactMass:237.05389,atomicNumber:90,halfLife:300},{id:"Th238",massNumber:238,exactMass:238.0565,atomicNumber:90}]},{elementSymbol:"Pa",atomicNumber:91,isotopes:[{id:"Pa212",massNumber:212,exactMass:212.0232,atomicNumber:91,halfLife:.0051},{id:"Pa213",massNumber:213,exactMass:213.02111,atomicNumber:91,halfLife:.0053},{id:"Pa214",massNumber:214,exactMass:214.02092,atomicNumber:91,halfLife:.017},{id:"Pa215",massNumber:215,exactMass:215.01919,atomicNumber:91,halfLife:.014},{id:"Pa216",massNumber:216,exactMass:216.01911,atomicNumber:91,halfLife:.2},{id:"Pa217",massNumber:217,exactMass:217.01832,atomicNumber:91,halfLife:.0049},{id:"Pa218",massNumber:218,exactMass:218.020042,atomicNumber:91,halfLife:12e-5},{id:"Pa219",massNumber:219,exactMass:219.01988,atomicNumber:91,halfLife:5.3e-8},{id:"Pa220",massNumber:220,exactMass:220.02188,atomicNumber:91,halfLife:7.8e-7},{id:"Pa221",massNumber:221,exactMass:221.02188,atomicNumber:91,halfLife:59e-7},{id:"Pa222",massNumber:222,exactMass:222.02374,atomicNumber:91,halfLife:.0029},{id:"Pa223",massNumber:223,exactMass:223.02396,atomicNumber:91,halfLife:.0065},{id:"Pa224",massNumber:224,exactMass:224.025626,atomicNumber:91,halfLife:.79},{id:"Pa225",massNumber:225,exactMass:225.02613,atomicNumber:91,halfLife:1.7},{id:"Pa226",massNumber:226,exactMass:226.027948,atomicNumber:91,halfLife:108},{id:"Pa227",massNumber:227,exactMass:227.028805,atomicNumber:91,halfLife:2298},{id:"Pa228",massNumber:228,exactMass:228.031051,atomicNumber:91,halfLife:79200},{id:"Pa229",massNumber:229,exactMass:229.0320968,atomicNumber:91,halfLife:129600},{id:"Pa230",massNumber:230,exactMass:230.034541,atomicNumber:91,halfLife:1503360},{id:"Pa231",massNumber:231,relativeAbundance:1,atomicNumber:91,exactMass:231.035884,spin:"3/2-",magneticMoment:"2.01",halfLife:103312e7,alphaDecay:"5.148",alphaDecayLikeliness:"100.0"},{id:"Pa232",massNumber:232,exactMass:232.038592,atomicNumber:91,magneticMoment:"+3.5",halfLife:113184,betaminusDecay:"1.34",betaminusDecayLikeliness:"100.0"},{id:"Pa233",massNumber:233,exactMass:233.0402473,atomicNumber:91,magneticMoment:"+3.5",halfLife:2329950,betaminusDecay:"0.572",betaminusDecayLikeliness:"100.0"},{id:"Pa234",massNumber:234,exactMass:234.043308,atomicNumber:91,spin:"4+",halfLife:24120},{id:"Pa235",massNumber:235,exactMass:235.04544,atomicNumber:91,halfLife:1470},{id:"Pa236",massNumber:236,exactMass:236.04868,atomicNumber:91,halfLife:546},{id:"Pa237",massNumber:237,exactMass:237.05115,atomicNumber:91,halfLife:522},{id:"Pa238",massNumber:238,exactMass:238.0545,atomicNumber:91,halfLife:138},{id:"Pa239",massNumber:239,exactMass:239.05726,atomicNumber:91},{id:"Pa240",massNumber:240,exactMass:240.06098,atomicNumber:91}]},{elementSymbol:"U",atomicNumber:92,isotopes:[{id:"U217",massNumber:217,exactMass:217.02437,atomicNumber:92},{id:"U218",massNumber:218,exactMass:218.02354,atomicNumber:92,halfLife:.0015},{id:"U219",massNumber:219,exactMass:219.02492,atomicNumber:92,halfLife:42e-6},{id:"U220",massNumber:220,exactMass:220.02472,atomicNumber:92},{id:"U221",massNumber:221,exactMass:221.0264,atomicNumber:92},{id:"U222",massNumber:222,exactMass:222.02609,atomicNumber:92,halfLife:-1},{id:"U223",massNumber:223,exactMass:223.02774,atomicNumber:92,halfLife:18e-6},{id:"U224",massNumber:224,exactMass:224.027605,atomicNumber:92,halfLife:9e-4},{id:"U225",massNumber:225,exactMass:225.029391,atomicNumber:92,halfLife:.095},{id:"U226",massNumber:226,exactMass:226.029339,atomicNumber:92,halfLife:.35},{id:"U227",massNumber:227,exactMass:227.031156,atomicNumber:92,halfLife:66},{id:"U228",massNumber:228,exactMass:228.031374,atomicNumber:92,halfLife:546},{id:"U229",massNumber:229,exactMass:229.033506,atomicNumber:92,halfLife:3480},{id:"U230",massNumber:230,exactMass:230.03394,atomicNumber:92,halfLife:1797120},{id:"U231",massNumber:231,exactMass:231.036294,atomicNumber:92,halfLife:362880},{id:"U232",massNumber:232,exactMass:232.0371562,atomicNumber:92,halfLife:217283e4,alphaDecay:"5.41",alphaDecayLikeliness:"100.0"},{id:"U233",massNumber:233,exactMass:233.0396352,atomicNumber:92,magneticMoment:"+0.55",halfLife:159200,alphaDecay:"4.91",alphaDecayLikeliness:"100.0"},{id:"U234",massNumber:234,relativeAbundance:54999999999999995e-21,atomicNumber:92,exactMass:234.0409521,spin:"0+",halfLife:245e3,alphaDecay:"4.856",alphaDecayLikeliness:"100.0"},{id:"U235",massNumber:235,relativeAbundance:.0072,atomicNumber:92,exactMass:235.0439299,spin:"7/2-",magneticMoment:"-0.35",halfLife:7038e5,alphaDecay:"4.6793",alphaDecayLikeliness:"100.0"},{id:"U236",massNumber:236,exactMass:236.045568,atomicNumber:92,halfLife:23415e3,alphaDecay:"4.569",alphaDecayLikeliness:"100.0"},{id:"U237",massNumber:237,exactMass:237.0487302,atomicNumber:92,halfLife:583200,betaminusDecay:"0.52",betaminusDecayLikeliness:"100.0"},{id:"U238",massNumber:238,relativeAbundance:.992745,atomicNumber:92,exactMass:238.0507882,spin:"0+",halfLife:4468e6,alphaDecay:"4.039",alphaDecayLikeliness:"100.0"},{id:"U239",massNumber:239,exactMass:239.0542933,atomicNumber:92,halfLife:1407},{id:"U240",massNumber:240,exactMass:240.056592,atomicNumber:92,halfLife:50760,betaminusDecay:"0.5",betaminusDecayLikeliness:"100.0"},{id:"U241",massNumber:241,exactMass:241.06033,atomicNumber:92},{id:"U242",massNumber:242,exactMass:242.06293,atomicNumber:92,halfLife:1008}]},{elementSymbol:"Np",atomicNumber:93,isotopes:[{id:"Np225",massNumber:225,exactMass:225.03391,atomicNumber:93,halfLife:.006},{id:"Np226",massNumber:226,exactMass:226.03515,atomicNumber:93,halfLife:.035},{id:"Np227",massNumber:227,exactMass:227.03496,atomicNumber:93,halfLife:.51},{id:"Np228",massNumber:228,exactMass:228.03618,atomicNumber:93,halfLife:61.4},{id:"Np229",massNumber:229,exactMass:229.03626,atomicNumber:93,halfLife:240},{id:"Np230",massNumber:230,exactMass:230.03783,atomicNumber:93,halfLife:276},{id:"Np231",massNumber:231,exactMass:231.03825,atomicNumber:93,halfLife:2928},{id:"Np232",massNumber:232,exactMass:232.04011,atomicNumber:93,halfLife:882},{id:"Np233",massNumber:233,exactMass:233.04074,atomicNumber:93,halfLife:2172},{id:"Np234",massNumber:234,exactMass:234.042895,atomicNumber:93,halfLife:380160},{id:"Np235",massNumber:235,exactMass:235.0440633,atomicNumber:93,halfLife:34223e3},{id:"Np236",massNumber:236,exactMass:236.04657,atomicNumber:93},{id:"Np237",massNumber:237,exactMass:237.0481734,atomicNumber:93,spin:"5/2+",halfLife:214e4,alphaDecay:"4.96",alphaDecayLikeliness:"100.0"},{id:"Np238",massNumber:238,exactMass:238.0509464,atomicNumber:93,halfLife:182909,betaminusDecay:"1.29",betaminusDecayLikeliness:"100.0"},{id:"Np239",massNumber:239,exactMass:239.052939,atomicNumber:93,halfLife:203602,betaminusDecay:"0.72",betaminusDecayLikeliness:"100.0"},{id:"Np240",massNumber:240,exactMass:240.056162,atomicNumber:93,halfLife:3714},{id:"Np241",massNumber:241,exactMass:241.05825,atomicNumber:93,halfLife:834},{id:"Np242",massNumber:242,exactMass:242.06164,atomicNumber:93,halfLife:330},{id:"Np243",massNumber:243,exactMass:243.06428,atomicNumber:93,halfLife:108},{id:"Np244",massNumber:244,exactMass:244.06785,atomicNumber:93,halfLife:137.4}]},{elementSymbol:"Pu",atomicNumber:94,isotopes:[{id:"Pu228",massNumber:228,exactMass:228.03874,atomicNumber:94,halfLife:.004},{id:"Pu229",massNumber:229,exactMass:229.04015,atomicNumber:94},{id:"Pu230",massNumber:230,exactMass:230.03965,atomicNumber:94},{id:"Pu231",massNumber:231,exactMass:231.041101,atomicNumber:94},{id:"Pu232",massNumber:232,exactMass:232.041187,atomicNumber:94,halfLife:2046},{id:"Pu233",massNumber:233,exactMass:233.043,atomicNumber:94,halfLife:1254},{id:"Pu234",massNumber:234,exactMass:234.043317,atomicNumber:94,halfLife:31680},{id:"Pu235",massNumber:235,exactMass:235.045286,atomicNumber:94,halfLife:1518},{id:"Pu236",massNumber:236,exactMass:236.046058,atomicNumber:94,halfLife:90129900,alphaDecay:"5.87",alphaDecayLikeliness:"100.0"},{id:"Pu237",massNumber:237,exactMass:237.0484097,atomicNumber:94,halfLife:3905280,alphaDecay:"",alphaDecayLikeliness:"0.004",ecDecay:"0.22",ecDecayLikeliness:"99.996"},{id:"Pu238",massNumber:238,exactMass:238.0495599,atomicNumber:94,halfLife:276571e4,alphaDecay:"5.59",alphaDecayLikeliness:"100.0"},{id:"Pu239",massNumber:239,exactMass:239.0521634,atomicNumber:94,spin:"1/2+",magneticMoment:"+0.203",halfLife:760333e6,alphaDecay:"5.24",alphaDecayLikeliness:"100.0"},{id:"Pu240",massNumber:240,exactMass:240.0538135,atomicNumber:94,spin:"0+",halfLife:206971e6,alphaDecay:"5.26",alphaDecayLikeliness:"100.0"},{id:"Pu241",massNumber:241,exactMass:241.0568515,atomicNumber:94,magneticMoment:"-0.683",halfLife:452542e3,betaminusDecay:"0.02",betaminusDecayLikeliness:"100.0"},{id:"Pu242",massNumber:242,exactMass:242.0587426,atomicNumber:94,spin:"0+",halfLife:373300,alphaDecay:"4.983",alphaDecayLikeliness:"100.0"},{id:"Pu243",massNumber:243,exactMass:243.062003,atomicNumber:94,halfLife:17841.6},{id:"Pu244",massNumber:244,exactMass:244.064204,atomicNumber:94},{id:"Pu245",massNumber:245,exactMass:245.067747,atomicNumber:94,halfLife:37800},{id:"Pu246",massNumber:246,exactMass:246.070205,atomicNumber:94,halfLife:936576},{id:"Pu247",massNumber:247,exactMass:247.07407,atomicNumber:94,halfLife:196128}]},{elementSymbol:"Am",atomicNumber:95,isotopes:[{id:"Am231",massNumber:231,exactMass:231.04556,atomicNumber:95},{id:"Am232",massNumber:232,exactMass:232.04659,atomicNumber:95,halfLife:79},{id:"Am233",massNumber:233,exactMass:233.04635,atomicNumber:95},{id:"Am234",massNumber:234,exactMass:234.04781,atomicNumber:95,halfLife:139.2},{id:"Am235",massNumber:235,exactMass:235.04795,atomicNumber:95,halfLife:900},{id:"Am236",massNumber:236,exactMass:236.04958,atomicNumber:95},{id:"Am237",massNumber:237,exactMass:237.05,atomicNumber:95,halfLife:4380},{id:"Am238",massNumber:238,exactMass:238.05198,atomicNumber:95,halfLife:5880},{id:"Am239",massNumber:239,exactMass:239.0530245,atomicNumber:95,halfLife:42840},{id:"Am240",massNumber:240,exactMass:240.0553,atomicNumber:95,halfLife:182880},{id:"Am241",massNumber:241,exactMass:241.0568291,atomicNumber:95,spin:"5/2-",magneticMoment:"+1.61",halfLife:136299e5,alphaDecay:"5.637",alphaDecayLikeliness:"100.0"},{id:"Am242",massNumber:242,exactMass:242.0595492,atomicNumber:95,halfLife:57672,betaminusDecay:"0.67",betaminusDecayLikeliness:"82.7",ecDecay:"0.73",ecDecayLikeliness:"17.3"},{id:"Am243",massNumber:243,exactMass:243.0613811,atomicNumber:95,spin:"5/2-",halfLife:23242e7,alphaDecay:"5.439",alphaDecayLikeliness:"100.0"},{id:"Am244",massNumber:244,exactMass:244.0642848,atomicNumber:95,halfLife:36360},{id:"Am245",massNumber:245,exactMass:245.066452,atomicNumber:95,halfLife:7380},{id:"Am246",massNumber:246,exactMass:246.069775,atomicNumber:95,halfLife:2340},{id:"Am247",massNumber:247,exactMass:247.07209,atomicNumber:95,halfLife:1380},{id:"Am248",massNumber:248,exactMass:248.07575,atomicNumber:95},{id:"Am249",massNumber:249,exactMass:249.07848,atomicNumber:95}]},{elementSymbol:"Cm",atomicNumber:96,isotopes:[{id:"Cm233",massNumber:233,exactMass:233.05077,atomicNumber:96},{id:"Cm234",massNumber:234,exactMass:234.05016,atomicNumber:96},{id:"Cm235",massNumber:235,exactMass:235.05143,atomicNumber:96},{id:"Cm236",massNumber:236,exactMass:236.05141,atomicNumber:96},{id:"Cm237",massNumber:237,exactMass:237.0529,atomicNumber:96},{id:"Cm238",massNumber:238,exactMass:238.05303,atomicNumber:96,halfLife:8640},{id:"Cm239",massNumber:239,exactMass:239.05496,atomicNumber:96,halfLife:10440},{id:"Cm240",massNumber:240,exactMass:240.0555295,atomicNumber:96,halfLife:2332800},{id:"Cm241",massNumber:241,exactMass:241.057653,atomicNumber:96,halfLife:2833920},{id:"Cm242",massNumber:242,exactMass:242.0588358,atomicNumber:96,halfLife:14065900},{id:"Cm243",massNumber:243,exactMass:243.0613891,atomicNumber:96,halfLife:917698e3},{id:"Cm244",massNumber:244,exactMass:244.0627526,atomicNumber:96,halfLife:570802e3},{id:"Cm245",massNumber:245,exactMass:245.0654912,atomicNumber:96,spin:"7/2+",halfLife:268056e6},{id:"Cm246",massNumber:246,exactMass:246.0672237,atomicNumber:96,spin:"0+",halfLife:149165e6},{id:"Cm247",massNumber:247,exactMass:247.070354,atomicNumber:96},{id:"Cm248",massNumber:248,exactMass:248.072349,atomicNumber:96,spin:"0+"},{id:"Cm249",massNumber:249,exactMass:249.075953,atomicNumber:96,halfLife:3849},{id:"Cm250",massNumber:250,exactMass:250.078357,atomicNumber:96,halfLife:283824e6},{id:"Cm251",massNumber:251,exactMass:251.082285,atomicNumber:96,halfLife:1008},{id:"Cm252",massNumber:252,exactMass:252.08487,atomicNumber:96}]},{elementSymbol:"Bk",atomicNumber:97,isotopes:[{id:"Bk235",massNumber:235,exactMass:235.05658,atomicNumber:97},{id:"Bk236",massNumber:236,exactMass:236.05733,atomicNumber:97},{id:"Bk237",massNumber:237,exactMass:237.057,atomicNumber:97},{id:"Bk238",massNumber:238,exactMass:238.05828,atomicNumber:97,halfLife:144},{id:"Bk239",massNumber:239,exactMass:239.05828,atomicNumber:97},{id:"Bk240",massNumber:240,exactMass:240.05976,atomicNumber:97,halfLife:288},{id:"Bk241",massNumber:241,exactMass:241.06023,atomicNumber:97},{id:"Bk242",massNumber:242,exactMass:242.06198,atomicNumber:97,halfLife:420},{id:"Bk243",massNumber:243,exactMass:243.063008,atomicNumber:97,halfLife:16200},{id:"Bk244",massNumber:244,exactMass:244.065181,atomicNumber:97,halfLife:15660},{id:"Bk245",massNumber:245,exactMass:245.0663616,atomicNumber:97,halfLife:426816},{id:"Bk246",massNumber:246,exactMass:246.06867,atomicNumber:97,halfLife:155520},{id:"Bk247",massNumber:247,exactMass:247.070307,atomicNumber:97,halfLife:435197e5},{id:"Bk248",massNumber:248,exactMass:248.07309,atomicNumber:97,halfLife:283824e3},{id:"Bk249",massNumber:249,exactMass:249.0749867,atomicNumber:97,spin:"7/2+",halfLife:27648e3},{id:"Bk250",massNumber:250,exactMass:250.078317,atomicNumber:97,halfLife:11581.2},{id:"Bk251",massNumber:251,exactMass:251.08076,atomicNumber:97,halfLife:3336},{id:"Bk252",massNumber:252,exactMass:252.08431,atomicNumber:97},{id:"Bk253",massNumber:253,exactMass:253.08688,atomicNumber:97},{id:"Bk254",massNumber:254,exactMass:254.0906,atomicNumber:97}]},{elementSymbol:"Cf",atomicNumber:98,isotopes:[{id:"Cf237",massNumber:237,exactMass:237.06207,atomicNumber:98,halfLife:2.1},{id:"Cf238",massNumber:238,exactMass:238.06141,atomicNumber:98,halfLife:.021},{id:"Cf239",massNumber:239,exactMass:239.06242,atomicNumber:98,halfLife:39},{id:"Cf240",massNumber:240,exactMass:240.0623,atomicNumber:98,halfLife:63.6},{id:"Cf241",massNumber:241,exactMass:241.06373,atomicNumber:98,halfLife:226.8},{id:"Cf242",massNumber:242,exactMass:242.0637,atomicNumber:98,halfLife:209.4},{id:"Cf243",massNumber:243,exactMass:243.06543,atomicNumber:98,halfLife:642},{id:"Cf244",massNumber:244,exactMass:244.066001,atomicNumber:98,halfLife:1164},{id:"Cf245",massNumber:245,exactMass:245.068049,atomicNumber:98,halfLife:2700},{id:"Cf246",massNumber:246,exactMass:246.0688053,atomicNumber:98,halfLife:128520},{id:"Cf247",massNumber:247,exactMass:247.071001,atomicNumber:98,halfLife:11196},{id:"Cf248",massNumber:248,exactMass:248.072185,atomicNumber:98,halfLife:28814400},{id:"Cf249",massNumber:249,exactMass:249.0748535,atomicNumber:98,spin:"9/2-",halfLife:110691e5},{id:"Cf250",massNumber:250,exactMass:250.0764061,atomicNumber:98,spin:"0+",halfLife:412491e3},{id:"Cf251",massNumber:251,exactMass:251.079587,atomicNumber:98,spin:"1/2+",halfLife:283193e5},{id:"Cf252",massNumber:252,exactMass:252.081626,atomicNumber:98,spin:"0+",halfLife:83412700},{id:"Cf253",massNumber:253,exactMass:253.085133,atomicNumber:98,halfLife:1538780},{id:"Cf254",massNumber:254,exactMass:254.087323,atomicNumber:98,halfLife:5227200},{id:"Cf255",massNumber:255,exactMass:255.09105,atomicNumber:98,halfLife:5100},{id:"Cf256",massNumber:256,exactMass:256.09344,atomicNumber:98,halfLife:738}]},{elementSymbol:"Es",atomicNumber:99,isotopes:[{id:"Es240",massNumber:240,exactMass:240.06892,atomicNumber:99},{id:"Es241",massNumber:241,exactMass:241.06854,atomicNumber:99,halfLife:9},{id:"Es242",massNumber:242,exactMass:242.06975,atomicNumber:99,halfLife:40},{id:"Es243",massNumber:243,exactMass:243.06955,atomicNumber:99,halfLife:21},{id:"Es244",massNumber:244,exactMass:244.07088,atomicNumber:99,halfLife:37},{id:"Es245",massNumber:245,exactMass:245.07132,atomicNumber:99,halfLife:66},{id:"Es246",massNumber:246,exactMass:246.0729,atomicNumber:99,halfLife:462},{id:"Es247",massNumber:247,exactMass:247.07366,atomicNumber:99,halfLife:273},{id:"Es248",massNumber:248,exactMass:248.07547,atomicNumber:99,halfLife:1620},{id:"Es249",massNumber:249,exactMass:249.07641,atomicNumber:99,halfLife:6132},{id:"Es250",massNumber:250,exactMass:250.07861,atomicNumber:99,halfLife:30960},{id:"Es251",massNumber:251,exactMass:251.079992,atomicNumber:99,halfLife:118800},{id:"Es252",massNumber:252,exactMass:252.08298,atomicNumber:99,halfLife:40754900},{id:"Es253",massNumber:253,exactMass:253.0848247,atomicNumber:99,spin:"7/2+",halfLife:1768610},{id:"Es254",massNumber:254,exactMass:254.088022,atomicNumber:99,halfLife:23820500},{id:"Es255",massNumber:255,exactMass:255.090273,atomicNumber:99,halfLife:3438720},{id:"Es256",massNumber:256,exactMass:256.0936,atomicNumber:99,halfLife:1524},{id:"Es257",massNumber:257,exactMass:257.09598,atomicNumber:99},{id:"Es258",massNumber:258,exactMass:258.09952,atomicNumber:99}]},{elementSymbol:"Fm",atomicNumber:100,isotopes:[{id:"Fm242",massNumber:242,exactMass:242.07343,atomicNumber:100,halfLife:8e-4},{id:"Fm243",massNumber:243,exactMass:243.07435,atomicNumber:100,halfLife:.18},{id:"Fm244",massNumber:244,exactMass:244.07408,atomicNumber:100,halfLife:.0033},{id:"Fm245",massNumber:245,exactMass:245.07539,atomicNumber:100,halfLife:4.2},{id:"Fm246",massNumber:246,exactMass:246.0753,atomicNumber:100,halfLife:1.1},{id:"Fm247",massNumber:247,exactMass:247.07685,atomicNumber:100,halfLife:35},{id:"Fm248",massNumber:248,exactMass:248.077195,atomicNumber:100,halfLife:36},{id:"Fm249",massNumber:249,exactMass:249.07903,atomicNumber:100,halfLife:156},{id:"Fm250",massNumber:250,exactMass:250.079521,atomicNumber:100,halfLife:1800},{id:"Fm251",massNumber:251,exactMass:251.081575,atomicNumber:100,halfLife:19080},{id:"Fm252",massNumber:252,exactMass:252.082467,atomicNumber:100,spin:"0+",halfLife:91404},{id:"Fm253",massNumber:253,exactMass:253.085185,atomicNumber:100,halfLife:259200},{id:"Fm254",massNumber:254,exactMass:254.0868542,atomicNumber:100,halfLife:11664},{id:"Fm255",massNumber:255,exactMass:255.089962,atomicNumber:100,halfLife:72252},{id:"Fm256",massNumber:256,exactMass:256.091773,atomicNumber:100,halfLife:9456},{id:"Fm257",massNumber:257,exactMass:257.095105,atomicNumber:100,halfLife:8683200},{id:"Fm258",massNumber:258,exactMass:258.09708,atomicNumber:100,halfLife:37e-5},{id:"Fm259",massNumber:259,exactMass:259.1006,atomicNumber:100,halfLife:1.5},{id:"Fm260",massNumber:260,exactMass:260.10268,atomicNumber:100}]},{elementSymbol:"Md",atomicNumber:101,isotopes:[{id:"Md245",massNumber:245,exactMass:245.08083,atomicNumber:101,halfLife:.35},{id:"Md246",massNumber:246,exactMass:246.08189,atomicNumber:101,halfLife:-1},{id:"Md247",massNumber:247,exactMass:247.08164,atomicNumber:101,halfLife:1.12},{id:"Md248",massNumber:248,exactMass:248.08282,atomicNumber:101,halfLife:7},{id:"Md249",massNumber:249,exactMass:249.08301,atomicNumber:101,halfLife:24},{id:"Md250",massNumber:250,exactMass:250.08442,atomicNumber:101,halfLife:52},{id:"Md251",massNumber:251,exactMass:251.08484,atomicNumber:101,halfLife:240},{id:"Md252",massNumber:252,exactMass:252.08656,atomicNumber:101,halfLife:138},{id:"Md253",massNumber:253,exactMass:253.08728,atomicNumber:101,halfLife:360},{id:"Md254",massNumber:254,exactMass:254.08966,atomicNumber:101,halfLife:600},{id:"Md255",massNumber:255,exactMass:255.091083,atomicNumber:101,halfLife:1620},{id:"Md256",massNumber:256,exactMass:256.09406,atomicNumber:101,halfLife:4686},{id:"Md257",massNumber:257,exactMass:257.095541,atomicNumber:101,halfLife:19872},{id:"Md258",massNumber:258,exactMass:258.098431,atomicNumber:101,halfLife:4449600},{id:"Md259",massNumber:259,exactMass:259.10051,atomicNumber:101,halfLife:5760},{id:"Md260",massNumber:260,exactMass:260.10365,atomicNumber:101,halfLife:2747520},{id:"Md261",massNumber:261,exactMass:261.10572,atomicNumber:101},{id:"Md262",massNumber:262,exactMass:262.10887,atomicNumber:101}]},{elementSymbol:"No",atomicNumber:102,isotopes:[{id:"No248",massNumber:248,exactMass:248.0866,atomicNumber:102},{id:"No249",massNumber:249,exactMass:249.08783,atomicNumber:102},{id:"No250",massNumber:250,exactMass:250.08751,atomicNumber:102,halfLife:25e-5},{id:"No251",massNumber:251,exactMass:251.08901,atomicNumber:102,halfLife:.8},{id:"No252",massNumber:252,exactMass:252.088977,atomicNumber:102,halfLife:2.3},{id:"No253",massNumber:253,exactMass:253.09068,atomicNumber:102,halfLife:102},{id:"No254",massNumber:254,exactMass:254.090955,atomicNumber:102,halfLife:55},{id:"No255",massNumber:255,exactMass:255.093241,atomicNumber:102,halfLife:186},{id:"No256",massNumber:256,exactMass:256.094283,atomicNumber:102,halfLife:2.91},{id:"No257",massNumber:257,exactMass:257.096877,atomicNumber:102,halfLife:25},{id:"No258",massNumber:258,exactMass:258.09821,atomicNumber:102,halfLife:.0012},{id:"No259",massNumber:259,exactMass:259.10103,atomicNumber:102,halfLife:3480},{id:"No260",massNumber:260,exactMass:260.10264,atomicNumber:102,halfLife:.106},{id:"No261",massNumber:261,exactMass:261.10575,atomicNumber:102},{id:"No262",massNumber:262,exactMass:262.1073,atomicNumber:102,halfLife:.005},{id:"No263",massNumber:263,exactMass:263.11055,atomicNumber:102},{id:"No264",massNumber:264,exactMass:264.11235,atomicNumber:102}]},{elementSymbol:"Lr",atomicNumber:103,isotopes:[{id:"Lr251",massNumber:251,exactMass:251.09436,atomicNumber:103},{id:"Lr252",massNumber:252,exactMass:252.09537,atomicNumber:103},{id:"Lr253",massNumber:253,exactMass:253.09521,atomicNumber:103,halfLife:1.3},{id:"Lr254",massNumber:254,exactMass:254.09645,atomicNumber:103,halfLife:13},{id:"Lr255",massNumber:255,exactMass:255.09668,atomicNumber:103,halfLife:22},{id:"Lr256",massNumber:256,exactMass:256.09863,atomicNumber:103,halfLife:28},{id:"Lr257",massNumber:257,exactMass:257.09956,atomicNumber:103,halfLife:.646},{id:"Lr258",massNumber:258,exactMass:258.10181,atomicNumber:103,halfLife:3.9},{id:"Lr259",massNumber:259,exactMass:259.1029,atomicNumber:103,halfLife:6.3},{id:"Lr260",massNumber:260,exactMass:260.1055,atomicNumber:103,halfLife:180},{id:"Lr261",massNumber:261,exactMass:261.10688,atomicNumber:103,halfLife:2340},{id:"Lr262",massNumber:262,exactMass:262.10963,atomicNumber:103,halfLife:12960},{id:"Lr263",massNumber:263,exactMass:263.11129,atomicNumber:103},{id:"Lr264",massNumber:264,exactMass:264.11404,atomicNumber:103},{id:"Lr265",massNumber:265,exactMass:265.11584,atomicNumber:103},{id:"Lr266",massNumber:266,exactMass:266.11931,atomicNumber:103}]},{elementSymbol:"Rf",atomicNumber:104,isotopes:[{id:"Rf253",massNumber:253,exactMass:253.10069,atomicNumber:104,halfLife:1.8},{id:"Rf254",massNumber:254,exactMass:254.10018,atomicNumber:104,halfLife:5e-4},{id:"Rf255",massNumber:255,exactMass:255.10134,atomicNumber:104,halfLife:1.5},{id:"Rf256",massNumber:256,exactMass:256.101166,atomicNumber:104,halfLife:.0067},{id:"Rf257",massNumber:257,exactMass:257.10299,atomicNumber:104,halfLife:4.7},{id:"Rf258",massNumber:258,exactMass:258.10349,atomicNumber:104,halfLife:.012},{id:"Rf259",massNumber:259,exactMass:259.10564,atomicNumber:104,halfLife:3.1},{id:"Rf260",massNumber:260,exactMass:260.10644,atomicNumber:104,halfLife:.0201},{id:"Rf261",massNumber:261,exactMass:261.10877,atomicNumber:104,halfLife:65},{id:"Rf262",massNumber:262,exactMass:262.10993,atomicNumber:104,halfLife:2.1},{id:"Rf263",massNumber:263,exactMass:263.11255,atomicNumber:104},{id:"Rf264",massNumber:264,exactMass:264.11399,atomicNumber:104},{id:"Rf265",massNumber:265,exactMass:265.1167,atomicNumber:104},{id:"Rf266",massNumber:266,exactMass:266.11796,atomicNumber:104},{id:"Rf267",massNumber:267,exactMass:267.12153,atomicNumber:104},{id:"Rf268",massNumber:268,exactMass:268.12364,atomicNumber:104}]},{elementSymbol:"Db",atomicNumber:105,isotopes:[{id:"Db255",massNumber:255,exactMass:255.1074,atomicNumber:105,halfLife:1.6},{id:"Db256",massNumber:256,exactMass:256.10813,atomicNumber:105,halfLife:2.6},{id:"Db257",massNumber:257,exactMass:257.10772,atomicNumber:105,halfLife:1.3},{id:"Db258",massNumber:258,exactMass:258.10923,atomicNumber:105,halfLife:4.4},{id:"Db259",massNumber:259,exactMass:259.10961,atomicNumber:105},{id:"Db260",massNumber:260,exactMass:260.1113,atomicNumber:105,halfLife:1.52},{id:"Db261",massNumber:261,exactMass:261.11206,atomicNumber:105,halfLife:1.8},{id:"Db262",massNumber:262,exactMass:262.11408,atomicNumber:105,halfLife:34},{id:"Db263",massNumber:263,exactMass:263.11499,atomicNumber:105,halfLife:27},{id:"Db264",massNumber:264,exactMass:264.1174,atomicNumber:105},{id:"Db265",massNumber:265,exactMass:265.1186,atomicNumber:105},{id:"Db266",massNumber:266,exactMass:266.12103,atomicNumber:105},{id:"Db267",massNumber:267,exactMass:267.12238,atomicNumber:105},{id:"Db268",massNumber:268,exactMass:268.12545,atomicNumber:105},{id:"Db269",massNumber:269,exactMass:269.12746,atomicNumber:105},{id:"Db270",massNumber:270,exactMass:270.13071,atomicNumber:105}]},{elementSymbol:"Sg",atomicNumber:106,isotopes:[{id:"Sg258",massNumber:258,exactMass:258.11317,atomicNumber:106,halfLife:.0029},{id:"Sg259",massNumber:259,exactMass:259.1145,atomicNumber:106,halfLife:.48},{id:"Sg260",massNumber:260,exactMass:260.11442,atomicNumber:106,halfLife:.0036},{id:"Sg261",massNumber:261,exactMass:261.11612,atomicNumber:106,halfLife:.23},{id:"Sg262",massNumber:262,exactMass:262.1164,atomicNumber:106},{id:"Sg263",massNumber:263,exactMass:263.11832,atomicNumber:106,halfLife:.8},{id:"Sg264",massNumber:264,exactMass:264.11893,atomicNumber:106},{id:"Sg265",massNumber:265,exactMass:265.12111,atomicNumber:106,halfLife:10},{id:"Sg266",massNumber:266,exactMass:266.12207,atomicNumber:106,halfLife:21},{id:"Sg267",massNumber:267,exactMass:267.12443,atomicNumber:106},{id:"Sg268",massNumber:268,exactMass:268.12561,atomicNumber:106},{id:"Sg269",massNumber:269,exactMass:269.12876,atomicNumber:106},{id:"Sg270",massNumber:270,exactMass:270.13033,atomicNumber:106},{id:"Sg271",massNumber:271,exactMass:271.13347,atomicNumber:106},{id:"Sg272",massNumber:272,exactMass:272.13516,atomicNumber:106},{id:"Sg273",massNumber:273,exactMass:273.13822,atomicNumber:106}]},{elementSymbol:"Bh",atomicNumber:107,isotopes:[{id:"Bh260",massNumber:260,exactMass:260.12197,atomicNumber:107},{id:"Bh261",massNumber:261,exactMass:261.12166,atomicNumber:107,halfLife:.0118},{id:"Bh262",massNumber:262,exactMass:262.12289,atomicNumber:107,halfLife:.102},{id:"Bh263",massNumber:263,exactMass:263.12304,atomicNumber:107},{id:"Bh264",massNumber:264,exactMass:264.1246,atomicNumber:107,halfLife:.44},{id:"Bh265",massNumber:265,exactMass:265.12515,atomicNumber:107,halfLife:.94},{id:"Bh266",massNumber:266,exactMass:266.12694,atomicNumber:107},{id:"Bh267",massNumber:267,exactMass:267.12765,atomicNumber:107},{id:"Bh268",massNumber:268,exactMass:268.12976,atomicNumber:107},{id:"Bh269",massNumber:269,exactMass:269.13069,atomicNumber:107},{id:"Bh270",massNumber:270,exactMass:270.13362,atomicNumber:107},{id:"Bh271",massNumber:271,exactMass:271.13518,atomicNumber:107},{id:"Bh272",massNumber:272,exactMass:272.13803,atomicNumber:107},{id:"Bh273",massNumber:273,exactMass:273.13962,atomicNumber:107},{id:"Bh274",massNumber:274,exactMass:274.14244,atomicNumber:107},{id:"Bh275",massNumber:275,exactMass:275.14425,atomicNumber:107}]},{elementSymbol:"Hs",atomicNumber:108,isotopes:[{id:"Hs263",massNumber:263,exactMass:263.12856,atomicNumber:108},{id:"Hs264",massNumber:264,exactMass:264.12839,atomicNumber:108,halfLife:85e-5},{id:"Hs265",massNumber:265,exactMass:265.13009,atomicNumber:108,halfLife:9e-4},{id:"Hs266",massNumber:266,exactMass:266.1301,atomicNumber:108},{id:"Hs267",massNumber:267,exactMass:267.13179,atomicNumber:108,halfLife:.026},{id:"Hs268",massNumber:268,exactMass:268.13216,atomicNumber:108},{id:"Hs269",massNumber:269,exactMass:269.13406,atomicNumber:108,halfLife:9},{id:"Hs270",massNumber:270,exactMass:270.13465,atomicNumber:108},{id:"Hs271",massNumber:271,exactMass:271.13766,atomicNumber:108},{id:"Hs272",massNumber:272,exactMass:272.13905,atomicNumber:108},{id:"Hs273",massNumber:273,exactMass:273.14199,atomicNumber:108},{id:"Hs274",massNumber:274,exactMass:274.14313,atomicNumber:108},{id:"Hs275",massNumber:275,exactMass:275.14595,atomicNumber:108},{id:"Hs276",massNumber:276,exactMass:276.14721,atomicNumber:108},{id:"Hs277",massNumber:277,exactMass:277.14984,atomicNumber:108}]},{elementSymbol:"Mt",atomicNumber:109,isotopes:[{id:"Mt265",massNumber:265,exactMass:265.13615,atomicNumber:109},{id:"Mt266",massNumber:266,exactMass:266.1373,atomicNumber:109,halfLife:8e-4},{id:"Mt267",massNumber:267,exactMass:267.13731,atomicNumber:109},{id:"Mt268",massNumber:268,exactMass:268.13873,atomicNumber:109,halfLife:.07},{id:"Mt269",massNumber:269,exactMass:269.13906,atomicNumber:109},{id:"Mt270",massNumber:270,exactMass:270.14066,atomicNumber:109},{id:"Mt271",massNumber:271,exactMass:271.14114,atomicNumber:109},{id:"Mt272",massNumber:272,exactMass:272.14374,atomicNumber:109},{id:"Mt273",massNumber:273,exactMass:273.14491,atomicNumber:109},{id:"Mt274",massNumber:274,exactMass:274.14749,atomicNumber:109},{id:"Mt275",massNumber:275,exactMass:275.14865,atomicNumber:109},{id:"Mt276",massNumber:276,exactMass:276.15116,atomicNumber:109},{id:"Mt277",massNumber:277,exactMass:277.15242,atomicNumber:109},{id:"Mt278",massNumber:278,exactMass:278.15481,atomicNumber:109},{id:"Mt279",massNumber:279,exactMass:279.15619,atomicNumber:109}]},{elementSymbol:"Ds",atomicNumber:110,isotopes:[{id:"Ds267",massNumber:267,exactMass:267.14434,atomicNumber:110,halfLife:3e-6},{id:"Ds268",massNumber:268,exactMass:268.1438,atomicNumber:110},{id:"Ds269",massNumber:269,exactMass:269.14512,atomicNumber:110,halfLife:17e-5},{id:"Ds270",massNumber:270,exactMass:270.14472,atomicNumber:110},{id:"Ds271",massNumber:271,exactMass:271.14606,atomicNumber:110,halfLife:.06},{id:"Ds272",massNumber:272,exactMass:272.14632,atomicNumber:110},{id:"Ds273",massNumber:273,exactMass:273.14886,atomicNumber:110,halfLife:18e-5},{id:"Ds274",massNumber:274,exactMass:274.14949,atomicNumber:110},{id:"Ds275",massNumber:275,exactMass:275.15218,atomicNumber:110},{id:"Ds276",massNumber:276,exactMass:276.15303,atomicNumber:110},{id:"Ds277",massNumber:277,exactMass:277.15565,atomicNumber:110},{id:"Ds278",massNumber:278,exactMass:278.15647,atomicNumber:110},{id:"Ds279",massNumber:279,exactMass:279.15886,atomicNumber:110},{id:"Ds280",massNumber:280,exactMass:280.1598,atomicNumber:110},{id:"Ds281",massNumber:281,exactMass:281.16206,atomicNumber:110}]},{elementSymbol:"Rg",atomicNumber:111,isotopes:[{id:"Rg272",massNumber:272,exactMass:272.15362,atomicNumber:111,halfLife:.0015},{id:"Rg273",massNumber:273,exactMass:273.15368,atomicNumber:111},{id:"Rg274",massNumber:274,exactMass:274.15571,atomicNumber:111},{id:"Rg275",massNumber:275,exactMass:275.15614,atomicNumber:111},{id:"Rg276",massNumber:276,exactMass:276.15849,atomicNumber:111},{id:"Rg277",massNumber:277,exactMass:277.15952,atomicNumber:111},{id:"Rg278",massNumber:278,exactMass:278.1616,atomicNumber:111},{id:"Rg279",massNumber:279,exactMass:279.16247,atomicNumber:111},{id:"Rg280",massNumber:280,exactMass:280.16447,atomicNumber:111},{id:"Rg281",massNumber:281,exactMass:281.16537,atomicNumber:111},{id:"Rg282",massNumber:282,exactMass:282.16749,atomicNumber:111},{id:"Rg283",massNumber:283,exactMass:283.16842,atomicNumber:111}]},{elementSymbol:"Uub",atomicNumber:112,isotopes:[{id:"Uub277",massNumber:277,exactMass:277.16394,atomicNumber:112,halfLife:24e-5},{id:"Uub278",massNumber:278,exactMass:278.16431,atomicNumber:112},{id:"Uub279",massNumber:279,exactMass:279.16655,atomicNumber:112},{id:"Uub280",massNumber:280,exactMass:280.16704,atomicNumber:112},{id:"Uub281",massNumber:281,exactMass:281.16929,atomicNumber:112},{id:"Uub282",massNumber:282,exactMass:282.16977,atomicNumber:112},{id:"Uub283",massNumber:283,exactMass:283.17179,atomicNumber:112},{id:"Uub284",massNumber:284,exactMass:284.17238,atomicNumber:112},{id:"Uub285",massNumber:285,exactMass:285.17411,atomicNumber:112}]}]},function(e,t,r){"use strict";e.exports=[{elementSymbol:"H",atomicNumber:1,atomTypes:[{id:"H1",maxBondOrder:1,bondOrderSum:1}]},null,{elementSymbol:"Li",atomicNumber:3,atomTypes:[{id:"Li1",maxBondOrder:1,bondOrderSum:1}]},null,{elementSymbol:"B",atomicNumber:5,atomTypes:[{id:"B3",maxBondOrder:2,bondOrderSum:3}]},{elementSymbol:"C",atomicNumber:6,atomTypes:[{id:"C4",maxBondOrder:3,bondOrderSum:4}]},{elementSymbol:"N",atomicNumber:7,atomTypes:[{id:"N3",maxBondOrder:3,bondOrderSum:3},{id:"N5",maxBondOrder:2,bondOrderSum:5}]},{elementSymbol:"O",atomicNumber:8,atomTypes:[{id:"O2",maxBondOrder:2,bondOrderSum:2}]},{elementSymbol:"F",atomicNumber:9,atomTypes:[{id:"F1",maxBondOrder:1,bondOrderSum:1}]},null,{elementSymbol:"Na",atomicNumber:11,atomTypes:[{id:"Na1",maxBondOrder:1,bondOrderSum:1}]},null,null,{elementSymbol:"Si",atomicNumber:14,atomTypes:[{id:"Si4",maxBondOrder:3,bondOrderSum:4}]},{elementSymbol:"P",atomicNumber:15,atomTypes:[{id:"P3",maxBondOrder:3,bondOrderSum:3},{id:"P4",maxBondOrder:3,bondOrderSum:5}]},{elementSymbol:"S",atomicNumber:16,atomTypes:[{id:"S2",maxBondOrder:2,bondOrderSum:2},{id:"S3",maxBondOrder:2,bondOrderSum:4},{id:"S4",maxBondOrder:2,bondOrderSum:6}]},{elementSymbol:"Cl",atomicNumber:17,atomTypes:[{id:"Cl1",maxBondOrder:1,bondOrderSum:1}]},null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,{elementSymbol:"As",atomicNumber:33,atomTypes:[{id:"As3",maxBondOrder:1,bondOrderSum:3}]},{elementSymbol:"Se",atomicNumber:34,atomTypes:[{id:"Se2",maxBondOrder:2,bondOrderSum:2}]},{elementSymbol:"Br",atomicNumber:35,atomTypes:[{id:"Br1",maxBondOrder:1,bondOrderSum:1}]},null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,{elementSymbol:"I",atomicNumber:53,atomTypes:[{id:"I1",maxBondOrder:1,bondOrderSum:1}]}]},function(e,t,r){"use strict";var i=r(0).Class,n=(r(0).ClassEx,r(0).ObjectEx),a=r(0).DataType;e.exports=function(e){return e.AbstractConfigs=i.create(n,{CLASS_NAME:"Kekule.AbstractConfigs",CONFIG_PROP_FLAG:"__$config_prop__",initialize:function($super,e){$super(),void 0===e&&(e=!0),e&&this.initPropDefValues()},addConfigProp:function(e,t,r,i){var n={dataType:t};i&&(n=Object.extend(n,i)),void 0!==r&&(n.defaultValue=r);var a=this.defineProp(e,n);return a[this.CONFIG_PROP_FLAG]=!0,a},addHashConfigProp:function(e,t,r){return this.addConfigProp(e,a.HASH,t,r)},addStrConfigProp:function(e,t,r){return this.addConfigProp(e,a.STRING,t,r)},addNumConfigProp:function(e,t,r){return this.addConfigProp(e,a.NUM,t,r)},addIntConfigProp:function(e,t,r){return this.addConfigProp(e,a.INT,t,r)},addFloatConfigProp:function(e,t,r){return this.addConfigProp(e,a.FLOAT,t,r)},addBoolConfigProp:function(e,t,r){return this.addConfigProp(e,a.BOOL,t,r)},initPropDefValues:function(){this.beginUpdate();try{for(var e=this.getAllPropList(),t=0,r=e.getLength();t<r;++t){var i=e.getPropInfoAt(t),n=i.name,a=i.defaultValue;void 0!==a&&this.setPropValue(n,a)}}finally{this.endUpdate()}},assign:function(e){e.copyPropsTo(this)},toHash:function(){var e={},t=this.CONFIG_PROP_FLAG;return this.saveObj(e,"json",{saveDefaultValues:!0,propFilter:function(e,r){return e[t]}}),e}}),e.ConfigPresetMap=i.create(n,{CLASS_NAME:"Kekule.ConfigPresetMap",initialize:function($super){$super(),this.map=new e.MapEx(!0)},doFinalize:function($super){this.map=null,$super()},set:function(e,t){this.map.set(e,t)},get:function(e){return this.map.get(e)},getHash:function(e){var t=this.get(e);return t?t.toHash?t.toHash():t:null},remove:function(e){this.map.remove(e)},has:function(e){return this.map.has(e)},clear:function(){this.map.clear()}}),e}},function(e,t,r){"use strict";var i=r(0).Class,n=(r(0).ClassEx,r(0).ObjectEx,r(0).DataType);e.exports=function(e){return e.ElementSeries={NONMETAL:"Nonmetals",METAL:"Metals",ALKALI_METAL:"Alkali Metals",ALKALI_EARTH_METAL:"Alkali Earth Metals",TRANSITION_METAL:"Transition Metals",METALLOID:"Metalloids",HALOGEN:"Halogens",NOBLE_GAS:"Noble Gases",LANTHANIDE:"Lanthanides",ACTINIDE:"Actinides"},e.Element=i.create(e.ChemObject,{CLASS_NAME:"Kekule.Element",initialize:function($super,t){if($super(),t!=e.Element.UNSET_ELEMENT){var r=this.getElementInfo(t);r?(this.setPropStoreFieldValue("symbol",r.symbol),this.setPropStoreFieldValue("atomicNumber",r.atomicNumber),this.setPropStoreFieldValue("group",r.group),this.setPropStoreFieldValue("period",r.period),this.setPropStoreFieldValue("series",r.chemicalSerie),this.setPropStoreFieldValue("naturalMass",r.naturalMass),r.name&&this.setPropStoreFieldValue("name",r.name)):this.setPropStoreFieldValue("symbol",t)}else this.setPropStoreFieldValue("symbol",e.Element.UNSET_ELEMENT),this.setPropStoreFieldValue("atomicNumber",e.Element.UNSET_ELEMENT)},initProperties:function(){this.defineProp("name",{dataType:n.STRING,serializable:!1,setter:null}),this.defineProp("atomicNumber",{dataType:n.INT,serializable:!1,setter:null}),this.defineProp("symbol",{dataType:n.STRING,serializable:!1,setter:null}),this.defineProp("group",{dataType:n.INT,serializable:!1,setter:null}),this.defineProp("period",{dataType:n.INT,serializable:!1,setter:null}),this.defineProp("series",{dataType:n.STRING,serializable:!1,setter:null}),this.defineProp("naturalMass",{dataType:n.FLOAT,serializable:!1,setter:null})},getElementInfo:function(t){return t==e.Element.UNSET_ELEMENT?{symbol:e.Element.UNSET_ELEMENT,atomicNumber:e.Element.UNSET_ELEMENT}:e.Element.isDummyElement(t)?{symbol:e.Element.DUMMY_ELEMENT,atomicNumber:e.Element.DUMMY_ELEMENT_ATOMICNUM}:e.ChemicalElementsDataUtil.getElementInfo(t)},getTheoreticValence:function(){return this.getGroup()?e.Element.getTheoreticValenceOfGroup(this.getGroup()):null},isDummyElement:function(){return this.getAtomicNumber()==e.Element.DUMMY_ELEMENT_ATOMICNUM},isRGroupElement:function(){return this.getAtomicNumber()==e.Element.RGROUP_ELEMENT_ATMOICNUM},isNormalElement:function(){return e.Element.isNormalElement(this.getAtomicNumber())},isSameElement:function(t){return t==e.Element.UNSET_ELEMENT?this.getAtomicNumber()==e.Element.UNSET_ELEMENT:"number"==typeof t?this.getAtomicNumber()==t:this.getSymbol()==t},isHetero:function(){return(this.getSeries()===e.ElementSeries.NONMETAL||this.getSeries()===e.ElementSeries.HALOGEN)&&6!==this.getAtomicNumber()&&1!==this.getAtomicNumber()},getLabel:function(){return this.getSymbol()}}),Object.extend(e.Element,e.ChemicalElementsDataUtil),e.Element.UNSET_ELEMENT=void 0,e.Element.DUMMY_ELEMENT="DU",e.Element.DUMMY_ELEMENT_ATOMICNUM=-1,e.Element.RGROUP_ELEMENT="R",e.Element.RGROUP_ELEMENT_ATOMICNUM=-2,e.Element.DEUTERIUM="D",e.Element.isNormalElement=function(t){return t!=e.Element.UNSET_ELEMENT&&!e.Element.isPseudoElement(t)},e.Element.isPseudoElement=function(t){return"string"==typeof t?t==e.Element.DUMMY_ELEMENT||t==e.Element.RGROUP_ELEMENT:t==e.Element.DUMMY_ELEMENT_ATOMICNUM||t==e.Element.RGROUP_ELEMENT_ATMOICNUM},e.Element.isDummyElement=function(t){return t===e.Element.DUMMY_ELEMENT||t===e.Element.DUMMY_ELEMENT_ATOMICNUM},e.Element.isRGroup=function(t){return t===e.Element.RGROUP_ELEMENT||t===e.Element.RGROUP_ELEMENT_ATOMICNUM},e.Element.getTheoreticValenceOfGroup=function(e){return e<=2?e:e<=12?null:e<=17?e-10:0},e.Element.getTheoreticValence=function(t){var r=e.ChemicalElementsDataUtil.getElementInfo(t);return r.group?e.Element.getTheoreticValenceOfGroup(r.group):null},Object.extend(e.Element,{isAtomicNumberAvailable:function(t){return e.ChemicalElementsDataUtil.isAtomicNumberAvailable(t)},isElementSymbolAvailable:function(t){return e.ChemicalElementsDataUtil.isElementSymbolAvailable(t)}}),e.Isotope=i.create(e.Element,{CLASS_NAME:"Kekule.Isotope",initialize:function($super,t,r){var i=t,n=r,a=e.IsotopesDataUtil.getIsotopeInfo(t,r);if(a&&(a.atomicNumber&&(i=a.atomicNumber),n=a.massNumber),$super(i),this.setPropStoreFieldValue("massNumber",n),a&&a.isotopeAlias&&this.setPropStoreFieldValue("isotopeAlias",a.isotopeAlias),e.Element.isNormalElement(i)&&n!==e.Isotope.UNSET_MASSNUMBER){var o=e.IsotopesDataUtil.getIsotopeInfo(this.getAtomicNumber(),n);o?(this.setPropStoreFieldValue("exactMass",o.exactMass),this.setPropStoreFieldValue("naturalAbundance",o.naturalAbundance)):e.chemError((e.hasLocalRes()?e.$L("ErrorMsg.INVALID_ISOTOPE"):"Invalid isotope")+": "+this.getSymbol()+"/"+r)}},initProperties:function(){this.defineProp("massNumber",{dataType:n.INTEGER,serializable:!1,setter:null}),this.defineProp("exactMass",{dataType:n.FLOAT,serializable:!1,setter:null}),this.defineProp("naturalAbundance",{dataType:n.FLOAT,serializable:!1,setter:null}),this.defineProp("isotopeAlias",{dataType:n.STRING,serializable:!1,setter:null})},isSame:function(t){return t instanceof e.Isotope&&(t===this||t.getAtomicNumber()==this.getAtomicNumber()&&t.getMassNumber()==this.getMassNumber())},getIsotopeId:function(){return e.IsotopesDataUtil.getIsotopeId(this.getAtomicNumber(),this.getMassNumber())},getLabel:function(){return""+(this.getMassNumber()||"")+this.getSymbol()}}),Object.extend(e.Isotope,e.IsotopesDataUtil),e.Isotope.UNSET_MASSNUMBER=void 0,e.Isotope.getIsotopeId=function(t,r){return e.IsotopesDataUtil.getIsotopeId(t,r)},Object.extend(e.Isotope,{isMassNumberAvailable:function(t,r){return e.IsotopesDataUtil.isMassNumberAvailable(t,r)}}),e.IsotopeFactory={GENERIC_ELEMENT_ID:"__GENERIC__",_isotopes:{},getIsotopeId:function(t,r){return t?e.IsotopesDataUtil.getIsotopeId(t,r):e.IsotopeFactory.GENERIC_ELEMENT_ID},getIsotope:function(t,r){var i=e.IsotopeFactory.getIsotopeId(t,r);if(!e.IsotopeFactory._isotopes[i]){var n=new e.Isotope(t,r);e.IsotopeFactory._isotopes[i]=n}return e.IsotopeFactory._isotopes[i]},getIsotopeById:function(t){if(e.IsotopeFactory._isotopes[t])return e.IsotopeFactory._isotopes[t];var r=e.IsotopesDataUtil.getIsotopeIdDetail(t);return r?e.IsotopeFactory.getIsotope(r.symbol,r.massNumber):null}},e.AtomType={UNSET_ATOMTYPE:void 0},e}},function(e,t,r){"use strict";var i=r(0).Class,n=(r(0).ClassEx,r(0).ObjectEx,r(0).DataType);e.exports=function(e){return e.ElectronSet=i.create(e.ChemObject,{CLASS_NAME:"Kekule.ElectronSet",initialize:function($super,t){$super(),this.setElectronCount(t||e.ElectronSet.UNSET_ELECTRONCOUNT)},initProperties:function(){this.defineProp("electronCount",{dataType:n.FLOAT})}}),e.ElectronSet.UNSET_ELECTRONCOUNT=null,e.UnBondedElectronSet=i.create(e.ElectronSet,{CLASS_NAME:"Kekule.UnBondedElectronSet",initialize:function($super,e){$super(e)},initProperties:function(){}}),e.BondType={COVALENT:"covalent",IONIC:"ionic",COORDINATE:"coordinate",METALLIC:"metallic",HYDROGEN:"hydrogen",UNKNOWN:null,DEFAULT:"covalent"},e.BondOrder={SINGLE:1,DOUBLE:2,TRIPLE:3,QUAD:4,EXPLICIT_AROMATIC:10,OTHER:20,UNSET:null,DEFAULT:1,getBondValence:function(t){return t===e.BondOrder.UNSET?0:t==e.BondOrder.EXPLICIT_AROMATIC?1.5:t}},e.BondForm=i.create(e.ElectronSet,{CLASS_NAME:"Kekule.BondForm",initialize:function($super,t,r,i){$super(r),this.setBondOrder(t||e.BondOrder.DEFAULT),e.ObjUtils.notUnset(i)&&this.setBondType(i),e.ObjUtils.notUnset(r)&&this.setElectronCount(r)},initProperties:function(){this.defineProp("bondType",{dataType:n.STRING,enumSource:e.BondType,getter:function(){var t=this.getPropStoreFieldValue("bondType");return t||e.BondType.DEFAULT}}),this.defineProp("bondOrder",{dataType:n.FLOAT,enumSource:e.BondOrder,setter:function(t){this.getPropStoreFieldValue("bondOrder")!=t&&(this.setPropStoreFieldValue("bondOrder",t),t?this.getBondType()==e.BondType.COVALENT&&this.setElectronCount(2*this.getBondValence()):t===e.BondOrder.UNSET&&this.setElectronCount(e.ElectronSet.UNSET_ELECTRONCOUNT))}}),this.defineProp("electronCount",{dataType:n.FLOAT}),this.defineProp("bondValence",{dataType:n.FLOAT,serializable:!1,getter:function(){return e.BondOrder.getBondValence(this.getBondOrder())},setter:null})}}),e.BondFormFactory={_bondForms:{},getBondFormId:function(e,t,r){var i="";return r&&(i+=r+"_"),e&&(i+=Number(e).toString()),t&&(i+="_"+Number(t).toString()),i},getBondForm:function(t,r,i){if(t||r||i){if(i||(i=e.BondType.DEFAULT),!r&&t&&i===e.BondType.COVALENT){r=2*e.BondOrder.getBondValence(t)}var n=e.BondFormFactory.getBondFormId(t,r,i);return e.BondFormFactory._bondForms[n]||(e.BondFormFactory._bondForms[n]=new e.BondForm(t,r,i)),e.BondFormFactory._bondForms[n]}}},e.RadicalOrder={NONE:0,SINGLET:1,DOUBLET:2,TRIPLET:3,DEFAULT:0,getRadicalElectronCount:function(t){var r=e.RadicalOrder;return e.ObjUtils.isUnset(t)||t===r.NONE?0:t===r.DOUBLET?1:2}},e.HybridizationType={UNKNOWN:null,SP:1,SP2:2,SP3:3,NONE:0},e}},function(e,t,r){"use strict";e.exports=function(e){return e.ValenceUtils={getImplicitMdlValence:function(e,t,r){var i=t,n=r;switch(e){case 1:case 3:case 11:case 19:case 37:case 55:case 87:if(0==i&&n<=1)return 1;break;case 4:case 12:case 20:case 38:case 56:case 88:switch(i){case 0:if(n<=2)return 2;break;case 1:if(n<=1)return 1}break;case 5:switch(i){case-4:if(n<=1)return 1;break;case-3:if(n<=2)return 2;break;case-2:if(n<=3)return 3;if(n<=5)return 5;break;case-1:if(n<=4)return 4;break;case 0:if(n<=3)return 3;break;case 1:if(n<=2)return 2;break;case 2:if(n<=1)return 1}break;case 6:switch(i){case-3:if(n<=1)return 1;break;case-2:if(n<=2)return 2;break;case-1:if(n<=3)return 3;if(n<=5)return 5;break;case 0:if(n<=4)return 4;break;case 1:if(n<=3)return 3;break;case 2:if(n<=2)return 2;break;case 3:if(n<=1)return 1}break;case 7:switch(i){case-2:if(n<=1)return 1;break;case-1:if(n<=2)return 2;break;case 0:if(n<=3)return 3;if(n<=5)return 5;break;case 1:if(n<=4)return 4;break;case 2:if(n<=3)return 3;break;case 3:if(n<=2)return 2;break;case 4:if(n<=1)return 1}break;case 8:switch(i){case-1:if(n<=1)return 1;break;case 0:if(n<=2)return 2;break;case 1:if(n<=3)return 3;if(n<=5)return 5;break;case 2:if(n<=4)return 4;break;case 3:if(n<=3)return 3;break;case 4:if(n<=2)return 2;break;case 5:if(n<=1)return 1}break;case 9:switch(i){case 0:if(n<=1)return 1;break;case 1:if(n<=2)return 2;break;case 2:if(n<=3)return 3;if(n<=5)return 5;break;case 3:if(n<=4)return 4;break;case 4:if(n<=3)return 3;break;case 5:if(n<=2)return 2;break;case 6:if(n<=1)return 1}break;case 13:switch(i){case-4:if(n<=1)return 1;if(n<=3)return 3;if(n<=5)return 5;if(n<=7)return 7;break;case-3:if(n<=2)return 2;if(n<=4)return 4;if(n<=6)return 6;break;case-2:if(n<=3)return 3;if(n<=5)return 5;break;case-1:if(n<=4)return 4;break;case 0:if(n<=3)return 3;break;case 1:if(n<=2)return 2;break;case 2:if(n<=1)return 1}break;case 14:switch(i){case-3:if(n<=1)return 1;if(n<=3)return 3;if(n<=5)return 5;if(n<=7)return 7;break;case-2:if(n<=2)return 2;if(n<=4)return 4;if(n<=6)return 6;break;case-1:if(n<=3)return 3;if(n<=5)return 5;break;case 0:if(n<=4)return 4;break;case 1:if(n<=3)return 3;break;case 2:if(n<=2)return 2;break;case 3:if(n<=1)return 1}break;case 15:switch(i){case-2:if(n<=1)return 1;if(n<=3)return 3;if(n<=5)return 5;if(n<=7)return 7;break;case-1:if(n<=2)return 2;if(n<=4)return 4;if(n<=6)return 6;break;case 0:if(n<=3)return 3;if(n<=5)return 5;break;case 1:if(n<=4)return 4;break;case 2:if(n<=3)return 3;break;case 3:if(n<=2)return 2;break;case 4:if(n<=1)return 1}break;case 16:switch(i){case-1:if(n<=1)return 1;if(n<=3)return 3;if(n<=5)return 5;if(n<=7)return 7;break;case 0:if(n<=2)return 2;if(n<=4)return 4;if(n<=6)return 6;break;case 1:if(n<=3)return 3;if(n<=5)return 5;break;case 2:if(n<=4)return 4;break;case 3:if(n<=3)return 3;break;case 4:if(n<=2)return 2;break;case 5:if(n<=1)return 1}break;case 17:switch(i){case 0:if(n<=1)return 1;if(n<=3)return 3;if(n<=5)return 5;if(n<=7)return 7;break;case 1:if(n<=2)return 2;if(n<=4)return 4;if(n<=6)return 6;break;case 2:if(n<=3)return 3;if(n<=5)return 5;break;case 3:if(n<=4)return 4;break;case 4:if(n<=3)return 3;break;case 5:if(n<=2)return 2;break;case 6:if(n<=1)return 1}break;case 31:switch(i){case-4:if(n<=1)return 1;if(n<=3)return 3;if(n<=5)return 5;if(n<=7)return 7;break;case-3:if(n<=2)return 2;if(n<=4)return 4;if(n<=6)return 6;break;case-2:if(n<=3)return 3;if(n<=5)return 5;break;case-1:if(n<=4)return 4;break;case 0:if(n<=3)return 3;break;case 2:if(n<=1)return 1}break;case 32:switch(i){case-3:if(n<=1)return 1;if(n<=3)return 3;if(n<=5)return 5;if(n<=7)return 7;break;case-2:if(n<=2)return 2;if(n<=4)return 4;if(n<=6)return 6;break;case-1:if(n<=3)return 3;if(n<=5)return 5;break;case 0:if(n<=4)return 4;break;case 1:if(n<=3)return 3;break;case 3:if(n<=1)return 1}break;case 33:switch(i){case-2:if(n<=1)return 1;if(n<=3)return 3;if(n<=5)return 5;if(n<=7)return 7;break;case-1:if(n<=2)return 2;if(n<=4)return 4;if(n<=6)return 6;break;case 0:if(n<=3)return 3;if(n<=5)return 5;break;case 1:if(n<=4)return 4;break;case 2:if(n<=3)return 3;break;case 4:if(n<=1)return 1}break;case 34:switch(i){case-1:if(n<=1)return 1;if(n<=3)return 3;if(n<=5)return 5;if(n<=7)return 7;break;case 0:if(n<=2)return 2;if(n<=4)return 4;if(n<=6)return 6;break;case 1:if(n<=3)return 3;if(n<=5)return 5;break;case 2:if(n<=4)return 4;break;case 3:if(n<=3)return 3;break;case 5:if(n<=1)return 1}break;case 35:switch(i){case 0:if(n<=1)return 1;if(n<=3)return 3;if(n<=5)return 5;if(n<=7)return 7;break;case 1:if(n<=2)return 2;if(n<=4)return 4;if(n<=6)return 6;break;case 2:if(n<=3)return 3;if(n<=5)return 5;break;case 3:if(n<=4)return 4;break;case 4:if(n<=3)return 3;break;case 6:if(n<=1)return 1}break;case 49:switch(i){case-4:if(n<=1)return 1;if(n<=3)return 3;if(n<=5)return 5;if(n<=7)return 7;break;case-3:if(n<=2)return 2;if(n<=4)return 4;if(n<=6)return 6;break;case-2:if(n<=3)return 3;if(n<=5)return 5;break;case-1:if(n<=2)return 2;if(n<=4)return 4;break;case 0:if(n<=3)return 3;break;case 2:if(n<=1)return 1}break;case 50:case 82:switch(i){case-3:if(n<=1)return 1;if(n<=3)return 3;if(n<=5)return 5;if(n<=7)return 7;break;case-2:if(n<=2)return 2;if(n<=4)return 4;if(n<=6)return 6;break;case-1:if(n<=3)return 3;if(n<=5)return 5;break;case 0:if(n<=2)return 2;if(n<=4)return 4;break;case 1:if(n<=3)return 3;break;case 3:if(n<=1)return 1}break;case 51:case 83:switch(i){case-2:if(n<=1)return 1;if(n<=3)return 3;if(n<=5)return 5;if(n<=7)return 7;break;case-1:if(n<=2)return 2;if(n<=4)return 4;if(n<=6)return 6;break;case 0:if(n<=3)return 3;if(n<=5)return 5;break;case 1:if(n<=2)return 2;if(n<=4)return 4;break;case 2:if(n<=3)return 3;break;case 4:if(n<=1)return 1}break;case 52:case 84:switch(i){case-1:if(n<=1)return 1;if(n<=3)return 3;if(n<=5)return 5;if(n<=7)return 7;break;case 0:if(n<=2)return 2;if(n<=4)return 4;if(n<=6)return 6;break;case 1:if(n<=3)return 3;if(n<=5)return 5;break;case 2:if(n<=2)return 2;if(n<=4)return 4;break;case 3:if(n<=3)return 3;break;case 5:if(n<=1)return 1}break;case 53:case 85:switch(i){case 0:if(n<=1)return 1;if(n<=3)return 3;if(n<=5)return 5;if(n<=7)return 7;break;case 1:if(n<=2)return 2;if(n<=4)return 4;if(n<=6)return 6;break;case 2:if(n<=3)return 3;if(n<=5)return 5;break;case 3:if(n<=2)return 2;if(n<=4)return 4;break;case 4:if(n<=3)return 3;break;case 6:if(n<=1)return 1}break;case 81:switch(i){case-4:if(n<=1)return 1;if(n<=3)return 3;if(n<=5)return 5;if(n<=7)return 7;break;case-3:if(n<=2)return 2;if(n<=4)return 4;if(n<=6)return 6;break;case-2:if(n<=3)return 3;if(n<=5)return 5;break;case-1:if(n<=2)return 2;if(n<=4)return 4;break;case 0:if(n<=1)return 1;if(n<=3)return 3}}return n},getImplicitHydValence:function(e,t,r){var i=e,n=t,a=r,o=0;return 6==i?o=4-Math.abs(n):7==i||15==i?o=3+n:8!=i&&16!=i||(o=2+n),o<0&&(o=0),a>o&&(o=a),o}},e.ValenceUtils.getImplicitValence=e.ValenceUtils.getImplicitMdlValence,e}},function(e,t,r){"use strict";var i=function(){function e(e,t){var r=[],i=!0,n=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);i=!0);}catch(e){n=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(n)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=r(0).Class,o=r(0).ClassEx,s=r(0).ObjectEx,l=r(0).DataType;e.exports=function(e){var t=e.ArrayUtils;return e.StructureComparationLevel={SKELETAL:1,CONSTITUTION:2,CONFIGURATION:3,EXACT:4,DEFAULT:4},e.globalOptions.add("algorithm.structureComparation",{structureComparationLevel:e.StructureComparationLevel.DEFAULT}),e.globalOptions.add("algorithm.structureClean",{structureCleanOptions:{orphanChemNode:!0,hangingChemConnector:!0}}),e.ObjComparer.compareStructure=function(t,r,i){var n=Object.create(i||{});return n.method=e.ComparisonMethod.CHEM_STRUCTURE,e.ObjComparer.compare(t,r,n)},e.ObjComparer.equalStructure=function(t,r,i){return 0===e.ObjComparer.compareStructure(t,r,i)},e.ObjComparer.getStructureComparisonDetailOptions=function(t){var r=Object.extend({},t);if(t){var i,n=e.StructureComparationLevel,a=t.structureLevel||t.level||e.globalOptions.algorithm.structureComparation.structureComparationLevel,o=["atom","mass","linkedConnectorCount","charge","radical","stereo","hydrogenCount","connectedObjCount","bondType","bondOrder"];a===n.SKELETAL?i={atom:!1,mass:!1,linkedConnectorCount:!0,charge:!1,radical:!1,stereo:!1,hydrogenCount:!1,connectedObjCount:!0,bondType:!1,bondOrder:!1}:a===n.CONSTITUTION?i={atom:!0,mass:!1,linkedConnectorCount:!0,charge:!1,radical:!1,stereo:!1,hydrogenCount:!0,connectedObjCount:!0,bondType:!0,bondOrder:!0}:a===n.CONFIGURATION?i={atom:!0,mass:!1,linkedConnectorCount:!0,charge:!1,radical:!1,stereo:!0,hydrogenCount:!0,connectedObjCount:!0,bondType:!0,bondOrder:!0}:a===n.EXACT&&(i={atom:!0,mass:!0,linkedConnectorCount:!0,charge:!0,radical:!0,stereo:!0,hydrogenCount:!0,connectedObjCount:!0,bondType:!0,bondOrder:!0});for(var s=0,l=o.length;s<l;++s){var d=o[s],u="compare"+d.capitalizeFirst(),c=r[d];e.ObjUtils.isUnset(c)&&(c=r[u]),e.ObjUtils.isUnset(c)?(r[d]=i[d],r[u]=i[d]):(r[d]=c,r[u]=c)}}return r},e.ChemStructureObject=a.create(e.ChemObject,{CLASS_NAME:"Kekule.ChemStructureObject",initialize:function($super,e){this.setPropStoreFieldValue("autoClearStructureCache",!0),$super(e)},doFinalize:function($super){$super()},initProperties:function(){this.defineProp("linkedConnectors",{dataType:l.ARRAY,serializable:!1,scope:a.PropertyScope.PUBLIC}),this.defineProp("linkedObjs",{dataType:l.ARRAY,serializable:!1,scope:a.PropertyScope.PUBLIC,setter:null,getter:function(){for(var t=[],r=0,i=this.getLinkedConnectorCount();r<i;++r)for(var n=this.getLinkedConnectorAt(r),a=n.getConnectedObjs(),o=0,s=a.length;o<s;++o){var l=a[o];l===this||this.hasChildObj&&this.hasChildObj(l)||e.ArrayUtils.pushUnique(t,a[o])}return t}}),this.defineProp("linkedSiblings",{dataType:l.ARRAY,serializable:!1,scope:a.PropertyScope.PUBLIC,setter:null,getter:function(){for(var e=[],t=this.getParent(),r=0,i=this.getLinkedConnectorCount();r<i;++r)for(var n=this.getLinkedConnectorAt(r),a=n.getConnectedObjs(),o=0,s=a.length;o<s;++o){var l=a[o];l!==this&&e.indexOf(l)<0&&(l.getParent()!==t&&(l=t.getDirectChildOfNestedNode(l)),l&&e.push(l))}return e}}),this.defineProp("structureCache",{dataType:l.HASH,serializable:!1,setter:null,getter:function(e){var t=this.getPropStoreFieldValue("structureCache");return!t&&e&&(t={},this.setPropStoreFieldValue("structureCache",t)),t}}),this.defineProp("autoClearStructureCache",{dataType:l.BOOL,serializable:!1})},initPropValues:function($super){$super(),this.setPropStoreFieldValue("linkedConnectors",[]),this.setSuppressChildChangeEventInUpdating(!0)},getAutoIdPrefix:function(){return"o"},getAcceptCoordStickFrom:function(e){return!1},doGetActualCompareOptions:function($super,t){if(t&&t.method===e.ComparisonMethod.CHEM_STRUCTURE){var r=e.ObjComparer.getStructureComparisonDetailOptions(t);return t.customMethod&&(r.customMethod=t.customMethod),t.extraComparisonProperties&&(r.extraComparisonProperties=t.extraComparisonProperties),r}return $super(t)},_getComparisonOptionFlagValue:function(t,r){var i="compare"+r.capitalizeFirst(),n=t[i];return e.ObjUtils.isUnset(n)&&(n=t[r]),n},doGetComparisonPropNames:function($super,t){return t.method===e.ComparisonMethod.CHEM_STRUCTURE?[]:$super(t)},doCompare:function($super,t,r){var i=$super(t,r);if(!i&&r.method===e.ComparisonMethod.CHEM_STRUCTURE&&this._getComparisonOptionFlagValue(r,"linkedConnectorCount")){var n=this.getLinkedNonHydrogenConnectors(),a=t.getLinkedNonHydrogenConnectors&&t.getLinkedNonHydrogenConnectors();i=this.doCompareOnValue(n.length,a&&a.length,r)}return i},compareStructure:function(t,r){var i=Object.create(r||{});return i.method=e.ComparisonMethod.CHEM_STRUCTURE,this.compare(t,i)},equalStructure:function(e,t){return 0===this.compareStructure(e,t)},getParentFragment:function(){var t=this.getParent();return t instanceof e.StructureFragment?t:null},getRootFragment:function(){var e=this.getParentFragment();return e?e.getRootFragment()||e:e},getStructureCacheData:function(e){var t=this.getStructureCache();return t&&t[e]},setStructureCacheData:function(e,t){return this.getStructureCache(!0)[e]=t,this},clearStructureCache:function(){return this.setPropStoreFieldValue("structureCache",null),this},needAutoClearStructureCache:function(){var e=this.getParent();return this.getAutoClearStructureCache()&&(!e||!e.needAutoClearStructureCache||e.needAutoClearStructureCache())},notifyLinkedConnectorsChanged:function(){this.notifyPropSet("linkedConnectors",this.getPropStoreFieldValue("linkedConnectors"))},getCurrConnectableObj:function(){return this},getLinkedConnectorCount:function(){return this.getLinkedConnectors().length},getLinkedConnectorAt:function(e){return this.getLinkedConnectors()[e]},indexOfLinkedConnector:function(e){return this.getLinkedConnectors().indexOf(e)},appendLinkedConnector:function(e){var t=this._doAppendLinkedConnector(e);return e&&e._doAppendConnectedObj(this),t},_doAppendLinkedConnector:function(t){if(!t)return-1;var r=this.getPropStoreFieldValue("linkedConnectors"),i=e.ArrayUtils.pushUniqueEx(r,t);return i.isPushed&&this.notifyLinkedConnectorsChanged(),i.index},insertLinkedConnectorAt:function(e,t){t||(t=0);var r=this.indexOfLinkedConnector(e),i=this.getLinkedConnectors();r>=0?(i.splice(r,1),i.splice(t,0,e),this.notifyLinkedConnectorsChanged()):(i.splice(t,0,e),e&&e._doAppendConnectedObj(this),this.notifyLinkedConnectorsChanged())},insertLinkedConnectorBefore:function(e,t){var r=t?this.indexOfLinkedConnector(t):-1;return r<0?this.appendLinkedConnector(e):this.insertLinkedConnectorAt(e,r)},removeLinkedConnectorAt:function(e){var t=this.getLinkedConnectorAt(e);return t&&t._doRemoveConnectedObjAt(t.indexOfConnectedObj(this)),this._doRemoveLinkedConnectorAt(e)},_doRemoveLinkedConnectorAt:function(t){var r=e.ArrayUtils.removeAt(this.getLinkedConnectors(),t);return r&&this.notifyLinkedConnectorsChanged(),r},removeLinkedConnector:function(e){var t=this.getLinkedConnectors().indexOf(e);t>=0&&this.removeLinkedConnectorAt(t)},getConnectorTo:function(e){for(var t=0,r=this.getLinkedConnectorCount();t<r;++t){var i=this.getLinkedConnectorAt(t);if(i.hasConnectedObj(e))return i}return null},removeThisFromLinkedConnector:function(){for(var e=this.getLinkedConnectorCount()-1;e>=0;--e){this.getLinkedConnectorAt(e).removeConnectedObj(this)}},getLinkedObjsOnConnector:function(t){for(var r=[],i=t.getConnectedObjs(),n=0,a=i.length;n<a;++n)i[n]!==this&&e.ArrayUtils.pushUnique(r,i[n]);return r},getLinkedNonHydrogenConnectors:function(){for(var t=[],r=0,i=this.getLinkedConnectorCount();r<i;++r){var n=this.getLinkedConnectorAt(r);n.isNormalConnectorToHydrogen&&n.isNormalConnectorToHydrogen()||e.ArrayUtils.pushUnique(t,n)}return t},getLinkedNonHydrogenObjs:function(){for(var t=[],r=0,i=this.getLinkedConnectorCount();r<i;++r)for(var n=this.getLinkedConnectorAt(r),a=n.getConnectedObjs(),o=0,s=a.length;o<s;++o)a[o]===this||a[o].isHydrogenAtom&&a[o].isHydrogenAtom()||e.ArrayUtils.pushUnique(t,a[o]);return t},getLinkedHydrogenAtoms:function(){for(var t=[],r=0,i=this.getLinkedConnectorCount();r<i;++r)for(var n=this.getLinkedConnectorAt(r),a=n.getConnectedObjs(),o=0,s=a.length;o<s;++o)a[o]!==this&&a[o].isHydrogenAtom&&a[o].isHydrogenAtom()&&e.ArrayUtils.pushUnique(t,a[o]);return t},getPathesToDest:function(e){return this._doGetPathesToDest(e,[])},_doGetPathesToDest:function(e,r){if(e===this)return[];for(var i,n=[],a=t.clone(r),o=0,s=this.getLinkedConnectorCount();o<s;++o){var l=this.getLinkedConnectorAt(o);if(!(a.indexOf(l)>=0)){a.push(l);for(var d=l.getConnectedObjs(),u=0,c=d.length;u<c;++u){var h=d[u];if(h===e)i=[[]];else{if(h===this)continue;i=h&&h._doGetPathesToDest&&h._doGetPathesToDest(e,a)}if(i){for(var m={connector:l,object:h},g=0,f=i.length;g<f;++g)i[g].unshift(m);n=n.concat(i)}}}}return n.length||(n=null),n},getStructureRelatedPropNames:function(){return["linkedConnectors"]},structureChange:function(e){this.needAutoClearStructureCache()&&(this.clearStructureFlags(),this.clearStructureCache()),this.invokeEvent("structureChange",{origin:e||this})},clearStructureFlags:function(){},relayEvent:function($super,e,t){"structureChange"===e?this.structureChange(t.origin):$super(e,t)},doObjectChange:function($super,t){if(e.ArrayUtils.intersect(t||[],this.getStructureRelatedPropNames()).length&&this.structureChange(),t.length&&-1!=t.indexOf("coord2D")){this.invokeEvent("objectMoved",this.coord2D);var r=this.getLinkedConnectors();if(r)for(var i=0;i<r.length;i++){var n=r[i];if(n instanceof e.Bond){var a=n.deriveBondCenter();n.invokeEvent("objectMoved",a)}}var o=this.getAttachedMarkers();if(o)for(var i=0;i<o.length;i++){var n=o[i];if(n instanceof e.ChemMarker.UnbondedElectronSet){var s=this.coord2D.x+n.coord2D.x,l=this.coord2D.y+n.coord2D.y;n.invokeEvent("objectMoved",{x:s,y:l})}}}}}),e.SimpleStructureNode=a.create(e.ChemStructureObject,{CLASS_NAME:"Kekule.SimpleStructureNode",initialize:function($super,e,t,r){$super(e),t&&this.setCoord2D(t),r&&this.setCoord3D(r)},initProperties:function(){this.defineProp("zIndex2D",{dataType:l.INT,scope:a.PropertyScope.PUBLISHED})},getStructureRelatedPropNames:function($super){return $super().concat(["coord2D","coord3D"])},getAutoIdPrefix:function(){return"n"},getContainerBox:function(t,r){var i=this.getAbsCoordOfMode(t,r);return e.BoxUtils.createBox(i,i)},getContainerBox2D:function(t){return this.getContainerBox(e.CoordMode.COORD2D,t)},getContainerBox3D:function(t){return this.getContainerBox(e.CoordMode.COORD3D,t)}}),e.ClassDefineUtils.addStandardCoordSupport(e.SimpleStructureNode),e.BaseStructureNode=a.create(e.SimpleStructureNode,{CLASS_NAME:"Kekule.BaseStructureNode",initProperties:function(){this.defineProp("coordStickTarget",{dataType:"Kekule.ChemStructureObject",objRef:!0,autoUpdate:!0,getter:function(){return this.getPropStoreFieldValue("coordStickTarget")},setter:function(t){if(t){if(!this.getAllowCoordStickTo(t))return void e.chemError(e.$L("ErrorMsg.COORD_STICK_NOT_ALLOWED_ON_CLASS"));var r=this.getOwner(),i=t.getOwner&&t.getOwner();if(i&&r!==i)return void e.chemError(e.$L("ErrorMsg.UNABLE_TO_STICK_TO_OTHER_OWNER_OBJ"));if(!t.getAcceptCoordStickFrom&&!t.getAcceptCoordStickFrom(this))return void e.chemError(e.$L("ErrorMsg.INVALID_STICK_TARGET_OBJ"));if(!t.getAbsCoordOfMode)return void e.chemError(e.$L("ErrorMsg.UNABLE_TO_STICK_TO_OBJ_WITHOUT_ABS_COORD"));if(t.getCoordStickTarget&&t.getCoordStickTarget()===this)return void e.chemError(e.$L("ErrorMsg.STICK_RECURSION_NOT_ALLOWED"))}var n=this.getCoordStickTarget();this.setPropStoreFieldValue("coordStickTarget",t),this._coordStickTargetChanged(n,t)}})},getAllowCoordStickTo:function(e){return!1},notifyCoordStickTargetChanged:function(e,t){},_getParentAbsCoord:function(e,t){var r=this.getCoordParent();return r&&r.getAbsCoordOfMode&&r.getAbsCoordOfMode(e,t)},_coordStickTargetChanged:function(e,t){e&&!t?this._copyAbsCoordFromStickedTarget(e,this.getCoordParent()):t&&this._copyAbsCoordFromStickedTarget(t,this.getCoordParent()),e&&e.detachCoordStickNodes&&e.detachCoordStickNodes(this),t&&t.attachCoordStickNodes&&t.attachCoordStickNodes(this),this.notifyCoordStickTargetChanged(e,t)},_copyAbsCoordFromStickedTarget:function(t,r,i){var n=e.CoordUtils,a=e.CoordMode;r||(r=this.getCoordParent());var o=i&&i!==a.COORD2D?null:t.getAbsCoord2D(),s=i&&i!==a.COORD2D?null:t.getAbsCoord3D();if(r){if(o){var l=r.getAbsCoord2D&&r.getAbsCoord2D();l&&(o=n.substract(o,l))}if(s){var d=r.getAbsCoord3D&&r.getAbsCoord3D();d&&(s=n.substract(s,d))}}o&&this.setPropStoreFieldValue("coord2D",o),s&&this.setPropStoreFieldValue("coord3D",s)},doGetCoord2D:function($super,t,r){var i=this.getCoordStickTarget();if(i&&i.getAbsCoord2D){var n=i.getAbsCoord2D(t,r),a=this._getParentAbsCoord(e.CoordMode.COORD2D,t);return a&&(n=e.CoordUtils.substract(n,a)),n}return $super(t,r)},doGetCoord3D:function($super,t,r){var i=this.getCoordStickTarget();if(i&&i.getAbsCoord3D){var n=i.getAbsCoord3D(t,r),a=this._getParentAbsCoord(e.CoordMode.COORD3D,t);return a&&(n=e.CoordUtils.substract(n,a)),n}return $super(t,r)}}),e.StereoParity={NONE:null,LINEAR:-1,ODD:1,EVEN:2,UNKNOWN:0},e.ChemStructureNode=a.create(e.BaseStructureNode,{CLASS_NAME:"Kekule.ChemStructureNode",initialize:function($super,e,t,r){$super(e),t&&this.setCoord2D(t),r&&this.setCoord3D(r)},initProperties:function(){this.defineProp("charge",{dataType:l.FLOAT,getter:function(){return this.getPropStoreFieldValue("charge")||0}}),this.defineProp("radical",{dataType:l.INT,getter:function(){return this.getPropStoreFieldValue("radical")||0}}),this.defineProp("parity",{dataType:l.INT,getter:function(){return this.getPropStoreFieldValue("parity")||0}}),this.defineProp("isAnchor",{dataType:l.BOOL,serializable:!1,getter:function(){var e=this.getParent();return!(!e||!e.indexOfAnchorNode)&&e.indexOfAnchorNode(this)>=0},setter:function(e){if(e!==this.getIsAnchor()){var t=this.getParent();t&&(e&&t.appendAnchorNode()?t.appendAnchorNode(this):!e&&t.removeAnchorNode&&t.removeAnchorNode(this))}}})},getStructureRelatedPropNames:function($super){return $super().concat(["charge","radical"])},getLabel:function(){return null},getAcceptCoordStickFrom:function(t){return!(this.isSiblingWith(t)||t instanceof e.ChemStructureNode)},doGetComparisonPropNames:function($super,t){var r=$super(t);return t.method===e.ComparisonMethod.CHEM_STRUCTURE&&(this._getComparisonOptionFlagValue(t,"charge")&&r.push("charge"),this._getComparisonOptionFlagValue(t,"radical")&&r.push("radical")),r},doCompare:function($super,t,r){var i=$super(t,r);if(!i&&r.method===e.ComparisonMethod.CHEM_STRUCTURE&&this._getComparisonOptionFlagValue(r,"stereo")){var n=this.getParity()||e.StereoParity.UNKNOWN,a=t.getParity&&t.getParity()||e.StereoParity.UNKNOWN;i=this.doCompareOnValue(n,a,r)}return i},getPrimaryIsotope:function(){return null},getLinkedChemNodes:function(t){for(var r=this.getLinkedObjs(),i=[],n=0,a=r.length;n<a;++n){var o=r[n];!(o instanceof e.ChemStructureNode)||t&&o.isHydrogenAtom&&o.isHydrogenAtom()||i.push(o)}return i},getLinkedBonds:function(t){for(var r=[],i=0,n=this.getLinkedConnectorCount();i<n;++i){var a=this.getLinkedConnectorAt(i);a instanceof e.Bond&&(!t||a.getBondType()===t)&&r.push(a)}return r},getLinkedMultiCenterBonds:function(){for(var t=[],r=0,i=this.getLinkedConnectorCount();r<i;++r){var n=this.getLinkedConnectorAt(r);n instanceof e.Bond&&n.getConnectedObjCount()>2&&t.push(n)}return t},getLinkedMultipleBonds:function(){for(var t=e.BondOrder,r=[],i=0,n=this.getLinkedConnectorCount();i<n;++i){var a=this.getLinkedConnectorAt(i);if(a instanceof e.Bond&&a.getBondType()===e.BondType.COVALENT){var o=a.getBondOrder();o!==t.DOUBLE&&o!==t.TRIPLE&&o!==t.QUAD&&o!==t.EXPLICIT_AROMATIC||r.push(a)}}return r},getLinkedDoubleBonds:function(){for(var t=e.BondOrder,r=[],i=0,n=this.getLinkedConnectorCount();i<n;++i){var a=this.getLinkedConnectorAt(i);if(a instanceof e.Bond&&a.getBondType()===e.BondType.COVALENT){a.getBondOrder()===t.DOUBLE&&r.push(a)}}return r},clearStructureFlags:function(){this.setPropStoreFieldValue("parity",e.StereoParity.NONE)},isHydrogenAtom:function(){return!1}}),e.RadicalType=e.RadicalOrder,e.AbstractAtom=a.create(e.ChemStructureNode,{CLASS_NAME:"Kekule.AbstractAtom",initialize:function($super,e,t,r){$super(e,t,r)},initProperties:function(){this.defineProp("explicitHydrogenCount",{dataType:l.INT,scope:a.PropertyScope.PUBLISHED})},getAutoIdPrefix:function(){return"a"},getStructureRelatedPropNames:function($super){return $super().concat(["explicitHydrogenCount"])},doCompare:function($super,t,r){var i=$super(t,r);if(!i&&r.method===e.ComparisonMethod.CHEM_STRUCTURE&&this._getComparisonOptionFlagValue(r,"hydrogenCount")){var n=this.getHydrogenCount(!0),a=t.getHydrogenCount&&t.getHydrogenCount(!0);i=this.doCompareOnValue(n,a)}if(!i&&r.method===e.ComparisonMethod.CHEM_STRUCTURE){var n=this.getAttachedMarkers()?this.getAttachedMarkers().reduce(function(e,t){return e+(t.getElectronCount?t.getElectronCount():0)},0):0,a=t.getAttachedMarkers()?t.getAttachedMarkers().reduce(function(e,t){return e+(t.getElectronCount?t.getElectronCount():0)},0):0;i=this.doCompareOnValue(n,a)}return i},getHydrogenCount:function(e){var t=this.getExplicitHydrogenCount()||0;if(e){t+=this.getLinkedHydrogenAtoms().length||0}return t},setHydrogenCount:function(e){return this.setExplicitHydrogenCount(e)},isSaturated:function(){return!this.getLinkedMultipleBonds().length},mayContainElement:function(t){var r;return r="string"==typeof t?e.ChemicalElementsDataUtil.getAtomicNumber(t):t,this.doMayContainElement(r)},doMayContainElement:function(e){return!1}}),e.Atom=a.create(e.AbstractAtom,{CLASS_NAME:"Kekule.Atom",initialize:function($super,e,t,r,i,n){$super(e,i,n),(t||r)&&this.changeIsotope(t,r)},initProperties:function(){this.defineProp("isotope",{dataType:"Kekule.Isotope",serializable:!1}),this.defineProp("isotopeId",{dataType:l.STRING,serializable:!0,getter:function(){var t=this.getIsotope();return t?t.getIsotopeId():e.Element.UNSET_ELEMENT},setter:function(t){var r=e.IsotopeFactory.getIsotopeById(t);r&&this.setIsotope(r)}}),this.defineProp("symbol",{dataType:l.STRING,serializable:!1,getter:function(){var t=this.getIsotope();return t?t.getSymbol():e.Element.UNSET_ELEMENT},setter:function(e){this.changeElement(e)}}),this.defineProp("atomicNumber",{dataType:l.INTEGER,serializable:!1,getter:function(){var e=this.getIsotope();return e?e.getAtomicNumber():0},setter:function(e){this.changeElement(e)}}),this.defineProp("massNumber",{dataType:l.INTEGER,getter:function(){var t=this.getIsotope();return t?t.getMassNumber():e.Isotope.UNSET_MASSNUMBER},setter:function(e){this.changeMassNumber(e)}}),this.defineProp("isotopeAlias",{dataType:l.STRING,getter:function(){var e=this.getIsotope();return e?e.getIsotopeAlias():void 0},setter:function(e){this.changeElement(e)}}),this.defineProp("atomType",{dataType:l.OBJECT,serializable:!1,scope:a.PropertyScope.PUBLIC}),this.defineProp("atomTypeId",{dataType:l.STRING,getter:function(){var t=this.getPropStoreFieldValue("atomType");return t?t.id:e.AtomType.UNSET_ATOMTYPE},setter:function(t){if(this.isNormalAtom()){var r=e.AtomTypeDataUtil.getAtomTypeFromId(this.getAtomicNumber(),t);this.setAtomType(r)}}}),this.defineProp("hybridizationType",{dataType:l.INT,enumSource:e.HybridizationType})},getAutoIdPrefix:function(){return"a"},getStructureRelatedPropNames:function($super){return $super().concat(["isotope","atomType"])},doGetComparisonPropNames:function($super,t){var r=$super(t);return t.method===e.ComparisonMethod.CHEM_STRUCTURE&&(this._getComparisonOptionFlagValue(t,"atom")&&r.push("atomicNumber"),this._getComparisonOptionFlagValue(t,"mass")&&r.push("massNumber")),r},getPrimaryIsotope:function(){return this.getIsotope()},getLabel:function(){return""+(this.getMassNumber()||"")+this.getSymbol()},doMayContainElement:function(e){return this.getAtomicNumber()===e},changeIsotope:function(t,r){t===e.Element.UNSET_ELEMENT?r=e.Isotope.UNSET_MASSNUMBER:t||(t=this.getAtomicNumber()),r||(r=e.Isotope.UNSET_MASSNUMBER),this.getAtomicNumber()!==t&&this.setAtomType(e.AtomType.UNSET_ATOMTYPE);var i=e.IsotopeFactory.getIsotope(t,r);this.setIsotope(i)},changeElement:function(t){return this.changeIsotope(t,e.Isotope.UNSET_MASSNUMBER)},changeMassNumber:function(e){return this.changeIsotope(null,e)},isElement:function(e){return this.getSymbol()===e||this.getAtomicNumber()===e},isNormalAtom:function(){var e=this.getIsotope();return!!e&&e.isNormalElement()},isHydrogenAtom:function(){return this.isElement(1)&&(!this.getMassNumber()||this.getMassNumber()<=1)},_getCurrCovalentBondsInfo:function(){for(var t=0,r=0,i=this.getStructureCacheData("piElectronCount")||null,n=0,a=this.getLinkedConnectorCount();n<a;++n){var o=this.getLinkedConnectorAt(n);if(o instanceof e.Bond&&o.getBondType()==e.BondType.COVALENT){var s;s=o.getBondOrder()===e.BondOrder.EXPLICIT_AROMATIC&&i>=2?1:o.getBondValence(),t+=s,s>r&&(r=s)}}return{valenceSum:t,maxValence:r}},_getCurrIonicBondsInfo:function(){for(var t=0,r=0,i=0,n=this.getLinkedConnectorCount();i<n;++i){var a=this.getLinkedConnectorAt(i);if(a instanceof e.Bond&&a.getBondType()==e.BondType.IONIC){var o=a.getBondValence();t+=o,o>r&&(r=o)}}return{valenceSum:t,maxValence:r}},guessAtomType:function(){if(this.isNormalAtom()){var t=null,r=null,i=this._getCurrCovalentBondsInfo(),n=e.AtomTypeDataUtil.getAllAtomTypes(this.getAtomicNumber());if(n){for(var a=0,o=n.length;a<o;++a){var s=n[a];if(r=s,s.bondOrderSum>=i.valenceSum&&(t=s,s.maxBondOrder>=i.maxValence))return s}return t||r}}return null},getProximalAtomType:function(){return this.getAtomType()||this.guessAtomType()},getImplicitValence:function(){if(this.isNormalAtom()){var t=this._getCurrCovalentBondsInfo(),r=t.valenceSum,i=Math.round(this.getCharge()||0);return e.ValenceUtils.getImplicitValence(this.getAtomicNumber(),i,r)}return 0},getImplicitHydrogenCount:function(){if(this.isNormalAtom()){var t=this._getCurrCovalentBondsInfo(),r=this._getCurrIonicBondsInfo(),i=this.getImplicitValence();i-=e.RadicalOrder.getRadicalElectronCount(this.getRadical());var n=this.getExplicitHydrogenCount()?this.getExplicitHydrogenCount():0,a=Math.max(i-t.valenceSum-r.valenceSum,0);return Math.max(0,a-n-this.getSingleElectronCount())}return 0},getHydrogenCount:function(t){var r;return r=e.ObjUtils.isUnset(this.getExplicitHydrogenCount())?this.getImplicitHydrogenCount()||0:this.getExplicitHydrogenCount()||0,t&&(r+=this.getLinkedHydrogenAtoms().length||0),r},getAtomicMass:function(){var e=null,t=this.getIsotope();return t&&(e=t.getExactMass()||t.getNaturalMass()),e}}),e.PseudoatomType={DUMMY:"dummy",ANY:"any",HETERO:"hetero",CUSTOM:"custom"},e.Pseudoatom=a.create(e.AbstractAtom,{CLASS_NAME:"Kekule.Pseudoatom",initialize:function($super,t,r,i,n,a){$super(t,n,a),r&&this.setAtomType(r),i&&r==e.PseudoatomType.CUSTOM&&this.setSymbol(i)},initProperties:function(){this.defineProp("atomType",{dataType:l.STRING,enumSource:e.PseudoatomType}),this.defineProp("symbol",{dataType:l.STRING,getter:function(){var t=this.getAtomType(),r=e.PseudoatomType,i=e.ChemStructureNodeLabels;return t===r.DUMMY?i.DUMMY_ATOM:t===r.ANY?i.ANY_ATOM:t===r.HETERO?i.HETERO_ATOM:this.getPropStoreFieldValue("symbol")||i.CUSTOM_ATOM},setter:function(t){var r=e.PseudoatomType,i=e.ChemStructureNodeLabels;if(t){var n=t===i.DUMMY_ATOM?r.DUMMY:t===i.ANY_ATOM?r.ANY:t===i.HETERO_ATOM?r.HETERO:r.CUSTOM;this.setAtomType(n)}this.setPropStoreFieldValue("symbol",t)}})},getStructureRelatedPropNames:function($super){return $super().concat(["atomType","symbol"])},getPrimaryIsotope:function(){return null},getLabel:function(){return this.getSymbol()},doGetComparisonPropNames:function($super,t){var r=$super(t);return t.method===e.ComparisonMethod.CHEM_STRUCTURE&&this._getComparisonOptionFlagValue(t,"atom")&&r.push("atomType"),r},doCompare:function($super,t,r){var i=$super(t,r);if(!i&&r.method===e.ComparisonMethod.CHEM_STRUCTURE&&this._getComparisonOptionFlagValue(r,"atom")&&this.getAtomType()===e.PseudoatomType.CUSTOM){var n=this.getSymbol(),a=t.getSymbol&&t.getSymbol();i=this.doCompareOnValue(n,a,r)}return i},doMayContainElement:function(t){var r=e.PseudoatomType,i=this.getAtomType();if(i===r.ANY)return!0;if(i===r.HETERO){if([1,6].indexOf(t)>=0)return!1;return"Nonmetals"===e.ChemicalElementsDataUtil.getElementInfo(t).chemicalSerie}return!1}}),e.VariableAtom=a.create(e.AbstractAtom,{CLASS_NAME:"Kekule.VariableAtom",initProperties:function(){this.defineProp("allowedIsotopeIds",{dataType:l.ARRAY,getter:function(e){var t=this.getPropStoreFieldValue("allowedIsotopeIds");return!t&&e&&(t=[],this.setPropStoreFieldValue("allowedIsotopeIds",t)),t}}),this.defineProp("disallowedIsotopeIds",{dataType:l.ARRAY,getter:function(e){var t=this.getPropStoreFieldValue("disallowedIsotopeIds");return!t&&e&&(t=[],this.setPropStoreFieldValue("disallowedIsotopeIds",t)),t}}),this.defineProp("allowedIsotopes",{dataType:l.ARRAY,setter:null,getter:function(){return this._getIsotopesFromIds(this.getAllowedIsotopeIds())}}),this.defineProp("disallowedIsotopes",{dataType:l.ARRAY,setter:null,getter:function(){return this._getIsotopesFromIds(this.getDisallowedIsotopeIds())}})},getStructureRelatedPropNames:function($super){return $super().concat(["allowedIsotopeIds","disallowedIsotopeIds"])},getPrimaryIsotope:function(){if(this.isDisallowedList())return null;var t=this.getAllowedIsotopeIds(),r=t?t[0]:null;return r?e.IsotopeFactory.getIsotopeById(r):null},getLabel:function(){return e.ChemStructureNodeLabels.VARIABLE_ATOM},doCompare:function($super,t,r){var i=$super(t,r);if(!i&&r.method===e.ComparisonMethod.CHEM_STRUCTURE&&this._getComparisonOptionFlagValue(r,"atom")){var n=e.ArrayUtils,a=this.getAllowedIsotopeIds(),o=t.getAllowedIsotopeIds&&t.getAllowedIsotopeIds();if(a)a=n.clone(a).sort(),o&&o.length&&(o=n.clone(o).sort()),i=this.doCompareOnValue(a,o,r);else if(o)i=1;else{var s=this.getDisallowedIsotopeIds(),l=t.getDisallowedIsotopeIds&&t.getDisallowedIsotopeIds();s&&s.length&&(s=n.clone(s).sort()),l&&l.length&&(l=n.clone(l).sort()),i=this.doCompareOnValue(s,l,r)}}return i},doMayContainElement:function(t){var r=function(t,r){if(!r)return!1;for(var i=0,n=r.length;i<n;++i){var a=r[i],o=e.IsotopesDataUtil.getIsotopeIdDetail(a),s=o.symbol;if(e.ChemicalElementsDataUtil.getAtomicNumber(s)===t)return!0}return!1},i=this.getAllowedIsotopeIds();return i?r(t,i):(i=this.getDisallowedIsotopeIds())?!r(t,i):void 0},isDisallowedList:function(){return this.getDisallowedIsotopeIds()&&!this.getAllowedIsotopeIds()},isListEmpty:function(){var e=this.getAllowedIsotopeIds(),t=!e||!e.length;return t&&(e=this.getDisallowedIsotopeIds(),t=!e||!e.length),t},fetchAllowedIsotopeIds:function(){return this.doGetAllowedIsotopeIds(!0)},fetchDisallowedIsotopeIds:function(){return this.doGetDisallowedIsotopeIds(!0)},_getIsotopesFromIds:function(t){if(!t)return null;for(var r=[],i=0,n=t.length;i<n;++i){var a=t[i],o=e.IsotopeFactory.getIsotopeById(a);o&&r.push(o)}return r}}),e.MolecularFormula=a.create(s,{CLASS_NAME:"Kekule.MolecularFormula",initialize:function($super,e){$super(),this.setPropStoreFieldValue("sections",[]),e&&this.setPropStoreFieldValue("parent",e),this.setBubbleEvent(!0)},initProperties:function(){this.defineProp("parent",{dataType:"Kekule.StructureFragment",serializable:!1,setter:null,scope:a.PropertyScope.PUBLIC}),this.defineProp("sections",{dataType:l.ARRAY,setter:null}),this.defineProp("charge",{dataType:l.FLOAT,getter:function(){return this.getPropStoreFieldValue("charge")||0}}),this.defineProp("radical",{dataType:l.INT,getter:function(){return this.getPropStoreFieldValue("radical")||0}})},getHigherLevelObj:function(){return this.getParent()},isEmpty:function(){return this.getSectionCount()<=0},notifySectionsChanged:function(){this.notifyPropSet("sections",this.getPropStoreFieldValue("sections"))},createSectionItem:function(e,t,r){var i={obj:e,count:t||1};return r&&e.setCharge(r),e.setParent&&e.setParent(this.getParent()),i},getTotalCharge:function(){for(var e=0,t=this.getSections(),r=0,i=t.length;r<i;++r)t[r].obj.getCharge&&(e+=t[r].obj.getCharge()*(t.count||1));return this.getCharge()&&(e+=this.getCharge()),e},indexOfObj:function(e){for(var t=this.getSections(),r=0,i=t.length;r<i;++r)if(t[r].obj==e)return r;return-1},getSectionCount:function(){return this.getSections().length},getSectionAt:function(e){return this.getSections()[e]},getSectionCharge:function(e){var t,r=0;return t="object"!=(void 0===e?"undefined":n(e))?this.getSectionAt(e):e,t.obj.getCharge&&(r+=t.obj.getCharge()||0),r},appendSection:function(e,t,r){var i=this.createSectionItem(e,t,r);return this.getSections().push(i),this.notifySectionsChanged(),i},insertSection:function(e,t,r,i){var n=this.createSectionItem(t,r,i);return this.getSections().splice(e,0,n),this.notifySectionsChanged(),n},removeSectionAt:function(e){var t=this.getSections().splice(e,1);return t&&this.notifySectionsChanged(),t},clear:function(){this.beginUpdate();try{this.setCharge(null),this.setRadical(null),this.setPropStoreFieldValue("sections",[]),this.notifySectionsChanged()}finally{this.endUpdate()}},removeObj:function(e){var t=this.indexOfObj(e);if(!(t>=0))return null;this.removeSectionAt(t);this.notifySectionsChanged()},getMaxNestedLevel:function(){for(var t=0,r=0,i=this.getSectionCount();r<i;++r){var n=this.getSectionAt(r);if(n.obj instanceof e.MolecularFormula){var a=n.obj.getMaxNestedLevel()+1;a>t&&(t=a)}}return t},getSimpleIsotopeMaps:function(){}}),e.StructureConnectionTable=a.create(s,{CLASS_NAME:"Kekule.StructureConnectionTable",TRAVERS_VISITED_KEY:"__$ctabTraversVisited__",initialize:function($super,e,t){$super(),e&&this.setOwner(e),t&&this.setPropStoreFieldValue("parent",t)},initProperties:function(){this.defineProp("owner",{dataType:"Kekule.ChemSpace",serializable:!1,scope:a.PropertyScope.PUBLIC,setter:function(e){e!=this.getPropStoreFieldValue("owner")&&(this.setPropStoreFieldValue("owner",e),this.ownerChanged(e))}}),this.defineProp("parent",{dataType:"Kekule.StructureFragment",serializable:!1,scope:a.PropertyScope.PUBLIC,setter:function(e){e!=this.getPropStoreFieldValue("parent")&&(this.setPropStoreFieldValue("parent",e),this.parentChanged(e))}}),this.defineProp("nodes",{dataType:l.ARRAY}),this.defineProp("anchorNodes",{dataType:l.ARRAY,setter:null}),this.defineProp("connectors",{dataType:l.ARRAY}),this.defineProp("nonHydrogenNodes",{dataType:l.ARRAY,scope:a.PropertyScope.PUBLIC,serializable:!1,setter:null,getter:function(){for(var e=[],t=0,r=this.getNodeCount();t<r;++t){var i=this.getNodeAt(t);i.isHydrogenAtom&&i.isHydrogenAtom()||e.push(i)}return e}}),this.defineProp("nonHydrogenConnectors",{dataType:l.ARRAY,scope:a.PropertyScope.PUBLIC,serializable:!1,setter:null,getter:function(){for(var e=[],t=0,r=this.getConnectorCount();t<r;++t){var i=this.getConnectorAt(t);i.isNormalConnectorToHydrogen&&i.isNormalConnectorToHydrogen()||e.push(i)}return e}}),this.defineProp("structureCache",{dataType:l.HASH,serializable:!1,setter:null,getter:function(e){var t=this.getParent();return t&&t.getStructureCache(e)}}),this.defineProp("hydrogenNodes",{dataType:l.ARRAY,scope:a.PropertyScope.PUBLIC,serializable:!1,setter:null,getter:function(){for(var e=[],t=0,r=this.getNodeCount();t<r;++t){var i=this.getNodeAt(t);i.isHydrogenAtom&&i.isHydrogenAtom()&&e.push(i)}return e}}),this.defineProp("hydrogenConnectors",{dataType:l.ARRAY,scope:a.PropertyScope.PUBLIC,serializable:!1,setter:null,getter:function(){for(var e=[],t=0,r=this.getConnectorCount();t<r;++t){var i=this.getConnectorAt(t);i.isNormalConnectorToHydrogen&&i.isNormalConnectorToHydrogen()&&e.push(i)}return e}})},initPropValues:function($super){$super(),this.setPropStoreFieldValue("nodes",[]),this.setPropStoreFieldValue("anchorNodes",[]),this.setPropStoreFieldValue("connectors",[])},getHigherLevelObj:function(){return this.getParent()||this.getOwner()},doSaveProp:function(e,t,r,i){var n=t.name;switch(n){case"anchorNodes":for(var a=[],o=0,s=e.getAnchorNodeCount();o<s;++o){var l=e.getAnchorNodeAt(o),d=e.indexOfNode(l);a.push(d)}var u=i.createChildStorageNode(r,i.propNameToStorageName(n),!0);return i.save(a,u),!0;case"connectors":for(var u=i.createChildStorageNode(r,i.propNameToStorageName(n),!0),o=0,s=e.getConnectorCount();o<s;++o){var c=e.getConnectorAt(o),h=i.getNameForArrayItemStorageNode(c),m=i.appendArrayItemStorageNode(u,i.propNameToStorageName(h),i.isArray(c));i.setStorageNodeExplicitType(m,i.getValueExplicitType(c)),i.save(c,m);for(var g=[],f=0,p=c.getConnectedObjCount();f<p;++f){var C=c.getConnectedObjAt(f),d=e.indexOfChild(C);if(d>=0)g.push(d);else{var b=e.indexStackOfChild(C);null!==b&&void 0!==b&&g.push(b)}}if(g.length){var E=i.createChildStorageNode(m,i.propNameToStorageName("connectedObjs"),!0);i.save(g,E)}}return!0;default:return!1}},doLoadProp:function(t,r,i,n){var a=r.name;switch(a){case"anchorNodes":var o=[],s=n.getChildStorageNode(i,n.propNameToStorageName(a));return n.load(o,s,e),t.__load_anchorNodes_indexes=o,!0;case"connectors":for(var d,s=n.getChildStorageNode(i,n.propNameToStorageName(a)),u=n.getAllArrayItemStorageNodes(s),c=0,h=u.length;c<h;++c){var m=u[c],g=n.getStorageNodeExplicitType(m)||n.getStorageNodeName(m);if(g){d=l.createInstance(g,e),n.load(d,m,e);var f=n.getChildStorageNode(m,n.propNameToStorageName("connectedObjs"));if(f){var p=[];n.load(p,f,e),d.__load_connectedObj_indexes=p}var C=n.getChildStorageNode(m,n.propNameToStorageName("connectedNodes"));if(C){var b=[];n.load(b,C,e),d.__load_connectedNode_indexes=b}var E=n.getChildStorageNode(m,n.propNameToStorageName("connectedConnectors"));if(E){var N=[];n.load(N,E,e),d.__load_connectedConnector_indexes=N}t.appendConnector(d)}}return!0;default:return!1}},loaded:function($super){if(this.__load_anchorNodes_indexes){for(var e=0,t=this.__load_anchorNodes_indexes.length;e<t;++e){var r=this.__load_anchorNodes_indexes[e];this.appendAnchorNode(this.getNodeAt(r))}delete this.__load_anchorNodes_indexes}for(var e=0,t=this.getConnectorCount();e<t;++e){var i=this.getConnectorAt(e);if(i.__load_connectedObj_indexes){for(var a=0,o=i.__load_connectedObj_indexes.length;a<o;++a){var s,r=i.__load_connectedObj_indexes[a];s="object"==(void 0===r?"undefined":n(r))?this.getChildAtIndexStack(r):this.getChildAt(r),s&&i.appendConnectedObj(s)}delete i.__load_connectedObj_indexes}if(i.__load_connectedNode_indexes){for(var a=0,o=i.__load_connectedNode_indexes.length;a<o;++a){var r=i.__load_connectedNode_indexes[a];"object"==(void 0===r?"undefined":n(r))?i.appendConnectedObj(this.getNodeAtIndexStack(r)):i.appendConnectedObj(this.getNodeAt(r))}delete i.__load_connectedNode_indexes}if(i.__load_connectedConnector_indexes){for(var a=0,o=i.__load_connectedConnector_indexes.length;a<o;++a){var r=i.__load_connectedConnector_indexes[a];i.appendConnectedObj(this.getConnectorAt(r))}delete i.__load_connectedConnector_indexes}}this.ownerChanged(this.getOwner()),this.parentChanged(this.getParent()),$super()},notifyNodesChanged:function(){this.notifyPropSet("nodes",this.getPropStoreFieldValue("nodes"))},notifyAnchorNodesChanged:function(){this.notifyPropSet("anchorNodes",this.getPropStoreFieldValue("anchorNodes"))},notifyConnectorsChanged:function(){this.notifyPropSet("connectors",this.getPropStoreFieldValue("connectors"))},ownerChanged:function(e){for(var t=0,r=this.getNodeCount();t<r;++t)this.getNodeAt(t).setOwner(e);for(var t=0,r=this.getConnectorCount();t<r;++t)this.getConnectorAt(t).setOwner(e)},parentChanged:function($super,e,t){for(var r=0,i=this.getNodeCount();r<i;++r)this.getNodeAt(r).setParent(e);for(var r=0,i=this.getConnectorCount();r<i;++r)this.getConnectorAt(r).setParent(e)},isEmpty:function(){return this.getNodeCount()<=0&&this.getConnectorCount()<=0},getStructureCacheData:function(e){var t=this.getStructureCache();return t&&t[e]},setStructureCacheData:function(e,t){var r=this.getParent();return r&&r.setStructureCacheData&&r.setStructureCacheData(e,t),this},clearStructureCache:function(){var e=this.getParent();return e&&e.clearStructureCache(),this},getNodeById:function(e){for(var t=this.getNodes(),r=0,i=t.length;r<i;++r){var n=t[r],a=n.getAttachedMarkers&&n.getAttachedMarkers();if(n.getId()===e)return n;if(a&&a.length)for(var o=0;o<a.length;o++){var s=a[o];if(s.getId()===e)return s}}return null},getConnectorById:function(e){for(var t=this.getConnectors(),r=0,i=t.length;r<i;++r)if(t[r].getId()==e)return t[r];return null},getObjectById:function(e){var t=this.getNodeById(e);return t||this.getConnectorById(e)},getNodeCount:function(){return this.getNodes().length},getNodeAt:function(e){return this.getNodes()[e]},indexOfNode:function(e){return this.getNodes().indexOf(e)},hasNode:function(e,t){var r=this.indexOfNode(e)>=0;if(!r&&t)for(var i=0,n=this.getNodeCount();i<n;++i){var a=this.getNodeAt(i);if(a.hasNode&&(r=a.hasNode(e,!0)),r)break}return r},indexStackOfNode:function(t){var r=this.indexOfNode(t);if(r>=0)return r;for(var i=null,a=0,o=this.getNodeCount();a<o;++a){var s=this.getNodeAt(a);if(s.indexStackOfNode&&(i=s.indexStackOfNode(t),!e.ObjUtils.isUnset(i)))return"object"!=(void 0===i?"undefined":n(i))&&(i=[i]),i.unshift(a),i}return i},getNodeAtIndexStack:function(t){if(t=e.ArrayUtils.toArray(t),t.length<=0)return null;for(var r=this.getNodeAt(t[0]),i=1,n=t.length;i<n;++i){if(!r||!r.getNodeAt)return null;r=r.getNodeAt(t[i])}return r},insertNodeBefore:function(e,t){var r=this.indexOfNode(t);r?this.insertNodeAt(e,r):this.appendNode(e)},appendNode:function(t){var r=e.ArrayUtils.pushUniqueEx(this.getNodes(),t);return r.isPushed&&(t.setOwner&&t.setOwner(this.getOwner()),t.setParent&&t.setParent(this.getParent()),this.notifyNodesChanged()),r.index},insertNodeAt:function(t,r){var i=this.indexOfNode(t),n=this.getNodes();return(e.ObjUtils.isUnset(r)||r<0)&&(r=n.length),i>=0?(n.splice(i,1),n.splice(r,0,t)):(n.splice(r,0,t),t.setOwner&&t.setOwner(this.getOwner()),t.setParent&&t.setParent(this.getParent())),this.notifyNodesChanged(),r},setNodeIndex:function(e,t){var r=this.getNodes(),i=this.indexOfNode(e);i>=0&&(r.splice(i,1),r.splice(t,0,e))},removeNodeAt:function(e,t){var r=this.getNodes()[e];r&&(t||r.removeThisFromLinkedConnector(),this.getNodes().splice(e,1),r.setOwner&&r.setOwner(null),r.setParent&&r.setParent(null),this.notifyNodesChanged())},removeNode:function(e,t){var r=this.getNodes().indexOf(e);r>=0&&this.removeNodeAt(r,t)},replaceNode:function(t,r){if(!this.hasNode(t))return this;this.insertBefore(r,t);var i=this.getAnchorNodes(),n=i.indexOf(t);n>=0&&i.splice(n,1,[r]);for(var a=e.ArrayUtils.clone(t.getLinkedConnectors()),o=0,s=a.length;o<s;++o){var l=a[o];l.replaceConnectedObj(t,r)}if(t.getNodes&&t.getCrossConnectors)for(var d=e.ArrayUtils.clone(t.getCrossConnectors()),o=0,s=d.length;o<s;++o){var l=d[o];if(this.indexOfConnector(l)>=0)for(var u=0,c=l.getConnectedObjCount();u<c;++u){var h=l.getConnectedObjAt(u);t.indexOfChild(h)>=0&&l.replaceConnectedObj(h,r)}l.replaceConnectedObj(t,r)}this.removeNode(t)},clearNodes:function(){this.clearAnchorNodes(),this.setPropStoreFieldValue("nodes",[]),this.notifyAnchorNodesChanged(),this.notifyNodesChanged()},sortNodes:function(t){t?(this.getNodes().sort(t),this.notifyNodesChanged()):e.error(e.$L("ErrorMsg.SORT_FUNC_UNSET"))},nodesHasCoord2D:function(e){for(var t=this.getNodes(),r=0,i=t.length;r<i;++r)if(t[r].hasCoord2D(e))return!0;return!1},nodesHasCoord3D:function(e){for(var t=this.getNodes(),r=0,i=t.length;r<i;++r)if(t[r].hasCoord3D(e))return!0;return!1},_createAtom:function(t,r,i,n){return new e.Atom(null,t,r,i,n)},appendAtom:function(e,t,r,i){var n=this._createAtom(e,t,r,i);return n&&this.appendNode(n),n},getAnchorNodeCount:function(){return this.getAnchorNodes().length},indexOfAnchorNode:function(e){return this.getAnchorNodes().indexOf(e)},getAnchorNodeAt:function(e){return this.getAnchorNodes()[e]},appendAnchorNode:function(t){if(!t)return-1;if(this.getNodes().indexOf(t)>=0){var r=e.ArrayUtils.pushUniqueEx(this.getAnchorNodes(),t);return r.isPushed&&this.notifyAnchorNodesChanged(),r.index}return-1},removeAnchorNodeAt:function(e){this.getAnchorNodes()[e]&&(this.getAnchorNodes().splice(e,1),this.notifyAnchorNodesChanged())},removeAnchorNode:function(e){var t=this.getAnchorNodes().indexOf(e);t>=0&&this.removeAnchorNodeAt(t)},clearAnchorNodes:function(){this.setPropStoreFieldValue("anchorNodes",[]),this.notifyAnchorNodesChanged()},getConnectorCount:function(){return this.getConnectors().length},indexOfConnector:function(e){return this.getConnectors().indexOf(e)},getConnectorAt:function(e){return this.getConnectors()[e]},indexStackOfConnector:function(t){var r=this.indexOfConnector(t);if(r>=0)return r;for(var i=null,a=0,o=this.getNodeCount();a<o;++a){var s=this.getNodeAt(a);if(s.indexStackOfConnector&&(i=s.indexStackOfConnector(t),!e.ObjUtils.isUnset(i)))return"object"!=(void 0===i?"undefined":n(i))&&(i=[i]),i.unshift(a),i}return i},getConnectorAtIndexStack:function(t){if(t=e.ArrayUtils.toArray(t),t.length<=0)return null;if(1===t.length)return this.getConnectorAt(t[0]);for(var r=t.length-1,i=this.getNodeAt(t[0]),n=1;n<r;++n){if(!i||!i.getNodeAt)return null;i=i.getNodeAt(t[n])}return i?i.getConnectorAt(t[r]):null},insertConnectorBefore:function(e,t){var r=this.indexOfConnector(t);r?this.insertConnectorAt(e,r):this.appendConnector(e)},appendConnector:function(t){var r=e.ArrayUtils.pushUniqueEx(this.getConnectors(),t);return r.isPushed&&(t.setOwner&&t.setOwner(this.getOwner()),t.setParent&&t.setParent(this.getParent()),this.notifyConnectorsChanged()),r.index},insertConnectorAt:function(t,r){var i=this.indexOfConnector(t),n=this.getConnectors();(e.ObjUtils.isUnset(r)||r<0)&&(r=n.length),i>=0?(n.splice(i,1),n.splice(r,0,t)):(n.splice(r,0,t),t.setOwner&&t.setOwner(this.getOwner()),t.setParent&&t.setParent(this.getParent())),this.notifyConnectorsChanged()},setConnectorIndex:function(e,t){var r=this.getConnectors(),i=this.indexOfConnector(e);i>=0&&(r.splice(i,1),r.splice(t,0,e))},removeConnectorAt:function(e,t){var r=this.getConnectors()[e];r&&(t||r.removeThisFromConnectedObjs(),this.getConnectors().splice(e,1),r.setOwner&&r.setOwner(null),r.setParent&&r.setParent(null),this.notifyConnectorsChanged())},removeConnector:function(e,t){var r=this.getConnectors().indexOf(e);r>=0&&this.removeConnectorAt(r,t)},clearConnectors:function(){this.setPropStoreFieldValue("connectors",[]),this.notifyConnectorsChanged()},hasConnector:function(e,t){var r=this.indexOfConnector(e)>=0;if(!r&&t)for(var i=0,n=this.getNodeCount();i<n;++i){var a=this.getNodeAt(i);if(a.hasConnector&&(r=a.hasConnector(e,!0)),r)break}return r},sortConnectors:function(t){t?(this.getConnectors().sort(t),this.notifyConnectorsChanged()):e.error(e.$L("ErrorMsg.SORT_FUNC_UNSET"))},_createBond:function(t,r,i){for(var n=[],a=0,o=t.length;a<o;++a){var s=t[a];l.isSimpleValue(s)&&(s=this.getNodeAt(s)),n.push(s)}return new e.Bond(null,n,r,null,i)},appendBond:function(e,t,r){var i=this._createBond(e,t,r);return i&&this.appendConnector(i),i},_getObjsNeedToBeCascadeRemoved:function(t,r){for(var i=[],n=t.getLinkedConnectors?t.getLinkedConnectors():[],a=0,o=n.length;a<o;++a){var s=n[a];(!r||r.indexOf(s)<0)&&s.getConnectedObjs().length<=2&&e.ArrayUtils.pushUnique(i,s)}if(t instanceof e.ChemStructureNode);else if(t instanceof e.ChemStructureConnector)for(var l=t.getConnectedObjs(),a=0,o=l.length;a<o;++a){var d=l[a];(!r||r.indexOf(d)<0)&&d instanceof e.ChemStructureNode&&d.getLinkedConnectors().length<=1&&e.ArrayUtils.pushUnique(i,d)}var u=[].concat(i);u.push(t);for(var c=[],a=0,o=i.length;a<o;++a){var d=i[a];if(d!==t)var h=this._getObjsNeedToBeCascadeRemoved(d,u);e.ArrayUtils.pushUnique(c,h)}return e.ArrayUtils.pushUnique(i,c),i},removeChildObj:function(t,r,i){var n;r?(n=this._getObjsNeedToBeCascadeRemoved(t),e.ArrayUtils.pushUnique(n,t)):n=[t];for(var a=0,o=n.length;a<o;++a){var s=n[a];s instanceof e.BaseStructureConnector?this.removeConnector(s):s instanceof e.BaseStructureNode&&this.removeNode(s)}if(i)for(var a=n.length-1;a>=0;--a){var s=n[a];s.finalize&&s.finalize()}},removeChild:function($super,e){return this.removeChildObj(e)||$super(e)},deleteChildObj:function(e,t){return this.removeChildObj(e,t,!0)},hasChildObj:function(e){return this.hasNode(e)||this.hasConnector(e)},getNextSiblingOfChild:function(t){if(t instanceof e.SimpleStructureNode){var r=this.indexOfNode(t);if(r>=0)return this.getNodeAt(r+1)}else if(t instanceof e.BaseStructureConnector){var r=this.indexOfConnector(t);if(r>=0)return this.getConnectorAt(r+1)}return null},insertBefore:function(t,r){if(t instanceof e.SimpleStructureNode){var i=this.indexOfNode(r);return this.insertNodeAt(t,i)}if(t instanceof e.BaseStructureConnector){var i=this.indexOfConnector(r);return this.insertConnectorAt(t,i)}return-1},clear:function(){this.clearNodes(),this.clearConnectors()},getChildCount:function(){return this.getNodeCount()+this.getConnectorCount()},getChildAt:function(e){var t=this.getNodeCount();return e<t?this.getNodeAt(e):e<t+this.getConnectorCount()?this.getConnectorAt(e-t):null},indexOfChild:function(t){var r;if(t instanceof e.BaseStructureNode)r=this.indexOfNode(t);else if(t instanceof e.BaseStructureConnector){if((r=this.indexOfConnector(t))>=0){var i=this.getNodeCount();r+=i}}else r=-1;return r},indexStackOfChild:function(t){var r;if(t instanceof e.BaseStructureNode)r=this.indexStackOfNode(t);else if(t instanceof e.BaseStructureConnector){var i=this.getNodeCount();r=this.indexStackOfConnector(t),r.length?r[r.length-1]+=i:r+=i}else r=-1;return r},getChildAtIndexStack:function(t){if(t=e.ArrayUtils.toArray(t),t.length<=0)return null;for(var r=this.getChildAt(t[0]),i=1,n=t.length;i<n;++i){if(!r||!r.getChildAt)return null;r=r.getChildAt(t[i])}return r},isSubFragment:function(e){return e.getNodeCount&&e.getNodeCount()>0},getSubFragments:function(){for(var e=[],t=0,r=this.getNodeCount();t<r;++t){var i=this.getNodeAt(t);this.isSubFragment(i)&&e.push(i)}return e},hasSubFragments:function(){var e=this.getSubFragments();return e&&e.length},getLeafNodes:function(){for(var e=[],t=0,r=this.getNodeCount();t<r;++t){var i=this.getNodeAt(t);if(this.isSubFragment(i)){if(i.getLeafNodes){var n=i.getLeafNodes();e=e.concat(n)}}else e.push(i)}return e},findDirectChildOfObj:function(e){for(var t=e;t&&this.indexOfChild(t)<0;)t=t.getParent?t.getParent():null;return t},getAllChildConnectors:function(){for(var e=[].concat(this.getConnectors()),t=this.getSubFragments(),r=0,i=t.length;r<i;++r)t[r].getAllChildConnectors&&(e=e.concat(t[r].getAllChildConnectors()));return e},getAllContainingConnectors:function(){return this.getAllChildConnectors()},getIsotopeMaps:function(){var t=this.getNodes();if(t.length<=0)return[];for(var r=function(e,t,r,i){for(var n=!1,a=0,s=e.length;a<s;++a)t.isSame(e[a].isotope)&&(n=!0,e[a].count+=r,e[a].charge+=i||0);if(!n){var l={isotope:t,count:r,charge:o.getCharge()||0};e.push(l)}return e},i=[],n=0,a=t.length;n<a;++n){var o=t[n];if(o instanceof e.StructureFragment)for(var s=o.getIsotopeMaps(),n=0,a=s.length;n<a;++n)i=r(i,s[n].isotope,s[n].count,s[n].charge||0);else if(o instanceof e.Atom){o.getIsotope();i=r(i,o.getIsotope(),1,o.getCharge()||0);var l=o.getHydrogenCount();if(l>0){var d=e.IsotopeFactory.getIsotope(1);i=r(i,d,l,0)}}}return i},calcFormula:function(){var t=this.getIsotopeMaps();if(t.length<=0)return null;for(var r=new e.MolecularFormula,i=0,n=t.length;i<n;++i){var a=new e.Atom;a.setIsotope(t[i].isotope),r.appendSection(a,t[i].count,t[i].charge)}return r},getNodesContainBox:function(t,r,i){for(var n=r===e.CoordMode.COORD3D,a={},o=0,s=t.length;o<s;++o){var l=t[o],d=l.getAbsCoordOfMode(r,i);0==o?(a.x1=a.x2=d.x,a.y1=a.y2=d.y,n&&(a.z1=a.z2=d.z)):(d.x<a.x1?a.x1=d.x:d.x>a.x2&&(a.x2=d.x),d.y<a.y1?a.y1=d.y:d.y>a.y2&&(a.y2=d.y),n&&(d.z<a.z1?a.z1=d.z:d.z>a.z2&&(a.z2=d.z)))}return a},getContainerBox:function(e,t){return this.getNodesContainBox(this.getNodes(),e,t)},getContainerBox2D:function(t){var r=this.getContainerBox(e.CoordMode.COORD2D,t);return r.width=r.x2-r.x1,r.height=r.y2-r.y1,r},getContainerBox3D:function(t){var r=this.getContainerBox(e.CoordMode.COORD3D,t);return r.deltaX=r.x2-r.x1,r.deltaY=r.y2-r.y1,r.deltaZ=r.z2-r.z1,r},traverse:function(e,r,i,n){for(var a={nodes:[],connectors:[]},o=t.clone(n||this.getNodes()),s=0,l=o.length;s<l;++s)o[s][this.TRAVERS_VISITED_KEY]=!1;for(;o.length;){var d;d=r&&o.indexOf(r)>=0?r:o[0];var u=this._doTravers(e,d,i,n);a.nodes=a.nodes.concat(u.nodes),a.connectors=a.connectors.concat(u.connectors),o=t.exclude(o,u.nodes)}return a},_doTravers:function(r,i,n,a){var o={nodes:[],connectors:[]},s=i;s[this.TRAVERS_VISITED_KEY]||(o.nodes.push(s),s[this.TRAVERS_VISITED_KEY]=!0,r&&r(s,!1));var l=t.clone(s.getLinkedConnectors()),d=this.getConnectors();l.sort(function(e,t){return d.indexOf(e)-d.indexOf(t)});for(var u=[],c=0,h=l.length;c<h;++c){var m=l[c],g=s.getLinkedObjsOnConnector(m);a&&(g=t.intersect(g,a));for(var f=0,p=g.length;f<p;++f){var C=g[f];if(C instanceof e.BaseStructureNode)break}if(C&&!C[this.TRAVERS_VISITED_KEY])if(o.nodes.push(C),o.connectors.push(m),C[this.TRAVERS_VISITED_KEY]=!0,r&&(r(m,!0),r(C,!1)),n)u.push(C);else{var b=this._doTravers(r,C,n,a);o.nodes=o.nodes.concat(b.nodes),o.connectors=o.connectors.concat(b.connectors)}}if(n)for(var c=0,h=u.length;c<h;++c){var E=u[c],b=this._doTravers(r,E,n,a);o.nodes=o.nodes.concat(b.nodes),o.connectors=o.connectors.concat(b.connectors)}return o}}),e.StructureFragment=a.create(e.ChemStructureNode,{CLASS_NAME:"Kekule.StructureFragment",initialize:function($super,e,t,r){$super(e,t,r)},doFinalize:function($super){this.hasFormula()&&this.getFormula().finalize(),this.hasCtab()&&this.getCtab().finalize(),$super()},initProperties:function(){this.defineProp("formula",{dataType:"Kekule.MolecularFormula",getter:function(e){return this.getPropStoreFieldValue("formula")||e&&this.createFormula(),this.getPropStoreFieldValue("formula")},setter:function(e){var t=this.getPropStoreFieldValue("formula");t&&(t.finalize(),t=null),e&&(e.setPropValue("parent",this,!0),e.addEventListener("change",function(e){this.notifyPropSet("formula",this.getFormula())},this)),this.setPropStoreFieldValue("formula",e)}}),this.defineProp("ctab",{dataType:"Kekule.StructureConnectionTable",getter:function(e){return this.getPropStoreFieldValue("ctab")||e&&this.createCtab(),this.getPropStoreFieldValue("ctab")},setter:function(e){var t=this.getPropStoreFieldValue("ctab");t&&(t.finalize(),t=null),e&&(e.setPropValue("parent",this,!0),e.setOwner(this.getOwner()),e.addEventListener("propValueSet",function(e){"nodes"!=e.propName&&"anchorNodes"!=e.propName&&"connectors"!=e.propName||this.notifyPropSet(e.propName,e.propValue)},this),e.setEnablePropValueSetEvent(!0)),this.setPropStoreFieldValue("ctab",e)}}),this.defineProp("nodes",{dataType:l.ARRAY,serializable:!1,scope:a.PropertyScope.PUBLISHED,setter:function(e){this.hasCtab()&&this.getCtab().setNodes(e)},getter:function(){return this.hasCtab()?this.getCtab().getNodes():[]}}),this.defineProp("anchorNodes",{dataType:l.ARRAY,serializable:!1,scope:a.PropertyScope.PUBLISHED,setter:null,getter:function(){return this.hasCtab()?this.getCtab().getAnchorNodes():[]}}),this.defineProp("connectors",{dataType:l.ARRAY,serializable:!1,scope:a.PropertyScope.PUBLISHED,setter:function(e){this.hasCtab()&&this.getCtab().setConnectors(e)},getter:function(){return this.hasCtab()?this.getCtab().getConnectors():[]}}),this.defineProp("crossConnectors",{dataType:l.ARRAY,serializable:!1,setter:null,scope:a.PropertyScope.PUBLIC,getter:function(){for(var t=[].concat(this.getPropStoreFieldValue("linkedConnectors")),r=0,i=this.getNodeCount();r<i;++r)for(var n=this.getNodeAt(r),a=n.getLinkedConnectors()||[],o=0,s=a.length;o<s;++o)this.indexOfConnector(a[o])<0&&e.ArrayUtils.pushUnique(t,a[o]);return t}}),this.defineProp("nonHydrogenNodes",{dataType:l.ARRAY,scope:a.PropertyScope.PUBLIC,serializable:!1,setter:null,getter:function(){return this.hasCtab()?this.getCtab().getNonHydrogenNodes():[]}}),this.defineProp("nonHydrogenConnectors",{dataType:l.ARRAY,scope:a.PropertyScope.PUBLIC,serializable:!1,setter:null,getter:function(){return this.hasCtab()?this.getCtab().getNonHydrogenConnectors():[]}}),this.defineProp("hydrogenNodes",{dataType:l.ARRAY,scope:a.PropertyScope.PUBLIC,serializable:!1,setter:null,getter:function(){return this.hasCtab()?this.getCtab().getHydrogenNodes():[]}}),this.defineProp("hydrogenConnectors",{dataType:l.ARRAY,scope:a.PropertyScope.PUBLIC,serializable:!1,setter:null,getter:function(){return this.hasCtab()?this.getCtab().getHydrogenConnectors():[]}}),this.defineProp("canonicalizationInfo",{dataType:l.OBJECT,serializable:!1,scope:a.PropertyScope.PUBLIC,getter:function(){return this.getStructureCacheData("canonicalizationInfo")},setter:function(e){this.setStructureCacheData("canonicalizationInfo",e)}}),this.defineProp("aromaticRings",{dataType:l.ARRAY,serializable:!1,scope:a.PropertyScope.PUBLIC,getter:function(){var e=this.getStructureCacheData("aromaticRings");return e||(e=[],this.setStructureCacheData("aromaticRings",e)),e},setter:function(e){this.setStructureCacheData("aromaticRings",e)}}),this.defineProp("flattenedShadow",{dataType:"Kekule.StructureFragmentShadow",serializable:!1,scope:a.PropertyScope.PRIVATE,getter:function(t){var r=null;if(e.ObjUtils.isUnset(t)&&(t=!0),this.getFlattenedShadowOnSelf())return null;if(!(r=this.getPropStoreFieldValue("flattenedShadow"))&&t){r=new e.StructureFragmentShadow(this);var i=r.getShadowFragment();i.unmarshalAllSubFragments(!0),this._copyAdditionalInfoToShadowFragment(i,r.getSourceToShadowMap(),r.getShadowToSourceMap()),this.setPropStoreFieldValue("flattenedShadow",r)}return r}}),this.defineProp("flattenedShadowOnSelf",{dataType:l.BOOL,serializable:!1,scope:a.PropertyScope.PROVATE,setter:null,getter:function(){var t=this.setPropStoreFieldValue("flattenedShadowOnSelf");return e.ObjUtils.isUnset(t)&&(t=!this.hasSubFragments(),this.setPropStoreFieldValue("flattenedShadowOnSelf",t)),t}})},getAutoIdPrefix:function(){return"f"},getStructureRelatedPropNames:function($super){return $super().concat(["ctab","formula","nodes","anchorNodes","connectors"])},getNonHydrogenNodeData:function(e){var t=e.getAttachedMarkers()?e.getAttachedMarkers().reduce(function(e,t){return e+(t.getElectronCount?t.getElectronCount():0)},0):0;return[void 0===e.getCharge()?0:e.getCharge(),t]},compareNonHydrogenNodes:function(e,t){var r=this.getNonHydrogenNodeData(e),n=i(r,2),a=n[0],o=n[1],s=this.getNonHydrogenNodeData(t),l=i(s,2),d=l[0],u=l[1];return e.getIsotopeId()===t.getIsotopeId()&&a===d&&o===u?0:1},getHydrogenNodeData:function(e){var t=e.getConnectedObjs(),r=i(t,2),n=r[0],a=r[1],o=n.getIsotope()&&"H"===n.getIsotope().getSymbol()?n:a,s=o.getAttachedMarkers()?o.getAttachedMarkers().reduce(function(e,t){return e+(t.getElectronCount?t.getElectronCount():0)},0):0;return[void 0===o.getCharge()?0:o.getCharge(),s]},getHydrogenOnlyNodeData:function(e){function t(e,t){return e+(t.getElectronCount?t.getElectronCount():0)}var r=e.getConnectedObjs(),n=i(r,2),a=n[0],o=n[1],s=a.getAttachedMarkers()?a.getAttachedMarkers().reduce(t,0):0,l=o.getAttachedMarkers()?o.getAttachedMarkers().reduce(t,0):0;return[void 0===a.getCharge()?0:a.getCharge(),s,void 0===o.getCharge()?0:o.getCharge(),l]},resolveHydrogenDecorations:function(e,t,r,n,a,o,s,l,d,u){ue=[];for(var c=0;c<d.length;c++){for(var h=!1,m=0;m<u.length;m++)if(!ue.includes(m)){var g=d[c].getConnectedObjs()[0].getIsotopeId(),f=d[c].getConnectedObjs()[1].getIsotopeId(),p=u[m].getConnectedObjs()[0].getIsotopeId(),C=u[m].getConnectedObjs()[1].getIsotopeId(),b=this.getNonHydrogenNodeData(d[c].getConnectedObjs()[0]),E=i(b,2),N=E[0],T=E[1],O=this.getNonHydrogenNodeData(d[c].getConnectedObjs()[1]),_=i(O,2),S=_[0],v=_[1],y=this.getNonHydrogenNodeData(u[m].getConnectedObjs()[0]),A=i(y,2),M=A[0],I=A[1],R=this.getNonHydrogenNodeData(u[m].getConnectedObjs()[1]),L=i(R,2),x=L[0],D=L[1];if(d[c].getBondForm().getBondOrder()===u[m].getBondForm().getBondOrder()&&(g===p&&N===M&&T===I&&f===C&&S===x&&v===D||g===C&&N===x&&T===D&&f===p&&S===M&&v===I)){h=!0,ue.push(m);break}}if(!h)return!1}ue=[];for(var c=0;c<u.length;c++){for(var h=!1,m=0;m<d.length;m++)if(!ue.includes(m)){var P=u[c].getConnectedObjs()[0].getIsotopeId(),B=u[c].getConnectedObjs()[1].getIsotopeId(),w=d[m].getConnectedObjs()[0].getIsotopeId(),k=d[m].getConnectedObjs()[1].getIsotopeId(),U=this.getNonHydrogenNodeData(u[c].getConnectedObjs()[0]),j=i(U,2),N=j[0],T=j[1],F=this.getNonHydrogenNodeData(u[c].getConnectedObjs()[1]),W=i(F,2),S=W[0],v=W[1],V=this.getNonHydrogenNodeData(d[m].getConnectedObjs()[0]),H=i(V,2),M=H[0],I=H[1],G=this.getNonHydrogenNodeData(d[m].getConnectedObjs()[1]),K=i(G,2),x=K[0],D=K[1];if(u[c].getBondForm().getBondOrder()===d[m].getBondForm().getBondOrder()&&(P===w&&N===M&&T===I&&B===k&&S===x&&v===D||P===k&&N===x&&T===D&&B===w&&S===M&&v===I)){h=!0,ue.push(m);break}}if(!h)return!1}ue=[];for(var c=0;c<s.length;c++){for(var h=!1,z=this.getHydrogenOnlyNodeData(s[c]),Y=i(z,4),X=Y[0],$=Y[1],J=Y[2],Z=Y[3],m=0;m<l.length;m++)if(!ue.includes(m)){var q=this.getHydrogenOnlyNodeData(l[m]),Q=i(q,4),ee=Q[0],te=Q[1],re=Q[2],ie=Q[3];if((X===ee&&$===te&&J===re&&Z===ie||X===re&&$===ie&&J===ee&&Z===te)&&s[c].getBondForm().getBondOrder()===l[m].getBondForm().getBondOrder()){h=!0,ue.push(m);break}}if(!h)return!1}ue=[];for(var c=0;c<l.length;c++){for(var h=!1,ne=this.getHydrogenOnlyNodeData(l[c]),ae=i(ne,4),X=ae[0],$=ae[1],J=ae[2],Z=ae[3],m=0;m<s.length;m++)if(!ue.includes(m)){var oe=this.getHydrogenOnlyNodeData(s[m]),se=i(oe,4),ee=se[0],te=se[1],re=se[2],ie=se[3];if((X===ee&&$===te&&J===re&&Z===ie||X===re&&$===ie&&J===ee&&Z===te)&&l[c].getBondForm().getBondOrder()===s[m].getBondForm().getBondOrder()){h=!0,ue.push(m);break}}if(!h)return!1}for(var le=n+t,de=!0,ue=[],c=0;c<a.length;c++){for(var h=!1,ce=this.getHydrogenNodeData(a[c]),he=i(ce,2),me=he[0],ge=he[1],m=0;m<o.length;m++)if(!ue.includes(m)){var fe=this.getHydrogenNodeData(o[m]),pe=i(fe,2),Ce=pe[0],be=pe[1];if(me===Ce&&ge===be&&a[c].getBondForm().getBondOrder()===o[m].getBondForm().getBondOrder()){h=!0,ue.push(m);break}}if(!h&&0===me&&0===ge){if(1!==a[c].getBondForm().getBondOrder())return!1;le--,h=le>=0}if(!(de=de&&h))return!1}var Ee=r+e,Ne=!0;ue=[];for(var c=0;c<o.length;c++){for(var h=!1,Te=this.getHydrogenNodeData(o[c]),Oe=i(Te,2),me=Oe[0],ge=Oe[1],m=0;m<a.length;m++)if(!ue.includes(m)){var _e=this.getHydrogenNodeData(a[m]),Se=i(_e,2),Ce=Se[0],be=Se[1];if(me===Ce&&ge===be&&a[m].getBondForm().getBondOrder()===o[c].getBondForm().getBondOrder()){h=!0,ue.push(m);break}}if(!h&&0===me&&0===ge){if(1!==o[c].getBondForm().getBondOrder())return!1;Ee--,h=Ee>=0}if(!(Ne=Ne&&h))return!1}return!0},onlyUnique:function(e,t,r){return r.indexOf(e)===t},compareHydrogens:function(e,t,r){function n(e){var t=e.getConnectedObjs(),r=i(t,2),n=r[0],a=r[1],o=n.getIsotope()&&"H"===n.getIsotope().getSymbol(),s=a.getIsotope()&&"H"===a.getIsotope().getSymbol();if(o||s){return o?n:a}}var r=0,a=this.getNodes(),o=e.getNodes();if(1===a.length&&1===o.length){var s=a[0],l=o[0],d=s.getAttachedMarkers()?s.getAttachedMarkers().reduce(function(e,t){return e+(t.getElectronCount?t.getElectronCount():0)},0):0,u=l.getAttachedMarkers()?l.getAttachedMarkers().reduce(function(e,t){return e+(t.getElectronCount?t.getElectronCount():0)},0):0;if(0!==(r=(void 0===s.getCharge()?0:s.getCharge())-(void 0===l.getCharge()?0:l.getCharge())))return r;r=d-u}if(0!==r)return r;var c=this.getNonHydrogenNodes(),h=e.getNonHydrogenNodes();if(0===(r=c.length-h.length)){for(var m=[],g=0,f=0,p=0,C=c.length;p<C;++p){for(var b=0,E=0,C=h.length;E<C;++E)if(!m.includes(E))if(0!==b||c[p].getSingleElectronCount()===h[E].getSingleElectronCount()){var N=this._getComparisonOptionFlagValue(t,"hydrogen_display_type")||"BONDED",T=this._getComparisonOptionFlagValue(t,"skeletalMode")||!1,O="EXPLICIT"===N&&c[p].getExplicitHydrogenCount()?c[p].getExplicitHydrogenCount():0,_="EXPLICIT"===N&&h[E].getExplicitHydrogenCount()?h[E].getExplicitHydrogenCount():0,S="IMPLICIT"===N||T&&"EXPLICIT"===N&&"C"===c[p].getIsotopeId()?c[p].getImplicitHydrogenCount():0,v="IMPLICIT"===N||T&&"EXPLICIT"===N&&"C"===h[E].getIsotopeId()?h[E].getImplicitHydrogenCount():0,y=c[p].getLinkedConnectors().filter(function(e){var t=e.getConnectedObjs();if("H"===t[0].getIsotopeId()||"H"===t[1].getIsotopeId()){return("H"===t[0].getIsotopeId()?t[1]:t[0])===c[p]}return!1}),A=h[E].getLinkedConnectors().filter(function(e){var t=e.getConnectedObjs();if("H"===t[0].getIsotopeId()||"H"===t[1].getIsotopeId()){return("H"===t[0].getIsotopeId()?t[1]:t[0])===h[E]}return!1}),M=this.getConnectors().filter(function(e){var t=e.getConnectedObjs();return"H"===t[0].getIsotopeId()&&"H"===t[1].getIsotopeId()}),I=e.getConnectors().filter(function(e){var t=e.getConnectedObjs();return"H"===t[0].getIsotopeId()&&"H"===t[1].getIsotopeId()}),R=c[p].getLinkedConnectors().filter(function(e){var t=e.getConnectedObjs();return"H"!==t[0].getIsotopeId()&&"H"!==t[1].getIsotopeId()}),L=h[E].getLinkedConnectors().filter(function(e){var t=e.getConnectedObjs();return"H"!==t[0].getIsotopeId()&&"H"!==t[1].getIsotopeId()});if(0===(b=O+S+y.length+M.length-(_+v+A.length+I.length))&&0===(b=R.length-L.length)&&0===b){var x=this.resolveHydrogenDecorations(O,_,S,v,y,A,M,I,R,L);if(x){b=0,g+=O+S,f+=_+v,m.push(E);break}b=-1}}else b=-1;if(0!==b)return b;if(0!==r)break}if(0===r){var D=this.getConnectors().map(n),P=D.filter(this.onlyUnique),B=e.getConnectors().map(n),w=B.filter(this.onlyUnique);return g+P.length-(f+w.length)}}return r},compareStereoBonds:function(t,r){for(var i=[],n=0;n<t.length;n++){for(var a=!1,o=0;o<r.length;o++)if(!i.includes(o)&&t[n].getParity()!==e.StereoParity.LINEAR&&r[o].getParity()!==e.StereoParity.LINEAR&&t[n].getStereo()+t[n].getParity()-(r[o].getStereo()+r[o].getParity())==0){a=!0,i.push(o);break}if(!a)return 1}i=[];for(var n=0;n<r.length;n++){for(var a=!1,o=0;o<t.length;o++)if(!i.includes(o)&&r[n].getParity()!==e.StereoParity.LINEAR&&t[o].getParity()!==e.StereoParity.LINEAR&&r[n].getStereo()+r[n].getParity()-(t[o].getStereo()+t[o].getParity())==0){a=!0,i.push(o);break}if(!a)return 1}return 0},doCompare:function($super,t,r){var i=$super(t,r),n=function(t,r){var i;t instanceof e.ChemStructureConnector?i=t.getConnectedNonHydrogenObjs():t instanceof e.ChemStructureNode&&(i=t.getLinkedNonHydrogenObjs());for(var n=[],a=0,o=i.length;a<o;++a){var s=i[a],l=r.indexOfNode(s);l>=0&&n.push(l)}return n.sort(),n},a=function(e){return e.getStereo()>=1&&e.getStereo()<=4};if(!i&&r.method===e.ComparisonMethod.CHEM_STRUCTURE){var o=this.hasCtab(),s=t.hasCtab&&t.hasCtab();if(!(i=o?s?0:1:s?-1:0)){var l=this.hasFormula(),d=t.hasFormula&&t.hasFormula();i=l?d?0:1:d?-1:0}if(!i&&this.hasCtab()){if(0===i&&this.getNonHydrogenNodes&&t.getNonHydrogenNodes){if(this._getComparisonOptionFlagValue(r,"hydrogenCount")&&(i=this.compareHydrogens(t,r)),0!==i)return i;var u=this._getComparisonOptionFlagValue(r,"hydrogen_display_type")||"BONDED";if(0===i){if(this.hydrateExplicitHydrogenBonds(),t.hydrateExplicitHydrogenBonds(),0===i&&"BONDED"!==u&&(e.globalOptions.algorithm.molStandardization.clearHydrogens=!0,e.MolStandardizer.standardize(this,r),e.MolStandardizer.standardize(t,r),e.globalOptions.algorithm.molStandardization.clearHydrogens=!1),0===i){var c=this.getNonHydrogenNodes(),h=t.getNonHydrogenNodes();i=c.length-h.length}if(0===i&&this._getComparisonOptionFlagValue(r,"compareStereo")){var m=this.getConnectors().filter(e.MolStereoUtils.isStereoBond),g=t.getConnectors().filter(e.MolStereoUtils.isStereoBond);i=this.compareStereoBonds(m,g)}if(0===i)for(var f=0,p=c.length;f<p&&0===(i=this.doCompareOnValue(c[f],h[f],r));++f){var C=n(c[f],this),b=n(h[f],t);if(0!==(i=e.ArrayUtils.compare(C,b)))break;if(this._getComparisonOptionFlagValue(r,"compareStereo")&&"C"===c[f].getIsotopeId()&&"C"===h[f].getIsotope()){var E=c[f].getLinkedConnectors().filter(a),N=h[f].getLinkedConnectors().filter(a);if(0!==(i=E.length-N.length))break}}}}if(0===i&&this.getConnectors&&t.getConnectors){var T=this.getNonHydrogenConnectors(),O=t.getNonHydrogenConnectors();if(0===(i=T.length-O.length))for(var f=0,p=T.length;f<p&&0===(i=this.doCompareOnValue(T[f],O[f],r));++f){var C=n(T[f],this),b=n(O[f],t);if(0!==(i=e.ArrayUtils.compare(C,b)))break}}if(0===i){for(var _=this.getNonHydrogenNodes(),S=t.getNonHydrogenNodes(),v=this.traverse(null,_[_.length-1],!0,_),y=t.traverse(null,S[S.length-1],!0,S),f=0,p=v.nodes.length;f<p;++f){var A=v.nodes[f],M=y.nodes[f];if(0!==(i=this.doCompareOnValue(A,M,r)))break}if(0===i)for(var f=0,p=v.connectors.length;f<p;++f){var I=v.connectors[f],R=y.connectors[f];if(0!==(i=this.doCompareOnValue(I,R,r)))break}}}}return i},hydrateExplicitHydrogenBonds:function(){var t=this.getNodes(),r=[],i=this.getConnectors();t.forEach(function(t){var n=t.getLinkedConnectors().map(function(e){var t=e.getStereo();if(t)switch(t){case 1:return"dash";case 2:return"reverse-dash";case 3:return"wedge";case 4:return"reverse-wedge"}return"normal"}),a=t.getExplicitHydrogenCount();if(a)for(var o=0;o<a;o++){var s=new e.Atom;s.setIsotopeId("H");for(var l=new e.Bond,d={},u=0;u<n.length;u++)"normal"!==n[u]&&(d[n[u]]=1+(d[n[u]]||0));if(1===Object.keys(d).length)switch(Object.keys(d)[0]){case"dash":l.setStereo(1);break;case"reverse-dash":l.setStereo(2);break;case"wedge":l.setStereo(3);break;case"reverse-wedge":l.setStereo(4)}r.push(s),i.push(l),l.getConnectedObjs().push(t),l.getConnectedObjs().push(s),s.getLinkedConnectors().push(l),t.getLinkedConnectors().push(l)}t.setExplicitHydrogenCount(void 0),r.push(t)}),this.setNodes(r),this.setConnectors(i)},structureChange:function($super,e){this.setPropStoreFieldValue("flattenedShadowOnSelf",null);var t=this.getFlattenedShadow(!1);t&&(t.finalize(),this.setPropStoreFieldValue("flattenedShadow",null)),$super(e)},clearStructureFlags:function($super){$super();for(var e=0,t=this.getChildCount();e<t;++e){var r=this.getChildAt(e);r.clearStructureFlags&&r.clearStructureFlags()}},ownerChanged:function($super,e,t){this.hasCtab()&&this.getCtab().setOwner(e),$super(e,t)},_removeChildObj:function($super,e){if(this.hasFormula()){this.getFormula()===e&&this.removeFormula()}else if(this.hasCtab()){var t=this.getCtab();t===e?this.removeCtab():t.hasChildObj(e)&&t.removeChildObj(e)}$super(e)},isEmpty:function(){var e;return(e=!this.hasFormula())&&((e=!this.hasCtab())||(e=this.getCtab().isEmpty())),e},isCtabEmpty:function(){return!this.hasCtab()||this.getCtab().isEmpty()},doGetLinkedConnectors:function(){return this.getCrossConnectors()},appendLinkedConnector:function($super,e){var t=this.getCurrConnectableObj();return t&&t!==this?t.appendLinkedConnector(e):$super(e)},getCurrConnectableObj:function(){var t=this.getAnchorNodeCount()>0?this.getAnchorNodes():this.getNodes();if(t.length<=0)return this;for(var r=this.getCrossConnectors(),i=null,n=null,a=0,o=t.length;a<o;++a){var s=t[a],l=s.getLinkedConnectors(),d=e.ArrayUtils.intersect(l,r),u=d.length;(null===i||i>u)&&(i=u,n=s)}return n},createCtab:function(){var t=new e.StructureConnectionTable(this.getOwner(),this);this.setCtab(t)},createFormula:function(){var t=new e.MolecularFormula(this);this.setFormula(t)},hasCtab:function(){return!!this.getPropStoreFieldValue("ctab")},hasFormula:function(){return!!this.getPropStoreFieldValue("formula")},removeFormula:function(){var e=this.getPropStoreFieldValue("formula");return e&&(e.finalize(),e=null,this.setPropStoreFieldValue("formula",null)),this},removeCtab:function(){var e=this.getPropStoreFieldValue("ctab");return e&&(e.finalize(),e=null,this.setPropStoreFieldValue("ctab",null)),this},getContainerBox:function($super,e,t){return this.hasCtab()?this.getCtab().getContainerBox(e,t):$super(e)},getNodeById:function(e){return this.hasCtab()?this.getCtab().getNodeById(e):null},getConnectorById:function(e){return this.hasCtab()?this.getCtab().getConnectorById(e):null},getObjectById:function(e){var t=this.getNodeById(e);return t||this.getConnectorById(e)},getNodeCount:function(){return this.hasCtab()?this.getCtab().getNodeCount():0},getNodeAt:function(e){return this.hasCtab()?this.getCtab().getNodeAt(e):null},indexOfNode:function(e){return this.hasCtab()?this.getCtab().indexOfNode(e):-1},hasNode:function(e,t){return this.hasCtab()?this.getCtab().hasNode(e,t):null},indexStackOfNode:function(e){return this.hasCtab()?this.getCtab().indexStackOfNode(e):-1},getNodeAtIndexStack:function(e){return this.hasCtab()?this.getCtab().getNodeAtIndexStack(e):null},getDirectChildOfNestedNode:function(e){var t=e.getParent();if(t){if(t===this)return t;for(var r=e;t&&t.getParent&&t!==this;)r=t,t=t.getParent();return t===this?r:null}return null},insertNodeBefore:function(e,t){return this.doGetCtab(!0).insertNodeBefore(e,t)},appendNode:function(e){return this.doGetCtab(!0).appendNode(e)},insertNodeAt:function(e,t){return this.doGetCtab(!0).insertNodeAt(e,t)},removeNodeAt:function(e,t){return this.hasCtab()?this.getCtab().removeNodeAt(e,t):null},removeNode:function(e,t){return this.hasCtab()?this.getCtab().removeNode(e,t):null},replaceNode:function(e,t){return this.hasCtab()?this.getCtab().replaceNode(e,t):null},clearNodes:function(){if(this.hasCtab())return this.getCtab().clearNodes()},sortNodes:function(e){if(this.hasCtab())return this.getCtab().sortNodes(e)},nodesHasCoord2D:function(e){return!!this.hasCtab()&&this.getCtab().nodesHasCoord2D(e)},nodesHasCoord3D:function(e){return!!this.hasCtab()&&this.getCtab().nodesHasCoord3D(e)},isNodeInAromaticRing:function(e){for(var t=this.getAromaticRings(),r=0,i=t.length;r<i;++r){if(t[r].nodes.indexOf(e)>=0)return!0}return!1},appendAtom:function(e,t,r,i){return this.doGetCtab(!0).appendAtom(e,t,r,i)},getAnchorNodeCount:function(){return this.hasCtab()?this.getCtab().getAnchorNodeCount():0},getAnchorNodeAt:function(e){return this.hasCtab()?this.getCtab().getAnchorNodeAt(e):null},indexOfAnchorNode:function(e){return this.hasCtab()?this.getCtab().indexOfAnchorNode(e):-1},appendAnchorNode:function(e){return this.doGetCtab(!0).appendAnchorNode(e)},removeAnchorNodeAt:function(e){return this.hasCtab()?this.getCtab().removeAnchorNodeAt(e):null},removeAnchorNode:function(e){return this.hasCtab()?this.getCtab().removeAnchorNode(e):null},clearAnchorNodes:function(){if(this.hasCtab())return this.getCtab().clearAnchorNodes()},getConnectorCount:function(){return this.hasCtab()?this.getCtab().getConnectorCount():0},getConnectorAt:function(e){return this.hasCtab()?this.getCtab().getConnectorAt(e):null},indexOfConnector:function(e){return this.hasCtab()?this.getCtab().indexOfConnector(e):-1},hasConnector:function(e,t){return this.hasCtab()?this.getCtab().hasConnector(e,t):null},insertConnectorBefore:function(e,t){return this.doGetCtab(!0).insertConnectorBefore(e,t)},appendConnector:function(e){return this.doGetCtab(!0).appendConnector(e)},insertConnectorAt:function(e,t){return this.doGetCtab(!0).insertConnectorAt(e,t)},removeConnectorAt:function(e,t){return this.hasCtab()?this.getCtab().removeConnectorAt(e,t):null},removeConnector:function(e,t){return this.hasCtab()?this.getCtab().removeConnector(e,t):null},clearConnectors:function(){if(this.hasCtab())return this.getCtab().clearConnectors()},sortConnectors:function(e){if(this.hasCtab())return this.getCtab().sortConnectors(e)},isConnectorInAromaticRing:function(e){for(var t=this.getAromaticRings(),r=0,i=t.length;r<i;++r){if(t[r].connectors.indexOf(e)>=0)return!0}return!1},appendBond:function(e,t,r){return this.doGetCtab(!0).appendBond(e,t,r)},_getObjsNeedToBeCascadeRemoved:function(e,t){return this.hasCtab()?this.getCtab()._getObjsNeedToBeCascadeRemoved(e,t):[]},removeChildObj:function(e,t,r){this.hasCtab()&&this.getCtab().removeChildObj(e,t,r)},hasChildObj:function(e){return!!this.hasCtab()&&this.getCtab().hasChildObj(e)},getNextSiblingOfChild:function($super,e){return this.hasCtab()?this.getCtab().getNextSiblingOfChild(e)||$super(e):$super(e)},getChildSubgroupNames:function($super){return["node","connector"].concat($super())},getBelongChildSubGroupName:function($super,t){return t instanceof e.SimpleStructureNode?"node":t instanceof e.BaseStructureConnector?"connector":$super(t)},isSubFragment:function(e){return e.getNodeCount&&e.getNodeCount()>0},getSubFragments:function(){return this.hasCtab()?this.getCtab().getSubFragments():[]},hasSubFragments:function(){return!!this.hasCtab()&&this.getCtab().hasSubFragments()},getLeafNodes:function(){return this.hasCtab()?this.getCtab().getLeafNodes():[]},findDirectChildOfObj:function(e){return this.hasCtab()?this.getCtab().findDirectChildOfObj(e):null},getAllChildConnectors:function(){return this.hasCtab()?this.getCtab().getAllChildConnectors():[]},getAllContainingConnectors:function(){return this.hasCtab()?this.getCtab().getAllContainingConnectors():[]},getIsotopeMaps:function(){return this.hasCtab()?this.getCtab().getIsotopeMaps():[]},clear:function(){this.hasCtab()&&this.setCtab(void 0),this.hasFormula()&&this.setFormula(void 0)},clean:function(t){var r=Object.extend({},e.globalOptions.algorithm.structureClean.structureCleanOptions);return r=Object.extend(r,t||{}),this.doClean(r)},doClean:function(t){if(t.hangingChemConnector)for(var r=this.getConnectorCount()-1;r>=0;--r){var i=this.getConnectorAt(r);i instanceof e.ChemStructureConnector&&i.getConnectedObjCount()<2&&this.removeConnectorAt(r)}for(var n=this.getNodeCount(),r=n-1;r>=0;--r){var a=this.getNodeAt(r);a instanceof e.ChemStructureNode&&(this.isSubFragment(a)&&a.doClean?a.doClean(t):t.orphanChemNode&&a.getLinkedConnectorCount()<1&&n>1&&this.removeNodeAt(r))}return this},clearExplicitHydrogens:function(){for(var t=this,r=function(e,r){for(var i=e.getLinkedConnectors(),n=i.length;n>=0;--n){var a=i[n];t.hasConnector(a,!0)&&t.removeConnector(a,!1)}t.removeNodeAt(r,!1)},i=this.getNodeCount(),n=i-1;n>=0;--n){var a=this.getNodeAt(n);a instanceof e.ChemStructureNode&&(this.isSubFragment(a)&&a.clearExplicitHydrogens?(a.clearExplicitHydrogens(),a.getNodeCount()<=0&&r(a,n)):a.isHydrogenAtom()&&r(a,n))}return this},calcFormula:function(){return this.hasCtab()?this.getCtab().calcFormula():this.hasFormula()?this.getFormula():null},marshalSubFragment:function(t,r){if(this.hasCtab()){this.beginUpdate();try{this.appendNode(r);for(var i=[],n=[],a=[],o=[],s=0,l=t.length;s<l;++s){var d=t[s];if(!(this.indexOfNode(d)<0)){for(var u=!1,c=d.getLinkedConnectors(),h=0,m=c.length;h<m;++h){for(var g=c[h],f=!1,p=g.getConnectedObjs(),C=0,b=p.length;C<b;++C){var E=p[C];E!=d&&t.indexOf(E)<0&&(u=!0,f=!0)}f?e.ArrayUtils.pushUnique(o,g):e.ArrayUtils.pushUnique(a,g)}e.ArrayUtils.pushUnique(i,d),u&&e.ArrayUtils.pushUnique(n,d)}}for(var s=a.length-1;s>=0;--s)this.removeConnector(a[s],!0);for(var s=i.length-1;s>=0;--s)this.removeNode(i[s],!0);r.beginUpdate();try{for(var s=0,l=i.length;s<l;++s)r.appendNode(i[s]);for(var s=0,l=n.length;s<l;++s)r.appendAnchorNode(n[s]);for(var s=0,l=a.length;s<l;++s)r.appendConnector(a[s])}finally{r.endUpdate()}}finally{this.endUpdate()}return r}return null},unmarshalSubFragment:function(t,r){if(this.hasCtab()){this.beginUpdate();try{t.beginUpdate();try{r&&t.unmarshalAllSubFragments&&t.unmarshalAllSubFragments(r);var i=this.getCtab();e.StructureFragment.moveChildBetweenStructFragment(t,this,t.getNodes(),t.getConnectors(),!0),t.clear(),i.removeNode(t)}finally{t.endUpdate(),t.finalize()}}finally{this.endUpdate()}}},unmarshalAllSubFragments:function(e){var t=this.getSubFragments();if(t)for(var r=0,i=t.length;r<i;++r)this.unmarshalSubFragment(t[r],e)},recalcCoords:function(){if(this.hasCtab()){this.beginUpdate();try{for(var t={},r={},i=this.getAnchorNodeCount(),n=0,a=i;n<a;++n){var o=this.getAnchorNodeAt(n);t=e.CoordUtils.add(t,o.getCoord2D()||{}),r=e.CoordUtils.add(r,o.getCoord3D()||{})}var s=e.ObjUtils.notUnset,l=s(t.x)||s(t.y),d=s(r.x)||s(r.y)||s(r.z);if(l){var u=e.CoordUtils.substract({},t);this.setCoord2D(e.CoordUtils.substract(this.fetchCoord2D(),u))}if(d){var c=e.CoordUtils.substract({},r);this.setCoord3D(e.CoordUtils.substract(this.fetchCoord3D(),c))}for(var n=0,a=this.getNodeCount();n<a;++n){var o=this.getNodeAt(n);l&&o.setCoord2D(e.CoordUtils.add(o.fetchCoord2D(),u)),d&&o.setCoord3D(e.CoordUtils.add(o.fetchCoord3D(),c))}}finally{this.endUpdate()}}},_copyAdditionalInfoToShadowFragment:function(e,t,r){var i=this,n=i.getAromaticRings();if(n&&n.length){for(var a=[],o=0,s=n.length;o<s;++o){for(var l=n[o],d=[],u=[],c=0,h=l.nodes.length;c<h;++c){var m=t.get(l.nodes[c]);m&&d.push(m)}for(var c=0,h=l.connectors.length;c<h;++c){var m=t.get(l.connectors[c]);m&&u.push(m)}var g=Object.extend({},l);g.nodes=d,g.connectors=u,a.push(g)}e.setAromaticRings(a)}},getFlattenedShadowFragment:function(e){if(this.getFlattenedShadowOnSelf())return this;var t=this.getFlattenedShadow(e);return t?t.getShadowFragment():null},getFlatternedShadowShadowObj:function(e,t){if(this.getFlattenedShadowOnSelf())return e;var r=this.getFlattenedShadow(t);return r?r.getShadowObj(e):null},getFlatternedShadowSourceObj:function(e,t){if(this.getFlattenedShadowOnSelf())return e;var r=this.getFlattenedShadow(t);return r?r.getSourceObj(e):null},getFlatternedShadowShadowObjs:function(e,t){if(this.getFlattenedShadowOnSelf())return e;var r=this.getFlattenedShadow(t),i=[];if(r)for(var n=0,a=e.length;n<a;++n)i.push(r.getShadowObj(e[n]));return i},getFlatternedShadowSourceObjs:function(e,t){if(this.getFlattenedShadowOnSelf())return e;var r=this.getFlattenedShadow(t),i=[];if(r)for(var n=0,a=e.length;n<a;++n)i.push(r.getSourceObj(e[n]));return i},createShadow:function(){var t=new e.StructureFragmentShadow(this);return this._copyAdditionalInfoToShadowFragment(t.getShadowFragment(),t.getSourceToShadowMap(),t.getShadowToSourceMap()),t},traverse:function(e,t,r,i){return this.hasCtab()?this.getCtab().traverse(e,t,r):null}}),e.StructureFragment.moveChildBetweenStructFragment=function(t,r,i,n,a){var o=e.CoordUtils;t.beginUpdate(),r.beginUpdate();var s=t.getAnchorNodes();try{for(var l=t.getAbsCoord2D(),d=t.getAbsCoord3D(),u=r.getAbsCoord2D(),c=r.getAbsCoord3D(),h=o.substract(l,u),m=o.substract(d,c),g=e.ArrayUtils.clone(i),f=e.ArrayUtils.clone(n),p=0,C=g.length;p<C;++p){var b=g[p],E=t.indexOfNode(b);if(E>=0){t.removeNodeAt(E,!0);var N=b.getCoord2D();if(N){var T=o.add(N,h);b.setCoord2D(T)}var O=b.getCoord3D();if(O){var _=o.add(O,m);b.setCoord2D(_)}r.appendNode(b),s.indexOf(b)>=0&&(t.removeAnchorNode(b),a||r.appendAnchorNode(b))}}for(var p=0,C=f.length;p<C;++p){var S=f[p],E=t.indexOfConnector(S);E>=0&&(t.removeConnectorAt(E,!0),r.appendConnector(S))}}finally{r.endUpdate(),t.endUpdate()}},e.StructureFragmentShadow=a.create(s,{CLASS_NAME:"Kekule.StructureFragmentShadow",initialize:function($super,t){if(!t)return void e.error(e.$L("ErrorMsg.SOURCE_FRAGMENT_NOT_SET"));$super(),this.setPropStoreFieldValue("shadowToSourceMap",new e.MapEx),this.setPropStoreFieldValue("sourceToShadowMap",new e.MapEx);var r=this._createShadowFragment(t,this.getSourceToShadowMap(),this.getShadowToSourceMap());this.setPropStoreFieldValue("shadowFragment",r)},doFinalize:function($super){this.getShadowToSourceMap().finalize(),this.getSourceToShadowMap().finalize(),this.getShadowFragment().finalize(),this.setPropStoreFieldValue("shadowToSourceMap",null),this.setPropStoreFieldValue("sourceToShadowMap",null),this.setPropStoreFieldValue("shadowFragment",null),$super()},initProperties:function(){this.defineProp("shadowFragment",{dataType:"Kekule.StructureFragment",setter:null}),this.defineProp("sourceToShadowMap",{dataType:"Kekule.MapEx",setter:null}),this.defineProp("shadowToSourceMap",{dataType:"Kekule.MapEx",setter:null})},_createShadowFragment:function(e,t,r){var i=e.clone();return this._mapFragmentChildren(e,i,t,r),i},_mapFragmentChildren:function(e,t,r,i){for(var n=0,a=e.getChildCount();n<a;++n){var o=e.getChildAt(n),s=t.getChildAt(n);r.set(o,s),i.set(s,o),o.getChildCount&&s.getChildCount&&this._mapFragmentChildren(o,s,r,i)}},getShadowObj:function(e){return this.getSourceToShadowMap().get(e)},getSourceObj:function(e){return this.getShadowToSourceMap().get(e)}}),e.SubGroup=a.create(e.StructureFragment,{CLASS_NAME:"Kekule.SubGroup",initialize:function($super,e,t,r,i,n){$super(e,i,n),this.setPropStoreFieldValue("abbr",t),this.setPropStoreFieldValue("name",r)},initProperties:function(){this.defineProp("abbr",{dataType:l.STRING}),this.defineProp("formulaText",{dataType:l.STRING}),this.defineProp("name",{dataType:l.STRING})},getAutoIdPrefix:function(){return"g"},doPropChanged:function($super,e,t){return"anchorNodes"==e&&this.recalcCoords(),$super(e,t)},getLabel:function(){return e.ChemStructureNodeLabels.SUBGROUP}}),e.RGroup=e.SubGroup,e.Molecule=a.create(e.StructureFragment,{CLASS_NAME:"Kekule.Molecule",initialize:function($super,t,r,i){$super(t),this.setPropStoreFieldValue("name",r),i&&this.setCtab(new e.StructureConnectionTable)},initProperties:function(){this.defineProp("name",{dataType:l.STRING})},getAutoIdPrefix:function(){return"m"}}),e.BaseStructureConnector=a.create(e.ChemStructureObject,{CLASS_NAME:"Kekule.BaseStructureConnector",initialize:function($super,e,t){$super(e),this.setConnectedObjs(t||[])},initProperties:function(){this.defineProp("connectedObjs",{dataType:l.ARRAY,serializable:!1,scope:a.PropertyScope.PUBLISHED,setter:function(t){var r=this.getPropStoreFieldValue("connectedObjs");r||(this.setPropStoreFieldValue("connectedObjs",[]),r=this.getPropStoreFieldValue("connectedObjs"));for(var i=0,n=r.length;i<n;++i)r[i].removeLinkedConnector(this);if(t){for(var i=0,n=t.length;i<n;++i)this.assertConnectedObjLegal(t[i]);for(var i=0,n=t.length;i<n;++i){var a=t[i],o=a.getCurrConnectableObj?a.getCurrConnectableObj():a;e.ArrayUtils.pushUnique(r,o)}}else this.setPropStoreFieldValue("connectedObjs",[]);r=this.getPropStoreFieldValue("connectedObjs");for(var i=0,n=r.length;i<n;++i)r[i].appendLinkedConnector(this);this.notifyConnectedObjsChanged()}}),this.defineProp("neighboringConnectors",{dataType:l.ARRAY,serializable:!1,scope:a.PropertyScope.PUBLIC,setter:null,getter:function(){for(var t=[],r=this.getConnectedObjs(),i=0,n=r.length;i<n;++i){var a=r[i];a.getLinkedConnectors&&e.ArrayUtils.pushUnique(t,a.getLinkedConnectors()||[])}return e.ArrayUtils.remove(t,this),t}})},getAutoIdPrefix:function(){return"c"},getStructureRelatedPropNames:function($super){return $super().concat(["connectedObjs"])},doCompare:function($super,t,r){var i=$super(t,r);if(!i&&r.method===e.ComparisonMethod.CHEM_STRUCTURE&&this._getComparisonOptionFlagValue(r,"connectedObjCount")){var n=this.getConnectedObjCount(),a=t.getConnectedObjCount&&t.getConnectedObjCount();i=this.doCompareOnValue(n,a,r)}return i},notifyConnectedObjsChanged:function(){this.notifyPropSet("connectedObjs",this.getPropStoreFieldValue("connectedObjs"))},assertConnectedObjLegal:function(t){if(t&&t.getOwner)return!t.getOwner()||t.getOwner()==this.getOwner()||(e.chemError(e.hasLocalRes()?e.$L("ErrorMsg.UNABLE_ADD_DIFF_OWNER_OBJ"):"Object with different owner can not be linked to connector"),!1);e.chemError(e.hasLocalRes()?e.$L("ErrorMsg.UNABLE_ADD_MISTYPED_NODE"):"Unable to link mistyped node to connector")},connectedObjAdded:function(e){this.notifyConnectedObjsChanged()},getConnectedObjCount:function(){return this.getConnectedObjs().length},indexOfConnectedObj:function(e){return this.getConnectedObjs().indexOf(e)},getConnectedObjAt:function(e){return this.getConnectedObjs()[e]},setConnectedObjAt:function(e,t){this.assertConnectedObjLegal(t);var r=this.getConnectedObjs()[e];r&&r.removeLinkedConnector(this),this.insertConnectedObjAt(t,e),this.connectedObjAdded(t)},appendConnectedObj:function(e){this.assertConnectedObjLegal(e);var t=e.getCurrConnectableObj?e.getCurrConnectableObj():e,r=this._doAppendConnectedObj(t);return t&&t.appendLinkedConnector(this),r},_doAppendConnectedObj:function(t){var r=e.ArrayUtils.pushUniqueEx(this.getConnectedObjs(),t);return r.isPushed&&this.connectedObjAdded(t),r.index},insertConnectedObjBefore:function(e,t){this.assertConnectedObjLegal(e);var r=t?t.getCurrConnectableObj?t.getCurrConnectableObj():t:null,i=r?this.indexOfConnectedObj(r):-1;return i<0?this.appendConnectedObj(e):this.insertConnectedObjAt(e,i)},insertConnectedObjAt:function(e,t){t||(t=0),this.assertConnectedObjLegal(e);var r=e.getCurrConnectableObj?e.getCurrConnectableObj():e,i=this.indexOfConnectedObj(r),n=this.getConnectedObjs();i>=0?(n.splice(i,1),n.splice(t,0,r),this.notifyConnectedObjsChanged()):(n.splice(t,0,r),r&&r.appendLinkedConnector(this),this.connectedObjAdded(r))},removeConnectedObjAt:function(e){var t=this.getConnectedObjs()[e];t&&(this._doRemoveConnectedObjAt(e),t._doRemoveLinkedConnectorAt(t.indexOfLinkedConnector(this)),this.notifyConnectedObjsChanged())},_doRemoveConnectedObjAt:function(e){this.getConnectedObjs().splice(e,1)},removeConnectedObj:function(e){var t=this.getConnectedObjs().indexOf(e);t>=0&&this.removeConnectedObjAt(t)},replaceConnectedObj:function(e,t){var r=this.indexOfConnectedObj(e);r>=0&&this.setConnectedObjAt(r,t)},clearConnectedObjs:function(){this.setConnectedObjs([])},hasConnectedObj:function(e){return this.getConnectedObjs().indexOf(e)>=0},isConnectingWithObj:function(e){return this.hasConnectedObj(e)},sortConnectedObjs:function(e){this.getConnectedObjs().sort(e)},reverseConnectedObjOrder:function(){this.setPropStoreFieldValue("connectedObjs",e.ArrayUtils.reverse(this.getConnectedObjs())),this.notifyConnectedObjsChanged()},removeThisFromConnectedObjs:function(){for(var e=this.getConnectedObjCount()-1;e>=0;--e){this.getConnectedObjAt(e).removeLinkedConnector(this)}},getConnectedSiblings:function(){for(var e=this.getConnectedObjs(),t=[],r=this.getParent(),i=0,n=e.length;i<n;++i){var a=e[i];if(a.getParent&&a.getParent()!==r){var o=function e(t){if(t.getParent){var i=t.getParent();return i===r?i:e(i)}return t}(a);o&&t.push(o)}else t.push(a)}return t},isConnectingConnector:function(){for(var t=0,r=this.getConnectedObjCount();t<r;++t){if(this.getConnectedObjAt(t)instanceof e.ChemStructureConnector)return!0}return!1}}),e.ChemStructureConnector=a.create(e.BaseStructureConnector,{CLASS_NAME:"Kekule.ChemStructureConnector",initProperties:function(){this.defineProp("parity",{dataType:l.INT}),this.defineProp("connectedChemNodes",{dataType:l.ARRAY,serializable:!1,scope:a.PropertyScope.PUBLIC,setter:null,getter:function(){for(var t=[],r=0,i=this.getConnectedObjCount();r<i;++r){var n=this.getConnectedObjAt(r);n instanceof e.ChemStructureNode&&t.push(n)}return t}})},getAcceptCoordStickFrom:function(t){return!(this.isSiblingWith(t)||t instanceof e.ChemStructureNode||t instanceof e.BaseStructureConnector)},doCompare:function($super,t,r){var i=$super(t,r);if(!i&&r.method===e.ComparisonMethod.CHEM_STRUCTURE&&this._getComparisonOptionFlagValue(r,"stereo")){var n=this.getParity()||e.StereoParity.UNKNOWN,a=t.getParity&&t.getParity()||e.StereoParity.UNKNOWN;i=this.doCompareOnValue(n,a,r)}return i},clearStructureFlags:function(){this.setParity(e.StereoParity.NONE)},getConnectedChemNodeCount:function(){return this.getConnectedChemNodes().length},getConnectedNonHydrogenObjs:function(){for(var e=[],t=this.getConnectedObjs(),r=0,i=t.length;r<i;++r){var n=t[r];n.isHydrogenAtom&&n.isHydrogenAtom()||e.push(n)}return e},isNormalConnectorToHydrogen:function(){return this.getConnectedNonHydrogenObjs().length<=1}}),e.BondStereo={NONE:0,UP:1,UP_INVERTED:2,DOWN:3,DOWN_INVERTED:4,UP_OR_DOWN:8,UP_OR_DOWN_INVERTED:9,CLOSER:10,E_OR_Z:20,E:21,Z:22,E_Z_BY_COORDINATES:23,CIS_OR_TRANS:30,CIS:31,TRANS:32,getInvertedDirection:function(t){var r=e.BondStereo;switch(t){case r.UP:return r.UP_INVERTED;case r.UP_INVERTED:return r.UP;case r.DOWN:return r.DOWN_INVERTED;case r.DOWN_INVERTED:return r.DOWN;case r.UP_OR_DOWN:return r.UP_OR_DOWN_INVERTED;default:return t}}},e.Bond=a.create(e.ChemStructureConnector,{CLASS_NAME:"Kekule.Bond",initialize:function($super,t,r,i,n,a){$super(t,r||[]),(i||n||a)&&this.setBondForm(e.BondFormFactory.getBondForm(i,n,a))},initProperties:function(){this.defineProp("bondForm",{dataType:"Kekule.BondForm",serializable:!1,scope:a.PropertyScope.PUBLIC}),this.defineProp("bondType",{dataType:l.STRING,enumSource:e.BondType,getter:function(){var t=this.getBondForm();return t?t.getBondType():e.BondType.DEFAULT},setter:function(t){this.changeBondForm(this.getBondOrder(),e.ElectronSet.UNSET_ELECTRONCOUNT,t)}}),this.defineProp("bondOrder",{dataType:l.INT,enumSource:e.BondOrder,getter:function(){var t=this.getBondForm();return t?t.getBondOrder():e.BondOrder.UNSET},setter:function(t){this.changeBondForm(t,e.ElectronSet.UNSET_ELECTRONCOUNT,this.getBondType())}}),this.defineProp("bondValence",{dataType:l.INT,serializable:!1,getter:function(){var e=this.getBondForm();return e?e.getBondValence():0},setter:null}),this.defineProp("electronCount",{dataType:l.FLOAT,getter:function(){if(this.isAromatic())return 3;var t=this.getBondForm();return t?t.getElectronCount():e.ElectronSet.UNSET_ELECTRONCOUNT},setter:function(e){var t=this.getBondOrder();this.changeBondForm(t,e,this.getBondType())}}),this.defineProp("stereo",{dataType:l.INT,enumSource:e.BondStereo,defaultValue:e.BondStereo.NONE}),this.defineProp("isInAromaticRing",{dataType:l.BOOL,setter:null,getter:function(){var e=this.getParent();return!(!e||!e.isConnectorInAromaticRing)&&e.isConnectorInAromaticRing(this)}}),this.defineProp("neighboringBonds",{dataType:l.ARRAY,serializable:!1,scope:a.PropertyScope.PUBLIC,setter:null,getter:function(){for(var t=this.getNeighboringConnectors()||[],r=[],i=0,n=t.length;i<n;++i)t[i]instanceof e.Bond&&r.push(t[i]);return r}})},initPropValues:function($super){$super(),this.setPropStoreFieldValue("stereo",e.BondStereo.NONE)},getAutoIdPrefix:function(){return"b"},getStructureRelatedPropNames:function($super){return $super().concat(["bondForm","stereo"])},clearStructureFlags:function(){this.setPropStoreFieldValue("isInAromaticRing",null)},doGetParity:function($super){return this.isDoubleBond()?$super():null},doGetComparisonPropNames:function($super,t){var r=$super(t);return t.method===e.ComparisonMethod.CHEM_STRUCTURE&&this._getComparisonOptionFlagValue(t,"bondType")&&r.push("bondType"),r},doCompare:function($super,t,r){var i=$super(t,r);if(!i&&r.method===e.ComparisonMethod.CHEM_STRUCTURE){if(this._getComparisonOptionFlagValue(r,"connectedObjCount")){var n=this.getConnectedObjCount(),a=t.getConnectedObjCount&&t.getConnectedObjCount();i=this.doCompareOnValue(n,a,r)}if(!i&&this._getComparisonOptionFlagValue(r,"bondOrder")){var o=Math.round(this.getElectronCount()),s=Math.round(t.getElectronCount());i=this.doCompareOnValue(o,s,r)}}return i},changeBondForm:function(t,r,i){this.setBondForm(e.BondFormFactory.getBondForm(t,r,i))},canInvertBondDirection:function(){var t=e.BondType,r=this.getBondType();return[t.COVALENT,t.IONIC,t.METALLIC,t.HYDROGEN,t.UNKNOWN].indexOf(r)>=0},invertBondDirection:function(){this.setStereo(e.BondStereo.getInvertedDirection(this.getStereo()))},reverseConnectedObjOrder:function($super){this.canInvertBondDirection()&&($super(),this.invertBondDirection())},deriveBondCenter:function(){var e=this.getConnectedObjs();return{x:(e[0].coord2D.x+e[1].coord2D.x)/2,y:(e[0].coord2D.y+e[1].coord2D.y)/2}},normalizeDirection:function(){var t=e.BondStereo,r=[t.UP_INVERTED,t.DOWN_INVERTED,t.UP_OR_DOWN_INVERTED],i=this.getBondStereo();r.indexOf(i)>=0&&this.reverseConnectedObjOrder()},isCovalentBond:function(){return this.getBondType()===e.BondType.COVALENT},isSingleBond:function(){return this.getBondType()===e.BondType.COVALENT&&this.getBondOrder()===e.BondOrder.SINGLE&&!this.getIsInAromaticRing()},isDoubleBond:function(){return this.getBondType()===e.BondType.COVALENT&&this.getBondOrder()===e.BondOrder.DOUBLE&&!this.getIsInAromaticRing()},isTripleBond:function(){return this.getBondType()===e.BondType.COVALENT&&this.getBondOrder()===e.BondOrder.TRIPLE},isAromatic:function(){return(!!this.getIsInAromaticRing()||this.getBondOrder()===e.BondOrder.EXPLICIT_AROMATIC)&&this.getBondType()===e.BondType.COVALENT},isBondBetween:function(t,r){var i=this.getConnectedObjs();if(2!==i.length)return!1;for(var n,a,o=0,s=i.length;o<s;++o){var l=i[o];if(l instanceof e.Atom&&(l.isElement(t)?n=!0:l.isElement(r)&&(a=!0),n&&a))return!0}return!1}}),e.ChemStructureObjectGroup=a.create(e.ChemStructureObject,{CLASS_NAME:"Kekule.ChemStructureObjectGroup",ITEM_BASE_CLASSES:["Kekule.ChemStructureObject","Kekule.ChemStructureObjectGroup"],initialize:function($super,e){$super(e),this.setPropStoreFieldValue("items",[]),this.setPropStoreFieldValue("raiseExceptionOnTypeMismatch",[])},initProperties:function(){this.defineProp("items",{dataType:l.ARRAY}),this.defineProp("raiseExceptionOnTypeMismatch",{dataType:l.BOOL,defaultValue:!0,scope:a.PropertyScope.PUBLIC})},getAutoIdPrefix:function(){return"sg"},getStructureRelatedPropNames:function($super){return $super().concat(["items"])},doGetComparisonPropNames:function($super,t){var r=$super(t);return t.method===e.ComparisonMethod.CHEM_STRUCTURE&&r.push("items"),r},ownerChanged:function($super,e,t){for(var r=this.getItems(),i=0,n=r.length;i<n;++i){var a=r[i].obj;a&&a.setOwner&&a.setOwner(e)}$super(e,t)},_removeChildObj:function($super,e){var t=this.indexOfObj(e);t<0&&(t=this.indexOfItem(e)),t>=0&&this.removeObjAt(t),$super(e)},getObjectBaseClasses:function(){return this.getPrototype().ITEM_BASE_CLASSES},ensureItemClass:function(t){var r=this.getObjectBaseClasses();if(r.length>0){for(var i=0,n=r.length;i<n;++i)if(t instanceof o.findClass(r[i],void 0,e))return!0;if(this.getRaiseExceptionOnTypeMismatch()){var a=e.hasLocalRes()?e.$L("ErrorMsg.CHEMSTRUCTUREOBJECTGROUP_ITEMCLASS_MISMATCH"):"Mismatched group item class";e.raise(a)}return!1}return!0},notifyItemsChanged:function(){this.notifyPropSet("items",this.getPropStoreFieldValue("items"))},indexOfItem:function(e){return this.getItems().indexOf(e)},indexOfObj:function(e){for(var t=this.getItems(),r=0,i=t.length;r<i;++r)if(t[r].obj==e)return r;return-1},hasObj:function(e){return this.indexOfObj(e)>=0},setAttributesAt:function(t,r){var i=this.getItems()[t];if(i)for(var n=e.ObjUtils.getOwnedFieldNames(r),a=0,o=n.length;a<o;++a)i[n[a]]=r[n[a]]},getItemCount:function(){return this.getItems().length},getItemAt:function(e){return this.getItems()[e]},appendItem:function(e){return this.getItems().push(e),this},insertItem:function(e,t){return this.insertItemAt(e,t)},insertItemAt:function(t,r){return e.ArrayUtils.insertUniqueEx(this.getItems(),t,r).index},removeItemAt:function(e){this.getItems()[e]&&(this.getItems().splice(e,1),this.notifyItemsChanged())},removeItem:function(e){var t=this.getItems().indexOf(e);t>=0&&this.removeItemAt(t)},getObjAt:function(e){var t=this.getItemAt(e);return t?t.obj:null},insertObj:function(e,t,r){return this.insertObjAt(e,t,r)},insertObjAt:function(e,t,r){if(e)if(this.indexOfObj(e)>=0);else if(this.ensureItemClass(e)){var i={obj:e};this.beginUpdate();try{var n=this.insertItem(i,t);r&&this.setAttributesAt(n,r),this.notifyItemsChanged()}finally{this.endUpdate()}return n}},appendObj:function(e,t){return this.insertObj(e,null,t)},removeObjAt:function(e){this.getItems()[e]&&(this.getItems().splice(e,1),this.notifyItemsChanged())},removeObj:function(e){var t=this.indexOfObj(e);t>=0&&this.removeObjAt(t)},getAllObjs:function(){for(var e=[],t=0,r=this.getItemCount();t<r;++t)e.push(this.getObjAt(t));return e},getChildSubgroupNames:function($super){return["item"].concat($super())},getBelongChildSubGroupName:function(e){return"item"},getNextSiblingOfChild:function(e){var t=this.indexOfItem(e);return t<0&&(t=this.indexOfObj(e)),t>=0?this.getChildAt(t+1):null},appendChild:function(t){return t instanceof e.ChemObject?this.appendObj(t):this.appendItem(t)},insertChild:function(t,r){return t instanceof e.ChemObject?this.insertObj(t,r):this.insertItem(t,r)},insertBefore:function(e,t){var r=this.indexOfItem(t);return r<0&&(r=this.indexOfObj(t)),this.insertChild(e,r)}}),e.StructureFragmentGroup=a.create(e.ChemStructureObjectGroup,{CLASS_NAME:"Kekule.ChemStructureObjectGroup",ITEM_BASE_CLASSES:["Kekule.StructureFragment","Kekule.StructureFragmentGroup"]}),e.MoleculeGroup=a.create(e.ChemStructureObjectGroup,{CLASS_NAME:"Kekule.MoleculeGroup",ITEM_BASE_CLASSES:["Kekule.Molecule","Kekule.MoleculeGroup"]}),e.CompositeMolecule=a.create(e.Molecule,{CLASS_NAME:"Kekule.CompositeMolecule",initialize:function($super,e,t){$super(e,t)},initProperties:function(){this.defineProp("subMolecules",{dataType:"Kekule.MoleculeGroup",getter:function(){return this.getPropStoreFieldValue("subMolecules")||this.setPropStoreFieldValue("subMolecules",new e.MoleculeGroup),this.getPropStoreFieldValue("subMolecules")}})},doGetComparisonPropNames:function($super,t){var r=$super(t);return t.method===e.ComparisonMethod.CHEM_STRUCTURE&&r.push("subMolecules"),r},ownerChanged:function($super,e,t){var r=this.getPropStoreFieldValue("subMolecules");r&&r.setOwner(e),$super(e,t)},getSubMoleculeCount:function(){var e=this.getPropStoreFieldValue("subMolecules");return e?e.length:0},hasCtab:function(){return!1},hasFormula:function(){return!1},getAllContainingConnectors:function(){for(var e=this.getSubMolecules(),t=[],r=0,i=e.getItemCount();r<i;++r){var n=e.getObjAt(r);if(n.getAllContainingConnectors){var a=n.getAllContainingConnectors();a&&a.length&&(t=t.concat(a))}}return t},getContainerBox:function(t){var r=null,i=this.getPropStoreFieldValue("subMolecules");if(i)for(var n=0,a=i.getItemCount();n<a;++n){var o=i.getObjAt(n),s=o.getContainerBox(t);s&&(r=r?e.BoxUtils.getContainerBox(r,s):e.BoxUtils.clone(s))}return r},doGetCtab:function(){return null},doSetCtab:function(){},doGetFormula:function(){return null},doSetFormula:function(){},getChildSubgroupNames:function($super){return["subMolecule"].concat($super())},getBelongChildSubGroupName:function($super,t){return t instanceof e.Molecule?"subMolecule":$super(t)},getNextSiblingOfChild:function(e){return this.getSubMolecules().getNextSiblingOfChild(e)},insertChild:function(e,t){return this.insertChildAt(e,t)}}),e.MoleculeList=a.create(e.ChemObjList,{CLASS_NAME:"Kekule.MoleculeList",initialize:function($super,t){$super(t,e.Molecule)}}),e.ChemStructureNodeLabels={ENABLE_ISOTOPE_ALIAS:!0,UNSET_ELEMENT:"?",DUMMY_ATOM:"Du",HETERO_ATOM:"Q",ANY_ATOM:"A",CUSTOM_ATOM:"@",VARIABLE_ATOM:"L",SUBGROUP:"R",ISO_LIST_LEADING_BRACKET:"[",ISO_LIST_TAILING_BRACKET:"]",ISO_LIST_DELIMITER:",",ISO_LIST_DISALLOW_PREFIX:"NOT"},e.ChemStructureNodeFactory={CANDIDATE_CLASSES:[e.SubGroup,e.VariableAtom,e.Pseudoatom],getClassByLabel:function(t,r){void 0===r&&(r=e.Pseudoatom);for(var i,n=e.ChemStructureNodeLabels,a=[[n.SUBGROUP],[n.VARIABLE_ATOM],[n.DUMMY_ATOM,n.HETERO_ATOM,n.ANY_ATOM,n.CUSTOM_ATOM]],o=e.ChemStructureNodeFactory.CANDIDATE_CLASSES,s=0,l=o.length;s<l;++s){var d=o[s];if(a[s].indexOf(t)>=0){i=d;break}}return i||(i=e.IsotopesDataUtil.isIsotopeIdAvailable(t)?e.Atom:r),i},createByLabel:function(t){var r=e.ChemStructureNodeFactory.getClassByLabel(t),i=new r;return i instanceof e.Pseudoatom?i.setSymbol(t):i instanceof e.Atom&&i.setIsotopeId(t),i}},e}},function(e,t,r){"use strict";var i=r(0).Class,n=(r(0).ClassEx,r(0).ObjectEx);r(0).DataType;e.exports=function(e){return e.ChemStructureBuilder=i.create(n,{CLASS_NAME:"Kekule.ChemStructureBuilder",initialize:function($super,e){$super(),e&&this.setTarget(e)},initProperties:function(){this.defineProp("target",{dataType:"Kekule.StructureFragment"})},setNodeCoord:function(){for(var t=Array.prototype.slice.call(arguments),r=t.shift(),i=t,n=0,a=i.length;n<a&&n<2;++n){var o=i[n];void 0!==o.z?r.setCoordOfMode(o,e.CoordMode.COORD3D):r.setCoordOfMode(o,e.CoordMode.COORD2D)}},createNode:function(){var e=Array.prototype.slice.call(arguments),t=e.shift(),r=e.shift(),i=e,n=new t(r);return this.setNodeCoord(n,i),this.appendNode(n),n},createConnector:function(e,t,r){var i=new e(t);return i.setConnectedObjs(r),i},appendNode:function(e){return e&&this.getTarget()?this.getTarget().appendNode(e):null},appendConnector:function(e){return e&&this.getTarget()?this.getTarget().appendConnector(e):null},createAtom:function(){var t=Array.prototype.slice.call(arguments),r=t.shift(),i=t.shift(),n=t.shift(),a=new e.Atom(r,i,n);return t.unshift(a),this.setNodeCoord.apply(this,t),this.appendNode(a),a},createBond:function(t,r,i,n,a){var o=new e.Bond(t,r,i);return o.changeBondForm(i,null,a),n&&o.setStereo(n),this.appendConnector(o),o},deleteNode:function(){},marshalSubGroup:function(t,r){var i=this.getTarget();if(i&&i.hasCtab()){var n=new e.SubGroup(r);return i.marshalSubFragment(t,n),n}return null}}),e}},function(e,t,r){"use strict";var i=r(0).Class,n=(r(0).ClassEx,r(0).ObjectEx,r(0).DataType);e.exports=function(e){return e.ReactionComponent={REACTANT:"reactant",PRODUCT:"product",SUBSTANCE:"substance",CONDITION:"condition"},e.ReactionRole={REAGENT:"reagent",CATALYST:"catalyst",SOLVENT:"solvent",TEMPERATURE:"temperature",DURATION:"duration"},e.ReactionDirection={FORWARD:1,BACKWARD:-1,BIDIRECTION:0},e.Reaction=i.create(e.ChemObject,{CLASS_NAME:"Kekule.Reaction",initialize:function($super,t){$super(t),this.setDirection(e.ReactionDirection.FORWARD)},initProperties:function(){this.defineProp("name",{dataType:n.STRING}),this.defineProp("title",{dataType:n.STRING}),this.defineProp("reactionType",{dataType:n.STRING}),this.defineProp("yield",{dataType:n.FLOAT}),this.defineProp("direction",{dataType:n.INT,defaultValue:e.ReactionDirection.FORWARD,enumSource:e.ReactionDirection}),this.defineProp("reactants",{dataType:n.ARRAY,setter:null,getter:function(e){var t=this.getPropStoreFieldValue("reactants");return!t&&e&&(t=[],this.setPropStoreFieldValue("reactants",t)),t}}),this.defineProp("products",{dataType:n.ARRAY,setter:null,getter:function(e){var t=this.getPropStoreFieldValue("products");return!t&&e&&(t=[],this.setPropStoreFieldValue("products",t)),t}}),this.defineProp("substances",{dataType:n.ARRAY,setter:null,getter:function(e){var t=this.getPropStoreFieldValue("substances");return!t&&e&&(t=[],this.setPropStoreFieldValue("substances",t)),t}}),this.defineProp("conditions",{dataType:n.ARRAY,setter:null,getter:function(e){var t=this.getPropStoreFieldValue("conditions");return!t&&e&&(t=[],this.setPropStoreFieldValue("conditions",t)),t}})},ownerChanged:function($super,e,t){for(var r=["reactants","products","substances","conditions"],i=0,n=r.length;i<n;++i){var a=r[i],o=this.getComponentArray(a);if(o)for(var s=0,l=o.length;s<l;++s){var d=o[s].item;d.setOwner&&d.setOwner(e)}}$super(e,t)},assertAddingMolecule:function(t){t instanceof e.Molecule||e.chemError(e.$L("ErrorMsg.UNABLE_ADD_NONMOLECULE_MAP"))},notifyReactantsChange:function(){this.notifyPropSet("reactants",this.getPropStoreFieldValue("reactants"))},notifyProductsChange:function(){this.notifyPropSet("products",this.getPropStoreFieldValue("products"))},notifySubstancesChange:function(){this.notifyPropSet("substances",this.getPropStoreFieldValue("substances"))},notifyConditionsChange:function(){this.notifyPropSet("conditions",this.getPropStoreFieldValue("conditions"))},notifyComponentChange:function(e){var t=this.componentToPropName(e);t&&this.notifyPropSet(t,this.getPropStoreFieldValue(t))},componentToPropName:function(e){return e+"s"},getComponentArray:function(e,t){var r=this.componentToPropName(e);if(!r)return null;switch(r){case"reactants":return this.doGetReactants(t);case"products":return this.doGetProducts(t);case"substances":return this.doGetSubstances(t);case"conditions":return this.doGetConditions(t);default:return null}},getComponentItemCount:function(e){var t=this.getComponentArray(e);return t?t.length:0},getMapAt:function(e,t){var r=this.getComponentArray(e);return r?r[t]:null},getMapItemAt:function(e,t){var r=this.getMapAt(e,t);return r?r.item:null},indexOfMap:function(e,t){var r=this.getComponentArray(e);return r?r.indexOf(t):-1},indexOfItem:function(e,t,r){var i=this.getComponentArray(e);if(i)for(var n=0,a=i.length;n<a;++n)if(i[n].item==t){if(void 0===r)return n;if(r===i[n].role)return n}return-1},appendMap:function(t,r){t!=e.ReactionComponent.PRODUCT&&t!=e.ReactionComponent.REACTANT||this.assertAddingMolecule(r.item);var i=e.ArrayUtils.pushUniqueEx(this.getComponentArray(t,!0),r);return i.isPushed&&this.notifyComponentChange(t),i.index},appendItem:function(t,r,i,n){var a=this.indexOfItem(t,r,i);if(a<0){t!=e.ReactionComponent.PRODUCT&&t!=e.ReactionComponent.REACTANT||this.assertAddingMolecule(r);var o=e.RoleMapUtils.createMap(r,i);n&&Object.extend(o,n);var s=e.ArrayUtils.pushUniqueEx(this.getComponentArray(t,!0),o);return this.notifyComponentChange(t),s.index}return a},removeMapAt:function(t,r){var i=null,n=this.getComponentArray(t);return n&&(i=e.ArrayUtils.removeAt(n,r))&&this.notifyComponentChange(t),i},removeMap:function(t,r){var i=null,n=this.getComponentArray(t);return n&&(i=e.ArrayUtils.remove(n,r))&&this.notifyComponentChange(t),i},removeItem:function(e,t,r){var i=this.indexOfItem(e,t,r);return i>=0?this.removeMapAt(e,i):null},clearComponent:function(e){this.getComponentArray(e);this.notifyComponentChange(e)},getReactantCount:function(){return this.getComponentItemCount(e.ReactionComponent.REACTANT)},getProductCount:function(){return this.getComponentItemCount(e.ReactionComponent.PRODUCT)},getSubstancesCount:function(){return this.getComponentItemCount(e.ReactionComponent.SUBSTANCE)},getConditionCount:function(){return this.getComponentItemCount(e.ReactionComponent.CONDITION)},getReactantMapAt:function(t){return this.getMapAt(e.ReactionComponent.REACTANT,t)},getProductMapAt:function(t){return this.getMapAt(e.ReactionComponent.PRODUCT,t)},getSubstanceMapAt:function(t){return this.getMapAt(e.ReactionComponent.SUBSTANCE,t)},getConditionMapAt:function(t){return this.getMapAt(e.ReactionComponent.CONDITION,t)},getReactantItemAt:function(t){return this.getMapItemAt(e.ReactionComponent.REACTANT,t)},getReactantAt:function(t){return this.getMapItemAt(e.ReactionComponent.REACTANT,t)},getProductItemAt:function(t){return this.getMapItemAt(e.ReactionComponent.PRODUCT,t)},getProductAt:function(t){return this.getMapItemAt(e.ReactionComponent.PRODUCT,t)},getSubstanceItemAt:function(t){return this.getMapItemAt(e.ReactionComponent.SUBSTANCE,t)},getSubstanceAt:function(t){return this.getMapItemAt(e.ReactionComponent.SUBSTANCE,t)},getConditionItemAt:function(t){return this.getMapItemAt(e.ReactionComponent.CONDITION,t)},indexOfReactantMap:function(t){return this.indexOfMap(e.ReactionComponent.REACTANT,t)},indexOfProductMap:function(t){return this.indexOfMap(e.ReactionComponent.PRODUCT,t)},indexOfSubstanceMap:function(t){return this.indexOfMap(e.ReactionComponent.SUBSTANCE,t)},indexOfConditionMap:function(t){return this.indexOfMap(e.ReactionComponent.CONDITION,t)},indexOfReactant:function(t,r){return this.indexOfItem(e.ReactionComponent.REACTANT,t,r)},indexOfProduct:function(t,r){return this.indexOfItem(e.ReactionComponent.PRODUCT,t,r)},indexOfSubstance:function(t,r){return this.indexOfItem(e.ReactionComponent.SUBSTANCE,t,r)},indexOfCondition:function(t,r){return this.indexOfItem(e.ReactionComponent.CONDITION,t,r)},appendReactantMap:function(t){return this.appendMap(e.ReactionComponent.REACTANT,t)},appendProductMap:function(t){return this.appendMap(e.ReactionComponent.PRODUCT,t)},appendSubstanceMap:function(t){return this.appendMap(e.ReactionComponent.SUBSTANCE,t)},appendConditionMap:function(t){return this.appendMap(e.ReactionComponent.CONDITION,t)},appendReactant:function(t,r,i,n){var a=n||{};return i&&(a.amount=i),this.appendItem(e.ReactionComponent.REACTANT,t,r,a)},appendProduct:function(t,r,i,n){var a=n||{};return i&&(a.amount=i),this.appendItem(e.ReactionComponent.PRODUCT,t,r,a)},appendSubstance:function(t,r,i,n){var a=n||{};return i&&(a.amount=i),this.appendItem(e.ReactionComponent.SUBSTANCE,t,r,a)},appendCondition:function(t,r,i){return this.appendItem(e.ReactionComponent.CONDITION,t,r,i)},removeReactantAt:function(t){return this.removeMapAt(e.ReactionComponent.REACTANT,t)},removeProductAt:function(t){return this.removeMapAt(e.ReactionComponent.PRODUCT,t)},removeSubstanceAt:function(t){return this.removeMapAt(e.ReactionComponent.SUBSTANCE,t)},removeConditionAt:function(t){return this.removeMapAt(e.ReactionComponent.CONDITION,t)},removeReactantMap:function(t){return this.removeMap(e.ReactionComponent.REACTANT,t)},removeProductMap:function(t){return this.removeMap(e.ReactionComponent.PRODUCT,t)},removeSubstanceMap:function(t){return this.removeMap(e.ReactionComponent.SUBSTANCE,t)},removeConditionMap:function(t){return this.removeMap(e.ReactionComponent.CONDITION,t)},removeReactant:function(t,r){return this.removeItem(e.ReactionComponent.REACTANT,t,r)},removeProduct:function(t,r){return this.removeItem(e.ReactionComponent.PRODUCT,t,r)},removeSubstance:function(t,r){return this.removeItem(e.ReactionComponent.SUBSTANCE,t,r)},removeCondition:function(t,r){return this.removeItem(e.ReactionComponent.CONDITION,t,r)},clearReactants:function(){return this.clearComponent(e.ReactionComponent.REACTANT)},clearProducts:function(){return this.clearComponent(e.ReactionComponent.PRODUCT)},clearSubstance:function(){return this.clearComponent(e.ReactionComponent.SUBSTANCE)},clearConditions:function(){return this.clearComponent(e.ReactionComponent.CONDITION)},clearAll:function(){this.clearProducts(),this.clearProducts(),this.clearSubstance(),this.clearConditions()},getAllContainingConnectors:function(){for(var t=e.ReactionComponent,r=[t.REACTANT,t.PRODUCT,t.SUBSTANCE],i=[],n=0,a=r.length;n<a;++n)for(var o=r[n],s=0,l=this.getComponentItemCount(o);s<l;++s){var d=this.getMapItemAt(o,s);if(d.getAllContainingConnectors){var u=d.getAllContainingConnectors();u&&u.length&&(i=i.concat(u))}}return i}}),e.ReactionList=i.create(e.ChemObjList,{CLASS_NAME:"Kekule.ReactionList",initialize:function($super,t){$super(t,e.Reaction)}}),e}},function(e,t,r){"use strict";var i=r(0).Class,n=r(0).ClassEx,a=r(0).ObjectEx,o=r(0).DataType;e.exports=function(e){var t=e.ArrayUtils;e.ChemStructureUtils={getConnectorLengthMedian:function(e,t,r){for(var i=[],n=0,a=e.length;n<a;++n){var o=e[n];if(o&&o.getLength){var s=o.getLength(t,r);s&&i.push(s)}}if(0===a)return 1;if(a<=1)return i[0];i.sort();var l=i.length;return l%2?i[l+1>>1]:(i[l>>1]+i[(l>>1)-1])/2},getChildStructureObjs:function(t,r){var i;if(t instanceof e.CompositeMolecule)i=t.getSubMolecules().getAllObjs();else if(t instanceof e.ChemStructureObjectGroup)i=t.getAllObjs();else if(t instanceof e.ChemObjList)i=t.getItems();else if(t instanceof e.ChemSpaceElement)i=t.getChildren().getItems();else{if(!(t instanceof e.ChemSpace))return[t];i=t.getChildren()}if(i=[].concat(i),r){for(var n=[],a=0,o=i.length;a<o;++a){var s=i[a],l=e.ChemStructureUtils.getChildStructureObjs(s,r);l.length<=1?e.ArrayUtils.pushUnique(n,s):e.ArrayUtils.pushUnique(n,l)}i=n}return i},getAllStructFragments:function(t,r){if(t instanceof e.StructureFragment)return[t];for(var i=e.ChemStructureUtils.getChildStructureObjs(t,r),n=[],a=0,o=i.length;a<o;++a)i[a]instanceof e.StructureFragment&&e.ArrayUtils.pushUnique(n,i[a]);return n},getTotalStructFragment:function(t,r){var i=e.ChemStructureUtils.getAllStructFragments(t,!0),n=i.length;return n<=0?null:1===n?i[0]:e.ChemStructureUtils.mergeStructFragments(i,r)},getCascadeDeleteObjs:function(t){for(var r=[],i=t.getLinkedConnectors?t.getLinkedConnectors():[],n=0,a=i.length;n<a;++n){var o=i[n];if(o.getConnectedObjs().length<=2){e.ArrayUtils.pushUnique(r,o);var s=e.ChemStructureUtils.getCascadeDeleteObjs(o);e.ArrayUtils.pushUnique(r,s)}}if(t instanceof e.ChemStructureNode);else if(t instanceof e.ChemStructureConnector)for(var l=t.getConnectedObjs(),n=0,a=l.length;n<a;++n){var d=l[n];d instanceof e.ChemStructureNode&&d.getLinkedConnectors().length<=1&&e.ArrayUtils.pushUnique(r,d)}return r},moveChildBetweenStructFragment:function(t,r,i,n,a){return e.StructureFragment.moveChildBetweenStructFragment(t,r,i,n,a)},_getCascadeConnectedNodesAndConnectors:function(t,r){for(var i=[],n=[],a=t.getConnectedObjs(),o=0,s=a.length;o<s;++o){var l=a[o];if(l!==t)if(r&&(l=r.findDirectChildOfObj(l)),l instanceof e.ChemStructureNode)e.ArrayUtils.pushUnique(n,l);else if(l instanceof e.ChemStructureConnector){e.ArrayUtils.pushUnique(i,l);var d=e.ChemStructureUtils._getCascadeConnectedNodesAndConnectors(l);e.ArrayUtils.pushUnique(i,d.connectors),e.ArrayUtils.pushUnique(n,d.nodes)}}return{connectors:i,nodes:n}},mergeStructFragments:function(t,r){if(t.length<=1)return t[0];for(var i=r||e.Molecule,n=new i,a=0,o=t.length;a<o;++a){var s=t[a].clone();e.ChemStructureUtils.moveChildBetweenStructFragment(s,n,s.getNodes(),s.getConnectors())}return n},splitStructFragment:function(t){if(!t.hasCtab())return[t];var r=t.getNodes();if(r.length<=0)return[t];var i=t.getConnectors(),n=[],a=[r[0]],o=[],s=0;do{var l=a[s],d=l.getLinkedConnectors();l.getCrossConnectors&&d.concat(l.getCrossConnectors()||[]),e.ArrayUtils.pushUnique(o,d);for(var u=0,c=d.length;u<c;++u){var h=e.ChemStructureUtils._getCascadeConnectedNodesAndConnectors(d[u],t);e.ArrayUtils.pushUnique(o,h.connectors),e.ArrayUtils.pushUnique(a,h.nodes)}++s}while(s<a.length);n.push(t);var m=e.ArrayUtils.exclude(r,a),g=e.ArrayUtils.exclude(i,o);if(m.length>0){var f=t.getClass(),p=new f;e.ChemStructureUtils.moveChildBetweenStructFragment(t,p,m,g);var C=e.ChemStructureUtils.splitStructFragment(p);n=n.concat(C)}return n},getAbsCoordVectorBetweenObjs:function(t,r,i,n){var a=t.getAbsCoordOfMode(i,n),o=r.getAbsCoordOfMode(i,n);return e.CoordUtils.substract(o,a)},_getRef2DCoordOfObj:function(e,t){return e.getAbsBaseCoord2D?e.getAbsBaseCoord2D(t):e.getAbsCoord2D?e.getAbsCoord2D(t):e.getCoord2D(t)},_getStandardizedLinkedObj2DRelCoords:function(r,i,n,a,o){var s=[],l=e.ChemStructureUtils._getRef2DCoordOfObj(r,n),d=o?r.getLinkedObjs():r.getLinkedExposedObjs();a&&r.getAttachedMarkers&&(d=d.concat(r.getAttachedMarkers()||[])),i&&i.length&&(d=t.exclude(d,i));for(var u=0,c=d.length;u<c;++u){var h=d[u],m=e.ChemStructureUtils._getRef2DCoordOfObj(h,n),g=e.CoordUtils.substract(m,l);g=e.CoordUtils.standardize(g),s.push(g)}return s},_calcLinkedObj2DAnglesOfObj:function(t,r,i,n,a){for(var o=[],s=e.ChemStructureUtils._getStandardizedLinkedObj2DRelCoords(t,r,i,n,a),l=0,d=s.length;l<d;++l){var u=s[l];if(0!==u.x||0!==u.y){var c=Math.atan2(u.y,u.x);c<0&&(c=2*Math.PI+c),o.push(c)}}return o},_getMostEmptyDirectionOfExistingAngles:function(t,r){var i=t.length;if(0===i)return 0;if(1===i)return e.GeometryUtils.standardizeAngle(Math.PI+t[0]);0===t[1]&&(t[1]=2*Math.PI,t.sort());for(var n=0,a=0,o=0;o<i;++o){var s=t[o],l=t[(o+1)%i],d=l-s;d<0&&(d+=2*Math.PI),d.toFixed(6)>=n.toFixed(6)&&(n=d,a=o)}return 2===t.length&&0===t[0]&&t[1].toFixed(6)===Math.PI.toFixed(6)||0===t[1]&&t[0].toFixed(6)===Math.PI.toFixed(6)?3*Math.PI/2:0!==t[a]?t[a]+Math.PI/Math.pow(2,Math.round((i+1)/2)-1):t[a+1]-Math.PI/Math.pow(2,Math.round((i+1)/2)-1)},getMostEmptyDirection2DAngleOfObj:function(t,r,i,n,a,o){var s=e.ChemStructureUtils._calcLinkedObj2DAnglesOfObj(t,r,i,n,a),l=s[0];return s.sort(),o&&(s=0===s.length&&1===o.length&&0===o[0]?s.concat(Math.PI):s.concat(o),s.sort()),e.ChemStructureUtils._getMostEmptyDirectionOfExistingAngles(s,l)},isSameRing:function(e,r){return e.nodes.length===r.nodes.length&&(e.connectors.length===r.connectors.length&&(!(t.exclude(e.nodes,r.nodes).length>0)&&!(t.exclude(e.connectors,r.connectors).length>0)))},isInRings:function(t,r){for(var i=0,n=r.length;i<n;++i){var a=r[i];if(t===a)return!0;if(e.ChemStructureUtils.isSameRing(t,a))return!0}return!1}},e.TokenAnalyzer=i.create(a,{CLASS_NAME:"Kekule.TokenAnalyzer",initialize:function($super,e){$super(),this.setSrcText(e)},initProperties:function(){this.defineProp("srcText",{dataType:o.STRING,setter:function(e){var t=e||"";this.setPropStoreFieldValue("srcText",t),this.setPropStoreFieldValue("srcLength",t.length),this.setCurrPos(0)}}),this.defineProp("srcLength",{dataType:o.INT,setter:null,serializable:!1}),this.defineProp("currPos",{dataType:o.INT,serializable:!1})},getCharType:function(e){return 0},isCharTypeMatched:function(e,t){return e===t},nextCharInfo:function(){var e=this.getCurrPos();if(e>=this.getSrcLength())return null;var t=this.getSrcText().charAt(e);return this.setCurrPos(e+1),{char:t,charType:this.getCharType(t)}},nextTokenInfo:function(){var e=this.nextCharInfo();if(e){for(var t=e.char,r=e.charType,i=this.nextCharInfo();i&&this.isCharTypeMatched(i.charType,e.charType);)t+=i.char,e=i,i=this.nextCharInfo();return i&&this.setCurrPos(this.getCurrPos()-1),{token:t,tokenType:r}}return null},getAllTokenInfos:function(){for(var e=[],t=this.nextTokenInfo();t;)e.push(t),t=this.nextTokenInfo();return e}}),e.ChemTextTypes={CT_ATOM_SYMBOL_LEADING:1,CT_ATOM_SYMBOL_FOLLOWING:2,CT_CHARGE_SYMBOL:3,CT_NUMBER:4,CT_BRACKET_LEADING:10,CT_BRACKET_TAILING:11,CT_SEPARATOR:20,CT_UNKNOWN:0};var r=e.ChemTextTypes;e.ChemTextAnalyzer=i.create(e.TokenAnalyzer,{CLASS_NAME:"Kekule.ChemTextAnalyzer",getCharType:function(e){return" "===e?r.CT_SEPARATOR:e>="0"&&e<="9"?r.CT_NUMBER:["+","-"].indexOf(e)>=0?r.CT_CHARGE_SYMBOL:["(","[","{"].indexOf(e)>=0?r.CT_BRACKET_LEADING:[")","]","}"].indexOf(e)>=0?r.CT_BRACKET_TAILING:e>="A"&&e<="Z"?r.CT_ATOM_SYMBOL_LEADING:e>="a"&&e<="z"?r.CT_ATOM_SYMBOL_FOLLOWING:r.CT_UNKNOWN},isCharTypeMatched:function(t,i){return!e.ArrayUtils.intersect([r.CT_BRACKET_LEADING,r.CT_BRACKET_TAILING],[t,i]).length&&(t===i&&i!==r.CT_ATOM_SYMBOL_LEADING||i===r.CT_ATOM_SYMBOL_LEADING&&t===r.CT_ATOM_SYMBOL_FOLLOWING)}}),e.FormulaUtils={FORMULA_BRACKETS:[["(",")"],["[","]"],["{","}"]],FORMULA_BRACKET_TYPE_COUNT:3,textToFormula:function(t,i,n){var a=n||null;a&&a.clear();var o=new e.ChemTextAnalyzer(t);try{var s=o.getAllTokenInfos();a||(a=new e.MolecularFormula(i));var l=s.length;if(l){var d,u,c=null,h=a;d={};for(var m=function(){d={}},g=function(){d&&d.obj&&h.appendSection(d.obj,d.count,d.charge)},f=0;f<l;++f){var p=s[f],C=p.tokenType,b=p.token,E=!1;if(C===r.CT_BRACKET_LEADING){g();var N=new e.MolecularFormula(i);N._parentFormula=h,h=N,m(),E=!0}else if(C===r.CT_BRACKET_TAILING)g(),m(),d.obj=h,h=h._parentFormula,p.asSymbol=!0,E=!0;else if([r.CT_ATOM_SYMBOL_LEADING,r.CT_ATOM_SYMBOL_FOLLOWING].indexOf(C)>=0){d.obj&&(g(),m());var T=d.massNum;T||c&&!c.handled&&c.tokenType===r.CT_NUMBER&&(T=parseInt(c.token,10)||null);var O=""+(T||"")+b;d.obj=e.ChemStructureNodeFactory.createByLabel(O),p.asSymbol=!0,E=!0}else if(C===r.CT_CHARGE_SYMBOL){if(u="+"===b?1:-1,p.asCharge=!0,c.tokenType===r.CT_NUMBER){var _;if(c.asCount)if(c.token.length>1){var S=c.token;_=S.substr(S.length-1),c.asCount&&(d.count=parseInt(S.substring(0,S.length-1),10))}else _=c.token,c.asCount&&(d.count=1);else _=c.token,c.asChargeCount=!0;u*=parseInt(_,10)}d.charge=u,E=!0}else if(C===r.CT_NUMBER){var v=parseInt(b,10);u&&c.tokenType===r.CT_CHARGE_SYMBOL&&c.asCharge?(u*=v,d.charge=u,p.asChargeCount=!0,E=!0):d.obj&&c.asSymbol?(d.count=v,p.asCount=!0,E=!0):d.obj||(d.massNum=v,E=!0)}p.handled=E,c=p}d&&d.obj&&g()}return a}finally{o.finalize()}},formulaToText:function(t,r,i){return e.ObjUtils.isUnset(r)&&(r=!0),s._convFormulaToText(t,!1,r,i)},_convFormulaToText:function(t,r,i,n){var a="",o=t.getSections();if(r){var l=t.getMaxNestedLevel()%s.FORMULA_BRACKET_TYPE_COUNT,d=s.FORMULA_BRACKETS[l][0],u=s.FORMULA_BRACKETS[l][1];a+=d}for(var c=0,h=o.length;c<h;++c){var m=o[c].obj,g=t.getSectionCharge(o[c]),f=null;if(m instanceof e.MolecularFormula)f=s._convFormulaToText(m,!0,!1,!1,n);else if(m.getLabel){var f=m.getLabel();m.getMassNumber&&m.getMassNumber()&&(f=(a?" ":"")+f)}if(f){var p=!1;if(1!=o[c].count&&(f+=o[c].count,p=!0),i&&g){var C=s._convChargeToText(g,n);f+=(p?" ":"")+C}a+=f}}if(r&&(a+=u),i){var g=t.getCharge();if(g){var C=s._convChargeToText(g,n);a+=C}}return a},_convChargeToText:function(t,r){if(!t)return null;var i=t>0?"+":"-",n=Math.abs(t),a=i;return 1!=n&&(a=(r?e.NumUtils.toDecimals(n,r):n.toString())+i),a}};var s=e.FormulaUtils;return n.defineProp(e.MolecularFormula,"text",{dataType:o.STRING,serializable:!1,getter:function(){return s.formulaToText(this)},setter:function(e){s.textToFormula(e,this.getParent(),this)}}),e}},function(e,t,r){"use strict";var i=r(0).Class;r(0).ClassEx,r(0).DataType;e.exports=function(e){return e.Glyph={},e.Glyph.Base=i.create(e.ChemObject,{CLASS_NAME:"Kekule.Glyph.Base",initialize:function($super,e,t,r){$super(e),t&&this.setCoord2D(t),r&&this.setCoord3D(r)},initProperties:function(){},getAutoIdPrefix:function(){return"g"},getAllowChildCoordStickTo:function(e,t){return!1},getChildAcceptCoordStickFrom:function(e,t){return!1},getChildUseCoordStickOffset:function(e,t){return null}}),e.ClassDefineUtils.addStandardCoordSupport(e.Glyph.Base),e}},function(e,t,r){"use strict";var i=r(0).Class,n=(r(0).ClassEx,r(0).DataType);e.exports=function(e){var t=e.CoordUtils,r=e.CoordMode;return e.Glyph.PathGlyphNode=i.create(e.BaseStructureNode,{CLASS_NAME:"Kekule.Glyph.PathGlyphNode",initialize:function($super,t,r,i,n){$super(t),i&&this.setCoord2D(i),n&&this.setCoord3D(n),this.setNodeType(r||e.Glyph.NodeType.LOCATION)},initProperties:function(){this.defineProp("nodeType",{dataType:n.STRING,scope:i.PropertyScope.PUBLIC}),this.defineProp("pathNodeParams",{dataType:n.HASH,scope:i.PropertyScope.PUBLISHED,getter:function(){var e=this.getPropStoreFieldValue("pathNodeParams");return e||(e={},this.setPropStoreFieldValue("pathNodeParams",e)),e},setter:function(e){e?this.setPropStoreFieldValue("pathNodeParams",Object.extend({},e,!0)):this.setPropStoreFieldValue("pathNodeParams",null)}}),this.defineProp("anchorObj",{dataType:n.STRING})},initPropValues:function($super){$super()},getAllowCoordStickTo:function(e){if(!e||!this.isSiblingWith(e)){var t=this.getParent();if(t&&t.getAllowChildCoordStickTo)return t.getAllowChildCoordStickTo(this,e)}return!1},getAcceptCoordStickFrom:function(e){var t=this.getParent();return!(!t||!t.getChildAcceptCoordStickFrom)&&t.getChildAcceptCoordStickFrom(this,e)},notifyCoordStickTargetChanged:function($super,t,r){$super(t,r);var i=this.getParent();if(e.ObjUtils.isUnset(this.getPathNodeParams().useStickingOffset)&&i.getChildUseCoordStickOffset){var n=i.getChildUseCoordStickOffset(this,r);e.ObjUtils.notUnset(n)&&(this.getPathNodeParams().useStickingOffset=n)}i.notifyChildCoordStickTargetChanged&&i.notifyChildCoordStickTargetChanged(this.oldTarget,r)}}),e.Glyph.NodeType={LOCATION:"location",CONTROLLER:"controller",HIDDEN:"hidden"},e.Glyph.PathGlyphConnectorControlNode=i.create(e.BaseStructureNode,{CLASS_NAME:"Kekule.Glyph.PathGlyphConnectorControlNode",initialize:function($super,e,t,r){$super(e),t&&this.setCoord2D(t),r&&this.setCoord3D(r)},initPropValues:function($super){$super(),this.setInteractMode(e.ChemObjInteractMode.UNSELECTABLE)},getAutoIdPrefix:function(){return"cn"},getAcceptCoordStickFrom:function(e){return!1},getParentConnector:function(){var t=this.getParent();return t&&t instanceof e.Glyph.PathGlyphConnector?t:null},isPositioned:function(e,t){return e||(e=r.COORD2D),this.doCheckIsPositioned(e,t)},doCheckIsPositioned:function(e,t){return!0},resetPosition:function(e){return e?this.doResetPosition(e):(this.doResetPosition(r.COORD2D),this.doResetPosition(r.COORD3D)),this},doResetPosition:function(e){}}),e.Glyph.PathType={LINE:"L",ARC:"A"},e.Glyph.ArrowType={NONE:null,OPEN:"open",TRIANGLE:"triangle"},e.Glyph.ArrowSide={DEFAULT:0,BOTH:0,SINGLE:1,REVERSED:-1},e.Glyph.PathGlyphConnector=i.create(e.BaseStructureConnector,{CLASS_NAME:"Kekule.Glyph.PathGlyphConnector",initialize:function($super,e,t,r){$super(e,r),this.setPathType(t)},initProperties:function(){this.defineProp("pathType",{dataType:n.STRING,scope:i.PropertyScope.PUBLISHED,enumSource:e.Glyph.PathType}),this.defineProp("pathParams",{dataType:n.HASH,scope:i.PropertyScope.PUBLISHED,getter:function(){var e=this.getPropStoreFieldValue("pathParams");return e||(e={},this.setPropStoreFieldValue("pathParams",e)),e},setter:function(e){e?this.setPropStoreFieldValue("pathParams",Object.extend({},e,!0)):this.setPropStoreFieldValue("pathParams",null)}}),this.defineProp("controlPoints",{dataType:n.ARRAY,scope:i.PropertyScope.PUBLISHED,getter:function(e){var t=this.getPropStoreFieldValue("controlPoints");return!t&&e&&(t=[],this.setPropStoreFieldValue("controlPoints",t)),t},setter:function(e){this.clearControlPoints(),this.setPropStoreFieldValue("controlPoints",e),this._updateControlPointsOwner(),this._updateControlPointsParent()}})},initPropValues:function($super){$super(),this.setInteractMode(e.ChemObjInteractMode.UNSELECTABLE)},_appendChildObj:function($super,t){var r=$super(t);return t instanceof e.Glyph.PathGlyphConnectorControlNode&&this.tryResetControlPointPosition(t),r},doPropChanged:function($super,e,t){return"connectedObjs"===e&&this.tryResetAllControlPointPositions(),$super(e,t)},getAbsCoord2D:function(t){return this.getAbsCoordOfMode(e.CoordMode.COORD2D,t)},getAbsCoord3D:function(t){return this.getAbsCoordOfMode(e.CoordMode.COORD2D,t)},getAbsCoordOfMode:function(t,r){for(var i=e.CoordUtils,n={x:0,y:0},a=0,o=0,s=this.getConnectedObjCount();o<s;++o){var l=this.getConnectedObjAt(o);if(l&&l.getAbsCoordOfMode){var d=l.getAbsCoordOfMode(t,r);d&&(++a,n=i.add(n,d))}}return i.divide(n,a)},getChildSubgroupNames:function($super){return["controlPoint"].concat($super())},getBelongChildSubGroupName:function($super,t){return t instanceof e.Glyph.PathGlyphArcConnectorControlNode?"controlPoint":$super(t)},getControlPointCount:function(){var e=this.getControlPoints();return e&&e.length||0},getControlPointAt:function(e){return(this.getControlPoints()||[])[e]},indexOfControlPoint:function(e){var t=this.getControlPoints();return t?t.indexOf(e):-1},removeControlPointAt:function(e){var t=null,r=this.getControlPoints();return r&&e>=0&&e<r.length&&(t=r.splice(e,1),t.setOwner&&t.setOwner(null),t.setParent&&t.setParent(null),this.notifyPropSet("controlPoints",this.getControlPoints())),t},removeControlPoint:function(e){var t=null,r=this.getControlPoints();if(r){var i=r.indexOf(e);i>=0&&(r.splice(i,1),e.setOwner&&e.setOwner(null),e.setParent&&e.setParent(null),t=e,this.notifyPropSet("controlPoints",this.getControlPoints()))}return t},insertControlPointAt:function(t,r){var i=this.getControlPoints();if(i&&r<i.length){var n=e.ArrayUtils.insertUniqueEx(i,t,r);return n.isInserted&&(t.setOwner&&t.setOwner(this.getOwner()),t.setParent&&t.setParent(this),this.notifyPropSet("controlPoints",this.getControlPoints())),n.index}return-1},insertControlPointBefore:function(e,t){var r=this.getControlPoints();if(r){var i=t?this.indexOfControlPoint(t):-1;return i<0&&(i=r.length),this.insertControlPointAt(e,i)}return-1},tryResetControlPointPosition:function(e){if(e.isPositioned&&e.resetPosition)for(var t=[r.COORD2D,r.COORD3D],i=0,n=t.length;i<n;++i){var a=t[i];e.isPositioned(a,!0)||e.resetPosition(a)}},tryResetAllControlPointPositions:function(){for(var e=0,t=this.getControlPointCount();e<t;++e){var r=this.getControlPointAt(e);this.tryResetControlPointPosition(r)}},removeChildObj:function(e){return this.removeControlPoint(e)},hasChildObj:function(e){return this.hasChild(e)},getNextSiblingOfChild:function(e){var t=this.indexOfChild(e);return++t,this.getChildAt(t)},_updateControlPointsOwner:function(e){e||(e=this.getOwner());var t=this.getControlPoints();if(t)for(var r=0,i=t.length;r<i;++r){var n=t[r];n.setOwner&&n.setOwner(e)}},_updateControlPointsParent:function(e){e||(e=this);var t=this.getControlPoints();if(t)for(var r=0,i=t.length;r<i;++r){var n=t[r];n.setParent&&n.setParent(e)}},clearControlPoints:function(){var t=this.getControlPoints();if(t&&(t=e.ArrayUtils.clone(t)),this.setPropStoreFieldValue("controlPoints",null),t)for(var r=0,i=t.length;r<i;++r){var n=t[r];n.setOwner&&n.setOwner(null),n.setParent&&n.setParent(null)}return this.notifyPropSet("controlPoints",null),this},modifyPathParams:function(e){if(e){var t=this.getPathParams();return t=Object.extend(t,e||{}),this.setPathParams(t),t}return null}}),e.Glyph.PathGlyphArcConnectorControlNode=i.create(e.Glyph.PathGlyphConnectorControlNode,{CLASS_NAME:"Kekule.Glyph.PathGlyphArcConnectorControlNode",initProperties:function(){this.defineProp("distanceToChord",{dataType:n.FLOAT})},doCheckIsPositioned:function(t,r){return this.getIndirectCoordRefCoords(t,r)&&e.ObjUtils.notUnset(this.getDistanceToChord())},doResetPosition:function(e){if(e===r.COORD2D){var i=this.getIndirectCoordRefCoords(e,!0);if(i&&i[0]&&i[1]){var n=t.getDistance(i[0],i[1]);this.setDistanceToChord(.5*n),this.notifyPropSet("coord2D",this.getCoord2D())}}},doGetEnableIndirectCoord:function(){return!0},getIndirectCoordRefCoords:function($super,e,t){var r=this.getParentConnector();if(r&&r.getConnectedObjCount()>=2){return[r.getConnectedObjAt(0).getAbsCoordOfMode(t),r.getConnectedObjAt(1).getAbsCoordOfMode(t)]}return $super(e)},calcIndirectCoordValue:function($super,i,n){if(i===r.COORD2D){var a=this.getDistanceToChord();if(e.ObjUtils.notUnset(a)){var o=this.getIndirectCoordRefCoords();if(o){var s=o[0],l=o[1];if(s&&l){var d=t.substract(l,s),u=Math.sign(d.x),c=Math.sign(d.y);if(e.NumUtils.isFloatEqual(d.x,0,1e-10))g={x:-a*c,y:0};else if(e.NumUtils.isFloatEqual(d.y,0,1e-10))g={x:0,y:a*u};else{var h=d.y/d.x,m=-1/h,g={x:-c*a/Math.sqrt(1+Math.sqr(m))};g.y=g.x*m}return g}}}}return $super(i,n)},saveIndirectCoordValue:function($super,e,i,n,a){if(e===r.COORD2D){var o=n,s=this.getIndirectCoordRefCoords();if(s){var l=s[0],d=s[1],u=t.substract(d,l),c=Math.atan2(u.y,u.x),h=(t.getDistance(l,d),t.substract(i,o)),m=Math.atan2(h.y,h.x),g=t.getDistance(i,o),f=g*Math.sin(m-c),p=this.getDistanceToChord()||0,C=p+f;return this.setDistanceToChord(C),C}}return $super(e,i)}}),e.Glyph.PathGlyphArcConnector=i.create(e.Glyph.PathGlyphConnector,{CLASS_NAME:"Kekule.Glyph.PathGlyphArcConnector",initialize:function($super,t,r){$super(t,e.Glyph.PathType.ARC,r);var i=new e.Glyph.PathGlyphArcConnectorControlNode(null,{x:0,y:0});this.setControlPoints([i])},getControlPoint:function(){return(this.getControlPoints()||[])[0]}}),e.Glyph.PathGlyph=i.create(e.Glyph.Base,{CLASS_NAME:"Kekule.Glyph.PathGlyph",initialize:function($super,e,t,r,i,n){$super(e,i,n),this.createDefaultStructure(t||1,r||{})},doFinalize:function($super){this.hasCtab()&&this.getCtab().finalize(),$super()},initProperties:function(){this.defineProp("ctab",{dataType:"Kekule.StructureConnectionTable",scope:i.PropertyScope.PUBLIC,getter:function(e){return this.getPropStoreFieldValue("ctab")||e&&this.createCtab(),this.getPropStoreFieldValue("ctab")},setter:function(e){var t=this.getPropStoreFieldValue("ctab");t&&(t.finalize(),t=null),e&&(e.setPropValue("parent",this,!0),e.setOwner(this.getOwner())),this.setPropStoreFieldValue("ctab",e)}}),this.defineProp("nodes",{dataType:n.ARRAY,serializable:!1,scope:i.PropertyScope.PUBLIC,setter:null,getter:function(){return this.hasCtab()?this.getCtab().getNodes():[]}}),this.defineProp("connectors",{dataType:n.ARRAY,serializable:!1,scope:i.PropertyScope.PUBLIC,setter:null,getter:function(){return this.hasCtab()?this.getCtab().getConnectors():[]}})},createDefaultStructure:function(e,t){e||(e=1);var r={},i=["startArrowLength","startArrowWidth","endArrowLength","endArrowWidth"];for(var n in t)i.indexOf(n)>=0?r[n]=t[n]*e:r[n]=t[n];return this.doCreateDefaultStructure(e,r)},doCreateDefaultStructure:function(e,t){},getAutoIdPrefix:function(){return"p"},ownerChanged:function($super,e,t){this.hasCtab()&&this.getCtab().setOwner(e),$super(e,t)},_removeChildObj:function($super,e){if(this.hasCtab()){var t=this.getCtab();t===e?this.removeCtab():t.hasChildObj(e)&&t.removeChildObj(e)}$super(e)},isEmpty:function(){return this.getCtab().isEmpty()},createCtab:function(){var t=new e.StructureConnectionTable(this.getOwner(),this);this.setPropStoreFieldValue("ctab",t),t.addEventListener("propValueSet",function(e){"nodes"==e.propName&&this.notifyPropSet(e.propName,e.propValue)},this),t.setEnablePropValueSetEvent(!0)},hasCtab:function(){return!!this.getPropStoreFieldValue("ctab")},getContainerBox:function($super,e,t){return this.hasCtab()?this.getCtab().getContainerBox(e,t):$super(e)},getNodeById:function(e){return this.hasCtab()?this.getCtab().getNodeById(e):null},getConnectorById:function(e){return this.hasCtab()?this.getCtab().getConnectorById(e):null},getObjectById:function(e){var t=this.getNodeById(e);return t||this.getConnectorById(e)},getNodeCount:function(){return this.hasCtab()?this.getCtab().getNodeCount():0},getNodeAt:function(e){return this.hasCtab()?this.getCtab().getNodeAt(e):null},indexOfNode:function(e){return this.hasCtab()?this.getCtab().indexOfNode(e):-1},hasNode:function(e,t){return this.hasCtab()?this.getCtab().hasNode(e,t):null},appendNode:function(e){return this.doGetCtab(!0).appendNode(e)},insertNodeAt:function(e,t){return this.doGetCtab(!0).insertNodeAt(e,t)},insertNodeBefore:function(e,t){var r=t?this.indexOfNode(t):-1;return r<0?this.appendNode(e):this.doGetCtab(!0).insertNodeAt(e,r)},removeNodeAt:function(e,t){return this.hasCtab()?this.getCtab().removeNodeAt(e,t):null},removeNode:function(e,t){return this.hasCtab()?this.getCtab().removeNode(e,t):null},replaceNode:function(e,t){return this.hasCtab()?this.getCtab().replaceNode(e,t):null},clearNodes:function(){if(this.hasCtab())return this.getCtab().clearNodes()},nodesHasCoord2D:function(e){return!!this.hasCtab()&&this.getCtab().nodesHasCoord2D(e)},nodesHasCoord3D:function(e){return!!this.hasCtab()&&this.getCtab().nodesHasCoord3D(e)},getConnectorCount:function(){return this.hasCtab()?this.getCtab().getConnectorCount():0},getConnectorAt:function(e){return this.hasCtab()?this.getCtab().getConnectorAt(e):null},indexOfConnector:function(e){return this.hasCtab()?this.getCtab().indexOfConnector(e):-1},hasConnector:function(e,t){return this.hasCtab()?this.getCtab().hasConnector(e,t):null},appendConnector:function(e){return this.doGetCtab(!0).appendConnector(e)},insertConnectorAt:function(e,t){return this.doGetCtab(!0).insertConnectorAt(e,t)},insertConnectorBefore:function(e,t){var r=t?this.indexOfConnector(t):-1;return r<0?this.appendConnector(e):this.doGetCtab(!0).insertConnectorAt(e,r)},removeConnectorAt:function(e,t){return this.hasCtab()?this.getCtab().removeConnectorAt(e,t):null},removeConnector:function(e,t){return this.hasCtab()?this.getCtab().removeConnector(e,t):null},clearConnectors:function(){if(this.hasCtab())return this.getCtab().clearConnectors()},_getObjsNeedToBeCascadeRemoved:function(e,t){return this.hasCtab()?this.getCtab()._getObjsNeedToBeCascadeRemoved(e,t):[]},getChildSubgroupNames:function($super){return["node","connector"].concat($super())},getBelongChildSubGroupName:function($super,t){return t instanceof e.Glyph.PathGlyphNode?"node":t instanceof e.Glyph.PathGlyphConnector?"connector":$super(t)},removeChildObj:function(e,t,r){this.hasCtab()&&this.getCtab().removeChildObj(e,t,r)},hasChildObj:function(e){return!!this.hasCtab()&&this.getCtab().hasChildObj(e)},getNextSiblingOfChild:function(e){return this.hasCtab()?this.getCtab().getNextSiblingOfChild(e):null},getDirectManipulationTarget:function(){return null}}),e}},function(e,t,r){"use strict";var i=r(0).Class,n=(r(0).ClassEx,r(0).DataType);e.exports=function(e){var t=e.ObjUtils,r=(e.Glyph.NodeType,e.Glyph.PathType),a=e.CoordUtils,o=e.CoordMode;return e.Glyph.StraightLine=i.create(e.Glyph.PathGlyph,{CLASS_NAME:"Kekule.Glyph.StraightLine",initialize:function($super,e,t,r,i,n){$super(e,t,r,i,n)},doCreateDefaultStructure:function(t,i){var n=e.CoordUtils,a={x:0,y:0},o={x:0,y:0,z:0},s={x:t*(i.lineLength||1)},l=new e.Glyph.PathGlyphNode(null,null,a,o),d=new e.Glyph.PathGlyphNode(null,null,n.add(a,s),n.add(o,s)),u=new e.Glyph.PathGlyphConnector(null,r.LINE,[l,d]);this._applyParamsToConnector(u,i),this.appendNode(l),this.appendNode(d),this.appendConnector(u)},_applyParamsToConnector:function(t,r){var i=Object.create(r);e.ObjUtils.isUnset(r.autoOffset)&&(i.autoOffset=!1),t.setPathParams(i)},getDirectManipulationTarget:function(){return this.getNodeAt(this.getNodeCount()-1)}}),e.Glyph.Polygon=i.create(e.Glyph.PathGlyph,{CLASS_NAME:"Kekule.Glyph.Polygon",initialize:function($super,e,t,r,i,n){$super(e,t,r,i,n)},getRefLengthRatio:function(){return 1},doCreateDefaultStructure:function(t,i){for(var n,a,o=e.CoordUtils,s={x:0,y:0},l={x:0,y:0,z:0},d=i.nodeProps,u=i.connectorProps,c=t*(i.lineLength||1)*this.getRefLengthRatio(),h=i.edgeCount||3,m=2*Math.PI/h,g=h%2?0:-m/2,f=g,p=0;p<h;++p){var C={x:c*Math.sin(f),y:c*Math.cos(f)},b=new e.Glyph.PathGlyphNode(null,null,o.add(s,C),o.add(l,C));if(d&&b.setPropValues(d),this.appendNode(b),0===p&&(n=b),a){var E=new e.Glyph.PathGlyphConnector(null,r.LINE,[a,b]);u&&E.setPropValues(u),this._applyParamsToConnector(E,i),this.appendConnector(E)}a=b,f+=m}var E=new e.Glyph.PathGlyphConnector(null,r.LINE,[b,n]);u&&E.setPropValues(u),this._applyParamsToConnector(E,i),this.appendConnector(E)},_applyParamsToConnector:function(e,t){e.setPathParams(t)}}),e.Glyph.BaseArc=i.create(e.Glyph.PathGlyph,{CLASS_NAME:"Kekule.Glyph.BaseArc",initialize:function($super,e,t,r,i,n){$super(e,t,r,i,n)},doCreateDefaultStructure:function(t,r){var i=e.CoordUtils,n={x:0,y:0},a={x:0,y:0,z:0},o={x:t*(r.lineLength||1)},s=new e.Glyph.PathGlyphNode(null,null,n,a),l=new e.Glyph.PathGlyphNode(null,null,i.add(n,o),i.add(a,o));this.appendNode(s),this.appendNode(l);var d=new e.Glyph.PathGlyphArcConnector(null,[s,l]);this._applyParamsToConnector(d,r),this.appendConnector(d),d.setInteractMode(e.ChemObjInteractMode.HIDDEN)},getDirectManipulationTarget:function(){return this.getNodeAt(this.getNodeCount()-1)},_isValidChemNodeOrConnectorStickTarget:function(t){return e.Glyph.ElectronArrowGlyphUtils.isValidChemNodeOrConnectorStickTarget(t)},_applyParamsToConnector:function(e,t){e.setPathParams(t)},getAllowChildCoordStickTo:function(e,t){return!t||this._isValidChemNodeOrConnectorStickTarget(t,e)&&!this._isChildrenStickingTo(t,[e])},getChildUseCoordStickOffset:function($super,t,r){return r instanceof e.ChemStructureNode||r instanceof e.ChemStructureConnector},_isChildrenStickingTo:function(t,r){var i=this.getNodes();i=e.ArrayUtils.exclude(i,r||[]);for(var n=0,a=i.length;n<a;++n){if(i[n].getCoordStickTarget()===t)return!0}return!1}}),e.Glyph.BaseTwinArc=i.create(e.Glyph.PathGlyph,{CLASS_NAME:"Kekule.Glyph.BaseTwinArc",DEF_MIN_PATH_END_DISTANCE_RATIO:.05,DEF_INIT_PATH_END_GAP_RATIO:.2,FIELD_ARC_END_NODE_FLAG:"__$arcEndNode$__",initialize:function($super,e,t,r,i,n){this.setPropStoreFieldValue("minPathEndDistanceRatio",this.DEF_MIN_PATH_END_DISTANCE_RATIO),$super(e,t,r,i,n)},initProperties:function(){this.defineProp("minPathEndDistanceRatio",{dataType:n.FLOAT}),this.defineProp("oppositePathEndArrowSides",{dataType:n.BOOL,serializable:!1,getter:function(){return this._isPathArrowSideOpposite("end")},setter:function(e){this._setPathArrowSideOpposite("end",!!e)}}),this.defineProp("oppositePathStartArrowSides",{dataType:n.BOOL,serializable:!1,getter:function(){return this._isPathArrowSideOpposite("start")},setter:function(e){this._setPathArrowSideOpposite("start",!!e)}})},loaded:function($super){var e=$super();return this._isTwinArcSetup()&&(this._setupArcEndNode(this.getNodeAt(1)),this._setupArcEndNode(this.getNodeAt(2))),e},_isPathArrowSideOpposite:function(r){var i=this.getConnectorCount();if(i<2)return null;for(var n,a=null,o=0;o<i;++o){var s=this.getConnectorAt(o),l=s.getPathParams();if(l[r+"ArrowType"]===e.Glyph.ArrowType.NONE)return null;var d=l[r+"ArrowSide"];if(d===e.Glyph.ArrowSide.BOTH)return null;if(0===o)n=d;else{var u=n!==d;if(t.isUnset(a))a=u;else if(a!==u)return null;n=d}}return a},_setPathArrowSideOpposite:function(r,i){var n=this.getConnectorCount();if(n<2)return null;for(var a,o=e.Glyph.ArrowSide,s=!0,l=0;l<n;++l){var d=this.getConnectorAt(l),u=d.getPathParams();u[r+"ArrowType"]===e.Glyph.ArrowType.NONE&&(s=!1);var c=u[r+"ArrowSide"];if(c===e.Glyph.ArrowSide.BOTH&&(s=!1),s)if(t.isUnset(a))a=c;else{var h;h=i?a===o.SINGLE?o.REVERSED:o.SINGLE:a,u[r+"ArrowSide"]=h,a=h}else a=null}return null},_isTwinArcSetup:function(){return 2===this.getConnectorCount()&&4===this.getNodeCount()},getDirectManipulationTarget:function(){return this.getNodeAt(this.getNodeCount()-1)},doCreateDefaultStructure:function(t,r){var i=e.CoordUtils,n={x:0,y:0},o={x:0,y:0,z:0},s=r.lineLength||1,l=r.minPathEndDistanceRatio||this.getMinPathEndDistanceRatio()||this.DEF_MIN_PATH_END_DISTANCE_RATIO,d=s*l;this.setMinPathEndDistanceRatio(l);var u=r.pathEndGap||s*this.DEF_INIT_PATH_END_GAP_RATIO;u=Math.max(u,d);var c={x:t*((s-u)/2)},h={x:t*u},m={x:t*s},g=new e.Glyph.PathGlyphNode(null,null,n,o),f=new e.Glyph.PathGlyphNode(null,null);this._setupArcEndNode(f);var p=new e.Glyph.PathGlyphNode(null,null),C=new e.Glyph.PathGlyphNode(null,null,i.add(n,m),i.add(o,m));this._setupArcEndNode(p),this.appendNode(g),this.appendNode(f),this.appendNode(p),this.appendNode(C),f.setCoord2D(i.add(n,c)).setCoord3D(i.add(o,c)),p.setCoord2D(i.add(n,a.add(c,h))).setCoord3D(i.add(o,a.add(c,h)));var b=new e.Glyph.PathGlyphArcConnector(null,[g,f]),E=new e.Glyph.PathGlyphArcConnector(null,[C,p]);this._applyParamsToConnector(b,r),this._applyParamsToConnector(E,r),E.getControlPointAt(0).setDistanceToChord(-E.getControlPointAt(0).getDistanceToChord()),this.appendConnector(b),this.appendConnector(E),b.setInteractMode(e.ChemObjInteractMode.HIDDEN),E.setInteractMode(e.ChemObjInteractMode.HIDDEN)},_applyParamsToConnector:function(e,t){e.setPathParams(t)},_setupArcEndNode:function(e){e[this.FIELD_ARC_END_NODE_FLAG]||(this._overwriteChildPathNodeMethods(e),e.setEnableIndirectCoord(!0),e[this.FIELD_ARC_END_NODE_FLAG]=!0)},_overwriteChildPathNodeMethods:function(e){e.overwriteMethod("getIndirectCoordRefLengths",this._insideNodeGetIndirectCoordRefLengths).overwriteMethod("getIndirectCoordRefCoords",this._insideNodeGetIndirectCoordRefCoords).overwriteMethod("calcIndirectCoordStorage",this._insideNodeCalcIndirectCoordStorage).overwriteMethod("calcIndirectCoordValue",this._insideNodeCalcIndirectCoordValue).overwriteMethod("_childPathNodeGetParentGlyph",this._childPathNodeGetParentGlyph).overwriteMethod("_childPathNodeGetGlyphMinPathEndDistanceRatio",this._childPathNodeGetGlyphMinPathEndDistanceRatio)},_getArrowStartingNodes:function(){var e=[];if(this._isTwinArcSetup())for(var t=0,r=this.getConnectorCount();t<r;++t){var i=this.getConnectorAt(t),n=i.getConnectedObjAt(0);n&&e.push(n)}return e},_childPathNodeGetParentGlyph:function(t){var r=this.getParent();return r instanceof e.Glyph.BaseTwinArc?r:null},_childPathNodeGetGlyphMinPathEndDistanceRatio:function(e){var t=this._childPathNodeGetParentGlyph();return t&&t.getMinPathEndDistanceRatio()},_insideNodeGetIndirectCoordRefLengths:function(t,r,i){var n=this.getParent();if(!n||r!==e.CoordMode.COORD2D)return t(r,i);var a=n.getNodeAt(0),o=n.getNodeAt(n.getNodeCount()-1);if(a&&o){var s=a.getAbsCoordOfMode(r),l=o.getAbsCoordOfMode(r),d=e.CoordUtils.getDistance(l,s);return{x:d,y:d,length:d}}},_insideNodeGetIndirectCoordRefCoords:function(e,t,r){var i=this.getParent();if(!i||t!==o.COORD2D)return e(t,r);var n=i.getNodeAt(0),a=i.getNodeAt(i.getNodeCount()-1);if(n&&a){return[n.getCoordOfMode(t),a.getCoordOfMode(t)]}},_insideNodeCalcIndirectCoordStorage:function(t,r,i,n,s){var l=this.getParent();if(l&&r===o.COORD2D){var d=this.getIndirectCoordRefCoords(r,s);if(d){var u=l.getNodeAt(0),c=u.getCoordOfMode(r),h=e.GeometryUtils.getPerpendicularCrossPointFromCoordToLine(i,d[0],d[1],!1);if(!h){h=a.getDistance(i,d[0])<a.getDistance(i,d[1])?d[0]:d[1]}var m=a.getDistance(c,h),g=a.getDistance(d[1],d[0]),f=g?m/g:0,p=this._childPathNodeGetGlyphMinPathEndDistanceRatio()||0;return f<p?f=p:f>1-p&&(f=1-p),{x:f,y:f,ratio:f}}}return t(r,i,n,s)},_insideNodeCalcIndirectCoordValue:function(t,r,i){var n=this.getParent();if(n&&r===o.COORD2D){var s=this.getIndirectCoordRefCoords(r,i);if(s){var l=a.substract(s[1],s[0]),d=n.getNodeAt(0),u=d.getCoordOfMode(r),c=this.getIndirectCoordStorageOfMode(r).ratio;if(e.ObjUtils.notUnset(c)){var h=a.multiply(l,c);return a.add(u,h)}}}return t(r,i)},_isValidChemNodeOrConnectorStickTarget:function(t){var r=t instanceof e.ChemStructureNode||t instanceof e.ChemStructureConnector;if(!r&&t instanceof e.ChemMarker.BaseMarker){var i=t.getParent&&t.getParent();i&&(r=i instanceof e.ChemStructureNode||i instanceof e.ChemStructureConnector)}return r},getAllowChildCoordStickTo:function(e,t){var r=this.indexOfNode(e);if(0===r||r===this.getNodeCount()-1){return!t||this._isValidChemNodeOrConnectorStickTarget(t,e)&&!this._isChildrenStickingTo(t,[e])}return!1},getChildUseCoordStickOffset:function($super,t,r){return r instanceof e.ChemStructureNode||r instanceof e.ChemStructureConnector},_isChildrenStickingTo:function(t,r){var i=this._getArrowStartingNodes();i=e.ArrayUtils.exclude(i,r||[]);for(var n=0,a=i.length;n<a;++n){if(i[n].getCoordStickTarget()===t)return!0}return!1}}),e.Glyph.Arc=i.create(e.Glyph.BaseArc,{CLASS_NAME:"Kekule.Glyph.Arc"}),e.Glyph.TwinArc=i.create(e.Glyph.BaseTwinArc,{CLASS_NAME:"Kekule.Glyph.TwinArc"}),e}},function(e,t,r){"use strict";var i=r(0).Class,n=(r(0).ClassEx,r(0).DataType);e.exports=function(e){var t=e.ObjUtils,r=(e.Glyph.NodeType,e.Glyph.PathType),a=e.Glyph.ElectronArrowGlyphUtils;return e.Glyph.HeatSymbol=i.create(e.Glyph.Polygon,{CLASS_NAME:"Kekule.Glyph.HeatSymbol",initialize:function($super,e,t,r,i,n){$super(e,t,r,i,n),this.setRenderOption&&this.setRenderOption("strokeWidth",1.5)},getRefLengthRatio:function(){return.25},doCreateDefaultStructure:function($super,t,r){return r.edgeCount=3,r.nodeProps=Object.extend(r.nodeProps||{},{interactMode:e.ChemObjInteractMode.HIDDEN}),r.connectorProps=Object.extend(r.connectorProps||{},{interactMode:e.ChemObjInteractMode.HIDDEN}),$super(t,r)},_applyParamsToConnector:function($super,e,t){return $super(e,t)}}),e.Glyph.AddSymbol=i.create(e.Glyph.PathGlyph,{CLASS_NAME:"Kekule.Glyph.AddSymbol",initialize:function($super,e,t,r,i,n){$super(e,t,r,i,n),this.setRenderOption&&this.setRenderOption("strokeWidth",1.5)},getRefLengthRatio:function(){return.5},doCreateDefaultStructure:function(t,i){var n={interactMode:e.ChemObjInteractMode.HIDDEN},a={interactMode:e.ChemObjInteractMode.HIDDEN},o=e.CoordUtils,s={x:0,y:0},l={x:0,y:0,z:0},d=t*this.getRefLengthRatio()*(i.lineLength||1)/2,u=new e.Glyph.PathGlyphNode(null,null,s,l);u.setPropValues(n),this.appendNode(u);for(var c=[{x:-d,y:0},{x:0,y:-d},{x:d,y:0},{x:0,y:d}],h=0,m=c.length;h<m;++h){var g=c[h],f=new e.Glyph.PathGlyphNode(null,null,o.add(s,g),o.add(l,g));f.setPropValues(n);var p=new e.Glyph.PathGlyphConnector(null,r.LINE,[u,f]);p.setPropValues(a),this._applyParamsToConnector(p,i),this.appendNode(f),this.appendConnector(p)}},_applyParamsToConnector:function(e,t){e.setPathParams(t)}}),e.Glyph.Segment=i.create(e.Glyph.StraightLine,{CLASS_NAME:"Kekule.Glyph.Segment"}),e.Glyph.ReactionArrowType={NORMAL:"normal",REVERSIBLE:"reversible",RESONANCE:"resonance",RETROSYNTHESIS:"retrosynthesis",CUSTOM:"custom"},e.Glyph.ReactionArrowType.getDefPathParamOfArrowType=function(t){var r,i=e.Glyph.ReactionArrowType,n=e.Glyph.ArrowType,a=e.Glyph.ArrowSide;switch(t){case i.NORMAL:r={startArrowType:n.NONE,endArrowType:n.OPEN,endArrowSide:a.BOTH,lineCount:1};break;case i.REVERSIBLE:r={startArrowType:n.OPEN,startArrowSide:a.REVERSED,endArrowType:n.OPEN,endArrowSide:a.SINGLE,lineGap:.1,lineCount:2};break;case i.RESONANCE:r={startArrowType:n.OPEN,startArrowSide:a.BOTH,endArrowType:n.OPEN,endArrowSide:a.BOTH,lineCount:1};break;case i.RETROSYNTHESIS:r={startArrowType:n.NONE,endArrowType:n.OPEN,endArrowSide:a.BOTH,lineGap:.1,lineCount:2};break;default:r=null}return r},e.Glyph.ReactionArrow=i.create(e.Glyph.StraightLine,{CLASS_NAME:"Kekule.Glyph.ReactionArrow",initProperties:function(){this.defineProp("reactionType",{dataType:n.STRING,enumSource:e.Glyph.ReactionArrowType,setter:function(e){this.setPropStoreFieldValue("reactionType",e),this.reactionTypeChanged(e)}})},initPropValues:function($super){$super(),this.setReactionType(e.Glyph.ReactionArrowType.NORMAL)},doCreateDefaultStructure:function($super,e,t){var r=t,i=t.reactionType||this.getReactionType();if(i){var n=this._getPathParamOfArrowType(i);r=Object.extend(n,t)}var a=$super(e,r);return i&&this.setReactionType(i),a},reactionTypeChanged:function(e){var t=this._getPathParamOfArrowType(e);if(t){var r=this.getConnectorAt(0);r&&r.modifyPathParams(t)}},_getPathParamOfArrowType:function(t){return e.Glyph.ReactionArrowType.getDefPathParamOfArrowType(t)}}),e.Glyph.ElectronPushingArrow=i.create(e.Glyph.BaseArc,{CLASS_NAME:"Kekule.Glyph.ElectronPushingArrow",initProperties:function(){this.defineProp("electronCount",{dataType:n.INT,getter:function(){var t=this._getValidArrowSide(),r=e.Glyph.ArrowSide;return t===r.BOTH?2:[r.SINGLE,r.REVERSED].indexOf(t)>=0?1:null},setter:function(t){var r=e.Glyph.ArrowSide,i=this._getValidArrowPos(),n=this.getConnectorAt(0);i||(n.getPathParams().endArrowType=e.Glyph.ArrowType.OPEN,i="end");var a=n.getPathParams();t>=2?a[i+"ArrowSide"]=r.BOTH:1===t&&(a[i+"ArrowSide"]=r.SINGLE),n.setPathParams(a)}}),this.defineProp("directReceptor",{dataType:"Kekule.ChemStructureObject",getter:function(){var e=this.getNodeAt(1);return this._getValidElectronTarget(e)},setter:function(e){var t=this.getNodeAt(1);this._setValidElectronTarget(t,e)}}),this.defineProp("directDonor",{dataType:"Kekule.ChemStructureObject",getter:function(){var e=this.getNodeAt(0);return this._getValidElectronTarget(e)},setter:function(e){var t=this.getNodeAt(0);this._setValidElectronTarget(t,e)}}),this.defineProp("receptor",{dataType:"Kekule.ChemStructureObject",getter:function(){var e=this.getNodeAt(1);return this._getValidElectronTargetNodeOrConnector(e)},setter:function(e){var t=this.getNodeAt(1);this._setValidElectronTarget(t,e)}}),this.defineProp("donor",{dataType:"Kekule.ChemStructureObject",getter:function(){var e=this.getNodeAt(0);return this._getValidElectronTargetNodeOrConnector(e)},setter:function(e){var t=this.getNodeAt(0);this._setValidElectronTarget(t,e)}})},doCreateDefaultStructure:function($super,e,t){var r=$super(e,t);return t.electronCount&&this.setElectronCount(t.electronCount),r},_isValidElectronTarget:function(e){return this._isValidChemNodeOrConnectorStickTarget(e)},_getValidElectronTarget:function(t){return e.Glyph.ElectronArrowGlyphUtils.getValidElectronTarget(t)},_setValidElectronTarget:function(t,r){return e.Glyph.ElectronArrowGlyphUtils.setValidElectronTarget(t,r),this},_getValidElectronTargetNodeOrConnector:function(t){return e.Glyph.ElectronArrowGlyphUtils.getValidElectronTargetNodeOrConnector(t)},_getValidArrowPos:function(){var e=this.getConnectorAt(0),t=e&&e.getPathParams();if(t){if(t.endArrowType)return"end";if(t.startArrowType)return"start"}return null},_getValidArrowSide:function(){var t=this.getConnectorAt(0),r=t&&t.getPathParams();if(r){if(r.endArrowType)return r.endArrowSide||e.Glyph.ArrowSide.DEFAULT;if(r.startArrowType)return r.startArrowSide||e.Glyph.ArrowSide.DEFAULT}return null},_applyParamsToConnector:function(t,r){var i=Object.create(r);e.ObjUtils.isUnset(r.autoOffset)&&(i.autoOffset=!0),t.setPathParams(i)}}),e.Glyph.BondFormingElectronPushingArrow=i.create(e.Glyph.BaseTwinArc,{CLASS_NAME:"Kekule.Glyph.BondFormingElectronPushingArrow",initProperties:function(){this.defineProp("electronCount",{dataType:n.INT,getter:function(){for(var e=null,r=0,i=this.getConnectorCount();r<i;++r){var n=this._getConnectorElectronCount(this.getConnectorAt(r));if(t.notUnset(n))if(t.isUnset(e))e=n;else if(e!==n)return null}return e},setter:function(t){if(t!==this.getElectronCount()){var r=this.getConnectorCount()?t/this.getConnectorCount():t;r=Math.round(r),r<=0&&(r=1);for(var i,n=e.Glyph.ArrowSide,a=this.getConnectors(),o=0,s=a.length;o<s;++o){var l=a[o];l.getPathParams().endArrowType=e.Glyph.ArrowType.OPEN,i="end";var d=l.getPathParams();r>=2?d[i+"ArrowSide"]=n.BOTH:1===r&&(d[i+"ArrowSide"]=o%2?n.SINGLE:n.REVERSED),l.setPathParams(d)}}}}),this.defineProp("directDonors",{dataType:n.ARRAY,getter:function(){for(var e=this._getArrowStartingNodes(),t=[],r=0,i=e.length;r<i;++r){var n=a.getValidElectronTarget(e[r]);n&&t.push(n)}return t},setter:function(e){var t=this._getArrowStartingNodes();if(t.length)for(var r=0,i=t.length;r<i;++r){var n=t[r];e[r];a.setValidElectronTarget(n,e)}}}),this.defineProp("donors",{dataType:n.ARRAY,getter:function(){for(var e=this._getArrowStartingNodes(),t=[],r=0,i=e.length;r<i;++r){var n=a.getValidElectronTargetNodeOrConnector(e[r]);n&&t.push(n)}return t},setter:function(e){this.setDirectDonors(e)}})},_getConnectorElectronCount:function(t){var r=t&&t.getPathParams();if(r){var i=e.Glyph.ArrowSide,n=r.endArrowType?r.endArrowSide||e.Glyph.ArrowSide.DEFAULT:null;if(n===i.BOTH)return 2;if([i.SINGLE||i.REVERSED].indexOf(n)>=0)return 1}return null},doCreateDefaultStructure:function($super,e,t){var r=$super(e,t);return this.setElectronCount(t.electronCount||1),r}}),e}},function(e,t,r){"use strict";e.exports=function(e){return e.Glyph.ElectronArrowGlyphUtils={isValidChemNodeOrConnectorStickTarget:function(t){var r=t instanceof e.ChemStructureNode||t instanceof e.ChemStructureConnector;if(!r&&t instanceof e.ChemMarker.BaseMarker){var i=t.getParent&&t.getParent();i&&(r=i instanceof e.ChemStructureNode||i instanceof e.ChemStructureConnector)}return r},isValidElectronTarget:function(t){return e.Glyph.ElectronArrowGlyphUtils.isValidChemNodeOrConnectorStickTarget(t)},getValidElectronTarget:function(t){var r=t&&t.getCoordStickTarget&&t.getCoordStickTarget();return r&&e.Glyph.ElectronArrowGlyphUtils.isValidElectronTarget(r)?r:null},setValidElectronTarget:function(t,r){t.getAllowCoordStickTo&&t.getAllowCoordStickTo(r)&&(r?e.Glyph.ElectronArrowGlyphUtils.isValidElectronTarget(r)&&t.setCoordStickTarget(r):t.setCoordStickTarget(null))},getValidElectronTargetNodeOrConnector:function(t){var r=null,i=e.Glyph.ElectronArrowGlyphUtils.getValidElectronTarget(t);return i&&(r=i instanceof e.ChemMarker.BaseMarker?i.getParent():i),r}},e}},function(e,t,r){"use strict";var i=r(0).Class,n=(r(0).ClassEx,r(0).DataType);e.exports=function(e){e.CoordMode,e.CoordUtils;return e.ContentBlock=i.create(e.ChemObject,{CLASS_NAME:"Kekule.ContentBlock",initialize:function($super,e,t,r){$super(e),t&&this.setCoord2D(t),r&&this.setCoord3D(r)},initProperties:function(){this.defineProp("needRecalcSize",{dataType:n.BOOL})},getAutoIdPrefix:function(){return"b"},getCornerCoord1:function(e,t){return this.getCoordOfMode(e,t)},getCornerCoord2:function(t,r){var i=this.getCornerCoord1(t,r),n=this.getSizeOfMode(t,r);return e.CoordUtils.add(i,n)},getContainerBox:function($super,t,r){var i=this.getAbsCoordOfMode(t,r)||{},n=this.getSizeOfMode(t,r)||{};if(t===e.CoordMode.COORD3D)var a=e.CoordUtils.add(i,this.getSizeOfMode(t,r)||{});else a={x:i.x+n.x,y:i.y-n.y};return e.BoxUtils.createBox(i,a)}}),e.ClassDefineUtils.addStandardCoordSupport(e.ContentBlock),e.ClassDefineUtils.addStandardSizeSupport(e.ContentBlock),e.TextBlock=i.create(e.ContentBlock,{CLASS_NAME:"Kekule.TextBlock",initialize:function($super,e,t,r,i){$super(e,r,i),this.setText(t||"")},initProperties:function(){this.defineProp("text",{dataType:n.STRING})},getAutoIdPrefix:function(){return"t"},doObjectChange:function($super,t){e.ArrayUtils.intersect(["text","renderOptions"],t).length&&this.setNeedRecalcSize(!0)}}),e.ImageBlock=i.create(e.ContentBlock,{CLASS_NAME:"Kekule.ImageBlock",initialize:function($super,e,t,r,i){$super(e,r,i),t&&this.setSrc(t)},initProperties:function(){this.defineProp("src",{dataType:n.STRING,scope:i.PropertyScope.PUBLISHED,setter:function(e){e!==this.getSrc()&&(this.setPropStoreFieldValue("src",e),this._clearCacheImg())}}),this.defineProp("cacheImg",{dataType:n.OBJECT,scope:i.PropertyScope.PUBLIC,serializable:!1,setter:null,getter:function(){var t=this.getPropStoreFieldValue("cacheImg");return!t&&e.$document&&(t=this._createCacheImg(this.getSrc())),t}})},getAutoIdPrefix:function(){return"g"},_createCacheImg:function(t){var r,i=e.$document;return i&&i.body&&i.createElement&&(r=i.createElement("img"),r.src=t),r},_clearCacheImg:function(){var e=this.getPropStoreFieldValue("cacheImg");if(e){e.src="";try{delete e.width,delete e.height}catch(e){}}}}),e}},function(e,t,r){"use strict";var i=r(0).Class,n=r(0).ClassEx,a=r(0).DataType;e.exports=function(e){var t=e.ArrayUtils;return e.ChemMarker={},n.extend(e.ChemObject,{isAttachedMarker:function(){var e=this.getParent();return e&&e.hasMarker(this)},notifyAttachedMarkersChanged:function(){this.notifyPropSet("attachedMarkers",this.getPropStoreFieldValue("attachedMarkers"))},_attachedMarkerAdded:function(e){},_attachedMarkerRemoved:function(e){},getMarkerCount:function(){var e=this.getPropStoreFieldValue("attachedMarkers");return e?e.length:0},getMarkerAt:function(e){var t=this.getPropStoreFieldValue("attachedMarkers");return t?t[e]:null},getMarkerOfType:function(e,t){for(var r=0,i=this.getMarkerCount();r<i;++r){var n=this.getMarkerAt(r);if(t&&n.getClass()===e||n instanceof e)return n}return null},getMarkersOfType:function(e,t){for(var r=[],i=0,n=this.getMarkerCount();i<n;++i){var a=this.getMarkerAt(i);(t&&a.getClass()===e||a instanceof e)&&r.push(a)}return r},fetchMarkerOfType:function(e,t,r,i){var n=this.getMarkerOfType(e,r);if(!n&&t){n=new e,n.beginUpdate();try{i&&n.setPropValues(i),this.appendMarker(n)}finally{n.endUpdate()}}return n},getUnplacedMarkers:function(e){for(var t=[],r=0,i=this.getMarkerCount();r<i;++r){var n=this.getMarkerAt(r);n.getCoordOfMode(e)||t.push(n)}return t},indexOfMarker:function(e){var t=this.getPropStoreFieldValue("attachedMarkers");return t?t.indexOf(e):-1},hasMarker:function(e){return this.indexOfMarker(e)>=0},hasMarkerOfType:function(e,t){return!!this.getMarkerOfType(e,t)},appendMarker:function(e){var t=this.indexOfMarker(e);if(t>=0)return t;var r=this.getAttachedMarkers(!0).push(e);e.beginUpdate();try{e.setOwner&&e.setOwner(this.getOwner()),e.setParent&&e.setParent(this),this._attachedMarkerAdded(e)}finally{e.endUpdate()}return this.notifyAttachedMarkersChanged(),r},insertMarkerBefore:function(e,t){var r=this.indexOfMarker(t);return this.insertMarkerAt(e,r)},insertMarkerAt:function(r,i){var n=(this.indexOfMarker(r),this.getAttachedMarkers(!0));(e.ObjUtils.isUnset(i)||i<0)&&(i=n.length);var a=t.insertUniqueEx(n,r,i);return a.isInserted&&(r.setOwner&&r.setOwner(this.getOwner()),r.setParent&&r.setParent(this),this._attachedMarkerAdded(r)),this.notifyAttachedMarkersChanged(),a.index},setMarkerIndex:function(e,t){var r=this.indexOfMarker(e);if(r>=0){var i=this.getPropStoreFieldValue("attachedMarkers");i.splice(r,1),i.splice(t,0,e)}},removeMarkerAt:function(e){var t=this.getMarkerAt(e);if(t){var r=this.getAttachedMarkers(!0).splice(e,1);return t.setOwner&&t.setOwner(null),t.setParent&&t.setParent(null),this._attachedMarkerRemoved(t),this.notifyAttachedMarkersChanged(),r}},removeMarker:function(e){var t=this.indexOfMarker(e);if(t>=0)return this.removeMarkerAt(t)},replaceMarker:function(e,t){var r=this.indexOfMarker(e);return r<0?this:(this.removeMarkerAt(r),this.insertMarkerAt(t,r),this)},clearMarkers:function(){var e=this.getPropStoreFieldValue("attachedMarkers");if(e&&(e=t.clone(e)),this.setPropStoreFieldValue("attachedMarkers",null),e)for(var r=0,i=e.length;r<i;++r){var n=e[r];n.setOwner&&n.setOwner(null),n.setParent&&n.setParent(null),this._attachedMarkerRemoved(n)}return this.notifyAttachedMarkersChanged(),this},autoSetMarker2DPos:function(t,r,i,n){if(this.hasMarker(t)){var a=e.ChemStructureUtils.getMostEmptyDirection2DAngleOfObj(this,[t],i,!0,!1,n),o={x:r*Math.cos(a),y:r*Math.sin(a)};t.setCoord2D(o)}},_updateAttachedMarkersOwner:function(e){e||(e=this.getOwner());for(var t=0,r=this.getMarkerCount();t<r;++t){var i=this.getMarkerAt(t);i.setOwner&&i.setOwner(e)}},_updateAttachedMarkersParent:function(e){e||(e=this);for(var t=0,r=this.getMarkerCount();t<r;++t){var i=this.getMarkerAt(t);i.setParent&&i.setParent(e)}}}),n.extendMethod(e.ChemObject,"ownerChanged",function(e,t){e(t),this._updateAttachedMarkersOwner(t)}),n.extendMethod(e.ChemObject,"removeChild",function(e,t){var r=e(t);return r||(r=this.removeMarker(t)),r}),n.extendMethod(e.ChemObject,"insertBefore",function(t,r,i){var n=t(r,i);return n<0&&(i&&this.hasMarker(i)||r instanceof e.ChemMarker.BaseMarker)&&(n=this.insertMarkerBefore(r,i)),n}),n.extendMethod(e.ChemObject,"getChildSubgroupNames",function(e){return e().concat("marker")}),n.defineProp(e.ChemObject,"attachedMarkers",{dataType:a.ARRAY,scope:i.PropertyScope.PUBLISHED,getter:function(e){var t=this.getPropStoreFieldValue("attachedMarkers");return!t&&e&&(t=[],this.setPropStoreFieldValue("attachedMarkers",t)),t},setter:function(e){this.clearMarkers(),this.setPropStoreFieldValue("attachedMarkers",e),this._updateAttachedMarkersOwner(),this._updateAttachedMarkersParent()}}),e}},function(e,t,r){"use strict";var i=r(0).Class,n=r(0).ClassEx,a=r(0).DataType;e.exports=function(e){return e.ChemMarker.BaseMarker=i.create(e.ChemObject,{CLASS_NAME:"Kekule.ChemMarker.BaseMarker",initialize:function($super,e,t,r){$super(e,t,r)},getAutoIdPrefix:function(){return"marker"},getAcceptCoordStickFrom:function(t){return!(this.isSiblingWith(t)||t instanceof e.ChemStructureNode||t instanceof e.BaseStructureConnector)}}),e.ClassDefineUtils.addStandardCoordSupport(e.ChemMarker.BaseMarker),e.ChemMarker.UnbondedElectronSet=i.create(e.ChemMarker.BaseMarker,{CLASS_NAME:"Kekule.ChemMarker.UnbondedElectronSet",initProperties:function(){this.defineProp("electronCount",{dataType:a.VARIANT})},initPropValues:function($super){$super(),this.setElectronCount(2)},getAutoIdPrefix:function(){return"electron"}}),e.ChemMarker.ChemPropertyMarker=i.create(e.ChemMarker.BaseMarker,{CLASS_NAME:"Kekule.ChemMarker.ChemPropertyMarker",initProperties:function(){this.defineProp("value",{dataType:a.VARIANT,serializable:!1,getter:function(){var e,t=this.getParent(),r=this.getPropertyName();return t&&r?(e=t.getPropValue(r),this.setPropStoreFieldValue("value",e)):e=this.getPropStoreFieldValue("value"),e},setter:function(e){this.setPropStoreFieldValue("value",e),this.setParentPropValue(e)}})},initPropValues:function($super){$super()},setParentPropValue:function(e){var t=this.getParent();if(t){var r=this.getPropertyName();r&&t&&t.setPropValue(r,e)}return this},resetParentPropValue:function(){return this.setParentPropValue(void 0)},getPropertyName:function(){return null},beforAddingByEditor:function($super,t,r){if(t){var i=this.getPropStoreFieldValue("value");e.ObjUtils.notUnset(i)&&this.setParentPropValue(i)}$super()},beforeRemovingByEditor:function(e){this.setPropStoreFieldValue("value",this.getValue()),this.resetParentPropValue()}}),e.ChemMarker.Charge=i.create(e.ChemMarker.ChemPropertyMarker,{CLASS_NAME:"Kekule.ChemMarker.Charge",getPropertyName:function(){return"charge"},getAutoIdPrefix:function(){return"charge"}}),e.ChemMarker.Radical=i.create(e.ChemMarker.ChemPropertyMarker,{CLASS_NAME:"Kekule.ChemMarker.Radical",getPropertyName:function(){return"radical"},getAutoIdPrefix:function(){return"radical"}}),n.extend(e.ChemStructureNode,{fetchChargeMarker:function(t,r){return this.fetchMarkerOfType(e.ChemMarker.Charge,t,!1,r)},fetchRadicalMarker:function(t,r){return this.fetchMarkerOfType(e.ChemMarker.Radical,t,!1,r)}}),n.defineProp(e.AbstractAtom,"lonePairCount",{dataType:a.INT,scope:i.PropertyScope.PUBLISHED,serializable:!1,setter:null,getter:function(){for(var t=0,r=this.getMarkersOfType(e.ChemMarker.UnbondedElectronSet),i=0,n=r.length;i<n;++i){2===r[i].getElectronCount()&&++t}return t}}),n.defineProp(e.AbstractAtom,"singleElectronCount",{dataType:a.INT,scope:i.PropertyScope.PUBLISHED,serializable:!1,setter:null,getter:function(){for(var t=0,r=this.getMarkersOfType(e.ChemMarker.UnbondedElectronSet),i=0,n=r.length;i<n;++i){1===r[i].getElectronCount()&&++t}return t}}),n.extendMethod(e.AbstractAtom,"doCompare",function(t,r,i){var n=t(r,i);if(!n&&i.method===e.ComparisonMethod.CHEM_STRUCTURE&&(this._getComparisonOptionFlagValue(i,"lonePair")||this._getComparisonOptionFlagValue(i,"unbondedElectron"))){var a=function(t){var r=[];if(t.getMarkersOfType)for(var i=t.getMarkersOfType(e.ChemMarker.UnbondedElectronSet),n=0,a=i.length;n<a;++n){var o=i[n];r.push(o.getElectronCount())}return r.sort(),r},o=a(this),s=a(r);return e.ArrayUtils.compare(o,s)}return n}),e}},function(e,t,r){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r(0).Class,r(0).ClassEx,r(0).ObjectEx,r(0).DataType;e.exports=function(e){void 0===e&&(e={}),"undefined"==typeof navigator?(e.Browser={},e.BrowserFeature={}):(e.Browser={},e.$jsRoot.window&&(e.Browser={IE:!(!window.attachEvent||window.opera),Opera:!!window.opera,WebKit:navigator.userAgent.indexOf("AppleWebKit/")>-1,Gecko:navigator.userAgent.indexOf("Gecko")>-1&&navigator.userAgent.indexOf("like Gecko")<0&&-1==navigator.userAgent.indexOf("KHTML"),MobileSafari:!!navigator.userAgent.match(/Apple.*Mobile.*Safari/),language:navigator.language||navigator.browserLanguage}),e.Browser.IEVersion=e.Browser.IE&&function(){var e=navigator.userAgent.toLowerCase();return-1!==e.indexOf("msie")&&parseInt(e.split("msie")[1])}(),e.BrowserFeature={},e.$jsRoot.window&&(e.BrowserFeature={typedArray:"undefined"!=typeof ArrayBuffer,svg:!!window.SVGSVGElement,canvas:!!window.CanvasRenderingContext2D,webgl:function(){return!!function(){try{var e=document.createElement("canvas");return!!window.WebGLRenderingContext&&(e.getContext("webgl")||e.getContext("experimental-webgl"))}catch(e){return!1}}()}(),htmlTemplate:!!window.HTMLTemplateElement,htmlSlot:!!window.HTMLSlotElement,downloadHref:function(e){return"download"in e.createElement("a")}(document),blob:!!window.Blob,workers:!!window.Worker,fileapi:!!(window.File&&window.FileReader&&window.FileList&&window.Blob),sessionStorage:function(){try{return!!window.sessionStorage}catch(e){return!1}}(),localStorage:function(){try{return!!window.localStorage}catch(e){return!1}}(),cssTransition:function(e){return"transition"in e||"WebkitTransition"in e||"MozTransition"in e||"msTransition"in e||"OTransition"in e}(document.createElement("div").style),cssTranform:function(e){return"transform"in e||"WebkitTransform"in e||"MozTransform"in e||"msTransform"in e||"OTransform"in e}(document.createElement("div").style),cssFlex:function(e){return"flex"in e||"WebkitFlex"in e||"MozFlex"in e||"msFlex"in e||"OFlex"in e}(document.createElement("div").style),cssGrid:function(e){return"grid"in e||"WebkitGrid"in e||"MozGrid"in e||"msGrid"in e||"OGrid"in e}(document.createElement("div").style),html5Form:{placeholder:function(e){return"placeholder"in e}(document.createElement("input")),supportType:function(e){var t=document.createElement("input");t.setAttribute("type",e);var r=t.type===e,i=["text","url","search"];if(r&&i.indexOf(e.toLowerCase())<0){t.value=":)",r=":)"!==t.value}return r}},mutationObserver:window.MutationObserver||window.MozMutationObserver||window.WebkitMutationObserver,resizeObserver:!!window.ResizeObserver,touchEvent:!!window.touchEvent,pointerEvent:!!window.PointerEvent,draggable:function(){var e=document.createElement("div");return"draggable"in e||"ondragstart"in e&&"ondrop"in e}()})),e.$jsRoot.requestAnimationFrame&&function(){for(var e=0,t=["ms","moz","webkit","o"],r=0;r<t.length&&!window.requestAnimationFrame;++r)window.requestAnimationFrame=window[t[r]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[r]+"CancelAnimationFrame"]||window[t[r]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t,r){var i=(new Date).getTime(),n=Math.max(0,16-(i-e)),a=window.setTimeout(function(){t(i+n)},n);return e=i+n,a}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}(),e.X={};var t=e.X,r=function(e){return null===e||void 0===e},n=function(e){return!r(e)},a=function(e){var t=win.getComputedStyle?win.getComputedStyle(e,null).position:e.currentStyle?e.currentStyle.position:null;return!!t&&(!!t&&("relative"===(t=t.toString().toLowerCase())||"absolute"===t))};if(e.$jsRoot.window&&(t.MutationObserver=window.MutationObserver||window.MozMutationObserver||window.WebkitMutationObserver),t.Event={MOUSE_BTN_LEFT:0,MOUSE_BTN_RIGHT:2,MOUSE_BTN_MID:1,MOUSE_BTN_LR:3},t.Event.PointerType={MOUSE:"mouse",TOUCH:"touch",PEN:"pen"},t.Event.MouseButton={LEFT:0,RIGHT:2,MID:1,LR:3},t.Event.KeyCode={BACKSPACE:8,TAB:9,CLEAR:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPSLOCK:20,ESC:27,SPACE:32,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRTSC:44,INS:45,DEL:46,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SCROLLLOCK:145},t.Event.isSupported=function(){var t={};return function(r){if(0===r.indexOf("touch"))return e.BrowserFeature.touchEvent;if(0===r.indexOf("pointer"))return e.BrowserFeature.pointerEvent;var i={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img",unload:"win",resize:"win"},n=r.replace(/^on/,"");if(t[n])return t[n];var a="win"==i[n]?win:document.createElement(i[n]||"div");r="on"+n;var o=r in a;return o||(a.setAttribute(r,"return;"),o="function"==typeof a[r]),a=null,t[n]=o,o}}(),t.Event.Methods={getType:function(e){return e.__$type__||e.type},setType:function(e,t){e.__$type__=t;try{e.type=t}catch(e){}},getPointerType:function(e){return e.pointerType},getTarget:function(e){var t=e.__$target__||e.target||e.srcElement;return 3==t.nodeType&&(t=t.parentNode),t},setTarget:function(e,t){e.__$target__=t;try{e.target=t}catch(e){}},getCurrentTarget:function(e){return e.currentTarget},getEventPhase:function(e){return e.eventPhase},getAltKey:function(e){return e.altKey},getCtrlKey:function(e){return e.ctrlKey},getShiftKey:function(e){return e.shiftKey},getCharCode:function(e){return n(e.charCode)?e.charCode:e.keyCode},getKeyCode:function(e){return e.keyCode},getClientX:function(e){var t;if(e.touches){var r=e.touches[0];t=r&&r.clientX}return void 0===t&&(t=e.clientX),t},getClientY:function(e){var t;if(e.touches){var r=e.touches[0];t=r&&r.clientY}return void 0===t&&(t=e.clientY),t},getScreenX:function(e){var t;if(e.touches){var r=e.touches[0];t=r&&r.screenX}return void 0===t&&(t=e.screenX),t},getScreenY:function(e){var t;if(e.touches){var r=e.touches[0];t=r&&r.screenY}return void 0===t&&(t=e.screenY),t},getPageX:function(e){var r;if(e.touches){var i=e.touches[0];i&&n(i.pageX)&&(r=i.pageX)}if(void 0===r&&n(e.pageX)&&(r=e.pageX),void 0===r){var a=t.Event.getTarget(e).ownerDocument||t.Event.getTarget(e),o=a?a.body:null;r=t.Event.getClientX(e)+(a&&a.scrollLeft||o&&o.scrollLeft||0)-(a&&a.clientLeft||o&&o.clientLeft||0)}return r},getPageY:function(e){var r;if(e.touches){var i=e.touches[0];if(i&&n(i.pageY))return i.pageY}else if(void 0===r&&n(e.pageY))return e.pageY;if(void 0===r){var a=t.Event.getTarget(e).ownerDocument||t.Event.getTarget(e),o=a?a.body:null;r=t.Event.getClientY(e)+(a&&a.scrollTop||o&&o.scrollTop||0)-(a&&a.clientTop||o&&o.clientTop||0)}return r},getOffsetX:function(r){if(n(r.offsetX))return r.offsetX;var i=t.Event.getTarget(r);if((i.defaultView||i.parentWindow)&&i.body&&(i=i.body),n(r.layerX)&&a(i)&&!r.touches)return r.layerX;var o=t.Event.getClientX(r);return Math.round(o-e.HtmlElementUtils.getElemPagePos(i,!0).x)},getOffsetY:function(r){if(n(r.offsetY))return r.offsetY;var i=t.Event.getTarget(r);if((i.defaultView||i.parentWindow)&&i.body&&(i=i.body),n(r.layerY)&&a(i)&&!r.touches)return r.layerY;var o=t.Event.getClientY(r);return Math.round(o-e.HtmlElementUtils.getElemPagePos(i,!0).y)},getOffsetCoord:function(r,i){var n,a=t.Event.getTarget(r);if(i&&e.ObjUtils.isUnset(r.offsetX)&&(n=e.StyleUtils.getTotalTransformMatrix(a)),n){var o=t.Event.getClientX(r),s=t.Event.getClientY(r),l={x:o-e.HtmlElementUtils.getElemBoundingClientRect(a).x,y:s-e.HtmlElementUtils.getElemBoundingClientRect(a).y},d=e.StyleUtils.calcInvertTransformMatrix(n);if(d){var u=e.MatrixUtils.create(3,1);u[0][0]=l.x,u[1][0]=l.y,u[2][0]=1;var c=e.MatrixUtils.multiply(d,u);return l.x=c[0][0],l.y=c[1][0],l}}return{x:t.Event.getOffsetX(r),y:t.Event.getOffsetY(r)}},getWindowX:function(e){var r=t.Event.getPageX(e),i=e.target.ownerDocument||e.target,n=i&&(i.defaultView||i.parentWindow);return r-(n&&n.scrollX||0)},getWindowY:function(e){var r=t.Event.getPageY(e),i=e.target.ownerDocument||e.target,n=i&&(i.defaultView||i.parentWindow);return r-(n&&n.scrollY||0)},getRelXToCurrTarget:function(r){var i=t.Event.getCurrentTarget(r);(i.defaultView||i.parentWindow)&&i.body&&(i=i.body);var n=t.Event.getClientX(r);return Math.round(n-e.HtmlElementUtils.getElemPagePos(i,!0).left)},getRelYToCurrTarget:function(r){var i=t.Event.getCurrentTarget(r);(i.defaultView||i.parentWindow)&&i.body&&(i=i.body);var n=t.Event.getClientY(r);return Math.round(n-e.HtmlElementUtils.getElemPagePos(i,!0).top)},getTouches:function(e){return e.touches}},t.Event._MouseEventEx={isMouseEnterLeaveEvent:function(e){return"mouseenter"===e||"mouseleave"===e},addMouseEnterLeaveListener:function(r,i,n,a){if("mouseenter"===i&&t.Event.isSupported("mouseenter")||"mouseleave"===i&&t.Event.isSupported("mouseleave"))return r.addEventListener(i,n,a);var o=function(t){var r=t.getTarget?t.getTarget():t.target,a=t.getCurrentTarget?t.getCurrentTarget():t.currentTarget;if(r===a||e.DomUtils.isDescendantOf(r,a)){var o=t.getRelatedTarget?t.getRelatedTarget():t.relatedTarget;if(!o||!e.DomUtils.isDescendantOf(o,a)){var s=new MouseEvent(i,{view:win,bubbles:!1,cancelable:!0,target:a,currentTarget:a,relatedTarget:o});n.call(a,s)}}};n.__$mouseExListenerWrapper__=o;var s="mouseenter"===i?"mouseover":"mouseout";return r.addEventListener(s,o,a)},removeMouseEnterLeaveListener:function(e,r,i){if("mouseenter"===r&&t.Event.isSupported("mouseenter")||"mouseleave"===r&&t.Event.isSupported("mouseleave"))return e.removeEventListener(r,i);var n="mouseenter"===r?"mouseover":"mouseout";return e.removeEventListener(n,i.__$mouseExListenerWrapper__||i)}},t.Event._W3C={addListener:function(e,r,i,n){return t.Event._MouseEventEx.isMouseEnterLeaveEvent(r)?t.Event._MouseEventEx.addMouseEnterLeaveListener(e,r,i,n):e.addEventListener(r,i,n)},removeListener:function(e,r,i,n){return t.Event._MouseEventEx.isMouseEnterLeaveEvent(r)&&i.__$listenerWrapper__?t.Event._MouseEventEx.removeMouseEnterLeaveListener(e,r,i.__$listenerWrapper__):e.removeEventListener(r,i,n)},stopPropagation:function(e){e.stopPropagation()},preventDefault:function(e){e.preventDefault()}},t.Event._W3CMethods={getRelatedTarget:function(e){return e.relatedTarget},getButton:function(e){return e.button}},t.Event._Gecko={addListener:function(e,r,i,n){if(t.Event._MouseEventEx.isMouseEnterLeaveEvent(r))return t.Event._MouseEventEx.addMouseEnterLeaveListener(e,r,i,n);if("mousewheel"===r){var a=function(t){t.wheelDeltaY=t.wheelDelta=40*-t.detail,t.__$type__="mousewheel",i.call(e,t)};i.__$mousewheelListenerWrapper__=a,e.addEventListener("DOMMouseScroll",a,n)}else e.addEventListener(r,i,n)},removeListener:function(e,t,r,i){"mousewheel"===t&&r.__$mousewheelListenerWrapper__?e.removeEventListener("DOMMouseScroll",r.__$mousewheelListenerWrapper__,i):e.removeEventListener(t,r,i)}},t.Event._IE={_handlers:{},WIN_UNLOAD_FLAG_FIELD:"__$win_unload_linked__",addListener:function(e,r,i,n){if(!(t.Event.findHandlerIndex(e,r,i)>=0)){var a=function(t){t||(t=s.event),t.currentTarget=e,t.eventPhase=t.srcElement===e?2:3,l||Object.extend(t,d),i.call(e,t)};e.attachEvent(t.Event.getEventName(r),a),t.Event.registerHandler(e,r,i,a);var o=e.ownerDocument||e,s=o.parentWindow||o;t.Event._linkUnloadEvent(s)}},removeListener:function(e,r,i,n){var a=t.Event.findHandlerIndex(e,r,i);if(a>=0){var o=t.Event._handlers[r][a].wrapper;e.detachEvent(t.Event.getEventName(r),o),t.Event._handlers[r].splice(a,1)}},stopPropagation:function(e){e.cancelBubble=!0},preventDefault:function(e){e.returnValue=!1},removeAllListeners:function(e){var r=t.Event._handlers;if(r)for(var i in r)if(r.hasOwnProperty(i)){var n=r[i];if(n&&n.length)for(var a=t.Event.getEventName(i),o=n.length-1;o>=0;--o){var s=n[o];e&&s.element.ownerDocument!==e||(s.element.detachEvent(a,s.wrapper),n.splice(o,1))}}},getEventName:function(e){return"on"+e},registerHandler:function(e,r,i,n){var a=t.Event._handlers;a[r]||(a[r]=[]),a[r].push({element:e,handler:i,wrapper:n})},unregisterHandler:function(e,r,i){if(i[r]){var n=i[r],a=t.Event.findHandlerIndex(e,r,i);a>=0&&n.splice(a,1)}},findHandlerIndex:function(e,r,i){var n=t.Event._handlers[r];if(!n)return-1;for(var a=0,o=n.length;a<o;++a){var s=n[a];if(s.element===e&&s.handler===i)return a}return-1},_linkUnloadEvent:function(e){var r=t.Event.WIN_UNLOAD_FLAG_FIELD;e[r]||(e.attachEvent("onunload",t.Event.reactWinUnload),e[r]=!0)},reactWinUnload:function(){var e=this.ownerDocument;t.Event.removeAllListeners(e)}},t.Event._IEMethods={getRelatedTarget:function(e){return["focusin","mouseenter","mouseover","pointerenter","pointerover","dragenter"].indexOf(e.type)>=0?e.fromElement||e.toElement:e.toElement||e.fromElement},getButton:function(e){switch(e.button){case 1:return 0;case 2:return 2;case 4:return 1;case 3:return 3;default:return e.button}},stopPropagation:function(e){e.cancelBubble=!0},preventDefault:function(e){e.returnValue=!1}},e.$document)if(e.$document.addEventListener)t.Event=Object.extend(t.Event,t.Event._W3C),t.Event.Methods=Object.extend(t.Event.Methods,t.Event._W3CMethods),e.Browser.Gecko&&(t.Event=Object.extend(t.Event,t.Event._Gecko));else if(e.$document.attachEvent&&(t.Event=Object.extend(t.Event,t.Event._IE),t.Event.Methods=Object.extend(t.Event.Methods,t.Event._IEMethods),win.Element)){var o=win.Element.prototype;o.addEventListener=t.Event.addListener.methodize(),o.removeEventListener=t.Event.removeListener.methodize()}Object.extend(t.Event,t.Event.Methods);var s=null;e.$jsRoot.window&&e.$jsRoot.window.Event&&(s=window.Event.prototype),s||e.$document&&e.$document.createEvent&&(s=e.$document.createEvent("HTMLEvents").__proto__);var l=!!s,d={},u=t.Event.Methods;for(var c in u)u.hasOwnProperty(c)&&"function"==typeof u[c]&&(d[c]=u[c].methodize());s&&Object.extend(s,d),function(){if("undefined"!=typeof document){var t=document.createElement("div");!("draggable"in t)&&"ondragstart"in t&&"ondrop"in t&&e.X.Event.addListener(document,"selectstart",function(e){for(var t=e.target;t;t=t.parentNode)if(t.attributes&&t.attributes.draggable)return e.preventDefault(),e.stopImmediatePropagation?e.stopImmediatePropagation():e.stopPropagation(),t.dragDrop(),!1})}}(),t.Ajax={XMLHttpFactories:[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],_availableFactoryIndex:-1,createXMLHTTPObject:function(){var e=!1,r=t.Ajax.XMLHttpFactories,i=t.Ajax._availableFactoryIndex;if(i>=0)e=r[i]();else for(var n=0;n<r.length;n++){try{e=r[n](),t.Ajax._availableFactoryIndex=n}catch(e){continue}break}return e},preparePostData:function(t){var r=t;return"object"===(void 0===t?"undefined":i(t))&&(r=e.UrlUtils.generateSearchString(t)),r},request:function(e){return t.Ajax.sendRequest(e.url,e.callback,e.postData,e.xhrProps)},sendRequest:function(e,r,n,a,o){var s=!1,l=!0,d=t.Ajax.createXMLHTTPObject();if(d){var u=n?"POST":"GET";d.open(u,e,!0),d.setRequestHeader("User-Agent","XMLHTTP/1.0"),n&&d.setRequestHeader("Content-type","application/x-www-form-urlencoded");var c,h;if(a&&("object"===(void 0===a?"undefined":i(a))?(h=a,c=h.responseType,o=h.overwriteMimeType):"string"==typeof a&&(c=a)),c){try{d.responseType=c}catch(e){}"arraybuffer"!==c&&"blob"!==c||(s=!0),d.responseType!==c&&(l=!1)}if(s&&!l&&d.overwriteMimeType&&d.overrideMimeType("text/plain; charset=x-user-defined"),o&&d.overwriteMimeType&&d.overwriteMimeType(o),h)for(var m in h)if(m in d)try{d[m]=h[m]}catch(e){}if(d.onreadystatechange=function(){if(4==d.readyState){if(200!=d.status&&304!=d.status)throw r(null,d,!1),"HTTP error "+d.status;r(d.response||d.responseText,d,!0)}},4!=d.readyState)return d.send(t.Ajax.preparePostData(n)),d}},getResponseMimeType:function(e){return e.getResponseHeader("content-type")||""}},e.Ajax=e.X.Ajax,e.X.DomReady={isReady:!1,suspendFlag:0,funcs:[],domReady:function(t,r){if(r||(r=e.$document),h.initReady(r),!h.isReady){var i=r&&r.readyState;("complete"===i||"loaded"===i||"interactive"===i&&!e.Browser.IE)&&(h.isReady=!0)}h.isReady?t():h.funcs.push(t)},fireReady:function(){h.isReady||(h.isReady=!0,h._execFuncs())},_execFuncs:function(){var e=h.funcs;if(e&&e.length)for(;e.length&&!h.isSuspending();){var t=e.shift();t&&t()}},suspend:function(){++h.suspendFlag},resume:function(){h.suspendFlag>0&&--h.suspendFlag,h.isSuspending()||h._execFuncs()},isSuspending:function(){return h.suspendFlag>0},initReady:function t(r){r||(r=e.$document),r&&r.addEventListener?r.addEventListener("DOMContentLoaded",function(){r.removeEventListener("DOMContentLoaded",t,!1),h.fireReady()},!1):r&&r.getElementById&&(r.write('<script id="ie-domReady" defer="defer" src="//:"><\/script>'),r.getElementById("ie-domReady").onreadystatechange=function(){"complete"===this.readyState&&(h.fireReady(),this.onreadystatechange=null,this.parentNode.removeChild(this))})}};var h=e.X.DomReady;return e.X.domReady=h.domReady,e}},function(e,t,r){"use strict";e.exports=function(e){var t=!0;"undefined"==typeof window&&(t=!1);var t=!0;"undefined"==typeof window&&(t=!1),e.NativeServices={MODE_OPEN:"open",MODE_SAVE:"save",FILTER_ALL_SUPPORT:"all",FILTER_ANY:"any",showFilePickerDialog:function(t,r,i){if(e.NativeServices.doShowFilePickerDialog)return e.NativeServices.doShowFilePickerDialog(t,r,i)},canLoadFileData:function(e){return!!r.doLoadFileData||!!r.doShowFilePickerDialog},loadFileData:function(t,i,n){if(e.NativeServices.doLoadFileData)return e.NativeServices.doLoadFileData(t,i,n);var a=Object.create(n||{});a.multiple=!1,a.mode=r.MODE_OPEN;var o=function(t,r,n){if(t&&r)if(e.BrowserFeature.fileapi){var o=r.name,s=a.binaryDetector&&a.binaryDetector(o,r),l=new FileReader;l.onload=function(e){var t=l.result;i&&i(!0,t,o)},l.onerror=function(){i&&i(!1),e.error(e.$L("ErrorMsg.ERROR_LOADING_FILE"+o))},s?l.readAsArrayBuffer(r):l.readAsText(r)}else e.error(e.$L("ErrorMsg.FILE_API_NOT_SUPPORTED"));else i(t,null,null)};r.showFilePickerDialog(t,o,a)},canSaveFileData:function(e){return!!r.doSaveFileData},saveFileData:function(t,r,i,n){if(e.NativeServices.doSaveFileData)return e.NativeServices.doSaveFileData(t,r,i,n)}};var r=e.NativeServices;return e.HtmlNativeServiceImpl={doShowFilePickerDialog:function(t,r,i){e.HtmlNativeServiceImpl._createFileInputElem(t,r,i||{}).click()},_createFileInputElem:function(t,r,i){var n=t.createElement("input");n.setAttribute("type","file");var a=i||{};if(a.multiple&&n.setAttribute("multiple","multiple"),a.filters){for(var o=[],s=0,l=a.filters.length;s<l;++s){var d=a.filters[s];if(d!==e.NativeServices.FILTER_ALL_SUPPORT&&d!==e.NativeServices.FILTER_ANY){var u=d.filter;u&&o.push(u)}}var c=o.join(",");n.setAttribute("accept",c)}var h=n.style;h.position="absolute",h.left="-100000px",h.opacity=0,t.body.appendChild(n);var m=function t(i){var n=i.getTarget(),a=n.files,o=a&&a[0];r&&r(!0,o,a),e.X.Event.removeListener(n,"change",t),n.ownerDocument.body.focus(),n.parentNode};return e.X.Event.addListener(n,"change",m),n},doSaveFileData:function(t,r,i,n){var a=n.initialFileName||null,o=e.HtmlNativeServiceImpl._createDataElem(t,r,a);o.click(),o.parentNode.removeChild(o),i&&i(null,null)},_createDataElem:function(e,t,r){var i=e.createElement("a"),n="data:application/octet-stream,"+encodeURIComponent(t);i.setAttribute("href",n),i.setAttribute("download",r||"");i.style;return i.position="absolute",i.left="-100000px",i.opacity=0,e.body.appendChild(i),i},doSaveFileDataIe:function(r,i,n,a){var o=a.initialFileName||null;if(e.BrowserFeature.blob&&t&&window.navigator.msSaveOrOpenBlob){var s=new Blob([i]);window.navigator.msSaveBlob(s,o)}else{var l=e.HtmlNativeServiceImpl._createAndExecDataIframe(r,i,o);l.parentNode.removeChild(l)}n&&n(null,null)},_createAndExecDataIframe:function(t,r,i){var n=t.createElement("iframe");t.body.appendChild(n);var a=n.contentWindow||n.contentDocument;a.document.open("text/html","replace");var o=r.toString();return a.document.write(o),a.document.close(),a.focus(),a.document.execCommand("SaveAs",!0,e.UrlUtils.extractFileCoreName(i)),n}},e.BrowserFeature.fileapi&&(r.doShowFilePickerDialog=e.HtmlNativeServiceImpl.doShowFilePickerDialog),e.Browser.IE||t&&window.navigator.msSaveOrOpenBlob?r.doSaveFileData=e.HtmlNativeServiceImpl.doSaveFileDataIe:e.BrowserFeature.downloadHref&&(r.doSaveFileData=e.HtmlNativeServiceImpl.doSaveFileData),e}},function(e,t,r){"use strict";var i=r(0).Class,n=r(0).ObjectEx,a=r(0).DataType;e.exports=function(e){return e.PredefinedResLoader=i.create(n,{CLASS_NAME:"Kekule.PredefinedResLoader",initialize:function($super,t,r,i){$super(),r?(this.setPropStoreFieldValue("resUri",r),this.setDoc(t),i&&this.setResType(i)):e.Error(e.$L("ErrorMsg.EMPTY_RESURI"))},initProperties:function(){this.defineProp("doc",{dataType:a.OBJECT,serializable:!1}),this.defineProp("resUri",{dataType:a.STRING,serializable:!1,setter:null}),this.defineProp("resType",{dataType:a.STRING,serializable:!1})},getLinkedResUrl:function(e){var t=e.tagName.toLowerCase();return"link"===t?e.getAttribute("href"):"script"===t?e.getAttribute("src"):null},getElemResType:function(e){return e.getAttribute("type")},load:function(t){var r,i,n=this.getResUri(),a=e.PredefinedResReferer.ID_MARK;if(n.startsWith(a)){var o=n.substr(a.length).trim();if(r=this.getDoc().getElementById(o)){i=this.getLinkedResUrl(r);var s=this.getElemResType(r);s&&this.setResType(s)}}else i=n;var l={resType:this.getResType(),resUri:n};if(i)e.X.Ajax.sendRequest(i,function(r,n,a){if(a){if(l=Object.extend(l,{data:r,text:n.responseText,success:!0}),!l.resType&&(l.resType=e.X.Ajax.getResponseMimeType(n),l.resType===e.IO.MimeType.OCTSTREAM)){var o=e.UrlUtils.extractFileExt(i);if(o){var s=e.IO.DataFormatsManager.findFormat(null,o);s&&(l.resType=s.mimeType)}}t(l,a)}else t(l,!1)},null,null,this.getResType()||null);else if(r){var d=r.innerHTML,u=2,c=d.indexOf("\r\n");c<0&&(c=d.indexOf("\n"),u=1),0===c&&(d=d.substring(u)),l=Object.extend(l,{data:d,text:d,resType:l.resType||"text/plain",success:!0}),t(l,!0)}else t(l,!1)}}),e.PredefinedResReferer={REFER_PATTERN:/^\s*url\((\S+)\)\s*$/,ID_MARK:"#",isResValue:function(t){return e.PredefinedResReferer.isResReferrer(t)},isResReferrer:function(t){return e.PredefinedResReferer.REFER_PATTERN.test(t)},extractReferedValue:function(t){var r=e.PredefinedResReferer.REFER_PATTERN.exec(t);if(r){var i=r[1];if(i)return i=e.StrUtils.unquote(i)}return null},loadResource:function(t,r,i,n){n||(n=document);var a,o=e.PredefinedResReferer,s=o.extractReferedValue(t);(a=new e.PredefinedResLoader(n,s))&&(i&&a.setResType(i),a.load(r))}},e._registerAfterLoadSysProc(function(){e.IO&&(e.IO.loadResourceData=function(t,r,i,n){e.PredefinedResReferer.loadResource(t,function(t,i){var n;i&&(n=e.IO.loadTypedData(t.data,t.resType,t.resUri)),r&&r(n,i)},i,n)})}),e}},function(e,t,r){"use strict";r(0).Class,r(0).ClassEx,r(0).ObjectEx,r(0).DataType;e.exports=function(e){return e.DomUtils={namespaceMatched:function(e,t,r){return void 0===r&&(r=!0),e.namespaceURI==t||r&&!e.namespaceURI},isElement:function(e){return e&&e.tagName&&e.nodeType},getElementText:function(e){for(var t="",r=0,i=e.childNodes.length;r<i;++r)3==e.childNodes[r].nodeType&&(t+=e.childNodes[r].nodeValue);return t},setElementText:function(e,t){for(var r=0,i=e.childNodes.length;r<i;++r)if(3==e.childNodes[r].nodeType)return e.childNodes[r].nodeValue=t,t;var n=e.ownerDocument.createTextNode(t);return e.appendChild(n),t},getLocalName:function(e){return e.localName||e.baseName||e.nodeName},getChildNodesOfTypes:function(t,r){for(var i=[],n=e.ArrayUtils.toArray(r),a=0,o=t.childNodes.length;a<o;++a){var s=t.childNodes[a];(!r||n.indexOf(s.nodeType)>=0)&&i.push(s)}return i},getFirstChildElem:function(t,r,i,n){for(var a=0,o=t.childNodes.length;a<o;++a){var s=t.childNodes[a];if(s.nodeType===Node.ELEMENT_NODE&&(r&&r.toLowerCase()===s.tagName.toLowerCase()||i&&i.toLowerCase()===e.DomUtils.getLocalName(s).toLowerCase()||!r&&!i)&&(!n||e.DomUtils.namespaceMatched(s,n)))return s}},getDirectChildElems:function(t,r,i,n){for(var a=[],o=0,s=t.childNodes.length;o<s;++o){var l=t.childNodes[o];l.nodeType===Node.ELEMENT_NODE&&(r&&r.toLowerCase()===l.tagName.toLowerCase()||i&&i.toLowerCase()===e.DomUtils.getLocalName(l).toLowerCase()||!r&&!i)&&(n&&!e.DomUtils.namespaceMatched(l,n)||a.push(l))}return a},getDirectChildElemsOfAttribValues:function(t,r,i,n,a){for(var o=e.DomUtils.getDirectChildElems(t,i,n,a),s=[],l=0,d=o.length;l<d;++l){for(var u=!0,c=0,h=r.length;c<h;++c){var m=e.ObjUtils.getOwnedFieldNames(r[c])[0];if(o[l].getAttribute(m)!=r[c][m]){u=!1;break}}u&&s.push(o[l])}return s},getParentNode:function(e,t){var r=t||{},i=e.parentNode;return i||(r.acrossShadowRoot&&e.host?e.host:null)},isDescendantOf:function(t,r,i){var n=i||{};try{if(t&&r){if(t.documentElement)return!1;if(t.ownerDocument===r)return!0;for(var a=e.DomUtils.getParentNode,o=a(t,n);o;){if(o===r)return!0;o=a(o,n)}}return!1}catch(e){return!1}},isOrIsDescendantOf:function(t,r,i){return t===r||e.DomUtils.isDescendantOf(t,r,i)},getNearestAncestorByTagName:function(e,t,r){var i=t.toLowerCase();if(r&&e.tagName&&e.tagName.toLowerCase()===i)return e;for(var n=e.parentNode;n&&n.tagName;){if(n.tagName.toLowerCase()===i)return n;n=n.parentNode}return null},getSameNSAttributeValue:function(e,t,r){return e.getAttribute(t)},setSameNSAttributeValue:function(e,t,r,i){return e.setAttribute(t,r)},fetchAttributeValuesToArray:function(t,r,i){for(var n=[],a=0,o=t.attributes.length;a<o;++a){var s=t.attributes[a];if(!r||e.DomUtils.namespaceMatched(s,r,!0)){var l;if(i)try{l=e.DomUtils.getLocalName(s)}catch(e){l=s.name}else l=s.name;n.push({name:l,value:s.value})}}return n},fetchAttributeValuesToJson:function(t,r,i){for(var n={},a=0,o=t.attributes.length;a<o;++a){var s=t.attributes[a];if(!r||e.DomUtils.namespaceMatched(s,r,!0)){var l;if(i)try{l=e.DomUtils.getLocalName(s)}catch(e){l=s.name}else l=s.name;n[l]=s.value}}return n},hasAttribute:function(e,t){return e.hasAttribute?e.hasAttribute(t):!!e.getAttribute(t)},isDataAttribName:function(e){return e.toString().startsWith("data-")},getDataAttribCoreName:function(t){return e.DomUtils.isDataAttribName(t)?t.substr(5):null},getDataAttrib:function(e,t){return e.dataset?e.dataset[t]:e.getAttribute("data-"+t.toString().hyphenize())},setDataAttrib:function(e,t,r){e.dataset?e.dataset[t]=r:e.setAttribute("data-"+t.toString().hyphenize(),r)},getDataset:function(e){if(e.dataset)return e.dataset;for(var t={},r=e.attributes,i=0,n=r.length;i<n;++i){var a=r[i],o=a.name;if(0===o.toLowerCase().indexOf("data-")){t[o.substring(5).camelize()]=a.value}}return t},clearChildContent:function(t){for(var r=e.ArrayUtils.toArray(t.childNodes),i=r.length-1;i>=0;--i){var n=r[i];n.nodeType!==Node.ATTRIBUTE_NODE&&t.removeChild(n)}return t},replaceTagName:function(t,r){if(t.tagName.toLowerCase()!==r.toLowerCase()){for(var i=t.ownerDocument.createElement(r),n=e.DomUtils.fetchAttributeValuesToArray(t),a=0,o=n.length;a<o;++a)i.setAttribute(n[a].name,n[a].value);for(var s=e.DomUtils.getDirectChildElems(t),a=0,o=s.length;a<o;++a)i.appendChild(s[a]);var l=t.parentNode,d=t.nextSibling;return l.removeChild(t),d?l.insertBefore(i,d):l.appendChild(i),i}return t},setElemAttributes:function(t,r){for(var i=e.ObjUtils.getOwnedFieldNames(r),n=0,a=i.length;n<a;++n){var o=i[n],s=r[o];o&&s&&t.setAttribute(o,s)}return t},isInDomTree:function(t,r,i){var n=i||{};if(!t)return!1;if(r||(r=t.ownerDocument),r){if(!n.acrossShadowRoot&&t.getRootNode)return t.getRootNode()===r;var a=r.documentElement;return e.DomUtils.isDescendantOf(t,a,i)||t===a}return!1},isInShadowRoot:function(e){if("undefined"==typeof ShadowRoot)return!1;try{return(e.getRootNode&&e.getRootNode())instanceof ShadowRoot}catch(e){return!1}}},e.DataSrcAttribUtils={isUrlBasedValue:function(e){return 0===e.toLowerCase().indexOf("url(")},getUrl:function(e){var t=e.trim();if(0===t.toLowerCase().indexOf("url(")){var r=t.lastIndexOf(")");return t=t.substring(4,r)}return null},getElementContent:function(e){if(!e)return null;var t=e.innerHTML;return t=t.ltrim()},getElementMimeType:function(e){return e.getAttribute("type")}},e.ScriptFileUtils={_existedScriptUrls:new e.MapEx,appendScriptFile:function(t,r,i){var n;if(t){if(n=e.ScriptFileUtils._existedScriptUrls.get(t),n||(n=[],e.ScriptFileUtils._existedScriptUrls.set(t,n)),n.indexOf(r)>=0)return void(i&&i(null));var a=t.createElement("script");return a.src=r,a.onerror=function(e){i&&i(e)},a.onload=a.onreadystatechange=function(e){if(!a._loaded){var t=a.readyState;void 0!==t&&"loaded"!==t&&"complete"!==t||(a._loaded=!0,a.onload=a.onreadystatechange=null,n.push(r),i&&i(null))}},(t.getElementsByTagName("head")[0]||t.body).appendChild(a),a}var o=e.$jsRoot.__$kekule_scriptfile_utils__;if(o&&o.appendScriptFile)return o.appendScriptFile(t,r,i)},appendScriptFiles:function(t,r,i){var n=[].concat(r);!function t(r,i,n,a){if(i.length<=0)return void(n&&n(a.length?new Error("Error in loading: "+a.join("; ")):null));var o=i.shift();e.ScriptFileUtils.appendScriptFile(r,o,function(e){e&&a.push(o+": "+e?e.message||e:""),t(r,i,n,a)})}(t,n,i,[])}},e}},function(e,t,r){"use strict";var i=r(0).Class,n=(r(0).ClassEx,r(0).ObjectEx),a=r(0).DataType;e.exports=function(e){return e.DomHelper=i.create(n,{CLASS_NAME:"Kekule.DomHelper",NAMESPACE_DEFINE_PREFIX:"xmlns",NAMESPACE_DELIMITER:":",ERR_EMPTY_DOC:"Document is empty",ERR_ELEMENT_NOTSET:"Element not set",initialize:function($super,e){$super(),this._supportNsMethods=null,e&&this.setDocument(e)},initProperties:function(){this.defineProp("document",{dataType:a.OBJECT,serializable:!1,getter:function(){var e=this.getPropStoreFieldValue("document");if(!e){var t=this.getPropStoreFieldValue("rootElement");e=t?t.ownerDocument:null}return e},setter:function(e){e!=this.getPropStoreFieldValue("document")&&(this.setPropStoreFieldValue("document",e),this.analysisRootElem())}}),this.defineProp("rootElement",{dataType:a.OBJECT,serializable:!1,getter:function(){var e=this.getPropStoreFieldValue("rootElement");if(!e){var t=this.getPropStoreFieldValue("document");e=t?t.documentElement:null}return e},setter:function(e){this.setPropStoreFieldValue("rootElement",e),this.analysisRootElem()}}),this.defineProp("namespaces",{dataType:a.ARRAY,serializable:!1,getter:function(){return this.getPropStoreFieldValue("namespaces")||this.setPropStoreFieldValue("namespaces",[]),this.getPropStoreFieldValue("namespaces")}}),this.defineProp("defNamespaceURI",{dataType:a.STRING,serializable:!1}),this.defineProp("forceAnalysisDoc",{dataType:a.BOOL})},analysisRootElem:function(){this.setNamespaces([]),this.setDefNamespaceURI(null);var e=this.getRootElement();if(e){var t=e.ownerDocument;if(this._supportNsMethods=!!t.getElementsByTagNameNS,!this._supportNsMethods||this.getForceAnalysisDoc())for(var r=0,i=e.attributes.length;r<i;++r){var n=e.attributes[r],a=n.name;if(a&&a.indexOf(this.NAMESPACE_DEFINE_PREFIX)>=0){var o=n.value,s=a.indexOf(this.NAMESPACE_DELIMITER),l=s>=0?a.substring(s+1):null;this.getNamespaces().push({namespaceURI:o,prefix:l}),l||this.setDefNamespaceURI(o)}}}},_getEmptyDocErrorMsg:function(){return e.hasLocalRes()?e.$L("ErrorMsg.EMPTY_DOC"):this.ERR_EMPTY_DOC},_getElementNotSetErrorMsg:function(){return e.hasLocalRes()?e.$L("ErrorMsg.ELEMENT_NOTSET"):this.ELEMENT_NOTSET},assertDocAvailable:function(t){return!!t||(e.raise(this._getEmptyDocErrorMsg()),!1)},assertElementAvailable:function(t){return!!t||(e.raise(this._getElementNotSetErrorMsg()),!1)},getNsPrefix:function(e){if(e==this.getDefNamespaceURI())return"";for(var t=this.getNamespaces(),r=0,i=t.length;r<i;++r)if(t[r].namespaceURI==e)return t[r].prefix;return null},getQualifiedName:function(e,t){var r=this.getNsPrefix(e);return null===r?null:r?r+this.NAMESPACE_DELIMITER+t:t},createElementNS:function(e,t){var r=this.getDocument();return this.assertDocAvailable(r)?this._supportNsMethods?r.createElementNS(e,t):r.createElement(t):null},getElementsByTagNameNS:function(e,t,r){var i=this.getPropStoreFieldValue("document")||this.getPropStoreFieldValue("rootElement"),n=this.getDocument();if(!this.assertDocAvailable(n))return null;if(this._supportNsMethods)return r?r.getElementsByTagNameNS(e,t):i.getElementsByTagNameNS(e,t);var a=this.getQualifiedName(e,t);return null===a?[]:r?r.getElementsByTagName(a):i.getElementsByTagName(a)},getAttributeNodeNS:function(e,t,r){if(!this.assertElementAvailable(r))return null;if(this._supportNsMethods)return r.getAttributeNodeNS(e,t);var i=this.getQualifiedName(e,t);return null===i?null:r.getAttributeNode(i)},getAttributeNS:function(e,t,r){if(!this.assertElementAvailable(r))return null;if(this._supportNsMethods)return r.getAttributeNS(e,t);var i=this.getQualifiedName(e,t);return null===i?null:r.getAttribute(i)},setAttributeNS:function(e,t,r,i){if(!this.assertElementAvailable(i))return null;if(this._supportNsMethods)return i.setAttributeNS(e,t,r);var n=this.getQualifiedName(e,t);return null===n?null:i.setAttribute(n,r)}}),e}},function(e,t,r){"use strict";e.exports=function(e){return e.StyleUtils={removeStyleProperty:function(e,t){e.removeProperty?e.removeProperty(t):e.removeAttribute?e.removeAttribute(t):e[t]=null},analysisUnitsValue:function(e){var t={};t.total=e,t.value=parseFloat(e);var r;if(e&&e.length&&void 0!==t.value&&!isNaN(t.value)){r="";for(var i=e.length-1;i>=0;--i){var n=e.charAt(i);n>="0"&&n<="9"||"."===n||"-"===n||(r=n+r)}}return t.units=r||"",t},multiplyUnitsValue:function(t,r){var i=e.StyleUtils.analysisUnitsValue(t);return i.value*=r,""+i.value+i.units},colorStrToValue:function(e){var t=e.length>4,r=t?e.substr(1,2):e.substr(1,1),i=t?e.substr(3,2):e.substr(2,1),n=t?e.substr(5,2):e.substr(3,1);return t||(r+=r,i+=i,n+=n),(parseInt(r,16)<<16)+(parseInt(i,16)<<8)+parseInt(n,16)},getComputedStyle:function(e,t){var r,i=e.ownerDocument;if(!i)return null;var n=i.defaultView;return n&&n.getComputedStyle?r=n.getComputedStyle(e,null):e.currentStyle&&(r=e.currentStyle),r?t?r[t]:r:null},isShown:function(t){var r=e.StyleUtils;return r.isDisplayed(t)&&r.isVisible(t)},isDisplayed:function(t){return"none"!==(e.StyleUtils.getComputedStyle(t,"display")||"").toLowerCase()},getDisplayed:function(t){return e.StyleUtils.getComputedStyle(t,"display")},setDisplay:function(e,t){e&&(e.style.display="string"==typeof t?t:t?"":"none")},isVisible:function(t){return"hidden"!==(e.StyleUtils.getComputedStyle(t,"visibility")||"").toLowerCase()},getVisibility:function(t){return e.StyleUtils.getComputedStyle(t,"visibility")},setVisibility:function(e,t){e&&(e.style.visibility="string"==typeof t?t:t?"":"hidden")},isBlockElem:function(t){return["block","list-item","table","flex","grid"].indexOf(e.StyleUtils.getComputedStyle(t,"display"))>=0},isAbsOrFixPositioned:function(t){var r=e.StyleUtils.getComputedStyle(t,"position")||"";return"absolute"===(r=r.toLowerCase())||"fixed"===r},_fillAbsOrFixedPositionStyleStack:function(t,r){if(e.DomUtils.isElement(t)){var i=e.StyleUtils.getComputedStyle(t,"position")||"";i=i.toLowerCase(),"absolute"!==i&&"fixed"!==i||r.push(i.toLocaleLowerCase())}var n=t.parentNode;return n&&n.ownerDocument&&e.StyleUtils._fillAbsOrFixedPositionStyleStack(n,r),r},isAncestorPositionFixed:function(t){return!!t.parentNode&&e.StyleUtils.isSelfOrAncestorPositionFixed(t)},isSelfOrAncestorPositionFixed:function(t){var r=[];if(e.StyleUtils._fillAbsOrFixedPositionStyleStack(t,r),!r.length)return null;for(var i=r.length-1;i>=0;--i){if("fixed"===r[i])return!0}return!1},setCursor:function(e,t){if(DataType.isArrayValue(t)){for(var r=0,i=t.length;r<i;++r){var n=t[r];if(e.style.cursor=n,e.style.cursor===n)return n}return e.style.cursor}return e.style.cursor=t,e.style.cursor},_cssTransformValuesToMatrix:function(t){var r=e.MatrixUtils.create(3,3,0);return r[0][0]=t.a,r[1][0]=t.b,r[0][1]=t.c,r[1][1]=t.d,r[0][2]=t.tx,r[1][2]=t.ty,r},_matrixToCssTransformValues:function(e){return{a:e[0][0],b:e[1][0],c:e[0][1],d:e[1][1],tx:e[0][2],ty:e[1][2]}},hasTransform:function(t){var r=e.StyleUtils.getComputedStyle(t,"transform");return r&&"none"!==r},getTransformMatrixValues:function(t){var r=e.StyleUtils.getComputedStyle(t,"transform")||"",i=r.match(/-?[\d\.]+/g);return i?{a:i[0],b:i[1],c:i[2],d:i[3],tx:i[4],ty:i[5]}:null},setTransformMatrixArrayValues:function(e,t){if(t){var r="matrix("+t.join(",")+")";e.style.transform=r}},getTransformMatrix:function(t){var r=e.StyleUtils.getTransformMatrixValues(t);return r?e.StyleUtils._cssTransformValuesToMatrix(r):null},getCascadeTranformMatrixes:function(t){for(var r=[],i=t;i;){if(1===i.nodeType){var n=e.StyleUtils.getTransformMatrix(i);n&&r.unshift(n)}i=i.parentNode}return r},getTotalTransformMatrix:function(t){for(var r=e.StyleUtils.getCascadeTranformMatrixes(t),i=null,n=r.length-1;n>=0;--n){var a=r[n];i=i?e.MatrixUtils.multiply(i,a):a}return i},calcInvertTransformMatrix:function(t){var r=e.StyleUtils._matrixToCssTransformValues(t),i=r,n=i.a*i.d-i.b*i.c;if(Math.abs(n)<1e-6)return!1;var a={a:i.d/n,b:-i.b/n,c:-i.c/n,d:i.a/n,tx:(i.c*i.ty-i.d*i.tx)/n,ty:(i.b*i.tx-i.a*i.ty)/n};return e.StyleUtils._cssTransformValuesToMatrix(a)}},e.HtmlElementUtils={getClassNames:function(t){return e.StrUtils.splitTokens(t.className)},hasClass:function(t,r){return e.HtmlElementUtils.getClassNames(t).indexOf(r)>=0},addClass:function(t,r){for(var i=e.HtmlElementUtils,n=e.ArrayUtils.isArray(r)?r:e.StrUtils.splitTokens(r),a=0,o=n.length;a<o;++a)i.hasClass(t,n[a])||(t.className+=" "+n[a]);return i},removeClass:function(t,r){for(var i=e.HtmlElementUtils,n=e.ArrayUtils.isArray(r)?r:e.StrUtils.splitTokens(r),a=i.getClassNames(t),o=a.length;o>=0;--o){n.indexOf(a[o])>=0&&a.splice(o,1)}return t.className=a.join(" "),i},toggleClass:function(t,r){for(var i=e.HtmlElementUtils,n=e.ArrayUtils.isArray(r)?r:e.StrUtils.splitTokens(r),a=0,o=n.length;a<o;++a)i.hasClass(t,n[a])?i.removeClass(t,n[a]):i.addClass(t,n[a]);return i},getInnerText:function(e){return e.innerText||e.textContent},resizeElem:function(e,t,r,i){e.style.width=t+(i||"px"),e.style.height=r+(i||"px")},getElemClientDimension:function(e){return{width:e.clientWidth,height:e.clientHeight}},getElemScrollDimension:function(e){return{width:e.scrollWidth,height:e.scrollHeight}},getElemComputedDimension:function(t){var r=e.StyleUtils,i={width:r.getComputedStyle(t,"width"),height:r.getComputedStyle(t,"height")},n=r.analysisUnitsValue(i.width),a=r.analysisUnitsValue(i.height),o={};return"px"===n.units&&(o.width=n.value),"px"===a.units&&(o.height=n.value),o},getElemOffsetDimension:function(e){return{width:e.offsetWidth,height:e.offsetHeight}},getViewportDimension:function(t){var r;if(t&&(r=t.ownerDocument?e.DocumentUtils.getDefaultView(t.ownerDocument):t.defaultView?t.defaultView:t.parentWindow?t.parentWindow:t),r=r||window,null!=r.innerWidth)return{width:r.innerWidth,height:r.innerHeight};var i=r.document;return"CSS1Compat"==i.compatMode?{width:i.documentElement.clientWidth,height:i.documentElement.clientHeight}:{width:i.body.clientWidth,height:i.body.clientHeight}},getViewportVisibleBox:function(t){var r;t&&(r=t.ownerDocument?e.DocumentUtils.getDefaultView(t.ownerDocument):t.defaultView?t.defaultView:t.parentWindow?t.parentWindow:t),r=r||window;var i=r.document,n=e.HtmlElementUtils.getViewportDimension(r),a=e.DocumentUtils.getScrollPosition(i),o={x1:a.left,y1:a.top,x2:n.width,y2:n.height};return o.left=o.x1,o.top=o.y1,o.right=o.x2,o.bottom=o.y2,o},getElemBoundingClientRect:function(t,r){var i=Object.extend({},t.getBoundingClientRect());if(e.ObjUtils.isUnset(i.width)&&(i.width=i.right-i.left),e.ObjUtils.isUnset(i.height)&&(i.height=i.bottom-i.top),r){var n=t.ownerDocument,a=n.documentElement.scrollTop||n.body.scrollTop||0,o=n.documentElement.scrollLeft||n.body.scrollLeft||0;i.left+=o,i.right+=o,i.top+=a,i.bottom+=a}var s=i;return s.x=s.left,s.y=s.top,s},getElemPagePos:function(e,t){for(var r=0,i=0,n=e;n;)r+=n.offsetLeft-n.scrollLeft+n.clientLeft,i+=n.offsetTop-n.scrollTop+n.clientTop,n=n.offsetParent;if(t){var a=e.ownerDocument,o=a.documentElement.scrollTop||a.body.scrollTop||0;r-=a.documentElement.scrollLeft||a.body.scrollLeft||0,i-=o}return{x:r,y:i}},getElemPageRect:function(t,r){var i=e.HtmlElementUtils.getElemPagePos(t,r),n=e.HtmlElementUtils.getElemClientDimension(t);return{x:i.x,y:i.y,left:i.x,top:i.y,right:i.x+n.width,bottom:i.y+n.height,width:n.width,height:n.height}},getElemViewportPos:function(t){var r=e.HtmlElementUtils.getElemPagePos(t,!0);return{x:r.left,y:r.top}},makePositioned:function(t){var r=e.StyleUtils.getComputedStyle(t,"position");r&&"static"!==r.toLowerCase()||(t.style.position="relative")},isFormCtrlElement:function(e){var t=["input","button","textarea","select"],r=e&&e.tagName.toLowerCase();return!!r&&t.indexOf(r)>=0},requestFullScreen:function(e){var t=e.requestFullScreen||e.mozRequestFullScreen||e.webkitRequestFullScreen||e.msRequestFullScreen;return t?t.apply(e):null},exitFullScreen:function(e){var t=e.exitFullScreen||e.mozExitFullScreen||e.webkitExitFullScreen||e.msExitFullScreen;return t?t.apply(e):null}},e.DocumentUtils={getDefaultView:function(e){return e.defaultView||e.parentWindow},getScrollPosition:function(t){var r=e.DocumentUtils.getDefaultView(t),i={left:(void 0!==r.pageXOffset?r.pageXOffset:(t.documentElement||t.body.parentNode||t.body).scrollLeft)||0,top:(void 0!==r.pageYOffset?r.pageYOffset:(t.documentElement||t.body.parentNode||t.body).scrollTop)||0};return i.x=i.left,i.y=i.top,i},getClientDimension:function(e){return"BackCompat"==e.compatMode?{width:e.body.clientWidth,height:e.body.clientHeight}:{width:e.documentElement.clientWidth,height:e.documentElement.clientHeight}},getClientVisibleBox:function(t){var r=e.DocumentUtils.getScrollPosition(t),i=e.DocumentUtils.getInnerClientDimension(t),n={};return n.left=n.x1=r.left,n.top=n.y1=r.top,n.right=n.x2=i.width+r.left,n.bottom=n.y2=i.height+r.top,n.width=i.width,n.height=i.height,n},getWindowInnerDimension:function(t){var r=e.DocumentUtils.getDefaultView(t);return{width:Math.min(r.innerWidth,r.outerWidth),height:Math.min(r.innerHeight,r.outerHeight)}},getInnerClientDimension:function(t){var r=e.DocumentUtils.getClientDimension(t),i=e.DocumentUtils.getWindowInnerDimension(t);return{width:i.width?Math.min(i.width,r.width):r.width,height:i.height?Math.min(i.height,r.height):r.height}},getClientScaleLevel:function(e){return"BackCompat"==e.compatMode?e.body.clientWidth/window.innerWidth:e.documentElement.clientWidth/window.innerWidth},getPixelZoomLevel:function(t){return e.DocumentUtils.getClientScaleLevel(t)*(e.DocumentUtils.getDefaultView(t).devicePixelRatio||1)},getDevicePPI:function(t){var r=e.DocumentUtils.getDefaultView(t);if(r.matchMedia){for(var i=0,n=0,a=200;!n||n-i>1;)r.matchMedia("(min-resolution: "+a+"dpi)").matches?n?(i=a,a=Math.round((i+n)/2)):(i=a,a*=2):(n=a,a=Math.round((i+n)/2));return a}return 96}},e}},function(e,t,r){"use strict";var i=r(0).Class,n=r(0).ObjectEx,a=r(0).DataType;e.exports=function(e){return e.TextLinesBuffer=i.create(n,{CLASS_NAME:"Kekule.TextLinesBuffer",LINEBREAK:"\n",initialize:function($super,e){$super(),this.setPropStoreFieldValue("lines",[]),e&&("string"==typeof e?this.setText(e):this.setLines(e)),this.setCurrLineNo(0)},initProperties:function(){this.defineProp("lines",{dataType:a.ARRAY,serializable:!1}),this.defineProp("text",{dataType:a.STRING,serializable:!1,getter:function(){return this.getLines().join(this.LINEBREAK)},setter:function(e){this.setPropStoreFieldValue("lines",[]),this.reset(),this.appendText(e)}}),this.defineProp("currLineNo",{dataType:a.INT,serializable:!1})},getUnreadLines:function(){var e=[].concat(this.getLines());return e.splice(0,this.getCurrLineNo()),e},getUnreadText:function(){return this.getUnreadLines().join(this.LINEBREAK)},appendText:function(e){var t=e.split(this.LINEBREAK);this.appendLines(t)},appendLines:function(e){this.setPropStoreFieldValue("lines",this.getLines().concat(e)),this.notifyPropSet("lines",this.getPropStoreFieldValue("lines"))},clear:function(){this.setLines([]),this.setCurrLineNo(0)},incCurrLineNo:function(e){null!==e&&void 0!==e||(e=1);var t=this.getCurrLineNo();t+=e,this.setCurrLineNo(t)},getLineAt:function(e){var t=this.getLines()[e];return t&&t.length&&"\r"===t.charAt(t.length-1)&&(t=t.substring(0,t.length-1)),t},getCurrLine:function(){return this.getLineAt(this.getCurrLineNo())},readLine:function(){var e=this.getLineAt(this.getCurrLineNo());return this.incCurrLineNo(),e},writeLine:function(e){this.getLines().splice(this.getCurrLineNo(),0,e),this.incCurrLineNo()},writeLines:function(e){for(var t=0,r=e.length;t<r;++t)this.writeLine(e[t])},writeText:function(e){var t=e.split(this.LINEBREAK);this.writeLines(t)},eof:function(){return this.getCurrLineNo()>=this.getLines().length},reset:function(){this.setCurrLineNo(0)}}),e}},function(e,t,r){"use strict";var i=r(0).Class,n=r(0).ClassEx,a=r(0).ObjectEx,o=r(0).DataType;e.exports=function(e){e.globalOptions.add("IO",{}),e.IO={},e.IO.ChemDataType={TEXT:"text",DOM:"dom",JSON:"json",BINARY:"bin",OTHER:"other",UNKNOWN:"unknown",isBinaryType:function(t){var r=e.IO.ChemDataType;return!t||t===r.BINARY||t===r.OTHER||t===r.UNKNOWN}},e.IO.DataFormat={},e.IO.MimeType={TEXT:"text/plain",HTML:"text/html",XML:"text/xml",JSON:"application/json",JAVASCRIPT:"application/javascript",GIF:"image/gif",JPEG:"image/jpeg",PNG:"image/png",XPNG:"image/x-png",OCTSTREAM:"application/octet-stream"},e.IO.DataFormatsManager={_formats:{},register:function(r,i,n,a,s,l,d){var u=null;u||(u=t._formats[r]),u||(u={id:r},t._formats[r]=u),u.mimeType=i;var c=o.isArrayValue(n)?n:[n];return u.fileExts?e.ArrayUtils.pushUnique(u.fileExts,c):u.fileExts=c,a&&a!==e.IO.ChemDataType.UNKNOWN&&(u.dataType=a),u.title=s,u.description=l,d&&(u=Object.extend(u,d)),u},unregister:function(e){t._formats[e]&&delete t._formats[e]},getAllIds:function(){return e.ObjUtils.getOwnedFieldNames(t._formats)},getFormatInfo:function(e){return t._formats[e]||null},getMimeType:function(e){var r=t.getFormatInfo(e);return r?r.mimeType:null},getFileExts:function(e){var r=t.getFormatInfo(e);return r?r.fileExts:null},findFormat:function(e,r){if(!e&&!r)return null;for(var i=t.getAllIds(),n=!1,a=0,o=i.length;a<o;++a){var s=t.getFormatInfo(i[a]);if(n=e&&e===s.mimeType,n||(n=r&&s.fileExts.indexOf(r)>=0),n)return s}return null},findFormatId:function(t,r){var i=e.IO.DataFormatsManager.findFormat(t,r);return i?i.id:null}};var t=e.IO.DataFormatsManager;return e.IO.dataFormatsManager=e.IO.DataFormatsManager,e.IO.ChemDataReader=i.create(a,{initialize:function($super,e){$super()},CLASS_NAME:"Kekule.IO.ChemDataReader",readData:function(t,r,i,n){if(!r){var a=e.IO.DataFormatsManager.getFormatInfo(i);r=a?a.dataType:null,r||(r="string"==typeof t?e.IO.ChemDataType.TEXT:t.getElementsByTagName?e.IO.ChemDataType.DOM:e.IO.ChemDataType.BINARY)}var o=this.doReadData(t,r,i,n||{});if(o instanceof e.ChemObject&&o.getSrcInfo){var s=o.getSrcInfo();s.data=t,s.dataType=r;var l=e.IO.DataFormatsManager.getFormatInfo(i);l&&(s.format=i,s.mimeType=l.mimeType,s.possibleFileExts=l.fileExts)}return o},doReadData:function(e,t,r,i){}}),e.IO.ChemDataWriter=i.create(a,{CLASS_NAME:"Kekule.IO.ChemDataWriter",initialize:function($super,e){$super()},writeData:function(t,r,i,n){if(!r){var a=e.IO.DataFormatsManager.getFormatInfo(i);r=a?a.dataType:null}return this.doWriteData(t,r,i,n||{})},doWriteData:function(e,t,r,i){}}),e.IO.ChemDataReaderManager={_readers:[],register:function(t,r,i,n){if(t&&r&&i&&(!o.isArrayValue(i)||i.length)){if(e.IO.ChemDataReaderManager.getReaderInfoById(t))return e.raise(e.$L("ErrorMsg.READER_ID_ALREADY_EXISTS")),null;var a={id:t,readerClass:r,formatId:o.isArrayValue(i)?i:[i]};return a=Object.extend(a,n),e.IO.ChemDataReaderManager._readers.push(a),a}},unregister:function(t){for(var r=-1,i=e.IO.ChemDataReaderManager._readers,n=0,a=i.length;n<a;++n){if(i[n].id===t){r=n;break}}if(r>=0){var o=i[r];return i.splice(r,1),o}return null},getAllReadableFormatIds:function(){for(var t=[],r=e.IO.ChemDataReaderManager._readers,i=0,n=r.length;i<n;++i){var a=r[i],o=a.formatId;e.ArrayUtils.pushUnique(t,o)}return t},getAllReadableFormats:function(){for(var r=[],i=e.IO.ChemDataReaderManager.getAllReadableFormatIds(),n=0,a=i.length;n<a;++n){var o=t.getFormatInfo(i[n]);o&&r.push(o)}return r},getAvailableReaderInfos:function(t){for(var r=[],i=e.IO.ChemDataReaderManager._readers,n=i.length-1;n>=0;--n)e.ObjUtils.match(i[n],t)&&r.push(i[n]);return r},getReaderInfo:function(t){for(var r=e.IO.ChemDataReaderManager._readers,i=r.length-1;i>=0;--i)if(e.ObjUtils.match(r[i],t))return r[i];return null},getReaderInfoById:function(t){return e.IO.ChemDataReaderManager.getReaderInfo({id:t})},getReaderInfoByFormat:function(t,r){for(var i=e.IO.ChemDataReaderManager._readers,n=i.length-1;n>=0;--n)if((!r||e.ObjUtils.match(i[n],r))&&i[n].formatId.indexOf(t)>=0)return i[n];return null},getReaderInfoByFileExt:function(t,r){var i=e.IO.DataFormatsManager.findFormatId(null,t);return i?e.IO.ChemDataReaderManager.getReaderInfoByFormat(i,r):null},createReaderOfInfo:function(e){return new e.readerClass(e.createOptions)},getReaderOfInfo:function(t){return t.instance||(t.instance=e.IO.ChemDataReaderManager.createReaderOfInfo(t)),t.instance},createReader:function(t){var r=e.IO.ChemDataReaderManager.getReaderInfo(t);if(r)return e.IO.ChemDataReaderManager.createReaderOfInfo(r)},getReader:function(t){var r=e.IO.ChemDataReaderManager.getReaderInfo(t);if(r)return e.IO.ChemDataReaderManager.getReaderOfInfo(r)},createReaderById:function(t){return e.IO.ChemDataReaderManager.createReader({id:t})},getReaderById:function(t){return e.IO.ChemDataReaderManager.getReader({id:t})},createReaderByFormat:function(t,r){var i=e.IO.ChemDataReaderManager.getReaderInfoByFormat(t,r);return i?e.IO.ChemDataReaderManager.createReaderOfInfo(i):null},getReaderByFormat:function(t,r){var i=e.IO.ChemDataReaderManager.getReaderInfoByFormat(t,r);return i?e.IO.ChemDataReaderManager.getReaderOfInfo(i):null},createReaderByFileExt:function(t,r){var i=e.IO.ChemDataReaderManager.getReaderInfoByFileExt(t,r);return i?e.IO.ChemDataReaderManager.createReaderOfInfo(i):null},getReaderByFileExt:function(t,r){var i=e.IO.ChemDataReaderManager.getReaderInfoByFileExt(t,r);return i?e.IO.ChemDataReaderManager.getReaderOfInfo(i):null},createReaderByMimeType:function(t){var r=e.IO.DataFormatsManager.findFormatId(t,null);return r?e.IO.ChemDataReaderManager.createReaderByFormat(r):null},getReaderByMimeType:function(t){var r=e.IO.DataFormatsManager.findFormatId(t,null);return r?e.IO.ChemDataReaderManager.getReaderByFormat(r):null}},e.IO.ChemDataWriterManager={_writers:[],register:function(t,r,i,n,a){if(t&&r&&n&&(!o.isArrayValue(n)||n.length)){if(e.IO.ChemDataWriterManager.getWriterInfoById(t))return e.raise(e.$L("ErrorMsg.WRITER_ID_ALREADY_EXISTS")),null;var s={id:t,writerClass:r,srcClasses:i,formatId:o.isArrayValue(n)?n:[n]};return s=Object.extend(s,a),e.IO.ChemDataWriterManager._writers.push(s),s}},unregister:function(t){for(var r=-1,i=e.IO.ChemDataWriterManager._writers,n=0,a=i.length;n<a;++n){if(i[n].id===t){r=n;break}}if(r>=0){var o=i[r];return i.splice(r,1),o}return null},getAllWritableFormatIds:function(){for(var t=[],r=e.IO.ChemDataWriterManager._writers,i=0,n=r.length;i<n;++i){var a=r[i],o=a.formatId;e.ArrayUtils.pushUnique(t,o)}return t},getAllWritableFormats:function(){for(var r=[],i=e.IO.ChemDataWriterManager.getAllWritableFormatIds(),n=0,a=i.length;n<a;++n){var o=t.getFormatInfo(i[n]);o&&r.push(o)}return r},getAvailableWriterInfos:function(t,r){for(var i=[],a=n.isClass(r)?r:r.getClass?r.getClass():r?null:void 0,o=e.IO.ChemDataWriterManager._writers,s=o.length-1;s>=0;--s)if(e.ObjUtils.match(o[s],t))if(void 0!==a){if(a)for(var l=0,d=o[s].srcClasses.length;l<d;++l)n.isOrIsDescendantOf(a,o[s].srcClasses[l])&&i.push(o[s])}else i.push(o[s]);return i},getWriterInfo:function(t,r){for(var i=e.IO.ChemDataWriterManager._writers,n=i.length-1;n>=0;--n)if(e.ObjUtils.match(i[n],t)){if(r){for(var a=0,o=i[n].srcClasses.length;a<o;++a)if(r instanceof i[n].srcClasses[a])return i[n];return null}return i[n]}return null},getWriterInfoById:function(t,r){return e.IO.ChemDataWriterManager.getWriterInfo({id:t},r)},getWriterInfoByFormat:function(t,r,i){for(var n=e.IO.ChemDataWriterManager._writers,a=n.length-1;a>=0;--a)if((!r||e.ObjUtils.match(n[a],r))&&n[a].formatId.indexOf(t)>=0){if(i){for(var o=0,s=n[a].srcClasses.length;o<s;++o)if(i instanceof n[a].srcClasses[o])return n[a];return null}return n[a]}return null},getWriterInfoByFileExt:function(t,r,i){var n=e.IO.DataFormatsManager.findFormatId(null,t);return n?e.IO.ChemDataWriterManager.getWriterInfoByFormat(n,r,i):null},createWriterOfInfo:function(e){return new e.writerClass(e.createOptions)},getWriterOfInfo:function(t){return t.instance||(t.instance=e.IO.ChemDataWriterManager.createWriterOfInfo(t)),t.instance},createWriter:function(t,r){var i=e.IO.ChemDataWriterManager.getWriterInfo(t,r);return i?e.IO.ChemDataWriterManager.createWriterOfInfo(i):null},getWriter:function(t,r){var i=e.IO.ChemDataWriterManager.getWriterInfo(t,r);return i?e.IO.ChemDataWriterManager.getWriterOfInfo(i):null},createWriterById:function(t,r){return e.IO.ChemDataWriterManager.createWriter({id:t},r)},getWriterById:function(t,r){return e.IO.ChemDataWriterManager.getWriter({id:t},r)},createWriterByFormat:function(t,r,i){var n=e.IO.ChemDataWriterManager.getWriterInfoByFormat(t,r,i);return n?e.IO.ChemDataWriterManager.createWriterOfInfo(n):null},getWriterByFormat:function(t,r,i){var n=e.IO.ChemDataWriterManager.getWriterInfoByFormat(t,r,i);return n?e.IO.ChemDataWriterManager.getWriterOfInfo(n):null},createWriterByFileExt:function(t,r,i){var n=e.IO.ChemDataWriterManager.getWriterInfoByFileExt(t,r,i);return n?e.IO.ChemDataWriterManager.createWriterOfInfo(n):null},getWriterByFileExt:function(t,r,i){var n=e.IO.ChemDataWriterManager.getWriterInfoByFileExt(t,r,i);return n?e.IO.ChemDataWriterManager.getWriterOfInfo(n):null},createWriterByMimeType:function(t,r){var i=e.IO.DataFormatsManager.findFormatId(t,null);return i?e.IO.ChemDataWriterManager.createWriterByFormat(i,null,r):null},getWriterByMimeType:function(t){var r=e.IO.DataFormatsManager.findFormatId(t,null);return r?e.IO.ChemDataWriterManager.getWriterByFormat(r,null):null}},e.IO.loadFormatData=function(t,r,i){var n=e.IO.ChemDataReaderManager.getReaderByFormat(r);if(n){var a=n.readData(t,null,r,i);if(!1===a){var o=e.$L("ErrorMsg.FAIL_TO_READ_FORMAT")+r;e.raise(o)}return a}var o=e.$L("ErrorMsg.NO_SUITABLE_READER_FOR_FORMAT")+r;return e.raise(o),null},e.IO.loadMimeData=function(t,r,i){return e.IO.loadTypedData(t,r,null,i)},e.IO.loadTypedData=function(t,r,i,n){var a;i&&(a=e.UrlUtils.extractFileExt(i));var o,s=e.IO.DataFormatsManager.findFormatId(r,r?null:a);if(s&&(o=e.IO.loadFormatData(t,s,n)),!1!==o){if(o instanceof e.ChemObject&&o.getSrcInfo){var l=o.getSrcInfo();r&&(l.mimeType=r),a&&(l.fileExt=a),i&&(l.url=i,l.fileName=i)}return o}var d=r?e.$L("ErrorMsg.NO_SUITABLE_READER_FOR_MIMETYPE")+r:e.$L("ErrorMsg.NO_SUITABLE_READER_FOR_FILEEXT")+a;return e.raise(d),null},e.IO.loadFileData=function(t,r,i,n){if(e.BrowserFeature.fileapi){var a,o=t.name,s=e.UrlUtils.extractFileExt(o);if(!(a=i?e.IO.DataFormatsManager.getFormatInfo(i):e.IO.DataFormatsManager.findFormat(null,s))){var l=e.$L("ErrorMsg.NO_SUITABLE_READER_FOR_FILEEXT")+s;return void e.raise(l)}var d=e.IO.ChemDataType.isBinaryType(a.dataType),u=new FileReader;u.onload=function(t){var i=u.result,s=e.IO.loadFormatData(i,a.id,n);if(s&&s.getSrcInfo){s.getSrcInfo().fileName=o}r(s,!1!==s,i)},d?u.readAsArrayBuffer(t):u.readAsText(t)}else e.error(e.$L("ErrorMsg.FILE_API_NOT_SUPPORTED"))},e.IO.loadUrlData=function(t,r,i,n){if(!e.Ajax)return e.raise(e.$L("ErrorMsg.AJAX_FILELOADER_NOT_FOUND")),null;e.Ajax.sendRequest(t,function(a,o,s){if(a&&s){var l;if(i&&(l=e.IO.DataFormatsManager.getFormatInfo(i)),!i){var d=e.Ajax.getResponseMimeType(o);l=e.IO.DataFormatsManager.findFormat(d)}if(!i){var u=e.UrlUtils.extractFileExt(t);l=e.IO.DataFormatsManager.findFormat(null,u)}if(!l){var c=e.$L("ErrorMsg.NO_SUITABLE_READER_FOR_FILEEXT")+u;return void e.raise(c)}var h=e.IO.loadFormatData(a,l.id,n);h.getSrcInfo().fileName=t;var s=!1!==h;r(h,s)}else e.raise(e.$L("ErrorMsg.FAIL_TO_LOAD_FILE_URL")+t)})},e.IO.saveFormatData=function(t,r,i){var n=e.IO.ChemDataWriterManager.getWriterByFormat(r,null,t);if(n){return n.writeData(t,null,r,i)}var a=e.$L("ErrorMsg.NO_SUITABLE_WRITER_FOR_FORMAT")+r;return e.raise(a),null},e.IO.saveMimeData=function(t,r,i){return e.IO.saveTypedData(t,r,null,i)},e.IO.saveTypedData=function(t,r,i,n){var a;i&&((a=e.UrlUtils.extractFileExt(i))||(a=i));var o,s=e.IO.DataFormatsManager.findFormatId(r,r?null:a);if(s&&(o=e.IO.saveFormatData(t,s,n)),e.ObjUtils.isUnset(o)){var l=r?e.$L("ErrorMsg.NO_SUITABLE_WRITER_FOR_MIMETYPE")+r:e.$L("ErrorMsg.NO_SUITABLE_WRITER_FOR_FILEEXT")+a;return e.raise(l),null}return o},e}},function(module,exports,__webpack_require__){"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Class=__webpack_require__(0).Class,ObjectEx=__webpack_require__(0).ObjectEx,DataType=__webpack_require__(0).DataType,XmlUtility=__webpack_require__(1).XmlUtility;module.exports=function(Kekule){return Kekule.globalOptions.add("IO.cml",{prettyPrint:!0}),Kekule.IO.CML={CML2CORE_NAMESPACE_URI:"http://www.xml-cml.org/schema/cml2/core",CML3_SCHEMA_NAMESPACE_URI:"http://www.xml-cml.org/schema",ARRAY_VALUE_DELIMITER:" ",TYPED_ELEM_NAMES:["string","integer","float"],TYPED_ARRAY_ELEM_NAMES:["stringArray","integerArray","floatArray"],ATOMS_REF_ATTRIBS:["atomRef","atomRefs2","atomRefs3","atomRefs4","atomRefs","atomRefArray"],BONDS_REF_ATTRIBS:["bondRef","bondRefs","bondRefArray"]},Kekule.IO.CML.LEGAL_CORE_NAMESPACE_URIS=[Kekule.IO.CML.CML2CORE_NAMESPACE_URI,Kekule.IO.CML.CML3_SCHEMA_NAMESPACE_URI],Kekule.IO.CmlUtils={cmlBondOrderToKekule:function(e){var t=parseInt(e);if(t!==t)switch(e.toUpperCase()){case"A":t=Kekule.BondOrder.EXPLICIT_AROMATIC;break;case"D":t=Kekule.BondOrder.DOUBLE;break;case"T":t=Kekule.BondOrder.TRIPLE;break;case"S":default:t=Kekule.BondOrder.SINGLE}return t},kekuleBondOrderToCml:function(e){switch(e){case Kekule.BondOrder.EXPLICIT_AROMATIC:return"A";case Kekule.BondOrder.QUAD:return"4";case Kekule.BondOrder.DOUBLE:return"D";case Kekule.BondOrder.TRIPLE:return"T";default:return"S"}},cmlBondStereoToKekule:function(e){var t;switch(e.toUpperCase()){case"E":t=Kekule.BondStereo.E;break;case"Z":t=Kekule.BondStereo.Z;break;case"C":t=Kekule.BondStereo.CIS;break;case"T":t=Kekule.BondStereo.TRANS;break;case"W":t=Kekule.BondStereo.UP;break;case"H":t=Kekule.BondStereo.DOWN;break;default:t=Kekule.BondStereo.NONE}return t},kekuleBondStereoToCml:function(e){switch(e){case Kekule.BondStereo.UP:return{value:"W"};case Kekule.BondStereo.UP_INVERTED:return{value:"W",invert:!0};case Kekule.BondStereo.DOWN:return{value:"H"};case Kekule.BondStereo.DOWN_INVERTED:return{value:"H",invert:!0};case Kekule.BondStereo.E:return{value:"E"};case Kekule.BondStereo.Z:return{value:"Z"};case Kekule.BondStereo.CIS:return{value:"C"};case Kekule.BondStereo.TRANS:return{value:"T"};default:return{value:null}}},reagentRoleToKekule:function(e){var t=Kekule.ReactionRole;switch(e){case"reagent":return t.REAGENT;case"catalyst":case"solvent":return t.CATALYST;default:return e}},kekuleReagentRoleToCml:function(e){var t=Kekule.ReactionRole;switch(e){case t.REAGENT:return"reagent";case t.CATALYST:return"catalyst";case t.SOLVENT:return"solvent";default:return e}},isDummyElementType:function(e){return"Du"==e||"Dummy"==e},isRGroupElementType:function(e){return"R"==e},isAtomListElementType:function(e){return"L"==e},getNodeElementType:function(e){if(e instanceof Kekule.Atom)return e.getSymbol();if(!(e instanceof Kekule.Pseudoatom))return e instanceof Kekule.VariableAtom?"R":e instanceof Kekule.StructureFragment?"R":e.getSymbol?e.getSymbol():"*";switch(e.getAtomType()){case Kekule.PseudoatomType.DUMMY:return"Du";case Kekule.PseudoatomType.ANY:return"A";case Kekule.PseudoatomType.HETERO:return"Q";case Kekule.PseudoatomType.CUSTOM:default:return e.getSymbol()}},createNodeByCmdElementType:function(e,t,r){return Kekule.IO.CmlUtils.isDummyElementType(t)?new Kekule.Pseudoatom(e,Kekule.PseudoatomType.DUMMY):Kekule.IO.CmlUtils.isRGroupElementType(t)?new Kekule.RGroup(e):Kekule.IO.CmlUtils.isAtomListElementType(t)?new Kekule.VariableAtom(e):Kekule.Element.isElementSymbolAvailable(t)||t==Kekule.Element.UNSET_ELEMENT?new Kekule.Atom(e,t,Math.round(r)):new Kekule.Pseudoatom(e,Kekule.PseudoatomType.CUSTOM,t)}},Kekule.IO.CmlDomUtils={splitCmlArrayValue:function(e){return"object"==(void 0===e?"undefined":_typeof(e))&&e.length?e:Kekule.StrUtils.normalizeSpace(Kekule.StrUtils.trim(e)).split(Kekule.IO.CML.ARRAY_VALUE_DELIMITER)},mergeToCmlArrayValue:function(e){return e.join(" ")},analysisCmlFormulaConciseValue:function(e){for(var t,r=Kekule.IO.CmlDomUtils.splitCmlArrayValue(e),i=0,n=r.length,a=[],o=null;i<n;){var s=r[i],l=parseFloat(s);l!=l?(o&&a.push(o),o={elementType:s}):o?(o.count=l,a.push(o),o=null):i==n-1&&(t=l),++i}return{isotopes:a,formalCharge:t}},getCmlBuiltinElemInfo:function(e,t,r){var i=e.getAttribute("builtin");if(!i&&t&&(e.getAttributeNS?i=e.getAttributeNS(t,"builtin"):r&&(i=r.getAttributeNS(t,"builtin",e))),i){return{name:i,value:Kekule.DomUtils.getElementText(e)}}return null},readCmlTypedPropertyElem:function(e,t,r){var i;if(i=e.getAttribute("builtin"),!i&&t&&(e.getAttributeNS?i=e.getAttributeNS(t,"builtin"):r&&(i=r.getAttributeNS(t,"builtin",e))),i){var n=Kekule.DomUtils.getElementText(e);switch(Kekule.DomUtils.getLocalName(e)){case"float":n=parseFloat(n);break;case"integer":n=parseInt(n)}return{name:i,value:n}}return null},readCmlTypedPropertyArrayElem:function(e,t,r){var i;if(i=e.getAttribute("builtin"),!i&&t&&(e.getAttributeNS?i=e.getAttributeNS(t,"builtin"):r&&(i=r.getAttributeNS(t,"builtin",e))),i){var n=Kekule.DomUtils.getElementText(e),a=Kekule.IO.CmlDomUtils.splitCmlArrayValue(n);switch(Kekule.DomUtils.getLocalName(e)){case"float":for(var o=0,s=a.length;o<s;++o)a[o]=parseFloat(a[o]);break;case"integer":for(var o=0,s=a.length;o<s;++o)a[o]=parseInt(a[o])}return{name:i,values:a}}return null},hasDirectCmlTypedElemChildren:function(e,t){for(var r=0,i=Kekule.IO.CML.TYPED_ELEM_NAMES.length;r<i;++r){var n=Kekule.IO.CML.TYPED_ELEM_NAMES[r];if(Kekule.DomUtils.getDirectChildElems(e,null,n,t).length>0)return!0}return!1},hasDirectCmlTypedArrayElemChildren:function(e,t){for(var r=0,i=Kekule.IO.CML.TYPED_ARRAY_ELEM_NAMES.length;r<i;++r){var n=Kekule.IO.CML.TYPED_ARRAY_ELEM_NAMES[r];if(Kekule.DomUtils.getDirectChildElems(e,null,n,t).length>0)return!0}return!1},isCmlTypedElem:function(e,t){var r=Kekule.IO.CML.TYPED_ELEM_NAMES.indexOf(Kekule.DomUtils.getLocalName(e))>=0;return t&&(r=r&&e.namespaceURI==t),r},isCmlTypedArrayElem:function(e,t){var r=Kekule.IO.CML.TYPED_ARRAY_ELEM_NAMES.indexOf(Kekule.DomUtils.getLocalName(e))>=0;return t&&(r=r&&e.namespaceURI==t),r},isCmlBuiltInMarkedElem:function(e,t){var r=Kekule.DomUtils.hasAttribute(e,"builtin");return t&&r&&(r=e.namespaceURI===t),r},FILTER_TYPED_ELEM:1,FILTER_TYPEDARRAY_ELEM:2,FILTER_ALL:3,getCmlTypedElem:function(e,t,r){var i=e.namespaceURI,n=Kekule.DomUtils.getDirectChildElemsOfAttribValues(e,[{builtin:t}],null,null,i);if(n&&n.length>0)for(var a=n.length-1;a>=0;--a){if(r&Kekule.IO.CmlDomUtils.FILTER_TYPED_ELEM&&Kekule.IO.CmlDomUtils.isCmlTypedElem(n[a],i))return n[a];if(r&Kekule.IO.CmlDomUtils.FILTER_TYPEDARRAY_ELEM&&Kekule.IO.CmlDomUtils.isCmlTypedArrayElem(n[a],i))return n[a]}return null},getCmlTypedElems:function(e,t,r){var i=[],n=e.namespaceURI,a=Kekule.DomUtils.getDirectChildElemsOfAttribValues(e,[{builtin:t}],null,null,n);if(a&&a.length>0)for(var o=a.length-1;o>=0;--o)r&Kekule.IO.CmlDomUtils.FILTER_TYPED_ELEM&&Kekule.IO.CmlDomUtils.isCmlTypedElem(a[o],n)?i.push(a[o]):r&Kekule.IO.CmlDomUtils.FILTER_TYPEDARRAY_ELEM&&Kekule.IO.CmlDomUtils.isCmlTypedArrayElem(a[o],n)&&i.push(a[o]);return i.length?i:null},getCmlTypedElemValue:function(e,t,r,i){r||(r=Kekule.IO.CmlDomUtils.FILTER_ALL);var n=Kekule.IO.CmlDomUtils.getCmlTypedElem(e,t,r);if(n)return Kekule.DomUtils.getElementText(n)},getMultipleCmlTypedElemValues:function(e,t,r,i){r||(r=Kekule.IO.CmlDomUtils.FILTER_ALL);var n=Kekule.IO.CmlDomUtils.getCmlTypedElems(e,t,r);if(n){for(var a=[],o=0,s=n.length;o<s;++o)a.push(Kekule.DomUtils.getElementText(n[o]));return a}return null},getCmlElemAttribute:function(e,t,r,i){r||(r=Kekule.IO.CmlDomUtils.FILTER_ALL);var n=Kekule.DomUtils.getSameNSAttributeValue(e,t,i);return null!==n&&void 0!==n||(n=Kekule.IO.CmlDomUtils.getCmlTypedElemValue(e,t,r,i)),n},getMultipleCmlElemAttribute:function(e,t,r,i){r||(r=Kekule.IO.CmlDomUtils.FILTER_ALL);var n=Kekule.DomUtils.getSameNSAttributeValue(e,t,i);return null!==n&&void 0!==n||(n=Kekule.IO.CmlDomUtils.getMultipleCmlTypedElemValues(e,t,r,i)),n},setCmlElemAttribute:function(e,t,r,i){return Kekule.DomUtils.setSameNSAttributeValue(e,t,r,i)},fetchCmlElemAttributeValuesToJson:function(e,t,r,i){t||(t=Kekule.IO.CmlDomUtils.FILTER_ALL);for(var n=e.namespaceURI,a=Kekule.DomUtils.fetchAttributeValuesToJson(e,n,!0),o=Kekule.DomUtils.getDirectChildElems(e,null,null,n),s=0,l=o.length;s<l;++s){var d=o[s];if(t&Kekule.IO.CmlDomUtils.FILTER_TYPED_ELEM&&(Kekule.IO.CmlDomUtils.isCmlTypedElem(d,n)||Kekule.IO.CmlDomUtils.isCmlBuiltInMarkedElem(d,n))){var u=Kekule.IO.CmlDomUtils.readCmlTypedPropertyElem(d,n,i);u&&(a[u.name]&&r?a[u.name]+=Kekule.IO.CML.ARRAY_VALUE_DELIMITER+u.value:a[u.name]=u.value)}else if(t&Kekule.IO.CmlDomUtils.FILTER_TYPEDARRAY_ELEM&&Kekule.IO.CmlDomUtils.isCmlTypedArrayElem(d,n)){var u=Kekule.IO.CmlDomUtils.getCmlBuiltinElemInfo(d,n,i);u&&(a[u.name]&&r?a[u.name]+=Kekule.IO.CML.ARRAY_VALUE_DELIMITER+u.value:a[u.name]=u.value)}}return a},isScalarElem:function(e,t){var r="scalar"==Kekule.DomUtils.getLocalName(e);return t&&(r=r&&e.namespaceURI==t),r},getCmlId:function(e,t){return Kekule.IO.CmlDomUtils.getCmlElemAttribute(e,"id",Kekule.IO.CmlDomUtils.FILTER_TYPED_ELEM,t)},setCmlId:function(e,t,r){return Kekule.IO.CmlDomUtils.setCmlElemAttribute(e,"id",t,r)},getCmlTitle:function(e,t){return Kekule.IO.CmlDomUtils.getCmlElemAttribute(e,"title",Kekule.IO.CmlDomUtils.FILTER_TYPED_ELEM,t)},setCmlTitle:function(e,t,r){return Kekule.IO.CmlDomUtils.setCmlElemAttribute(e,"title",t,r)}},Kekule.IO.CmlElementReaderFactory={_readers:{},register:function(e,t){if(Kekule.ArrayUtils.isArray(e))for(var r=0,i=e.length;r<i;++r)Kekule.IO.CmlElementReaderFactory.register(e[r],t);else Kekule.IO.CmlElementReaderFactory._readers[e]=t},getReader:function(e){var t;t="string"!=typeof e?Kekule.DomUtils.getLocalName(e):e;var r=Kekule.IO.CmlElementReaderFactory._readers[t];return r?new r:null}},Kekule.IO.CmlElementWriterFactory={_writers:{},register:function(e,t){if(Kekule.ArrayUtils.isArray(e))for(var r=0,i=e.length;r<i;++r)Kekule.IO.CmlElementWriterFactory.register(e[r],t);else Kekule.IO.CmlElementWriterFactory._writers[e]=t},getWriter:function getWriter(objOrTypeName){var name;name="string"!=typeof objOrTypeName?DataType.getType(objOrTypeName):objOrTypeName;var writerClass=Kekule.IO.CmlElementWriterFactory._writers[name];if(!writerClass&&objOrTypeName.getClassName)for(var obj=objOrTypeName,typeNames=Kekule.ObjUtils.getOwnedFieldNames(Kekule.IO.CmlElementWriterFactory._writers),i=typeNames.length-1;i>=0;--i)if(obj instanceof eval(typeNames[i])){writerClass=Kekule.IO.CmlElementWriterFactory._writers[typeNames[i]];break}return writerClass?new writerClass:null}},Kekule.IO.CmlElementHandler=Class.create(ObjectEx,{CLASS_NAME:"Kekule.IO.CmlElementHandler",initProperties:function(){this.defineProp("domHelper",{dataType:"Kekule.DomHelper",serializable:!1,getter:function(){return this.getPropStoreFieldValue("domHelper")||this.setPropStoreFieldValue("domHelper",new Kekule.DomHelper),this.getPropStoreFieldValue("domHelper")}}),this.defineProp("coreNamespaceURI",{dataType:DataType.STRING,serializable:!1})},matchCoreNamespace:function(e){var t;return t=e?"string"!=typeof e?e.namespaceURI:e:"",!this.getCoreNamespaceURI()&&!t||this.getCoreNamespaceURI()&&this.getCoreNamespaceURI()==t},copySettingsToChildHandler:function(e){e.setDomHelper(this.getDomHelper()),e.setCoreNamespaceURI(this.getCoreNamespaceURI())}}),Kekule.IO.CmlElementReader=Class.create(Kekule.IO.CmlElementHandler,{CLASS_NAME:"Kekule.IO.CmlElementReader",readElement:function(e,t){var r=this.doReadElement(e,t);if(r&&r.getId&&!r.getId()&&r.setId){var i=Kekule.IO.CmlDomUtils.getCmlId(e,this.getDomHelper);i&&r.setId(i)}return r},doReadElement:function(e,t){},readChildElement:function(e,t){return this.doReadChildElement(e,t)},doReadChildElement:function(e,t){return this.doReadChildElementDef(e,t)},readChildElementDef:function(e,t){return this.doReadChildElementDef(e,t)},doReadChildElementDef:function(e,t){var r=Kekule.IO.CmlElementReaderFactory.getReader(e);return r?(this.copySettingsToChildHandler(r),r.readElement(e,t)):null},iterateChildElements:function(e,t){for(var r=Kekule.DomUtils.getDirectChildElems(e,null,null,this.getCoreNamespaceURI()),i=0,n=r.length;i<n;++i)this.readChildElement(r[i],t)}}),Kekule.IO.CmlElementWriter=Class.create(Kekule.IO.CmlElementHandler,{CLASS_NAME:"Kekule.IO.CmlElementWriter",writeObject:function(e,t,r){if(!t&&!r)return Kekule.error(Kekule.$L("ErrorMsg.CML_CAN_NOT_OUTPUT_TO_EMPTY_ELEMENT")),null;!t&&r?t=r.documentElement:r||(r=t.ownerDocument),this.getDomHelper().getDocument!=r&&this.getDomHelper().setDocument(r);var i=this.doCreateElem(e,t,r);i?t.appendChild(i):i=t;var n=this.doWriteObject(e,i)||i;return n&&e&&(this.writeObjId(e,n),this.writeObjAdditionalInfo(e,n)),n},writeObjId:function(e,t){e.getId&&e.getId()&&Kekule.IO.CmlDomUtils.setCmlId(t,e.getId(),this.getDomHelper())},writeScalarAttribs:function(e,t){if(e.getScalarAttribs){var r=Kekule.IO.CmlElementWriterFactory.getWriter("Kekule.Scalar");if(r){this.copySettingsToChildHandler(r);for(var i=0,n=e.getScalarAttribCount();i<n;++i)r.writeObject(e.getScalarAttribAt(i),t)}}},writeObjInfoValues:function(e,t){if(e.getInfo)for(var r,i=e.getInfoKeys(),n=0,a=i.length;n<a;++n){var o=i[n],s=e.getInfoValue(i[n]);if(o&&s&&!Kekule.IO.CmlDomUtils.getCmlElemAttribute(t,o,this.getDomHelper())){r||(r=this.createChildElem("metaDataList",t));var l=this.createChildElem("metaData",r);Kekule.IO.CmlDomUtils.setCmlElemAttribute(l,"name",o,this.getDomHelper()),Kekule.IO.CmlDomUtils.setCmlElemAttribute(l,"content",DataType.StringUtils.serializeValue(s),this.getDomHelper())}}},writeObjAdditionalInfo:function(e,t){this.writeScalarAttribs(e,t),this.writeObjInfoValues(e,t)},doCreateElem:function(e,t){},createChildElem:function(e,t,r){var i=r||this.getCoreNamespaceURI(),n=this.getDomHelper().createElementNS(i,e);return t&&t.appendChild(n),n},doWriteObject:function(e,t){},reportTypeMismatchError:function(e){Kekule.error(Kekule.$L("ErrorMsg.CML_ELEM_WRITER_TYPE_INPROPER").format(this.getClassName(),DataType.getType(e)))}}),Kekule.IO.CmlNameReader=Class.create(Kekule.IO.CmlElementReader,{CLASS_NAME:"Kekule.IO.CmlNameReader",initialize:function($super){$super()},doReadElement:function(e,t){var r=Kekule.DomUtils.getElementText(e),i=Kekule.IO.CmlDomUtils.getCmlElemAttribute(e,"convention");if(r){var n={};return n.name=r,i?n.convention=i:t.setName&&t.setName(r),n}return null}}),Kekule.IO.CmlScalarReader=Class.create(Kekule.IO.CmlElementReader,{CLASS_NAME:"Kekule.IO.CmlScalarReader",doReadElement:function(e,t){var r=this.readScalar(e);return t&&t.appendScalarAttrib&&t.appendScalarAttrib(r),r},readScalar:function(e){var t=Kekule.DomUtils.fetchAttributeValuesToJson(e,this.getCoreNamespaceURI(),!0),r=Kekule.DomUtils.getElementText(e);if(r&&(t.value=r),t.value&&t.dataType)switch(t.dataType){case"xsd:boolean":t.value=Kekule.StrUtils.strToBool(t.value);break;case"xsd:float":case"xsd:double":case"xsd:duration":case"xsd:decimal":case"xsd:integer":case"xsd:nonPositiveInteger":case"xsd:negativeInteger":case"xsd:long":case"xsd:int":case"xsd:short":case"xsd:byte":case"xsd:nonNegativeInteger":case"xsd:unsignedLong":case"xsd:unsignedInt":case"xsd:unsignedShort":case"xsd:unsignedByte":case"xsd:positiveInteger":t.value=parseFloat(t.value),t.errorValue&&(t.errorValue=parseFloat(t.errorValue))}var i;if(t){i=new Kekule.Scalar;for(var n=Kekule.ObjUtils.getOwnedFieldNames(t),a=0,o=n.length;a<o;++a){var s=n[a],r=t[s];switch(s){case"value":i.setValue(r);break;case"errorValue":i.setErrorValue(r);break;case"units":i.setUnit(r);break;case"title":i.setTitle(r);break;case"dictRef":i.setName(r);break;default:i.setInfoValue(s,r)}}}return i}}),Kekule.IO.CmlScalarWriter=Class.create(Kekule.IO.CmlElementWriter,{CLASS_NAME:"Kekule.IO.CmlScalarWriter",doCreateElem:function(e,t){return this.createChildElem("scalar",t)},doWriteObject:function(e,t){if(!(e instanceof Kekule.Scalar))return this.reportTypeMismatchError(e),null;var r;if(Kekule.ObjUtils.isUnset(e.getValue())||(Kekule.DomUtils.setElementText(t,e.getValue()),r=DataType.getType(e.getValue())),e.getName()&&Kekule.IO.CmlDomUtils.setCmlElemAttribute(t,"dictRef",e.getName(),this.getDomHelper()),e.getErrorValue()&&Kekule.IO.CmlDomUtils.setCmlElemAttribute(t,"errorValue",e.getErrorValue(),this.getDomHelper()),e.getUnit()&&Kekule.IO.CmlDomUtils.setCmlElemAttribute(t,"units",e.getUnit(),this.getDomHelper()),e.getTitle()&&Kekule.IO.CmlDomUtils.setCmlElemAttribute(t,"title",e.getTitle(),this.getDomHelper()),r){var i=r==DataType.INT?"xsd:integer":r==DataType.FLOAT?"xsd:float":r==DataType.BOOL?"xsd:boolean":null;i&&Kekule.IO.CmlDomUtils.setCmlElemAttribute(t,"datatype",i,this.getDomHelper())}}}),Kekule.IO.CmlMetaDataReader=Class.create(Kekule.IO.CmlElementReader,{CLASS_NAME:"Kekule.IO.CmlMetaReader",doReadElement:function(e,t){var r=this.readMeta(e);return t&&t.setInfoValue&&r.key&&r.value&&t.setInfoValue(r.key,r.value),r},readMeta:function(e){var t=Kekule.DomUtils.fetchAttributeValuesToJson(e,this.getCoreNamespaceURI(),!0);return{key:t.name,value:DataType.StringUtils.deserializeValue(t.content)}}}),Kekule.IO.CmlMetaDataListReader=Class.create(Kekule.IO.CmlElementReader,{CLASS_NAME:"Kekule.IO.CmlMetaListReader",doReadElement:function(e,t){for(var r=Kekule.DomUtils.getDirectChildElems(e,null,"metaData",this.getCoreNamespaceURI()),i=0,n=r.length;i<n;++i){var a=r[i],o=Kekule.IO.CmlElementReaderFactory.getReader(a);o&&(this.copySettingsToChildHandler(o),o.readElement(a,t))}}}),Kekule.IO.CmlChemStructureReader=Class.create(Kekule.IO.CmlElementReader,{CLASS_NAME:"Kekule.IO.CmlChemStructureReader",initialize:function($super){$super()},hasAtomChildren:function(e,t){return t.getElementsByTagNameNS(this.getCoreNamespaceURI(),"atom",e).length},getAtomChildren:function(e,t){return t.getElementsByTagNameNS(this.getCoreNamespaceURI(),"atom",e)},atomInfoToJSON:function(e,t){return Kekule.IO.CmlDomUtils.fetchCmlElemAttributeValuesToJson(e,Kekule.IO.CmlDomUtils.FILTER_TYPED_ELEM,!0,t)},arrayedAtomInfosToJSON:function(e,t){for(var r=["id","atomID","elementType","isotope","hydrogenCount","formalCharge","count","xFract","yFract","zFract","x2","y2","x3","y3","z3"],i=["id","id","elementType","isotope","hydrogenCount","formalCharge","count","xFract","yFract","zFract","x2","y2","x3","y3","z3"],n=[],a=0,o=r.length;a<o;++a){var s,l=[];s=Kekule.IO.CmlDomUtils.getCmlElemAttribute(e,r[a],Kekule.IO.CmlDomUtils.FILTER_TYPEDARRAY_ELEM,t),s&&(l=Kekule.IO.CmlDomUtils.splitCmlArrayValue(s));for(var d=0,u=l.length;d<u;++d)n[d]||(n[d]={}),l[d]&&(n[d][i[a]]=l[d])}return n}}),Kekule.IO.CmlFormulaReader=Class.create(Kekule.IO.CmlChemStructureReader,{CLASS_NAME:"Kekule.IO.CmlFormulaReader",doReadElement:function(e,t){return this.readFormula(e,this.getDomHelper())},readFormula:function(e,t){var r=new Kekule.MolecularFormula,i=Kekule.IO.CmlDomUtils.getCmlElemAttribute(e,"formalCharge",Kekule.IO.CmlDomUtils.FILTER_TYPED_ELEM,t);i&&r.setCharge(parseFloat(i));var n=Kekule.IO.CmlDomUtils.getCmlElemAttribute(e,"concise",Kekule.IO.CmlDomUtils.FILTER_TYPED_ELEM,t);if(n)this.setConcise(r,n);else for(var a=Kekule.DomUtils.getDirectChildElems(e,null,null,this.getCoreNamespaceURI()),o=0,s=a.length;o<s;++o)switch(Kekule.DomUtils.getLocalName(a[o])){case"formula":this.readSubFormula(r,a[o],t);break;case"atomArray":this.readAtomArray(r,a[o],t);break;default:Kekule.IO.CmlDomUtils.isCmlTypedElem(e)||Kekule.IO.CmlDomUtils.isCmlTypedArrayElem(e)||this.readChildElementDef(e,r)}return r},readConsice:function(e){var t=null;return e&&(t=new Kekule.MolecularFormula,this.setConcise(t,e)),t},setConcise:function(e,t){var r=Kekule.IO.CmlDomUtils.analysisCmlFormulaConciseValue(t);return r.isotopes&&r.isotopes.length&&this.createSectionsFromAtomAttribs(e,r.isotopes),r.formalCharge&&e.setCharge(r.formalCharge),e},readAtomArray:function(e,t,r){var i=[],n=this.getAtomChildren(t,r);if(n.length>0)for(var a=0,o=n.length;a<o;++a){var s=n[a],l=this.atomInfoToJSON(s,r);i.push(l)}else i=this.arrayedAtomInfosToJSON(t,r);return this.createSectionsFromAtomAttribs(e,i),e},createSectionsFromAtomAttribs:function(e,t){for(var r=0,i=t.length;r<i;++r){var n=t[r].elementType;if(n){var a=Kekule.IO.CmlUtils.createNodeByCmdElementType(null,n),o=t[r].formalCharge||0,s=t[r].count;e.appendSection(a,s,o)}}},readSubFormula:function(e,t,r){var i=this.readElement(t,r),n=Kekule.IO.CmlDomUtils.getCmlElemAttribute(t,"count",Kekule.IO.CmlDomUtils.FILTER_TYPED_ELEM,r);e.appendSection(i,parseFloat(n)||1,i.getCharge()||0)}}),Kekule.IO.CmlFormulaWriter=Class.create(Kekule.IO.CmlElementWriter,{CLASS_NAME:"Kekule.IO.CmlFormulaWriter",doCreateElem:function(e,t){return this.createChildElem("formula",t)},doWriteObject:function(e,t){if(!(e instanceof Kekule.MolecularFormula))return this.reportTypeMismatchError(e),null;for(var r=[],i=[],n=[],a=0,o=e.getSectionCount();a<o;++a){var s=e.getSectionAt(a);if(s.obj instanceof Kekule.MolecularFormula){this.createAtomArrayElem(r,i,n,t),r=[],i=[],n=[];this.writeSubFormula(s.obj,s.count||1,t)}else r.push(Kekule.IO.CmlUtils.getNodeElementType(s.obj)),i.push(s.count||1),n.push(e.getSectionCharge(s)||0),a==o-1&&this.createAtomArrayElem(r,i,n,t)}e.getCharge()&&Kekule.IO.CmlDomUtils.setCmlElemAttribute(t,"formalCharge",e.getCharge(),this.getDomHelper())},writeSubFormula:function(e,t,r){var i=this.createChildElem("formula",r);return this.doWriteObject(e,i),t>1&&Kekule.IO.CmlDomUtils.setCmlElemAttribute(i,"count",t,this.getDomHelper()),i},createAtomArrayElem:function(e,t,r,i){if(!(e.length<=0)){var n=this.createChildElem("atomArray",i),a=Kekule.IO.CmlDomUtils.mergeToCmlArrayValue(e),o=Kekule.IO.CmlDomUtils.mergeToCmlArrayValue(t);Kekule.IO.CmlDomUtils.setCmlElemAttribute(n,"elementType",a,this.getDomHelper()),Kekule.IO.CmlDomUtils.setCmlElemAttribute(n,"count",o,this.getDomHelper());for(var s=!1,l=0,d=r.length;l<d;++l)if(r[l]){s=!0;break}if(s){var u=Kekule.IO.CmlDomUtils.mergeToCmlArrayValue(t);Kekule.IO.CmlDomUtils.setCmlElemAttribute(n,"formalCharge",u,this.getDomHelper())}return n}}}),Kekule.IO.CmlMoleculeReader=Class.create(Kekule.IO.CmlChemStructureReader,{CLASS_NAME:"Kekule.IO.CmlMoleculeReader",initialize:function($super){$super()},initProperties:function(){this.defineProp("structureBuilder",{dataType:"Kekule.ChemStructureBuilder",serializable:!1,getter:function(){return this.getPropStoreFieldValue("structureBuilder")||this.setPropStoreFieldValue("structureBuilder",new Kekule.ChemStructureBuilder),this.getPropStoreFieldValue("structureBuilder")},setter:null})},doReadElement:function(e,t){return this.readMolecule(e,this.getDomHelper())},doReadChildElement:function($super,e,t){if("molecule"==Kekule.DomUtils.getLocalName(e)&&this.matchCoreNamespace(e)){if(t.getSubMolecules){var r=this.readElement(e,t);if(r){var i=Kekule.IO.CmlDomUtils.getCmlElemAttribute(e,"amount",Kekule.IO.CmlDomUtils.FILTER_TYPED_ELEM)||Kekule.IO.CmlDomUtils.getCmlElemAttribute(e,"count",Kekule.IO.CmlDomUtils.FILTER_TYPED_ELEM),n=i?{amount:parseFloat(i)}:null;t.getSubMolecules().appendObj(r,n)}return r}return null}return $super(e,t)},hasSubMolecule:function(e){return Kekule.DomUtils.getDirectChildElems(e,null,"molecule",this.getCoreNamespaceURI()).length>0},readMolecule:function(e,t){var r;return this.hasSubMolecule(e)?(r=new Kekule.CompositeMolecule,this.iterateChildElements(e,r)):r=this.readMoleculeCore(e,t),this.readMoleculeAttribs(r,e,t),r},readMoleculeAttribs:function(e,t,r){for(var i=Kekule.IO.CmlDomUtils.fetchCmlElemAttributeValuesToJson(t,null,!0,r),n=Kekule.ObjUtils.getOwnedFieldNames(i),a=0,o=n.length;a<o;++a){var s=n[a],l=i[s];switch(s){case"id":e.setId(l);break;case"title":e.setInfoValue("title",l);break;case"formalCharge":l&&e.setCharge(parseFloat(l));break;case"formula":this.readFormulaAttrib(e,l);break;case"amount":case"count":break;default:e.setInfoValue(s,l)}}},readMoleculeCore:function(e,t){var r=new Kekule.Molecule;this.getStructureBuilder().setTarget(r);for(var i=e.firstChild;i;){if(i.nodeType!=Node.ELEMENT_NODE);else if(this.matchCoreNamespace(i))switch(Kekule.DomUtils.getLocalName(i)){case"atomArray":this.readMoleculeAtomArray(r,i,this.getStructureBuilder(),t);break;case"bondArray":this.readMoleculeBondArray(r,i,this.getStructureBuilder(),t);break;case"formula":this.readFormula(r,i,t);break;case"atom":this.getStructureBuilder().setTarget(r);var n=this.readAtom(i,t);this.getStructureBuilder().appendNode(n);break;case"bond":this.getStructureBuilder().setTarget(r);var a=this.readBond(r,i,t);this.getStructureBuilder().appendConnector(a);break;case"molecule":break;default:Kekule.IO.CmlDomUtils.isCmlTypedElem(i)||Kekule.IO.CmlDomUtils.isCmlTypedArrayElem(i)||this.readChildElementDef(i,r)}else;i=i.nextSibling}return r.hasCtab()&&this.connectUpBondAndAtom(r),r},connectUpBondAndAtom:function(e){for(var t=e.getConnectors(),r=0,i=t.length;r<i;++r){var n=t[r],a=n[this._BOND_ATOM_REF_TEMP_FIELD];if(a&&a.length)for(var o=0,s=a.length;o<s;++o){var l=e.getNodeById(a[o]);l?n.appendConnectedObj(l):Kekule.raise((Kekule.hasLocalRes()?Kekule.$L("ErrorMsg.ATOMID_NOT_EXISTS"):"Atom id not exists: ")+a[o])}delete n[this._BOND_ATOM_REF_TEMP_FIELD];var d=n[this._BOND_BOND_REF_TEMP_FIELD];if(d&&d.length)for(var o=0,s=d.length;o<s;++o){var u=e.getConnectorById(d[o]);u?n.appendConnectedObj(u):Kekule.raise((Kekule.hasLocalRes()?Kekule.$L("ErrorMsg.BONDID_NOT_EXISTS"):"Bond id not exists: ")+d[o])}delete n[this._BOND_BOND_REF_TEMP_FIELD]}},readMoleculeAtomArray:function(e,t,r,i){r.setTarget(e);var n=this.getAtomChildren(t,i);if(n.length>0)for(var a=0,o=n.length;a<o;++a){var s=n[a],l=this.readAtom(s,i);r.appendNode(l)}else for(var d=this.readArrayedAtoms(t,i),a=0,o=d.length;a<o;++a)r.appendNode(d[a])},readAtom:function(e,t){var r,i=!Kekule.IO.CmlDomUtils.hasDirectCmlTypedElemChildren(e,this.getCoreNamespaceURI()),n=this.atomInfoToJSON(e,t);if(r=this.createStructureNodeOfAttribs(n),i)for(var a=Kekule.DomUtils.getDirectChildElems(e,null,null,this.getCoreNamespaceURI()),o=0,s=a.length;o<s;++o){var e=a[o];this.readChildElementDef(e,r)}return r},readArrayedAtoms:function(e,t){for(var r=this.arrayedAtomInfosToJSON(e,t),i=[],n=0,a=r.length;n<a;++n){var o=this.createStructureNodeOfAttribs(r[n]);o&&i.push(o)}return i},createStructureNodeOfAttribs:function(e){var t;e.elementType||(e.elementType=Kekule.Element.UNSET_ELEMENT);var r=null;void 0!==e.id&&(r=e.id),delete e.id;var i=e.isotope?Math.round(e.isotope):null;t=Kekule.IO.CmlUtils.createNodeByCmdElementType(r,e.elementType,i),delete e.elementType,void 0!==e.hydrogenCount&&t.setExplicitHydrogenCount&&t.setExplicitHydrogenCount(parseInt(e.hydrogenCount,10)),delete e.hydrogenCount,e.formalCharge&&t.setCharge(parseInt(e.formalCharge)),delete e.formalCharge,e.title&&t.setInfoValue("title",e.title),delete e.title,e.role&&t.setInfoValue("role",e.role),delete e.role;var n,a;if(void 0!==e.x2&&void 0!==e.y2)n={x:parseFloat(e.x2),y:parseFloat(e.y2)};else if(e.xy2){var o=Kekule.IO.CmlDomUtils.splitCmlArrayValue(e.xy2);2==o.length&&(n={x:parseFloat(o[0]),y:parseFloat(o[1])})}if(delete e.x2,delete e.y2,delete e.xy2,void 0!==e.x3&&void 0!==e.y3&&void 0!==e.z3)a={x:parseFloat(e.x3),y:parseFloat(e.y3),z:parseFloat(e.z3)};else if(e.xyz3){var s=Kekule.IO.CmlDomUtils.splitCmlArrayValue(e.xyz3);3==s.length&&(n={x:parseFloat(s[0]),y:parseFloat(s[1]),z:parseFloat(s[2])})}delete e.x3,delete e.y3,delete e.z3,delete e.xyz3,n&&t.setCoord2D(n),a&&t.setCoord3D(a);for(var l in e)e.hasOwnProperty(l)&&"string"==typeof e[l]&&t.setInfoValue(l,e[l]);return t},_BOND_ATOM_REF_TEMP_FIELD:"__cml_atomRefs",_BOND_BOND_REF_TEMP_FIELD:"__cml_bondRefs",readMoleculeBondArray:function(e,t,r,i){r.setTarget(e);var n=i.getElementsByTagNameNS(this.getCoreNamespaceURI(),"bond",t);if(n.length>0)for(var a=0,o=n.length;a<o;++a){var s=n[a],l=this.readBond(e,s,i);r.appendConnector(l)}else for(var d=this.readArrayedBonds(e,t,i),a=0,o=d.length;a<o;++a)r.appendConnector(d[a])},readBond:function(e,t,r){var i,n=[],a=!1;if(a=!Kekule.IO.CmlDomUtils.hasDirectCmlTypedElemChildren(t,this.getCoreNamespaceURI()),n=Kekule.IO.CmlDomUtils.fetchCmlElemAttributeValuesToJson(t,Kekule.IO.CmlUtils.FILTER_TYPED_ELEM,!0,r),i=this.createStructureConnectorOfAttribs(e,n),a)for(var o=Kekule.DomUtils.getDirectChildElems(t,null,null,this.getCoreNamespaceURI()),s=0,l=o.length;s<l;++s){var t=o[s];if("bondStereo"==Kekule.DomUtils.getLocalName(t)){var d=Kekule.DomUtils.getElementText(t);d||(d=Kekule.IO.CmlDomUtils.getCmlElemAttribute(t,"conversionValue",Kekule.IO.CmlDomUtils.FILTER_TYPED_ELEM,r));var u=Kekule.IO.CmlUtils.cmlBondStereoToKekule(d);u!=Kekule.BondStereo.NONE&&i.setStereo&&i.setStereo(u)}else this.readChildElementDef(t,i)}return i},readArrayedBonds:function(e,t,r){var i=["id","bondID","atomRef1","atomRef2","order","bondStereo"],n=["id","id","atomRefs2","atomRefs2","order","bondStereo"],a=[],o=Kekule.IO.CmlDomUtils.getMultipleCmlElemAttribute(t,"atomRefs",Kekule.IO.CmlDomUtils.FILTER_TYPEDARRAY_ELEM,r);if(o&&o.length)for(var s=0,l=o.length;s<l;++s)for(var d=o[s],u=Kekule.IO.CmlDomUtils.splitCmlArrayValue(d),c=0,h=u.length;c<h;++c)a[c]||(a[c]={}),void 0==a[c].atomRefs&&(a[c].atomRefs=[]),a[c].atomRefs.push(u[c]);for(var s=0,l=i.length;s<l;++s){var d,u=[];d=Kekule.IO.CmlDomUtils.getCmlElemAttribute(t,i[s],Kekule.IO.CmlDomUtils.FILTER_TYPEDARRAY_ELEM,r),d&&(u=Kekule.IO.CmlDomUtils.splitCmlArrayValue(d));for(var c=0,h=u.length;c<h;++c)a[c]||(a[c]={}),u[c]&&("atomRef1"==i[s]||"atomRef2"==i[s]?(void 0==a[c].atomRefs2&&(a[c].atomRefs2=[]),"atomRef1"==i[s]?a[c].atomRefs2[0]=u[c]:a[c].atomRefs2[1]=u[c]):a[c][n[s]]=u[c])}for(var m=[],s=0,l=a.length;s<l;++s){var g=this.createStructureConnectorOfAttribs(e,a[s]);g&&m.push(g)}return m},createStructureConnectorOfAttribs:function(e,t){var r,i,n;if(t.id&&(i=t.id),delete t.id,void 0!==t.order&&(n=Kekule.IO.CmlUtils.cmlBondOrderToKekule(t.order)),delete t.order,r=new Kekule.Bond(i,null,n),t.bondStereo){var a=Kekule.IO.CmlUtils.cmlBondStereoToKekule(t.bondStereo);a!=Kekule.BondStereo.NONE&&r.setStereo&&r.setStereo(a)}delete t.bondStereo;for(var o=0,s=Kekule.IO.CML.ATOMS_REF_ATTRIBS.length;o<s;++o){var l=Kekule.IO.CML.ATOMS_REF_ATTRIBS[o];if(void 0!=t[l]){var d=Kekule.IO.CmlDomUtils.splitCmlArrayValue(t[l]);d.length>0&&(r[this._BOND_ATOM_REF_TEMP_FIELD]=d),delete t[l];break}}for(var o=0,s=Kekule.IO.CML.BONDS_REF_ATTRIBS.length;o<s;++o){var l=Kekule.IO.CML.BONDS_REF_ATTRIBS[o];if(void 0!=t[l]){var u=Kekule.IO.CmlDomUtils.splitCmlArrayValue(t[l]);u.length>0&&(r[this._BOND_BOND_REF_TEMP_FIELD]=u),delete t[l];break}}for(var c in t)t.hasOwnProperty(c)&&"string"==typeof t[c]&&r.setInfoValue(c,t[c]);return r},readFormula:function(e,t,r){var i=Kekule.IO.CmlElementReaderFactory.getReader(t);if(i){this.copySettingsToChildHandler(i);var n=i.readElement(t,e);n&&e.setFormula(n)}},readFormulaAttrib:function(e,t){var r=Kekule.IO.CmlElementReaderFactory.getReader("formula");if(r){var i=r.readConsice?r.readConsice(t):null;i&&e.setFormula(i)}}}),Kekule.IO.CmlMoleculeWriter=Class.create(Kekule.IO.CmlElementWriter,{CLASS_NAME:"Kekule.IO.CmlMoleculeWriter",initProperties:function(){this.defineProp("allowCascadeGroup",{dataType:DataType.BOOL})},doCreateElem:function(e,t){return this.createChildElem("molecule",t)},doWriteObject:function(e,t){return this.writeMolecule(e,t)},writeMolecule:function(e,t){return this.writeMoleculeAttribs(e,t),e instanceof Kekule.CompositeMolecule?this.writeCompositeMolecule(e,t):this.writeMoleculeCore(e,t)},writeMoleculeAttribs:function(e,t){var r=[];e.getCharge()&&r.push({key:"formalCharge",value:e.getCharge()});for(var i=["title","dictRef","chirality","ref","spinMultiplicity","symmetryOriented","role"],n=0,a=i.length;n<a;++n){var o=i[n],s=e.getInfoValue(o);Kekule.ObjUtils.isUnset(s)||r.push({key:o,value:e.getInfoValue(o)})}for(var n=0,a=r.length;n<a;++n)Kekule.IO.CmlDomUtils.setCmlElemAttribute(t,r[n].key,r[n].value,this.getDomHelper())},writeCompositeMolecule:function(e,t){for(var r=e.getSubMolecules(),i=0,n=r.getItemCount();i<n;++i){var a=r.getItemAt(i),o=a.obj,s=this.writeObject(o,t);a.amount&&Kekule.IO.CmlDomUtils.setCmlElemAttribute(s,"amount",a.amount,this.getDomHelper())}return t},writeMoleculeCore:function(e,t){if(e.hasFormula()){var r=e.getFormula(),i=Kekule.IO.CmlElementWriterFactory.getWriter(r);this.copySettingsToChildHandler(i),i.writeObject(r,t)}e.hasCtab()&&this.writeCtab(e.getCtab(),e,t)},writeCtab:function(e,t,r){this.identifyObjsInCtab(e,t);var i=this.getAllowCascadeGroup()?e.getNodes():e.getLeafNodes();if(i.length>0)for(var n=this.createChildElem("atomArray",r),a=0,o=i.length;a<o;++a)this.writeCtabNode(i[a],n);var s=this.getAllowCascadeGroup()?e.getConnectors():e.getAllChildConnectors();if(s.length>0)for(var l=this.createChildElem("bondArray",r),a=0,o=s.length;a<o;++a)this.writeCtabConnector(s[a],l)},writeCtabNode:function(e,t){var r=this.createChildElem("atom",t);this.writeObjId(e,r);var i=Kekule.IO.CmlUtils.getNodeElementType(e);Kekule.IO.CmlDomUtils.setCmlElemAttribute(r,"elementType",i,this.getDomHelper());var n=e.getMassNumber?e.getMassNumber():null;n&&Kekule.IO.CmlDomUtils.setCmlElemAttribute(r,"isotope",n,this.getDomHelper());var a=e.getExplicitHydrogenCount?e.getExplicitHydrogenCount():null;Kekule.ObjUtils.isUnset(a)||Kekule.IO.CmlDomUtils.setCmlElemAttribute(r,"hydrogenCount",a,this.getDomHelper());var o=e.getCharge?e.getCharge():null;o&&Kekule.IO.CmlDomUtils.setCmlElemAttribute(r,"formalCharge",o,this.getDomHelper());var s=(e.getParity&&e.getParity(),e.getInfoValue?e.getInfoValue("title"):null);s&&Kekule.IO.CmlDomUtils.setCmlElemAttribute(r,"title",s,this.getDomHelper());var l=e.getInfoValue?e.getInfoValue("role"):null;if(l&&Kekule.IO.CmlDomUtils.setCmlElemAttribute(r,"role",l,this.getDomHelper()),e.hasCoord2D&&e.hasCoord2D()){var d=e.getAbsCoord2D();Kekule.ObjUtils.isUnset(d.x)||Kekule.IO.CmlDomUtils.setCmlElemAttribute(r,"x2",d.x,this.getDomHelper()),Kekule.ObjUtils.isUnset(d.y)||Kekule.IO.CmlDomUtils.setCmlElemAttribute(r,"y2",d.y,this.getDomHelper())}if(e.hasCoord3D&&e.hasCoord3D()){var u=e.getAbsCoord3D();Kekule.ObjUtils.isUnset(u.x)||Kekule.IO.CmlDomUtils.setCmlElemAttribute(r,"x3",u.x,this.getDomHelper()),Kekule.ObjUtils.isUnset(u.y)||Kekule.IO.CmlDomUtils.setCmlElemAttribute(r,"y3",u.y,this.getDomHelper()),Kekule.ObjUtils.isUnset(u.z)||Kekule.IO.CmlDomUtils.setCmlElemAttribute(r,"z3",u.z,this.getDomHelper())}for(var c=["occupancy","xFract","xyzFract","yFract","convention","dictRef","ref"],h=0,m=c.length;h<m;++h){var g=c[h],f=e.getInfoValue(g);f&&Kekule.IO.CmlDomUtils.setCmlElemAttribute(r,g,f,this.getDomHelper())}return this.writeObjAdditionalInfo(e,r),r},writeCtabConnector:function(e,t){var r=!1,i=this.createChildElem("bond",t);this.writeObjId(e,i);var n=e.getBondOrder?e.getBondOrder():null;if(n){var a=Kekule.IO.CmlUtils.kekuleBondOrderToCml(n);a&&Kekule.IO.CmlDomUtils.setCmlElemAttribute(i,"order",a,this.getDomHelper())}var o=e.getStereo?e.getStereo():null;if(o){var s=Kekule.IO.CmlUtils.kekuleBondStereoToCml(o);if(s.value){var l=this.createChildElem("bondStereo",i);Kekule.DomUtils.setElementText(l,s.value),s.invert&&(r=!0)}}for(var d=[],u=[],c=0,h=e.getConnectedObjCount();c<h;++c){var m=e.getConnectedObjAt(c);if(m.getId&&m.getId()){var g=m.getId();m instanceof Kekule.ChemStructureNode?r?d.unshift(g):d.push(g):m instanceof Kekule.ChemStructureConnector&&u.push(g)}}var f=d.length;if(f){var p=1==f?"atomRefs":f>=2&&f<=4?"atomRefs"+f:"atomRefs";Kekule.IO.CmlDomUtils.setCmlElemAttribute(i,p,Kekule.IO.CmlDomUtils.mergeToCmlArrayValue(d),this.getDomHelper())}var f=u.length;if(f){var p="bondRefs";Kekule.IO.CmlDomUtils.setCmlElemAttribute(i,p,Kekule.IO.CmlDomUtils.mergeToCmlArrayValue(u),this.getDomHelper())}for(var C=["convention","dictRef","ref"],c=0,h=C.length;c<h;++c){var b=C[c],E=e.getInfoValue(b);E&&Kekule.IO.CmlDomUtils.setCmlElemAttribute(i,b,E,this.getDomHelper())}return this.writeObjAdditionalInfo(e,i),i},identifyObjsInCtab:function(e,t){for(var r=0,i=e.getNodeCount();r<i;++r){var n=e.getNodeAt(r);n.getId()||this.autoIdentifyForObj(n,t),e.isSubFragment(n)&&n.hasCtab&&n.hasCtab()&&this.identifyObjsInCtab(n.getCtab(),t)}for(var r=0,i=e.getConnectorCount();r<i;++r){var a=e.getConnectorAt(r);a.getId()||this.autoIdentifyForObj(a,t)}},autoIdentifyForObj:function(e,t){e.getId()||(e.getOwner&&e.getOwner()&&e.getOwner().getAutoId?e.setId(e.getOwner().getAutoId(e)):e.setId(this.getAutoIdForObj(e,t)))},getAutoIdForObj:function(e,t){var r=e.getAutoIdPrefix?e.getAutoIdPrefix():"obj";return Kekule.IO.CmlMoleculeWriter._UID_SEED||(Kekule.IO.CmlMoleculeWriter._UID_SEED=(new Date).getTime()),++Kekule.IO.CmlMoleculeWriter._UID_SEED,""+r+Kekule.IO.CmlMoleculeWriter._UID_SEED.toString()}}),Kekule.IO.CmlMoleculeWriter._UID_SEED=null,Kekule.IO.CmlReactionReagentReader=Class.create(Kekule.IO.CmlElementReader,{CLASS_NAME:"Kekule.IO.CmlReactionReagentReader",doReadElement:function(e,t){return this.readReagent(e,this.getDomHelper())},readReagent:function(e,t){var r=null,i=Kekule.DomUtils.getDirectChildElems(e,null,"molecule",this.getCoreNamespaceURI());if(i&&i.length){var n=i[i.length-1],a=Kekule.IO.CmlElementReaderFactory.getReader(n);this.copySettingsToChildHandler(a);var o=a.readElement(n,null);o&&(r={},Kekule.RoleMapUtils.setItem(r,o),this.readReagentAttribs(r,e,t))}return r},readReagentAttribs:function(e,t,r){for(var i=Kekule.IO.CmlDomUtils.fetchCmlElemAttributeValuesToJson(t,Kekule.IO.CmlDomUtils.FILTER_TYPED_ELEM,!0,r),n=Kekule.ObjUtils.getOwnedFieldNames(i),a=0,o=n.length;a<o;++a){var s=n[a],l=i[s];switch(s){case"role":e.role=Kekule.IO.CmlUtils.reagentRoleToKekule(l);break;case"amount":case"count":e.amount=parseFloat(l);break;default:e[s]=l}}return e}}),Kekule.IO.CmlReactionReader=Class.create(Kekule.IO.CmlElementReader,{CLASS_NAME:"Kekule.IO.CmlReactionReader",doReadElement:function(e,t){return this.readReaction(e,this.getDomHelper())},readReaction:function(e,t){for(var r=new Kekule.Reaction,i=Kekule.DomUtils.getDirectChildElems(e,null,null,this.getCoreNamespaceURI()),n=0,a=i.length;n<a;++n)this.isComponentListElem(i[n])?this.readComponentList(r,i[n],t):this.readChildElement(i[n],r);for(var o=Kekule.IO.CmlDomUtils.fetchCmlElemAttributeValuesToJson(e,Kekule.IO.CmlDomUtils.FILTER_TYPED_ELEM,null,this.getDomHelper()),s=Kekule.ObjUtils.getOwnedFieldNames(o),n=0,a=s.length;n<a;++n){var l=s[n],d=o[l];switch(l){case"name":r.setName(d);break;case"title":r.setTitle(d);break;case"type":r.setReactionType(d);break;case"yield":r.setYield(parseFloat(d));break;default:r.setInfoValue(l,d)}}return r},readComponentList:function(e,t,r){var i=this.getListElemComponentName(t),n=e.getComponentArray(i,!0);if(n)for(var a=Kekule.DomUtils.getDirectChildElems(t,null,null,this.getCoreNamespaceURI()),o=0,s=a.length;o<s;++o){var l=this.readChildElement(a[o],n);l&&(i==Kekule.ReactionComponent.CONDITION&&l instanceof ObjectEx?e.appendItem(i,l):e.appendMap(i,l))}},isComponentListElem:function(e){return["reactantList","productList","substanceList","conditionList"].indexOf(Kekule.DomUtils.getLocalName(e))>=0},getListElemComponentName:function(e){switch(Kekule.DomUtils.getLocalName(e)){case"reactantList":return Kekule.ReactionComponent.REACTANT;case"productList":return Kekule.ReactionComponent.PRODUCT;case"conditionList":return Kekule.ReactionComponent.CONDITION;default:return Kekule.ReactionComponent.SUBSTANCE}}}),Kekule.IO.CmlReactionWriter=Class.create(Kekule.IO.CmlElementWriter,{CLASS_NAME:"Kekule.IO.CmlReactionWriter",doCreateElem:function(e,t){return this.createChildElem("reaction",t)},doWriteObject:function(e,t){return this.writeReaction(e,t)},writeReaction:function(e,t){for(var r=[Kekule.ReactionComponent.REACTANT,Kekule.ReactionComponent.PRODUCT,Kekule.ReactionComponent.SUBSTANCE,Kekule.ReactionComponent.CONDITION],i=0,n=r.length;i<n;++i)this.writeCompList(e,r[i],t);return this.writeReactionAttribs(e,t),t},writeReactionAttribs:function(e,t){var r=[];e.getName()&&r.push({key:"name",value:e.getName()}),e.getTitle()&&r.push({key:"title",value:e.getTitle()}),e.getReactionType()&&r.push({key:"type",value:e.getReactionType()}),e.getYield()&&r.push({key:"yield",value:e.getYield()});for(var i=["dictRef","convention","format","ref","role","type","state","yield","atomMap","electronMap"],n=0,a=i.length;n<a;++n)Kekule.ObjUtils.isUnset(e.getInfoValue(i[n]))||r.push({key:i[n],value:e.getInfoValue(i[n])});for(var n=0,a=r.length;n<a;++n)Kekule.IO.CmlDomUtils.setCmlElemAttribute(t,r[n].key,r[n].value,this.getDomHelper())},writeCompList:function(e,t,r){if(e.getComponentItemCount(t)<=0)return null;for(var i=this.getReactionComponentCmlName(t),n=this.createChildElem(i+"List",r),a=0,o=e.getComponentItemCount(t);a<o;++a){var s=e.getMapAt(t,a),l=e.getMapItemAt(t,a);if(s&&l){var d;t!=Kekule.ReactionComponent.CONDITION?(d=this.createChildElem(i,n),Kekule.ObjUtils.isUnset(s.amount)||Kekule.IO.CmlDomUtils.setCmlElemAttribute(d,"amount",s.amount,this.getDomHelper()),s.role&&Kekule.IO.CmlDomUtils.setCmlElemAttribute(d,"role",Kekule.IO.CmlUtils.kekuleReagentRoleToCml(s.role),this.getDomHelper())):d=n;var u=Kekule.IO.CmlElementWriterFactory.getWriter(l);u&&(this.copySettingsToChildHandler(u),u.writeObject(l,d))}}},getReactionComponentCmlName:function(e){switch(e){case Kekule.ReactionComponent.REACTANT:return"reactant";case Kekule.ReactionComponent.PRODUCT:return"product";case Kekule.ReactionComponent.CONDITION:return"condition";default:return"substance"}}}),Kekule.IO.CmlListReader=Class.create(Kekule.IO.CmlElementReader,{CLASS_NAME:"Kekule.IO.CmlListReader",doReadElement:function(e,t){var r=this.createList(e);return r=this.readList(r,e,this.getDomHelper())},createList:function(e){switch(Kekule.DomUtils.getLocalName(e)){case"moleculeList":return new Kekule.MoleculeList;case"reactionList":return new Kekule.ReactionList;default:return new Kekule.ChemObjList}},readList:function(e,t,r){var i=Kekule.DomUtils.getDirectChildElems(t,null,null,this.getCoreNamespaceURI());if(i)for(var n=0,a=i.length;n<a;++n){var o=i[n],s=Kekule.IO.CmlElementReaderFactory.getReader(o);if(s){this.copySettingsToChildHandler(s);var l=s.readElement(o,null);l&&e.append(l)}}return e}}),Kekule.IO.CmlListWriter=Class.create(Kekule.IO.CmlElementWriter,{CLASS_NAME:"Kekule.IO.CmlListWriter",doCreateElem:function(e,t){var r;switch(DataType.getType(e)){case"Kekule.MoleculeList":r="moleculeList";break;case"Kekule.ReactionList":r="reactionList";break;default:r="list"}return this.createChildElem(r,t)},doWriteObject:function(e,t){var r=Kekule.ChemStructureUtils.getChildStructureObjs(e,!1);return this.writeList(r,t)},writeList:function(e,t){for(var r=0,i=e.length;r<i;++r){var n=e[r];if(n){var a=Kekule.IO.CmlElementWriterFactory.getWriter(n);a&&(this.copySettingsToChildHandler(a),a.writeObject(n,t))}}return t}}),Kekule.IO.CmlRootReader=Class.create(Kekule.IO.CmlElementReader,{CLASS_NAME:"Kekule.IO.CmlRootReader",doReadElement:function(e,t){this.analysisElem(e);var r;if("cml"!=Kekule.DomUtils.getLocalName(e)&&(r=this.getReader(e)),r)return r.readElement(e,null);var i=Kekule.DomUtils.getDirectChildElems(e,null,null,this.getCoreNamespaceURI());if(i)for(var n=0,a=i.length;n<a;++n)if(r=this.getReader(i[n]))return r.readElement(i[n],null);return null},getReader:function(e){var t=Kekule.IO.CmlElementReaderFactory.getReader(e);return t?(this.copySettingsToChildHandler(t),t):null},analysisElem:function(e){var t=this.getDomHelper();t.setForceAnalysisDoc(!0),this.getDomHelper().setRootElement(e);for(var r=t.getNamespaces(),i=null,n=0,a=r.length;n<a;++n){var o=r[n].namespaceURI;if(Kekule.IO.CML.LEGAL_CORE_NAMESPACE_URIS.indexOf(o)>=0){i=o;break}}this.setCoreNamespaceURI(i||null)}}),Kekule.IO.CmlRootWriter=Class.create(Kekule.IO.CmlElementWriter,{CLASS_NAME:"Kekule.IO.CmlRootWriter",getWriter:function(e){var t=Kekule.IO.CmlElementWriterFactory.getWriter(e);return t?(this.copySettingsToChildHandler(t),t):null},writeObject:function(e,t,r){this.getDomHelper().setForceAnalysisDoc(!0),this.getDomHelper().setRootElement(t);var i;i=e instanceof Kekule.ChemSpace?e.getRoot():e;var n=this.getWriter(i);return n?n.writeObject(i,t):null}}),Kekule.IO.CmlReader=Class.create(Kekule.IO.ChemDataReader,{CLASS_NAME:"Kekule.IO.CmlReader",doReadData:function(e,t,r){var i;if(t!=Kekule.IO.ChemDataType.DOM){i=DataType.XmlUtility.parse(e).documentElement}else i=e.documentElement?e.documentElement:e;return Kekule.IO.CmlElementReaderFactory.getReader("cml").readElement(i,null)}}),Kekule.IO.CmlWriter=Class.create(Kekule.IO.ChemDataWriter,{CLASS_NAME:"Kekule.IO.CmlWriter",initialize:function($super,e){$super(e);var t=e||{};this.setPrettyPrint(Kekule.ObjUtils.isUnset(t.prettyPrint)?Kekule.globalOptions.IO.cml.prettyPrint:t.prettyPrint)},initProperties:function(){this.defineProp("prettyPrint",{dataType:DataType.BOOL,defaultValue:!0})},doWriteData:function(e,t,r){var i=Kekule.IO.CML.CML3_SCHEMA_NAMESPACE_URI,n=DataType.XmlUtility.newDocument("cml",i),a=Kekule.IO.CmlElementWriterFactory.getWriter("Kekule.ChemDocument");if(a){a.setCoreNamespaceURI(i);var o=a.writeObject(e,n.documentElement);return t==Kekule.IO.ChemDataType.TEXT&&(o=DataType.XmlUtility.serializeNode(n.documentElement,{prettyPrint:this.getPrettyPrint()})),o}return Kekule.error(Kekule.$L("ErrorMsg.UNABLE_TO_OUTPUT_AS_CML").format(DataType.getType(e))),null}}),function(){Kekule.IO.MimeType.CML="chemical/x-cml";var e=Kekule.IO.CmlElementReaderFactory;e.register("name",Kekule.IO.CmlNameReader),e.register("scalar",Kekule.IO.CmlScalarReader),e.register("metaData",Kekule.IO.CmlMetaDataReader),e.register("metaDataList",Kekule.IO.CmlMetaDataListReader),e.register("formula",Kekule.IO.CmlFormulaReader),e.register("molecule",Kekule.IO.CmlMoleculeReader),e.register(["reactant","product","substance"],Kekule.IO.CmlReactionReagentReader),e.register("reaction",Kekule.IO.CmlReactionReader),e.register(["list","moleculeList","reactionList"],Kekule.IO.CmlListReader),e.register("cml",Kekule.IO.CmlRootReader);var t=Kekule.IO.CmlElementWriterFactory;t.register("Kekule.Scalar",Kekule.IO.CmlScalarWriter),t.register("Kekule.MolecularFormula",Kekule.IO.CmlFormulaWriter),t.register(["Kekule.ChemStructureFragment","Kekule.Molecule","Kekule.CompositeMolecule"],Kekule.IO.CmlMoleculeWriter),t.register("Kekule.Reaction",Kekule.IO.CmlReactionWriter),t.register(["Kekule.ChemObjList","Kekule.ChemStructureObjectGroup","Kekule.ChemSpaceElement","Kekule.ChemSpace"],Kekule.IO.CmlListWriter),t.register("Kekule.ChemDocument",Kekule.IO.CmlRootWriter),Kekule.IO.DataFormat.CML="cml",Kekule.IO.DataFormatsManager.register("cml",Kekule.IO.MimeType.CML,"cml",Kekule.IO.ChemDataType.TEXT,"Chemical Markup Language");var r=Kekule.IO.DataFormatsManager.findFormatId(Kekule.IO.MimeType.CML);Kekule.IO.ChemDataReaderManager.register("cml",Kekule.IO.CmlReader,[r]),Kekule.IO.ChemDataWriterManager.register("cml",Kekule.IO.CmlWriter,[Kekule.Scalar,Kekule.StructureFragment,Kekule.Reaction,Kekule.ChemObjList,Kekule.ChemSpace],[r])}(),Kekule}},function(e,t,r){"use strict";var i=r(0).Class,n=r(0).ObjectEx;r(0).DataType,r(1).XmlUtility;e.exports=function(e){return e.IO.MdlVersion={V2000:2,V3000:3},e.IO.MDL={VER2000:"V2000",VER3000:"V3000",SYMBOL_ANYATOM:"A",SYMBOL_STARATOM:"*",SYMBOL_HETEROATOM:"Q",SYMBOL_RGROUP:"R",SYMBOL_RGROUP2:"R#",SYMBOL_LONEPAIR:"LP",SYMBOL_ATOMLIST:"L",SYMBOL_DUMMYATOM:"Du",SD_DATA_HEAD_PREFIX:">",MOL_DELIMITER:"$$$$"},e.IO.MdlUtils={isUnspecifiedAtomSymbol:function(t){return t===e.IO.MDL.SYMBOL_ANYATOM||t===e.IO.MDL.SYMBOL_STARATOM},isHeteroAtomSymbol:function(t){return t===e.IO.MDL.SYMBOL_HETEROATOM},isRGroupSymbol:function(t){return t===e.IO.MDL.SYMBOL_RGROUP||t===e.IO.MDL.SYMBOL_RGROUP2},isLonePairSymbol:function(t){return t===e.IO.MDL.SYMBOL_LONEPAIR},isAtomListSymbol:function(t){return t===e.IO.MDL.SYMBOL_ATOMLIST},analysisMdlDateTimeStr:function(e,t){var r=new Date,i=0,n=2,a=(parseInt(e.substr(i,n).trim(),10)||1)-1;i+=n;var o=parseInt(e.substr(i,n).trim(),10)||0;i+=n,n=t?4:2;var s=parseInt(e.substr(i,n),10)||0;t||(s+=s>=70?1900:2e3),r.setFullYear(s,a,o),i+=n,n=2;var l=parseInt(e.substr(i,n),10)||0;i+=n;var d=parseInt(e.substr(i,n),10)||0;return r.setHours(l,d),r},generateMdlDateTimeStr:function(e,t){var r="";return r+=(e.getMonth()+1).toString().lpad(2,"0"),r+=e.getDate().toString().lpad(2,"0"),r+=t?e.getFullYear().toString().lpad(4,"0"):(e.getFullYear()%100).toString().lpad(2,"0"),r+=e.getHours().toString().lpad(2,"0"),r+=e.getMinutes().toString().lpad(2,"0")},mdlRadicalToKekule:function(e){return e},kekuleRadicalToMdl:function(e){return e},bondTypeToKekuleOrder:function(t){switch(t){case 1:return e.BondOrder.SINGLE;case 2:return e.BondOrder.DOUBLE;case 3:return e.BondOrder.TRIPLE;case 4:return e.BondOrder.EXPLICIT_AROMATIC;default:return e.BondOrder.UNSET}},kekuleBondOrderToMdlType:function(t){switch(t){case e.BondOrder.SINGLE:return 1;case e.BondOrder.DOUBLE:return 2;case e.BondOrder.TRIPLE:return 3;case e.BondOrder.EXPLICIT_AROMATIC:return 4;default:return 1}},getRxnMarkVersion:function(t){var r=t.substr(0,4);return"$RXN"!=r?null:(r=t.substr(4).trim(),r==e.IO.MDL.VER3000?e.IO.MdlVersion.V3000:e.IO.MdlVersion.V2000)},assertIlegalForCtabOutput:function(t){return t instanceof e.StructureFragment?!!t.hasCtab()||(e.error(e.$L("ErrorMsg.MOLECULE_HAS_NO_CTAB_TO_OUTPUT")),!1):(e.error(e.$L("ErrorMsg.CAN_NOT_WRITE_NON_MOLECULE_TO_MOL")),!1)}},e.IO.MdlStructureUtils={fillFragment:function(t,r,i){if(t.clear(),r){var n;if(n=i&&i!=e.CoordMode.UNKNOWN?i==e.CoordMode.COORD3D:r.atomInfos.isCoord3D,r.atomInfos)for(var a=0,o=r.atomInfos.length;a<o;++a){var s=r.atomInfos[a];if(s){var l=e.IO.MdlStructureUtils.createStructureNode(t,s,n);l?t.appendNode(l):e.raise(e.$L("ErrorMsg.MDL_CTAB_ATOM_CANNOT_CREATE"))}}if(r.bondInfos)for(var a=0,o=r.bondInfos.length;a<o;++a){var s=r.bondInfos[a];if(s){var d=e.IO.MdlStructureUtils.createStructureConnector(t,s);d?t.appendConnector(d):e.raise(e.$L("ErrorMsg.MDL_CTAB_BOND_CANNOT_CREATE"))}}if(r.sgInfos&&r.sgInfos.length){for(var u=[],a=0,o=r.sgInfos.length;a<o;++a){var s=r.sgInfos[a];if(s&&"SUP"==s.sgType){for(var c=[],h=0,m=s.atomIndexes.length;h<m;++h)c.push(t.getNodeAt(s.atomIndexes[h]));c.length&&u.push({atoms:c,text:s.label})}}for(var a=0,o=u.length;a<o;++a){var c=u[a].atoms;if(c.length){var g=t.marshalSubFragment(c,new e.SubGroup),f=u[a].text;g.setFormulaText&&f.match(/.+\d/)?g.setFormulaText(u[a].text):g.setAbbr(u[a].text)}}}}return t},createStructureNode:function(t,r,i){var n;if(r.atomListInfo||e.IO.MdlUtils.isAtomListSymbol(r.symbol)){n=new e.VariableAtom;var a=[];r.atomListInfo&&r.atomListInfo.symbols&&(a=a.concat(r.atomListInfo.symbols),r.atomListInfo.isAllowList?n.setAllowedIsotopeIds(a):n.setDisallowedIsotopeIds(a))}else if(e.IO.MdlUtils.isRGroupSymbol(r.symbol))n=new e.RGroup;else if(e.IO.MdlUtils.isHeteroAtomSymbol(r.symbol))n=new e.Pseudoatom(null,e.PseudoatomType.HETERO);else if(e.IO.MdlUtils.isUnspecifiedAtomSymbol(r.symbol))n=new e.Pseudoatom(null,e.PseudoatomType.ANY);else{var o=e.ChemicalElementsDataUtil.getElementInfo(r.symbol);if(o){var s=null;if(r.massNumber)s=r.massNumber;else if(r.massDiff&&o){var l=o.naturalMass,s=Math.round(l+r.massDiff),d=e.IsotopesDataUtil.getIsotopeInfo(o.atomicNumber,s);d||(s=Math.floor(l+r.massDiff),d=e.IsotopesDataUtil.getIsotopeInfo(o.atomicNumber,s)),d||(s=Math.ceil(l+r.massDiff),d=e.IsotopesDataUtil.getIsotopeInfo(o.atomicNumber,s)),d||(s=null)}n=new e.Atom(null,r.symbol,s)}else{var u=e.IsotopesDataUtil.getIsotopeInfo(r.symbol);n=u?new e.Atom(null,u.atomicNumber,u.massNumber):new e.Pseudoatom(null,e.PseudoatomType.ANY)}}return r.charge&&n.setCharge(r.charge),r.radical&&n.setRadical(r.radical),r.parity&&n.setParity&&n.setParity(r.parity),void 0!==r.hydrongenCount&&n.setExplicitHydrogenCount&&n.setExplicitHydrogenCount(r.hydrongenCount),i?n.setCoord3D({x:r.x,y:r.y,z:r.z}):n.setCoord2D({x:r.x,y:r.y}),n},createStructureConnector:function(t,r){var i=t.getNodeAt(r.atomIndex1),n=t.getNodeAt(r.atomIndex2);if(i&&n){var a=[i,n];if(r.endAtomIndexes)for(var o=0,s=r.endAtomIndexes.length;o<s;++o){var l=t.getNodeAt(r.endAtomIndexes[o]);l&&a.push(l)}var d=new e.Bond(null,a,r.order);return void 0!==r.stereo&&d.setStereo(r.stereo),d}return null},isNodeVariableAtom:function(t){return t instanceof e.VariableAtom},getAtomTypeStr:function(t,r){if(t instanceof e.Atom)return t.getSymbol();if(!(t instanceof e.Pseudoatom)){if(t instanceof e.RGroup)return e.IO.MDL.SYMBOL_RGROUP;if(t instanceof e.VariableAtom){if(r)return e.IO.MDL.SYMBOL_ATOMLIST;var i="[",n=t.getAllowedIsotopeIds();if(n&&n.length||(i="NOT[",n=t.getDisallowedIsotopeIds()),n&&n.length){for(var a=[],o=0,s=n.length;o<s;++o){var l=e.IsotopesDataUtil.getIsotopeIdDetail(n[o]);l&&l.symbol&&a.push(l.symbol)}return i=i+a.join(",")+"]"}return e.IO.MDL.SYMBOL_ATOMLIST}return"?"}switch(t.getAtomType()){case e.PseudoatomType.ANY:return e.IO.MDL.SYMBOL_ANYATOM;case e.PseudoatomType.HETERO:return e.IO.MDL.SYMBOL_HETEROATOM;default:return e.IO.MDL.SYMBOL_DUMMYATOM}},getMoleculeCtabStructureInfo:function(t){var r={};r.atoms=t.getLeafNodes(),r.bonds=t.getAllChildConnectors(),r.subGroups=t.getSubFragments();for(var i=0,n=0,a=0,o=r.atoms.length;a<o;++a)r.atoms[a].hasCoord3D()&&++n,r.atoms[a].hasCoord2D()&&++i;return r.coordMode=i>n?e.CoordMode.COORD2D:e.CoordMode.COORD3D,r},splitConnectedNodes:function(t){for(var r={primaryNodes:[]},i=0,n=t.getConnectedObjs(),a=0,o=n.length;a<o;++a)n[a]instanceof e.ChemStructureNode&&(i<2?(r.primaryNodes.push(n[a]),++i):(r.remainNodes||(r.remainNodes=[]),r.remainNodes.push(n[a])));return r},generateClassicStyleCountLine:function(t,r){if(r==e.IO.MdlVersion.V3000)return"  0  0  0     0  0              0 V3000";var i="";i+=t.atoms.length.toString().lpad(3),i+=t.bonds.length.toString().lpad(3),i+="0".lpad(3),i+="0".lpad(3),i+="0".lpad(3),i+="0".lpad(3);for(var n=0;n<4;++n)i+="0".lpad(3);return i+="999",i+=e.IO.MDL.VER2000.lpad(6)}},e.IO.MdlBlockHandler=i.create(n,{CLASS_NAME:"Kekule.IO.MdlBlockHandler",initProperties:function(){this.defineProp("textBuffer",{dataType:"Kekule.TextLinesBuffer",serializable:!1,getter:function(){var e=this.getPropStoreFieldValue("textBuffer");return e||(e=this.createTextBuffer(),this.setPropStoreFieldValue("textBuffer",e)),e},setter:null})},createTextBuffer:function(){return new e.TextLinesBuffer}}),e.IO.MdlBlockReader=i.create(e.IO.MdlBlockHandler,{CLASS_NAME:"Kekule.IO.MdlBlockReader",readBlock:function(e,t){return"string"==typeof e?this.getTextBuffer().setText(e):this.getTextBuffer().setLines(e),this.getTextBuffer().reset(),this.doReadBlock(this.getTextBuffer())},doReadBlock:function(e,t){}}),e.IO.MdlBlockWriter=i.create(e.IO.MdlBlockHandler,{CLASS_NAME:"Kekule.IO.MdlBlockWriter",writeBlock:function(e){return this.getTextBuffer().clear(),this.doWriteBlock(e,this.getTextBuffer()),this.getTextBuffer().getText()},doWriteBlock:function(e,t){}}),e}},function(e,t,r){"use strict";var i=r(0).Class,n=(r(0).ObjectEx,r(0).DataType);r(1).XmlUtility;e.exports=function(e){return e.IO.Mdl2kUtils={atomLineChargeToKekule:function(e){switch(e){case 1:return 3;case 2:return 2;case 3:return 1;case 5:return-1;case 6:return-2;case 7:return-3;default:return 0}},chargeToMdlAtomLineValue:function(e){switch(e){case 1:return 3;case 2:return 2;case 3:return 1;case-1:return 5;case-2:return 6;case-3:return 7;default:return 0}},atomLineChargeToRadical:function(t){return 4==t?e.RadicalOrder.DOUBLET:0},radicalToMdlAtomLineValue:function(t){return t==e.RadicalOrder.DOUBLET?4:0},chargeOrRadicalToMdlAtomLineValue:function(t,r){return t?e.IO.Mdl2kUtils.chargeToMdlAtomLineValue(t):r?e.IO.Mdl2kUtils.radicalToMdlAtomLineValue(t):0},bondStereoToKekule:function(t,r){if(r==e.BondOrder.SINGLE)switch(t){case 1:return e.BondStereo.UP;case 4:return e.BondStereo.UP_OR_DOWN;case 6:return e.BondStereo.DOWN;default:return e.BondStereo.NONE}else{if(r!=e.BondOrder.DOUBLE)return e.BondStereo.NONE;switch(t){case 3:return e.BondStereo.E_Z_BY_COORDINATES;default:return e.BondStereo.NONE}}},bondStereoToMdlBondLineValue:function(t,r,i){var n=e.BondStereo,a={};if(r==e.BondOrder.SINGLE)if(i&&[n.UP_INVERTED,n.DOWN_INVERTED].indexOf(t)>=0&&(a.inverted=!0),a.inverted)t===n.UP_INVERTED?a.stereo=1:t===n.DOWN_INVERTED&&(a.stereo=6);else switch(t){case n.DOWN_INVERTED:case n.UP:a.stereo=1;break;case n.UP_INVERTED:case n.DOWN:a.stereo=6;break;case n.UP_OR_DOWN_INVERTED:case n.UP_OR_DOWN:a.stereo=4;break;default:a.stereo=0}else if(r==e.BondOrder.DOUBLE)switch(t){case e.BondStereo.E_Z_BY_COORDINATES:a.stereo=3;break;default:a.stereo=0}else a.stereo=0;return a},coordToStr:function(e){return(e||0).toFixed(4)},getMassDiff:function(t){var r=e.ChemicalElementsDataUtil.getElementInfo(t.getAtomicNumber()),i=r.naturalMass;return Math.round(t.getMassNumber()-i)},getAtomListPropLineValue:function(t){var r="",i=t.getAllowedIsotopeIds();if(i&&i.length?r=" F ":(r=" T ",i=t.getDisallowedIsotopeIds()),i&&i.length){for(var n=[],a=0,o=i.length;a<o;++a){var s=e.IsotopesDataUtil.getIsotopeIdDetail(i[a]);s&&s.symbol&&n.push(s.symbol.rpad(4))}var l=n.join("");return r=n.length.toString().lpad(3)+r+l}return null},getCtabPropLineTag:function(e,t){return(t||"M")+"  "+e},getCtabPropLineCountTag:function(e,t,r){var i=(r||"M")+"  "+e;return t&&(i+=t.toString().lpad(3)),i},generateCtabPropLine:function(t,r,i,n){return e.IO.Mdl2kUtils.getCtabPropLineCountTag(r,i,n)+" "+t.join(" ")}},e.IO.Mdl2kCTabReader=i.create(e.IO.MdlBlockReader,{CLASS_NAME:"Kekule.IO.Mdl2kCTabReader",doReadBlock:function(e,t){return this.analysisCTab(e)},analysisCTab:function(e){var t={},r=e.readLine(),i=this.analysisCountLine(r),n=[];n.isCoord3D=!1;for(var a=0;a<i.atomCount;++a){r=e.readLine();var o=this.analysisAtomLine(r);o.z&&(n.isCoord3D=!0),n.push(o)}for(var s=[],a=0;a<i.bondCount;++a){r=e.readLine();var l=this.analysisBondLine(r);s.push(l)}for(var a=0;a<i.atomListCount;++a){r=e.readLine();var d=this.analysisAtomListInfoLine(r);n[d.atomIndex]&&(n[d.atomIndex].atomListInfo=d)}for(var a=0;a<i.stextCount;++a)r=e.readLine(),r=e.readLine();for(var u=[];!e.eof();){r=e.readLine();var c=this.analysisPropertyLine(r,n,u);if("END"===c.prop)break;if("SKP"===c.prop)for(var a=0;a<c.count&&!e.eof();++a)r=e.readLine();else if("A"===c.leading){if(e.eof())break;var h=c.atomIndex;r=e.readLine(),n[h].symbol=r.trim()}}return t.countInfo=i,t.atomInfos=n,t.bondInfos=s,t.sgInfos=u,t},analysisCountLine:function(t){var r={},i=t.substr(33,6).trim();return i&&i!=e.IO.MDL.VER2000?(e.error(e.$L("ErrorMsg.NOT_MDL2000_FORMAT_DATA")),null):(i=t.substr(0,3),r.atomCount=parseInt(i,10),i=t.substr(3,3),r.bondCount=parseInt(i,10),i=t.substr(12,3),r.isChiral=0!=parseInt(i,10),i=t.substr(15,3),r.stextCount=parseInt(i,10),r)},analysisAtomLine:function(t){var r={},i=t.substr(0,10);r.x=parseFloat(i),i=t.substr(10,10),r.y=parseFloat(i),i=t.substr(20,10),r.z=parseFloat(i),i=t.substr(31,3),r.symbol=i.trim(),i=t.substr(34,2),r.massDiff=parseInt(i,10),i=t.substr(36,3);var n=parseInt(i,10),a=e.IO.Mdl2kUtils.atomLineChargeToRadical(n);a?r.radical=a:r.charge=e.IO.Mdl2kUtils.atomLineChargeToKekule(n),i=t.substr(39,3);var n=parseInt(i,10);n&&(r.parity=n),i=t.substr(42,3);var n=parseInt(i,10);return n>0&&(r.hydrongenCount=n-1),r},analysisBondLine:function(t){var r={},i=t.substr(0,3);r.atomIndex1=parseInt(i,10)-1,i=t.substr(3,3),r.atomIndex2=parseInt(i,10)-1,i=t.substr(6,3),r.order=e.IO.MdlUtils.bondTypeToKekuleOrder(parseInt(i,10)),i=t.substr(9,3);var n=e.IO.Mdl2kUtils.bondStereoToKekule(parseInt(i,10),r.order);return n&&(r.stereo=n),r},analysisAtomListInfoLine:function(e){var t={},r=e.substr(0,3);t.atomIndex=parseInt(r,10)-1,r=e.substr(4,1),t.isAllowList="f"==r.toLowerCase(),r=e.substr(9,1);var i=Math.min(parseInt(r,10),5);t.atomicNumbers=[];for(var n=11,a=0;a<i;++a){n+=4*a,r=e.substr(n,3);var o=parseInt(r,10);o&&t.atomicNumbers.push(o)}return t},analysisPropertyLine:function(t,r,i){var n={},a=t.substr(0,1);if(n.leading=a,"M"==a){var o=t.substr(3,3).trim();n.prop=o;var s,l,d;if("END"===o)return n;if(["CHG","RAD","ISO"].indexOf(o)>=0){var u=parseInt(t.substr(6,3).trim());n.entryCount=u,n.entries=[];for(var c="CHG"===o?"charge":"RAD"===o?"radical":"massNumber",h=10,m=0;m<u;++m){var s=parseInt(t.substr(h,3).trim(),10)-1,g=parseInt(t.substr(h+4,3).trim(),10);h+=8,n.entries.push({atomIndex:s,propName:g}),r[s][c]=g}}else["STY","SLB"].indexOf(o)>=0?(l=parseInt(t.substr(10,3),10)-1,d=i[l]):["SAL","SBL","SMT","SCL","SAP","SBV"].indexOf(o)>=0&&(l=parseInt(t.substr(7,3),10)-1,d=i[l]);switch(o){case"ALS":var f={},p=t.substr(7,3).trim();f.atomIndex=parseInt(p,10)-1,n.atomIndex=f.atomIndex;var C=parseInt(t.substr(10,3)),b=t.substr(14,1);f.isAllowList="f"==b.toLowerCase(),f.symbols=[];for(var m=0;m<C;++m)b=t.substr(16+4*m,4).trim(),f.symbols.push(b);n.atomListInfo=f;var E=r[f.atomIndex].atomListInfo;E?E.isAllowList!==f.isAllowList?r[f.atomIndex].atomListInfo=f:E.symbols=e.ArrayUtils.pushUnique(E.symbols,f.symbols):r[f.atomIndex].atomListInfo=f;break;case"STY":"SUP"==t.substr(14,3)&&(i[l]={sgType:"SUP"});break;case"SLB":d&&(d.labelId=t.substr(14).trim());break;case"SAL":if(d){var N=parseInt(t.substr(10,3));d.atomIndexes||(d.atomIndexes=[]);for(var m=0;m<N;++m){var b=t.substr(14+4*m,3),s=parseInt(b)-1;d.atomIndexes.push(s)}}break;case"SBL":if(d&&"SUP"==d.sgType){var T=parseInt(t.substr(10,3));d.crossBondIndexes||(d.crossBondIndexes=[]);for(var m=0;m<T;++m){var b=t.substr(14+4*m,3),O=parseInt(b)-1;d.crossBondIndexes.push(O)}}break;case"SMT":d&&("SUP"==d.sgType?d.label=t.substr(11).trim():d.subscript=t.substr(11).trim());break;case"SCL":d&&(d.sgClass=t.substr(11).trim());break;case"SBV":if(d){var _=parseInt(t.substr(11,3),10)-1;d.bondVectors||(d.bondVectors=[]),d.bondVectors[_]={bondIndex:_,x:parseFloat(t.substr(14,10)),y:parseFloat(t.substr(24,10))};var S=t.substr(34,10).trim();S&&(d.bondVectors[_].z=parseFloat(S)||0)}}}else if("A"===a){var h=3,s=parseInt(t.substr(h,3).trim(),10)-1;n.atomIndex=s}else if("V"===a);else if("G"===a);else if("S"===a){var o=t.substr(3,3).trim();n.prop=o,n.count=parseInt(t.substr(6,3),10)}return n}}),e.IO.Mdl2kCTabWriter=i.create(e.IO.MdlBlockWriter,{CLASS_NAME:"Kekule.IO.Mdl2kCTabWriter",initialize:function($super,t){$super(),this.setCoordMode(t||e.CoordMode.UNKNOWN)},initProperties:function(){this.defineProp("coordMode",{dataType:n.INT,deaultValue:e.CoordMode.UNKNOWN})},doWriteBlock:function(t,r){return e.IO.MdlUtils.assertIlegalForCtabOutput(t),this.outputCtab(t,r)},outputCtab:function(t,r){var i=[],n=e.IO.MdlStructureUtils.getMoleculeCtabStructureInfo(t);if(this.getCoordMode()!=e.CoordMode.UNKNOWN&&(n.coordMode=this.getCoordMode()),r.writeLine(this.generateCountLine(n)),this.outputAtomBlock(t,n,r,i),this.outputBondBlock(t,n,r),i.length)for(var a=0,o=i.length;a<o;++a)r.writeLine(i[a]);this.outputSubgroupsPropLines(t,n,r),r.writeLine(e.IO.Mdl2kUtils.getCtabPropLineTag("END"))},generateCountLine:function(t){return e.IO.MdlStructureUtils.generateClassicStyleCountLine(t,e.IO.MdlVersion.V2000)},outputAtomBlock:function(e,t,r,i){for(var n=0,a=t.atoms.length;n<a;++n){var o=t.atoms[n],s=this.generateAtomLine(n,t.coordMode,o,i);r.writeLine(s)}},generateAtomLine:function(t,r,i,n){var a=e.IO.Mdl2kUtils.coordToStr,o="",s=(t+1).toString().lpad(3),l=r==e.CoordMode.COORD3D?i.getAbsCoord3D():i.getAbsCoord2D();if(o+=a(l.x).lpad(10)+a(l.y).lpad(10)+a(l.z).lpad(10),o+=" "+e.IO.MdlStructureUtils.getAtomTypeStr(i,!0).rpad(3),e.IO.MdlStructureUtils.isNodeVariableAtom(i)){var d=e.IO.Mdl2kUtils.getAtomListPropLineValue(i);if(d){var u=e.IO.Mdl2kUtils.getCtabPropLineTag("ALS")+" "+s+d;n.push(u)}}if(i.getMassNumber&&i.getMassNumber()){o+=(e.IO.Mdl2kUtils.getMassDiff(i.getIsotope())||0).toString().lpad(2);var u=e.IO.Mdl2kUtils.generateCtabPropLine([s,i.getMassNumber().toString().lpad(3)],"ISO",1);n.push(u)}else o+="0".lpad(2);if(o+=e.IO.Mdl2kUtils.chargeOrRadicalToMdlAtomLineValue(i.getCharge?i.getCharge():null,i.getRadical?i.getRadical():null).toString().lpad(3),i.getCharge&&i.getCharge()){var u=e.IO.Mdl2kUtils.generateCtabPropLine([s,i.getCharge().toString().lpad(3)],"CHG",1);n.push(u)}if(i.getRadical&&i.getRadical()){var u=e.IO.Mdl2kUtils.generateCtabPropLine([s,e.IO.MdlUtils.kekuleRadicalToMdl(i.getRadical()).toString().lpad(3)],"RAD",1);n.push(u)}o+=(i.getParity?i.getParity()||0:0).toString().lpad(3);var c=i.getExplicitHydrogenCount?i.getExplicitHydrogenCount():null;o+=(e.ObjUtils.isUnset(c)?"0":(c+1).toString()).lpad(3);for(var h=0,m="0".lpad(3);h<8;++h)o+=m;return o},outputBondBlock:function(e,t,r){for(var i=0,n=t.bonds.length;i<n;++i){var a=t.bonds[i],o=this.generateBondLine(i,a,t.atoms);r.writeLine(o)}},generateBondLine:function(t,r,i){var n,a,o="";r.getStereo&&r.getBondOrder?(a=e.IO.Mdl2kUtils.bondStereoToMdlBondLineValue(r.getStereo(),r.getBondOrder(),!0),n=a.stereo.toString().lpad(3)):(a={},n+="0".lpad(3));var s=e.IO.MdlStructureUtils.splitConnectedNodes(r);l=(i.indexOf(s.primaryNodes[0])+1).toString().lpad(3),d=(i.indexOf(s.primaryNodes[1])+1).toString().lpad(3);var l,d;return a&&a.inverted?o+=d+l:o+=l+d,r.getBondOrder?o+=e.IO.MdlUtils.kekuleBondOrderToMdlType(r.getBondOrder()).toString().lpad(3):o+="0".lpad(3),o+=n,o+="0".lpad(3),o+="0".lpad(3),o+="0".lpad(3)},outputSubgroupsPropLines:function(e,t,r){for(var i=0,n=t.subGroups.length;i<n;++i)for(var a=this.generateSgroupLines(i,t.subGroups[i],t),o=0,s=a.length;o<s;++o)r.writeLine(a[o])},generateSgroupLines:function(t,r,i){var n=[],a=(t+1).toString().lpad(3),o=e.IO.Mdl2kUtils.generateCtabPropLine([a,"SUP"],"STY",1);n.push(o),o=e.IO.Mdl2kUtils.generateCtabPropLine([a,a],"SLB",1),n.push(o);var s=r.getAbbr&&r.getAbbr()||r.getFormulaText&&r.getFormulaText()||r.getName&&r.getName();s&&(o=e.IO.Mdl2kUtils.generateCtabPropLine([a,s],"SMT"),n.push(o));for(var l=[],d=r.getLeafNodes(),u=0,c=d.length;u<c;++u){var t=i.atoms.indexOf(d[u]);t>=0&&l.push((t+1).toString().lpad(3))}l=l.sort();for(var h=e.ArrayUtils.divide(l,15),u=0,c=h.length;u<c;++u){var m=h[u];o=e.IO.Mdl2kUtils.getCtabPropLineTag("SAL")+" "+a+m.length.toString().lpad(3)+" "+m.join(" "),n.push(o)}for(var g=r.getCrossConnectors(),f=[],p=[],C=e.IO.Mdl2kUtils.coordToStr,u=0,c=g.length;u<c;++u){var t=i.bonds.indexOf(g[u]);if(t>=0){f.push((t+1).toString().lpad(3));var b=[t+1],E=e.IO.MdlStructureUtils.splitConnectedNodes(g[u]),d=E.primaryNodes,N={};2==d.length&&(i.coordMode==e.CoordMode.COORD2D?(N=e.CoordUtils.substract(d[0].getAbsCoord2D(),d[1].getAbsCoord2D()),b=b.concat([C(N.x).lpad(10),C(N.y).lpad(10)])):(N=e.CoordUtils.substract(d[0].getAbsCoord3D(),d[1].getAbsCoord3D()),b=b.concat([C(N.x),C(N.y),C(N.z)]))),p.push(b)}}f=f.sort();for(var T=e.ArrayUtils.divide(f,15),u=0,c=T.length;u<c;++u){var O=T[u];o=e.IO.Mdl2kUtils.getCtabPropLineTag("SBL")+" "+a+O.length.toString().lpad(3)+" "+O.join(" "),n.push(o)}for(var u=0,c=p.length;u<c;++u){var _=p[u].shift(),S=p[u].join("");o=e.IO.Mdl2kUtils.getCtabPropLineTag("SBV")+" "+a+" "+_.toString().lpad(3)+S,n.push(o)}return n}}),e}},function(e,t,r){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=r(0).Class,a=(r(0).ObjectEx,r(0).DataType);r(1).XmlUtility;e.exports=function(e){return e.IO.Mdl3kUtils={get3kBlockStartTag:function(e){return"BEGIN "+e.toUpperCase()},get3kBlockEndTag:function(e){return"END "+e.toUpperCase()},isAtomList:function(e){var t=/\[.+\]/;return e.search(t)>=0},analysisAtomList:function(e){var t=/\[(.+)\]/g,r=t.exec(e);if(r&&r.length>=2){r=r[1].split(",");var i={};i.isAllowList=!(0==e.trim().indexOf("NOT")),i.symbols=[];for(var n=0,a=r.length;n<a;++n)i.symbols.push(r[n].trim());return i}return null},bondCfgToKekule:function(t){switch(t){case 0:return e.BondStereo.NONE;case 1:return e.BondStereo.UP;case 2:return e.BondStereo.UP_OR_DOWN;case 3:return e.BondStereo.DOWN;default:return e.BondStereo.NONE}},bondStereoToMdlCfg:function(t,r){var i=e.BondStereo,n={};if(r&&[i.UP_INVERTED,i.DOWN_INVERTED].indexOf(t)>=0&&(n.inverted=!0),n.inverted)t===i.UP_INVERTED?n.cfg=1:t===i.DOWN_INVERTED&&(n.cfg=3);else switch(t){case i.UP:case i.DOWN_INVERTED:n.cfg=1;break;case i.UP_OR_DOWN:n.cfg=2;break;case i.DOWN:case i.UP_INVERTED:n.cfg=3;break;default:n.cfg=0}return n},coordToStr:function(e){return(e||0).toFixed(6)}},e.IO.Mdl3kValueUtils={SEPARATOR:" ",KEYVALUE_CONNECTOR:"=",STR_QUOTE:'"',ESC_QUOTE:'""',VALUELIST_PATTERN:/\(.+\)/g,split:function(t,r){for(var i=r||e.IO.Mdl3kValueUtils.SEPARATOR,n=e.IO.Mdl3kValueUtils.STR_QUOTE,a=[],o=!1,s=!1,l=!1,d="",u=0,c=t.length;u<c;++u){var h=t.charAt(u);h==n?!o&&t.charAt(u+1)==n||o&&t.charAt(u-1)==n||(o=!o):"["==h?s=!0:"]"==h?s=!1:"("==h?l=!0:")"==h&&(l=!1),h==i?o||s||l||!d?d+=h:(a.push(d),d=""):d+=h}return d&&a.push(d),a},merge:function(t,r){var i=r||e.IO.Mdl3kValueUtils.SEPARATOR;return t.join(i)},isKeyValuePair:function(t){return t.indexOf(e.IO.Mdl3kValueUtils.KEYVALUE_CONNECTOR)>=0},splitKeyValue:function(t){var r={},i=e.IO.Mdl3kValueUtils.KEYVALUE_CONNECTOR,n=t.indexOf(i);return n<0?r.value=t:(r.key=t.substr(0,n),r.value=t.substr(n+i.length)),r},mergeKeyValue:function(t,r){return r?""+r+e.IO.Mdl3kValueUtils.KEYVALUE_CONNECTOR+t:t},isValueList:function(t){return t.search(e.IO.Mdl3kValueUtils.VALUELIST_PATTERN)>=0},splitValueList:function(t){var r=/\((.+)\)/,i=r.exec(t);if(i&&i.length>1){var n=i[1],a=e.IO.Mdl3kValueUtils.split(n);return a.shift(),a}return[t]},mergeValueList:function(t){for(var r="("+t.length,i=0,n=t.length;i<n;++i)r+=e.IO.Mdl3kValueUtils.SEPARATOR+t[i];return r+=")"},unquoteValue:function(t){var r=e.IO.Mdl3kValueUtils.STR_QUOTE,i=t.trim();i.substr(0,r.length)==r&&(i=i.substr(r.length)),i.substr(i.length-r.length)==r&&(i=i.substr(0,i.length-r.length));var n=new RegExp(r+r,"g");return i=i.replace(n,r),e.IO.Mdl3kValueUtils.isValueList(i)&&(i=e.IO.Mdl3kValueUtils.splitValueList(i)),i},quoteValue:function(t){var r=e.IO.Mdl3kValueUtils.STR_QUOTE,i=""+t,n=new RegExp(r,"g");return i=i.replace(n,r+r),i.indexOf(e.IO.Mdl3kValueUtils.SEPARATOR)>=0&&(i=r+i+r),i},splitValues:function(t){for(var r=[],i=e.IO.Mdl3kValueUtils.split(t),n=0,a=i.length;n<a;++n){var o=e.IO.Mdl3kValueUtils.splitKeyValue(i[n]);o.value&&(o.value=e.IO.Mdl3kValueUtils.unquoteValue(o.value)),r.push(o)}return r},mergeValues:function(t){for(var r,n=0,a=t.length;n<a;++n){var o,s,l=t[n];"object"!=(void 0===l?"undefined":i(l))||e.ArrayUtils.isArray(l)?s=l:(o=l.key,s=l.value);var d;d=e.ArrayUtils.isArray(s)?e.IO.Mdl3kValueUtils.mergeValueList(s):e.IO.Mdl3kValueUtils.quoteValue(s),o&&(d=e.IO.Mdl3kValueUtils.mergeKeyValue(d,o)),r=e.IO.Mdl3kValueUtils.appendToken(r,d)}return r},appendToken:function(t,r,i){var n=i||e.IO.Mdl3kValueUtils.SEPARATOR,a=t||"";return a&&a.substr(a.length-n.length,n.length)!=n?a+=e.IO.Mdl3kValueUtils.SEPARATOR+r:a=r,a}},e.IO.Mdl3kTextBuffer=n.create(e.TextLinesBuffer,{CLASS_NAME:"Kekule.Mdl3kTextBuffer",LEADING_TAG:"M  V30 ",LINE_CONTI_MARK:"-",MAX_COL_WIDTH:80,initialize:function($super,e){$super(e)},isStartWithLeadingTag:function(e){return e.substr(0,this.LEADING_TAG.length)==this.LEADING_TAG},isEndWithContinueMark:function(e){var t=e.trim();return t.substr(t.length-this.LINE_CONTI_MARK.length)==this.LINE_CONTI_MARK},getLineWithout3kTag:function(e){var t=this.LEADING_TAG.length;return e.substr(0,t)==this.LEADING_TAG?e.substr(t):e},getLineAtEx:function(e){var t=this.getLineAt(e),r=1;if(t&&this.isEndWithContinueMark(t)&&this.isStartWithLeadingTag(this.getLines()[e])){var i=t.lastIndexOf(this.LINE_CONTI_MARK);t=t.substr(0,i);var n=this.getLineAtEx(e+1);t+=n.line,r+=n.lineCount}return{line:t,lineCount:r}},getLineAt:function($super,e){var t=$super(e);return this.getLineWithout3kTag(t)},readLine:function(){var e=this.getLineAtEx(this.getCurrLineNo());return this.incCurrLineNo(e.lineCount),e.line},writeLine:function($super,t,r){if(r)return $super(t);var i=t;this.isStartWithLeadingTag(t)||(i=this.LEADING_TAG+i);var n;if(i.length>this.MAX_COL_WIDTH){var a=this.LINE_CONTI_MARK,o=(e.IO.Mdl3kValueUtils.SEPARATOR,this.MAX_COL_WIDTH-a.length);n=i.substr(o),i=i.substr(0,o),i+=a}var s=$super(i);return n&&(s=this.writeLine(n,r)),s},writeLines:function($super,e,t){for(var r=0,i=e.length;r<i;++r)this.writeLine(e[r],t)},getBlockBuffer:function(t,r){var i,n=e.IO.Mdl3kUtils.get3kBlockStartTag(t),a=e.IO.Mdl3kUtils.get3kBlockEndTag(t),o=this.getCurrLineNo();this.reset();for(var s=this.readLine().trim();s!=n&&!this.eof();)s=this.readLine().trim();if(this.eof())i=null;else{for(var l=this.getCurrLineNo(),d=this.getCurrLineNo(),s=this.readLine().trim();s!=a&&!this.eof();)d=this.getCurrLineNo(),s=this.readLine().trim();if(s==a)var u=this.getLines().slice(l,d);else var u=this.getLines().slice(l);i=new e.IO.Mdl3kTextBuffer(u)}return r&&this.setCurrLineNo(o),i}}),e.IO.Mdl3kBlockReader=n.create(e.IO.MdlBlockReader,{CLASS_NAME:"Kekule.IO.Mdl3kBlockReader",createTextBuffer:function(){return new e.IO.Mdl3kTextBuffer},doReadBlock:function(t,r){var i,n=!(t instanceof e.IO.Mdl3kTextBuffer);n?(i=new e.IO.Mdl3kTextBuffer,i.setLines(t.getUnreadLines()),i.reset()):i=t;var a=i.getCurrLineNo(),o=this.doRead3kBlock(i,r),s=i.getCurrLineNo();if(n){var l=s-a;t.incCurrLineNo(l)}return o},doRead3kBlock:function(e,t){}}),e.IO.Mdl3kBlockWriter=n.create(e.IO.MdlBlockWriter,{CLASS_NAME:"Kekule.IO.Mdl3kBlockWriter",createTextBuffer:function(){return new e.IO.Mdl3kTextBuffer},writeStartTag:function(t,r){r.writeLine(e.IO.Mdl3kUtils.get3kBlockStartTag(t))},writeEndTag:function(t,r){r.writeLine(e.IO.Mdl3kUtils.get3kBlockEndTag(t))},doWriteBlock:function(t,r){var i,n=!(r instanceof e.IO.Mdl3kTextBuffer);n?(i=new e.IO.Mdl3kTextBuffer,i.setLines(r.getUnreadLines()),i.reset()):i=r;var a=this.doWrite3kBlock(t,i);return n&&r.appendLines(n.getLines()),a},doWrite3kBlock:function(e,t){}}),e.IO.Mdl3kCTabReader=n.create(e.IO.Mdl3kBlockReader,{CLASS_NAME:"Kekule.IO.Mdl3kCTabReader",doRead3kBlock:function(e,t){var r=e.getBlockBuffer("CTAB");return r||(r=e),this.analysisCTab(r)},analysisCTab:function(t){var r={},i=t.readLine(),n=this.analysisCountLine(i);if(!n)return null;var a,o=[],s=t.getBlockBuffer("ATOM");if(!s)return e.raise(e.$L("ErrorMsg.MDL3000_ATOMBLOCK_NOT_FOUND")),null;a=this.analysisAtomBlock(s,o);var l,d=t.getBlockBuffer("BOND");d&&(l=this.analysisBondBlock(d,o));var u,c=t.getBlockBuffer("SGROUP");return c&&(u=this.analysisSGroupBlock(c,o)),r.countInfo=n,r.atomInfos=a,r.atomIndexMap=o,l&&(r.bondInfos=l),u&&(r.sgInfos=u),r},analysisCountLine:function(t){var r={},i=e.IO.Mdl3kValueUtils.splitValues(t);if("COUNTS"!=i.shift().value)return void e.raise(e.$L("ErrorMsg.MALFORMED_MDL3000_COUNTLINE"));var n=i.shift().value;return r.atomCount=parseInt(n,10),n=i.shift().value,r.bondCount=parseInt(n,10),n=i.shift().value,r.sgroupCount=parseInt(n,10),n=i.shift().value,r.isChiral=0!=parseInt(n,10),r},analysisAtomBlock:function(t,r){for(var i=e.CoordMode.COORD2D,n=[];!t.eof();){var a=t.readLine(),o=this.analysisAtomLine(a),s=n.push(o)-1;r[o.index]=s,o.z&&(i=e.CoordMode.COORD3D)}return n.coordMode=i,n.isCoord3D=i==e.CoordMode.COORD3D,n},analysisAtomLine:function(t,r){var i={},n=e.IO.Mdl3kValueUtils.splitValues(t);i.index=parseInt(n.shift().value,10);var a=n.shift().value.trim();if(e.IO.Mdl3kUtils.isAtomList(a)){var o=e.IO.Mdl3kUtils.analysisAtomList(a);o&&(i.atomListInfo=o,i.symbol="L")}else i.symbol=a;i.x=parseFloat(n.shift().value),i.y=parseFloat(n.shift().value),i.z=parseFloat(n.shift().value),n.shift();for(var s=0,l=n.length;s<l;++s){var d=n[s],u=d.key,c=d.value;switch(u){case"CHG":var h=parseInt(c,10);h&&(i.charge=h);break;case"RAD":var h=parseInt(c,10);h&&(i.radical=h);break;case"CFG":var h=parseInt(c,10);h&&(i.parity=h);break;case"MASS":i.massNumber=parseFloat(c);break;case"VAL":break;case"HCOUNT":var h=parseInt(c,10);h&&(i.hydrongenCount=-1==h?0:h-1);break;case"RGROUPS":var h=parseInt(c,10);h&&(i.rgroupCount=h)}}return i},analysisBondBlock:function(e,t){for(var r=[];!e.eof();){var i=e.readLine(),n=this.analysisBondLine(i,t);r[n.index]=n}return r},analysisBondLine:function(t,r){var i={},n=e.IO.Mdl3kValueUtils.splitValues(t);i.index=parseInt(n.shift().value,10);var a=n.shift().value;i.order=e.IO.MdlUtils.bondTypeToKekuleOrder(parseInt(a,10)),i.atomIndex1=r[parseInt(n.shift().value,10)],i.atomIndex2=r[parseInt(n.shift().value,10)];for(var o=0,s=n.length;o<s;++o){var l=n[o].key,d=n[o].value;switch(l){case"CFG":var u=parseInt(d,10);i.stereo=e.IO.Mdl3kUtils.bondCfgToKekule(u);break;case"ENDPTS":if(e.ArrayUtils.isArray(d)){i.endAtomIndexes=[];for(var c=0,h=d.length;c<h;++c)i.endAtomIndexes.push(r[parseInt(d[c],10)])}else i.endAtomIndexes=[r[parseInt(d,10)]]}}return i},analysisSGroupBlock:function(t,r){var i=[],n=null,a=t.getCurrLineNo(),o=t.readLine(),s=e.IO.Mdl3kValueUtils.splitValues(o);for("DEFAULT"==s.shift().value?n=this.fetchSGroupOptionalValues(o,r):t.setCurrLineNo(a);!t.eof();){o=t.readLine();var l=this.analysisSGroupLine(o,r,n);i[l.index]=l}return i},analysisSGroupLine:function(t,r,i){var n={},a=e.IO.Mdl3kValueUtils.splitValues(t);n.index=parseInt(a.shift().value,10),n.sgType=a.shift().value.trim(),n.extIndex=parseInt(a.shift().value,10);var o=this.fetchSGroupOptionalValues(a,r);return i&&(o=Object.extend(i,o)),n=Object.extend(n,o)},fetchSGroupOptionalValues:function(e,t){for(var r={},i=0,n=e.length;i<n;++i){var a=e[i].key,o=e[i].value;switch(a){case"ATOMS":r.atomIndexes=[];for(var s=0,l=o.length;s<l;s++)r.atomIndexes.push(t[o[s]]);break;case"XBONDS":r.crossBondIndexes=[].concat(o);break;case"SUBTYPE":r.subType=o;break;case"LABEL":r.label=o;break;case"CSTATE":r.bondVectors||(r.bondVectors=[]);var d=parseInt(o.shift(),10),u=parseFloat(o.shift())||0,c=parseFloat(o.shift())||0,h=parseFloat(o.shift())||0;r.bondVectors[d]={bondIndex:d,x:u,y:c,z:h};break;case"CLASS":r.sgClass=o}}return r}}),e.IO.Mdl3kCTabWriter=n.create(e.IO.Mdl3kBlockWriter,{CLASS_NAME:"Kekule.IO.Mdl3kCTabWriter",initialize:function($super,t){$super(),this.setCoordMode(t||e.CoordMode.UNKNOWN)},initProperties:function(){this.defineProp("coordMode",{dataType:a.INT,deaultValue:e.CoordMode.UNKNOWN})},doWrite3kBlock:function(t,r){return e.IO.MdlUtils.assertIlegalForCtabOutput(t),this.outputCtab(t,r)},outputCtab:function(t,r){var i=e.IO.MdlStructureUtils.getMoleculeCtabStructureInfo(t);this.writeStartTag("CTAB",r),this.getCoordMode()!=e.CoordMode.UNKNOWN&&(i.coordMode=this.getCoordMode()),r.writeLine(this.generateCountLine(i)),this.outputAtomBlock(t,i,r),this.outputBondBlock(t,i,r),this.outputSgroupBlock(t,i,r),this.writeEndTag("CTAB",r)},generateCompatibilityCountLine:function(t){return e.IO.MdlStructureUtils.generateClassicStyleCountLine(t,e.IO.MdlVersion.V3000)},generateCountLine:function(t){var r=["COUNTS"];return r.push(t.atoms.length),r.push(t.bonds.length),r.push(t.subGroups.length),r.push(0),r.push(0),e.IO.Mdl3kValueUtils.mergeValues(r)},outputAtomBlock:function(e,t,r){this.writeStartTag("ATOM",r);for(var i=0,n=t.atoms.length;i<n;++i){var a=t.atoms[i],o=this.generateAtomLine(i,t.coordMode,a);r.writeLine(o)}this.writeEndTag("ATOM",r)},generateAtomLine:function(t,r,i){var n=e.IO.Mdl3kUtils.coordToStr,a=[t+1,e.IO.MdlStructureUtils.getAtomTypeStr(i)];if(r==e.CoordMode.COORD2D){var o=i.getAbsCoord2D();a=a.concat([n(o.x),n(o.y),n(0)])}else{var o=i.getAbsCoord3D();a=a.concat([n(o.x),n(o.y),n(o.z)])}return a.push(0),i.getCharge&&i.getCharge()&&a.push({key:"CHG",value:i.getCharge()}),i.getRadical&&i.getRadical()&&a.push({key:"RAD",value:i.getRadical()}),i.getParity&&i.getParity()&&a.push({key:"CFG",value:i.getParity()}),i.getMassNumber&&i.getMassNumber()&&a.push({key:"MASS",value:i.getMassNumber()}),i.getExplicitHydrogenCount&&!e.ObjUtils.isUnset(i.getExplicitHydrogenCount())&&a.push({key:"HCOUNT",value:i.getExplicitHydrogenCount()+1}),e.IO.Mdl3kValueUtils.mergeValues(a)},outputBondBlock:function(e,t,r){if(!(t.bonds.length<=0)){this.writeStartTag("BOND",r);for(var i=0,n=t.bonds.length;i<n;++i){var a=t.bonds[i],o=this.generateBondLine(i,a,t.atoms);r.writeLine(o)}this.writeEndTag("BOND",r)}},generateBondLine:function(t,r,i){var n=[t+1,e.IO.MdlUtils.kekuleBondOrderToMdlType(r.getBondOrder?r.getBondOrder():e.BondOrder.UNSET)],a=r.getStereo&&r.getStereo()?e.IO.Mdl3kUtils.bondStereoToMdlCfg(r.getStereo(),!0):{},o=[],s=[],l=e.IO.MdlStructureUtils.splitConnectedNodes(r),d=i.indexOf(l.primaryNodes[0])+1,u=i.indexOf(l.primaryNodes[1])+1;if(o=a.inverted?[u,d]:[d,u],l.remainNodes&&l.remainNodes.length)for(var c=0,h=l.remainNodes.length;c<h;++c)s.push(i.indexOf(l.remainNodes[c])+1);return n=n.concat(o),a&&a.cfg&&n.push({key:"CFG",value:a.cfg}),s.length>0&&(n.push({key:"ENDPTS",value:s}),n.push({key:"ATTACH",value:"ALL"})),e.IO.Mdl3kValueUtils.mergeValues(n)},outputSgroupBlock:function(e,t,r){if(!(t.subGroups.length<=0)){this.writeStartTag("SGROUP",r);for(var i=0,n=t.subGroups.length;i<n;++i){var a=this.generateSgroupLine(i,t.subGroups[i],t);r.writeLine(a)}this.writeEndTag("SGROUP",r)}},generateSgroupLine:function(t,r,i){for(var n=i.atoms,a=i.bonds,o=[t+1,"SUP",t+1],s=[],l=r.getLeafNodes(),d=0,u=l.length;d<u;++d){var t=n.indexOf(l[d]);t>=0&&s.push(t+1)}s=s.sort(),o.push({key:"ATOMS",value:s});var c=r.getAbbr&&r.getAbbr()||r.getFormulaText&&r.getFormulaText()||r.getName&&r.getName();c&&o.push({key:"LABEL",value:c});for(var h=r.getCrossConnectors(),m=[],g=[],f=e.IO.Mdl3kUtils.coordToStr,d=0,u=h.length;d<u;++d){var t=a.indexOf(h[d]);if(t>=0){m.push(t+1);var p=[t+1],C=e.IO.MdlStructureUtils.splitConnectedNodes(h[d]),l=C.primaryNodes,b={};2==l.length&&(i.coordMode==e.CoordMode.COORD2D?(b=e.CoordUtils.substract(l[0].getAbsCoord2D(),l[1].getAbsCoord2D()),p=p.concat([f(b.x),f(b.y),0])):(b=e.CoordUtils.substract(l[0].getAbsCoord3D(),l[1].getAbsCoord3D()),p=p.concat([f(b.x),f(b.y),f(b.z)]))),g.push(p)}}m=m.sort(),o.push({key:"XBONDS",value:m});for(var d=0,u=g.length;d<u;++d)o.push({key:"CSTATE",value:g[d]});return e.IO.Mdl3kValueUtils.mergeValues(o)}}),e}},function(e,t,r){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=r(0).Class,a=(r(0).ObjectEx,r(0).DataType);r(1).XmlUtility;e.exports=function(e){return e.globalOptions.add("IO.mdl",{mdlVersion:e.IO.MdlVersion.V2000,coordMode:e.CoordMode.UNKNOWN}),e.IO.MdlStructureFragmentReader=n.create(e.IO.MdlBlockReader,{CLASS_NAME:"Kekule.IO.MdlStructureFragmentReader",initialize:function($super,t){$super(),this.setCoordMode(t||e.CoordMode.UNKNOWN)},initProperties:function(){this.defineProp("coordMode",{dataType:a.INT,defaultValue:e.CoordMode.UNKNOWN})},createFragment:function(e){},createCtabReader:function(t){return t==e.IO.MdlVersion.V3000?new e.IO.Mdl3kCTabReader:new e.IO.Mdl2kCTabReader},getCtabVersion:function(t){var r=t.getCurrLineNo(),i=t.readLine();t.setCurrLineNo(r);var n=i.substr(33,6).trim();return"V3000"==n?e.IO.MdlVersion.V3000:e.IO.MdlVersion.V2000},createStructureFromJson:function(t,r){var i=this.createFragment();return i&&e.IO.MdlStructureUtils.fillFragment(i,t,this.getCoordMode()),i},doReadBlock:function($super,e,t){var r=this.getCtabVersion(e);if(!r)return null;var i=this.createCtabReader(r),n=i.doReadBlock(e,t);return n.atomInfos.coordMode&&(this._forceCoordMode=n.atomInfos.coordMode),this.createStructureFromJson(n,t)}}),e.IO.MdlStructureFragmentWriter=n.create(e.IO.MdlBlockWriter,{CLASS_NAME:"Kekule.IO.MdlStructureFragmentWriter",initialize:function($super,t,r){$super(),this.setMdlVersion(t||e.IO.MdlVersion.V2000),this.setCoordMode(r||e.CoordMode.UNKNOWN)},initProperties:function(){this.defineProp("mdlVersion",{dataType:a.INT,defaultValue:e.IO.MdlVersion.V2000}),this.defineProp("coordMode",{dataType:a.INT,defaultValue:e.CoordMode.UNKNOWN})},createCtabWriter:function(t){return t==e.IO.MdlVersion.V3000?new e.IO.Mdl3kCTabWriter(this.getCoordMode()):new e.IO.Mdl2kCTabWriter(this.getCoordMode())},doWriteBlock:function($super,e,t){var r=this.createCtabWriter(this.getMdlVersion()),i=r.writeBlock(e);t.writeText(i)}}),e.IO.Mdl3kMoleculeCTabReader=n.create(e.IO.MdlStructureFragmentReader,{CLASS_NAME:"Kekule.IO.Mdl3kMoleculeCTabReader",createFragment:function(t){return new e.Molecule},doReadBlock:function($super,t,r){var i=this.createCtabReader(e.IO.MdlVersion.V3000),n=i.doReadBlock(t,r);return this.createStructureFromJson(n,r)}}),e.IO.Mdl3kMoleculeCTabWriter=n.create(e.IO.MdlStructureFragmentWriter,{CLASS_NAME:"Kekule.IO.Mdl3kMoleculeCTabWriter",initialize:function($super,t){$super(e.IO.MdlVersion.V3000,t)},doWriteBlock:function($super,t,r){var i=new e.IO.Mdl3kCTabWriter(this.getCoordMode()),n=i.writeBlock(t);r.writeText(n)}}),e.IO.MdlMoleculeReader=n.create(e.IO.MdlStructureFragmentReader,{CLASS_NAME:"Kekule.IO.MdlMoleculeReader",createFragment:function(t){return new e.Molecule},readHeaderInfo:function(e,t){var r={},i=e.readLine();i&&(r.name=i);var n=e.readLine(),a=this.readInfoLine(n);a&&(r=Object.extend(r,a));var o=e.readLine();return o&&(r.comment=o),r},readInfoLine:function(t){var r={};if(t.trim()){var i=t.substr(0,2).trim();i&&(r.userAbbr=i),i=t.substr(2,8).trim(),i&&(r.programName=i),i=t.substr(10,10),i.trim()&&(r.date=e.IO.MdlUtils.analysisMdlDateTimeStr(i,!1)),i=t.substr(20,2),r.coordMode="3D"==i?e.CoordMode.COORD3D:"2D"==i?e.CoordMode.COORD2D:e.CoordMode.UNKNOWN}return r},doReadBlock:function($super,e,t){var r=this.readHeaderInfo(e,t);r&&void 0!==r.coordMode&&this.setCoordMode(r.coordMode);var i=$super(e,t);if(i&&r&&(r.name&&i.setName(r.name),r.userAbbr&&i.setInfoValue("author",r.userAbbr),r.programName&&i.setInfoValue("generator",r.programName),r.date&&i.setInfoValue("date",r.date),r.comment&&i.setInfoValue("comment",r.comment)),!e.eof()){"M  END"===e.getCurrLine().trim().toUpperCase()&&e.readLine()}return i}}),e.IO.MdlMoleculeWriter=n.create(e.IO.MdlStructureFragmentWriter,{CLASS_NAME:"Kekule.IO.MdlMoleculeWriter",writeHeaderInfo:function(t,r){r.writeLine(t.getName()||e.$L("Texts.UNNAMED")||"");var i=this.generateInfoLine(t);r.writeLine(i);var n=t.getInfoValue("comment");r.writeLine(n||"")},generateInfoLine:function(t){var r="",i=t.getInfoValue("author");r+=i?i.toString().substr(0,2).rpad(2):"  ";var n=t.getInfoValue("generator");r+=n?n.toString().substr(0,8).rpad(8):e.LIBNAME_CORE.rpad(8);var a=t.getInfoValue("date")||new Date;return r+=e.IO.MdlUtils.generateMdlDateTimeStr(a,!1),r+=this.getCoordMode()==e.CoordMode.COORD3D?"3D":"2D"},getMolecule:function(t){return e.ChemStructureUtils.getTotalStructFragment(t)},doWriteBlock:function($super,t,r){var i=this.getMolecule(t);if(i){var n=e.IO.MdlStructureUtils.getMoleculeCtabStructureInfo(i);this.setCoordMode(n.coordMode),this.writeHeaderInfo(i,r),this.getMdlVersion()==e.IO.MdlVersion.V3000&&r.writeLine(e.IO.MdlStructureUtils.generateClassicStyleCountLine(n,this.getMdlVersion())),$super(i,r),this.getMdlVersion()==e.IO.MdlVersion.V3000&&r.writeLine("M  END")}}}),e.IO.MdlStructDataReader=n.create(e.IO.MdlBlockReader,{CLASS_NAME:"Kekule.IO.MdlStructDataReader",DATA_HEAD_PREFIX:e.IO.MDL.SD_DATA_HEAD_PREFIX,DATA_DBFIELD_PATTERN:/\bDT(\d+)\b/,DATA_KEY_NAME_PATTERN:/\<(.+)\>/,MOL_DELIMITER:e.IO.MDL.MOL_DELIMITER,doReadBlock:function(t,r){var i=new e.IO.MdlMoleculeReader;try{for(var n,a,o,s=[];!t.eof();){try{o=i.doReadBlock(t,null)}catch(e){o=null}if(!o)break;for(s.push(o),n=null,a=null;!t.eof();){var l=this.analysisDataLine(t.readLine());if(l){var d=l.lineType;if("dataheader"===d)n=l.key;else if("datavalue"===d)n&&(a=l.value,o.setInfoValue(n,a));else if("moldelimiter"===d)break}}}if(s.length>1){for(var u=new e.ChemObjList,c=0,h=s.length;c<h;++c)u.append(s[c]);return u}return s[0]}finally{i.finalize()}},analysisDataLine:function(e){var t,r,i=e.trim();return i.startsWith(this.DATA_HEAD_PREFIX)?(t="dataheader",r=this.getDataHeaderKey(e),r?{lineType:t,key:r}:null):i.startsWith(this.MOL_DELIMITER)?{lineType:"moldelimiter"}:i?{lineType:"datavalue",value:e}:null},getDataHeaderKey:function(e){var t=null,r=this.DATA_KEY_NAME_PATTERN.exec(e);return r&&r.length>1?t=r[1]:(r=this.DATA_DBFIELD_PATTERN.exec(e),t=r&&r.length>1?r[1]:e),t},doReadDataBlock:function(e,t){e.readLine()}}),e.IO.MdlStructDataWriter=n.create(e.IO.MdlBlockWriter,{CLASS_NAME:"Kekule.IO.MdlStructDataWriter",IGNORED_INFO_FIELDS:["generator","author","date","comment"],initialize:function($super,t,r){$super(),this.setMdlVersion(t||e.IO.MdlVersion.V2000),this.setCoordMode(r||e.CoordMode.UNKNOWN)},initProperties:function(){this.defineProp("mdlVersion",{dataType:a.INT,defaultValue:e.IO.MdlVersion.V2000}),this.defineProp("coordMode",{dataType:a.INT,defaultValue:e.CoordMode.UNKNOWN})},doWriteBlock:function(t,r){var i=this.getChildMols(t),n=new e.IO.MdlMoleculeWriter;n.setMdlVersion(this.getMdlVersion()),n.setCoordMode(this.getCoordMode());for(var a=0,o=i.length;a<o;++a){var s=i[a];try{var l=n.writeBlock(s);r.writeText(l);var d=this.getMolData(s);this.doWriteDataBlock(d,r),r.writeLine(e.IO.MDL.MOL_DELIMITER)}catch(e){}}},doWriteDataBlock:function(t,r){for(var i=e.ObjUtils.getOwnedFieldNames(t),n=0,a=i.length;n<a;++n){var o=i[n];if(this.IGNORED_INFO_FIELDS.indexOf(o)<0){var s=e.IO.MDL.SD_DATA_HEAD_PREFIX+" <"+o+">",l=t[o];s&&l&&(r.writeLine(s),r.writeLine(l),r.writeLine(""))}}},getChildMols:function(t){for(var r=e.ChemStructureUtils.getChildStructureObjs(t,!0),i=[],n=0,a=r.length;n<a;++n){var o=r[n];o instanceof e.StructureFragment&&i.push(o)}return i},getMolData:function(e){return e.getInfo?e.getInfo()||{}:null}}),e.IO.MdlBaseReactionReader=n.create(e.IO.MdlBlockReader,{CLASS_NAME:"Kekule.IO.MdlBaseReactionReader",readHeaderBlock:function(t,r){var i,n={},a=t.readLine().trim();return"$RXN"!=(i=a.substr(0,4))?(e.error(e.$L("ErrorMsg.NOT_MDL_RXN_DATA")),null):(i=a.substr(4).trim(),n.version="V3000"==i?e.IO.MdlVersion.V3000:e.IO.MdlVersion.V2000,a=t.readLine().trim(),a&&(n.name=a),a=t.readLine(),i=a.substr(0,6).trim(),i&&(n.userAbbr=i),i=a.substr(6,9).trim(),i&&(n.programName=i),i=a.substr(15,10),i.trim()&&(n.date=e.IO.MdlUtils.analysisMdlDateTimeStr(i,!0)),a=t.readLine().trim(),a&&(n.comment=a),n)},readSubstanceCountLine:function(e){},readMolBlock:function(e){},doReadBlock:function($super,t,r){for(var i=this.readHeaderBlock(t,null),n=this.readSubstanceCountLine(t.readLine()),a=new e.Reaction,o=0;o<n.reactantCount;++o){var s=this.readMolBlock(t);s&&a.appendReactant(s)}for(var o=0;o<n.productCount;++o){var s=this.readMolBlock(t);s&&a.appendProduct(s)}return a&&i&&(i.name&&a.setName(i.name),i.userAbbr&&a.setInfoValue("author",i.userAbbr),i.programName&&a.setInfoValue("generator",i.programName),i.date&&a.setInfoValue("date",i.date),i.comment&&a.setInfoValue("comment",i.comment)),a}}),e.IO.Mdl2kReactionReader=n.create(e.IO.MdlBaseReactionReader,{CLASS_NAME:"Kekule.IO.Mdl2kReactionReader",readHeaderBlock:function($super,t,r){var i=$super(t,r);return i.version!=e.IO.MdlVersion.V2000?(e.error(e.$L("ErrorMsg.NOT_MDL2000_RXN_DATA")),null):i},readSubstanceCountLine:function(e){var t={};return t.reactantCount=parseInt(e.substr(0,3),10)||0,t.productCount=parseInt(e.substr(3,3),10)||0,t},readMolBlock:function(t){for(var r=t.readLine();"$MOL"!==r&&!t.eof();)r=t.readLine();if(t.eof())return null;for(var i=[],r=t.getCurrLine();"$MOL"!==r&&!t.eof();)i.push(r),t.incCurrLineNo(),r=t.getCurrLine();return(new e.IO.MdlMoleculeReader).readBlock(i,null)}}),e.IO.Mdl3kReactionReader=n.create(e.IO.MdlBaseReactionReader,{CLASS_NAME:"Kekule.IO.Mdl3kReactionReader",createTextBuffer:function(){return new e.IO.Mdl3kTextBuffer},readHeaderBlock:function($super,t,r){var i=$super(t,r);return i.version!=e.IO.MdlVersion.V3000?(e.error(e.$L("ErrorMsg.NOT_MDL3000_RXN_DATA")),null):i},readSubstanceCountLine:function(t){var r={},i=e.IO.Mdl3kValueUtils.splitValues(t);return"COUNTS"!=i.shift().value.trim()?(e.error(e.$L("ErrorMsg.NOT_MDL3000_RXN_COUNTLINE")),null):(r.reactantCount=parseInt(i.shift().value,10)||0,r.productCount=parseInt(i.shift().value,10)||0,r)},readMolBlock:function(t){if(t.getBlockBuffer){var r=t.getBlockBuffer("CTAB");return(new e.IO.Mdl3kMoleculeCTabReader).doReadBlock(r)}return null}}),e.IO.MdlReactionReader=n.create(e.IO.MdlBlockReader,{CLASS_NAME:"Kekule.IO.MdlReactionReader",doReadBlock:function(t,r){var i;return i=e.IO.MdlUtils.getRxnMarkVersion(t.getCurrLine())==e.IO.MdlVersion.V3000?new e.IO.Mdl3kReactionReader:new e.IO.Mdl2kReactionReader,i.readBlock(t.getUnreadLines(),r)}}),e.IO.MdlReactionWriter=n.create(e.IO.MdlBlockWriter,{CLASS_NAME:"Kekule.IO.MdlReactionWriter",initialize:function($super,t,r){$super(),this.setMdlVersion(t||e.IO.MdlVersion.V2000),this.setCoordMode(r||e.CoordMode.UNKNOWN)},initProperties:function(){this.defineProp("mdlVersion",{dataType:a.INT,defaultValue:e.IO.MdlVersion.V2000}),this.defineProp("coordMode",{dataType:a.INT,defaultValue:e.CoordMode.UNKNOWN})},writeHeaderBlock:function(t,r){var i;i="$RXN"+(this.getMdlVersion()==e.IO.MdlVersion.V3000?" "+e.IO.MDL.VER3000:""),r.writeLine(i),r.writeLine(t.getName()||""),i=(t.getInfoValue("author")||"").substr(0,6).rpad(6),i+=(t.getInfoValue("generator")||"").substr(0,9).rpad(9);var n=t.getInfoValue("date")||new Date;i+=e.IO.MdlUtils.generateMdlDateTimeStr(n,!0),r.writeLine(i);var a=t.getInfoValue("comment")||"";r.writeLine(a)},generateSubstanceCountLine:function(t){return this.getMdlVersion()==e.IO.MdlVersion.V3000?"M  V30 COUNTS "+e.IO.Mdl3kValueUtils.mergeValues([t.getReactantCount(),t.getProductCount()]):t.getReactantCount().toString().lpad(3)+t.getProductCount().toString().lpad(3)},writeMolDelimiterLine:function(t){this.getMdlVersion()==e.IO.MdlVersion.V2000&&t.writeLine("$MOL")},writeMolBlock:function(t,r){var i=this.getMdlVersion()==e.IO.MdlVersion.V3000?new e.IO.Mdl3kMoleculeCTabWriter(this.getCoordMode()):new e.IO.MdlMoleculeWriter(this.getMdlVersion(),this.getCoordMode()),n=i.writeBlock(t);r.writeText(n)},doWriteBlock:function($super,t,r){var i=this.getMdlVersion()==e.IO.MdlVersion.V3000;this.writeHeaderBlock(t,r);var n=this.generateSubstanceCountLine(t);r.writeLine(n),i&&r.writeLine("M  V30 "+e.IO.Mdl3kUtils.get3kBlockStartTag("REACTANT"));for(var a=0;a<t.getReactantCount();++a)this.writeMolDelimiterLine(r),this.writeMolBlock(t.getReactantAt(a),r);i&&r.writeLine("M  V30 "+e.IO.Mdl3kUtils.get3kBlockEndTag("REACTANT")),i&&r.writeLine("M  V30 "+e.IO.Mdl3kUtils.get3kBlockStartTag("PRODUCT"));for(var a=0;a<t.getProductCount();++a)this.writeMolDelimiterLine(r),this.writeMolBlock(t.getProductAt(a),r);i&&(r.writeLine("M  V30 "+e.IO.Mdl3kUtils.get3kBlockEndTag("PRODUCT")),r.writeLine("M  END"))}}),e.IO.BaseMdlReader=n.create(e.IO.ChemDataReader,{CLASS_NAME:"Kekule.IO.BaseMdlReader",doReadData:function(t,r,i){return r!=e.IO.ChemDataType.TEXT?(e.error(e.$L("ErrorMsg.MDL_INPUT_DATATYPE_NOT_TEXT")),null):this.doReadMdlData(t)},doReadMdlData:function(e){return null}}),e.IO.BaseMdlWriter=n.create(e.IO.ChemDataWriter,{CLASS_NAME:"Kekule.IO.BaseMdlWriter",initialize:function($super,t){$super(t),t||(t={}),this.setMdlVersion(t.mdlVersion||e.globalOptions.IO.mdl.mdlVersion),this.setCoordMode(t.coordMode||e.globalOptions.IO.mdl.coordMode)},initProperties:function(){this.defineProp("mdlVersion",{dataType:a.INT,defaultValue:e.IO.MdlVersion.V2000}),this.defineProp("coordMode",{dataType:a.INT,defaultValue:e.CoordMode.UNKNOWN})},doWriteData:function($super,t,r,i){var n=r||e.IO.ChemDataType.TEXT;return n!=e.IO.ChemDataType.TEXT?(e.error(e.$L("ErrorMsg.MDL_OUTPUT_DATATYPE_NOT_TEXT")),null):$super(t,n,i)}}),e.IO.MdlMolReader=n.create(e.IO.BaseMdlReader,{CLASS_NAME:"Kekule.IO.MdlMolReader",doReadMdlData:function(t){return(new e.IO.MdlMoleculeReader).readBlock(t,null)}}),e.IO.MdlMolWriter=n.create(e.IO.BaseMdlWriter,{CLASS_NAME:"Kekule.IO.MdlMolWriter",doWriteData:function(t,r,i){return new e.IO.MdlMoleculeWriter(this.getMdlVersion(),this.getCoordMode()).writeBlock(t)}}),e.IO.MdlSdReader=n.create(e.IO.BaseMdlReader,{CLASS_NAME:"Kekule.IO.MdlSdReader",doReadMdlData:function(t){return(new e.IO.MdlStructDataReader).readBlock(t,null)}}),e.IO.MdlSdWriter=n.create(e.IO.BaseMdlWriter,{CLASS_NAME:"Kekule.IO.MdlSdWriter",doWriteData:function(t,r,i){return new e.IO.MdlStructDataWriter(this.getMdlVersion(),this.getCoordMode()).writeBlock(t)}}),e.IO.MdlRxnReader=n.create(e.IO.BaseMdlReader,{CLASS_NAME:"Kekule.IO.MdlRxnReader",doReadMdlData:function(t){return(new e.IO.MdlReactionReader).readBlock(t,null)}}),e.IO.MdlRxnWriter=n.create(e.IO.BaseMdlWriter,{CLASS_NAME:"Kekule.IO.MdlRxnWriter",doWriteData:function(t,r,i){return new e.IO.MdlReactionWriter(this.getMdlVersion(),this.getCoordMode()).writeBlock(t)}}),e.IO.MdlReader=n.create(e.IO.ChemDataReader,{CLASS_NAME:"Kekule.IO.MdlReader",doReadData:function(t,r,i){if(r!=e.IO.ChemDataType.TEXT)return e.error(e.$L("ErrorMsg.MDL_INPUT_DATATYPE_NOT_TEXT")),null;var n;return n="$RXN"==t.substr(0,4)?new e.IO.MdlReactionReader:new e.IO.MdlMoleculeReader,n.readBlock(t,null)}}),e.IO.MdlWriter=n.create(e.IO.ChemDataWriter,{CLASS_NAME:"Kekule.IO.MdlWriter",initialize:function($super,t){$super(t);var r=t||{};this.setMdlVersion(r.mdlVersion||e.globalOptions.IO.mdl.mdlVersion),this.setCoordMode(r.coordMode||e.globalOptions.IO.mdl.coordMode)},initProperties:function(){this.defineProp("mdlVersion",{dataType:a.INT,defaultValue:e.IO.MdlVersion.V2000}),this.defineProp("coordMode",{dataType:a.INT,defaultValue:e.CoordMode.UNKNOWN})},doWriteData:function(t,r,n){var a;if(t instanceof e.Reaction)a=new e.IO.MdlRxnWriter(this.getMdlVersion(),this.getCoordMode());else{if(!(t instanceof e.StructureFragment)){var o=t&&t.getClassName?t.getClassName():void 0===t?"undefined":i(t);return e.error(e.$L("ErrorMsg.UNABLE_TO_OUTPUT_AS_MDL").format(o)),null}a=new e.IO.MdlMolWriter(this.getMdlVersion(),this.getCoordMode())}if(a)return a.writeData(t)}}),function(){e.IO.DataFormat.MOL="mol",e.IO.DataFormat.RXN="rxn",e.IO.DataFormat.SD="sd",e.IO.DataFormat.MOL3K="mol3k",e.IO.DataFormat.RXN3K="rxn3k",e.IO.MimeType.MDL_MOL="chemical/x-mdl-molfile",e.IO.MimeType.MDL_RXN="chemical/x-mdl-rxnfile",e.IO.MimeType.MDL_SD="chemical/x-mdl-sdfile",e.IO.DataFormatsManager.register("mol",e.IO.MimeType.MDL_MOL,"mol",e.IO.ChemDataType.TEXT,"MDL Mol 2000 format"),e.IO.DataFormatsManager.register("rxn",e.IO.MimeType.MDL_RXN,"rxn",e.IO.ChemDataType.TEXT,"MDL Reaction 2000 format"),e.IO.DataFormatsManager.register("sd",e.IO.MimeType.MDL_SD,["sd","sdf"],e.IO.ChemDataType.TEXT,"MDL Structure-Data format"),e.IO.DataFormatsManager.register("mol3k",e.IO.MimeType.MDL_MOL,"mol",e.IO.ChemDataType.TEXT,"MDL Mol 3000 format"),e.IO.DataFormatsManager.register("rxn3k",e.IO.MimeType.MDL_RXN,"rxn",e.IO.ChemDataType.TEXT,"MDL Reaction 3000 format"),e.IO.ChemDataReaderManager.register("MDL-mol",e.IO.MdlMolReader,["mol","mol3k"]),e.IO.ChemDataReaderManager.register("MDL-rxn",e.IO.MdlRxnReader,["rxn","rxn3k"]),e.IO.ChemDataReaderManager.register("MDL-general",e.IO.MdlReader,["mol","mol3k","rxn","rxn3k"]),e.IO.ChemDataReaderManager.register("MDL-sd",e.IO.MdlSdReader,"sd");var t=[e.StructureFragment,e.ChemObjList,e.ChemStructureObjectGroup,e.ChemSpaceElement,e.ChemSpace];e.IO.ChemDataWriterManager.register("MDL-mol",e.IO.MdlMolWriter,t,"mol"),e.IO.ChemDataWriterManager.register("MDL-mol3k",e.IO.MdlMolWriter,t,"mol3k",{createOptions:{mdlVersion:e.IO.MdlVersion.V3000}}),e.IO.ChemDataWriterManager.register("MDL-rxn",e.IO.MdlRxnWriter,[e.Reaction],"rxn"),e.IO.ChemDataWriterManager.register("MDL-rxn3k",e.IO.MdlRxnWriter,[e.Reaction],"rxn3k"),e.IO.ChemDataWriterManager.register("MDL-sd",e.IO.MdlSdWriter,t,"sd")}(),e}},function(e,t,r){"use strict";var i=r(0).Class;r(0).DataType,r(1).JsonUtility;e.exports=function(e){var t=e.ArrayUtils;e.IO.SMILES={ATOM_BRACKET_LEFT:"[",ATOM_BRACKET_RIGHT:"]",ATOM_WILDCARD:"*",ATOM_H:"H",ORGAN_SUBSET_ATOMS:["B","C","N","O","S","P","F","Cl","Br","I"],AROMATIC_SUBSET_ATOMS:["B","C","N","O","S","P"],BOND_SINGLE:"-",BOND_DOUBLE:"=",BOND_TRIPLE:"#",BOND_QUAD:"$",BOND_AROMATIC:":",BOND_FAKE:".",RING_BOND_TWO_DIGIT_NO_PREFIX:"%",BRANCH_BRACKET_LEFT:"(",BRANCH_BRACKET_RIGHT:")",ROTATION_DIR_CLOCKWISE:"@@",ROTATION_DIR_ANTICLOCKWISE:"@",DIRECTION_BOND_SYMBOLS:["/","\\"]};var r=e.IO.SMILES;e.IO.SmilesUtils={createGraphDepthSpanningTreesEx:function(e,r){for(var i=t.clone(e.getVertexes()),n=0,a=i.length;n<a;++n)i[n].setData("__$visitedEx__",!1);for(var o=[];i.length;){var s;s=r&&i.indexOf(r)>=0?r:i[0];var l={vertexes:[],edges:[],longestPath:{vertexes:[],edges:[],length:0}},d=function e(t){var r={vertexes:[],edges:[],longestPath:{vertexes:[],edges:[],length:0}},i=t;i.getData("__$visitedEx__")||(r.vertexes.push(i),i.setData("__$visitedEx__",!0));for(var n,a=i.getEdges(),o=0,s=a.length;o<s;++o){var l=a[o],d=i.getNeighborOnEdge(l);if(!d.getData("__$visitedEx__")){r.vertexes.push(d),r.edges.push(l),d.setData("__$visitedEx__",!0);var u=e(d);r.vertexes=r.vertexes.concat(u.vertexes),r.edges=r.edges.concat(u.edges),(u.longestPath.length>r.longestPath.length||!r.longestPath.length)&&(r.longestPath.vertexes=u.longestPath.vertexes,r.longestPath.edges=u.longestPath.edges,r.longestPath.length=u.longestPath.length,n=l)}}return n&&(r.longestPath.edges.unshift(n),r.longestPath.length=(r.longestPath.length||0)+1),r.longestPath.vertexes.unshift(i),r}(s);l.vertexes=l.vertexes.concat(d.vertexes),l.edges=l.edges.concat(d.edges),l.longestPath.length=(l.longestPath.length||0)+d.longestPath.length,l.longestPath.vertexes=l.longestPath.vertexes.concat(d.longestPath.vertexes),l.longestPath.edges=l.longestPath.edges.concat(d.longestPath.edges),i=t.exclude(i,d.vertexes),o.push(l)}return o}},e.IO.SmilesMolWriter=i.create(e.IO.ChemDataWriter,{CLASS_NAME:"Kekule.IO.SmilesMolWriter",doWriteData:function(e,t,r,i){var n=this.getMolecule(e);return n?this.writeStructFragment(n,i):""},getMolecule:function(t){return e.ChemStructureUtils.getTotalStructFragment(t)},writeStructFragment:function(i,n){if(i.hasCtab()&&!i.isEmpty()){var a=i.clone();a.standardize&&a.standardize();var o=[],s=[];if(a.getAromaticRings)for(var l=a.getAromaticRings(),d=0,u=l.length;d<u;++d){var c=l[d];t.pushUnique(o,c.nodes),t.pushUnique(s,c.connectors)}for(var h,m=e.GraphAdaptUtils.ctabToGraph(a.getCtab(),null,{expandSubStructures:!0,ignoreBondedHydrogen:!0}),g=m.getVertexes(),f=(m.getEdges(),g[g.length-1]),p=e.IO.SmilesUtils.createGraphDepthSpanningTreesEx(m,f),C=[],d=0,u=p.length;d<u;++d){var b=p[d],E=b.longestPath,N="",T=E.vertexes[0];N=this._writeMolVertex(T,null,E.edges,b.edges,C,o,s,n),0===d?h=N:h+=r.BOND_FAKE+N}return h}return""},_writeMolVertex:function(t,i,n,a,o,s,l,d){var u,c,h=t.getData("object"),m=t.getEdges(),g=[],f=[],p=[],C=[],b="",E=d.ignoreStereoBond;e.ObjUtils.isUnset(E)&&(E=d.ignoreStereo||!1);for(var N=m.length-1;N>=0;--N){var T=m[N];if(T!==i){var O=T.getData("object");if(!E&&O.getParity&&O.getParity()){var _=e.MolStereoUtils.getStereoBondKeyNodes(O);if(_){var S=t.getNeighborOnEdge(T),v=S.getData("object"),y=this._getStereoDoubleBondInitialDirectionSymbols(O),A=y[0];_.indexOf(v)<0&&(A=this._getInvertBondDirectionSymbol(A))}b=A}if(a.indexOf(T)>=0){var S=t.getNeighborOnEdge(T),M=this._writeMolVertex(S,T,n,a,o,s,l,d);n.indexOf(T)>=0?(c=S,u=M):(f.push(S),g.push(M))}else{var I=o.indexOf(T);I<0&&(I=o.length,o.push(T)),C.push(t.getNeighborOnEdge(T));var R=this._outputConnectorStr(O,T.getVertexes()[0].getData("object"),T.getVertexes()[1].getData("object"),s,l);I+=1,R+=I<10?I:r.RING_BOND_TWO_DIGIT_NO_PREFIX+I,p.push(R)}}}var L,x="",D="";if(i){b&&(x+=b);L=t.getNeighborOnEdge(i).getData("object");var P=i.getData("object");if(!E&&P.getParity&&P.getParity()){var _=e.MolStereoUtils.getStereoBondKeyNodes(P);if(_){var y=this._getStereoDoubleBondInitialDirectionSymbols(P),A=y[1];_.indexOf(L)<0&&(A=this._getInvertBondDirectionSymbol(A))}D+=A}x+=this._outputConnectorStr(P,i.getVertexes()[0].getData("object"),i.getVertexes()[1].getData("object"),s,l)}for(var B=[],N=0,w=C.length;N<w;++N)B.push(C[N].getData("object"));for(var N=0,w=f.length;N<w;++N)B.push(f[N].getData("object"));c&&B.push(c.getData("object")),x+=this._outputNodeStr(h,s.indexOf(h)>=0,L,B,d);for(var N=0,w=p.length;N<w;++N)x+=p[N];!u&&g.length&&(u=g.shift());for(var N=0,w=g.length;N<w;++N)x+=r.BRANCH_BRACKET_LEFT+g[N]+r.BRANCH_BRACKET_RIGHT;return x+=D,u&&(x+=u),x},_outputNodeStr:function(t,i,n,a,o){var s,l;t instanceof e.Atom?(l=t.getSymbol(),s=l,i&&(s=s.toLowerCase())):s=r.ATOM_WILDCARD;var d=o.ignoreStereoAtom;e.ObjUtils.isUnset(d)&&(d=o.ignoreStereo||!1);var u;if(!d&&t.getParity&&t.getParity()&&a&&a.length){var c=t.getLinkedHydrogenAtoms();c&&1===c.length&&a.indexOf(c[0])<0&&a.push(c[0]);var h=t.getHydrogenCount?t.getHydrogenCount(!1)||0:0;if(c.length&&h)u="";else var m=e.MolStereoUtils.calcTetrahedronChiralCenterRotationDirection(null,t,n,a,!!h,!1,{allowExplicitVerticalHydrogen:!0}),u=m===e.RotationDir.CLOCKWISE?r.ROTATION_DIR_CLOCKWISE:m===e.RotationDir.ANTICLOCKWISE?r.ROTATION_DIR_ANTICLOCKWISE:"";u&&(s+=u)}var g;if(u?g=t.getHydrogenCount?t.getHydrogenCount(!0)||0:0:!(g=t.getExplicitHydrogenCount?t.getExplicitHydrogenCount():0)&&i&&"C"!==l&&t.getImplicitHydrogenCount&&(g=t.getImplicitHydrogenCount()),g){s+=r.ATOM_H;var h=Math.round(g);h>1&&(s+=h)}var f=Math.round(t.getCharge());if(f){var p=f>0?"+":"-";(f>1||f<-1)&&(p=Math.abs(f)+p),s+=p}var C=t.getMassNumber?t.getMassNumber():null;C&&(s=Math.abs(C)+s);var b=!1;return g||f||C||u||(!i&&r.ORGAN_SUBSET_ATOMS.indexOf(l)>=0||i&&r.AROMATIC_SUBSET_ATOMS.indexOf(l)>=0)&&(b=!0),b||(s=r.ATOM_BRACKET_LEFT+s+r.ATOM_BRACKET_RIGHT),s},_outputConnectorStr:function(t,i,n,a,o){if(t instanceof e.Bond&&t.getBondType()===e.BondType.COVALENT){if(o.indexOf(t)>=0)return"";var s=a.indexOf(i)>=0&&a.indexOf(n)>=0,l=t.getBondOrder(),d=e.BondOrder;return l===d.DOUBLE?r.BOND_DOUBLE:l===d.TRIPLE?r.BOND_TRIPLE:l===d.QUAD?r.BOND_QUAD:s?r.BOND_SINGLE:""}return r.BOND_FAKE},_getStereoDoubleBondInitialDirectionSymbols:function(t){return t.getParity()===e.StereoParity.EVEN?[r.DIRECTION_BOND_SYMBOLS[0],r.DIRECTION_BOND_SYMBOLS[0]]:[r.DIRECTION_BOND_SYMBOLS[0],r.DIRECTION_BOND_SYMBOLS[1]]},_getInvertBondDirectionSymbol:function(e){return e===r.DIRECTION_BOND_SYMBOLS[1]?r.DIRECTION_BOND_SYMBOLS[0]:r.DIRECTION_BOND_SYMBOLS[1]}}),e.IO.MimeType.SMILES="chemical/x-daylight-smiles",e.IO.DataFormat.SMILES="smi";e.IO.DataFormatsManager.register(e.IO.DataFormat.SMILES,e.IO.MimeType.SMILES,["smi","smiles"],e.IO.ChemDataType.TEXT,"SMILES format");var n=[e.StructureFragment,e.ChemObjList,e.ChemStructureObjectGroup,e.ChemSpaceElement,e.ChemSpace];return e.IO.ChemDataWriterManager.register("SMILES",e.IO.SmilesMolWriter,n,[e.IO.DataFormat.SMILES]),e}},function(e,t,r){"use strict";var i=r(0).Class,n=r(0).DataType;r(1).JsonUtility,r(1).XmlUtility,r(2).ObjSerializerFactory;e.exports=function(e){return e.globalOptions.add("IO.kekuleNative",{prettyPrint:!0}),e.IO.KcjReader=i.create(e.IO.ChemDataReader,{CLASS_NAME:"Kekule.IO.KcjReader",readData:function($super,t,r){var i,a=r||e.IO.ChemDataType.TEXT;return a==e.IO.ChemDataType.JSON&&(i=t),a!=e.IO.ChemDataType.TEXT?(e.error(e.$L("ErrorMsg.KCJ_INPUT_DATATYPE_NOT_JSON_OR_TEXT")),null):(i=n.JsonUtility.parse(t),$super(i,e.IO.ChemDataType.JSON))},doReadData:function(t,r){var n=i.ObjSerializerFactory.getSerializer("json");return n?n.load(null,t,e):(e.error(e.$L("ErrorMsg.JSON_SERIALIZER_NOT_EXISTS")),null)}}),e.IO.KcjWriter=i.create(e.IO.ChemDataWriter,{CLASS_NAME:"Kekule.IO.KcjWriter",initialize:function($super,t){$super(t);var r=t||{};this.setPrettyPrint(e.ObjUtils.isUnset(r.prettyPrint)?e.globalOptions.IO.kekuleNative.prettyPrint:r.prettyPrint)},initProperties:function(){this.defineProp("prettyPrint",{dataType:n.BOOL,defaultValue:!0})},writeData:function($super,t,r,i,a){var o=r||e.IO.ChemDataType.TEXT;if(o!=e.IO.ChemDataType.JSON&&o!=e.IO.ChemDataType.TEXT)return e.error(e.$L("ErrorMsg.KCJ_OUTPUT_DATATYPE_NOT_JSON_OR_TEXT")),null;var s=$super(t,e.IO.ChemDataType.JSON);if(o==e.IO.ChemDataType.JSON)return s;if(o==e.IO.ChemDataType.TEXT){var l=a&&e.ObjUtils.notUnset(a.prettyPrint)?a.prettyPrint:this.getPrettyPrint();return n.JsonUtility.serializeToStr(s,{prettyPrint:l})}},doWriteData:function(t,r,n,a){var o=i.ObjSerializerFactory.getSerializer("json");if(!o)return e.error(e.$L("ErrorMsg.JSON_SERIALIZER_NOT_EXISTS")),null;var s={};return o.save(t,s),s}}),e.IO.KcxReader=i.create(e.IO.ChemDataReader,{CLASS_NAME:"Kekule.IO.KcxReader",readData:function($super,t,r){var i,a=r||e.IO.ChemDataType.TEXT;return a==e.IO.ChemDataType.DOM&&(i=t),a!=e.IO.ChemDataType.TEXT?(e.error(e.$L("ErrorMsg.KCX_INPUT_DATATYPE_NOT_DOM_OR_TEXT")),null):(i=n.XmlUtility.parse(t).documentElement,$super(i,e.IO.ChemDataType.DOM))},doReadData:function(t,r){var n=i.ObjSerializerFactory.getSerializer("xml");return n?n.load(null,t,e):(e.error(e.$L("ErrorMsg.XML_SERIALIZER_NOT_EXISTS")),null)}}),e.IO.KcxWriter=i.create(e.IO.ChemDataWriter,{CLASS_NAME:"Kekule.IO.KcxWriter",initialize:function($super,t){$super(t);var r=t||{};this.setPrettyPrint(e.ObjUtils.isUnset(r.prettyPrint)?e.globalOptions.IO.kekuleNative.prettyPrint:r.prettyPrint),this.setRootTag(r.rootTag||"kcx")},initProperties:function(){this.defineProp("prettyPrint",{dataType:n.BOOL,defaultValue:!0}),this.defineProp("rootTag",{dataType:n.STRING})},writeData:function($super,t,r){var i=r||e.IO.ChemDataType.TEXT;if(i!=e.IO.ChemDataType.DOM&&i!=e.IO.ChemDataType.TEXT)return e.error(e.$L("ErrorMsg.KCX_OUTPUT_DATATYPE_NOT_DOM_OR_TEXT")),null;var a=$super(t,e.IO.ChemDataType.DOM);if(i==e.IO.ChemDataType.DOM)return a;if(i==e.IO.ChemDataType.TEXT){var o={prettyPrint:this.getPrettyPrint()};return n.XmlUtility.serializeNode(a,o)}},doWriteData:function(t,r){var a=i.ObjSerializerFactory.getSerializer("xml");if(!a)return e.error(e.$L("ErrorMsg.XML_SERIALIZER_NOT_EXISTS")),null;var o=n.XmlUtility.newDocument(this.getRootTag());return a.save(t,o.documentElement),o.documentElement}}),function(){e.IO.MimeType.KEKULE_JSON="chemical/x-kekule-json",e.IO.MimeType.KEKULE_XML="chemical/x-kekule-xml",e.IO.DataFormat.KEKULE_JSON="Kekule-JSON",e.IO.DataFormat.KEKULE_XML="Kekule-XML",e.IO.DataFormatsManager.register("JSON",e.IO.MimeType.JSON,"json",e.IO.ChemDataType.TEXT,"JSON format"),e.IO.DataFormatsManager.register(e.IO.DataFormat.KEKULE_JSON,e.IO.MimeType.KEKULE_JSON,"kcj",e.IO.ChemDataType.TEXT,"Kekule Chemical JSON format"),e.IO.DataFormatsManager.register(e.IO.DataFormat.KEKULE_XML,e.IO.MimeType.KEKULE_XML,"kcx",e.IO.ChemDataType.TEXT,"Kekule Chemical XML format");var t=e.IO.DataFormatsManager.findFormatId(e.IO.MimeType.JSON),r=e.IO.DataFormatsManager.findFormatId(e.IO.MimeType.KEKULE_JSON),i=e.IO.DataFormatsManager.findFormatId(e.IO.MimeType.KEKULE_XML);e.IO.ChemDataReaderManager.register("json",e.IO.KcjReader,t),e.IO.ChemDataReaderManager.register("kcj",e.IO.KcjReader,r),e.IO.ChemDataReaderManager.register("kcx",e.IO.KcxReader,i),e.IO.ChemDataWriterManager.register("kcj",e.IO.KcjWriter,[e.ChemObject],r,{createOptions:{prettyPrint:!1}}),e.IO.ChemDataWriterManager.register("kcx",e.IO.KcxWriter,[e.ChemObject],i,{createOptions:{prettyPrint:!0}})}(),e}},function(e,t,r){"use strict";var i=r(0).Class,n=r(0).ClassEx,a=(r(0).ObjectEx,r(0).DataType);e.exports=function(e){var t=e,r=e.ChemStructureNodeLabels,o=e.CoordMode;n.extend(e.ChemObject,{getDefCoordPos:function(t){return e.Render.CoordPos.CENTER},getCoordPos:function(t){var r=t===e.CoordMode.COORD3D?this.getPropStoreFieldValue("coordPos3D"):this.getPropStoreFieldValue("coordPos2D");return e.ObjUtils.isUnset(r)&&(r=this.getDefCoordPos(t)),r},getOverrideRenderOptions:function(e){if(e&&e.length){for(var t={},r=0,i=e.length;r<i;++r)t=Object.extend(t,e[r]);return t}return null},_appendOverrideRenderOptionItem:function(e,t){var r=this.getPropStoreFieldValue(t);r||(r=[],this.setPropStoreFieldValue(t,r));var i=r.indexOf(e);return i>=0&&r.splice(i,1),r.push(e),this.notifyPropSet(t,r),this},_deleteOverrideRenderOptionItem:function(e,t){var r=this.getPropStoreFieldValue(t);if(r){var i=r.indexOf(e);return i>=0&&(r.splice(i,1),this.notifyPropSet(t,r)),this}},addOverrideRenderOptionItem:function(e){return this._appendOverrideRenderOptionItem(e,"overrideRenderOptionItems")},addOverrideRender3DOptionItem:function(e){return this._appendOverrideRenderOptionItem(e,"overrideRender3DOptionItems")},removeOverrideRenderOptionItem:function(e){return this._deleteOverrideRenderOptionItem(e,"overrideRenderOptionItems")},removeOverrideRender3DOptionItem:function(e){return this._deleteOverrideRenderOptionItem(e,"overrideRender3DOptionItems")},getOverriddenRenderOptions:function(){var e=this.getRenderOptions()||{},t=e,r=this.getOverrideRenderOptions(this.getOverrideRenderOptionItems());return r&&(t=Object.extend(t,r)),t},getOverriddenRender3DOptions:function(){var e=Object.create(this.getRender3DOptions()||null),t=this.getOverrideRenderOptions(this.getOverrideRender3DOptionItems());return t&&(e=Object.extend(e,t)),e},setRenderOption:function(e,t){var r=this.getRenderOptions();r||this.setRenderOptions({});var r=this.getRenderOptions();r[e]!==t&&(r[e]=t,this.notifyPropSet("renderOptions",r))},setRender3DOption:function(e,t){var r=this.getRender3DOptions();r||this.setRender3DOptions({});var r=this.getRender3DOptions();r[e]!==t&&(r[e]=t,this.notifyPropSet("render3DOptions",r))},getRenderOption:function(e){var t=this.getOverriddenRenderOptions();return t?t[e]:void 0},getRender3DOption:function(e){var t=this.getOverriddenRender3DOptions();return t?t[e]:void 0},getCascadedRenderOption:function(t){var r=this.getOverriddenRenderOptions(),i=r?r[t]:void 0;if(e.ObjUtils.isUnset(i)){var n=this.getParent?this.getParent():null;i=n&&n.getCascadedRenderOption?n.getCascadedRenderOption(t):void 0}return i},getCascadedRender3DOption:function(t){var r=this.getOverriddenRender3DOptions(),i=r?r[t]:void 0;if(e.ObjUtils.isUnset(i)){var n=this.getParent?this.getParent():null;i=n&&n.getCascadedRender3DOption?n.getCascadedRender3DOption(t):void 0}return i},getBaseCoord:function(t,r){var i=this.getCoordPos(t),n=this.getCoordOfMode?this.getCoordOfMode(t,r):null;if(n&&i!==e.Render.CoordPos.CENTER&&i===e.Render.CoordPos.CORNER_TL){var a=this.getExposedContainerBox(t,r),s={x:(a.x2-a.x1)/2,y:(a.y2-a.y1)/2};t===o.COORD3D&&(s.z=(a.z2-a.z1)/2),t===o.COORD3D?n=e.CoordUtils.add(n,s):(n.x+=s.x,n.y-=s.y)}return n},getBaseCoord2D:function(t){return this.getBaseCoord(e.CoordMode.COORD2D,t)},getBaseCoord3D:function(t){return this.getBaseCoord(e.CoordMode.COORD3D,t)},getAbsBaseCoord:function(t,r){var i=this.getCoordPos(t),n=this.getAbsCoordOfMode?this.getAbsCoordOfMode(t,r):null;if(n&&i!==e.Render.CoordPos.CENTER&&i===e.Render.CoordPos.CORNER_TL){var a=this.getExposedContainerBox(t,r),s={x:(a.x2-a.x1)/2,y:(a.y2-a.y1)/2};t===o.COORD3D&&(s.z=(a.z2-a.z1)/2),t===o.COORD3D?n=e.CoordUtils.add(n,s):(n.x+=s.x,n.y-=s.y)}return n},getAbsBaseCoord2D:function(t){return this.getAbsBaseCoord(e.CoordMode.COORD2D,t)},getAbsBaseCoord3D:function(t){return this.getAbsBaseCoord(e.CoordMode.COORD3D,t)},setAbsBaseCoord:function(t,r,i){var n=this.getCoordPos(r),a=e.CoordUtils.clone(t);if(t&&n!==e.Render.CoordPos.CENTER&&n===e.Render.CoordPos.CORNER_TL){var s=this.getExposedContainerBox(r,i),l={x:(s.x2-s.x1)/2,y:(s.y2-s.y1)/2};r===o.COORD3D&&(l.z=(s.z2-s.z1)/2),r===o.COORD3D?a=e.CoordUtils.substract(a,l):(a.x-=l.x,a.y+=l.y)}return this.setAbsCoordOfMode?this.setAbsCoordOfMode(a,r):this.setCoordOfMode&&this.setCoordOfMode(a,r),this},setAbsBaseCoord2D:function(t,r){return this.setAbsCoordOfMode(t,e.CoordMode.COORD2D,r)},setAbsBaseCoord3D:function(t,r){return this.setAbsCoordOfMode(t,e.CoordMode.COORD3D,r)},getExposedAncestor:function(){var e=this.getParent();return e?e.isExpanded()?this:e.getExposedAncestor():this},isExposed:function(){var e=this.getParent();return!e||e.isExpanded()},isExpanded:function(){return!0},setExpanded:function(e){},getLinkedExposedObjs:function(){for(var t=[],r=0,i=this.getLinkedConnectorCount();r<i;++r){var n=this.getLinkedConnectorAt(r);if(n.isExposed())for(var a=n.getConnectedExposedObjs(),o=0,s=a.length;o<s;++o)a[o]!==this&&e.ArrayUtils.pushUnique(t,a[o])}return t},getExposedContainerBox:function(e,t){return this.getContainerBox(e,t)},getAllAutoScaleRefLengths:function(e,t){return[]},getAllContainingConnectors:function(){return this.getAllChildConnectors?this.getAllChildConnectors():[]},getConnectorLengthMedian:function(t,r){var i=this.getAllContainingConnectors();return e.ChemStructureUtils.getConnectorLengthMedian(i,t,r)}}),n.defineProps(e.ChemObject,[{name:"coordPos2D",dataType:a.INT,scope:i.PropertyScope.PUBLIC,getter:function(){return this.getCoordPos(e.CoordMode.COORD2D)}},{name:"coordPos3D",dataType:a.INT,scope:i.PropertyScope.PUBLIC,getter:function(){return this.getCoordPos(e.CoordMode.COORD3D)}},{name:"renderOptions",dataType:a.OBJECT},{name:"render3DOptions",dataType:a.OBJECT},{name:"overrideRenderOptionItems",dataType:a.ARRAY,scope:i.PropertyScope.PUBLIC},{name:"overrideRender3DOptionItems",dataType:a.ARRAY,scope:i.PropertyScope.PUBLIC}]),n.extend(e.ChemObjList,{getAllContainingConnectors:function(){for(var e=[],t=0,r=this.getItemCount();t<r;++t){var i=this.getItemAt(t);i.getAllContainingConnectors&&(e=e.concat(i.getAllContainingConnectors()))}return e},getAllAutoScaleRefLengths:function(e,t){for(var r=[],i=0,n=this.getItemCount();i<n;++i){var a=this.getItemAt(i);a.getAllAutoScaleRefLengths&&(r=r.concat(a.getAllAutoScaleRefLengths(e,t)))}return r},getExposedContainerBox:function(t,r){for(var i,n=this.toArray(),a=0,o=n.length;a<o;++a){var s=n[a];if(s.isExposed()){var l=s.getExposedContainerBox?s.getExposedContainerBox(t,r):s.getContainerBox?s.getContainerBox(t,r):null;l&&(i=i?e.BoxUtils.getContainerBox(i,l):e.BoxUtils.clone(l))}}return i}}),e.ClassDefineUtils.addStandardCoordSupport(e.ChemObjList),n.extend(e.ChemSpaceElement,{getAllContainingConnectors:function(){return this.getChildren().getAllContainingConnectors()},getAllAutoScaleRefLengths:function(e,t){return this.getChildren().getAllAutoScaleRefLengths(e,t)}}),n.extend(e.ChemSpace,{getAllContainingConnectors:function(){return this.getRoot().getAllContainingConnectors()},getAllAutoScaleRefLengths:function(e,t){return this.getDefAutoScaleRefLength()?[this.getDefAutoScaleRefLength()]:this.getRoot().getAllAutoScaleRefLengths(e,t)}}),n.defineProps(e.ChemObject,[{name:"defAutoScaleRefLength",dataType:a.NUMBER,scope:i.PropertyScope.PUBLIC}]),n.extend(e.BaseStructureConnector,{getBaseCoord:function(t,r){for(var i=e.CoordMode,n=null,a=0,o=t===i.COORD2D?{x:0,y:0}:{x:0,y:0,z:0},s=0,l=this.getConnectedObjCount();s<l;++s){var d=this.getConnectedObjAt(s),u=d.getBaseCoord?d.getBaseCoord(t,r):null;u&&(o=e.CoordUtils.add(o,u),++a)}return a&&(n=e.CoordUtils.divide(o,a)),n},getAbsBaseCoord:function(t,r){for(var i=e.CoordMode,n=null,a=0,o=t===i.COORD2D?{x:0,y:0}:{x:0,y:0,z:0},s=0,l=this.getConnectedObjCount();s<l;++s){var d=this.getConnectedObjAt(s),u=d.getAbsBaseCoord?d.getAbsBaseCoord(t,r):null;u&&(o=e.CoordUtils.add(o,u),++a)}return a&&(n=e.CoordUtils.divide(o,a)),n},getAbsCoordOfMode:function(e,t){return this.getAbsBaseCoord(e,t)},getConnectedExposedObjs:function(){for(var e=this.getConnectedObjs(),t=[],r=0,i=e.length;r<i;++r){var n=e[r].getExposedAncestor();t.indexOf(n)<0&&t.push(n)}return t},getLength:function(t,r){var i=this.getConnectedObjs();if(2!==i.length)return null;var n=i[0].getAbsBaseCoord?i[0].getAbsBaseCoord(t,r):null,a=i[1].getAbsBaseCoord?i[1].getAbsBaseCoord(t,r):null;return e.CoordUtils.getDistance(n,a)},getLength2D:function(t){return this.getLength(e.CoordMode.COORD2D,t)},getLength3D:function(t){return this.getLength(e.CoordMode.COORD3D,t)}}),n.defineProps(e.BaseStructureConnector,[{name:"absCoord2D",dataType:a.HASH,serializable:!1,getter:function(t){return this.getAbsBaseCoord(e.CoordMode.COORD2D,t)}},{name:"absCoord3D",dataType:a.HASH,serializable:!1,getter:function(t){return this.getAbsBaseCoord(e.CoordMode.COORD3D,t)}}]),n.extend(e.ChemStructureConnector,{getAllAutoScaleRefLengths:function(e,t){return[this.getLength(e,t)]}}),n.extend(e.BaseStructureNode,{getBaseCoord:function(e,t){return this.getCoordOfMode(e,t)},getAbsBaseCoord:function(e,t){return this.getAbsCoordOfMode(e,t)},getExposedContainerBox:function(e,t){return this.getContainerBox(e,t)},getExposedContainerBox2D:function(t){var r=this.getExposedContainerBox(e.CoordMode.COORD2D,t);return r.width=r.x2-r.x1,r.height=r.y2-r.y1,r},getExposedContainerBox3D:function(t){var r=this.getExposedContainerBox(e.CoordMode.COORD3D,t);return r.deltaX=r.x2-r.x1,r.deltaY=r.y2-r.y1,r.deltaZ=r.z2-r.z1,r}}),n.extend(e.ChemStructureNode,{getDisplayRichText:function(t,r,i,n,a,o){var s=e.Render;e.ObjUtils.isUnset(r)&&(r=!0);var l,d=s.RichTextUtils.create(),u=this.getRenderOption("customLabel");return l=u?s.RichTextUtils.strToRichText(u):this.getCoreDisplayRichTextItem(t,r,i,n),l&&(r&&(l=this.appendElectronStateDisplayText(l,n,a,o)),l&&(s.RichTextUtils.append(d,l),d.anchorItem=l)),d},getCoreDisplayRichTextItem:function(e,t,r,i){return null},appendElectronStateDisplayText:function(t,r,i,n){var a=e.Render,o=this.getCharge(),s=this.getRadical(),l=a.ChemDisplayTextUtils.createElectronStateDisplayTextSection(o,s,r,i,n);if(l){var d=a.RichTextUtils.createGroup();return a.RichTextUtils.append(d,t),a.RichTextUtils.append(d,l),d.charDirection=e.Render.TextDirection.LTR,d.anchorItem=t,d}return t}}),n.extend(e.AbstractAtom,{getDisplayRichText:function($super,t,r,i,n,a,o){var s=e.Render;e.ObjUtils.isUnset(t)&&(t=s.HydrogenDisplayLevel.DEFAULT);var l=$super(t,r,i,n,a,o),d=0,u=this&&this.getIsotopeId&&"H"!==this.getIsotopeId()?this.getImplicitHydrogenCount():0,c=this.getExplicitHydrogenCount()||0;switch(t){case s.HydrogenDisplayLevel.NONE:d=0;break;case s.HydrogenDisplayLevel.ALL:case s.HydrogenDisplayLevel.IMPLICIT:d=u+c;break;case s.HydrogenDisplayLevel.EXPLICIT:d=c;break;case s.HydrogenDisplayLevel.UNMATCHED_EXPLICIT:this.getImplicitHydrogenCount&&this.getImplicitHydrogenCount()!==c&&(d=c)}return d&&(l=this.appendHydrogenDisplayText(l,d)),l},appendHydrogenDisplayText:function(t,r){var i=e.Render;if(r)if(r>1){var n=i.RichTextUtils.createGroup();n.charDirection=e.Render.TextDirection.LTR;var a=i.RichTextUtils.appendText2(n,"H");i.RichTextUtils.appendText(n,r.toString(),{textType:i.RichText.SUB,refItem:a}),i.RichTextUtils.append(t,n)}else i.RichTextUtils.appendText(t,"H");return t}}),n.extend(e.Atom,{getCoreDisplayRichTextItem:function(i,n,a,o){var s=e.Render,l=s.RichTextUtils.createGroup(),d=this.getIsotopeAlias();this.getSymbol();if(d||this.getSymbol()!==t.Element.UNSET_ELEMENT){var u;d&&e.ChemStructureNodeLabels.ENABLE_ISOTOPE_ALIAS?(u=s.RichTextUtils.createSection(this.getIsotopeAlias(),{charDirection:e.Render.TextDirection.LTR}),l=s.RichTextUtils.append(l,u),l.anchorItem=u):(u=s.RichTextUtils.createSection(this.getSymbol(),{charDirection:e.Render.TextDirection.LTR}),l=s.RichTextUtils.append(l,u),l.anchorItem=u,this.getMassNumber()!==e.Isotope.UNSET_MASSNUMBER&&(l=s.RichTextUtils.insertText(l,0,this.getMassNumber().toString(),{textType:s.RichText.SUP,charDirection:e.Render.TextDirection.LTR,refItem:l.anchorItem}),l.charDirection=e.Render.TextDirection.LTR))}else l=s.RichTextUtils.appendText(l,a&&a.getUnsetElement()||r.UNSET_ELEMENT);return l}}),n.extend(e.Pseudoatom,{getCoreDisplayRichTextItem:function(t,i,n,a){var o,s=e.Render,l=n;return o=this.getLabel(),o||(o=l&&l.getUnsetElement()||r.UNSET_ELEMENT),s.RichTextUtils.createSection(o,{charDirection:e.Render.TextDirection.LTR})}});var s=function(t,r,i){var n,a=e.Render,o=e.IsotopesDataUtil.getIsotopeIdDetail(r);o.massNumber&&(n=a.RichTextUtils.appendText2(t,o.massNumber.toString(),{textType:e.Render.RichText.SUP,charDirection:e.Render.TextDirection.LTR}));var s=a.RichTextUtils.appendText2(t,o.symbol,{charDirection:e.Render.TextDirection.LTR},i);return n&&(n.refItem=s),t.charDirection=e.Render.TextDirection.LTR,t};return n.extend(e.VariableAtom,{getCoreDisplayRichTextItem:function(t,i,n,a){var o,l=e.Render,d=n;if(this.isListEmpty())return o=l.RichTextUtils.strToRichText(d&&d.getVariableAtom()||r.VARIABLE_ATOM),o.charDirection=e.Render.TextDirection.LTR,o;var u=this.getAllowedIsotopeIds()||this.getDisallowedIsotopeIds(),c=this.isDisallowedList();if(o=l.RichTextUtils.createGroup(),o.charDirection=e.Render.TextDirection.LTR,c&&(o=l.RichTextUtils.appendText(o,d.getIsoListDisallowPrefix())),o=l.RichTextUtils.appendText(o,d.getIsoListLeadingBracket()),u&&u.length)for(var h=0,m=u.length;h<m;++h){var g=u[h];g&&(0!=h&&(o=l.RichTextUtils.appendText(o,d.getIsoListDelimiter())),o=s(o,g,0==h))}return o=l.RichTextUtils.appendText(o,d.getIsoListTailingBracket())}}),n.extend(e.StructureConnectionTable,{exposedNodesHasCoord2D:function(e){for(var t=this.getExposedNodes(),r=0,i=t.length;r<i;++r)if(t[r].hasCoord2D(e))return!0;return!1},exposedNodesHasCoord3D:function(e){for(var t=this.getExposedNodes(),r=0,i=t.length;r<i;++r)if(t[r].hasCoord3D(e))return!0;return!1},getExposedNodes:function(){for(var e=[],t=this.getNodes(),r=0,i=t.length;r<i;++r){var n=t[r];if(n.getExposedNodes&&n.isExpanded()){var a=n.getExposedNodes();e=e.concat(a)}else n.isExposed()&&e.push(n)}return e},getExposedConnectors:function(){for(var e=this.getConnectors(),t=this.getNodes(),r=0,i=t.length;r<i;++r){var n=t[r];if(n.getConnectors&&n.isExpanded()){var a=n.getExposedConnectors();e=e.concat(a)}}return e},getExposedContainerBox:function(e,t){var r=this.getExposedNodes();return r.length?this.getNodesContainBox(r,e,t):null},getExposedContainerBox2D:function(t){var r=this.getExposedContainerBox(e.CoordMode.COORD2D,t);return r.width=r.x2-r.x1,r.height=r.y2-r.y1,r},getExposedContainerBox3D:function(t){var r=this.getExposedContainerBox(e.CoordMode.COORD3D,t);return r.deltaX=r.x2-r.x1,r.deltaY=r.y2-r.y1,r.deltaZ=r.z2-r.z1,r},getConnectorLengthMedian:function(t,r){var i=this.getAllContainingConnectors();return e.ChemStructureUtils.getConnectorLengthMedian(i,t,r)},getAllAutoScaleRefLengths:function(e,t){for(var r=this.getAllContainingConnectors(),i=[],n=0,a=r.length;n<a;++n){var o=r[n];if(o&&o.getAllAutoScaleRefLengths){var s=o.getAllAutoScaleRefLengths(e,t);s&&(i=i.concat(s))}}return i}}),n.extend(e.ContentBlock,{getDefCoordPos:function($super,t){return t!==o.COORD3D?e.Render.CoordPos.CORNER_TL:$super(t)}}),n.extend(e.ChemMarker.ChemPropertyMarker,{getDefCoordPos:function($super,t){return t!==o.COORD3D?e.Render.CoordPos.CENTER:$super(t)}}),n.extend(e.StructureFragment,{isExpanded:function(){var e=this.getOverriddenRenderOptions();return!!e&&!!e.expanded},setExpanded:function(e){this.setRenderOption("expanded",e)},getExposedNodes:function(){return this.hasCtab()?this.getCtab().getExposedNodes():[]},getExposedConnectors:function(){return this.hasCtab()?this.getCtab().getExposedConnectors():[]},exposedNodesHasCoord2D:function(e){return!!this.hasCtab()&&this.getCtab().exposedNodesHasCoord2D(e)},exposedNodesHasCoord3D:function(e){return!!this.hasCtab()&&this.getCtab().exposedNodesHasCoord3D(e)},getExposedContainerBox:function(e,t){if(this.hasCtab()){var r=this.getCtab().getExposedContainerBox(e,t);return r||(r=this.getContainerBox(e,t)),r}return this.getContainerBox(e,t)},getConnectorLengthMedian:function(e,t){return this.hasCtab()?this.getCtab().getConnectorLengthMedian(e,t):null},getAutoScaleRefLength:function(e,t){return this.getConnectorLengthMedian(e,t)},getAllAutoScaleRefLengths:function(e,t){return this.hasCtab()?this.getCtab().getAllAutoScaleRefLengths(e,t):null}}),n.extend(e.SubGroup,{getCoreDisplayRichTextItem:function(t,i,n,a){var o=e.Render,s=null,l=this.getAbbr();l||(s=this.getFormulaText()?e.FormulaUtils.textToFormula(this.getFormulaText()):this.getFormula(!1)||this.calcFormula())&&!s.isEmpty()||(l=n&&n.getRgroup()||r.SUBGROUP);var d;if(l)if(l.length<=3)d=o.RichTextUtils.createSection(l),d.charDirection=e.Render.TextDirection.LTR;else{var u=this._indexOfFirstUppercaseLetter(l);u<0&&(u=0),d=o.RichTextUtils.createGroup(),d.charDirection=e.Render.TextDirection.LTR,u>0&&(c=o.RichTextUtils.createSection(l.substring(0,u)),c.charDirection=e.Render.TextDirection.INHERIT,d=o.RichTextUtils.append(d,c));var c=o.RichTextUtils.createSection(l.charAt(u));d=o.RichTextUtils.append(d,c),d.anchorItem=c,u<l.length-1&&(c=o.RichTextUtils.createSection(l.substring(u+1)),c.charDirection=e.Render.TextDirection.INHERIT,d=o.RichTextUtils.append(d,c))}else if(s){d=s.getDisplayRichText(i,n,a);var c=o.RichTextUtils.getFirstNormalTextSection(d);c||(c=d.items[0]),d.anchorItem=c}return d},_indexOfFirstUppercaseLetter:function(e){for(var t=0,r=e.length;t<r;++t){var i=e.charAt(t);if(i>="A"&&i<="Z")return t}return-1},_autoSetSelfCoord:function(t,r){if(!this._isAutoSettingSelfCoord&&!this.getCoordOfMode(t,r)){var i=this.getAnchorNodeCount();if(!(i<=0)){this.beginUpdate();try{this._isAutoSettingSelfCoord=!0;for(var n={},a=0;a<i;++a){var o=this.getAnchorNodeAt(a);o._autoSetSelfCoord&&o._autoSetSelfCoord(t,r);var s=o.getAbsCoordOfMode(t,r);s&&(n=e.CoordUtils.add(n,s))}var l=e.CoordUtils.divide(n,i);this.setAbsCoordOfMode(l,t);for(var d=this.getCoordOfMode(t)||{},i=this.getNodeCount(),a=0;a<i;++a){var o=this.getNodeAt(a),s=o.getCoordOfMode(t,r);s&&(s=e.CoordUtils.substract(s,d),o.setCoordOfMode(s,t))}}finally{this._isAutoSettingSelfCoord=!1,this.endUpdate()}}}},doGetAbsCoord2D:function($super,t){return this._autoSetSelfCoord(e.CoordMode.COORD2D,t),$super(t)},doGetAbsCoord3D:function($super,t){return this._autoSetSelfCoord(e.CoordMode.COORD3D,t),$super(t)},doSetAbsCoord2D:function($super,t){return this._autoSetSelfCoord(e.CoordMode.COORD2D),$super(t)},doSetAbsCoord3D:function($super,t){return this._autoSetSelfCoord(e.CoordMode.COORD3D),$super(t)}}),n.extend(e.MolecularFormula,{getDisplayRichText:function(t,r,i,n,a){var o=e.Render;return e.ObjUtils.isUnset(t)&&(t=!0),o.ChemDisplayTextUtils.formulaToRichText(this,t,null,i,r,n,a)},getDisplayText:function(t,r,i){var n=this.getDisplayRichText();return e.Render.RichTextUtils.toText(n)}}),n.extend(e.Molecule,{afterInitialization:function(){this.setExpanded(!0)}}),n.extend(e.CompositeMolecule,{getExposedContainerBox:function(t,r){var i=null,n=this.getPropStoreFieldValue("subMolecules");if(n)for(var a=0,o=n.length;a<o;++a){var s=n[a],l=s.getExposedContainerBox(t,r);l&&(i=i?e.BoxUtils.getContainerBox(i,l):e.BoxUtils.clone(l))}return i},getAllAutoScaleRefLengths:function(e,t){var r=[],i=this.getPropStoreFieldValue("subMolecules");if(i)for(var n=0,a=i.getItemCount();n<a;++n){var o=i.getObjAt(n),s=o.getAllAutoScaleRefLengths(e,t);s&&(r=r.concat(s))}return r}}),e}},function(e,t,r){"use strict";var i=r(0).Class,n=r(0).ObjectEx,a=r(0).DataType;e.exports=function(e){return e.Render={},e.Render.CoordSystem={CHEM:0,CONTEXT:1,SCREEN:2},e.Render.RendererType={R2D:2,R3D:3},e.Render.CoordPos={CENTER:0,CORNER_TL:21,DEFAULT:0},e.Render.DEF_ATOM_ATOMIC_NUM=6,e.Render.MoleculeDisplayType={SKELETAL:1,CONDENSED:2,DEFAULT:1},e.Render.Molecule2DDisplayType=e.Render.MoleculeDisplayType,e.Render.NodeLabelDisplayMode={HIDDEN:-1,SHOWN:1,SMART:0,DEFAULT:0},e.Render.HydrogenDisplayLevel={NONE:0,EXPLICIT:1,UNMATCHED_EXPLICIT:2,IMPLICIT:12,ALL:10,LABELED:30,DEFAULT:1},e.Render.TextDirection={DEFAULT:0,LTR:1,RTL:3,TTB:2,BTT:4,INHERIT:10},e.Render.TextAlign={DEFAULT:0,LEFT:1,RIGHT:2,TOP:3,BOTTOM:4,CENTER:5,LEADING:10,TRAILING:11,getAbsAlign:function(t,r){var i=t,n=e.Render.TextAlign,a=e.Render.TextDirection;if(t===n.LEADING||t===n.TRAILING){var o=t==n.LEADING;switch(r){case a.RTL:i=o?n.RIGHT:n.LEFT;break;case a.TTB:i=o?n.TOP:n.BOTTOM;break;case a.BTT:i=o?n.BOTTOM:n.TOP;break;case a.LTR:default:i=o?n.LEFT:n.RIGHT}}return i}},e.Render.BoxXAlignment={LEFT:0,RIGHT:1,CENTER:2},e.Render.BoxYAlignment={TOP:0,BOTTOM:1,CENTER:2},e.Render.TextBoxAlignmentMode={BOX:0,ANCHOR:1},e.Render.BondRenderType={SINGLE:0,DOUBLE:1,TRIPLE:2,QUAD:3,DASHED:4,DASHED_DOUBLE:5,DASHED_TRIPLE:6,SOLID_DASH:7,ARROWED:8,ARROWED_INV:9,HASHED:10,BOLD:11,BOLD_DOUBLE:12,BOLD_TRIPLE:13,BOLD_QUAD:14,BOLD_DASH:16,WEDGED_SOLID:20,WEDGED_SOLID_INV:21,WEDGED_HOLLOW:22,WEDGED_HOLLOW_INV:23,WEDGED_HASHED:24,WEDGED_HASHED_INV:25,WEDGED_SOLID_BOTH:26,WEDGED_HOLLOW_BOTH:27,WAVY:30,SCISSORS_DOUBLE:40},e.Render.ChargeMarkRenderType={NUM_WITH_SYMBOL:1,DEFAULT:1,CIRCLE_AROUND:3},e.Render.Render3DGraphicQuality={EXTREME_LOW:1,LOW:2,MEDIUM:3,HIGH:4,EXTREME_HIGH:5},e.Render.Molecule3DDisplayType={WIRE:31,STICKS:32,BALL_STICK:33,SPACE_FILL:34,DEFAULT:33},e.Render.Bond3DRenderMode={NONE:0,WIRE:1,MULTI_WIRE:2,CYLINDER:3,MULTI_CYLINDER:4,isWireMode:function(t){var r=e.Render.Bond3DRenderMode;return t===r.WIRE||t===r.MULTI_WIRE},isCylinderMode:function(t){var r=e.Render.Bond3DRenderMode;return t===r.CYLINDER||t===r.MULTI_CYLINDER}},e.Render.Bond3DSpliceMode={UNSPLIT:1,MID_SPLIT:2,WEIGHTING_SPLIT:3},e.Render.Bond3DRenderType={SINGLE:1,DOUBLE:2,TRIPLE:3,DASH:-1,SOLID_DASH:-2},e.Render.Node3DRenderMode={NONE:0,BALL:1,SPACE:2},e.Render.MetaShapeType={POINT:0,CIRCLE:1,LINE:2,RECT:3,ARC:5,POLYLINE:11,POLYGON:10,SPHERE:101,CYLINDER:102,COMPOSITE:-1},e.Render.BoundShapeType=e.Render.MetaShapeType,e.Render.ObjectUpdateType={MODIFY:0,ADD:1,REMOVE:2,CLEAR:3},e.Render.AbstractRenderer=i.create(n,{CLASS_NAME:"Kekule.Render.AbstractRenderer",RENDER_CACHE_FIELD:"__$renderCache$__",initialize:function($super,e,t,r){$super(),this.setPropValue("chemObj",e,!0),r&&this.setParent(r),this.setDrawBridge(t),this.setBubbleEvent(!0),this._suspendUpdateStatus=0,this._suspendUpdateInfos=[]},finalize:function($super){var e=this.getPropStoreFieldValue("boundInfoRecorder");e&&e.finalize(),this.setPropValue("chemObj",null,!0),this.setDrawBridge(null),$super()},initProperties:function(){this.defineProp("chemObj",{dataType:"Kekule.ChemObject",serializable:!1,setter:null}),this.defineProp("drawBridge",{dataType:a.OBJECT,serializable:!1}),this.defineProp("parent",{dateType:a.OBJECT,serializable:!1}),this.defineProp("parentRenderer",{dateType:"Kekule.Render.AbstractRenderer",serializable:!1,getter:function(){var t=this.getParent();return t instanceof e.Render.AbstractRenderer?t:null},setter:function(e){this.setParent(e)}}),this.defineProp("redirectContext",{dataType:a.OBJECT,serializable:!1}),this.defineProp("canModifyTargetObj",{dataType:a.BOOL,serializable:!1,getter:function(){var t=this.getPropStoreFieldValue("canModifyTargetObj");if(e.ObjUtils.isUnset(t)){var r=this.getParent();r&&r.getCanModifyTargetObj&&(t=r.getCanModifyTargetObj())}return t}}),this.defineProp("boundInfoRecorder",{dataType:"Kekule.Render.BoundInfoRecorder",serializable:!1,setter:null,getter:function(e){if(this.isRootRenderer()){var t=this.getPropStoreFieldValue("boundInfoRecorder");return t||e||(t=this._createBoundInfoRecorder()),t}var r=this.getRootRenderer();return r&&r.getBoundInfoRecorder(e)}}),this.defineEvent("clear"),this.defineEvent("updateBasicDrawObject")},_createBoundInfoRecorder:function(){var t=this.getPropStoreFieldValue("boundInfoRecorder");t&&t.finalize();var r=new e.Render.BoundInfoRecorder(this);return this.setPropStoreFieldValue("boundInfoRecorder",r),r},isRootRenderer:function(){return!this.getParentRenderer()},getHigherLevelObj:function(){return this.getParent()},getRootRenderer:function(){if(this.isRootRenderer())return this;var e=this.getParentRenderer();return e?e.getRootRenderer():this},getRendererType:function(){return e.Render.RendererType.R2D},getCoordMode:function(){return this.getRendererType()===e.Render.RendererType.R3D?e.CoordMode.COORD3D:e.CoordMode.COORD2D},_getRenderSortIndex:function(){return 0},getRenderCache:function(e){var t=this.getExtraProp(e,this.RENDER_CACHE_FIELD);return t||(t={},this.setExtraProp(e,this.RENDER_CACHE_FIELD,t)),t},beginDraw:function(e,t,r){var i=this.getDrawBridge();i.prepareContext&&i.prepareContext(e)},endDraw:function(e,t,r){var i=this.getDrawBridge();i.renderContext&&i.renderContext(e)},updateDrawInfoInCache:function(e,t,r,i,n){var a=this.getRenderCache(t);t&&(a.context=t),r&&(a.baseCoord=r),e&&(a.chemObj=e),i&&(a.options=i),n&&(a.realDrawOptions=n)},_isCurrChemObjNeedToBeDrawn:function(e,t){for(var r=this.getChemObj(),i=0,n=e.length;i<n;++i){var a=e[i];if(a===r||a.isChildOf(r))return!0}return!1},getAutoBaseCoord:function(e){return this.doGetAutoBaseCoord(e)},doGetAutoBaseCoord:function(e){return null},getCachedDrawOptions:function(e){return this.getRenderCache(e).options},getCachedDrawnElem:function(e){return this.getRenderCache(e).drawnElem},draw:function(t,r,i){try{this.__isDrawing=!0,this.getBoundInfoRecorder();var n,a={},o=this.getParentRenderer();if(o)var n=o.getRenderCache().options;n?(a=Object.create(n),a=Object.extend(a,i)):a=Object.create(i||null);var s=this.getChemObj(),l=a.partialDrawObjs;if(l&&!this._isCurrChemObjNeedToBeDrawn(l,t))return null;var d=this.getRendererType()===e.Render.RendererType.R3D?"getRender3DOptions":"getRenderOptions",u=s[d]?s[d]():null;d=this.getRendererType()===e.Render.RendererType.R3D?"getOverriddenRender3DOptions":"getOverriddenRenderOptions";var c=s[d]?s[d]():null;a=e.Render.RenderOptionUtils.mergeRenderOptions(u||{},a),this.getRenderCache().options=a,a=e.Render.RenderOptionUtils.mergeRenderOptions(c||{},a),this.updateDrawInfoInCache(this.getChemObj(),t,r,i,a);var h=this.isRootRenderer();this.invokeEvent("prepareDrawing",{context:t,obj:this.getChemObj()}),h&&this.beginDraw(t,r,a);var m=this.doDraw(t,r,a);this.getRenderCache(t).drawnElem=m,h&&this.endDraw(t,r,a),this.invokeEvent("draw",{context:t,obj:this.getChemObj()})}finally{this.__isDrawing=!1}return m},doDraw:function(e,t,r){return this.doDrawSelf(e,t,r)},doDrawSelf:function(e,t,r){return null},redraw:function(e){var t=this.isRootRenderer();if(t){var r=this.getRenderCache(e)||{};this.beginDraw(e,r.baseCoord,r.options)}var i=this.doRedraw(e);return this.getRenderCache(e).drawnElem=i,t&&this.endDraw(e,r.baseCoord,r.options),i},doRedraw:function(e){var t=this.getRenderCache(e);return this.draw(e,t.baseCoord,t.options)},canModifyGraphic:function(e){var t=this.getDrawBridge();return!!t.canModifyGraphic&&t.canModifyGraphic(e)},beginUpdateRenderer:function(){++this._suspendUpdateStatus},endUpdateRenderer:function(){--this._suspendUpdateStatus,this._suspendUpdateStatus<=0&&(this._suspendUpdateStatus=0),this.isUpdatingRenderer()||this.doEndUpdateRenderer()},doEndUpdateRenderer:function(){this.updateEx(this._suspendUpdateInfos),this._suspendUpdateInfos=[]},isUpdatingRenderer:function(){return this._suspendUpdateStatus>0},updateEx:function(t){var r=!0;if(this.isUpdatingRenderer())return this._suspendUpdateInfos||(this._suspendUpdateInfos=[]),this._mergeRendererUpdateInfo(this._suspendUpdateInfos,t),!0;if(!this.canModifyGraphic(s)){if(this.isRootRenderer()){for(var i=[],n=0,a=t.length;n<a;++n){var o=t[n],s=o.context;e.ArrayUtils.pushUnique(i,s)}for(var n=0,a=i.length;n<a;++n){this.getDrawBridge().clearContext(s);var l=this.getRenderCache(s);this.draw(s,l.baseCoord,l.options)}return!0}return this.getParentRenderer().updateEx(t)}for(var n=0,a=t.length;n<a;++n){for(var o=t[n],s=o.context,d=0,u=o.items.length;d<u;++d){var c=o.items[d];if(!(r=r&&this.doUpdate(s,c.updatedObjDetails,c.updateType)))break}if(!r)break}return r},_mergeRendererUpdateInfo:function(e,t){for(var r=0,i=t.length;r<i;++r){var n=t[r],a=this._indexOfContextInRendererUpdateInfos(n.context,e);if(a<0)e.push(n);else{var o=e[a];o.items=o.items.concat(n.items)}}return e},_indexOfContextInRendererUpdateInfos:function(e,t){for(var r=0,i=t.length;r<i;++r){if(t[r].context===e)return r}return-1},update:function(e,t,r){for(var i=[],n=0,a=t.length;n<a;++n){var o=t[n].obj;this.isChemObjRenderedBySelf(e,o)&&i.push(t[n])}return!i.length||this.updateEx([{context:e,items:[{updateType:r,updatedObjDetails:i}]}])},doUpdate:function(e,t,r){return this.doUpdateSelf(e,t,r)},doUpdateSelf:function(t,r,i){if(this.canModifyGraphic(t)){for(var n=!1,a=this.getChemObj(),o=0,s=r.length;o<s;++o){if(r[o].obj===a){n=!0;break}}if(n){if(i===e.Render.ObjectUpdateType.CLEAR)return this.doClear(t);this.doClear(t);var l=this.getRenderCache(t);return this.draw(t,l.baseCoord,l.options)}}return!1},_extractObjsOfUpdateObjDetails:function(t){return e.Render.UpdateObjUtils._extractObjsOfUpdateObjDetails(t)},_createUpdateObjDetailsFromObjs:function(t){return e.Render.UpdateObjUtils._createUpdateObjDetailsFromObjs(t)},addNew:function(t,r){var i=this._createUpdateObjDetailsFromObjs(r);return this.update(t,i,e.Render.ObjectUpdateType.ADD)},modify:function(t,r){return this.update(t,r,e.Render.ObjectUpdateType.MODIFY)},remove:function(t,r){var i=this._createUpdateObjDetailsFromObjs(r);return this.update(t,i,e.Render.ObjectUpdateType.REMOVE)},clear:function(e){this.doClear(e);this.invokeEvent("clear",{context:e,obj:this.getChemObj()})},doClear:function(e){return!!this.canModifyGraphic()&&this.doClearSelf(e)},doClearSelf:function(e){if(!this.canModifyGraphic())return!1;var t=this.getRenderCache(e).drawnElem;if(t)try{this.getDrawBridge().removeDrawnElem(e,t)}catch(e){}this.getRenderCache(e).drawnElem=null},estimateObjBox:function(e,t,r){var i=this.doEstimateObjBox(e,t,r);return this._fillBoxDefaultValue(i,this.getRendererType())},doEstimateObjBox:function(e,t,r){return this.doEstimateSelfObjBox(e,t,r)},doEstimateSelfObjBox:function(e,t,r){return null},estimateRenderBox:function(e,t,r,i){var n=this.doEstimateRenderBox(e,t,r,i);return n&&(n=this._fillBoxDefaultValue(n,this.getRendererType())),n},doEstimateRenderBox:function(e,t,r,i){return null},_fillBoxDefaultValue:function(t,r){t||(t={});var i=r===e.Render.RendererType.R3D,n={x1:t.x1||0,x2:t.x2||0,y1:t.y1||0,y2:t.y2||0};return i&&(n.z1=t.z1||0,n.z2=t.z2||0),n},transformCoordToObj:function(e,t,r){return this.doTransformCoordToObj(e,t,r)},doTransformCoordToObj:function(e,t,r){return r},transformCoordToContext:function(e,t,r){return this.doTransformCoordToContext(e,t,r)},doTransformCoordToContext:function(e,t,r){return r},transformContextCoordToScreen:function(e,t){return this.doTransformContextCoordToScreen(e,t)},doTransformContextCoordToScreen:function(e,t){var r=this.getDrawBridge();return r&&r.transformContextCoordToScreen?r.transformContextCoordToScreen(e,t):t},basicDrawObjectUpdated:function(e,t,r,i,n){this.invokeEvent("updateBasicDrawObject",{context:e,obj:t,parentObj:r,boundInfo:i,updateType:n})},isChemObjRenderedBySelf:function(e,t){return t===this.getRenderCache(e).chemObj},isChemObjRenderedDirectlyBySelf:function(e,t){return!(!t||!this.getRenderCache(e).chemObj)&&t===this.getRenderCache(e).chemObj},getObjRenderBound:function(e,t,r){var i=this.getBoundInfoRecorder(),n=t;return r&&t.getCoordStickTarget&&(n=t.getCoordStickTarget()||n),i&&i.getBound(e,n)},getStickingTargetRenderBound:function(e,t){var r;if(t.getCoordStickTarget&&(r=t.getCoordStickTarget()),r){var i=this.getBoundInfoRecorder();return i&&i.getBound(e,r,!0)}return null},createBoundInfo:function(t,r,i){return e.Render.MetaShapeUtils.createShapeInfo(t,r,i)},createPointBoundInfo:function(t){return this.createBoundInfo(e.Render.BoundShapeType.POINT,[t])},createCircleBoundInfo:function(t,r){return this.createBoundInfo(e.Render.BoundShapeType.CIRCLE,[t],{radius:r})},createArcBoundInfo:function(t,r,i,n,a,o){return this.createBoundInfo(e.Render.BoundShapeType.ARC,[t],{radius:r,startAngle:i,endAngle:n,anticlockwise:a,width:o})},createLineBoundInfo:function(t,r,i,n){var a=24;return n?(a=8,this.createBoundInfo(e.Render.BoundShapeType.LINE,[t,r],{width:a})):this.createBoundInfo(e.Render.BoundShapeType.LINE,[t,r],{width:a})},createRectBoundInfo:function(t,r){return t.x=t.x-9,t.y=t.y-6,r.x=r.x+9,r.y=r.y+6,this.createBoundInfo(e.Render.BoundShapeType.RECT,[t,r])},createSphereBoundInfo:function(t,r){return this.createBoundInfo(e.Render.BoundShapeType.SPHERE,[t],{radius:r})},createCylinderBoundInfo:function(t,r,i){return this.createBoundInfo(e.Render.BoundShapeType.CYLINDER,[t,r],{radius:i})}}),e.ClassDefineUtils.addExtraObjMapSupport(e.Render.AbstractRenderer),e.Render.DummyRenderer=i.create(e.Render.AbstractRenderer,{CLASS_NAME:"Kekule.Render.DummyRenderer",draw:function(e,t,r){},redraw:function(e){}}),e.Render.CompositeRenderer=i.create(e.Render.AbstractRenderer,{CLASS_NAME:"Kekule.Render.CompositeRenderer",initProperties:function(){this.defineProp("targetChildObjs",{dataType:a.ARRAY,serializable:!1}),this.defineProp("childRendererMap",{dataType:a.OBJECT,serializable:!1,getter:function(){var t=this.getPropStoreFieldValue("childRendererMap");return t||(t=new e.MapEx(!0),this.setPropStoreFieldValue("childRendererMap",t)),t}})},finalize:function($super){this.reset(),$super()},_getRenderSortIndex:function($super){for(var e=$super(),t=this.prepareChildRenderers(),r=0,i=t.length;r<i;++r){var n=t[r],a=n._getRenderSortIndex();a>e&&(e=a)}return e},doEstimateObjBox:function($super,t,r,i){for(var n=$super(t,r,i),a=this.prepareChildRenderers(),o=e.BoxUtils,s=0,l=a.length;s<l;++s){var d=a[s];if(d){var u=d.estimateObjBox(t,r,i);u&&(n=n?o.getContainerBox(n,u):o.clone(u))}}return n},isChemObjRenderedBySelf:function($super,e,t){var r=$super(e,t);if(!r)for(var i=this.getChildRenderers(),n=0,a=i.length;n<a;++n){var o=i[n];if(o.isChemObjRenderedBySelf(e,t))return!0}if(!r){this.refreshChildObjs();var s=this.getTargetChildObjs();r=s&&s.indexOf(t)>=0}return r},isChemObjRenderedDirectlyBySelf:function($super,e,t){return $super(e,t)},doSetRedirectContext:function($super,e){$super(e);var t=this.getChildRenderers();if(t&&t.length)for(var r=0,i=t.length;r<i;++r)t[r].setRedirectContext(e)},getChildObjs:function(){var e=this.getChemObj();return e&&e.getAttachedMarkers?[].concat(e.getAttachedMarkers()||[]):[]},prepareChildObjs:function(){var e=this.getTargetChildObjs();return e||(this.setTargetChildObjs(this.getChildObjs()),this.getTargetChildObjs())},refreshChildObjs:function(){this.setTargetChildObjs(null),this.prepareChildObjs()},getChildRenderers:function(){return this.getChildRendererMap().getValues()},getRendererForChild:function(t,r){var i=this.getRendererType()===e.Render.RendererType.R3D?e.Render.get3DRendererClass:e.Render.get2DRendererClass,n=this.getChildRendererMap(),a=n.get(t);if(!a&&r){var o=i(t)||e.Render.DummyRenderer,a=o?new o(t,this.getDrawBridge(),this):null;n.set(t,a),a.setRedirectContext(this.getRedirectContext())}return a},prepareChildRenderers:function(){for(var e=this.getChildRendererMap(),t=this.prepareChildObjs()||[],r=e.getKeys(),i=0,n=r.length;i<n;++i){var a=r[i];t.indexOf(a)<0&&e.remove(a)}for(var i=0,n=t.length;i<n;++i){var o=t[i];this.getRendererForChild(o,!0)}return e.getValues()},releaseChildRenderers:function(){var e=this.getChildRendererMap(),t=e.getValues();if(t){for(var r=0,i=t.length;r<i;++r)t[r].finalize();e.clear()}},hasChildRenderers:function(){var e=this.getChildRendererMap().getValues();return e&&e.length},prepare:function(){this.prepareChildObjs(),this.prepareChildRenderers()},reset:function(){this.setTargetChildObjs(null),this.releaseChildRenderers()},_needWholelyDraw:function(e,t){var r=this.getChemObj();return!e||e.indexOf(r)>=0},doDraw:function($super,e,t,r){this.refreshChildObjs(),this.prepareChildRenderers();var i=Object.create(r);if(r.partialDrawObjs&&this._needWholelyDraw(r.partialDrawObjs,e)&&(i.partialDrawObjs=null),this.getTargetChildObjs().length){var n=this.doDrawSelf(e,t,i),a=this.doDrawChildren(e,t,i);return n&&this.addToDrawGroup(n,a),a}return $super(e,t,i)},doDrawChildren:function(t,r,i){var n=this.createDrawGroup(t),a=this.getChildRenderers();this._sortChildRenderers(a);var o=Object.create(i);if(this.getRenderCache(t).childDrawOptions=o,a.length>1)for(var s=0,l=a.length;s<l;++s)if(a[s]instanceof e.Render.TextBasedChemMarker2DRenderer){var d=a.splice(s,1);a.unshift(d[0])}for(var s=0,l=a.length;s<l;++s){var u=a[s],c=u.draw(t,null,o);n&&c&&this.addToDrawGroup(c,n)}return n},_sortChildRenderers:function(e){e.sort(function(e,t){return e._getRenderSortIndex()-t._getRenderSortIndex()})},doClear:function($super,e){return $super(e),this.hasChildRenderers()&&this.doClearChildren(e),!0},doClearChildren:function(e){for(var t=this.getChildRendererMap().getValues(),r=0,i=t.length;r<i;++r)t[r]&&t[r].clear(e)},doUpdate:function($super,e,t,r){return this.refreshChildObjs(),$super(e,t,r),this.getTargetChildObjs().length&&this.doUpdateChildren(e,t,r),!0},doUpdateChildren:function(t,r,i){for(var n=e.Render.UpdateObjUtils._extractObjsOfUpdateObjDetails(r),a=this.getTargetChildObjs()||[],o=this.getChildRendererMap(),s=e.ArrayUtils.toArray(n),l=new e.MapEx(!1),d=[],u=!1,c=0,h=s.length;c<h;++c){var m=s[c];this.isChemObjRenderedDirectlyBySelf(t,m)&&(u=!0)}if(u)return this.doClear(t),this.redraw(t),!0;for(var c=0,h=s.length;c<h;++c){var m=s[c],g=o.get(m);if(g)i===e.Render.ObjectUpdateType.REMOVE?(g.clear(),o.remove(m)):(e.ArrayUtils.pushUnique(d,g),T=[m],l.set(g,T));else{var f=this._getRenderersForChildObj(t,m);if(!f.length&&a.indexOf(m)>=0){var p=this.getRendererForChild(m,!0),C=p.draw(t,null,this.getRenderCache(t).childDrawOptions);if(C){var b=this.getCachedDrawnElem(t);b&&this.addToDrawGroup(C,b)}}for(var E=0,N=f.length;E<N;++E){var g=f[E],T=l.get(g);T||(d.push(g),T=[],l.set(g,T)),T.push(m)}}}for(var O=!0,c=0,h=d.length;c<h;++c){var g=d[c],_=l.get(g),S=e.Render.UpdateObjUtils._createUpdateObjDetailsFromObjs(_),p=g.update(t,S,i);O=O&&p}return O},_getRenderersForChildObj:function(e,t){for(var r=[],i=this.getChildRenderers(),n=0,a=i.length;n<a;++n){var o=i[n];o.isChemObjRenderedBySelf(e,t)&&r.push(o)}return r}}),e.Render.Renderer2DFactory=e.FactoryUtils.createSimpleFactory(e.FactoryUtils.MATCH_BY_CLASS),e.Render.get2DRendererClass=function(t){var r=t instanceof n?t.getClass():t;return e.Render.Renderer2DFactory.getClass(r)},e.Render.Renderer3DFactory=e.FactoryUtils.createSimpleFactory(e.FactoryUtils.MATCH_BY_CLASS),e.Render.get3DRendererClass=function(t){var r=t instanceof n?t.getClass():t;return e.Render.Renderer3DFactory.getClass(r)},e.Render.DrawBridgeManager=i.create({CLASS_NAME:"Kekule.Render.DrawBridgeManager",initialize:function(){this._items=[],this._preferredItem=null},_indexOfBridgeClass:function(e){for(var t=0,r=this._items.length;t<r;++t){if(this._items[t].bridgeClass===e)return t}return-1},_sortItems:function(){this._items.sort(function(e,t){return(e.priorityLevel||0)-(t.priorityLevel||0)})},_reselectPreferred:function(){this._sortItems();for(var e=this._items.length-1;e>=0;--e){var t=this._items[e];if(t.isSupported)return this._preferredItem=t,t}return this._preferredItem=null,null},register:function(e,t){t||(t=0);var r,i=this._indexOfBridgeClass(e);return i>=0?(r=this._items[i],r.priorityLevel=t):(r={bridgeClass:e,priorityLevel:t},r.isSupported=!!e.isSupported&&e.isSupported(),this._items.push(r)),this._sortItems(),(!this._preferredItem||this._preferredItem.priorityLevel<t)&&r.isSupported&&(this._preferredItem=r),r},unregister:function(e){var t=null,r=this._indexOfBridgeClass(e);return r>=0&&(t=this._items[r],this._items.splice(r,1),t===this._preferredItem&&this._reselectPreferred()),t},getPreferredBridgeClass:function(){return this._preferredItem?this._preferredItem.bridgeClass:null},getPreferredBridgeInstance:function(){var e=this.getPreferredBridgeClass();return e?new e:null}}),e.Render.DrawBridge2DMananger=new e.Render.DrawBridgeManager,e.Render.DrawBridge3DMananger=new e.Render.DrawBridgeManager,e}},function(e,t,r){"use strict";r(0).Class,r(0).ClassEx,r(0).ObjectEx,r(0).DataType;e.exports=function(e){var t=e.Render;t.atomColorSets={jmol:["#000099","#FFFFFF","#D9FFFF","#CC80FF","#C2FF00","#FFB5B5","#909090","#3050F8","#FF0D0D","#90E050","#B3E3F5","#AB5CF2","#8AFF00","#BFA6A6","#F0C8A0","#FF8000","#FFFF30","#1FF01F","#80D1E3","#8F40D4","#3DFF00","#E6E6E6","#BFC2C7","#A6A6AB","#8A99C7","#9C7AC7","#E06633","#F090A0","#50D050","#C88033","#7D80B0","#C28F8F","#668F8F","#BD80E3","#FFA100","#A62929","#5CB8D1","#702EB0","#00FF00","#94FFFF","#94E0E0","#73C2C9","#54B5B5","#3B9E9E","#248F8F","#0A7D8C","#006985","#C0C0C0","#FFD98F","#A67573","#668080","#9E63B5","#D47A00","#940094","#429EB0","#57178F","#00C900","#70D4FF","#FFFFC7","#D9FFC7","#C7FFC7","#A3FFC7","#8FFFC7","#61FFC7","#45FFC7","#30FFC7","#1FFFC7","#00FF9C","#00E675","#00D452","#00BF38","#00AB24","#4DC2FF","#4DA6FF","#2194D6","#267DAB","#266696","#175487","#D0D0E0","#FFD123","#B8B8D0","#A6544D","#575961","#9E4FB5","#AB5C00","#754F45","#428296","#420066","#007D00","#70ABFA","#00BAFF","#00A1FF","#008FFF","#0080FF","#006BFF","#545CF2","#785CE3","#8A4FE3","#A136D4","#B31FD4","#B31FBA","#B30DA6","#BD0D87","#C70066","#CC0059","#D1004F","#D90045","#E00038","#E6002E","#EB0026","#000000","#000000"],cpk2D:["#000000","#000000","#FFC0CB","#B22222",null,"#00FF00","#000000","#8F8FFF","#F00000","#DAA520",null,"#0000FF","#228B22","#808090","#DAA520","#FFA500","#FFC832","#00FF00",null,"#0000FF","#808090","#808090","#808090","#808090","#808090","#808090","#FFA500","#A52A2A","#A52A2A","#A52A2A","#A52A2A"]};var r=t.atomColorSets.cpk2D,i=t.atomColorSets.jmol;return r[35]="#A52A2A",r[47]="#808090",r[53]="#A020F0",r[56]="#FFA500",r[79]="#DAA520",r.SubGroup=i.SubGroup="#0000CC",t.atom3DColors=e.Render.atomColorSets.jmol,t.atom2DColors=e.Render.atomColorSets.cpk2D,t.atomColors=[],t.atomColors[t.RendererType.R2D]=t.atom2DColors,t.atomColors[t.RendererType.R3D]=t.atom3DColors,e}},function(e,t,r){"use strict";var i=(r(0).Class,r(0).ClassEx,r(0).ObjectEx,r(0).DataType);e.exports=function(e){return e.Render.RichText={SECTION:"section",GROUP:"group",LINES:"lines",SUP:"superscript",SUB:"subscript",NORMAL:"normal"},e.Render.RichTextUtils={STYLE_PROPS:["fontSize","fontFamily","fontWeight","fontStyle","color","opacity"],create:function(){return e.Render.RichTextUtils.createGroup()},createGroup:function(e,t){var r={role:e||"group",items:[]};if(t)for(var i in t)t.hasOwnProperty(i)&&(r[i]=t[i]);return r},createSection:function(e,t){var r={text:e};if(t)for(var i in t)t.hasOwnProperty(i)&&(r[i]=t[i]);return r},strToRichText:function(t,r){t||(t="");var i=e.Render.RichTextUtils,n=t.split("\n");if(n.length<=1)return e.Render.RichTextUtils.appendText(i.create(),t,r);for(var a=i.createGroup(e.Render.RichText.LINES),o=0,s=n.length;o<s;++o){var l=n[o]||" ";i.appendText(a,l,r)}return a},insertText:function(t,r,i,n,a){var o=e.Render.RichTextUtils.createSection(i,n);return t.items.splice(r,0,o),a&&(t.anchorItem=o),t},appendText:function(t,r,i,n){var a=e.Render.RichTextUtils.createSection(r,i);return t.items.push(a),n&&(t.anchorItem=a),t},appendText2:function(t,r,i,n){var a=e.Render.RichTextUtils.createSection(r,i);return t.items.push(a),n&&(t.anchorItem=a),a},insert:function(e,t,r){return e.items.splice(t,0,r),e},append:function(e,t){return e.items.push(t),e},appendItems:function(t,r){return t.items=t.items.concat(e.ArrayUtils.toArray(r)),t},getItemType:function(t){return t.items?t.role:e.Render.RichText.SECTION},getItemRole:function(t){var r=e.Render.RichText;return e.Render.RichTextUtils.getItemType(t)===r.GROUP?r.GROUP:r.SECTION},getItemTextType:function(t){return t.textType||e.Render.RichText.NORMAL},isSuperscript:function(t){return e.Render.RichTextUtils.getItemTextType(t)==e.Render.RichText.SUP},isSubscript:function(t){return e.Render.RichTextUtils.getItemTextType(t)==e.Render.RichText.SUB},isGroup:function(t){return e.Render.RichTextUtils.getItemType(t)===e.Render.RichText.GROUP},isSection:function(t){return e.Render.RichTextUtils.getItemType(t)===e.Render.RichText.SECTION},getFirstNormalTextSection:function(t){for(var r=0,i=t.items.length;r<i;++r){var n=t.items[r];if(e.Render.RichTextUtils.getItemTextType(n)===e.Render.RichText.NORMAL)return n}return null},getActualRefItem:function(e,t){var r=e.refItem;if(!r&&t.items.length>1){var i=t.items.indexOf(e);r=i>0?t.items[i-1]:0==i?t.items[1]:null}return r},getFinalAnchorItem:function(t){return t.anchorItem?e.Render.RichTextUtils.getFinalAnchorItem(t.anchorItem):t},tidy:function(t){for(var r=e.Render.RichTextUtils.createGroup(t.role),i=-1,n=0,a=t.items.length;n<a;++n){var o=t.items[n];if(o.items){var s=e.Render.RichTextUtils.tidy(o);if(1==s.items.length){var l=Object.extend({},s);delete l.items,delete l.role,l=Object.extend(l,s.items[0]),o=l}else if(s.items.length>0){++i,r.items.push(s);continue}}var d=!1;if(i>=0){var u=r.items[i];u.items||e.ObjUtils.equal(o,u,["text"])&&(u.text+=o.text,d=!0)}d||(++i,r.items.push(Object.extend({},o)))}return r},clone:function(t){var r={};if(Object.extend(r,t),t.items){r.items=[];for(var i=0,n=t.items.length;i<n;++i){var a={};a=e.Render.RichTextUtils.clone(t.items[i]),r.items.push(a)}}if(r.items){if(t.anchorItem){var o=t.items.indexOf(t.anchorItem);r.anchorItem=o>=0?r.items[o]:null}for(var i=0,n=r.items.length;i<n;++i){var s=t.items[i],a=r.items[i];if(s.refItem){var o=t.items.indexOf(s.refItem);a.refItem=o>=0?r.items[o]:null}}}return r},toText:function(t){var r="";if(!t.items)return t.text||"";for(var i=0,n=t.items.length;i<n;++i){var a=t.items[i];a.items?r+=e.Render.RichTextUtils.toText(a):a.text&&(r+=a.text)}return r},_toDebugHtml:function(t){if(!t.items)return t.text;for(var r="",i=0,n=t.items.length;i<n;++i){var a=t.items[i];if(a.items)r+=e.Render.RichTextUtils._toDebugHtml(a);else if(a.text)switch(a.textType){case e.Render.RichText.SUB:r+="<sub>"+a.text+"</sub>";break;case e.Render.RichText.SUP:r+="<sup>"+a.text+"</sup>";break;default:r+=a.text}}return r},toSimpleHtmlCode:function(t){return e.Render.RichTextUtils._toDebugHtml(t)},toHtml:function(t,r,i){var n,a,o=e.Render.RichText;a=r.charDirection?r.charDirection===e.Render.TextDirection.RTL||r.charDirection===e.Render.TextDirection.BTT:i;var s=r.role;if(s===o.SECTION||r.text){var l=r.textType,d=l===o.SUB?"sub":l===o.SUP?"sup":"span";n=t.createElement(d);var u=r.text;a&&(u=u.reverse()),e.DomUtils.setElementText(n,r.text||"")}else{var c,h=null;s===o.LINES?(n=t.createElement("div"),h="p",c="margin:0.2em 0;padding:0"):n=t.createElement("span");for(var m,g=0,f=r.items.length;g<f;++g){var p=r.items[g],C=e.Render.RichTextUtils.toHtml(t,p,a);if(h){var b=t.createElement(h);c&&(b.style.cssText=c),b.appendChild(C),C=b}a&&m?n.insertBefore(C,m):n.appendChild(C),m=C}}for(var E=n.style,N=e.Render.RichTextUtils.STYLE_PROPS,g=0,f=N.length;g<f;++g){var T=N[g];r[T]&&(E[T]=r[T])}return n},fromHtml:function(t){function r(t,s){if(t.nodeType===Node.TEXT_NODE){var l=t.nodeValue;return l=l.replace(/[\r\n]/g,""),l.trim()?n.createSection(l):null}if(t.nodeType===Node.ELEMENT_NODE){var d=n.STYLE_PROPS;d.push("direction");for(var u={},c=0,h=d.length;c<h;++c){var m,g=d[c];m=s?o.getComputedStyle(t,g):t.style[g],m&&(u[g]=m)}if(u.direction?(u.charDirection="ltr"===u.direction?e.Render.TextDirection.LTR:"rtl"===u.direction?e.Render.TextDirection.RTL:"inherit"===u.direction?e.Render.TextDirection.INHERIT:null,delete u.direction):u.charDirection=e.Render.TextDirection.DEFAULT,a.getFirstChildElem(t)){for(var f=i.GROUP,p=a.getChildNodesOfTypes(t,[Node.ELEMENT_NODE,Node.TEXT_NODE]),C=[],b=!1,c=0,h=p.length;c<h;++c){var E=p[c],N=r(E,!1);if(E.nodeType===Node.ELEMENT_NODE){"br"===E.tagName.toLowerCase()&&(C.push("br"),b=!0);o.isBlockElem(E)&&(b=!0,N._isLine=!0)}N&&C.push(N)}if(b){for(var T=[],O=[],c=0,h=C.length;c<h;++c){var N=C[c];if(N._isLine||"br"==N){if(O.length){if(O.length>1){var _=n.createGroup();n.appendItems(_,O),T.push(_)}else T.push(O[0]);O=[]}N._isLine&&(delete N._isLine,T.push(N))}else O.push(N)}if(O.length)if(O.length>1){var _=n.createGroup();n.appendItems(_,O),T.push(_)}else T.push(O[0]);C=T}b&&(f=i.LINES);for(var S=n.createGroup(f,u),c=0,h=C.length;c<h;++c)n.append(S,C[c]);return S}var l=a.getElementText(t),v=t.tagName.toLowerCase();return u.textType="sub"===v?i.SUB:"sup"===v?i.SUP:i.NORMAL,l?n.createSection(l,u):null}}var i=e.Render.RichText,n=e.Render.RichTextUtils,a=e.DomUtils,o=e.StyleUtils;return r(t,!0)}},e.Render.ChemDisplayTextUtils={RADICAL_LABELS:["","••","•","••"],RADICAL_TRIPLET_ALTER_LABEL:"^^",getRadicalDisplayText:function(t,r){return r&&t===e.RadicalOrder.TRIPLET?e.Render.ChemDisplayTextUtils.RADICAL_TRIPLET_ALTER_LABEL:e.Render.ChemDisplayTextUtils.RADICAL_LABELS[t]},getChargeDisplayText:function(t,r,i){var n="";if(!!t&&(!r||Math.abs(t)>Math.pow(10,-r)/2)){var a=t>0?"+":"-",o=Math.abs(t);1!=o?n+=r?e.NumUtils.toDecimals(o,r):o.toString():i===e.Render.ChargeMarkRenderType.CIRCLE_AROUND&&(a=t>0?"⊕":"⊖"),n+=a}return n},createElectronStateDisplayTextSection:function(t,r,i,n,a){var o=null,s="";return t&&(s=e.Render.ChemDisplayTextUtils.getChargeDisplayText(t,i,n)),r&&(s+=e.Render.ChemDisplayTextUtils.getRadicalDisplayText(r,a)||""),s&&(o=e.Render.RichTextUtils.createSection(s,{textType:e.Render.RichText.SUP,charDirection:e.Render.TextDirection.LTR})),o},formulaToRichText:function(t,r,i,n,a,o,s){return e.Render.ChemDisplayTextUtils._convFormulaToRichTextGroup(t,!1,r,i,n,a,o,s)},_convFormulaToRichTextGroup:function(t,r,i,n,a,o,s,l){var d=e.Render.RichTextUtils.createGroup(),u=t.getSections();if(r){var c=t.getMaxNestedLevel()%e.FormulaUtils.FORMULA_BRACKET_TYPE_COUNT,h=e.FormulaUtils.FORMULA_BRACKETS[c][0],m=e.FormulaUtils.FORMULA_BRACKETS[c][1];d=e.Render.RichTextUtils.appendText(d,h)}for(var g=0,f=u.length;g<f;++g){var p=u[g].obj,C=t.getSectionCharge(u[g]),b=null;if(p instanceof e.MolecularFormula)b=e.Render.ChemDisplayTextUtils._convFormulaToRichTextGroup(p,!0,!1,!1,a,o,s);else if(p.getDisplayRichText)var b=p.getDisplayRichText(e.Render.HydrogenDisplayLevel.NONE,!1,null,o,a,s);if(b){if(1!=u[g].count&&(b=e.Render.RichTextUtils.appendText(b,u[g].count.toString(),{textType:e.Render.RichText.SUB}),b.charDirection=e.Render.TextDirection.LTR),i&&C){var E=e.Render.ChemDisplayTextUtils.createElectronStateDisplayTextSection(C,null,a,s,l);E&&e.Render.RichTextUtils.append(b,E)}d=e.Render.RichTextUtils.append(d,b)}}if(r&&(d=e.Render.RichTextUtils.appendText(d,m)),i||n){var C=t.getCharge(),N=t.getRadical(),E=e.Render.ChemDisplayTextUtils.createElectronStateDisplayTextSection(C,N,a,s);E&&e.Render.RichTextUtils.append(d,E)}return d}},e.Render.TextDrawUtils={isHorizontalLine:function(t){return t==e.Render.TextDirection.LTR||t==e.Render.TextDirection.RTL||null==t},isVerticalLine:function(t){return t==e.Render.TextDirection.TTB||t==e.Render.TextDirection.BTT},getOppositeDirection:function(t){var r=e.Render.TextDirection;switch(t){case r.LTR:return r.RTL;case r.RTL:return r.LTR;case r.TTB:return r.BTT;case r.BTT:return r.TTB}},isOppositeDirection:function(t,r){return e.Render.TextDrawUtils.getOppositeDirection(t)===r},getActualDirection:function(t,r){var i=e.Render.TextDirection;return t===i.LINE_BREAK?r===i.TTB||r===i.BTT?i.LTR:r===i.LTR||r===i.RTL?i.TTB:t:t},getActualAlign:function(t,r){var i=e.Render.TextAlgin,n=e.Render.TextDirection;switch(t){case i.LEFT:case i.RIGHT:case i.TOP:case i.BOTTOM:case i.CENTER:return t;case i.LEADING:switch(r){case n.TTB:return i.TOP;case n.BTT:return i.BOTTOM;case n.RTL:return i.RIGHT;case n.LTR:default:return i.LEFT}case i.TRAILING:switch(r){case n.BTT:return i.TOP;case n.TTB:return i.BOTTOM;case n.RTL:return i.LEFT;case n.LTR:default:return i.RIGHT}}}},e.Render.DrawPathUtils={makePath:function(){for(var e,t=[],r=null,n=[],a=0,o=arguments.length;a<o;++a){var s=arguments[a];i.isArrayValue(s)?n=n.concat(s):"number"==typeof s?n.push(s):(r&&(e={method:r,params:n},t.push(e),r=null,n=[]),r=s.toString()),a===o-1&&r&&(e={method:r,params:n},t.push(e))}return t}},e.Render.ConnectorDrawUtils={getPossibleConnectorRenderTypes:function(t){if(t instanceof e.Bond)return e.Render.ConnectorDrawUtils.getPossibleBondRenderTypes(t);var r=e.Render.BondRenderType;return[r.SINGLE,r.DASHED,r.WAVY]},getDefConnectorRenderType:function(t){return e.Render.ConnectorDrawUtils.getPossibleConnectorRenderTypes(t)[0]},getPossibleBondRenderTypes:function(t){var r=e.Render.BondRenderType,i=e.BondType;switch(t.getBondType()){case i.HYDROGEN:return[r.DASHED,r.ARROWED,r.WAVY];case i.COORDINATE:return[r.ARROWED,r.SINGLE,r.DASHED,r.WAVY];case i.IONIC:case i.METALLIC:case i.UNKNOWN:return[r.SINGLE,r.DASHED,r.WAVY];case i.COVALENT:break;default:return[r.SINGLE,r.DASHED,r.ARROWED,r.WAVY]}if(t.getConnectedObjCount()>2)return[r.DASHED,r.SINGLE];var n=e.BondOrder;switch(t.getBondOrder()){case n.DOUBLE:var a=[r.DOUBLE,r.DASHED_DOUBLE,r.BOLD_DOUBLE,r.WAVY];return t.getStereo&&[e.BondStereo.E_OR_Z,e.BondStereo.CIS_OR_TRANS].indexOf(t.getStereo())>=0&&a.unshift(r.SCISSORS_DOUBLE),a;case n.TRIPLE:return[r.TRIPLE,r.BOLD_TRIPLE,r.WAVY];case n.QUAD:return[r.QUAD,r.BOLD_QUAD,r.WAVY];case n.EXPLICIT_AROMATIC:return[r.SOLID_DASH,r.WAVY];case n.SINGLE:var o=e.BondStereo,s=[r.SINGLE,r.BOLD,r.WAVY];switch(t.getStereo()){case o.UP:s.unshift(r.WEDGED_SOLID,r.WEDGED_HOLLOW);break;case o.UP_INVERTED:s.unshift(r.WEDGED_SOLID_INV,r.WEDGED_HOLLOW_INV);break;case o.DOWN:s.unshift(r.WEDGED_HASHED,r.DASHED);break;case o.DOWN_INVERTED:s.unshift(r.WEDGED_HASHED_INV,r.DASHED);break;case o.UP_OR_DOWN:case o.UP_OR_DOWN_INVERTED:s=[r.WAVY,r.SINGLE];break;case o.CLOSER:s=[r.WEDGED_SOLID_BOTH,r.WEDGED_HOLLOW_BOTH]}return s;default:return[r.SINGLE,r.DASHED,r.ARROWED,r.WAVY]}},getDefBondRenderType:function(t){return e.Render.ConnectorDrawUtils.getPossibleBondRenderTypes(t)[0]},getConnectorRender3DType:function(t,r){var i=e.Render.Bond3DRenderType,n=e.Render.Bond3DRenderMode;return(!r||r!==n.WIRE&&r!==n.CYLINDER)&&t instanceof e.Bond?e.Render.ConnectorDrawUtils.getBondRender3DTypes(t):i.SINGLE},getBondRender3DTypes:function(t){var r=e.Render.Bond3DRenderType,i=e.BondType;switch(t.getBondType()){case i.HYDROGEN:return r.DASH;case i.COVALENT:break;default:return r.SINGLE}var n=e.BondOrder;switch(t.getBondOrder()){case n.DOUBLE:return r.DOUBLE;case n.TRIPLE:return r.TRIPLE;case n.EXPLICIT_AROMATIC:return r.SOLID_DASH;default:return r.SINGLE}}},e.Render.ObjUtils={getContainerBox:function(t,r,i){r||(r=e.CoordMode.COORD2D);var n,a=t;if(a.getExposedContainerBox)n=a.getExposedContainerBox(r,i);else if(a.getContainerBox)n=a.getContainerBox(r,i);else{var o=a.getAbsCoordOfMode?a.getAbsCoordOfMode(r):null;n=o?e.BoxUtils.createBox(o,o):null}return n}},e.Render.MetaShapeUtils={createShapeInfo:function(e,t,r){var i={shapeType:e,coords:t};return r&&(i=Object.extend(i,r)),i},isCompositeShape:function(e){return i.isArrayValue(e)},inflateShape:function(t,r){if(!t)return null;var i=e.Render.MetaShapeType,n=e.Render.MetaShapeUtils;if(n.isCompositeShape(t)){for(var a=[],o=0,s=t.length;o<s;++o){var l=t[o],d=n.inflateShape(l,r);a.push(d)}return a}var u;switch(t.shapeType){case i.POINT:u=n._inflatePointShape(t,r);break;case i.CIRCLE:u=n._inflateCircleShape(t,r);break;case i.LINE:u=n._inflateLineShape(t,r);break;case i.RECT:u=n._inflateRectShape(t,r);break;case i.POLYGON:u=n._inflatePolygonShape(t,r);break;case i.ARC:u=n._inflateArcShape(t,r)}return u},_inflatePointShape:function(t,r){return e.Render.MetaShapeUtils.createShapeInfo(e.Render.BoundShapeType.CIRCLE,[t.coords[0]],{radius:r})},_inflateCircleShape:function(t,r){return e.Render.MetaShapeUtils.createShapeInfo(e.Render.BoundShapeType.CIRCLE,[t.coords[0]],{radius:t.radius+r})},_inflateLineShape:function(t,r){return e.Render.MetaShapeUtils.createShapeInfo(e.Render.BoundShapeType.LINE,[t.coords[0],t.coords[1]],{width:(t.width||0)+2*r})},_inflateArcShape:function(e,t){var r=Object.extend({},e);return r.width=(e.width||0)+2*t,r},_inflateRectShape:function(t,r){var i=e.Render.MetaShapeUtils.createShapeInfo(e.Render.BoundShapeType.RECT,[]),n=e.Render.MetaShapeUtils._inflateCoords(t.coords,r);return i.coords=n,i},_inflatePolygonShape:function(t,r){var i=e.Render.MetaShapeUtils.createShapeInfo(e.Render.BoundShapeType.POLYGON,[]),n=e.Render.MetaShapeUtils._inflateCoords(t.coords,r);return i.coords=n,i},_inflateCoords:function(t,r){for(var i=e.CoordUtils,n=[],a=i.getCenter(t),o=0,s=t.length;o<s;++o){var l=t[o],d=i.substract(l,a),u=i.getDistance(d),c=i.multiply(d,r/u),h=i.add(l,c);n.push(h)}return n},getDistance:function(t,r,i){if(e.Render.MetaShapeUtils.isCompositeShape(r)){for(var n=null,a=0,o=r.length;a<o;++a){var s=r[a],l=e.Render.MetaShapeUtils.getDistance(t,s,i);(null===n||n>l)&&(n=l)}return n}var d=e.Render.MetaShapeType,u=e.Render.MetaShapeUtils,c=i?u.inflateShape(r,i):r;switch(r.shapeType){case d.POINT:return i?u._getDistanceToCircle(t,c):u._getDistanceToPoint(t,c);case d.CIRCLE:return u._getDistanceToCircle(t,c);case d.LINE:return u._getDistanceToLine(t,c);case d.RECT:return u._getDistanceToRect(t,c);case d.POLYGON:return u._getDistanceToPolygon(t,c);case d.ARC:return u._getDistanceToArc(t,c);default:return!1}},_getDistanceToPoint:function(t,r){return e.CoordUtils.getDistance(t,r.coords[0])},_getDistanceToCircle:function(t,r){return e.CoordUtils.getDistance(t,r.coords[0])-r.radius},_getDistanceToArc:function(t,r){var i=e.CoordUtils,n=i.substract(t,r.coords[0]),a=Math.atan2(n.y,n.x);if(e.Render.MetaShapeUtils.isAngleInArcRange(a,r.startAngle,r.endAngle,r.anticlockwise)){var o=i.getDistance(t,r.coords[0]),o=Math.abs(o-r.radius);return r.width&&r.width>1&&(o-=r.width/2),Math.max(0,o)}var s,l=r.coords[0];s=r.width&&r.width>1?[r.radius-r.width/2,r.radius+r.width/2]:[r.radius];for(var d=[],u=r.startAngle,c=r.endAngle,h=0,m=s.length;h<m;++h){var g=s[h],f=i.add(l,{x:g*Math.cos(u),y:g*Math.sin(u)}),p=i.add(l,{x:g*Math.cos(c),y:g*Math.sin(c)});d.push(f),d.push(p)}for(var C=null,h=0,m=d.length;h<m;++h){var o=i.getDistance(d[h],t);(null===C||C>o)&&(C=o)}return C},_getDistanceToLine:function(t,r){var i=e.Render.MetaShapeUtils,n=r.coords,a=e.Render.MetaShapeUtils._calcVerticalLineCrossPoint(t,n[0],n[1]),o=e.NumUtils;if(o.isFloatEqual(n[0].x,n[1].x)&&o.isFloatEqual(n[0].y,n[1].y)){var s={coords:[r.coords[0]],radius:r.width};return i._getDistanceToCircle(t,s)}var l=e.CoordUtils.substract(n[1],n[0]);if(Math.abs(l.y)>Math.abs(l.x)?Math.sign(a.y-n[0].y)*Math.sign(a.y-n[1].y)<=0:Math.sign(a.x-n[0].x)*Math.sign(a.x-n[1].x)<=0){return e.CoordUtils.getDistance(t,a)-(r.width||0)/2}var d={coords:[r.coords[0]],radius:r.width||0},u={coords:[r.coords[1]],radius:r.width||0},c=i._getDistanceToCircle(t,d),h=i._getDistanceToCircle(t,u);return Math.min(c,h)},_getDistanceToRect:function(t,r){var i=r.coords,n=t.x-i[0].x,a=t.x-i[1].x,o=t.y-i[0].y,s=t.y-i[1].y;if(n*a<=0&&o*s<=0)return-Math.min(Math.abs(n),Math.abs(a),Math.abs(o),Math.abs(s));var l=e.CoordUtils;return Math.min(l.getDistance(t,i[0]),l.getDistance(t,i[1]),l.getDistance(t,{x:i[0].x,y:i[1].y}),l.getDistance(t,{x:i[1].x,y:i[0].y}))},_getDistanceToPolygon:function(t,r){for(var i=(e.CoordUtils,e.Render.MetaShapeUtils),n=e.Render.MetaShapeType,a=i._isInsidePolygon(t,r),o=r.coords,s=null,l=0,d=o.length;l<d;++l){var u=o[l],c=o[(l+1)%d],h=i.createShapeInfo(n.LINE,[u,c],{width:0}),m=i._getDistanceToLine(t,h);null===s?s=m:s>m&&(s=m)}return a&&(s=-s),s},_getDistanceOfTwoLines:function(t,r){var i=(e.Render.MetaShapeUtils,e.GeometryUtils);if(i.getCrossPointOfLines(t[0],t[1],r[0],r[1]))return 0;var n=i.getDistanceFromPointToLine(t[0],r[0],r[1]),a=i.getDistanceFromPointToLine(t[1],r[0],r[1]),o=i.getDistanceFromPointToLine(r[0],t[0],t[1]),s=i.getDistanceFromPointToLine(r[1],t[0],t[1]);return Math.min(n,a,o,s)},isCoordInside:function(t,r,i){if(!t)return!1;if(e.Render.MetaShapeUtils.isCompositeShape(r)){for(var n=0,a=r.length;n<a;++n){var o=r[n];if(e.Render.MetaShapeUtils.isCoordInside(t,o,i))return!0}return!1}var s=e.Render.MetaShapeType,l=e.Render.MetaShapeUtils,d=i?l.inflateShape(r,i):r;if(!d)return!1;switch(r.shapeType){case s.POINT:return i?l._isInsideCircle(t,d):l._isInsidePoint(t,d);case s.CIRCLE:return l._isInsideCircle(t,d);case s.LINE:return l._isInsideLine(t,d);case s.RECT:return l._isInsideRect(t,d);case s.POLYGON:return l._isInsidePolygon(t,d);case s.ARC:return l._isInsideArc(t,d);default:return!1}},_isInsidePoint:function(t,r){return e.CoordUtils.isEqual(t,r.coords[0])},_isInsideCircle:function(t,r){return e.CoordUtils.getDistance(t,r.coords[0])<=r.radius},_isInsideLine:function(t,r){var i=r.coords,n=e.Render.MetaShapeUtils._calcVerticalLineCrossPoint(t,i[0],i[1]),a=e.NumUtils;if(a.isFloatEqual(i[0].x,i[1].x)&&a.isFloatEqual(i[0].y,i[1].y)){var o={coords:[r.coords[0]],radius:r.width};return e.Render.MetaShapeUtils._isInsideCircle(t,o)}var s=e.CoordUtils.substract(i[1],i[0]);if(Math.abs(s.y)>Math.abs(s.x)?Math.sign(n.y-(i[0].y+8))*Math.sign(n.y-(i[1].y+8))<=0||Math.sign(n.y-(i[0].y-8))*Math.sign(n.y-(i[1].y-8))<=0:Math.sign(n.x-(i[0].x+8))*Math.sign(n.x-(i[1].x+8))<=0||Math.sign(n.x-(i[0].x-8))*Math.sign(n.x-(i[1].x-8))<=0){return e.CoordUtils.getDistance(t,n)<=r.width/2}return!1},_isInsideArc:function(t,r){var i=e.CoordUtils,n=e.GeometryUtils,a=i.getDistance(t,r.coords[0]),o=Math.abs(a-r.radius)<r.width/2;if(o){var s=i.substract(t,r.coords[0]),l=n.standardizeAngle(Math.atan2(s.y,s.x),0);o=e.Render.MetaShapeUtils.isAngleInArcRange(l,r.startAngle,r.endAngle,r.anticlockwise)}return o},_isInsideRect:function(t,r){var i=r.coords;return e.CoordUtils.insideRect(t,i[0],i[1])},_isInsidePolygon:function(t,r){for(var i=e.CoordUtils,n=r.coords,a=0,o=0,s=n.length;o<s;++o){var l=n[o],d=n[(o+1)%s],u=i.substract(d,l);if(0!==u.x){var c={x:t.x};c.y=(c.x-l.x)/u.x*u.y+l.y,i.insideRect(c,l,d)&&++a}}return a%2==0},_calcVerticalLineCrossPoint:function(e,t,r){var i={};if(Math.abs(t.x-r.x)<1e-10)i.x=t.x,i.y=e.y;else{var n=(r.y-t.y)/(r.x-t.x);i.x=(n*n*t.x+n*(e.y-t.y)+e.x)/(n*n+1),i.y=n*(i.x-t.x)+t.y}return i},getContainerBox:function(t,r){var i=e.Render.MetaShapeType,n=e.Render.MetaShapeUtils,a=e.BoxUtils;if(!t)return null;var o=t.coords;r=r||0;var s;if(n.isCompositeShape(t)){s=null;for(var l=0,d=t.length;l<d;++l){var u=t[l],c=n.getContainerBox(u);s=s?a.getContainerBox(s,c):c}}else switch(t.shapeType){case i.POINT:case i.CIRCLE:var h=t.shapeType===i.POINT?0:t.radius||0,m=o[0];s=a.createBox({x:m.x-h,y:m.y-h},{x:m.x+h,y:m.y+h});break;case i.LINE:s=a.createBox(o[0],o[1]),s=e.BoxUtils.inflateBox(s,(t.width||0)/2);break;case i.ARC:s=e.Render.MetaShapeUtils._getArcContainerBox(t);break;case i.RECT:s=a.createBox(o[0],o[1]);break;case i.POLYGON:s=a.createBox(o[0],o[0]);for(var l=1,d=o.length;l<d;++l){var m=o[l];s={x1:Math.min(s.x1,m.x),y1:Math.min(s.y1,m.y),x2:Math.max(s.x2,m.x),y2:Math.max(s.y2,m.y)}}}return r&&(s=e.BoxUtils.inflateBox(s,r)),s},_getArcContainerBox:function(t){var r,i=e.Render.MetaShapeUtils,n=e.CoordUtils;r=t.width&&t.width>1?[t.radius+t.width/2,t.radius-t.width/2]:[t.radius];for(var a=t.coords[0],o=Math.PI/2,s=function(e,t){return n.add(a,{x:t*Math.cos(e),y:t*Math.sin(e)})},l=[],d=0,u=r.length;d<u;++d){var c=r[d],h=s(t.startAngle,c),m=s(t.endAngle,c);l=l.concat([h,m]);for(var g=[0,o,2*o,3*o],f=0,p=g.length;f<p;++f)i.isAngleInArcRange(g[f],t.startAngle,t.endAngle,t.anticlockwise)&&l.push(s(g[f],c))}return n.getContainerBox(l)},isAngleInArcRange:function(t,r,i,n){var a=e.GeometryUtils.standardizeAngle,o=a(r),s=a(i),l=a(t),d=Math.sign(l-o)*Math.sign(l-s)*Math.sign(s-o);return n?d>=0:d<=0},isIntersectingLine:function(t,r,i){var n=e.Render.MetaShapeType,a=e.Render.MetaShapeUtils;if(a.isCompositeShape(t)){for(var o=0,s=t.length;o<s;++o){var l=t[o];if(a.isIntersectingLine(l,r,i))return!0}return!1}var d=a.createShapeInfo(n.LINE,r),u=i/2,c=t.coords;switch(t.shapeType){case n.POINT:var h=a._getDistanceToLine(c[0],d);return h<=u;case n.CIRCLE:var h=a._getDistanceToLine(c[0],d);return h<=u+(d.radius||0);case n.LINE:var h=a._getDistanceOfTwoLines(c,r);return h<=u+(d.width||0);case n.RECT:case n.POLYGON:for(var m=a._getCoordsForShapeInComparingWithPolygon(t),h=null,g=m.length-1,o=0,s=m.length;o<s;++o){var f=[m[o],m[g]],p=a._getDistanceOfTwoLines(f,r);(null===h||p<h)&&(h=p),g=o}return h<=u}return!1},isInsideBox:function(t,r){var i=e.Render.MetaShapeUtils.getContainerBox(t);return e.BoxUtils.isInside(i,r)},isIntersectingBox:function(t,r){if(!e.Render.MetaShapeUtils.isCompositeShape(t)){for(var i=t.coords,n=0,a=i.length;n<a;++n){var o=i[n];if(e.CoordUtils.isInsideBox(o,r))return!0}return!1}for(var n=0,a=t.length;n<a;++n){var s=t[n];if(e.Render.MetaShapeUtils.isIntersectingBox(s,r))return!0}},isPointInsidePolygon:function(e,t){for(var r=!1,i=t.length,n=i-1,a=0;a<i;++a)t[a].y>e.y!=t[n].y>e.y&&e.x<(t[n].x-t[a].x)*(e.y-t[a].y)/(t[n].y-t[a].y)+t[a].x&&(r=!r),n=a;return r},isInsidePolygon:function(t,r){var i=e.Render.MetaShapeUtils,n=i._getCoordsForShapeInComparingWithPolygon(t);if(!n)return!1;for(var a=0,o=n.length;a<o;++a){var s=n[a];if(!i.isPointInsidePolygon(s,r))return!1}return!0},isIntersectingPolygon:function(t,r){var i=e.Render.MetaShapeUtils,n=i._getCoordsForShapeInComparingWithPolygon(t);if(!n)return!1;for(var a=0,o=n.length;a<o;++a){var s=n[a];if(i.isPointInsidePolygon(s,r))return!0}return!1},isIntersectingPolyline:function(t,r,i){for(var n=e.Render.MetaShapeUtils,a=0,o=r.length-1;a<o;++a){var s=[r[a],r[a+1]];if(n.isIntersectingLine(t,s,i))return!0}return!1},_getCoordsForShapeInComparingWithPolygon:function(t){var r,i=e.Render.MetaShapeType,n=e.Render.MetaShapeUtils;if(n.isCompositeShape(t)){r=[];for(var a=0,o=t.length;a<o;++a){var s=t[a],l=n._getCoordsForShapeInComparingWithPolygon(s);r=r.concat(l)}return r}var d=t.coords;switch(t.shapeType){case i.POINT:r=[d[0]];break;case i.CIRCLE:var u=t.radius||0;if(u){var c=u,h=c/Math.sqrt(2);r=[{x:c,y:0},{x:h,y:h},{x:0,y:c},{x:-h,y:h},{x:-c,y:0},{x:-h,y:-h},{x:0,y:-c},{x:h,y:-h}]}else r=[d[0]];break;case i.LINE:r=[d[0],d[1]];break;case i.RECT:var m=d[0],g=d[1];r=[m,{x:g.x,y:m.y},g,{x:m.x,y:g.y}];break;case i.POLYGON:r=d}return r},getEdgeVectors:function(t){var r,i=e.Render.MetaShapeType,n=e.Render.MetaShapeUtils,a=e.CoordUtils;if(n.isCompositeShape(t)){r=[];for(var o=0,s=t.length;o<s;++o){var l=t[o],d=n.getEdgeVectors(l);r=r.concat(d)}return r}var u=t.coords;switch(t.shapeType){case i.POINT:r=[[u[0],u[0]]];break;case i.CIRCLE:r=null;break;case i.LINE:var c=t.width;if(c){var h=u[0],m=u[1],g=a.substract(m,h),f=a.getDistance(h,m),p=g.y/f,C=g.x/f,b=c/2,E=b*p,N=b*C,T=[{x:h.x-E,y:h.y+N},{x:h.x+E,y:h.y-N},{x:m.x+E,y:m.y-N},{x:m.x-E,y:m.y+N}],O=T;r=[[O[0],O[1]],[O[1],O[2]],[O[2],O[3]],[O[3],O[0]]]}else r=[[u[0],u[1]]];break;case i.RECT:var _=u[0],m=u[1],h={x:m.x,y:_.y},S={x:_.x,y:m.y};r=[[_,h],[h,m],[m,S],[S,_]];break;case i.POLYGON:r=[];for(var o=0,s=u.length-1;o<s;++o){var v=++o;v>=s&&(v=0),r.push([u[o],u[v]])}}return r},getEdgeBasicElements:function(t){var r=e.Render.MetaShapeType,i=e.Render.MetaShapeUtils,n={vectors:[],circles:[]};if(i.isCompositeShape(t)){for(var a=0,o=t.length;a<o;++a){var s=t[a],l=i.getEdgeBasicElements(s);n.vectors=n.concat(l.vectors),n.circles=n.concat(l.circles)}return n}var d=t.coords;switch(t.shapeType){case r.POINT:n.circles.push({center:d[0],radius:0});break;case r.CIRCLE:n.circles.push({center:d[0],radius:t.radius});break;default:n.vectors=n.vectors.concat(e.Render.MetaShapeUtils.getEdgeVectors(t))}return n},getCrossPointsOfVectorToShapeEdges:function(t,r,i,n){for(var a=e.Render.MetaShapeUtils.getEdgeBasicElements(r),o=a.vectors,s=a.circles,l=[],d=0,u=o.length;d<u;++d){var c=o[d],h=e.GeometryUtils.getCrossPointOfVectors(t,c);if(h&&(l.push(h),i))return l}for(var d=0,u=s.length;d<u;++d){var m=s[d],g=e.GeometryUtils.getCrossPointsOfVectorToCircle(t,m.center,m.radius,n);if(g&&g.length&&(l=l.concat(g),i))return l}return l}},e.Render.RenderOptionUtils={mergeObjLocalRenderOptions:function(t,r){var i=t&&t.getOverriddenRenderOptions?t.getOverriddenRenderOptions():null;return e.Render.RenderOptionUtils.mergeRenderOptions(i||{},r)},mergeObjLocalRender3DOptions:function(t,r){var i=t&&t.getOverriddenRender3DOptions?t.getOverriddenRender3DOptions():null;return e.Render.RenderOptionUtils.mergeRenderOptions(i||{},r)},mergeRenderOptions:function(e,t){var r=Object.create(t);return r=Object.extend(r,e,!0,!0)},getColor:function(e){return e?e.color:null},getMoleculeDisplayType:function(e){return e?e.moleculeDisplayType:null},getNodeDisplayMode:function(e){return e?e.nodeDisplayMode:null},getHydrogenDisplayLevel:function(e){return e?e.hydrogenDisplayLevel:null},getShowCharge:function(e){return e?e.showCharge:null},getChargeDrawOptions:function(e){if(e){var t=["showCharge","chargeMarkType","chargeMarkFontSize","chargeMarkMargin","chargeMarkCircleWidth","color","opacity"];return Object.copyValues({},e,t)}return null},getNodeLabelDrawOptions:function(e){if(e){var t=["fontSize","fontFamily","supFontSizeRatio","subFontSizeRatio","superscriptOverhang","subscriptOversink","textBoxXAlignment","textBoxYAlignment","color","opacity"];return Object.copyValues({},e,t)}return null},getConnectorRenderType:function(e){return e?e.renderType:null},getConnectorDrawParams:function(e){if(e){var t=["bondLineWidth","boldBondLineWidth","hashSpacing","multipleBondSpacingRatio","multipleBondSpacingAbs","multipleBondMaxAbsSpacing","bondArrowLength","bondArrowWidth","bondWedgeWidth","bondWedgeHashMinWidth","color","opacity"];return Object.copyValues({},e,t)}return null},convertConfigsToPlainHash:function(t){var r=e.Render.RenderOptionUtils;return t instanceof e.Render.Render3DConfigs?r.convert3DConfigsToPlainHash(t):r.convert2DConfigsToPlainHash(t)},convert2DConfigsToPlainHash:function(t){var r=e.ObjUtils,i={};i._configs=t;var n=t.getGeneralConfigs().toHash();return r.replacePropName(n,"drawOpacity","opacity"),i=Object.extend(i,n),n=t.getMoleculeDisplayConfigs().toHash(),r.replacePropName(n,"defMoleculeDisplayType","moleculeDisplayType"),r.replacePropName(n,"defNodeDisplayMode","nodeDisplayMode"),r.replacePropName(n,"defHydrogenDisplayLevel","hydrogenDisplayLevel"),r.replacePropName(n,"defChargeMarkType","chargeMarkType"),i=Object.extend(i,n),i.displayLabelConfigs=t.getDisplayLabelConfigs(),n=t.getTextFontConfigs().toHash(),i=Object.extend(i,n),n=t.getLengthConfigs().toHash(),i=Object.extend(i,n),i.unitLength=i.unitLength||1,n=t.getColorConfigs().toHash(),i=Object.extend(i,n)},convert3DConfigsToPlainHash:function(t){var r=e.ObjUtils,i={};i._configs=t;var n=t.getGeneralConfigs().toHash();r.replacePropName(n,"drawOpacity","opacity"),i=Object.extend(i,n);var n=t.getEnvironmentConfigs().toHash();i=Object.extend(i,n);var n=t.getMoleculeDisplayConfigs().toHash();r.replacePropName(n,"defMoleculeDisplayType","moleculeDisplayType"),r.replacePropName(n,"defBondSpliceMode","bondSpliceMode"),r.replacePropName(n,"defDisplayMultipleBond","displayMultipleBond"),r.replacePropName(n,"defBondColor","bondColor"),r.replacePropName(n,"defAtomColor","atomColor"),i=Object.extend(i,n);var n=t.getModelConfigs().toHash();i=Object.extend(i,n);var n=t.getLengthConfigs().toHash();return i=Object.extend(i,n)},getCascadeRenderOptionValueOfObjs:function(t,r,i){for(var n,a=!1,o=e.ArrayUtils.toArray(t),s=i?"getCascadedRender3DOption":"getCascadedRenderOption",l=0,d=o.length;l<d;++l){var u=o[l];if(u[s]){var c=u[s](r);if(a){if(n!=c)return null}else n=c,a=!0}}return n},setRenderOptionValueOfObjs:function(t,r,i){for(var n=e.ArrayUtils.toArray(t),a=0,o=n.length;a<o;++a){var s=n[a];if(s.setRenderOption)for(var l=e.ObjUtils.getOwnedFieldNames(r),d=0,u=l.length;d<u;++d)s.setRenderOption(l[d],r[l[d]])}}},e.Render.Render3DOptionUtils={getConnectorRenderType:function(e){return e?e.renderType:null},convertConfigsToPlainHash:function(e){}},e.Render.RenderColorUtils={getActiveAtomColorSet:function(t){return e.Render.atomColors[t]},setActiveAtomColorSet:function(t,r){var i=e.Render.AtomColorSets[t];return i&&(e.Render.atomColorSet[r]=i),i},getColor:function(t,r){var i=e.Render.RenderColorUtils.getActiveAtomColorSet(r),n=i[t];return n||(n=i[0]),n}},e.Render.UpdateObjUtils={_extractObjsOfUpdateObjDetails:function(t){for(var r=[],i=0,n=t.length;i<n;++i){var a=t[i];a.obj&&e.ArrayUtils.pushUnique(r,a.obj)}return r},_createUpdateObjDetailsFromObjs:function(e){for(var t=[],r=0,i=e.length;r<i;++r)t.push({obj:e[r]});return t}},e}},function(e,t,r){"use strict";var i=r(0).Class;r(0).ObjectEx,r(0).DataType;e.exports=function(e){var t=e.OBJDEF_TEXTS,r=i.PropertyScope;return e.Render.PredefinedConfigsMap=i.create(e.ConfigPresetMap,{CLASS_NAME:"Kekule.Render.PredefinedConfigsMap"}),e.Render.GeneralConfigs=i.create(e.AbstractConfigs,{CLASS_NAME:"Kekule.Render.GeneralConfigs",initProperties:function(){this.addBoolConfigProp("allowCoordBorrow",!0,{scope:r.PUBLIC}),this.addIntConfigProp("moduleWidth",1500,{scope:r.PUBLIC}),this.addIntConfigProp("moduleHeight",1e3,{scope:r.PUBLIC}),this.addFloatConfigProp("drawOpacity",1,{title:t.TITLE_DRAWOPACITY,description:t.DES_DRAWOPACITY})}}),e.Render.Render2DConfigs=i.create(e.AbstractConfigs,{CLASS_NAME:"Kekule.Render.Render2DConfigs",initProperties:function(){this.addConfigProp("generalConfigs","Kekule.Render.GeneralConfigs"),this.addConfigProp("moleculeDisplayConfigs","Kekule.Render.MoleculeDisplayConfigs"),this.addConfigProp("displayLabelConfigs","Kekule.Render.DisplayLabelConfigs"),this.addConfigProp("textFontConfigs","Kekule.Render.TextFontConfigs"),this.addConfigProp("lengthConfigs","Kekule.Render.LengthConfigs"),this.addConfigProp("colorConfigs","Kekule.Render.ColorConfigs"),this.addConfigProp("nodeViewConfigs","Kekule.Render.NodeViewConfigs")},initPropValues:function($super){$super(),this.setPropStoreFieldValue("generalConfigs",new e.Render.GeneralConfigs),this.setPropStoreFieldValue("moleculeDisplayConfigs",new e.Render.MoleculeDisplayConfigs),this.setPropStoreFieldValue("displayLabelConfigs",new e.Render.DisplayLabelConfigs),this.setPropStoreFieldValue("textFontConfigs",new e.Render.TextFontConfigs),this.setPropStoreFieldValue("lengthConfigs",new e.Render.LengthConfigs),this.setPropStoreFieldValue("colorConfigs",new e.Render.ColorConfigs),this.setPropStoreFieldValue("nodeViewConfigs",new e.Render.NodeViewConfigs)},initInteractStyleMap:function(){}}),e.ClassUtils.makeSingleton(e.Render.Render2DConfigs),e.Render.getRender2DConfigs=function(){return e.Render.Render2DConfigs.getInstance()},e.Render.MoleculeDisplayConfigs=i.create(e.AbstractConfigs,{CLASS_NAME:"Kekule.Render.MoleculeDisplayConfigs",initProperties:function(){this.addIntConfigProp("defMoleculeDisplayType",e.Render.MoleculeDisplayType.SKELETAL,{enumSource:e.Render.MoleculeDisplayType}),this.addIntConfigProp("defNodeDisplayMode",e.Render.NodeLabelDisplayMode.SMART,{enumSource:e.Render.NodeLabelDisplayMode}),this.addIntConfigProp("defHydrogenDisplayLevel",e.Render.HydrogenDisplayLevel.DEFAULT,{enumSource:e.Render.HydrogenDisplayLevel}),this.addIntConfigProp("defChargeMarkType",e.Render.ChargeMarkRenderType.DEFAULT,{enumSource:e.Render.ChargeMarkRenderType}),this.addBoolConfigProp("distinguishSingletAndTripletRadical",!1),this.addIntConfigProp("partialChargeDecimalsLength",2),this.addBoolConfigProp("autoCreateChargeAndRadicalMarker",!0)}}),e.Render.DisplayLabelConfigs=i.create(e.AbstractConfigs,{CLASS_NAME:"Kekule.Render.DisplayLabelConfigs",DEF_UNSET_ELEMENT:"?",DEF_DUMMY_ATOM:"Du",DEF_HETERO_ATOM:"Q",DEF_ANY_ATOM:"A",DEF_VARIABLE_ATOM:"L",DEF_RGROUP:"R",DEF_ISO_LIST_LEADING_BRACKET:"[",DEF_ISO_LIST_TAILING_BRACKET:"]",DEF_ISO_LIST_DELIMITER:",",DEF_ISO_LIST_DISALLOW_PREFIX:"NOT",initProperties:function(){var t=e.ChemStructureNodeLabels;this.addBoolConfigProp("enableIsotopeAlias",t.ENABLE_ISOTOPE_ALIAS,{getter:function(){return t.ENABLE_ISOTOPE_ALIAS},setter:function(e){t.ENABLE_ISOTOPE_ALIAS=e}}),this.addStrConfigProp("unsetElement",t.UNSET_ELEMENT,{getter:function(){return t.UNSET_ELEMENT},setter:function(e){e&&(t.UNSET_ELEMENT=e)}}),this.addStrConfigProp("dummyAtom",t.DUMMY_ATOM,{getter:function(){return t.DUMMY_ATOM},setter:function(e){e&&(t.DUMMY_ATOM=e)}}),this.addStrConfigProp("heteroAtom",t.HETERO_ATOM,{getter:function(){return t.HETERO_ATOM},setter:function(e){e&&(t.HETERO_ATOM=e)}}),this.addStrConfigProp("anyAtom",t.ANY_ATOM,{getter:function(){return t.ANY_ATOM},setter:function(e){e&&(t.ANY_ATOM=e)}}),this.addStrConfigProp("variableAtom",t.VARIABLE_ATOM,{getter:function(){return t.VARIABLE_ATOM},setter:function(e){e&&(t.VARIABLE_ATOM=e)}}),this.addStrConfigProp("rgroup",t.SUBGROUP,{getter:function(){return t.SUBGROUP},setter:function(e){e&&(t.SUBGROUP=e)}}),this.addStrConfigProp("isoListLeadingBracket",t.ISO_LIST_LEADING_BRACKET,{getter:function(){return t.ISO_LIST_LEADING_BRACKET},setter:function(e){e&&(t.ISO_LIST_LEADING_BRACKET=e)}}),this.addStrConfigProp("isoListTailingBracket",t.ISO_LIST_TAILING_BRACKET,{getter:function(){return t.ISO_LIST_TAILING_BRACKET},setter:function(e){e&&(t.ISO_LIST_TAILING_BRACKET=e)}}),this.addStrConfigProp("isoListDelimiter",t.ISO_LIST_DELIMITER,{getter:function(){return t.ISO_LIST_DELIMITER},setter:function(e){e&&(t.ISO_LIST_DELIMITER=e)}}),this.addStrConfigProp("isoListDisallowPrefix",t.ISO_LIST_DISALLOW_PREFIX,{getter:function(){return t.ISO_LIST_DISALLOW_PREFIX},setter:function(e){e&&(t.ISO_LIST_DISALLOW_PREFIX=e)}})}}),e.Render.TextFontConfigs=i.create(e.AbstractConfigs,{CLASS_NAME:"Kekule.Render.TextFontConfigs",DEF_LABEL_FONT_FAMILY:"",initProperties:function(){this.addStrConfigProp("labelFontFamily","Arial, Helvetica, sans-serif"),this.addStrConfigProp("atomFontFamily","Arial, Helvetica, sans-serif"),this.addFloatConfigProp("supFontSizeRatio",.66),this.addFloatConfigProp("subFontSizeRatio",.66),this.addFloatConfigProp("superscriptOverhang",.2),this.addFloatConfigProp("subscriptOversink",.2),this.addIntConfigProp("textCharDirection",e.Render.TextDirection.LTR,{enumSource:e.Render.TextDirection}),this.addIntConfigProp("textHorizontalAlign",e.Render.TextAlign.LEADING,{enumSource:e.Render.TextAlign}),this.addIntConfigProp("textVerticalAlign",e.Render.TextAlign.LEADING,{enumSource:e.Render.TextAlign}),this.addIntConfigProp("textBoxXAlignment",e.Render.BoxXAlignment.LEFT,{enumSource:e.Render.BoxXAlignment,scope:r.PUBLIC}),this.addIntConfigProp("textBoxYAlignment",e.Render.BoxYAlignment.TOP,{enumSource:e.Render.BoxYAlignment,scope:r.PUBLIC}),this.addIntConfigProp("textBoxAlignmentMode",e.Render.TextBoxAlignmentMode.ANCHOR,{enumSource:e.Render.TextBoxAlignmentMode,scope:r.PUBLIC})}}),e.Render.LengthConfigs=i.create(e.AbstractConfigs,{CLASS_NAME:"Kekule.Render.LengthConfigs",initProperties:function(){this.addFloatConfigProp("unitLength",1,{scope:r.PUBLIC}),this.addFloatConfigProp("labelFontSize",14),this.addFloatConfigProp("atomFontSize",14),this.addFloatConfigProp("atomLabelBoxExpandRatio",1.2,{scope:r.PUBLIC}),this.addFloatConfigProp("chargeMarkFontSize",10),this.addFloatConfigProp("chargeMarkMargin",5),this.addFloatConfigProp("chemMarkerFontSize",10),this.addFloatConfigProp("chemMarkerMargin",5),this.addFloatConfigProp("allenCenterAtomRadius",3),this.addFloatConfigProp("defBondLength",25),this.addFloatConfigProp("bondLineWidth",1),this.addFloatConfigProp("boldBondLineWidthRatio",2,{scope:r.PUBLIC}),this.addFloatConfigProp("hashSpacing",3),this.addFloatConfigProp("multipleBondSpacingRatio",.18),this.addFloatConfigProp("multipleBondSpacingAbs",null,{scope:r.PUBLIC}),this.addFloatConfigProp("multipleBondMaxAbsSpacing",5),this.addFloatConfigProp("bondArrowLength",6),this.addFloatConfigProp("bondArrowWidth",6),this.addFloatConfigProp("bondWedgeWidth",6),this.addFloatConfigProp("bondWedgeHashMinWidth",2),this.addFloatConfigProp("bondWavyRadius",5),this.addFloatConfigProp("glyphStrokeWidth",1),this.addFloatConfigProp("glyphStickOffsetRelLength",.1),this.addFloatConfigProp("strokeWidth",3),this.addFloatConfigProp("rxnMolMargin",10,{scope:r.PUBLIC}),this.addFloatConfigProp("defScaleRefLength",.8),this.addFloatConfigProp("autofitContextPadding",45)},getActualLength:function(e){var t=this.getPropValue(e);return null!==t&&void 0!==t?t*this.getUnitLength():null}}),e.Render.ColorConfigs=i.create(e.AbstractConfigs,{CLASS_NAME:"Kekule.Render.ColorConfigs",initProperties:function(){this.addBoolConfigProp("useAtomSpecifiedColor",!1),this.addStrConfigProp("labelColor","#000000"),this.addStrConfigProp("atomColor","#000000"),this.addStrConfigProp("bondColor","#000000"),this.addStrConfigProp("glyphStrokeColor","#555555"),this.addStrConfigProp("glyphFillColor","#999999")}}),e.Render.NodeViewConfigs=i.create(e.AbstractConfigs,{CLASS_NAME:"Kekule.Render.NodeViewConfigs",initProperties:function(){this.addStrConfigProp("hydrogenDisplayType","BONDED")}}),e.Render.Render3DConfigs=i.create(e.AbstractConfigs,{CLASS_NAME:"Kekule.Render.Render3DConfigs",initProperties:function(){this.addConfigProp("generalConfigs","Kekule.Render.GeneralConfigs"),this.addConfigProp("moleculeDisplayConfigs","Kekule.Render.Molecule3DDisplayConfigs"),this.addConfigProp("lengthConfigs","Kekule.Render.Length3DConfigs"),this.addConfigProp("environmentConfigs","Kekule.Render.Render3DEnvironmentConfigs"),this.addConfigProp("modelConfigs","Kekule.Render.Model3DConfigs")},initPropValues:function($super){$super(),this.setPropStoreFieldValue("generalConfigs",new e.Render.GeneralConfigs),this.setPropStoreFieldValue("environmentConfigs",new e.Render.Render3DEnvironmentConfigs),this.setPropStoreFieldValue("moleculeDisplayConfigs",new e.Render.Molecule3DDisplayConfigs),this.setPropStoreFieldValue("modelConfigs",new e.Render.Model3DConfigs),this.setPropStoreFieldValue("lengthConfigs",new e.Render.Length3DConfigs)}}),e.ClassUtils.makeSingleton(e.Render.Render3DConfigs),e.Render.getRender3DConfigs=function(){return e.Render.Render3DConfigs.getInstance()},e.Render.Render3DEnvironmentConfigs=i.create(e.AbstractConfigs,{CLASS_NAME:"Kekule.Render.Render3DEnvironmentConfigs",initProperties:function(){this.addIntConfigProp("graphicQuality",e.Render.Render3DGraphicQuality.MEDIUM,{enumSource:e.Render.Render3DGraphicQuality})}}),e.Render.Molecule3DDisplayConfigs=i.create(e.AbstractConfigs,{CLASS_NAME:"Kekule.Render.Molecule3DDisplayConfigs",initProperties:function(){this.addIntConfigProp("defMoleculeDisplayType",e.Render.Molecule3DDisplayType.BALL_STICK,{enumSource:e.Render.Molecule3DDisplayType}),this.addIntConfigProp("defBondSpliceMode",e.Render.Bond3DSpliceMode.WEIGHTING_SPLIT,{enumSource:e.Render.Bond3DSpliceMode}),this.addBoolConfigProp("defDisplayMultipleBond",!0),this.addStrConfigProp("defBondColor","#FFFFFF"),this.addStrConfigProp("defAtomColor","#000099"),this.addBoolConfigProp("useAtomSpecifiedColor",!0)}}),e.Render.Model3DConfigs=i.create(e.AbstractConfigs,{CLASS_NAME:"Kekule.Render.Model3DConfigs",initProperties:function(){this.addBoolConfigProp("showNodeLabel",!0,{scope:r.PUBLIC}),this.addBoolConfigProp("hideHydrogens",!1),this.addBoolConfigProp("useVdWRadius",!0),this.addFloatConfigProp("nodeRadiusRatio",.25,{scope:r.PUBLIC}),this.addFloatConfigProp("connectorRadiusRatio",.25,{scope:r.PUBLIC}),this.addFloatConfigProp("multiConnectorRadiusRatio",.5),this.addFloatConfigProp("multiConnectorMarginRatio",1)}}),e.Render.Length3DConfigs=i.create(e.AbstractConfigs,{CLASS_NAME:"Kekule.Render.Length3DConfigs",initProperties:function(){this.addFloatConfigProp("unitLength",1,{scope:r.PUBLIC}),this.addFloatConfigProp("fixedNodeRadius",1.7),this.addFloatConfigProp("connectorRadius",.6),this.addFloatConfigProp("connectorLineWidth",2),this.addFloatConfigProp("defBondLength",100,{scope:r.PUBLIC})},getActualLength:function(e){var t=this.getPropValue(e);return null!==t&&void 0!==t?t*this.getUnitLength():null}}),e}},function(e,t,r){"use strict";var i=r(0).Class,n=r(0).ObjectEx;r(0).DataType;e.exports=function(e){var t=e.Render.RichText,r=e.Render.RichTextUtils,a=e.Render.TextDirection,o=e.Render.TextDrawUtils,s=e.Render.TextAlign;return e.Render.AbstractTextDrawBridge=i.create({CLASS_NAME:"Kekule.Render.AbstractTextDrawBridge",drawText:function(e,t,r,i){return null},canMeasureText:function(e){return!1},measureText:function(e,t,r){return{}},canMeasureDrawnText:function(e){return!1},measureDrawnText:function(e,t,r){return{}},canModifyText:function(e){return!1},modifyDrawnTextCoord:function(e,t,r){},createGroup:function(e){},addToGroup:function(e,t){},removeFromGroup:function(e,t){}}),e.Render.BaseRichTextDrawer=i.create(n,{CLASS_NAME:"Kekule.Render.BaseRichTextDrawer",ITEM_PARENT_FIELD:"__$parent__",initialize:function($super,e,t,r){$super(),this.options=t||{},e&&this.setDrawBridge(e),r&&this.setDrawConfigs(r)},initProperties:function(){this.defineProp("drawBridge",{dataType:"Kekule.Render.AbstractTextDrawBridge",serializable:!1}),this.defineProp("drawConfigs",{dataType:"Kekule.Render.Render2DConfigs",serializable:!1})},fillOptions:function(e){if(e){var t=e.getTextFontConfigs(),r=this.options;r.supFontSizeRatio=t.getSupFontSizeRatio(),r.subFontSizeRatio=t.getSubFontSizeRatio(),r.superscriptOverhang=t.getSuperscriptOverhang(),r.subscriptOversink=t.getSubscriptOversink(),r.textCharDirection=t.getTextCharDirection(),r.textLineDirection=t.getTextLineDirection(),r.textHorizontalAlign=t.getTextHorizontalAlign(),r.textVerticalAlign=t.getTextVerticalAlign(),r.textBoxXAlignment=t.getTextBoxXAlignment(),r.textBoxYAlignment=t.getTextBoxYAlignment(),r.textBoxAlignmentMode=t.getTextBoxAlignmentMode()}},cloneRichText:function(t){return e.Render.RichTextUtils.clone(t)},_FONT_OPTION_FIELDS:["fontSize","fontFamily","fontWeight","fontStyle","color","overhang","oversink","opacity","zoom"],_DRAW_OPTIONS_FIELDS:["textType","charDirection","defaultCharDirection","fontSize","fontFamily","fontWeight","fontStyle","color","horizontalAlign","verticalAlign","zoom"],_fillLocalDrawOptions:function(t,r){for(var i=r||{},n=0,o=0,s=this._DRAW_OPTIONS_FIELDS.length;o<s;++o){var l=this._DRAW_OPTIONS_FIELDS[o],d=t[l];e.ObjUtils.notUnset(d)&&(i[l]=d,++n)}return e.ObjUtils.isUnset(t.charDirection)?i.charDirection=a.DEFAULT:t.charDirection===a.INHERIT&&(i.charDirection=r.charDirection),i},RECT_INFO_FIELD:"__rectInfo__",ACTUAL_FONT_FIELD:"__drawFont__",RENDER_TEXT_FIELD:"__renderText__",RENDER_ELEM_FIELD:"__renderElem__",LOCAL_DRAW_OPTIONS_FIELD:"__drawOptions__",_setItemRectInfo:function(e,t,r){e[this.RECT_INFO_FIELD]={boundRect:Object.extend({},t),alignRect:Object.extend({},r)}},_getItemRectInfo:function(e){return e[this.RECT_INFO_FIELD]},_setActualFontInfo:function(e,t){e[this.ACTUAL_FONT_FIELD]=t},_getActualFontInfo:function(e){return e[this.ACTUAL_FONT_FIELD]},_setRenderText:function(e,t){e[this.RENDER_TEXT_FIELD]=t},_getRenderText:function(e){return e[this.RENDER_TEXT_FIELD]||e.text},_setRenderElem:function(e,t){e[this.RENDER_ELEM_FIELD]=t},_getRenderElem:function(e){return e[this.RENDER_ELEM_FIELD]},_itemHasNoAlignRect:function(t){return e.ObjUtils.notUnset(t._noAlignRect)?!!t._noAlignRect:r.isSubscript(t)||r.isSuperscript(t)},drawEx:function(e,t,r,i,n){var a;i?(a=Object.create(this.options||{}),a=Object.extend(a,i)):a=this.options,a.defaultCharDirection||(a.defaultCharDirection=a.charDirection);var o=this.cloneRichText(r),s=this.getDrawBridge(),l={delayDrawing:s.canMeasureText(),adjustDrawing:s.canModifyText()};return this.doPrepare(e,t,o,a,l),{drawnObj:this.doRenderRichText(e,o,a,l),boundRect:this._getItemRectInfo(o).boundRect}},draw:function(e,t,r,i,n){return this.drawEx(e,t,r,i,n).drawnObj},doPrepare:function(t,r,i,n,a){var o=this.doPrepareItem(t,i,n,a),s=null;n.textBoxAlignmentMode===e.Render.TextBoxAlignmentMode.ANCHOR&&(s=this.doGetRootAnchorItemAbsAlignRect(i));var l,d=this._getItemRectInfo(i);if(s){var u=this.doAlignRectToCoord(r,s,n.textBoxXAlignment,n.textBoxYAlignment);l={x:u.left-s.left,y:u.top-s.top}}else{var c=this.doAlignRectToCoord(r,d.alignRect,n.textBoxXAlignment,n.textBoxYAlignment);l={x:c.left-d.alignRect.left,y:c.top-d.alignRect.top}}var h=e.RectUtils.shiftRect(d.alignRect,l.x,l.y),m=e.RectUtils.shiftRect(d.boundRect,l.x,l.y);return this._setItemRectInfo(i,m,h),o},doAlignRectToCoord:function(t,r,i,n){var a=e.Render.BoxXAlignment,o=e.Render.BoxYAlignment,s=i===a.RIGHT?-1:i===a.CENTER?-.5:0,l=n===o.TOP?0:n===o.CENTER?-.5:-1,d=Object.extend({},r);return d.left=t.x+d.width*s,d.top=t.y+d.height*l,d},doGetRootAnchorItemAbsAlignRect:function(t){var r=t;if(r.anchorItem){for(var i=this._getItemRectInfo(r).alignRect,n={x:i.left,y:i.top};r.anchorItem;)r=r.anchorItem,i=this._getItemRectInfo(r).alignRect,n.x+=i.left,n.y+=i.top;return e.RectUtils.createRect(n.x,n.y,i.width,i.height)}return null},doCalcActualDrawFontInfo:function(t,i){function n(t,r){if("string"==typeof t){var i=e.StyleUtils.analysisUnitsValue(t);return i.value=Math.round(Math.max(i.value*r,1)),""+i.value+i.units}return t*r}for(var a={sizeScale:1},o=0,s=this._FONT_OPTION_FIELDS.length;o<s;++o){var l=this._FONT_OPTION_FIELDS[o];e.ObjUtils.notUnset(i[l])&&(a[l]=i[l])}return e.ObjUtils.notUnset(a.zoom)&&(a.fontSize=n(a.fontSize,a.zoom||1),a.zoom=null),r.isSuperscript(t)?(a.sizeScale=i.supFontSizeRatio,a.fontSize=n(a.fontSize,i.supFontSizeRatio),a.isSup=!0,e.ObjUtils.isUnset(a.overhang)&&(a.overhang=i.superscriptOverhang||0)):r.isSubscript(t)&&(a.sizeScale=i.subFontSizeRatio,a.fontSize=n(a.fontSize,i.subFontSizeRatio),a.isSub=!0,e.ObjUtils.isUnset(a.oversink)&&(a.oversink=i.subscriptOversink||0)),a},doPrepareItem:function(i,n,o,s){var l=r.getItemType(n),d=Object.create(o);d=this._fillLocalDrawOptions(n,d),(d.charDirection===a.DEFAULT||e.ObjUtils.isUnset(d.charDirection))&&(d.charDirection=d.defaultCharDirection);var u;switch(l){case t.SECTION:u=this.doPrepareSection(i,n,d,s);break;case t.LINES:u=this.doPrepareLines(i,n,d,s);break;default:u=this.doPrepareGroup(i,n,d,s)}return u},doPrepareSection:function(e,t,i,n){var s=this.getDrawBridge(),l=this.doCalcActualDrawFontInfo(t,i);this._setActualFontInfo(t,l);var d=t.text;if(o.isVerticalLine(i.charDirection)&&d.length>1){var u=t;u.role="group",delete u.text,u.charDirection=i.charDirection;var c=Object.create(i);c=Object.extend(c,l),u.items=[];for(var h=0,m=d.length;h<m;++h)r.appendText(u,d.charAt(h));return this.doPrepareItem(e,u,c,n)}i.charDirection===a.RTL&&(d=d.reverse()),this._setRenderText(t,d);var g;if(n.delayDrawing)g=s.measureText(e,d,l);else{var f={x:-1e4,y:-1e4},p=this.getDrawBridge().drawText(e,f,d,l);this._setRenderElem(t,p),g=s.measureDrawnText(e,p,l)}var C={left:0,top:0,width:g.width||0,height:g.height||0};this._setItemRectInfo(t,C,C)},doPrepareLines:function(e,t,r,i){for(var n=r.charDirection||a.DEFAULT,o=t.items,s=n===a.TTB?a.RTL:n===a.BTT?a.LTR:a.TTB,l=0,d=o.length;l<d;++l){var u=o[l];u.charDirection||(u.charDirection=n)}return t.charDirection=s,r.charDirection=s,r._originCharDirection=n,this.doPrepareGroup(e,t,r,i)},doPrepareGroup:function(t,i,n,l){for(var d=i.items,u=0,c=d.length;u<c;++u){var h=d[u];this.doPrepareItem(t,h,n,l)}var m,g=n.charDirection||a.DEFAULT,f=n._originCharDirection||g,p=o.isHorizontalLine(g),C=p?"x":"y",b=p?"y":"x",E=s.getAbsAlign(n.horizontalAlign,f),N=s.getAbsAlign(n.verticalAlign,f);m=p?N==s.TOP?0:N==s.CENTER?-.5:-1:E==s.RIGHT?-1:E==s.CENTER?-.5:0;for(var T={x:0,y:0},O=g===a.RTL||g===a.BTT?-1:1,_=p?"left":"top",S=p?"top":"left",v=[],u=0,c=d.length;u<c;++u){var h=d[u],y=this._getItemRectInfo(h),A=y.boundRect,M=y.alignRect;if(O>0){var I=T[C]-A[_];A[_]=T[C],M[_]+=I}var R={x:A.width,y:A.height};if(T[C]+=R[C]*O,O<0){var I=T[C]-A[_];A[_]=T[C],M[_]+=I}var R={x:M.width,y:M.height},L=this._getActualFontInfo(h);if(!!L&&(L.isSup||L.isSub)&&r.getActualRefItem(h,i))v.push(h);else{var x=L?L.oversink||-(L.overhang||0):0;p||(x=-x);var D=R[b]*(m+x),P=M[S]-D;M[S]=D,A[S]-=P}}for(var u=0,c=v.length;u<c;++u){var h=v[u],B=r.getActualRefItem(h,i),L=this._getActualFontInfo(h),y=this._getItemRectInfo(h),w=this._getItemRectInfo(B).alignRect,A=y.boundRect,M=y.alignRect;if(L.isSup){var k=L.overhang;p?(M.top=w.top,M.height=w.height,A.top=w.top-w.height*k):(M.left=w.left,M.width=w.width,A.left=w.lefy+w.width-A.left+w.width*k)}else{var x=L.oversink;p?(M.top=w.top,M.height=w.height,A.top=w.top+w.height-A.height+w.height*x):(M.left=w.left,M.width=w.width,A.left=w.left-w.width*x)}}for(var d=i.items,U=null,j=null,u=0,c=d.length;u<c;++u){var h=d[u];y=this._getItemRectInfo(h),this._itemHasNoAlignRect(h)&&(U||u!=c-1)||(U=U?e.RectUtils.getContainerRect(U,y.alignRect):Object.extend({},y.alignRect)),j=j?e.RectUtils.getContainerRect(j,y.boundRect):Object.extend({},y.boundRect)}d.length<=0&&(U=e.RectUtils.createRect(0,0,0,0),j=e.RectUtils.createRect(0,0,0,0));var P={x:-U.left,y:-U.top};if(0!==P.x||0!==P.y){for(var u=0,c=d.length;u<c;++u)y=this._getItemRectInfo(d[u]),y.alignRect=e.RectUtils.shiftRect(y.alignRect,P.x,P.y),y.boundRect=e.RectUtils.shiftRect(y.boundRect,P.x,P.y);U.left=0,U.top=0,j.left+=P.x,j.top+=P.y}this._setItemRectInfo(i,j,U)},doRenderRichText:function(e,t,r,i){var n=this.getDrawBridge(),a=n.createGroup(e);return this.doRenderItem(e,{x:0,y:0},t,i,a),a},doRenderItem:function(e,i,n,a,o){var s,l=r.getItemType(n);switch(l){case t.SECTION:s=this.doRenderSection(e,i,n,a,o);break;default:s=this.doRenderGroup(e,i,n,a,o)}return s},doRenderGroup:function(e,t,r,i,n){var a=r.items;if(a.length<=0)return null;for(var o=this._getItemRectInfo(r),s={x:t.x+o.alignRect.left,y:t.y+o.alignRect.top},l=0,d=a.length;l<d;++l)this.doRenderItem(e,s,a[l],i,n)},doRenderSection:function(t,r,i,n,a){var o=this._getItemRectInfo(i),s=o.boundRect,l={x:s.left,y:s.top};l=e.CoordUtils.add(l,r);var d,u=this._getRenderText(i),c=this._getActualFontInfo(i),h=this.getDrawBridge();n.delayDrawing?d=h.drawText(t,l,u,c):n.adjustDrawing&&(d=this._getRenderElem(i),h.modifyDrawnTextCoord(t,d,l)),h.addToGroup(d,a)}}),e}},function(e,t,r){"use strict";var i=r(0).Class,n=r(0).ObjectEx,a=r(0).DataType;e.exports=function(e){return e.Render.BoundInfoRecorder=i.create(n,{CLASS_NAME:"Kekule.Render.BoundInfoRecorder",initialize:function($super,t){$super(),this.setPropStoreFieldValue("boundInfos",new e.TwoTupleMapEx(!0)),this._renderer=t,t&&t.setBoundInfoRecorder&&t.setBoundInfoRecorder(this),this.installEventListener(t)},finalize:function($super){this._renderer&&this.uninstallEventListener(this._renderer);var e=this.getPropStoreFieldValue("boundInfos");e&&e.clear(),$super()},initProperties:function(){this.defineProp("boundInfos",{dataType:"Kekule.TwoTupleMapEx",serializable:!1,setter:null}),this.defineProp("targetContext",{dataType:a.OBJECT,serializable:!1})},needRecordOnContext:function(e){var t=this.getTargetContext();return!t||t===e},installEventListener:function(e){e.addEventListener("updateBasicDrawObject",this._reactRendererUpdateBasicDrawObject,this),e.addEventListener("clear",this._reactRendererClear,this)},uninstallEventListener:function(e){e.removeEventListener("updateBasicDrawObject",this._reactRendererUpdateBasicDrawObject,this),e.removeEventListener("clear",this._reactRendererClear,this)},_reactRendererUpdateBasicDrawObject:function(t){var r=e.Render.ObjectUpdateType;if(this.needRecordOnContext(t.context)){var i=t.updateType;i===r.ADD?this.add(t.context,t.obj,t.parentObj,t.boundInfo,t.target):i===r.MODIFY?this.modify(t.context,t.obj,t.parentObj,t.boundInfo,t.target):i===r.REMOVE?this.remove(t.context,t.obj):i===r.CLEAR&&this.clear(t.context),this.invokeEvent("updateBasicDrawObject",t)}},_reactRendererClear:function(e){this.needRecordOnContext(e.context)&&this.clearOnRenderer(e.context,e.target);this.getAllRecordedInfoOfContext(e.context)},getInfo:function(e,t){return this.getBoundInfos().get(e,t)},getBelongedInfos:function(e,t){var r=this.getInfo(e,t);if(r)return[r];for(var i=[],n=this.getAllRecordedInfoOfContext(e),a=0,o=n.length;a<o;++a){var r=n[a];r.obj.isChildOf(t)&&i.push(r)}return i},getBound:function(t,r){var i=this.getInfo(t,r),n=i?i.boundInfo:null;if(!n){for(var a=e.BoxUtils,o=e.Render.MetaShapeUtils,s=this.getBelongedInfos(t,r),l=null,d=0,u=s.length;d<u;++d){var i=s[d],c=o.getContainerBox(i.boundInfo,0);l=l?a.getContainerBox(l,c):c}l&&(n=o.createShapeInfo(e.Render.MetaShapeType.RECT,[{x:l.x1,y:l.y1},{x:l.x2,y:l.y2}]))}return n},clearOnRenderer:function(e,t){var r=this.getBoundInfos(),i=r.getSecondLevelMap(e);if(i)for(var n=i.getKeys(),r=i.getValues(),a=n.length-1;a>=0;--a){var o=n[a],s=r[a];s.renderer===t&&i.remove(o)}},clear:function(e){var t=this.getBoundInfos(),r=t.getSecondLevelMap(e);return r&&r.clear(),this},clearAll:function(){return this.getBoundInfos().clear(),this},add:function(e,t,r,i,n){return this.getBoundInfos().set(e,t,{obj:t,parentObj:r,boundInfo:i,renderer:n}),this},modify:function(t,r,i,n,a){var o=this.getBoundInfos().get(t,r);o||(o={},this.getBoundInfos.set(t,r,o));var s=e.ObjUtils.notUnset;return s(i)&&(o.parentObj=i),s(n)&&(o.boundInfo=n),s(a)&&(o.renderer=a),this},remove:function(e,t,r){return this.getBoundInfos().remove(e,t),this},getAllRecordedInfoOfContext:function(e){var t=this.getBoundInfos(),r=t.getSecondLevelMap(e);return r?r.getValues():[]},getAllBoundInfosOfContext:function(e){for(var t=this.getAllRecordedInfoOfContext(e),r=[],i=0,n=t.length;i<n;++i){var a=t[i].boundInfo;a&&r.push(a)}return r},getContainerBox:function(t){for(var r=e.BoxUtils,i=e.Render.MetaShapeUtils,n=null,a=this.getAllBoundInfosOfContext(t),o=0,s=a.length;o<s;++o){var l=i.getContainerBox(a[o],0);n=r.getContainerBox(n,l)}return n},getIntersectionInfos:function(t,r,i,n,a){for(var o=[],s=this.getAllRecordedInfoOfContext(t),l=0,d=s.length;l<d;++l){var u=s[l].boundInfo;a&&!a(s[l])||u&&(s[l].obj instanceof e.ChemMarker.UnbondedElectronSet?e.Render.MetaShapeUtils.isCoordInside(r,u,t.zoom&&t.zoom*n>n?t.zoom*n:n)&&o.push(s[l]):e.Render.MetaShapeUtils.isCoordInside(r,u,n)&&o.push(s[l]))}return o}}),e}},function(e,t,r){"use strict";var i=r(0).Class,n=r(0).DataType;r(1).XmlUtility;e.exports=function(e){var t=e.Render.BondRenderType,r=e.Render.TextDirection,a=e.BoxUtils,o=e.BondOrder,s=e.CoordUtils,l=e.oneOf;return e.Render.Abstract2DDrawBridge=i.create({CLASS_NAME:"Kekule.Render.Abstract2DDrawBridge",createContext:function(e,t,r){return null},releaseContext:function(e){},getContextDimension:function(e){return{}},setContextDimension:function(e,t,r){return null},getContextElem:function(e){},setContextViewBox:function(e,t,r,i,n,a){},clearContext:function(e){return null},setClearColor:function(e,t){},transformContextCoordToScreen:function(e,t){return t},transformScreenCoordToContext:function(e,t){return t},canModifyGraphic:function(e){return!1},drawPath:function(e,t,r){},drawLine:function(e,t,r,i){},drawTriangle:function(e,t,r,i,n){},drawRect:function(e,t,r,i){},drawRoundRect:function(e,t,r,i,n){},drawCircle:function(e,t,r,i){},drawArc:function(e,t,r,i,n,a,o){},drawImage:function(e,t,r,i,n,a){},drawImageElem:function(e,t,r,i,n){},createGroup:function(e){return null},addToGroup:function(e,t){},removeFromGroup:function(e,t){},removeDrawnElem:function(e,t){},exportToDataUri:function(e,t,r){}}),e.Render.Base2DRenderer=i.create(e.Render.CompositeRenderer,{CLASS_NAME:"Kekule.Render.Base2DRenderer",initialize:function($super,e,t,r){$super(e,t,r),this.__$redirectContextDebug__=!1,this._richTextDrawer=null},initProperties:function(){this.defineProp("richTextDrawerClass",{dataType:n.CLASS,serializable:!1})},getActualTargetContext:function(e){return this.getRedirectContext()||e},getRendererType:function(){return e.Render.RendererType.R2D},canMeasureText:function(e){return this.getDrawBridge().canMeasureText(e)},getAutoScaleRefDrawLength:function(e){return e.defBondLength},getAutoScaleRefObjLength:function(t,r){var i=t||this.getChemObj();if(!i.getAllAutoScaleRefLengths)return null;var n=i.getAllAutoScaleRefLengths(e.CoordMode.COORD2D,r);return n&&n.length?e.ArrayUtils.getMedian(n):void 0},getRichTextDrawer:function(){if(!this._richTextDrawer){var t=this.getRichTextDrawerClass()||e.Render.BaseRichTextDrawer;this._richTextDrawer=new t(this.getDrawBridge())}return this._richTextDrawer},drawPath:function(e,t,r){return this.getDrawBridge().drawPath(this.getActualTargetContext(e),t,r)},drawLine:function(e,t,r,i){if(this.__$redirectContextDebug__){var n=Object.create(i);return this.getRedirectContext()&&(n.color=n.strokeColor="#ff0000"),this.getDrawBridge().drawLine(this.getActualTargetContext(e),t,r,n)}return this.getDrawBridge().drawLine(this.getActualTargetContext(e),t,r,i)},drawArrowLine:function(e,t,r,i,n){var a=this.getActualTargetContext(e);if(i){var o=this.createDrawGroup(a),s=this.drawLine(a,t,r,n);this.addToDrawGroup(s,o);var l=r.x-t.x,d=r.y-t.y,u=Math.atan(d/l),c=Math.sign(l)||1,h=(i.width||6)/2,m=i.length||3,g=Math.atan(h/m),f=Math.sqrt(Math.sqr(h)+Math.sqr(m))*c,p=Math.cos(u-g)*f,C=Math.sin(u-g)*f,b=Math.cos(u+g)*f,E=Math.sin(u+g)*f;return s=this.drawLine(a,r,{x:r.x-p,y:r.y-C},n),this.addToDrawGroup(s,o),s=this.drawLine(a,r,{x:r.x-b,y:r.y-E},n),this.addToDrawGroup(s,o),o}return this.drawLine(a,t,r,n)},drawTriangle:function(e,t,r,i,n){return this.getDrawBridge().drawTriangle(this.getActualTargetContext(e),t,r,i,n)},drawRect:function(e,t,r,i){var n={x:Math.min(t.x,r.x),y:Math.min(t.y,r.y)},a={x:Math.max(t.x,r.x),y:Math.max(t.y,r.y)};return this.getDrawBridge().drawRect(this.getActualTargetContext(e),n,a,i)},drawRoundRect:function(e,t,r,i,n){var a={x:Math.min(t.x,r.x),y:Math.min(t.y,r.y)},o={x:Math.max(t.x,r.x),y:Math.max(t.y,r.y)};return this.getDrawBridge().drawRoundRect(this.getActualTargetContext(e),a,o,i,n)},drawCircle:function(e,t,r,i){return this.getDrawBridge().drawCircle(this.getActualTargetContext(e),t,r,i)},drawArc:function(e,t,r,i,n,a,o){return this.getDrawBridge().drawArc(this.getActualTargetContext(e),t,r,i,n,a,o)},drawText:function(t,r,i,n){var a=this.getRichTextDrawer(),o=e.Render.RichTextUtils.strToRichText(i,n);if(this.__$redirectContextDebug__){var s=Object.create(n||{});return this.getRedirectContext()&&(s.color=s.strokeColor="#ff0000"),a.drawEx(this.getActualTargetContext(t),r,o,s)}return a.drawEx(this.getActualTargetContext(t),r,o,n)},drawRichText:function(e,t,r,i){var n=this.getRichTextDrawer();if(i.fontWeight="bold",r.text){var a=r.text;i.strokeColor="transparent",i.globalCompositeOperation="destination-over";var o=12*i.zoom;"-"!==a&&"+"!==a||(i.fontSize=20),a.includes("+")&&(i.fillColor="rgb(172,219,162)"),a.includes("-")&&(i.fillColor="rgb(255,175,175)"),r.text=a.replace("-","‒"),this.drawCircle(e,t,o,i)}if(this.__$redirectContextDebug__){var s=Object.create(i||{});return this.getRedirectContext()&&(s.color=s.strokeColor="#ff0000"),n.drawEx(this.getActualTargetContext(e),t,r,s)}return n.drawEx(this.getActualTargetContext(e),t,r,i)},drawImage:function(e,t,r,i,n,a){var o=this;return this.getDrawBridge().drawImage(this.getActualTargetContext(e),t,r,i,n,a,function(){return o.getActualTargetContext(e)})},drawImageElem:function(t,r,i,n,a){if(r.complete)return this.getDrawBridge().drawImageElem(this.getActualTargetContext(t),r,i,n,a);var o=e.X.Event;if(o){var s=this,l=function(){o.removeListener(r,"load",d)},d=function(){l(),s.update(s.getActualTargetContext(t),[{obj:s.getChemObj()}],e.Render.ObjectUpdateType.MODIFY)};o.addListener(r,"load",d),o.addListener(r,"error",l)}},createDrawGroup:function(e){return this.getDrawBridge().createGroup(this.getActualTargetContext(e))},addToDrawGroup:function(e,t){return this.getDrawBridge().addToGroup(e,t)},removeFromDrawGroup:function(e,t){return this.getDrawBridge().removeFromGroup(e,t)},removeDrawnElem:function(e,t){return this.getDrawBridge().removeDrawnElem(this.getActualTargetContext(e),t)},transformScreenCoordToContext:function(e,t){return this.doTransformScreenCoordToContext(this.getActualTargetContext(e),t)},doTransformScreenCoordToContext:function(e,t){var r=this.getDrawBridge();return r&&r.transformScreenCoordToContext?r.transformScreenCoordToContext(this.getActualTargetContext(e),t):t}}),e.Render.ChemObj2DRenderer=i.create(e.Render.Base2DRenderer,{CLASS_NAME:"Kekule.Render.ChemObj2DRenderer",_getRenderSortIndex:function($super){var e=this.getChemObj();return e&&e.coordStickTarget&&e.getCoordStickTarget()?1:$super()},doEstimateSelfObjBox:function(t,r,i){return e.Render.ObjUtils.getContainerBox(this.getChemObj(),this.getCoordMode(),i)},doEstimateRenderBox:function(e,t,r,i){var n=this.estimateObjBox(e,r,i);if(n){var o=this.prepareTransformParams(e,t,r,n),s=o;return a.transform2D(n,s)}return null},doGetAutoBaseCoord:function(t){var r=t.transformParams;if(r){var i=this.getChemObj(),n=i.getAbsBaseCoord?i.getAbsBaseCoord(e.CoordMode.COORD2D):i.getAbsBaseCoord2D?i.getAbsBaseCoord2D():null;if(n)return e.CoordUtils.transform2D(n,r)}return null},doDraw:function($super,e,t,r){var i=this.getAutoScaleRefObjLength(this.getChemObj(),r.allowCoordBorrow);return r.medianObjRefLength=i||r.defScaleRefLength,this.prepareTransformParams(e,t,r),this.prepareGeneralOptions(e,r),$super(e,t,r)},prepareGeneralOptions:function(e,t){},prepareTransformParams:function(t,r,i,n){var a;if(i.transformParams)a=i.transformParams;else{var o=this.generateTransformParams(t,r,i,n);i.transformParams=o,a=o}var s=e.CoordUtils.calcTransform2DMatrix(a),l=e.CoordUtils.calcInverseTransform2DMatrix(a);return i.transformParams.transformMatrix=s,i.transformParams.invTransformMtrix=l,this.getRenderCache(t).transformParams=a,this.getRenderCache(t).transformMatrix=s,this.getRenderCache(t).invTransformMatrix=l,a},calcPreferedTransformOptions:function(t,r,i,n){var a={};a.allowCoordBorrow=l(i.allowCoordBorrow,!1),a.unitLength=i.unitLength||1,n||(n=this.estimateObjBox(t,i,a.allowCoordBorrow)),n||(n={x1:0,x2:1,y1:0,y2:1});var o={x:(n.x1+n.x2)/2,y:(n.y1+n.y2)/2},s=e.ObjUtils;if(s.isUnset(i.translateX)&&s.isUnset(i.translateY)?r&&(a.translateX=r.x-o.x,a.translateY=r.y-o.y):(a.translateX=i.translateX||0,a.translateY=i.translateY||0),a.zoom=i.zoom||1,i.scale||i.scaleX||i.scaleY)a.scaleX=l(i.scaleX,i.scale,1),a.scaleY=l(i.scaleY,i.scale,1);else if(i.autofit){var d=this.getDrawBridge().getContextDimension(t);d.x=d.width,d.y=d.height,d=this.getDrawBridge().transformScreenCoordToContext(t,d),d.width=d.x,d.height=d.y;var u=i.autofitContextPadding;u*=2*a.unitLength,n.width=n.x2-n.x1,n.height=n.y2-n.y1;var c=Math.max(d.width-u,0)/(n.width||1),h=Math.max(d.height-u,0)/(n.height||1);s.isUnset(i.retainAspect)||i.retainAspect?a.scaleX=a.scaleY=Math.min(c,h):(a.scaleX=c,a.scaleY=h)}else{var m=l(i.refDrawLength,this.getAutoScaleRefDrawLength(i))||1,g=i.medianObjRefLength;e.ObjUtils.isUnset(g)&&(g=i.defScaleRefLength),a.scaleX=a.scaleY=m/g||1}return s.notUnset(i.rotateAngle)&&(a.rotateAngle=i.rotateAngle),s.isUnset(i.center)?a.center=o:a.center=i.center,a.drawBaseCoord=r||e.CoordUtils.transform2D(o,a),a},generateTransformParams:function(e,t,r,i){var n=this.calcPreferedTransformOptions(e,t,r,i),a=Object.extend({},n);return n=this.getFinalTransformParams(e,n),n.initialTransformOptions=a,n},getFinalTransformParams:function(e,t){var r=Object.create(t);return r.zoom&&(r.scaleX*=r.zoom,r.scaleY*=r.zoom),r.scaleY=-r.scaleY,r.unitLength&&(r.translateX*=r.unitLength,r.translateY*=r.unitLength,r.drawBaseCoord.x*=r.unitLength,r.drawBaseCoord.y*=r.unitLength),r},getRenderFinalTransformParams:function(e){return this.getRenderCache(e).transformParams},getRenderInitialTransformOptions:function(e){var t=this.getRenderFinalTransformParams(e);return t?t.initialTransformOptions:null},doTransformCoordToObj:function(t,r,i){var n=this.getRenderCache(t).invTransformMatrix;return e.CoordUtils.transform2DByMatrix(i,n)},doTransformCoordToContext:function(t,r,i){var n=this.getRenderCache(t).transformMatrix;return e.CoordUtils.transform2DByMatrix(i,n)}}),e.Render.RichTextBased2DRenderer=i.create(e.Render.ChemObj2DRenderer,{CLASS_NAME:"Kekule.Render.RichTextBased2DRenderer",DRAWN_OBJ_FIELD:"__$drawnObj__",initialize:function($super,e,t,r){$super(e,t,r),this.__$alwaysRecalcSize__=!1,this.__$isRecalculatingSize=!1},getDrawnObj:function(e){return this.getExtraProp(e,this.DRAWN_OBJ_FIELD)},setDrawnObj:function(e,t){this.setExtraProp(e,this.DRAWN_OBJ_FIELD,t)},getRichText:function(e,t){return null},extractRichTextDrawOptions:function(e){var t=Object.create(e||{});return t.horizontalAlign=l(t.horizontalAlign,t.textHorizontalAlign),t.verticalAlign=l(t.verticalAlign,t.textVerticalAlign),t.charDirection=l(t.charDirection,t.textCharDirection),t},getDrawTextCoord:function(e,t){return t},doDrawSelf:function($super,t,r,i){$super(t,r,i);var n=this.getChemObj(),a=(i.transformParams,this.getRichText(this.getChemObj(),i));if(!a)return null;r||(r=this.getAutoBaseCoord(i));var o=this.getDrawTextCoord(t,r),s=this.drawRichText(t,o,a,this.extractRichTextDrawOptions(i)),l=s.boundRect,d=this.createRectBoundInfo({x:l.left,y:l.top},{x:l.left+l.width,y:l.top+l.height});return this.basicDrawObjectUpdated(t,n,n,d,e.Render.ObjectUpdateType.ADD),this.getRenderCache(t).drawnObj=s.drawnObj,this.setDrawnObj(t,s.drawnObj),(this.getCanModifyTargetObj()&&n.getNeedRecalcSize&&n.getNeedRecalcSize()||this.__$alwaysRecalcSize__)&&this._autosetObjSize(t,n,d),s.drawnObj},_autosetObjSize:function(t,r,i){if(!this.__$isRecalculatingSize&&r.hasProperty("size2D")&&r.setNeedRecalcSize){this.__$isRecalculatingSize=!0;try{var n=i.coords,a=this.transformCoordToObj(t,r,n[0]),o=this.transformCoordToObj(t,r,n[1]),s=e.CoordUtils.substract(o,a);r.setPropStoreFieldValue("size2D",{x:Math.abs(s.x),y:Math.abs(s.y)}),r.setNeedRecalcSize(!1)}finally{this.__$isRecalculatingSize=!1}}}}),e.Render.TextBlock2DRenderer=i.create(e.Render.RichTextBased2DRenderer,{CLASS_NAME:"Kekule.Render.TextBlock2DRenderer",getRichText:function(t,r){return e.Render.RichTextUtils.strToRichText(t.getText())},doEstimateSelfObjBox:function(e,t,r){return this.getChemObj().getBox2D(r)},getDrawTextCoord:function(t,r){var i=this.getChemObj(),n=i.getExposedContainerBox(),a={x:n.x1,y:n.y2},o={x:n.x2,y:n.y1},s=this.transformCoordToContext(t,i,a),l=this.transformCoordToContext(t,i,o),d=e.CoordUtils.substract(l,s);return{x:r.x-d.x/2,y:r.y-d.y/2}},extractRichTextDrawOptions:function($super,t){var r=$super(t);return r.fontSize=l(r.fontSize,r.labelFontSize),r.fontFamily=l(r.fontFamily,r.labelFontFamily),r.color=l(r.color,r.labelColor),r.textBoxXAlignment=e.Render.BoxXAlignment.LEFT,r.textBoxYAlignment=e.Render.BoxYAlignment.TOP,r}}),e.Render.Formula2DRenderer=i.create(e.Render.RichTextBased2DRenderer,{CLASS_NAME:"Kekule.Render.Formula2DRenderer",basicDrawObjectUpdated:function($super,e,t,r,i,n){return t===this.getChemObj()?$super(e,t.getParent(),t.getParent(),i,n):$super(e,t,r,i,n)},getRichText:function(e,t){return e.getDisplayRichText(!0,t.displayLabelConfigs,t.partialChargeDecimalsLength,t.chargeMarkType)},doEstimateSelfObjBox:function(e,t,r){var i=this.getChemObj()?this.getChemObj().getParent():null;if(i){var n=i?i.getAbsBaseCoord2D(r):{x:0,y:0};return a.createBox(n,n)}return null},extractRichTextDrawOptions:function($super,t){var r=$super(t);return r.fontSize=l(r.fontSize,r.atomFontSize),r.fontFamily=l(r.fontFamily,r.atomFontFamily),r.color=l(r.color,r.labelColor,r.atomColor),r.textBoxXAlignment=e.Render.BoxXAlignment.CENTER,r.textBoxYAlignment=e.Render.BoxYAlignment.CENTER,r}}),e.Render.TextBasedChemMarker2DRenderer=i.create(e.Render.RichTextBased2DRenderer,{CLASS_NAME:"Kekule.Render.TextBasedChemMarker2DRenderer",initialize:function($super,e,t,r){$super(e,t,r)},doDrawSelf:function($super,e,t,r){return $super(e,t,r)},getRichText:function(t,r){var i,n=this.getChemObj();if(n instanceof e.ChemMarker.Charge){var a=n.getValue();if(i=e.Render.ChemDisplayTextUtils.getChargeDisplayText(a,r.partialChargeDecimalsLength,r.chargeMarkType))return e.Render.RichTextUtils.createSection(i,{charDirection:e.Render.TextDirection.LTR})}else if(n instanceof e.ChemMarker.Radical){var o=n.getValue();if(i=e.Render.ChemDisplayTextUtils.getRadicalDisplayText(o,r.distinguishSingletAndTripletRadical))return e.Render.RichTextUtils.createSection(i,{charDirection:e.Render.TextDirection.LTR})}return null},doEstimateSelfObjBox:function($super,e,t,r){return $super(e,t,r)},extractRichTextDrawOptions:function($super,t){var r=$super(t),i=this.getChemObj();return r.fontSize=l(i.getRenderOption("fontSize"),r.chemMarkerFontSize,r.fontSize,r.atomFontSize),r.fontFamily=l(r.fontFamily,r.atomFontFamily),r.color=l(r.color,r.atomColor,r.labelColor),r.textBoxXAlignment=e.Render.BoxXAlignment.CENTER,r.textBoxYAlignment=e.Render.BoxYAlignment.CENTER,r}}),e.Render.ImageBlock2DRenderer=i.create(e.Render.ChemObj2DRenderer,{CLASS_NAME:"Kekule.Render.ImageBlock2DRenderer",initialize:function($super,e,t,r){$super(e,t,r)},doDrawSelf:function($super,t,r,i){$super(t,r,i);var n=this.getChemObj();i.transformParams;if(!n||!n.getSrc||!n.getSrc())return null;r||(r=this.getAutoBaseCoord(i));var a,o=n.getExposedContainerBox(),s={x:o.x1,y:o.y2},l={x:o.x2,y:o.y1},d=this.transformCoordToContext(t,n,s),u=this.transformCoordToContext(t,n,l),c=e.CoordUtils.substract(u,d),h={x:r.x-c.x/2,y:r.y-c.y/2},m=n.getCacheImg();return a=m?this.drawImageElem(t,m,h,c,i):this.drawImage(t,n.getSrc(),h,c,i),this.basicDrawObjectUpdated(t,n,n,this.createRectBoundInfo(h,e.CoordUtils.add(h,c)),e.Render.ObjectUpdateType.ADD),a}}),e.Render.UnbondedElectronSetRenderer=i.create(e.Render.ChemObj2DRenderer,{CLASS_NAME:"Kekule.Render.UnbondedElectronSetRenderer",_extractActualDrawOptions:function(e){var t=Object.create(e),r=this.getChemObj();return t.fontSize=l(r.getRenderOption("fontSize"),t.chargeMarkFontSize,t.fontSize,t.atomFontSize),t.color=l(t.color,t.atomColor,t.labelColor),t.strokeColor=t.color,t.fillColor=t.color,t.electronGap=t.fontSize/3*(t.unitLength||1)*(t.zoom||1),t.electronRadius=t.fontSize/12*(t.unitLength||1)*(t.zoom||1),t},_drawSingleElectron:function(e,t,r,i){return i.strokeColor="#ffffff",i.strokeWidth=4,i.globalCompositeOperation="destination-over",this.drawCircle(e,t,r,i)},_drawElectrons:function(e,t,r,i,n){var a,o,l=s.substract(r,i),d=s.getDistance(l);if(0===d)var a=0,o=1;else var a=l.x/d,o=l.y/d;for(var u,c=n.electronGap,h=n.electronRadius,m={x:c*o,y:-c*a},g=(t-1)/2,f=s.substract(r,s.multiply(m,g)),p=[],C=t>1?this.createDrawGroup(e):null,b=0;b<t;++b)p.push(f),u=this._drawSingleElectron(e,f,h,n),C&&this.addToDrawGroup(u,C),f=s.add(f,m);var E;if(p.length<=1)E=this.createCircleBoundInfo(p[0],h);else{var N={x:(p[0].x+p[1].x)/2,y:(p[0].y+p[1].y)/2};E=this.createCircleBoundInfo(N,h)}return{electronCoords:p,drawnElem:C||u,electronRadius:h,boundInfo:E}},_doGetParentCoord:function(t,r,i){var n=i.transformParams;if(n){var a=r,o=a.getAbsBaseCoord?a.getAbsBaseCoord(e.CoordMode.COORD2D):a.getAbsBaseCoord2D?a.getAbsBaseCoord2D():null;if(o)return s.transform2D(o,n)}return null},doDrawSelf:function($super,t,r,i){$super(t,r,i);var n=this._extractActualDrawOptions(i),a=this.getChemObj(),o=a.getParent();i.transformParams;if(!a||!o||o.getAtomicNumber()>=113||!a.getElectronCount||(a.getElectronCount()||0)<=0)return null;r||(r=this.getAutoBaseCoord(i));for(var s=this._doGetParentCoord(t,o,i),l=0,d=0;d<o.getMarkerCount();++d){o.getMarkerAt(d)instanceof e.ChemMarker.UnbondedElectronSet&&(l+=1)}if(!r||!s)return null;if(l>4&&a instanceof e.ChemMarker.UnbondedElectronSet&&o.indexOfMarker(a)>3)return o.removeMarkerAt(o.getMarkerCount()-1),null;var u=this._drawElectrons(t,a.getElectronCount(),r,s,n);u.electronCoords,u.electronRadius;return this.basicDrawObjectUpdated(t,a,o,u.boundInfo,e.Render.ObjectUpdateType.ADD),u.drawnElem}}),e.Render.Ctab2DRenderer=i.create(e.Render.ChemObj2DRenderer,{CLASS_NAME:"Kekule.Render.Ctab2DRenderer",DRAW_ELEM_FIELD:"__$drawElem__",TRANSFORM_COORD_FIELD:"__$transCoord2D__",TRANSFORM_MATRIX_FIELD:"__$transMatrix__",RENDERED_OBJS_FIELD:"__$renderedObjs__",INV_TRANSFORM_MATRIX_FIELD:"__$inverseTransMatrix__",CHILD_TRANSFORM_MATRIX_FIELD:"__$childTransMatrix__",_getRenderSortIndex:function($super){for(var e=this.getChemObj(),t=e.getExposedNodes(),r=0,i=t.length;r<i;++r){var n=t[r];if(n&&n.coordStickTarget&&n.getCoordStickTarget())return 1}return $super()},doEstimateSelfObjBox:function(e,t,r){return this.getChemObj().getExposedContainerBox2D(r)},getObjDrawElem:function(e,t){return this.getExtraProp2(e,t,this.DRAW_ELEM_FIELD)},setObjDrawElem:function(e,t,r){this.setExtraProp2(e,t,this.DRAW_ELEM_FIELD,r)},getRenderedObjs:function(e){return this.getExtraProp(e,this.RENDERED_OBJS_FIELD)},addRenderedObj:function(t,r){var i=this.getRenderedObjs(t);i?e.ArrayUtils.pushUnique(i,r):(i=[r],this.setExtraProp(t,this.RENDERED_OBJS_FIELD,i))},removeRenderedObj:function(t,r){var i=this.getRenderedObjs(t);i&&e.ArrayUtils.remove(i,r)},clearRenderedObj:function(e){this.setExtraProp(e,this.RENDERED_OBJS_FIELD,null)},prepareGeneralOptions:function($super,e,t){return $super(e,t)},doPrepare:function($super,e,t,r,i){$super(e,t,r,i),this.doPrepareLayout(e,t,r,i)},doPrepareLayout:function(e,t,r,i){},handleNodeSpecifiedRenderOptions:function(e,t){var r=(e.getOverriddenRenderOptions?e.getOverriddenRenderOptions():null)||{},i=Object.create(t);return i=Object.extend(i,r)},handleConnectorSpecifiedRenderOptions:function($super,e,t){var r=(e.getOverriddenRenderOptions?e.getOverriddenRenderOptions():null)||{},i=Object.create(t||null);return i=Object.extend(i,r)},isChemObjRenderedBySelf:function($super,e,t){var r=this.getRenderedObjs(e);return $super(e,t)||r&&r.indexOf(t)>=0||this.getChemObj().hasChildObj(t)&&(!t.isExposed||t.isExposed())},isChemObjRenderedDirectlyBySelf:function($super,e,t){var r=this.getRenderedObjs(e);return $super(e,t)||r&&r.indexOf(t)>=0},doDrawSelf:function($super,e,t,r){$super(e,t,r);var i=this.getChemObj();this._ctab=i;var n=r.transformParams;return this.getRenderCache(e).transformOptions=n,this.transformCtabCoords2DToContext(e,i,n),this.doPrepare(e,i,t,r),this.getRenderCache(e).appliedOptions=r,this.doDrawCore(e,i,r,n)},doRedraw:function(e){var t=this.getRenderCache(e);return this.doDrawCore(e,this.getChemObj(),t.appliedOptions,t.transformOptions)},doDrawCore:function(e,t,r,i){this.clearRenderedObj(e);var n=this.createDrawGroup(e);return this.doDrawConnectors(e,n,t,r,i),this.doDrawNodes(e,n,t,r,i),this.setObjDrawElem(e,t,n),n},doUpdateSelf:function($super,t,r,i){if(this.canModifyGraphic(t)){var n=!1,a=e.Render.ObjectUpdateType;switch(i){case a.ADD:n=this.doAddNew(t,r);break;case a.MODIFY:n=this.doModify(t,r);break;case a.REMOVE:n=this.doRemove(t,e.Render.UpdateObjUtils._extractObjsOfUpdateObjDetails(r));break;default:return $super(t,r,i)}return n}return $super(t,r,i)},doAddNew:function(e,t){return!!this.canModifyGraphic()&&this.doModify(e,t)},doModify:function(e,t){if(this.canModifyGraphic()){var r=this._extractObjsOfUpdateObjDetails(t);this.remove(e,r);var i=this.getChemObj(),n=this.getObjDrawElem(e,i),a=this.getRenderCache(e),o=a.appliedOptions;r.indexOf(i)>=0&&this.draw(e,a.baseCoord,o);for(var s=0,l=r.length;s<l;++s){var d=r[s];if(!d.isExposed||d.isExposed())if(i.hasConnector(d)){var u=this.handleConnectorSpecifiedRenderOptions(d,o);this.doDrawConnector(e,n,d,this.getChemObj(),u,a.transformParams||{})}else if(i.hasNode(d)){var u=this.handleNodeSpecifiedRenderOptions(d,o);this.doDrawNode(e,n,d,this.getChemObj(),u,a.transformParams)}}return!0}return!1},doRemove:function(t,r){if(this.canModifyGraphic()){for(var i=e.ArrayUtils.toArray(r),n=0,a=i.length;n<a;++n){var o=i[n],s=this.getObjDrawElem(t,o);if(s){var l=this.getObjDrawElem(t,this.getChemObj());this.removeFromDrawGroup(s,l),this.removeDrawnElem(t,s)}this.removeRenderedObj(t,o),this.removeExtraProp2(t,o),this.basicDrawObjectUpdated(t,o,this.getChemObj(),null,e.Render.ObjectUpdateType.REMOVE)}return!0}return!1},getCoordTransformOptions:function(e){return this.getRenderCache(e).transformOptions},transformCtabCoords2DToContext:function(e,t,r){var i=r.allowCoordBorrow,n=Object.extend({},r);n.centerX=0,n.centerY=0;var a=r.transformMatrix;this.setExtraProp2(e,t,this.TRANSFORM_MATRIX_FIELD,a);var o=a;this.setExtraProp2(e,t,this.CHILD_TRANSFORM_MATRIX_FIELD,a);var s=r.invTransformMatrix;this.setExtraProp2(e,t,this.INV_TRANSFORM_MATRIX_FIELD,s);for(var l=0,d=t.getNodeCount();l<d;++l){var u=t.getNodeAt(l);this.transformObjCoord2DToContext(e,u,a,o,i)}},transformObjCoord2DToContext:function(t,r,i,n,a){var o;if(r&&r.getAbsBaseCoord2D){var s=r.getAbsBaseCoord2D(a);if(s){var l=e.CoordUtils.transform2DByMatrix(s,i);this.setTransformedCoord2D(t,r,l),o=l}if(r.getNodes)for(var d=0,u=r.getNodeCount();d<u;++d)this.transformObjCoord2DToContext(t,r.getNodeAt(d),n,n,a)}return o},getTransformedCoord2D:function(t,r,i){e.ObjUtils.isUnset(i)&&(i=this.getRenderCache(t).options.transformParams.allowCoordBorrow);var n=r instanceof e.BaseStructureNode,a=r.getParent(),o=n&&a&&a instanceof e.BaseStructureConnector,s=n&&!o&&this.getExtraProp2(t,r,this.TRANSFORM_COORD_FIELD);if(!s){var l=this.getChemObj(),d=this.getExtraProp2(t,l,this.TRANSFORM_MATRIX_FIELD),u=this.getExtraProp2(t,l,this.CHILD_TRANSFORM_MATRIX_FIELD);s=l&&(l.hasNode(r,!1)||l.hasConnector(r,!1))?this.transformObjCoord2DToContext(t,r,d,u,i):this.transformObjCoord2DToContext(t,r,u,u,i)}return s},setTransformedCoord2D:function(e,t,r){this.setExtraProp2(e,t,this.TRANSFORM_COORD_FIELD,r)},doTransformCoordToObj:function($super,t,r,i){var n=this.getExtraProp2(t,r,this.INV_TRANSFORM_MATRIX_FIELD);return n?e.CoordUtils.transform2DByMatrix(i,n):$super(t,r,i)},doTransformCoordToContext:function($super,t,r,i){var n=this.getExtraProp2(t,r,this.TRANSFORM_MATRIX_FIELD);return n?e.CoordUtils.transform2DByMatrix(i,n):$super(t,r,i)},doDrawNodes:function(e,t,r,i,n){for(var a=r.getExposedNodes(),o=0,s=a.length;o<s;++o){var l=a[o],d=this.handleNodeSpecifiedRenderOptions(l,i);this.doDrawNode(e,t,l,r,d,n)}},doDrawNode:function(e,t,r,i,n,a){},doDrawConnectors:function(e,t,r,i,n){for(var a=r.getExposedConnectors(),o=0,s=a.length;o<s;++o){var l=a[o],d=this.handleConnectorSpecifiedRenderOptions(l,i);this.doDrawConnector(e,t,l,r,d,n)}},doDrawConnector:function(t,r,i,n,a,o){var s,l=i.getConnectedExposedObjs(),d=l.length;if(d<2)return null;for(var u,c,h,m,g=d>2?this.createDrawGroup(t):null,f=d>2?[]:null,p=a,C=0;C<d;++C)if(u=l[C],this.getTransformedCoord2D(t,u,o.allowCoordBorrow))for(var b=C+1;b<d;++b)if(c=l[b],this.getTransformedCoord2D(t,c,o.allowCoordBorrow)&&(m=this.doDrawConnectorShape(t,i,[u,c],p,o))){h=m.element,h&&g&&this.addToDrawGroup(h,g);var E=m.boundInfo;f&&E&&f.push(E)}return s=g||h,s&&r&&this.addToDrawGroup(s,r),s?this.setObjDrawElem(t,i,s):this.setObjDrawElem(t,i,null),this.addRenderedObj(t,i),(E||f)&&this.basicDrawObjectUpdated(t,i,n,f||E,e.Render.ObjectUpdateType.ADD),s},doDrawConnectorShape:function(e,t,r,i,n){}}),e.ClassDefineUtils.addExtraTwoTupleObjMapSupport(e.Render.Ctab2DRenderer),e.Render.ChemCtab2DRenderer=i.create(e.Render.Ctab2DRenderer,{CLASS_NAME:"Kekule.Render.ChemCtab2DRenderer",OBJ_NEED_LABEL_FIELD:"__$needDrawLabel__",OBJ_NEED_DOT_FIELD:"__$needDrawDot__",getObjNeedDrawLabel:function(t,r){var i=this.getExtraProp2(t,r,this.OBJ_NEED_LABEL_FIELD);if(e.ObjUtils.isUnset(i)){var n=this.getRenderCache(t).appliedOptions;i=!(r instanceof e.ChemStructureConnector)&&this._needNodeDrawLabel(r,n),this.setObjNeedDrawLabel(t,r,i)}return i},setObjNeedDrawLabel:function(e,t,r){this.setExtraProp2(e,t,this.OBJ_NEED_LABEL_FIELD,r)},getObjNeedDrawDot:function(t,r){var i=this.getRenderCache(t).appliedOptions;return!(r instanceof e.ChemStructureConnector)&&this._needNodeDrawDot(t,r,i)},doPrepare:function($super,t,r,i,n){n.fontSize||(n.fontSize=n.atomFontSize),n.textBoxXAlignment=e.Render.BoxXAlignment.CENTER,n.textBoxYAlignment=e.Render.BoxYAlignment.CENTER,$super(t,r,i,n)},doPrepareLayout:function($super,e,t,r,i){$super(e,t,r,i);for(var n=t.getExposedNodes(),a=0,o=n.length;a<o;++a){var s=n[a],l=this._needNodeDrawLabel(s,i);this.setObjNeedDrawLabel(e,s,l)}},handleNodeSpecifiedRenderOptions:function($super,e,t){var r=$super(e,t);return!r.color&&r.atomColor&&(r.color=r.atomColor),!r.fontFamily&&r.atomFontFamily&&(r.fontFamily=r.atomFontFamily),!r.fontSize&&r.atomFontSize&&(r.fontSize=r.atomFontSize),r},handleConnectorSpecifiedRenderOptions:function($super,e,t){var r=$super(e,t);return!r.color&&r.bondColor&&(r.color=r.bondColor),r},doDrawNode:function(t,r,i,n,a,o){var s,l,d=this.getTransformedCoord2D(t,i,o.allowCoordBorrow),u=a,c=i.getAtomicNumber?i.getAtomicNumber():0,h=i.getOverriddenRenderOptions()||{},m=h.color||h.atomColor;if(m)u.color=m;else if(u.useAtomSpecifiedColor){var g;if(c<=0){var f=i.getClassLocalName();g=e.Render.RenderColorUtils.getColor(f,this.getRendererType())}else g=e.Render.RenderColorUtils.getColor(c,this.getRendererType());u.color=g}c&&c>=113&&"D"!=i.getSymbol()&&i.getAttachedMarkers()&&(i.getAttachedMarkers().length=0),c&&c>=113&&"D"!=i.getSymbol()&&0!=i.getCharge()&&i.setCharge(0);var p=(i.getCharge()||i.getRadical(),i.getCharge()&&!i.fetchChargeMarker(!1)),C=i.getRadical()&&!i.fetchRadicalMarker(!1),b=!1;if(this.getObjNeedDrawLabel(t,i)){b=!0;var E=this._getNodeHydrogenDisplayLevel(i,u);E===e.Render.HydrogenDisplayLevel.LABELED&&(E=e.Render.HydrogenDisplayLevel.ALL);var N=!(!p&&!C),T=i.getDisplayRichText(E,N,u.displayLabelConfigs,u.partialChargeDecimalsLength,u.chargeMarkType,u.distinguishSingletAndTripletRadical),O=u.charDirection?u.charDirection:this._decideNodeLabelCharDirection(t,i);u.fontSize*=u.unitLength;var _=Object.create(u);_.charDirection=O,_.verticalAlign=e.Render.TextAlign.CENTER;var S=this.drawRichText(t,d,T,_),v=S.drawnObj;S.boundRect;l=this.createCircleBoundInfo(d,10),s=v}else{var y,A;if(this.getObjNeedDrawDot(t,i)&&e.ObjUtils.isUnset(u.atomRadius)&&(u.atomRadius=u.allenCenterAtomRadius),u.atomRadius){var M=u.atomRadius*u.unitLength;u.strokeColor=u.color,u.fillColor=u.color,y=this.drawCircle(t,d,M,u)}if(l=this.createCircleBoundInfo(d,10),p||C){var S=this.doDrawElectronStateMark(t,r,i,u.chargeMarkType,u.partialChargeDecimalsLength,u.distinguishSingletAndTripletRadical,u.fontFamily,u.chargeMarkFontSize*u.unitLength,u.chargeMarkMargin*u.unitLength,u.chargeMarkCircleWidth*u.unitLength,u.color,u.opacity,u.zoom||1);S&&(A=S.drawnObj)}y&&A?(s=this.createDrawGroup(t),this.addToDrawGroup(s,y),this.addToDrawGroup(s,A)):s=y||A}if(i.getUnplacedMarkers(this.getCoordMode()).length>=0){var I=u.chemMarkerMargin;if(b){I+=this._getNodeFontSize(t,i)*(o.zoom||1)*u.unitLength*1/2-I/2;var R=e.Render.TextDirection,L=(R.LTR,R.RTL,R.TTB,R.BTT,O===R.LTR?{x:1,y:0}:O===R.RTL?{x:-1,y:0}:O===R.TTB?{x:0,y:1}:O===R.BTT?{x:0,y:-1}:{x:0,y:0}),x={x:L.x*o.scaleX,y:L.y*o.scaleY};x.x>0?0:x.x<0?Math.PI:x.y>0?Math.PI/2:x.y<0?3*Math.PI/2:null}var D=I/u.defBondLength*u.medianObjRefLength;this.doAdjustChemPropMarkerPos(i,D,o.allowCoordBorrow,[])}return s?(this.setObjDrawElem(t,i,s),r&&this.addToDrawGroup(s,r)):this.setObjDrawElem(t,i,null),this.addRenderedObj(t,i),this.basicDrawObjectUpdated(t,i,n,l,e.Render.ObjectUpdateType.ADD),s},_getNodeFontSize:function(t,r,i){i||(i=this.getRenderCache(t).appliedOptions||this.getRenderCache(t).options);var n=e.Render.RenderOptionUtils.getNodeLabelDrawOptions(r.getOverriddenRenderOptions())||{};return l(n.fontSize,i.fontSize,i.atomFontSize)},_getNodeHydrogenDisplayLevel:function(t,r){var i=this.getDrawBridge(),n=i.hydrogenDisplayType,a=e.Render.HydrogenDisplayLevel,o=a.IMPLICIT,s=a.EXPLICIT,l=a.NONE,d=e.Render.MoleculeDisplayType.SKELETAL;if("C"===t.getIsotopeId()&&r.moleculeDisplayType===d)return s;switch(n){case"BONDED":return l;case"IMPLICIT":return o;case"EXPLICIT":default:return s}},_needNodeDrawDot:function(t,r,i){r.getOverriddenRenderOptions();if(r instanceof e.Atom){if(r.getAtomicNumber()!==e.Render.DEF_ATOM_ATOMIC_NUM)return!1;if(this.getObjNeedDrawLabel(t,r))return!1;if(2===r.getLinkedBonds().length){var n=r.getLinkedMultipleBonds();if(2===n.length&&n[0].getBondOrder()===n[1].getBondOrder()){var a=n[0].getBondOrder();return a>=o.DOUBLE&&a<o.EXPLICIT_AROMATIC}}return!1}return!1},_needNodeDrawLabel:function(t,r){var i=e.Render.RenderOptionUtils,n=e.Render.NodeLabelDisplayMode,a=t.getOverriddenRenderOptions(),o=i.getNodeDisplayMode(a)||r.nodeDisplayMode;if(!(t instanceof e.ChemStructureNode))return!1;if(o===n.HIDDEN)return!1;if(o===n.SHOWN)return!0;if(r.moleculeDisplayType===e.Render.MoleculeDisplayType.CONDENSED)return!0;if(t.getLinkedConnectors().length<=0)return!0;if(t instanceof e.Atom&&t.getAtomicNumber()===e.Render.DEF_ATOM_ATOMIC_NUM&&!t.getMassNumber()){if(t.getRenderOption("customLabel"))return!0;var s=this._getNodeHydrogenDisplayLevel(t,r),l=e.Render.HydrogenDisplayLevel;if(s===l.ALL)return!0;if(s===l.UNMATCHED_EXPLICIT){var d=t.getExplicitHydrogenCount();return e.ObjUtils.notUnset(d)&&t.getImplicitHydrogenCount()!==d}return e.ObjUtils.notUnset(t.getExplicitHydrogenCount())}return!0},_isNodeHasConnectorToDirection:function(t,i,n){e.ObjUtils.isUnset(n)&&(n=.2);for(var a=0,o=t.length;a<o;++a){var s=t[a];if(i===r.LTR&&s.x>n)return!0;if(i===r.RTL&&s.x<-n)return!0;if(i===r.TTB&&s.y>n)return!0;if(i===r.BTT&&s.y<-n)return!0}return!1},_calcConnectorVectorWeight:function(e){for(var t=0,r=0,i=function(e,t){return 0==t?100:Math.min(100,Math.pow(e/t,2))},n=0,a=e.length;n<a;++n)t+=e[n].x*i(e[n].x,e[n].y)*1,r+=e[n].y*i(e[n].y,e[n].x)*1;return{x:t,y:r}},_calcConnectorVectorOfNode:function(e,t){for(var r={x:0,y:0},i=this._getStandardizedLinkedObjRelCoords(e,t,null),n=0,a=i.length;n<a;++n)r.x+=i[n].x,r.y+=i[n].y;return r.x===r.y===0&&(r={x:1,y:0}),r},_calcVectorAxisDirection:function(e){return Math.abs(e.x)>=Math.abs(e.y)?e.x>0?r.LTR:r.RTL:e.y>0?r.TTB:r.BTT},_decideNodeLabelCharDirection:function(t,r){for(var i=this._getStandardizedLinkedObjRelCoords(t,r,null),n=e.Render.TextDirection,a=[n.LTR,n.RTL,n.TTB,n.BTT],o=0,s=a.length;o<s;++o)if(!this._isNodeHasConnectorToDirection(i,a[o]))return a[o];var l=this._calcConnectorVectorWeight(i);return Math.abs(l.x)>Math.abs(l.y)?l.x<=0?n.LTR:n.RTL:l.y<=0?n.TTB:n.BTT},_calcConnectorAnglesOfNode:function(e,t){for(var r=[],i=this._getStandardizedLinkedObjRelCoords(e,t,null),n=0,a=i.length;n<a;++n){var o=i[n],s=Math.atan2(o.y,o.x);s<0&&(s=2*Math.PI+s),r.push(s)}return r.sort(),r},_getMostEmptyDirectionAngleOfNode:function(e,t){var r,i=this._calcConnectorAnglesOfNode(e,t),n=i.length;if(0===n)r=0;else if(1===n)r=-i[0];else{for(var a=0,o=0,s=0;s<n;++s){var l=i[s],d=i[(s+1)%n],u=d-l;u<0&&(u+=2*Math.PI),u>a&&(a=u,o=s)}r=i[o]+a/2}return r},doAutoAdjustAttachedMarkerPos:function(e,t,r,i,n){t&&!t.getCoordOfMode(this.getCoordMode())&&e.autoSetMarker2DPos(t,r,i,n)},doAdjustChemPropMarkerPos:function(t,r,i,n){t.beginUpdate();try{var a=t.getMarkerOfType(e.ChemMarker.Charge);this.doAutoAdjustAttachedMarkerPos(t,a,r,i,n);var o=t.getMarkerOfType(e.ChemMarker.Radical);this.doAutoAdjustAttachedMarkerPos(t,o,r,i,n);for(var s=t.getUnplacedMarkers(this.getCoordMode()),l=0,d=s.length;l<d;++l)this.doAutoAdjustAttachedMarkerPos(t,s[l],r,i,n)}finally{t.endUpdate()}},doDrawElectronStateMark:function(t,r,i,n,a,o,s,l,d,u,c,h,m){var g=i.getCharge(),f=i.getRadical(),p="";if(!a||Math.abs(g)>Math.pow(10,-a)/2){var C=(e.Render.ChargeMarkRenderType.CIRCLE_AROUND,n===e.Render.ChargeMarkRenderType.CIRCLE_AROUND);if(1===g)p=C?"⊕":"+";else if(-1===g)p=C?"⊖":"−";else{var b=a?e.NumUtils.toDecimals(Math.abs(g),a):Math.abs(g).toString();p=b+(g>0?"+":"−")}}if(f&&(p+=e.Render.ChemDisplayTextUtils.getRadicalDisplayText(f,o)),!p)return null;var E=this.getTransformedCoord2D(t,i),N=this._getMostEmptyDirectionAngleOfNode(t,i),T={x:Math.cos(N),y:Math.sin(N)},O=d/1,_={x:T.x*O,y:T.y*O};_=e.CoordUtils.add(E,_);var S,v,y=e.Render.BoxXAlignment,A=e.Render.BoxYAlignment;return S=y.CENTER,v=A.CENTER,this.drawText(t,_,p,{fontFamily:s,fontSize:l,color:c,opacity:h,textBoxXAlignment:S,textBoxYAlignment:v,zoom:m||1})},doDrawConnectorShape:function(t,r,i,n,a){var o=e.CoordUtils;n.globalCompositeOperation="destination-over";var s,l=i[0],d=i[1],u=this.getTransformedCoord2D(t,l,a.allowCoordBorrow),c=this.getTransformedCoord2D(t,d,a.allowCoordBorrow),h={x:u.x,y:u.y},m={x:c.x,y:c.y},i=[l,d],g=[h,m],f=o.getDistance(h,m),p=0,C=n.unitLength||1,b=Math.sqrt(Math.sqr(m.x-h.x)+Math.sqr(m.y-h.y)),E=[],N=n.bondLengthScaleRatio;if(e.ObjUtils.notUnset(N)){var T=o.substract(m,h);!0,s=N>0?0:1;var O=1-Math.abs(N||1),_=1===s?-1:1;E[s]=o.multiply(T,_*O)}if(this.getObjNeedDrawLabel(t,l)||this.getObjNeedDrawLabel(t,d)){var S,v,y,A=n.atomLabelBoxExpandRatio,M=m.x-h.x,I=m.y-h.y,R=M>=0?1:-1,L=I>=0?1:-1,x=0===M;if(!x)var D=Math.abs(I/M);y=Math.abs(M)>=Math.abs(I);for(var P=0,B=i.length;P<B;++P){var w=i[P],k=g[P],U=null;if(this.getObjNeedDrawLabel(t,w)){if(S=v=this._getNodeFontSize(t,w)*(a.zoom||1)*C*A/2,U=y?{x:S*R,y:S*D*L}:x?{x:0,y:v*L}:{x:v/D*R,y:v*L}){var j=E[P];j&&Math.abs(N)<=1?(Math.abs(U.x)>Math.abs(j.x)||Math.abs(U.y)>Math.abs(j.y))&&(E[P]=U):E[P]=U}}R*=-1,L*=-1}}for(var P=0,B=g.length;P<B;++P){var k=g[P],U=E[P];if(U){p+=o.getDistance(U,{x:0,y:0});var F=o.add(k,U);k.x=F.x,k.y=F.y}}if(p>=f)return null;var W=(n.bondLineWidth||n.strokeWidth||1)*(n.unitLength||1);n.strokeWidth=W;var V=n.renderType,H=e.Render.ConnectorDrawUtils.getPossibleConnectorRenderTypes(r);(e.ObjUtils.isUnset(V)||H.indexOf(V)<0)&&(V=H[0]);var G;return this.isLineBasedConnector(V)?G=this.doDrawLineBasedConnector(t,V,l,d,h,m,b,n):this.isTriangleBasedConnector(V)?G=this.doDrawTriangleBasedConnector(t,V,l,d,h,m,b,n):this.isTriangleHashBasedConnector(V)?G=this.doDrawTriangleHashBasedConnector(t,V,l,d,h,m,b,n):this.isRectangleBasedConnector(V)?G=this.doDrawRectangleBasedConnector(t,V,l,d,h,m,b,n):this.isWavyBasedConnector(V)&&(G=this.doDrawWavyBasedConnector(t,V,l,d,h,m,b,n)),G},_lineBasedConnectorTypes:[t.SINGLE,t.DOUBLE,t.TRIPLE,t.QUAD,t.SCISSORS_DOUBLE,t.BOLD,t.BOLD_DOUBLE,t.BOLD_TRIPLE,t.DASHED,t.DASHED_DOUBLE,t.DASHED_TRIPLE,t.SOLID_DASH,t.BOLD_DASH,t.ARROWED],_triangleBasedConnectorTypes:[t.WEDGED_SOLID,t.WEDGED_SOLID_INV,t.WEDGED_HOLLOW,t.WEDGED_HOLLOW_INV],_triangleHashBasedConnectorTypes:[t.WEDGED_HASHED,t.WEDGED_HASHED_INV,t.HASHED],_rectangleBasedConnectorTypes:[t.WEDGED_SOLID_BOTH,t.WEDGED_HOLLOW_BOTH],isLineBasedConnector:function(e){return this._lineBasedConnectorTypes.indexOf(e)>=0},isTriangleBasedConnector:function(e){return this._triangleBasedConnectorTypes.indexOf(e)>=0},isTriangleHashBasedConnector:function(e){return this._triangleHashBasedConnectorTypes.indexOf(e)>=0},isRectangleBasedConnector:function(e){return this._rectangleBasedConnectorTypes.indexOf(e)>=0},isWavyBasedConnector:function(e){return t.WAVY},doDrawLineBasedConnector:function(e,r,i,n,a,o,s,l){var d=[],u={isBold:!1,isDash:!1},c={isBold:!0,isDash:!1},h={isBold:!1,isDash:!0};switch(r){case t.DOUBLE:case t.SCISSORS_DOUBLE:for(var m=0;m<2;++m,d.push(u));break;case t.TRIPLE:for(var m=0;m<3;++m,d.push(u));break;case t.QUAD:for(var m=0;m<4;++m,d.push(u));break;case t.BOLD:d.push(c);break;case t.BOLD_DOUBLE:d.push(c),d.push(u);break;case t.BOLD_TRIPLE:d.push(c);for(var m=0;m<2;++m,d.push(u));break;case t.BOLD_QUAD:d.push(c);for(var m=0;m<3;++m,d.push(u));break;case t.DASHED:d.push(h);break;case t.DASHED_DOUBLE:for(var m=0;m<2;++m,d.push(h));break;case t.DASHED_TRIPLE:for(var m=0;m<3;++m,d.push(h));break;case t.SOLID_DASH:d.push(u),d.push(h);break;case t.BOLD_DASH:d.push(c),d.push(h);break;case t.ARROWED:u.isArrow=!0,d.push(u);break;case t.SINGLE:default:d.push(u)}var g=r===t.SCISSORS_DOUBLE;return this.doDrawSymmetryLineConnector(e,i,n,a,o,s,d,g,l)},doDrawSymmetryLineConnector:function(t,r,i,n,a,o,s,l,d){var u=s.length,c=null,h=null;if(1===u){var m=d.strokeWidth;s[0].isBold&&(m*=d.boldBondLineWidthRatio);var g=null;s[0].isArrow&&(g={width:d.bondArrowWidth*d.unitLength,length:d.bondArrowLength*d.unitLength});var f={strokeWidth:m,strokeColor:e.Render.RenderOptionUtils.getColor(d),strokeDash:s[0].isDash,opacity:d.opacity},h=this.drawArrowLine(t,n,a,g,f),p=this.createLineBoundInfo(n,a,m)}else if(u>1){c=this.createDrawGroup(t);var C=d.multipleBondSpacingAbs?d.multipleBondSpacingAbs:d.multipleBondSpacingRatio*o;d.multipleBondMaxAbsSpacing&&(C=Math.min(C,d.multipleBondMaxAbsSpacing)),C*=d.unitLength;var b=a.x-n.x,E=a.y-n.y,N=Math.sqrt(Math.sqr(b)+Math.sqr(E)),T=E/N,O=b/N,_=[],S=1;1&u||(S=0);for(var v=0;v<u;++v)if(e.ObjUtils.notUnset(s[v].offsetAdjust))_.push(s[v].offsetAdjust);else if(0===v&&0!==S)_.push(0);else{var y=1&v?1:-1;if(0!==S)var A=S*y*(v+1>>1);else var A=(1*(v>>1)+.5)*y;_.push(A)}var M=C;M>L&&(L=M),M<x&&(x=M);for(var I={x:0,y:0},R={x:0,y:0},L=0,x=0,D=[],v=0;v<u;++v){var P=Object.create(d),B=M*T,w=M*O,k={x:n.x-B*_[v],y:n.y+w*_[v]},U={x:a.x-B*_[v],y:a.y+w*_[v]};I=e.CoordUtils.add(I,k),R=e.CoordUtils.add(R,U);var g=null;s[v].isArrow&&(g={width:d.bondArrowWidth*d.unitLength,length:d.bondArrowLength*d.unitLength});var m=d.strokeWidth;s[v].isBold&&(m*=d.boldBondLineWidthRatio),P.strokeColor=d.color,P.strokeDash=s[v].isDash,D.push({coord1:k,coord2:U,arrowParams:g,drawOptions:P}),M=s[v].isBold?C+Math.floor(m/2):C}if(l)for(var v=0;v<u;++v){var j=D[v],F=D[u-v-1],h=this.drawArrowLine(t,j.coord1,F.coord2,j.arrowParams,j.drawOptions);this.addToDrawGroup(h,c)}else for(var v=0;v<u;++v){var W=D[v],h=this.drawArrowLine(t,W.coord1,W.coord2,W.arrowParams,W.drawOptions);this.addToDrawGroup(h,c)}I=e.CoordUtils.divide(I,u),R=e.CoordUtils.divide(R,u);var p=this.createLineBoundInfo(I,R,L-x)}return{element:c||h,boundInfo:p}},_getStandardizedLinkedObjRelCoords:function(t,r,i){for(var n=[],a=this.getTransformedCoord2D(t,r),o=r.getLinkedExposedObjs(),s=0,l=o.length;s<l;++s){var d=o[s];if(d!==i){var u=this.getTransformedCoord2D(t,d),c=e.CoordUtils.substract(u,a);c=e.CoordUtils.standardize(c),n.push(c)}}return n},_decideEvenBondAlign:function(t,r,i){var n=e.CoordUtils.substract(this.getTransformedCoord2D(t,i),this.getTransformedCoord2D(t,r));n=e.CoordUtils.standardize(n);for(var a=this._getStandardizedLinkedObjRelCoords(t,r,i),o=this._getStandardizedLinkedObjRelCoords(t,i,r),s=0,l={x:0,y:0},d=0,u=a.length;d<u;++d)s+=this._calcSinglePointAlign(a[d],n),l.x+=a[d].x,l.y+=a[d].y;for(var d=0,u=o.length;d<u;++d)s+=this._calcSinglePointAlign(o[d],n),l.x+=o[d].x,l.y+=o[d].y;return 0!==s?Math.sign(s):this._calcSinglePointAlign(l,n)},_calcSinglePointAlign:function(e,t){var r;if(Math.abs(t.x)<1e-4)return r=Math.abs(e.x)<1e-4?0:-Math.sign(e.x)*Math.sign(t.y);var i=t.y*e.x/t.x,n=e.y-i;return r=n>1e-4?1:n<-1e-4?-1:0,r*=Math.sign(t.x)},doDrawTriangleBasedConnector:function(e,r,i,n,a,o,s,l){var d=r===t.WEDGED_SOLID||r===t.WEDGED_SOLID_INV,u=r===t.WEDGED_SOLID_INV||r===t.WEDGED_HOLLOW_INV,c=u?[o,a]:[a,o],h=l.bondWedgeWidth*l.unitLength,m=this._calcTriangleBaselineCoords(c[0],c[1],h),g=Object.create(l);g.strokeColor=l.color,g.fillColor=d?l.color:null;var f=this.drawTriangle(e,c[0],m[0],m[1],g),p={element:f};return p.boundInfo=this.createLineBoundInfo(c[0],c[1],h),p},doDrawTriangleHashBasedConnector:function(r,i,n,a,o,s,l,d){var u=i===t.WEDGED_HASHED_INV,c=i!==t.HASHED,h=u?[s,o]:[o,s],m=d.hashSpacing*d.unitLength,g=d.bondWedgeWidth*d.unitLength,f=c?d.bondWedgeHashMinWidth*d.unitLength:g,p=g-f,C=e.CoordUtils.substract(h[1],h[0]),b=Math.sqrt(Math.sqr(C.x)+Math.sqr(C.y)),E=Math.floor(b/m),N=this.createDrawGroup(r),T=Object.create(d);T.strokeColor=d.color;for(var O=0;O<E;++O){var _=m*O,S=_/b,v={x:C.x*S,y:C.y*S};v=e.CoordUtils.add(v,h[0]);var y=this._calcTriangleBaselineCoords(h[0],v,p*S+f),A=this.drawLine(r,y[0],y[1],T);this.addToDrawGroup(A,N)}var M={element:N};return M.boundInfo=this.createLineBoundInfo(h[0],h[1],g),M},_calcTriangleBaselineCoords:function(t,r,i){var n=e.CoordUtils.substract(r,t),a=Math.sqrt(Math.sqr(n.x)+Math.sqr(n.y)),o=n.y/a,s=n.x/a,l=i/2,d=[];return d.push({x:r.x+l*o,y:r.y-l*s}),d.push({x:r.x-l*o,y:r.y+l*s}),d},doDrawRectangleBasedConnector:function(r,i,n,a,o,s,l,d){var u=i===t.WEDGED_SOLID_BOTH,c=d.bondWedgeWidth*d.unitLength,h=this._calcRectangleCornerCoords(o,s,c),m=Object.create(d);m.strokeColor=d.color,m.fillColor=u?d.color:null;var g=e.Render.DrawPathUtils.makePath("M",[h[0].x,h[0].y],"L",[h[1].x,h[1].y],"L",[h[2].x,h[2].y],"L",[h[3].x,h[3].y],"Z"),f=this.drawPath(r,g,m),p={element:f};return p.boundInfo=this.createLineBoundInfo(o,s,c),p},_calcRectangleCornerCoords:function(t,r,i){var n=e.CoordUtils.substract(r,t),a=Math.sqrt(Math.sqr(n.x)+Math.sqr(n.y)),o=n.y/a,s=n.x/a,l=i/2,d=[],u={x:l*o,y:l*s};return d.push({x:t.x+u.x,y:t.y-u.y}),d.push({x:t.x-u.x,y:t.y+u.y}),d.push({x:r.x-u.x,y:r.y+u.y}),d.push({x:r.x+u.x,y:r.y-u.y}),d},doDrawWavyBasedConnector:function(t,r,i,n,a,o,s,l){for(var d,u=e.CoordUtils,c=l.bondWavyRadius*l.unitLength,h=u.getDistance(a,o),m=Math.round(h/c),g=u.divide(u.substract(o,a),m),f=h/m,p=[],C=a,b=Math.atan2(g.y,g.x)+Math.PI,E={x:f/1.5*Math.sin(b),y:-f/1.5*Math.cos(b)},N=1,T=0;T<m;++T){N=-N,d=C,C=u.add(d,g);var O=u.multiply(E,N),_=u.add(d,O),S=u.add(C,O);0===T&&(p.push("M"),p.push([d.x,d.y])),p.push("C"),p.push([_.x,_.y,S.x,S.y,C.x,C.y])}var v=e.Render.DrawPathUtils.makePath.apply(e.Render.DrawPathUtils,p),y=Object.create(l);y.strokeColor=l.color,y.fillColor=null;var A=this.drawPath(t,v,y),M={element:A};return M.boundInfo=this.createLineBoundInfo(a,o,f),M}}),e.Render.StructFragment2DRenderer=i.create(e.Render.ChemObj2DRenderer,{CLASS_NAME:"Kekule.Render.StructFragment2DRenderer",initialize:function($super,e,t,r){$super(e,t,r),this._concreteRenderer=null,this._concreteChemObj=null,this.initConcreteRenderer()},finalize:function($super){$super(),this._concreteRenderer&&(this._concreteRenderer.finalize(),this._concreteRenderer=null)},_getRenderSortIndex:function($super){return this._concreteRenderer?this._concreteRenderer._getRenderSortIndex():$super()},initConcreteRenderer:function(){var t=this.getChemObj(),r=this.getDrawBridge();return this._isRendererMismatch(this._concreteRenderer,t)&&this._concreteRenderer&&(this._concreteRenderer.finalize(),this._concreteRenderer=null,this._concreteChemObj=null),!this._concreteRenderer&&t&&(t.hasCtab()?(this._concreteChemObj=t.getCtab(),this._concreteRenderer=new e.Render.ChemCtab2DRenderer(t.getCtab(),r,this)):t.hasFormula()&&(this._concreteChemObj=t.getFormula(),this._concreteRenderer=new e.Render.Formula2DRenderer(t.getFormula(),r,this))),this._concreteRenderer},_isRendererMismatch:function(t,r){return t&&!r||t instanceof e.Render.ChemCtab2DRenderer&&!r.hasCtab()||t instanceof e.Render.Formula2DRenderer&&!r.hasFormula()},getConcreteRenderer:function(){return this.initConcreteRenderer(),this._concreteRenderer},_getConcreteRendererDrawOptions:function(e){return e},isChemObjRenderedBySelf:function($super,e,t){var r=this.getConcreteRenderer();return $super(e,t)||t===this.getChemObj()||r&&r.isChemObjRenderedBySelf(e,t)},isChemObjRenderedDirectlyBySelf:function($super,e,t){this.getConcreteRenderer();return $super(e,t)||t===this.getChemObj()||t===this._concreteChemObj},doSetRedirectContext:function($super,e){$super(e);var t=this.getConcreteRenderer();t&&t.setRedirectContext(e)},getChildObjs:function($super){var e=this.getChemObj();if(e){for(var t=[],r=(e.getExposedNodes()||[]).concat(e.getExposedConnectors()||[]),i=0,n=r.length;i<n;++i){var a=r[i];a.getAttachedMarkers&&(t=t.concat(a.getAttachedMarkers()||[]))}return t.concat($super())}return $super()},_needWholelyDraw:function($super,e,t){var r=$super(e,t);if(!r){for(var i=this.getChemObj(),n=!1,a=0,o=e.length;a<o;++a){if(e[a].isChildOf(i)){n=!0;break}}r=n}return r},_createChargeAndRadicalMarkerOnStructFragment:function(e){e.beginUpdate();try{e.getCharge&&e.getCharge()&&e.fetchChargeMarker(!0);for(var t=(e.getNodes(),0),r=e.getNodeCount();t<r;++t){var i=e.getNodeAt(t);i.beginUpdate();try{i.getCharge()&&i.fetchChargeMarker(!0),i.getRadical()&&i.fetchRadicalMarker(!0),i.getNodeAt&&this._createChargeAndRadicalMarkerOnStructFragment(i)}finally{i.endUpdate()}}}finally{e.endUpdate()}},doDraw:function($super,e,t,r){var i=!!r.autoCreateChargeAndRadicalMarker;if(this.getCanModifyTargetObj()&&i){var n=this.getChemObj();this._createChargeAndRadicalMarkerOnStructFragment(n)}$super(e,t,r)},doDrawSelf:function($super,t,r,i){t.textBaseline="hanging",$super(t,r,i);var n=this.getChemObj(),a=r,o=this.getConcreteRenderer();if(!a&&o instanceof e.Render.Formula2DRenderer&&n.getAbsBaseCoord2D){var s=n.getAbsBaseCoord2D(i.allowCoordBorrow);a=e.CoordUtils.transform2D(s,i.transformParams)}return n.hasFormula()||n.hasCtab()?o?o.draw(t,a,this._getConcreteRendererDrawOptions(i)):void 0:null},doRedraw:function($super,e){return $super(e)},doUpdateSelf:function(e,t,r){if(this._extractObjsOfUpdateObjDetails(t).indexOf(this.getChemObj())>=0){var i=this.getRenderCache(e);return this.doClear(e),this.draw(e,i.baseCoord,i.options)}var n=this.getConcreteRenderer();if(n)return n.doUpdate(e,t,r)},doClearSelf:function(e){var t=this.getConcreteRenderer();if(t)return t.clear(e)},estimateRenderBox:function(e,t,r,i){var n=this.getConcreteRenderer();return n?n.estimateRenderBox(e,t,this._getConcreteRendererDrawOptions(r),i):null},transformCoordToObj:function($super,e,t,r){return $super(e,t,r)},transformCoordToContext:function($super,e,t,r){return $super(e,t,r)}}),e.Render.Mol2DRenderer=e.Render.StructFragment2DRenderer,e.Render.CompositeObj2DRenderer=i.create(e.Render.ChemObj2DRenderer,{CLASS_NAME:"Kekule.Render.CompositeObj2DRenderer"}),e.Render.CompositeMolecule2DRenderer=i.create(e.Render.CompositeObj2DRenderer,{CLASS_NAME:"Kekule.Render.CompositeMolecule2DRenderer",getChildObjs:function($super){for(var e=[],t=this.getChemObj().getSubMolecules(),r=0,i=t.getItemCount();r<i;++r){var n=t.getObjAt(r);e.push(n)}return e.concat($super())}}),e.Render.ChemObjGroupList2DRenderer=i.create(e.Render.CompositeObj2DRenderer,{CLASS_NAME:"Kekule.Render.CompositeMolecule2DRenderer",getChildObjs:function($super){var t=this.getChemObj();if(t instanceof e.ChemObjList)for(var r=[],i=0,n=t.getItemCount();i<n;++i)r.push(t.getItemAt(i));else t instanceof e.ChemStructureObjectGroup&&(r=t.getAllObjs());return(r||[]).concat($super())}}),e.Render.Reaction2DRenderer=i.create(e.Render.CompositeObj2DRenderer,{CLASS_NAME:"Kekule.Render.Reaction2DRenderer",getChildObjs:function($super){for(var e=[],t=this.getChemObj(),e=[],r=0,i=t.getReactantCount();r<i;++r){var n=t.getReactantAt(r);e.push(n)}for(var r=0,i=t.getProductCount();r<i;++r){var n=t.getProductAt(r);e.push(n)}return(e||[]).concat($super())}}),e.Render.ChemSpaceElement2DRenderer=i.create(e.Render.CompositeObj2DRenderer,{CLASS_NAME:"Kekule.Render.ChemSpaceElement2DRenderer",getChildObjs:function($super){var e=$super()||[];return e=(this.getChemObj().getChildren().toArray()||[]).concat(e)}}),e.Render.ChemSpace2DRenderer=i.create(e.Render.CompositeObj2DRenderer,{CLASS_NAME:"Kekule.Render.ChemSpace2DRenderer",getChildObjs:function($super){return[this.getChemObj().getRoot()].concat($super()||[])},doEstimateSelfObjBox:function($super,e,t,r){var i=this.getChemObj().getSize2D();if(i&&i.x&&i.y&&t.useExplicitSpaceSize){return{x1:0,y1:0,x2:i.x,y2:i.y}}return $super(e,t,r)}}),e.Render.Renderer2DFactory.register(e.ChemMarker.Charge,e.Render.TextBasedChemMarker2DRenderer),e.Render.Renderer2DFactory.register(e.ChemMarker.Radical,e.Render.TextBasedChemMarker2DRenderer),e.Render.Renderer2DFactory.register(e.ChemMarker.UnbondedElectronSet,e.Render.UnbondedElectronSetRenderer),e.Render.Renderer2DFactory.register(e.TextBlock,e.Render.TextBlock2DRenderer),e.Render.Renderer2DFactory.register(e.ImageBlock,e.Render.ImageBlock2DRenderer),e.Render.Renderer2DFactory.register(e.StructureFragment,e.Render.StructFragment2DRenderer),e.Render.Renderer2DFactory.register(e.CompositeMolecule,e.Render.CompositeMolecule2DRenderer),e.Render.Renderer2DFactory.register(e.Reaction,e.Render.Reaction2DRenderer),e.Render.Renderer2DFactory.register(e.ChemObjList,e.Render.ChemObjGroupList2DRenderer),e.Render.Renderer2DFactory.register(e.ChemStructureObjectGroup,e.Render.ChemObjGroupList2DRenderer),e.Render.Renderer2DFactory.register(e.ChemSpaceElement,e.Render.ChemSpaceElement2DRenderer),e.Render.Renderer2DFactory.register(e.ChemSpace,e.Render.ChemSpace2DRenderer),e}},function(e,t,r){"use strict";var i=r(0).Class;e.exports=function(e){var t=(e.Render.DrawPathUtils,e.CoordUtils),r=(e.oneOf,e.Glyph.NodeType),n=e.Glyph.PathType;return e.Render.BaseGlyph2DRenderer=i.create(e.Render.ChemObj2DRenderer,{CLASS_NAME:"Kekule.Render.BaseGlyph2DRenderer",doDraw:function($super,e,t,r){var i=Object.create(r);return i.strokeColor=r.strokeColor||r.glyphStrokeColor,i.fillColor=r.fillColor||r.glyphFillColor,i.strokeWidth=r.strokeWidth||r.glyphStrokeWidth,$super(e,t,i)}}),e.Render.PathGlyphCtab2DRenderer=i.create(e.Render.Ctab2DRenderer,{CLASS_NAME:"Kekule.Render.PathGlyphCtab2DRenderer",initialize:function($super,t,r,i){$super(t,r,i),this._nodeCoordOverrideMap=new e.MapEx(!0)},doFinalize:function($super){this._nodeCoordOverrideMap.finalize(),$super()},extractGlyphDrawOptions:function(e){var t=e.unitLength||1;return{strokeColor:e.shouldRenderRed?"rgb(255,175,175)":e.strokeColor||e.color||e.glyphStrokeColor,fillColor:e.shouldRenderRed?"rgb(255,175,175)":e.fillColor||e.color||e.glyphFillColor,strokeWidth:(e.strokeWidth||e.glyphStrokeWidth)*t}},doDraw:function($super,e,t,r){var i=$super(e,t,r);return this._nodeCoordOverrideMap.clear(),i},doDrawNode:function(t,i,n,a,o,s){var l,d=n.getNodeType();if(!d||d===r.LOCATION||d===r.CONTROLLER){var u=this._nodeCoordOverrideMap.get(n),c=u||this.getTransformedCoord2D(t,n,s.allowCoordBorrow);l=this.createPointBoundInfo(c)}l&&(this.basicDrawObjectUpdated(t,n,a,l,e.Render.ObjectUpdateType.ADD),!n.anchorObj&&n.getParent()instanceof e.Glyph.Arc&&this.drawCircle(t,c,5*o.zoom,o))},doDrawConnector:function($super,t,r,i,n,a,o){var s=$super(t,r,i,n,a,o),l=i.getControlPoints&&i.getControlPoints();if(l)for(var d=0,u=l.length;d<u;++d){var c=this.getTransformedCoord2D(t,l[d],o.allowCoordBorrow),h=this.createPointBoundInfo(c);this.basicDrawObjectUpdated(t,l[d],i,h,e.Render.ObjectUpdateType.ADD)}return s},doDrawConnectorShape:function(r,i,a,o,s){var l=e.Glyph.ArrowSide,d=a[0],u=a[1],c=t.clone(this.getTransformedCoord2D(r,d,s.allowCoordBorrow)),h=t.clone(this.getTransformedCoord2D(r,u,s.allowCoordBorrow));o.shouldRenderRed=a.reduce(function(t,r){return t||!r.anchorObj&&r.getParent()instanceof e.Glyph.Arc},!1);var m,g,f=this.extractGlyphDrawOptions(o),p=i.getPathType(),C=i.getPathParams()||{},b=this.getChemObj(),E=(C.lineGap||0)*o.defScaleRefLength,N=E?C.lineCount||1:1,T=[];if(C.startArrowType&&C.startArrowWidth){var O=this._transformArrowLength(r,C.startArrowLength,C.startArrowWidth);m={arrowLength:O.arrowLength,arrowWidth:O.arrowWidth,arrowType:C.startArrowType,arrowSide:C.startArrowSide,drawOnCenter:!C.startArrowSide||C.startArrowSide===l.BOTH}}if(C.endArrowType&&C.endArrowWidth)var O=this._transformArrowLength(r,C.endArrowLength,C.endArrowWidth),g={arrowLength:O.arrowLength,arrowWidth:O.arrowWidth,arrowType:C.endArrowType,arrowSide:C.endArrowSide,drawOnCenter:!C.endArrowSide||C.endArrowSide===l.BOTH};for(var _=[],S=e.Render.MetaShapeUtils.inflateShape,v=0,y=a.length;v<y;++v){var A=a[v].getPathNodeParams();if(A.useStickingOffset){var M=this.getStickingTargetRenderBound(r,a[v]);if(M){var I=A.stickingOffsetRelLength;if(e.ObjUtils.isUnset(I)&&(I=o.glyphStickOffsetRelLength),I){M=S(M,this._doGetStickOffsetContextLength(r,I,o))}_[v]=M}}}var R=[],L=[],x={y:0,x:E},D=t.substract(this.transformCoordToContext(r,b,{x:0,y:0}),this.transformCoordToContext(r,b,x)),P=t.getDistance(D,{x:0,y:0});if(p===n.LINE){var B=this._doDrawLineConnectorShape(r,b,i,a,c,h,N,P,m,g,_,f,o);R=B.drawnElems,T=B.arrowElems,L=B.boundInfos}else if(p===n.ARC){var w=i.getControlPoints&&i.getControlPoints(),k=w&&w[0];if(k){var U=t.clone(this.getTransformedCoord2D(r,k,s.allowCoordBorrow)),B=this._doDrawArcConnectorShape(r,b,i,a,c,h,U,N,P,m,g,_,f,o);R=B.drawnElems,T=B.arrowElems,L=B.boundInfos}}if(L.length||(L=null),N<=1&&!T.length)return{element:R&&R[0],boundInfo:L&&L[0]};for(var j=this.createDrawGroup(r),v=0;v<N;++v)R[v]&&this.addToDrawGroup(R[v],j);for(var v=0,y=T.length;v<y;++v)T[v]&&this.addToDrawGroup(T[v],j);return{element:j,boundInfo:L}},_doGetStickOffsetContextLength:function(e,r,i){var n=r*i.medianObjRefLength,a={x:0,y:0},o={x:n,y:0},s=this.getRootRenderer(),l=s.transformCoordToContext(e,this.getChemObj(),a),d=s.transformCoordToContext(e,this.getChemObj(),o);return t.getDistance(l,d)},_doDrawLineConnectorShape:function(r,i,n,a,o,s,l,d,u,c,h,m,g){for(var f=[o,s],p=[o,s],C=(t.divide(t.add(o,s),2),0);C<2;++C){var b=h[C];if(b){var E=e.Render.MetaShapeUtils.getCrossPointsOfVectorToShapeEdges(p,b,!0);E&&E.length&&(f[C]=E[0],this._nodeCoordOverrideMap.set(a[C],f[C]))}}for(var N,T,O=e.Glyph.ArrowSide,_=[],S=[],v=[],y=t.substract(f[1],f[0]),A=y.x,M=y.y,I=t.getDistance(f[0],f[1]),R=M/I,L=A/I,x=I,D=(l-1)/2,P=d,B={y:P*L,x:-P*R},w=(t.multiply(B,(l-1)/2),t.multiply(B,(l-1)/2)),k=t.substract(f[0],w),U=t.substract(f[1],w),C=0;C<l;++C){if(N=null,T=null,0!==C&&(k=t.add(k,B),U=t.add(U,B)),u||c){var j=C-D,F=P*Math.abs(j);if(u){if(u.drawOnCenter&&(!u.arrowSide||u.arrowSide===O.SINGLE&&j<0||u.arrowSide===O.REVERSED&&j>0))var W=u.arrowType===e.Glyph.ArrowType.OPEN?u.arrowLength*F/(u.arrowWidth/2):u.arrowLength,N=t.add(k,t.multiply(y,W/x));u.drawOnCenter&&0===C&&e.ArrayUtils.pushUnique(v,this.doDrawArrowShape(r,n,f[1],f[0],u,m,!0)),!u.drawOnCenter&&(u.arrowSide===O.SINGLE&&0===C||u.arrowSide===O.REVERSED&&C===l-1)&&e.ArrayUtils.pushUnique(v,this.doDrawArrowShape(r,n,U,k,u,m,!0))}if(c){if(c.drawOnCenter&&(!c.arrowSide||c.arrowSide===O.SINGLE&&j<0||c.arrowSide===O.REVERSED&&j>0))var W=c.arrowType===e.Glyph.ArrowType.OPEN?c.arrowLength*F/(c.arrowWidth/2):c.arrowLength,T=t.substract(U,t.multiply(y,W/x));c.drawOnCenter&&0===C&&e.ArrayUtils.pushUnique(v,this.doDrawArrowShape(r,n,f[0],f[1],c,m)),!c.drawOnCenter&&(c.arrowSide===O.SINGLE&&0===C||c.arrowSide===O.REVERSED&&C===l-1)&&e.ArrayUtils.pushUnique(v,this.doDrawArrowShape(r,n,k,U,c,m))}}var V=this.doDrawLineShape(r,n,N||k,T||U,m,g);_.push(V.element),S.push(V.boundInfo)}return{drawnElems:_,boundInfos:S,arrowElems:v}},_doDrawArcConnectorShape:function(r,i,n,a,o,s,l,d,u,c,h,m,g,f){for(var p=[],C=[],b=[],E=[o,s],N=t.divide(t.add(l,E[0]),2),T=t.divide(t.add(E[1],l),2),O=-(E[0].x-l.x)/(E[0].y-l.y),_=-(E[1].x-l.x)/(E[1].y-l.y),S={x:(T.y-N.y-_*T.x+O*N.x)/(O-_),y:N.y+O*(T.y-N.y-_*T.x+_*N.x)/(O-_)},v=t.getDistance(S,E[0]),y=t.substract(E[0],S),A=t.substract(E[1],S),M=t.substract(l,S),I=e.GeometryUtils.standardizeAngle(Math.atan2(y.y,y.x)),R=e.GeometryUtils.standardizeAngle(Math.atan2(A.y,A.x)),L=e.GeometryUtils.standardizeAngle(Math.atan2(M.y,M.x)),x=[],D=0;D<2;++D){var P=m[D];if(P){var B=this._getCrossCoordsAndAnglesOfArcToShapeEdges(S,v,I,R,L,P);if(B&&B.length>=1){var w=B[0].coord,k=B[0].angle;x[D]=k,E[D]=w,this._nodeCoordOverrideMap.set(a[D],w)}}}x[0]&&(I=x[0]),x[1]&&(R=x[1]);var U,j,F=R-I,W=L-I,V=L-R,H=Math.sign(W)*Math.sign(V),G=Math.sign(F),K=H*G>0,z=10/v;if(c){var Y=I-(K?z:-z);U={x:Math.cos(Y),y:Math.sin(Y)}}if(h){var Y=R+(K?z:-z);j={x:Math.cos(Y),y:Math.sin(Y)}}for(var X=(d-1)/2,$=v-u*X,D=0;D<d;++D){var J=$+D*u;if((c||h)&&d<=1){if(c&&0===D){var Z=t.add(S,t.multiply(U,J));e.ArrayUtils.pushUnique(b,this.doDrawArrowShape(r,n,Z,E[0],c,g,!0))}if(h&&0===D){var Z=t.add(S,t.multiply(j,J));e.ArrayUtils.pushUnique(b,this.doDrawArrowShape(r,n,Z,E[1],h,g,!0))}}var q=this.doDrawArcShape(r,S,J,I,R,K,g);q.element&&p.push(q.element),q.boundInfo&&C.push(q.boundInfo)}return{drawnElems:p,boundInfos:C,arrowElems:b}},_getCrossCoordsAndAnglesOfArcToShapeEdges:function(r,i,n,a,o,s){for(var l=e.Render.MetaShapeUtils.getEdgeBasicElements(s),d=l.vectors,u=[],c=0,h=d.length;c<h;++c){var m=d[c],g=e.GeometryUtils.getCrossPointsOfVectorToCircle(m,r,i,1e-4);g&&g.length&&(u=u.concat(g))}for(var f=l.circles,c=0,h=f.length;c<h;++c){var m=f[c],g=e.GeometryUtils.getCrossPointsOfCircles(m.center,m.radius,r,i,1e-4);g&&g.length&&(u=u.concat(g))}for(var p=[],C=Math.sign((o-n)*(o-a)),c=0,h=u.length;c<h;++c){var b=t.substract(u[c],r),E=e.GeometryUtils.standardizeAngle(Math.atan2(b.y,b.x));Math.sign((E-n)*(E-a))===C&&p.push({angle:E,coord:u[c]})}return p},_getNearestCoordToPoint:function(e,r){for(var i=null,n=null,a=0,o=r.length;a<o;++a){var s=t.getDistance(r[a],e);(!i||s<n)&&(i=r[a],n=s)}return i},_transformArrowLength:function(t,r,i){var n={x:r||0,y:i||0},a=e.CoordUtils.substract(this.transformCoordToContext(t,this.getChemObj(),n),this.transformCoordToContext(t,this.getChemObj(),{x:0,y:0}));return{arrowLength:Math.abs(a.x),arrowWidth:Math.abs(a.y)}},doDrawArrowShape:function(r,i,n,a,o,s,l){var d,u,c=e.Glyph.ArrowSide,h=e.Glyph.ArrowType,m=t.substract(a,n),g=t.getDistance(a,n),f=m.y/g,p=m.x/g,C=o.arrowLength,b=o.arrowWidth,E=b/2,N=t.substract(a,t.multiply(m,C/g)),T={x:E*f,y:-E*p},O=e.Render.DrawPathUtils,_=[];!o.arrowSide||!l&&o.arrowSide===c.SINGLE||l&&o.arrowSide===c.REVERSED?(d=t.add(N,T),_.push("M"),_.push([d.x,d.y]),_.push("L"),_.push([a.x,a.y])):(_.push("M"),_.push([a.x,a.y])),(!o.arrowSide||!l&&o.arrowSide===c.REVERSED||l&&o.arrowSide===c.SINGLE)&&(u=t.substract(N,T),_.push("L"),_.push([u.x,u.y]));var S=!1;if(o.arrowType===h.TRIANGLE){var v=d&&u?null:N;v&&(_.push("L"),_.push([v.x,v.y])),_.push("Z"),S=!0}var y=O.makePath.apply(this,_),A=Object.create(s);return S||(A.fillColor="transparent"),this.drawPath(r,y,A)},doDrawLineShape:function(e,t,r,i,n,a){return{element:this.drawLine(e,r,i,n),boundInfo:this.createLineBoundInfo(r,i,n.strokeWidth)}},doDrawArcShape:function(e,t,r,i,n,a,o){var s=Object.create(o);return s.fillColor=null,{element:this.drawArc(e,t,r,i,n,a,s),boundInfo:this.createArcBoundInfo(t,r,i,n,a,s.strokeWidth)}}}),e.Render.PathGlyph2DRenderer=i.create(e.Render.BaseGlyph2DRenderer,{CLASS_NAME:"Kekule.Render.PathGlyph2DRenderer",initialize:function($super,t,r,i){$super(t,r,i),this._concreteChemObj=t.getCtab(),this._concreteRenderer=new e.Render.PathGlyphCtab2DRenderer(t.getCtab(),r,this)},finalize:function($super){$super(),this._concreteRenderer&&(this._concreteRenderer.finalize(),this._concreteRenderer=null)},_getRenderSortIndex:function($super){return this._concreteRenderer?this._concreteRenderer._getRenderSortIndex():$super()},getRenderCache:function(e){return this._concreteRenderer.getRenderCache(e)},_getConcreteRendererDrawOptions:function(e){return e},isChemObjRenderedBySelf:function($super,e,t){return $super(e,t)||t===this.getChemObj()||this._concreteRenderer.isChemObjRenderedBySelf(e,t)},isChemObjRenderedDirectlyBySelf:function($super,e,t){return $super(e,t)||t===this.getChemObj()},doSetRedirectContext:function($super,e){$super(e),this._concreteRenderer.setRedirectContext(e)},doDraw:function($super,e,t,r){$super(e,t,r);var i=(this.getChemObj(),Object.create(r));return i.partialDrawObjs&&(i.partialDrawObjs=null),this._concreteRenderer.draw(e,t,this._getConcreteRendererDrawOptions(i))},doRedraw:function(e){return this._concreteRenderer.redraw(e)},doUpdate:function(e,t,r){if(this._extractObjsOfUpdateObjDetails(t).indexOf(this.getChemObj())>=0){var i=this.getRenderCache(e);return this.doClear(e),this.draw(e,i.baseCoord,i.options)}return this._concreteRenderer.doUpdate(e,t,r)},doClear:function(e){return this._concreteRenderer.clear(e)},estimateRenderBox:function(e,t,r){return this._concreteRenderer.estimateRenderBox(e,this._getConcreteRendererDrawOptions(t),r)},transformCoordToObj:function(e,t,r){var i=this.getChemObj()===t?this._concreteChemObj:t;return this._concreteRenderer.transformCoordToObj(e,i,r)},transformCoordToContext:function(e,t,r){var i=this.getChemObj()===t?this._concreteChemObj:t;return this._concreteRenderer.transformCoordToContext(e,i,r)}}),e.Render.Renderer2DFactory.register(e.Glyph.PathGlyph,e.Render.PathGlyph2DRenderer),e}},function(e,t,r){"use strict";var i=r(0).Class;e.exports=function(e){return e.Render.CanvasRendererBridge=i.create({CLASS_NAME:"Kekule.Render.CanvasRendererBridge",DEF_DOUBLE_BUFFERED:!1,SHADOW_CANVAS_FIELD:"__$shadow_canvas__",SHADOW_CONTEXT_FIELD:"__$shadow_context__",getShadowContext:function(e){return e[this.SHADOW_CONTEXT_FIELD]},getShadowCanvas:function(e){return e[this.SHADOW_CANVAS_FIELD]},getOperatingContext:function(e){return this.getShadowContext(e)||e},createContext:function(e,t,r,i,n){void 0===n&&(n=this.DEF_DOUBLE_BUFFERED);var a=(e.ownerDocument,document.createElement("canvas"));i&&(a.id=i),e.appendChild(a);var o=a.getContext("2d");if(n){var s=document.createElement("canvas");s.style.position="absolute",s.style.display="none",e.appendChild(s),o[this.SHADOW_CANVAS_FIELD]=s,o[this.SHADOW_CONTEXT_FIELD]=s.getContext("2d")}return this.setContextDimension(o,t,r),o},releaseContext:function(e){var t=e.canvas,r=this.getShadowCanvas(e),i=t.parentNode;i&&(i.removeChild(t),r&&i.removeChild(r))},getContextDimension:function(e){return{width:e.canvas.width,height:e.canvas.height}},setContextDimension:function(e,t,r){var i=this.getShadowCanvas(e);t&&(e.canvas.width=t,e.canvas.style.width=t+"px",i&&(i.width=t,i.style.width=t+"px")),r&&(e.canvas.height=r,e.canvas.style.height=r+"px",i&&(i.height=r,i.style.height=r+"px")),this.clearContext(e)},getContextElem:function(e){return e?e.canvas:null},setContextViewBox:function(e,t,r,i,n,a){},clearContext:function(e){var t=e.canvas;t.setAttribute("width",t.width);var r=this.getShadowCanvas(e);r&&(r.width=t.width);var i=e.__$clearColor__;if(i){e.save();try{var n=this.getContextDimension(e);this.drawRect(e,{x:0,y:0},{x:n.width,y:n.height},{fillColor:i,strokeColor:i})}finally{e.restore()}}},setClearColor:function(e,t){e&&(e.__$clearColor__=t)},renderContext:function(e){var t=this.getShadowCanvas(e);t&&e.drawImage(t,0,0)},transformContextCoordToScreen:function(e,t){return t},transformScreenCoordToContext:function(e,t){return t},canModifyGraphic:function(e){return!1},_drawDashLine:function(e,t,r,i){void 0==i&&(i=5),e.moveTo(t.x,t.y);for(var n=r.x-t.x,a=r.y-t.y,o=Math.floor(Math.sqrt(n*n+a*a)/i),s=n/o,l=a/o,d=0,u=t.x,c=t.y;d++<o;)u+=s,c+=l,e[d%2==0?"moveTo":"lineTo"](u,c);e[d%2==0?"moveTo":"lineTo"](r.x2,r.y)},drawLine:function(e,t,r,i){var n=this.getOperatingContext(e);n.beginPath(),this.setDrawStyle(n,i),i.strokeDash&&!this.isLineDashSupported(n)?this._drawDashLine(n,t,r,i.strokeDash):(n.moveTo(t.x,t.y),n.lineTo(r.x,r.y)),this.doneDraw(n,i)},drawTriangle:function(e,t,r,i,n){var a=this.getOperatingContext(e);a.beginPath(),this.setDrawStyle(a,n),a.moveTo(t.x,t.y),a.lineTo(r.x,r.y),a.lineTo(i.x,i.y),a.closePath(),this.doneDraw(a,n)},drawRect:function(e,t,r,i){var n=this.getOperatingContext(e);n.beginPath(),this.setDrawStyle(n,i),n.rect(t.x,t.y,r.x-t.x,r.y-t.y),this.doneDraw(n,i)},drawRoundRect:function(e,t,r,i,n){return this.drawRect(e,t,r,n)},drawCircle:function(e,t,r,i){var n=this.getOperatingContext(e);n.beginPath(),this.setDrawStyle(n,i),n.arc(t.x,t.y,r,0,2*Math.PI,!1),this.doneDraw(n,i)},drawArc:function(e,t,r,i,n,a,o){var s=this.getOperatingContext(e);s.beginPath(),this.setDrawStyle(s,o),s.arc(t.x,t.y,r,i,n,a),this.doneDraw(s,o)},_PATH_CMDS:["M","Z","L","C","Q"],_PATH_METHODS:["moveTo","closePath","lineTo","bezierCurveTo","quadraticCurveTo"],drawPath:function(e,t,r){var i=this.getOperatingContext(e);if(!(t.length<=0)){i.beginPath(),this.setDrawStyle(i,r);for(var n,a=0,o=t.length;a<o;++a){n=[];var s,l=t[a],d=l.method.toUpperCase(),u=this._PATH_CMDS.indexOf(d);if(u>=0){var s=this._PATH_METHODS[u];n=l.params,i[s].apply(i,n)}}this.doneDraw(i,r)}},drawImage:function(e,t,r,i,n,a,o){var s=this.getOperatingContext(e),l=this.getContextElem(s),d=l.ownerDocument,u=d.createElement("img");u.src=t;var c=this;u.onload=function(){try{c.setDrawStyle(s,n);var t=e;o&&(t=o()),t=c.getOperatingContext(t),t.drawImage(u,r.x,r.y,i.x,i.y),a&&a(!0),c.doneDraw(s,n)}catch(e){throw a&&a(!1),e}},u.src=t},drawImageElem:function(e,t,r,i,n){var a=this.getOperatingContext(e);this.setDrawStyle(a,n),a.drawImage(t,r.x,r.y,i.x,i.y),this.doneDraw(a,n)},isLineDashSupported:function(t){return e.ObjUtils.isUnset(this.isLineDashSupported._cachedValue)&&(this.isLineDashSupported._cachedValue=t.setLineDash&&"number"==typeof t.lineDashOffset),this.isLineDashSupported._cachedValue},setDrawStyle:function(t,r){if(e.ObjUtils.notUnset(r.strokeWidth)?t.lineWidth=r.strokeWidth:t.lineWidth=1,r.strokeColor&&"#999999"===r.strokeColor&&(r.strokeColor="#686868"),r.strokeColor&&(t.strokeStyle=r.strokeColor),t.lineCap=r.lineCap||"butt",t.lineJoin=r.lineJoin||"miter",this.isLineDashSupported(t))if(r.strokeDash){var i=!0===r.strokeDash?[5]:e.ArrayUtils.isArray(r.strokeDash)?r.strokeDash:[r.strokeDash];t.setLineDash(i)}else t.setLineDash([]);r.fillColor?t.fillStyle=r.fillColor:t.fillStyle="transparent",e.ObjUtils.notUnset(r.opacity)?t.globalAlpha=r.opacity:t.globalAlpha=1,r.zoom&&(t.zoom=r.zoom)},doneDraw:function(e,t){e.stroke(),t.fillColor&&e.fill()},getCanvasFontStyle:function(e){var t="";return e.fontStyle&&(t+=e.fontStyle+" "),e.fontWeight&&(t+=e.fontWeight+" "),e.fontSize&&("string"==typeof e.fontSize?t+=e.fontSize+" ":t+=e.fontSize+"px "),e.fontFamily&&(t+=e.fontFamily+" "),t},drawText:function(e,t,r,i){var n=this.getOperatingContext(e),a=n.font,o=n.fillStyle,s=this.getCanvasFontStyle(i);this.setDrawStyle(n,i),n.font=s,i.color&&(n.fillStyle=i.color),n.textBaseline="hanging",n.fillText(r,t.x,t.y),n.fontStyle=a,n.fillStyle=o},canMeasureText:function(e){return!0},measureText:function(t,r,i){var n=this.getCanvasFontStyle(i);t.font=n;var a=t.measureText(r),o=i.fontSize;return"string"==typeof o&&(o=e.StyleUtils.analysisUnitsValue(o).value),{width:a.width,height:o}},canMeasureDrawnText:function(e){return!1},canModifyText:function(e){return!1},createGroup:function(e){},addToGroup:function(e,t){},removeFromGroup:function(e,t){},exportToDataUri:function(e,t,r){var i=this.getContextElem(e);return i?i.toDataURL(t,r):null}}),e.Render.CanvasRendererBridge.isSupported=function(){var t=!1,r=e.$jsRoot.document;return r&&r.createElement&&(t=!!r.createElement("canvas").getContext),t},e.Render.DrawBridge2DMananger.register(e.Render.CanvasRendererBridge,20),e}},function(e,t,r){"use strict";var i=r(0).Class,n=r(0).DataType;r(1).XmlUtility;e.exports=function(e){if(e.$jsRoot.Raphael){var t=e.$jsRoot.Raphael;t.fn.line=function(e,t,r,i){return this.path("M"+e+" "+t+" L"+r+" "+i)},t.fn.arrowLine=function(e,t,r,i,n){if(!n)return this.line(e,t,r,i);var a=this.set(),o=r-e,s=i-t,l=Math.atan(s/o),d=(n.width||6)/2,u=n.length||3,c=Math.atan(d/u),h=Math.sqrt(Math.sqr(d)+Math.sqr(u));return a.push(this.path("M"+r+" "+i+" L"+(r-h*Math.cos(l-c))+" "+(i-h*Math.sin(l-c))+" M"+r+" "+i+" L"+(r-h*Math.cos(l+c))+" "+(i-h*Math.sin(l+c))),this.path("M"+e+" "+t+" L"+r+" "+i)),a},t.fn.triangle=function(e,t,r,i,n,a){return this.path("M"+e+" "+t+" L"+r+" "+i+" L"+n+" "+a+" L"+e+" "+t)},t.fn.polygon=function(e){for(var t="M"+e[0].x+" "+e[0].y,r=1,i=e.length;r<i;++r)t+=" L"+e[r].x+" "+e[r].y;return t+="L"+e[0].x+" "+e[0].y,this.path(t)},t.el.translateCoord=function(e){if(this.forEach)this.forEach(function(t){t.translateCoord(e)});else{var t=this.attr(["x","y"]);void 0!==t.x&&void 0!==t.y&&this.attr({x:t.x+e.x,y:t.y+e.y})}return this},t.st.translateCoord=function(e){return this.forEach&&this.forEach(function(t){t.translateCoord(e)}),this},t.st.remove=function(e){this.forEach(function(e){e.remove()},this),this.clear()}}return e.Render.RaphaelRendererBridge=i.create({CLASS_NAME:"Kekule.Render.RaphaelRendererBridge",createContext:function(e,r,i){return t(e,r,i)},releaseContext:function(e){e.remove()},getContextDimension:function(e){return{width:e.width,height:e.height}},setContextDimension:function(e,t,r){e.setSize(t,r),this.clearContext(e)},clearContext:function(e){e.clear();var t=e.__$clearColor__;if(t){var r=this.getContextDimension(e);this.drawRect(e,{x:0,y:0},{x:r.width,y:r.height},{fillColor:t,strokeColor:t})}},setClearColor:function(e,t){e&&(e.__$clearColor__=t)},getContextElem:function(e){return e?e.canvas:null},transformContextCoordToScreen:function(e,t){return t},transformScreenCoordToContext:function(e,t){return t},canModifyGraphic:function(e){return!0},drawPath:function(e,t,r){for(var i="",a=0,o=t.length;a<o;++a){var s=t[a];if(i+=s.method,s.params&&s.params.length)for(var l=0,d=s.params.length;l<d;++l)i+=0===l?"":",",n.isArrayValue(s.params[l])?i+=s.params[l].join(","):i+=s.params[l]}var u=e.path(i);return this.setBasicElemAttribs(u,r),u},drawLine:function(e,t,r,i){var n=e.line(t.x,t.y,r.x,r.y);return this.setBasicElemAttribs(n,i),n},drawTriangle:function(e,t,r,i,n){var a=e.triangle(t.x,t.y,r.x,r.y,i.x,i.y);return this.setBasicElemAttribs(a,n),a},drawRect:function(e,t,r,i){var n=e.rect(t.x,t.y,r.x-t.x,r.y-t.y);return this.setBasicElemAttribs(n,i),n},drawRoundRect:function(e,t,r,i,n){var a=e.rect(t.x,t.y,r.x-t.x,r.y-t.y,i);return this.setBasicElemAttribs(a,n),a},drawCircle:function(e,t,r,i){var n=e.circle(t.x,t.y,r);return this.setBasicElemAttribs(n,i),n},drawArc:function(t,r,i,n,a,o,s){var l=e.GeometryUtils.polarToCartesian,d=e.GeometryUtils.standardizeAngle,u=(e.CoordUtils,l(r.x,r.y,i,a)),c=l(r.x,r.y,i,n),h=d(n,0),m=d(a,0),g=m-h,f=d(g)<=Math.PI&&!o||d(g)>Math.PI&&o,p=f?"0":"1",C=o?"1":"0",b=["M",u.x,u.y,"A",i,i,0,p,C,c.x,c.y].join(" "),E=t.path(b);return this.setBasicElemAttribs(E,s),E},drawImage:function(e,t,r,i,n,a){try{var o=e.image(t,r.x,r.y,i.x,i.y);this.setBasicElemAttribs(o,n),a&&a(!0)}catch(e){throw a&&a(!1),e}return o},drawImageElem:function(e,t,r,i,n){return this.drawImage(e,t.src,r,i,n)},setBasicElemAttribs:function(t,r){if(e.ObjUtils.notUnset(r.strokeWidth)&&t.attr("stroke-width",r.strokeWidth),r.strokeColor&&t.attr("stroke",r.strokeColor),r.strokeDash){t.attr("stroke-dasharray","- ")}r.fillColor&&t.attr("fill",r.fillColor),r.opacity&&t.attr({"stroke-opacity":r.opacity,"fill-opacity":r.opacity}),r.lineCap&&t.attr("stroke-linecap",r.linecap),r.lineJoin&&t.attr("stroke-linejoin",r.linejoin)},getRaphaelFontStyle:function(e){var t={};return e.fontStyle&&(t["font-style"]=e.fontStyle),e.fontWeight&&(t["font-weight"]=e.fontWeight),e.fontSize&&(t["font-size"]=e.fontSize+"px"),e.fontFamily&&(t["font-family"]=e.fontFamily),t},drawText:function(e,t,r,i){r.endsWith(" ")&&(r=r.substring(0,r.length-1)+" "),r.startsWith(" ")&&(r=" "+r.substr(1));var n=this.getRaphaelFontStyle(i),a=e.text(-1e4,-1e4,r);return a.attr(n),i.color&&a.attr({stroke:i.color,fill:i.color}),this.modifyDrawnTextCoord(e,a,t),this.setBasicElemAttribs(a,i),a},canMeasureText:function(e){return!1},canMeasureDrawnText:function(e){return!0},canModifyText:function(e){return!0},measureDrawnText:function(t,r,i){var n=e.oneOf,a=r.getBBox(),o={};return o.width=n(a.width,a.x2-a.x1),o.height=n(a.height,a.y2-a.y1),o},modifyDrawnTextCoord:function(e,t,r){var i=this.measureDrawnText(e,t,null);t.attr({x:r.x+i.width/2,y:r.y+i.height/2})},createGroup:function(e){return e.set()},addToGroup:function(e,t){return t.push(e)},removeFromGroup:function(e,t){return e!==t&&t.exclude(e)},removeDrawnElem:function(e,t){t.remove()},exportToDataUri:function(e,t,r){if(e.toSVG){var i=e.toSVG();return"data:image/svg+xml;base64,"+btoa(i)}if(e.canvas&&"svg"===e.canvas.tagName.toLowerCase()){var i=n.XmlUtility.serializeNode(e.canvas);return"data:image/svg+xml;base64,"+btoa(i)}}}),e.Render.RaphaelRendererBridge.isSupported=function(){var r=!1;return e.$jsRoot.Raphael&&(r=!(!t.svg&&!t.vml)),r},e.Render.DrawBridge2DMananger.register(e.Render.RaphaelRendererBridge,10),e}},function(e,t,r){"use strict";var i=r(0).Class;r(0).DataType,r(1).XmlUtility;e.exports=function(e){var t=e.ObjUtils,r=e.BoxUtils,n=e.Render.Molecule3DDisplayType,a=e.Render.Bond3DRenderMode,o=e.Render.Bond3DRenderType,s=e.Render.Bond3DSpliceMode,l=e.Render.Node3DRenderMode,d=e.oneOf;return e.Render.Abstract3DDrawBridge=i.create({CLASS_NAME:"Kekule.Render.Abstract3DDrawBridge",getGraphicQualityLevel:function(){return null},setGraphicQualityLevel:function(e){},transformContextCoordToScreen:function(e,t){return{x:t.x,y:t.y}},canModifyGraphic:function(e){return!1},createContext:function(e,t,r){return null},getContextDimension:function(e){return{}},setContextDimension:function(e,t,r){return null},clearContext:function(e){return null},setClearColor:function(e,t){},drawSphere:function(e,t,r,i){},drawCylinder:function(e,t,r,i,n){},drawLine:function(e,t,r,i){},createDrawGroup:function(e){},addToDrawGroup:function(e,t){},removeFromDrawGroup:function(e,t){},getCameraProps:function(e){},setCameraProps:function(e,t){},exportToDataUri:function(e,t,r){}}),e.Render.Base3DRenderer=i.create(e.Render.CompositeRenderer,{CLASS_NAME:"Kekule.Render.Base3DRenderer",initialize:function($super,e,t,r){$super(e,t,r)},getRendererType:function(){return e.Render.RendererType.R3D},getActualTargetContext:function(e){return this.getRedirectContext()||e},getCameraProps:function(e){return this.getDrawBridge().getCameraProps(e)},setCameraProps:function(e,t){return this.getDrawBridge().setCameraProps(e,t)},getInitialLightPositions:function(e){return this.getDrawBridge().getInitialLightPositions&&this.getDrawBridge().getInitialLightPositions(e)},getLightCount:function(e){return this.getDrawBridge().getLightCount&&this.getDrawBridge().getLightCount(e)},getLightProps:function(e,t){return this.getDrawBridge().getLightProps&&this.getDrawBridge().getLightProps(e,t)},setLightProps:function(e,t,r){return this.getDrawBridge().setLightProps(e,t,r)},drawSphere:function(e,t,r,i){return this.getDrawBridge().drawSphere(this.getActualTargetContext(e),t,r,i)},drawCylinder:function(e,t,r,i,n){var a=this.getDrawBridge();return a?a.drawCylinder(this.getActualTargetContext(e),t,r,i,n):null},drawCylinderEx:function(e,t,r,i,n){var a=null,o=this.drawCylinder(e,t,r,i,n);if(o&&n.withEndCaps){a=this.createDrawGroup(e);var s=this.drawSphere(e,t,i);this.addToDrawGroup(s,a);var s=this.drawSphere(e,r,i);this.addToDrawGroup(s,a)}return a||o},drawParallelCylinders:function(e,t,r){var i=this.getDrawBridge();if(i.drawParallelCylinders)return i.drawParallelCylinders(this.getActualTargetContext(e),t,r);for(var n=this.createDrawGroup(e),a=0,o=t.length;a<o;++a){var s=t[a],l=this.drawCylinderEx(e,s.coord1,s.coord2,s.radius,{color:s.color,withEndCaps:r});l&&this.addToDrawGroup(l,n)}return n},drawLine:function(e,t,r,i){var n=this.getDrawBridge();return n?n.drawLine(this.getActualTargetContext(e),t,r,i):null},drawParallelLines:function(e,t,r){var i=this.getDrawBridge();if(i.drawParallelLines)return i.drawParallelLines(this.getActualTargetContext(e),t,r);if(i.drawLine){for(var n=t.length,a=[],o=0;o<n;++o){var s=t[o],l=this.drawLine(e,s.coord1,s.coord2,{lineWidth:s.lineWidth,color:s.color,opacity:s.opacity});l&&a.push(l)}var d;if(a.length<=1)d=a[0];else{d=this.createDrawGroup(e);for(var o=0,u=a.length;o<u;++o)this.addToDrawGroup(a[o],d)}return d}},createDrawGroup:function(e){return this.getDrawBridge().createGroup(this.getActualTargetContext(e))},addToDrawGroup:function(e,t){return this.getDrawBridge().addToGroup(e,t)},removeFromDrawGroup:function(e,t){return this.getDrawBridge().removeFromGroup(e,t)},removeDrawnElem:function(e,t){}}),e.Render.ChemObj3DRenderer=i.create(e.Render.Base3DRenderer,{CLASS_NAME:"Kekule.Render.ChemObj3DRenderer",initialize:function($super,e,t,r){$super(e,t,r),this._enableTransformByCamera=!0},doEstimateSelfObjBox:function(t,r,i){return e.Render.ObjUtils.getContainerBox(this.getChemObj(),this.getCoordMode(),i)},doEstimateRenderBox:function(e,t,i,n){var a=this.estimateObjBox(e,i,n);if(a){var o=this.prepareTransformParams(e,t,i,a),s=o;return r.transform3D(a,s)}return null},beginDraw:function($super,e,t,r){if($super(e,t,r),this.isRootRenderer()){var i=this.getDrawBridge();if(i&&i.setGraphicQualityLevel){var n=r.graphicQuality;i.setGraphicQualityLevel(n)}}},endDraw:function($super,e,t,r){this.isRootRenderer()&&this.adjustCamera(e,r.transformParams),$super(e,t,r)},doDraw:function($super,e,t,r){return this.prepareTransformParams(e,t,r),$super(e,t,r)},changeGeometryOptions:function(e,t,r){var i=Object.create(r);this.prepareTransformParams(e,t,i).pureCameraTransform?this.endDraw(e,t,i):(this.getDrawBridge().clearContext(e),this.draw(e,t,r))},prepareTransformParams:function(t,r,i,n){var a;if(i.transformParams)a=i.transformParams;else{var o=this.generateTransformParams(t,r,i,n);i.transformParams=o,a=o}var s=e.CoordUtils.calcTransform3DMatrix(a),l=e.CoordUtils.calcInverseTransform3DMatrix(a);return i.transformParams.transformMatrix=s,i.transformParams.invTransformMtrix=l,this.getRenderCache(t).transformParams=a,this.getRenderCache(t).transformMatrix=s,this.getRenderCache(t).invTransformMatrix=l,this.getRenderCache(t).transformParams=a,a},canDoPureCameraTransform:function(e,t){return this._enableTransformByCamera&&t.scaleX===t.scaleY&&t.scaleY===t.scaleZ&&!t.rotateAngle&&!t.rotateX&&!t.rotateY&&!t.rotateZ},generateTransformParams:function(r,i,n,a){var o={};o.allowCoordBorrow=d(n.allowCoordBorrow,!1),o.unitLength=n.unitLength||1,a||(a=this.estimateObjBox(r,n,o.allowCoordBorrow)),a||(a={x1:0,x2:1,y1:0,y2:1,z1:0,z2:1});var s={x:(a.x1+a.x2)/2,y:(a.y1+a.y2)/2,z:(a.z1+a.z2)/2},l=e.ObjUtils;l.isUnset(n.translateX)&&l.isUnset(n.translateY)&&l.isUnset(n.translateZ)?i&&(o.translateX=i.x-s.x,o.translateY=i.y-s.y,o.translateZ=i.z||0-s.z||0):(o.translateX=n.translateX||0,o.translateY=n.translateY||0,o.translateZ=n.translateZ||0),o.zoom=n.zoom||1,o.scaleX=d(n.scaleX,n.scale,1),o.scaleY=d(n.scaleY,n.scale,1),o.scaleZ=d(n.scaleZ,n.scale,1);n.scaleX||n.scaleY||n.scaleZ||n.scale;t.notUnset(n.rotateMatrix)?o.rotateMatrix=n.rotateMatrix:t.notUnset(n.rotateAngle)&&t.notUnset(n.rotateAxisVector)?o.rotateMatrix=e.CoordUtils.calcRotate3DMatrix({rotateAngle:n.rotateAngle,rotateAxisVector:n.rotateAxisVector}):(o.rotateX||o.rotateY||o.rotateZ)&&(o.rotateMatrix=e.CoordUtils.calcRotate3DMatrix({rotateX:n.rotateX||0,rotateY:n.rotateY||0,rotateZ:n.rotateZ||0})),l.isUnset(n.center)&&(o.center=s),o.drawBaseCoord=i||e.CoordUtils.transform3D(s,o);var u=Object.extend({},o);o=this.getFinalTransformParams(r,o),o.initialTransformOptions=u;var c=this.canDoPureCameraTransform(r,o);if(o.pureCameraTransform=c,this.isRootRenderer()&&(n.autofit||!n.cameraPos)){var h=this.getAutofitObjBoxInflation(r,this.getChemObj(),n),m=e.BoxUtils.inflateBox(a,h.x,h.y,h.z),g=Math.max(m.x2-m.x1,m.y2-m.y1),f=this.getCameraProps(r),p=g/2/Math.tan(f.fov/2),C=Math.sqrt(Math.sqr(p)-Math.sqr(g/2));if(c){C/=o.scaleX,o.cameraWidth=g/o.scaleX,o.cameraHeight=o.cameraWidth;var b,E,N,T,O=e.MatrixUtils.create(4,1,[0,0,1,1]),_=e.MatrixUtils.create(4,1,[0,1,1,1]);if(o.rotateMatrix){var S=e.MatrixUtils.transpose(o.rotateMatrix);b=e.MatrixUtils.multiply(S,O),N=e.MatrixUtils.multiply(S,_),E={x:b[0],y:b[1],z:b[2]},T={x:N[0],y:N[1],z:N[2]}}else E={x:0,y:0,z:1},T={x:0,y:1,z:1};E=e.CoordUtils.multiply(E,C),o.cameraPos={x:E.x,y:E.y,z:E.z},o.cameraPos=e.CoordUtils.add(o.cameraPos,o.drawBaseCoord),o.cameraUp=T,o.scaleX=o.scaleY=o.scaleZ=1;var v=this.getInitialLightPositions(r);if(S){var y=this.getLightCount(r);if(v&&v.length&&y)for(var A=Math.min(v.length,y),M=[],I=0;I<A;++I){var R=v[I];if(R){var L=e.MatrixUtils.create(4,1,[R.x,R.y,R.z,1]),x=e.MatrixUtils.multiply(S,L),D={x:x[0],y:x[1],z:x[2]};M.push(D)}}}o.lightPositions=M||v,o.rotateMatrix=null}else o.cameraPos={x:o.drawBaseCoord.x,y:o.drawBaseCoord.y,z:C+o.drawBaseCoord.z},o.cameraUp={x:0,y:1,z:1};o.cameraLookAtVector=o.drawBaseCoord||{x:0,y:0,z:0};var P={x:-o.translateX,y:-o.translateY,z:-o.translateZ};o.translateX=o.translateY=o.translateZ=0,o.cameraPos=e.CoordUtils.add(o.cameraPos,P),o.cameraLookAtVector=e.CoordUtils.add(o.cameraLookAtVector,P)}return o},getFinalTransformParams:function(t,r){var i=Object.create(r);return i.zoom&&(i.scaleX*=i.zoom,i.scaleY*=i.zoom,i.scaleZ*=i.zoom),1!==i.unitLength&&(i.translateX*=i.unitLength,i.translateY*=i.unitLength,i.translateZ*=i.unitLength,i.drawBaseCoord&&(i.drawBaseCoord=e.CoordUtils.multiply(i.drawBaseCoord,i.unitLength))),i},getRenderFinalTransformParams:function(e){return this.getRenderCache(e).transformParams},getRenderInitialTransformOptions:function(e){var t=this.getRenderFinalTransformParams(e);return t?t.initialTransformOptions:null},getAutofitObjBoxInflation:function(e,t,r){var i=r.fixedNodeRadius||0;return{x:i,y:i,z:i}},adjustCamera:function(e,t){var r=t.cameraWidth,i=t.cameraHeight,n={position:t.cameraPos,upVector:t.cameraUp,lookAtVector:t.cameraLookAtVector};if(r&&i){var a=r/2,o=i/2;n.left=-a,n.right=a,n.top=o,n.bottom=-o}this.setCameraProps(e,n),this.adjustLights(e,t)},adjustLights:function(e,t){for(var r=t.lightPositions||[],i=0,n=r.length;i<n;++i){var a=r[i];a&&this.setLightProps(e,i,{position:a})}}}),e.Render.ChemCtab3DRenderer=i.create(e.Render.ChemObj3DRenderer,{CLASS_NAME:"Kekule.Render.ChemCtab3DRenderer",TRANSFORM_COORD_FIELD:"__$transCoord3D__",DRAW_ELEM_FIELD:"__$drawElem__",DRAW_COLOR_FIELD:"__$drawColor__",BASE_RADIUS_FIELD:"__$baseRadius__",TRANSFORM_MATRIX_FIELD:"__$transMatrix__",INV_TRANSFORM_MATRIX_FIELD:"__$inverseTransMatrix__",CHILD_TRANSFORM_MATRIX_FIELD:"__$childTransMatrix__",HIDDEN_NODES_FIELD:"__$hiddenNodes__",HIDDEN_CONNECTORS_FIELD:"__$hiddenConnectors__",getObjDrawElem:function(e,t){return this.getExtraProp2(e,t,this.DRAW_ELEM_FIELD)},setObjDrawElem:function(e,t,r){this.setExtraProp2(e,t,this.DRAW_ELEM_FIELD,r)},getObjDrawColor:function(e,t){return this.getExtraProp2(e,t,this.DRAW_COLOR_FIELD)},setObjDrawColor:function(e,t,r){this.setExtraProp2(e,t,this.DRAW_COLOR_FIELD,r)},getNodeBaseRadius:function(e,t){return this.getExtraProp2(e,t,this.BASE_RADIUS_FIELD)},setNodeBaseRadius:function(e,t,r){this.setExtraProp2(e,t,this.BASE_RADIUS_FIELD,r)},getHiddenNodes:function(e){return this.getExtraProp(e,this.HIDDEN_NODES_FIELD)||[]},setHiddenNodes:function(e,t){return this.setExtraProp(e,this.HIDDEN_NODES_FIELD,t)},getHiddenConnectors:function(e){return this.getExtraProp(e,this.HIDDEN_CONNECTORS_FIELD)||[]},setHiddenConnectors:function(e,t){return this.setExtraProp(e,this.HIDDEN_CONNECTORS_FIELD,t)},doEstimateSelfObjBox:function(e,t,r){return this.getChemObj().getExposedContainerBox3D(r)},doPrepare:function(e,t,r,i){var o,s,d=i,u=this.getRenderCache(e);switch(d.moleculeDisplayType){case n.WIRE:o=l.NONE,s=d.displayMultipleBond?a.MULTI_WIRE:a.WIRE;break;case n.STICKS:o=l.NONE,s=d.displayMultipleBond?a.MULTI_CYLINDER:a.CYLINDER;break;case n.SPACE_FILL:o=l.SPACE,s=a.NONE;break;case n.BALL_STICK:default:o=l.BALL,s=d.displayMultipleBond?a.MULTI_CYLINDER:a.CYLINDER}u.nodeRenderMode=o,u.connectorRenderMode=s,u.options=d;var c=t.getExposedNodes(),h=t.getExposedConnectors();return this.prepareHiddenObjects(e,c,h,d),this.prepareNodesDrawColor(e,c,d),this.prepareNodeBaseRadii(e,c,d),d},prepareHiddenObjects:function(t,r,i,n){var a=[];this.setHiddenNodes(t,a);for(var o=0,s=r.length;o<s;++o){var l=r[o];n.hideHydrogens&&l instanceof e.Atom&&1===l.getAtomicNumber()&&a.push(l)}var d=[];this.setHiddenConnectors(t,d);for(var o=0,s=i.length;o<s;++o){var u=i[o],c=u.getConnectedExposedObjs();e.ArrayUtils.exclude(c,a)<2&&d.push(u)}},prepareNodesDrawColor:function(t,r,i){for(var n=i.useAtomSpecifiedColor,a=0,o=r.length;a<o;++a){var s=r[a],l=s.getOverriddenRender3DOptions()||{},u=l.color||l.atomColor;if(u&&!l.useAtomSpecifiedColor);else if(n||l.useAtomSpecifiedColor){var c=s.getAtomicNumber?s.getAtomicNumber():0;u=c>=0?e.Render.RenderColorUtils.getColor(c,this.getRendererType()):e.Render.RenderColorUtils.getColor(s.getClassLocalName(),this.getRendererType())}else u=d(l.color||i.atomColor);this.setObjDrawColor(t,s,u)}},prepareNodeBaseRadii:function(e,t,r){for(var i=0,n=t.length;i<n;++i){var a,o=t[i];a=this.calcNodeBaseRadius(o,r),this.setNodeBaseRadius(e,o,a)}},calcNodeBaseRadius:function(t,r){var i,n=t.getOverriddenRender3DOptions()||{},a=t.getAtomicNumber?t.getAtomicNumber():null;if(n.nodeRadius||r.nodeRadius)i=n.nodeRadius||r.nodeRadius;else if(d(n.useVdWRadius,r.useVdWRadius)&&a){var o=e.ChemicalElementsDataUtil.getElementProp(a,"radiiVdw")||n.fixedNodeRadius||r.fixedNodeRadius;i=o}else i=d(n.fixedNodeRadius,r.fixedNodeRadius);return i},doDrawSelf:function($super,e,t,r){$super(e,t,r);var i=this.getChemObj(),n=r.transformParams;this.getRenderCache(e).transformOptions=n,this.transformCtabCoords3DToContext(e,i,n);var a=this.doPrepare(e,i,t,r);return this.doDrawCore(e,i,a,n)},doRedraw:function(e){var t=this.getRenderCache(e);return this.doDrawCore(e,this.getChemObj(),t.options,t.transformOptions)},doDrawCore:function(e,t,r,i){var n=this.createDrawGroup(e);return this.doDrawConnectors(e,n,t,r,i),this.doDrawNodes(e,n,t,r,i),this.setObjDrawElem(e,t,n),n},transformCtabCoords3DToContext:function(e,t,r){var i=r.allowCoordBorrow;r.scaleX=r.scaleX||r.scale,r.scaleY=r.scaleY||r.scale,r.scaleZ=r.scaleZ||r.scale;var n=Object.extend({},r);n.centerX=0,n.centerY=0;var a=r.transformMatrix;this.setExtraProp2(e,t,this.TRANSFORM_MATRIX_FIELD,a);var o=a;this.setExtraProp2(e,t,this.CHILD_TRANSFORM_MATRIX_FIELD,a);var s=r.invTransformMatrix;this.setExtraProp2(e,t,this.INV_TRANSFORM_MATRIX_FIELD,s);for(var l=0,d=t.getNodeCount();l<d;++l){var u=t.getNodeAt(l);this.transformObjCoord3DToContext(e,u,a,o,i)}},transformObjCoord3DToContext:function(t,r,i,n,a){var o,s;if(r&&r.getAbsBaseCoord3D){if(s=r.getAbsBaseCoord3D(a)){var l=e.CoordUtils.transform3DByMatrix(s,i);this.setTransformedCoord3D(t,r,l),o=l}if(r.getNodes)for(var d=0,u=r.getNodeCount();d<u;++d)this.transformObjCoord3DToContext(t,r.getNodeAt(d),n,n,a)}return o},getTransformedCoord3D:function(t,r,i){e.ObjUtils.isUnset(i)&&(i=this.getRenderCache(t).options.transformParams.allowCoordBorrow);var n=r instanceof e.BaseStructureNode,a=n&&this.getExtraProp2(t,r,this.TRANSFORM_COORD_FIELD);if(!a){var o=this.getChemObj(),s=this.getExtraProp2(t,o,this.TRANSFORM_MATRIX_FIELD),l=this.getExtraProp2(t,o,this.CHILD_TRANSFORM_MATRIX_FIELD);a=o&&(o.hasNode(r,!1)||o.hasConnector(r,!1))?this.transformObjCoord3DToContext(r,s,l,i):this.transformObjCoord3DToContext(r,l,l,i)}return a},setTransformedCoord3D:function(e,t,r){this.setExtraProp2(e,t,this.TRANSFORM_COORD_FIELD,r)},doTransformCoordToObj:function(t,r,i){var n=this.getExtraProp2(t,r,this.INV_TRANSFORM_MATRIX_FIELD);return e.CoordUtils.transform3DByMatrix(i,n)},doTransformCoordToContext:function(t,r,i){var n=this.getExtraProp2(t,r,this.TRANSFORM_MATRIX_FIELD);return e.CoordUtils.transform3DByMatrix(i,n)},doDrawNodes:function(e,t,r,i,n){for(var a=r.getExposedNodes(),o=this.getHiddenNodes(e),s=0,l=a.length;s<l;++s){var d=a[s];if(!(o.indexOf(d)>=0)){this.doDrawNode(e,t,d,r,i,n)}}},doDrawNode:function(t,r,i,n,a,o){var s,d,u=this.getRenderCache(t).nodeRenderMode;if(u===l.NONE)return null;d=e.Render.RenderOptionUtils.mergeObjLocalRender3DOptions(i,a);var c;c=this.getNodeBaseRadius(t,i),e.ObjUtils.isUnset(c)&&(c=this.calcNodeBaseRadius(i,a)),u===l.SPACE?c*=o.scaleX:c*=d.nodeRadiusRatio*o.scaleX;var h=this.getObjDrawColor(t,i),m=this.getTransformedCoord3D(t,i,o.allowCoordBorrow);s=this.drawSphere(t,m,c,{color:h,opacity:d.opacity});var g=this.createSphereBoundInfo(m,c);this.basicDrawObjectUpdated(t,i,n,g,e.Render.ObjectUpdateType.ADD),s&&(this.setObjDrawElem(t,i,s),r&&this.addToDrawGroup(s,r))},doDrawConnectors:function(e,t,r,i,n){if(this.getRenderCache(e).connectorRenderMode===a.NONE)return null;for(var o=r.getExposedConnectors(),s=this.getHiddenConnectors(e),l=0,d=o.length;l<d;++l){var u=o[l];if(!(s.indexOf(u)>=0)){this.doDrawConnector(e,t,u,r,i,n)}}},doDrawConnector:function(t,r,i,n,a,o){var s=Object.create(a);s=e.Render.RenderOptionUtils.mergeObjLocalRender3DOptions(i,a);var l=this.getHiddenNodes(t),d=i.getConnectedExposedObjs();d=e.ArrayUtils.exclude(d,l);for(var u,c,h,m,g,f=d.length,p=f>2?this.createDrawGroup(t):null,C=0;C<f;++C)if(u=d[C],h=this.getTransformedCoord3D(t,u,o.allowCoordBorrow))for(var b=C+1;b<f;++b)c=d[b],(m=this.getTransformedCoord3D(t,c,o.allowCoordBorrow))&&(g=this.doDrawConnectorShape(t,i,[u,c],n,h,m,s,o))&&p&&this.addToDrawGroup(g,p);return p?this.addToDrawGroup(p,r):this.addToDrawGroup(g,r),p||g},doDrawConnectorShape:function(t,r,i,n,l,u,c,h){var m=e.CoordUtils,g=r.getOverriddenRender3DOptions()||{},f=(c.unitLength,i[0]),p=i[1],C=d(g.bondSpliceMode,c.bondSpliceMode),b=C===s.MID_SPLIT?.5:null;if(C===s.WEIGHTING_SPLIT){var E=this.getNodeBaseRadius(t,f),N=this.getNodeBaseRadius(t,p);b=E&&N?E/(E+N):.5}var T=null,O=!1,_=[];if(b){var S=d(c.color||c.bondColor),v=d(g.color||g.bondColor);if(O=!1,v)_.push(v);else{var y=d(this.getObjDrawColor(t,f),S),A=d(this.getObjDrawColor(t,p),S);y!==A?(_.push(y),_.push(A),O=!0):_.push(d(y,c.color,c.bondColor,c.defBondColor))}}else _.push(d(g.color,g.bondColor,c.color,c.bondColor,c.defBondColor));if(b&&O){var M=u.x-l.x,I=u.y-l.y,R=u.z-l.z;T={},T.x=l.x+M*b,T.y=l.y+I*b,T.z=l.z+R*b}var L=O?[[l,T],[T,u]]:[[l,u]],x=this.getRenderCache(t).connectorRenderMode,D=this._getBondRenderType(r,x),P=!1,B=d(g.connectorRadius,c.connectorRadius)*d(g.connectorRadiusRatio,c.connectorRadiusRatio)*c.unitLength;B*=h.scaleX;var w=d(g.connectorLineWidth,c.connectorLineWidth)*c.unitLength;D!==o.SINGLE&&D!==o.DASH?(B*=d(g.multiConnectorRadiusRatio,c.multiConnectorRadiusRatio),P=x===a.MULTI_CYLINDER):P=!1;var k=[],U=1,j=0;switch(D){case o.SINGLE:U=1;break;case o.DOUBLE:U=2;break;case o.TRIPLE:U=3;break;case o.DASH:case o.SOLID_DASH:}j=U;var F=null;if(j>1){var W=d(g.multiConnectorMarginRatio,c.multiConnectorMarginRatio)*B;P&&(W+=2*B);var V=m.getDistance(l,u),H=m.substract(u,l),G=H.y/V,K=H.x/V,z={x:-W*G,y:W*K,z:0};F=(j%2?0:.5)-Math.floor(j/2);var Y=m.multiply(z,F)}for(var X=0,$=L.length;X<$;++X)if(1===j){var J={};J.coord1=L[X][0],J.coord2=L[X][1],O&&(J.jointCoordIndex=0===X?2:1),J.color=_[X],J.radius=B,J.lineWidth=w,J.opacity=c.opacity,k.push(J)}else for(var Z=m.add(L[X][0],Y),q=m.add(L[X][1],Y),Q=0;Q<j;++Q){var J={};J.coord1=Z,J.coord2=q,Z=m.add(Z,z),q=m.add(q,z),O&&(J.jointCoordIndex=0===X?2:1),J.color=_[X],J.radius=B,J.lineWidth=w,J.opacity=c.opacity,k.push(J)}var ee,te=x;return ee=te===a.WIRE||te===a.MULTI_WIRE?this.createLineBoundInfo(l,u,{width:w}):this.createCylinderBoundInfo(l,u,{radius:B}),this.basicDrawObjectUpdated(t,r,n,ee,e.Render.ObjectUpdateType.ADD),this.doDrawConnectorSet(t,k,te,D,c)},doDrawConnectorSet:function(e,t,r,i,n){if(r===a.WIRE||r===a.MULTI_WIRE)return this.drawParallelLines(e,t);var o=this.getRenderCache(e).nodeRenderMode===l.NONE;return this.drawParallelCylinders(e,t,o)},_getBondRenderType:function(t,r){var i=t.getOverriddenRender3DOptions()||{},n=e.Render.Render3DOptionUtils.getConnectorRenderType(i);return n||e.Render.ConnectorDrawUtils.getConnectorRender3DType(t,r)}}),e.ClassDefineUtils.addExtraTwoTupleObjMapSupport(e.Render.ChemCtab3DRenderer),e.Render.StructFragment3DRenderer=i.create(e.Render.ChemObj3DRenderer,{CLASS_NAME:"Kekule.Render.StructFragment3DRenderer",initialize:function($super,t,r,i){$super(t,r,i),this._concreteRenderer=null,t.hasCtab()?this._concreteRenderer=new e.Render.ChemCtab3DRenderer(t.getCtab(),r,this):(this._concreteRenderer=null,e.raise(e.$L("ErrorMsg.FORMULA_RENDERER_3D_NOT_AVAILABLE"))),this._concreteRenderer.setParentRenderer(this)},finalize:function($super){$super(),this._concreteRenderer&&this._concreteRenderer.finalize()},getRenderCache:function(e){return this._concreteRenderer.getRenderCache(e)},_getConcreteRendererDrawOptions:function(t){var r=Object.create(t),i=this.getChemObj(),n=this.getRendererType()===e.Render.RendererType.R3D?i.getOverriddenRender3DOptions():i.getOverriddenRenderOptions();return r=Object.extend(r,n||{})},isChemObjRenderedBySelf:function($super,e,t){return $super(e,t)||t===this.getChemObj()||this._concreteRenderer.isChemObjRenderedBySelf(e,t)},isChemObjRenderedDirectlyBySelf:function($super,e,t){return $super(e,t)||t===this.getChemObj()},doSetRedirectContext:function($super,e){$super(e),this._concreteRenderer.setRedirectContext(e)},doDrawSelf:function($super,e,t,r){return $super(e,t,r),this._concreteRenderer.draw(e,t,this._getConcreteRendererDrawOptions(r))},doRedraw:function(e){return this._concreteRenderer.redraw(e)},doUpdateSelf:function(e,t,r){if(this._extractObjsOfUpdateObjDetails(t).indexOf(this.getChemObj())>=0){var i=this.getRenderCache(e);return this.doClear(e),this.draw(e,i.baseCoord,i.options)}return this._concreteRenderer.doUpdate(e,t,r)},doClearSelf:function(e){var t=this._concreteRenderer;if(t)return t.clear(e)},estimateRenderBox:function(e,t,r){return this._concreteRenderer.estimateRenderBox(e,this._getConcreteRendererDrawOptions(t),r)},getChildObjs:function($super){var e=this.getChemObj();if(e&&e.getAttachedMarkers){for(var t=[],r=(e.getExposedNodes()||[]).concat(e.getExposedConnectors()||[]),i=0,n=r.length;i<n;++i){var a=r[i];t=t.concat(a.getAttachedMarkers()||[])}return t.concat($super())}return $super()},_needWholelyDraw:function($super,e,t){var r=$super(e,t);if(!r){for(var i=this.getChemObj(),n=!1,a=0,o=e.length;a<o;++a){if(e[a].isChildOf(i)){n=!0;break}}r=n}return r},transformCoordToObj:function(e,t,r){var i=this.getChemObj()===t?this._concreteChemObj:t;return this._concreteRenderer.transformCoordToObj(e,i,r)},transformCoordToContext:function(e,t,r){var i=this.getChemObj()===t?this._concreteChemObj:t;return this._concreteRenderer.transformCoordToContext(e,i,r)}}),e.Render.Mol3DRenderer=e.Render.StructFragment3DRenderer,e.Render.CompositeObj3DRenderer=i.create(e.Render.ChemObj3DRenderer,{CLASS_NAME:"Kekule.Render.CompositeObj3DRenderer"}),e.Render.CompositeMolecule3DRenderer=i.create(e.Render.CompositeObj3DRenderer,{CLASS_NAME:"Kekule.Render.CompositeMolecule3DRenderer",getChildObjs:function($super){for(var e=[],t=this.getChemObj().getSubMolecules(),r=0,i=t.getItemCount();r<i;++r){var n=t.getObjAt(r);e.push(n)}return e.concat($super())}}),e.Render.ChemObjGroupList3DRenderer=i.create(e.Render.CompositeObj3DRenderer,{CLASS_NAME:"Kekule.Render.ChemObjGroupList3DRenderer",getChildObjs:function($super){var t=this.getChemObj();if(t instanceof e.ChemObjList)for(var r=[],i=0,n=t.getItemCount();i<n;++i)r.push(t.getItemAt(i));else t instanceof e.ChemStructureObjectGroup&&(r=t.getAllObjs());return(r||[]).concat($super())}}),e.Render.ChemSpaceElement3DRenderer=i.create(e.Render.CompositeObj3DRenderer,{CLASS_NAME:"Kekule.Render.ChemSpaceElement3DRenderer",getChildObjs:function($super){return(this.getChemObj().getChildren().toArray()||[]).concat($super())}}),e.Render.ChemSpace3DRenderer=i.create(e.Render.CompositeObj3DRenderer,{CLASS_NAME:"Kekule.Render.ChemSpace3DRenderer",getChildObjs:function($super){return[this.getChemObj().getRoot()].concat($super())}}),e.Render.Renderer3DFactory.register(e.StructureFragment,e.Render.StructFragment3DRenderer),e.Render.Renderer3DFactory.register(e.CompositeMolecule,e.Render.CompositeMolecule3DRenderer),e.Render.Renderer3DFactory.register(e.ChemObjList,e.Render.ChemObjGroupList3DRenderer),e.Render.Renderer3DFactory.register(e.ChemStructureObjectGroup,e.Render.ChemObjGroupList3DRenderer),e.Render.Renderer3DFactory.register(e.ChemSpaceElement,e.Render.ChemSpaceElement3DRenderer),e.Render.Renderer3DFactory.register(e.ChemSpace,e.Render.ChemSpace3DRenderer),e}},function(e,t,r){"use strict";var i=r(0).Class,n=r(0).ObjectEx,a=r(0).DataType;r(1).XmlUtility;e.exports=function(e){if(e.$jsRoot.THREE){var t=e.$jsRoot.THREE;t.Object3D.prototype.clear=function(){for(var e=this.children,t=e.length-1;t>=0;t--){var r=e[t];r.clear(),this.remove(r)}},t.Scene.prototype.clearMesh=function(){for(var e=this.children,r=e.length-1;r>=0;r--){var i=e[r];(i instanceof t.Mesh||i instanceof t.Line||i.__objGroup__)&&(i.clear(),this.remove(i))}}}return e.Render.ThreeObjectCache=i.create({CLASS_NAME:"Kekule.Render.ThreeObjectCache",initialize:function(){this.cache=new e.MapEx(!0)},finalize:function(){this.cache.finalize(),this.cache=null},createInstance:function(e,t){return null},isSameParams:function(e,t){if(e.length!==t.length)return!1;for(var r=0,i=e.length;r<i;++r)if(!this.isParamEqual(e[r],t[r]))return!1;return!0},isParamEqual:function(t,r){var i=t===r;return i||a.isObjectValue(t)&&a.isObjectValue(r)&&(i=e.ObjUtils.equal(t,r)),i},add:function(){var e=Array.prototype.slice.call(arguments),t=e.shift(),r=this.cache.get(t);r||(r=[],this.cache.set(t,r));var i={params:e};return i.instance=this.createInstance(t,e),r.push(i),i.instance},get:function(){var e=Array.prototype.slice.call(arguments),t=e[0],r=this.cache.get(t);if(r){e.shift();for(var i=0,n=r.length;i<n;++i){var a=r[i].params;if(this.isSameParams(a,e))return r[i].instance}e.unshift(t)}return this.add.apply(this,e)}}),e.Render.ThreeGeometryCache=i.create(e.Render.ThreeObjectCache,{CLASS_NAME:"Kekule.Render.ThreeGeometryCache",createInstance:function(e,r){var i=null,n=r;n[0];switch(e){case t.SphereGeometry:i=new t.SphereGeometry(n[1],n[2],n[3]);break;case t.CylinderGeometry:i=new t.CylinderGeometry(n[1],n[2],n[3],n[4],n[5],n[6])}return i}}),e.ClassUtils.makeSingleton(e.Render.ThreeGeometryCache),e.Render.ThreeMaterialCache=i.create(e.Render.ThreeObjectCache,{CLASS_NAME:"Kekule.Render.ThreeMaterialCache",createInstance:function(e,t){return new e(t[1])}}),e.ClassUtils.makeSingleton(e.Render.ThreeMaterialCache),e.Render.ThreeContext=i.create(n,{CLASS_NAME:"Kekule.Render.ThreeContext",initialize:function($super,e,t,r,i){$super(),this.setScene(e),this.setCamera(t),this.setLights(r),this.setRenderer(i)},initProperties:function(){this.defineProp("scene",{dataType:a.OBJECT,serializable:!1}),this.defineProp("camera",{dataType:a.OBJECT,serializable:!1}),this.defineProp("lights",{dataType:a.ARRAY,serializable:!1}),this.defineProp("renderer",{dataType:a.OBJECT,serializable:!1}),this.defineProp("width",{dataType:a.INT,serializable:!1,setter:null}),this.defineProp("height",{dataType:a.INT,serializable:!1,setter:null})},getDimension:function(){return{width:this.getWidth(),height:this.getHeight()}},setDimension:function(e,r){this.setPropStoreFieldValue("width",e),this.setPropStoreFieldValue("height",r),this.getRenderer().setSize(e,r);var i=this.getCamera();i instanceof t.OrthographicCamera?(i.left=e/-2,i.right=e/2,i.top=r/2,i.bottom=r/-2):i.aspect=e/r,i.updateProjectionMatrix()}}),e.Render.ThreeRendererBridge=i.create({CLASS_NAME:"Kekule.Render.ThreeRendererBridge",_qualitySettings:[null,{sphereSegments:6,sphereRings:6,cylinderSegmentsRadius:6},{sphereSegments:8,sphereRings:8,cylinderSegmentsRadius:8},{sphereSegments:16,sphereRings:16,cylinderSegmentsRadius:16},{sphereSegments:32,sphereRings:32,cylinderSegmentsRadius:32},{sphereSegments:64,sphereRings:64,cylinderSegmentsRadius:64}],initialize:function(){this.geometryCache=e.Render.ThreeGeometryCache.getInstance(),this.materialCache=e.Render.ThreeMaterialCache.getInstance(),this._quality=null,this._modelParams={},this._webglEnabled=!0},finalize:function(){this.geometryCache=null,this.materialCache=null},getGraphicQualityLevel:function(){return this._quality},setGraphicQualityLevel:function(t){this._webglEnabled?this._quality=t:this._quality=e.Render.Render3DGraphicQuality.EXTREME_LOW,this._modelParams=this.calcModelParams(this._quality)},_updateGraphicQualityLevel:function(){this._webglEnabled||this.setGraphicQualityLevel(e.Render.Render3DGraphicQuality.EXTREME_LOW)},calcModelParams:function(t){var r=this._qualitySettings[t];return r||(r=this._qualitySettings[e.Render.Render3DGraphicQuality.MEDIUM]),r},getInitialLightPositions:function(e){return[{x:5,y:5,z:10}]},createContext:function(r,i,n){var a=e.BrowserFeature,o=a.webgl?new t.WebGLRenderer({preserveDrawingBuffer:!0,alpha:!0}):a.canvas?new t.CanvasRenderer:new t.SVGRenderer,s=new t.PerspectiveCamera;s.fov=5,this._webglEnabled=o instanceof t.WebGLRenderer,this._updateGraphicQualityLevel();var l=new t.Scene;l.add(s),o.setSize(i,n);for(var d=this.getInitialLightPositions(),u=[],c=0,h=d.length;c<h;++c){var m=new t.DirectionalLight(13421772,1,10,!0),g=d[c];m.position.set(g.x,g.y,g.z),l.add(m),u.push(m)}var m=new t.AmbientLight(2105376);l.add(m),r.appendChild(o.domElement);var f=new e.Render.ThreeContext(l,s,u,o);return f.setDimension(i,n),f},releaseContext:function(e){var t=this.getContextElem(e);e.finalize(),t&&t.parentNode.removeChild(t)},getContextElem:function(e){return e?e.getRenderer().domElement:null},getContextDimension:function(e){return{width:e.getWidth(),height:e.getHeight()}},setContextDimension:function(e,t,r){e.setDimension(t,r)},transformContextCoordToScreen:function(e,t){var r=e.getDimension();return{x:t.x+r.width/2,y:t.y+r.height/2}},transformScreenCoordToContext:function(e,t){var r=e.getDimension();return{x:t.x-r.width/2,y:t.y-r.height/2,z:0}},canModifyGraphic:function(e){return!0},colorStrToHex:function(t){return e.StyleUtils.colorStrToValue(t)},createGroup:function(e){var r=new t.Object3D;return r.__objGroup__=!0,e.getScene().add(r),r},addToGroup:function(e,t){return t.add(e),t},removeFromGroup:function(e,t){t.remove(e)},setClearColor:function(e,t){var r=e.getRenderer();r&&(r.setClearColorHex?t?e.getRenderer().setClearColorHex(this.colorStrToHex(t),1):e.getRenderer().setClearColorHex(null,0):r.setClearColor&&(t?e.getRenderer().setClearColor(this.colorStrToHex(t),1):e.getRenderer().setClearColor(null,0)))},clearContext:function(e){e.getScene().clearMesh(),this.renderContext(e)},renderContext:function(e){e.getRenderer().render(e.getScene(),e.getCamera())},drawSphere:function(e,r,i,n){var a=this._modelParams.sphereSegments,o=this._modelParams.sphereRings,s=this.geometryCache.get(t.SphereGeometry,e.getScene(),1,a,o),l=this.materialCache.get(t.MeshLambertMaterial,e.getScene(),{color:this.colorStrToHex(n.color),opacity:n.opacity||1}),d=new t.Mesh(s,l);return d.scale.x=i,d.scale.y=i,d.scale.z=i,d.position.x=r.x,d.position.y=r.y,d.position.z=r.z,e.getScene().add(d),d},drawLine:function(e,r,i,n){var a=(this.colorStrToHex(n.color),this.materialCache.get(t.LineBasicMaterial,e.getScene(),{color:this.colorStrToHex(n.color),opacity:n.opacity||1,linewidth:n.lineWidth||1})),o=new t.Geometry;o.vertices.push(new t.Vector3(r.x,r.y,r.z)),o.vertices.push(new t.Vector3(i.x,i.y,i.z));var s=new t.Line(o,a);return e.getScene().add(s),s},drawCylinder:function(r,i,n,a,o){var s=e.CoordUtils,l=this._modelParams.cylinderSegmentsRadius,d=s.getDistance(i,n),u=this.geometryCache.get(t.CylinderGeometry,r.getScene(),1,1,1,l,1,!0),c=this.materialCache.get(t.MeshLambertMaterial,r.getScene(),{color:this.colorStrToHex(o.color),opacity:o.opacity||1}),h=new t.Mesh(u,c);h.scale.y=d,h.scale.x=a,h.scale.z=a;var m=e.ObjUtils.isUnset(o.quaternion)?this._calcQuaternion(i,n):o.quaternion;return m&&(h.applyQuaternion?h.applyQuaternion(m):(h.useQuaternion=!0,h.quaternion=m,h.updateMatrix())),h.position.x=(i.x+n.x)/2,h.position.y=(i.y+n.y)/2,h.position.z=(i.z+n.z)/2,r.getScene().add(h),h},drawParallelCylinders:function(t,r,i){for(var n=(e.CoordUtils,r[0]),a=this._calcQuaternion(n.coord1,n.coord2),o=this.createGroup(t),s=0,l=r.length;s<l;++s){var d=r[s],u=this.drawCylinder(t,d.coord1,d.coord2,d.radius,{color:d.color,quaternion:a,opacity:d.opacity});this.addToGroup(u,o)}if(i)for(var c,s=0,l=r.length;s<l;++s){var d=r[s];c=e.ObjUtils.isUnset(d.jointCoordIndex)?[d.coord1,d.coord2]:1===d.jointCoordIndex?[d.coord2]:[d.coord1];for(var h=0,m=c.length;h<m;++h){var u=this.drawSphere(t,c[h],d.radius,{color:d.color,opacity:d.opacity});this.addToGroup(u,o)}}return o},removeDrawnElem:function(e,t){t.parent&&t.parent.remove&&t.parent.remove(t)},_calcQuaternion:function(r,i){var n=e.CoordUtils,a=n.substract(i,r);if(a.x||a.z){var o={x:a.z,y:0,z:-a.x};o=n.standardize(o);var s=Math.atan2(Math.sqrt(Math.sqr(a.x)+Math.sqr(a.z)),a.y),l=s/2,d=Math.cos(l),u=Math.sin(l);return new t.Quaternion(u*o.x,u*o.y,u*o.z,d)}return null},getLightCount:function(e){var t=e.getLights();return t?t.length||0:0},getLightProps:function(e,t){return{position:e.getLights()[t].position}},setLightProps:function(e,t,r){var i=e.getLights()[t],n=r.position;n&&(i.position.x=n.x,i.position.y=n.y,i.position.z=n.z),i.updateMatrix()},getCameraProps:function(e){var t=e.getCamera();return{position:t.position,fov:t.fov*Math.PI/180,aspect:t.aspect,left:t.left,right:t.right,top:t.top,bottom:t.bottom,lookAtVector:t.lookAtVector,upVector:t.up}},setCameraProps:function(r,i){var n=r.getCamera(),a=e.ObjUtils.notUnset,o=i.position;if(o&&(n.position.x=o.x,n.position.y=o.y,n.position.z=o.z),a(i.near)&&(n.near=i.near),a(i.far)&&(n.near=i.far),i.fov&&(n.fov=180*i.fov/Math.PI),i.aspect&&(n.aspect=i.aspect),a(i.left)&&(n.left=i.left),a(i.top)&&(n.top=i.top),a(i.bottom)&&(n.bottom=i.bottom),a(i.right)&&(n.right=i.right),a(i.upVector)){var s=i.upVector;n.up=new t.Vector3(s.x,s.y,s.z)}if(a(i.lookAtVector)){var s=i.lookAtVector;n.lookAt(new t.Vector3(s.x,s.y,s.z))}n.updateMatrix()},exportToDataUri:function(e,r,i){if(e.getRenderer()instanceof t.SVGRenderer){var n=e.getRenderer().domElement,o=a.XmlUtility.serializeNode(n);return"data:image/svg+xml;base64,"+btoa(o)}var n=e.getRenderer().domElement;return n?n.toDataURL(r,i):null}}),e.Render.ThreeRendererBridge.isSupported=function(){var t=void 0!==e.$jsRoot.THREE;if(t){var r=e.BrowserFeature;t=r.webgl||r.canvas||r.svg}return!!t},e.Render.DrawBridge3DMananger.register(e.Render.ThreeRendererBridge,20),e}},function(e,t,r){"use strict";var i=r(0).Class,n=(r(0).ClassEx,r(0).ObjectEx),a=r(0).DataType;e.exports=function(e){return e.Render.ChemObjPainter=i.create(n,{CLASS_NAME:"Kekule.Render.ChemObjPainter",initialize:function($super,t,r,i,n){$super();var a=t||e.Render.RendererType.R2D;this.setPropStoreFieldValue("renderType",a),this.setPropStoreFieldValue("chemObj",r),this.setPropStoreFieldValue("drawBridge",i||(a===e.Render.RendererType.R3D?e.Render.DrawBridge3DMananger.getPreferredBridgeInstance():e.Render.DrawBridge2DMananger.getPreferredBridgeInstance())),n&&this.setPropStoreFieldValue("renderConfigs",n)},finalize:function($super){this.getRenderer()&&this.getRenderer().finalize(),$super()},initProperties:function(){this.defineProp("renderType",{dataType:a.INT,serializable:!1,setter:null}),this.defineProp("chemObj",{dataType:"Kekule.ChemObject",serializable:!1,setter:null}),this.defineProp("drawBridge",{dataType:a.OBJECT,serializable:!1,setter:null}),this.defineProp("renderConfigs",{dataType:a.OBJECT,serializable:!1,getter:function(){var t=this.getPropStoreFieldValue("renderConfigs");return t||(t=this.getRenderType()===e.Render.RendererType.R3D?e.Render.Render3DConfigs.getInstance():e.Render.Render2DConfigs.getInstance()),t}}),this.defineProp("renderer",{dateType:"Kekule.Render.AbstractRenderer",serializable:!1,setter:null}),this.defineProp("canModifyTargetObj",{dataType:a.BOOL}),this.defineProp("boundInfoRecorder",{dataType:"Kekule.Render.BoundInfoRecorder",serializable:!1,setter:null,getter:function(){var e=this.getRenderer();return e&&e.getBoundInfoRecorder()}})},getDrawOptionFromConfigs:function(t){return e.Render.RenderOptionUtils.convertConfigsToPlainHash(t)},prepareRenderer:function(){if(this.getRenderer())return this.getRenderer();var t=this.getRenderType()===e.Render.RendererType.R3D?e.Render.get3DRendererClass:e.Render.get2DRendererClass,r=t(this.getChemObj());if(r){var i=new r(this.getChemObj(),this.getDrawBridge(),this);return this.setPropStoreFieldValue("renderer",i),i}return e.error(e.$L("ErrorMsg.CANNOT_FIND_SUITABLE_RENDERER_FOR_OBJ")),null},createContext:function(e,t,r){return this.getDrawBridge().createContext(e,t,r)},_convertContextBoxToScreen:function(t,r){if(!r)return{};var i=this.getDrawBridge(),n=i.transformContextCoordToScreen(t,{x:r.x1,y:r.y1}),a=i.transformContextCoordToScreen(t,{x:r.x2,y:r.y2});return e.BoxUtils.createBox(n,a)},estimateObjBox:function(e,t,r){this._generateDrawOptions(t);return this.prepareRenderer(),this.getRenderer().estimateObjBox(e,t,r)},estimateRenderBox:function(e,t,r,i){var n=this._generateDrawOptions(r);return this.prepareRenderer(),this.getRenderer().estimateRenderBox(e,t,n,i)},estimateScreenBox:function(e,t,r,i){var n=this.estimateRenderBox(e,t,r,i);return n?this._convertContextBoxToScreen(e,n):null},_generateDrawOptions:function(e){var t=this.getRenderConfigs(),r=t?this.getDrawOptionFromConfigs(t):{};return r=Object.extend(r,e)},draw:function(e,t,r){this.prepareRenderer();var i=this._generateDrawOptions(r);return this.getRenderer().draw(e,t,i)},redraw:function(e){return this.getRenderer().redraw(e)},getActualRenderTransformParams:function(e){var t=this.getRenderer();return t?t.getRenderFinalTransformParams(e):null},getActualInitialRenderTransformOptions:function(e){var t=this.getRenderer();return t?t.getRenderInitialTransformOptions(e):null},changeGeometryOptions:function(e,t,r){var i=this.getRenderer();if(i&&i.changeGeometryOptions){var n=this._generateDrawOptions(r);return i.changeGeometryOptions(e,t,n)}return this.clearContext(e),this.draw(e,t,r)},supportGeometryOptionChange:function(){var e=this.getRenderer();return e&&e.changeGeometryOptions},beginUpdatePainter:function(){return this.getRenderer().beginUpdateRenderer()},endUpdatePainter:function(){return this.getRenderer().endUpdateRenderer()},update:function(e,t,r){return this.getRenderer().update(e,t,r)},addNew:function(e,t){return this.getRenderer().addNew(e,t)},modify:function(e,t){return this.getRenderer().modify(e,t)},remove:function(e,t){return this.getRenderer().remove(e,t)},clear:function(e){var t=this.getRenderer();return t&&t.clear(e),this},clearContext:function(e){return this.getDrawBridge().clearContext(e)}}),e.Render.ChemObjPainter2D=i.create(e.Render.ChemObjPainter,{CLASS_NAME:"Kekule.Render.ChemObjPainter2D",initialize:function($super,t,r,i){$super(e.Render.RendererType.R2D,t,r,i)}}),e.Render.ChemObjPainter3D=i.create(e.Render.ChemObjPainter,{CLASS_NAME:"Kekule.Render.ChemObjPainter3D",initialize:function($super,t,r,i){$super(e.Render.RendererType.R3D,t,r,i)}}),e}},function(e,t,r){"use strict";var i=r(0).Class,n=(r(0).ClassEx,r(0).ObjectEx),a=r(0).DataType;e.exports=function(e){return e.Operation=i.create(n,{CLASS_NAME:"Kekule.Operation",initialize:function($super){$super()},initProperties:function(){},isReversible:function(){return!0},execute:function(){return this.doExecute()},doExecute:function(){},reverse:function(){return this.isReversible()||e.raise(e.$L("ErrorMsg.COMMAND_NOT_REVERSIBLE")),this.doReverse()},doReverse:function(){}}),e.Operation.State={UNEXECUTED:0,EXECUTED:1},e.MacroOperation=i.create(e.Operation,{CLASS_NAME:"Kekule.MacroOperation",initialize:function($super,e){$super(),this.setChildren(e||[])},initProperties:function(){this.defineProp("children",{dataType:a.ARRAY})},isReversible:function(){for(var e=this.getChildren(),t=0,r=e.length;t<r;++t)if(!e[t].isReversible())return!1;return!0},doExecute:function(){for(var e=this.getChildren(),t=0,r=e.length;t<r;++t)e[t].execute()},doReverse:function(){for(var e=this.getChildren(),t=e.length-1;t>=0;--t)e[t].reverse()},add:function(e){return this.getChildren().push(e)},remove:function(e){var t=this.getChildren(),r=t.indexOf(e);return r>=0?t.splice(r,1):null},getChildAt:function(e){return this.getChildren()[e]},getChildCount:function(){return this.getChildren().length}}),e.OperationHistory=i.create(n,{CLASS_NAME:"Kekule.OperationHistory",initialize:function($super,e){$super(),this.setCapacity(e||null)},initProperties:function(){this.defineProp("capacity",{dataType:a.INT}),this.defineProp("operations",{dataType:a.ARRAY,getter:function(){var e=this.getPropStoreFieldValue("operations");return e||(e=[],this.setPropStoreFieldValue("operations",e)),e}}),this.defineProp("currIndex",{dataType:a.INT,serializable:!1}),this.defineEvent("push"),this.defineEvent("pop"),this.defineEvent("undo"),this.defineEvent("redo")},checkCapacity:function(){var e=this.getCapacity();if(e&&!(e<=0))for(var t=this.getPropStoreFieldValue("operations");t&&t.length>e;)t.shift(),this.getCurrIndex()>0&&this.setCurrIndex(this.getCurrIndex()-1)},getOperationCount:function(){return this.getOperations().length},getOperationAt:function(e){return this.getOperations()[e]},getCurrOperation:function(){var e=this.getCurrIndex();return e>=0?this.getOperations()[e]:null},clear:function(){this.setOperations([]),this.setCurrIndex(-1),this.invokeEvent("clear",{currOperIndex:this.getCurrIndex()}),this.invokeEvent("operChange")},push:function(e){var t=this.getOperations(),r=this.getCurrIndex();r<t.length&&t.splice(r+1,t.length-r-1),t.push(e),this.setCurrIndex(t.length-1),this.checkCapacity(),this.invokeEvent("push",{operation:e,currOperIndex:this.getCurrIndex()}),this.invokeEvent("operChange")},pop:function(){var e,t=this.getCurrIndex();return this.canPop()?(e=this.getOperations()[t],this.setCurrIndex(--t),this.invokeEvent("pop",{operation:e,currOperIndex:this.getCurrIndex()}),this.invokeEvent("operChange")):e=null,e},canPop:function(){return this.getCurrIndex()>=0&&!!this.getOperations().length},unpop:function(){var e,t=this.getCurrIndex();this.getOperations();return this.canUnpop()?(this.setCurrIndex(++t),e=this.getOperations()[t]):e=null,e},canUnpop:function(){return this.getCurrIndex()<this.getOperations().length-1},replaceOperation:function(e,t){var r=this.getOperations(),i=r.lastIndexOf(e);return i>=0?(console.log("replace operation",i===r.length-1),r.splice(i,1,t)):null},undo:function(){var e=this.pop();return e&&e.isReversible()&&e.reverse(),this.invokeEvent("undo",{operation:e,currOperIndex:this.getCurrIndex()}),this.invokeEvent("operChange"),e},undoAll:function(){for(;this.canUndo;)this.undo()},canUndo:function(){return this.canPop()},redo:function(){var e=this.unpop();return e&&e.execute(),this.invokeEvent("redo",{operation:e,currOperIndex:this.getCurrIndex()}),this.invokeEvent("operChange"),e},canRedo:function(){return this.canUnpop()}}),e}},function(e,t,r){"use strict";var i=r(0).Class,n=r(0).ClassEx,a=r(0).ObjectEx,o=r(0).DataType;e.exports=function(e){e.Action=i.create(a,{CLASS_NAME:"Kekule.Action",HTML_CLASSNAME:null,initialize:function($super){$super(),this.setPropStoreFieldValue("linkedWidgets",[]),this.setPropStoreFieldValue("enabled",!0),this.setPropStoreFieldValue("visible",!0),this.setPropStoreFieldValue("displayed",!0),this.setPropStoreFieldValue("htmlClassName",this.getInitialHtmlClassName()),this.setBubbleEvent(!0),this.reactWidgetExecuteBind=this.reactWidgetExecute.bind(this)},finalize:function($super){var e=this.getOwner();e&&e.actionRemoved&&e.actionRemoved(this),this.unlinkAllWidgets(),this.setPropStoreFieldValue("linkedWidgets",[]),$super()},initProperties:function(){this.defineProp("enabled",{dataType:o.BOOL,setter:function(e){e!==this.getEnabled()&&(this.setPropStoreFieldValue("enabled",e),this.updateAllWidgetsProp("enabled",e))}}),this.defineProp("visible",{dataType:o.BOOL,setter:function(e){e!==this.getVisible()&&(this.setPropStoreFieldValue("visible",e),this.updateAllWidgetsProp("visible",e))}}),this.defineProp("displayed",{dataType:o.BOOL,setter:function(e){e!==this.getDisplayed()&&(this.setPropStoreFieldValue("displayed",e),this.updateAllWidgetsProp("displayed",e))}}),this.defineProp("checked",{dataType:o.BOOL,setter:function(e){e!==this.getChecked()&&(this.setPropStoreFieldValue("checked",e),this.updateAllWidgetsProp("checked",e),this.checkedChanged())}}),this.defineProp("checkGroup",{dataType:o.STRING}),this.defineProp("hint",{dataType:o.STRING,setter:function(e){e&&e!==this.getHint()&&(this.setPropStoreFieldValue("hint",e),this.updateAllWidgetsProp("hint",e))}}),this.defineProp("text",{dataType:o.STRING,setter:function(e){e&&e!==this.getText()&&(this.setPropStoreFieldValue("text",e),this.updateAllWidgetsProp("text",e))}}),this.defineProp("htmlClassName",{dataType:o.STRING,setter:function(e){var t=this.getHtmlClassName();this.setPropStoreFieldValue("htmlClassName",e),this.updateAllWidgetClassName(e,t)}}),this.defineProp("owner",{dataType:o.OBJECT,serializable:!1,setter:null}),this.defineProp("linkedWidgets",{dataType:o.ARRAY,serializable:!1,setter:null}),this.defineProp("invoker",{dataType:"Kekule.Widget.BaseWidget",serializable:!1,setter:null})},getHigherLevelObj:function(){return this.getOwner()},invokeEvent:function($super,e,t){t||(t={}),t.invoker||(t.invoker=this.getInvoker()),$super(e,t)},getInitialHtmlClassName:function(){return this.HTML_CLASSNAME||null},getActionList:function(){var t=this.getOwner();return t instanceof e.ActionList?t:null},checkedChanged:function(){var e=this.getActionList();e&&e.actionCheckedChanged(this)},linkWidget:function(e){var t=this.getLinkedWidgets();if(t.indexOf(e)<0){var r=this.getText();r&&this.updateWidgetProp(e,"text",r);var i=this.getHint();return i&&this.updateWidgetProp(e,"hint",i),this.updateWidgetProp(e,"enabled",this.getEnabled()),this.updateWidgetProp(e,"displayed",this.getDisplayed()),this.updateWidgetProp(e,"visible",this.getVisible()),this.updateWidgetProp(e,"checked",this.getChecked()),this.updateWidgetClassName(e,this.getHtmlClassName(),null),e.addEventListener("execute",this.reactWidgetExecuteBind),t.push(e),this}},unlinkWidget:function(e){var t=this.getLinkedWidgets(),r=t.indexOf(e);r>=0&&(this.updateWidgetClassName(e,null,this.getHtmlClassName()),e.removeEventListener("execute",this.reactWidgetExecuteBind),t.splice(r,1))},unlinkAllWidgets:function(){for(var e=this.getLinkedWidgets(),t=e.length-1;t>=0;--t)this.unlinkWidget(e[t])},reactWidgetExecute:function(e){return this.execute(e.target,e.htmlEvent)},execute:function(e,t){var r=this.getChecked();return this.getCheckGroup()&&r||(this.doExecute(e,t),this.getCheckGroup()&&this.setChecked(!0)),this.setPropStoreFieldValue("invoker",e),this.invokeEvent("execute",{htmlEvent:t}),this},doExecute:function(e,t){},update:function(){return this.doUpdate(),this},doUpdate:function(){},updateAllWidgetsProp:function(e,t){for(var r=this.getLinkedWidgets(),i=0,n=r.length;i<n;++i){var a=r[i];this.updateWidgetProp(a,e,t)}},updateWidgetProp:function(e,t,r){e.hasProperty(t)&&e.setPropValue(t,r)},updateWidgetClassName:function(e,t,r){r&&e.removeClassName(r,!0),t&&e.addClassName(t,!0)},updateAllWidgetClassName:function(e,t){for(var r=this.getLinkedWidgets(),i=0,n=r.length;i<n;++i){var a=r[i];this.updateWidgetClassName(a,e,t)}}}),e.ActionList=i.create(a,{CLASS_NAME:"Kekule.ActionList",initialize:function($super){$super(),this.setPropStoreFieldValue("actions",[]),this.setPropStoreFieldValue("ownActions",!0),this.setPropStoreFieldValue("autoUpdate",!0),this.reactActionExecutedBind=this.reactActionExecuted.bind(this),this.addEventListener("execute",this.reactActionExecutedBind)},finalize:function($super){this.removeEventListener("execute",this.reactActionExecutedBind),this.clear(),this.setPropStoreFieldValue("actions",null),$super()},initProperties:function(){this.defineProp("actions",{dataType:o.ARRAY,serializable:!1,setter:null}),this.defineProp("ownActions",{dataType:o.BOOL}),this.defineProp("autoUpdate",{dataType:o.BOOL,setter:function(e){this.setPropStoreFieldValue("autoUpdate",e),e&&this.updateAll()}})},hasActionChecked:function(e){return!!this.getCheckedAction(e)},getCheckedAction:function(e){for(var t=this.getActions(),r=0,i=t.length;r<i;++r){var n=t[r];if(n.getCheckGroup()===e&&n.getChecked())return n}return null},actionAdded:function(t){if(this.getOwnActions()){var r=t.getOwner();r&&r.actionRemoved&&r.actionRemoved(t),t.setPropStoreFieldValue("owner",this)}e.ArrayUtils.pushUnique(this.getActions(),t),t.update()},actionRemoved:function(t){e.ArrayUtils.remove(this.getActions(),t),t.setPropStoreFieldValue("owner",null)},actionCheckedChanged:function(e){if(e&&e.getChecked()){var t=e.getCheckGroup();if(t)for(var r=this.getActions(),i=0,n=r.length;i<n;++i){var a=r[i];a!==e&&a.getCheckGroup()===t&&a.getChecked()&&a.setChecked(!1)}}},reactActionExecuted:function(t){t.target instanceof e.Action&&(this.invokeEvent("execute",{action:t.target}),this.getAutoUpdate()&&this.updateAll())},getActionCount:function(){return this.getActions().length},getActionLength:function(){return this.getActions().length},getActionAt:function(e){return this.getActions()[e]},indexOfAction:function(e){return this.getActions().indexOf(e)},setActionIndex:function(e,t){var r=this.getActions();if(r){var i=r.indexOf(e);i>=0&&i!==t&&(r.splice(i,1),r.splice(t,0,e))}return this},hasAction:function(e){return this.indexOfAction(e)>=0},add:function(e){return this.actionAdded(e),this},remove:function(e){return this.actionRemoved(e),this.getOwnActions()&&e.finalize(),this},removeAt:function(t){var r=this.getActions(),i=r[t];return i&&(e.ArrayUtils.removeAt(r,t),this.actionRemoved(i)),this},clear:function(){for(var e=this.getActions(),t=e.length-1;t>=0;--t)this.actionRemoved(e[t]);return this.setPropStoreFieldValue("actions",[]),this},updateAll:function(){for(var e=this.getActions(),t=0,r=e.length;t<r;++t)e[t].update();return this}}),e.ActionFileOpen=i.create(e.Action,{CLASS_NAME:"Kekule.ChemWidget.ActionFileOpen",initialize:function($super){$super()},initProperties:function(){this.defineProp("filters",{dataType:o.ARRAY})},doUpdate:function($super){$super(),this.setEnabled(this.getEnabled()&&e.NativeServices.showFilePickerDialog)},doExecute:function(e){var t=e.getElement(),r=t.ownerDocument,i=this,n=this.getInvoker();this.openFilePicker(r,function(e,t,r){e&&i.fileOpened(r,n)})},openFilePicker:function(t,r){return e.NativeServices.showFilePickerDialog(t,r,{mode:"open",filters:this.getFilters()})},fileOpened:function(e,t){this.doFileOpened(e,t),this.invokeEvent("open",{files:e,file:e[0]})},doFileOpened:function(e,t){}}),e.ActionLoadFileData=i.create(e.Action,{CLASS_NAME:"Kekule.ChemWidget.ActionLoadFileData",initialize:function($super){$super()},initProperties:function(){this.defineProp("filters",{dataType:o.ARRAY}),this.defineProp("binaryDetector",{dataType:o.FUNCTION,serializable:!1})},doUpdate:function($super){$super(),this.setEnabled(this.getEnabled()&&e.NativeServices.canLoadFileData())},doExecute:function(e){var t=e.getElement(),r=t.ownerDocument,i=this,n=this.getInvoker();this.loadFileData(r,function(e,t,r){i.dataLoaded(t,r,!!e,n)})},loadFileData:function(t,r){return e.NativeServices.loadFileData(t,r,{filters:this.getFilters(),binaryDetector:this.getBinaryDetector()})},reactFileLoad:function(e,t,r){this.dataLoaded(t,r,!!e)},dataLoaded:function(e,t,r,i){this.doDataLoaded(e,t,r,i),this.invokeEvent("load",{fileName:t,data:e,success:r})},doDataLoaded:function(e,t,r,i){}}),e.ActionFileSave=i.create(e.Action,{CLASS_NAME:"Kekule.ChemWidget.ActionFileSave",initialize:function($super,e,t){$super(),e&&this.setData(e),t&&this.setFileName(t)},initProperties:function(){this.defineProp("data",{dataType:o.STRING,serializable:!1}),this.defineProp("fileName",{dataType:o.STRING,serializable:!1}),this.defineProp("filters",{dataType:o.ARRAY})},doUpdate:function($super){$super(),this.setEnabled(this.getEnabled()&&e.NativeServices.canSaveFileData())},doExecute:function(t){var r;if(t){r=t.getElement().ownerDocument}else r=document;e.NativeServices.saveFileData(r,this.getData(),null,{initialFileName:this.getFileName(),filters:this.getFilters()})}}),e.ActionManager={_namedActionMap:null,_getNamedActionMap:function(r){var i=t._namedActionMap;return!i&&r&&(i=new e.MapEx,t._namedActionMap=i),i},getRegisteredActionsOfClass:function(e,r){var i=t._getNamedActionMap(r);if(i){var n=i.get(e);return!n&&r&&(n={},i.set(e,n)),n}return null},registerNamedActionClass:function(e,r,i){t.getRegisteredActionsOfClass(i,!0)[e]=r},unregisterNamedActionClass:function(e,r){var i=t.getRegisteredActionsOfClass(r,!1);i&&i[e]&&delete i[e]},getActionClassOfName:function(e,r,i){var a=n.isClass(r)?r:r.getClass&&r.getClass();if(!a)return null;var o=t.getRegisteredActionsOfClass(a,!1),s=o&&o[e];if(!s&&i){var l=n.getSuperClass(a);s=l?t.getActionClassOfName(e,l,i):null}return s}};var t=e.ActionManager;return e}},function(e,t,r){"use strict";var i=r(0).Class,n=r(0).ClassEx,a=r(0).ObjectEx,o=r(0).DataType;e.exports=function(e){return e.DataBingItem=i.create(a,{CLASS_NAME:"Kekule.DataBingItem",initialize:function($super,e,t,r,i){$super(),this.setSource(e),this.setSourceName(t),this.setTarget(r),this.setTargetName(i)},initProperties:function(){this.defineProp("source",{dataType:o.OBJECTEX,serializable:!1}),this.defineProp("sourceName",{dataType:o.STRING,serializable:!1}),this.defineProp("target",{dataType:o.OBJECTEX,serializable:!1}),this.defineProp("targetName",{dataType:o.STRING,serializable:!1})},updateData:function(e){var t=this.getSource(),r=this.getTarget(),i=this.getSourceName(),n=this.getTargetName();if(t&&r&&i&&n)if(e){var a=r.getDataByBindingName(n);t.setDataByBindingName(i,a)}else{var a=t.getDataByBindingName(i);r.setDataByBindingName(n,a)}}}),n.extend(a,{getDataByBindingName:function(e){return this.hasProperty(e)?this.getPropValue(e):o.isFunctionValue(this[e])?this[e]():void 0},setDataByBindingName:function(e,t){var r=t,i=this.getPropInfo(e);if(i){var n=i.dataType,a=o.getType(t);n!==a&&a===o.STRING&&(r=o.StringUtils.deserializeValue(t))}return this.setPropValue(e,r),this},createDataBinding:function(t,r,i){var n=new e.DataBingItem(t,r,this,i);return this.getDataBindings(!0).push(n),n},removeDataBinding:function(t){e.ArrayUtils.remove(this.getDataBindings(),t)},updateBindingData:function(e){var t=this.getDataBindings();if(t&&t.length)for(var r=0,i=t.length;r<i;++r)t[r].updateData(e)}}),n.defineProp(a,"dataBindings",{dataType:o.ARRAY,scope:i.PropertyScope.PRIVATE,getter:function(e){var t=this.getPropStoreFieldValue("dataBindings");return!t&&e&&(t=[],this.setPropStoreFieldValue("dataBindings",t)),t}}),e}},function(e,t,r){"use strict";var i=r(0).Class,n=r(0).ClassEx,a=r(0).ObjectEx,o=r(0).DataType;r(2).ObjSerializerFactory;e.exports=function(e){var t=e.$document&&Object.keys(e.$document).length?r(95):{},s=e.ArrayUtils,l=e.HtmlElementUtils;e.Widget={DEF_EVENT_HANDLER_PREFIX:"react_",getEventHandleFuncName:function(t){return e.Widget.DEF_EVENT_HANDLER_PREFIX+t},getTouchGestureHandleFuncName:function(t){return e.Widget.DEF_EVENT_HANDLER_PREFIX+t}},e.Widget.HtmlTagNames={CHILD_SLOT_HOLDER:"slot",CHILD_HOLDER:"span"},e.Widget.HtmlNames={CHILD_HOLDER:"children"},e.Widget.HtmlClassNames={BASE:"K-Widget",DYN_CREATED:"K-Dynamic-Created",CHILD_HOLDER:"K-Child-Holder",TOP_LAYER:"K-Top-Layer",ISOLATED_LAYER:"K-Isolated-Layer",NORMAL_BACKGROUND:"K-Normal-Background",NONSELECTABLE:"K-NonSelectable",SELECTABLE:"K-Selectable",STATE_NORMAL:"K-State-Normal",STATE_DISABLED:"K-State-Disabled",STATE_HOVER:"K-State-Hover",STATE_ACTIVE:"K-State-Active",STATE_FOCUSED:"K-State-Focused",STATE_SELECTED:"K-State-Selected",STATE_CHECKED:"K-State-Checked",SHOW_POPUP:"K-Show-Popup",SHOW_DIALOG:"K-Show-Dialog",SHOW_ACTIVE_MODAL:"K-Show-ActiveModal",SECTION:"K-Section",PART_CONTENT:"K-Content",PART_TEXT_CONTENT:"K-Text-Content",PART_ASSOC_TEXT_CONTENT:"K-Assoc-Text-Content",PART_IMG_CONTENT:"K-Img-Content",PART_GLYPH_CONTENT:"K-Glyph-Content",PART_PRI_GLYPH_CONTENT:"K-Pri-Glyph-Content",PART_ASSOC_GLYPH_CONTENT:"K-Assoc-Glyph-Content",PART_DECORATION_CONTENT:"K-Decoration-Content",PART_ERROR_REPORT:"K-Error-Report",FIRST_CHILD:"K-First-Child",LAST_CHILD:"K-Last-Child",TEXT_NO_WRAP:"K-No-Wrap",LAYOUT_H:"K-Layout-H",LAYOUT_V:"K-Layout-V",CORNER_ALL:"K-Corner-All",CORNER_LEFT:"K-Corner-Left",CORNER_RIGHT:"K-Corner-Right",CORNER_TOP:"K-Corner-Top",CORNER_BOTTOM:"K-Corner-Bottom",CORNER_TL:"K-Corner-TL",CORNER_TR:"K-Corner-TR",CORNER_BL:"K-Corner-BL",CORNER_BR:"K-Corner-BR",CORNER_LEADING:"K-Corner-Leading",CORNER_TAILING:"K-Corner-Tailing",FULLFILL:"K-Fulfill",NOWRAP:"K-No-Wrap",HIDE_TEXT:"K-Text-Hide",HIDE_GLYPH:"K-Glyph-Hide",SHOW_TEXT:"K-Text-Show",SHOW_GLYPH:"K-Glyph-Show",MODAL_BACKGROUND:"K-Modal-Background",DUMB_WIDGET:"K-Dumb-Widget",PLACEHOLDER:"K-PlaceHolder"};var d=e.Widget.HtmlClassNames;e.Widget.Layout={HORIZONTAL:1,VERTICAL:2},e.Widget.Position={AUTO:0,TOP:1,LEFT:2,BOTTOM:4,RIGHT:8,TOP_LEFT:3,TOP_RIGHT:9,BOTTOM_LEFT:6,BOTTOM_RIGHT:12},e.Widget.Direction={AUTO:0,LTR:1,TTB:2,RTL:4,BTT:8,isInHorizontal:function(t){var r=e.Widget.Direction;return!!(t&r.LTR||t&r.RTL)},isInVertical:function(t){var r=e.Widget.Direction;return!!(t&r.TTB||t&r.BTT)}},e.Widget.State={NORMAL:0,FOCUSED:1,HOVER:2,ACTIVE:3,DISABLED:-1};var u=e.Widget.State;e.Widget.ShowHideType={DROPDOWN:1,POPUP:2,DIALOG:3,DEFAULT:0},e.Widget.DragDrop={ELEM_INDEX_DATA_TYPE:"application/x-kekule-dragdrop-elem-index"},e.Widget.UiEvents=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","keydown","keyup","keypress","touchstart","touchend","touchcancel","touchmove","pointerdown","pointermove","pointerout","pointerover","pointerup","drag","dragend","dragenter","dragexit","dragleave","dragover","dragstart","drop"],e.Widget.UiLocalEvents=["blur","focus","mouseenter","mouseleave","mousewheel","pointerenter","pointerleave"],e.Widget.TouchGestures=["hold","tap","doubletap","swipe","swipeup","swipedown","swipeleft","swiperight","transform","transformstart","transformend","rotate","rotatestart","rotatemove","rotateend","rotatecancel","pinch","pinchstart","pinchmove","pinchend","pinchcancel","pinchin","pinchout","pan","panstart","panmove","panend","pancancel","panleft","panright","panup","pandown"],e.Widget._PointerHoldParams={DURATION_THRESHOLD:1e3,MOVEMENT_THRESHOLD:10};return e.Widget.BaseWidget=i.create(a,{CLASS_NAME:"Kekule.Widget.BaseWidget",BINDABLE_TAG_NAMES:null,DEF_PERIODICAL_EXEC_DELAY:500,DEF_PERIODICAL_EXEC_INTERVAL:100,STYLE_RES_FIELD:"__$style_resources__",initialize:function($super,t,r){this._stateClassName=null,this._isDismissed=!1,this._pendingHtmlClassNames="",this._enableShowHideEvents=!0,this._reactElemAttribMutationBind=this._reactElemAttribMutation.bind(this),this.reactTouchGestureBind=this.reactTouchGesture.bind(this),this.setPropStoreFieldValue("inheritEnabled",!0),this.setPropStoreFieldValue("inheritStatic",!0),this.setPropStoreFieldValue("selfEnabled",!0),this.setPropStoreFieldValue("selfStatic",!1),this.setPropStoreFieldValue("periodicalExecDelay",this.DEF_PERIODICAL_EXEC_DELAY),this.setPropStoreFieldValue("periodicalExecInterval",this.DEF_PERIODICAL_EXEC_INTERVAL),this.setPropStoreFieldValue("useNormalBackground",!0),this.setPropStoreFieldValue("droppableDataKinds",["string"]),this._touchActionNoneTouchStartHandlerBind=this._touchActionNoneTouchStartHandler.bind(this),$super(),this.setPropStoreFieldValue("isDumb",!!r),r||(this.reactUiEventBind=this.reactUiEvent.bind(this)),t&&(t instanceof e.Widget.BaseWidget?(this.setDocument(t.getDocument()),this.createElement(),this.setParent(t)):t.documentElement?(this.setDocument(t),this.createElement()):(this.setDocument(t.ownerDocument),this.setElement(t))),this._stateClassName=null,this._layoutClassName=null,this.getLayout()||this.setLayout(e.Widget.Layout.HORIZONTAL),this._periodicalExecBind=this._periodicalExec.bind(this),this.setBubbleEvent(!0),this.setInheritBubbleUiEvents(!0),this.stateChanged();var i=this.getGlobalManager();i&&i.notifyWidgetCreated(this)},initProperties:function(){this.defineProp("isDumb",{dataType:o.BOOL,serializable:!1,scope:i.PropertyScope.PUBLIC,setter:function(e){if(this.getIsDumb()!=e){this.setPropStoreFieldValue("isDumb",e);var t=this.getElement();t&&(e?this.uninstallUiEventHandlers(t):this.installUiEventHandlers(t))}}}),this.defineProp("bubbleUiEvents",{dataType:o.BOOL,scope:i.PropertyScope.PUBLIC}),this.defineProp("inheritBubbleUiEvents",{dataType:o.BOOL,scope:i.PropertyScope.PUBLIC}),this.defineProp("touchAction",{dataType:o.STRING,scope:i.PropertyScope.PUBLIC,setter:function(t){var r=this.getCoreElement();r&&(r.style.touchAction=t,"none"===t?e.X.Event.addListener(r,"touchstart",this._touchActionNoneTouchStartHandlerBind,{passive:!1}):e.X.Event.removeListener(r,"touchstart",this._touchActionNoneTouchStartHandlerBind,{passive:!1}))}}),this.defineProp("parent",{dataType:"Kekule.Widget.BaseWidget",serializable:!1,scope:i.PropertyScope.PUBLISHED,setter:function(e){var t=this.getParent();t&&t._removeChild(this),e&&e._addChild(this),this.setPropStoreFieldValue("parent",e)}}),this.defineProp("childWidgets",{dataType:o.ARRAY,serializable:!1,setter:null,scope:i.PropertyScope.PUBLIC,getter:function(){var e=this.getPropStoreFieldValue("childWidgets");return e||(e=[],this.setPropStoreFieldValue("childWidgets",e)),e}}),this.defineProp("document",{dataType:o.OBJECT,serializable:!1,scope:i.PropertyScope.PUBLIC}),this.defineProp("element",{dataType:o.OBJECT,serializable:!1,scope:i.PropertyScope.PUBLIC,setter:function(e){var t=this.getElement();e!==t&&(this.setPropStoreFieldValue("element",e),this.elementChanged(e,t))}}),this.defineProp("observeElementAttribChanges",{dataType:o.BOOL,setter:function(e){!!e!=!!this.getObserveElementAttribChanges()&&(this.setPropStoreFieldValue("observeElementAttribChanges",e),this.observeElementAttribChangesChanged(!!e))}}),this.defineElemAttribMappingProp("id","id"),this.defineProp("draggable",{dataType:o.BOOL,serializable:!1,scope:i.PropertyScope.PUBLIC,getter:function(){return e.StrUtils.strToBool(this.getElement().getAttribute("draggable")||"")},setter:function(e){this.getElement().setAttribute("draggable",e?"true":"false")}}),this.defineProp("droppable",{dataType:o.BOOL,scope:i.PropertyScope.PUBLIC}),this.defineProp("droppableDataKinds",{dataType:o.ARRAY,scope:i.PropertyScope.PUBLIC}),this.defineProp("fileDroppable",{dataType:o.ARRAY,serializable:!1,scope:i.PropertyScope.PUBLIC,getter:function(){if(!this.getDroppable())return!1;var e=this.getDroppableDataKinds();return!e||e&&e.indexOf&&e.indexOf("file")>=0},setter:function(e){e&&!this.getDroppable()&&this.setDroppable(!0);var t=this.getPropStoreFieldValue("droppableDataKinds");if(t){var r=t.indexOf("file");!e&&r>=0?t.splice(r,1):e&&r<0&&t.push("file")}else e||this.setDroppableDataKinds(["string"])}}),this.defineElemStyleMappingProp("width","width"),this.defineElemStyleMappingProp("height","height"),this.defineProp("offsetParent",{dataType:o.OBJECT,serializable:!1,scope:i.PropertyScope.PUBLIC,getter:function(){return this.getElement().offsetParent},setter:null}),this.defineProp("offsetLeft",{dataType:o.INT,serializable:!1,getter:function(){return this.getElement().offsetLeft},setter:null}),this.defineProp("offsetTop",{dataType:o.INT,serializable:!1,getter:function(){return this.getElement().offsetTop},setter:null}),this.defineProp("offsetWidth",{dataType:o.INT,serializable:!1,getter:function(){return this.getElement().offsetWidth},setter:null}),this.defineProp("offsetHeight",{dataType:o.INT,serializable:!1,getter:function(){return this.getElement().offsetHeight},setter:null}),this.defineProp("innerHTML",{dataType:o.STRING,serializable:!1,scope:i.PropertyScope.PUBLIC,getter:function(){return this.getElement().innerHTML},setter:function(e){this.getElement().innerHTML=e}}),this.defineProp("style",{dataType:o.OBJECT,serializable:!1,scope:i.PropertyScope.PUBLIC,getter:function(){return this.getElement().style},setter:null}),this.defineProp("cssText",{dataType:o.STRING,serializable:!1,scope:i.PropertyScope.PUBLIC,getter:function(){return this.getElement().style.cssText},setter:function(e){this.getElement().style.cssText=e}}),this.defineProp("htmlClassName",{dataType:o.STRING,serializable:!1,scope:i.PropertyScope.PUBLIC,getter:function(){return this.getElement().className},setter:function(e){this.getElement().className=e}}),this.defineProp("customHtmlClassName",{dataType:o.STRING,scope:i.PropertyScope.PUBLIC,setter:function(e){var t=this.getElement(),r=this.getCustomHtmlClassName();t&&r!==e&&(r&&l.removeClass(t,r),e&&l.addClass(t,e),this.setPropStoreFieldValue("customHtmlClassName",e))}}),this.defineProp("visible",{dataType:o.BOOL,serializable:!1,getter:function(){return e.StyleUtils.isVisible(this.getElement())},setter:function(t,r){e.StyleUtils.setVisibility(this.getElement(),t),r||this.widgetShowStateChanged(this.isShown())}}),this.defineProp("displayed",{dataType:o.BOOL,serializable:!1,getter:function(){return e.StyleUtils.isDisplayed(this.getElement())},setter:function(t,r){e.StyleUtils.setDisplay(this.getElement(),t),r||this.widgetShowStateChanged(this.isShown())}}),this.defineProp("showHideType",{dataType:o.INT,serializable:!1,scope:i.PropertyScope.PRIVATE}),this.defineProp("showHideCaller",{dataType:"Kekule.Widget.BaseWidget",serializable:!1,scope:i.PropertyScope.PRIVATE}),this.defineProp("showHideCallerPageRect",{dataType:o.HASH,serializable:!1,scope:i.PropertyScope.PRIVATE}),this.defineProp("standaloneOnShowHide",{dataType:o.BOOL,serializable:!1,scope:i.PropertyScope.PUBLIC}),this.defineProp("finalizeAfterHiding",{dataType:o.BOOL,scope:i.PropertyScope.PUBLIC}),this.defineProp("layout",{dataType:o.INT,setter:function(e){this.getPropStoreFieldValue("layout")!==e&&(this.setPropStoreFieldValue("layout",e),this.layoutChanged())}}),this.defineProp("useCornerDecoration",{dataType:o.BOOL,setter:function(e){this.setPropStoreFieldValue("useCornerDecoration",e),e?this.addClassName(d.CORNER_ALL):this.removeClassName(d.CORNER_ALL)}}),this.defineProp("useNormalBackground",{dataType:o.BOOL,setter:function(e){this.setPropStoreFieldValue("useNormalBackground",e),e?this.addClassName(d.NORMAL_BACKGROUND):this.removeClassName(d.NORMAL_BACKGROUND)}}),this.defineProp("showText",{dataType:o.BOOL,setter:function(e){this.setPropStoreFieldValue("showText",e),e?(this.removeClassName(d.HIDE_TEXT),this.addClassName(d.SHOW_TEXT)):(this.addClassName(d.HIDE_TEXT),this.removeClassName(d.SHOW_TEXT))}}),this.defineProp("showGlyph",{dataType:o.BOOL,setter:function(e){this.setPropStoreFieldValue("showGlyph",e),e?(this.removeClassName(d.HIDE_GLYPH),this.addClassName(d.SHOW_GLYPH)):(this.addClassName(d.HIDE_GLYPH),this.removeClassName(d.SHOW_GLYPH))}}),this.defineProp("allowTextWrap",{dataType:o.BOOL,serialzable:!1,setter:function(e){e?this.removeClassName(d.TEXT_NO_WRAP):this.addClassName(d.TEXT_NO_WRAP)}}),this.defineProp("selfEnabled",{dataType:o.BOOL,scope:i.PropertyScope.PRIVATE}),this.defineProp("inheritEnabled",{dataType:o.BOOL,setter:function(e){this.setPropStoreFieldValue("inheritEnabled",e),this.stateChanged()}}),this.defineProp("enabled",{dataType:o.BOOL,serializable:!1,getter:function(){var e=this.getPropStoreFieldValue("selfEnabled");if(this.getInheritEnabled()){var t=this.getParent();t&&(e=e&&t.getEnabled())}return e},setter:function(e){var t=this.getElement();e?t.removeAttribute("disabled"):t.setAttribute("disabled","true");var t=this.getCoreElement();t!=this.getElement()&&(e?t.removeAttribute("disabled"):t.setAttribute("disabled","true")),this.setPropStoreFieldValue("selfEnabled",e),this.stateChanged()}}),this.defineProp("selfStatic",{dataType:o.BOOL,scope:i.PropertyScope.PRIVATE}),this.defineProp("inheritStatic",{dataType:o.BOOL,setter:function(e){this.setPropStoreFieldValue("inheritStatic",e),this.stateChanged()}}),this.defineProp("static",{dataType:o.BOOL,serializable:!1,getter:function(){var e=this.getPropStoreFieldValue("selfStatic");if(this.getInheritStatic()){var t=this.getParent();t&&(e=e||t.getStatic())}return e},setter:function(e){this.setPropStoreFieldValue("selfStatic",e),this.stateChanged()}}),this.defineProp("inheritState",{dataType:o.BOOL,setter:function(e){this.setPropStoreFieldValue("inheritState",e),this.stateChanged()}}),this.defineProp("state",{dataType:o.INT,serializable:!1,scope:i.PropertyScope.PUBLIC,setter:null,getter:function(){var e;if(this.getInheritState()){var t=this.getParent();t&&(e=t.getState())}else e=this.getEnabled()?this.getIsActive()?u.ACTIVE:this.getIsHover()?u.HOVER:this.getIsFocused()?u.FOCUSED:u.NORMAL:u.DISABLED;return e}}),this.defineProp("cursor",{dataType:o.VARIANT,serializable:!1,getter:function(){return this.getStyleProperty("cursor")},setter:function(t){o.isArrayValue(t)?e.StyleUtils.setCursor(this.getElement(),t):this.setStyleProperty("cursor",t)}}),this.defineProp("isHover",{dataType:o.BOOL,serializable:!1,scope:i.PropertyScope.PUBLIC,setter:function(e){this.setPropStoreFieldValue("isHover",e),e||this.isCaptureMouse()||this.setPropStoreFieldValue("isActive",!1);var t=this.getGlobalManager();t&&t.notifyWidgetHoverChanged(this,e),this.stateChanged()}}),this.defineProp("isActive",{dataType:o.BOOL,serializable:!1,scope:i.PropertyScope.PUBLIC,setter:function(e){this.setPropStoreFieldValue("isActive",e),e&&this.focus();var t=this.getGlobalManager();t&&t.notifyWidgetActiveChanged(this,e),this.stateChanged()}}),this.defineProp("isFocused",{dataType:o.BOOL,serializable:!1,scope:i.PropertyScope.PUBLIC,getter:function(){var e=this.getDocument(),t=this.getCoreElement();if(e&&t&&e.activeElement)return e.activeElement===t},setter:function(t){this.setPropStoreFieldValue("isFocused",t);var r=this.getGlobalManager();r&&r.notifyWidgetFocusChanged(this,t);var i=this.getCoreElement();i&&(i.focus&&t&&e.HtmlElementUtils.isFormCtrlElement(i)&&i.focus(),i.blur&&!t&&i.blur()),this.stateChanged()}}),this.defineProp("minDimension",{dataType:o.HASH}),this.defineProp("enableDimensionTransform",{dataType:o.BOOL}),this.defineProp("autoResizeConstraints",{dataType:o.HASH,setter:function(t){this.setPropStoreFieldValue("autoResizeConstraints",t);var r=this.getGlobalManager()||e.Widget.globalManager;t?(this.autoResizeToClient(),r.registerAutoResizeWidget(this)):r.unregisterAutoResizeWidget(this)}}),this.defineProp("observeElemResize",{dataType:o.BOOL,getter:function(){return this.getPropStoreFieldValue("observeElemResize")&&e.BrowserFeature.resizeObserver},setter:function(e){this.getPropStoreFieldValue("observeElemResize")!=!!e&&(this.setPropStoreFieldValue("observeElemResize",!!e),e?this._installElemResizeObserver():this._uninstallElemResizeObserver())}}),this.defineProp("autoAdjustSizeOnPopup",{dataType:o.BOOL,scope:i.PropertyScope.PUBLIC}),this.defineProp("isDialog",{dataType:o.BOOL,scope:i.PropertyScope.PUBLIC}),this.defineProp("isPopup",{dataType:o.BOOL,scope:i.PropertyScope.PUBLIC}),this.defineProp("popupCaller",{dataType:o.BOOL,scope:i.PropertyScope.PRIVATE}),this.defineProp("modalInfo",{dataType:o.HASH,scope:i.PropertyScope.PUBLIC}),this.defineProp("enablePeriodicalExec",{dataType:o.BOOL}),this.defineProp("periodicalExecDelay",{dataType:o.INT}),this.defineProp("periodicalExecInterval",{dataType:o.INT}),this.defineElemAttribMappingProp("hint","title"),this.defineProp("action",{dataType:"Kekule.Action",serializable:!1,setter:function(e){var t=this.getAction();t!==e&&(t&&t.unlinkWidget&&(t.unlinkWidget(this),this.unlinkAction(t)),this.setPropStoreFieldValue("action",e),e&&e.linkWidget&&(e.linkWidget(this),this.linkAction(e)))}}),this.defineProp("iaControllerMap",{dataType:o.OBJECT,serializable:!1,setter:null,scope:i.PropertyScope.PUBLIC,getter:function(){var t=this.getPropStoreFieldValue("iaControllerMap");return t||(t=new e.HashEx,this.setPropStoreFieldValue("iaControllerMap",t)),t}}),this.defineProp("defIaControllerId",{dataType:o.STRING,serializable:!1,scope:i.PropertyScope.PUBLIC}),this.defineProp("defIaController",{dataType:o.STRING,serializable:!1,scope:i.PropertyScope.PUBLIC,setter:null,getter:function(){return this.getIaControllerMap().get(this.getDefIaControllerId())}}),this.defineProp("activeIaControllerId",{dataType:o.STRING,serializable:!1,scope:i.PropertyScope.PUBLIC,setter:function(e){if(e!==this.getActiveIaControllerId()){this.setPropStoreFieldValue("activeIaControllerId",e);var t=this.getActiveIaController();t&&t.activated&&t.activated(this)}}}),this.defineProp("activeIaController",{dataType:o.OBJECT,serializable:!1,scope:i.PropertyScope.PUBLIC,setter:null,getter:function(){return this.getIaControllerMap().get(this.getActiveIaControllerId())}}),this.defineProp("observingGestureEvents",{dataType:o.ARRAY,serializable:!1,scope:i.PropertyScope.PUBLIC,setter:null})},doFinalize:function($super){this._elemResizeObserver&&(this._elemResizeObserver.disconnect&&this._elemResizeObserver.disconnect(),this._elemResizeObserver=null),this.setAction(null),this.setParent(null),this.releaseChildWidgets();var e=this.getElement();this.setElement(null),this.destroyElement(e),this.getGlobalManager()&&this.getGlobalManager().notifyWidgetFinalized(this),$super()},initPropValues:function($super){$super(),this.setEnableObjectChangeEvent(!0)},invokeEvent:function($super,e,t){t||(t={}),t.widget||(t.widget=this),$super(e,t);var r=this.getGlobalManager();r&&r.notifyWidgetEventFired(this,e,t)},getGlobalManager:function(){var t=this.getDocument(),r=t&&e.DocumentUtils.getDefaultView(t),i=r&&r.Kekule;return i||(i=e),i.Widget.globalManager},getCoreElement:function(){return this.getElement()},getChildrenHolderElement:function(){return this.getCoreElement()},getTextSelectable:function(){return!1},canUsePlaceHolderOnElem:function(e){return!1},doPropChanged:function(e,t){"width"!==e&&"height"!==e||this.resized()},getActualBubbleUiEvents:function(){var e=this.getParent();return!!this.getBubbleUiEvents()||(this.getInheritBubbleUiEvents()&&e&&e.getActualBubbleUiEvents?e.getActualBubbleUiEvents():void 0)},releaseChildWidgets:function(){for(var e=this.getChildWidgets(),t=e.length-1;t>=0;--t)e[t].finalize()},defineElemAttribMappingProp:function(e,t,r){var i=Object.extend({dataType:o.STRING,serializable:!1,getter:function(){return this.getElement()&&this.getElement().getAttribute(t)},setter:function(e){this.getElement()&&this.getElement().setAttribute(t,e)}},r||{});return this.defineProp(e,i)},defineElemStyleMappingProp:function(e,t,r){var i=Object.extend({dataType:o.STRING,serializable:!1,getter:function(){return this.getStyleProperty(t)},setter:function(e){this.setStyleProperty(t,e)}},r||{});return this.defineProp(e,i)},getHigherLevelObj:function(){return this.getParent()},linkAction:function(e){},unlinkAction:function(e){},getChildActionClass:function(t,r){return e.ActionManager.getActionClassOfName(t,this,r)},linkStyleResource:function(t,r){var i=t instanceof e.Widget.StyleResource?t:e.Widget.StyleResourceManager.getResource(t);return i&&i.linkTo(r||this),this},unlinkStyleResource:function(t,r){var i=t instanceof e.Widget.StyleResource?t:e.Widget.StyleResourceManager.getResource(t);return i&&i.unlinkFrom(r||this),this},getStyleProperty:function(e,t){var r=t||this.getElement(),i=r[this.STYLE_RES_FIELD];return i&&i[e]?i[e]:r.style[e]},setStyleProperty:function(t,r,i){var n=i||this.getElement();if(n){var a;if(r instanceof e.Widget.StyleResource?a=r:o.getType(r)===o.STRING&&r.startsWith(e.Widget.StyleResourceNames.PREFIX)&&(a=e.Widget.StyleResourceManager.getResource(r)),a){var s=n[this.STYLE_RES_FIELD];s||(s={},n[this.STYLE_RES_FIELD]=s);var l=s[t];l&&this.unlinkStyleResource(l,n),a&&this.linkStyleResource(a,n),s[t]=a}else{n.style[t]=r;var s=n[this.STYLE_RES_FIELD];s&&s[t]&&this.unlinkStyleResource(s[t],n)}}},removeStyleProperty:function(t,r,i){var n=i||this.getElement();e.StyleUtils.removeStyleProperty(n.style,t)},_addChild:function(e){if(e){var t=this.getChildWidgets();t.indexOf(e)<0&&(t.push(e),this.childWidgetAdded(e),this.childrenModified())}},_insertChild:function(e,t){if(e){var r=this.getChildWidgets(),i=t?r.indexOf(t):r.length;r.indexOf(e)>=0?i>=0&&this._moveChild(e,i):(i<0&&(i=r.length),r.splice(i,0,e),this.childWidgetAdded(e),this.childrenModified())}},_removeChild:function(t){if(t){var r=this.getChildWidgets(),i=r.indexOf(t);if(i>=0){r.splice(i,1);var n=this.getChildrenHolderElement(),a=t.getElement();a&&e.DomUtils.isDescendantOf(a,n)&&a.parentNode.removeChild(a),this.childWidgetRemoved(t),this.childrenModified()}}},_moveChild:function(t,r){t&&e.ArrayUtils.changeItemIndex(this.getChildWidgets(),t,r)&&(this.childWidgetMoved(t,r),this.childrenModified())},childrenModified:function(){},childWidgetAdded:function(e){},childWidgetRemoved:function(e){},childWidgetMoved:function(e,t){},indexOfChild:function(e){return this.getChildWidgets().indexOf(e)},hasChild:function(e,t){var r=this.getChildWidgets(),i=r.indexOf(e),n=i>=0;if(!n)for(var a=0,o=r.length;a<o;++a){var s=r[a];if(s.hasChild&&(n=s.hasChild(e,t)))break}return n},getChildAtIndex:function(e){return this.getChildWidgets()[e]},getPrevSibling:function(){var e=this.getParent();if(e){var t=e.indexOfChild(this);return this.getChildAtIndex(--t)}return null},getNextSibling:function(){var e=this.getParent();if(e){var t=e.indexOfChild(this);return this.getChildAtIndex(++t)}return null},_haltPrevShowHideProcess:function(){e.Widget.showHideManager&&this.__$showHideTransInfo&&this.__$showHideTransInfo.halt()},_setEnableShowHideEvents:function(e){this._enableShowHideEvents=e},show:function(e,t,r,i){if(this.getElement()&&!this.__$isShowing)return this._haltPrevShowHideProcess(),this.doShow(e,t,r,i),this},doShow:function(t,r,i,n){this.__$isShowing=!0;var a=this,o=function(){a.__$showHideTransInfo=null,a.widgetShowStateDone(!0),a.__$isShowing=!1,r&&r()};this.setShowHideType(i),e.ObjUtils.notUnset(i)&&(this.setIsPopup(i===e.Widget.ShowHideType.DROPDOWN||i===e.Widget.ShowHideType.POPUP),i===e.Widget.ShowHideType.DIALOG?(this.setIsDialog(!0),i=e.Widget.ShowHideType.POPUP):this.setIsDialog(!1)),this.widgetShowStateBeforeChanging(!0);var s=this.getGlobalManager();i!==e.Widget.ShowHideType.DROPDOWN&&i!==e.Widget.ShowHideType.POPUP||s.preparePopupWidget(this,t,i),!e.Widget.showHideManager||n&&n.instantly?(this.setDisplayed(!0,!0),this.setVisible(!0,!0),o()):this.__$showHideTransInfo||(this.__$showHideTransInfo=e.Widget.showHideManager.show(this,t,o,i,n)),this.setShowHideCaller(t),t&&this.setShowHideCallerPageRect(l.getElemBoundingClientRect(t.getElement&&t.getElement()||t)),function(){a.widgetShowStateChanged(!0)}.defer()},flash:function(e,t,r,i){var n=this,a=function(){r&&r(),setTimeout(n.hide.bind(n),e)};return this.show(t,a,i),this},hide:function(e,t,r,i){if(this.getElement()&&!this.__$isHiding)return this.__$isHiding=!0,e||(e=this.getShowHideCaller()),r||(r=this.getShowHideType()),this._haltPrevShowHideProcess(),this.doHide(e,t,r,i),this},doHide:function(t,r,i,n){var a=Object.extend({callerPageRect:this.getShowHideCallerPageRect()},n),o=a.useVisible,s=this,l=this.getFinalizeAfterHiding(),d=function(){s.__$showHideTransInfo=null,s.widgetShowStateDone(!1);var t=s.getGlobalManager();i!==e.Widget.ShowHideType.DROPDOWN&&i!==e.Widget.ShowHideType.POPUP||t.unpreparePopupWidget(s),s.__$isHiding=!1,r&&r(),l&&s.finalize()};this.widgetShowStateBeforeChanging(!1),e.Widget.showHideManager&&!a.instantly?(this.__$showHideTransInfo&&this.__$showHideTransInfo.halt(),this.__$showHideTransInfo||(this.__$showHideTransInfo=e.Widget.showHideManager.hide(this,t,d,i,!1,a))):(o?this.setVisible(!1,!0):this.setDisplayed(!1,!0),d()),function(){s.widgetShowStateChanged(!1)}.defer()},dismiss:function(e,t,r,i){return this._isDismissed=!0,this.hide(e,t,r,i)},isShown:function(e){return(this.isInDomTree()||e)&&this.getElement()&&this.getVisible()&&this.getDisplayed()},widgetShowStateBeforeChanging:function(e){e&&this.autoResizeToClient()},widgetShowStateChanged:function(t,r){if(e.ObjUtils.isUnset(t)&&(t=this.isShown()),!e.ObjUtils.notUnset(this._lastShown)||this._lastShown!==t){this._lastShown=t,t&&(this._isDismissed=!1);var i=this.getGlobalManager();this.getIsPopup()&&(t?i.registerPopupWidget(this):i.unregisterPopupWidget(this)),this.getIsDialog()&&(t?i.registerDialogWidget(this):i.unregisterDialogWidget(this)),this._enableShowHideEvents&&this.invokeEvent("showStateChange",{widget:this,isShown:t,isDismissed:this._isDismissed,byDomChange:r})}},doWidgetShowStateChanged:function(e){},widgetShowStateDone:function(e){},isInDomTree:function(){var t=this.getElement();return e.DomUtils.isInDomTree(t,null,{acrossShadowRoot:!0})},focus:function(){return this.setIsFocused(!0),this},blur:function(){return this.setIsFocused(!1),this},getBoundingClientRect:function(t){if(this.getDisplayed())return e.HtmlElementUtils.getElemBoundingClientRect(this.getElement(),t);var r=e.StyleUtils.getDisplayed(this.getElement()),i=e.StyleUtils.getVisibility(this.getElement());try{this.setVisible("hidden"),this.setDisplayed("");var n=e.HtmlElementUtils.getElemBoundingClientRect(this.getElement(),t)}finally{this.setDisplayed(r),this.setVisible(i)}return n},getPageRect:function(t){if(this.getDisplayed())return e.HtmlElementUtils.getElemPageRect(this.getElement(),t);var r=e.StyleUtils.getDisplayed(this.getElement()),i=e.StyleUtils.getVisibility(this.getElement());try{this.setVisible("hidden"),this.setDisplayed("");var n=e.HtmlElementUtils.getElemPageRect(this.getElement(),t)}finally{this.setDisplayed(r),this.setVisible(i)}return n},getDimension:function(){return this.getPageRect()},setDimension:function(t,r,i){var n=e.ObjUtils.notUnset,a=this.getMinDimension(),o=a&&a.width,s=a&&a.height,l=!1;if(this.getEnableDimensionTransform()){var d,u=n(t)&&o?t/o:null,c=n(r)&&s?r/s:null;if(d=u&&c?Math.min(u,c):u||c){if(d>=1)return this._setTransformScale(1),l=!0,this.doSetDimension(t,r,i);var h,m;return!c||u<=c?(h=o,m=r&&r/d):(m=s,h=t&&t/d),this._setTransformScale(d),l=!0,this.doSetDimension(h,m,i)}l=!1}if(!l){var h=n(t)?o?Math.max(t,o):t:null,m=n(r)?s?Math.max(r,s):r:null;return this._setTransformScale(1),this.doSetDimension(h,m,i)}},doSetDimension:function(t,r,i){var n=!1,a=e.ObjUtils.notUnset;return a(t)&&(this.getStyle().width="number"==typeof t?t+"px":t,n=!0),a(r)&&(this.getStyle().height="number"==typeof r?r+"px":r,n=!0),n&&!i&&(this.getObserveElemResize()||this.resized()),this.objectChange(["width","height"]),this},_setTransformScale:function(t){var r=this.getElement();1!==t?(r.style.transformOrigin="0 0",r.style.transform="scale("+t+")"):e.StyleUtils.removeStyleProperty(r.style,"transform")},updateDimensionTransform:function(){var e=this.getDimension();this.setDimension(e.width,e.height,!0)},autoResizeToClient:function(){var t=this.getAutoResizeConstraints();if(t){var r=e.DocumentUtils.getClientDimension(this.getDocument()),i=t.width?r.width*t.width:null,n=t.height?r.height*t.height:null;this.setDimension(i,n)}},resized:function(){if(!this._isResizing){this._isResizing=!0;try{this.doResize(),this.invokeEvent("resize",{widget:this})}finally{this._isResizing=!1}}},doResize:function(){},_installElemResizeObserver:function(){if(e.BrowserFeature.resizeObserver){if(!this._elemResizeObserver){var t=this;this._elemResizeObserver=new ResizeObserver(function(e){for(var r=0,i=e.length;r<i;++r){var n=e[r];n.target&&n.contentBoxSize&&n.target===t.getElement()&&t.resized()}})}this._elemResizeObserver.observe(this.getElement())}},_uninstallElemResizeObserver:function(){e.BrowserFeature.resizeObserver&&this._elemResizeObserver&&this._elemResizeObserver.unobserve(this.getElement())},layoutChanged:function(){var e=this.getLayout();this._layoutClassName&&this.removeClassName(this._layoutClassName),this._layoutClassName=this.getLayoutClassName(e),this._layoutClassName&&this.addClassName(this._layoutClassName)},getLayoutClassName:function(t){var r=e.Widget.Layout;return t===r.VERTICAL?d.LAYOUT_V:t===r.HORIZONTAL?d.LAYOUT_H:null},stateChanged:function(){this._stateClassName&&this.removeClassName(this._stateClassName),this._stateClassName=this.getStateClassName(this.getState()),this._stateClassName&&this.addClassName(this._stateClassName);for(var e=this.getChildWidgets(),t=0,r=e.length;t<r;++t)e[t].stateChanged()},getStateClassName:function(t){var r=e.Widget.State;return t===r.ACTIVE?d.STATE_ACTIVE:t===r.HOVER?d.STATE_HOVER:t===r.FOCUSED?d.STATE_FOCUSED:t===r.DISABLED?d.STATE_DISABLED:d.STATE_NORMAL},createElement:function(){var e=this.getDocument(),t=this.doCreateRootElement(e);return this.setElement(t),t},doCreateRootElement:function(e){},doCreateSubElements:function(e,t){return[]},destroyElement:function(e){var e=e||this.getElement();e&&e.parentNode&&e.parentNode.removeChild(e)},appendToElem:function(e){return e&&e.appendChild(this.getElement()),this},insertToElem:function(e,t){return e.insertBefore(this.getElement(),t),this},removeFromDom:function(){var e=this.getElement(),t=e.parentNode;t&&t.removeChild(e)},appendToWidget:function(e){return this.setParent(e),this.appendToElem(e.getChildrenHolderElement()),this},insertToWidget:function(e,t){return this.setParent(e),t?this.insertToElem(e.getChildrenHolderElement(),t.getElement()):this.appendToElem(e.getChildrenHolderElement()),this},insertedToDom:function(){return this.widgetDomStateChanged(!0),this.widgetShowStateChanged(this.isShown(),!0),this.doInsertedToDom()},doInsertedToDom:function(){},removedFromDom:function(){return this.widgetDomStateChanged(!1),this.widgetShowStateChanged(!1,!0),this.doRemovedFromDom()},doRemovedFromDom:function(){},widgetDomStateChanged:function(e){this.doWidgetDomStateChanged(e),this.invokeEvent("domStateChange",{widget:this,isInDom:e})},doWidgetDomStateChanged:function(e){},domElemAdded:function(e){return this.doDomElemAdded(e)},doDomElemAdded:function(e){},domElemRemoved:function(e){return this.doDomElemRemoved(e)},doDomElemRemoved:function(e){},getWidgetClassName:function(){var t=e.Widget.HtmlClassNames.BASE;return this.getElement()&&!e.HtmlElementUtils.isFormCtrlElement(this.getCoreElement())&&this.getUseNormalBackground()&&(t+=" "+e.Widget.HtmlClassNames.NORMAL_BACKGROUND),t+=" "+this.doGetWidgetClassName()},doGetWidgetClassName:function(){return""},hasClassName:function(e){return l.hasClass(this.getElement(),e)},addClassName:function(t,r){if(this.getElement())if(r){var i=this.getCustomHtmlClassName();i=e.StrUtils.addTokens(i,t),this.setCustomHtmlClassName(i)}else l.addClass(this.getElement(),t);else this._pendingHtmlClassNames=e.StrUtils.addTokens(this._pendingHtmlClassNames,t);return this},removeClassName:function(t,r){if(this.getElement())if(r){var i=this.getCustomHtmlClassName();i=e.StrUtils.removeTokens(i,t),this.setCustomHtmlClassName(i)}else l.removeClass(this.getElement(),t);else this._pendingHtmlClassNames=e.StrUtils.removeTokens(this._pendingHtmlClassNames,t);return this},toggleClassName:function(t,r){if(this.getElement())if(r){var i=this.getCustomHtmlClassName();i=e.StrUtils.toggleTokens(i,t),this.setCustomHtmlClassName(i)}else l.toggleClass(this.getElement(),t);return this},isElementBindable:function(e){var t=this.getBindableElemTagNames();if(t){var r=e.tagName;return t.indexOf(r.toLowerCase())>=0}return!0},getBindableElemTagNames:function(){return this.getPrototype().hasOwnProperty("BINDABLE_TAG_NAMES")?this.BINDABLE_TAG_NAMES:null},bindElement:function(t){if(t){if(!this.isElementBindable(t))return void e.error(e.$L("ErrorMsg.WIDGET_CAN_NOT_BIND_TO_ELEM").format(this.getClassName(),t.tagName));var r=t.className;r&&this.setCustomHtmlClassName(this.getCustomHtmlClassName()||" "+r);var i=e.DomUtils,n=e.HtmlElementUtils;!function(e){for(var t=i.getDirectChildElems(e),r=t.length-1;r>=0;--r){var a=t[r];n.hasClass(a,d.DYN_CREATED)&&e.removeChild(a)}}(t);var a=this.getDocument(),o=a.createDocumentFragment(),s=this.doCreateSubElements(this.getDocument(),o);if(s&&s.length)for(var u=0,c=s.length;u<c;++u){var h=s[u];n.addClass(h,d.DYN_CREATED)}(s&&s.length||o.children&&o.children.length||o.childNodes&&o.childNodes.length)&&t.appendChild(o),this.doBindElement(t),e.DomUtils.hasAttribute(t,"disabled")&&this.setEnabled(!1);var m=this.getWidgetClassName();l.addClass(t,m),m=this.getCustomHtmlClassName(),m&&l.addClass(t,m),this.getTextSelectable()||l.addClass(t,d.NONSELECTABLE),this._pendingHtmlClassNames&&(l.addClass(t,this._pendingHtmlClassNames),this._pendingHtmlClassNames="");var g=t.getAttribute("width"),f=t.getAttribute("height");(e.ObjUtils.notUnset(g)||e.ObjUtils.notUnset(f))&&(g=parseFloat((g||"").toString())||0,f=parseFloat((f||"").toString())||0,this.setDimension(g,f));var p=e.DomUtils.getDataset(t);if(p)for(var C in p){var b=p[C];try{e.Widget.Utils.setWidgetPropFromElemAttrib(this,C,b)}catch(t){e.warn(t)}}var E=this.getTouchAction();e.ObjUtils.notUnset(E)&&this.setTouchAction(E),this.getIsDumb()||this.installUiEventHandlers(t),t.__$kekule_widget__=this,this.elementBound(t),this.invokeEvent("bind",{widget:this,element:t})}},doBindElement:function(e){},elementBound:function(e){},unbindElement:function(e){if(e){this.getIsDumb()||this.uninstallUiEventHandlers(e);var t=this.getWidgetClassName();l.removeClass(e,t),this.doUnbindElement(e),e.__$kekule_widget__=void 0;try{delete e.__$kekule_widget__}catch(e){}this.elementUnbound(e),this.invokeEvent("unbind",{widget:this,element:e})}},doUnbindElement:function(e){},elementUnbound:function(e){},elementChanged:function(e,t){t&&this.unbindElement(t),e&&this.bindElement(e)},observeElementAttribChangesChanged:function(e){var t=this.getElement();e?this._installAttribMutationObserver(t):this._uninstallAttribMutationObserver(t)},_installAttribMutationObserver:function(t){if(e.X.MutationObserver){if(!this._attribMutationObserver){var r=new e.X.MutationObserver(this._reactElemAttribMutationBind);this._attribMutationObserver=r}this._attribMutationObserver.observe(t,{attributes:!0})}},_uninstallAttribMutationObserver:function(e){this._attribMutationObserver&&this._attribMutationObserver.disconnect()},_reactElemAttribMutation:function(t){for(var r=this.getElement(),i=0,n=t.length;i<n;++i){var a=t[i];if("attributes"===a.type&&a.target===r){var o=a.attributeName;if(o&&e.DomUtils.isDataAttribName(o)){var s=e.DomUtils.getDataAttribCoreName(o);if(s){var l=r.getAttribute(o);e.Widget.Utils.setWidgetPropFromElemAttrib(this,s,l)}}}}},createDecorationContent:function(e,t){var r=e.ownerDocument,i=r.createElement("span");return l.addClass(i,[d.PART_CONTENT,d.PART_DECORATION_CONTENT,d.DYN_CREATED]),t?e.insertBefore(i,t):e.appendChild(i),i},createTextContent:function(e,t,r){var i=t.ownerDocument,n=i.createElement("span");return l.addClass(n,[d.PART_CONTENT,d.PART_TEXT_CONTENT,d.DYN_CREATED]),n.innerHTML=e,r?t.insertBefore(n,r):t.appendChild(n),n},createGlyphContent:function(e,t,r){var i=e.ownerDocument,n=i.createElement("span");return l.addClass(n,[d.PART_CONTENT,d.PART_GLYPH_CONTENT,d.DYN_CREATED]),r&&l.addClass(n,r),t?e.insertBefore(n,t):e.appendChild(n),n},_touchActionNoneTouchStartHandler:function(e){e.preventDefault()},installUiEventHandlers:function(t){for(var r=e.Widget.UiLocalEvents,i=0,n=r.length;i<n;++i)e.X.Event.addListener(t,r[i],this.reactUiEventBind)},uninstallUiEventHandlers:function(t){for(var r=e.Widget.UiLocalEvents,i=0,n=r.length;i<n;++i)e.X.Event.removeListener(t,r[i],this.reactUiEventBind)},reactUiEvent:function(t){if(this.getStatic());else if(this.getEnabled()){var r,i=!1,n=t.getType(),a=t.getTarget(),o=e.Widget.Utils.getBelongedResponsiveWidget(a),s=o===this,l=e.X.Event.KeyCode;if("mousemove"===n||"pointermove"===n){this.reactPointerMoving(t);var d=this.getEventMouseRelCoord(t),u=this.testMouseCursor(d,t);e.ObjUtils.notUnset(u)&&this.getElement()&&(this.setCursor(u),i=!0)}else if("touchmove"===n){if(this.reactPointerMoving(t),this.getIsActive()&&!this.isCaptureMouse()){var c=t.touches[0];if(c){var h=this.getDocument(),m=h.elementFromPoint(c.clientX,c.clientY);e.DomUtils.isOrIsDescendantOf(m,this.getElement())||(this.setIsHover(!1),this.setIsActive(!1))}else this.setIsHover(!1),this.setIsActive(!1)}i=!0}else if("focus"===n)s&&t.getTarget()===this.getCoreElement()&&(this.setIsFocused(!0),i=!0);else if("blur"===n){if(s&&t.getTarget()==this.getCoreElement()){var g=this.getDocument().activeElement,f=this.getElement();g&&(e.DomUtils.isDescendantOf(g,f)||g===f)||this.setIsFocused(!1),i=!0}}else if("pointerover"===n)"touch"===t.pointerType||t.ghostMouseEvent||this.setIsHover(!0),i=!0;else if("mouseout"===n||"touchleave"===n){if(!t.ghostMouseEvent){var p=t.getRelatedTarget();p&&e.DomUtils.isOrIsDescendantOf(p,this.getCoreElement())||(this.setIsHover(!1),this.isCaptureMouse()||(this.reactDeactiviting(t),i=!0))}}else"pointerdown"===n&&t.getButton()===e.X.Event.MouseButton.LEFT?(s&&!t.ghostMouseEvent&&this.reactActiviting(t),i=!0):"pointerup"===n&&t.getButton()===e.X.Event.MouseButton.LEFT||"touchcancel"===n?(s&&!t.ghostMouseEvent&&this.reactDeactiviting(t),i=!0):"keydown"===n?(r=t.getKeyCode())!==l.ENTER&&r!==l.SPACE||(s&&!this.getIsActive()&&this.reactActiviting(t),i=!0):"keyup"===n&&((r=t.getKeyCode())!==l.ENTER&&r!==l.SPACE||(s&&this.getIsActive()&&this.reactDeactiviting(t),i=!0));this.doBeforeDispatchUiEvent(t);var C=e.Widget.getEventHandleFuncName(t.getType());i=this[C]?this[C](t):this.dispatchEventToIaControllers(t)||i,this.doReactUiEvent(t),this.invokeEvent(n,{htmlEvent:t})}else t.stopPropagation();if(this.getActualBubbleUiEvents()){var b=this.getParent();b&&b.reactUiEvent&&b.reactUiEvent(t)}},doReactUiEvent:function(e){},doBeforeDispatchUiEvent:function(e){},_supportGestureEvent:function(){return void 0!==e.$jsRoot.Hammer&&e.$jsRoot.document&&e.$jsRoot.document.addEventListener},startObservingGestureEvents:function(t){if(this._supportGestureEvent()){t||(t=e.Widget.TouchGestures);var r=s.exclude(t,this.getObservingGestureEvents()||[]);r.length&&this.installHammerTouchHandlers(r)}},stopObservingGestureEvents:function(t){if(this._supportGestureEvent()&&this.getObservingGestureEvents()){t||(t=e.Widget.TouchGestures);var r=s.intersect(t,this.getObservingGestureEvents());r.length&&this.uninstallHammerTouchHandlers(r)}},installHammerTouchHandlers:function(r){if(this._supportGestureEvent()){r||(r=e.Widget.TouchGestures);var i=this.getCoreElement(),n=new t(i);return r.indexOf("pinch")>=0&&n.get("pinch").set({enable:!0}),r.indexOf("rotate")>=0&&n.get("rotate").set({enable:!0}),n.on(r.join(" "),this.reactTouchGestureBind),this._hammertime=n,this.setPropStoreFieldValue("observingGestureEvents",r),n}},uninstallHammerTouchHandlers:function(e){this._hammertime&&(e||(e=this.getObservingGestureEvents()),this._hammertime.off(e.join(" "),this.reactTouchGestureBind))},reactTouchGesture:function(t){var r=e.Widget.getTouchGestureHandleFuncName(t.getType&&t.getType()||t.type);this[r]?this[r](t):this.dispatchEventToIaControllers(t,"hammer")},reactActiviting:function(e){this.getIsActive()||(this.setIsActive(!0),this.doReactActiviting(e),this.invokeEvent("activate",{widget:this}))},doReactActiviting:function(e){},reactDeactiviting:function(e){this.getIsActive()&&(this.doReactDeactiviting(e),this.invokeEvent("deactivate",{widget:this}),this.setIsActive(!1))},doReactDeactiviting:function(e){},reactPointerMoving:function(e){this.doReactPointerMoving(e)},doReactPointerMoving:function(e){},dispatchEventToIaControllers:function(e,t){var r=!1,i=this.getActiveIaController();return i&&(r="hammer"===t?i.handleGestureEvent(e):i.handleUiEvent(e)),r||(i=this.getDefIaController())&&(r="hammer"===t?i.handerGestureEvent(e):i.handleUiEvent(e)),r},getEventMouseRelCoord:function(t,r){r||(r=this.getCoreElement());var i={x:t.getClientX(),y:t.getClientY()},n=e.HtmlElementUtils.getElemPageRect(r,!0),a={x:n.left-r.scrollLeft,y:n.top-r.scrollTop};return e.CoordUtils.substract(i,a)},testMouseCursor:function(e,t){var r=this.doTestMouseCursor(e,t);if(!r){var i=this.getActiveIaController();i&&(r=i.testMouseCursor(e,t)),r||(i=this.getDefIaController())&&(r=i.testMouseCursor(e,t))}return r},doTestMouseCursor:function(e,t){return null},setMouseCapture:function(e){var t=this.getGlobalManager();e?t.setMouseCaptureWidget(this):this.isCaptureMouse()&&t.setMouseCaptureWidget(null)},isCaptureMouse:function(){return this.getGlobalManager().getMouseCaptureWidget()===this},_filterDraggedDataItemByKinds:function(e,t){if(e.items){for(var r=[],i=0,n=e.items.length;i<n;++i){var a=e.items[i];t.indexOf(a.kind)>=0&&r.push(a)}return r}return null},dragStart:function(e){if(this.getDraggable()){var t=this.doDragStart(e);return this.invokeEvent("dragStart",{widget:this,dataTransfer:e.dataTransfer,startingElem:e.targetElem}),t}return!1},doDragStart:function(e,t){return!0},dragEnd:function(e){var t=this.doDragEnd(e);return this.invokeEvent("dragEnd",{widget:this,dataTransfer:e.dataTransfer,startingElem:e.targetElem}),t},doDragEnd:function(e){},acceptDragSrc:function(t){if(this.getDroppable()){var r=!0,i={widget:this,htmlEvent:t.htmlEvent,dataTransfer:t.dataTransfer,srcElem:t.srcElem,srcWidget:t.srcWidget,srcFiles:t.dataTransfer&&t.dataTransfer.files};if(this.invokeEvent("dragAcceptQuery",i),e.ObjUtils.notUnset(i.result))return r=i.result;var n=this.getDroppableDataKinds();if(n)if(t.dataTransfer.items){var a=this._filterDraggedDataItemByKinds(t.dataTransfer,n);r=!!a.length}else n.indexOf("file")>=0&&t.dataTransfer.files&&t.dataTransfer.files.length&&(r=!0);return r&&this.doAcceptDragSrc(t)}return!1},doAcceptDragSrc:function(e){return!0},dragOver:function(e){if(this.getDroppable()&&this.acceptDragSrc(e)){var t=this.doDragOver(e);return this.invokeEvent("dragOver",{widget:this,htmlEvent:e.htmlEvent,dataTransfer:e.dataTransfer,srcElem:e.srcElem,srcWidget:e.srcWidget,srcFiles:e.dataTransfer&&e.dataTransfer.files}),t}return!1},doDragOver:function(e){return!0},dragLeave:function(e){var t=this.doDragLeave(e);return this.invokeEvent("dragLeave",{widget:this,htmlEvent:e.htmlEvent,dataTransfer:e.dataTransfer,srcElem:e.srcElem,srcWidget:e.srcWidget,srcFiles:e.dataTransfer&&e.dataTransfer.files}),t},doDragLeave:function(e){},dragDrop:function(e){if(this.getDroppable()&&this.acceptDragSrc(e)){var t=this.doDragDrop(e),r=this.getDroppableDataKinds();if(!r||r.indexOf("file")>=0){var i=e.dataTransfer.files;i&&i.length&&(t=t||this.doFileDragDrop(i))}var n={widget:this,htmlEvent:e.htmlEvent,dataTransfer:e.dataTransfer,srcElem:e.srcElem,srcWidget:e.srcWidget,srcFiles:e.dataTransfer&&e.dataTransfer.files};return this.invokeEvent("dragDrop",n),t||n._preventDefault}return!1},doDragDrop:function(e){return!1},doFileDragDrop:function(e){return!0},addIaController:function(e,t,r){this.getIaControllerMap().set(e,t),r&&this.setDefIaControllerId(e),t&&t.setWidget(this)},removeIaController:function(e){var t=this.getIaControllerMap().get(e);t&&(this.getIaControllerMap().remove(e),e===this.getDefIaControllerId()&&this.setDefIaControllerId(null),e===this.getActiveIaControllerId()&&this.setActiveIaControllerId(null),t.setWidget(null))},getIaController:function(e){return this.getIaControllerMap().get(e)},execute:function(e){this.doExecute(e),this.invokeEvent("execute",{widget:this,htmlEvent:e})},doExecute:function(e){},isPeriodicalExecuting:function(){return this._periodicalExecBind},startPeriodicalExec:function(e){var t=this.getPeriodicalExecDelay()||0;this._periodicalExecuting=!0,this._periodicalExecHtmlEvent=e,setTimeout(this._periodicalExecBind,t)},stopPeriodicalExec:function(){this._periodicalExecuting=!1,this._periodicalExecHtmlEvent=null},_periodicalExec:function(e){this.isPeriodicalExecuting()&&(this._waitPeriodicalProcess||(this._waitPeriodicalProcess=!0,this.execute(this._periodicalExecHtmlEvent),this._waitPeriodicalProcess=!1),setTimeout(this._periodicalExecBind,this.getPeriodicalExecInterval()||20))}}),e.Widget.InteractionController=i.create(a,{CLASS_NAME:"Kekule.Widget.InteractionController",initialize:function($super,e){$super(),e&&this.setWidget(e)},doFinalize:function($super){this.setWidget(null),$super()},initProperties:function(){this.defineProp("widget",{dataType:"Kekule.Widget.BaseWidget",serializable:!1})},activated:function(e){},handleUiEvent:function(t){var r=t.getType(),i=e.Widget.getEventHandleFuncName(r);return!!this[i]&&this[i](t)},handleGestureEvent:function(t){var r=t.type,i=e.Widget.getEventHandleFuncName(r);return!!this[i]&&this[i](t)},_defEventHandler:function(e){return!1},testMouseCursor:function(e,t){return this.doTestMouseCursor(e,t)},doTestMouseCursor:function(e,t){return null},_getEventMouseCoord:function(t,r){var i=r||this.getWidget().getElement(),n=t.getTarget(),a=t.getOffsetCoord(!0);if(n===i)return a;var o=e.HtmlElementUtils.getElemPagePos(i),s=e.HtmlElementUtils.getElemPagePos(n),l={x:s.x-o.x,y:s.y-o.y};return a=e.CoordUtils.substract(a,l)}}),e.Widget.DumbWidget=i.create(e.Widget.BaseWidget,{CLASS_NAME:"Kekule.Widget.DumbWidget",initialize:function($super,e){$super(e,!0)},doGetWidgetClassName:function($super){return $super()+" "+d.DUMB_WIDGET},doCreateRootElement:function(e){return e.createElement("span")}}),e.Widget.PlaceHolder=i.create(e.Widget.BaseWidget,{CLASS_NAME:"Kekule.Widget.PlaceHolder",initialize:function($super,e,t){this.setPropStoreFieldValue("targetWidgetClass",t),$super(e,!0)},initProperties:function(){this.defineProp("targetWidgetClass",{dataType:o.CLASS,serializable:!1,getter:function(){var t=this.getPropStoreFieldValue("targetWidgetClass");if(!t){var r=this.getPropStoreFieldValue("targetWidgetClassName");r&&(t=n.findClass(r,void 0,e))}return t}}),this.defineProp("targetWidgetClassName",{dataType:o.STRING,getter:function(){this.getTargetWidgetClass();return this.getPropStoreFieldValue("targetWidgetClassName")},setter:function(t){this.setPropStoreFieldValue("targetWidgetClassName",t),this.setTargetWidgetClass(n.findClass(t,void 0,e))}}),this.defineProp("target",{dataType:o.STRING,getter:function(){return this.getTargetWidgetClassName()},setter:function(e){this.setTargetWidgetClassName(e)}}),this.defineProp("targetWidget",{dataType:"Kekule.Widget.BaseWidget",serializable:"false",setter:null,getter:function(){var e=this.getPropStoreFieldValue("targetWidget");return e||(e=this.createTargetWidget()),e}})},doGetWidgetClassName:function($super){var t=$super()+" "+d.PLACEHOLDER,r=this.getTargetWidgetClass();if(r){var i=n.getPrototype(r).getWidgetClassName();t=e.StrUtils.addTokens(t,i)}return t},doCreateRootElement:function(e){return e.createElement("img")},doReactUiEvent:function(e){this.createTargetWidget()},createTargetWidget:function(){var t=this.getTargetWidgetClass();if(t){try{var r=this.getElement(),i=this.getParent();i&&i instanceof e.Widget.PlaceHolder&&(i=i.createTargetWidget());var n=s.clone(this.getChildWidgets());this.unbindElement(this.getElement()),this.setPropStoreFieldValue("element",null);var a=new t(r);if(a){if(i){var o=this.getNextSibling();this.setParent(null),a.setPropStoreFieldValue("parent",i),i._insertChild(a,o)}if(n)for(var l=0,d=n.length;l<d;++l)n[l].setParent(a)}}finally{this.finalize()}return a}e.error(e.$L("ErrorMsg.WIDGET_UNAVAILABLE_FOR_PLACEHOLDER"))}}),e.Widget.Utils={getWidgetOnElem:function(t,r){var i=t.__$kekule_widget__;return!r&&i instanceof e.Widget.PlaceHolder&&(i=i.getTargetWidget()),i},getWidgetsInsideElem:function(t,r){var i,n=e.Widget.Utils.getWidgetOnElem(t);if(i=n?[n]:[],!r)return i;for(var a=e.DomUtils.getDirectChildElems(t),o=0,s=a.length;o<s;++o){var l=a[o],d=e.Widget.Utils.getWidgetsInsideElem(l,r);i=i.concat(d)}return i},getWidgetById:function(t,r){r||(r=e.$jsRoot.document);var i=r.getElementById(t);return i?e.Widget.Utils.getWidgetOnElem(i):void 0},getBelongedWidget:function(t){for(var r=null;t&&!r;)r=e.Widget.Utils.getWidgetOnElem(t),t=t.parentNode;return r},getBelongedResponsiveWidget:function(t){for(var r=null;t&&!r;)r=e.Widget.Utils.getWidgetOnElem(t),r&&r.getStatic()&&(r=null),t=t.parentNode;return r},createFromHash:function(t,r){var i=["widget","widgetClass","htmlClass","children"],a=r.widgetClass||r.widget;if("string"==typeof a&&(a=n.findClass(a,void 0,e)),!a)return e.error(e.$L("ErrorMsg.WIDGET_CLASS_NOT_FOUND")),null;var s=new a(t),l=e.ObjUtils.getOwnedFieldNames(r,!0);l=e.ArrayUtils.exclude(l,i);for(var d=0,u=l.length;d<u;++d){var c=l[d],h=r[c];if(c.startsWith("#")&&o.isFunctionValue(h)){var m=c.substr(1);s.addEventListener(m,h)}else s.hasProperty(c)&&s.setPropValue(c,h)}if(r.htmlClass&&s.addClassName(r.htmlClass,!0),r.children){var g=r.children;if(o.isArrayValue(g))for(var d=0,u=g.length;d<u;++d){var f=g[d],p=e.Widget.Utils.createFromHash(s,f);p&&p.appendToWidget(s)}}return s},setWidgetPropFromElemAttrib:function(t,r,a){var s=r.camelize(),l=t.getPropertyDataType(s);if(l||(r.startsWith("data-")&&(s=r.substr(5).camelize(),l=t.getPropertyDataType(s)),l))if(l===o.STRING)t.setPropValue(s,a);else if(e.PredefinedResReferer.isResValue(a))e.PredefinedResReferer.loadResource(a,function(e,r){t.loadPredefinedResDataToProp&&t.loadPredefinedResDataToProp(s,e,r)},null,t.getDocument());else if(a&&a.startsWith("#")&&n.isOrIsDescendantOf(n.findClass(l),e.Widget.BaseWidget)){var d=a.substr(1).trim();e.Widget.Utils._setWidgetRefPropFromId(t,s,d)}else{var u=JSON.parse(a);if(e.ObjUtils.notUnset(u)){var c=i.ObjSerializerFactory.getSerializer("json").load(null,u);t.setPropValue(s,c)}}},_setWidgetRefPropFromId:function(t,r,i){if(i){var n=e.Widget.getWidgetById(i,t.getDocument());n&&t.setPropValue(r,n)}},getThemeUrl:function(t){var r=null;t||(t="default");var i=e.scriptSrcInfo;if(i){var n=i.path;if(n){r=n+((i.useMinFile?"themes/":"widgets/themes/")+t)+"/kekule.css"}}return r}},e.Widget.getWidgetOnElem=e.Widget.Utils.getWidgetOnElem,e.Widget.getWidgetById=e.Widget.Utils.getWidgetById,e.$W=e.Widget.Utils.getWidgetById,e.Widget.getBelongedWidget=e.Widget.Utils.getBelongedWidget,e.Widget.createFromHash=e.Widget.Utils.createFromHash,e.Widget.BaseEventsReceiver=i.create(a,{CLASS_NAME:"Kekule.Widget.BaseEventsReceiver",initialize:function($super,t,r){this._document=t||e.$jsRoot.document,this._eventRootObj=r||this._document.documentElement,this.reactUiEventBind=this.reactUiEvent.bind(this),this.reactDomNodeInsertEventBind=this.reactDomNodeInsertEvent.bind(this),this.reactDomNodeRemoveEventBind=this.reactDomNodeRemoveEvent.bind(this),$super();var i=this;(function(){e.X.domReady(i.domReadyInit.bind(i),this._document)}).defer()},finalize:function($super){var e=this.getEventRootObj();e&&(this.uninstallGlobalDomMutationHandlers(e),this.uninstallGlobalEventHandlers(e)),$super()},getEventRootObj:function(){return this._eventRootObj},domReadyInit:function(){var e=this.getEventRootObj();e&&(this.installGlobalEventHandlers(e),this.installGlobalDomMutationHandlers(e))},installGlobalEventHandlers:function(t){if(!this._globalEventInstalled){for(var r=e.Widget.UiEvents,i=0,n=r.length;i<n;++i)"touchstart"===r[i]||"touchmove"===r[i]||"touchend"===r[i]?e.X.Event.addListener(t,r[i],this.reactUiEventBind,{passive:!0}):e.X.Event.addListener(t,r[i],this.reactUiEventBind);this._globalEventInstalled=!0}},uninstallGlobalEventHandlers:function(t){for(var r=e.Widget.UiEvents,i=0,n=r.length;i<n;++i)e.X.Event.removeListener(t,r[i],this.reactUiEventBind)},installGlobalDomMutationHandlers:function(t){var r=this;if(e.X.MutationObserver&&e.DomUtils.isElement(t)){var i=new e.X.MutationObserver(function(e){r.reactDomMutation(e)});i.observe(t,{childList:!0,subtree:!0}),this._domMutationObserver=i}else e.X.Event.addListener(t,"DOMNodeInserted",this.reactDomNodeInsertEventBind),e.X.Event.addListener(t,"DOMNodeRemoved",this.reactDomNodeRemoveEventBind)},uninstallGlobalDomMutationHandlers:function(t){this._domMutationObserver&&this._domMutationObserver.disconnect(),this._reactDomNodeInserted&&e.X.Event.removeListener(t,"DOMNodeInserted",this.reactDomNodeInsertEventBind),this._reactDomNodeRemoved&&e.X.Event.removeListener(t,"DOMNodeRemoved",this.reactDomNodeRemoveEventBind)},reactUiEvent:function(e){},reactDomNodeInsertEvent:function(e){},reactDomNodeRemoveEvent:function(e){},reactDomMutation:function(e){}}),e.Widget.GlobalManager=i.create(e.Widget.BaseEventsReceiver,{CLASS_NAME:"Kekule.Widget.GlobalManager",INFO_FIELD:"__$info__",ISOLATED_LAYER_FIELD:"__$isolated_layer__",TOPMOST_LAYER_FIELD:"__$topmost_layer__",THEME_LOADED_FIELD:"__$theme_loaded__",initialize:function($super,t){this._document=t||e.$document,this._touchEventSeq=[],this._hammertime=null,this._globalSysElems=[],this.setPropStoreFieldValue("popupWidgets",[]),this.setPropStoreFieldValue("dialogWidgets",[]),this.setPropStoreFieldValue("modalWidgets",[]),this.setPropStoreFieldValue("autoResizeWidgets",[]),this.setPropStoreFieldValue("widgets",[]),this.setPropStoreFieldValue("draggingElems",[]),this.setPropStoreFieldValue("preserveWidgetList",!0),this.setPropStoreFieldValue("enableMouseEventToPointerPolyfill",!0),this.setPropStoreFieldValue("enableHammerGesture",!1),this.reactTouchGestureBind=this.reactTouchGesture.bind(this),this.reactWindowResizeBind=this.reactWindowResize.bind(this),$super(this._document,this._document.documentElement)},finalize:function($super){this.uninstallWindowEventHandlers(e.DocumentUtils.getDefaultView(this._document)),this._hammertime=null,this.setPropStoreFieldValue("popupWidgets",null),this.setPropStoreFieldValue("widgets",null),this.setPropStoreFieldValue("draggingElems",null),$super()},initProperties:function(){this.defineProp("mouseCaptureWidget",{dataType:o.OBJECT,serializable:!1}),this.defineProp("popupWidgets",{dataType:o.ARRAY,serializable:!1}),this.defineProp("dialogWidgets",{dataType:o.ARRAY,serializable:!1}),this.defineProp("modalWidgets",{dataType:o.ARRAY,serializable:!1}),this.defineProp("autoResizeWidgets",{dataType:o.ARRAY,serializable:!1}),this.defineProp("draggingElems",{dataType:o.ARRAY,serializable:!1}),this.defineProp("preserveWidgetList",{dataType:o.BOOL,serializable:!1,setter:function(e){this.setPropStoreFieldValue("preserveWidgetList",e),e||this.setPropStoreFieldValue("widgets",[])}}),this.defineProp("widgets",{dataType:o.ARRAY,serializable:!1,setter:null}),this.defineProp("currHoverWidget",{dataType:"Kekule.Widget.BaseWidget",serializable:!1}),this.defineProp("currActiveWidget",{dataType:"Kekule.Widget.BaseWidget",serializable:!1}),this.defineProp("currFocusedWidget",{dataType:"Kekule.Widget.BaseWidget",serializable:!1}),this.defineProp("modalBackgroundElem",{dataType:o.OBJECT,serializable:!1,setter:null}),this.defineProp("enableHammerGesture",{dataType:o.BOOL,serializable:!1}),this.defineProp("enableMouseEventToPointerPolyfill",{dataType:o.BOOL,serializable:!1})},domReadyInit:function($super){$super(),this.getEnableHammerGesture()&&(this._hammertime=this.installGlobalHammerTouchHandlers(this._document.body)),this.installWindowEventHandlers(e.DocumentUtils.getDefaultView(this._document))},getDefaultContextRootElem:function(){return this.getDocContextRootElem()},getDocContextRootElem:function(){return this._document.body},_detectIfThemeLoaded:function(t){var r=t[this.THEME_LOADED_FIELD];if(!r){var i=t.ownerDocument,n=i.createElement("span");n.className="K-StyleSheet-Detector",n.style.visibility="hidden",t.appendChild(n);-88888==e.StyleUtils.getComputedStyle(n,"z-index")?(r=!0,t[this.THEME_LOADED_FIELD]=r):r=!1,t.removeChild(n)}return r},loadTheme:function(t,r){if(t||(t=this.getDefaultContextRootElem()),!this._detectIfThemeLoaded(t)){var i=e.Widget.Utils.getThemeUrl(r),n=t.ownerDocument,a=n.createElement("style");a.innerHTML='@import "'+i+'"',t.appendChild(a),t[this.THEME_LOADED_FIELD]=!0}},notifyWidgetCreated:function(e){this.getPreserveWidgetList()&&this.getWidgets().push(e),this.invokeEvent("widgetCreate",{widget:e})},notifyWidgetFinalized:function(t){this.getWidgets()&&e.ArrayUtils.remove(this.getWidgets(),t),this.getPopupWidgets()&&e.ArrayUtils.remove(this.getPopupWidgets(),t),this.getDialogWidgets()&&e.ArrayUtils.remove(this.getDialogWidgets(),t),this.getAutoResizeWidgets()&&e.ArrayUtils.remove(this.getAutoResizeWidgets(),t),t===this.getCurrActiveWidget()&&this.setCurrActiveWidget(null),t===this.getCurrFocusedWidget()&&this.setCurrFocusedWidget(null),this.invokeEvent("widgetFinalize",{widget:t})},notifyWidgetHoverChanged:function(e,t){var r=this.getCurrHoverWidget();t?e!==r&&(r&&r.setIsHover(!1),this.setCurrHoverWidget(e)):r===e&&this.setCurrHoverWidget(null)},notifyWidgetActiveChanged:function(e,t){var r=this.getCurrActiveWidget();t?e!==r&&(r&&r.setIsActive(!1),this.setCurrActiveWidget(e)):r===e&&this.setCurrActiveWidget(null)},notifyWidgetFocusChanged:function(e,t){var r=this.getCurrFocusedWidget();t?e!==r&&(r&&r.setIsFocused(!1),this.setCurrFocusedWidget(e)):r===e&&this.setCurrFocusedWidget(null)},hasPopupWidgets:function(){return!!this.getPopupWidgets().length},hasDialogWidgets:function(){return!!this.getDialogWidgets().length},getBelongedResponsiveWidget:function(t){return e.Widget.Utils.getBelongedResponsiveWidget(t)},notifyWidgetEventFired:function(e,t,r){var i=Object.extend({},r);i.widget=e,this.invokeEvent(t,i)},installWindowEventHandlers:function(t){e.X.Event.addListener(t,"resize",this.reactWindowResizeBind)},uninstallWindowEventHandlers:function(t){e.X.Event.removeListener(t,"resize",this.reactWindowResizeBind)},installGlobalHammerTouchHandlers:function(r){if(void 0!==e.$jsRoot.Hammer){var i=new t(r);return i.get("pinch").set({enable:!0}),i.get("rotate").set({enable:!0}),i.on(e.Widget.TouchGestures.join(" "),this.reactTouchGestureBind),this._hammertime=i,i}},uninstallGlobalHammerTouchHandlers:function(t){this._hammertime&&this._hammertime.off(e.Widget.TouchGestures.join(" "),this.reactTouchGestureBind)},_handleDomAddedElem:function(t){for(var r=e.Widget.Utils.getWidgetsInsideElem(t,!0),i=0,n=r.length;i<n;++i){var a=r[i];a.insertedToDom()}var a=e.Widget.Utils.getBelongedWidget(t);a&&(a.getElement()===t?a.insertedToDom():a.domElemAdded(t))},_handleDomRemovedElem:function(t){for(var r=e.Widget.Utils.getWidgetsInsideElem(t,!0),i=0,n=r.length;i<n;++i){var a=r[i];a.removedFromDom()}var a=e.Widget.Utils.getBelongedWidget(t);a&&a.domElemRemoved(t)},isMouseEvent:function(e){return e.startsWith("mouse")||"click"===e},isTouchEvent:function(e){return e.startsWith("touch")},isPointerEvent:function(e){return e.startsWith("pointer")},mapTouchToPointerEvent:function(t){var r=t.getType(),i=t;i.pointerType="touch";var n;if("touchstart"===r?n="pointerdown":"touchmove"===r?n="pointermove":"touchleave"===r?n="pointerout":"touchend"===r&&(n="pointerup"),n){i.setType(n),i.button=e.X.Event.MouseButton.LEFT;var a=t.touches[0],o=["clientX","clientY","pageX","pageY","screenX","screenY"];if(a){for(var s={},l=0,d=o.length;l<d;++l){var u=o[l];i[u]=a[u],s[u]=a[u]}var c=(this._document,this._retrieveTouchEventActualTarget(i));i.setTarget(c),this._touchPointerMapData={positionCache:s,targetCache:i.getTarget()}}else{if(this._touchPointerMapData)for(var l=0,d=o.length;l<d;++l){var u=o[l];i[u]=this._touchPointerMapData.positionCache[u]}i.setTarget(this._touchPointerMapData.targetCache)}return i}return null},_retrieveTouchEventActualTarget:function(e){var t=e.getTarget();return this._retrieveElementFromClientCoord(t,e.getClientX(),e.getClientY())},_retrieveElementFromClientCoord:function(e,t,r){var i=e;if(e.shadowRoot&&e.getRootNode){var n=e.shadowRoot;if(n.elementFromPoint){var a=n.elementFromPoint(t,r);a&&a!==e&&(i=this._retrieveElementFromClientCoord(a,t,r))}}return i},reactDomNodeInsertEvent:function($super,e){$super(e);var t=e.getTarget();t.nodeType===Node.ELEMENT_NODE&&(this._isGlobalSysElement(t)||this._handleDomAddedElem(t))},reactDomNodeRemoveEvent:function($super,e){$super(e);var t=e.getTarget();t.nodeType===Node.ELEMENT_NODE&&(this._isGlobalSysElement(t)||this._handleDomRemovedElem(t))},reactDomMutation:function($super,e){$super(e);for(var t=0,r=e.length;t<r;++t){var i=e[t];if("childList"===i.type){for(var n=i.addedNodes,a=0,o=n.length;a<o;++a){var s=n[a];s.nodeType===Node.ELEMENT_NODE&&(this._isGlobalSysElement(s)||this._handleDomAddedElem(s))}for(var n=i.removedNodes,a=0,o=n.length;a<o;++a){var s=n[a];s.nodeType===Node.ELEMENT_NODE&&(this._isGlobalSysElement(s)||this._handleDomRemovedElem(s))}}}},reactUiEvent:function($super,t){$super(t);var r,i=t.getType();if(this.getMouseCaptureWidget()&&(this.isMouseEvent(i)||this.isTouchEvent(i)||this.isPointerEvent(i)))r=this.getMouseCaptureWidget(),!0;else{var n=t.getTarget();r=this.getBelongedResponsiveWidget(n)}if("touchstart"===i)this._touchEventSeq=["touchstart"],this._touchDoneTimeStamp=null;else if("touchcancel"===i)this._touchEventSeq=[];else if("touchend"===i)"touchstart"===this._touchEventSeq[0]&&(this._touchEventSeq.push("touchend"),this._touchDoneTimeStamp=Date.now());else if(["mousedown","mouseup","mouseover","mouseout","click"].indexOf(i)>=0)if("touchstart"===this._touchEventSeq[0]&&"touchend"===this._touchEventSeq[1])t.ghostMouseEvent=!0,"click"===i&&(this._touchEventSeq=[],this._touchDoneTimeStamp=Date.now());else if(this._touchDoneTimeStamp){var a=Date.now();a-this._touchDoneTimeStamp<1e3&&(t.ghostMouseEvent=!0)}if(this.doReactUiEvent(t,r),!t.ghostMouseEvent&&!e.BrowserFeature.pointerEvent&&this.getEnableMouseEventToPointerPolyfill()){var o=["mousedown","mousemove","mouseout","mouseover","mouseup"],s=["touchstart","touchmove","touchleave","touchend","touchcancel"],l=["pointerdown","pointermove","pointerout","pointerover","pointerup"],d=o.indexOf(i);if(d>=0)t.setType(l[d]),t.pointerType="mouse",this.doReactUiEvent(t,r);else if(s.indexOf(i)>=0){var u=this.mapTouchToPointerEvent(t);u&&this.reactUiEvent(u)}}},doReactUiEvent:function(t,r){var i=e.Widget.getEventHandleFuncName(t.getType());this[i]&&this[i](t),r&&(this._htmlEventOnWidgetInvoked(r,t),r.reactUiEvent(t))},reactTouchGesture:function(t){var r=e.Widget.getTouchGestureHandleFuncName(t.getType&&t.getType()||t.type);this[r]&&this[r](t);var i=e.Widget.getBelongedWidget(t.target);i&&i.reactTouchGesture(t)},reactWindowResize:function(e){for(var t=this.getAutoResizeWidgets(),r=0,i=t.length;r<i;++r)t[r].isShown()&&t[r].autoResizeToClient()},_htmlEventOnWidgetInvoked:function(e,t){this.invokeEvent("htmlEventOnWidget",{widget:e,htmlEvent:t}),this.invokeEvent(t.getType(),{widget:e,htmlEvent:t})},_startPointerHolderTimer:function(t){var r=this;return this._pointerHolderTimer={pointerType:t.pointerType,button:t.getButton(),coord:{x:t.getClientX(),y:t.getClientY()},target:t.getTarget(),_timeoutId:setTimeout(function(){var e=t;e.setType("pointerhold"),r._pointerHolderTimer=null,r.reactUiEvent(e)},e.Widget._PointerHoldParams.DURATION_THRESHOLD),cancel:function(){clearTimeout(r._pointerHolderTimer._timeoutId),r._pointerHolderTimer=null}},this._pointerHolderTimer},react_pointerdown:function(t){if(this.hasPopupWidgets()&&!t.ghostMouseEvent&&t.getButton()===e.X.Event.MouseButton.LEFT){var r=t.getTarget();this.hidePopupWidgets(r)}this._pointerHolderTimer?t.pointerType===this._pointerHolderTimer.pointerType&&t.getButton()===this._pointerHolderTimer.button||this._pointerHolderTimer.cancel():this._startPointerHolderTimer(t)},react_pointerup:function(e){this._pointerHolderTimer&&this._pointerHolderTimer.cancel()},react_pointermove:function(t){if(this._pointerHolderTimer)if(t.getTarget()!==this._pointerHolderTimer.target)this._pointerHolderTimer.cancel();else{var r=this._pointerHolderTimer.coord,i={x:t.getClientX(),y:t.getClientY()};e.CoordUtils.getDistance(r,i)>e.Widget._PointerHoldParams.MOVEMENT_THRESHOLD&&this._pointerHolderTimer.cancel()}},react_keydown:function(t){t.getKeyCode()===e.X.Event.KeyCode.ESC&&(this.hasPopupWidgets()?this.hidePopupWidgets(null,!0):this.hasDialogWidgets()&&this.hideTopmostDialogWidget(null,!0))},react_touchstart:function(e){if(this.hasPopupWidgets()){var t=e.getTarget();this.hidePopupWidgets(t)}},react_dragstart:function(t){this._clearDraggingElems();var r=t.getTarget();if(r&&t.dataTransfer){var i=this._appendDraggingElem(r);if(t.dataTransfer.setData)try{t.dataTransfer.setData(e.Widget.DragDrop.ELEM_INDEX_DATA_TYPE,""+i)}catch(t){}var n=e.Widget.getBelongedWidget(r);n&&n.dragStart({htmlEvent:t,dataTransfer:t.dataTransfer,startingElem:r})}},react_dragend:function(t){var r=t.getTarget();if(r){var i=e.Widget.getBelongedWidget(r);i&&i.dragEnd({htmlEvent:t,dataTransfer:t.dataTransfer,startingElem:r})}this._dragDone(t)},react_dragover:function(t){var r=t.getTarget(),i=this._getNearestDragDropDestWidget(e.Widget.getBelongedWidget(r));if(i&&i.getDroppable()&&t.dataTransfer){var n=this._getElemAndWidgetInDraggingTransfer(t.dataTransfer),a={htmlEvent:t,dataTransfer:t.dataTransfer,srcElem:n.elem,srcWidget:n.widget};i.acceptDragSrc(a)&&(t.preventDefault(),i.dragOver(a))}},react_dragleave:function(t){var r=t.getTarget(),i=this._getNearestDragDropDestWidget(e.Widget.getBelongedWidget(r));if(i&&i.getDroppable()&&t.dataTransfer){var n=this._getElemAndWidgetInDraggingTransfer(t.dataTransfer),a={htmlEvent:t,dataTransfer:t.dataTransfer,srcElem:n.elem,srcWidget:n.widget};i.acceptDragSrc(a)&&i.dragLeave(a)}},react_drop:function(t){var r=t.getTarget(),i=this._getNearestDragDropDestWidget(e.Widget.getBelongedWidget(r));if(i&&i.getDroppable()){var n=this._getElemAndWidgetInDraggingTransfer(t.dataTransfer),a={htmlEvent:t,dataTransfer:t.dataTransfer,srcElem:n.elem,srcWidget:n.widget};i.acceptDragSrc(a)&&i.dragDrop(a)&&t.preventDefault()}this._dragDone(t)},_dragDone:function(e){this._clearDraggingElems();var t=e.dataTransfer;t&&(t.items?t.items.clear():t.clearData())},_getNearestDragDropDestWidget:function(e){if(!e)return null;if(e.getDroppable())return e;var t=e.getParent();return t&&this._getNearestDragDropDestWidget(t)},_getElemAndWidgetInDraggingTransfer:function(t){var r,i;if(t.getData){try{var n=t.getData(e.Widget.DragDrop.ELEM_INDEX_DATA_TYPE);if(e.ObjUtils.notUnset(n)){var a=parseInt(n)||0;r=this.getDraggingElems()[a]}}catch(e){var o=this.getDraggingElems();o&&1===o.length&&(r=o[0])}r&&(i=e.Widget.getBelongedWidget(r))}return{elem:r,widget:i}},_clearDraggingElems:function(){this.setPropStoreFieldValue("draggingElems",[])},_appendDraggingElem:function(e){var t=this.getDraggingElems();return t.push(e),t.length-1},unpreparePopupWidget:function(e){e.setPopupCaller(null),this.restoreElem(e.getElement())},preparePopupWidget:function(t,r,i){t.setPopupCaller(r);var n,a,o=t.getElement(),s=o.ownerDocument,l=this.getWidgetContextRootElement(r),d=this.getTopmostLayer(s,!0,l),u=o.parentNode===d,c=e.Widget.ShowHideType,h=t.getAutoAdjustSizeOnPopup();if(i===c.DROPDOWN?(a=e.StyleUtils.isSelfOrAncestorPositionFixed(r.getElement()),n=this._calcDropDownWidgetPosInfo(t,r,a)):n=this._calcPopupWidgetPosInfo(t,r,u),h&&n){var m=r||t,s=m.getDocument?m.getDocument():m.ownerDocument,g=e.DocumentUtils.getClientVisibleBox(s),f=g.right-g.left,p=g.bottom-g.top,C=n.rect;C.left+C.width>f+g.left&&(n.width=g.right-C.left+"px",n.widthChanged=!0),C.top+C.height>p+g.top&&(n.height=g.bottom-C.top+"px",n.heightChanged=!0)}if(u?this.moveElemToTopmostLayer(o,!0,l):this.moveElemToTopmostLayer(o,null,l),n){var b=["left","top","right","bottom"];n.widthChanged&&b.push("width"),n.heightChanged&&b.push("height");var E={},N=o.style;i===c.DROPDOWN&&a?N.position="fixed":e.StyleUtils.isAbsOrFixPositioned(o)||(N.position="absolute");for(var T=0,O=b.length;T<O;++T){var _=b[T],S=n[_];S&&(E[_]=N[_]||"",N[_]=S)}this._getElemStoredInfo(o).styles=E}},_calcPopupWidgetPosInfo:function(t,r,i){var n,a=e.HtmlElementUtils,o=t.getElement();t.isShown()||(o.style.visible="hidden",o.style.display="");var s,l=!1;if(!e.DomUtils.isInDomTree(o,null,{acrossShadowRoot:!0})){var d=this.getWidgetContextRootElement(r);s=this.getIsolatedLayer(t.getDocument(),!0,d),s.appendChild(o),l=!0}var u=a.getElemBoundingClientRect(o,!0);return n={rect:u},i||"fixed"!==e.StyleUtils.getComputedStyle(o,"position")&&(n.top=u.top+"px",n.left=u.left+"px"),l&&s.removeChild(o),n},_calcDropDownWidgetPosInfo:function(t,r,i){var n=e.HtmlElementUtils,a=e.Widget.Position,o=r.getDropPosition?r.getDropPosition():null,s=r.getParent(),l=s&&s.getLayout()||e.Widget.Layout.HORIZONTAL,d=r.getElement(),u=this.getWidgetContextRootElement(r),c=n.getElemBoundingClientRect(d,!0),h=e.DocumentUtils.getClientVisibleBox(r.getDocument()),m=t.getElement();m.style.visible="hidden",m.style.display="";var g=!1,f=this.getIsolatedLayer(m.ownerDocument,!0,u);f.appendChild(m),g=!0,m.style.position="relative";var p=n.getElemOffsetDimension(m),C=n.getElemScrollDimension(m),b=n.getElemPageRect(m,!0);if(m.style.position="absolute",g&&f.removeChild(m),!o||o===a.AUTO)if(o=0,l===e.Widget.Layout.VERTICAL){var E=c.x-h.left,N=h.right-c.x-c.width;N>=p.width?o|=a.RIGHT:o|=E>N?a.LEFT:a.RIGHT}else{var T=c.y-h.top,O=h.bottom-c.y-c.height;O>=p.height?o|=a.BOTTOM:o|=T>O?a.TOP:a.BOTTOM}var _,c=(e.StyleUtils,n.getElemBoundingClientRect(d,!i)),S=C.width,v=C.height;if(o&a.LEFT)_=c.left-b.width;else if(o&a.RIGHT)_=c.right;else{var y=c.right-h.left,A=h.right-c.left;_=A>=b.width?c.left:y>=b.width?c.right-b.width:Math.max(h.left,h.right-b.width)}var M;if(o&a.TOP)M=c.top-b.height;else if(o&a.BOTTOM)M=c.bottom;else{var I=c.bottom-h.top,R=h.bottom-c.top;M=R>=b.height?c.bottom:I>=b.height?c.bottom-b.height:Math.max(h.top,h.bottom-b.height)}var L={};return L.rect={left:_,top:M,width:S,height:v},_+="px",M+="px",S+="px",v+="px",L.left=_,L.top=M,L.width=S,L.height=v,L},_fillPersistentPopupWidgetsInHidden:function(t,r,i,n){n.push(t);var a,o,s;try{t&&t instanceof e.Widget.BaseWidget?(a=t.getElement(),o=t.getParent(),s=t.getPopupCaller()):a=t instanceof HTMLElement?t:null}catch(e){a=null}if(a){for(var l=0,d=r.length;l<d;++l){var u=r[l];if(u===t)i.push(u);else{var c=u.getElement();e.DomUtils.isDescendantOf(a,c)&&i.push(u)}}o&&n.indexOf(o)<=0&&this._fillPersistentPopupWidgetsInHidden(o,r,i,n),s&&n.indexOf(s)<=0&&this._fillPersistentPopupWidgetsInHidden(s,r,i,n)}},hidePopupWidgets:function(t,r){var i=this.getPopupWidgets(),n=e.Widget.getBelongedWidget(t),a=[];n&&this._fillPersistentPopupWidgetsInHidden(n,i,a,[]);for(var o=i.length-1;o>=0;--o){var s=i[o],l=s.getElement();if(l){if(a.indexOf(s)>=0)continue;t&&(l===t||e.DomUtils.isDescendantOf(t,l))||(r?s.dismiss():s.hide())}else e.ArrayUtils.remove(this.getPopupWidgets(),s)}},hideTopmostDialogWidget:function(t,r){var i=this.getDialogWidgets()||[],n=i[i.length-1];if(n){n.getElement()?r?n.dismiss():n.hide():e.ArrayUtils.remove(this.geDialogWidgets(),n)}},registerPopupWidget:function(t){t.addClassName(d.SHOW_POPUP),e.ArrayUtils.pushUnique(this.getPopupWidgets(),t)},unregisterPopupWidget:function(t){t.removeClassName(d.SHOW_POPUP),e.ArrayUtils.remove(this.getPopupWidgets(),t)},registerDialogWidget:function(t){t.addClassName(d.SHOW_DIALOG),e.ArrayUtils.pushUnique(this.getDialogWidgets(),t)},unregisterDialogWidget:function(t){t.removeClassName(d.SHOW_DIALOG),e.ArrayUtils.remove(this.getDialogWidgets(),t)},registerModalWidget:function(t){var r=this.getCurrModalWidget();r&&r.removeClassName(d.SHOW_ACTIVE_MODAL),e.ArrayUtils.pushUnique(this.getModalWidgets(),t),t.addClassName(d.SHOW_ACTIVE_MODAL)},unregisterModalWidget:function(t){t.removeClassName(d.SHOW_ACTIVE_MODAL),e.ArrayUtils.remove(this.getModalWidgets(),t);var r=this.getCurrModalWidget();r&&r.addClassName(d.SHOW_ACTIVE_MODAL)},getCurrModalWidget:function(){var e=this.getModalWidgets();return e&&e.length?e[0]:null},prepareModalWidget:function(e,t){var r=e.getDocument(),i=this.getModalBackgroundElem();i||(i=r.createElement("div"),i.className=d.MODAL_BACKGROUND,this.setPropStoreFieldValue("modalBackgroundElem",i),this._globalSysElems.push(i));var n=e.getElement();e.setModalInfo({oldParent:n.parentNode,oldSibling:n.nextSibling}),n.parentNode&&n.parentNode.removeChild(n),i.parentNode&&i.parentNode.removeChild(i);var a=this.getWidgetContextRootElement(t);a.appendChild(i),a.appendChild(n),this.registerModalWidget(e)},unprepareModalWidget:function(e){e.getDocument();this.unregisterModalWidget(e);var t=e.getElement().parentNode;t&&t.removeChild(e.getElement());var r=e.getModalInfo();r&&(r.oldParent&&r.oldParent.insertBefore(e.getElement(),r.oldSibling),e.setModalInfo(null));var i=this.getCurrModalWidget(),n=this.getModalBackgroundElem();if(n)if(i){n.parentNode&&n.parentNode.removeChild(n);var a=i.getElement().parentNode;a.insertBefore(n,i.getElement())}else n.parentNode&&n.parentNode.removeChild(n)},registerAutoResizeWidget:function(t){e.ArrayUtils.pushUnique(this.getAutoResizeWidgets(),t)},unregisterAutoResizeWidget:function(t){e.ArrayUtils.remove(this.getAutoResizeWidgets(),t)},getWidgetContextRootElement:function(e){return e&&e.getDocument?e.getDocument().body:this._document.body},getTopmostLayer:function(e,t,r){var e=r.ownerDocument,i=r[this.TOPMOST_LAYER_FIELD];return i?r.lastChild!==i&&r.appendChild(i):t&&(i=this._createTopmostLayer(e,r),r.appendChild(i),r[this.TOPMOST_LAYER_FIELD]=i,this._globalSysElems.push(i)),i},_createTopmostLayer:function(e,t){var r=e.createElement("div");return r.className=d.TOP_LAYER,r},getIsolatedLayer:function(e,t,r){var i=r[this.ISOLATED_LAYER_FIELD];return!i&&t&&(i=this._createIsolatedLayer(e,r),this._globalSysElems.push(i),r.appendChild(i),r[this.ISOLATED_LAYER_FIELD]=i),i},_createIsolatedLayer:function(e,t){var r=e.createElement("div");return r.className=d.ISOLATED_LAYER,r},_isGlobalSysElement:function(e){return this._globalSysElems.indexOf(e)>=0},_getElemStoredInfo:function(e){var t=null;return e&&((t=e[this.INFO_FIELD])||(t={},e[this.INFO_FIELD]=t)),t},_clearElemStoredInfo:function(e){e[this.INFO_FIELD]&&(e[this.INFO_FIELD]=void 0)},moveElemToTopmostLayer:function(e,t,r){if(!t){var i=this._getElemStoredInfo(e);i.parentElem=e.parentNode,i.nextSibling=e.nextSibling}this.getTopmostLayer(e.ownerDocument,!0,r).appendChild(e)},restoreElem:function(t){if(t){var r=this._getElemStoredInfo(t);if(r){for(var i=r.styles,n=e.ObjUtils.getOwnedFieldNames(i),a=t.style,o=0,s=n.length;o<s;++o){var l=n[o],d=i[l];d?a[l]=d:e.StyleUtils.removeStyleProperty(a,l)}r.parentElem&&(r.nextSibling?r.parentElem.insertBefore(t,r.nextSibling):r.parentElem.appendChild(t)),t[this.INFO_FIELD]=null}}}}),e.ClassUtils.makeSingleton(e.Widget.GlobalManager),e.Widget.globalManager=e.Widget.GlobalManager.getInstance(),e}},function(e,t,r){var i;/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */
!function(n,a,o,s){"use strict";function l(e,t,r){return setTimeout(m(e,r),t)}function d(e,t,r){return!!Array.isArray(e)&&(u(e,r[t],r),!0)}function u(e,t,r){var i;if(e)if(e.forEach)e.forEach(t,r);else if(e.length!==s)for(i=0;i<e.length;)t.call(r,e[i],i,e),i++;else for(i in e)e.hasOwnProperty(i)&&t.call(r,e[i],i,e)}function c(e,t,r){var i="DEPRECATED METHOD: "+t+"\n"+r+" AT \n";return function(){var t=new Error("get-stack-trace"),r=t&&t.stack?t.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",a=n.console&&(n.console.warn||n.console.log);return a&&a.call(n.console,i,r),e.apply(this,arguments)}}function h(e,t,r){var i,n=t.prototype;i=e.prototype=Object.create(n),i.constructor=e,i._super=n,r&&ge(i,r)}function m(e,t){return function(){return e.apply(t,arguments)}}function g(e,t){return typeof e==Ce?e.apply(t?t[0]||s:s,t):e}function f(e,t){return e===s?t:e}function p(e,t,r){u(N(t),function(t){e.addEventListener(t,r,!1)})}function C(e,t,r){u(N(t),function(t){e.removeEventListener(t,r,!1)})}function b(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function E(e,t){return e.indexOf(t)>-1}function N(e){return e.trim().split(/\s+/g)}function T(e,t,r){if(e.indexOf&&!r)return e.indexOf(t);for(var i=0;i<e.length;){if(r&&e[i][r]==t||!r&&e[i]===t)return i;i++}return-1}function O(e){return Array.prototype.slice.call(e,0)}function _(e,t,r){for(var i=[],n=[],a=0;a<e.length;){var o=t?e[a][t]:e[a];T(n,o)<0&&i.push(e[a]),n[a]=o,a++}return r&&(i=t?i.sort(function(e,r){return e[t]>r[t]}):i.sort()),i}function S(e,t){for(var r,i,n=t[0].toUpperCase()+t.slice(1),a=0;a<fe.length;){if(r=fe[a],(i=r?r+n:t)in e)return i;a++}return s}function v(){return _e++}function y(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow||n}function A(e,t){var r=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){g(e.options.enable,[e])&&r.handler(t)},this.init()}function M(e){var t=e.options.inputClass;return new(t||(ye?V:Ae?K:ve?Y:W))(e,I)}function I(e,t,r){var i=r.pointers.length,n=r.changedPointers.length,a=t&Ie&&i-n==0,o=t&(Le|xe)&&i-n==0;r.isFirst=!!a,r.isFinal=!!o,a&&(e.session={}),r.eventType=t,R(e,r),e.emit("hammer.input",r),e.recognize(r),e.session.prevInput=r}function R(e,t){var r=e.session,i=t.pointers,n=i.length;r.firstInput||(r.firstInput=D(t)),n>1&&!r.firstMultiple?r.firstMultiple=D(t):1===n&&(r.firstMultiple=!1);var a=r.firstInput,o=r.firstMultiple,s=o?o.center:a.center,l=t.center=P(i);t.timeStamp=Ne(),t.deltaTime=t.timeStamp-a.timeStamp,t.angle=U(s,l),t.distance=k(s,l),L(r,t),t.offsetDirection=w(t.deltaX,t.deltaY);var d=B(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=d.x,t.overallVelocityY=d.y,t.overallVelocity=Ee(d.x)>Ee(d.y)?d.x:d.y,t.scale=o?F(o.pointers,i):1,t.rotation=o?j(o.pointers,i):0,t.maxPointers=r.prevInput?t.pointers.length>r.prevInput.maxPointers?t.pointers.length:r.prevInput.maxPointers:t.pointers.length,x(r,t);var u=e.element;b(t.srcEvent.target,u)&&(u=t.srcEvent.target),t.target=u}function L(e,t){var r=t.center,i=e.offsetDelta||{},n=e.prevDelta||{},a=e.prevInput||{};t.eventType!==Ie&&a.eventType!==Le||(n=e.prevDelta={x:a.deltaX||0,y:a.deltaY||0},i=e.offsetDelta={x:r.x,y:r.y}),t.deltaX=n.x+(r.x-i.x),t.deltaY=n.y+(r.y-i.y)}function x(e,t){var r,i,n,a,o=e.lastInterval||t,l=t.timeStamp-o.timeStamp;if(t.eventType!=xe&&(l>Me||o.velocity===s)){var d=t.deltaX-o.deltaX,u=t.deltaY-o.deltaY,c=B(l,d,u);i=c.x,n=c.y,r=Ee(c.x)>Ee(c.y)?c.x:c.y,a=w(d,u),e.lastInterval=t}else r=o.velocity,i=o.velocityX,n=o.velocityY,a=o.direction;t.velocity=r,t.velocityX=i,t.velocityY=n,t.direction=a}function D(e){for(var t=[],r=0;r<e.pointers.length;)t[r]={clientX:be(e.pointers[r].clientX),clientY:be(e.pointers[r].clientY)},r++;return{timeStamp:Ne(),pointers:t,center:P(t),deltaX:e.deltaX,deltaY:e.deltaY}}function P(e){var t=e.length;if(1===t)return{x:be(e[0].clientX),y:be(e[0].clientY)};for(var r=0,i=0,n=0;n<t;)r+=e[n].clientX,i+=e[n].clientY,n++;return{x:be(r/t),y:be(i/t)}}function B(e,t,r){return{x:t/e||0,y:r/e||0}}function w(e,t){return e===t?De:Ee(e)>=Ee(t)?e<0?Pe:Be:t<0?we:ke}function k(e,t,r){r||(r=We);var i=t[r[0]]-e[r[0]],n=t[r[1]]-e[r[1]];return Math.sqrt(i*i+n*n)}function U(e,t,r){r||(r=We);var i=t[r[0]]-e[r[0]],n=t[r[1]]-e[r[1]];return 180*Math.atan2(n,i)/Math.PI}function j(e,t){return U(t[1],t[0],Ve)+U(e[1],e[0],Ve)}function F(e,t){return k(t[0],t[1],Ve)/k(e[0],e[1],Ve)}function W(){this.evEl=Ge,this.evWin=Ke,this.pressed=!1,A.apply(this,arguments)}function V(){this.evEl=Xe,this.evWin=$e,A.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function H(){this.evTarget=Ze,this.evWin=qe,this.started=!1,A.apply(this,arguments)}function G(e,t){var r=O(e.touches),i=O(e.changedTouches);return t&(Le|xe)&&(r=_(r.concat(i),"identifier",!0)),[r,i]}function K(){this.evTarget=et,this.targetIds={},A.apply(this,arguments)}function z(e,t){var r=O(e.touches),i=this.targetIds;if(t&(Ie|Re)&&1===r.length)return i[r[0].identifier]=!0,[r,r];var n,a,o=O(e.changedTouches),s=[],l=this.target;if(a=r.filter(function(e){return b(e.target,l)}),t===Ie)for(n=0;n<a.length;)i[a[n].identifier]=!0,n++;for(n=0;n<o.length;)i[o[n].identifier]&&s.push(o[n]),t&(Le|xe)&&delete i[o[n].identifier],n++;return s.length?[_(a.concat(s),"identifier",!0),s]:void 0}function Y(){A.apply(this,arguments);var e=m(this.handler,this);this.touch=new K(this.manager,e),this.mouse=new W(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}function X(e,t){e&Ie?(this.primaryTouch=t.changedPointers[0].identifier,$.call(this,t)):e&(Le|xe)&&$.call(this,t)}function $(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var r={x:t.clientX,y:t.clientY};this.lastTouches.push(r);var i=this.lastTouches,n=function(){var e=i.indexOf(r);e>-1&&i.splice(e,1)};setTimeout(n,tt)}}function J(e){for(var t=e.srcEvent.clientX,r=e.srcEvent.clientY,i=0;i<this.lastTouches.length;i++){var n=this.lastTouches[i],a=Math.abs(t-n.x),o=Math.abs(r-n.y);if(a<=rt&&o<=rt)return!0}return!1}function Z(e,t){this.manager=e,this.set(t)}function q(e){if(E(e,st))return st;var t=E(e,lt),r=E(e,dt);return t&&r?st:t||r?t?lt:dt:E(e,ot)?ot:at}function Q(e){this.options=ge({},this.defaults,e||{}),this.id=v(),this.manager=null,this.options.enable=f(this.options.enable,!0),this.state=ct,this.simultaneous={},this.requireFail=[]}function ee(e){return e&pt?"cancel":e&gt?"end":e&mt?"move":e&ht?"start":""}function te(e){return e==ke?"down":e==we?"up":e==Pe?"left":e==Be?"right":""}function re(e,t){var r=t.manager;return r?r.get(e):e}function ie(){Q.apply(this,arguments)}function ne(){ie.apply(this,arguments),this.pX=null,this.pY=null}function ae(){ie.apply(this,arguments)}function oe(){Q.apply(this,arguments),this._timer=null,this._input=null}function se(){ie.apply(this,arguments)}function le(){ie.apply(this,arguments)}function de(){Q.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function ue(e,t){return t=t||{},t.recognizers=f(t.recognizers,ue.defaults.preset),new ce(e,t)}function ce(e,t){this.options=ge({},ue.defaults,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=M(this),this.touchAction=new Z(this,this.options.touchAction),he(this,!0),u(this.options.recognizers,function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])},this)}function he(e,t){var r=e.element;if(r.style){var i;u(e.options.cssProps,function(n,a){i=S(r.style,a),t?(e.oldCssProps[i]=r.style[i],r.style[i]=n):r.style[i]=e.oldCssProps[i]||""}),t||(e.oldCssProps={})}}function me(e,t){var r=a.createEvent("Event");r.initEvent(e,!0,!0),r.gesture=t,t.target.dispatchEvent(r)}var ge,fe=["","webkit","Moz","MS","ms","o"],pe=a.createElement("div"),Ce="function",be=Math.round,Ee=Math.abs,Ne=Date.now;ge="function"!=typeof Object.assign?function(e){if(e===s||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),r=1;r<arguments.length;r++){var i=arguments[r];if(i!==s&&null!==i)for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])}return t}:Object.assign;var Te=c(function(e,t,r){for(var i=Object.keys(t),n=0;n<i.length;)(!r||r&&e[i[n]]===s)&&(e[i[n]]=t[i[n]]),n++;return e},"extend","Use `assign`."),Oe=c(function(e,t){return Te(e,t,!0)},"merge","Use `assign`."),_e=1,Se=/mobile|tablet|ip(ad|hone|od)|android/i,ve="ontouchstart"in n,ye=S(n,"PointerEvent")!==s,Ae=ve&&Se.test(navigator.userAgent),Me=25,Ie=1,Re=2,Le=4,xe=8,De=1,Pe=2,Be=4,we=8,ke=16,Ue=Pe|Be,je=we|ke,Fe=Ue|je,We=["x","y"],Ve=["clientX","clientY"];A.prototype={handler:function(){},init:function(){this.evEl&&p(this.element,this.evEl,this.domHandler),this.evTarget&&p(this.target,this.evTarget,this.domHandler),this.evWin&&p(y(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&C(this.element,this.evEl,this.domHandler),this.evTarget&&C(this.target,this.evTarget,this.domHandler),this.evWin&&C(y(this.element),this.evWin,this.domHandler)}};var He={mousedown:Ie,mousemove:Re,mouseup:Le},Ge="mousedown",Ke="mousemove mouseup";h(W,A,{handler:function(e){var t=He[e.type];t&Ie&&0===e.button&&(this.pressed=!0),t&Re&&1!==e.which&&(t=Le),this.pressed&&(t&Le&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:"mouse",srcEvent:e}))}});var ze={pointerdown:Ie,pointermove:Re,pointerup:Le,pointercancel:xe,pointerout:xe},Ye={2:"touch",3:"pen",4:"mouse",5:"kinect"},Xe="pointerdown",$e="pointermove pointerup pointercancel";n.MSPointerEvent&&!n.PointerEvent&&(Xe="MSPointerDown",$e="MSPointerMove MSPointerUp MSPointerCancel"),h(V,A,{handler:function(e){var t=this.store,r=!1,i=e.type.toLowerCase().replace("ms",""),n=ze[i],a=Ye[e.pointerType]||e.pointerType,o="touch"==a,s=T(t,e.pointerId,"pointerId");n&Ie&&(0===e.button||o)?s<0&&(t.push(e),s=t.length-1):n&(Le|xe)&&(r=!0),s<0||(t[s]=e,this.callback(this.manager,n,{pointers:t,changedPointers:[e],pointerType:a,srcEvent:e}),r&&t.splice(s,1))}});var Je={touchstart:Ie,touchmove:Re,touchend:Le,touchcancel:xe},Ze="touchstart",qe="touchstart touchmove touchend touchcancel";h(H,A,{handler:function(e){var t=Je[e.type];if(t===Ie&&(this.started=!0),this.started){var r=G.call(this,e,t);t&(Le|xe)&&r[0].length-r[1].length==0&&(this.started=!1),this.callback(this.manager,t,{pointers:r[0],changedPointers:r[1],pointerType:"touch",srcEvent:e})}}});var Qe={touchstart:Ie,touchmove:Re,touchend:Le,touchcancel:xe},et="touchstart touchmove touchend touchcancel";h(K,A,{handler:function(e){var t=Qe[e.type],r=z.call(this,e,t);r&&this.callback(this.manager,t,{pointers:r[0],changedPointers:r[1],pointerType:"touch",srcEvent:e})}});var tt=2500,rt=25;h(Y,A,{handler:function(e,t,r){var i="touch"==r.pointerType,n="mouse"==r.pointerType;if(!(n&&r.sourceCapabilities&&r.sourceCapabilities.firesTouchEvents)){if(i)X.call(this,t,r);else if(n&&J.call(this,r))return;this.callback(e,t,r)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var it=S(pe.style,"touchAction"),nt=it!==s,at="auto",ot="manipulation",st="none",lt="pan-x",dt="pan-y",ut=function(){if(!nt)return!1;var e={},t=n.CSS&&n.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(r){e[r]=!t||n.CSS.supports("touch-action",r)}),e}();Z.prototype={set:function(e){"compute"==e&&(e=this.compute()),nt&&this.manager.element.style&&ut[e]&&(this.manager.element.style[it]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return u(this.manager.recognizers,function(t){g(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))}),q(e.join(" "))},preventDefaults:function(e){var t=e.srcEvent,r=e.offsetDirection;if(this.manager.session.prevented)return void t.preventDefault();var i=this.actions,n=E(i,st)&&!ut[st],a=E(i,dt)&&!ut[dt],o=E(i,lt)&&!ut[lt];if(n){var s=1===e.pointers.length,l=e.distance<2,d=e.deltaTime<250;if(s&&l&&d)return}return o&&a?void 0:n||a&&r&Ue||o&&r&je?this.preventSrc(t):void 0},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}};var ct=1,ht=2,mt=4,gt=8,ft=gt,pt=16;Q.prototype={defaults:{},set:function(e){return ge(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(d(e,"recognizeWith",this))return this;var t=this.simultaneous;return e=re(e,this),t[e.id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return d(e,"dropRecognizeWith",this)?this:(e=re(e,this),delete this.simultaneous[e.id],this)},requireFailure:function(e){if(d(e,"requireFailure",this))return this;var t=this.requireFail;return e=re(e,this),-1===T(t,e)&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(d(e,"dropRequireFailure",this))return this;e=re(e,this);var t=T(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){function t(t){r.manager.emit(t,e)}var r=this,i=this.state;i<gt&&t(r.options.event+ee(i)),t(r.options.event),e.additionalEvent&&t(e.additionalEvent),i>=gt&&t(r.options.event+ee(i))},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=32},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(this.requireFail[e].state&(32|ct)))return!1;e++}return!0},recognize:function(e){var t=ge({},e);if(!g(this.options.enable,[this,t]))return this.reset(),void(this.state=32);this.state&(ft|pt|32)&&(this.state=ct),this.state=this.process(t),this.state&(ht|mt|gt|pt)&&this.tryEmit(t)},process:function(e){},getTouchAction:function(){},reset:function(){}},h(ie,Q,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},process:function(e){var t=this.state,r=e.eventType,i=t&(ht|mt),n=this.attrTest(e);return i&&(r&xe||!n)?t|pt:i||n?r&Le?t|gt:t&ht?t|mt:ht:32}}),h(ne,ie,{defaults:{event:"pan",threshold:10,pointers:1,direction:Fe},getTouchAction:function(){var e=this.options.direction,t=[];return e&Ue&&t.push(dt),e&je&&t.push(lt),t},directionTest:function(e){var t=this.options,r=!0,i=e.distance,n=e.direction,a=e.deltaX,o=e.deltaY;return n&t.direction||(t.direction&Ue?(n=0===a?De:a<0?Pe:Be,r=a!=this.pX,i=Math.abs(e.deltaX)):(n=0===o?De:o<0?we:ke,r=o!=this.pY,i=Math.abs(e.deltaY))),e.direction=n,r&&i>t.threshold&&n&t.direction},attrTest:function(e){return ie.prototype.attrTest.call(this,e)&&(this.state&ht||!(this.state&ht)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=te(e.direction);t&&(e.additionalEvent=this.options.event+t),this._super.emit.call(this,e)}}),h(ae,ie,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[st]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||this.state&ht)},emit:function(e){if(1!==e.scale){var t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}this._super.emit.call(this,e)}}),h(oe,Q,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[at]},process:function(e){var t=this.options,r=e.pointers.length===t.pointers,i=e.distance<t.threshold,n=e.deltaTime>t.time;if(this._input=e,!i||!r||e.eventType&(Le|xe)&&!n)this.reset();else if(e.eventType&Ie)this.reset(),this._timer=l(function(){this.state=ft,this.tryEmit()},t.time,this);else if(e.eventType&Le)return ft;return 32},reset:function(){clearTimeout(this._timer)},emit:function(e){this.state===ft&&(e&&e.eventType&Le?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=Ne(),this.manager.emit(this.options.event,this._input)))}}),h(se,ie,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[st]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||this.state&ht)}}),h(le,ie,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Ue|je,pointers:1},getTouchAction:function(){return ne.prototype.getTouchAction.call(this)},attrTest:function(e){var t,r=this.options.direction;return r&(Ue|je)?t=e.overallVelocity:r&Ue?t=e.overallVelocityX:r&je&&(t=e.overallVelocityY),this._super.attrTest.call(this,e)&&r&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&Ee(t)>this.options.velocity&&e.eventType&Le},emit:function(e){var t=te(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),h(de,Q,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[ot]},process:function(e){var t=this.options,r=e.pointers.length===t.pointers,i=e.distance<t.threshold,n=e.deltaTime<t.time;if(this.reset(),e.eventType&Ie&&0===this.count)return this.failTimeout();if(i&&n&&r){if(e.eventType!=Le)return this.failTimeout();var a=!this.pTime||e.timeStamp-this.pTime<t.interval,o=!this.pCenter||k(this.pCenter,e.center)<t.posThreshold;this.pTime=e.timeStamp,this.pCenter=e.center,o&&a?this.count+=1:this.count=1,this._input=e;if(0===this.count%t.taps)return this.hasRequireFailures()?(this._timer=l(function(){this.state=ft,this.tryEmit()},t.interval,this),ht):ft}return 32},failTimeout:function(){return this._timer=l(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==ft&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),ue.VERSION="2.0.7",ue.defaults={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,preset:[[se,{enable:!1}],[ae,{enable:!1},["rotate"]],[le,{direction:Ue}],[ne,{direction:Ue},["swipe"]],[de],[de,{event:"doubletap",taps:2},["tap"]],[oe]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};ce.prototype={set:function(e){return ge(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?2:1},recognize:function(e){var t=this.session;if(!t.stopped){this.touchAction.preventDefaults(e);var r,i=this.recognizers,n=t.curRecognizer;(!n||n&&n.state&ft)&&(n=t.curRecognizer=null);for(var a=0;a<i.length;)r=i[a],2===t.stopped||n&&r!=n&&!r.canRecognizeWith(n)?r.reset():r.recognize(e),!n&&r.state&(ht|mt|gt)&&(n=t.curRecognizer=r),a++}},get:function(e){if(e instanceof Q)return e;for(var t=this.recognizers,r=0;r<t.length;r++)if(t[r].options.event==e)return t[r];return null},add:function(e){if(d(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(d(e,"remove",this))return this;if(e=this.get(e)){var t=this.recognizers,r=T(t,e);-1!==r&&(t.splice(r,1),this.touchAction.update())}return this},on:function(e,t){if(e!==s&&t!==s){var r=this.handlers;return u(N(e),function(e){r[e]=r[e]||[],r[e].push(t)}),this}},off:function(e,t){if(e!==s){var r=this.handlers;return u(N(e),function(e){t?r[e]&&r[e].splice(T(r[e],t),1):delete r[e]}),this}},emit:function(e,t){this.options.domEvents&&me(e,t);var r=this.handlers[e]&&this.handlers[e].slice();if(r&&r.length){t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()};for(var i=0;i<r.length;)r[i](t),i++}},destroy:function(){this.element&&he(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},ge(ue,{INPUT_START:Ie,INPUT_MOVE:Re,INPUT_END:Le,INPUT_CANCEL:xe,STATE_POSSIBLE:ct,STATE_BEGAN:ht,STATE_CHANGED:mt,STATE_ENDED:gt,STATE_RECOGNIZED:ft,STATE_CANCELLED:pt,STATE_FAILED:32,DIRECTION_NONE:De,DIRECTION_LEFT:Pe,DIRECTION_RIGHT:Be,DIRECTION_UP:we,DIRECTION_DOWN:ke,DIRECTION_HORIZONTAL:Ue,DIRECTION_VERTICAL:je,DIRECTION_ALL:Fe,Manager:ce,Input:A,TouchAction:Z,TouchInput:K,MouseInput:W,PointerEventInput:V,TouchMouseInput:Y,SingleTouchInput:H,Recognizer:Q,AttrRecognizer:ie,Tap:de,Pan:ne,Swipe:le,Pinch:ae,Rotate:se,Press:oe,on:p,off:C,each:u,merge:Oe,extend:Te,assign:ge,inherit:h,bindFn:m,prefixed:S}),(void 0!==n?n:"undefined"!=typeof self?self:{}).Hammer=ue,(i=function(){return ue}.call(t,r,t,e))!==s&&(e.exports=i)}(window,document)},function(e,t,r){"use strict";e.exports=function(e){var t,r=function(){function e(e){var o=!1;for(var s in t){i.style.fontFamily=e+","+t[s],r.appendChild(i);var l=i.offsetWidth!=n[t[s]]||i.offsetHeight!=a[t[s]];r.removeChild(i),o=o||l}return o}var t=["monospace","sans-serif","serif"],r=document.getElementsByTagName("body")[0],i=document.createElement("span");i.style.fontSize="72px",i.innerHTML="mmmmmmmmmmlli";var n={},a={};for(var o in t)i.style.fontFamily=t[o],r.appendChild(i),n[t[o]]=i.offsetWidth,a[t[o]]=i.offsetHeight,r.removeChild(i);this.detect=e};e.Widget.FontDetector={detect:function(e){var i=t;return i||(i=new r,t=i),i.detect(e)}};var i=["Arial, Helvetica, sans-serif","Georgia, Times New Roman, Times, serif","Courier New, Courier, monospace","Tahoma, Geneva, sans-serif","Trebuchet MS, Arial, Helvetica, sans-serif","Arial Black, Gadget, sans-serif","Palatino Linotype, Book Antiqua, Palatino, serif","Lucida Sans Unicode, Lucida Grande, sans-serif","MS Serif, New York, serif","Lucida Console, Monaco, monospace","Comic Sans MS, cursive"];return e.Widget.FontEnumerator={getAvailableFontFamilies:function(t){t||(t=i);for(var r=[],n=0,a=t.length;n<a;++n){var o=t[n];e.Widget.FontDetector.detect(o)&&r.push(o)}return r}},e}},function(e,t,r){"use strict";var i=r(0).Class,n=(r(0).ClassEx,r(0).ObjectEx),a=r(0).DataType;r(2).ObjSerializerFactory;e.exports=function(e){return e.Widget.Clipboard=i.create(n,{CLASS_NAME:"Kekule.Widget.Clipboard",STORAGE_KEY:"__$kekule_widget_clipboard__",initialize:function($super){if($super(),this._data=new e.MapEx(!0),e.BrowserFeature.localStorage){this._crossPageStorage=window.localStorage,this.setEnableCrossPageClipboard(!0);var t=this;e.X.Event.addListener(window,"storage",function(e){if(t.getEnableCrossPageClipboard()){var r=e.key,i=t._extractSessionDataType(r);i&&t.invokeEvent("setData",{dataType:i,data:t.deserializeData(e.newValue)})}})}},finalize:function($super){this._data.finalize(),$super()},initProperties:function(){this.defineProp("enableCrossPageClipboard",{dataType:a.BOOL})},_useSessionClipboard:function(){return this.getEnableCrossPageClipboard()&&e.BrowserFeature.localStorage},_extractSessionDataType:function(e){return e.startsWith(this.STORAGE_KEY)?e.substr(this.STORAGE_KEY.length):null},serializeData:function(e){var t;if(a.isSimpleValue(e))t=JSON.stringify(e);else{var r={};i.ObjSerializerFactory.getSerializer("json").save(e,r),t=JSON.stringify(r)}return t},deserializeData:function(e){var t=JSON.parse(e);return a.isSimpleValue(t)?t:i.ObjSerializerFactory.getSerializer("json").load(null,t)},setData:function(t,r){if(this._useSessionClipboard()){var i,n=this.serializeData(r);try{this._crossPageStorage.setItem(this.STORAGE_KEY+t,n),i=!0}catch(t){e.warn(t)}i||this._data.set(t,r)}else this._data.set(t,r);return this.invokeEvent("setData",{dataType:t,data:r}),this},getData:function(t){if(this._useSessionClipboard()){var r,i;try{r=this._crossPageStorage.getItem(this.STORAGE_KEY+t),i=!0}catch(t){e.warn(t)}if(i)return r?this.deserializeData(r):null}return this._data.get(t)},hasData:function(t){if(this._useSessionClipboard()){var r,i;try{r=this._crossPageStorage.getItem(this.STORAGE_KEY+t),i=!0}catch(t){e.warn(t)}if(i)return e.ObjUtils.notUnset(r)}return e.ObjUtils.notUnset(this._data.get(t))},clearData:function(){if(this._useSessionClipboard())for(var e=this.getTypes(),t=0,r=e.length;t<r;++t)this._crossPageStorage.removeItem(this.STORAGE_KEY+e[t]);else this._data.clear();return this.invokeEvent("setData",{dataType:null,data:null}),this},getTypes:function(){if(this._useSessionClipboard()){for(var e=[],t=0,r=this._crossPageStorage.length;t<r;++t){var i=this._crossPageStorage.key(t),n=this._extractSessionDataType(i);n&&e.push(n)}return e}return this._data.getKeys()},setObjects:function(e,t){for(var r=[],n=i.ObjSerializerFactory.getSerializer("json"),a=0,o=t.length;a<o;++a){var s=t[a],l={};n.save(s,l),r.push(l)}var d=JSON.stringify(r);return this.setData(e,d)},getObjects:function(e){var t=this.getData(e);if(a.isSimpleValue(t)){var r=JSON.parse(t);a.isArrayValue(r)||(r=[r]);for(var n=[],o=i.ObjSerializerFactory.getSerializer("json"),s=0,l=r.length;s<l;++s){var d=r[s],u=o.load(null,d);n.push(u)}return n}return t}}),e.ClassUtils.makeSingleton(e.Widget.Clipboard),e.Widget.clipboard=e.Widget.Clipboard.getInstance(),e}},function(e,t,r){"use strict";var i=r(0).Class,n=r(0).ObjectEx,a=r(0).DataType;e.exports=function(e){e.Widget.EvokeMode={ALWAYS:0,EVOKEE_CLICK:1,EVOKEE_MOUSE_ENTER:2,EVOKEE_MOUSE_LEAVE:3,EVOKEE_MOUSE_DOWN:4,EVOKEE_MOUSE_UP:5,EVOKEE_MOUSE_MOVE:6,EVOKEE_TOUCH:7,EVOKER_CLICK:11,EVOKER_MOUSE_ENTER:12,EVOKER_MOUSE_LEAVE:13,EVOKER_MOUSE_DOWN:14,EVOKER_MOUSE_UP:15,EVOKER_MOUSE_MOVE:16,EVOKER_TOUCH:17,EVOKEE_TIMEOUT:21,EVOKER_TIMEOUT:22};var t=e.Widget.EvokeMode;return e.Widget.DynamicEvokeHelper=i.create(n,{CLASS_NAME:"Kekule.Widget.DynamicEvokeHelper",evokeEvents:["click","mouseenter","mouseleave","mousedown","mouseup","touchstart"],DEF_TIMEOUT:5e3,initialize:function($super,e,t,r,i,n){$super(),this._timeoutRevokeHandle=null,this.reactEvokeEventsBind=this.reactEvokeEvents.bind(this),this.checkTimeoutRevokeBind=this.checkTimeoutRevoke.bind(this),this.setTimeout(n||this.DEF_TIMEOUT),this.setPropStoreFieldValue("evokeModes",r||[]),this.setPropStoreFieldValue("revokeModes",i||[]),this.linkWidgets(e,t)},finalize:function($super){this.unlinkWidgets(this.getEvokee(),this.getEvoker()),$super()},initProperties:function(){this.defineProp("evokee",{dataType:"Kekule.Widget.BaseWidget",serializable:!1,setter:null}),this.defineProp("evoker",{dataType:"Kekule.Widget.BaseWidget",serializable:!1,setter:null}),this.defineProp("evokeModes",{dataType:a.ARRAY}),this.defineProp("revokeModes",{dataType:a.ARRAY}),this.defineProp("timeout",{dataType:a.INT}),this.defineProp("showHideType",{dataType:a.INT})},evoke:function(){this.getEvoker()&&(clearTimeout(this._timeoutRevokeHandle),this.getEvoker().show(this.getEvokee(),null,this.getShowHideType()),this.postponeTimeoutCheck())},revoke:function(){if(this.getEvoker()){clearTimeout(this._timeoutRevokeHandle);this.getEvoker().getDocument().body.focus(),this.getEvoker().hide(this.getEvokee(),null,this.getShowHideType())}},doObjectChange:function($super,t){$super(t),e.ArrayUtils.intersect(t,["evokeModes","revokeModes"]).length>0&&this.evokeModesChanged()},linkWidgets:function(e,t){this.setPropStoreFieldValue("evokee",e),this.setPropStoreFieldValue("evoker",t),this.installEventHandlers(e,this.evokeEvents,this.reactEvokeEventsBind),this.installEventHandlers(t,this.evokeEvents,this.reactEvokeEventsBind),this.updateOnAlwaysMode()},unlinkWidgets:function(e,t){this.uninstallEventHandlers(e,this.evokeEvents,this.reactEvokeEventsBind),this.uninstallEventHandlers(t,this.evokeEvents,this.reactEvokeEventsBind)},installEventHandlers:function(e,t,r){for(var i=0,n=t.length;i<n;++i)e.addEventListener(t[i],r)},uninstallEventHandlers:function(e,t,r){for(var i=0,n=t.length;i<n;++i)e.removeEventListener(t[i],r)},evokeModesChanged:function(){this.updateOnAlwaysMode()},updateOnAlwaysMode:function(){this.getEvokeModes().indexOf(t.ALWAYS)>=0?this.evoke():this.getRevokeModes().indexOf(t.ALWAYS)>=0&&this.revoke()},checkTimeoutRevoke:function(r){if(this.getEvoker()){var i=e.DomUtils,n=this.getEvoker().getDocument(),a=n.activeElement,o=this.getRevokeModes(),s=[];o.indexOf(t.EVOKEE_TIMEOUT)>=0&&s.push(this.getEvokee().getElement()),o.indexOf(t.EVOKER_TIMEOUT)>=0&&s.push(this.getEvoker().getElement());for(var l=!1,d=0,u=s.length;d<u;++d){var c=s[d];if(a===c||i.isDescendantOf(a,c)){l=!0;break}}l?this.postponeTimeoutCheck():this.revoke()}},postponeTimeoutCheck:function(){if(this.hasTimeoutMode(this.getRevokeModes())){if(this.getEvokeModes().indexOf(t.ALWAYS)>=0)return;this._timeoutRevokeHandle=setTimeout(this.checkTimeoutRevokeBind,this.getTimeout())}},hasTimeoutMode:function(r){return e.ArrayUtils.intersect([t.EVOKEE_TIMEOUT,t.EVOKER_TIMEOUT],r).length>0},getEventTypeOfMode:function(e){switch(e){case t.EVOKEE_CLICK:case t.EVOKER_CLICK:return"click";case t.EVOKEE_MOUSE_ENTER:case t.EVOKER_MOUSE_ENTER:return"mouseenter";case t.EVOKEE_MOUSE_LEAVE:case t.EVOKER_MOUSE_LEAVE:return"mouseleave";case t.EVOKEE_MOUSE_DOWN:case t.EVOKER_MOUSE_DOWN:return"mousedown";case t.EVOKEE_MOUSE_UP:case t.EVOKER_MOUSE_UP:return"mouseup";case t.EVOKEE_MOUSE_MOVE:case t.EVOKER_MOUSE_MOVE:return"mousemove";case t.EVOKEE_TOUCH:case t.EVOKER_TOUCH:return"touchstart"}},isEvokeTargetOnEvokee:function(e){return e>=t.EVOKEE_CLICK&&e<=t.EVOKEE_TOUCH},reactEvokeEvents:function(e){var r=e.htmlEvent.getType(),i=e.target;if(i===this.getEvokee()||i===this.getEvoker()){var n=e.target===this.getEvokee();if(!this.getEvoker().isShown()){if(this.getRevokeModes().indexOf(t.ALWAYS)>=0)return;for(var a=this.getEvokeModes(),o=0,s=a.length;o<s;++o)if(n===this.isEvokeTargetOnEvokee(a[o])&&r===this.getEventTypeOfMode(a[o]))return void this.evoke()}else{if(this.getEvokeModes().indexOf(t.ALWAYS)>=0)return;for(var a=this.getRevokeModes(),o=0,s=a.length;o<s;++o)if(n===this.isEvokeTargetOnEvokee(a[o])&&r===this.getEventTypeOfMode(a[o]))return void this.revoke()}}}}),e}},function(e,t,r){"use strict";var i=r(0).Class,n=(r(0).ClassEx,r(0).ObjectEx),a=r(0).DataType;e.exports=function(e){var t=e.HtmlElementUtils;e.Widget.StyleResource=i.create(n,{CLASS_NAME:"Kekule.Widget.StyleResource",initialize:function($super,e,t){$super(),this.setPropStoreFieldValue("name",e),t&&this.setCssClassName(t)},initProperties:function(){this.defineProp("name",{dataType:a.STRING,setter:null}),this.defineProp("cssClassName",{dataType:a.STRING})},linkTo:function(e){return t.addClass(this._getElement(e),this.getCssClassName()),this},unlinkFrom:function(e){t.removeClass(this._getElement(e),this.getCssClassName())},_getElement:function(t){return t instanceof e.Widget.BaseWidget?t.getElement():t}}),e.Widget.StyleResourceManager={_resources:{},register:function(e){var t=e.getName();return t&&(r._resources[t]=e),r},unregister:function(e){var t;return"string"==typeof e?t=e:e.getName&&(t=e.getName()),t&&delete r._resources[t],r},getResource:function(e){return r._resources[e]}},e.Widget.StyleResourceNames={PREFIX:"$$",CURSOR_ROTATE:"$$cursor_rotate",CURSOR_ROTATE_NE:"$$cursor_rotate_ne",CURSOR_ROTATE_NW:"$$cursor_rotate_nw",CURSOR_ROTATE_SE:"$$cursor_rotate_se",CURSOR_ROTATE_SW:"$$cursor_rotate_sw",ICON_COLOR_PICK:"$$icon_color_pick",ICON_COLOR_NOTSET:"$$icon_color_default",ICON_COLOR_MIXED:"$$icon_color_mixed",BUTTON_YES_OK:"$$btn_yes_ok",BUTTON_NO_CANCEL:"$$btn_no_cancel",BUTTON_RESET:"$$btn_reset",BUTTON_LOAD_FILE:"$$btn_load_file",ICON_REMOVE:"$$icon_remove"};var r=e.Widget.StyleResourceManager,o=e.Widget.StyleResource,s=e.Widget.StyleResourceNames;return r.register(new o(s.CURSOR_ROTATE,"K-Res-Cursor-Rotate")),r.register(new o(s.CURSOR_ROTATE_NE,"K-Res-Cursor-Rotate-NE")),r.register(new o(s.CURSOR_ROTATE_NW,"K-Res-Cursor-Rotate-NW")),r.register(new o(s.CURSOR_ROTATE_SE,"K-Res-Cursor-Rotate-SE")),r.register(new o(s.CURSOR_ROTATE_SW,"K-Res-Cursor-Rotate-SW")),r.register(new o(s.ICON_COLOR_PICK,"K-Res-Icon-Color-Pick")),r.register(new o(s.ICON_COLOR_NOTSET,"K-Res-Icon-Color-NotSet")),r.register(new o(s.ICON_COLOR_MIXED,"K-Res-Icon-Color-Mixed")),r.register(new o(s.BUTTON_YES_OK,"K-Res-Button-YesOk")),r.register(new o(s.BUTTON_NO_CANCEL,"K-Res-Button-NoCancel")),r.register(new o(s.BUTTON_RESET,"K-Res-Button-Reset")),r.register(new o(s.BUTTON_LOAD_FILE,"K-Res-Button-LoadFile")),r.register(new o(s.ICON_REMOVE,"K-Res-Icon-Remove")),e}},function(e,t,r){"use strict";var i=r(0).Class,n=r(0).ClassEx,a=r(0).ObjectEx;r(0).DataType;e.exports=function(e){var t=e.DomUtils;e.ArrayUtils;e.Widget.AutoLauncher=i.create(a,{CLASS_NAME:"Kekule.Widget.AutoLauncher",WIDGET_ATTRIB:"data-widget",WIDGET_ATTRIB_ALT:"data-kekule-widget",PLACEHOLDER_ATTRIB:"data-placeholder",FIELD_PARENT_WIDGET_ELEM:"__$kekule_parent_widget_elem$__",initialize:function($super){$super(),this._executingFlag=0,this._pendingWidgetRefMap=new e.MapEx(!0),this._pendingElems=[],this._handlingPendings=!1,this._execOnPendingBind=this._execOnPending.bind(this);var t=this;e.Widget.Utils._setWidgetRefPropFromId=function(r,i,n){if(n){var a=e.Widget.getWidgetById(n,r.getDocument());if(a)r.setPropValue(i,a);else{var o=r.getDocument().getElementById(n);o&&t.isExecuting()&&t.addPendingWidgetRefItem(o,r,i)}}}},finalize:function($super){this._pendingElems=null,this._pendingWidgetRefMap=null,$super()},getPendingElems:function(){return this._pendingElems},addPendingElem:function(e,t,r,i,n){this._pendingElems.push({doc:e,elem:t,parent:r,widgetClass:i,execOnChildren:n})},handlePendingElems:function(e){if(!this._handlingPendings){if(this._handlingPendings=!0,e){this._pendingElems.push({callback:e})}this.beginExec(),setTimeout(this._execOnPendingBind,0)}},_execOnPending:function(){var e=this._pendingElems.shift();if(e)try{e.elem?this.createWidgetOnElem(e.doc,e.elem,e.parent):e.callback&&setTimeout(e.callback,0)}finally{setTimeout(this._execOnPendingBind,0)}else this._handlingPendings=!1,this.endExec()},getPendingWidgetRefMap:function(){return this._pendingWidgetRefMap},addPendingWidgetRefItem:function(e,t,r){this._pendingWidgetRefMap.set(e,{widget:t,propName:r})},removePendingWidgetRefItem:function(e){this._pendingWidgetRefMap.remove(e)},handlePendingWidgetRef:function(){for(var t=this._pendingWidgetRefMap.getKeys(),r=0,i=t.length;r<i;++r){var n=t[r],a=e.Widget.getWidgetOnElem(n);if(a){var o=this._pendingWidgetRefMap.get(n);o.widget.setPropValue(o.propName,a)}this.removePendingWidgetRefItem(n)}},beginExec:function(){++this._executingFlag},endExec:function(){this._executingFlag>0&&--this._executingFlag,this._executingFlag<=0&&this.handlePendingWidgetRef()},isExecuting:function(){return this._executingFlag>0},execute:function(t,r,i){var n=e.ObjUtils.notUnset(r)?r:e.Widget.AutoLauncher.deferring;n||this.beginExec();try{"function"==typeof t.querySelector?this.executeOnElemBySelector(t.ownerDocument,t,null,n):this.executeOnElem(t.ownerDocument,t,null,n),n&&this.handlePendingElems(i)}finally{n||(this.endExec(),i&&i())}},executeOnElem:function(r,i,n,a){if(this.isElemLaunchable(i)){var o=null,s=this.getElemWidgetClass(i),l=n;if(a)s&&(this.addPendingElem(r,i,n,s,!1),l=i);else{var d=n;!d||d instanceof e.Widget.BaseWidget||(d=e.Widget.getWidgetOnElem(n)),o=this.createWidgetOnElem(r,i,d,s),l=o||i}if(a&&!s||!a&&!o||e.Widget.AutoLauncher.enableCascadeLaunch)for(var u=t.getDirectChildElems(i),c=0,h=u.length;c<h;++c){var m=u[c];this.executeOnElem(r,m,l,a)}}},executeOnElemBySelector:function(t,r,i,n){var a="["+this.WIDGET_ATTRIB+"],["+this.WIDGET_ATTRIB_ALT+"]",o=r.querySelectorAll(a);if(this.getElemWidgetClass(r)&&(o=Array.prototype.slice.call(o),o.unshift(r)),o&&o.length){for(var s=0,l=o.length;s<l;++s){var d=o[s],u=this._findParentCandidateElem(d,o,0,s-1);u&&(d[this.FIELD_PARENT_WIDGET_ELEM]=u)}for(var s=0,l=o.length;s<l;++s){var d=o[s];if(this.isElemLaunchable(d)){var c=d[this.FIELD_PARENT_WIDGET_ELEM]||null;!e.Widget.AutoLauncher.enableCascadeLaunch&&c||(n?this.addPendingElem(t,d,c,null,!1):this.createWidgetOnElem(t,d,c))}}}},_findParentCandidateElem:function(e,t,r,i){for(var n=null,a=e.parentNode;a&&!n;){for(var o=i;o>=r;--o)if(a===t[o])return n=t[o];n||(a=a.parentNode)}return n},createWidgetOnElem:function(t,r,i,a){var o=null,s=e.Widget.getWidgetOnElem(r);if(s)return s;if(a||(a=this.getElemWidgetClass(r)),a){var l=e.Widget.AutoLauncher,d=!1;if(l.placeHolderStrategy!==l.PlaceHolderStrategies.DISABLED){var u=r.getAttribute(this.PLACEHOLDER_ATTRIB)||"";d=l.placeHolderStrategy===l.PlaceHolderStrategies.EXPLICIT&&e.StrUtils.strToBool(u)||l.placeHolderStrategy===l.PlaceHolderStrategies.IMPLICIT,d=d&&n.getPrototype(a).canUsePlaceHolderOnElem(r)}if(o=d?new e.Widget.PlaceHolder(r,a):new a(r)){var c=i;!c||c instanceof e.Widget.BaseWidget||(c=e.Widget.getWidgetOnElem(i)),c&&o.setParent(c)}}return o},isElemLaunchable:function(t){return!(t.isContentEditable&&!e.HtmlElementUtils.isFormCtrlElement(t)&&!e.Widget.AutoLauncher.enableOnEditable)},getElemWidgetClass:function(e){var t=null,r=e.getAttribute(this.WIDGET_ATTRIB);return r||(r=e.getAttribute(this.WIDGET_ATTRIB_ALT)),r&&(t=this.getWidgetClass(r)),t},getWidgetClass:function(t){return n.findClass(t,void 0,e)}}),e.ClassUtils.makeSingleton(e.Widget.AutoLauncher),e.Widget.autoLauncher=e.Widget.AutoLauncher.getInstance(),e.Widget.AutoLauncher.PlaceHolderStrategies={DISABLED:"disabled",IMPLICIT:"implicit",EXPLICIT:"explicit"},e.Widget.AutoLauncher.enabled=!0,e.Widget.AutoLauncher.enableCascadeLaunch=!0,e.Widget.AutoLauncher.enableDynamicDomCheck=!0,e.Widget.AutoLauncher.enableOnEditable=!1,e.Widget.AutoLauncher.placeHolderStrategy=e.Widget.AutoLauncher.PlaceHolderStrategies.EXPLICIT,e.Widget.AutoLauncher.deferring=!1,e.Widget.WidgetsReady={isReady:!1,funcs:[],ready:function(e){r.isReady?e():r.funcs.push(e)},fireReady:function(){if(!r.isReady){r.isReady=!0;for(var e=r.funcs;e.length;){e.shift()()}}}};var r=e.Widget.WidgetsReady;e.Widget.ready=r.ready;var o=function t(){if(!t.done){if(!e._isLoaded())return void e._registerAfterLoadSysProc(t);var i=e.Widget.AutoLauncher.deferring?function(){e.X.DomReady.resume()}:null,n=function(){try{r.fireReady()}finally{i&&i()}};if(e.Widget.AutoLauncher.enabled?(e.Widget.AutoLauncher.deferring&&e.X.DomReady.suspend(),e.Widget.autoLauncher.execute(document.body,null,n)):n(),e.X.MutationObserver){new e.X.MutationObserver(function(t){if(e.Widget.AutoLauncher.enableDynamicDomCheck&&e.Widget.AutoLauncher.enabled)for(var r=0,i=t.length;r<i;++r){var n=t[r];if("childList"===n.type)for(var a=n.addedNodes,o=0,s=a.length;o<s;++o){var l=a[o];l.nodeType===Node.ELEMENT_NODE&&e.Widget.autoLauncher.execute(l)}}}).observe(document.body,{childList:!0,subtree:!0})}else e.X.Event.addListener(document,"DOMNodeInserted",function(t){if(e.Widget.AutoLauncher.enableDynamicDomCheck&&e.Widget.AutoLauncher.enabled){var r=t.getTarget();r.nodeType===(Node.ELEMENT_NODE||1)&&e.Widget.autoLauncher.execute(r)}});t.done=!0}};return e.X.domReady(o),e}},function(e,t,r){"use strict";var i=r(0).Class,n=r(0).ClassEx,a=r(0).ObjectEx,o=r(0).DataType;e.exports=function(e){var t=e.Widget.Direction,r=e.StyleUtils;e.Widget.BaseTransition=i.create(a,{CLASS_NAME:"Kekule.Widget.BaseTransition",initialize:function($super){$super()},initProperties:function(){this.defineProp("element",{dataType:o.OBJECT,serializable:!1}),this.defineProp("caller",{dataType:o.OBJECT,serializable:!1})},canExecute:function(e,t){return!0},prepare:function(e,t,r){},finish:function(e,t,r){},execute:function(e,t,r,i){this.setElement(e),t&&this.setCaller(t);var n=Object.extend({from:0,to:1},i),a=this,o=function i(){i.__$applied__||(i.__$applied__=!0,a.finish(e,t,n),r&&r())};o.__$applied__=!1,this.prepare(e,t,n);var a=this,s={element:e,caller:t,callback:r,doneCallback:o,options:i,executor:this,halt:function(){a.halt(s)}};return this.doExecute(e,t,o,n),s},doExecute:function(e,t,r,i){},halt:function(e){e.executor!==this?e.executor.halt(e):(this.doHalt(e),e.doneCallback&&e.doneCallback())},doHalt:function(e){},setElementProp:function(e,t,r){}}),e.Widget.Css3Transition=i.create(e.Widget.BaseTransition,{CLASS_NAME:"Kekule.Widget.Css3Transition",initialize:function($super){$super()},initProperties:function(){this.defineProp("cssProperty",{dataType:o.STRING}),this.defineProp("timingFunc",{dataType:o.STRING})},getAffectedCssPropNames:function(e){},getTransCssPropNames:function(e){},storeCssInlineValues:function(e,t){for(var r=e.style,i={},n=0,a=t.length;n<a;++n){var o=t[n];i[o]=r[o]}return i},restoreCssInlineValues:function(e,t,r){for(var i=e.style,n=0,a=t.length;n<a;++n){var o=t[n];if(r[o])i[o]=r[o];else try{i.removeProperty(o)}catch(e){i[o]=""}}},storeCssComputedValues:function(e,t){for(var i={},n=0,a=t.length;n<a;++n){var o=t[n],s=r.getComputedStyle(e,o);i[o]=s}return i},canExecute:function(t,r){return e.BrowserFeature.cssTransition},isSupported:function(){return e.BrowserFeature.cssTransition},isAppear:function(e){return!!e.isAppear},isDisappear:function(e){return!!e.isDisappear},setTransitionProp:function(e,t,r){for(var i=["Moz"+t.capitalizeFirst(),"Webkit"+t.capitalizeFirst(),t],n=0,a=i.length;n<a;++n)e[i[n]]=r},getOriginCssInlineValues:function(){return this._originCssInlineValues},getComputedCssValues:function(){return this._computedCssValues},prepare:function(e,t,r){this.setCssProperty(this.getTransCssPropNames(r).join(","));var i=this.getAffectedCssPropNames(r);this._affectedCssPropNames=i,this._originCssInlineValues=this.storeCssInlineValues(e,i),this._computedCssValues=this.storeCssComputedValues(e,i)},finish:function(e,t,r){(1===r.to||this.isAppear(r)||this.isDisappear(r))&&this.restoreCssInlineValues(e,this._affectedCssPropNames,this._originCssInlineValues)},doExecute:function(t,r,i,n){var a=e.StyleUtils,o=t.style;this.isAppear(n),this.isDisappear(n);if(this.isSupported()){this.setElementProp(t,n.from,n),a.isDisplayed(t)||a.setDisplay(t,!0),a.isVisible(t)||a.setVisibility(t,!0);var s=this.getCssProperty();this.setTransitionProp(o,"transitionProperty",s),s=this.getTimingFunc(),s&&this.setTransitionProp(o,"transitionTimingFunction",s),s=n.duration.toString()+"ms",this.setTransitionProp(o,"transitionDuration",s);var l,d=this,u=function r(n){e.X.Event.removeListener(t,"transitionend",r),d.setTransitionProp(o,"transition",""),l&&clearTimeout(l),i&&i()};this._currEventHandler=u,e.X.Event.addListener(t,"transitionend",u),l=setTimeout(u,n.duration+100),setTimeout(function(){d.setElementProp(t,n.to,n)},0)}else{try{this.setElementProp(t,n.to,n)}catch(e){}i&&setTimeout(i,0)}},doHalt:function(e){var t=e.element;t&&this.setTransitionProp(t.style,"transitionProperty","none")}}),e.Widget.Css3OpacityTrans=i.create(e.Widget.Css3Transition,{CLASS_NAME:"Kekule.Widget.Css3OpacityTrans",canExecute:function($super,t,r){return!!e.BrowserFeature.cssTranform},getAffectedCssPropNames:function(e){return["opacity"]},getTransCssPropNames:function(e){return["opacity"]},setElementProp:function(e,t,r){var i=parseFloat(this._computedCssValues.opacity)||1;e.style.opacity=i*t}}),e.Widget.Css3SlideTransition=i.create(e.Widget.Css3Transition,{CLASS_NAME:"Kekule.Widget.Css3SlideTransition",initialize:function($super,t){$super(),e.ObjUtils.notUnset(t)&&this.setDirection(t)},initProperties:function(){this.defineProp("direction",{dataType:o.INT})},canExecute:function($super,e,t){return!0},prepare:function($super,e,t,i){r.setDisplay(e,!0),this._direction=this.getActualDirection(e,i),$super(e,t,i),e.style.overflow="hidden",this._clearDimesionConstraints(e)},_clearDimesionConstraints:function(e){var t=e.style;t.minWidth="0",t.minHeight="0",t.maxWidth="none",t.maxHeight="none"},setElementProp:function(e,i,n){var a,o=this._direction;if(t.isInHorizontal(o)){a=this.getComputedCssValues().width;var s=r.analysisUnitsValue(a);if(e.style.width=s.value*i+s.units,a=this.getComputedCssValues().left){var l=r.analysisUnitsValue(a);l.units===s.units&&(e.style.left=s.value*(1-i)+l.value+l.units)}}if(t.isInVertical(o)){a=this.getComputedCssValues().height;var d=r.analysisUnitsValue(a);if(e.style.height=d.value*i+d.units,a=this.getComputedCssValues().top){var u=r.analysisUnitsValue(a);u.units===d.units&&(e.style.top=d.value*(1-i)+u.value+u.units)}}},getAffectedCssPropNames:function(e){var t=[].concat(this.getTransCssPropNames(e));return t=t.concat(["overflow","min-width","min-height","max-width","max-height"])},getTransCssPropNames:function(e){var r=this.getActualDirection(this.getElement(),e),i=[];return t.isInHorizontal(r)&&(i.push("width"),r&t.RTL&&i.push("left")),t.isInVertical(r)&&(i.push("height"),r&t.BTT&&i.push("top")),i},getRefRect:function(t){var r,i=e.HtmlElementUtils;return this.getCaller()?(r=i.getElemPageRect(this.getCaller()),e.RectUtils.isZero(r)&&(r=(t||{}).callerPageRect||null)):r=null,r},getActualDirection:function(t,r){t||(t=this.getElement());var i=e.Widget.Direction,n=e.HtmlElementUtils,a=this.getDirection();if(!a||a===i.AUTO){var o=this.getRefRect(r);if(o){var s={x:o.x+o.width/2,y:o.y+o.height/2},l=n.getElemPagePos(t),d=n.getElemClientDimension(t),u={x:l.x+(d.width||0)/2,y:l.y+(d.height||0)/2},c=e.CoordUtils.substract(u,s);if(o.width<1)a=c.x>=0?i.LTR:i.RTL;else if(c.x<1)a=c.y>=0?i.TTB:i.BTT;else{var h=Math.abs(o.height/o.width),m=Math.abs(c.y/c.x);a=h>m?c.x>=0?i.LTR:i.RTL:c.y>=0?i.TTB:i.BTT}}else a=i.TTB}return a}}),e.Widget.Css3GrowTransition=i.create(e.Widget.Css3Transition,{CLASS_NAME:"Kekule.Widget.Css3GrowTransition",initialize:function($super,e){$super(),e&&(e.ownerDocument?this.setBaseElement(e):this.setCaller(e))},initProperties:function(){this.defineProp("baseRect",{dataType:o.HASH})},getRefRect:function(t){var r=e.HtmlElementUtils,i=null;return this.getBaseRect()?i=this.getBaseRect():this.getCaller()&&(i=r.getElemBoundingClientRect(this.getCaller(),!0),e.RectUtils.isZero(i)&&(i=(t||{}).callerPageRect||null)),i||(i={x:0,y:0,width:0,height:0}),i},canExecute:function($super,e,t){return!0},prepare:function($super,t,i,n){r.setDisplay(t,!0),$super(t,i,n),t.style.overflow="hidden",e.HtmlElementUtils.makePositioned(t);var a=this.getRefRect(n),o=e.HtmlElementUtils,s=o.getElemBoundingClientRect(t,!0),l={x:s.x-a.x,y:s.y-a.y,width:s.width-a.width,height:s.height-a.height};this._delta=l,this._clearDimesionConstraints(t)},_clearDimesionConstraints:function(e){var t=e.style;t.minWidth="0",t.minHeight="0",t.maxWidth="none",t.maxHeight="none"},setElementProp:function(e,t,i){var n=this.getComputedCssValues(),a=this._delta,o=1-t,s=e.style,l=r.analysisUnitsValue(n.left);"px"===l.units&&(s.left=l.value-o*a.x+"px");var l=r.analysisUnitsValue(n.top);"px"===l.units&&(s.top=l.value-o*a.y+"px");var l=r.analysisUnitsValue(n.width);"px"===l.units&&(s.width=l.value-o*a.width+"px");var l=r.analysisUnitsValue(n.height);"px"===l.units&&(s.height=l.value-o*a.height+"px")},getAffectedCssPropNames:function(e){var t=[].concat(this.getTransCssPropNames(e));return t=t.concat(["overflow","min-width","min-height","max-width","max-height"])},getTransCssPropNames:function(e){return["left","top","width","height","position"]}}),e.BrowserFeature&&e.BrowserFeature.cssTranform&&(e.Widget.Css3TransformTrans=i.create(e.Widget.Css3Transition,{CLASS_NAME:"Kekule.Widget.Css3TransformTrans",getAffectedCssPropNames:function(e){return["transform","transformOrigin"]},getTransCssPropNames:function(e){return["transform","transformOrigin"]},prepare:function($super,t,r,i){$super(t,r,i);var n=e.StyleUtils.getTransformMatrixValues(t);n&&(n.scaleX=n.a,n.scaleY=n.d),this._computedTransMatrixInfo=n},setElemTransform:function(t,r,i,n,a){var o=[n,0,0,a,r,i];e.StyleUtils.setTransformMatrixArrayValues(t,o)}}),e.Widget.Css3TransformGrowTransition=i.create(e.Widget.Css3TransformTrans,{CLASS_NAME:"Kekule.Widget.Css3TransformGrowTransition",initialize:function($super,e){$super(),e&&(e.ownerDocument?this.setBaseElement(e):this.setCaller(e))},initProperties:function(){this.defineProp("baseRect",{dataType:o.HASH})},getRefRect:function(t){var r=e.HtmlElementUtils,i=null;return this.getBaseRect()?i=this.getBaseRect():this.getCaller()&&(i=r.getElemBoundingClientRect(this.getCaller(),!0),e.RectUtils.isZero(i)&&(i=(t||{}).callerPageRect||null)),i||(i={x:0,y:0,width:0,height:0}),i},prepare:function($super,t,i,n){r.setDisplay(t,!0),$super(t,i,n),t.style.overflow="hidden",e.HtmlElementUtils.makePositioned(t);var a=this.getRefRect(n),o=e.HtmlElementUtils,s=o.getElemBoundingClientRect(t,!0),l={x:s.x-a.x,y:s.y-a.y};this._translateDelta=l,this._initialScale={x:a.width/s.width,y:a.height/s.height},this._computedTransMatrixInfo?(this._endScale={x:this._computedTransMatrixInfo.scaleX,y:this._computedTransMatrixInfo.scaleY},this._endTranslate={x:this._computedTransMatrixInfo.tx,y:this._computedTransMatrixInfo.ty}):(this._endScale={x:1,y:1},this._endTranslate={x:0,y:0})},setElementProp:function(e,t,r){var i=(this.getComputedCssValues(),this._translateDelta),n=this._initialScale,a=this._endScale,o={x:this._endTranslate.x-(1-t)*i.x,y:this._endTranslate.y-(1-t)*i.y},s={x:t*a.x+(1-t)*n.x,y:t*a.y+(1-t)*n.y};e.style.transformOrigin="0 0 0",this.setElemTransform(e,o.x,o.y,s.x,s.y)}})),e.Widget.Css3TransitionSimpleClassCreator={create:function(t,r,a,o){var s=i.create(e.Widget.Css3Transition,{CLASS_NAME:t,initialize:function($super){$super(),this.setCssProperty(r),this.setTimingFunc(a)}});return o&&(s=n.extend(s,o)),s}};e.Widget.Css3TransitionSimpleClassCreator;return e}},function(e,t,r){"use strict";var i=r(0).Class,n=(r(0).ClassEx,r(0).ObjectEx),a=r(0).DataType;e.exports=function(e){e.StyleUtils;e.Widget.ShowHideManager=i.create(n,{CLASS_NAME:"Kekule.Widget.ShowHideManager",initialize:function($super){$super(),this.setEnableTransition(!0),this.setShowDuration(450),this.setHideDuration(450)},initProperties:function(){this.defineProp("enableTransition",{dataType:a.BOOL}),this.defineProp("transitionSelector",{dataType:"Kekule.Widget.ShowHideTransitionSelector",serializable:!1}),this.defineProp("showDuration",{dataType:a.INT}),this.defineProp("hideDuration",{dataType:a.INT})},_getCallerElement:function(t){return t?t.getElement?t.getElement():e.DomUtils.isElement(t)?t:null:null},isUsingTransition:function(){return this.getEnableTransition()&&this.getTransitionSelector()},selectTransition:function(e,t,r){var i=this.getTransitionSelector();if(!i)return null;var n=i.selectTransition(e,t,r);return n&&t&&n.setCaller(this._getCallerElement(t)),n},show:function(e,t,r,i,n){var a=Object.extend(n||{},{from:0,to:1,isAppear:!0,duration:this.getShowDuration()}),o=e.getStandaloneOnShowHide()?null:t,s=this.selectTransition(e,o,i);if(s&&this.isUsingTransition()&&s.canExecute(e.getElement(),a)){var l=function(t){e.setVisible(!0,!0),e.setDisplayed(!0,!0),r&&r()},d=this._getCallerElement(o);return s.execute(e.getElement(),d,l,a)}return e.setVisible(!0,!0),e.setDisplayed(!0,!0),r&&r(),null},hide:function(e,t,r,i,n,a){var o=Object.extend(a,{from:1,to:0,isDisappear:!0,duration:this.getHideDuration()}),n=!!a.useVisible,s=e.getStandaloneOnShowHide()?null:t,l=this.selectTransition(e,s,i);if(l&&this.isUsingTransition()&&l.canExecute(e.getElement(),o)){var d=function(){e&&(n?e.setVisible(!1,!0):e.setDisplayed(!1,!0)),r&&r()};return l.execute(e.getElement(),this._getCallerElement(s),d,o)}return n?e.setVisible(!1,!0):e.setDisplayed(!1,!0),r&&r(),null}}),e.ClassUtils.makeSingleton(e.Widget.ShowHideManager),e.Widget.showHideManager=e.Widget.ShowHideManager.getInstance(),e.Widget.ShowHideTransitionSelector=i.create(n,{CLASS_NAME:"Kekule.Widget.ShowHideTransitionSelector",initialize:function($super){$super(),this.setTransitionClassMap({})},initProperties:function(){this.defineProp("transitionClassMap",{dataType:a.OBJECT,serializable:!1})},_getTransClassOfType:function(t){var r=this.getTransitionClassMap();return r[t]||r[e.Widget.ShowHideType.DEFAULT]},addTransitionClass:function(e,t){this.getTransitionClassMap()[e]=t},selectTransition:function(t,r,i){var n;e.Widget.ShowHideType;return n=r?this._getTransClassOfType(i):this._getTransClassOfType(e.Widget.ShowHideType.DEFAULT),n?new n:null}});var t=new e.Widget.ShowHideTransitionSelector,r=e.Widget.ShowHideType;return t.addTransitionClass(r.DEFAULT,e.Widget.Css3OpacityTrans),t.addTransitionClass(r.DROPDOWN,e.Widget.Css3SlideTransition),t.addTransitionClass(r.POPUP,e.Widget.Css3TransformGrowTransition||e.Widget.Css3GrowTransition),t.addTransitionClass(r.DIALOG,e.Widget.Css3TransformGrowTransition||e.Widget.Css3GrowTransition),e.Widget.showHideManager.setTransitionSelector(t),e}},function(e,t,r){"use strict";var i=r(0).Class,n=r(0).ClassEx,a=(r(0).ObjectEx,r(0).DataType);e.exports=function(e){var t=(e.HtmlElementUtils,e.X.Event),r=e.Widget.HtmlClassNames;e.Widget.HtmlClassNames=Object.extend(e.Widget.HtmlClassNames,{RESIZEGRIPPER:"K-Resize-Gripper"});var o=i.PropertyScope;return e.Widget.ResizeGripper=i.create(e.Widget.BaseWidget,{CLASS_NAME:"Kekule.Widget.ResizeGripper",BINDABLE_TAG_NAMES:["div","span"],initialize:function($super,e){if(this.reactMousemoveBind=this.reactMousemove.bind(this),this.reactMouseupBind=this.reactMouseup.bind(this),this.reactTouchmoveBind=this.reactTouchmove.bind(this),this.reactTouchendBind=this.reactTouchend.bind(this),$super(e),!this.getTarget())if(this.getParent())this.setTarget(this.getParent());else{var t=this.getElement().parentNode;t&&this.setTarget(t)}},initProperties:function(){this.defineProp("target",{dataType:a.OBJECT,serializable:!1,setter:function(e){this.getTarget()!==e&&(this.setPropStoreFieldValue("target",e),this.targetChanged(e))}}),this.defineProp("retainAspectRatio",{dataType:a.BOOL}),this.defineProp("isUnderResizing",{dataType:a.BOOL,serializable:!1,setter:null,scope:o.PRIVATE}),this.defineProp("baseCoord",{dataType:a.HASH,serializable:!1,scope:o.PRIVATE}),this.defineProp("baseDimension",{dataType:a.HASH,serializable:!1,scope:o.PRIVATE}),this.defineProp("baseAspectRatio",{dataType:a.FLOAT,serializable:!1,scope:o.PRIVATE})},doGetWidgetClassName:function($super){return $super()+" "+r.RESIZEGRIPPER},doCreateRootElement:function(e){return e.createElement("span")},targetChanged:function(e){var t;(t=this.targetIsWidget(e)?e.getResizerElement?e.getResizerElement():e.getChildrenHolderElement():e)&&this.appendToElem(t)},targetIsWidget:function(t){return t instanceof e.Widget.BaseWidget},getTargetDimension:function(t){var r=t||this.getTarget();return this.targetIsWidget(r)?r.getDimension():e.HtmlElementUtils.getElemPageRect(r,!0)},setTargetDimension:function(e,t,r){var i=e||this.getTarget();if(this.targetIsWidget(i))i.setDimension(t,r);else{var n=i.style;n.width=t+"px",n.height=r+"px"}},prepareResizing:function(e,t){if(!this.getIsUnderResizing()){var r=this._getMoveEventReceiverElem(this.getElement());this._installEventHandlers(r),this._setMouseCapture(this.getElement(),!0,t),this.setBaseCoord(e);var i=this.getTargetDimension();this.setBaseDimension(i),this.setBaseAspectRatio(i.width/i.height),this.setPropStoreFieldValue("isUnderResizing",!0)}},doneResizing:function(e){this._setMouseCapture(this.getElement(),!1,e);var t=this._getMoveEventReceiverElem(this.getElement());this._uninstallEventHandlers(t),this.setBaseCoord(null),this.setBaseDimension(null),this.setPropStoreFieldValue("isUnderResizing",!1)},resizeTo:function(t){var r=e.CoordUtils.substract(t,this.getBaseCoord()),i=this.getBaseDimension(),n=i.width+r.x,a=i.height+r.y;if(this.getRetainAspectRatio()){var o=this.getBaseAspectRatio();n/a>o?n=o*a:n/a<o&&(a=n/o)}this.setTargetDimension(this.getTarget(),n,a)},reactMousemove:function(e){if(this.getIsUnderResizing()){var t={x:e.getScreenX(),y:e.getScreenY()};this.resizeTo(t),e.stopPropagation(),e.preventDefault()}},reactMouseup:function(t){t.getButton()===e.X.Event.MouseButton.LEFT&&this.getIsUnderResizing()&&(this.doneResizing(t),t.preventDefault())},reactTouchmove:function(e){if(this.getIsUnderResizing()){var t={x:e.getScreenX(),y:e.getScreenY()};this.resizeTo(t),e.stopPropagation(),e.preventDefault()}},reactTouchend:function(e){this.getIsUnderResizing()&&(this.doneResizing(e),e.preventDefault())},_elemSupportCapture:function(e){return!!e.setCapture},_setMouseCapture:function(t,r,i){t&&(r?(t.setCapture&&t.setCapture(!0),t.setPointerCapture&&e.ObjUtils.notUnset(i.pointerId)&&t.setPointerCapture(i.pointerId)):(t.releaseCapture&&t.releaseCapture(),t.releasePointerCapture&&e.ObjUtils.notUnset(i.pointerId)&&t.releasePointerCapture(i.pointerId)))},_getMoveEventReceiverElem:function(e){return this._elemSupportCapture(e)?e:e.ownerDocument.documentElement},_installEventHandlers:function(e){t.addListener(e,"mousemove",this.reactMousemoveBind),t.addListener(e,"touchmove",this.reactTouchmoveBind),t.addListener(e,"mouseup",this.reactMouseupBind),t.addListener(e,"touchend",this.reactTouchendBind)},_uninstallEventHandlers:function(e){t.removeListener(e,"mousemove",this.reactMousemoveBind),t.removeListener(e,"touchmove",this.reactTouchmoveBind),t.removeListener(e,"mouseup",this.reactMouseupBind),t.removeListener(e,"touchend",this.reactTouchendBind)},doReactActiviting:function($super,e){$super(e);var t={x:e.getScreenX(),y:e.getScreenY()};this.prepareResizing(t,e)}}),n.extend(e.Widget.BaseWidget,{resizableChanged:function(){if(this.getResizable()){var t=new e.Widget.ResizeGripper(this);t.setRetainAspectRatio(this.getResizeWithAspectRatio()),this.setPropStoreFieldValue("resizeGripper",t)}else{var t=this.getResizeGripper();t&&t.finalize(),this.setPropStoreFieldValue("resizeGripper",null)}}}),n.defineProps(e.Widget.BaseWidget,[{name:"resizable",dataType:a.BOOL,setter:function(e){e!==this.getResizable()&&(this.setPropStoreFieldValue("resizable",e),this.resizableChanged())}},{name:"resizeWithAspectRatio",dataType:a.BOOL,setter:function(e){this.setPropStoreFieldValue("resizeWithAspectRatio",e),this.getResizeGripper()&&this.getResizeGripper().setRetainAspectRatio(e)}},{name:"isResizing",dataType:a.BOOL,serializable:!1,scope:o.PRIVATE,setter:null,getter:function(){var e=this.getResizeGripper();return!!e&&e.getIsUnderResizing()}},{name:"resizeGripper",dataType:"Kekule.Widget.ResizeGripper",serializable:!1,setter:null,scope:o.PRIVATE}]),e}},function(e,t,r){"use strict";var i=r(0).Class,n=r(0).ClassEx,a=r(0).ObjectEx,o=r(0).DataType;e.exports=function(e){var t=e.HtmlElementUtils,r=e.StyleUtils,s=e.X.Event,l=i.PropertyScope;return e.Widget.MoveHelper=i.create(a,{CLASS_NAME:"Kekule.Widget.MoveHelper",initialize:function($super,e,t){$super(),this.reactMouseDownBind=this.reactMouseDown.bind(this),this.reactMouseUpBind=this.reactMouseUp.bind(this),this.reactMouseMoveBind=this.reactMouseMove.bind(this),this.reactTouchDownBind=this.reactTouchDown.bind(this),this.reactTouchEndBind=this.reactTouchEnd.bind(this),this.reactTouchMoveBind=this.reactTouchMove.bind(this),this.__$K_initialMoverInfo__={},this.setCssPropX("left").setCssPropY("top").setMovingCursor("move").setMovingCursorDelay(500),this.setTarget(e),this.setGripper(t),this.setEnabled(!0)},doFinalize:function($super){this.setGripper(null),$super()},initProperties:function(){this.defineProp("enabled",{dataType:o.BOOL}),this.defineProp("target",{dataType:o.OBJECT,serializable:!1}),this.defineProp("gripper",{dataType:o.OBJECT,serializable:!1,getter:function(){return this.getPropStoreFieldValue("gripper")||this.getTarget()},setter:function(e){var t=this.getPropStoreFieldValue("gripper");e!==t&&(this.setPropStoreFieldValue("gripper",e),this.gripperChanged(e,t))}}),this.defineProp("isMoving",{dataType:o.BOOL,serializable:!1}),this.defineProp("cssPropX",{dataType:o.STRING}),this.defineProp("cssPropY",{dataType:o.STRING}),this.defineProp("movingCursor",{dataType:o.STRING}),this.defineProp("movingCursorDelay",{dataType:o.INT}),this.defineProp("movable",{dataType:o.BOOL,setter:null,getter:function(){return this.getEnabled()&&this.getGripper()}})},_objIsWidget:function(t){return t instanceof e.Widget.BaseWidget},_getElement:function(e){return this._objIsWidget(e)?e.getElement():e},getTargetElement:function(){var e=this.getTarget();return this._objIsWidget(e)?e.getElement():e},getGripperElement:function(){var e=this.getGripper();return this._objIsWidget(e)?e.getElement():e},gripperChanged:function(e,t){t&&this.installEventHandlers(this._getElement(t)),e&&this.installEventHandlers(this._getElement(e))},installEventHandlers:function(e){e&&(s.addListener(e,"mousedown",this.reactMouseDownBind),s.addListener(e,"touchstart",this.reactTouchDownBind))},uninstallEventHandlers:function(e){e&&(s.removeListener(e,"mousedown",this.reactMouseDownBind),s.removeListener(e,"touchstart",this.reactTouchDownBind))},_elemSupportCapture:function(e){return!!e.setCapture},_getMoveEventReceiverElem:function(e){return this._elemSupportCapture(e)?e:e.ownerDocument.documentElement},setMouseCapture:function(e){var t=this.getGripperElement();t&&(e?t.setCapture&&t.setCapture(!0):t.releaseCapture&&t.releaseCapture())},beginMoving:function(e){if(!this.getIsMoving()){var r=this.getTargetElement();t.makePositioned(r),this.saveInitialInformation(e);var i=this._getMoveEventReceiverElem(this.getGripperElement());s.addListener(i,"mousemove",this.reactMouseMoveBind),s.addListener(i,"touchmove",this.reactTouchMoveBind),s.addListener(i,"mouseup",this.reactMouseUpBind),s.addListener(i,"touchend",this.reactTouchEndBind),this.setMouseCapture(!0),this._setCursorHandle=this.delaySetMoveCursor(),this.setIsMoving(!0)}},endMoving:function(){this.setIsMoving(!1),this.setMouseCapture(!1);var e=this.getGripperElement(),t=this._getMoveEventReceiverElem(e);if(s.removeListener(t,"mousemove",this.reactMouseMoveBind),s.removeListener(t,"touchmove",this.reactTouchMoveBind),s.removeListener(t,"mouseup",this.reactMouseUpBind),s.removeListener(t,"touchend",this.reactTouchEndBind),this.clearCursorSetter(),e){var r=this.__$K_initialMoverInfo__.cursor;e.style.cursor=r||"",this.__$K_initialMoverInfo__.cursor=null}},moveTo:function(t){this.clearCursorSetter(),this.doSetMoveCursor();var r=this.getTargetElement();if(r){var i=this.__$K_initialMoverInfo__,n=e.CoordUtils.substract(t,i.pointerCoord);"right"===(this.getCssPropX()||"").toLowerCase()?r.style.right=i.elemCoord.x-n.x+"px":r.style.left=i.elemCoord.x+n.x+"px","bottom"===(this.getCssPropY()||"").toLowerCase()?r.style.bottom=i.elemCoord.y-n.y+"px":r.style.top=i.elemCoord.y+n.y+"px"}},delaySetMoveCursor:function(){return setTimeout(this.doSetMoveCursor.bind(this),this.getMovingCursorDelay()||0)},doSetMoveCursor:function(){var e=this.getGripperElement();e&&this.getMovingCursor()&&(e.style.cursor=this.getMovingCursor())},clearCursorSetter:function(){this._setCursorHandle&&clearTimeout(this._setCursorHandle)},saveInitialInformation:function(e){var i=this.getTargetElement();if(i){this.__$K_initialMoverInfo__.pointerCoord=e;var n,a=(r.getComputedStyle(i,"position")||"").toLowerCase(),o=(this.getCssPropX()||"left").toLowerCase(),s=(this.getCssPropY()||"top").toLowerCase();if("relative"===a){n={x:r.analysisUnitsValue(r.getComputedStyle(i,"left")).value||0,y:r.analysisUnitsValue(r.getComputedStyle(i,"top")).value||0},o="left",s="top"}else n={x:i.offsetLeft,y:i.offsetTop};var l=t.getElemOffsetDimension(i);"right"===o&&(n.x+=l.width),"bottom"===s&&(n.y+=l.height),this.__$K_initialMoverInfo__.elemCoord=n,this.getGripperElement()&&(this.__$K_initialMoverInfo__.cursor=this.getGripperElement().style.cursor)}},reactMouseDown:function(e){this.getTargetElement()&&this.getEnabled()&&e.getButton()===s.MouseButton.LEFT&&(this.beginMoving({x:e.getScreenX(),y:e.getScreenY()},e.getTarget()),e.preventDefault())},reactMouseUp:function(e){e.getButton()===s.MouseButton.LEFT&&this.getIsMoving()&&(this.endMoving(),e.preventDefault())},reactMouseMove:function(e){if(this.getIsMoving()){var t={x:e.getScreenX(),y:e.getScreenY()};this.moveTo(t),e.preventDefault()}},reactTouchDown:function(e){this.getEnabled()&&(this.beginMoving({x:e.getScreenX(),y:e.getScreenY()},e.getTarget()),e.preventDefault())},reactTouchEnd:function(e){this.getIsMoving()&&(this.endMoving(),e.preventDefault())},reactTouchMove:function(e){if(this.getIsMoving()){var t={x:e.getScreenX(),y:e.getScreenY()};this.moveTo(t),e.preventDefault()}}}),n.extend(e.Widget.BaseWidget,{_getMoveHelper:function(t){var r=this.getMoveHelper();return!r&&t&&(r=new e.Widget.MoveHelper(this)),r},movingGripperChanged:function(){var e=this.getMovingGripper();if(e){var t=this._getMoveHelper(!0);t.setGripper(e)}else{var t=this._getMoveHelper(!1);t&&t.setGripper(null)}}}),n.defineProps(e.Widget.BaseWidget,[{name:"movable",dataType:o.BOOL,getter:function(){return this._getMoveHelper()&&this._getMoveHelper().getMovable()},setter:function(e){if(e!==this.getMovable())if(e)this.setMovingGripper(this.getDefaultMovingGripper&&this.getDefaultMovingGripper()||this);else{var t=this._getMoveHelper();t&&t.setEnabled(!1)}}},{name:"movingGripper",dataType:o.OBJECT,setter:function(e){e!==this.getMovingGripper()&&(this.setPropStoreFieldValue("movingGripper",e),this.movingGripperChanged())}},{name:"isMoving",dataType:o.BOOL,serializable:!1,scope:l.PRIVATE,setter:null,getter:function(){var e=this.getMoveHelper();return!!e&&e.getIsMoving()}},{name:"moveHelper",dataType:"Kekule.Widget.MoveHelper",serializable:!1,setter:null,scope:l.PRIVATE}]),e}},function(e,t,r){"use strict";var i=r(0).Class,n=(r(0).ClassEx,r(0).ObjectEx,r(0).DataType);e.exports=function(e){var t=e.HtmlElementUtils,r=e.Widget.HtmlClassNames;return e.Widget.Glyph=i.create(e.Widget.BaseWidget,{CLASS_NAME:"Kekule.Widget.Glyph",initialize:function($super,e,t){this._imgElem=null,$super(e),t&&this.setNormalInfo(t)},initProperties:function(){this.defineImgInfoProp("normalInfo",{dataType:n.HASH}),this.defineImgInfoProp("hoverInfo",{dataType:n.HASH}),this.defineImgInfoProp("focusedInfo",{dataType:n.HASH}),this.defineImgInfoProp("activeInfo",{dataType:n.HASH}),this.defineImgInfoProp("disabledInfo",{dataType:n.HASH})},defineImgInfoProp:function(e,t){var r=Object.extend({setter:function(t){t?this.setPropStoreFieldValue(e,Object.extend({},t)):this.setPropStoreFieldValue(e,null),this.imgInfoChanged()}},t);return this.defineProp(e,r)},doGetWidgetClassName:function(){return"K-Glyph"},doCreateRootElement:function(e){return e.createElement("span")},doBindElement:function($super,e){$super(),this.createImgContainer(e)},createImgContainer:function(e,t){var i=e.ownerDocument;this._imgElem=i.createElement("span"),this._imgElem.className=r.FULLFILL,e.innerHTML="",e.appendChild(this._imgElem)},imgInfoChanged:function(){this.updateImg()},stateChanged:function($super){$super(),this.updateImg()},updateImg:function(){var t=e.Widget.State,r=this.getState(),i=r===t.DISABLED?this.getDisabledInfo():r===t.ACTIVE?this.getActiveInfo()||this.getHoverInfo()||this.getFocusedInfo():r===t.HOVER?this.getHoverInfo():r===t.FOCUSED?this.getFocusedInfo():this.getNormalInfo();i=i||this.getNormalInfo(),this.showImgOfInfo(i)},showImgOfInfo:function(e){var i=this._imgElem;i&&(e?(e.className?(i.className=r.FULLFILL,t.addClass(i,e.className)):i.className=r.FULLFILL,i.style.backgroundImage=e.src?"url("+e.src+")":"",i.style.backgroundPosition=e.position||"",i.style.backgroundRepeat=e.repeat||"no-repeat"):i.style.backgroundImage="")}}),e}},function(e,t,r){"use strict";var i=r(0).Class,n=(r(0).ClassEx,r(0).ObjectEx,r(0).DataType);e.exports=function(e){e.Widget.HtmlClassNames=Object.extend(e.Widget.HtmlClassNames,{CONTAINER:"K-Container",PANEL:"K-Panel",PANEL_CAPTION:"K-Panel-Caption",TOOLBAR:"K-Toolbar"});var t=e.DomUtils,r=(e.HtmlElementUtils,e.Widget.HtmlClassNames),a=e.StyleUtils;return e.Widget.Container=i.create(e.Widget.BaseWidget,{CLASS_NAME:"Kekule.Widget.Container",initialize:function($super,e){this._defContainerElem=null,$super(e),this.reactShowStateChangeBind=this.reactShowStateChange.bind(this),this.addEventListener("showStateChange",this.reactShowStateChangeBind)},finalize:function($super){this.removeEventListener("showStateChange",this.reactShowStateChangeBind),this.clearWidgets(),$super()},initProperties:function(){this.defineChildDimensionRelatedProp("childWidth"),this.defineChildDimensionRelatedProp("childHeight"),this.defineChildDimensionRelatedProp("childMargin"),this.defineProp("firstChild",{dataType:"Kekule.Widget.BaseWidget",serializable:!1,setter:null,scope:i.PropertyScope.PUBLIC}),this.defineProp("lastChild",{dataType:"Kekule.Widget.BaseWidget",serializable:!1,setter:null,scope:i.PropertyScope.PUBLIC}),this.defineProp("allowChildWrap",{dataType:n.BOOL,serializable:!1,setter:function(e){this.setPropStoreFieldValue("allowChildWrap",e),e?this.removeClassName(r.NOWRAP):this.addClassName(r.NOWRAP)}})},initPropValues:function($super){$super(),this.setAllowChildWrap(!0)},defineChildDimensionRelatedProp:function(e,t){var r=Object.extend({dataType:n.STRING,setter:function(t){this.setPropStoreFieldValue(e,t),this.updateChildSizes()}},t||{});return this.defineProp(e,r)},doGetWidgetClassName:function(){return r.CONTAINER},doCreateRootElement:function(e){return e.createElement("span")},doCreateContainerElement:function(t,i,n){var a=e.BrowserFeature.htmlSlot?e.Widget.HtmlTagNames.CHILD_HOLDER:n||"span",o=t.createElement(a);return o.className=r.CHILD_HOLDER,o},getContainerElement:function(){return this.getElement()},getChildrenHolderElement:function(){return this.getContainerElement()},appendWidget:function(e){return e.setParent(this),this},insertWidgetBefore:function(e,t){return e.insertToWidget(this,t),this},removeWidget:function(e,t){e.setParent(null),t||e.finalize()},clearWidgets:function(e){for(var t=this.getChildWidgets(),r=t.length-1;r>=0;--r){var i=t[r];this.removeWidget(i,e)}},_insertChildWidget:function(e,t){var r=t?t.getElement():null,i=this.getChildrenHolderElement();i&&(r?i.insertBefore(e.getElement(),r):i.appendChild(e.getElement()))},reactShowStateChange:function(e){this.childrenModified()},childrenModified:function($super){$super();for(var e=this.getChildWidgets(),t=e.length,i=0,n=e[i];n&&!n.isShown(!0)&&i<t;)++i,n=e[i];for(var a=i<t?n:null,i=t-1,n=e[t-1];n&&!n.isShown(!0)&&i>=0;)--i,n=e[i];var o=i>=0?n:null,s=this.getFirstChild(),l=this.getLastChild();a!==s&&(s&&s.removeClassName(r.FIRST_CHILD),a&&a.addClassName(r.FIRST_CHILD),this.setPropStoreFieldValue("firstChild",a)),o!==l&&(l&&l.removeClassName(r.LAST_CHILD),o&&o.addClassName(r.LAST_CHILD),this.setPropStoreFieldValue("lastChild",o))},childWidgetAdded:function($super,e){$super(e);var t=this.getChildWidth();t&&e.setWidth(t);var r=this.getChildHeight();r&&e.setHeight(r);var i=this.getChildMargin();i&&(e.getStyle().margin=i),this._insertChildWidget(e,null)},childWidgetRemoved:function($super,e){$super(e)},childWidgetMoved:function($super,e,t){$super(e,t);var r=e.getElement(),i=this.getChildWidgets()[t+1],n=i?i.getElement():null;n?this.getContainerElement().insertBefore(r,n):this.getContainerElement().appendChild(r)},updateChildSizes:function(){for(var e=this.getChildWidgets(),t=this.getChildWidth()||"",r=this.getChildHeight()||"",i=this.getChildMargin()||"",n=(this.getLayout(),0),a=e.length;n<a;++n){var o=e[n];o.setWidth(t),o.setHeight(r),o.getStyle().margin=i}}}),e.Widget.Panel=i.create(e.Widget.Container,{CLASS_NAME:"Kekule.Widget.Panel",initProperties:function(){this.defineProp("caption",{dataType:n.STRING,getter:function(){return this.getCaptionElem(!1)&&t.getElementText(this.getCaptionElem())},setter:function(e){t.setElementText(this.getCaptionElem(!0),e),a.setDisplay(this.getCaptionElem(),!!e)}}),this.defineProp("captionElem",{dataType:n.OBJECT,serializable:!1,setter:null,getter:function(e){var i=this.getPropStoreFieldValue("captionElem");if(!i&&e){i=this.getDocument().createElement("div"),i.className=r.PANEL_CAPTION;var n=this.getElement();n.insertBefore(i,t.getFirstChildElem(n)),this.setPropStoreFieldValue("captionElem",i)}return i}})},initPropValues:function($super){$super(),this.setUseCornerDecoration(!0)},doGetWidgetClassName:function($super){return $super()+" "+r.PANEL}}),e.Widget.WidgetGroup=i.create(e.Widget.Container,{CLASS_NAME:"Kekule.Widget.WidgetGroup",initialize:function($super,e){$super(e)},initPropValues:function($super){$super(),this.setUseCornerDecoration(!0)},doObjectChange:function($super,e){$super(e),e.indexOf("useCornerDecoration")>=0&&this._updateChildStyles()},childWidgetAdded:function($super,e){e.setUseCornerDecoration&&e.setUseCornerDecoration(!1),$super(e)},layoutChanged:function($super){$super(),this._updateChildStyles()},childrenModified:function($super){$super(),this._updateChildStyles()},_updateChildStyles:function(){for(var t=(e.Widget.Layout,this.getLayout(),this.getFirstChild()),i=this.getLastChild(),n=this.getUseCornerDecoration(),a=this.getChildWidgets(),o=[r.CORNER_LEADING,r.CORNER_TAILING],s=0,l=a.length;s<l;++s){var d=a[s];d.removeClassName(o),d===t&&n&&d.addClassName(r.CORNER_LEADING),d===i&&n&&d.addClassName(r.CORNER_TAILING)}}}),e.Widget.Toolbar=i.create(e.Widget.WidgetGroup,{CLASS_NAME:"Kekule.Widget.Toolbar",finalize:function($super){var e=this.getChildWidgetInternalNameMap();e&&e.finalize(),$super()},initProperties:function(){this.defineProp("childDefs",{dataType:n.ARRAY,setter:function(e){this.setPropStoreFieldValue("childDefs",e),this.recreateChildrenByDefs()}}),this.defineProp("childWidgetInternalNameMap",{dataType:n.OBJECT,serializable:!1})},doGetWidgetClassName:function($super){return $super()+" "+r.TOOLBAR},doSetShowText:function($super,e){$super(e),this._updateAllChildTextGlyphStyles()},doSetShowGlyph:function($super,e){$super(e),this._updateAllChildTextGlyphStyles()},childWidgetAdded:function($super,e){$super(e),this._updateChildTextGlyphStyles(e)},_updateChildTextGlyphStyles:function(e){e.setShowText&&e.setShowText(this.getShowText()),e.setShowGlyph&&e.setShowGlyph(this.getShowGlyph())},_updateAllChildTextGlyphStyles:function(){for(var e=this.getChildWidgets(),t=e.length-1;t>=0;--t)this._updateChildTextGlyphStyles(e[t])},recreateChildrenByDefs:function(){var t=this.getChildDefs()||[];this.clearWidgets();var r=new e.MapEx(!0);this.setChildWidgetInternalNameMap(r);for(var i=this.getDefaultChildWidgetClassName(),n=0,a=t.length;n<a;++n){var o=t[n];o.widget||o.widgetClass||!i||(o=Object.extend({widget:i},o));var s=e.Widget.createFromHash(this,o);s&&(s.appendToWidget(this),o.internalName&&r.set(o.internalName,s))}},getDefaultChildWidgetClassName:function(){return null},getChildWidgetByInternalName:function(e){var t=this.getChildWidgetInternalNameMap();return t?t.get(e):null}}),e}},function(e,t,r){"use strict";var i=r(0).Class,n=(r(0).ClassEx,r(0).ObjectEx,r(0).DataType);e.exports=function(e){var t=e.DomUtils,r=(e.HtmlElementUtils,e.Widget.HtmlClassNames);return e.Widget.HtmlClassNames=Object.extend(e.Widget.HtmlClassNames,{MENU:"K-Menu",POPUPMENU:"K-PopupMenu",MENUBAR:"K-MenuBar",MENUITEM:"K-MenuItem",MENUITEM_NORMAL:"K-MenuItem-Normal",MENUITEM_SEPARATOR:"K-MenuItem-Separator",SUBMENU_MARKER:"K-SubMenu-Marker",CHECKMENU_MARKER:"K-CheckMenu-Marker"}),e.Widget.MenuItem=i.create(e.Widget.Container,{CLASS_NAME:"Kekule.Widget.MenuItem",BINDABLE_TAG_NAMES:["li"],SUB_MENU_TAGS:["ol","ul"],initialize:function($super,e,t){$super(e),t&&this.setText(t),this._subMenuMarker=null,this._checkMarker=null},initProperties:function(){this.defineProp("text",{dataType:n.STRING,getter:function(){return e.HtmlElementUtils.getInnerText(this.getElement())},setter:function(t){t===e.Widget.MenuItem.SEPARATOR_TEXT?this.setIsSeparator(!0):(t&&this.setIsSeparator(!1),this.changeContentText(t))}}),this.defineProp("checked",{dataType:n.BOOL,setter:function(e){this.getPropStoreFieldValue("checked")!==e&&(this.setPropStoreFieldValue("checked",e),this.checkChanged())}}),this.defineProp("autoCheck",{dataType:n.BOOL}),this.defineProp("isSeparator",{dataType:n.BOOL,setter:function(e){this.setPropStoreFieldValue("isSeparator",e),this.isSeparatorChanged(e)}})},initPropValues:function($super){$super(),this.setUseCornerDecoration(!1),this.setIsSeparator(!1)},doGetWidgetClassName:function($super){return $super()+" "+r.MENUITEM},doCreateRootElement:function(e){return e.createElement("li")},changeContentText:function(e){this.getElement().innerHTML=e||""},isSeparatorChanged:function(e){e?(this.setText("&nbsp;"),this.removeClassName(r.MENUITEM_NORMAL),this.addClassName(r.MENUITEM_SEPARATOR),this.setStatic(!0)):(this.removeClassName(r.MENUITEM_SEPARATOR),this.addClassName(r.MENUITEM_NORMAL),this.setStatic(!1))},doBindElement:function($super,e){$super(e);for(var r=t.getDirectChildElems(e),i=0,n=r.length;i<n;++i){var a=r[i];a.nodeType===Node.ELEMENT_NODE&&this.bindSubMenu(a),a=a.nextSibling}},doDomElemAdded:function(t){e.Widget.getWidgetOnElem(t)||this.bindSubMenu(t)},checkChanged:function(){this.getChecked()?(this._createCheckMarker(),this.addClassName(r.STATE_CHECKED),this.invokeEvent("check")):this.removeClassName(r.STATE_CHECKED)},_createCheckMarker:function(){var e=this._checkMarker;if(!e){var e=this.getDocument().createElement("span");e.className=r.CHECKMENU_MARKER,this.getElement().appendChild(e),this._checkMarker=e}return e},_removeCheckMarker:function(){this._checkMarker&&(this._checkMarker.parentNode.removeChild(this._checkMarker),this._checkMarker=null)},childWidgetAdded:function($super,t){if($super(t),t instanceof e.Widget.Menu)t.setIsSubMenu(!0);else if(t instanceof e.Widget.MenuItem){var r=this.getSubMenu(!0);(function(){t.setParent(r),t.appendToWidget(r)}).defer(10)}},childrenModified:function($super){$super(),this.subMenuChanged()},bindSubMenu:function(t){var r=t.tagName.toLowerCase();if("ul"===r||"ol"===r){var i=new e.Widget.PopupMenu(t);return this.addSubMenu(i),i}},subMenuChanged:function(){var e=this.getSubMenu();e?this._createSubMenuMarker(e):this._removeSubMenuMarker()},getSubMenu:function(t){for(var r=this.getChildWidgets(),i=0,n=r.length;i<n;++i){var a=r[i];if(a instanceof e.Widget.Menu)return a}return t?this.createSubMenu():null},addSubMenu:function(e){return e.appendToWidget(this),this},removeSubMenu:function(e){return e.setParent(null),e},createSubMenu:function(){var t=new e.Widget.PopupMenu(this);return this.addSubMenu(t),t},_createSubMenuMarker:function(e){var t=this._subMenuMarker;if(!t){var t=this.getDocument().createElement("span");t.className=r.SUBMENU_MARKER,this.getElement().appendChild(t),this._subMenuMarker=t}return t},_removeSubMenuMarker:function(){this._subMenuMarker&&(this._subMenuMarker.parentNode.removeChild(this._subMenuMarker),this._subMenuMarker=null)},isLeafItem:function(){var e=this.getElement();return!(e.getElementsByTagName("ul").length||e.getElementsByTagName("ol").length)},isPeriodicalExecuting:function($super){return $super()&&this.getIsActive()},doReactActiviting:function($super,e){$super(e),this.isLeafItem()&&this.getEnablePeriodicalExec()&&this.startPeriodicalExec(e)},doReactDeactiviting:function($super,e){this.isLeafItem()&&(this.stopPeriodicalExec(),this.getIsActive()&&(this.execute(e),this.getAutoCheck()&&this.setChecked(!this.getChecked()),this.notifyDeactivated()))},notifyDeactivated:function(){var e=this.getParent();e&&e.childDeactivated&&e.childDeactivated(this)},childDeactivated:function(e){var t=this.getParent();t&&t.childDeactivated&&t.childDeactivated(this)}}),e.Widget.MenuItem.SEPARATOR_TEXT="-",e.Widget.MenuItem.createFromHash=function(t,r){var i=r;return n.isSimpleValue(i)&&(i=i===e.Widget.MenuItem.SEPARATOR_TEXT?{isSeparator:!0}:{text:i}),i.widget||i.widgetClass||(i.widget=e.Widget.MenuItem),e.Widget.createFromHash(t,i)},e.Widget.Menu=i.create(e.Widget.Container,{CLASS_NAME:"Kekule.Widget.Menu",BINDABLE_TAG_NAMES:["ol","ul"],MENU_ITEM_TAG:"li",initialize:function($super,e){$super(e)},initProperties:function(){this.defineProp("isSubMenu",{dataType:n.BOOL,serializable:!1,setter:function(t){this.setPropStoreFieldValue("isSubMenu",t),t&&this.setLayout(e.Widget.Layout.VERTICAL)}})},initPropValues:function($super){$super(),this.setUseCornerDecoration(!0)},doGetWidgetClassName:function($super){return $super()+" "+r.MENU},doCreateRootElement:function(e){return e.createElement("ul")},doBindElement:function($super,t){$super(t);for(var r=e.DomUtils.getDirectChildElems(t),i=0,n=r.length;i<n;++i){var a=r[i];a.nodeType===Node.ELEMENT_NODE&&this.bindMenuItem(a),a=a.nextSibling}},doDomElemAdded:function(e){this.bindMenuItem(e)},bindMenuItem:function(t){if("li"===t.tagName.toLowerCase()){var r=new e.Widget.MenuItem(t);return r.setParent(this),r}},getSubMenuTagName:function(){return this.getElement().tagName},getMenuItems:function(r){r||(r=this.getElement());for(var i=t.getDirectChildElems(r,this.MENU_ITEM_TAG),n=[],a=0,o=i.length;a<o;++a){var s=e.Widget.getWidgetOnElem(i[a]);s&&s instanceof e.Widget.MenuItem&&n.push(s)}return n},insertMenuItem:function(e,t){return e.insertToWidget(this,t),this},appendMenuItem:function(e){return e.appendToWidget(this),this},removeMenuItem:function(e,t){e.setParent(null),t||e.finalize()},clearMenuItems:function(e){return this.clearWidgets(e),this},isTopLevel:function(){var t=this.getParent();return!t||!(t instanceof e.Widget.MenuItem||t instanceof e.Widget.Menu)},childDeactivated:function(e){var t=this.getParent();t&&t.childDeactivated&&t.childDeactivated(this)},createChildrenByDefs:function(t){for(var r=0,i=t.length;r<i;++r){var n=t[r];e.Widget.MenuItem.createFromHash(this,n)}return this}}),e.Widget.PopupMenu=i.create(e.Widget.Menu,{CLASS_NAME:"Kekule.Widget.PopupMenu",initPropValues:function($super){$super(),this.setLayout(e.Widget.Layout.VERTICAL)},doGetWidgetClassName:function($super){return $super()+" "+r.POPUPMENU},childDeactivated:function(e){}}),e.Widget.MenuBar=i.create(e.Widget.Menu,{CLASS_NAME:"Kekule.Widget.MenuBar",doGetWidgetClassName:function($super){return $super()+" "+r.MENUBAR}}),e}},function(e,t,r){"use strict";var i=r(0).Class,n=(r(0).ClassEx,r(0).ObjectEx,r(0).DataType);e.exports=function(e){var t=e.HtmlElementUtils,r=e.Widget.HtmlClassNames;return e.Widget.HtmlClassNames=Object.extend(e.Widget.HtmlClassNames,{BUTTON:"K-Button",BUTTON_KINDED:"K-Button-Kinded",BUTTON_GROUP:"K-Button-Group",COMPACT_BUTTON:"K-Compact-Button",BTN_COMPACT_MARK:"K-Compact-Mark"}),e.Widget.Button=i.create(e.Widget.BaseWidget,{CLASS_NAME:"Kekule.Widget.Button",BINDABLE_TAG_NAMES:["input","button","a","label"],CSS_DROPDOWN_CLASS_NAME:"K-DropDownMark",DEF_GLYPH_WIDTH:"16px",DEF_GLYPH_HEIGHT:"16px",initialize:function($super,e,t){this._elemTextPart=null,this._elemLeadingGlyphPart=null,this._elemTailingGlyphPart=null,$super(e),t&&this.setText(t)},initProperties:function(){this.defineElemAttribMappingProp("actionType","type"),this.defineProp("text",{dataType:n.STRING,serializable:!1,getter:function(){var e=this._elemTextPart||this.getElement();return e?e.innerHTML:null},setter:function(e){this.changeContentText(e)}}),this.defineProp("leadingGlyph",{dataType:"Kekule.Widget.Glyph",serializable:!1,scope:i.PropertyScope.PUBLIC,setter:null,getter:function(e){var t=this.getPropStoreFieldValue("leadingGlyph");return!t&&e&&(t=this._createDefaultGlyphWidget(this._elemLeadingGlyphPart),this.setPropStoreFieldValue("leadingGlyph",t)),t}}),this.defineProp("tailingGlyph",{dataType:"Kekule.Widget.Glyph",serializable:!1,scope:i.PropertyScope.PUBLIC,setter:null,getter:function(e){var t=this.getPropStoreFieldValue("tailingGlyph");return!t&&e&&(t=this._createDefaultGlyphWidget(this._elemTailingGlyphPart),this.setPropStoreFieldValue("tailingGlyph",t)),t}}),this.defineProp("showLeadingGlyph",{dataType:n.BOOL,scope:i.PropertyScope.PUBLIC,setter:function(e){this.setPropStoreFieldValue("showLeadingGlyph",e),this._elemLeadingGlyphPart.style.display=e&&this.getShowGlyph()?"":"none"}}),this.defineProp("showTailingGlyph",{dataType:n.BOOL,scope:i.PropertyScope.PUBLIC,setter:function(e){this.setPropStoreFieldValue("showTailingGlyph",e),this._elemTailingGlyphPart.style.display=e&&this.getShowGlyph()?"":"none"}}),this.defineProp("buttonKind",{dataType:n.STRING,setter:function(e){var t=this.getButtonKind();e!==t&&(this.cancelButtonKind(t),this.applyButtonKind(e),this.setPropStoreFieldValue("buttonKind",e))}})},initPropValues:function($super){$super(),this.setPropStoreFieldValue("showText",!0),this.setPropStoreFieldValue("showGlyph",!0),this.setPropStoreFieldValue("showLeadingGlyph",!0),this.setPropStoreFieldValue("showTailingGlyph",!0),this.setPropStoreFieldValue("useCornerDecoration",!0),this.setAllowTextWrap(!1)},_createDefaultGlyphWidget:function(t){var r=new e.Widget.Glyph(this);return r.setWidth(this.DEF_GLYPH_WIDTH).setHeight(this.DEF_GLYPH_HEIGHT),r.setStatic(!0).setInheritState(!0).setInheritStatic(!0).setInheritEnabled(!0),r.appendToElem(t),r},doGetWidgetClassName:function($super){return $super()+" "+r.BUTTON},doCreateRootElement:function(e){var t=e.createElement("button");return t.setAttribute("type","button"),t},doBindElement:function($super,e){$super(e);var i=e.innerHTML||"";e.innerHTML="",this._elemTextPart=this.createTextContent(i,e),this._elemLeadingGlyphPart=this.createGlyphContent(e,this._elemTextPart,r.PART_PRI_GLYPH_CONTENT),this._elemTailingGlyphPart=this.createGlyphContent(e,null,r.PART_ASSOC_GLYPH_CONTENT),this.getUseCornerDecoration()&&t.addClass(e,r.CORNER_ALL)},changeContentText:function(e){this._elemTextPart.innerHTML=e||""},isPeriodicalExecuting:function($super){return $super()&&this.getIsActive()},doReactActiviting:function($super,e){$super(e),this.getEnablePeriodicalExec()&&this.startPeriodicalExec(e)},doReactDeactiviting:function($super,e){this.stopPeriodicalExec(),this.getIsActive()&&this.execute(e)},cancelButtonKind:function(e){e&&(this.removeClassName(e),this.removeClassName(r.BUTTON_KINDED))},applyButtonKind:function(e){e&&(this.addClassName(r.BUTTON_KINDED),this.addClassName(e))}}),e.Widget.Button.Kinds={DROPDOWN:"K-Kind-DropDown",POPUP:"K-Kind-Popup",SEARCH:"K-Kind-Search",EDIT:"K-Kind-Edit",ENTER:"K-Kind-Enter"},e.Widget.CheckButton=i.create(e.Widget.Button,{CLASS_NAME:"Kekule.Widget.CheckButton",initialize:function($super,e,t){$super(e,t)},initProperties:function(){this.defineProp("checked",{dataType:n.BOOL,setter:function(e){this.getPropStoreFieldValue("checked")!==e&&(this.setPropStoreFieldValue("checked",e),this.checkChanged(),this.stateChanged())}}),this.defineProp("autoCheck",{dataType:n.BOOL})},initPropValues:function($super){$super(),this.setAutoCheck(!0)},checkChanged:function(){this.getChecked()?this.invokeEvent("check"):this.invokeEvent("uncheck"),this.invokeEvent("checkChange",{checked:this.getChecked()})},getStateClassName:function($super,t){return $super(this.getChecked()?e.Widget.State.ACTIVE:t)},doReactDeactiviting:function($super,e){var t=this.getChecked();$super(e),this.getAutoCheck()&&this._doToggleCheckOnSelf(t)},_doToggleCheckOnSelf:function(e){this.getEnabled()&&this.setChecked(/*!this.getChecked()*/!e)}}),e.Widget.RadioButton=i.create(e.Widget.CheckButton,{CLASS_NAME:"Kekule.Widget.RadioButton",initialize:function($super,e,t){$super(e,t)},initProperties:function(){this.defineProp("group",{dataType:n.STRING})},checkChanged:function($super){$super(),this.getChecked()&&this.uncheckSiblings()},uncheckSiblings:function(){var e=this.getParent(),t=this.getGroup();if(e)for(var r=e.getChildWidgets(),i=0,n=r.length;i<n;++i){var a=r[i];a!==this&&a.getGroup&&a.setChecked&&a.getGroup()===t&&a.setChecked(!1)}},doReactDeactiviting:function($super,e){$super(e)},_doToggleCheckOnSelf:function($super,e){e||$super(e)},_doCheckOnSelf:function(){this.getEnabled()&&this.setChecked(!0)}}),e.Widget.DropDownButton=i.create(e.Widget.Button,{CLASS_NAME:"Kekule.Widget.DropDownButton",doFinalize:function($super){$super()},initProperties:function(){this.defineProp("dropDownWidget",{dataType:"Kekule.Widget.BaseWidget",serializable:!1,getter:function(){var e=this.getPropStoreFieldValue("dropDownWidget");if(!e){var t=this.getDropDownWidgetGetter();t&&(e=t(this),this.setPropStoreFieldValue("dropDownWidget",e))}return e},setter:function(e){this.setPropStoreFieldValue("dropDownWidget",e),e&&e.setDisplayed(!1)}}),this.defineProp("dropDownWidgetGetter",{dataType:n.FUNCTION,serializable:!1}),this.defineProp("dropPosition",{dataType:n.INT})},doCreateRootElement:function($super,e){return $super(e)},calcActualDropPosition:function(){var t=e.Widget.Position,r=this.getDropPosition();if(!r){var i=this.getParent(),n=i?i.getLayout():e.Widget.Layout.HORIZONTAL,a=e.HtmlElementUtils.getElemPageRect(this.getElement(),!0),o=e.HtmlElementUtils.getViewportDimension(this.getElement()),s=this.getDropDownWidget().getElement();s.style.visible="hidden",s.style.display="",this.getElement().appendChild(s);var l=e.HtmlElementUtils.getElemOffsetDimension(s);if(this.getElement().removeChild(s),n)if(n===e.Widget.Layout.VERTICAL){var d=a.x,u=o.width-d-a.width;r=u>=l.width?t.RIGHT:d>u?t.LEFT:t.RIGHT}else{var c=a.y,h=o.height-c-a.height;r=h>=l.height?t.BOTTOM:c>h?t.TOP:t.BOTTOM}}return r},showDropDownWidget:function(){var t=this.getDropDownWidget();t.getElement().style.position="absolute";this.getElement();t.show(this,null,e.Widget.ShowHideType.DROPDOWN),this.invokeEvent("dropDown",{dropDown:t})},hideDropDownWidget:function(){this.getDropDownWidget().hide(this)},isDropDownWidgetShown:function(){var e=this.getDropDownWidget();return e&&e.isShown()},doExecute:function($super,e){this.getDropDownWidget()&&(this.isDropDownWidgetShown()?this.hideDropDownWidget():this.showDropDownWidget()),$super(e)}}),e.Widget.ButtonGroup=i.create(e.Widget.Toolbar,{CLASS_NAME:"Kekule.Widget.ButtonGroup",initialize:function($super,e){$super(e)},initPropValues:function($super){$super(),this.setPropStoreFieldValue("showText",!0),this.setPropStoreFieldValue("showGlyph",!0),this.setAllowChildWrap(!1)},doGetWidgetClassName:function($super){return $super()+" "+r.BUTTON_GROUP},doCreateRootElement:function(e){return e.createElement("span")},getDefaultChildWidgetClassName:function(){return"Kekule.Widget.Button"}}),e.Widget.CompactButtonSet=i.create(e.Widget.DropDownButton,{CLASS_NAME:"Kekule.Widget.CompactButtonSet",initialize:function($super,e,t){this.reactSetButtonExecuteBind=this.reactSetButtonExecute.bind(this),this.setPropStoreFieldValue("showCompactMark",!0),this.setPropStoreFieldValue("cloneSelectedOutlook",!0),$super(e,t),this.getButtonSet()||this.initButtonGroup()},initProperties:function(){this.defineProp("buttonSet",{dataType:"Kekule.Widget.ButtonGroup",serializable:!1,setter:function(e){var t=this.getButtonSet();t!==e&&(t&&t.finalize(),this.initButtonGroup(e))}}),this.defineProp("buttonSetLayout",{dataType:n.INT}),this.defineProp("selected",{dataType:"Kekule.Widget.Button",serializable:!1,setter:function(e){if(e)this.getButtonSet().hasChild(e)&&(this.getCloneSelectedOutlook()&&this.cloneSetButton(e),e.setChecked&&e.setChecked(!0));else{var t=this.getSelected();t&&t.setChecked(!1)}this.setPropStoreFieldValue("selected",e)}}),this.defineProp("cloneSelectedOutlook",{dataType:n.BOOL}),this.defineProp("showCompactMark",{dataType:n.BOOL,setter:function(e){this.getShowCompactMark()!==e&&(this.setPropStoreFieldValue("showCompactMark",e),e?this.createCompactMark():this.removeCompactMark())}})},doGetWidgetClassName:function($super){return $super()+" "+r.COMPACT_BUTTON},doSetShowText:function($super,e){return this.getButtonSet()&&this.getButtonSet().setShowText(e),$super(e)},doSetShowGlyph:function($super,e){return this.getButtonSet()&&this.getButtonSet().setShowGlyph(e),$super(e)},createCompactMark:function(){var e=this.getElement();this._compactMark&&e.removeChild(this._compactMark);var t=this.getDocument().createElement("span");return t.className=r.BTN_COMPACT_MARK,e.appendChild(t),this._compactMark=t,t},removeCompactMark:function(){var e=this.getElement();this._compactMark&&e.removeChild(this._compactMark)},initButtonGroup:function(t){if(t)var r=this._getCheckedButtonInGroup(t);else t=new e.Widget.ButtonGroup(this);t.setDisplayed(!1),t.setShowText(this.getShowText()),t.setShowGlyph(this.getShowGlyph()),this.setPropStoreFieldValue("buttonSet",t),this.setDropDownWidget(t),t.addEventListener("execute",this.reactSetButtonExecuteBind),t.addEventListener("check",this.reactSetButtonExecuteBind),r&&this.cloneSetButton(r)},_getCheckedButtonInGroup:function(e){for(var t=e.getChildWidgets(),r=0,i=t.length;r<i;++r){var n=t[r];if(n.getChecked&&n.getChecked())return n}return null},cloneSetButton:function(t){if(this.getCloneSelectedOutlook()){for(var r=this.getElement(),i=this.getButtonSet().getElement(),n=e.DomUtils,a=n.getDirectChildElems(r),o=n.getDirectChildElems(t.getElement()),s=!1,l=0,d=a.length;l<d;++l){var u=a[l];u!==i?r.removeChild(u):s=!0}for(var l=0,d=o.length;l<d;++l){var u=o[l].cloneNode(!0);s?r.insertBefore(u,i):r.appendChild(u)}this._clonedCustomHtmlClassName&&this.removeClassName(this._clonedCustomHtmlClassName),this._clonedCustomHtmlClassName=t.getCustomHtmlClassName(),this._clonedCustomHtmlClassName&&this.addClassName(this._clonedCustomHtmlClassName),this._compactMark=null,this.createCompactMark()}},calcActualButtonSetLayout:function(){var t=e.Widget.Layout,r=this.getButtonSetLayout();if(!r){var i=this.getParent();r=(i?i.getLayout():t.HORIZONTAL)===t.VERTICAL?t.HORIZONTAL:t.VERTICAL}return r},showDropDownWidget:function($super){var e=this.calcActualButtonSetLayout();this.getButtonSet().setLayout(e),$super()},reactSetButtonExecute:function(t){if(t.target instanceof e.Widget.Button&&t.target!==this.getSelected()&&(!this._currExecButton||this._currExecButton!==t.target))try{this._currExecButton=t.target,t.target.setIsFocused(!1),t.target.setIsHover(!1),t.target.setIsActive(!1),this.setSelected(t.target),this.getButtonSet().isShown()&&this.getButtonSet().hide(),this.invokeEvent("select",{selected:t.target})}finally{this._currExecButton=null}},append:function(e,t){return this.getButtonSet().appendWidget(e),t&&this.setSelected(e),this},insertBefore:function(e,t,r){return this.getButtonSet().insertWidgetBefore(e),r&&this.setSelected(e),this},remove:function(e,t){return this.getButtonSet().removeWidget(e,t),this}}),e}},function(e,t,r){"use strict";var i=r(0).Class,n=(r(0).ClassEx,r(0).ObjectEx,r(0).DataType);e.exports=function(e){var t=e.DomUtils,r=e.HtmlElementUtils,a=e.Widget.HtmlClassNames,o=e.ObjUtils;return e.Widget.HtmlClassNames=Object.extend(e.Widget.HtmlClassNames,{OVERLAP:"K-Overlap",FORMCONTROL:"K-FormControl",CHECKBOX:"K-CheckBox",TEXTBOX:"K-TextBox",COMBOTEXTBOX:"K-ComboTextBox",COMBOTEXTBOX_ASSOC_WIDGET:"K-ComboTextBox-Assoc-Widget",BUTTONTEXTBOX:"K-ButtonTextBox",TEXTAREA:"K-TextArea",SELECTBOX:"K-SelectBox",COMBOBOX:"K-ComboBox",COMBOBOX_TEXTWRAPPER:"K-ComboBox-TextWrapper",NUMINPUT:"K-NumInput"}),e.Widget.FormWidget=i.create(e.Widget.BaseWidget,{CLASS_NAME:"Kekule.Widget.FormWidget",initialize:function($super,e,t){this.reactValueChangeBind=this.reactValueChange.bind(this),this.reactInputBind=this.reactInput.bind(this),this.setPropStoreFieldValue("isDirty",!1),$super(e,t)},initProperties:function(){this.defineProp("name",{dataType:n.STRING,getter:function(){return this.getCoreElement().name},setter:function(e){this.getCoreElement().name=e}}),this.defineProp("value",{dataType:n.VARIANT,serializable:!1,getter:function(){return this.getCoreElement().value},setter:function(e){this.getCoreElement().value=e}}),this.defineProp("isDirty",{dataType:n.BOOL,serializable:!1}),this.defineProp("readOnly",{dataType:n.BOOL,serializable:!1,getter:function(){return this.getCoreElement().readOnly},setter:function(e){this.getCoreElement().readOnly=e}})},getTextSelectable:function(){return!0},doGetWidgetClassName:function($super){return $super()+" "+a.FORMCONTROL},doBindElement:function($super,t){$super(t);var r=this.getCoreElement();if(r){var i=e.Browser.IE&&8===e.Browser.IEVersion;e.X.Event.addListener(r,"change",this.reactValueChangeBind),e.X.Event.addListener(r,"input",this.reactInputBind),i?(this._bindKeyupEvent=!0,e.X.Event.addListener(r,"keyup",this.reactInputBind)):this._bindKeyupEvent=!1}},doUnbindElement:function($super,t){var r=this.getCoreElement();r&&(e.X.Event.removeListener(r,"change",this.reactValueChangeBind),e.X.Event.removeListener(r,"input",this.reactInputBind),this._bindKeyupEvent&&e.X.Event.removeListener(r,"keyup",this.reactInputBind)),$super(t)},notifyValueChanged:function(){this.setIsDirty(!0),this.invokeEvent("valueChange",{widget:this,value:this.getValue()})},selectAll:function(){var e=this.getCoreElement();return e&&e.select&&e.select(),this},reactValueChange:function(){this.notifyValueChanged()},reactInput:function(e){this.setIsDirty(!0),this.invokeEvent("valueInput",{widget:this,value:this.getValue()})}}),e.Widget.CheckBox=i.create(e.Widget.FormWidget,{CLASS_NAME:"Kekule.Widget.CheckBox",BINDABLE_TAG_NAMES:["div","span"],initialize:function($super,t,r){$super(t),e.ObjUtils.notUnset(r)&&this.setChecked(!!r)},initProperties:function(){this.defineProp("checked",{dataType:n.BOOL,getter:function(){var e=this.getCoreElement();return!!e&&e.checked},setter:function(e){var t=this.getCoreElement();t&&(t.checked=!!e)}}),this.defineProp("text",{dataType:n.STRING,getter:function(){return e.DomUtils.getElementText(this.getLabelElem())},setter:function(t){e.DomUtils.setElementText(this.getLabelElem(),t)}})},getCoreElement:function(){return this.getInputElem()},doGetWidgetClassName:function($super){return $super()+" "+a.CHECKBOX},getInputElem:function(){var e=this.getElement();if(e){var t=e.getElementsByTagName("input");if(t&&t.length)return t[0]}return null},getLabelElem:function(){var e=this.getElement();if(e){if("label"===e.tagName.toLowerCase())return e;var t=e.getElementsByTagName("label");if(t&&t.length)return t[0]}return null},doCreateRootElement:function(e){return e.createElement("span")},doCreateSubElements:function(e,t){var r=e.createElement("label");t.appendChild(r);var i=e.createElement("input");return i.setAttribute("type","checkbox"),r.appendChild(i),[r,i]}}),e.Widget.TextBox=i.create(e.Widget.FormWidget,{CLASS_NAME:"Kekule.Widget.TextBox",BINDABLE_TAG_NAMES:["input"],initialize:function($super,e,t){$super(e),t&&this.setText(t)},initProperties:function(){this.defineProp("text",{dataType:n.STRING,getter:function(){return this.getElement().value},setter:function(e){this.getElement().value=e||""}}),this.defineProp("placeholder",{dataType:n.STRING,getter:function(){return this.getElement().placeholder},setter:function(e){this.getElement().placeholder=e}})},doGetWidgetClassName:function($super){return $super()+" "+a.TEXTBOX},doCreateRootElement:function(e){return e.createElement("input")},doBindElement:function($super,e){$super(e),e.setAttribute("type","text")}}),e.Widget.ComboTextBox=i.create(e.Widget.FormWidget,{CLASS_NAME:"Kekule.Widget.ComboTextBox",BINDABLE_TAG_NAMES:["div","span"],initialize:function($super,e,t){$super(e),t&&this.setText(t)},initProperties:function(){this.defineProp("text",{dataType:n.STRING,serializable:!1,getter:function(){var e=this.getTextBox();return e?e.getText():null},setter:function(e){var t=this.getTextBox();t&&t.setText(e)}}),this.defineProp("placeholder",{dataType:n.STRING,getter:function(){return this.getTextBox().getPlaceholder()},setter:function(e){this.getTextBox().setPlaceholder(e)}}),this.defineProp("overlapOnTextBox",{dataType:n.BOOL,setter:function(e){this.setPropStoreFieldValue("overlapOnTextBox",e),e?this.addClassName(a.OVERLAP):this.removeClassName(a.OVERLAP),this.adjustWidgetsSize()}}),this.defineProp("textBox",{dataType:"Kekule.Widget.TextBox",serializable:!1,setter:null}),this.defineProp("headingWidget",{dataType:"Kekule.Widget.BaseWidget",serializable:!1,setter:function(e){var t=this.getHeadingWidget();if(e!==t&&(this.setPropStoreFieldValue("headingWidget",e),t&&(t.setParent(null),t.removeClassName(a.COMBOTEXTBOX_ASSOC_WIDGET)),e)){var r=this.getTextBox()?this.getTextBox().getElement():this.getTailingWidget()?this.getTailingWidget().getElement():null;e.setParent(this),e.addClassName(a.COMBOTEXTBOX_ASSOC_WIDGET),e.insertToElem(this.getElement(),r)}}}),this.defineProp("tailingWidget",{dataType:"Kekule.Widget.BaseWidget",serializable:!1,setter:function(e){var t=this.getTailingWidget();e!==t&&(this.setPropStoreFieldValue("tailingWidget",e),t&&(t.setParent(null),t.removeClassName(a.COMBOTEXTBOX_ASSOC_WIDGET)),e&&(e.setParent(this),e.addClassName(a.COMBOTEXTBOX_ASSOC_WIDGET),e.appendToElem(this.getElement())))}})},finalize:function($super){this._finalizeSubWidgets(),$super()},_finalizeSubWidgets:function(){var e=this.getTextBox();e&&e.finalize();var t=this.getHeadingWidget();t&&t.finalize();var t=this.getTailingWidget();t&&t.finalize()},getCoreElement:function($super){var e=this.getTextBox();return e?e.getElement():$super()},doGetWidgetClassName:function($super){return $super()+" "+a.COMBOTEXTBOX},doCreateRootElement:function(e){return e.createElement("span")},doCreateSubElements:function($super,t,r){var i=$super(t,r);this._finalizeSubWidgets();var n=new e.Widget.TextBox(this);return n.addClassName(a.TEXTBOX),n.appendToElem(this.getElement()),this.setPropStoreFieldValue("textBox",n),i.push(n.getElement()),i},elementBound:function(e){this.setObserveElemResize(!0)},relayEvent:function($super,e,t){var r=t.widget;return r!==this.getTextBox()&&r!==this.getHeadingWidget()&&r!==this.getTailingWidget()||(t.widget=this),$super(e,t)},doSetEnabled:function(e){var t=this.getTextBox();t&&t.setEnabled(e);var r=this.getHeadingWidget();r&&r.setEnabled(e),(r=this.getTailingWidget())&&r.setEnabled(e)},doResize:function(){this.adjustWidgetsSize()},widgetShowStateChanged:function($super,e,t){$super(e,t),e&&this.adjustWidgetsSize()},doInsertedToDom:function(){this.isShown()&&this.adjustWidgetsSize()},assocWidgetChanged:function(){this.adjustWidgetsSize()},adjustWidgetsSize:function(){var t=e.StyleUtils,r=this.getOverlapOnTextBox(),i=r?"absolute":"relative",n=this.getTextBox().getElement();if(n){var a=e.HtmlElementUtils.getElemPageRect(n),o=this.getHeadingWidget(),s=o?o.getElement():null;if(s&&o.isShown()){var l=s.style;if(l.position=i,r){var d=e.HtmlElementUtils.getElemPageRect(s);l.left=0,l.top=(a.height-d.height)/2+"px",n.style.paddingLeft=d.width+"px"}else t.removeStyleProperty(l,"left"),t.removeStyleProperty(l,"top"),t.removeStyleProperty(n.style,"paddingLeft")}else t.removeStyleProperty(n.style,"paddingLeft");var o=this.getTailingWidget(),s=o?o.getElement():null;if(s&&o.isShown()){var l=s.style;if(l.position=i,r){var d=e.HtmlElementUtils.getElemPageRect(s);l.right=0,l.top=(a.height-d.height)/2+"px",n.style.paddingRight=d.width+"px"}else t.removeStyleProperty(l,"right"),t.removeStyleProperty(l,"top"),t.removeStyleProperty(n.style,"paddingRight")}else t.removeStyleProperty(n.style,"paddingRight")}}}),e.Widget.ButtonTextBox=i.create(e.Widget.ComboTextBox,{CLASS_NAME:"Kekule.Widget.ButtonTextBox",initialize:function($super,e,t){$super(e,t),this.setOverlapOnTextBox(!0)},initProperties:function(){this.defineProp("button",{dataType:"Kekule.Widget.Button",serializable:!1,setter:null,getter:function(){return this.getTailingWidget()}}),this.defineProp("buttonKind",{dataType:n.STRING,getter:function(){return this.getButton().getButtonKind()},setter:function(e){this.getButton().setButtonKind(e)}}),this.defineProp("buttonText",{dataType:n.STRING,getter:function(){return this.getButton().getText()},setter:function(e){this.getButton().setText(e).setShowText(!!e)}})},doGetWidgetClassName:function($super){return $super()+" "+a.BUTTONTEXTBOX},doCreateSubElements:function($super,e,t){var r=$super(e,t),i=this.createAssocButton();return i&&r.push(i.getElement()),r},createAssocButton:function(){var t=new e.Widget.Button(this);return t.setShowText(!1),this.setTailingWidget(t),t.addEventListener("change",this.adjustWidgetsSize,this),t.addEventListener("execute",function(e){this.invokeEvent("buttonExecute",{widget:this})},this),t},execBtn:function(e){var t=this.getButton();if(t)return t.execute(e),!0},react_keypress:function(e){13===e.getKeyCode()&&this.execBtn(e)},react_keydown:function(t){if(this.getButtonKind()===e.Widget.Button.Kinds.DROPDOWN){var r=e.X.Event.KeyCode;t.getKeyCode()===r.DOWN&&this.execBtn(t)}}}),e.Widget.TextArea=i.create(e.Widget.FormWidget,{CLASS_NAME:"Kekule.Widget.TextArea",BINDABLE_TAG_NAMES:["textarea"],initialize:function($super,e,t){$super(e),t&&this.setText(t)},initProperties:function(){this.defineProp("text",{dataType:n.STRING,getter:function(){return this.getValue()},setter:function(e){this.setValue(e),this.adjustAutoSize()}}),this.defineProp("placeholder",{dataType:n.STRING,getter:function(){return this.getElement().placeholder},setter:function(e){this.getElement().placeholder=e}}),this.defineProp("autoSizeX",{dataType:n.BOOL,setter:function(e){this.setPropStoreFieldValue("autoSizeX",e),this._autoSizeChanged()}}),this.defineProp("autoSizeY",{dataType:n.BOOL,setter:function(e){this.setPropStoreFieldValue("autoSizeY",e),this._autoSizeChanged()}}),this.defineProp("wrap",{dataType:n.STRING,getter:function(){return this.getElement().wrap},setter:function(e){this.getElement().wrap=e}})},doGetWidgetClassName:function($super){return $super()+" "+a.TEXTAREA},doCreateRootElement:function(e){return e.createElement("textarea")},doBindElement:function($super,e){$super(e),this.adjustAutoSize()},setValue:function($super,e){$super(e),this.adjustAutoSize()},widgetShowStateChanged:function($super,e,t){$super(e,t),e&&this.adjustAutoSize()},doFileDragDrop:function($super,t){if(t){if(e.BrowserFeature.fileapi){var r=this,i=new FileReader;i.onload=function(e){var t=i.result;r.setText(t)},i.readAsText(t[0])}return!0}return $super()},reactValueChange:function($super){this.adjustAutoSize(),$super()},react_keyup:function(){this.adjustAutoSize()},react_keypress:function(){this.adjustAutoSize()},doWidgetShowStateChanged:function(e){e&&this.adjustAutoSize()},_autoSizeChanged:function(){var e=this.getCoreElement().style;this.getAutoSizeX()?(e.overflowX="hidden",this.setWrap("off")):(e.overflowX="auto",this.setWrap("")),this.getAutoSizeY()?e.overflowY="hidden":e.overflowY="auto",this.adjustAutoSize()},adjustAutoSize:function(){(this.getAutoSizeX()||this.getAutoSizeY())&&this.adjustSizeByContent()},adjustSizeByContent:function(){var t=this.getCoreElement(),r=this.getText(),i=!r,n=t.style;this.getAutoSizeX()&&(n.width="1px"),this.getAutoSizeY()&&(n.height="1px");var a=e.HtmlElementUtils.getElemScrollDimension(t),o=e.HtmlElementUtils.getElemClientDimension(t);this.getAutoSizeX()&&(i?n.width="1em":a.width>o.width&&(n.width=a.width+"px")),this.getAutoSizeY()&&(i&&(n.height="1em"),a.height>o.height&&(n.height=a.height+"px"))}}),e.Widget.SelectBox=i.create(e.Widget.FormWidget,{CLASS_NAME:"Kekule.Widget.SelectBox",BINDABLE_TAG_NAMES:["select"],ITEM_DATA_FIELD:"__$item_data__",ITEM_VALUE_FIELD:"__$item_value__",initialize:function($super,e,t){$super(e),t&&this.setItems(t)},initProperties:function(){this.defineProp("items",{dataType:n.ARRAY,serializable:!1,getter:function(){for(var e=this.getAllItemElems(),t=[],r=0,i=e.length;r<i;++r){var n=e[r],a=this._getBoxItemInfo(n);t.push(a)}return t},setter:function(t){var r=this.getElement();if(this.clear(),t)for(var i=e.ArrayUtils.toArray(t),n=0,a=i.length;n<a;++n){var o=i[n];if(o){var s=this._createBoxItemElem(r);this._setBoxItemInfo(s,o)}}}}),this.defineProp("index",{dataType:n.INT,getter:function(){return this.getElement().selectedIndex},setter:function(e){this.getElement().selectedIndex=e}})},doGetWidgetClassName:function($super){return $super()+" "+a.SELECTBOX},doCreateRootElement:function(e){return e.createElement("select")},_createBoxItemElem:function(e,t){var r=e.ownerDocument,i=r.createElement("option");return t?e.insertBefore(i,t):e.appendChild(i),i},doBindElement:function($super,e){$super(e)},doGetValue:function(){var e=this.getSelectedItemElem();if(e){return this._getBoxItemInfo(e).value}},doSetValue:function(e){for(var t=this.getAllItemElems(),r=0,i=t.length;r<i;++r){var n=t[r];if(this._getBoxItemInfo(n).value===e)return void this.setIndex(r)}this.setIndex(-1)},getAllItemElems:function(){return t.getDirectChildElems(this.getElement(),"option")},getSelectedItemElem:function(){for(var e=this.getAllItemElems(),t=0,r=e.length;t<r;++t){var i=e[t];if(i.selected)return i}return null},clear:function(){this.getElement().innerHTML=""},dropDown:function(){var e=(this.getDocument(),this.getElement(),this.getDocument().createEvent("MouseEvents"));e.initEvent("mousedown",!0,!0),this.getElement().dispatchEvent(e)},_getBoxItemInfo:function(e){var t={};return t.text=r.getInnerText(e),t.value=e[this.ITEM_VALUE_FIELD],o.notUnset(e.title)&&(t.title=e.title),o.notUnset(e[this.ITEM_DATA_FIELD])&&(t.data=e[this.ITEM_DATA_FIELD]),t},_setBoxItemInfo:function(t,r){n.isSimpleValue(r)&&(r={value:r});var i=r.text||r.value;return o.notUnset(i)&&e.DomUtils.setElementText(t,i),t.value=""+r.value,t[this.ITEM_VALUE_FIELD]=r.value,o.notUnset(r.title)&&(t.title=r.title),o.notUnset(r.data)&&(t[this.ITEM_DATA_FIELD]=r.data),r.selected?t.setAttribute("selected","selected"):t.selected=!1,this}}),e.Widget.ComboBox=i.create(e.Widget.FormWidget,{CLASS_NAME:"Kekule.Widget.ComboBox",BINDABLE_TAG_NAMES:["div","span"],initialize:function($super,e){$super(e)},initProperties:function(){this.defineProp("text",{dataType:n.STRING,serializable:!1,getter:function(){var e=this.getTextBox();return e?e.getText():null},setter:function(e){var t=this.getTextBox();t&&(t.setText(e),this.textChanged())}}),this.defineProp("items",{dataType:n.ARRAY,serializable:!1,getter:function(){var e=this.getSelectBox();return e?e.getItems():null},setter:function(e){var t=this.getSelectBox();t&&t.setItems(e)}}),this.defineProp("textBox",{dataType:"Kekule.Widget.TextBox",serializable:!1,setter:null,scope:i.PropertyScope.PRIVATE}),this.defineProp("selectBox",{dataType:"Kekule.Widget.SelectBox",serializable:!1,setter:null,scope:i.PropertyScope.PRIVATE})},finalize:function($super){this._finalizeSubElements(),$super()},_finalizeSubElements:function(){var e=this.getTextBox();e&&e.finalize();var t=this.getSelectBox();t&&t.finalize()},getCoreElement:function($super){var e=this.getTextBox();return e?e.getElement():$super()},doGetWidgetClassName:function($super){return $super()+" "+a.COMBOBOX},doCreateRootElement:function(e){return e.createElement("span")},doCreateSubElements:function(t,r){var i=this;this._finalizeSubElements();var n=t.createElement("span");n.className=a.COMBOBOX_TEXTWRAPPER,r.appendChild(n);var o=new e.Widget.TextBox(this);o.appendToElem(n),this.setPropStoreFieldValue("textBox",o);var s=new e.Widget.SelectBox(this);return s.appendToElem(r),this.setPropStoreFieldValue("selectBox",s),s.addEventListener("valueChange",function(e){var t=s.getSelectedItemElem();if(t){var r=t.value,n=t.text||t.value;n!==o.getText()&&(o.setText(n),i.notifyValueChanged()),o.selectAll(),o.focus(),i.invokeEvent("valueSelect",{widget:i,value:r})}}),o.addEventListener("valueChange",function(e){i.textChanged()}),e.X.Event.addListener(o.getElement(),"keydown",function(t){t.getKeyCode()===e.X.Event.KeyCode.DOWN&&s.dropDown()}),[n]},relayEvent:function($super,e,t){var r=t.widget;if(r!==this.getTextBox()&&r!==this.getSelectBox()||(t.widget=this,"valueChange"!==e))return $super(e,t)},textChanged:function(){var e=this.getText(),t=this._getValueOfText(e);this.getSelectBox().setValue(t)},_getValueOfText:function(e){for(var t=this.getSelectBox().getItems(),r=0,i=t.length;r<i;++r){var n=t[r];if(n.text&&n.text===e)return n.value}return e},doSetEnabled:function(e){var t=this.getTextBox();t&&t.setEnabled(e);var r=this.getSelectBox();r&&r.setEnabled(e)},doGetValue:function($super){var e=$super();return this._getValueOfText(e)},doSetValue:function($super,e){var t=e,r=this.getSelectBox().getItems();this.getSelectBox().setIndex(-1);for(var i=0,n=r.length;i<n;++i){var a=r[i];if(a.value===e){t=a.text||a.value,this.getSelectBox().setIndex(i);break}}$super(t)}}),e.Widget.NumInput=i.create(e.Widget.FormWidget,{CLASS_NAME:"Kekule.Widget.NumInput",BINDABLE_TAG_NAMES:["input"],DEF_MIN_VALUE:0,DEF_MAX_VALUE:100,DEF_STEP:1,initialize:function($super,e,t,r,i,n){$super(e),o.notUnset(t)&&this.setMinValue(t),o.notUnset(r)&&this.setMaxValue(r),o.notUnset(i)&&this.setStep(i),n&&this.setControlType(n)},initProperties:function(){this.defineProp("minValue",{dataType:n.NUMBER,getter:function(){return parseFloat(this.getElement().min)||null},setter:function(e){this.getElement().min=e}}),this.defineProp("maxValue",{dataType:n.NUMBER,getter:function(){return parseFloat(this.getElement().max)||null},setter:function(e){this.getElement().max=e}}),this.defineProp("step",{dataType:n.NUMBER,getter:function(){return parseFloat(this.getElement().step)||null},setter:function(e){this.getElement().step=e}}),this.defineProp("controlType",{dataType:n.STRING,getter:function(){return this.getElement().getAttribute("type")},setter:function(e){this.getElement().setAttribute("type",e)}})},doGetValue:function($super){var e=$super();return e?parseFloat(e):0},doGetWidgetClassName:function($super){return $super()+" "+a.NUMINPUT},doCreateRootElement:function(e){return e.createElement("input")},doBindElement:function($super,e){$super(e),e.setAttribute("type","range")}}),e}},function(e,t,r){"use strict";var i=r(0).Class,n=(r(0).ClassEx,r(0).ObjectEx,r(0).DataType);e.exports=function(e){return e.Widget.HtmlClassNames=Object.extend(e.Widget.HtmlClassNames,{STATE_COLLAPSED:"K-State-Collapsed",STATE_EMPTY:"K-State-Empty",NESTED_CONTAINER:"K-NestedContainer",NESTED_CONTAINER_ITEM:"K-NestedContainer-Item"}),e.Widget.NestedContainer=i.create(e.Widget.BaseWidget,{CLASS_NAME:"Kekule.Widget.NestedContainer",DEF_CONTAINER_TAG:"ul",DEF_ITEM_TAG:"li",ITEM_DATA_FIELD:"__$itemData__",initialize:function($super,e){$super(e)},initProperties:function(){this.defineProp("itemInitialExpanded",{dataType:n.BOOL})},doCreateRootElement:function(e){return e.createElement("div")},doBindElement:function($super,e){$super(e)},getContainerElemTag:function(){return this.DEF_CONTAINER_TAG},getItemElemTag:function(){return this.DEF_ITEM_TAG},_createChildItemElem:function(){var t=this.doCreateChildItemElem();return e.HtmlElementUtils.addClass(t,e.Widget.HtmlClassNames.NESTED_CONTAINER_ITEM),e.HtmlElementUtils.addClass(t,e.Widget.HtmlClassNames.STATE_EMPTY),t},doCreateChildItemElem:function(){return this.getDocument().createElement(this.getItemElemTag())},_createChildContainerElem:function(){var t=this.doCreateChildContainerElem();return e.HtmlElementUtils.addClass(t,e.Widget.HtmlClassNames.NESTED_CONTAINER),t},doCreateChildContainerElem:function(){return this.getDocument().createElement(this.getContainerElemTag())},getChildContainerElem:function(e,t){e||(e=this.getElement());var r=e.getElementsByTagName(this.getContainerElemTag()),i=r.length?r[0]:null;return!i&&t&&(i=this._createChildContainerElem(),e.appendChild(i)),i},getItemData:function(e){return e[this.ITEM_DATA_FIELD]},setItemData:function(t,r){this.doSetItemData(t,r),t[this.ITEM_DATA_FIELD]=r;var i=r.children;if(i&&e.ArrayUtils.isArray(i)){this.clearChildItems(t);for(var n=0,a=i.length;n<a;++n){var o=i[n];this.appendChildItem(t,o)}}return this},doSetItemData:function(e,t){},hasChildItem:function(e){return this.getChildItemCount(e)>0},getChildItemCount:function(e){return this.getChildren(e).length},getChildren:function(t){var r=this.getChildContainerElem(t);if(r){return e.DomUtils.getDirectChildElems(r,this.getItemElemTag())}return[]},getChildItemAt:function(e,t){var r=this.getChildren(e);return r.length&&r.length>t?r[t]:null},insertChildItem:function(t,r,i){var a,o=this.getChildContainerElem(t,!0);if(r&&e.DomUtils.isElement(r))a=r;else{var a=this._createChildItemElem();this.getItemInitialExpanded()||e.HtmlElementUtils.addClass(a,e.Widget.HtmlClassNames.STATE_COLLAPSED),r&&this.setItemData(a,r)}var s=n.isSimpleType(i)?this.getChildren(t)[i]:i;return s?o.insertBefore(a,s):o.appendChild(a),this.childItemsChanged(t),a},appendChildItem:function(e,t){return this.insertChildItem(e,t)},removeChildItem:function(e,t){var r=this.getChildContainerElem(e);return r&&(r.removeChild(t),this.hasChildItem(e)||e.removeChild(r),this.childItemsChanged(e)),this},removeChildItemAt:function(e,t){var r=this.getChildItemAt(e,t);return r&&this.removeChildItem(e,r),this},clearChildItems:function(e){var t=this.getChildContainerElem(e);e||(e=this.getElement()),t&&e.removeChild(t),this.childItemsChanged(e)},childItemsChanged:function(t){if(t){var r=e.Widget.HtmlClassNames.STATE_EMPTY;this.hasChildItem(t)?e.HtmlElementUtils.removeClass(t,r):e.HtmlElementUtils.addClass(t,r)}},expandItem:function(t){return e.HtmlElementUtils.removeClass(t,e.Widget.HtmlClassNames.STATE_COLLAPSED),this},collapseItem:function(t){return e.HtmlElementUtils.addClass(t,e.Widget.HtmlClassNames.STATE_COLLAPSED),this},toggleExpandStateOfItem:function(t){return e.HtmlElementUtils.toggleClass(t,e.Widget.HtmlClassNames.STATE_COLLAPSED),this},isChildItem:function(t){return e.HtmlElementUtils.hasClass(t,e.Widget.HtmlClassNames.NESTED_CONTAINER_ITEM)},getBelongedChildItem:function(e){for(var t=e,r=this.getElement(),i=this.getDocument().body;t!==r&&t!==i;)if(t=t.parentNode,this.isChildItem(t))return t;return null},getAllChildItems:function(t){var r=[],i=this.getChildContainerElem(t,!1);if(i)for(var n=e.DomUtils.getDirectChildElems(i),a=0,o=n.length;a<o;++a){var s=n[a];if(this.isChildItem(s)){r.push(s);var l=this.getAllChildItems(s);r=r.concat(l)}}return r},getChildItemRange:function(e,t,r){var i=this.getAllChildItems(r),n=i.indexOf(e),a=i.indexOf(t);if(n>=0&&a>=0){if(n>a){var o=!0,s=n;n=a,a=s}var l=i.slice(n,a+1);return o&&(l=l.reverse()),l}return[]}}),e}},function(e,t,r){"use strict";var i=r(0).Class,n=(r(0).ClassEx,r(0).ObjectEx,r(0).DataType);e.exports=function(e){var t=(e.HtmlElementUtils,e.Widget.HtmlClassNames);return e.Widget.HtmlClassNames=Object.extend(e.Widget.HtmlClassNames,{TREEVIEW:"K-TreeView",TREEVIEW_EXPANDMARK:"K-TreeView-ExpandMark",TREEVIEW_ITEMCONTENT:"K-TreeView-ItemContent"}),e.Widget.TreeView=i.create(e.Widget.NestedContainer,{CLASS_NAME:"Kekule.Widget.TreeView",BELONGED_ITEM_FIELD:"__$treeItem__",initProperties:function(){this.defineProp("selection",{dataType:n.ARRAY,serializable:!1,scope:i.PropertyScope.PUBLIC,getter:function(){var e=this.getPropStoreFieldValue("selection");return e||(e=[],this.setPropStoreFieldValue("selection",e)),e},setter:function(e){this.select(e)}}),this.defineProp("selectedItem",{dataType:n.OBJECT,serializable:!1,getter:function(){var e=this.getSelection();return e.length?e[e.length-1]:null},setter:function(e){this.select(e)}}),this.defineProp("enableMultiSelected",{dataType:n.BOOL})},doGetWidgetClassName:function(){return t.TREEVIEW},doCreateChildItemElem:function($super){var e=$super();if(e){var r=this.createGlyphContent(e,null,t.TREEVIEW_EXPANDMARK);r[this.BELONGED_ITEM_FIELD]=e,e._expandMarkerElem=r;var i=this.getDocument().createElement("span");i.className=t.TREEVIEW_ITEMCONTENT,e.appendChild(i),i[this.BELONGED_ITEM_FIELD]=e,e._contentElem=i}return e},doSetItemData:function(e,t){this.setItemText(e,t.text)},getExpandMarkerElem:function(e){return e._expandMarkerElem},getItemContentElem:function(e){return e._contentElem},getTextPartElem:function(e,t){var r=e._textPartElem;return!r&&t&&(r=this.createTextContent("",this.getItemContentElem(e)),e._textPartElem=r),r},setItemText:function(e,t){this.getTextPartElem(e,!0).innerHTML=t},isItemSelected:function(e){var t=this.getSelection();return!!t&&t.indexOf(e)>=0},selectionChanged:function(){this.notifyPropSet("selection",this.getSelection())},clearSelection:function(){var r=this.getSelection();if(r.length){for(var i=0,n=r.length;i<n;++i){var a=r[i];e.HtmlElementUtils.removeClass(this.getItemContentElem(a),t.STATE_SELECTED)}this.setPropStoreFieldValue("selection",[]),this.selectionChanged()}return this},removeFromSelection:function(r){if(r){var i=e.ArrayUtils.toArray(r);if(i&&i.length){for(var n=this.getSelection(),a=0,o=i.length;a<o;++a){var s=i[a];e.ArrayUtils.remove(n,s)&&e.HtmlElementUtils.removeClass(this.getItemContentElem(s),t.STATE_SELECTED)}this.selectionChanged()}}return this},addToSelection:function(r){if(r){var i=e.ArrayUtils.toArray(r);if(i&&i.length){this.getEnableMultiSelected()||(this.clearSelection(),i=[i[i.length-1]]);for(var n=this.getSelection(),a=0,o=i.length;a<o;++a){var s=i[a];this.isItemSelected(s)||(e.HtmlElementUtils.addClass(this.getItemContentElem(s),t.STATE_SELECTED),n.push(s))}this.selectionChanged()}}return this},toggleSelectionState:function(t){if(t){this.beginUpdate();try{var r=e.ArrayUtils.toArray(t);this.getSelection();if(r&&r.length)for(var i=0,n=r.length;i<n;++i){var a=r[i];this.isItemSelected(a)?this.removeFromSelection(a):this.addToSelection(a)}}finally{this.endUpdate()}}},select:function(t){this.beginUpdate();try{if(this.clearSelection(),t)if(this.getEnableMultiSelected())this.addToSelection(t);else{var r=e.ArrayUtils.toArray(t);this.addToSelection(r[r.length-1])}}finally{this.endUpdate()}},react_click:function(e){var t=e.getTarget(),r=t[this.BELONGED_ITEM_FIELD];if(r&&this.isChildItem(r))this.toggleExpandStateOfItem(r);else if(r=this.getBelongedChildItem(t),e.getShiftKey()){var i=this.getSelectedItem();if(i){var n=this.getChildItemRange(i,r);n.length&&(e.getCtrlKey()?this.addToSelection(n):this.select(n))}else this.select(r)}else e.getCtrlKey()?this.toggleSelectionState(r):r&&this.select(r)},react_dblclick:function(e){var t=e.getTarget(),r=this.getBelongedChildItem(t);r&&this.toggleExpandStateOfItem(r)}}),e}},function(e,t,r){"use strict";var i=r(0).Class,n=(r(0).ClassEx,r(0).ObjectEx,r(0).DataType);e.exports=function(e){var t=e.DomUtils,r=(e.HtmlElementUtils,e.StyleUtils),a=e.Widget.HtmlClassNames;return e.Widget.HtmlClassNames=Object.extend(e.Widget.HtmlClassNames,{DIALOG:"K-Dialog",DIALOG_INSIDE:"K-Dialog-Inside",DIALOG_OVERFLOW:"K-Dialog-Overflow",DIALOG_CLIENT:"K-Dialog-Client",DIALOG_CAPTION:"K-Dialog-Caption",DIALOG_BTN_PANEL:"K-Dialog-Button-Panel"}),e.Widget.DialogButtons={OK:"ok",CANCEL:"cancel",YES:"yes",NO:"no",isPositive:function(t){var r=e.Widget.DialogButtons;return[r.OK,r.YES].indexOf(t)>=0},isNegative:function(t){var r=e.Widget.DialogButtons;return[r.CANCEL,r.NO].indexOf(t)>=0}},e.Widget.Location={DEFAULT:1,CENTER:2,FULLFILL:3,CENTER_OR_FULLFILL:4},e.Widget.Dialog=i.create(e.Widget.BaseWidget,{CLASS_NAME:"Kekule.Widget.Dialog",BINDABLE_TAG_NAMES:["div","span"],BTN_NAME_FIELD:"__$btnName__",initialize:function($super,t,r,i){this._dialogCallback=null,this._modalInfo=null,this._childButtons=[],this.setPropStoreFieldValue("location",e.Widget.Location.CENTER),$super(t),this._dialogOpened=!1,this.setUseCornerDecoration(!0),r&&this.setCaption(r),i&&this.setButtons(i),this.setDisplayed(!1)},doFinalize:function($super){this.getModalInfo()&&this.getGlobalManager().unprepareModalWidget(this),$super()},initProperties:function(){this.defineProp("caption",{dataType:n.STRING,getter:function(){return t.getElementText(this.getCaptionElem())},setter:function(e){t.setElementText(this.getCaptionElem(),e),r.setDisplay(this.getCaptionElem(),!!e)}}),this.defineProp("buttons",{dataType:n.ARRAY,setter:function(e){this.setPropStoreFieldValue("buttons",e),this.getBtnPanelElem()&&r.setDisplay(this.getBtnPanelElem(),e&&e.length),this.buttonsChanged()}}),this.defineProp("result",{dataType:n.STRING,serializable:!1,scope:i.PropertyScope.PUBLIC}),this.defineProp("location",{dataType:n.INT}),this.defineProp("clientElem",{dataType:n.OBJECT,serializable:!1,setter:null,scope:i.PropertyScope.PUBLIC}),this.defineProp("captionElem",{dataType:n.OBJECT,serializable:!1,setter:null,scope:i.PropertyScope.PUBLIC}),this.defineProp("btnPanelElem",{dataType:n.OBJECT,serializable:!1,setter:null,scope:i.PropertyScope.PUBLIC})},initPropValues:function($super){$super(),this.setMovable&&this.setMovable(!0)},getDefaultMovingGripper:function(){return this.getCaptionElem()},getCoreElement:function(){return this.getClientElem()},doGetWidgetClassName:function(){return a.DIALOG},doCreateRootElement:function(e){return e.createElement("div")},doCreateSubElements:function(e,t){var r=[],i=e.createElement("div");i.className=a.DIALOG_CAPTION,t.appendChild(i),this.setPropStoreFieldValue("captionElem",i),r.push(i),this.setMovingGripper&&this.setMovingGripper(i);var i=e.createElement("div");i.className=a.DIALOG_CLIENT,t.appendChild(i),this.setPropStoreFieldValue("clientElem",i),this.doCreateClientContents(i),r.push(i);var i=e.createElement("div");return i.className=a.DIALOG_BTN_PANEL,t.appendChild(i),this.setPropStoreFieldValue("btnPanelElem",i),r.push(i),this.buttonsChanged(),r},doCreateClientContents:function(e){},buttonsChanged:function(){for(var e=this._childButtons.length-1;e>=0;--e){this._childButtons[e].finalize()}for(var t=this.getButtons()||[],e=0,r=t.length;e<r;++e)this.createDialogButton(t[e])},createDialogButton:function(t,r,i,n){var a=this._getPredefinedButtonInfo(t);if(a||(a={text:t}),a){var o=new e.Widget.Button(this,a.text);o[this.BTN_NAME_FIELD]=t,o.addEventListener("execute",this._reactDialogBtnExec,this),o.appendToElem(this.getBtnPanelElem()),o.__$name__=t;var s=r||this._getDialogButtonResName(t);return s&&o.linkStyleResource(s),this._childButtons.push(o),o}return null},_getDialogButtonResName:function(t){var r=e.Widget.DialogButtons;return[r.OK,r.YES].indexOf(t)>=0?e.Widget.StyleResourceNames.BUTTON_YES_OK:[r.CANCEL,r.NO].indexOf(t)>=0?e.Widget.StyleResourceNames.BUTTON_NO_CANCEL:null},_reactDialogBtnExec:function(t){var r=e.Widget.DialogButtons,i=[r.OK,r.YES,r.CANCEL,r.NO],n=t.target;if(n){var a=n.__$name__;i.indexOf(a)>=0&&(this.setResult(a),this.close(a))}},_getPredefinedButtonInfo:function(t){var r=e.Widget.DialogButtons,i=[r.OK,r.CANCEL,r.YES,r.NO],n=[e.$L("WidgetTexts.CAPTION_OK"),e.$L("WidgetTexts.CAPTION_CANCEL"),e.$L("WidgetTexts.CAPTION_YES"),e.$L("WidgetTexts.CAPTION_NO")],a=i.indexOf(t);return a>=0?{text:n[a]}:null},getDialogButton:function(e){for(var t=this._childButtons.length-1;t>=0;--t){var r=this._childButtons[t];if(r[this.BTN_NAME_FIELD]===e)return r}return null},needAdjustPosition:function(){return this.getShowHideType()!==e.Widget.ShowHideType.DROPDOWN},_storePositionInfo:function(){if(this.needAdjustPosition()){var e=this.getElement(),t=e.style;this._posInfo={left:t.left,top:t.top,right:t.right,bottom:t.bottom,width:t.width,height:t.height,position:t.position}}},_restorePositionInfo:function(){if(this.needAdjustPosition()){var e=this.getElement(),t=e.style,r=this._posInfo;r&&(t.left=r.left,t.top=r.top,t.right=r.right,t.bottom=r.bottom,t.width=r.width,t.height=r.height,t.position=r.position)}},adjustLocation:function(){if(this.needAdjustPosition()){this._storePositionInfo();var t=e.Widget.Location,r=this.getLocation()||t.DEFAULT,i=!1;if(r!==t.DEFAULT){var n,o,s,l,d,u,c=this.getDisplayed(),h=this.getVisible();try{this.setDisplayed(!0,!0),this.setVisible(!0,!0);var m=e.DocumentUtils.getInnerClientDimension(this.getDocument()),g=e.HtmlElementUtils.getElemPageRect(this.getElement(),!0),f=g.right-g.left,p=g.bottom-g.top,C=this.getOffsetParent();C&&e.HtmlElementUtils.getElemPageRect(C,!0);i=f>=m.width||p>=m.height}finally{this.setVisible(h,!0),this.setDisplayed(c,!0)}if(r===t.CENTER_OR_FULLFILL)if(i){e.DocumentUtils.getClientVisibleBox(this.getDocument());f>=m.width?(n=0,d=0):n=(m.width-f)/2,p>=m.height?(o=0,u=0):o=(m.height-p)/2}else r=t.CENTER;if(r===t.FULLFILL?(n=0,o=0,d=0,u=0):r===t.CENTER&&(n=(m.width-f)/2,o=(m.height-p)/2),i){this.removeClassName(a.DIALOG_INSIDE),this.addClassName(a.DIALOG_OVERFLOW);var b=e.DocumentUtils.getScrollPosition(this.getDocument());n+=b.left,o+=b.top,n<0&&(n=0),o<0&&(o=0)}else this.removeClassName(a.DIALOG_OVERFLOW),this.addClassName(a.DIALOG_INSIDE);var E=this.getElement().style,N=e.ObjUtils.notUnset;N(n)&&(E.left=n+"px"),N(o)&&(E.top=o+"px"),N(d)&&(E.right=d+"px"),N(u)&&(E.bottom=d+"px"),N(s)&&(E.width=s+"px"),N(l)&&(E.height=l+"px"),this.adjustClientSize(s,l,i)}this._posAdjusted=!0}},adjustClientSize:function(e,t,r){},prepareShow:function(e,t){var r=this.getElement();if(!r.parentNode){this.getGlobalManager().getWidgetContextRootElement(t).appendChild(r)}var i=this;setTimeout(function(){i._dialogCallback=e},0)},openModal:function(e,t){return this.getGlobalManager().prepareModalWidget(this,t),this.open(e,t)},openPopup:function(t,r){return this.open(t,r,e.Widget.ShowHideType.POPUP)},open:function(t,r,i){return this.prepareShow(t,r),this.show(r,null,i||e.Widget.ShowHideType.DIALOG),this._dialogOpened=!0,this},close:function(e){this.setResult(e),this.hide()},isPositiveResult:function(t){return e.Widget.DialogButtons.isPositive(t||this.getResult())},isNegativeResult:function(t){return e.Widget.DialogButtons.isNegative(t||this.getResult())},widgetShowStateBeforeChanging:function($super,e){$super(e),e&&(this.adjustLocation(),this.setResult(null))},doWidgetShowStateChanged:function($super,e){$super(e),e||this._dialogCallback&&(this._dialogCallback(this.getResult()),this._dialogCallback=null)},widgetShowStateDone:function($super,e){$super(e),!e&&this._dialogOpened&&(this.getModalInfo()&&this.getGlobalManager().unprepareModalWidget(this),this.isShown()||this._restorePositionInfo(),this._dialogOpened=!1)}}),e}},function(e,t,r){"use strict";var i=r(0).Class,n=r(0).ClassEx,a=(r(0).ObjectEx,r(0).DataType);e.exports=function(e){var t=e.HtmlElementUtils,r=e.Widget.HtmlClassNames;return e.Widget.HtmlClassNames=Object.extend(e.Widget.HtmlClassNames,{MSGPANEL:"K-MsgPanel",MSGPANEL_CONTENT:"K-MsgPanel-Content",MSGGROUP:"K-MsgGroup",MSGGROUP_FOR_WIDGET:"K-Widget-MsgGroup",MSG_NORMAL:"K-Msg-Normal",MSG_INFO:"K-Msg-Info",MSG_WARNING:"K-Msg-Warning",MSG_ERROR:"K-Msg-Error"}),e.Widget.MsgType={NORMAL:"",INFO:"info",WARNING:"warning",ERROR:"error"},e.Widget.MsgPanel=i.create(e.Widget.BaseWidget,{CLASS_NAME:"Kekule.Widget.MsgPanel",BINDABLE_TAG_NAMES:["span","div"],initialize:function($super,e,t,r){this._contentElem=null,this._elemTextPart=null,this._elemLeadingGlyphPart=null,this._elemTailingGlyphPart=null,this.setPropStoreFieldValue("showText",!0),$super(e),t&&this.setText(t),r&&this.setMsgType(r),this.setUseCornerDecoration(!0)},initProperties:function(){this.defineProp("text",{dataType:a.STRING,serializable:!1,getter:function(){return e.HtmlElementUtils.getInnerText(this.getElement())},setter:function(e){this.changeContentText(e)}}),this.defineProp("showLeadingGlyph",{dataType:a.BOOL,setter:function(e){this.setPropStoreFieldValue("showLeadingGlyph",e),this._elemLeadingGlyphPart.style.display=e?"":"none"}}),this.defineProp("showTailingGlyph",{dataType:a.BOOL,setter:function(e){this.setPropStoreFieldValue("showTailingGlyph",e),this._elemTailingGlyphPart.style.display=e?"":"none"}}),this.defineProp("msgType",{dataType:a.STRING,setter:function(e){var t=this.getMsgType();if(t!==e){var r=this.getClassNameForMsgType(t),i=this.getClassNameForMsgType(e);r!==i&&(this.removeClassName(r),this.addClassName(i)),this.setPropStoreFieldValue("msgType",e)}}})},doGetWidgetClassName:function($super){return $super()+" "+r.MSGPANEL},doCreateRootElement:function(e){return e.createElement("span")},doCreateSubElements:function($super,e,i){var n=$super(e,i)||[],a=t.getInnerText(i);i.innerHTML="";var o=e.createElement("span");return o.className=r.MSGPANEL_CONTENT,i.appendChild(o),this._contentElem=o,this._elemTextPart=this.createTextContent(a,o),this._elemLeadingGlyphPart=this.createGlyphContent(o,this._elemTextPart,r.PART_PRI_GLYPH_CONTENT),this._elemTailingGlyphPart=this.createGlyphContent(o,null,r.PART_ASSOC_GLYPH_CONTENT),n.push(o),n},doSetUseCornerDecoration:function($super,t){$super(t),t?e.HtmlElementUtils.addClass(this._contentElem,r.CORNER_ALL):e.HtmlElementUtils.removeClass(this._contentElem,r.CORNER_ALL)},getTextSelectable:function(){return!0},changeContentText:function(t){e.DomUtils.setElementText(this._elemTextPart,t||"")},getClassNameForMsgType:function(t){var i=e.Widget.MsgType;switch(t){case i.INFO:return r.MSG_INFO;case i.WARNING:return r.MSG_WARNING;case i.ERROR:return r.MSG_ERROR;default:return r.MSG_NORMAL}}}),e.Widget.MsgGroup=i.create(e.Widget.WidgetGroup,{CLASS_NAME:"Kekule.Widget.MsgGroup",BINDABLE_TAG_NAMES:["span","div"],initialize:function($super,t){$super(t),this.setLayout(e.Widget.Layout.VERTICAL)},initProperties:function(){this.defineProp("reversedOrder",{dataType:a.BOOL}),this.defineProp("maxMsgCount",{dataType:a.INT,setter:function(e){this.setPropStoreFieldValue("maxMsgCount",e),this.clearExcessiveMsgs()}}),this.defineProp("msgFlashTime",{dataType:a.INT})},initPropValues:function($super){$super(),this.setMsgFlashTime(6e3)},doGetWidgetClassName:function($super){return $super()+" "+r.MSGGROUP},doCreateRootElement:function(e){return e.createElement("div")},addMessage:function(t,r,i,n){if(t||r){var a=new e.Widget.MsgPanel(this,t,r);a.setFinalizeAfterHiding(!0),n&&a.addClassName(n);this.getReversedOrder()?a.insertToWidget(this,this.getChildAt(0)):a.appendToWidget(this);var o=e.ObjUtils.isUnset(i)?this.getMsgFlashTime():i;return o?a.flash(o,this):a.show(this),this.clearExcessiveMsgs(),a}},clearExcessiveMsgs:function(){var e=this.getMaxMsgCount();if(e&&e>0){var t=this.getChildWidgets().length,r=t-e;if(r>0){var i,n=0,a=this;!function e(){n<r&&(i=a.getOldestMsgPanel(),a.hideMsgPanel(i,e),++n)}()}}},getOldestMsgPanel:function(){return this.getReversedOrder()?this.getLastChild():this.getFirstChild()},hideMsgPanel:function(e,t){return e.hide(this,t),e}}),n.defineProp(e.Widget.BaseWidget,"msgReporter",{dataType:"Kekule.Widget.MsgGroup",serializable:!1,setter:null,getter:function(t){var i=this.getPropStoreFieldValue("msgReporter");return!i&&t&&(i=new e.Widget.MsgGroup(this),i.addClassName(r.MSGGROUP_FOR_WIDGET),i.appendToWidget(this),this.setPropStoreFieldValue("msgReporter",i)),i}}),n.extend(e.Widget.BaseWidget,{reportMessage:function(e,t,r,i){var n=this.getMsgReporter(!0),a=n.addMessage(e,t,r||0,i);return n.setDisplayed(!0),a},flashMessage:function(e,t,r,i){return this.reportMessage(e,t,r||this.getMsgReporter(!0).getMsgFlashTime(),i)},removeMessage:function(e){e.hide()}}),e}},function(e,t,r){"use strict";var i=r(0).Class,n=(r(0).ClassEx,r(0).ObjectEx,r(0).DataType);e.exports=function(e){var t=(e.HtmlElementUtils,e.Widget.HtmlClassNames),r=e.ArrayUtils;return e.Widget.HtmlClassNames=Object.extend(e.Widget.HtmlClassNames,{TABVIEW:"K-TabView",TABVIEW_TABBUTTON:"K-TabView-TabButton",TABVIEW_CLIENT:"K-TabView-Client",TABVIEW_PAGE:"K-TabView-Page",TABVIEW_ACTIVE_PAGE:"K-TabView-Active-Page",TABVIEW_TABBUTTON_CONTAINER:"K-TabView-TabButton-Container",TABVIEW_PAGE_CONTAINER:"K-TabView-Page-Container",TABBUTTONGROUP:"K-TabButtonGroup",TAB_AT_LEFT:"K-TabAtLeft",TAB_AT_RIGHT:"K-TabAtRight",TAB_AT_TOP:"K-TabAtTop",TAB_AT_BOTTOM:"K-TabAtBottom"}),e.Widget.TabPage=i.create(e.Widget.BaseWidget,{CLASS_NAME:"Kekule.Widget.TabPage",initProperties:function(){this.defineProp("text",{dataType:n.STRING}),this.defineProp("active",{dataType:n.STRING,getter:function(){var e=this.getTabView();return e?e.getActiveTabPage()===this:this.getPropStoreFieldValue("active")},setter:function(e){this.setPropStoreFieldValue("active",e);var t=this.getTabView();t&&e&&t.setActiveTabPage(this)}})},doGetWidgetClassName:function($super){return $super()+" "+t.TABVIEW_PAGE},doCreateRootElement:function(e){return e.createElement("div")},getTabView:function(){var t=this.getParent();return t instanceof e.Widget.TabView?t:null}}),e.Widget.TabButtonGroup=i.create(e.Widget.ButtonGroup,{CLASS_NAME:"Kekule.Widget.TabButtonGroup",initialize:function($super,t){$super(t),this.addEventListener("execute",function(t){var r=t.target;r instanceof e.Widget.RadioButton&&this.invokeEvent("switch",{button:r})},this),this.tabButtonPosChanged()},initProperties:function(){this.defineProp("tabButtonPosition",{dataType:n.INT,enumSource:e.Widget.Position,setter:function(e){this.getTabButtonPosition()!==e&&(this.setPropStoreFieldValue("tabButtonPosition",e),this.tabButtonPosChanged())}}),this.defineProp("activeTabIndex",{dataType:n.INT,getter:function(){for(var e=this.getTabButtons(),t=0,r=e.length;t<r;++t)if(e[t].getChecked())return t;return-1},setter:function(e){for(var t=this.getTabButtons(),r=0,i=t.length;r<i;++r)t[r].setChecked(r===e)}})},initPropValues:function($super){$super(),this.setUseCornerDecoration(!1)},doGetWidgetClassName:function($super){return $super()+" "+t.TABBUTTONGROUP},getTabButtons:function(){for(var t=[],r=this.getChildWidgets(),i=0,n=r.length;i<n;++i){var a=r[i];a instanceof e.Widget.RadioButton&&t.push(a)}return t},tabButtonPosChanged:function(){var r=e.Widget.Position,i=this.getTabButtonPosition(),n=i&r.LEFT||i&r.RIGHT,a=i&r.RIGHT?t.TAB_AT_RIGHT:i&r.BOTTOM?t.TAB_AT_BOTTOM:i&r.LEFT?t.TAB_AT_LEFT:t.TAB_AT_TOP;this._lastTabBtnPosClassName&&this.removeClassName(this._lastTabBtnPosClassName),this._lastTabBtnPosClassName=a,this.addClassName(this._lastTabBtnPosClassName),this.setLayout(n?e.Widget.Layout.VERTICAL:e.Widget.Layout.HORIZONTAL)}}),e.Widget.TabView=i.create(e.Widget.Container,{CLASS_NAME:"Kekule.Widget.TabView",TAB_BTN_FIELD:"__$tabButton__",initialize:function($super,t){this._tabBtnContainer=null,this._pageContainer=null,$super(t),e.ObjUtils.isUnset(this.getUseCornerDecoration())&&this.setUseCornerDecoration(!0),this.tabButtonPosChanged(),this.addEventListener("change",this.reactTabPagePropChange,this)},doFinalize:function($super){this.getTabGroup()&&this.getTabGroup().finalize(),$super()},initProperties:function(){this.defineProp("tabPages",{dataType:n.ARRAY,serializable:!1,getter:function(){var e=this.getPropStoreFieldValue("tabPages");return e||(e=[],this.setPropStoreFieldValue("tabPages",e)),e},setter:null}),this.defineProp("activeTabPage",{dataType:"Kekule.Widget.TabPage",serializable:!1,setter:function(e){var r=this.getActiveTabPage();r!==e&&this.hasChild(e)&&(this.setPropStoreFieldValue("activeTabPage",e),r&&(r.removeClassName(t.TABVIEW_ACTIVE_PAGE),this._getPageTabButton(r).setChecked(!1)),e&&(e.addClassName(t.TABVIEW_ACTIVE_PAGE),this._getPageTabButton(e).setChecked(!0),this.invokeEvent("switchTab",{tabPage:e})))}}),this.defineProp("activeTabIndex",{dataType:n.INT,serializable:!1,getter:function(){return this.getTabPages().indexOf(this.getActiveTabPage())},setter:function(e){var t=this.getTabPages()[e];t&&this.setActiveTabPage(t)}}),this.defineProp("tabButtonPosition",{dataType:n.INT,enumSource:e.Widget.Position,setter:function(e){this.getTabButtonPosition()!==e&&(this.setPropStoreFieldValue("tabButtonPosition",e),this.tabButtonPosChanged())}}),this.defineProp("showTabButtons",{dataType:n.BOOL,getter:function(){var e=this.getTabGroup();return e&&e.getDisplayed()},setter:function(e){var t=this.getTabGroup();t&&t.setDisplayed(e)}}),this.defineProp("tabGroup",{dataType:"Kekule.Widget.ButtonGroup",serializable:!1,setter:null,scope:i.PropertyScope.PRIVATE})},doGetWidgetClassName:function($super){return $super()+" "+t.TABVIEW},doCreateRootElement:function(e){return e.createElement("div")},doCreateSubElements:function(e,r){var i=e.createElement("div");i.className=t.TABVIEW_TABBUTTON_CONTAINER;var n=this.doCreateContainerElement(e,null,"div");return n.className=t.TABVIEW_PAGE_CONTAINER,this._tabBtnContainer=i,this._pageContainer=n,r.appendChild(i),r.appendChild(n),this.setPropStoreFieldValue("tabGroup",this.doCreateTabbar(e,i)),[i,n]},doCreateTabbar:function(t,r){var i=new e.Widget.TabButtonGroup(t);return i.setParent(this),i.appendToElem(r),i.addEventListener("switch",function(e){var t=e.button,r=this._getPageOfTabButton(t);r&&this.setActiveTabPage(r)},this),i},getChildrenHolderElement:function(){return this._pageContainer},getContainerElement:function(){return this._pageContainer},_getPageTabButton:function(e){return e[this.TAB_BTN_FIELD]},_setPageTabButton:function(e,t){e[this.TAB_BTN_FIELD]=t},_getPageOfTabButton:function(e){for(var t=this.getTabPages(),r=0,i=t.length;r<i;++r){var n=t[r];if(this._getPageTabButton(n)===e)return n}return null},childWidgetAdded:function($super,t){if($super(t),t instanceof e.Widget.TabPage){var r=!this.getTabPages().length;t.appendToElem(this._pageContainer),this.getTabPages().push(t),this._insertTabButtonBefore(t),(r||t.getActive())&&this.setActiveTabPage(t)}},childWidgetRemoved:function($super,t){$super(t),t instanceof e.Widget.TabPage&&(r.remove(this.getTabPages(),t),this._removeTabButton(t))},childWidgetMoved:function($super,t,r){$super(t,r),t instanceof e.Widget.TabPage&&this._changeTabIndex(t,r)},_insertTabButtonBefore:function(t,r){var i=this.getTabGroup(),n=new e.Widget.RadioButton(this.getDocument());this._updateTabButton(t,n),this._setPageTabButton(t,n),r?n.insertToWidget(i,r):n.appendToWidget(i)},_updateTabButton:function(e,t){t||(t=this._getPageTabButton(e)),t.setText(e.getText()||""),e.getHint()&&t.setHint(e.getHint())},_removeTabButton:function(e){var t=this._getPageTabButton(e);t&&t.finalize()},_changeTabIndex:function(e,t){var i=this._getPageTabButton(e);this.getTabGroup()._moveChild(i,t);var n=this.getTabPages(),a=n.indexOf(e);a>=0&&a!==t&&r.changeItemIndex(n,e,t)},reactTabPagePropChange:function(t){var r=t.target;if(r instanceof e.Widget.TabPage){var i=this._getPageTabButton(r);i&&this._updateTabButton(r,i)}},tabButtonPosChanged:function(){var r=e.Widget.Position,i=this.getTabButtonPosition(),n=i&r.BOTTOM||i&r.RIGHT,a=(i&r.LEFT||r.RIGHT,i&r.RIGHT?t.TAB_AT_RIGHT:i&r.BOTTOM?t.TAB_AT_BOTTOM:i&r.LEFT?t.TAB_AT_LEFT:t.TAB_AT_TOP);this._lastTabBtnPosClassName&&this.removeClassName(this._lastTabBtnPosClassName),this._lastTabBtnPosClassName=a,this.addClassName(this._lastTabBtnPosClassName),this.getTabGroup().setTabButtonPosition(i),n?this.getElement().appendChild(this._tabBtnContainer):this.getElement().insertBefore(this._tabBtnContainer,this._pageContainer)},createNewTabPage:function(t,r,i){var n=this.getDocument(),a=new e.Widget.TabPage(n);if(a.setText(t),r&&a.setHint(r),a.appendToWidget(this),i){var o=this.getChildWidgets().indexOf(i);this._moveChild(a,o)}return a}}),e}},function(e,t,r){"use strict";var i=r(0).Class,n=(r(0).ClassEx,r(0).ObjectEx,r(0).DataType);e.exports=function(e){var t=e.DomUtils,r=e.HtmlElementUtils,a=e.Widget.HtmlClassNames;e.Widget.HtmlClassNames=Object.extend(e.Widget.HtmlClassNames,{VALUELISTEDITOR:"K-ValueListEditor",VALUELISTEDITOR_ROW:"K-ValueListEditor-Row",VALUELISTEDITOR_CELL:"K-ValueListEditor-Cell",VALUELISTEDITOR_INDICATORCELL:"K-ValueListEditor-IndicatorCell",VALUELISTEDITOR_KEYCELL:"K-ValueListEditor-KeyCell",VALUELISTEDITOR_VALUECELL:"K-ValueListEditor-ValueCell",VALUELISTEDITOR_CELL_CONTENT:"K-ValueListEditor-CellContent",VALUELISTEDITOR_VALUECELL_TEXT:"K-ValueListEditor-ValueCellText",VALUELISTEDITOR_INLINE_EDIT:"K-ValueListEditor-InlineEdit",VALUELISTEDITOR_EXPANDMARK:"K-ValueListEditor-ExpandMark",VALUELISTEDITOR_ACTIVE_ROW:"K-ValueListEditor-ActiveRow"}),e.Widget.ValueListEditor=i.create(e.Widget.BaseWidget,{CLASS_NAME:"Kekule.Widget.ValueListEditor",BINDABLE_TAG_NAMES:["table"],ROW_ELEM_TAG:"tr",CELL_ELEM_TAG:"td",ROW_DATA_FIELD:"__$row_data__",ROW_EDIT_INFO_FIELD:"__$row_edit_info__",initialize:function($super,e){$super(e),this._inlineEdit=null,this._isActivitingRow=!1},initProperties:function(){this.defineProp("hash",{dataType:n.HASH,getter:function(){return this._getTotalHash()},setter:function(e){this._setTotalHash(e),this.setPropStoreFieldValue("hash",e)}}),this.defineProp("readOnly",{dataType:n.BOOL}),this.defineProp("useKeyHint",{dataType:n.BOOL}),this.defineProp("valueDisplayMode",{dataType:n.INT,enumSource:e.Widget.ValueListEditor.ValueDisplayMode,setter:function(e){this.getValueDisplayMode()!==e&&(this.setPropStoreFieldValue("valueDisplayMode",e),this.valueDisplayModeChanged())}}),this.defineProp("activeRow",{dataType:n.OBJECT,serializable:!1,scope:i.PropertyScope.PUBLIC,setter:function(e){var t=this.getActiveRow();t!==e&&(t&&(this.finishEditing(),r.removeClass(t,a.VALUELISTEDITOR_ACTIVE_ROW),this._showValueCellText(t)),this._inlineEdit&&this._inlineEdit.finalize(),e&&(r.addClass(e,a.VALUELISTEDITOR_ACTIVE_ROW),this.getReadOnly()||this.createValueEditWidget(e)),this.setPropStoreFieldValue("activeRow",e),this.invokeEvent("activeRowChange",{row:e}))}})},doGetWidgetClassName:function(){return a.VALUELISTEDITOR},doCreateRootElement:function(e){return e.createElement("table")},doBindElement:function($super,e){$super(e)},getRootElem:function(){return this.getElement()},createRowElem:function(e){var t=e.createElement(this.ROW_ELEM_TAG);return r.addClass(t,a.VALUELISTEDITOR_ROW),t},createCellElem:function(e){var t=e.createElement(this.CELL_ELEM_TAG);return r.addClass(t,a.VALUELISTEDITOR_CELL),t},createIndicatorCellElem:function(e){var t=this.createCellElem(e);r.addClass(t,a.VALUELISTEDITOR_INDICATORCELL);var i=e.createElement("span");return t.appendChild(i),t},createKeyCellElem:function(e){var t=this.createCellElem(e);return r.addClass(t,a.VALUELISTEDITOR_KEYCELL),t},createValueCellElem:function(e){var t=this.createCellElem(e);return r.addClass(t,a.VALUELISTEDITOR_VALUECELL),t},createValueEditWidget:function(e){var t=null;if(e===this.getActiveRow()?t=this._inlineEdit:this._inlineEdit&&(this._inlineEdit.finalize(),this._inlineEdit=null),!t){t=this.doCreateValueEditWidget(e),t.setBubbleUiEvents(!0),r.addClass(t.getElement(),a.VALUELISTEDITOR_INLINE_EDIT);var i=this.getValueCell(e),n=this.getCellContentWrapper(i,!0);t.appendToElem(n)}return t&&(t.focus&&t.focus(),t.selectAll&&t.selectAll(),this._inlineEdit=t,this._hideValueCellText(e)),t},doCreateValueEditWidget:function(e){var t=this.getRowData(e),r=this.getValueCellText(e,t),i=this.getValueEditWidgetInfo(e),n=i.widgetClass,a=new n(this);return i.propValues&&a.setPropValues(i.propValues),a.setValue(r),a},getDefaultValueEditWidgetInfo:function(){return{widgetClass:e.Widget.TextBox}},getValueEditWidgetInfo:function(e){return this.getRowEditInfo(e)||this.getDefaultValueEditWidgetInfo()},getRowElems:function(){return this.getRootElem()?t.getDirectChildElems(this.getRootElem(),this.ROW_ELEM_TAG):[]},getRows:function(){return this.getRowElems()},getRowCount:function(){var e=this.getRowElems();return e?e.length:0},getRowAt:function(e){var t=this.getRowElems();return t?t[e]:null},getPrevRow:function(e){for(var t=this.ROW_ELEM_TAG.toLowerCase(),r=e.previousSibling;r&&(r.nodeType!==Node.ELEMENT_NODE||r.tagName.toLowerCase()!==t);)r=r.previousSibling;return r},getNextRow:function(e){for(var t=this.ROW_ELEM_TAG.toLowerCase(),r=e.nextSibling;r&&(r.nodeType!==Node.ELEMENT_NODE||r.tagName.toLowerCase()!==t);)r=r.nextSibling;return r},getKeyCell:function(e){return t.getDirectChildElems(e,this.CELL_ELEM_TAG)[1]},getCellContentWrapper:function(e,i){var n=t.getDirectChildElems(e),o=n?n[0]:null;return!o&&i&&(o=e.ownerDocument.createElement("span"),e.appendChild(o),r.addClass(o,a.VALUELISTEDITOR_CELL_CONTENT)),o},getValueCellTextWrapper:function(e,t){var i=null,n=this.getCellContentWrapper(e,t);if(n){var o=n.getElementsByTagName("span");i=o?o[0]:null,!i&&t&&(i=e.ownerDocument.createElement("span"),n.appendChild(i),r.addClass(i,a.VALUELISTEDITOR_VALUECELL_TEXT))}return i},_hideValueCellText:function(e){var t=this.getValueCellTextWrapper(this.getValueCell(e));t&&(t.style.visibility="hidden")},_showValueCellText:function(e){var t=this.getValueCellTextWrapper(this.getValueCell(e));t&&(t.style.visibility="visible")},getValueCell:function(e){return t.getDirectChildElems(e,this.CELL_ELEM_TAG)[2]},getParentCell:function(e){return t.getNearestAncestorByTagName(e,this.CELL_ELEM_TAG,!0)},getParentRow:function(e){return t.getNearestAncestorByTagName(e,this.ROW_ELEM_TAG,!0)},_createNewRow:function(e){var t=this.getDocument(),r=this.createRowElem(t);if(r){var i=this.createIndicatorCellElem(t);r.appendChild(i);var n=this.createKeyCellElem(t);r.appendChild(n);var a=this.createValueCellElem(t);r.appendChild(a),e&&this.setRowData(r,e)}return r},insertRowBefore:function(e,t){var r=this._createNewRow(e);return r&&this.getRootElem().insertBefore(r,t||null),r},appendRow:function(e){return this.insertRowBefore(e,null)},removeRow:function(e){return e===this.getActiveRow()&&this.setActiveRow(null),this.getRootElem().removeChild(e),this},removeRowAt:function(e){var t=this.getRowAt(e);return t&&this.removeRow(t),this},clear:function(){this.setActiveRow(null),this.getRootElem()&&e.DomUtils.clearChildContent(this.getRootElem())},updateAll:function(){for(var e=this.getRowElems(),t=0,r=e.length;t<r;++t){var i=e[t],n=this.getRowData(i);this.setRowData(i,n)}return this},valueDisplayModeChanged:function(){this.updateAll()},getKeyCellText:function(e,t){return t.title||t.key},getKeyCellHint:function(e,t){return t.hint||this.getKeyCellText(e,t)},getValueCellText:function(e,t){return this.getValueDisplayMode()===o.JSON?JSON.stringify(t.value):""+t.value},valueCellTextToValue:function(e,t,r){return this.getValueDisplayMode()===o.JSON?JSON.parse(e):e},setValueCellText:function(e,t){var r=this.getRowData(t),i=this.valueCellTextToValue(e,t,r);return r.value=i,this.setRowData(t,r),this},getRowData:function(e){return e[this.ROW_DATA_FIELD]},setRowData:function(e,t){e[this.ROW_DATA_FIELD]=t,this.setRowKeyCellContent(e,this.getKeyCellText(e,t),this.getKeyCellHint(e,t)),this.setRowValueCellContent(e,this.getValueCellText(e,t)),e===this.getActiveRow()&&this._inlineEdit&&this.createValueEditWidget(e)},setRowKeyCellContent:function(e,t,r){var i=this.getKeyCell(e),n=this.getCellContentWrapper(i,!0);n.innerHTML=t,this.getUseKeyHint()&&(n.title=r)},setRowValueCellContent:function(t,r){var i=this.getValueCell(t),n=this.getValueCellTextWrapper(i,!0),a=r;""===a?n.innerHTML="&nbsp;":e.DomUtils.setElementText(n,a)},getRowEditInfo:function(e){return e[this.ROW_EDIT_INFO_FIELD]},setRowEditInfo:function(e,t){e[this.ROW_EDIT_INFO_FIELD]=t,e===this.getActiveRow()&&(this.setActiveRow(null),this.setActiveRow(e))},editRow:function(e){this.setActiveRow(e)},finishEditing:function(){var e=this.getActiveRow();return e&&this._inlineEdit&&(this.setValueCellText(this._inlineEdit.getValue(),e),this.invokeEvent("editFinish",{row:e})),this},cancelEditing:function(){var e=this.getActiveRow();if(e&&this._inlineEdit){var t=this.getRowData(e);this.setRowData(e,t),this.invokeEvent("editCancel",{row:e})}return this},_getTotalHash:function(){for(var e={},t=this.getRowElems(),r=0,i=t.length;r<i;++r){var n=t[r],a=this.getRowData(n);a&&(e[a.key]=a.value)}return e},_setTotalHash:function(t){for(var r=this.getRowElems(),i=r.length,n=e.ObjUtils.getOwnedFieldNames(t),a=n.length,o=0;o<a;++o){var s,l=n[o],d=t[l];o<i?(s=this.getRowAt(o),this.setRowData(s,{key:l,value:d})):s=this.appendRow({key:l,value:d})}if(i>a)for(var o=i-1;o>=a;--o)this.removeRow(r[o]);var u=this.getActiveRow();return u&&(this.setActiveRow(null),this.setActiveRow(u)),this},react_click:function(e){var t=e.getTarget(),r=this.getParentRow(t);r&&this.setActiveRow(r)},react_keydown:function(t){var r=t.getKeyCode();if(!(t.getAltKey()||t.getShiftKey()||t.getCtrlKey())){var i=this.getActiveRow();if(i){var n;r===e.X.Event.KeyCode.UP?n=this.getPrevRow(i):r===e.X.Event.KeyCode.DOWN&&(n=this.getNextRow(i)),n&&this.setActiveRow(n)}}},react_keyup:function(t){var r=t.getKeyCode();r===e.X.Event.KeyCode.ESC?this.cancelEditing():r===e.X.Event.KeyCode.ENTER&&this.finishEditing()},react_blur:function(e){}}),e.Widget.ValueListEditor.ValueDisplayMode={SIMPLE:0,JSON:1};var o=e.Widget.ValueListEditor.ValueDisplayMode;return e}},function(e,t,r){"use strict";var i=r(0).Class,n=(r(0).ClassEx,r(0).ObjectEx,r(0).DataType);e.exports=function(e){var t=(e.DomUtils,e.HtmlElementUtils,e.Widget.HtmlClassNames);return e.Widget.HtmlClassNames=Object.extend(e.Widget.HtmlClassNames,{COLORPICKER:"K-ColorPicker",COLORPICKER_HEADER:"K-ColorPicker-Header",COLORPICKER_SPEC_COLOR_PALETTE:"K-ColorPicker-Spec-Color-Palette",COLORPICKER_HEXBOX:"K-ColorPicker-HexBox",COLORPICKER_PREVIEWER:"K-ColorPicker-Previewer",COLORPICKER_INPUT:"K-ColorPicker-Input",COLORPICKER_BROWSE_BTN:"K-ColorPicker-Browse-Btn",COLORPICKER_PALETTE:"K-ColorPicker-Palette",COLORPICKER_PALETTE_LINE:"K-ColorPicker-Palette-Line",COLORPICKER_PALETTE_CELL:"K-ColorPicker-Palette-Cell",COLORPICKER_PALETTE_CELL_TRANSPARENT:"K-ColorPicker-Palette-Cell-Transparent",COLORPICKER_SPEC_COLOR_UNSET:"K-Color-Unset",COLORPICKER_SPEC_COLOR_DEFAULT:"K-Color-Default",COLORPICKER_SPEC_COLOR_MIXED:"K-Color-Mixed",COLORPICKER_SPEC_COLOR_TRANSPARENT:"K-Color-Transparent",COLORDROPTEXTBOX:"K-ColorDropTextBox",COLORDROPBUTTON:"K-ColorDropButton",COLORPREVIEWER:"K-ColorPreviewer"}),e.Widget.ColorPicker=i.create(e.Widget.BaseWidget,{CLASS_NAME:"Kekule.Widget.ColorPicker",COLOR_VALUE_FIELD:"__$colorValue__",COLOR_TEXT_FIELD:"__$colorText__",COLOR_CLASS_FIELD:"__ $colorClass__",BINDABLE_TAG_NAMES:["div","span"],initialize:function($super,e){$super(e),this.setUseCornerDecoration(!0),this.setValue("#000000"),this.setTouchAction("none")},initProperties:function(){this.defineProp("value",{dataType:n.STRING,setter:function(e){this.setPropStoreFieldValue("value",e),this.getHexBox().innerHTML=e||"&nbsp;",this.getPreviewer().style.backgroundColor=e||"transparent",this.getColorInput()&&(this.getColorInput().value=e)}}),this.defineProp("colorClassName",{dataType:n.STRING}),this.defineProp("specialColors",{dataType:n.ARRAY,setter:function(e){this.setPropStoreFieldValue("specialColors",e),this._recreateSpecialColorPaletteCells(this.getDocument(),this.getSpecialColorPalette())}}),this.defineProp("isDirty",{dataType:n.BOOL,serializable:!1}),this.defineProp("hexBox",{dataType:n.OBJECT,serializable:!1,scope:i.PropertyScope.PRIVATE}),this.defineProp("palette",{dataType:n.OBJECT,serializable:!1,scope:i.PropertyScope.PRIVATE}),this.defineProp("previewer",{dataType:n.OBJECT,serializable:!1,scope:i.PropertyScope.PRIVATE}),this.defineProp("colorInput",{dataType:n.OBJECT,serializable:!1,scope:i.PropertyScope.PRIVATE}),this.defineProp("specialColorPalette",{dataType:n.OBJECT,serializable:!1,scope:i.PropertyScope.PRIVATE}),this.defineProp("isPicking",{dataType:n.BOOL,serializable:!1,scope:i.PropertyScope.PRIVATE})},doGetWidgetClassName:function($super){return $super()+" "+t.COLORPICKER},doCreateRootElement:function(e){return e.createElement("div")},doCreateSubElements:function(e,t){var r=[];return r.push(this.doCreateHeader(e,t)),r.push(this.doCreatePalette(e,t)),r},doCreateHeader:function(e,r){var i=e.createElement("div");i.className=t.COLORPICKER_HEADER,i.appendChild(this.doCreateSpecialColorPalette(e)),i.appendChild(this.doCreateHexBox(e)),i.appendChild(this.doCreatePreviewer(e));var n=this.doCreateColorInput(e);if(n){i.appendChild(n);var a=this.doCreateColorDialogBtn(e);a&&a.appendToElem(i)}return r.appendChild(i),i},doCreateSpecialColorPalette:function(e){var r=e.createElement("div");return r.className=t.COLORPICKER_SPEC_COLOR_PALETTE,this._recreateSpecialColorPaletteCells(e,r),this.setSpecialColorPalette(r),r},_isPredefinedSpecialColor:function(t){var r=e.Widget.ColorPicker.SpecialColors;return[r.UNSET,r.DEFAULT,r.MIXED,r.TRANSPARENT].indexOf(t)>=0},_getPredefinedSpecialColorInfo:function(r){var i=e.Widget.ColorPicker.SpecialColors,n=[i.UNSET,i.DEFAULT,i.MIXED,i.TRANSPARENT],a=[t.COLORPICKER_SPEC_COLOR_UNSET,t.COLORPICKER_SPEC_COLOR_DEFAULT,t.COLORPICKER_SPEC_COLOR_MIXED,t.COLORPICKER_SPEC_COLOR_TRANSPARENT],o=[e.$L("WidgetTexts.S_COLOR_UNSET"),e.$L("WidgetTexts.S_COLOR_DEFAULT"),e.$L("WidgetTexts.S_COLOR_MIXED"),e.$L("WidgetTexts.S_COLOR_TRANSPARENT")],s={value:r},l=n.indexOf(r);return l>=0&&(s.text=o[l],s.className=a[l]),s},_recreateSpecialColorPaletteCells:function(t,r){e.DomUtils.clearChildContent(r);var i=this.getSpecialColors();if(i&&i.length)for(var a=0,o=i.length;a<o;++a){var s,l=i[a],d={};n.isObjectValue(l)?d=l:this._isPredefinedSpecialColor(l)?d=this._getPredefinedSpecialColorInfo(l):d.value=l,s=this.doCreatePaletteCell(t,d.value,d.text,d.className),d.className&&e.HtmlElementUtils.addClass(s,d.className),r.appendChild(s)}},doCreateHexBox:function(e){var r=e.createElement("span");return r.className=t.COLORPICKER_HEXBOX,r.innerHTML="&nbsp",this.setHexBox(r),r},doCreatePreviewer:function(e){var r=e.createElement("span");return r.className=t.COLORPICKER_PREVIEWER,r.innerHTML="&nbsp",this.setPreviewer(r),r},doCreateColorInput:function(r){if(e.BrowserFeature.html5Form.supportType("color")){var i=r.createElement("input");i.setAttribute("type","color"),i.className=t.COLORPICKER_INPUT;var n=this;return e.X.Event.addListener(i,"change",function(e){var t=i.value;n.setValue(t),n.notifyColorSet()}),this.setColorInput(i),i}return null},doCreateColorDialogBtn:function(r){if(e.BrowserFeature.html5Form.supportType("color")){var i=new e.Widget.Button(r);return i.setText(e.$L("WidgetTexts.CAPTION_BROWSE_COLOR")),i.setHint(e.$L("WidgetTexts.HINT_BROWSE_COLOR")),i.setShowText(!1),i.doSetShowGlyph(!0),i.linkStyleResource(e.Widget.StyleResourceNames.ICON_COLOR_PICK),i.addClassName(t.COLORPICKER_BROWSE_BTN),i.addEventListener("execute",this.openColorDialog,this),i}},doCreatePalette:function(e,r){var i=e.createElement("div");i.className=t.COLORPICKER_PALETTE;for(var n=["00","00","11","22","33","44","55","66","77","88","99","AA","BB","CC","DD","EE","FF",null],a=n.length,o=this.doCreatePaletteLine(e),s=0;s<a;s++){var l=n[s]?"#"+n[s]+n[s]+n[s]:"transparent",d=this.doCreatePaletteCell(e,l);o.appendChild(d)}i.appendChild(o),n=["00","33","66","99","CC","FF"];for(var a=n.length,s=0;s<a;s++){for(var o=this.doCreatePaletteLine(e),u=0;u<a>>1;u++)for(var c=0;c<a;c++){var l="#"+n[u]+n[s]+n[c],d=this.doCreatePaletteCell(e,l);o.appendChild(d)}i.appendChild(o)}for(var s=0;s<a;s++){for(var o=this.doCreatePaletteLine(e),u=a>>1;u<a;u++)for(var c=0;c<a;c++){var l="#"+n[u]+n[s]+n[c],d=this.doCreatePaletteCell(e,l);o.appendChild(d)}i.appendChild(o)}return r.appendChild(i),this.setPalette(i),i},doCreatePaletteCell:function(e,r,i,n){var a=e.createElement("span"),o=t.COLORPICKER_PALETTE_CELL;if("transparent"===r)o+=" "+t.COLORPICKER_PALETTE_CELL_TRANSPARENT;else try{a.style.backgroundColor=r}catch(e){}return a[this.COLOR_VALUE_FIELD]=r,a[this.COLOR_TEXT_FIELD]=i||r,a[this.COLOR_CLASS_FIELD]=n,a.className=o,a.title=i||r,a},doCreatePaletteLine:function(e){var r=e.createElement("div");return r.className=t.COLORPICKER_PALETTE_LINE,r},_isPaletteCellElem:function(r){return e.HtmlElementUtils.hasClass(r,t.COLORPICKER_PALETTE_CELL)},openColorDialog:function(){return this.getColorInput()&&this.getColorInput().click(),this},applyColor:function(e){var t=e[this.COLOR_VALUE_FIELD];t&&this.setValue(t);var r=e[this.COLOR_TEXT_FIELD];r&&(this.getHexBox().innerHTML=r);var i=e[this.COLOR_CLASS_FIELD];this.setColorClassName(i)},notifyColorSet:function(){this.setIsDirty(!0),this.invokeEvent("valueSet",{value:this.getValue(),colorClassName:this.getColorClassName()}),this.invokeEvent("valueChange",{value:this.getValue(),colorClassName:this.getColorClassName()})},doReactActiviting:function($super,e){$super(e);var t=e.getTarget();if(this._isPaletteCellElem(t))return this.setIsPicking(!0),this.applyColor(t),!0},doReactDeactiviting:function($super,e){if(this.getIsPicking()){this.setIsPicking(!1);var t=e.getTarget();return this._isPaletteCellElem(t)&&this.applyColor(t),this.notifyColorSet(),!0}$super(e)},reactPointerMoving:function($super,e){if($super(e),this.getIsPicking()){var t=e.getTarget();if(e.getTouches()){var r={x:e.getClientX(),y:e.getClientY()},i=this.getDocument();t=i.elementFromPoint&&i.elementFromPoint(r.x,r.y)||t,e.preventDefault()}return t&&this._isPaletteCellElem(t)&&this.applyColor(t),e.preventDefault(),!0}}}),e.Widget.ColorPicker.SpecialColors={UNSET:"(unset)",DEFAULT:"(default)",MIXED:"(mixed)",TRANSPARENT:"transparent"},e.Widget.ColorDropTextBox=i.create(e.Widget.ButtonTextBox,{CLASS_NAME:"Kekule.Widget.ColorDropTextBox",initialize:function($super,t,r){$super(t),this.setButtonKind(e.Widget.Button.Kinds.DROPDOWN),this.addEventListener("buttonExecute",this.reactDropbuttonExecute,this),this.setShowPreview(!0),r&&this.setValue(r)},initProperties:function(){this.defineProp("showPreview",{dataType:n.BOOL,setter:function(e){this.getPreviewElem().style.display=e?"inherit":""}}),this.defineProp("colorClassName",{dataType:n.STRING,setter:function(t){var r=this.getPreviewElem();if(r){var i=this.getColorClassName();i&&e.HtmlElementUtils.removeClass(r,i),t&&e.HtmlElementUtils.addClass(r,t)}this.setPropStoreFieldValue("colorClassName",t)}}),this.defineProp("colorPicker",{dataType:"Kekule.Widget.ColorPicker",setter:null,serializable:!1,scope:i.PropertyScope.PUBLIC,getter:function(){var t=this.getPropStoreFieldValue("colorPicker");return t||(t=new e.Widget.ColorPicker(this),t.setDisplayed(!1),t.getElement().style.position="absolute",t.setSpecialColors(this.getSpecialColors()),t.addEventListener("valueChange",this.reactColorPickerValueSet,this),t.appendToElem(this.getElement()),this.setPropStoreFieldValue("colorPicker",t)),t}}),this.defineProp("specialColors",{dataType:n.ARRAY,setter:function(e){this.setPropStoreFieldValue("specialColors",e);var t=this.getPropStoreFieldValue("colorPicker");t&&t.setSpecialColors(e)}})},doFinalize:function($super){var e=this.getPropStoreFieldValue("colorPicker");e&&e.finalize(),$super()},doGetWidgetClassName:function($super){return $super()+" "+t.COLORDROPTEXTBOX},doCreateSubElements:function($super,r,i){$super(r,i);var n=new e.Widget.DumbWidget(this);return n.addClassName(t.COLORPREVIEWER),this.setHeadingWidget(n),[n.getElement()]},getPreviewElem:function(){var e=this.getHeadingWidget();if(e)return e.getElement()},showColorPicker:function(){var t=this.getColorPicker();t.isShown()||(t.setValue(this.getValue()),t.show(this,null,e.Widget.ShowHideType.DROPDOWN))},hideColorPicker:function(){var e=this.getPropStoreFieldValue("colorPicker");e&&e.isShown()&&e.hide()},reactDropbuttonExecute:function(e){this.showColorPicker()},reactColorPickerValueSet:function(e){var t=e.value;this.setValue(t),this.setIsDirty(this.getIsDirty()||this.getColorPicker().getIsDirty()),this.setColorClassName(e.colorClassName),this.hideColorPicker(),e.stopPropagation()},doSetValue:function($super,e){$super(e);var t=this.getPreviewElem();t&&(t.style.backgroundColor="transparent",t.style.backgroundColor=e)}}),e.Widget.ColorDropButton=i.create(e.Widget.DropDownButton,{CLASS_NAME:"Kekule.Widget.ColorDropButton",initialize:function($super,t,r){$super(t),this.setButtonKind(e.Widget.Button.Kinds.DROPDOWN),this.setShowPreview(!0),r&&this.setValue(r)},initProperties:function(){this.defineProp("showPreview",{dataType:n.BOOL,setter:function(e){try{this.getPreviewElem().style.display=e?"inherit":""}catch(e){}}}),this.defineProp("value",{dataType:n.STRING,getter:function(){return this.getText()},setter:function(e){this.setText(e),this.updateColorPreview(e);var t=this.getPropStoreFieldValue("colorPicker");t&&t.setValue(e)}}),this.defineProp("colorClassName",{dataType:n.STRING,setter:function(t){var r=this.getPreviewElem();if(r){var i=this.getColorClassName();i&&e.HtmlElementUtils.removeClass(r,i),t&&e.HtmlElementUtils.addClass(r,t)}this.setPropStoreFieldValue("colorClassName",t)}}),this.defineProp("colorPicker",{dataType:"Kekule.Widget.ColorPicker",setter:null,serializable:!1,scope:i.PropertyScope.PUBLIC,getter:function(){var t=this.getPropStoreFieldValue("colorPicker");return t||(t=new e.Widget.ColorPicker(this),t.setDisplayed(!1),t.getElement().style.position="absolute",t.setSpecialColors(this.getSpecialColors()),t.addEventListener("valueChange",this.reactColorPickerValueSet,this),this.setPropStoreFieldValue("colorPicker",t)),t}}),this.defineProp("specialColors",{dataType:n.ARRAY,setter:function(e){this.setPropStoreFieldValue("specialColors",e);var t=this.getPropStoreFieldValue("colorPicker");t&&t.setSpecialColors(e)}}),this.defineProp("isDirty",{dataType:n.BOOL,serializable:!1,getter:function(){return this.getColorPicker().getIsDirty()},setter:function(e){this.getColorPicker().setIsDirty(e)}})},doFinalize:function($super){var e=this.getPropStoreFieldValue("colorPicker");e&&e.finalize(),$super()},doGetWidgetClassName:function($super){return $super()+" "+t.COLORDROPBUTTON},doGetDropDownWidget:function(){return this.getColorPicker()},getPreviewElem:function(){return this._elemLeadingGlyphPart},showColorPicker:function(){var t=this.getColorPicker();t.isShown()||(t.setValue(this.getValue()),t.show(this,null,e.Widget.ShowHideType.DROPDOWN))},hideColorPicker:function(){var e=this.getPropStoreFieldValue("colorPicker");e&&e.isShown()&&e.hide()},reactColorPickerValueSet:function(e){var t=e.value,r=e.colorClassName;this.setValue(t),this.setColorClassName(r),this.hideColorPicker(),this.invokeEvent("valueChange",{value:t}),e.stopPropagation()},updateColorPreview:function(e){var t=this.getPreviewElem();t&&(t.style.backgroundColor="transparent",t.style.backgroundColor=e)}}),e}},function(e,t,r){"use strict";var i=r(0).Class,n=(r(0).ClassEx,r(0).ObjectEx,r(0).DataType);e.exports=function(e){var t=(e.DomUtils,e.HtmlElementUtils,e.Widget.HtmlClassNames);return e.Widget.HtmlClassNames=Object.extend(e.Widget.HtmlClassNames,{TEXTEDITOR:"K-TextEditor",TEXTEDITOR_TOOLBAR:"K-TextEditor-Toolbar",TEXTEDITOR_TEXTAREA:"K-TextEditor-TextArea",TEXTEDITOR_FONTBOX:"K-TextEditor-FontBox",TEXTEDITOR_BTN_FONTSIZEINC:"K-TextEditor-Btn-FontSizeInc",TEXTEDITOR_BTN_FONTSIZEDEC:"K-TextEditor-Btn-FontSizeDec",TEXTEDITOR_BTN_TEXTWRAP:"K-TextEditor-Btn-TextWrap"}),e.Widget.TextEditor=i.create(e.Widget.FormWidget,{CLASS_NAME:"Kekule.Widget.TextEditor",BINDABLE_TAG_NAMES:["div","span"],DEF_TOOLBAR_COMPONENTS:["fontFamily","fontSizeInc","fontSizeDec","textWrap"],DEF_AUTOWRAP_THRESHOLD:80,initialize:function($super,e){this._toolCompWidgets=[],this.setPropStoreFieldValue("showToolbar",!0),$super(e)},initProperties:function(){this.defineProp("text",{dataType:n.STRING,serializable:!1,getter:function(){var e=this.getTextArea();return e?e.getText():null},setter:function(e){var t=this.getTextArea();t&&(t.setText(e),this._checkAutoWrap())}}),this.defineProp("readOnly",{dataType:n.BOOL,serializable:!1,getter:function(){return this.getTextArea().getReadOnly()},setter:function(e){return this.getTextArea().setReadOnly(e)}}),this.defineProp("wrap",{dataType:n.STRING,serializable:!1,getter:function(){return this.getTextArea().getWrap()},setter:function(e){var t=this.getTextArea().setWrap(e);return this.updateToolButtonStates(),t}}),this.defineProp("autoWrapThreshold",{dataType:n.INT,setter:function(e){var t=!0===e?this.DEF_AUTOWRAP_THRESHOLD:e;this.setPropStoreFieldValue("autoWrapThreshold",t),this._checkAutoWrap()}}),this.defineProp("textArea",{dataType:"Kekule.Widget.TextArea",serializable:!1,setter:null,scope:i.PropertyScope.PRIVATE,getter:function(){var e=this.getPropStoreFieldValue("textArea");return e||(e=this.createTextArea(),this.setPropStoreFieldValue("textArea",e)),e}}),this.defineProp("toolbar",{dataType:"Kekule.Widget.Toolbar",serializable:!1,setter:null,scope:i.PropertyScope.PRIVATE,getter:function(){var e=this.getPropStoreFieldValue("toolbar");return e||this.getShowToolbar()&&(e=this.createToolbar(),this.setPropStoreFieldValue("styleToolbar",e)),e}}),this.defineProp("showToolbar",{dataType:n.BOOL,setter:function(e){this.setPropStoreFieldValue("showToolbar",e),this.getToolbar().setDisplayed(e)}}),this.defineProp("toolbarPos",{dataType:n.INT,setter:function(e){this.setPropStoreFieldValue("toolbarPos",e),this.updateChildWidgetPos()}}),this.defineProp("toolbarComponents",{dataType:n.ARRAY,serializable:!1,getter:function(){var e=this.getPropStoreFieldValue("toolbarComponents");return e||(e=null,this.setPropStoreFieldValue("toolbarComponents",e)),e},setter:function(e){this.setPropStoreFieldValue("toolbarComponents",e),this.recreateToolbarComponents(e)}}),this.defineProp("candidateFontFamilies",{dataType:n.ARRAY}),this.defineProp("fontSizeLevel",{dataType:n.FLOAT,setter:function(e){this.setPropStoreFieldValue("fontSizeLevel",e),this.setTextStyle({fontSize:e+"em"})}})},finalize:function($super){this._finalizeSubElements(),$super()},_finalizeSubElements:function(){var e=this.getTextArea();e&&e.finalize()},getCoreElement:function($super){var e=this.getTextArea();return e?e.getElement():$super()},getChildrenHolderElement:function($super){return this.getElement()},doSetValue:function($super,e){$super(e),this._checkAutoWrap()},doGetWidgetClassName:function($super){return $super()+" "+t.TEXTEDITOR},doCreateRootElement:function(e){return e.createElement("span")},doCreateSubElements:function(e,t){var r=this.createToolbar();r&&r.appendToElem(t);var i=this.createTextArea();return i.appendToElem(t),this.updateChildWidgetPos(),[r.getElement(),i.getElement()]},doWidgetShowStateChanged:function($super,e){$super(e),e&&(this.updateChildWidgetPos(),this.updateToolButtonStates())},doFileDragDrop:function($super,t){if(t){if(e.BrowserFeature.fileapi){var r=this,i=new FileReader;i.onload=function(e){var t=i.result;r.setText(t)},i.readAsText(t[0])}return!0}return $super()},createToolbar:function(){if(this.getShowToolbar()){var r=new e.Widget.Toolbar(this);return this.setPropStoreFieldValue("toolbar",r),r.addClassName(t.TEXTEDITOR_TOOLBAR),this.recreateToolbarComponents(),r}return null},recreateToolbarComponents:function(e){e||(e=this.getToolbarComponents());var t=e||this.DEF_TOOLBAR_COMPONENTS,r=this.getToolbar();if(r){this._toolCompWidgets.length=0,r.clearWidgets(),r.setShowText(!1),r.setShowGlyph(!0);for(var i,n=0,a=t.length;n<a;++n){var o=t[n];i="fontFamily"===o?this.createFontFamilyComboBox(r):this.createToolButton(r,o),this._toolCompWidgets[o]=i}this.updateToolButtonStates()}},createFontFamilyComboBox:function(r){for(var i=new e.Widget.ComboBox(r),n=e.Widget.FontEnumerator.getAvailableFontFamilies(this.getCandidateFontFamilies()),a=[],o=0,s=n.length;o<s;++o)a.push({text:n[o],value:n[o]});return i.setHint(e.$L("WidgetTexts.HINT_CHOOSE_FONT_FAMILY")),i.addClassName(t.TEXTEDITOR_FONTBOX),i.setItems(a),i.appendToWidget(r),i.addEventListener("valueChange",function(e){this.setTextStyle({fontFamily:i.getValue()})},this),i},createToolButton:function(r,i){var n,a,o,s="textWrap"===i?e.Widget.CheckButton:e.Widget.Button,l=new s(r);return l.appendToWidget(r),"textWrap"===i?(n=e.$L("WidgetTexts.CAPTION_TOGGLE_TEXTWRAP"),a=e.$L("WidgetTexts.HINT_TOGGLE_TEXTWRAP"),o=t.TEXTEDITOR_BTN_TEXTWRAP,l.setChecked("off"!==this.getWrap()),l.addEventListener("checkChange",function(e){var t=l.getChecked();this.setWrap(t?"soft":"off")},this)):"fontSizeInc"===i?(n=e.$L("WidgetTexts.CAPTION_INC_TEXT_SIZE"),a=e.$L("WidgetTexts.HINT_INC_TEXT_SIZE"),o=t.TEXTEDITOR_BTN_FONTSIZEINC,l.addEventListener("execute",this.increaseTextSize,this)):"fontSizeDec"===i&&(n=e.$L("WidgetTexts.CAPTION_DEC_TEXT_SIZE"),a=e.$L("WidgetTexts.HINT_DEC_TEXT_SIZE"),o=t.TEXTEDITOR_BTN_FONTSIZEDEC,l.addEventListener("execute",this.decreaseTextSize,this)),l.setText(n),l.setHint(a),l.addClassName(o),l},createToolCheckButton:function(t,r){var i=new e.Widget.CheckButton(t);return i.appendToWidget(t),i},getToolbarComponentWidget:function(e){return this._toolCompWidgets[e]},createTextArea:function(){var r=new e.Widget.TextArea(this);return this.setPropStoreFieldValue("textArea",r),r.addClassName(t.TEXTEDITOR_TEXTAREA),r.addEventListener("valueChange",this._checkAutoWrap,this),r.addEventListener("valueInput",this._checkAutoWrap,this),r},updateChildWidgetPos:function(){var t=this.getToolbarPos(),r=this.getToolbar().getElement(),i=this.getTextArea().getElement(),n=r.parentNode;t===e.Widget.Position.BOTTOM?n.insertBefore(i,r):n.insertBefore(r,i)},updateToolButtonStates:function(){var e=this._toolCompWidgets.textWrap;e&&e.setChecked("off"!==this.getWrap())},setTextStyle:function(t){var r=this.getTextArea();if(r)for(var i=e.ObjUtils.getOwnedFieldNames(t),n=0,a=i.length;n<a;++n){var o=i[n];r.setStyleProperty(o,t[o])}return this},increaseTextSize:function(){var t=this.getFontSizeLevel()||1,r=e.ZoomUtils.getNextZoomInRatio(t);this.setFontSizeLevel(r)},decreaseTextSize:function(){var t=this.getFontSizeLevel()||1,r=e.ZoomUtils.getNextZoomOutRatio(t);this.setFontSizeLevel(r)},_checkAutoWrap:function(){var e=this.getAutoWrapThreshold();if(e){var t=this.getToolbarComponentWidget("textWrap"),r=((this.getWrap()||"").toLowerCase(),this.getValue()||""),i=r.split("\n").length,n=r.length/i;t.setChecked(n>e)}}}),e}},function(e,t,r){"use strict";var i=r(0).Class,n=(r(0).ClassEx,r(0).ObjectEx,r(0).DataType);e.exports=function(e){var t=e.ArrayUtils,r=e.StyleUtils,a=e.DomUtils,o=e.HtmlElementUtils;e.Widget.HtmlClassNames=Object.extend(e.Widget.HtmlClassNames,{WIDGET_GRID:"K-Widget-Grid",WIDGET_GRID_CELL:"K-Widget-Grid-Cell",WIDGET_GRID_ADD_CELL:"K-Widget-Grid-Add-Cell",WIDGET_GRID_INTERACTION_AREA:"K-Widget-Grid-Interaction-Area",WIDGET_GRID_WIDGET_PARENT:"K-Widget-Grid-Widget-Parent",WIDGET_GRID_BUTTON_REMOVE:"K-Widget-Grid-Button-Remove",WIDGET_GRID_ENABLE_CELL_INTERACTION:"K-Widget-Grid-Enable-Cell-Interaction"});var s=e.Widget.HtmlClassNames;return e.Widget.WidgetGrid=i.create(e.Widget.Container,{CLASS_NAME:"Kekule.Widget.WidgetGrid",CELL_FIELD:"__$cell__",WIDGET_FIELD:"__$cellWidget__",INTERACTION_AREA_FIELD:"__$interactionArea__",EXCEED_TOPRIGHT_FIELD:"__$exceedTopRight__",BTN_REMOVE_CELL_FIELD:"__$removeCell__",initialize:function($super,e){this._floatClearer=null,this.reactCellMouseEnterBind=this.reactCellMouseEnter.bind(this),this.reactCellMouseLeaveBind=this.reactCellMouseLeave.bind(this),this.reactCellClickBind=this.reactCellClick.bind(this),$super(e),this.addEventListener("change",this.reactChildWidgetChange,this)},initProperties:function(){this.defineProp("childWidgetClass",{dataType:n.CLASS,serializable:!1}),this.defineProp("cellWidth",{dataType:n.STRING}),this.defineProp("cellHeight",{dataType:n.STRING}),this.defineProp("widgetPos",{dataType:n.INT,enumSource:e.Widget.Position}),this.defineProp("autoShrinkWidgets",{dataType:n.BOOL}),this.defineProp("keepWidgetAspectRatio",{dataType:n.BOOL}),this.defineProp("restoreWidgetSizeOnHotTrack",{dataType:n.BOOL}),this.defineProp("enableAdd",{dataType:n.BOOL,setter:function(e){if(this.setPropStoreFieldValue("enableAdd",e),e)this.setAddingCell(this.createAddCell());else{var t=this.getAddingCell();t&&this.getContainerElement().removeChild(t)}}}),this.defineProp("enableRemove",{dataType:n.BOOL,getter:function(){return this.hasClassName(s.WIDGET_GRID_ENABLE_CELL_INTERACTION)},setter:function(e){e?this.addClassName(s.WIDGET_GRID_ENABLE_CELL_INTERACTION):this.removeClassName(s.WIDGET_GRID_ENABLE_CELL_INTERACTION)}}),this.defineProp("hotCell",{dataType:n.OBJECT,serializable:!1,setter:function(e){this.getHotCell()!==e&&(this.hotCellChanged(this.getHotCell(),e),this.setPropStoreFieldValue("hotCell",e))}}),this.defineProp("addingCell",{dataType:n.OBJECT,serializable:!1})},initPropValues:function(){this.setPropStoreFieldValue("autoShrinkWidgets",!0),this.setPropStoreFieldValue("keepWidgetAspectRatio",!0),this.setPropStoreFieldValue("restoreWidgetSizeOnHotTrack",!0),this.setEnableRemove(!0),this.setUseCornerDecoration(!0)},doGetWidgetClassName:function($super){return $super()+" "+s.WIDGET_GRID},doCreateRootElement:function(e){return e.createElement("div")},doSetUseCornerDecoration:function($super,e){$super(e),this.updateAllCells()},doObjectChange:function($super,e){$super(e),t.intersect(e,["autoShrinkWidgets","keepWidgetAspectRatio","cellWidth","cellHeight","widgetPos"]).length>0&&this.updateAllCells()},doWidgetShowStateChanged:function($super,e){return e&&this.updateAllCells(),$super(e)},each:function(t){for(var r=e.ArrayUtils.clone(this.getChildWidgets()),i=0,n=r.length;i<n;++i)t(r[i])},addWidget:function(e){e.setParent(this)},removeWidget:function(e,t){this.hasChild(e)&&(e.setParent(null),t&&e.finalize())},createWidget:function(){var e=this.doCreateNewChildWidget(this.getDocument());if(e)return e.setParent(this),e},doCreateNewChildWidget:function(e){return null},getFloatClearer:function(){return this._floatClearer||(this._floatClearer=this.getDocument().createElement("div"),this._floatClearer.style.clear="both",this.getContainerElement().appendChild(this._floatClearer)),this._floatClearer},createCell:function(t){var r=!t,i=this.getDocument(),n=i.createElement("div");n.className=s.WIDGET_GRID_CELL+" "+s.DYN_CREATED+(r?" "+s.WIDGET_GRID_ADD_CELL:""),n[this.WIDGET_FIELD]=t,e.X.Event.addListener(n,"mouseenter",this.reactCellMouseEnterBind),e.X.Event.addListener(n,"mouseleave",this.reactCellMouseLeaveBind),e.X.Event.addListener(n,"click",this.reactCellClickBind);var a=i.createElement("div");if(a.className=s.WIDGET_GRID_WIDGET_PARENT+" "+s.DYN_CREATED,a[this.WIDGET_FIELD]=t,r&&(a.innerHTML=e.$L("WidgetTexts.CAPTION_ADD_CELL"),a.title=e.$L("WidgetTexts.HINT_ADD_CELL")),n.appendChild(a),t&&(t.appendToElem(a),t[this.CELL_FIELD]=n),!r){var o=i.createElement("div");o.className=s.WIDGET_GRID_INTERACTION_AREA+" "+s.DYN_CREATED,n.appendChild(o),a[this.INTERACTION_AREA_FIELD]=o,n[this.INTERACTION_AREA_FIELD]=o,this.createCellInteractionWidgets(o,n)}return this.getAddingCell()&&!r?this.getContainerElement().insertBefore(n,this.getAddingCell()):this.getContainerElement().insertBefore(n,this.getFloatClearer()),this.updateCell(n),n},createAddCell:function(){return this.createCell(null)},createCellInteractionWidgets:function(t,r){var i=new e.Widget.Button(t.ownerDocument);i.setText(e.$L("WidgetTexts.CAPTION_REMOVE_CELL")),i.setHint(e.$L("WidgetTexts.HINT_REMOVE_CELL")),i.addClassName(s.WIDGET_GRID_BUTTON_REMOVE),i[this.BTN_REMOVE_CELL_FIELD]=!0;var n=this.getContainingWidget(r);i[this.WIDGET_FIELD]=n,i.setShowText(!1),i.setShowGlyph(!0),i.addEventListener("execute",function(e){var t=e.widget,r=t[this.WIDGET_FIELD];this.removeWidget(r,!0)},this),i.appendToElem(t)},getWidgetCell:function(e){return e[this.CELL_FIELD]},getWidgetParentElem:function(e){var t=e.getElement();return t&&t.parentNode},getWidgetParentElemOfCell:function(e){return e.children[0]},getInteractionAreaElemOfCell:function(e){return e[this.INTERACTION_AREA_FIELD]},getContainingWidget:function(e){return e[this.WIDGET_FIELD]},childWidgetAdded:function($super,e){$super(e),this.createCell(e)},childWidgetRemoved:function($super,e){$super(e);var t=this.getWidgetCell(e);this.getContainerElement().removeChild(t)},childWidgetMoved:function($super,e,t){$super(e,t);var r=this.getWidgetCell(e),i=this.getChildWidgets()[t+1],n=i?this.getWidgetCell(i):null;n?this.getContainerElement().insertBefore(r,n):this.getContainerElement().appendChild(r)},childrenModified:function($super){this.getContainerElement().appendChild(this.getFloatClearer())},getAllCells:function(){for(var e=this.getChildWidgets(),t=[],r=0,i=e.length;r<i;++r)t.push(this.getWidgetCell(e[r]));return this.getAddingCell()&&t.push(this.getAddingCell()),t},updateCell:function(e,t){var i=e.style,n=this.getCellWidth(),a=this.getCellHeight();n?i.width=n:r.removeStyleProperty(i,"width"),a?i.height=a:r.removeStyleProperty(i,"height"),this.getUseCornerDecoration()?o.addClass(e,s.CORNER_ALL):o.removeClass(e,s.CORNER_ALL),this.adjustCellWidgetPos(e,t),this.adjustInteractionArea(e,t)},adjustCellWidgetPos:function(t,i){for(var n=this.getWidgetParentElemOfCell(t),a=o.getElemOffsetDimension(n),s=o.getElemClientDimension(t),l=["top","right","bottom","left"],d={},u=0,c=l.length;u<c;++u){var h=r.getComputedStyle(t,"padding-"+l[u]);d[l[u]]=r.analysisUnitsValue(h).value||0}var m=Object.extend({},s);m.width-=d.left+d.right,m.height-=d.top+d.bottom;var g=this.getWidgetPos(),f=e.Widget.Position,p=g&f.LEFT?d.left:g&f.RIGHT?s.width-a.width-d.right:(m.width-a.width)/2+d.left,C=g&f.TOP?d.top:g&f.BOTTOM?s.height-a.height-d.bottom:(m.height-a.height)/2+d.top;n.style.left=p+"px",n.style.top=C+"px";var b=this.getInteractionAreaElemOfCell(t);if(b){var E=o.getElemClientDimension(b),N=p+a.width,T=N+E.width>=s.width&&C<=E.height;t[this.EXCEED_TOPRIGHT_FIELD]=T}if(this.getAutoShrinkWidgets()&&!i||!this.getRestoreWidgetSizeOnHotTrack()){var O=a.width>m.width?m.width/a.width:null,_=a.height>m.height?m.height/a.height:1;if(this.getKeepWidgetAspectRatio()){var S=O&&_?Math.min(O,_):O||_;O=S,_=S}n.style.transform="scale("+O+", "+_+")";var v=g&f.LEFT?"0":g&f.RIGHT?"100%":"50%",y=g&f.TOP?"0":g&f.BOTTOM?"100%":"50%";n.style.transformOrigin=v+" "+y}else n.style.transform="none"},adjustInteractionArea:function(e,t){var r=this.getInteractionAreaElemOfCell(e);if(r)if(t){if(e[this.EXCEED_TOPRIGHT_FIELD]){var i=this.getWidgetParentElemOfCell(e);i.appendChild(r)}}else e.appendChild(r)},updateAllCells:function(){for(var e=this.getAllCells(),t=0,r=e.length;t<r;++t)this.updateCell(e[t],e[t]===this.getHotCell())},restoreCellShrink:function(e){var t=this.getWidgetParentElemOfCell(e);t&&(t.style.transform="none")},hotCellChanged:function(e,t){e&&(this.updateCell(e,!1),o.removeClass(e,s.STATE_HOVER)),t&&(o.addClass(t,s.STATE_HOVER),this.getRestoreWidgetSizeOnHotTrack()&&(this.restoreCellShrink(t),this.adjustInteractionArea(t,!0)))},reactCellMouseEnter:function(e){var t=e.getTarget();this.setHotCell(t)},reactCellMouseLeave:function(e){var t=e.getTarget();this.getHotCell()===t&&this.setHotCell(null)},reactCellClick:function(e){var t=e.getTarget();(a.isDescendantOf(t,this.getAddingCell())||t===this.getAddingCell())&&this.createWidget()},reactChildWidgetChange:function(e){var t=e.widget;t&&this.hasChild(t)&&this.updateCell(this.getWidgetCell(t),this.getHotCell()===this.getWidgetCell(t))}}),e}},function(e,t,r){"use strict";var i=r(0).Class,n=r(0).ClassEx,a=r(0).ObjectEx,o=r(0).DataType;e.exports=function(e){var t=e.DomUtils,r=e.HtmlElementUtils,s=e.StyleUtils,l=e.Widget.HtmlClassNames;return e.Widget.HtmlClassNames=Object.extend(e.Widget.HtmlClassNames,{PROPLISTEDITOR:"K-PropListEditor",PROPLISTEDITOR_PROPEXPANDMARKER:"K-PropListEditor-PropExpandMarker",PROPLISTEDITOR_PROPEXPANDED:"K-PropListEditor-PropExpanded",PROPLISTEDITOR_PROPCOLLAPSED:"K-PropListEditor-PropCollapsed",PROPLISTEDITOR_INDENTDECORATOR:"K-PropListEditor-IndentDecorator",PROPLISTEDITOR_READONLY:"K-PropListEditor-ReadOnly",OBJINSPECTOR:"K-ObjInspector",OBJINSPECTOR_FLEX_LAYOUT:"K-ObjInspector-Flex-Layout",OBJINSPECTOR_SUBPART:"K-ObjInspector-SubPart",OBJINSPECTOR_OBJSINFOPANEL:"K-ObjInspector-ObjsInfoPanel",OBJINSPECTOR_PROPINFOPANEL:"K-ObjInspector-PropInfoPanel",OBJINSPECTOR_PROPINFO_TITLE:"K-ObjInspector-PropInfoPanel-Title",OBJINSPECTOR_PROPINFO_DESCRIPTION:"K-ObjInspector-PropInfoPanel-Description",OBJINSPECTOR_PROPLISTEDITOR_CONTAINER:"K-ObjInspector-PropListEditorContainer"}),e.Widget.ObjPropListEditor=i.create(e.Widget.ValueListEditor,{CLASS_NAME:"Kekule.Widget.ObjPropListEditor",PARENT_ROW_FIELD:"__$parentRow__",SUB_ROWS_FIELD:"__$subRows__",initialize:function($super,t){$super(t),this.setValueDisplayMode(e.Widget.ValueListEditor.ValueDisplayMode.SIMPLE),this.setPropStoreFieldValue("displayedPropScopes",[i.PropertyScope.PUBLISHED]),this.setEnableLiveUpdate(!0),this.setSubPropNamePadding("1em"),this.setUseKeyHint(!0)},initProperties:function(){this.defineProp("objects",{dataType:o.ARRAY,serializable:!1,scope:i.PropertyScope.PUBLIC,setter:function(t){var r=e.ArrayUtils.toArray(t),i=this.getObjects();this.setPropStoreFieldValue("objects",r),this.inspectedObjectsChanged(r,i)}}),this.defineProp("displayedPropScopes",{dataType:o.ARRAY,setter:function(e){this.setPropStoreFieldValue("displayedPropScopes",e),this.updateAll()}}),this.defineProp("enableLiveUpdate",{dataType:o.BOOL}),this.defineProp("subPropNamePadding",{dataType:o.STRING}),this.defineProp("activePropEditor",{dataType:o.OBJECT,serializable:!1,setter:null,scope:i.PropertyScope.PUBLIC,getter:function(){var e=this.getActiveRow();return e?this.getRowPropEditor(e):null}}),this.defineProp("keyField",{dataType:o.STRING}),this.defineProp("sortField",{dataType:o.STRING}),this.defineProp("enableOperHistory",{dataType:o.BOOL,serializable:!1}),this.defineProp("operHistory",{dataType:"Kekule.OperationHistory",serializable:!1,scope:i.PropertyScope.PUBLIC})},doFinalize:function($super){$super()},initPropValues:function($super){$super(),this.setKeyField("title"),this.setSortField("key")},doGetWidgetClassName:function($super){return $super()+" "+l.PROPLISTEDITOR},inspectedObjectsChanged:function(t,r){var i=e.ArrayUtils.toArray(t);r&&this._uninstallObjectsEventHandlers(r),t&&this._installObjectsEventHandlers(i),this.updateAll(i)},_installObjectsEventHandlers:function(e){for(var t=0,r=e.length;t<r;++t){var i=e[t];i.addEventListener&&i.addEventListener("change",this.reactObjectsChange,this)}},_uninstallObjectsEventHandlers:function(e){for(var t=0,r=e.length;t<r;++t){var i=e[t];i.removeEventListener&&i.removeEventListener("change",this.reactObjectsChange,this)}},reactObjectsChange:function(e){if(this.getEnableLiveUpdate()){var t=e.changedPropNames;this.updateValues(t)}},getKeyCellExpandMarker:function(e,i){var n=null,a=this.getCellContentWrapper(e,i);if(a){for(var o=t.getDirectChildElems(a)||[],s=0,d=o.length;s<d;++s){var u=o[s];if(r.hasClass(u,l.PROPLISTEDITOR_PROPEXPANDMARKER)){n=u;break}}if(!n&&i){n=this.getDocument().createElement("span"),r.addClass(n,l.PROPLISTEDITOR_PROPEXPANDMARKER);var c=t.getChildNodesOfTypes(a,[Node.ELEMENT_NODE,Node.TEXT_NODE])[0];a.insertBefore(n,c)}}return n},getKeyCellIndentDecorator:function(e,i){var n=null,a=this.getCellContentWrapper(e,i);if(a){for(var o=t.getDirectChildElems(a)||[],s=0,d=o.length;s<d;++s){var u=o[s];if(r.hasClass(u,l.PROPLISTEDITOR_INDENTDECORATOR)){n=u;break}}if(!n&&i){n=this.getDocument().createElement("div"),r.addClass(n,l.PROPLISTEDITOR_INDENTDECORATOR);var c=t.getChildNodesOfTypes(a,[Node.ELEMENT_NODE,Node.TEXT_NODE])[0];a.insertBefore(n,c)}}return n},setRowKeyCellContent:function($super,t,r,i){var n=$super(t,r,i),a=this.getKeyCell(t),o=(this.getKeyCellExpandMarker(a,!0),this.getRowSubLevel(t)),s=this.getSubPropNamePadding();if(s){e.StyleUtils.multiplyUnitsValue(s,o);s=e.StyleUtils.multiplyUnitsValue(s,o);var l=this.getKeyCell(t);this.getCellContentWrapper(l,!0).style.paddingLeft=s}return n},updateAll:function(e){if(e||(e=this.getObjects()),!e||!e.length)return void this.clear();this.setActiveRow(null),this.collapseAllRows();var t=(e[0],this.getDisplayPropEditors(e));this.sortPropEditors(t);for(var r=(e.length,this.getRows()),i=r.length,n=t.length,a=0,o=0,s=this.getValueDisplayMode(),a=0;a<n;++a){var l=t[a];if(l.setValueTextMode(s),this.isPropEditorVisible(l)){var d=o<i?r[o]:this.appendRow();this.setRowPropEditor(d,l),++o}}if(i>o)for(var a=i-1;a>=o;--a)this.removeRow(r[a]);return this},updateValues:function(e){for(var t=e&&e.length,r=this.getRows(),i=0,n=r.length;i<n;++i){var a=r[i];if(t){var o=this.getRowPropEditor(a);if(!o||e.indexOf(o.getPropertyName())<0)continue}this.updateRowPropValue(a)}},updateRowPropValue:function(e){var t=this.getRowPropEditor(e),r=t.getValueText(),i=this.getRowData(e);i.value=r,this.setRowData(e,i),this.updateRowExpandState(e);var n=this.getSubPropRows(e);if(n)for(var a=0,o=n.length;a<o;++a)this.updateRowPropValue(n[a])},setRowPropEditor:function(e,t){var i,n=this.getKeyField()||"title";if(n)if("name"===n)i=t.getPropertyName();else if("title"===n)i=t.getTitle();else{var a=t.getPropertyInfo();i=a[n]}i||(i=t.getTitle()||t.getPropertyName());var o={key:t.getPropertyName(),value:t.getValueText(),title:i,hint:t.getHint(),propEditor:t,expanded:!1};t.isReadOnly()?r.addClass(e,l.PROPLISTEDITOR_READONLY):r.removeClass(e,l.PROPLISTEDITOR_READONLY),this.setRowData(e,o),this.updateRowExpandState(e)},getRowCascadeKey:function(e){if(e&&this.getRowData(e)){var t=this.getRowData(e).key,r=this.getParentPropRow(e);return r&&(t=this.getRowCascadeKey(r)+"."+t),t}return null},getActiveRowCascadeKey:function(){var e=this.getActiveRow();return e&&this.getRowCascadeKey(e)},getRowPropEditor:function(e){var t=this.getRowData(e);return t?t.propEditor:null},getPropEditor:function(t,r){var i=e.PropertyEditor.findEditorClass(t,r);return i?new i:null},getPropEditorForType:function(t,r){var i=e.PropertyEditor.findEditorClassForType(t,r);return i?new i:null},isPropEditorVisible:function(t){var r=!0;if(r=!(t.getObjects().length>1)||t.getAttributes()&e.PropertyEditor.EditorAttributes.MULTIOBJS){var n=t.getPropertyInfo();if(n){var a=n.scope||i.PropertyScope.DEFAULT;if(a){var o=this.getDisplayedPropScopes();o&&(r=o.indexOf(a)>=0)}}}return r},isRowExpandable:function(e){var t=this.getRowPropEditor(e);return!!t&&t.hasSubPropertyEditors()},isRowExpanded:function(e){return!!this.getRowData(e).expanded},updateRowExpandState:function(e){var t=this.isRowExpandable(e);t||this.removeSubPropertyRows(e),r.removeClass(e,l.PROPLISTEDITOR_PROPCOLLAPSED),r.removeClass(e,l.PROPLISTEDITOR_PROPEXPANDED),t&&(this.isRowExpanded(e)?r.addClass(e,l.PROPLISTEDITOR_PROPEXPANDED):r.addClass(e,l.PROPLISTEDITOR_PROPCOLLAPSED))},expandRow:function(e){return this._doExpandRow(e),this},_doExpandRow:function(e){if(this.isRowExpandable(e)&&!this.isRowExpanded(e)){r.removeClass(e,l.PROPLISTEDITOR_PROPCOLLAPSED),r.addClass(e,l.PROPLISTEDITOR_PROPEXPANDED);this.getRowData(e).expanded=!0;var t=this.getRowPropEditor(e),i=t.getSubPropertyEditors(this.getDisplayedPropScopes());return e[this.SUB_ROWS_FIELD]=this.addSubPropertyRows(e,i),e[this.SUB_ROWS_FIELD]}return null},collapseRow:function(e){if(this.isRowExpandable(e)&&this.isRowExpanded(e)){r.removeClass(e,l.PROPLISTEDITOR_PROPEXPANDED),r.addClass(e,l.PROPLISTEDITOR_PROPCOLLAPSED);this.getRowData(e).expanded=!1,this.removeSubPropertyRows(e)}return this},toggleRowExpandState:function(e){return this.isRowExpanded(e)?this.collapseRow(e):this.expandRow(e),this},collapseAllRows:function(){for(var e=this.getRows(),t=0,r=e.length;t<r;++t)this.collapseRow(e[t]);return this},expandAllRows:function(e){var t=this,r=this.getRows();return function e(r,i){for(var n=0,a=r.length;n<a;++n){var o=t._doExpandRow(r[n]);o&&i&&e(o,i)}}(r,e),this},addSubPropertyRows:function(e,t){var r=this.getNextRow(e),i=[];if(t&&t.length){this.sortPropEditors(t);for(var n=0,a=t.length;n<a;++n){var o=t[n];this.isPropEditorVisible(o)&&i.push(this.addSubPropRow(e,o,r))}}return i},addSubPropRow:function(e,t,r){var i=this.insertRowBefore(null,r);return i[this.PARENT_ROW_FIELD]=e,this.setRowPropEditor(i,t),i},removeSubPropertyRows:function(e){for(var t=this.getSubPropRows(e),r=t.length-1;r>=0;--r)this.removeSubPropertyRows(t[r]),this.removeRow(t[r]);e[this.SUB_ROWS_FIELD]=null},getSubPropRows:function(e){return e[this.SUB_ROWS_FIELD]||[]},getParentPropRow:function(e){return e[this.PARENT_ROW_FIELD]},getRowSubLevel:function(e){for(var t=0,r=this.getParentPropRow(e);r;)++t,r=this.getParentPropRow(r);return t},getValueCellText:function($super,e,t){return t.value},finishEditing:function(){var t=this.getActiveRow(),r=this.getRowPropEditor(t);if(r){var i=this.getOperHistory(),n=this.getEnableOperHistory()&&i,a=r.getValue();if(r.saveEditValue()){if(n){var o=new e.Widget.PropEditorModifyOperation(r,r.getValue(),a);i.push(o)}this.updateValues(),this.invokeEvent("propertyChange",{propertyEditor:r,propertyInfo:r.getPropertyInfo(),oldValue:a,newValue:r.getValue()}),this.invokeEvent("editFinish",{row:t})}}return this},doCreateValueEditWidget:function($super,e){var t=this.getRowPropEditor(e),r=t.createEditWidget(this);return r?t.isReadOnly()&&r.setReadOnly&&r.setReadOnly(!0):r=this.doCreateDefaultValueEditWidget(e),r},doCreateDefaultValueEditWidget:function(t){var r=new e.Widget.TextBox(this);r.setReadOnly(!0);var i=this.getRowData(t).value;return r.setValue(i),r},isOperHistoryAvailable:function(){return this.getOperHistory()&&this.getEnableOperHistory()},undo:function(){return this.isOperHistoryAvailable()&&this.getOperHistory().undo(),this},redo:function(){return this.isOperHistoryAvailable()&&this.getOperHistory().redo(),this},getCommonSuperClass:function(e){return n.getCommonSuperClass(e)},getCommonPropNames:function(e){var t=[],r=this.getCommonSuperClass(e);if(r)for(var i=n.getPropListOfScopes(r,this.getDisplayedPropScopes()),a=0,o=i.getLength();a<o;++a){var s=i.getPropInfoAt(a);t.push(s.name)}return t},getDisplayPropNames:function(e){return this.getCommonPropNames(e)},getDisplayPropEditors:function(e){var t=[],r=this.getCommonSuperClass(e);if(r){var i=this.getPropEditor(null,{dataType:n.getClassName(r)});i&&(i.setObjects(e),t=t.concat(i.getSubPropertyEditors(this.getDisplayedPropScopes())||[]))}else if(1===e.length){var a=e[0];if(o.isObjectValue(a)){var i=this.getPropEditorForType("object");i&&(i.setObjects(a),t=t.concat(i.getSubPropertyEditors()||[]))}}return t},sortPropEditors:function(e){var t=this.getSortField();if(t){"key"===t&&this.getKeyField();var r=function(e,t){return e[t]||e.name};e.sort(function(e,i){var n=r(e.getPropertyInfo(),t),a=r(i.getPropertyInfo(),t);return n<a?-1:n>a?1:0})}},getObjPropValue:function(e,t){return e instanceof a?e.getPropValue(t):e instanceof Object?e[t]:void 0},getObjsPropValue:function(e,t){for(var r=e[0],i=this.getObjPropValue(r,t),n=1,a=e.length;n<a;++n){var r=e[n];if(this.getObjPropValue(r,t)!==i)return}return i},react_click:function($super,e){var t=e.getTarget(),r=this.getParentRow(t);if(r){t===this.getKeyCellExpandMarker(this.getKeyCell(r),!1)&&this.toggleRowExpandState(r)}$super(e)},react_dblclick:function(e){var t=e.getTarget(),r=this.getParentCell(t);if(r){var i=this.getParentRow(r);r===this.getKeyCell(i)&&(this.toggleRowExpandState(i),!0)}},react_keydown:function($super,t){$super(t);var r=t.getKeyCode();if(!(t.getAltKey()||t.getShiftKey()||t.getCtrlKey())){var i=this.getActiveRow();i&&(r===e.X.Event.KeyCode.RIGHT?this.expandRow(i):r===e.X.Event.KeyCode.LEFT&&this.collapseRow(i))}}}),e.Widget.ObjectInspector=i.create(e.Widget.BaseWidget,{CLASS_NAME:"Kekule.Widget.ObjectInspector",initialize:function($super,e){this._propListElem=null,this._objsInfoElem=null,this._propInfoElem=null,this.setPropStoreFieldValue("showObjsInfoPanel",!0),this.setPropStoreFieldValue("showPropInfoPanel",!0),$super(e)},initProperties:function(){this.defineProp("objects",{dataType:o.ARRAY,scope:i.PropertyScope.PUBLIC,setter:function(t){var r=e.ArrayUtils.toArray(t);this.setPropStoreFieldValue("objects",r),this.inspectedObjectsChanged(r)}}),this.defineProp("propEditor",{dataType:"Kekule.Widget.ObjPropListEditor",serializable:!1,setter:null,scope:i.PropertyScope.PRIVATE}),this.defineProp("showObjsInfoPanel",{dataType:o.BOOL,setter:function(e){this.setPropStoreFieldValue("showObjsInfoPanel",e),s.setDisplay(this._objsInfoElem,!!e),this._updateChildElemSize()}}),this.defineProp("showPropInfoPanel",{dataType:o.BOOL,setter:function(e){this.setPropStoreFieldValue("showPropInfoPanel",e),s.setDisplay(this._propInfoElem,!!e),this._updateChildElemSize()}}),this.defineProp("keyField",{dataType:o.STRING,getter:function(){var e=this.getPropEditor();return e&&e.getKeyField()},setter:function(e){var t=this.getPropEditor();t&&t.setKeyField(e)}}),this.defineProp("sortField",{dataType:o.STRING,getter:function(){var e=this.getPropEditor();return e&&e.getSortField()},setter:function(e){var t=this.getPropEditor();t&&t.setSortField(e)}}),this.defineProp("activeRow",{dataType:o.OBJECT,serializable:!1,scope:i.PropertyScope.PUBLIC,getter:function(){var e=this.getPropEditor();return e&&e.getActiveRow()},setter:function(e){var t=this.getPropEditor();t&&t.setActiveRow(e)}}),this.defineProp("enableOperHistory",{dataType:o.BOOL,serializable:!1,getter:function(){var e=this.getPropEditor();return!!e&&e.getEnableOperHistory()},setter:function(e){var t=this.getPropEditor();return t?t.setEnableOperHistory(e):null}}),this.defineProp("operHistory",{dataType:"Kekule.OperationHistory",serializable:!1,scope:i.PropertyScope.PUBLIC,getter:function(){var e=this.getPropEditor();return e?e.getOperHistory():null},setter:function(e){var t=this.getPropEditor();return t?t.setOperHistory(e):null}})},doFinalize:function($super){this._finalizeChildWidgets(),$super()},getChildrenHolderElement:function($super){return this._propListElem||$super()},doGetWidgetClassName:function(){var e=l.OBJINSPECTOR;return this._isUsingFlexLayout()&&(e+=" "+l.OBJINSPECTOR_FLEX_LAYOUT),e},_isUsingFlexLayout:function(){return!!e.BrowserFeature.cssFlex},doBindElement:function($super,e){$super(e),this._updateChildElemSize()},doCreateRootElement:function(e){return e.createElement("div")},doCreateSubElements:function($super,e,t){var i=$super(e,t)||[],n=this._createSubPartElem(e);r.addClass(n,l.OBJINSPECTOR_OBJSINFOPANEL),t.appendChild(n),this._objsInfoElem=n;var a=this._createSubPartElem(e);r.addClass(a,l.OBJINSPECTOR_PROPINFOPANEL),t.appendChild(a),this._propInfoElem=a;var o=this._createSubPartElem(e);return r.addClass(o,l.OBJINSPECTOR_PROPLISTEDITOR_CONTAINER),t.appendChild(o),this._propListElem=o,this._createChildWidgets(o),i.concat([n,a,o])},_createSubPartElem:function(e){var t=e.createElement("div");return t.className=l.OBJINSPECTOR_SUBPART,t},_createChildWidgets:function(t){this._finalizeChildWidgets();var r=new e.Widget.ObjPropListEditor(this);r.appendToWidget(this);var i=this;r.addEventListener("activeRowChange",function(e){i._updatePropInfo()}),this.setPropStoreFieldValue("propEditor",r)},_finalizeChildWidgets:function(){var e=this.getPropEditor();e&&e.finalize()},inspectedObjectsChanged:function(e){var t=this.getPropEditor();t&&t.setObjects(e),this._updateObjectsInfo(e),this._updatePropInfo()},_updateObjectsInfo:function(r){if(this._objsInfoElem){var i;if(r.length<=0)i=e.$L("WidgetTexts.S_INSPECT_NONE");else if(1===r.length){var n=r[0],a=n.getId?n.getId():null,s=o.getType(n);i=a?e.$L("WidgetTexts.S_INSPECT_ID_OBJECT").format(a,s):e.$L("WidgetTexts.S_INSPECT_ANONYMOUS_OBJECT").format(s)}else i=e.$L("WidgetTexts.S_INSPECT_OBJECTS").format(r.length);t.setElementText(this._objsInfoElem,i)}},_updatePropInfo:function(){if(this._propInfoElem){this._propInfoElem.innerHTML="";var e=this.getPropEditor().getActivePropEditor();if(e){var r=e.getTitle(),i=e.getDescription()||e.getPropertyType()||"",n=this._propInfoElem.ownerDocument,a=n.createElement("div");a.className=l.OBJINSPECTOR_PROPINFO_TITLE,t.setElementText(a,r),this._propInfoElem.appendChild(a);var a=n.createElement("div");a.className=l.OBJINSPECTOR_PROPINFO_DESCRIPTION,t.setElementText(a,i),this._propInfoElem.appendChild(a)}}},undo:function(){return this.getPropEditor()&&this.getPropEditor().undo(),this},redo:function(){return this.getPropEditor()&&this.getPropEditor().redo(),this},getRowCascadeKey:function(e){var t=this.getPropEditor();return t&&t.getRowCascadeKey(e)},getActiveRowCascadeKey:function(){var e=this.getPropEditor();return e&&e.getActiveRowCascadeKey()},isRowExpandable:function(e){var t=this.getPropEditor();return t&&t.isRowExpandable(e)},isRowExpanded:function(e){var t=this.getPropEditor();return t&&t.isRowExpanded(e)},expandRow:function(e){var t=this.getPropEditor();return t&&t.expandRow(e),this},collapseRow:function(e){var t=this.getPropEditor();return t&&t.collapseRow(e),this},toggleRowExpandState:function(e){var t=this.getPropEditor();return t&&t.toggleRowExpandState(e),this},collapseAllRows:function(){var e=this.getPropEditor();return e&&e.collapseAllRows(),this},expandAllRows:function(e){var t=this.getPropEditor();return t&&t.expandAllRows(e),this},_updateChildElemSize:function(){var e=this;this._isUsingFlexLayout()||setTimeout(function(){var t;t=e.getShowObjsInfoPanel()?s.getComputedStyle(e._objsInfoElem,"height"):0;var r;r=e.getShowPropInfoPanel()?s.getComputedStyle(e._propInfoElem,"height"):0,e._propListElem.style.top=t,e._propListElem.style.bottom=r},100)},setUseCornerDecoration:function($super,e){return $super(e)}}),e}},function(e,t,r){"use strict";var i=r(0).Class,n=r(0).ClassEx,a=r(0).ObjectEx,o=r(0).DataType;e.exports=function(e){var t=e.ArrayUtils;e.Widget.PropertyEditor={},e.PropertyEditor=e.Widget.PropertyEditor,e.PropertyEditor.BaseEditor=i.create(a,{CLASS_NAME:"Kekule.PropertyEditor.BaseEditor",initialize:function($super){$super(),this._editWidget=null},initProperties:function(){this.defineProp("objects",{dataType:o.ARRAY,serializable:!1,setter:function(t){var r=e.ArrayUtils;this.setPropStoreFieldValue("objects",r.clone(r.toArray(t)))}}),this.defineProp("propertyInfo",{dataType:o.OBJECT,serializable:!1}),this.defineProp("propertyName",{dataType:o.VARIANT,serializable:!1,setter:null,getter:function(){var e=this.getPropertyInfo();return e?e.name:null}}),this.defineProp("propertyType",{dataType:o.VARIANT,serializable:!1,setter:null,getter:function(){var e=this.getPropertyInfo();return e?e.dataType:null}}),this.defineProp("parentEditor",{dataType:"Kekule.PropertyEditor.BaseEditor",serializable:!1}),this.defineProp("valueTextMode",{dataType:o.INT}),this.defineProp("readOnly",{dataType:o.BOOL}),this.defineProp("allowEmpty",{dataType:o.BOOL})},finalize:function($super){this.finalizeWidget(),$super()},finalizeWidget:function(){this._editWidget&&(this._editWidget.finalize(),this._editWidget=null)},getEditWidget:function(){return this._editWidget},getObjPropValue:function(t,r){return e.ObjUtils.isUnset(r)?t:t instanceof a?t.getPropValue(r):o.isArrayValue(t)?t[r]:t instanceof Object?t[r]:void 0},setObjPropValue:function(e,t,r){return e instanceof a?e.setPropValue(t,r):e instanceof Object&&(e[t]=r),this},getObjsPropValue:function(t,r){if(t){if(e.ObjUtils.isUnset(r))return t;for(var i=t[0],n=this.getObjPropValue(i,r),a=1,o=t.length;a<o;++a){var i=t[a];if(this.getObjPropValue(i,r)!==n)return}return n}},setObjsPropValue:function(e,t,r){if(!e||!t)return this;for(var i=0,n=e.length;i<n;++i){var a=e[i];this.setObjPropValue(a,t,r)}return this},isReadOnly:function(){return!!(this.getAttributes()&r.READONLY)},hasSubPropertyEditors:function(){return!!(this.getAttributes()&r.SUBPROPS)},getAttributes:function(){var t=r.MULTIOBJS|r.SIMPLEVALUE,i=this.getPropertyInfo();return e.ObjUtils.isUnset(this.getReadOnly())?i&&!i.setter&&(t|=r.READONLY):this.getReadOnly()&&(t|=r.READONLY),t},getSubPropertyEditors:function(e){return null},getTitle:function(){var e=this.getPropertyInfo();return e?e.title||e.name:""},getHint:function(){return this.getTitle()},getDescription:function(){return this.getPropertyInfo().description},getValue:function(){return this.getObjsPropValue(this.getObjects(),this.getPropertyName())},getValueText:function(){var t=e.Widget.ValueListEditor.ValueDisplayMode,r=this.getValue(),i=this.getValueTextMode();try{var n=i===t.JSON?JSON.stringify(r):e.ObjUtils.isUnset(r)?"":""+r}catch(e){return""+r}return n},setValue:function(e){var t=this.setObjsPropValue(this.getObjects(),this.getPropertyName(),e);return this.getParentEditor()&&this.getParentEditor().notifyChildEditorValueChange&&this.getParentEditor().notifyChildEditorValueChange(this.getPropertyName(),e),t},createEditWidget:function(e){var t=this.getValue(),r=this.doCreateEditWidget(e,t);return r&&r.setIsDirty&&r.setIsDirty(!1),this._editWidget=r,r},doCreateEditWidget:function(e){},saveEditValue:function(){if(this._editWidget){if(!this._editWidget.getIsDirty||this._editWidget.getIsDirty()){var e=this.doSaveEditValue();return this._editWidget.setIsDirty&&this._editWidget.setIsDirty(!1),e}return!1}return!1},doSaveEditValue:function(){},notifyChildEditorValueChange:function(e,t){}}),e.PropertyEditor.EditorAttributes={MULTIOBJS:1,SUBPROPS:2,SIMPLEVALUE:4,VALUELIST:8,CUSTOMEDIT:16,READONLY:32,INLINE_EDIT:128,DROP_EDIT:256,POPUP_EDIT:512};var r=e.PropertyEditor.EditorAttributes;return e.PropertyEditor.EditorMananger=i.create({initialize:function(){this._registeredItems=[],this._defaultItems=[]},register:function(e,t,r,i,n){var a={editorClass:e,propType:t,objClass:r,propName:i,matchFunc:n};return this._registeredItems.push(a),t||r||i||n||this._defaultItems.push(a),this},unregister:function(e){for(var t=this._registeredItems,r=t.length-1;r>=0;--r){var i=t[r];i.editorClass===e&&t.splice(r,1)}for(var t=this._defaultItems,r=t.length-1;r>=0;--r){var i=t[r];i.editorClass===e&&t.splice(r,1)}return this},_getDefaultItem:function(){var e=this._defaultItems;return e[e.length-1]},_getSuperiorItem:function(e,t){for(var r=["matchFunc","propName","objClass","propType"],i=0,n=r.length;i<n;++i)if(!!e[r]!=!!t[r])return e[r]?e:t;return e},_isMatchedPropType:function(t,r){var i=t===r;if(!i&&o.isObjectExType(t)&&o.isObjectExType(r)){var a=n.findClass(t,void 0,e),s=n.findClass(r,void 0,e);i=n.isOrIsDescendantOf(a,s)}return i},_testOnPropType:function(e,t){return e.propType&&t.dataType?this._isMatchedPropType(t.dataType,e.propType)?1:-1:0},_testOnObjClass:function(e,t){return e.objClass&&t?n.isOrIsDescendantOf(t,e.objClass)?1:-1:0},_testOnPropName:function(e,t){return e.propName&&t.name?e.propName===t.name?1:-1:0},_testOnMatchFunc:function(e,t,r){return e.matchFunc?e.matchFunc(t,r)?1:-1:0},findEditorClass:function(e,t){for(var r=null,i=this._registeredItems,n=i.length-1;n>=0;--n){var a=i[n],o=this._testOnPropType(a,t);if(!(o<0)){var s=this._testOnObjClass(a,e);if(!(s<0)){var l=this._testOnPropName(a,t);if(!(l<0)){var d=this._testOnMatchFunc(a,e,t);if(!(d<0)&&o+s+l+d>0&&(r=r?this._getSuperiorItem(r,a.editorClass):a.editorClass)&&a.matchFunc)break}}}}if(!r){var a=this._getDefaultItem();r=a?a.editorClass:null}return r},findEditorClassForType:function(e,t){var r={dataType:e,name:t};return this.findEditorClass(null,r)}}),e.ClassUtils.makeSingleton(e.PropertyEditor.EditorMananger),e.PropertyEditor.findEditorClass=e.PropertyEditor.EditorMananger.getInstance().findEditorClass.bind(e.PropertyEditor.EditorMananger.getInstance()),e.PropertyEditor.findEditorClassForType=e.PropertyEditor.EditorMananger.getInstance().findEditorClassForType.bind(e.PropertyEditor.EditorMananger.getInstance()),e.PropertyEditor.register=e.PropertyEditor.EditorMananger.getInstance().register.bind(e.PropertyEditor.EditorMananger.getInstance()),e.PropertyEditor.unregister=e.PropertyEditor.EditorMananger.getInstance().unregister.bind(e.PropertyEditor.EditorMananger.getInstance()),e.PropertyEditor.SimpleEditor=i.create(e.PropertyEditor.BaseEditor,{CLASS_NAME:"Kekule.PropertyEditor.SimpleEditor",convertStrToValue:function(t,r){return o.isSimpleType(r)?!t&&this.getAllowEmpty()?null:e.StrUtils.convertToType(t,r):t},setValueText:function(e){if(e===this._originValueText)return!1;var t,r=this.getPropertyType();return!(r&&!o.isSimpleType(r))&&(t=r?this.convertStrToValue(e,r):e,this.setValue(t),!0)},doCreateEditWidget:function(t){var r=this.getValueText();return this._originValueText=r,new e.Widget.TextBox(t,r)},doSaveEditValue:function(){return this.setValueText(this.getEditWidget().getValue())}}),e.PropertyEditor.register(e.PropertyEditor.SimpleEditor),e.PropertyEditor.TextEditor=i.create(e.PropertyEditor.SimpleEditor,{CLASS_NAME:"Kekule.PropertyEditor.TextEditor",LINE_BREAK_REPLACER:"\\n",textToSingleLine:function(e){return e.split("\n").join(this.LINE_BREAK_REPLACER)},textToMultiLine:function(e){return e.split(this.LINE_BREAK_REPLACER).join("\n")},doCreateEditWidget:function(t){this._parentWidget=t;var r=this.getValueText();this._originValueText=r;var i=new e.Widget.ButtonTextBox(t,this.textToSingleLine(r));return this._textbox=i,i.setButtonKind(e.Widget.Button.Kinds.POPUP),i.addEventListener("buttonExecute",this.reactButtonExecute,this),i},reactButtonExecute:function(e){this.openPopupEditor()},openPopupEditor:function(){var t=this._popupDialog;t||(t=this.createPopupDialog(),this._popupDialog=t);var r=this._popupEditor;r.setValue(this.getValueText());var i=this;t.openPopup(function(t){t===e.Widget.DialogButtons.OK&&(i._textbox.setValue(i.textToSingleLine(r.getValue())),i._textbox.setIsDirty(!0),i.saveEditValue())},this._textbox)},createPopupDialog:function(){var t=this._parentWidget.getDocument(),r=new e.Widget.Dialog(t,this.getPropertyName(),[e.Widget.DialogButtons.OK,e.Widget.DialogButtons.CANCEL]);r.setLocation(e.Widget.Location.CENTER_OR_FULLFILL);var i=e.Widget.TextArea,n=new i(t),a=n.getElement().style;return a.width="40em",a.height="20em",n.appendToWidget(r),this._popupEditor=n,r},doSaveEditValue:function(){var e=this.getEditWidget().getValue();return(e=this.textToMultiLine(e))!==this._originValueText&&(this.setValueText(e),!0)}}),e.PropertyEditor.register(e.PropertyEditor.TextEditor,o.STRING),e.PropertyEditor.BoolEditor=i.create(e.PropertyEditor.BaseEditor,{CLASS_NAME:"Kekule.PropertyEditor.BoolEditor",boolToStr:function(t){return e.StrUtils.boolToStr(t)},doCreateEditWidget:function(t){this._originValue=this.getValue();var r=new e.Widget.CheckBox(t,this._originValue);r.setText(this.boolToStr(this._originValue));var i=this;return r.addEventListener("valueChange",function(e){var t=r.getChecked();r.setText(i.boolToStr(t))}),r},getValueText:function($super){var t=this.getValue();return e.ObjUtils.isUnset(t)?e.$L("WidgetTexts.S_VALUE_UNSET"):$super()},doSaveEditValue:function(){var e=this.getEditWidget().getChecked();return e!==this._originValue&&(this.setValue(e),!0)}}),e.PropertyEditor.register(e.PropertyEditor.BoolEditor,o.BOOL),e.PropertyEditor.SelectEditor=i.create(e.PropertyEditor.BaseEditor,{CLASS_NAME:"Kekule.PropertyEditor.SelectEditor",getValueText:function($super){for(var e=this.getValue(),t=this.getSelectItems()||[],r=0,i=t.length;r<i;++r){var n=t[r];if(n.value===e)return n.text}return $super()},getSelectItems:function(){return[]},doCreateEditWidget:function(t){var r=new e.Widget.SelectBox(t,this.getSelectItems());return this._originalValue=this.getValue(),r.setValue(this._originalValue),r},doSaveEditValue:function(){var e=this.getEditWidget().getValue();return e!==this._originalValue&&(this.setValue(e),!0)}}),e.PropertyEditor.EnumEditor=i.create(e.PropertyEditor.SelectEditor,{CLASS_NAME:"Kekule.PropertyEditor.EnumEditor",initialize:function($super){$super(),this.enumInfos=[]},setPropertyInfo:function($super,t){if($super(t),t){var r=t.enumSource;if(r&&o.isObjectValue(r)){var i=e.ObjUtils.getOwnedFieldNames(r);this.enumInfos=[];for(var n=0,a=i.length;n<a;++n)this.enumInfos.push({text:i[n],value:r[i[n]]})}}},getSelectItems:function(){var t=this.getValue();if(e.ObjUtils.isUnset(t)){var r=e.ArrayUtils.clone(this.enumInfos);return r.unshift({text:e.$L("WidgetTexts.S_VALUE_UNSET"),value:t}),r}return this.enumInfos}}),e.PropertyEditor.register(e.PropertyEditor.EnumEditor,null,null,null,function(e,t){return!!t.enumSource}),e.PropertyEditor.ObjectExEditor=i.create(e.PropertyEditor.BaseEditor,{CLASS_NAME:"Kekule.PropertyEditor.ObjectExEditor",getAttributes:function($super){var e=$super();return e|=r.SUBPROPS},hasSubPropertyEditors:function($super){return $super()&&this.getValue()},getSubPropertyEditors:function(t){var r=[],i=this.getValue();if(i){if(i instanceof a)var o=i,s=o.getClass();else var s=n.getCommonSuperClass(i);for(var l=n.getPropListOfScopes(s,t),d=0,u=l.getLength();d<u;++d){var c=l.getPropInfoAt(d),h=e.PropertyEditor.findEditorClass(s,c);if(h){var m=new h;m.setObjects(e.ArrayUtils.toArray(i)),m.setPropertyInfo(c),m.setValueTextMode(this.getValueTextMode()),r.push(m)}}}return r},getValueText:function($super){var t=this.getValue();return e.ObjUtils.notUnset(t)?t.getClassName?"["+t.getClassName()+"]":$super():e.$L("WidgetTexts.S_OBJECT_UNSET")}}),e.PropertyEditor.register(e.PropertyEditor.ObjectExEditor,"ObjectEx"),e.PropertyEditor.ObjectFieldEditor=i.create(e.PropertyEditor.SimpleEditor,{CLASS_NAME:"Kekule.PropertyEditor.ObjectFieldEditor",initialize:function(){},doCreateEditWidget:function($super,e){if(!this.getPropertyType()){var t=this.getValue();this.getPropertyInfo().dataType=o.getType(t)}return $super(e)}}),e.PropertyEditor.ObjectEditor=i.create(e.PropertyEditor.BaseEditor,{CLASS_NAME:"Kekule.PropertyEditor.ObjectEditor",initialize:function($super){$super(),this._initialObjValue=void 0},getFieldEditorClass:function(t,r){return e.PropertyEditor.findEditorClass(null,r)||e.PropertyEditor.ObjectFieldEditor},getFieldValueType:function(t,r){var i=t[r];return e.ObjUtils.notUnset(i)?o.getType(i):null},createFieldEditor:function(e,t){var r=this.getFieldEditorClass(e,t),i=new r;return i.setParentEditor(this),i.setReadOnly(!1),i.setAllowEmpty(this.getAllowEmpty()),i.setPropertyInfo(t),i.setObjects(e),i.setValueTextMode(this.getValueTextMode()),i},getObjFields:function(t){return t?e.ObjUtils.getOwnedFieldNames(t):[]},getObjFieldInfos:function(e){for(var t=this.getObjFields(e),r=[],i=0,n=t.length;i<n;++i){var a={name:t[i],dataType:this.getFieldValueType(e,t[i])};r.push(a)}return r},notifyChildEditorValueChange:function(e,t){var r=this.getValue()||this._initialObjValue;r[e]=t,this.setValue(r)},getAttributes:function($super){var e=$super();return e|=r.SUBPROPS},hasSubPropertyEditors:function($super){return $super()&&this.getObjFieldInfos(this.getValue()).length},getValueText:function($super){var t=e.Widget.ValueListEditor.ValueDisplayMode;return this.getValueTextMode()===t.JSON?$super():this.getValue()?"["+e.$L("WidgetTexts.S_OBJECT")+"]":""},setValue:function($super,e){var t=$super(e);return this._initialObjValue=e,t},getSubPropertyEditors:function(e){var r=[],i=t.toArray(this.getValue());if(i.length>1)return[];var n=i[0];this._initialObjValue=n||{};for(var a=this.getObjFieldInfos(n),o=[this._initialObjValue],s=0,l=a.length;s<l;++s){var d=this.createFieldEditor(o,a[s]);r.push(d)}return r}}),e.PropertyEditor.register(e.PropertyEditor.ObjectEditor,o.OBJECT),e.PropertyEditor.ArrayEditor=i.create(e.PropertyEditor.BaseEditor,{CLASS_NAME:"Kekule.PropertyEditor.ArrayEditor",getAttributes:function($super){var e=$super();return e|=r.SUBPROPS},hasSubPropertyEditors:function($super){var e=this.getValue();return $super()&&e&&e.length},getSubPropertyEditors:function(t){var r=[],i=this.getValue();if(o.isArrayValue(i)&&i.length)for(var n=this.getPropertyInfo().elementType,a=0,s=i.length;a<s;++a){var l=i[a],d=n||o.getType(l),u=e.PropertyEditor.findEditorClassForType(d);if(u){var c=new u;c.setParentEditor(this),c.setObjects([i]);var h={name:a,title:a,dataType:d};c.setPropertyInfo(h),c.setValueTextMode(this.getValueTextMode()),r.push(c)}}return r},getValueText:function($super){var t=this.getValue();return o.isArrayValue(t)?"["+t.length+" "+e.$L("WidgetTexts.S_ITEMS")+"]":$super()}}),e.PropertyEditor.register(e.PropertyEditor.ArrayEditor,o.ARRAY),e.PropertyEditor.ColorEditor=i.create(e.PropertyEditor.SimpleEditor,{CLASS_NAME:"Kekule.PropertyEditor.ColorEditor",doCreateEditWidget:function(t){this._parentWidget=t;var r=this.getValue();this._originValue=r;var i=new e.Widget.ColorDropTextBox(t,r);return i.setSpecialColors([e.Widget.ColorPicker.SpecialColors.UNSET]),i.addEventListener("valueSet",function(e){this.saveEditValue()},this),this._textbox=i,i},doSaveEditValue:function(){var t=this.getEditWidget().getValue();return t===e.Widget.ColorPicker.SpecialColors.UNSET?t=void 0:""===t&&(t=void 0),t!==this._originValue&&(this.setValue(t),!0)}}),e.PropertyEditor.register(e.PropertyEditor.ColorEditor,o.STRING,null,null,function(e,t){var r=t.name;return r&&r.toLowerCase().indexOf("color")>=0}),e}},function(e,t,r){"use strict";var i=r(0).Class,n=r(0).DataType;e.exports=function(e){return e.Widget.PropEditorModifyOperation=i.create(e.Operation,{CLASS_NAME:"Kekule.Widget.PropEditorModifyOperation",initialize:function($super,e,t,r){$super(),this.setPropEditor(e),this.setNewValue(t),this.setOldValue(r)},initProperties:function(){this.defineProp("propEditor",{dataType:"Kekule.PropertyEditor.BaseEditor",serializable:!1}),this.defineProp("newValue",{dataType:n.VARIANT,serializable:!1}),this.defineProp("oldValue",{dataType:n.VARIANT,serializable:!1})},doExecute:function(){var e=this.getPropEditor();void 0===this.getOldValue()&&this.setOldValue(e.getValue()),e.setValue(this.getNewValue())},doReverse:function(){this.getPropEditor().setValue(this.getOldValue())}}),e}},function(e,t,r){"use strict";var i=r(0).Class,n=r(0).ClassEx,a=r(0).ObjectEx,o=r(0).DataType;e.exports=function(e){e.Widget.HtmlClassNames=Object.extend(e.Widget.HtmlClassNames,{WIDGET_CONFIGURATOR:"K-Widget-Configurator",WIDGET_CONFIGURATOR_CLIENT:"K-Widget-Configurator-Client",ACTION_OPEN_CONFIGURATOR:"K-Action-Open-Configurator"});var t=e.Widget.HtmlClassNames;return e.Widget.Configurator=i.create(e.Widget.Panel,{CLASS_NAME:"Kekule.Widget.Configurator",TAB_BTN_DATA_FIELD:"__$data__",DEF_TAB_POSITION:e.Widget.Position.RIGHT,initialize:function($super,e){this.setPropStoreFieldValue("widget",e),this._objInspector=null,this._tabGroup=null,$super(e)},initProperties:function(){this.defineProp("widget",{dataType:"Kekule.Widget.BaseWidget",serializable:!1}),this.defineProp("autoUpdate",{dataType:o.BOOL}),this.defineProp("tabPosition",{dataType:o.INT,setter:function(e){this.setPropStoreFieldValue("tabPosition",e),this._tabGroup&&this._tabGroup.setTabButtonPosition(e||this.DEF_TAB_POSITION)}})},initPropValues:function($super){$super(),this.setLayout(e.Widget.Layout.HORIZONTAL)},doGetWidgetClassName:function($super){return $super()+" "+t.WIDGET_CONFIGURATOR},doCreateRootElement:function(e){return e.createElement("div")},doCreateSubElements:function($super,r,i){var n=[],a=r.createElement("div");a.className=t.WIDGET_CONFIGURATOR_CLIENT,n.push(a);var o=new e.Widget.ObjectInspector(this);o.setShowObjsInfoPanel(!1),o.setSortField(null),o.appendToElem(a),this._objInspector=o,o.addEventListener("propertyChange",function(e){this.invokeEvent("configChange",{obj:o.getObjects()[0],propertyName:e.propertyInfo.name,oldValue:e.oldValue,newValue:e.newValue})},this);var s=this.getCategoryInfos(),l=new e.Widget.TabButtonGroup(this);this._tabGroup=l,l.setTabButtonPosition(this.getTabPosition()||this.DEF_TAB_POSITION);for(var d,u=0,c=s.length;u<c;++u){var h=s[u],m=new e.Widget.RadioButton(l);m.setText(h.title||h.name),m.setHint(h.description||""),m[this.TAB_BTN_DATA_FIELD]=h.obj,m.appendToWidget(l),0===u&&(d=m)}return l.addEventListener("execute",function(t){var r=t.widget;r instanceof e.Widget.RadioButton&&this._switchToTab(r)},this),l.appendToElem(a),s.length<=1&&l.setDisplayed("none"),d.setChecked(!0),this._switchToTab(d),i.appendChild(a),n},doWidgetShowStateChanged:function($super,e){$super(e),this.getAutoUpdate()&&(e?this.loadConfigValues():this.saveConfigValues())},loadConfigValues:function(){},saveConfigValues:function(){},getCategoryInfos:function(){var e=this.getWidget(),t=[],r=e.getSettingFacade();if(r){var i=e.getPropInfo("settingFacade");t.push({obj:r,name:i.name,title:i.title,descrption:i.description})}return t},_switchToTab:function(e){var t=e[this.TAB_BTN_DATA_FIELD];this._objInspector.setObjects(t)}}),e.Widget.ActionOpenConfigWidget=i.create(e.Action,{CLASS_NAME:"Kekule.Widget.ActionOpenConfigWidget",HTML_CLASSNAME:t.ACTION_OPEN_CONFIGURATOR,initialize:function($super,t){$super(),this.setWidget(t),this.setText(e.$L("WidgetTexts.CAPTION_CONFIG")),this.setHint(e.$L("WidgetTexts.HINT_CONFIG"))},initProperties:function(){this.defineProp("widget",{dataType:"Kekule.Widget.BaseWidget",serializable:!1})},doUpdate:function(){var e=this.getWidget();this.setEnabled(e&&e.getEnabled())},doExecute:function(e){this.getWidget().openConfigurator(e)}}),n.extend(e.Widget.BaseWidget,{getSettingFacadeClass:function(){var t=this.getClass(),r=null;do{var i=n.getClassName(t)+".Settings";r=n.findClass(i,void 0,e),t=n.getSuperClass(t)}while(t&&!r);return r},getConfiguratorClass:function(){var t=this.getClass(),r=null;do{var i=n.getClassName(t)+".Configurator";r=n.findClass(i,void 0,e),t=n.getSuperClass(t)}while(t&&!r);return r},createConfigurator:function(){return new(this.getConfiguratorClass())(this)},getConfigurator:function(){return this._configurator||(this._configurator=this.createConfigurator()),this._configurator},openConfigurator:function(t){this.getConfigurator().show(t||this,null,e.Widget.ShowHideType.DROPDOWN)}}),n.defineProp(e.Widget.BaseWidget,"settingFacade",{dataType:o.OBJECTEX,serializable:!1,scope:i.PropertyScope.PUBLIC,setter:null,getter:function(){var e=this.getPropStoreFieldValue("settingFacade");if(!e){var t=this.getSettingFacadeClass();t&&(e=new t(this),this.setPropStoreFieldValue("settingFacade",e))}return e}}),e.Widget.BaseWidget.Settings=i.create(a,{CLASS_NAME:"Kekule.Widget.BaseWidget.Settings",initialize:function($super,e){this._basedClass=null,$super(),this.setWidget(e)},initProperties:function(){this.defineProp("widget",{dataType:"Kekule.Widget.BaseWidget",serializable:!1,scope:i.PropertyScope.PUBLIC})},getBasedClass:function(){if(!this.hasOwnProperty("_basedClass")||!this._basedClass){var t=this.getClassName(),r=t.split(".");r.pop(),t=r.join("."),this._basedClass=n.findClass(t,void 0,e)}return this._basedClass},defineDelegatedProp:function(e,t){t||(t=e);var r=n.getPropInfo(this.getBasedClass(),t),i=Object.create(r);i.setter=null,i.getter=null,r.getter&&(i.getter=function(){return this.getWidget().getPropValue(t)}),r.setter&&(i.setter=function(e){this.getWidget().setPropValue(t,e)}),this.defineProp(e,i)},defineDelegatedProps:function(e,t){t||(t=[]);for(var r=0,i=e.length;r<i;++r){var n=e[r],a=t[r]||n;this.defineDelegatedProp(n,a)}}}),e}},function(e,t,r){"use strict";var i=r(0).Class,n=r(0).ObjectEx,a=r(0).DataType;e.exports=function(e){return e.Widget.BaseDataSet=i.create(n,{CLASS_NAME:"Kekule.Widget.BaseDataSet",PREFIX_SORT_DESC:"!",initProperties:function(){this.defineProp("enableCache",{dataType:a.BOOL,getter:function(){return this.getPropStoreFieldValue("enableCache")&&this.getCacheAvailable()},setter:function(e){this.setPropStoreFieldValue("enableCache",e),e||this.clearCache()}}),this.defineProp("defaultTimeout",{dataType:a.INT}),this.defineProp("sortFields",{dataType:a.ARRAY,setter:function(t){var r=t?e.ArrayUtils.toArray(t):null;this.setPropStoreFieldValue("sortFields",r),this.sortFieldsChanged(r)}}),this.defineProp("cache",{dataType:a.ARRAY})},initPropValues:function($super){$super(),this.setEnableCache(!0),this.setCache([]),this.setDefaultTimeout(2e4)},finalize:function($super){this.clearCache(),this.setCache(null),$super()},dataChanged:function(){this.clearCache(),this.invokeEvent("dataChange")},sortFieldsChanged:function(e){this.clearCache(),this.doSortFieldsChanged(e)},doSortFieldsChanged:function(e){},getTotalCount:function(){return this.doGetTotalCount()||0},doGetTotalCount:function(){},totalCountChanged:function(e){this.invokeEvent("totalCountChange",{totalCount:e})},getFirstIndex:function(){return 0},getLastIndex:function(){return(this.getTotalCount()||0)-1},getCacheAvailable:function(){return!0},clearCache:function(){return this.getCache().length=0,this},saveCacheData:function(e,t){for(var r=this.getCache(),i=t,n=0;n<e.length;++n)r[i]=e[n]||null,++i},loadCacheData:function(e,t){if(this.getEnableCache()){var r=this.getCache();if(r.length<e+t)return null;for(var i=[],n=e,a=e+t;n<a;++n){var o=r[n];if(void 0===o)return null;i.push(o)}return i}return null},fetch:function(t){var r=Object.extend({fromIndex:0,count:0},t);if(r.timeout=r.timeout||this.getDefaultTimeout(),this.getEnableCache()){var i=this.loadCacheData(r.fromIndex,r.count);if(i)return void r.callback(i)}var n=this,a=!1,o=function(e){a||(d&&clearTimeout(d),t.callback&&t.callback(e),n.getEnableCache()&&n.saveCacheData(e,r.fromIndex))},s=function(e){a||(d&&clearTimeout(d),t.errCallback&&t.errCallback(e))};if(r.timeout>0)var l=function(){d&&clearTimeout(d),a=!0,r.timeoutCallback?r.timeoutCallback():t.errCallback&&t.errCallback(e.$L("ErrorMsg.FETCH_DATA_TIMEOUT"))},d=setTimeout(l,r.timeout);r.callback=o,r.errCallback=s;this.doFetch(r.fromIndex,r.count,r.callback,r.errCallback)},doFetch:function(e,t,r,i){}}),e.Widget.ArrayDataSet=i.create(e.Widget.BaseDataSet,{CLASS_NAME:"Kekule.Widget.ArrayDataSet",initialize:function($super,e){$super(),this.setData(e)},initProperties:function(){this.defineProp("data",{dataType:a.ARRAY,setter:function(e){this.setPropStoreFieldValue("data",e);var t=this.getSortFields();t&&this.doSortFieldsChanged(t),this.dataChanged()}})},getCacheAvailable:function(){return!1},doSortFieldsChanged:function(t){var r=this.getData()||[];return e.ArrayUtils.sortHashArray(r,t),this.dataChanged(),this},doGetTotalCount:function(){return(this.getData()||[]).length},doFetch:function(e,t,r,i){for(var n=[],a=this.getData()||[],o=e,s=Math.min(e+t,a.length);o<s;++o){var l=a[o];n.push(l)}r(n)}}),e.Widget.DataPager=i.create(n,{CLASS_NAME:"Kekule.Widget.DataPager",initialize:function($super,e){$super(),this.setPropStoreFieldValue("pageSize",10),this.setDataSet(e)},initProperties:function(){this.defineProp("dataSet",{dataType:"Kekule.Widget.BaseDataSet",setter:function(e){var t=this.getDataSet();e!==t&&(this.setPropStoreFieldValue("dataSet",e),this.dataSetChange(t,e),this.switchToPage(this.getCurrPageIndex()||0))}}),this.defineProp("pageSize",{dataType:a.INT,setter:function(e){e!==this.getPageSize()&&(this.setPropStoreFieldValue("pageSize",e),this.pageCountChanged(this.getPageCount()),this.switchToPage(this.getCurrPageIndex()||0))}}),this.defineProp("currPageIndex",{dataType:a.INT}),this.defineProp("currPageData",{dataType:a.ARRAY}),this.defineProp("sortFields",{dataType:a.ARRAY,serializable:!1,getter:function(){return this.getDataSet()&&this.getDataSet().getSortFields()},setter:function(e){this.getDataSet()&&this.getDataSet().setSortFields(e)}})},initPropValues:function($super){$super(),this.setCurrPageIndex(0)},dataSetChange:function(e,t){e&&(e.RemoveEventListener("dataChange",this.reactDataSetDataChange,this),e.RemoveEventListener("totalCountChange",this.reactDataSetTotalCountChange,this)),t&&(t.addEventListener("dataChange",this.reactDataSetDataChange,this),t.addEventListener("totalCountChange",this.reactDataSetTotalCountChange,this)),this.pageCountChanged(this.getPageCount())},reactDataSetDataChange:function(e){this.dataChanged()},dataChanged:function(){this.pageCountChanged(this.getPageCount()),this.switchToPage(this.getCurrPageIndex()||0)},reactDataSetTotalCountChange:function(e){this.pageCountChanged(this.getPageCount())},getPageCount:function(){var e=this.getDataSet(),t=e?e.getTotalCount()||0:0;return Math.ceil(t/this.getPageSize())},pageCountChanged:function(e){this.invokeEvent("pageCountChange",{pageCount:e})},fetchPageData:function(t){var r=this.getPageSize(),i=e.ObjUtils.isUnset(t.pageIndex)?this.getCurrPageIndex():t.pageIndex,n=r*i,a=this.getPageSize(),o=Object.create(t);return Object.extend(o,{fromIndex:n,count:a}),this.getDataSet().fetch(o),this},switchToPage:function(t,r){var i=this,n={pageIndex:t,timeout:r,callback:function(e){i.setCurrPageData(e),i.setCurrPageIndex(t),i.invokeEvent("dataFetched",{pageIndex:t,data:e})},errCallback:function(t){i.invokeEvent("dataError",{error:t}),e.error(t)}};this.invokeEvent("pageRetrieve",{pageIndex:t}),this.fetchPageData(n)}}),e}},function(e,t,r){"use strict";var i=r(0).Class,n=r(0).DataType;e.exports=function(e){var t=e.DomUtils,r=e.HtmlElementUtils,a=e.Widget.HtmlClassNames;e.Widget.HtmlClassNames=Object.extend(e.Widget.HtmlClassNames,{DATAGRID:"K-DataGrid",DATATABLE:"K-DataTable",DATATABLE_ROW_ODD:"K-Odd",DATATABLE_ROW_EVEN:"K-Even",DATATABLE_CELL_WRAPPER:"K-DataTable-CellWrapper",DATATABLE_HEADCELL_INTERACTABLE:"K-DataTable-HeadCellInteractable",DATATABLE_OPER_COL:"K-DataTable-OperCol",DATATABLE_OPER_CELL:"K-DataTable-OperCell",DATATABLE_CHECK_COL:"K-DataTable-CheckCol",DATATABLE_CHECK_CELL:"K-DataTable-CheckCell",DATATABLE_DATA_COL:"K-DataTable-DataCol",DATATABLE_DATA_CELL:"K-DataTable-DataCell",DATATABLE_SORTMARK:"K-DataTable-SortMark",DATATABLE_SORTASC:"K-Sort-Asc",DATATABLE_SORTDESC:"K-Sort-Desc",DATATABLE_EDIT:"K-DataTable-Edit",DATATABLE_DELETE:"K-DataTable-Delete",DATATABLE_INSERT:"K-DataTable-Insert",PAGENAVIGATOR:"K-PageNavigator",PAGENAVIGATOR_FIRST:"K-PageNavigator-First",PAGENAVIGATOR_LAST:"K-PageNavigator-Last",PAGENAVIGATOR_PREV:"K-PageNavigator-Prev",PAGENAVIGATOR_NEXT:"K-PageNavigator-Next",PAGENAVIGATOR_PAGEINDEXER:"K-PageNavigator-PageIndexer",PAGENAVIGATOR_PAGEINPUT:"K-PageNavigator-PageInput",PAGENAVIGATOR_PAGESELECTOR:"K-PageNavigator-PageSelector"}),e.Widget.DataTableColNames={OPER:"OPER",CHECK:"CHECK",ALL:"*"};var o=e.Widget.DataTableColNames;e.Widget.DataTable=i.create(e.Widget.BaseWidget,{CLASS_NAME:"Kekule.Widget.DataTable",BINDABLE_TAG_NAMES:["div","span"],PREFIX_SORT_DESC:"!",COLDEF_FIELD:"__$colDef__",ROWDATA_FIELD:"__$rowData__",ROW_OPER_TOOLBAR_FIELD:"__$rowOperToolbar__",ROW_CHECKBOX_FIELD:"__$rowCheckBox__",COLNAME_OPER:o.OPER,COLNAME_CHECK:o.CHECK,COLNAME_ALL:o.ALL,initialize:function($super,e){this._displayData=null,this.setPropStoreFieldValue("showTableHead",!0),$super(e)},initProperties:function(){this.defineProp("data",{dataType:n.ARRAY}),this.defineProp("columns",{dataType:n.ARRAY}),this.defineProp("operColShowMode",{dataType:n.STRING}),this.defineProp("operWidgets",{dataType:n.ARRAY}),this.defineProp("sortFields",{dataType:n.ARRAY,setter:function(t){var r=t?e.ArrayUtils.toArray(t):null;this.setPropStoreFieldValue("sortFields",r),this.getDataPager()&&this.getDataPager().setSortFields(r)}}),this.defineProp("sortFunc",{dataType:n.FUNCTION}),this.defineProp("showTableHead",{dataType:n.BOOL}),this.defineProp("enableHeadInteraction",{dataType:n.BOOL}),this.defineProp("enableActiveRow",{dataType:n.BOOL,setter:function(e){this.setPropStoreFieldValue("enableActiveRow",e),e||this.setActiveCell(null)}}),this.defineProp("activeCell",{dataType:n.OBJECT,setter:function(e){var t=this.getActiveCell();if(t!==e)if(t&&r.removeClass(t,a.STATE_ACTIVE),this.setPropStoreFieldValue("activeCell",e),e){r.addClass(e,a.STATE_ACTIVE);var i=this.getParentRow(e);i&&this.setActiveRow(i)}else this.setActiveRow(null)}}),this.defineProp("activeRow",{dataType:n.OBJECT,setter:function(e){var t=this.getActiveRow();t!==e&&(this.activeRowChanged(t,e),this.setPropStoreFieldValue("activeRow",e))}}),this.defineProp("hoverCell",{dataType:n.OBJECT,setter:function(e){var t=this.getHoverCell();if(t!==e)if(t&&r.removeClass(t,a.STATE_HOVER),this.setPropStoreFieldValue("hoverCell",e),e){r.addClass(e,a.STATE_HOVER);var i=this.getParentRow(e);i&&this.setHoverRow(i)}else this.setHoverRow(null)}}),this.defineProp("hoverRow",{dataType:n.OBJECT,setter:function(e){var t=this.getHoverRow();t!==e&&(this.hoverRowChanged(t,e),this.setPropStoreFieldValue("hoverRow",e))}}),this.defineProp("dataPager",{dataType:"Kekule.Widget.DataPager",setter:function(e){var t=this.getDataPager();t!==e&&(this.setPropStoreFieldValue("dataPager",e),this.dataPagerChanged(e,t))}})},initPropValues:function($super){$super(),this.reactOperEditBind=this.reactOperEdit.bind(this),this.reactOperDeleteBind=this.reactOperDelete.bind(this),this.reactOperInsertBind=this.reactOperInsert.bind(this)},doObjectChange:function($super,t){$super(t);var r=["data","columns","sortFields","sortFunc","showTableHead","enableHeadInteraction","operColShowMode","operWidgets"];e.ArrayUtils.intersect(t,r).length&&this.recreateChildContent()},doGetWidgetClassName:function($super){return $super()+" "+a.DATATABLE},doCreateRootElement:function(e){return e.createElement("div")},doCreateSubElements:function(e,t){return this.doCreateDataTable(e,t)},doCreateDataTable:function(e,t){var r=e.createElement("table");return this.recreateChildContent(e,r),t.appendChild(r),r},getTableElement:function(){return this.getElement()&&this.getElement().getElementsByTagName("table")[0]},getShowOperCol:function(){return(this.getOperColShowMode()||e.Widget.DataTable.OperColShowMode.NONE)!==e.Widget.DataTable.OperColShowMode.NONE},recreateChildContent:function(e,r){this.setActiveCell(null),this.setHoverCell(null);var i=this.prepareData(),n=r||this.getTableElement(),a=[];if(n){if(t.clearChildContent(n),!e)var e=n.ownerDocument;a.push(this.doCreateDataTableColGroup(e,n,i.columns)),this.getShowTableHead()&&a.push(this.doCreateDataTableHead(e,n,i.columns)),a.push(this.doCreateDataTableBody(e,n,i.columns,i.data))}return a},doCreateDataTableColGroup:function(e,t,r){for(var i=r||[],n=e.createElement("colgroup"),a=0,o=i.length;a<o;++a){var s=i[a]||{},l=e.createElement("col");s.colClassName&&(l.className=s.colClassName),s.colStyle&&(l.style.cssText=s.colStyle),n.appendChild(l)}return t.appendChild(n),n},doCreateDataTableCellWrapper:function(e,t){var r=e.createElement("span");return r.className=a.DATATABLE_CELL_WRAPPER,t.appendChild(r),r},doCreateDataTableHead:function(e,t,r){for(var i=r||[],n=this.getEnableHeadInteraction(),a=e.createElement("thead"),o=e.createElement("tr"),s=0,l=i.length;s<l;++s){var d=i[s]||{};this.doCreateDataTableHeadCell(e,o,d,n)}return a.appendChild(o),t.appendChild(a),a},doCreateDataTableHeadCell:function(i,n,o,s){var l=i.createElement("th");o.className&&(l.className=o.className),o.style&&(l.style.cssText=o.style);var d=this.doCreateDataTableCellWrapper(i,l);(e.ObjUtils.notUnset(o.disableInteract)?!o.disableInteract:s)&&r.addClass(l,a.DATATABLE_HEADCELL_INTERACTABLE),t.setElementText(d,o.text||o.name);var u=this.doCreateDataTableHeadCellSortMark(i,l);return 1===o.sorting?r.addClass(u,a.DATATABLE_SORTASC):-1===o.sorting&&r.addClass(u,a.DATATABLE_SORTDESC),d.title=o.hint||"",l[this.COLDEF_FIELD]=o,n.appendChild(l),l},doCreateDataTableHeadCellSortMark:function(e,t){var r=e.createElement("span");return r.className=a.DATATABLE_SORTMARK,t.appendChild(r),r},doCreateDataTableBody:function(e,t,r,i){var n=r||[],i=i||[],o=e.createElement("tbody");if(this.getShowOperCol())var s=this.getOperWidgetDefinitions();for(var l=!0,d=0,u=i.length;d<u;++d){var c=e.createElement("tr");c.className=l?a.DATATABLE_ROW_ODD:a.DATATABLE_ROW_EVEN,l=!l;var h=i[d]||{};c[this.ROWDATA_FIELD]=h;for(var m=0,g=n.length;m<g;++m){var f=n[m],p=f.name,C=h[p],b=e.createElement("td");f.className&&(b.className=f.className),f.style&&(b.style.cssText=f.style);var E=this.doCreateDataTableCellWrapper(e,b);if(f.isOperCol){var N={rowData:h,rowIndex:d,colIndex:m,childWidgetDefinitions:s},T=this.doCreateOperCellContent(E,N);c[this.ROW_OPER_TOOLBAR_FIELD]=T}else if(f.isCheckCol){var N={rowData:h,rowIndex:d,colIndex:m},O=this.doCreateCheckCellContent(E,N);c[this.ROW_CHECKBOX_FIELD]=O}else{var N={rowData:h,cellKey:p,cellValue:C,rowIndex:d,colIndex:m};this.doCreateDataCellContent(E,N)}b.appendChild(E),c.appendChild(b)}o.appendChild(c)}return t.appendChild(o),o},doCreateDataCellContent:function(r,i){var n="";e.ObjUtils.notUnset(i.cellValue)&&(n=""+i.cellValue),t.setElementText(r,n)},doCreateCheckCellContent:function(t,r){var i=new e.Widget.CheckBox(this);return i.appendToElem(t),i},doCreateOperCellContent:function(t,r){var i=this.doCreateOperToolbar(t,r.childWidgetDefinitions),n=e.Widget.DataTable.OperColShowMode;return this.getOperColShowMode()!==n.ALL&&i.setVisible(!1),i},doCreateOperToolbar:function(t,r){var i=new e.Widget.ButtonGroup(this);return i.setChildDefs(r),i.appendToElem(t),i},getDefaultOperButtons:function(){var t=e.Widget.DataTable.Components;return[t.EDIT,t.DELETE]},getOperWidgetDefinitions:function(){for(var e=[],t=this.getOperWidgets()||this.getDefaultOperButtons(),r=0,i=t.length;r<i;++r){var a=t[r];if(n.isObjectValue(a))e.push(a);else{var o=this.getDefaultComponentDefinitionHash(a);o&&e.push(o)}}return e},getDefaultComponentDefinitionHash:function(t){var r,i=e.Widget.DataTable.Components;return t===i.EDIT?r={widget:"Kekule.Widget.Button",htmlClass:a.DATATABLE_EDIT,text:e.$L("WidgetTexts.CAPTION_DATATABLE_EDIT"),hint:e.$L("WidgetTexts.HINT_DATATABLE_EDIT"),"#execute":this.reactOperEditBind}:t===i.DELETE?r={widget:"Kekule.Widget.Button",htmlClass:a.DATATABLE_DELETE,text:e.$L("WidgetTexts.CAPTION_DATATABLE_DELETE"),hint:e.$L("WidgetTexts.HINT_DATATABLE_DELETE"),"#execute":this.reactOperDeleteBind}:t===i.INSERT&&(r={widget:"Kekule.Widget.Button",htmlClass:a.DATATABLE_INSERT,text:e.$L("WidgetTexts.CAPTION_DATATABLE_INSERT"),hint:e.$L("WidgetTexts.HINT_DATATABLE_INSERT"),"#execute":this.reactOperInsertBind}),r&&(r.internalName=t),r},hasExternalDataProvider:function(){return!!this.getDataPager()},needSort:function(){return this.getSortFields()||this.getSortFunc()},sortData:function(){var t=this.getData()||[];if(this.needSort()&&!this.hasExternalDataProvider()){var r=e.ArrayUtils.clone(t);return e.ArrayUtils.sortHashArray(r,this.getSortFields()),r}return t},prepareData:function(){var t={},r=this.sortData();t.data=r;var i=function(t){for(var r=[],i=0,n=t.length;i<n;++i){var a=e.ObjUtils.getOwnedFieldNames(t[i]);e.ArrayUtils.pushUnique(r,a)}for(var o=[],i=0,n=r.length;i<n;++i)o.push({name:r[i],text:r[i]});return o};this.getColumns()?t.columns=e.ArrayUtils.clone(this.getColumns()):t.columns=i(r);for(var n=0;n<t.columns.length;){var o=t.columns[n];if("string"==typeof o&&(o={name:o}),o.name===this.COLNAME_OPER)t.columns[n]={name:"",text:"",disableInteract:!0,isOperCol:!0,colClassName:a.DATATABLE_OPER_COL,className:a.DATATABLE_OPER_CELL};else if(o.name===this.COLNAME_CHECK)t.columns[n]={name:"",text:"",disableInteract:!0,isCheckCol:!0,colClassName:a.DATATABLE_CHECK_COL,className:a.DATATABLE_CHECK_CELL};else if(o.name===this.COLNAME_ALL){var s=i(r),l=s;l.unshift(1),l.unshift(n),t.columns.splice.apply(t.columns,l)}else o.colClassName=a.DATATABLE_DATA_COL+" "+(o.colClassName||""),o.className=a.DATATABLE_DATA_CELL+" "+(o.className||"");++n}if(this.needSort()&&!this.getSortFunc())for(var d=this.getSortFields(),n=0,u=t.columns.length;n<u;++n){var c=t.columns[n],h=c.name;d.indexOf(h)>=0?t.columns[n].sorting=1:d.indexOf(this.PREFIX_SORT_DESC+h)>=0?t.columns[n].sorting=-1:t.columns[n].sorting=0}return t},activeRowChanged:function(t,i){var n=e.Widget.DataTable.OperColShowMode,o=this.getOperColShowMode();t&&(r.removeClass(t,a.STATE_ACTIVE),o!==n.ACTIVE&&o!==n.HOVER||this.hideRowOperToolbar(t)),i&&(r.addClass(i,a.STATE_ACTIVE),o!==n.ACTIVE&&o!==n.HOVER||this.showRowOperToolbar(i))},hoverRowChanged:function(t,i){var n=e.Widget.DataTable.OperColShowMode,o=this.getOperColShowMode();t&&(r.removeClass(t,a.STATE_HOVER),o===n.HOVER&&t!==this.getActiveRow()&&this.hideRowOperToolbar(t)),i&&(r.addClass(i,a.STATE_HOVER),o===n.HOVER&&this.showRowOperToolbar(i))},getParentCell:function(e){return t.isDescendantOf(e,this.getElement())?t.getNearestAncestorByTagName(e,"td",!0):null},getParentHeadCell:function(e){return t.isDescendantOf(e,this.getElement())?t.getNearestAncestorByTagName(e,"th",!0):null},getParentRow:function(e){return t.isDescendantOf(e,this.getElement())?t.getNearestAncestorByTagName(e,"tr",!0):null},getColCount:function(){return(this.getColumns()||[]).length},getRowCount:function(){return(this.getData()||[]).length},getDataRows:function(){var e=this.getElement().getElementsByTagName("tbody")[0];return e&&e.getElementsByTagName("tr")},getCheckedRows:function(){for(var e=[],t=this.getDataRows(),r=0,i=t.length;r<i;++r)this.isRowChecked(t[r])&&e.push(t[r]);return e},getRowData:function(e){return e?e[this.ROWDATA_FIELD]:null},isRowChecked:function(e){var t=this.getRowCheckBox(e);return t&&t.getChecked&&t.getChecked()},getRowCheckBox:function(e){return e&&e[this.ROW_CHECKBOX_FIELD]},getRowOperToolbar:function(e){return e?e[this.ROW_OPER_TOOLBAR_FIELD]:null},showRowOperToolbar:function(e){var t=this.getRowOperToolbar(e);t&&t.setVisible(!0)},hideRowOperToolbar:function(e){var t=this.getRowOperToolbar(e);t&&t.setVisible(!1)},dataPagerChanged:function(e,t){t&&(t.removeEventListener("pageRetrieve",this.reactPagerRetrieve,this),t.removeEventListener("dataFetched",this.reactPagerFetched,this),t.removeEventListener("dataError",this.reactPagerError,this)),e&&(e.addEventListener("pageRetrieve",this.reactPagerRetrieve,this),e.addEventListener("dataFetched",this.reactPagerFetched,this),e.addEventListener("dataError",this.reactPagerError,this),this.setData(e.getCurrPageData()))},reactPagerRetrieve:function(t){this.reportMessage&&(this._loadingDataMsg=this.reportMessage(e.$L("WidgetTexts.MSG_RETRIEVING_DATA"),e.Widget.MsgType.INFO))},reactPagerFetched:function(e){this.setData(e.data),this._loadingDataMsg&&this.removeMessage&&this.removeMessage(this._loadingDataMsg)},reactPagerError:function(t){this._loadingDataMsg&&this.removeMessage&&this.removeMessage(this._loadingDataMsg),this.flashMessage&&this.flashMessage(t.error.message||t.error,e.Widget.MsgType.ERROR)},reactOperEdit:function(e){return this.reactOperExecute(s.EDIT,e)},reactOperDelete:function(e){return this.reactOperExecute(s.DELETE,e)},reactOperInsert:function(e){return this.reactOperExecute(s.INSERT,e)},reactOperExecute:function(e,t){var r=t.target,i=this.getParentRow(r.getElement()),n=this.getRowData(i);return this.doReactOperExecute(e,n,i,t)},doReactOperExecute:function(e,t,r,i){},react_click:function($super,e){$super(e);var t=e.getTarget(),r=this.getParentHeadCell(t);if(r)this._autoSortOnHeadCell(r);else if(this.getEnableActiveRow()){var i=this.getParentCell(t);i&&this.setActiveCell(i)}},react_pointerover:function($super,e){$super(e);var t=e.getTarget();if(this.getEnableActiveRow()){var r=this.getParentCell(t);r?this.setHoverCell(r):this.setHoverCell(null)}},react_pointerleave:function($super,e){$super(e);e.getTarget();this.getEnableActiveRow()&&this.setHoverCell(null)},_autoSortOnHeadCell:function(e){if(e&&this.getEnableHeadInteraction()){var t=e[this.COLDEF_FIELD];if(t&&!t.disableInteract){var r=t.name;1===t.sorting&&(r=this.PREFIX_SORT_DESC+r),this.setSortFields([r])}}},load:function(t,r,i,n){this.beginUpdate();try{this.setData(t),this.setColumns(r),this.setSortFields(i?e.ArrayUtils.toArray(i):null),this.setSortFunc(n)}finally{this.endUpdate()}return this},reload:function(){return this.recreateChildContent(),this}}),e.Widget.DataTable.OperColShowMode={NONE:"none",ACTIVE:"active",HOVER:"hover",ALL:"all"},e.Widget.DataTable.Components={EDIT:"edit",DELETE:"delete",INSERT:"insert"};var s=e.Widget.DataTable.Components;e.Widget.PageNavigator=i.create(e.Widget.ButtonGroup,{CLASS_NAME:"Kekule.Widget.PageNavigator",initProperties:function(){this.defineProp("components",{dataType:n.ARRAY}),this.defineProp("firstIndex",{dataType:n.INT}),this.defineProp("lastIndex",{dataType:n.INT}),this.defineProp("currIndex",{dataType:n.INT}),this.defineProp("dataPager",{dataType:"Kekule.Widget.DataPager",setter:function(e){var t=this.getDataPager();t!==e&&(this.setPropStoreFieldValue("dataPager",e),this.dataPagerChanged(e,t))}})},initPropValues:function($super){$super(),this.setShowText(!0),this.setShowGlyph(!0),this.setFirstIndex(1),this.reactFirstBind=this.reactFirst.bind(this),this.reactLastBind=this.reactLast.bind(this),this.reactPrevBind=this.reactPrev.bind(this),this.reactNextBind=this.reactNext.bind(this),this.reactPageInputChangeBind=this.reactPageInputChange.bind(this)},doObjectChange:function($super,t){$super(t),e.ArrayUtils.intersect(t,["firstIndex","lastIndex","currIndex"]).length&&this.updateChildComponent(),t.indexOf("currIndex")>=0&&this.invokeEvent("pageChange",{currIndex:this.getCurrIndex()})},doGetWidgetClassName:function($super){return $super()+" "+a.PAGENAVIGATOR},doCreateSubElements:function(e,t){return this.recreateChildContent(e,t)},getDefaultComponents:function(){return[l.FIRST,l.PREV,l.PAGESELECTOR,l.NEXT,l.LAST]},recreateChildContent:function(){for(var e=this.getComponents()||this.getDefaultComponents(),t=[],r=0,i=e.length;r<i;++r){var a=e[r];if(n.isObjectValue(a))t.push(a);else{var o=this.getDefaultComponentDefinitionHash(a);o&&t.push(o)}}this.setChildDefs(t),this.updateChildComponent()},getDefaultComponentDefinitionHash:function(t){var r;return r=t===l.FIRST?{widget:"Kekule.Widget.Button",htmlClass:a.PAGENAVIGATOR_FIRST,text:e.$L("WidgetTexts.CAPTION_FIRST_PAGE"),hint:e.$L("WidgetTexts.HINT_FIRST_PAGE"),"#execute":this.reactFirstBind}:t===l.LAST?{widget:"Kekule.Widget.Button",htmlClass:a.PAGENAVIGATOR_LAST,text:e.$L("WidgetTexts.CAPTION_LAST_PAGE"),hint:e.$L("WidgetTexts.HINT_LAST_PAGE"),"#execute":this.reactLastBind}:t===l.PREV?{widget:"Kekule.Widget.Button",htmlClass:a.PAGENAVIGATOR_PREV,text:e.$L("WidgetTexts.CAPTION_PREV_PAGE"),hint:e.$L("WidgetTexts.HINT_PREV_PAGE"),"#execute":this.reactPrevBind}:t===l.NEXT?{widget:"Kekule.Widget.Button",htmlClass:a.PAGENAVIGATOR_NEXT,text:e.$L("WidgetTexts.CAPTION_NEXT_PAGE"),hint:e.$L("WidgetTexts.HINT_NEXT_PAGE"),"#execute":this.reactNextBind}:t===l.PAGEINPUT?{widget:"Kekule.Widget.TextBox",htmlClass:[a.PAGENAVIGATOR_PAGEINPUT,a.PAGENAVIGATOR_PAGEINDEXER],hint:e.$L("WidgetTexts.HINT_CURR_PAGE"),"#valueChange":this.reactPageInputChangeBind}:t===l.PAGESELECTOR?{widget:"Kekule.Widget.SelectBox",htmlClass:[a.PAGENAVIGATOR_PAGESELECTOR,a.PAGENAVIGATOR_PAGEINDEXER],hint:e.$L("WidgetTexts.HINT_CURR_PAGE"),"#valueChange":this.reactPageInputChangeBind}:null,r&&(r.internalName=t),r},getComponent:function(e){return this.getChildWidgetByInternalName(e)},setChildComponentEnabled:function(e,t){var r=this.getComponent(e);r&&r.setEnabled(t)},updateChildComponent:function(){var e=this.getFirstIndex()||0,t=this.getLastIndex()||0,r=this.getCurrIndex()||0,i=r<=e,n=r>=t;this.setChildComponentEnabled(l.FIRST,!i),this.setChildComponentEnabled(l.PREV,!i),this.setChildComponentEnabled(l.NEXT,!n),this.setChildComponentEnabled(l.LAST,!n),this.setChildComponentEnabled(l.PAGEINPUT,t>e),this.setChildComponentEnabled(l.PAGESELECTOR,t>e);var a=this.getComponent(l.PAGEINPUT);a&&a.setValue(r);var o=this.getComponent(l.PAGESELECTOR);if(o){for(var s=[],d=e;d<=t;++d)s.push({value:d});o.setItems(s),o.setValue(r)}},dataPagerChanged:function(e,t){t&&(t.removeEventListener("dataFetched",this.reactPagerFetched,this),e.removeEventListener("pageCountChange",this.reactPagerPageCountChange,this)),e&&(e.addEventListener("dataFetched",this.reactPagerFetched,this),e.addEventListener("pageCountChange",this.reactPagerPageCountChange,this),this.updatePageDetails(e),this.setCurrIndex(e.getCurrPageIndex()+this.getFirstIndex()))},reactPagerFetched:function(e){this.setCurrIndex(e.pageIndex+this.getFirstIndex())},reactPagerPageCountChange:function(e){this.updatePageDetails(this.getDataPager())},updatePageDetails:function(e){var t=this.getFirstIndex();this.setLastIndex(e.getPageCount()+t-1)},requestChangeCurrIndex:function(e){var t=this.getDataPager();t?t.switchToPage(e-this.getFirstIndex()):this.setCurrIndex(e)},reactFirst:function(e){this.requestChangeCurrIndex(this.getFirstIndex()||0)},reactLast:function(e){this.requestChangeCurrIndex(this.getLastIndex()||0)},reactPrev:function(e){var t=this.getFirstIndex()||0,r=this.getCurrIndex()||0;this.requestChangeCurrIndex(Math.max(r-1,t))},reactNext:function(e){var t=this.getLastIndex()||0,r=this.getCurrIndex()||0;this.requestChangeCurrIndex(Math.min(r+1,t))},reactPageInputChange:function(t){var r=t.target.getValue();"string"==typeof r&&(r=parseInt(r));var i=this.getFirstIndex()||0,n=this.getLastIndex()||0;r>=i&&r<=n?this.requestChangeCurrIndex(r):e.error(e.$L("ErrorMsg.PAGE_INDEX_OUTOF_RANGE"))}}),e.Widget.PageNavigator.Components={FIRST:"first",LAST:"last",PREV:"prev",NEXT:"next",PAGEINPUT:"pageInput",PAGESELECTOR:"pageSelector"};var l=e.Widget.PageNavigator.Components;return e}},function(e,t,r){"use strict";var i=r(0).Class,n=(r(0).ClassEx,r(0).ObjectEx,r(0).DataType);e.exports=function(e){var t=(e.HtmlElementUtils,e.Widget.HtmlClassNames);return e.Widget.HtmlClassNames=Object.extend(e.Widget.HtmlClassNames,{SYSMSGGROUP:"K-SysMsgGroup"}),e.Widget.SysMsgGroup=i.create(e.Widget.MsgGroup,{CLASS_NAME:"Kekule.Widget.SysMsgGroup",initialize:function($super,e){$super(e)},initPropValues:function($super){$super(),this.setMaxMsgCount(6)},doGetWidgetClassName:function($super){return $super()+" "+t.SYSMSGGROUP}}),e.Widget.ExceptionHandler=i.create(e.ExceptionHandler,{CLASS_NAME:"Kekule.Widget.ExceptionHandler",initProperties:function(){this.defineProp("document",{dataType:n.OBJECT,serializable:!1,getter:function(){return this.getPropStoreFieldValue("document")||document}}),this.defineProp("sysMsgGroup",{dataType:"Kekule.Widget.SysMsgGroup",serializable:!1,setter:null,getter:function(){var t=this.getPropStoreFieldValue("sysMsgGroup");if(!t){t=new e.Widget.SysMsgGroup(this.getDocument());var r=t.getGlobalManager();t.appendToElem(r.getDefaultContextRootElem()),this.setPropStoreFieldValue("sysMsgGroup",t)}return t}})},throwException:function($super,t,r){var i=e.ExceptionLevel,n=e.Widget.MsgType;r||(r=i.ERROR);var a;if(a="string"==typeof t?t:t.message){var o=r!==i.ERROR&&r?r===i.WARNING?n.WARNING:r===i.NOTE?n.INFO:n.NORMAL:n.ERROR;this.getSysMsgGroup().addMessage(a,o)}return $super(t,r)}}),e.ClassUtils.makeSingleton(e.Widget.ExceptionHandler),e.X.domReady(function(){e.exceptionHandler=e.Widget.ExceptionHandler.getInstance()}),e}},function(e,t,r){"use strict";var i=r(0).Class,n=(r(0).ClassEx,r(0).ObjectEx,r(0).DataType);e.exports=function(e){var t=e.Widget.HtmlClassNames;return e.Widget.HtmlClassNames=Object.extend(e.Widget.HtmlClassNames,{OPER_HISTORY_TREE_VIEW:"K-OperHistory-TreeView"}),e.Widget.OperHistoryTreeView=i.create(e.Widget.TreeView,{CLASS_NAME:"Kekule.Widget.OperHistoryTreeView",initialize:function($super,t,r){$super(t),this.setPropStoreFieldValue("objMap",new e.MapEx(!0)),this.setEnableLiveUpdate(!0),this.setEnableMultiSelected(!0),this.setOperHistory(r)},initProperties:function(){this.defineProp("operHistory",{dataType:"Kekule.OperationHistory",serializable:!1,setter:function(e){var t=this.getPropStoreFieldValue("operHistory");this.setPropStoreFieldValue("operHistory",e),this.operHistoryChanged(e,t)}}),this.defineProp("enableLiveUpdate",{dataType:n.BOOL}),this.defineProp("objMap",{dataType:"Kekule.MapEx",setter:null,serializable:!1})},doGetWidgetClassName:function($super){return $super()+" "+t.OPER_HISTORY_TREE_VIEW},operHistoryChanged:function(e,t){this.clearChildItems(),this.getObjMap().clear(),t&&this._uninstallRootEventHandler(t),e&&(this._fillTree(e),this._installRootEventHandler(e))},_installRootEventHandler:function(e){e.addEventListener("operChange",this.reactOperChange,this)},_uninstallRootEventHandler:function(e){e.removeEventListener("operChange",this.reactOperChange,this)},reactOperChange:function(e){if(this.getEnableLiveUpdate()){e.target;this._fillTree(e.target)}},_fillTree:function(e){if(e){this.clearChildItems(),this._updateTreeItem(this.appendChildItem(),e);var t=e.getCurrOperation(),r=t?this.getObjMap().get(t):null;this.select(r)}},_getOperChildCount:function(t){return t instanceof e.OperationHistory?t.getOperationCount():t instanceof e.MacroOperation?t.getChildCount():0},_getChildOperAt:function(t,r){return t instanceof e.OperationHistory?t.getOperationAt(r):t instanceof e.MacroOperation?t.getChildAt(r):null},_updateTreeItem:function(e,t){var r=this._getOperDisplayTitle(t),i={text:r,obj:t};this.setItemData(e,i),this.getObjMap().set(t,e);for(var n=this.getChildItemCount(e),a=this._getOperChildCount(t),o=0;o<a;++o){var s,l=this._getChildOperAt(t,o);s=o<n?this.getChildItemAt(e,o):this.appendChildItem(e),this._updateTreeItem(s,l)}if(n>a)for(var o=n-1;o>=a;--o)this.removeChildItemAt(e,o)},_getOperDisplayTitle:function(e){var t=e.getClassName(),r=e.getTarget?e.getTarget():null;return r&&r.getId&&(t+="(target: "+r.getId()+")"),t}}),e}},function(e,t,r){"use strict";var i=r(0).Class,n=r(0).ClassEx,a=r(0).ObjectEx,o=r(0).DataType;e.exports=function(e){var t=e.ArrayUtils;return e.GraphElement=i.create(a,{CLASS_NAME:"Kekule.GraphElement",initialize:function($super){$super(),this._data={}},initProperties:function(){this.defineProp("storedData",{dataType:o.HASH,getter:function(){return this._data},setter:function(e){this._data=e||{}}})},getData:function(e){return e?this._data[e]:this._data},setData:function(e,t){return e&&(this._data[e]=t),this},removeData:function(e){return this._data[e]&&delete this._data[e],this}}),e.GraphVertex=i.create(e.GraphElement,{CLASS_NAME:"Kekule.GraphVertex",initialize:function($super){$super(),this.setPropStoreFieldValue("edges",[])},initProperties:function(){this.defineProp("edges",{dataType:o.ARRAY,serializable:!1,setter:null})},getEdgeCount:function(){return this.getEdges().length},getNeighbors:function(){for(var e=[],r=this.getEdges(),i=0,n=r.length;i<n;++i){var a=r[i].getVertexes();t.pushUnique(e,t.exclude(a,this))}return e},getNeighborOnEdge:function(e){for(var t=e.getVertexes(),r=0,i=t.length;r<i;++r)if(t[r]!==this)return t[r]},getEdgeTo:function(e){for(var t=this.getEdges(),r=0,i=t.length;r<i;++r){if(t[r].getVertexes().indexOf(e)>=0)return t[r]}return null},doAppendEdge:function(t){return e.ArrayUtils.pushUnique(this.getEdges(),t),this},doRemoveEdge:function(t){return e.ArrayUtils.remove(this.getEdges(),t),this},doClearEdges:function(){for(var e=this.getEdges(),t=e.length-1;t>=0;--t)this.removeEdge(e[t]);return this}}),e.GraphEdge=i.create(e.GraphElement,{CLASS_NAME:"Kekule.GraphEdge",initialize:function($super){this.setPropStoreFieldValue("weight",1),$super(),this.setPropStoreFieldValue("vertexes",[])},initProperties:function(){this.defineProp("vertexes",{dataType:o.ARRAY,serializable:!1,setter:null}),this.defineProp("weight",{dataType:o.NUMBER})},replaceVertex:function(e,t){var r=this.getVertexes(),i=r.indexOf(e),n=r.indexOf(t);i<0||n>=0||(r.splice(i,1,t),e.doRemoveEdge(this),t.doAppendEdge(this))}}),e.GraphTraverseMode={DEPTH_FIRST:0,BREADTH_FIRST:1},e.Graph=i.create(a,{CLASS_NAME:"Kekule.Graph",VISITED_KEY:"__$visited__",initialize:function($super){$super(),this.setPropStoreFieldValue("vertexes",[]),this.setPropStoreFieldValue("edges",[])},initProperties:function(){this.defineProp("vertexes",{dataType:o.ARRAY,serializable:!1,setter:null}),this.defineProp("edges",{dataType:o.ARRAY,serializable:!1,setter:null})},addVertex:function(t){return e.ArrayUtils.pushUnique(this.getVertexes(),t),this},newVertex:function(){var t=new e.GraphVertex;return this.addVertex(t),t},removeVertex:function(t){if(e.ArrayUtils.remove(this.getVertexes(),t))for(var r=e.ArrayUtils.clone(t.getEdges()),i=0,n=r.length;i<n;++i)this.removeEdge(r[i])},addEdge:function(t,r,i){return e.ArrayUtils.pushUnique(this.getEdges(),t)&&(t.setPropStoreFieldValue("vertexes",[r,i]),r.doAppendEdge(t),i.doAppendEdge(t)),this},newEdge:function(t,r){var i=new e.GraphEdge;return this.addEdge(i,t,r),i},removeEdge:function(t){for(var r=t.getVertexes(),i=0,n=r.length;i<n;++i){r[i].doRemoveEdge(t)}return e.ArrayUtils.remove(this.getEdges(),t),this},traverse:function(e,r,i){for(var n=[],a=t.clone(this.getVertexes()),o=0,s=a.length;o<s;++o)a[o].setData(this.VISITED_KEY,!1);for(;a.length;){var l,d={vertexes:[],edges:[]};l=i&&a.indexOf(i)>=0?i:a[0];var u=this._doTravers(e,r,l);d.vertexes=d.vertexes.concat(u.vertexes),d.edges=d.edges.concat(u.edges),a=t.exclude(a,u.vertexes),n.push(d)}return n},_doTravers:function(t,r,i){var n={vertexes:[],edges:[]},a=i;a.getData(this.VISITED_KEY)||(n.vertexes.push(a),a.setData(this.VISITED_KEY,!0),t&&t(a,!1));for(var o=a.getEdges(),s=[],l=r===e.GraphTraverseMode.BREADTH_FIRST,d=0,u=o.length;d<u;++d){var c=o[d],h=a.getNeighborOnEdge(c);if(!h.getData(this.VISITED_KEY))if(n.vertexes.push(h),n.edges.push(c),h.setData(this.VISITED_KEY,!0),t&&(t(c,!0),t(h,!1)),l)s.push(h);else{var m=this._doTravers(t,r,h);n.vertexes=n.vertexes.concat(m.vertexes),n.edges=n.edges.concat(m.edges)}}if(l)for(var d=0,u=s.length;d<u;++d){var g=s[d],m=this._doTravers(t,r,g);n.vertexes=n.vertexes.concat(m.vertexes),n.edges=n.edges.concat(m.edges)}return n}}),e.globalOptions.add("algorithm.molToGraph",{expandSubStructures:!0,ignoreBondedHydrogen:!0}),e.GraphAdaptUtils={ctabToGraph:function(t,r,i){var a=Object.extend(Object.extend({},e.globalOptions.algorithm.molToGraph),i||{}),o=t,s=e.ArrayUtils,l=null,d=a.expandSubStructures;if(o){for(var u=a.nodeFilter||function(e,t){if(a.nodeClasses){var r=e.getClass();if(!n.isOrIsDescendantOfClasses(r,a.nodeClasses))return!1}if(a.ignoreBondedHydrogen&&e.isHydrogenAtom&&e.isHydrogenAtom()){var i=e.getLinkedConnectors();if(t&&(i=s.intersect(i,t)),i.length<=1)return!1}return!0},c=a.connectorFilter||function(e,t){if(a.connectorClasses){var r=e.getClass();if(!n.isOrIsDescendantOfClasses(r,a.connectorClasses))return!1}return!(e.getBondType&&a.bondTypes&&a.bondTypes.indexOf(e.getBondType())<0)},l=r||new e.Graph,h=d?o.getAllContainingConnectors():o.getConnectors(),m=d?o.getLeafNodes():o.getNodes(),g=[],f=new e.MapEx,p=0,C=h.length;p<C;++p){var b=h[p];if(c(b))for(var E=[],N=d?b.getConnectedObjs():b.getConnectedSiblings(),T=0,O=N.length;T<O;++T){var _=N[T];if(m.indexOf(_)>=0&&(u(_,h)?E.push(_):s.pushUnique(g,_),E.length>=2)){for(var S=s.exclude(E,g),v=0,y=S.length;v<y;++v){var A=l.newVertex();A.setData("object",S[v]),f.set(S[v],A)}var M=l.newEdge(f.get(E[0]),f.get(E[1]));M.setData("object",b),s.pushUnique(g,E);break}}}for(var I=s.exclude(m,g),p=0,C=I.length;p<C;++p){var R=I[p];if(u(R,h)){var A=l.newVertex();A.setData("object",R)}}f.finalize()}return l},molToGraph:function(t,r,i){e.ArrayUtils;if(!t||!t.hasCtab())return null;var n=t.getCtab();return n?e.GraphAdaptUtils.ctabToGraph(n,r,i):null},chemObjToGraph:function(t,r,i){for(var n=e.ChemStructureUtils.getAllStructFragments(t,!0),a=r||new e.Graph,o=0,s=n.length;o<s;++o)e.GraphAdaptUtils.molToGraph(n[o],a,i);return a}},e.GraphAlgorithmUtils={SEQ_KEY:"__$seq__",RESD_DEGREE_KEY:"__$resdDegree__",VISIT_EDGE_DEGREE_KEY:"__$visitedEdgeDegree__",TYPE_KEY:"__$type__",TYPE_CYCLE:"cycle",TYPE_BRIDGE:"bridge",VISITED_KEY:"__$visited",createSpanningTrees:function(e,t){return e.traverse(null,t)},calcMinDistances:function(e,t){var r,i,n=e.getVertexes();o.isSimpleValue(t)?(i=t,r=n[i]):(r=t,i=n.indexOf(r));for(var a=[],s=[],l=0,d=n.length;l<d;++l){var u=n[l];if(l===i)a[l]=0,s[l]=r;else{var c=r.getEdgeTo(u);c?(a[l]=c.getWeight(),s[l]=r):(a[l]=1/0,s[l]=null)}}for(var h=[i],l=0,d=n.length;l<d;++l)if(l!==i){for(var m,g=1/0,f=-1,p=0,C=n.length;p<C;++p)p!==i&&h.indexOf(p)<0&&a[p]<g&&(g=a[p],f=p,m=n[p]);h.push(f);for(var p=0,C=n.length;p<C;++p)if(h.indexOf(p)<0){var c=m.getEdgeTo(n[p]),b=c?c.getWeight():1/0,E=g+b;E<a[p]&&(a[p]=E)}}return a},findCycleBlocks:function(r){for(var i=[],n=e.GraphAlgorithmUtils,a=n.SEQ_KEY,o=n.RESD_DEGREE_KEY,s=n.VISIT_EDGE_DEGREE_KEY,l=n.TYPE_KEY,d=n.TYPE_CYCLE,u=n.TYPE_BRIDGE,c=r.getEdges(),h=0,m=c.length;h<m;++h)c[h].removeData(a);for(var g=r.getVertexes(),h=0,m=g.length;h<m;++h)g[h].removeData(l);for(var f=1,p=1,C=[],b=[],E=[],h=(r.traverse(function(e,t){t?(e.setData(a,f),b.push(e),++f):(e.setData(a,p),++p,C.push(e))}),0),m=C.length;h<m;++h){var N=C[h],T=N.getEdges();N.setData(o,T.length);for(var O=0,_=0,S=T.length;_<S;++_){T[_].getData(a)&&++O}N.setData(s,O),O<T.length&&E.push(N)}for(var v=function(e,t){if(t&&e.getData(a)<=1)return null;for(var r=e.getEdges(),i=null,n=null,o=0,s=r.length;o<s;++o){var l=r[o].getData(a);l&&(n?l<n&&(i=r[o],n=l):(i=r[o],n=l))}return i||null},y=function(e){for(var t=e.getEdges(),r=0,i=t.length;r<i;++r)if(!t[r].getData(a)&&!t[r].getData(l))return t[r];return null},A=C.shift();A;){if(A.getData(l));else{var M=A.getData(s);if(A.getData(o)-M>0){var I=function e(r){var i=[],n=[],a=r.getData(s),u=r.getData(o),c=u-a;if(c>0){r.setData(l,d),t.pushUnique(i,r);for(var h=0;h<c;++h){r.setData(o,u+1);var m=y(r);if(m){m.setData(l,d),t.pushUnique(n,m);var g=r.getNeighborOnEdge(m);for(g.setData(o,g.getData(o)+1),g.setData(l,d),t.pushUnique(i,g);;){var a=g.getData(s),u=g.getData(o);if(a<u){var f=e(g);t.pushUnique(i,f.vertexes),t.pushUnique(n,f.edges)}var p=v(g,!1);if(!p)break;p.setData(l,d),t.pushUnique(n,p);var C=g.getNeighborOnEdge(p);if(C.getData(l))break;C.setData(l,d),t.pushUnique(i,C),g=C}}}}return{vertexes:i,edges:n}}(A);i.push(I)}else{A.setData(l,u);var R=v(A,!0);R&&R.setData(l,u)}}A=C.shift()}return i},findEndChains:function(t){for(var r=e.ArrayUtils,i={vertexes:[],edges:[]},n=r.clone(t.getVertexes()),a=[],o=0,s=n.length;o<s;++o){var l=n[o],d=l.getEdgeCount();l.setData("__$currConnectivity__",d),d<=1&&a.push(l)}if(a.length){var u=a.pop();for(r.remove(n,u),i.vertexes.push(u);n.length;){var c=!1,h=r.exclude(u.getEdges(),i.edges);if(h.length){i.edges=i.edges.concat(h);var m=u.getNeighborOnEdge(h[0]),d=m.getData("__$currConnectivity__")-1;m.setData("__$currConnectivity__",d),d<=1&&(u=m,r.remove(n,u),i.vertexes.push(u),c=!0)}if(!c){if(!a.length)break;var u=a.pop();r.remove(n,u),i.vertexes.push(u)}}}return i},removeEndChains:function(t){for(var r=e.GraphAlgorithmUtils.findEndChains(t),i=0,n=r.vertexes.length;i<n;++i)t.removeVertex(r.vertexes[i]);return r},findBridgeChains:function(r){for(var i=r.getVertexes(),n=r.getEdges(),a=e.GraphAlgorithmUtils.findCycleBlocks(r),o=0,s=a.length;o<s;++o)i=t.exclude(i,a[o].vertexes),n=t.exclude(n,a[o].edges);return{vertexes:i,edges:n}},removeBridgeChains:function(t){for(var r=e.GraphAlgorithmUtils.findBridgeChains(t),i=0,n=r.vertexes.length;i<n;++i)t.removeVertex(r.vertexes[i]);return r},findAllRings:function(r){var i,n=e.GraphAlgorithmUtils,a=[];i=r instanceof e.Graph?n.findCycleBlocks(r):[r];for(var o=function(e,t){var r=e.vertexes,i=r.length;return i&&(r[0]===t||r[i-1]===t)},s=function(e,r,i){var n=t.clone(e.vertexes),a=t.clone(r.vertexes);return n.shift(),n.pop(),a.shift(),a.pop(),t.intersect(n,a).length>=1},l=function(e,r,i){var n=t.clone(e.vertexes),a=t.clone(r.vertexes),o=t.clone(e.edges),s=t.clone(r.edges);n[0]===i&&(n.reverse(),o.reverse()),a[a.length-1]===i&&(a.reverse(),s.reverse()),n.pop();var l=n.concat(a),d=o.concat(s);return{vertexCount:e.vertexCount+r.vertexCount-1,vertexes:l,edges:d}},d=0,u=i.length;d<u;++d){var c=i[d];if(function(e){return e.vertexes.length===e.edges.length}(c))a.push({vertexes:t.clone(c.vertexes),edges:t.clone(c.edges)});else for(var h=function(e){for(var r=[],i=t.clone(e.vertexes),n=e.edges,a=0,d=i.length;a<d;++a){var u=i[a],c=t.intersect(u.getEdges(),n);u.setData("__$vertextPartDegree__",c.length)}i.sort(function(e,t){return e.getData("__$vertextPartDegree__")-t.getData("__$vertextPartDegree__")});for(var h=[],a=0,d=e.edges.length;a<d;++a){var m=e.edges[a],g=m.getVertexes();h.push({vertexCount:g.length,vertexes:[g[0],g[1]],edges:[m]})}for(;i.length;)for(var f=i.shift(),p=null,a=h.length-1;a>=0;--a){var C=h[a];if(o(C,f)){p=C;for(var b=a-1;b>=0;--b){var C=h[b];if(o(C,f)&&!s(p,C)){var E=l(p,C,f),N=E.vertexes;N[0]===N[N.length-1]?(N.pop(),r.push(E)):h.push(E)}}h.splice(a,1)}}return r}(c),m=0,g=h.length;m<g;++m){var f=h[m];a.push({vertexes:t.clone(f.vertexes),edges:t.clone(f.edges)})}}return a},findSSSR:function(r,i){var n,a=e.GraphAlgorithmUtils,o=[];r instanceof e.Graph?(n=a.findCycleBlocks(r),i=null):n=[r];for(var s=0,l=n.length;s<l;++s){var d=n[s],u=function(r,i){var n=[],o=r.edges.length-r.vertexes.length+1;if(o<=0)return[];var s=i?t.clone(i):a.findAllRings(r);s.sort(function(e,t){return e.vertexes.length-t.vertexes.length});var l,d=function(e){n.push(e)},u=[],c=e.RingVectorUtils;c.prepareConvertRingToVector(r);var h=s.shift();for(d(h),l=c.convertRingToVector(h,r),u.push(l);n.length<o&&s.length;)h=s.shift(),l=c.convertRingToVector(h,r),c.isLinearDependant(l,u)||(u.push(l),d(h));return n}(d,i);o=o.concat(u)}return o},analysisRings:function(t){var r,i=e.GraphAlgorithmUtils,n=[];r=t instanceof e.Graph?i.findCycleBlocks(t):[t];for(var a=0,o=r.length;a<o;++a){var s=r[a],l=i.findAllRings(s),d=i.findSSSR(s,l);n.push({vertexes:s.vertexes,edges:s.edges,allRings:l,sssrRings:d})}return n}},e.RingVectorUtils={MAX_INT_BITNUM:23,EDGE_INDEX_FIELD:"__$index__",prepareConvertRingToVector:function(t){for(var r=t.edges,i=0,n=r.length;i<n;++i)r[i][e.RingVectorUtils.EDGE_INDEX_FIELD]=i},convertRingToVector:function(t,r){var i,n=r.edges.length,a=t.edges;if(n<e.RingVectorUtils.MAX_INT_BITNUM){i=0;for(var o=0,s=a.length;o<s;++o){var l=a[o],d=l[e.RingVectorUtils.EDGE_INDEX_FIELD];i+=1<<d}}else{i=[];for(var o=0,s=a.length;o<s;++o){var l=a[o],d=l[e.RingVectorUtils.EDGE_INDEX_FIELD];i[d]=!0}}return i},vectorNotNull:function(e){if(o.isSimpleValue(e))return!!e;for(var t=0;t<e.length;++t)if(e[t])return!0;return!1},getVectorLength:function(e){return o.isSimpleValue(e)?e.toString(2).length:e.length},ringVectorAnd:function(e,t){if(o.isSimpleValue(e))return e&t;for(var r=[],i=Math.min(e.length,t.length),n=0;n<i;++n)r[n]=e[n]&&t[n];return r},ringVectorAndAll:function(t){if(t.length<2)return t[0];for(var r=e.RingVectorUtils,i=r.ringVectorAnd(t[0],t[1]),n=2,a=t.length;n<a;++n)i=r.ringVectorAnd(i,t[n]);return i},ringVectorOr:function(e,t){if(o.isSimpleValue(e))return e|t;for(var r=[],i=Math.max(e.length,t.length),n=0;n<i;++n)r[n]=e[n]||t[n];return r},ringVectorOrAll:function(t){if(t.length<2)return t[0];for(var r=e.RingVectorUtils,i=r.ringVectorOr(t[0],t[1]),n=2,a=t.length;n<a;++n)i=r.ringVectorOr(i,t[n]);return i},ringVectorXor:function(e,t){if(o.isSimpleValue(e))return e^t;for(var r=[],i=Math.max(e.length,t.length),n=0;n<i;++n)r[n]=!!(e[n]^t[n]);return r},ringVectorXorAll:function(t){if(t.length<2)return t[0];for(var r=e.RingVectorUtils,i=r.ringVectorXor(t[0],t[1]),n=2,a=t.length;n<a;++n)i=r.ringVectorXor(i,t[n]);return i},ringVectorNot:function(e){if(o.isSimpleValue(e))return~e;for(var t=[],r=0,i=e.length;r<i;++r)t[r]=!e[r];return t},isLinearDependant:function(t,r){var i=e.RingVectorUtils,n=i.ringVectorOrAll(r),a=i.ringVectorAnd(t,i.ringVectorNot(n));if(i.vectorNotNull(a))return!1;for(var o=r.length,s=function e(t,r,i){var n=t[r],a=++n;if(a>=i-r)return!(r>=t.length-1)&&e(t,r+1,i);t[r]=a;for(var o=a,s=r-1;s>=0;--s)++o,t[s]=o;return!0},l=0,d=!1,u=2;u<=o;++u){for(var c=function(e){for(var t=[],r=0;r<e;++r)t[r]=e-r-1;return t}(u);;){++l;for(var h=[],m=0,g=c.length;m<g;++m)h.push(r[c[m]]);var f=i.ringVectorXorAll(h);if(!i.vectorNotNull(i.ringVectorXor(f,t))){d=!0;break}if(!function(e,t){return s(e,0,t)}(c,o)){d=!1;break}}if(d)break}return d},isLinearDependant_wrong:null},e}},function(e,t,r){"use strict";var i=r(0).Class,n=(r(0).ClassEx,r(0).ObjectEx),a=r(0).DataType;e.exports=function(e){return e.ChemStructObjContainer=i.create(n,{CLASS_NAME:"Kekule.ChemStructObjContainer",initialize:function($super){$super(),this.setPropStoreFieldValue("nodes",[]),this.setPropStoreFieldValue("connectors",[])},initProperties:function(){this.defineProp("nodes",{dataType:a.ARRAY,serializable:!1,setter:null}),this.defineProp("connectors",{dataType:a.ARRAY,serializable:!1,setter:null})},clear:function(){return this.getNodes().length=0,this.getConnectors().length=0,this},add:function(t){var r=null;return t instanceof e.ChemStructureConnector?r=this.getConnectors():t instanceof e.ChemStructureNode&&(r=this.getNodes()),r?e.ArrayUtils.pushUnique(r,t):e.error(e.$L("ErrorMsg.CANNOT_ADD_NON_NODE_NOR_CONNECTOR_TO_STRUCT_CONTAINER")),this},remove:function(t){var r=null;return r=t instanceof e.ChemStructureConnector?this.getConnectors():this.getNodes(),e.ArrayUtils.remove(r,t),this}}),e}},function(e,t,r){"use strict";var i=r(0).Class,n=r(0).ClassEx,a=r(0).ObjectEx,o=r(0).DataType;e.exports=function(e){var t=e.ArrayUtils;e.BondType;return e.CanonicalizationIndexer=i.create(a,{CLASS_NAME:"Kekule.CanonicalizationIndexer",initialize:function($super){$super()},execute:function(t){var r=t instanceof e.StructureFragment?t.getCtab():t;return r?this.doExecute(r):null},doExecute:function(e){}}),e.CanonicalizationNodeSorter=i.create(a,{CLASS_NAME:"Kekule.CanonicalizationNodeSorter",execute:function(t){var r=t instanceof e.StructureFragment?t.getCtab():t;return r?this.doExecute(r,r.getNodes()):null},doExecute:function(e){}}),e.CanonicalizationConnectorSorter=i.create(a,{CLASS_NAME:"Kekule.CanonicalizationConnectorSorter",execute:function(t){var r=t instanceof e.StructureFragment?t.getCtab():t;return r?this.doExecute(r,r.getConnectors()):null},doExecute:function(e){}}),e.CanonicalizationConnectorConnectedObjsSorter=i.create(a,{CLASS_NAME:"Kekule.CanonicalizationConnectorConnectedObjsSorter",execute:function(t){var r=t instanceof e.StructureFragment?t.getCtab():t;return r?this.doExecute(r,r.getConnectors()):null},doExecute:function(e){}}),e.CanonicalizationCustomExecutor=i.create(a,{CLASS_NAME:"Kekule.CanonicalizationCustomExecutor",execute:function(e){var t=this.doExecute(e);return t&&this.doCanonicalizeConnectedObjs(t),t},doExecute:function(e){return e},doCanonicalizeConnectedObjs:function(t){if(t){(new e.CanonicalizationGeneralConnectorConnectedObjsSorter).execute(t)}}}),e.CanonicalizationGeneralConnectorSorter=i.create(e.CanonicalizationConnectorSorter,{CLASS_NAME:"Kekule.CanonicalizationGeneralConnectorSorter",doExecute:function(r){var i=new e.MapEx;try{for(var n=0,a=r.getConnectorCount();n<a;++n){for(var o=r.getConnectorAt(n),s=o.getConnectedObjs(),l=[],d=0,u=s.length;d<u;++d){var c,h=s[d];h instanceof e.ChemStructureNode&&(c=r.indexOfNode(h),l.push(c))}l.sort(function(e,t){return e-t}),i.set(o,l)}r.sortConnectors(function(e,r){var n=i.get(e),a=i.get(r),o=t.compare(n,a);return 0===o&&(o=-(e.getConnectedObjCount()-r.getConnectedObjCount())),o})}finally{i.finalize()}}}),e.CanonicalizationGeneralConnectorConnectedObjsSorter=i.create(e.CanonicalizationConnectorConnectedObjsSorter,{CLASS_NAME:"Kekule.CanonicalizationGeneralConnectorConnectedObjsSorter",doExecute:function(t){var r=new e.MapEx;try{for(var i=0,n=t.getConnectorCount();i<n;++i){var a=t.getConnectorAt(i);if(2===a.getConnectedObjCount()){var o=a.getConnectedObjAt(0),s=a.getConnectedObjAt(1),l=t.indexOfChild(o),d=t.indexOfChild(s);(l<0||d<0)&&(l=(o.getCanonicalizationIndex?-o.getCanonicalizationIndex():0)||0,d=(s.getCanonicalizationIndex?-s.getCanonicalizationIndex():0)||0),l>d&&a.reverseConnectedObjOrder()}else a.sortConnectedObjs(function(e,r){var i=t.indexOfChild(e),n=t.indexOfChild(r);(i<0||n<0)&&(i=(e.getCanonicalizationIndex?-e.getCanonicalizationIndex():0)||0,n=(r.getCanonicalizationIndex?-r.getCanonicalizationIndex():0)||0,a=(i||0)-(n||0));var a=t.indexOfChild(e)-t.indexOfChild(r);return a})}}finally{r.finalize()}}}),e.CanonicalizationMorganIndexer=i.create(e.CanonicalizationIndexer,{CLASS_NAME:"Kekule.CanonicalizationMorganIndexer",doExecute:function(e){var t=this.doCalcGraphAndEcResult(e);this.doExecuteOnGraphEcResult(t.graph,t.ecMapping,t.vertexGroup)},doCalcGraphAndEcResult:function(t){var r=e.GraphAdaptUtils.ctabToGraph(t,null,{expandSubStructures:!0,ignoreBondedHydrogen:!0});if(!r)return null;var i=this._calcGraphFinalECs(r);return{graph:r,ecMapping:i.ecMapping,vertexGroup:i.vertexGroup}},doExecuteOnGraphEcResult:function(e,t,r){var i=this._sortNodeByEcMapping(e,t,r);this._setCanonicalizationIndexToNodeGroups(i),this._fillSpanningTreeInfo(e)},_fillSpanningTreeInfo:function(t){var r=t.getVertexes();if(r&&r.length){r.sort(function(t,r){var i=t.getData("object"),n=r.getData("object");if(i||n){if(i){if(n){var a=(n.getCanonicalizationIndex()||-1)-(i.getCanonicalizationIndex()||-1);if(0===a&&i.hasCoord3D(!0)&&n.hasCoord3D(!0)){var o=e.CoordUtils.substract(n.getAbsCoord3D(!0),i.getAbsCoord3D(!0));a=o.z||o.y||o.x}return a}return-1}return 1}return 0});var i=t.getEdges();if(i&&i.length){var n=function(e,t){for(var r=t.length,i=[],n=e.getVertexes(),a=0,o=n.length;a<o;++a){var s=t.indexOf(n[a]);s<0&&(s=r),i.push(s)}return i.sort(),i},r=t.getVertexes();i.sort(function(t,i){var a=n(t,r),o=n(i,r);return e.ArrayUtils.compare(a,o)})}r=t.getVertexes();for(var a=0,o=r.length;a<o;++a){r[a].getEdges().sort(function(e,t){return i.indexOf(e)-i.indexOf(t)})}}this._setSpanningTreeIndexToNodeOfGraph(t)},_sortNodeByEcMapping:function(e,t,r){return this._doSortNodeByEcMapping(e,t,r)},_doSortNodeByEcMapping:function(e,r,i){for(var n=this._doSortNodeByEcMappingDirectly(i),a=this._doSortNodeBySortedNodeList(n),o=[],s=0,l=a.length;s<l;++s){var d=a[s];t.isArray(d)&&1===d.length?o.push(d[0]):o.push(d)}return o},_doSortNodeByEcMappingDirectly:function(e){for(var r=[],i=e,n=0,a=i.length;n<a;++n){var o=i[n],s=this._vertexesToNodes(o.vertexes);if(1===s.length)t.pushUnique(r,s[0]);else{var l=this._groupNodesWithSameEcValue(s,r);r=r.concat(l)}}return r},_doSortNodeBySortedNodeList:function(e){var t=this._doSortNodeBySortedNodeListCore(e),r=t.length;do{var i=t,n=r,t=this._doSortNodeBySortedNodeListCore(i),r=t.length}while(r>n);return i},_doSortNodeBySortedNodeListCore:function(e){for(var r=[],i=[],n=0,a=e.length;n<a;++n){var o=e[n];if(t.isArray(o)){var s=function(e,r){for(var i=0,n=r.length;i<n;++i)if(t.isArray(r[i])){if(r[i].indexOf(e)>=0)return i}else if(r[i]===e)return i;return-1},l=function(e,t,r){for(var i=[],n=0,a=t.length;n<a;++n)i.push(s(t[n],r));return i.sort(function(e,t){return t-e}),i},d=function(n,a){var o=t.intersect(n.getLinkedObjs(),i),s=t.intersect(a.getLinkedObjs(),i),d=o.length-s.length;if(0===d&&o.length>0){var u=l(0,o,r),c=l(0,s,r);d=t.compare(u,c)}if(0===d){var o=t.intersect(n.getLinkedObjs(),e),s=t.intersect(a.getLinkedObjs(),e),d=o.length-s.length;if(0===d){var u=l(0,o,e),c=l(0,s,e);d=t.compare(u,c)}}return d},u=t.group(o,d);r=r.concat(u),i=i.concat(o)}else r.push([o]),i.push(o)}return r},_setCanonicalizationIndexToNodeGroups:function(e){for(var r=0,i=e.length;r<i;++r){var n=r+1,a=e[r];if(t.isArray(a))for(var o=0,s=a.length;o<s;++o)a[o].setCanonicalizationIndex(n);else a.setCanonicalizationIndex(n)}},_setSpanningTreeIndexToNodeOfGraph:function(t){for(var r=e.GraphAlgorithmUtils.createSpanningTrees(t,e.GraphTraverseMode.DEPTH_FIRST),i=0,n=r.length;i<n;++i){var a=r[i];if(a.vertexes)for(var o=a.vertexes.length,s=0;s<o;++s){var l=a.vertexes[s].getData("object");l&&l.setCanonicalizationAssocIndex&&l.setCanonicalizationAssocIndex(o-s)}}},_vertexesToNodes:function(e){for(var t=[],r=0,i=e.length;r<i;++r){var n=e[r].getData("object");t.push(n)}return t},_processECs:function(e,r,i,n){if(n)return this._initECs(e,r);for(var a=[],o=[],s=e.getVertexes(),l=0,d=s.length;l<d;++l){var u=s[l],c=this._usePrimeECs?1:0;if(this._usePrimeECs)var h=this._getPrimeArray();for(var m=u.getNeighbors(),g=0,f=m.length;g<f;++g)this._usePrimeECs?c*=h[i.get(m[g])-1||0]:c+=i.get(m[g])||0;t.pushUnique(a,c),o[c]?o[c].push(u):o[c]=[u]}a.sort(function(e,t){return e-t});for(var p=[],l=0,d=a.length;l<d;++l){var C=a[l];o[C]&&p.push(o[C])}return this._setECValueByVertexGroup(p,r),p.length},_initECs:function(e,r){for(var i=[],n=e.getVertexes(),a=0,o=n.length;a<o;++a){var s=n[a],l=s.getEdgeCount();i[l]?i[l].push(s):i[l]=[s]}for(var d=[],a=0,o=i.length;a<o;++a){var n=i[a];if(n)if(1===n.length)d.push(n);else for(var u=t.group(n,function(e,t){var r=e.getData("object"),i=t.getData("object"),n=(r.getLinkedNonHydrogenConnectors()||[]).length-(i.getLinkedNonHydrogenConnectors()||[]).length;return n||(n=r.compareStructure(i))||(n=(r.getHydrogenCount?r.getHydrogenCount(!0):0)-(i.getHydrogenCount?i.getHydrogenCount(!0):0)),n}),c=0,h=u.length;c<h;++c)d.push(t.toArray(u[c]))}return this._setECValueByVertexGroup(d,r),d.length},_setECValueByVertexGroup:function(e,t){for(var r=0,i=e.length;r<i;++r)for(var n=e[r],a=0,o=n.length;a<o;++a)t.set(n[a],r+1)},_getPrimeArray:function(){return e.CanonicalizationMorganIndexer.primes||(e.CanonicalizationMorganIndexer.primes=e.NumUtils.getPrimes(1e4)),e.CanonicalizationMorganIndexer.primes},_calcGraphFinalECs:function(t){var r=[new e.MapEx,new e.MapEx];try{t.getVertexes().length<this._getPrimeArray().length?this._usePrimeECs=!0:this._usePrimeECs=!1;for(var i,n,a=0,o=r[0],s=r[0],l=0,d=[],u=this._processECs(t,o,s,!0),c=!0;c;)l=u,i=n,s=o,++a,o=r[a%2],u=this._processECs(t,o,s),n=null,c=u>l,u===l?(n=this._groupVertexesByEcValue(t,o),!i&&s&&(i=this._groupVertexesByEcValue(t,s)),d.push(i),c=!this._hasVertexGroup(n,d)):d=[]}finally{o.finalize()}return{ecMapping:s,ecCount:l,vertexGroup:i||this._groupVertexesByEcValue(t,s)}},_groupVertexesByEcValue:function(e,r){for(var i=[],n=[],a=e.getVertexes(),o=0,s=a.length;o<s;++o){var l=a[o],d=r.get(l);t.pushUnique(n,d),i[d]||(i[d]=[]),i[d].push(l)}n.sort(function(e,t){return e-t});for(var u=[],o=0,s=n.length;o<s;++o){var c=i[n[o]];u.push({ecValue:n[o],vertexes:c,vertexesCount:c.length})}return u},_hasVertexGroup:function(e,t){for(var r=0,i=t.length;r<i;++r)if(0===this._compareEcVertexGroup(e,t[r]))return!0;return!1},_compareEcVertexGroup:function(e,r){var i=e.length,n=i-r.length;if(0===n)for(var a=0;a<i&&(n=e[a].vertexes.length-r[a].vertexes.length,0===n&&(n=t.exclude(e[a].vertexes,r[a].vertexes).length),0===n);++a);return n},_groupNodesWithSameEcValue:function(e,r){var i=function(e,r){for(var i=t.flatten(r),n=e.getLinkedObjs(),a=t.intersect(n,i),o=[],s=[],l=0,d=a.length;l<d;++l){var u=a[l],c=t.indexStackOfElem(u,r);o.push(c)}o.sort(function(e,r){return t.compare(e,r)});for(var l=0,d=o.length;l<d;++l){var u=t.getElemByIndexStack(r,o[l]);u||console.error("not found",u,o[l]);var h=e.getConnectorTo(u);s.push(h)}return{nodeIndexValues:o,connectors:s}};return t.group(e,function(e,n){var a=e.compareStructure(n);if(0===a){var o=i(e,r),s=i(n,r);a=t.compare(o.nodeIndexValues,s.nodeIndexValues);for(var l=o.connectors,d=s.connectors,u=0,c=l.length;u<c&&0===(a=l[u].compareStructure(d[u]));++u);if(0===a){var h=e.getBelongedSssrRings&&e.getBelongedSssrRings()||[],m=n.getBelongedSssrRings&&n.getBelongedSssrRings()||[];if(0===(a=h.length-m.length)){for(var g=[],f=[],u=0,c=h.length;u<c;++u)g.push(h[u].nodes.length),f.push(m[u].nodes.length);g.sort(),f.sort(),a=t.compare(g,f)}}}return a})}}),e.CanonicalizationMorganNodeSorter=i.create(e.CanonicalizationNodeSorter,{CLASS_NAME:"Kekule.CanonicalizationMorganNodeSorter",doExecute:function(e){var t=this._getNodeSortedArray(e),r=t.length,i=this;e.sortNodes(function(e,n){var a=t.indexOf(e),o=t.indexOf(n);a<0&&(a=r),o<0&&(o=r);var s=a-o;return 0===s&&a===r&&(s=i._getNeighborNodesMinIndex(e,t)-i._getNeighborNodesMinIndex(n,t)),s})},_getNeighborNodesMinIndex:function(e,t){for(var r=e.getLinkedChemNodes(),i=t.length,n=0,a=r.length;n<a;++n){var o=t.indexOf(r[n]);o>0&&o<i&&(i=o)}return i},_getNodeSortedArray:function(r){var i=function(t,r,i,n){var a,o=r.getCanonicalizationIndex(),s=i.getCanonicalizationIndex();if(0===(a=(o||-1)-(s||-1))){if(t){var l=t.getConnectorTo(r),d=t.getConnectorTo(i);a=l.compareStructure(d)}if(0===a&&n){a=(n.get(r)||1/0)-(n.get(i)||1/0)}if(0===a){var u=r.getCanonicalizationAssocIndex(),c=i.getCanonicalizationAssocIndex();a=(u||-1)-(c||-1)}if(0===a&&r.hasCoord3D(!0)&&i.hasCoord3D(!0)){var h=e.CoordUtils.substract(r.getAbsCoord3D(!0),i.getAbsCoord3D(!0));a=h.z||h.y||h.x}}return a};try{for(var n,a,o=t.clone(r.getNodes()),s=0,l=o.length;s<l;++s){var d=o[s];n?i(null,d,n)>0&&(n=d,a=s):(n=d,a=s)}o.splice(a,1);var u=[],c=[];n&&u.push(n);for(var s=0;s<u.length;++s){var n=u[s];if(0!==s){var h=o.indexOf(n);h>=0&&(u.push(n),o.splice(h,1))}var m=n.getLinkedObjs();if(m=t.intersect(m,o),m.length){m.sort(function(e,t){return i(n,e,t)});for(var g=m.length-1;g>=0;--g){var f=m[g];if((h=o.indexOf(f))>=0){var p=f.getCanonicalizationIndex();e.ObjUtils.isUnset(p)?c.push(f):u.push(f),o.splice(h,1)}}}}return u=u.concat(c)}finally{}}}),e.Canonicalizer=i.create({CLASS_NAME:"Kekule.Canonicalizer",initialize:function(){this._executorClasses={},this._executorInstances={},this._defExecutorId=null},registerExecutor:function(r,i,n){t.isArray(i)?this._executorClasses[r]={indexer:i[0],nodeSorter:i[1],connectorSorter:i[2]||e.CanonicalizationGeneralConnectorSorter,connectorConnectedObjsSorter:i[3]||e.CanonicalizationGeneralConnectorConnectedObjsSorter}:this._executorClasses[r]={customExecutor:i},n&&(this._defExecutorId=r)},getExecutor:function(e){if(!e)return null;var t=this._executorInstances[e];if(!t){var r=this._executorClasses[e];r&&(t=r.customExecutor?{customExecutor:new r.customExecutor}:{indexer:new r.indexer,nodeSorter:new r.nodeSorter,connectorSorter:new r.connectorSorter,connectorConnectedObjsSorter:new r.connectorConnectedObjsSorter},this._executorInstances[e]=t)}return t},canonicalize:function(t,r){t.beginUpdate();try{var i=r||this._defExecutorId,n=this.getExecutor(i);if(n){var a=t instanceof e.StructureFragment?t:null,o=a.getCanonicalizationInfo();if(o&&o.id===i)return t;var s=t.getCtab?t.getCtab():t;if(!s||s.isEmpty())return t;var l=s.getParent();n.customExecutor?n.customExecutor.execute(s):this._doDefaultCanonicalize(n,s,l),a.setCanonicalizationInfo({id:i})}else e.error(e.$L("ErrorMsg.REGISTERED_CANONICALIZATION_EXECUTOR_NOT_FOUND"))}finally{t.endUpdate()}return t},_doDefaultCanonicalize:function(e,t,r){var i=r.getFlattenedShadowFragment(),t=i.getCtab();t.beginUpdate();try{e.indexer.execute(t),e.nodeSorter.execute(t),e.connectorSorter.execute(t),e.connectorConnectedObjsSorter.execute(t)}finally{t.endUpdate()}if(!r.getFlattenedShadowOnSelf()){r.beginUpdate();try{this._sortSrcStructBaseOnShadow(r,i),e.connectorConnectedObjsSorter.execute(r.getCtab())}finally{r.endUpdate()}}},_sortSrcStructBaseOnShadow:function(t,r){var i=function(e){return e.__$flattern_index$__},n=function(e,t){e.__$flattern_index$__=t};t.cascadeOnChildren(function(e){e&&n(e,null)});var a=r.getChildCount();t.beginUpdate();try{for(var o=0;o<a;++o){var s=r.getChildAt(o);if(s instanceof e.ChemStructureNode){var l=s,d=t.getFlatternedShadowSourceObj(l);d&&(!function r(a,o,s,l){n(o,s);var d=o.getParent();if(d.isChildOf(t)){var u=i(d),c=s+l;(e.ObjUtils.isUnset(u)||u>c)&&r(a,d,c,l)}}(t,d,o,a),d.setCanonicalizationIndex(l.getCanonicalizationIndex()))}else if(s instanceof e.ChemStructureConnector){var u=s,c=t.getFlatternedShadowSourceObj(u);n(c,o)}}!function t(r){r.beginUpdate();try{r.sortNodes(function(e,t){return i(e)-i(t)}),r.sortConnectors(function(e,t){return i(e)-i(t)});for(var n=0,a=r.getNodeCount();n<a;++n){var o=r.getNodeAt(n);o instanceof e.StructureFragment&&t(o)}}finally{r.endUpdate()}}(t)}finally{t.endUpdate()}}}),e.ClassUtils.makeSingleton(e.Canonicalizer),e.canonicalizer=e.Canonicalizer.getInstance(),n.extend(e.ChemObject,{canonicalize:function(t){for(var r=e.ChemStructureUtils.getAllStructFragments(this,!0),i=0,n=r.length;i<n;++i)r[i].canonicalize(t);return this}}),n.extend(e.StructureConnectionTable,{canonicalize:function(t){return e.canonicalizer.canonicalize(this),this}}),n.extend(e.StructureFragment,{canonicalize:function(t){return e.canonicalizer.canonicalize(this),this}}),n.defineProp(e.ChemStructureObject,"canonicalizationIndex",{dataType:o.INT,serializable:!1,scope:i.PropertyScope.PUBLISHED}),n.defineProp(e.ChemStructureObject,"canonicalizationAssocIndex",{dataType:o.INT,serializable:!1,scope:i.PropertyScope.PUBLISHED}),e.canonicalizer.registerExecutor("morgan",[e.CanonicalizationMorganIndexer,e.CanonicalizationMorganNodeSorter],!0),e}},function(e,t,r){"use strict";var i=r(0).Class,n=r(0).ClassEx,a=r(0).DataType;e.exports=function(e){var t=e.ArrayUtils,r=e.GraphAlgorithmUtils,o=e.ChemStructureUtils,s=e.BondType;return e.globalOptions.add("algorithm.ringSearch",{bondTypes:[s.COVALENT]}),n.extend(e.StructureConnectionTable,{getGraph:function(t){var r=i.create(t);return r.connectorClasses=[e.Bond],e.GraphAdaptUtils.ctabToGraph(this,null,r)},extractStructObjs:function(t){for(var r=t.edges,i=t.vertexes,n=[],a=[],o=0,s=i.length;o<s;++o){var l=i[o].getData("object");l instanceof e.BaseStructureNode&&n.push(l)}for(var o=0,s=r.length;o<s;++o){var l=r[o].getData("object");l instanceof e.BaseStructureConnector&&a.push(l)}return{nodes:n,connectors:a}},findCycleBlocks:function(){var e=this.getRingInfo();return e?e.cycleBlocks:[]},findAllRings:function(){var e=this.getRingInfo(),t=[];if(e)for(var r=0,i=e.cycleBlocks.length;r<i;++r){var n=e.cycleBlocks[r],a=n.allRings;t=t.concat(a)}return t},findSSSR:function(){var e=this.getRingInfo(),t=[];if(e)for(var r=0,i=e.cycleBlocks.length;r<i;++r){var n=e.cycleBlocks[r],a=n.sssrRings;t=t.concat(a)}return t},analysisRings:function(t){var i=Object.extend(Object.extend({},e.globalOptions.algorithm.ringSearch),t),n=this.getGraph(i);if(n){for(var a=[],o=r.analysisRings(n),s=0,l=o.length;s<l;++s){var d=o[s],u=this.extractStructObjs(d);a.push(u),u.allRings=[];for(var c=d.allRings,h=0,m=c.length;h<m;++h){var g=c[h],f=this.extractStructObjs(g);u.allRings.push(f)}u.sssrRings=[];for(var p=d.sssrRings,h=0,m=p.length;h<m;++h){var g=p[h],C=c.indexOf(g);if(C>=0)u.sssrRings.push(u.allRings[C]);else{var f=this.extractStructObjs(g);u.sssrRings.push(f)}}}return{cycleBlocks:a}}return null}}),n.defineProps(e.StructureConnectionTable,[{name:"ringInfo",dataType:a.HASH,serializable:!1,getter:function(e){var t=this.getStructureCacheData("ringInfo");return t||e||(t=this.analysisRings(),this.setStructureCacheData("ringInfo",t)),t},setter:null}]),n.extend(e.StructureFragment,{findCycleBlocks:function(){return this.hasCtab()?this.getCtab().findCycleBlocks():null},findAllRings:function(){return this.hasCtab()?this.getCtab().findAllRings():null},findSSSR:function(){return this.hasCtab()?this.getCtab().findSSSR():null},analysisRings:function(e){return this.hasCtab()?this.getCtab().analysisRings(e):null}}),n.defineProps(e.StructureFragment,[{name:"ringInfo",dataType:a.HASH,serializable:!1,getter:function(e){return this.hasCtab()?this.getCtab().getRingInfo(e):null},setter:null}]),n.extendMethod(e.StructureFragment,"_copyAdditionalFragmentInfo",function(e,t,r,i){var n=function(e){for(var t={nodes:[],connectors:[]},i=0,n=e.nodes.length;i<n;++i){var a=r.get(e.nodes[i]);a&&t.nodes.push(a)}for(var i=0,n=e.connectors.length;i<n;++i){var a=r.get(e.connectors[i]);a&&t.connectors.push(a)}return t};e(t,r,i);var a=this,o=a.getRingInfo(!0);if(o){for(var s={cycleBlocks:[]},l=0,d=o.cycleBlocks.length;l<d;++l){for(var u=o.cycleBlocks[l],c={allRings:[],sssrRings:[]},h=u.allRings,m=0,g=h.length;m<g;++m){var f=h[m];c.allRings.push(n(f))}for(var p=u.sssrRings,m=0,g=p.length;m<g;++m){var f=p[m];c.sssrRings.push(n(f))}s.cycleBlocks.push(c)}t.setPropStoreFieldValue("ringInfo",s)}}),n.extend(e.ChemStructureObject,{getBelongedSssrRings:function(){var t=[],r=this.getParent();if(r&&r.findSSSR)for(var i=r.findSSSR(),n=0,a=i.length;n<a;++n){var o=i[n];this instanceof e.BaseStructureConnector?o.connectors.indexOf(this)>=0&&t.push(o):o.nodes.indexOf(this)>=0&&t.push(o)}return t},getBelongedRingMinSize:function(){var e=null,t=this.getBelongedSssrRings();if(t&&t.length)for(var r=0,i=t.length;r<i;++r){var n=t[r],a=n.nodes.length;e=e?Math.min(e,a):a}return e},isInRing:function(r){var i=r&&t.toArray(r);if(!i){var n=this.getParent();n&&n.findSSSR&&(i=n.findSSSR())}if(i&&i.length){for(var a=0,o=i.length;a<o;++a){var s=i[a];if(this instanceof e.BaseStructureConnector){if(s.connectors.indexOf(this)>=0)return!0}else if(s.nodes.indexOf(this)>=0)return!0}return!1}return!1}}),n.extend(e.ChemObject,{findCycleBlocks:function(){for(var e=o.getAllStructFragments(this),t=[],r=0,i=e.length;r<i;++r){var n=e[r].findCycleBlocks();n&&(t=t.concat(n))}return t.length?t:null},findAllRings:function(){for(var e=o.getAllStructFragments(this),t=[],r=0,i=e.length;r<i;++r){var n=e[r].findAllRings();n&&(t=t.concat(n))}return t.length?t:null},findSSSR:function(){for(var e=o.getAllStructFragments(this),t=[],r=0,i=e.length;r<i;++r){var n=e[r].findSSSR();n&&(t=t.concat(n))}return t.length?t:null},analysisRings:function(e){for(var t=o.getAllStructFragments(this),r=[],i=0,n=t.length;i<n;++i){var a=t[i].analysisRings(e);a&&(r=r.concat(a))}return r.length?r:null}}),e}},function(e,t,r){"use strict";var i=(r(0).Class,r(0).ClassEx);r(0).DataType;e.exports=function(e){var t=e.ObjUtils,r=e.ArrayUtils,n=e.BondType,a=e.BondOrder,o=e.ChemStructureUtils,s={SATURATED_CARBON:-1,ESTER_CARBON:-16,SULFONE_OR_SULFOXIDE_SULPHUR:-32};return e.AromaticTypes={NONAROMATIC:0,EXPLICIT_AROMATIC:1,ANTIAROMATIC:-1,UNCERTAIN:64},i.extend(e.Atom,{isSulfoneOrSulfoxideSulphur:function(){if("S"===this.getSymbol()){var t=this.getLinkedMultipleBonds();if(t.length>=1)for(var r=0,i=t;r<i;++r)for(var n=this.getLinkedObjsOnConnector(t[r]),a=0,o=n.length;a<o;++a){var s=n[a];if(s instanceof e.Atom&&"O"===s.getSymbol())return!0}}return!1},isEsterCarbon:function(){if("C"===this.getSymbol())for(var e,t,r=this.getLinkedBonds(n.COVALENT),i=0,o=r.length;i<o;++i){var s=r[i];if(s.isBondBetween("C","O")&&(t||s.getBondOrder()!==a.SINGLE?e||s.getBondOrder()!==a.DOUBLE||(e=!0):t=!0,t&&e))return!0}return!1}}),e.globalOptions.add("algorithm.aromaticRingsPerception",{allowUncertainRings:!1}),i.extend(e.StructureConnectionTable,{_getPossibleRingNodePiElectronCounts:function(t,i,n){var a=function(t,i,n,a){var o=t,l=e.IsotopeFactory.getIsotope(o),d=i.getCharge();if(!i.isSaturated||!i.isSaturated()){var u,c=i.getLinkedMultipleBonds();if(i.isSulfoneOrSulfoxideSulphur&&i.isSulfoneOrSulfoxideSulphur())return s.SULFONE_OR_SULFOXIDE_SULPHUR;if(i.isEsterCarbon&&i.isEsterCarbon())return s.ESTER_CARBON;var h,m;if(a?(h=r.intersect(c,a),m=h.length):(h=null,m=1),m)if(2===m&&h[0].getBondOrder()===e.BondOrder.EXPLICIT_AROMATIC)u=l.isHetero&&l.isHetero()?[1,2]:1;else if(1===m&&h&&h[0].getBondOrder()===e.BondOrder.DOUBLE)u=1;else{if(1!==m||h)return-1;u=1}else if("C"===o){for(var g=!1,f=0,p=c.length;f<p;++f){var C=c[f],b=i.getLinkedObjsOnConnector(C);if(1===b.length){var E=b[0],N=E.getPrimaryIsotope();if(N.isHetero()){g=!0;break}}}u=g?0:1}else u=1;if(r.isArray(u)){for(var f=0,p=u.length;f<p;++f)u[f]=Math.min(Math.max(u[f]-d,0),2);return u}return Math.min(Math.max(u-d,0),2)}return i.getRadical&&i.getRadical()===e.RadicalOrder.DOUBLET?1:l.isHetero()?Math.min(Math.max(2-d,0),2):"C"===o?d>0?0:d<0?2:s.SATURATED_CARBON:0};if(t instanceof e.VariableAtom){var o=t.getAllowedIsotopeIds();if(o&&o.length){for(var l=[],d=0,u=o.length;d<u;++d){var c=o[d],h=e.IsotopeFactory.getIsotopeById(c).getSymbol();r.pushUnique(l,a(h,t,0,n))}return l}return[0,1,2]}var m=t.getPrimaryIsotope();if(m){var h=m.getSymbol();return a(h,t,0,n)}return[0,1,2]},_checkRingAromaticType:function(t,i,n){if(i){for(var a=n&&e.ChemStructureUtils.isInRings(t,n),o=t.nodes,s=o.length,l=s>6&&s<16,d=[],u=[],c=o.length,h=0;h<c;++h){var m=o[h],g=i.get(m);r.isArray(g)?d.push(g):d.push([g]),u[h]=0}var f,p=function e(t,r){var i=r[t],n=++i;return n>=d[t].length?!(t>=r.length-1)&&(r[t]=0,e(t+1,r)):(r[t]=n,!0)},C=null,b=0,E=null;do{++b;for(var N=0,T=null,h=0;h<c;++h){var O=d[h][u[h]];if(!(O>=0)){T=e.AromaticTypes.NONAROMATIC;break}N+=O}if(null===T){var _=parseInt(N/4),S=N%4,v=l&&a;_<=5&&(2!==_||!v)&&(2===S?(T=e.AromaticTypes.EXPLICIT_AROMATIC,E=r.clone(u)):S||(T=e.AromaticTypes.ANTIAROMATIC))}if(null!==C){if(T&&C!==T&&(C===e.AromaticTypes.EXPLICIT_AROMATIC||T===e.AromaticTypes.EXPLICIT_AROMATIC)){f=e.AromaticTypes.UNCERTAIN;break}}else C=T}while(function(e){return p(0,e)}(u));if(f||(f=C),E)for(var y=new e.MapEx,h=0,A=E.length;h<A;++h)y.set(o[h],d[h][E[h]]);return{result:f,eMap:y}}},_calcPossibleRingNodesPElectronCounts:function(t,i,n){var a=[],o=[],s=[];if(n){for(var l=0,d=n.length;l<d;++l)r.pushUnique(a,n[l].nodes),r.pushUnique(o,n[l].connectors);for(var l=0,d=i.length;l<d;++l)r.pushUnique(s,i[l].nodes)}else{for(var l=0,d=i.length;l<d;++l)r.pushUnique(a,i[l].nodes),r.pushUnique(o,i[l].connectors);s=a}for(var l=0,d=s.length;l<d;++l){var u=s[l],c=u.getStructureCacheData("piElectronCount");if(e.ObjUtils.notUnset(c))t.set(u,[c]);else{var h=this._getPossibleRingNodePiElectronCounts(u,a,o);t.set(u,h)}}},_storeAromaticCacheToRingInfo:function(t,r,i){if(t.aromaticType=r,r===e.AromaticTypes.EXPLICIT_AROMATIC)for(var n=t.nodes,a=0,o=n.length;a<o;++a){var s=n[a];if(e.ObjUtils.isUnset(s.getStructureCacheData("piElectronCount"))&&i){var l=i.get(s);e.ObjUtils.notUnset(l)&&s.setStructureCacheData("piElectronCount",l)}}},perceiveAromaticRings:function(t,r){e.ObjUtils.isUnset(t)&&(t=e.globalOptions.algorithm.aromaticRingsPerception.allowUncertainRings);var i=this.findSSSR(),n=r||i,a=[],o=new e.MapEx;try{this._calcPossibleRingNodesPElectronCounts(o,n,null);for(var s=0,l=n.length;s<l;++s){var d,u=n[s];if(e.ObjUtils.notUnset(u.aromaticType))d=u.aromaticType;else{var c=this._checkRingAromaticType(u,o,i);d=c.result,this._storeAromaticCacheToRingInfo(u,d,c.eMap)}(d===e.AromaticTypes.EXPLICIT_AROMATIC||t&&d===e.AromaticTypes.UNCERTAIN)&&a.push(u)}return a}finally{o.finalize()}},findAromaticRings:function(e,t){return this.perceiveAromaticRings(e,t)},getRingAromaticType:function(t,r){if(e.ObjUtils.notUnset(t.aromaticType))return t.aromaticType;var i=this.findSSSR();r||(r=i);var n,a=new e.MapEx;try{this._calcPossibleRingNodesPElectronCounts(a,[t],r);var o=this._checkRingAromaticType(t,a,i);n=o.result,this._storeAromaticCacheToRingInfo(t,n,o.eMap)}finally{a.finalize()}return n},getHucklizationChanges:function(t,r){for(var i=r&&r.allowUncertainRings,n=e.BondOrder,a=[],o=(this.getParent(),this.findAromaticRings(i)),s=0,l=o.length;s<l;++s)for(var d=o[s].connectors,u=0,c=d.length;u<c;++u){var h=d[u];if(!t||t.indexOf(h)>=0){var m=h.getBondOrder&&h.getBondOrder();m!==n.SINGLE&&m!==n.DOUBLE||h.setBondOrder&&a.push({bond:h,bondOrder:e.BondOrder.EXPLICIT_AROMATIC})}}return a},hucklize:function(t,r){var i=(r&&r.allowUncertainRings,e.BondOrder,[]),n=this.getParent();n.setAutoClearStructureCache(!1),n.beginUpdate();try{var a=this.getHucklizationChanges(t,r);if(a)for(var o=0,s=a.length;o<s;++o){var l=a[o].bond,d=a[o].bondOrder;l.setBondOrder&&(l.setBondOrder(d),i.push(l))}}finally{n.endUpdate(),n.setAutoClearStructureCache(!0)}return i},getKekulizationChanges:function(t,r){var i=Object.extend({doAromaticTests:!1,includingSubFragments:!0,expandSubFragments:!1,useShadow:!0},r||{}),n=[],o=this.getParent();i.doAromaticTests&&this.perceiveAromaticRings();var s;if(i.useShadow){var l=o.createShadow();s=l.getShadowFragment()}else s=o;try{i.expandSubFragments&&i.useShadow&&s.unmarshalAllSubFragments(!0);var d;if(t)if(d=[],i.useShadow)for(var u=0,c=t.length;u<c;++u){var h=l.getShadowObj(t[u]);h&&d.push(h)}else d=t;else d=i.includingSubFragments&&!i.expandSubFragments?s.getAllContainingConnectors():s.getConnectors();for(var m=[],u=0,c=d.length;u<c;++u){var g=d[u];g.getBondType()===e.BondType.COVALENT&&g.getBondOrder()===e.BondOrder.EXPLICIT_AROMATIC&&2===g.getConnectedChemNodeCount()&&m.push(g)}s.setAutoClearStructureCache(!1),s.beginUpdate();try{for(var f=this._splitConnectorsToContinuousParts(m)||[],u=0,c=f.length;u<c;++u){var p=f[u];if(this._kekulizeContinousBonds(p,l,s,o))for(var C=0,b=p.length;C<b;++C){var E=p[C].getBondOrder();if(E!==a.EXPLICIT_AROMATIC){var N=i.useShadow?l.getSourceObj(p[C]):p[C];n.push({bond:N,bondOrder:E})}}}}finally{s.endUpdate(),s.setAutoClearStructureCache(!0)}}finally{i.useShadow&&l.finalize()}return n._useShadow=i.useShadow,n},kekulize:function(e,t){var r=[],i=this.getKekulizationChanges(e,t);if(i&&i._useShadow){var n=this.getParent();try{n.setAutoClearStructureCache(!1),n.beginUpdate();for(var a=0,o=i.length;a<o;++a){var s=i[a];s.bond.setBondOrder(s.bondOrder),r.push(s.bond)}}finally{n.endUpdate(),n.setAutoClearStructureCache(!0)}}return r},_kekulizeContinousBonds:function(i,n,a,o){for(var s=[],l=0,d=i.length;l<d;++l){var u=i[l].getConnectedChemNodes()||[];r.pushUnique(s,u)}for(var c=new e.MapEx(!1),l=0,d=s.length;l<d;++l){var h=s[l],m=n?n.getSourceObj(h):h,g=m&&m.getStructureCacheData("piElectronCount");t.notUnset(g)&&c.set(h,{cachedPiElectronCount:g})}return this._doKekulizeContinousBondSys(0,i,s,c)},_doKekulizeContinousBondSys:function(i,n,o,s){var l=this,d=function(e){var r,i=s.get(e);return i?r=i.bondOrder:n.indexOf(e)<0&&(r=e.getBondOrder()),t.notUnset(r)?r:null},u=function(e){var t=d(e);return t>a.SINGLE&&t<=a.QUAD},c=function(e){var t=r.intersect(e,n),i=!t||!t.length;if(!i){i=!0;for(var a=0,o=t.length;a<o;++a){var l=t[a];if(!s.get(l)){i=!1;break}}}return i},h=function(i){var n=s.get(i),o=n&&n.cachedPiElectronCount;if(t.isUnset(o)){var u=i.getLinkedBonds(e.BondType.COVALENT);if(c(u)){var h=r.toArray(l._getPossibleRingNodePiElectronCounts(i,null,null));return!h||!h.length||h[0]<0?-1:h[0]}for(var m=0,g=0,f=0,p=u.length;f<p;++f){var C=u[f],b=d(C);t.notUnset(b)&&(b===a.DOUBLE||b===a.TRIPLE||b===a.QUAD?++m:++g)}m&&(o=1===m?1:-1)}return o},m=n[i],g=m.getConnectedChemNodes(),f=[];if(!s.get(m)){if(function(e){for(var t=e.getNeighboringBonds(),r=0,i=t.length;r<i;++r){var e=t[r];if(u(e))return!0}return!1}(m))f=[a.SINGLE];else{var p=function(e,r){for(var i=0,n=0,a=0,o=r.length;a<o;++a){var s=h(r[a]);t.notUnset(s)&&(s>=2?++i:++n)}return i>0||!(n>=2)&&null}(0,g);f=p?[a.SINGLE]:null!==p?[a.DOUBLE]:[a.DOUBLE,a.SINGLE]}for(var C,b=0,E=f.length;b<E;++b){C=!0;var N=f[b];s.set(m,{bondOrder:N}),m.setBondOrder(N);for(var T=0,O=g.length;T<O;++T){var _=g[T];if(h(_)<0){C=!1;break}}if(C){if(!(i<n.length-1)){C=!0;break}if(C=this._doKekulizeContinousBondSys(i+1,n,o,s))break}}return!!C||(m.setBondOrder(a.EXPLICIT_AROMATIC),s.remove(m),!1)}},_splitConnectorsToContinuousParts:function(e){if(!e||!e.length)return null;for(var t=[],i=r.clone(e);i.length;){var n=i[0],a=function e(t,r){var i=r.indexOf(t);if(i<0)return[];r.splice(i,1);for(var n=[t],a=t.getNeighboringConnectors(),o=0,s=a.length;o<s;++o){var l=a[o];r.indexOf(l)>=0&&(n=n.concat(e(l,r)))}return n}(n,i);a&&a.length&&t.push(a)}return t}}),i.extend(e.StructureFragment,{perceiveAromaticRings:function(e,t){var r=this.hasCtab()?this.getCtab().perceiveAromaticRings(e,t):[];return this.setAromaticRings(r||[]),r},findAromaticRings:function(e,t){return this.perceiveAromaticRings(e,t)},getRingAromaticType:function(e,t){return this.hasCtab()?this.getCtab().getRingAromaticType(e,t):null},getHucklizationChanges:function(e,t){return this.hasCtab()?this.getCtab().getHucklizationChanges(e,t):[]},hucklize:function(e,t){return this.hasCtab()?this.getCtab().hucklize(e,t):[]},getKekulizationChanges:function(e,t){return this.hasCtab()?this.getCtab().getKekulizationChanges(e,t):[]},kekulize:function(e,t){return this.hasCtab()?this.getCtab().kekulize(e,t):[]}}),i.extend(e.ChemObject,{perceiveAromaticRings:function(e,t){for(var r=o.getAllStructFragments(this),i=[],n=0,a=r.length;n<a;++n){var s=r[n].perceiveAromaticRings(e,t);s&&(i=i.concat(s))}return i.length?i:null},findAromaticRings:function(e,t){return this.perceiveAromaticRings(e,t)},_groupActualTargetBondsOfKekulizationOrHucklization:function(e,t,r){var i=[];if(t)for(var n=0,a=t.length;n<a;++n)for(var o=t[n],s=0,l=e.length;s<l;++s){var d=e[s];o.isChildOf(d)&&(i[s]?i[s].bonds.push(o):i[s]={structFragment:d,bonds:[o]})}else for(var n=0,a=e.length;n<a;++n)i.push({structFragment:e[n],bonds:null});return i},getHucklizationChanges:function(e,t){for(var r=[],i=o.getAllStructFragments(this),n=this._groupActualTargetBondsOfKekulizationOrHucklization(i,e,t),a=0,s=n.length;a<s;++a){var l=n[a];l&&(r=r.concat(l.structFragment.getHucklizationChanges(l.bonds,t)||[]))}return r},hucklize:function(e,t){for(var r=[],i=o.getAllStructFragments(this),n=this._groupActualTargetBondsOfKekulizationOrHucklization(i,e,t),a=0,s=n.length;a<s;++a){var l=n[a];l&&(r=r.concat(l.structFragment.hucklize(l.bonds,t)||[]))}return r},getKekulizationChanges:function(e,t){for(var r=[],i=o.getAllStructFragments(this),n=this._groupActualTargetBondsOfKekulizationOrHucklization(i,e,t),a=0,s=n.length;a<s;++a){var l=n[a];l&&(r=r.concat(l.structFragment.getKekulizationChanges(l.bonds,t)||[]))}return r},kekulize:function(e,t){for(var r=[],i=o.getAllStructFragments(this),n=this._groupActualTargetBondsOfKekulizationOrHucklization(i,e,t),a=0,s=n.length;a<s;++a){var l=n[a];l&&(r=r.concat(l.structFragment.kekulize(l.bonds,t)||[]))}return r}}),e}},function(e,t,r){"use strict";var i=(r(0).Class,r(0).ClassEx);r(0).ObjectEx,r(0).DataType;e.exports=function(e){return e.globalOptions.add("algorithm.molStandardization",{cleanStructure:!0,clearHydrogens:!1,unmarshalSubFragments:!0,doCanonicalization:!0,doAromaticPerception:!0,doStereoPerception:!0}),e.MolStandardizer={standardize:function(t,r){var i=Object.extend({},e.globalOptions.algorithm.molStandardization),n=t,a=Object.extend(i,r);return a.unmarshalSubFragments&&n.unmarshalAllSubFragments(!0),a.cleanStructure&&n.clean(),a.clearHydrogens&&n.clearExplicitHydrogens(),a.doCanonicalization&&(e.Canonicalizer._compareOptions=r,e.canonicalizer.canonicalize(n,a.canonicalizerExecutorId||null)),a.doAromaticPerception&&n.perceiveAromaticRings(),a.doStereoPerception&&n.perceiveStereos(null,!0,a),n}},Object.extend(e.ChemStructureUtils,{compareStructFragment:function(t,r,i){var n=t.clone(!1),a=r.clone(!1);n.setCanonicalizationIndex(null),a.setCanonicalizationIndex(null);var o=Object.create(i||{});return n=e.MolStandardizer.standardize(n,o),a=e.MolStandardizer.standardize(a,o),o.doStandardize=!1,o.extraComparisonProperties=["canonicalizationIndex"],n.compareStructure(a,o)},isSameStructure:function(t,r,i){return 0===e.ChemStructureUtils.compareStructFragment(t,r,i)}}),i.extend(e.ChemObject,{standardize:function(t){for(var r=e.ChemStructureUtils.getAllStructFragments(this,!0),i=0,n=r.length;i<n;++i)r[i].standardize(t);return this}}),i.extend(e.StructureFragment,{standardize:function(t){return e.MolStandardizer.standardize(this,t)},isSameStructureWith:function(t,r){return e.ChemStructureUtils.isSameStructure(this,t,r)}}),i.extendMethod(e.StructureFragment,"compare",function(t,r,i){return i.method===e.ComparisonMethod.CHEM_STRUCTURE&&!1!==i.doStandardize&&r instanceof e.StructureFragment?e.ChemStructureUtils.compareStructFragment(this,r,i):t(r,i)}),e}},function(e,t,r){"use strict";var i=(r(0).Class,r(0).ClassEx);r(0).ObjectEx,r(0).DataType;e.exports=function(e){var t=e.ArrayUtils;e.globalOptions.add("algorithm.structureSearch",{doStandardize:!0}),e.ChemStructureSearcher={findSubStructure:function(i,n,a){var o=Object.extend(Object.extend({},e.globalOptions.algorithm.structureSearch),a);if(o.exactMatch){return!!n.isSameStructureWith(i,o)&&[].concat(n.getNodes()).concat(n.getConnectors())}o=Object.extend({level:e.StructureComparationLevel.CONSTITUTION,compareLinkedConnectorCount:!1,compareHydrogenCount:!1,compareConnectedObjCount:!1},o),o=e.ObjComparer.getStructureComparisonDetailOptions(o);var s=o;if(o.doStandardize){var l={unmarshalSubFragments:!1,doCanonicalization:!0,doAromaticPerception:!0};o.compareStereo||(l.doCanonicalization=!1),i.standardize(l),n.standardize(l)}for(var d=n.getFlattenedShadowFragment(!0),u=i.getFlattenedShadowFragment(!0),c=u.getNonHydrogenNodes()[0],h=d.getNonHydrogenNodes(),m=h.length,g=0,f=[],p=[],C=!1;!C&&g<m;)C=r._compareNode(c,h[g],f,p,s),++g;if(C){var b=t.toUnique(C);return n.getFlatternedShadowSourceObjs(b)}return!1},_addToComparedObjs:function(e,t,r){t.push(e)},_removeFromComparedObjs:function(e,t,r){var i=t.indexOf(e);t.length=i},_isSameMappedObj:function(e,t,r,i){var n=i.indexOf(t),a=r.indexOf(e);return n>=0&&n===a},_compareComparedNeighbors:function(e,t,r,i){if(e.length>t.length)return!1;for(var n=[],a=0,o=e.length;a<o;++a)n.push(r.indexOf(e[a]));for(var s=[],a=0,o=t.length;a<o;++a)s.push(i.indexOf(t[a]));for(var a=0,o=n.length;a<o;++a)if(s.indexOf(n[a])<0)return!1;return!0},_compareNode:function(e,i,n,a,o){if(0!==e.compareStructure(i,o))return!1;var s=e.getLinkedNonHydrogenConnectors(),l=i.getLinkedNonHydrogenConnectors();if(s.length>l.length)return!1;var d=t.clone(n),u=t.clone(a);r._addToComparedObjs(e,d,"target"),r._addToComparedObjs(i,u,"src");var c=t.intersect(s,d),h=t.intersect(l,u),m=!0;r._compareComparedNeighbors(c,h,d,u)?(s=t.exclude(s,c),l=t.exclude(l,h),s.length>l.length&&(m=!1)):m=!1;for(var g=[];m&&s.length;){for(var f,p=!1,C=s.shift(),b=0;l.length&&!p&&b<l.length;)f=l[b],p=r._compareConnector(C,f,d,u,o),p&&(g=g.concat(p)),++b;if(!p){m=!1;break}t.remove(l,f)}return m&&(m=[i].concat(g)),m},_compareConnector:function(i,n,a,o,s){if(0!==i.compareStructure(n,s))return!1;if(i.getConnectedObjCount()>n.getConnectedObjCount())return!1;var l=t.clone(a),d=t.clone(o);r._addToComparedObjs(i,l,"target"),r._addToComparedObjs(n,d,"src");var u=t.clone(i.getConnectedObjs()),c=t.clone(n.getConnectedObjs()),h=t.intersect(u,l),m=t.intersect(c,d),g=!0;r._compareComparedNeighbors(h,m,l,d)?(u=t.exclude(u,h),c=t.exclude(c,m),u.length>c.length&&(g=!1)):g=!1;for(var f=[];g&&u.length;){for(var p,C=!1,b=u.shift(),E=0;c.length&&!C&&E<c.length;)p=c[E],C=p.getClass()===b.getClass()&&(p instanceof e.ChemStructureNode?r._compareNode(b,p,l,d,s):p instanceof e.ChemStructureConnector&&r._compareConnector(b,p,l,d,s)),C&&(f=f.concat(C)),++E;if(!C){g=!1;break}t.remove(c,p)}return g&&(g=[n].concat(f)),g}};var r=e.ChemStructureSearcher;return i.extend(e.StructureFragment,{search:function(e,t){return r.findSubStructure(e,this,t)}}),e}},function(e,t,r){"use strict";var i=r(0).Class,n=r(0).ClassEx;r(0).ObjectEx,r(0).DataType;e.exports=function(e){var t=e.ArrayUtils,r=e.CoordUtils;e.RotationDir={CLOCKWISE:1,ANTICLOCKWISE:-1,UNKNOWN:0};var a=e.RotationDir;return e.globalOptions.add("algorithm.stereoPerception",{useFlattenedShadow:!0,perceiveStereoConnectors:!0,perceiveChiralNodes:!0,calcParity:!0,strictStereoBondGeometry:!1,strictStereoAtomGeometry:!1,wedgeBondPrior:!0}),e.MolStereoUtils={FISCHER_PROJECTION_BOND_ALLOWED_ERROR:.08,getDihedralAngleOfNodes:function(t,r,i,n,a,o){e.ObjUtils.isUnset(o)&&(o=!0),e.ObjUtils.isUnset(a)&&(a=r.hasCoord3D()?e.CoordMode.COORD3D:e.CoordMode.COORD2D);var s=e.MolStereoUtils._getNodeCoordForBondParity,l=r.getConnectorTo(i),d=l&&l.isDoubleBond&&l.isDoubleBond(),u=s(r,null,null,a,o),c=s(i,null,null,a,o),h=s(t,r,u,a,o,d),m=s(n,i,c,a,o,d);if(h&&u&&c&&m){return e.GeometryUtils.getDihedralAngleOfPoints(h,u,c,m)}return-1},getParityOfNodeSeq:function(t,r,i,n,a,o){var s=e.StereoParity,l=e.MolStereoUtils.getDihedralAngleOfNodes(t,r,i,n,a,o);return-1===l?s.LINEAR:l<0?s.UNKNOWN:l<2*Math.PI/5||l>8*Math.PI/5?s.ODD:l>3*Math.PI/5&&l<7*Math.PI/5?s.EVEN:s.UNKNOWN},_getNodeCoordForBondParity:function(t,i,n,a,o,s){if(a!==e.CoordMode.COORD2D)return t.getAbsCoordOfMode(a,!0);var l=t.getAbsCoordOfMode(a,!0);if(i&&n){var d=t.getConnectorTo(i);if(d&&d.getStereo){var u=d.getStereo(),c=e.BondStereo,h=[c.UP,c.UP_INVERTED,c.DOWN,c.DOWN_INVERTED];if(h.indexOf(u)>=0){d.indexOfConnectedObj(t)-d.indexOfConnectedObj(i)<0&&(u=c.getInvertedDirection(u));var m=[1,-1,-1,1],g=r.getDistance(l,n);l.z=g*m[h.indexOf(u)]}else if([c.UP_OR_DOWN,c.UP_OR_DOWN_INVERTED].indexOf(u)>=0)return null}}return l.z=l.z||0,l},_calcParityOfCoordPairs:function(t,i,n,a,o,s,l){var d=e.StereoParity,u=r.substract(i,t);if(!u.x&&!u.y)return d.UNKNOWN;for(var c=Math.atan2(u.y,u.x),h=r.calcTransform2DMatrix({rotateAngle:-c,center:t,translateX:-t.x,translateY:-t.y}),m=[t,i,n,a,o,s],g=[],f=0,p=m.length;f<p;++f){var C=m[f];g[f]=C?r.transform2DByMatrix(C,h):null}var b=(g[0],g[1]),E=g[2],N=g[3],T=r.substract(g[4],b),O=g[5]?r.substract(g[5],b):null,_=function(e,t,r,i){var n=0,a=Math.sqrt(Math.sqr(e.x)+Math.sqr(e.y));if(t){var o=Math.sqrt(Math.sqr(t.x)+Math.sqr(t.y)),s=e.y/a-t.y/o;if(Math.abs(s)<r)n=0;else if(Math.sign(e.y)!==Math.sign(t.y))n=Math.sign(s)*i;else{if(l)return 0;var d=e.x/e.y,u=t.x/t.y;s=-(d-u),n=Math.sign(s)}}else{var s=e.y/a;n=Math.abs(s)<r?0:Math.sign(e.y)}return n},S=_(E,N,.05,-1),v=_(T,O,.05,1);return S&&v?S===v?d.ODD:d.EVEN:d.UNKNOWN},isStereoBond:function(r){var i=e.ObjUtils.isUnset;if(r.getBelongedRingMinSize){var n=r.getBelongedRingMinSize()||0;if(n>0&&n<=10)return!1}var a=!1;if(r.isDoubleBond&&r.isDoubleBond()&&2===r.getConnectedObjCount()){var o=r.getConnectedChemNodes();if(2===o.length)for(var a=!0,s=0;s<2;++s){var l=o[s],d=l.getHydrogenCount(!0),u=t.exclude(l.getLinkedChemNodes(),o);if(d>=2||!u.length){a=!1;break}if(1===u.length);else if(2===u.length&&(i(u[0].getCanonicalizationIndex())&&i(u[1].getCanonicalizationIndex())||u[0].getCanonicalizationIndex()===u[1].getCanonicalizationIndex())){a=!1;break}for(var c=0,h=u.length;c<h;++c){var m=l.getConnectorTo(u[c]);if(!m.isSingleBond||!m.isSingleBond()){a=!1;break}}if(!a)break}}else a=!1;return a},doFindStereoBonds:function(t,r){var i=[];r||e.canonicalizer.canonicalize(t,"morganEx");for(var n=0,a=t.getConnectorCount();n<a;++n){var o=t.getConnectorAt(n);e.MolStereoUtils.isStereoBond(o)&&i.push(o)}return i},getStereoBondKeyNodes:function(e){var r=null;if(2===e.getConnectedObjCount()){var i=e.getConnectedChemNodes();if(2===i.length){for(var n=[],a=0;a<2;++a){var o=i[a],s=t.exclude(o.getLinkedChemNodes(),i);if(1===s.length)n.push(s[0]);else{if(2!==s.length)return null;var l=s[0].getCanonicalizationIndex()||-1,d=s[1].getCanonicalizationIndex()||-1;n.push(d>l?s[1]:s[0])}}r=[n[0],i[0],i[1],n[1]]}}return r},getStereoBondRelNodes:function(e){var r=null;if(2===e.getConnectedObjCount()){var i=e.getConnectedChemNodes();if(2===i.length){for(var n=[],a=0;a<2;++a){var o=i[a],s=t.exclude(o.getLinkedChemNodes(),i);if(1===s.length)n.push(s[0]),n.push(null);else{if(2!==s.length)return null;var l=s[0].getCanonicalizationIndex()||-1,d=s[1].getCanonicalizationIndex()||-1;n.push(d>l?s[1]:s[0]),n.push(d>l?s[0]:s[1])}}r=[i[0],i[1],n[0],n[1],n[2],n[3]]}}return r},calcStereoBondParity:function(t,r,i,n){var a=e.StereoParity;if(!i&&!e.MolStereoUtils.isStereoBond(t))return a.NONE;if(t.getStereo&&[e.BondStereo.E_OR_Z,e.BondStereo.CIS_OR_TRANS].indexOf(t.getStereo())>=0)return a.NONE;var o=a.UNKNOWN,s=e.MolStereoUtils.getStereoBondKeyNodes(t);if(s&&s.length){if(e.ObjUtils.isUnset(r)&&(r=s[1].hasCoord3D()?e.CoordMode.COORD3D:e.CoordMode.COORD2D),r===e.CoordMode.COORD3D){var l=e.MolStereoUtils.getDihedralAngleOfNodes(s[0],s[1],s[2],s[3],r);if(l<0||l>2*Math.PI/5&&l<3*Math.PI/5||l>7*Math.PI/5&&l<8*Math.PI/5)return a.UNKNOWN}var d=e.MolStereoUtils._getNodeCoordForBondParity,u=e.MolStereoUtils.getStereoBondRelNodes(t),c=[d(u[0],null,null,r,!0),d(u[1],null,null,r,!0)];c=c.concat([d(u[2],u[0],c[0],r,!0,!0),u[3]?d(u[3],u[0],c[0],r,!0,!0):null,d(u[4],u[1],c[1],r,!0,!0),u[5]?d(u[5],u[1],c[1],r,!0,!0):null]);for(var h=r===e.CoordMode.COORD2D?[["x","y"]]:[["x","y"],["x","z"],["y","z"]],m=null,g=0,f=h.length;g<f;++g){for(var p=[],C=0,b=c.length;C<b;++C)c[C]?p.push(function(e,t){return e?{x:e[t[0]],y:e[t[1]]}:null}(c[C],h[g])):p.push(null);var E=e.MolStereoUtils._calcParityOfCoordPairs(p[0],p[1],p[2],p[3],p[4],p[5],n);if(E!==a.UNKNOWN)if(null===m)m=E;else if(m!==E)return a.UNKNOWN}o=m}return o},doPerceiveStereoConnectors:function(t,r,i,n){var a=e.MolStereoUtils.doFindStereoBonds(t,i);t.beginUpdate();try{if(a&&a.length)for(var o=0,s=a.length;o<s;++o){var l=a[o],d=e.MolStereoUtils.calcStereoBondParity(l,r,!0,n);l.setParity&&l.setParity(d)}}finally{t.endUpdate()}return a},isChiralNode:function(e){var t=!1;if(e.mayContainElement){var r,i,n=null,a=!1;if(e.mayContainElement("C")||e.mayContainElement("Si")?(r=4,i=0,n=[0],a=!0):e.mayContainElement("N")?(r=4,i=0,a=!0):e.mayContainElement("S")||e.mayContainElement("P")?(r=3,i=0,a=!0):e.mayContainElement("B")&&(r=3,i=0,n=[-1],a=!0),a){if(e.getLinkedMultiCenterBonds().length)return!1;var o=e.getLinkedChemNodes(),s=e.getLinkedMultipleBonds(),l=e.getHydrogenCount?e.getHydrogenCount():0,d=e.getHydrogenCount?e.getHydrogenCount(!0):0,u=e.getCharge()||0;if(s.length>i||d>=2||o.length+l<r||n&&n.indexOf(u)<0)t=!1;else{t=!0;for(var c=[],h=0,m=o.length;h<m;++h){var g=o[h],f=g.getCanonicalizationIndex()||0;if(c[f]){t=!1;break}c[f]=1}}}}return t},doFindChiralNodes:function(t,r){var i=[];r||e.canonicalizer.canonicalize(t,"morganEx");for(var n=0,a=t.getNodeCount();n<a;++n){var o=t.getNodeAt(n);e.MolStereoUtils.isChiralNode(o)&&i.push(o)}return i},calcRotationDirection:function(t,i,n,o,s,l){var d,u,c=l?r.substract(t,i):r.substract(i,t),h=null;0!==c.x||0!==c.y?(d=e.GeometryUtils.getVectorCrossProduct(c,{x:0,y:0,z:1}),u=e.GeometryUtils.getVectorIncludedAngle(c,{x:0,y:0,z:1}),c.z<0&&(u=Math.PI-u)):c.z<0&&(d={x:1,y:0,z:0},u=Math.PI),d&&u&&(h=r.calcRotate3DMatrix({rotateAngle:u,rotateAxisVector:d,center:{x:0,y:0,z:0}}));var m=r.substract(n,t),g=r.substract(o,t),f=r.substract(s,t);h&&(m=r.transform3DByMatrix(m,h),g=r.transform3DByMatrix(g,h),f=r.transform3DByMatrix(f,h));var u=-Math.atan2(m.y,m.x),h=r.calcTransform2DMatrix({rotateAngle:u,center:{x:0,y:0,z:0}}),p=r.transform2DByMatrix(g,h),C=r.transform2DByMatrix(f,h);if(0===p.x||0===C.x)return a.UNKNOWN;var b=Math.atan2(p.y,p.x),E=Math.atan2(C.y,C.x);return E<0&&(E=2*Math.PI+E),b<0&&(b=2*Math.PI+b),b<E?a.ANTICLOCKWISE:b>E?a.CLOCKWISE:a.UNKNOWN},_getFischerProjectionInfo:function(t,i,n){var a=Object.create(n||null);if(a.allowExplicitVerticalHydrogen=!0,a.allowExplicitHydrogen=!0,i.length<3||i.length>4)return null;if(3===i.length&&!a.allowExplicitHydrogen)return null;var o=e.CoordMode.COORD2D,s=a.allowedError||e.MolStereoUtils.FISCHER_PROJECTION_BOND_ALLOWED_ERROR;if(!a.ignoreStructure){var l=t instanceof e.Atom&&6===t.getAtomicNumber();if(l&&t.getRenderOption&&(l=t.getRenderOption("nodeDisplayMode")!==e.Render.NodeLabelDisplayMode.SHOWN),!l)return null}for(var d=t.getAbsCoordOfMode(o,!0),u=[],c=0,h=0,m=i.length;h<m;++h){var g=i[h];if(!a.ignoreStructure){var f=g.getConnectorTo(t),p=f.getStereo()||e.BondStereo.NONE;if(!(f instanceof e.Bond&&p===e.BondStereo.NONE))return null}var C=g.getAbsCoordOfMode(o,!0),b=r.substract(C,d),E=Math.abs(b.x),N=Math.abs(b.y);if(e.NumUtils.isFloatEqual(E,0)&&e.NumUtils.isFloatEqual(N,0))return null;var T,O;if(E>N?(O=N/E,T=b.x>0?1:3):(O=E/N,T=b.y>0?0:2,++c),O>s)return null;if(!function(e,t,r){return!e[t]&&(e[t]=r,!0)}(u,T,g))return null}if(2!==c&&!a.allowExplicitVerticalHydrogen)return null;var _={horizontalSiblings:[u[3],u[1]],verticalSiblings:[u[0],u[2]]};return a.reversedDirection?(_.towardSiblings=_.verticalSiblings,_.awaySiblings=_.horizontalSiblings,_.implicitTowardSibling=!u[0]||!u[2],_.implicitAwaySibling=!u[1]||!u[3]):(_.towardSiblings=_.horizontalSiblings,_.awaySiblings=_.verticalSiblings,_.implicitTowardSibling=!u[1]||!u[3],_.implicitAwaySibling=!u[0]||!u[2]),_},calcTetrahedronChiralCenterRotationDirectionEx:function(i,n,o,s){var l=Object.extend({implicitFischerProjection:!0,allowExplicitHydrogenInFischer:!0},s),d=l.coordMode,u=!!l.withImplicitSibling,c=!!l.refSiblingBehind;l.implicitFischerProjection;if(!d){var h=i||n||o[0];if(!h)return a.UNKNOWN;d=h.hasCoord3D()?e.CoordMode.COORD3D:e.CoordMode.COORD2D}var m=d===e.CoordMode.COORD2D,g=o.length,f=g;if(n&&++f,u&&++f,f<4)return a.UNKNOWN;var p=function(t,i,n,a,o){if(a!==e.CoordMode.COORD2D)return t.getAbsCoordOfMode(a,!0);var s,d=t.getAbsCoordOfMode(a,!0);if(i&&n){s=n.z;var u=t.getConnectorTo(i);if(u.getStereo){var c=u.indexOfConnectedObj(t)-u.indexOfConnectedObj(i),h=e.BondStereo,m=u.getStereo()||h.NONE;m===h.NONE&&o&&(o.towardSiblings.indexOf(t)>=0?m=c<0?h.UP_INVERTED:h.UP:o.awaySiblings.indexOf(t)>=0&&(m=c<0?h.DOWN_INVERTED:h.DOWN));var g=[h.UP,h.UP_INVERTED,h.DOWN,h.DOWN_INVERTED];if(g.indexOf(m)>=0){c<0&&(m=h.getInvertedDirection(m));var f=l.wedgeBondPrior?[2,-2,-1,-1]:[1,-1,-1,1],p=r.getDistance(d,n);d.z=p*f[g.indexOf(m)]}else if([h.UP_OR_DOWN,h.UP_OR_DOWN_INVERTED].indexOf(m)>=0)return null}}return e.ObjUtils.isUnset(d.z)&&t.getZIndex2D&&(d.z=t.getZIndex2D(),e.ObjUtils.isUnset(d.z)&&(d.z=s)),d.z=d.z||0,d},C=i?p(i,null,null,d):null,b={allowedError:l.fischerAllowedError,reversedDirection:l.reversedFischer,allowExplicitHydrogen:l.allowExplicitHydrogenInFischer,allowExplicitVerticalHydrogen:l.allowExplicitVerticalHydrogen},E=[].concat(o);n&&e.ArrayUtils.pushUnique(E,n);for(var N=i&&l.implicitFischerProjection?e.MolStereoUtils._getFischerProjectionInfo(i,E,b):null,T=[],O=0;O<g;++O){var _=p(o[O],i,C,d,N);T.push(_)}var S=t.clone(T),v=n?p(n,i,C,d,N):null;if(v&&S.push(v),S.indexOf(null)>=0)return a.UNKNOWN;if(!C){for(var y={},O=0,A=S.length;O<A;++O)y=r.add(S[O],y);C=r.divide(y,S.length)}for(var M=0,O=0,A=S.length;O<A;++O){var I=S[O],R=r.substract(I,C);I.x=R.x,I.y=R.y,I.z=R.z,m&&R.z&&++M}if(m&&M<=0)return a.UNKNOWN;if(C={x:0,y:0,z:0},u){for(var L=0,y={},O=0,A=S.length;O<A;++O)y=r.add(S[O],y),L=Math.max(L,S[O].z||0);var x=r.substract({x:0,y:0,z:0},y);N&&(N.implicitTowardSibling||N.implicitTowardSibling)&&(x.z=N.implicitTowardSibling?L:-L),n?T.push(x):v=x}return 3===T.length&&T.indexOf(null)<0?e.MolStereoUtils.calcRotationDirection(C,v,T[0],T[1],T[2],c):a.UNKNOWN},calcTetrahedronChiralCenterRotationDirection:function(t,r,i,n,a,o,s){var l=Object.create(s);return e.MolStereoUtils.calcTetrahedronChiralCenterRotationDirectionEx(r,i,n,Object.extend(l,{coordMode:t,withImplicitSibling:a,refSiblingBehind:o}))},calcTetrahedronChiralNodeParity:function(t,r,i){var n=Object.create(i||null);r||(r=t.hasCoord3D()?e.CoordMode.COORD3D:e.CoordMode.COORD2D),n.coordMode=r,n.refSiblingBehind=!0;var o=e.StereoParity;if(!n.ignoreChiralCheck&&!e.MolStereoUtils.isChiralNode(t))return o.NONE;var s=t.getLinkedChemNodes();if(r===e.CoordMode.COORD2D&&i.strictStereoAtomGeometry&&!e.MolStereoUtils._isSiblingBond2DGeometryLegal(t,s))return o.UNKNOWN;var l=t.getHydrogenCount();n.withImplicitSibling=!!l||s.length<4,s.sort(function(e,t){return-((e.getCanonicalizationIndex()||0)-(t.getCanonicalizationIndex()||0))});var d=n.withImplicitSibling?null:s[3];s=s.slice(0,3);var u=e.MolStereoUtils.calcTetrahedronChiralCenterRotationDirectionEx(t,d,s,n);return u===a.CLOCKWISE?o.ODD:u===a.ANTICLOCKWISE?o.EVEN:o.UNKNOWN},_isSiblingBond2DGeometryLegal:function(t,r){for(var i=e.BondStereo,n=[i.NONE,i.CLOSER],a=[2,2],o=[],s=0,l=r.length;s<l;++s){var d=r[s];if(!d.getZIndex2D()){var u=t.getConnectorTo(d);if(u.getStereo){var c=u.getStereo();if(n.indexOf(c)>=0)if(o[c]){if(++o[c]>a[c])return!1}else o[c]=1}}}return!0},doPerceiveChiralNodes:function(t,r,i,n){var a=Object.create(n||null),o=Object.create(a);o.ignoreChiralCheck=!0;var s=e.MolStereoUtils.doFindChiralNodes(t,i);t.beginUpdate();try{if(s&&s.length)for(var l=0,d=s.length;l<d;++l){var u=s[l],c=e.MolStereoUtils.calcTetrahedronChiralNodeParity(u,r,o);u.setParity&&u.setParity(c)}}finally{t.endUpdate()}return s},perceiveStereos:function(t,r,i,n){var a,o,s=Object.extend(Object.extend({},e.globalOptions.algorithm.stereoPerception),n),l=t instanceof e.StructureConnectionTable?t.getParent():t;o=s.useFlattenedShadow?l.getFlattenedShadowFragment(!0):l,i||e.canonicalizer.canonicalize(o,"morganEx"),o.beginUpdate();try{var d,u;s.perceiveStereoConnectors&&(d=s.calcParity?e.MolStereoUtils.doPerceiveStereoConnectors(o,r,!0,s.strictStereoBondGeometry):e.MolStereoUtils.doFindStereoBonds(o,!0)),s.perceiveChiralNodes&&(u=s.calcParity?e.MolStereoUtils.doPerceiveChiralNodes(o,r,!0,s):e.MolStereoUtils.doFindChiralNodes(o,!0));var c=(u||[]).concat(d||[]);if(s.useFlattenedShadow&&!l.getFlattenedShadowOnSelf()){a=[],l.beginUpdate();try{for(var h=0,m=c.length;h<m;++h){var g=l.getFlatternedShadowSourceObj(c[h]);g&&(s.calcParity&&g.setParity(c[h].getParity()),a.push(g))}}finally{l.endUpdate()}}else a=c}finally{o.endUpdate()}return a},findStereoConnectors:function(t,r){return e.MolStereoUtils.perceiveStereos(t,null,r,{perceiveStereoConnectors:!0,perceiveChiralNodes:!1,calcParity:!1})},perceiveStereoConnectors:function(t,r,i,n){return e.MolStereoUtils.perceiveStereos(t,r,i,{perceiveStereoConnectors:!0,perceiveChiralNodes:!1,calcParity:!0,strictStereoBondGeometry:n})},findChiralNodes:function(t,r){return e.MolStereoUtils.perceiveStereos(t,null,r,{perceiveStereoConnectors:!1,perceiveChiralNodes:!0,calcParity:!1})},perceiveChiralNodes:function(t,r,i,n){var a=Object.create(n||null);return a=Object.extend(a,{perceiveStereoConnectors:!1,perceiveChiralNodes:!0,calcParity:!0}),e.MolStereoUtils.perceiveStereos(t,r,i,a)}},e.CanonicalizationMorganExIndexer=i.create(e.CanonicalizationMorganIndexer,{CLASS_NAME:"Kekule.CanonicalizationMorganExIndexer",doExecute:function($super,t){var r=this.doCalcGraphAndEcResult(t);this.doExecuteOnGraphEcResult(r.graph,r.ecMapping,r.vertexGroup);var i=t.getNonHydrogenNodes(),n=this._groupNodesByCanoIndex(i),a=null,o=0;for(a=e.MolStereoUtils.perceiveStereos(t,null,!0)||[];o<a.length;)n=this._regroupSortedNodes(n),this._setCanonicalizationIndexToNodeGroups(n),o=a.length,a=e.MolStereoUtils.perceiveStereos(t,null,!0)||[];o>0&&this.doExecuteOnGraphEcResult(r.graph,r.ecMapping,r.vertexGroup)},_groupNodesByCanoIndex:function(e){return t.group(e,function(e,t){return(e.getCanonicalizationIndex()||-1)-(t.getCanonicalizationIndex()||-1)})},_regroupSortedNodes:function(e){var t,r,i=e;do{t=i.length,i=this._doRegroupSortedNodes(i),r=i.length}while(r>t);return i},_doRegroupSortedNodes:function(r){for(var i=[],n=0,a=r.length;n<a;++n){var o=r[n];if(t.isArray(o)){var s=t.group(o,function(t,r){var i=t.compareStructure(r);if(0===i){var n=t.getLinkedConnectors(),a=r.getLinkedConnectors();i=e.ObjComparer.compareStructure(n,a)}return i});i=i.concat(s)}else i.push(o)}return i}}),e.canonicalizer.registerExecutor("morganEx",[e.CanonicalizationMorganExIndexer,e.CanonicalizationMorganNodeSorter],!0),n.extend(e.StructureFragment,{perceiveChiralNodes:function(t,r,i){return e.MolStereoUtils.perceiveChiralNodes(this,t,r,i)},perceiveStereoConnectors:function(t,r){return e.MolStereoUtils.perceiveStereoConnectors(this,t,r)},perceiveStereos:function(t,r,i){return e.MolStereoUtils.perceiveStereos(this,t,r,i)}}),e}},function(e,t,r){"use strict";e.exports=function(e){return e.ChemWidget={},e.ChemWidget.AbstractWidget=e.Widget.BaseWidget,e.ChemWidget.ComponentWidgetNames={menu:"menu",newDoc:"newDoc",clearObjs:"clearObjs",loadFile:"loadFile",loadData:"loadData",saveData:"saveData",zoomIn:"zoomIn",zoomOut:"zoomOut",resetZoom:"resetZoom",rotateRight:"rotateRight",rotateLeft:"rotateLeft",rotateX:"rotateX",rotateY:"rotateY",rotateZ:"rotateZ",reset:"reset",molDisplayType:"molDisplayType",molDisplayTypeCondensed:"molDisplayTypeCondensed",molDisplayTypeSkeletal:"molDisplayTypeSkeletal",molDisplayTypeWire:"molDisplayTypeWire",molDisplayTypeSticks:"molDisplayTypeSticks",molDisplayTypeBallStick:"molDisplayTypeBallStick",molDisplayTypeSpaceFill:"molDisplayTypeSpaceFill",molHideHydrogens:"molHideHydrogens",openEditor:"openEditor",config:"config",objInspector:"objInspector",undo:"undo",redo:"redo",copy:"copy",cut:"cut",paste:"paste",cloneSelection:"cloneSelection",toggleSelect:"toggleSelect",dragScroll:"dragScroll",erase:"erase",manipulate:"manipulate",trackInput:"trackInput",molBond:"bond",molAtom:"atom",molFormula:"formula",molAtomAndFormula:"atomAndFormula",molCharge:"charge",textBlock:"textBlock",imageBlock:"imageBlock",molRing:"ring",glyph:"glyph",textImage:"textImage",fontName:"fontName",fontSize:"fontSize",color:"color",textDirection:"textDirection",textAlign:"textAlign",nodeDisplayMode:"nodeDisplayMode"},e.ChemWidget.HtmlClassNames={PREFIX:"K-Chem-",INNER_TOOLBAR:"K-Chem-InnerToolbar"},e}},function(e,t,r){"use strict";var i=r(0).Class,n=(r(0).ClassEx,r(0).ObjectEx,r(0).DataType);e.exports=function(e){var t=(i.PropertyScope,e.ChemWidget,e.Widget.HtmlClassNames,e.ChemWidget.HtmlClassNames);return e.ChemWidget.HtmlClassNames=Object.extend(e.ChemWidget.HtmlClassNames,{DIALOG_LOADDATA:"K-Chem-Dialog-LoadData",DIALOG_LOADDATA_FORMATBOX:"K-Chem-Dialog-LoadData-FormatBox",DIALOG_LOADDATA_SRCEDITOR_REGION:"K-Chem-Dialog-LoadData-SrcEditorRegion",DIALOG_LOADDATA_SRCEDITOR:"K-Chem-Dialog-LoadData-SrcEditor",DIALOG_LOADDATA_BTN_LOADFROMFILE:"K-Chem-Dialog-LoadData-Btn-LoadFromFile",DIALOG_LOADAPPENDDATA:"K-Chem-Dialog-LoadAppendData",DIALOG_LOADAPPENDDATA_APPENDCHECKBOX:"K-Chem-Dialog-LoadAppendData-AppendCheckBox"}),e.ChemWidget.LoadDataDialog=i.create(e.Widget.Dialog,{CLASS_NAME:"Kekule.ChemWidget.LoadDataDialog",initialize:function($super,t,r,i){this._openFileAction=new e.ActionLoadFileData,this._openFileAction.setBinaryDetector(this._detectBinaryFormat),this._openFileAction.update(),this._openFileAction.addEventListener("load",this.reactFileLoad,this),this._sBtnLoadFromFile=e.$L("ChemWidgetTexts.CAPTION_LOADDATA_FROM_FILE"),this._formatItems=null,$super(t,r||e.$L("ChemWidgetTexts.CAPTION_LOADDATA_DIALOG"),i||[e.Widget.DialogButtons.OK,e.Widget.DialogButtons.CANCEL]),this.setResizable&&this.setResizable(!0)},finalize:function($super){this._openFileAction.finalize(),$super()},initProperties:function(){this.defineProp("chemObj",{dataType:"Kekule.ChemObject",serializable:!1,setter:null}),this.defineProp("allowedFormatIds",{dataType:n.ARRAY,setter:function(e){this.setPropStoreFieldValue("allowedFormatIds",e),this.updateFormatItems()}})},initPropValues:function($super){$super(),this.setAutoAdjustSizeOnPopup(!0)},doGetWidgetClassName:function($super){return $super()+" "+t.DIALOG_LOADDATA},doCreateClientContents:function($super,r){$super();var i=this.getDocument(),n=i.createElement("div");n.innerHTML=e.$L("ChemWidgetTexts.CAPTION_DATA_FORMAT"),r.appendChild(n),n=i.createElement("div"),r.appendChild(n);var a=new e.Widget.SelectBox(this);a.addClassName(t.DIALOG_LOADDATA_FORMATBOX),a.appendToElem(n),this._formatSelector=a,this.updateFormatItems();var n=i.createElement("div");n.innerHTML=e.$L("ChemWidgetTexts.CAPTION_DATA_SRC"),r.appendChild(n),n=i.createElement("div"),n.className=t.DIALOG_LOADDATA_SRCEDITOR_REGION,r.appendChild(n);var o=new e.Widget.TextEditor(this);o.setWrap("off").setAutoWrapThreshold(!0).setFileDroppable(!0),o.setToolbarPos(e.Widget.Position.BOTTOM),o.addClassName(t.DIALOG_LOADDATA_SRCEDITOR),o.appendToElem(n),this._dataEditor=o},getFormatSelectorItems:function(t){for(var r=[],i=this.getAllowedFormatIds()||e.IO.ChemDataReaderManager.getAllReadableFormatIds(),n=0,a=i.length;n<a;++n){var o=e.IO.DataFormatsManager.getFormatInfo(i[n]);if(o){for(var s=e.ArrayUtils.clone(e.ArrayUtils.toArray(o.fileExts)),l=0,d=s.length;l<d;++l)s[l]="*."+s[l];var u=s.join(", "),c=o.title;u&&(c+=" ("+u+")"),r.push({value:o.mimeType,text:c,title:o.mimeType,data:o})}}return r.sort(function(e,t){return e.text<t.text?-1:e.text>t.text?1:0}),r},getFileFilters:function(t){for(var r=[],i=0,n=t.length;i<n;++i){var a=t[i],o=a.data,s=a.text||a.title||a.value,l=e.ArrayUtils.toArray(o.fileExts);r.push({title:s,filter:"."+l.join(",.")})}return r.push(e.NativeServices.FILTER_ALL_SUPPORT),r.push(e.NativeServices.FILTER_ANY),r},updateFormatItems:function(){this._formatItems=this.getFormatSelectorItems(),this._formatSelector.setItems(this._formatItems);var e=this.getFileFilters(this._formatItems);this._openFileAction.setFilters(e)},doSetButtons:function($super,r){var i=r||[];i.indexOf(this._sBtnLoadFromFile)<0&&i.unshift(this._sBtnLoadFromFile),$super(i);var n=this.getDialogButton(this._sBtnLoadFromFile);n.setAction(this._openFileAction),n.linkStyleResource(e.Widget.StyleResourceNames.BUTTON_LOAD_FILE),n.addClassName(t.DIALOG_LOADDATA_BTN_LOADFROMFILE),n.setEnabled(this._openFileAction.getEnabled())},reactFileLoad:function(t){var r,i=t.data,n=t.fileName;try{if(t.success&&i&&n){r=e.IO.loadTypedData(i,null,n),this.setPropStoreFieldValue("chemObj",r);var a=e.Widget.DialogButtons.OK;this.close(a)}else r=null}catch(t){e.error(t)}},open:function($super,e,t,r){return this.setPropStoreFieldValue("chemObj",null),$super(e,t,r)},close:function($super,t){if(!this.getChemObj()&&this.isPositiveResult(t)){var r=this._dataEditor.getValue(),i=this._formatSelector.getValue();try{var n=e.IO.loadTypedData(r,i);n?this.setPropStoreFieldValue("chemObj",n):e.error(e.$L("ErrorMsg.LOAD_CHEMDATA_FAILED"))}catch(t){e.raise(t,e.ExceptionLevel.ERROR)}}return $super(t)},_detectBinaryFormat:function(t,r){if(r&&t){var i=e.UrlUtils.extractFileExt(t),n=e.IO.DataFormatsManager.findFormat(null,i);if(n){return e.IO.ChemDataType.isBinaryType(n.dataType)}}return!1}}),e.ChemWidget.LoadOrAppendDataDialog=i.create(e.ChemWidget.LoadDataDialog,{CLASS_NAME:"Kekule.ChemWidget.LoadOrAppendDataDialog",initialize:function($super,e,t,r){this._appendCheckBox=null,$super(e,t,r)},initProperties:function(){this.defineProp("displayAppendCheckBox",{dataType:n.BOOL}),this.defineProp("isAppending",{dataType:n.BOOL,serializable:!1,getter:function(){return this._appendCheckBox&&this._appendCheckBox.getChecked()},setter:function(e){this._appendCheckBox&&this._appendCheckBox.setChecked(!!e)}})},doGetWidgetClassName:function($super){return $super()+" "+t.DIALOG_LOADAPPENDDATA},doCreateClientContents:function($super,r){$super(r);var i=(this.getDocument(),new e.Widget.CheckBox(this));i.addClassName(t.DIALOG_LOADAPPENDDATA_APPENDCHECKBOX),i.setText(e.$L("ChemWidgetTexts.CAPTION_LOADDATA_DIALOG_APPENDMODE")),i.appendToElem(r),i.setDisplayed(this.getDisplayAppendCheckBox()),this._appendCheckBox=i},open:function($super,e,t,r){return this.setIsAppending(!1),this._appendCheckBox.setDisplayed(this.getDisplayAppendCheckBox()),$super(e,t,r)}}),e}},function(e,t,r){"use strict";var i=r(0).Class,n=(r(0).ClassEx,r(0).ObjectEx,r(0).DataType);e.exports=function(e){var t=e.DomUtils,r=e.HtmlElementUtils,a=e.Widget.HtmlClassNames,o=e.ChemWidget.HtmlClassNames;return e.ChemWidget.HtmlClassNames=Object.extend(e.ChemWidget.HtmlClassNames,{PERIODIC_TABLE:"K-Chem-Periodic-Table",PERIODIC_TABLE_MINI:"K-Chem-Periodic-Table-Mini",PERIODIC_TABLE_LEGEND:"K-Chem-Periodic-Table-Legend",PERIODIC_TABLE_LEGEND_CONTENT:"K-Chem-Periodic-Table-Legend-Content",PERIODIC_TABLE_LEGEND_COLORS:"K-Chem-Periodic-Table-Legend-Colors",PERIODIC_TABLE_LEGEND_COLOR:"K-Chem-Periodic-Table-Legend-Color",PERIODIC_TABLE_MAINTABLE:"K-Chem-Periodic-Table-MainTable",PERIODIC_TABLE_EXTRATABLE:"K-Chem-Periodic-Table-ExtraTable",PERIODIC_TABLE_ELEM_CELL:"K-Chem-Periodic-Table-Elem-Cell",PERIODIC_TABLE_ELEM_STUBSCELL:"K-Chem-Periodic-Table-Elem-StubsCell",PERIODIC_TABLE_ELEM_CELL_CONTENT:"K-Chem-Periodic-Table-Elem-Cell-Content",PERIODIC_TABLE_LEGEND_ELEM_CELL_CONTENT:"K-Chem-Periodic-Table-Elem-Cell-Content",PERIODIC_TABLE_HEAD_CELL:"K-Chem-Periodic-Table-Head-Cell",PERIODIC_TABLE_HEAD_CELL_CONTENT:"K-Chem-Periodic-Table-Head-Cell-Content",PERIODIC_TABLE_HEAD_CELL_GROUP:"K-Chem-Periodic-Table-Head-Cell-Group",PERIODIC_TABLE_HEAD_CELL_PERIOD:"K-Chem-Periodic-Table-Head-Cell-Period",ELEM_SYMBOL:"K-Chem-Elem-Symbol",ELEM_SYMBOL_STUBS:"K-Chem-Elem-Symbol-Stubs",ELEM_NAME:"K-Chem-Elem-Name",ATOMIC_NUM:"K-Chem-Atomic-Num",ATOMIC_WEIGHT:"K-Chem-Atomic-Weight"}),e.globalOptions.add("chemWidget.periodicTable",{displayedComponents:["symbol","name","atomicNumber","groupHead","legend"]}),e.ChemWidget.PeriodicTable=i.create(e.ChemWidget.AbstractWidget,{CLASS_NAME:"Kekule.ChemWidget.PeriodicTable",BINDABLE_TAG_NAMES:["span","div"],ELEM_DATA_FIELD:"__$elemData__",MAX_GROUP:18,MAX_PERIOD:7,LA_SERIES:["La","Ce","Pr","Nd","Pm","Sm","Eu","Gd","Tb","Dy","Ho","Er","Tm","Yb","Lu"],AC_SERIES:["Ac","Th","Pa","U","Np","Pu","Am","Cm","Bk","Cf","Es","Fm","Md","No","Lr"],initialize:function($super,e,t){this.setPropStoreFieldValue("displayedComponents",t||this.getDefaultDisplayedComponents()),this._elemCells=[],this._selectedElemCells=[],$super(e),this.setEnableSelect(!0),this.setEnableMultiSelect(!0)},initProperties:function(){this.defineProp("displayedComponents",{dataType:n.ARRAY,getter:function(){return this.getPropStoreFieldValue("displayedComponents")||this.getDefaultDisplayedComponents()}}),this.defineProp("startingAtomNum",{dataType:n.INT}),this.defineProp("endingAtomNum",{dataType:n.INT}),this.defineProp("useMiniMode",{dataType:n.BOOL,setter:function(e){this.setPropStoreFieldValue("useMiniMode",e),e?this.addClassName(o.PERIODIC_TABLE_MINI):this.removeClassName(o.PERIODIC_TABLE_MINI)}}),this.defineProp("enableSelect",{dataType:n.BOOL,getter:function(){return this.getPropStoreFieldValue("enableSelect")||this.getEnableMultiSelect()}}),this.defineProp("enableMultiSelect",{dataType:n.BOOL}),this.defineProp("selected",{dataType:n.HASH,serializable:!1,setter:null,getter:function(){return this.getSelection()?this.getSelection()[0]:null}}),this.defineProp("selection",{dataType:n.ARRAY,serializable:!1,setter:null,getter:function(){for(var e=[],t=this._selectedElemCells||[],r=0,i=t.length;r<i;++r){var n=t[r][this.ELEM_DATA_FIELD];n&&e.push(n)}return e}}),this.defineProp("selectedSymbol",{dataType:n.STRING,getter:function(){return this.getSelectedSymbols()[0]},setter:function(e){this.setSelectedSymbols([e])}}),this.defineProp("selectedSymbols",{dataType:n.ARRAY,getter:function(){var e=this.getSelection();if(e){for(var t=[],r=0,i=e.length;r<i;++r)t.push(e[r].symbol);return t}return[]},setter:function(e){this.selectSymbols(e)}})},doGetWidgetClassName:function($super){return $super()+" "+o.PERIODIC_TABLE},doCreateRootElement:function(e){return e.createElement("div")},doCreateSubElements:function($super,e,t){var r=$super(e,t),i=this.createMainTable(e,t);return r.concat([i])},doObjectChange:function(t){var r=["displayedComponents","startingAtomNum","endingAtomNum"];e.ArrayUtils.intersect(t,r).length&&this.recreateMainTable()},getDefaultDisplayedComponents:function(){return e.globalOptions.chemWidget.periodicTable.displayedComponents},getShowElemSymbol:function(){return this.getDisplayedComponents().indexOf("symbol")>=0},getShowElemName:function(){return this.getDisplayedComponents().indexOf("name")>=0},getShowAtomicNum:function(){return this.getDisplayedComponents().indexOf("atomicNumber")>=0},getShowAtomicWeight:function(){return this.getDisplayedComponents().indexOf("atomicWeight")>=0},getShowGroupHead:function(){return this.getDisplayedComponents().indexOf("groupHead")>=0},getShowPeriodHead:function(){return this.getDisplayedComponents().indexOf("periodHead")>=0},getShowLegend:function(){return this.getDisplayedComponents().indexOf("legend")>=0},recreateMainTable:function(){this.deselectAll();var e=this.getElement();t.clearChildContent(e),this.createMainTable(e.ownerDocument,e)},createMainTable:function(r,i){var n=e.chemicalElementsData,s=[];this._elemCells=[];for(var l=[],d=[],u=r.createElement("table"),c=0;c<=this.MAX_PERIOD;++c){for(var h=r.createElement("tr"),m=[],g=0;g<=this.MAX_GROUP;++g){var f=r.createElement("td");h.appendChild(f),m.push(f)}u.appendChild(h),s.push(m)}for(var p=r.createElement("table"),c=0;c<2;++c){for(var h=r.createElement("tr"),m=[],g=0;g<this.LA_SERIES.length;++g){var f=r.createElement("td");h.appendChild(f),m.push(f)}p.appendChild(h),l.push(m)}for(var C=this.getStartingAtomNum()||0,b=this.getEndingAtomNum()||3e5,E=0,N=n.length;E<N;++E){var T=n[E],O=T.atomicNumber;if(!(O<C||O>b)){var _=T.symbol,S=T.period,v=T.group,y=T.chemicalSerie.replace(/\s/g,"");e.ArrayUtils.pushUnique(d,T.chemicalSerie);var f,A=this.LA_SERIES.indexOf(_),M=this.AC_SERIES.indexOf(_);A>=0?f=l[0][A]:M>=0?f=l[1][M]:S&&v&&(f=s[S][v]),f&&(f.className=o.PERIODIC_TABLE_ELEM_CELL,f.appendChild(this.createElemCellContent(r,T,y.upperFirst())),f[this.ELEM_DATA_FIELD]=T,this._elemCells.push(f)),0!==A&&0!==M||(f=s[S][v],f.className=o.PERIODIC_TABLE_ELEM_STUBSCELL,f.appendChild(this.createElemCellStubsContent(r,T,y.upperFirst())))}}if(this.getShowGroupHead())for(var I=["IA","IIA","IIIB","IVB","VB","VIB","VIIB","","VIII","","IB","IIB","IIIA","IVA","VA","VIA","VIIA","VIIIA"],g=1;g<=this.MAX_GROUP;++g){var c=1===g||18===g?0:2===g||g>=13?1:3,f=s[c][g];f.className=o.PERIODIC_TABLE_HEAD_CELL+" "+o.PERIODIC_TABLE_HEAD_CELL_GROUP,f.appendChild(this.createHeadContent(r,I[g-1]))}if(this.getShowPeriodHead())for(var c=1;c<=this.MAX_PERIOD;++c){var f=s[c][0];f.className=o.PERIODIC_TABLE_HEAD_CELL+" "+o.PERIODIC_TABLE_HEAD_CELL_PERIOD,f.appendChild(this.createHeadContent(r,c))}if(i.appendChild(u),this.getShowLegend()){var R=r.createElement("a");R.href="javascript:void(0)",R.className=o.PERIODIC_TABLE_LEGEND+" "+a.CORNER_ALL,t.setElementText(R,e.$L("ChemWidgetTexts.LEGEND_CAPTION"));var L=r.createElement("div");L.className=o.PERIODIC_TABLE_LEGEND_CONTENT+" "+a.CORNER_ALL;var x={symbol:e.$L("ChemWidgetTexts.LEGEND_ELEM_SYMBOL"),atomicNumber:e.$L("ChemWidgetTexts.LEGEND_ATOMIC_NUM"),naturalMass:e.$L("ChemWidgetTexts.LEGEND_ATOMIC_WEIGHT"),name:e.$L("ChemWidgetTexts.LEGEND_ELEM_NAME")},D=this.createElemCellContent(r,x,o.PERIODIC_TABLE_LEGEND_ELEM_CELL_CONTENT);L.appendChild(D);var P=r.createElement("div");P.className=o.PERIODIC_TABLE_LEGEND_COLORS;for(var E=0,N=d.length;E<N;++E){var B=r.createElement("div");B.className=o.PERIODIC_TABLE_LEGEND_COLOR+" "+d[E].replace(/\s/g,""),t.setElementText(B,d[E]),P.appendChild(B)}L.appendChild(P),R.appendChild(L),i.appendChild(R)}return i.appendChild(p),u},createElemCellContent:function(e,t,r){var i=e.createElement("div"),n=o.PERIODIC_TABLE_ELEM_CELL_CONTENT;if(r&&(n+=" "+r),i.className=n,this.getShowAtomicNum()&&i.appendChild(this.createElemContentComponent(e,t.atomicNumber,o.ATOMIC_NUM)),this.getShowAtomicWeight()){var a=t.naturalMass;if(a){var s="number"==typeof a?a.toFixed(3):a;i.appendChild(this.createElemContentComponent(e,s,o.ATOMIC_WEIGHT))}else i.appendChild(this.createElemContentComponent(e," ",o.ATOMIC_WEIGHT))}return this.getShowElemSymbol()&&i.appendChild(this.createElemContentComponent(e,t.symbol,o.ELEM_SYMBOL)),this.getShowElemName()&&i.appendChild(this.createElemContentComponent(e,t.name,o.ELEM_NAME)),i},createElemCellStubsContent:function(e,t,r){var i=e.createElement("div");i.className=o.PERIODIC_TABLE_ELEM_CELL_CONTENT+" "+(r||"");var n,a,s;return s=t.chemicalSerie,"La"===t.symbol?(n="57-71",a="La-Lu"):(n="89-103",a="Ac-Lr"),this.getShowAtomicNum()&&i.appendChild(this.createElemContentComponent(e,n,o.ATOMIC_NUM)),this.getShowElemSymbol()&&i.appendChild(this.createElemContentComponent(e,a,o.ELEM_SYMBOL_STUBS,!0)),this.getShowElemName()&&i.appendChild(this.createElemContentComponent(e,s,o.ELEM_NAME)),i},createElemContentComponent:function(e,r,i,n){var a=e.createElement("span");if(a.className=i,n){var o=e.createElement("span");a.appendChild(o)}return t.setElementText(o||a,r),a},createHeadContent:function(e,r,i){var n=e.createElement("div");return n.className=o.PERIODIC_TABLE_HEAD_CELL_CONTENT+" "+(i||""),t.setElementText(n,r),n},_getAtomCellElem:function(e){var r=t.getNearestAncestorByTagName(e,"td",!0);return r&&this._elemCells.indexOf(r)>=0?r:null},_getCellElemOfSymbol:function(e){for(var t=this._elemCells,r=0,i=t.length;r<i;++r){var n=t[r];if(n[this.ELEM_DATA_FIELD].symbol===e)return n}return null},isCellSelected:function(e){return this._selectedElemCells.indexOf(e)>=0},selectCell:function(t){t&&(r.addClass(t,a.STATE_SELECTED),e.ArrayUtils.pushUnique(this._selectedElemCells,t),this.invokeEvent("select",{elemData:t[this.ELEM_DATA_FIELD]}))},deselectCell:function(t){t&&(r.removeClass(t,a.STATE_SELECTED),e.ArrayUtils.remove(this._selectedElemCells,t),this.invokeEvent("deselect",{elemData:t[this.ELEM_DATA_FIELD]}))},toggleCell:function(e){this.isCellSelected(e)?this.deselectCell(e):this.selectCell(e)},deselectAll:function(){for(var e=this._selectedElemCells,t=e.length-1;t>=0;--t)this.deselectCell(e[t]);return this},selectSymbols:function(t){this.deselectAll();for(var r=e.ArrayUtils.toArray(t),i=0,n=r.length;i<n;++i){var a=this._getCellElemOfSymbol(r[i]);a&&this.selectCell(a)}return this},react_click:function($super,e){if(this.getEnableSelect()){var t=e.getTarget(),r=this._getAtomCellElem(t);if(r)return this.getEnableMultiSelect()?this.toggleCell(r):(this.deselectAll(),this.selectCell(r)),!0}$super(e)}}),e}},function(e,t,r){"use strict";var i=r(0).Class,n=(r(0).ClassEx,r(0).ObjectEx,r(0).DataType);e.exports=function(e){var t=i.PropertyScope,r=(e.DomUtils,e.ZoomUtils),a=(e.ChemWidget,e.Widget.HtmlClassNames),o=e.ChemWidget.HtmlClassNames;return e.ChemWidget.HtmlClassNames=Object.extend(e.ChemWidget.HtmlClassNames,{DISPLAYER_DRAWCONTEXT_PARENT:"K-Chem-Displayer-DrawContext-Parent",ACTION_MOL_DISPLAY_TYPE:"K-Chem-MolDisplayType",ACTION_MOL_DISPLAY_SKELETAL:"K-Chem-MolDisplaySkeletal",ACTION_MOL_DISPLAY_CONDENSED:"K-Chem-MolDisplayCondensed",ACTION_MOL_DISPLAY_WIRE:"K-Chem-MolDisplayWire",ACTION_MOL_DISPLAY_BALLSTICK:"K-Chem-MolDisplayBallStick",ACTION_MOL_DISPLAY_STICKS:"K-Chem-MolDisplaySticks",ACTION_MOL_DISPLAY_SPACEFILL:"K-Chem-MolDisplaySpaceFill",ACTION_MOL_HIDE_HYDROGENS:"K-Chem-MolHideHydrogens",ACTION_ZOOMIN:"K-Chem-ZoomIn",ACTION_ZOOMOUT:"K-Chem-ZoomOut",ACTION_RESET:"K-Chem-Reset",ACTION_RESET_ZOOM:"K-Chem-ResetZoom",ACTION_LOADFILE:"K-Chem-LoadFile",ACTION_LOADDATA:"K-Chem-LoadData",ACTION_SAVEFILE:"K-Chem-SaveFile",ACTION_CLEAROBJS:"K-Chem-ClearObjs",ACTION_CONFIG:"K-Chem-Config",DIALOG_CHOOSE_FILE_FORAMT:"K-Chem-Dialog-Choose-File-Format",DIALOG_CHOOSE_FILE_FORAMT_FORMATBOX:"K-Chem-Dialog-Choose-File-Format-FormatBox",DIALOG_CHOOSE_FILE_FORAMT_PREVIEWER_REGION:"K-Chem-Dialog-Choose-File-Format-PreviewerRegion",DIALOG_CHOOSE_FILE_FORAMT_PREVIEWER:"K-Chem-Dialog-Choose-File-Format-Previewer"}),e.ChemWidget.ChemObjDisplayerConfigs=i.create(e.AbstractConfigs,{CLASS_NAME:"Kekule.ChemWidget.ChemObjDisplayerConfigs",initProperties:function(){this.addConfigProp("ioConfigs","Kekule.ChemWidget.ChemObjDisplayerIOConfigs")},initPropValues:function($super){$super(),this.setPropStoreFieldValue("ioConfigs",new e.ChemWidget.ChemObjDisplayerIOConfigs)}}),e.ChemWidget.ChemObjDisplayerIOConfigs=i.create(e.AbstractConfigs,{CLASS_NAME:"Kekule.ChemWidget.ChemObjDisplayerIOConfigs",initProperties:function(){this.addBoolConfigProp("canonicalizeBeforeSave",!0)}}),e.ChemWidget.ChemObjDisplayer=i.create(e.ChemWidget.AbstractWidget,{CLASS_NAME:"Kekule.ChemWidget.ChemObjDisplayer",initialize:function($super,t,r,i,n){this._paintFlag=0,this._bgColorMap={},this._contextTransformOpsMap=new e.MapEx,this.setPropStoreFieldValue("resetAfterLoad",!0),this.setPropStoreFieldValue("renderType",i||e.Render.RendererType.R2D),$super(t),r&&this.setChemObj(r),this.setEnableLoadNewFile(!0),this.setPropStoreFieldValue("displayerConfigs",n||this.createDefaultConfigs())},doFinalize:function($super){this.setPropStoreFieldValue("chemObj",null),this.getPainter().finalize();var e=this.getPropStoreFieldValue("drawBridge"),t=this.getPropStoreFieldValue("drawContext");t&&e&&e.releaseContext(t),e&&e.finalize&&e.finalize(),this.setPropStoreFieldValue("drawBridge",null),this.setPropStoreFieldValue("drawContext",null),this._contextTransformOpsMap&&this._contextTransformOpsMap.finalize(),$super()},initProperties:function(){this.defineProp("displayerConfigs",{dataType:"Kekule.ChemWidget.ChemObjDisplayerConfigs",serializable:!1,scope:t.PUBLIC}),this.defineProp("enableLoadNewFile",{dataType:n.BOOL}),this.defineProp("allowedInputFormatIds",{dataType:n.ARRAY}),this.defineProp("allowedOutputFormatIds",{dataType:n.ARRAY}),this.defineProp("standardizationOptions",{dataType:n.HASH}),this.defineProp("resetAfterLoad",{dataType:n.BOOL}),this.defineProp("chemObj",{dataType:"Kekule.ChemObject",serializable:!1,scope:t.PUBLIC,setter:function(e){var t=this.getPropStoreFieldValue("chemObj");this.setPropStoreFieldValue("chemObj",e),this.chemObjChanged(e,t)}}),this.defineProp("chemObjLoaded",{dataType:n.BOOL,serializable:!1,scope:t.PUBLIC,setter:null,getter:function(){return this.getChemObj()&&this.getPropStoreFieldValue("chemObjLoaded")}}),this.defineProp("renderType",{dataType:n.INT,serializable:!1,scope:t.PUBLISHED,setter:function(t){if(!this.getAllowRenderTypeChange())return void e.error(e.$L("ErrorMsg.RENDER_TYPE_CHANGE_NOT_ALLOWED"));var r=this.getRenderType();t!==r&&(this.setPropStoreFieldValue("renderType",t),this.resetRenderType(r,t))}}),this.defineProp("renderConfigs",{dataType:n.OBJECT,serializable:!1,scope:t.PUBLIC,getter:function(){var t=this.getPropStoreFieldValue("renderConfigs");return t||(t=this.getRenderType()===e.Render.RendererType.R3D?e.Render.Render3DConfigs.getInstance():e.Render.Render2DConfigs.getInstance()),t},setter:function(e){this.setPropStoreFieldValue("renderConfigs",e);var t=this.getPropStoreFieldValue("painter");t&&t.setRenderConfigs(this.getRenderConfigs())}}),this.defineProp("backgroundColor",{dataType:n.STRING,scope:t.PUBLISHED,setter:function(e){this.setPropStoreFieldValue("backgroundColor",e),this._bgColorMap[this.getRenderType().toString()]=e,this.backgroundColorChanged()}}),this.defineProp("transformParams",{dataType:n.HASH,serializable:!1,scope:t.PUBLIC,getter:function(){var e=Object.extend({},this.getDrawOptions());return e.screenCoordOffset=this.getBaseCoordOffset(),e},setter:function(e){var t=e||{};this.setDrawOptions(t),this.setBaseCoordOffset(t.baseCoordOffset),this.drawOptionChanged()}}),this.defineProp("drawOptions",{dataType:n.HASH,serializable:!1,scope:t.PUBLIC,getter:function(){var e=this.getPropStoreFieldValue("drawOptions");return e||(e={},this.setPropStoreFieldValue("drawOptions",e)),e},setter:function(e){this.setPropStoreFieldValue("drawOptions",e),this.drawOptionChanged()}}),this.defineProp("zoom",{dataType:n.FLOAT,serializable:!1,getter:function(){return(this.getDrawOptions()||{}).zoom},setter:function(e){return this.zoomTo(e),this}}),this.defineProp("initialZoom",{dataType:n.FLOAT}),this.defineProp("autofit",{dataType:n.BOOL,serializable:!1,getter:function(){return(this.getDrawOptions()||{}).autofit},setter:function(e){var t=this.getDrawOptions()||{};return t.autofit=e,this.setDrawOptions(t)}}),this.defineProp("moleculeDisplayType",{dataType:n.INT,serializable:!1,getter:function(){return(this.getDrawOptions()||{}).moleculeDisplayType},setter:function(e){return this.getDrawOptions().moleculeDisplayType=e,this.drawOptionChanged(),this}}),this.defineProp("allowCoordBorrow",{dataType:n.BOOL,serializable:!1,scope:t.PUBLIC,getter:function(){return e.oneOf(this.getDrawOptions().allowCoordBorrow,this.getRenderConfigs().getGeneralConfigs().getAllowCoordBorrow())}}),this.defineProp("autoSize",{dataType:n.BOOL,serializable:!1,setter:function(e){e!=this.getAutoSize()&&(this.setPropStoreFieldValue("autoSize",e),e&&this.allowAutoSize()&&this.drawOptionChanged())}}),this.defineProp("padding",{dataType:n.INT,serializable:!1,setter:function(e){e!=this.getPadding()&&(this.setPropStoreFieldValue("padding",e),this.getDrawOptions().autofitContextPadding=e,this.drawOptionChanged())}}),this.defineProp("baseCoordOffset",{dataType:n.Hash,serializable:!1,setter:function(e){this.setPropStoreFieldValue("baseCoordOffset",e),this.getChemObjLoaded()&&this.repaint()}}),this.defineProp("drawBridge",{dataType:n.OBJECT,serializable:!1,scope:t.PRIVATE,setter:null,getter:function(e){var t=this.getPropStoreFieldValue("drawBridge");return t||(t=this.createDrawBridge(e),this.setPropStoreFieldValue("drawBridge",t)),t}}),this.defineProp("drawContext",{dataType:n.OBJECT,serializable:!1,scope:t.PRIVATE,setter:null,getter:function(){var t=this.getPropStoreFieldValue("drawContext");if(!t){var r=this.getDrawBridge();if(r){var i=this.getDrawContextParentElem();if(!i)return null;var n=e.HtmlElementUtils.getElemOffsetDimension(i);t=r.createContext(i,n.width,n.height),this.setPropStoreFieldValue("drawContext",t)}}return t}}),this.defineProp("painter",{dataType:"Kekule.Render.ChemObjPainter",serializable:!1,scope:t.PRIVATE,setter:null,getter:function(){var e=this.getPropStoreFieldValue("painter");return e||(e=this.createNewPainter()),e}}),this.defineProp("rootRenderer",{dataType:"Kekule.Render.AbstractRenderer",serializable:!1,scope:t.PRIVATE,setter:null,getter:function(){var e=this.getPainter();return e?e.getRenderer():null}}),this.defineProp("boundInfoRecorder",{dataType:"Kekule.Render.BoundInfoRecorder",serializable:!1,setter:null,getter:function(){var e=this.getRootRenderer();return e&&e.getBoundInfoRecorder()}})},initPropValues:function($super){$super(),this.setStandardizationOptions({unmarshalSubFragments:!1,clearHydrogens:!1})},elementBound:function(e){this.setObserveElemResize(!0)},doWidgetShowStateChanged:function($super,e){$super(e),e&&this.setChemObj(this.getChemObj())},doFileDragDrop:function($super,t){if(t){var r=this;return function(){e.IO.loadFileData(t[0],function(e,t){t&&r.setChemObj(e)})}.defer(),!0}return $super()},getAllowRenderTypeChange:function(){return!1},resetRenderType:function(e,t){var r=this.getChemObj(),i=this.getPropStoreFieldValue("drawBridge"),n=this.getPropStoreFieldValue("drawContext");i&&n&&i.releaseContext(n),this.setPropStoreFieldValue("drawContext",null),this.setPropStoreFieldValue("drawBridge",null);var a=this.getBackgroundColorOfType(t);this.getDrawOptions().moleculeDisplayType=this.getDefaultMoleculeDisplayType(t),this.setPropStoreFieldValue("backgroundColor",a),this.backgroundColorChanged(!0),this.setChemObj(r||null)},createDefaultConfigs:function(){return new e.ChemWidget.ChemObjDisplayerConfigs},getCoordMode:function(){return this.getRenderType()===e.Render.RendererType.R3D?e.CoordMode.COORD3D:e.CoordMode.COORD2D},setCoordMode:function(t){var r=t===e.CoordMode.COORD3D?e.Render.RendererType.R3D:e.Render.RendererType.R2D;this.setRenderType(r)},loadPredefinedResDataToProp:function(t,r,i){if("chemObj"===t)if(i)try{var n=e.IO.loadTypedData(r.data,r.resType,r.resUri);this.setChemObj(n)}catch(e){this.reportException(e)}else this.reportException(e.$L("ErrorMsg.CANNOT_LOAD_RES_OF_URI")+r.resUri||"")},reportException:function(t,r){e.raise(t,r||e.ExceptionLevel.ERROR)},createDrawBridge:function(t){var r=this.getRenderType()===e.Render.RendererType.R3D?e.Render.DrawBridge3DMananger:e.Render.DrawBridge2DMananger,i=r.getPreferredBridgeInstance();return i||t||e.error(e.$L("ErrorMsg.DRAW_BRIDGE_NOT_SUPPORTED")),i},getDrawContextParentElem:function(t){var r=this._drawContextParentElem;if(!r&&!t){r=this.getDocument().createElement("div"),this._drawContextParentElem=r,e.HtmlElementUtils.addClass(r,a.DYN_CREATED),e.HtmlElementUtils.addClass(r,o.DISPLAYER_DRAWCONTEXT_PARENT),r.style.width="100%",r.style.height="100%";var i=this.getElement(),n=e.DomUtils.getFirstChildElem(i);n?i.insertBefore(r,n):i.appendChild(r)}return r},allowAutoSize:function(){return this.getRenderType()===e.Render.RendererType.R2D},canModifyPartialGraphic:function(e){var t=this.getDrawBridge();return!!t.canModifyGraphic&&t.canModifyGraphic(e||this.getDrawContext())},doInsertedToDom:function(){this.doResize()},doResize:function(){this.refitDrawContext(this.isPainting())},refitDrawContext:function(t){if(this.getDrawBridge(!0)&&this.getDrawContext()){var r=e.HtmlElementUtils.getElemClientDimension(this.getDrawContextParentElem()),i=this.changeContextDimension(r);!t&&i&&this.repaint()}},getContextDimension:function(){return this.getDrawBridge()&&this.getDrawContext()?this.getDrawBridge().getContextDimension(this.getDrawContext()):null},changeContextDimension:function(e){return!(!this.getDrawBridge()||!this.getDrawContext())&&(this.getDrawBridge().setContextDimension(this.getDrawContext(),e.width,e.height),!0)},clearContext:function(){var e=this.getPropStoreFieldValue("drawContext");if(e){var t=this.getPropStoreFieldValue("painter");t&&t.clear(e),this.getDrawBridge().clearContext(e)}},createNewPainter:function(t){var r=this.getPropStoreFieldValue("painter");r&&r.finalize();var i=new e.Render.ChemObjPainter(this.getRenderType(),t,this.getDrawBridge());return this.setPropStoreFieldValue("painter",i),i},chemObjChanged:function(e,t){this.doLoad(e),this.getResetAfterLoad()&&t&&this.resetDisplay()},load:function(e){this.setChemObj(e)},doLoad:function(e){this.refitDrawContext(!0),this.setPropStoreFieldValue("chemObjLoaded",!1);try{if(e){this.createNewPainter(e).setRenderConfigs(this.getRenderConfigs()),this.repaint(),this.setPropStoreFieldValue("chemObjLoaded",!0)}else this.clearContext();this.invokeEvent("load",{obj:e})}catch(e){this.clearContext(),this.reportException(e)}finally{this.doLoadEnd(this.getChemObj())}},doLoadEnd:function(e){},loadFromData:function(t,r,i){try{if(t){var n=e.IO.loadTypedData(t,r,i);return n?this.setChemObj(n):e.error(e.$L("ErrorMsg.LOAD_CHEMDATA_FAILED")),n}return this.setChemObj(null),null}catch(e){this.reportException(e)}},loadFromFile:function(t){if(t){var r=this;try{e.IO.loadFileData(t,function(e,t){t&&r.setChemObj(e)})}catch(e){this.reportException(e)}}else this.setChemObj(null)},getSavingTargetObj:function(){return this.getChemObj()},saveData:function(t,r,i){var i=i||this.getSavingTargetObj();this.prepareSaveData(i);var n=e.IO.ChemDataWriterManager.getWriterByFormat(t,null,i);if(n){if(this._needToCanonicalizeBeforeSaving()&&this.getDisplayerConfigs().getIoConfigs().getCanonicalizeBeforeSave()&&i.standardize){var i=i.clone?i.clone(!0):i;i.standardize(this.getStandardizationOptions())}if(!r){r=e.IO.DataFormatsManager.getFormatInfo(t).dataType}return n.writeData(i,r,t)}return e.error(e.$L("ErrorMsg.NO_SUITABLE_WRITER_FOR_FORMAT")),null},_needToCanonicalizeBeforeSaving:function(){return!1},prepareSaveData:function(e){},getDrawClientDimension:function(){return e.HtmlElementUtils.getElemClientDimension(this.getCoreElement())},setDrawDimension:function(e,t){this.setDimension(e,t)},calcDrawBaseCoord:function(t){var r,i,n=this.getDrawContext(),a=this.getPainter();if(!this._isContinuousRepainting&&this.getAutoSize()&&this.allowAutoSize()){var o=this.getPadding()||0,s=a.estimateScreenBox(n,r,t,this.getAllowCoordBorrow());if(s){var l=s.x2-s.x1+2*o,d=s.y2-s.y1+2*o;this.changeContextDimension({width:l,height:d}),this.setDrawDimension(l,d),i={width:l,height:d},r={x:l/2,y:d/2}}}else if(!(r=t?t.baseCoord:null)){var u=this.getDrawClientDimension();r={x:u.width/2,y:u.height/2};var c=this.getBaseCoordOffset();c&&(r=e.CoordUtils.add(r,c))}return r=this.getDrawBridge().transformScreenCoordToContext(n,r),{baseCoord:r,baseCoordPos:e.Render.CoordPos.CENTER,newWidgetDimension:i}},getActualDrawOptions:function(){return this.getDrawBridge().hydrogenDisplayType=this.getRenderConfigs().getNodeViewConfigs().getHydrogenDisplayType(),this.getDrawBridge().module_width=this.getRenderConfigs().getGeneralConfigs().getModuleWidth(),this.getDrawBridge().module_height=this.getRenderConfigs().getGeneralConfigs().getModuleHeight(),this.getDrawOptions()},calcDrawParams:function(e){var t=this.getActualDrawOptions();e&&(t=Object.extend(t,e));var r=this.calcDrawBaseCoord(t);return{drawOptions:t,baseCoord:r.baseCoord,baseCoordPos:r.baseCoordPos,newWidgetDimension:r.newWidgetDimension}},_savePainterInitialRenderTransformOptions:function(e,t){var r=t.getActualInitialRenderTransformOptions(e);this._contextTransformOpsMap.set(e,r)},repaint:function(e){this.beginPaint();try{if(e&&e.doNotClear||this.clearContext(),!this.getChemObj())return;var t,r,i=this.getPainter(),n=this.getDrawContext(),a=!0;e&&e.preserveTransformOptions?(r=this._contextTransformOpsMap.get(n)||null,a=!1,t=this.calcDrawParams(r)):t=this.calcDrawParams(e),this._lastBaseCoord=t.baseCoord,i.draw(n,t.baseCoord,t.drawOptions),a&&this._savePainterInitialRenderTransformOptions(n,i)}finally{this.endPaint()}},beginPaint:function(){this._paintFlag||(this._paintFlag=0),++this._paintFlag},endPaint:function(){this._paintFlag>0&&--this._paintFlag,this._paintFlag<0&&(this._paintFlag=0)},isPainting:function(){return this._paintFlag>0},getBackgroundColorOfType:function(e){return this._bgColorMap[e.toString()]},setBackgroundColorOfType:function(e,t){this._bgColorMap[t.toString()]=e,t===this.getRenderType()&&this.setBackgroundColor(e)},backgroundColorChanged:function(e){var t=this.getBackgroundColor();"transparent"===t&&(t=null);var r=this.getDrawBridge(!0);r&&r.setClearColor&&(r.setClearColor(this.getDrawContext(),t),e||this.repaint())},drawOptionChanged:function(){this.repaint()},geometryOptionChanged:function(){var e=this.getPainter(),t=this.getDrawOptions();if(e.supportGeometryOptionChange()){var r=this.getDrawContext();e.changeGeometryOptions(r,t.baseCoord||this._lastBaseCoord,t),this._savePainterInitialRenderTransformOptions(r,e)}else this.drawOptionChanged()},beginContinuousRepainting:function(){this._isContinuousRepainting=!0},endContinuousRepainting:function(){this._isContinuousRepainting&&(this._isContinuousRepainting=!1,this.repaint())},resetDisplay:function(){var e=this.getDrawOptions();return e.zoom=.66,e.rotateX=0,e.rotateY=0,e.rotateZ=0,e.rotateAngle=0,e.rotateAxisVector=null,e.rotateMatrix=null,this.setBaseCoordOffset(null),this.geometryOptionChanged(),this},getCurrZoom:function(){return this.getDrawOptions().zoom||1},zoomTo:function(e,t){return this.getDrawOptions().zoom=e,t||this.geometryOptionChanged(),this},zoomIn:function(e){var t=this.getCurrZoom(),i=r.getNextZoomInRatio(t,e||1);return this.zoomTo(i)},zoomOut:function(e){var t=this.getCurrZoom(),i=r.getNextZoomOutRatio(t,e||1);return this.zoomTo(i)},resetZoom:function(){return this.zoomTo(this.getInitialZoom()||1)},getDefaultMoleculeDisplayType:function(t){return t===e.Render.RendererType.R3D?e.Render.Molecule3DDisplayType.DEFAULT:e.Render.Molecule2DDisplayType.DEFAULT},getCurrMoleculeDisplayType:function(){var e=this.getDrawOptions().moleculeDisplayType;return e||(e=this.getDefaultMoleculeDisplayType(this.getRenderType())),e},setHideHydrogens:function(e){return this.getDrawOptions().hideHydrogens=e,this.drawOptionChanged(),this},exportToDataUri:function(e,t){return this.getDrawBridge().exportToDataUri(this.getDrawContext(),e,t)},createConfigurator:function($super){var e=$super();return e.addEventListener("configChange",function(e){this.repaint()},this),e}}),e.ChemWidget.ChemObjDisplayer.Settings=i.create(e.Widget.BaseWidget.Settings,{CLASS_NAME:"Kekule.ChemWidget.ChemObjDisplayer.Settings",initialize:function($super,e){$super(e)},initProperties:function(){this.defineDelegatedProps(["enableLoadNewFile"])},getDisplayer:function(){return this.getWidget()}}),e.ChemWidget.ChemObjDisplayer.Configurator=i.create(e.Widget.Configurator,{CLASS_NAME:"Kekule.ChemWidget.ChemObjDisplayer.Configurator",TAB_BTN_DATA_FIELD:"__$data__",initialize:function($super,e){$super(e)},initPropValues:function($super){$super(),this.setLayout(e.Widget.Layout.HORIZONTAL)},getCategoryInfos:function($super){for(var e=$super(),t=this.getDisplayer(),r=[t.getDisplayerConfigs(),t.getRenderConfigs()],n=0,a=r.length;n<a;++n)for(var o=r[n],s=o.getPropListOfScopes([i.PropertyScope.PUBLISHED]),l=0,d=s.getLength();l<d;++l){var u=s.getPropInfoAt(l),c=o.getPropValue(u.name);c&&e.push({obj:c,name:u.name,title:u.title,description:u.description})}return e},getDisplayer:function(){return this.getWidget()}}),e.ChemWidget.ActionDisplayerLoadFile=i.create(e.ActionLoadFileData,{CLASS_NAME:"Kekule.ChemWidget.ActionDisplayerLoadFile",HTML_CLASSNAME:o.ACTION_LOADFILE,initialize:function($super,t){$super(),this.setDisplayer(t),this.setText(e.$L("ChemWidgetTexts.CAPTION_LOADFILE")),this.setHint(e.$L("ChemWidgetTexts.HINT_LOADFILE"))},initProperties:function(){this.defineProp("displayer",{dataType:"Kekule.ChemWidget.ChemObjDisplayer",serializable:!1})},doUpdate:function($super){$super();var e=this.getDisplayer();this.setEnabled(this.getEnabled()&&e&&e.getEnabled()&&e.getEnableLoadNewFile())},doDataLoaded:function(e,t,r){r&&this.getDisplayer().loadFromData(e,null,t)}}),e.ChemWidget.ActionOnDisplayer=i.create(e.Action,{CLASS_NAME:"Kekule.ChemWidget.ActionOnDisplayer",initialize:function($super,e,t,r){$super(),this.setDisplayer(e),this.setText(t),this.setHint(r)},initProperties:function(){this.defineProp("displayer",{dataType:"Kekule.ChemWidget.ChemObjDisplayer",serializable:!1})},doUpdate:function(){var e=this.getDisplayer();this.setEnabled(e&&e.getChemObj()&&e.getChemObjLoaded()&&e.getEnabled())}}),e.ChemWidget.ActionDisplayerClear=i.create(e.ChemWidget.ActionOnDisplayer,{CLASS_NAME:"Kekule.ChemWidget.ActionDisplayerClear",HTML_CLASSNAME:o.ACTION_CLEAROBJS,initialize:function($super,t){$super(t,e.$L("ChemWidgetTexts.CAPTION_CLEAROBJS"),e.$L("ChemWidgetTexts.HINT_CLEAROBJS"))},doUpdate:function($super){$super();var e=this.getDisplayer();this.setEnabled(e&&e.getEnabled()&&e.getChemObj())},doExecute:function(e){this.getDisplayer().setChemObj(null)}}),e.ChemWidget.ActionDisplayerLoadData=i.create(e.ChemWidget.ActionOnDisplayer,{CLASS_NAME:"Kekule.ChemWidget.ActionDisplayerLoadData",HTML_CLASSNAME:o.ACTION_LOADDATA,initialize:function($super,t){$super(t,e.$L("ChemWidgetTexts.CAPTION_LOADDATA"),e.$L("ChemWidgetTexts.HINT_LOADDATA"))},finalize:function($super){$super()},initPropValues:function($super){$super(),this.setDialogShowType(e.Widget.ShowHideType.DROPDOWN)},initProperties:function(){this.defineProp("dataDialog",{dataType:"Kekule.ChemWidget.LoadDataDialog",serializable:!1,setter:null,getter:function(){var e=this.getPropStoreFieldValue("dataDialog");return e||(e=this.createDataDialog(),this.setPropStoreFieldValue("dataDialog",e)),e}}),this.defineProp("dialogShowType",{dataType:n.INT})},createDataDialog:function(){var t=this.getDisplayer().getDocument();return new e.ChemWidget.LoadDataDialog(t)},doUpdate:function($super){$super();var e=this.getDisplayer();this.setEnabled(e&&e.getEnabled()&&e.getEnableLoadNewFile())},doExecute:function(t){var r=this,i=this.getDataDialog();i.setAllowedFormatIds(this.getDisplayer().getAllowedInputFormatIds()||e.IO.ChemDataReaderManager.getAllReadableFormatIds());var n=(i._formatSelector,this.getDialogShowType());(n===e.Widget.ShowHideType.DIALOG?i.openModal:i.open).apply(i,[function(e){i.isPositiveResult(e)&&r.doLoadToDisplayer(i.getChemObj(),i)},t,n])},doLoadToDisplayer:function(e,t){this.getDisplayer().load(e)}}),e.ChemWidget.ActionDisplayerSaveFile=i.create(e.ChemWidget.ActionOnDisplayer,{CLASS_NAME:"Kekule.ChemWidget.ActionDisplayerSaveFile",HTML_CLASSNAME:o.ACTION_SAVEFILE,initialize:function($super,t){$super(t,e.$L("ChemWidgetTexts.CAPTION_SAVEFILE"),e.$L("ChemWidgetTexts.HINT_SAVEFILE")),this._saveAction=new e.ActionFileSave},finalize:function($super){this._saveAction.finalize(),$super()},initPropValues:function($super){$super(),this.setDialogShowType(e.Widget.ShowHideType.DROPDOWN)},initProperties:function(){this.defineProp("formatDialog",{dataType:"Kekule.Widget.Dialog",serializable:!1,setter:null,getter:function(){var e=this.getPropStoreFieldValue("formatDialog");return e||(e=this.createFormatDialog(),this.setPropStoreFieldValue("formatDialog",e)),e}}),this.defineProp("lastFormat",{dataType:n.STRING,serializable:!1}),this.defineProp("currSaveData",{dataType:n.VARIANT,serializable:!1}),this.defineProp("dialogShowType",{dataType:n.INT})},getChemObjSrcInfo:function(e){var t=this.getDisplayer();return t.getChemObjSrcInfo?t.getChemObjSrcInfo(e):e.getSrcInfo?e.getSrcInfo():null},getChemObjSrcFormat:function(e){var t=this.getChemObjSrcInfo(e);return t?t.format:null},createFormatDialog:function(){var t=this.getDisplayer().getDocument(),r=new e.Widget.Dialog(t,e.$L("ChemWidgetTexts.CAPTION_SAVEDATA_DIALOG"),[e.Widget.DialogButtons.OK,e.Widget.DialogButtons.CANCEL]);r.addClassName(o.DIALOG_CHOOSE_FILE_FORAMT),r.setAutoAdjustSizeOnPopup(!0);var i=t.createElement("div");i.innerHTML=e.$L("ChemWidgetTexts.CAPTION_SELECT_FORMAT"),r.getClientElem().appendChild(i),i=t.createElement("div"),r.getClientElem().appendChild(i);var n=new e.Widget.SelectBox(r);n.addClassName(o.DIALOG_CHOOSE_FILE_FORAMT_FORMATBOX),n.appendToElem(i),n.addEventListener("valueChange",this.reactFormatSelectorChange,this),r._formatSelector=n;var i=t.createElement("div");i.innerHTML=e.$L("ChemWidgetTexts.CAPTION_PREVIEW_FILE_CONTENT"),r.getClientElem().appendChild(i),i=t.createElement("div"),i.className=o.DIALOG_CHOOSE_FILE_FORAMT_PREVIEWER_REGION,r.getClientElem().appendChild(i);var a=new e.Widget.TextEditor(r);return a.setReadOnly(!0),a.setWrap("off").setAutoWrapThreshold(!0),a.setToolbarPos(e.Widget.Position.BOTTOM),a.addClassName(o.DIALOG_CHOOSE_FILE_FORAMT_PREVIEWER),a.appendToElem(i),r._previewTextArea=a,r.setResizable&&r.setResizable(!0),r},getAvailableWriterInfos:function(t){if(t){return e.IO.ChemDataWriterManager.getAvailableWriterInfos(null,t)}return[]},getFormatSelectorItems:function(t,r){for(var i=[],n=[],a=this.getChemObjSrcInfo(t),o=a?a.format:null,s=0,l=r.length;s<l;++s){var d=r[s];e.ArrayUtils.pushUnique(n,d.formatId)}n=e.ArrayUtils.intersect(this.getAllowedFormatIds(),n);for(var s=0,l=n.length;s<l;++s){var u=e.IO.DataFormatsManager.getFormatInfo(n[s]);if(u){for(var c=e.ArrayUtils.clone(e.ArrayUtils.toArray(u.fileExts)),h=0,m=c.length;h<m;++h)c[h]="*."+c[h];var g=c.join(", "),f=u.title;g&&(f+=" ("+g+")");var p=o?n[s]===o:this.getLastFormat()?this.getLastFormat()===n[s]:0===s;i.push({value:u.id,text:f,title:u.mimeType,data:u,selected:p})}}return i.sort(function(e,t){return e.text<t.text?-1:e.text>t.text?1:0}),i},getAllowedFormatIds:function(){return this.getDisplayer().getAllowedOutputFormatIds()||e.IO.ChemDataWriterManager.getAllWritableFormatIds()},getFileFilters:function(t){for(var r=[],i=0,n=t.length;i<n;++i){var a=t[i],o=a.data,s=a.text||a.title||a.value,l=e.ArrayUtils.toArray(o.fileExts);r.push({title:s,filter:"."+l.join(",.")})}return r.push(e.NativeServices.FILTER_ALL_SUPPORT),r.push(e.NativeServices.FILTER_ANY),r},updateFormatItems:function(e){this._formatItems=this.getFormatSelectorItems(e,this.getAvailableWriterInfos()),this._formatSelector.setItems(this._formatItems);var t=this.getFileFilters(this._formatItems);this._saveAction.setFilters(t)},reactFormatSelectorChange:function(){var e=this.getFormatDialog()._formatSelector.getValue();this.updatePreview(e,this.getFormatDialog())},updatePreview:function(t,r){var i=r._previewTextArea;if(i.setValue(""),t){var n=e.IO.DataFormatsManager.getFormatInfo(t),a=this.getTargetObj(),o=this.getChemObjSrcInfo(a);if(o&&o.format===t&&o.data)i.setValue(o.data),this.setCurrSaveData(o.data);else{var s=this.getDisplayer().saveData(t,n.dataType,a);i.setValue(s),this.setCurrSaveData(s)}}},getTargetObj:function(e){return this.getDisplayer().getSavingTargetObj()},doUpdate:function($super){$super();var e=this.getDisplayer();this._saveAction&&this._saveAction.update(),this.setEnabled(e&&e.getEnabled()&&e.getChemObj())},doExecute:function(t){var r=this,i=this.getFormatDialog(),n=this.getTargetObj(),a=i._formatSelector,o=this.getAvailableWriterInfos(n),s=this.getFormatSelectorItems(n,o);a.setItems(s),this.reactFormatSelectorChange();var l=!1;this._saveAction&&(l=this._saveAction.getEnabled());var d=i.getDialogButton(e.Widget.DialogButtons.OK);d&&d.setEnabled(l);var u=this.getDialogShowType();(u===e.Widget.ShowHideType.DIALOG?i.openModal:i.open).apply(i,[function(n){if(n===e.Widget.DialogButtons.OK){var a=r.getCurrSaveData();r._saveAction.setData(a);var o=i._formatSelector.getValue();r.setLastFormat(o);var s=e.IO.DataFormatsManager.getFormatInfo(o),l=s.fileExts,d=e.ArrayUtils.toArray(l[0]||l),u=[{title:s.title||s.mimeType,filter:"."+d.join(",.")},e.NativeServices.FILTER_ANY],c=e.$L("ChemWidgetTexts.S_DEF_SAVE_FILENAME")+"."+d;r._saveAction.setFileName(c),r._saveAction.setFilters(u),r._saveAction.execute(t)}},t,u])}}),e.ChemWidget.ActionDisplayerReset=i.create(e.ChemWidget.ActionOnDisplayer,{CLASS_NAME:"Kekule.ChemWidget.ActionDisplayerReset",HTML_CLASSNAME:o.ACTION_RESET,initialize:function($super,t){$super(t,e.$L("ChemWidgetTexts.CAPTION_RESETVIEW"),e.$L("ChemWidgetTexts.HINT_RESETVIEW"))},doExecute:function(){this.getDisplayer().resetDisplay()}}),e.ChemWidget.ActionDisplayerZoomIn=i.create(e.ChemWidget.ActionOnDisplayer,{CLASS_NAME:"Kekule.ChemWidget.ActionDisplayerZoomIn",HTML_CLASSNAME:o.ACTION_ZOOMIN,initialize:function($super,t){$super(t,e.$L("ChemWidgetTexts.CAPTION_ZOOMIN"),e.$L("ChemWidgetTexts.HINT_ZOOMIN"))},doExecute:function(){this.getDisplayer().zoomIn()}}),e.ChemWidget.ActionDisplayerZoomOut=i.create(e.ChemWidget.ActionOnDisplayer,{CLASS_NAME:"Kekule.ChemWidget.ActionDisplayerZoomOut",HTML_CLASSNAME:o.ACTION_ZOOMOUT,initialize:function($super,t){$super(t,e.$L("ChemWidgetTexts.CAPTION_ZOOMOUT"),e.$L("ChemWidgetTexts.HINT_ZOOMOUT"))},doExecute:function(){this.getDisplayer().zoomOut()}}),e.ChemWidget.ActionDisplayerResetZoom=i.create(e.ChemWidget.ActionOnDisplayer,{CLASS_NAME:"Kekule.ChemWidget.ActionDisplayerResetZoom",HTML_CLASSNAME:o.ACTION_RESET_ZOOM,initialize:function($super,t){$super(t,e.$L("ChemWidgetTexts.CAPTION_RESETZOOM"),e.$L("ChemWidgetTexts.HINT_RESETZOOM"))},doExecute:function(){this.getDisplayer().resetZoom()}}),e.ChemWidget.ActionDisplayerHideHydrogens=i.create(e.ChemWidget.ActionOnDisplayer,{CLASS_NAME:"Kekule.ChemWidget.ActionDisplayerHideHydrogens",HTML_CLASSNAME:o.ACTION_MOL_HIDE_HYDROGENS,initialize:function($super,t){$super(t,e.$L("ChemWidgetTexts.CAPTION_HIDEHYDROGENS"),e.$L("ChemWidgetTexts.HINT_HIDEHYDROGENS"))},doUpdate:function($super){$super();var t=this.getDisplayer(),r=t&&t.getRenderType()===e.Render.RendererType.R3D;this.setDisplayed(r).setEnabled(this.getEnabled()&&r)},doExecute:function(){var e=!this.getChecked();this.setChecked(e),this.getDisplayer().setHideHydrogens(e)}}),e.ChemWidget.ActionDisplayerChangeMolDisplayTypeBase=i.create(e.ChemWidget.ActionOnDisplayer,{CLASS_NAME:"Kekule.ChemWidget.ActionDisplayerChangeMolDisplayTypeBase",initialize:function($super,e,t,r,i){$super(e,t,r),this._displayType=i,this.setCheckGroup("__molDisplayType__")},doUpdate:function($super){$super();var e=this.getDisplayer();this.setChecked(e&&e.getCurrMoleculeDisplayType()===this.getMolDisplayType())},doExecute:function(){this.getDisplayer().setMoleculeDisplayType(this._displayType),this.setChecked(!0)},getMolDisplayType:function(){return this._displayType}}),e.ChemWidget.ActionDisplayerChangeMolDisplayTypeBase2D=i.create(e.ChemWidget.ActionDisplayerChangeMolDisplayTypeBase,{CLASS_NAME:"Kekule.ChemWidget.ActionDisplayerChangeMolDisplayTypeBase2D",doUpdate:function($super){$super();var t=this.getDisplayer(),r=t&&t.getRenderType()===e.Render.RendererType.R2D;this.setDisplayed(r).setEnabled(this.getEnabled()&&r)}}),e.ChemWidget.ActionDisplayerChangeMolDisplayTypeBase3D=i.create(e.ChemWidget.ActionDisplayerChangeMolDisplayTypeBase,{CLASS_NAME:"Kekule.ChemWidget.ActionDisplayerChangeMolDisplayTypeBase3D",doUpdate:function($super){$super();var t=this.getDisplayer(),r=t&&t.getRenderType()===e.Render.RendererType.R3D;this.setDisplayed(r).setEnabled(this.getEnabled()&&r)}}),e.ChemWidget.ActionDisplayerChangeMolDisplayTypeSkeletal=i.create(e.ChemWidget.ActionDisplayerChangeMolDisplayTypeBase2D,{CLASS_NAME:"Kekule.ChemWidget.ActionDisplayerChangeMolDisplayTypeSkeletal",HTML_CLASSNAME:o.ACTION_MOL_DISPLAY_SKELETAL,initialize:function($super,t){$super(t,e.$L("ChemWidgetTexts.CAPTION_SKELETAL"),e.$L("ChemWidgetTexts.HINT_SKELETAL"),e.ChemWidget.ActionDisplayerChangeMolDisplayTypeSkeletal.TYPE)}}),e.ChemWidget.ActionDisplayerChangeMolDisplayTypeSkeletal.TYPE=e.Render.Molecule2DDisplayType.SKELETAL,e.ChemWidget.ActionDisplayerChangeMolDisplayTypeCondensed=i.create(e.ChemWidget.ActionDisplayerChangeMolDisplayTypeBase2D,{CLASS_NAME:"Kekule.ChemWidget.ActionDisplayerChangeMolDisplayTypeCondensed",HTML_CLASSNAME:o.ACTION_MOL_DISPLAY_CONDENSED,initialize:function($super,t){$super(t,e.$L("ChemWidgetTexts.CAPTION_CONDENSED"),e.$L("ChemWidgetTexts.HINT_CONDENSED"),e.ChemWidget.ActionDisplayerChangeMolDisplayTypeCondensed.TYPE)}}),e.ChemWidget.ActionDisplayerChangeMolDisplayTypeCondensed.TYPE=e.Render.Molecule2DDisplayType.CONDENSED,e.ChemWidget.ActionDisplayerChangeMolDisplayTypeWire=i.create(e.ChemWidget.ActionDisplayerChangeMolDisplayTypeBase3D,{CLASS_NAME:"Kekule.ChemWidget.ActionDisplayerChangeMolDisplayTypeWire",HTML_CLASSNAME:o.ACTION_MOL_DISPLAY_WIRE,initialize:function($super,t){$super(t,e.$L("ChemWidgetTexts.CAPTION_WIRE"),e.$L("ChemWidgetTexts.HINT_WIRE"),e.ChemWidget.ActionDisplayerChangeMolDisplayTypeWire.TYPE)}}),e.ChemWidget.ActionDisplayerChangeMolDisplayTypeWire.TYPE=e.Render.Molecule3DDisplayType.WIRE,e.ChemWidget.ActionDisplayerChangeMolDisplayTypeSticks=i.create(e.ChemWidget.ActionDisplayerChangeMolDisplayTypeBase3D,{CLASS_NAME:"Kekule.ChemWidget.ActionDisplayerChangeMolDisplayTypeSticks",HTML_CLASSNAME:o.ACTION_MOL_DISPLAY_STICKS,initialize:function($super,t){$super(t,e.$L("ChemWidgetTexts.CAPTION_STICKS"),e.$L("ChemWidgetTexts.HINT_STICKS"),e.ChemWidget.ActionDisplayerChangeMolDisplayTypeSticks.TYPE)}}),e.ChemWidget.ActionDisplayerChangeMolDisplayTypeSticks.TYPE=e.Render.Molecule3DDisplayType.STICKS,e.ChemWidget.ActionDisplayerChangeMolDisplayTypeBallStick=i.create(e.ChemWidget.ActionDisplayerChangeMolDisplayTypeBase3D,{CLASS_NAME:"Kekule.ChemWidget.ActionDisplayerChangeMolDisplayTypeBallStick",HTML_CLASSNAME:o.ACTION_MOL_DISPLAY_BALLSTICK,initialize:function($super,t){$super(t,e.$L("ChemWidgetTexts.CAPTION_BALLSTICK"),e.$L("ChemWidgetTexts.HINT_BALLSTICK"),e.ChemWidget.ActionDisplayerChangeMolDisplayTypeBallStick.TYPE)}}),e.ChemWidget.ActionDisplayerChangeMolDisplayTypeBallStick.TYPE=e.Render.Molecule3DDisplayType.BALL_STICK,e.ChemWidget.ActionDisplayerChangeMolDisplayTypeSpaceFill=i.create(e.ChemWidget.ActionDisplayerChangeMolDisplayTypeBase3D,{CLASS_NAME:"Kekule.ChemWidget.ActionDisplayerChangeMolDisplayTypeSpaceFill",HTML_CLASSNAME:o.ACTION_MOL_DISPLAY_SPACEFILL,initialize:function($super,t){$super(t,e.$L("ChemWidgetTexts.CAPTION_SPACEFILL"),e.$L("ChemWidgetTexts.HINT_SPACEFILL"),e.ChemWidget.ActionDisplayerChangeMolDisplayTypeSpaceFill.TYPE)}}),e.ChemWidget.ActionDisplayerChangeMolDisplayTypeSpaceFill.TYPE=e.Render.Molecule3DDisplayType.SPACE_FILL,e}},function(e,t,r){"use strict";var i=r(0).Class,n=r(0).DataType;e.exports=function(e){var t=e.ChemWidget.HtmlClassNames;return e.ChemWidget.HtmlClassNames=Object.extend(e.ChemWidget.HtmlClassNames,{CHEM_STRUCT_TREE_VIEW:"K-Chem-Struct-TreeView",CHEM_STRUCT_TREE_VIEW_ITEM_TITLE:"K-Chem-Struct-TreeView-ItemTitle",CHEM_STRUCT_TREE_VIEW_ITEM_TYPE:"K-Chem-Struct-TreeView-ItemType"}),e.ChemWidget.StructureTreeView=i.create(e.Widget.TreeView,{CLASS_NAME:"Kekule.ChemWidget.StructureTreeView",initialize:function($super,t,r){$super(t),this.setPropStoreFieldValue("objMap",new e.MapEx(!0)),this.setEnableLiveUpdate(!0),this.setEnableMultiSelected(!0),this.setRootObj(r),this._pauseLiveUpdateFlag=0,this._changedObjects=[]},initProperties:function(){this.defineProp("rootObj",{dataType:"Kekule.ChemObject",serializable:!1,setter:function(e){var t=this.getPropStoreFieldValue("rootObj");this.setPropStoreFieldValue("rootObj",e),this.rootObjChanged(e,t)}}),this.defineProp("enableLiveUpdate",{dataType:n.BOOL}),this.defineProp("objMap",{dataType:"Kekule.MapEx",setter:null,serializable:!1})},doGetWidgetClassName:function($super){return $super()+" "+t.CHEM_STRUCT_TREE_VIEW},rootObjChanged:function(e,t){this.clearChildItems(),this.getObjMap().clear(),t&&this._uninstallRootEventHandler(t),e&&(this._fillTree(e),this._installRootEventHandler(e))},pauseLiveUpdate:function(){return this._pauseLiveUpdateFlag>=0&&(this._pauseLiveUpdateFlag=0,this._changedObjects=[]),--this._pauseLiveUpdateFlag,this},resumeLiveUpdate:function(){if(++this._pauseLiveUpdateFlag>=0){this._pauseLiveUpdateFlag=0;for(var e=0,t=this._changedObjects.length;e<t;++e)this.refreshObject(this._changedObjects[e])}},isLiveUpdatePaused:function(){return this._pauseLiveUpdateFlag<0},_installRootEventHandler:function(e){e.addEventListener("change",this.reactChemObjChange,this)},_uninstallRootEventHandler:function(e){e.removeEventListener("change",this.reactChemObjChange,this)},reactChemObjChange:function(t){this.getEnableLiveUpdate()&&(this.isLiveUpdatePaused()?this.getObjMap().get(t.target)&&e.ArrayUtils.pushUnique(this._changedObjects,t.target):this.refreshObject(t.target))},refreshObject:function(e){var t=this.getObjMap().get(e);return t&&this._updateTreeItem(t,e),this},_fillTree:function(e){e&&(this.clearChildItems(),this._updateTreeItem(this.appendChildItem(),e))},_updateTreeItem:function(e,t){var r=this._getChemObjDisplayTitle(t),i={text:r,obj:t};this.setItemData(e,i),this.getObjMap().set(t,e);for(var n=this.getChildItemCount(e),a=t.getChildCount(),o=0;o<a;++o){var s,l=t.getChildAt(o);s=o<n?this.getChildItemAt(e,o):this.appendChildItem(e),this._updateTreeItem(s,l)}if(n>a)for(var o=n-1;o>=a;--o)this.removeChildItemAt(e,o)},_getChemObjDisplayTitle:function(e){var r="",i=e.getId();i&&(r+='<span class="'+t.CHEM_STRUCT_TREE_VIEW_ITEM_TITLE+'">'+i+"</span>");var n=e.getClassName(),a=n.split("."),o=a.length?a[a.length-1]:n;return r+'<span class="'+t.CHEM_STRUCT_TREE_VIEW_ITEM_TYPE+'">('+o+")</span>"},selectChemObjs:function(e){for(var t=[],r=0,i=e.length;r<i;++r){var n=e[r],a=this.getObjMap().get(n);a&&t.push(a)}return this.select(t),this},getSelectedChemObjs:function(){var e=[],t=this.getSelection();if(t&&t.length)for(var r=0,i=t.length;r<i;++r){var n=this.getItemData(t[r]);n&&n.obj&&e.push(n.obj)}return e}}),e}},function(e,t,r){"use strict";var i=r(0).Class,n=(r(0).ClassEx,r(0).ObjectEx),a=r(0).DataType;e.exports=function(e){e.oneOf;return e.ChemWidget.AbstractUIMarker=i.create(n,{CLASS_NAME:"Kekule.ChemWidget.AbstractUIMarker",initialize:function($super){$super(),this.setVisible(!0)},initProperties:function(){this.defineProp("drawStyles",{dataType:a.OBJECT}),this.defineProp("visible",{dataType:a.BOOL})}}),e.ChemWidget.MetaShapeUiMarker=i.create(e.ChemWidget.AbstractUIMarker,{CLASS_NAME:"Kekule.ChemWidget.MetaShapeUiMarker",initialize:function($super,e){$super(),e&&this.setShapeInfo(e)},initProperties:function(){this.defineProp("shapeInfo",{dataType:a.OBJECT}),this.defineProp("shapeType",{dataType:a.INT,serializable:!1,setter:null,getter:function(){var e=this.getShapeInfo();return e?e.shapeType:null}})}}),e.ChemWidget.MetaShapeUIMarker=e.ChemWidget.MetaShapeUiMarker,e.ChemWidget.TextUiMarker=i.create(e.ChemWidget.AbstractUIMarker,{CLASS_NAME:"Kekule.ChemWidget.TextUiMarker",initialize:function($super,e,t){$super(),e&&this.setText(e),t&&this.setCoord(t)},initProperties:function(){this.defineProp("text",{dataType:a.STRING}),this.defineProp("coord",{dataType:a.HASH})}}),e.ChemWidget.UiMarkerCollection=i.create(n,{CLASS_NAME:"Kekule.ChemWidget.UiMarkerCollection",initProperties:function(){this.defineProp("markers",{dataType:a.ARRAY,getter:function(){var e=this.getPropStoreFieldValue("markers");return e||(e=[],this.setPropStoreFieldValue("markers",e)),e},setter:null})},getMarkerCount:function(){return this.getMarkers().length},getMarkerAt:function(e){return this.getMarkers()[e]},addMarker:function(e){return this.getMarkers().push(e)},indexOfMarker:function(e){return this.getMarkers().indexOf(e)},removeMarker:function(e){var t=this.getMarkers(),r=t.indexOf(e);r>=0&&t.splice(r,1)},clearMarkers:function(){this.setPropStoreFieldValue("markers",[])}}),e.ChemWidget.UiMarker2DRenderer=i.create(e.Render.Base2DRenderer,{CLASS_NAME:"Kekule.ChemWidget.UiMarkerRenderer"}),e.ChemWidget.MetaShapeUiMarker2DRenderer=i.create(e.ChemWidget.UiMarker2DRenderer,{CLASS_NAME:"Kekule.ChemWidget.MetaShapeUiMarker2DRenderer",doDrawSelf:function($super,t,r,i){var n=this.getChemObj(),a=n.getShapeInfo();if(!a)return null;var o=Object.create(i);o=Object.extend(o,n.getDrawStyles()||{}),o.color&&(o.strokeColor||(o.strokeColor=o.color),o.fillColor||(o.fillColor=o.color));var s;if(e.Render.MetaShapeUtils.isCompositeShape(a))if(a.length>1){s=this.createDrawGroup(t);for(var l=0,d=a.length;l<d;++l){var u=a[l];this.doDrawShape(t,s,u,o)}}else{if(1!==a.length)return null;s=this.doDrawShape(t,null,a[0],o)}else s=this.doDrawShape(t,null,a,o);return s},doDrawShape:function(t,r,i,n){var a,o=e.Render.MetaShapeType;if(e.Render.MetaShapeUtils.isCompositeShape(i)){a=this.createDrawGroup(t);for(var s=0,l=i.length;s<l;++s){this.doDrawShape(t,a,i[s],n)}}else{var d=i.coords;switch(i.shapeType){case o.POINT:a=this.drawCircle(t,d[0],1,n);break;case o.CIRCLE:a=this.drawCircle(t,d[0],i.radius,n);break;case o.LINE:var u=n;i.width&&(u=Object.create(n),u.strokeWidth=i.width),a=this.drawLine(t,d[0],d[1],u);break;case o.RECT:a=this.drawRect(t,d[0],d[1],n);break;case o.ARC:var u=Object.extend({},n);u.strokeWidth=i.width,u.fillColor=null,a=this.drawArc(t,d[0],i.radius,i.startAngle,i.endAngle,i.anticlockwise,u);break;case o.POLYGON:case o.POLYLINE:for(var c=[],s=0,l=d.length;s<l;++s){var h=0===s?"M":"L";c.push(h);var m=[d[s].x,d[s].y];c.push(m)}i.shapeType===o.POLYGON&&(c.push("L"),m=[d[0].x,d[0].y],c.push(m));var g=e.Render.DrawPathUtils.makePath.apply(this,c);a=this.drawPath(t,g,n)}}return r&&this.addToDrawGroup(a,r),a}}),e.ChemWidget.TextUiMarker2DRenderer=i.create(e.ChemWidget.UiMarker2DRenderer,{CLASS_NAME:"Kekule.ChemWidget.TextUiMarker2DRenderer",doDrawSelf:function($super,t,r,i){var n=this.getChemObj(),a={textBoxXAlignment:e.Render.BoxXAlignment.CENTER,textBoxYAlignment:e.Render.BoxYAlignment.CENTER};a=Object.extend(a,i),a=Object.extend(a,n.getDrawStyles()||{});var o=n.getCoord();return n.getText()&&o?this.drawText(t,o,n.getText(),a):null}}),e.ChemWidget.UiMarkerCollection2DRenderer=i.create(e.ChemWidget.UiMarker2DRenderer,{CLASS_NAME:"Kekule.ChemWidget.UiMarkerCollection2DRenderer",getChildObjs:function($super){for(var e=this.getChemObj(),t=e.getMarkers(),r=[],i=0,n=t.length;i<n;++i)t[i].getVisible()&&r.push(t[i]);return r}}),e.Render.Renderer2DFactory.register(e.ChemWidget.MetaShapeUiMarker,e.ChemWidget.MetaShapeUiMarker2DRenderer),e.Render.Renderer2DFactory.register(e.ChemWidget.TextUiMarker,e.ChemWidget.TextUiMarker2DRenderer),e.Render.Renderer2DFactory.register(e.ChemWidget.UiMarkerCollection,e.ChemWidget.UiMarkerCollection2DRenderer),e.ChemWidget.UiMarkersRenderer=i.create(e.Render.Base2DRenderer,{CLASS_NAME:"Kekule.ChemWidget.UiMarkersRenderer",DRAW_ELEM_FIELD:"__$drawElem__",initialize:function($super,e,t){$super(e,t),this._drawGroup=null},initProperties:function(){},getObjDrawElem:function(e,t){return this.getExtraProp2(e,t,this.DRAW_ELEM_FIELD)},setObjDrawElem:function(e,t,r){this.setExtraProp2(e,t,this.DRAW_ELEM_FIELD,r)},doEstimateRenderBox:function(e,t,r,i){return null},doDraw:function($super,e,t,r){$super(e,t,r);var i=this.getChemObj(),n=this.createDrawGroup(e);return this.setObjDrawElem(e,i,n),i.getMarkerCount()>0&&this.doDrawMarkers(e,n,i.getMarkers(),r),n},doUpdate1:function($super,t,r,i){if(this.canModifyGraphic(t)){var n=!1,a=e.Render.ObjectUpdateType;switch(i){case a.ADD:n=this.doAddNew(t,r);break;case a.MODIFY:n=this.doModify(t,r);break;case a.REMOVE:var o=this._extractObjsOfUpdateObjDetails(r);n=this.doRemove(t,o);break;default:return $super(t,r,i)}return n}return $super(t,r,i)},doAddNew:function(e,t){return!!this.canRemoveElem()&&this.doModify(e,t)},doModify:function(e,t){if(!this.canRemoveElem())return!1;var r=this._extractObjsOfUpdateObjDetails(t);this.remove(e,r);var i=this.getChemObj(),n=this.getObjDrawElem(i),a=this.getDrawParams();r.indexOf(i)>=0?this.draw(e,a.baseCoord,a.options):this.doDrawMarkers(e,n,r,a.options)},doRemove:function(e,t){if(!this.canRemoveElem())return!1;var r=this.getObjDrawElem(t);if(r){var i=this.getObjDrawElem(this.getChemObj());this.doRemoveFromGroup(r,i),this.doRemoveElem(e,r),this.setObjDrawElem(t,null)}},doDrawMarkers:function(e,t,r,i){for(var n=0,a=r.length;n<a;++n){var o=r[n];o.getVisible()&&this.doDrawMarker(e,t,o,i)}},doDrawMarker:function(t,r,i,n){var a=i.getShapeInfo();if(!a)return null;var o=Object.create(n);o=Object.extend(i.getDrawStyles()||{}),o.color&&(o.strokeColor||(o.strokeColor=o.color),o.fillColor||(o.fillColor=o.color));var s;if(e.ArrayUtils.isArray(a))if(a.length>1){s=this.createDrawGroup(t);for(var l=0,d=a.length;l<d;++l){var u=a[l];this.doDrawShape(t,s,u,o)}}else{if(1!==a.length)return null;s=this.doDrawShape(t,null,a[0],o)}else s=this.doDrawShape(t,null,a,o);return s&&(this.setObjDrawElem(t,i,s),r&&this.addToDrawGroup(s,r)),s},doDrawShape:function(t,r,i,n){var a,o=e.Render.MetaShapeType;if(e.Render.MetaShapeUtils.isCompositeShape(i)){a=this.createDrawGroup(t);for(var s=0,l=i.length;s<l;++s){this.doDrawShape(t,a,i[s],n)}}else{var d=i.coords;switch(i.shapeType){case o.POINT:a=this.drawCircle(t,d[0],1,n);break;case o.CIRCLE:a=this.drawCircle(t,d[0],i.radius,n);break;case o.LINE:var u=n;i.width&&(u=Object.create(n),u.strokeWidth=i.width),a=this.drawLine(t,d[0],d[1],u);break;case o.RECT:a=this.drawRect(t,d[0],d[1],n);break;case o.POLYGON:case o.POLYLINE:for(var c=[],s=0,l=d.length;s<l;++s){var h=0===s?"M":"L";c.push(h);var m=[d[s].x,d[s].y];c.push(m)}i.shapeType===o.POLYGON&&(c.push("L"),m=[d[0].x,d[0].y],c.push(m));var g=e.Render.DrawPathUtils.makePath.apply(this,c);a=this.drawPath(t,g,n)}}return r&&this.addToDrawGroup(a,r),a}}),e.ClassDefineUtils.addExtraTwoTupleObjMapSupport(e.ChemWidget.UiMarkersRenderer),e}},function(e,t,r){"use strict";var i=r(0).Class,n=r(0).ClassEx,a=(r(0).ObjectEx,r(0).DataType);e.exports=function(e){var t=i.PropertyScope,r=e.ArrayUtils,o=(e.ZoomUtils,e.ChemWidget.ComponentWidgetNames),s=e.ChemWidget,l=e.Widget.EvokeMode;e.globalOptions.add("chemWidget.viewer",{toolButtons:[o.loadData,o.saveData,o.molDisplayType,o.molHideHydrogens,o.zoomIn,o.zoomOut,o.rotateX,o.rotateY,o.rotateZ,o.rotateLeft,o.rotateRight,o.reset,o.openEditor],menuItems:[o.loadData,o.saveData,e.Widget.MenuItem.SEPARATOR_TEXT,o.molDisplayType,o.molHideHydrogens,o.zoomIn,o.zoomOut,{text:e.$L("ChemWidgetTexts.CAPTION_ROTATE"),hint:e.$L("ChemWidgetTexts.HINT_ROTATE"),children:[o.rotateLeft,o.rotateRight,o.rotateX,o.rotateY,o.rotateZ]},o.reset,e.Widget.MenuItem.SEPARATOR_TEXT,o.openEditor,o.config]}),e.ChemWidget.HtmlClassNames=Object.extend(e.ChemWidget.HtmlClassNames,{VIEWER:"K-Chem-Viewer",VIEWER2D:"K-Chem-Viewer2D",VIEWER3D:"K-Chem-Viewer3D",VIEWER_CAPTION:"K-Chem-Viewer-Caption",VIEWER_EMBEDDED_TOOLBAR:"K-Chem-Viewer-Embedded-Toolbar",VIEWER_MENU_BUTTON:"K-Chem-Viewer-Menu-Button",VIEWER_EDITOR_FULLCLIENT:"K-Chem-Viewer-Editor-FullClient",ACTION_ROTATE_LEFT:"K-Chem-RotateLeft",ACTION_ROTATE_RIGHT:"K-Chem-RotateRight",ACTION_ROTATE_X:"K-Chem-RotateX",ACTION_ROTATE_Y:"K-Chem-RotateY",ACTION_ROTATE_Z:"K-Chem-RotateZ",ACTION_VIEWER_EDIT:"K-Chem-Viewer-Edit"});var d=e.Widget.HtmlClassNames,u=e.ChemWidget.HtmlClassNames;e.ChemWidget.Viewer=i.create(e.ChemWidget.ChemObjDisplayer,{CLASS_NAME:"Kekule.ChemWidget.Viewer",BINDABLE_TAG_NAMES:["div","span","img"],DEF_BGCOLOR_2D:null,DEF_BGCOLOR_3D:"#000000",DEF_TOOLBAR_EVOKE_MODES:[l.EVOKEE_CLICK,l.EVOKEE_MOUSE_ENTER,l.EVOKEE_TOUCH],DEF_TOOLBAR_REVOKE_MODES:[l.EVOKEE_MOUSE_LEAVE,l.EVOKER_TIMEOUT],initialize:function($super,t,r,i,n){this.setPropStoreFieldValue("renderType",i||e.Render.RendererType.R2D),this.setPropStoreFieldValue("enableToolbar",!1),this.setPropStoreFieldValue("toolbarEvokeModes",this.DEF_TOOLBAR_EVOKE_MODES),this.setPropStoreFieldValue("toolbarRevokeModes",this.DEF_TOOLBAR_REVOKE_MODES),this.setPropStoreFieldValue("enableDirectInteraction",!0),this.setPropStoreFieldValue("toolbarPos",e.Widget.Position.AUTO),this.setPropStoreFieldValue("toolbarMarginHorizontal",10),this.setPropStoreFieldValue("toolbarMarginVertical",10),this.setPropStoreFieldValue("showCaption",!1),this.setPropStoreFieldValue("useCornerDecoration",!0),$super(t,r,i,n),this.setPadding(this.getRenderConfigs().getLengthConfigs().getActualLength("autofitContextPadding")),this._isContinuousRepainting=!1;var a=e.Render.RendererType,o=this.getRenderType()===a.R2D?this.getBackgroundColor()||this.DEF_BGCOLOR_2D:this.DEF_BGCOLOR_2D,s=this.getRenderType()===a.R3D?this.getBackgroundColor()||this.DEF_BGCOLOR_3D:this.DEF_BGCOLOR_3D;this.setBackgroundColorOfType(o,a.R2D),this.setBackgroundColorOfType(s,a.R3D),this.useCornerDecorationChanged(),this.doResize(),this.addIaController("default",new e.ChemWidget.ViewerBasicInteractionController(this),!0),console.log("+++++++++++ HI!!! I'm CherryPickToApril Kekule.ChemWidget.Viewer.")},doFinalize:function($super){var e=this.getToolbar();$super(),e&&e.finalize(),this._composerDialog&&this._composerDialog.finalize(),this._composerPanel&&this._composerPanel.finalize()},initProperties:function(){this.defineProp("viewerConfigs",{dataType:"Kekule.ChemWidget.ChemObjDisplayerConfigs",serializable:!1,getter:function(){return this.getDisplayerConfigs()},setter:function(e){return this.setDisplayerConfigs(e)}}),this.defineProp("allowedMolDisplayTypes",{dataType:a.ARRAY,scope:t.PUBLIC,setter:function(e){this.setPropStoreFieldValue("allowedMolDisplayTypes",e),this.updateUiComps()}}),this.defineProp("enableRestraintRotation3D",{dataType:a.BOOL}),this.defineProp("restraintRotation3DEdgeRatio",{dataType:a.FLOAT}),this.defineProp("enableEdit",{dataType:a.BOOL,getter:function(){return this.getPropStoreFieldValue("enableEdit")&&this.getCoordMode()!==e.CoordMode.COORD3D}}),this.defineProp("shareEditorInstance",{dataType:a.BOOL}),this.defineProp("enableEditFromVoid",{dataType:a.BOOL}),this.defineProp("restrainEditorWithCurrObj",{dataType:a.BOOL}),this.defineProp("modalEdit",{dataType:a.BOOL}),this.defineProp("editorProperties",{dataType:a.HASH}),this.defineProp("toolButtons",{dataType:a.ARRAY,scope:t.PUBLIC,getter:function(){return this.getPropStoreFieldValue("toolButtons")},setter:function(e){this.setPropStoreFieldValue("toolButtons",e),this.updateToolbar()}}),this.defineProp("menuItems",{dataType:a.ARRAY,scope:t.PUBLIC,setter:function(e){this.setPropStoreFieldValue("menuItems",e),this.updateMenu()}}),this.defineProp("menu",{dataType:"Kekule.Widget.Menu",serializable:!1,scope:t.PRIVATE,setter:function(e){var t=this.getMenu();e!==t&&(t&&(t.finalize(),t=null),this.setPropStoreFieldValue("menu",e))}}),this.defineProp("toolbar",{dataType:"Kekule.Widget.ButtonGroup",serializable:!1,scope:t.PRIVATE,setter:function(t){var r=this.getToolbar(),i=this.getToolbarEvokeHelper();if(t!==r){if(r){r.finalize();var n=this.getToolbarEvokeHelper();n&&n.finalize(),r=null}i&&i.finalize(),this.setPropStoreFieldValue("toolbar",t),t&&this.setPropStoreFieldValue("toolbarEvokeHelper",new e.Widget.DynamicEvokeHelper(this,t,this.getToolbarEvokeModes(),this.getToolbarRevokeModes()))}}}),this.defineProp("enableToolbar",{dataType:a.BOOL,setter:function(e){this.setPropStoreFieldValue("enableToolbar",e),this.updateToolbar()}}),this.defineProp("toolbarPos",{dataType:a.INT,enumSource:e.Widget.Position,setter:function(e){this.setPropStoreFieldValue("toolbarPos",e),this.adjustToolbarPos()}}),this.defineProp("toolbarMarginVertical",{dataType:a.INT,setter:function(e){this.setPropStoreFieldValue("toolbarMarginVertical",e),this.adjustToolbarPos()}}),this.defineProp("toolbarMarginHorizontal",{dataType:a.INT,setter:function(e){this.setPropStoreFieldValue("toolbarMarginHorizontal",e),this.adjustToolbarPos()}}),this.defineProp("toolbarEvokeHelper",{dataType:"Kekule.Widget.DynamicEvokeHelper",serializable:!1,setter:null,scope:t.PRIVATE}),this.defineProp("toolbarEvokeModes",{dataType:a.ARRAY,scope:t.PUBLIC,setter:function(e){this.setPropStoreFieldValue("toolbarEvokeModes",e||[]),this.getToolbarEvokeHelper()&&this.getToolbarEvokeHelper().setEvokeModes(e||[])}}),this.defineProp("toolbarRevokeModes",{dataType:a.ARRAY,scope:t.PUBLIC,setter:function(e){this.setPropStoreFieldValue("toolbarRevokeModes",e||[]),this.getToolbarEvokeHelper()&&this.getToolbarEvokeHelper().setRevokeModes(e||[])}}),this.defineProp("toolbarRevokeTimeout",{dataType:a.INT,setter:function(e){this.setPropStoreFieldValue("toolbarRevokeTimeout",e),this.getToolbarEvokeHelper()&&this.getToolbarEvokeHelper().setTimeout(e)}}),this.defineProp("toolbarParentElem",{dataType:a.OBJECT,serializable:!1,setter:function(e){this.getToolbarParentElem()!==e&&(this.setPropStoreFieldValue("toolbarParentElem",e),this.updateToolbar())}}),this.defineProp("caption",{dataType:a.STRING,setter:function(t){this.setPropStoreFieldValue("caption",t),e.DomUtils.setElementText(this.getCaptionElem(),t||""),this.captionChanged()}}),this.defineProp("showCaption",{dataType:a.BOOL,setter:function(e){this.setPropStoreFieldValue("showCaption",e),this.captionChanged()}}),this.defineProp("captionPos",{dataType:a.INT,enumSource:e.Widget.Position,setter:function(e){this.setPropStoreFieldValue("captionPos",e),this.captionChanged()}}),this.defineProp("autoCaption",{dataType:a.BOOL,setter:function(e){this.setPropStoreFieldValue("autoCaption",e),e&&this.autoDetectCaption()}}),this.defineProp("captionElem",{dataType:a.OBJECT,scope:t.PRIVATE,setter:null,getter:function(e){var t=this.getPropStoreFieldValue("captionElem");return t||e||(t=this.doCreateCaptionElem(),this.setPropStoreFieldValue("captionElem",t)),t}}),this.defineProp("actions",{dataType:"Kekule.ActionList",serializable:!1,scope:t.PUBLIC,setter:null,getter:function(){var t=this.getPropStoreFieldValue("actions");return t||(t=new e.ActionList,this.setPropStoreFieldValue("actions",t)),t}}),this.defineProp("actionMap",{dataType:"Kekule.MapEx",serializable:!1,scope:t.PRIVATE,setter:null,getter:function(){var t=this.getPropStoreFieldValue("actionMap");return t||(t=new e.MapEx(!0),this.setPropStoreFieldValue("actionMap",t)),t}}),this.defineProp("enableDirectInteraction",{dataType:a.BOOL}),this.defineProp("enableTouchInteraction",{dataType:a.BOOL,setter:function(e){this.setPropStoreFieldValue("enableTouchInteraction",!!e),this.setTouchAction(e?"none":null)}})},initPropValues:function($super){this.setUseNormalBackground(!1),this.setModalEdit(!0),this.setRestrainEditorWithCurrObj(!0),this.setRestraintRotation3DEdgeRatio(.18),this.setEnableRestraintRotation3D(!0),this.setShareEditorInstance(!0),this.setEnableTouchInteraction(!1)},canUsePlaceHolderOnElem:function(e){var t=e.getAttribute("src");return"img"===e.tagName.toLowerCase()&&!!t},doObjectChange:function($super,e){$super(e),this.updateActions()},doSetElement:function($super,t){var r=t;if(r){"img"===r.tagName.toLowerCase()&&(r=e.DomUtils.replaceTagName(r,"span"))}return $super(r)},doUnbindElement:function($super,e){return this._drawContextParentElem&&this._drawContextParentElem.parentNode&&(this._drawContextParentElem.parentNode.removeChild(this._drawContextParentElem),this._drawContextParentElem=null),$super(e)},elementBound:function(e){this.setObserveElemResize(!0)},doCreateRootElement:function(e){return e.createElement("div")},doGetWidgetClassName:function($super){var e=$super()+" "+u.VIEWER;try{var t=this.getRenderType();e+=" "+this._getRenderTypeSpecifiedHtmlClassName(t)}catch(e){}return e},_getRenderTypeSpecifiedHtmlClassName:function(t){return t===e.Render.RendererType.R3D?u.VIEWER3D:u.VIEWER2D},getResizerElement:function(){return this.getDrawContextParentElem()},doResize:function($super){this.adjustDrawParentDim(),this.adjustToolbarPos(),$super()},doWidgetShowStateChanged:function(e){e&&this.updateActions()},refitDrawContext:function($super,e){$super(e),this.adjustToolbarPos()},getAllowRenderTypeChange:function(){return!0},resetRenderType:function($super,e,t){$super(e,t);var r=this._getRenderTypeSpecifiedHtmlClassName(e),i=this._getRenderTypeSpecifiedHtmlClassName(t);this.removeClassName(r),this.addClassName(i),this.updateUiComps()},doLoadEnd:function(e){this.updateActions(),this.autoDetectCaption()},doSetUseCornerDecoration:function($super,e){$super(e),this.useCornerDecorationChanged()},useCornerDecorationChanged:function(){var t=this.getDrawContextParentElem();if(t){this.getUseCornerDecoration()?e.HtmlElementUtils.addClass(t,d.CORNER_ALL):e.HtmlElementUtils.removeClass(t,d.CORNER_ALL)}},adjustDrawParentDim:function(){var t,r,i=this.getDrawContextParentElem(),n=i.parentNode,a=this.getCaptionElem(!0),o=e.HtmlElementUtils.getElemClientDimension(n);if(a&&this.captionIsShown()&&a.parentNode===n){var s=e.HtmlElementUtils.getElemClientDimension(a);r=Math.max(o.height-s.height,0),t=this.getCaptionPos()&e.Widget.Position.TOP?s.height:0,i.style.top=t+"px",i.style.height=r+"px"}else e.StyleUtils.removeStyleProperty(i.style,"top"),i.style.height=o.height+"px"},getInteractionReceiverElem:function(){return this.getDrawContextParentElem()},setDrawDimension:function($super,t,r){var i=r;if(this.captionIsShown()){i+=e.HtmlElementUtils.getElemClientDimension(this.getCaptionElem()).height||0}$super(t,i)},doCreateCaptionElem:function(){var e=this.getDocument().createElement("span");return e.className=d.DYN_CREATED+"  "+d.SELECTABLE+" "+u.VIEWER_CAPTION,this.getElement().appendChild(e),e},captionChanged:function(){if(this.captionIsShown()){var t=this.getCaptionElem(),r=t.style;this.getCaptionPos()&e.Widget.Position.TOP?(r.top=0,r.bottom="auto"):(r.bottom=0,r.top="auto"),r.display="block"}else{var t=this.getCaptionElem(!0);t&&(t.style.display="none")}this.doResize()},captionIsShown:function(){return this.getCaption()&&this.getShowCaption()},getAllowEditing:function(){return this.getCoordMode()!==e.CoordMode.COORD3D&&this.getEnableEdit()&&(this.getChemObj()||this.getEnableEditFromVoid())},getComposerDialog:function(){var t;return t=this.getShareEditorInstance()?e.ChemWidget.Viewer._composerDialog:this._composerDialog,t||e.Editor.ComposerDialog&&(t=new e.Editor.ComposerDialog(this.getDocument(),e.$L("ChemWidgetTexts.CAPTION_EDIT_OBJ"),[e.Widget.DialogButtons.OK,e.Widget.DialogButtons.CANCEL])),this.getShareEditorInstance()?e.ChemWidget.Viewer._composerDialog=t:this._composerDialog=t,t},getComposerPanel:function(){var t;if(!(t=this.getShareEditorInstance()?e.ChemWidget.Viewer._composerPanel:this._composerPanel)&&e.Editor.Composer){t=new e.Editor.Composer(this.getDocument()),t.addClassName(u.VIEWER_EDITOR_FULLCLIENT),t.setUseNormalBackground(!0);var i=e.Editor.Composer.getMinPreferredDimension();t.setMinDimension(i),t.setEnableDimensionTransform(!0),t.setAutoResizeConstraints({width:1,height:1});var n=e.globalOptions.chemWidget.composer.commonToolButtons;n=r.exclude(n,[o.cut,o.config,o.objInspector]),t.setCommonToolButtons(n);var a=[{text:e.$L("ChemWidgetTexts.CAPTION_EDITOR_DONE"),hint:e.$L("ChemWidgetTexts.HINT_EDITOR_DONE"),htmlClass:"K-Res-Button-YesOk",showText:!0,"#execute":function(){t._doneEditCallback(),t.hide()}},{text:e.$L("ChemWidgetTexts.CAPTION_EDITOR_CANCEL"),hint:e.$L("ChemWidgetTexts.HINT_EDITOR_CANCEL"),htmlClass:"K-Res-Button-NoCancel",showText:!0,"#execute":function(){t.hide()}}];t._customEndEditButtons=a}return this.getShareEditorInstance()?e.ChemWidget.Viewer._composerPanel=t:this._composerPanel=t,t._invokerViewer=this,t._doneEditCallback=null,t},openEditor:function(t){if(this.getAllowEditing()){var r=this.getChemObj(),i=!r,n=r&&r.isEmpty&&r.isEmpty(),a=this.getRestrainEditorWithCurrObj(),o=e.DocumentUtils.getClientDimension(this.getDocument()),s=e.Editor.Composer.getMinPreferredDimension();o.width<=s.width+50||o.height<s.height+100?this._openEditComposer(t,r,a,i,n):this._openEditComposerDialog(t,r,a,i,n)}},_prepareEditComposer:function(e,t,r,i){e.setEnableCreateNewDoc(r||!t),e.setEnableLoadNewFile(r||!t),e.setAllowCreateNewChild(r||!t);var n=this.getEditorProperties();n&&e.setPropValues(n)},_feedbackEditResult:function(e,t,r){if(e.isDirty()){var i=e.getSavingTargetObj();r?this.setChemObj(i.clone()):this.getRestrainEditorWithCurrObj()?(t.getClass()===i.getClass()?t.assign(i.clone()):t.assign(i),t.setSrcInfo(null),this.setChemObj(t)):this.setChemObj(i),this.invokeEvent("editingDone",{obj:this.getChemObj()})}},_openEditComposerDialog:function(t,r,i,n,a){var o=this.getComposerDialog();if(!o)return void e.error(e.$L("ErrorMsg.CAN_NOT_CREATE_EDITOR"));var s=o.getComposer();this._prepareEditComposer(s,i,n,a);var l;n||a?o.getComposer().newDoc():(l=r.clone(),o.setChemObj(l));var d=this,u=function(t){t===e.Widget.DialogButtons.OK&&o.getComposer().isDirty()&&d._feedbackEditResult(o.getComposer(),r,n)};this.getModalEdit()?o.openModal(u,t||this):o.openPopup(u,t||this)},_openEditComposer:function(t,r,i,n,a){var o=this.getComposerPanel();if(!o)return void e.error(e.$L("ErrorMsg.CAN_NOT_CREATE_EDITOR"));this._prepareEditComposer(o,i,n,a);for(var s=o._customEndEditButtons,l=o.getCommonToolButtons()||[],d=!1,u=0,c=s.length;u<c;++u){var h=s[u];l.indexOf(h)<0&&(l.push(h),d=!0)}if(d&&o.setCommonToolButtons(l),n||a)o.newDoc();else{var m=r.clone();o.setChemObj(m)}var g=this;o._doneEditCallback=function(){g._feedbackEditResult(o,r,n)},o.show(t,function(){n||a||o.setChemObj(m)},e.Widget.ShowHideType.POPUP)},resetView:function(){return this.resetDisplay()},getCurr2DRotationAngle:function(){return this.getDrawOptions().rotateAngle||0},rotate2DBy:function(e,t){return this.rotate2DTo(this.getCurr2DRotationAngle()+e,t)},rotate2DTo:function(e,t){return this.getDrawOptions().rotateAngle=e,t||this.geometryOptionChanged(),this},getCurr3DRotationInfo:function(){for(var e={},t=["rotateMatrix","rotateX","rotateY","rotateZ","rotateAngle"],r=this.getDrawOptions(),i=0,n=t.length;i<n;++i){var a=t[i];e[a]=r[a]||0}return e.rotateAxisVector=r.rotateAxisVector||null,e},setRotate3DMatrix:function(e,t){return this.getDrawOptions().rotateMatrix=e,t||this.geometryOptionChanged(),this},rotate3DBy:function(t,r,i,n){var a=this.getCurr3DRotationInfo(),o=a.rotateMatrix||e.MatrixUtils.createIdentity(4),s=e.CoordUtils.calcRotate3DMatrix({rotateX:t,rotateY:r,rotateZ:i}),l=e.MatrixUtils.multiply(s,o);return this.setRotate3DMatrix(l,n),this},rotate3DByAxis:function(t,r,i){var n=this.getCurr3DRotationInfo(),a=n.rotateMatrix||e.MatrixUtils.createIdentity(4),o=e.CoordUtils.calcRotate3DMatrix({rotateAngle:t,rotateAxisVector:r}),s=e.MatrixUtils.multiply(o,a);return this.setRotate3DMatrix(s,i),this},getDefaultToolBarButtons:function(){return e.globalOptions.chemWidget.viewer.toolButtons},isToolbarEmbedded:function(){return!this.getToolbarParentElem()},adjustToolbarPos:function(){var t=this.getToolbar();if(t)if(this.isToolbarEmbedded()){var r=e.Widget.Position,i=e.HtmlElementUtils.getElemPageRect(this.getDrawContextParentElem()),n=e.HtmlElementUtils.getElemPageRect(t),a=this.getToolbarPos(),o=this.getToolbarMarginHorizontal(),s=this.getToolbarMarginVertical(),l="left",d="top",u="right",c="bottom",h=(i.width-n.width)/2,m=(i.height-n.height)/2;if(a===r.AUTO||!a){var g=2*(o>0?o:0)+n.width,f=2*(s>0?s:0)+n.height;g>i.width?(a|=r.LEFT,o=0):a|=r.RIGHT,f>i.height/2?(a|=r.BOTTOM,s=-1):a|=r.BOTTOM}a&r.LEFT?(l="left",u="right",h=o>=0?o:o-n.width):a&r.RIGHT&&(l="right",u="left",h=o>=0?o:o-n.width),a&r.TOP?(d="top",c="bottom",m=s>=0?s:s-n.height):a&r.BOTTOM&&(d="bottom",c="top",m=s>=0?s:s-n.height),t.removeStyleProperty(u),t.removeStyleProperty(c),t.setStyleProperty(l,h+"px"),t.setStyleProperty(d,m+"px")}else t.removeStyleProperty("left"),t.removeStyleProperty("top"),t.removeStyleProperty("width"),t.removeStyleProperty("height")},updateToolbar:function(){this.getEnableToolbar()?(this.createToolbar(),this.adjustToolbarPos()):this.setToolbar(null)},updateMenu:function(){this.createMenu()},updateUiComps:function(){this.updateToolbar(),this.updateMenu()},updateActions:function(){this.getActions()&&this.getActions().updateAll()},clearActions:function(){this.getActions().clear(),this.getActionMap().clear()},getCompActionClass:function(e){return this.getChildActionClass(e,!0)},_getActionOfComp:function(e,t,r){var i=this.getActionMap(),n=i.get(e);if(!n&&t){var a=this.getCompActionClass(e)||r;a&&(n=new a(this),i.set(e,n),this.getActions().add(n))}return n},createToolbar:function(){this.clearActions();var t=new e.Widget.ButtonGroup(this);t.addClassName(d.DYN_CREATED),t.setDisplayed(!1),t.setShowText(!1),t.doSetShowGlyph(!0);for(var r=this.getToolButtons()||this.getDefaultToolBarButtons(),i=0,n=r.length;i<n;++i){var a=r[i];this.createToolButton(a,t)}return t.addClassName(u.INNER_TOOLBAR),this.isToolbarEmbedded()&&t.addClassName(u.VIEWER_EMBEDDED_TOOLBAR),t.appendToElem(this.getToolbarParentElem()||this.getElement()),this.setToolbar(t),t},createToolButton:function(t,r){var i=null,s=this.beginContinuousRepainting.bind(this),l=this.endContinuousRepainting.bind(this),d=[o.rotateX,o.rotateY,o.rotateZ,o.rotateLeft,o.rotateRight];if(a.isObjectValue(t)){var u=Object.extend({widget:e.Widget.Button},t);i=e.Widget.Utils.createFromHash(r,u);var c=u.actionClass;if(c&&"string"==typeof c&&(c=n.findClass(u.actionClass,void 0,e)),c){var h=this._getActionOfComp(i,!0,c);h&&i.setAction(h)}}else{if(t===o.molDisplayType)return this.createMolDisplayTypeButton(r);if(t===o.menu)return this.createMenuButton(r);var c=this.getCompActionClass(t),m=e.Widget.Button;t===o.molHideHydrogens&&(m=e.Widget.CheckButton),i=new m(r);var h=this._getActionOfComp(t,!0);h&&i.setAction(h),d.indexOf(t)>=0&&(i.setPeriodicalExecInterval(20),i.setEnablePeriodicalExec(!0),i.addEventListener("activate",s),i.addEventListener("deactivate",l))}return i},createMenuButton:function(t){var r=new e.Widget.DropDownButton(t);return r.setText(e.$L("WidgetTexts.CAPTION_MENU")).setHint(e.$L("WidgetTexts.HINT_MENU")),r.addClassName(u.VIEWER_MENU_BUTTON),this.getMenu()||this.createMenu(),r.setDropDownWidget(this.getMenu()),r},createMolDisplayTypeButton:function(t){var r=new e.Widget.CompactButtonSet(t);r.getButtonSet().addClassName(u.INNER_TOOLBAR),r.setShowText(!1);var i=this._getActionOfComp(o.molDisplayType,!0);r.setAction(i),this.getActions().add(i);for(var n=this.getDocument(),a=this.getAllowedMolDisplayTypes(),s=this._getUsableMolDisplayActionClasses(a),l=0,d=s.length;l<d;++l){var c=s[l].TYPE,h=new e.Widget.RadioButton(n),i=this._getActionOfComp(o.molDisplayType+c,!0,s[l]);h.setAction(i),r.append(h,c===this.getCurrMoleculeDisplayType())}return r},_getUsableMolDisplayActionClasses:function(t){for(var r=[],i=this.getRenderType()===e.Render.RendererType.R3D?s.Viewer.molDisplayType3DActionClasses:s.Viewer.molDisplayType2DActionClasses,n=0,a=i.length;n<a;++n){var o=i[n].TYPE;t&&t.indexOf(o)<0&&o!==this.getCurrMoleculeDisplayType()||r.push(i[n])}return r},getDefaultMenuItems:function(){return e.globalOptions.chemWidget.viewer.menuItems},prepareMenuItems:function(t){for(var r=[],i=e.Widget.MenuItem.SEPARATOR_TEXT,n=0,a=t.length;n<a;++n){var o=t[n];if("string"==typeof o){if(o!==i){var s=this.createPredefinedMenuItemDefHash(o);s&&r.push(s)}}else{var l=Object.extend({},o);if(o.widget||o.widgetClass||(l.widget=e.Widget.MenuItem),o.children&&o.children.length){var d=this.prepareMenuItems(o.children);l.children=d}r.push(l)}}return r},createPredefinedMenuItemDefHash:function(t){if(t===o.molDisplayType)return this.createMolDisplayMenuDefHash();var r=[o.rotateX,o.rotateY,o.rotateZ,o.rotateLeft,o.rotateRight],i=this.beginContinuousRepainting.bind(this),n=this.endContinuousRepainting.bind(this),a=(this.getCompActionClass(t),e.Widget.MenuItem),s=null,l=this._getActionOfComp(t,!0);return l&&(s={widget:a,action:l},r.indexOf(t)>=0&&(s=Object.extend(s,{periodicalExecInterval:20,enablePeriodicalExec:!0,"#activate":i,"@deactivate":n}))),s},createMolDisplayMenuDefHash:function(){for(var t=this._getActionOfComp(o.molDisplayType,!0),r={widget:e.Widget.MenuItem,action:t},i=[],n=this.getAllowedMolDisplayTypes(),a=this._getUsableMolDisplayActionClasses(n),s=0,l=a.length;s<l;++s){var d=a[s].TYPE,t=this._getActionOfComp(o.molDisplayType+d,!0,a[s]);i.push({widget:e.Widget.MenuItem,action:t})}return i.length&&(r.children=[{widget:e.Widget.PopupMenu,children:i}]),r},createMenu:function(){var t=this.getMenu();t?t.clearMenuItems():(t=new e.Widget.PopupMenu(this),t.addClassName(d.DYN_CREATED),t.setDisplayed(!1));var r=this.getMenuItems()||this.getDefaultMenuItems();return r=this.prepareMenuItems(r),t.createChildrenByDefs(r),this.setMenu(t),t},autoDetectCaption:function(){if(this.getAutoCaption()){var e=this.getChemObj();if(e){var t=e&&e.getInfo(),r=e&&e.getSrcInfo();if(t&&r){var i=t.title||t.caption||e.getName()||r.fileName;i&&this.setCaption(i)}}}}});var c=e.X.Event;e.ChemWidget.ViewerBasicInteractionController=i.create(e.Widget.InteractionController,{CLASS_NAME:"Kekule.ChemWidget.ViewerBasicInteractionController",initialize:function($super,e){$super(e),this._enableMouseRotate=!0,this._transformInfo={isTransforming:!1,lastCoord:null,lastZoom:null},this._restraintCoord=null,this._doInteractiveTransformStepBind=this._doInteractiveTransformStep.bind(this)},initProperties:function(){this.defineProp("viewer",{dataType:"Kekule.ChemWidget.Viewer",serializable:!1,getter:function(){return this.getWidget()},setter:function(e){this.setWidget(e)}})},getViewerRenderType:function(){return this.getViewer().getRenderType()},getEnableInteraction:function(){var e=this.getViewer();return!!(e&&e.getEnableDirectInteraction()&&e.getChemObjLoaded())},getEnableTouchInteraction:function(){var e=this.getViewer();return!!(e&&e.getEnableDirectInteraction()&&e.getEnableTouchInteraction()&&e.getChemObjLoaded())},_initTransform:function(){var e,t=this.getViewer(),r=t.getOffsetWidth(),i=t.getOffsetHeight(),n=this._transformInfo,a=this._restraintCoord;a?(e="x"===a?i:r,n.angleRatio=1/e*Math.PI*2):(e=Math.min(r,i),n.angleRatio=1/e*Math.PI)},zoomViewer:function(e){var t=this.getViewer();t&&t.getChemObj()&&(e>0?t.zoomIn&&t.zoomIn(e):e<0&&t.zoomOut&&t.zoomOut(-e))},isEventFromInteractionArea:function(t){var r=t.getTarget(),i=this.getViewer().getInteractionReceiverElem();return r===i||e.DomUtils.isDescendantOf(r,i)},_beginInteractTransformAtCoord:function(e,t,r,i){var n=this.getViewer();if(n&&n.getChemObj()){var a=this._transformInfo;a.isTransforming=!0,a.lastCoord={x:e,y:t},this._restraintCoord=this._calcRestraintRotateCoord(r,i),this._initTransform(),this.getViewer().setTouchAction("none"),this._requestInteractiveTransform(e,t)}},_endInteractTransform:function(){this._transformInfo.isTransforming=!1,this.getViewer().setTouchAction(null),this._doInteractiveTransformEnd()},_calcRestraintRotateCoord:function(t,r){var i=this.getViewer(),n=null,a=this._getRestraintRotate3DEdgeSize();if(a>0){var o,s,l,d,u=i.getInteractionReceiverElem(),c=e.HtmlElementUtils.getElemPageRect(u,!0),h=t-c.left,m=r-c.top,g=c.right-t,f=c.bottom-r;h<=g?(l=1,o=h):(l=-1,o=g),m<=f?(d=1,s=m):(d=-1,s=f);var p=Math.min(o,s);if(p>a)return null;s>p?l<0&&(n="x"):n=d>0?"z":"y"}return n},_interactTransformAtCoord:function(t,r){var i=this._transformInfo.lastCoord;if(i){var n={x:t,y:r};if(e.CoordUtils.getDistance(i,n)<5)return}this._requestInteractiveTransform(t,r)},_requestInteractiveTransform:function(e,t){this._transformInfo.interactScreenCoord={x:e,y:t},this._interactiveTransformStepId||(this._interactiveTransformStepId=window.requestAnimationFrame(this._doInteractiveTransformStepBind))},_doInteractiveTransformStep:function(){if(this._transformInfo&&this._transformInfo.isTransforming){var t=this._transformInfo.interactScreenCoord;this.getViewerRenderType()===e.Render.RendererType.R3D?this.rotateByXYDistance(t.x,t.y):this.moveByXYDistance(t.x,t.y),this._interactiveTransformStepId=window.requestAnimationFrame(this._doInteractiveTransformStepBind)}},_doInteractiveTransformEnd:function(){this._interactiveTransformStepId&&(window.cancelAnimationFrame(this._interactiveTransformStepId),this._interactiveTransformStepId=null)},_getRestraintRotate3DEdgeSize:function(){var t=this.getViewer();if(t.getEnableRestraintRotation3D()&&t.getRenderType()===e.Render.RendererType.R3D){var r=t.getDimension();return Math.min(r.width,r.height)*(t.getRestraintRotation3DEdgeRatio()||0)}return 0},needReactEvent:function(e){return this.getEnableInteraction()&&this.isEventFromInteractionArea(e)},react_dblclick:function(e){this.needReactEvent(e)&&this.getViewer().resetDisplay()},react_mousewheel:function(e){if(this.needReactEvent(e)){var t=e.wheelDeltaY||e.wheelDelta;return t&&(t/=120),this.zoomViewer(t),e.preventDefault(),!0}},react_pointerdown:function(e){this.needReactEvent(e)&&e.getButton()===c.MouseButton.LEFT&&(e.getPointerType()!==c.PointerType.TOUCH||this.getEnableTouchInteraction())&&this._beginInteractTransformAtCoord(e.getScreenX(),e.getScreenY(),e.getClientX(),e.getClientY())},react_pointerhold:function(e){this.needReactEvent(e)&&e.getPointerType()===c.PointerType.TOUCH&&e.getButton()===c.MouseButton.LEFT&&this.getViewer().setEnableTouchInteraction(!this.getViewer().getEnableTouchInteraction())},react_pointerleave:function(e){this._endInteractTransform()},react_pointerup:function(e){e.getButton()===c.MouseButton.LEFT&&this._endInteractTransform()},react_pointermove:function(e){this.needReactEvent(e)&&this._transformInfo.isTransforming&&(this._interactTransformAtCoord(e.getScreenX(),e.getScreenY()),e.preventDefault())},moveByXYDistance:function(t,r){var i=this._transformInfo;if(i&&i.isTransforming&&!i.calculating){var n=this.getViewer();if(n.getRenderType()===e.Render.RendererType.R3D)return;i.calculating=!0;try{var a={x:t,y:r},o=e.CoordUtils.substract(a,i.lastCoord),s=n.getBaseCoordOffset()||{};s=e.CoordUtils.add(s,o),n.setBaseCoordOffset(s),i.lastCoord=a}finally{i.calculating=!1}}},rotateByXYDistance:function(t,r){var i=this._transformInfo;if(i&&i.isTransforming&&!i.calculating){var n=this.getViewer();if(n.getRenderType()!==e.Render.RendererType.R3D)return;i.calculating=!0;try{var a={x:t,y:r},o=e.CoordUtils.substract(a,i.lastCoord);o.y=-o.y;var s,l,d;if(this._restraintCoord){var u=this._restraintCoord;"x"===u?(s=o.y,d={x:1,y:0,z:0}):(s=o.x,d="y"===u?{x:0,y:-1,z:0}:{x:0,y:0,z:1}),l=-s*i.angleRatio}else s=e.CoordUtils.getDistance({x:0,y:0},o),l=s*i.angleRatio,d={x:-o.y,y:o.x,z:0};n.rotate3DByAxis(l,d),i.lastCoord=a,i.calculating=!1}catch(e){}finally{i.calculating=!1}}},doTestMouseCursor:function(e,t){var r="";return this._transformInfo.isTransforming&&(r="move"),r}}),e.ChemWidget.Viewer2D=i.create(e.ChemWidget.Viewer,{CLASS_NAME:"Kekule.ChemWidget.Viewer2D",initialize:function($super,t,r){$super(t,r,e.Render.RendererType.R2D)},getAllowRenderTypeChange:function(){return!1}}),e.ChemWidget.Viewer3D=i.create(e.ChemWidget.Viewer,{CLASS_NAME:"Kekule.ChemWidget.Viewer3D",initialize:function($super,t,r){$super(t,r,e.Render.RendererType.R3D)},getAllowRenderTypeChange:function(){return!1}});var h=e.ObjPropSettingManager;return h.register("Kekule.ChemWidget.Viewer.fullFunc",{enableToolbar:!0,enableDirectInteraction:!0,enableTouchInteraction:!0,enableEdit:!0,toolButtons:null}),h.register("Kekule.ChemWidget.Viewer.basic",{enableToolbar:!0,enableDirectInteraction:!0,enableTouchInteraction:!1,toolButtons:[o.saveData,o.molDisplayType,o.zoomIn,o.zoomOut],menuItems:[o.saveData,"-",o.molDisplayType,o.zoomIn,o.zoomOut]}),h.register("Kekule.ChemWidget.Viewer.mini",{enableToolbar:!0,enableDirectInteraction:!0,enableTouchInteraction:!1,toolButtons:[o.menu],menuItems:[o.saveData,"-",o.molDisplayType,o.zoomIn,o.zoomOut]}),h.register("Kekule.ChemWidget.Viewer.static",{enableToolbar:!1,enableDirectInteraction:!1,enableTouchInteraction:!1,toolButtons:[],menuItems:[]}),h.register("Kekule.ChemWidget.Viewer.editOnly",{enableToolbar:!0,enableEdit:!0,toolButtons:[o.openEditor],menuItems:[o.openEditor]}),e.ChemWidget.Viewer.Settings=i.create(e.ChemWidget.ChemObjDisplayer.Settings,{CLASS_NAME:"Kekule.ChemWidget.Viewer.Settings",initProperties:function(){this.defineDelegatedProps(["enableDirectInteraction","enableTouchInteraction","enableToolbar","toolbarPos","toolbarMarginHorizontal","toolbarMarginVertical","enableEdit","modalEdit"])},getViewer:function(){return this.getWidget()}}),e.ChemWidget.ActionOnViewer=i.create(e.ChemWidget.ActionOnDisplayer,{CLASS_NAME:"Kekule.ChemWidget.ActionOnViewer",initialize:function($super,e,t,r){$super(e,t,r)},doUpdate:function(){var e=this.getDisplayer();this.setEnabled(e&&e.getChemObj()&&e.getChemObjLoaded()&&e.getEnabled())},getViewer:function(){var t=this.getDisplayer();return t instanceof e.ChemWidget.Viewer?t:null}}),e.ChemWidget.ActionViewerRotateBase=i.create(e.ChemWidget.ActionOnViewer,{CLASS_NAME:"Kekule.ChemWidget.ActionViewerRotateBase",initialize:function($super,e,t,r){$super(e,t,r),this.setDelta(2*Math.PI/180)},initProperties:function(){this.defineProp("delta",{dataType:a.FLOAT})},isShiftModified:function(e){return e&&e.getShiftKey()}}),e.ChemWidget.ActionViewerRotateBase2D=i.create(e.ChemWidget.ActionViewerRotateBase,{CLASS_NAME:"Kekule.ChemWidget.ActionViewerRotateBase2D",doUpdate:function($super){$super();var t=this.getViewer(),r=t&&t.getRenderType()===e.Render.RendererType.R2D;this.setDisplayed(r).setEnabled(this.getEnabled()&&r)}}),e.ChemWidget.ActionViewerRotateBase3D=i.create(e.ChemWidget.ActionViewerRotateBase,{CLASS_NAME:"Kekule.ChemWidget.ActionViewerRotateBase3D",doUpdate:function($super){$super();var t=this.getViewer(),r=t&&t.getRenderType()===e.Render.RendererType.R3D;this.setDisplayed(r).setEnabled(this.getEnabled()&&r)}}),e.ChemWidget.ActionViewerRotateLeft=i.create(e.ChemWidget.ActionViewerRotateBase2D,{CLASS_NAME:"Kekule.ChemWidget.ActionViewerRotateLeft",HTML_CLASSNAME:u.ACTION_ROTATE_LEFT,initialize:function($super,t){$super(t,e.$L("ChemWidgetTexts.CAPTION_ROTATELEFT"),e.$L("ChemWidgetTexts.HINT_ROTATELEFT"))},doExecute:function(e,t){var r=this.getDelta();this.getViewer().rotate2DBy(r)}}),e.ChemWidget.ActionViewerRotateRight=i.create(e.ChemWidget.ActionViewerRotateBase2D,{CLASS_NAME:"Kekule.ChemWidget.ActionViewerRotateRight",HTML_CLASSNAME:u.ACTION_ROTATE_RIGHT,initialize:function($super,t){$super(t,e.$L("ChemWidgetTexts.CAPTION_ROTATERIGHT"),e.$L("ChemWidgetTexts.HINT_ROTATERIGHT"))},doExecute:function(e,t){var r=-this.getDelta();this.getViewer().rotate2DBy(r)}}),e.ChemWidget.ActionViewerRotateX=i.create(e.ChemWidget.ActionViewerRotateBase3D,{CLASS_NAME:"Kekule.ChemWidget.ActionViewerRotateX",HTML_CLASSNAME:u.ACTION_ROTATE_X,initialize:function($super,t){$super(t,e.$L("ChemWidgetTexts.CAPTION_ROTATEX"),e.$L("ChemWidgetTexts.HINT_ROTATEX"))},doExecute:function(e,t){var r=this.isShiftModified(t),i=-this.getDelta();r&&(i=-i),this.getViewer().rotate3DBy(i,0,0)}}),e.ChemWidget.ActionViewerRotateY=i.create(e.ChemWidget.ActionViewerRotateBase3D,{CLASS_NAME:"Kekule.ChemWidget.ActionViewerRotateY",HTML_CLASSNAME:u.ACTION_ROTATE_Y,initialize:function($super,t){$super(t,e.$L("ChemWidgetTexts.CAPTION_ROTATEY"),e.$L("ChemWidgetTexts.HINT_ROTATEY"))},doExecute:function(e,t){var r=this.isShiftModified(t),i=-this.getDelta();r&&(i=-i),this.getViewer().rotate3DBy(0,i,0)}}),e.ChemWidget.ActionViewerRotateZ=i.create(e.ChemWidget.ActionViewerRotateBase3D,{CLASS_NAME:"Kekule.ChemWidget.ActionViewerRotateZ",HTML_CLASSNAME:u.ACTION_ROTATE_Z,initialize:function($super,t){$super(t,e.$L("ChemWidgetTexts.CAPTION_ROTATEZ"),e.$L("ChemWidgetTexts.HINT_ROTATEZ"))},doExecute:function(e,t){var r=this.isShiftModified(t),i=-this.getDelta();r&&(i=-i),this.getViewer().rotate3DBy(0,0,i)}}),e.ChemWidget.ActionViewerChangeMolDisplayTypeStub=i.create(e.ChemWidget.ActionOnDisplayer,{CLASS_NAME:"Kekule.ChemWidget.ActionViewerChangeMolDisplayTypeStub",initialize:function($super,t){$super(t,e.$L("ChemWidgetTexts.CAPTION_MOL_DISPLAY_TYPE"),e.$L("ChemWidgetTexts.HINT_MOL_DISPLAY_TYPE"))},doExecute:function(e){}}),e.ChemWidget.ActionViewerEdit=i.create(e.ChemWidget.ActionOnViewer,{CLASS_NAME:"Kekule.ChemWidget.ActionViewerEdit",HTML_CLASSNAME:u.ACTION_VIEWER_EDIT,initialize:function($super,t){$super(t,e.$L("ChemWidgetTexts.CAPTION_OPENEDITOR"),e.$L("ChemWidgetTexts.HINT_OPENEDITOR"))},doUpdate:function($super){$super();var e=this.getViewer();this.setEnabled(e&&e.getAllowEditing()&&e.getEnabled()),this.setDisplayed(e&&e.getEnableEdit())},doExecute:function(e){this.getViewer().openEditor(e)}}),e.ChemWidget.Viewer.rotate2DActionClasses=[s.ActionViewerRotateLeft,s.ActionViewerRotateRight],e.ChemWidget.Viewer.rotate3DActionClasses=[s.ActionViewerRotateX,s.ActionViewerRotateY,s.ActionViewerRotateZ],e.ChemWidget.Viewer.molDisplayType2DActionClasses=[s.ActionDisplayerChangeMolDisplayTypeSkeletal,s.ActionDisplayerChangeMolDisplayTypeCondensed],e.ChemWidget.Viewer.molDisplayType3DActionClasses=[s.ActionDisplayerChangeMolDisplayTypeWire,s.ActionDisplayerChangeMolDisplayTypeSticks,s.ActionDisplayerChangeMolDisplayTypeBallStick,s.ActionDisplayerChangeMolDisplayTypeSpaceFill],e._registerAfterLoadSysProc(function(){var t=e.ActionManager,r=e.ChemWidget,i=e.ChemWidget.Viewer,n=t.registerNamedActionClass;n(o.loadFile,r.ActionDisplayerLoadFile,i),n(o.loadData,r.ActionDisplayerLoadData,i),n(o.saveData,r.ActionDisplayerSaveFile,i),n(o.clearObjs,r.ActionDisplayerClear,i),n(o.zoomIn,r.ActionDisplayerZoomIn,i),n(o.zoomOut,r.ActionDisplayerZoomOut,i),n(o.rotateLeft,r.ActionViewerRotateLeft,i),n(o.rotateRight,r.ActionViewerRotateRight,i),n(o.rotateX,r.ActionViewerRotateX,i),n(o.rotateY,r.ActionViewerRotateY,i),n(o.rotateZ,r.ActionViewerRotateZ,i),n(o.reset,r.ActionDisplayerReset,i),n(o.molHideHydrogens,r.ActionDisplayerHideHydrogens,i),n(o.molDisplayType,r.ActionViewerChangeMolDisplayTypeStub,i),n(o.openEditor,r.ActionViewerEdit,i),n(o.config,e.Widget.ActionOpenConfigWidget,i),n(o.molDisplayTypeCondensed,r.ActionDisplayerChangeMolDisplayTypeCondensed,i),n(o.molDisplayTypeSkeletal,r.ActionDisplayerChangeMolDisplayTypeSkeletal,i),n(o.molDisplayTypeWire,r.ActionDisplayerChangeMolDisplayTypeWire,i),n(o.molDisplayTypeSticks,r.ActionDisplayerChangeMolDisplayTypeSticks,i),n(o.molDisplayTypeBallStick,r.ActionDisplayerChangeMolDisplayTypeBallStick,i),n(o.molDisplayTypeSpaceFill,r.ActionDisplayerChangeMolDisplayTypeSpaceFill,i)}),e}},function(e,t,r){"use strict";var i=r(0).Class,n=r(0).ClassEx,a=(r(0).ObjectEx,r(0).DataType);e.exports=function(e){var t=i.PropertyScope;e.ChemWidget.HtmlClassNames=Object.extend(e.ChemWidget.HtmlClassNames,{VIEWER_GRID:"K-Chem-Viewer-Grid"});var r=(e.Widget.HtmlClassNames,e.ChemWidget.HtmlClassNames);return e.ChemWidget.ViewerGrid=i.create(e.Widget.WidgetGrid,{CLASS_NAME:"Kekule.ChemWidget.ViewerGrid",initialize:function($super,e,t,r){this.setPropStoreFieldValue("renderType",t),this.setPropStoreFieldValue("viewerConfigs",r),$super(e)},initProperties:function(){this._shadowedPropPairs=[],this.defineProp("renderType",{dataType:a.INT,serializable:!1,setter:null,scope:t.PUBLIC}),this.defineProp("chemObjs",{dataType:a.ARRAY,serializable:!1,setter:null,getter:function(){var e=[];return this.each(function(t){e.push(t.getChemObj())}),e}}),this.defineViewerShadowProps(["drawOptions","moleculeDisplayType","zoom","autoSize","enableLoadNewFile","viewerConfigs","allowedMolDisplayTypes","enableEdit","modalEdit","toolButtons","enableToolbar","toolbarPos","toolbarMarginVertical","toolbarMarginHorizontal","toolbarEvokeModes","toolbarRevokeModes","toolbarRevokeTimeout","caption","showCaption","autoCaption","captionPos","enableDirectInteraction","enableTouchInteraction"]),this.defineViewerShadowProps(["viewerPredefinedSetting"],["predefinedSetting"]),this.defineProp("actionLoadData",{dataType:"Kekule.ChemWidget.ActionDisplayerLoadData",serializable:!1,scope:t.PRIVATE,setter:null,getter:function(){var t=this.getPropStoreFieldValue("actionLoadData");return t||(t=new e.ChemWidget.ActionDisplayerLoadData,this.setPropStoreFieldValue("actionLoadData",t)),t}})},defineViewerShadowProps:function(e,t){t||(t=[]);for(var r=0,i=e.length;r<i;++r){var n=e[r],a=t[r]||e[r];this.defineViewerShadowProp(n,a)}},defineViewerShadowProp:function(t,r){r||(r=t);var i=e.ChemWidget.Viewer,a=n.getPropInfo(i,r);if(a){var o=Object.create(a);o.getter=void 0,o.setter=function(e){this.setPropStoreFieldValue(t,e),this.each(function(t){t.setPropValue(r,e)})},this.defineProp(t,o),this._shadowedPropPairs.push({prop:t,viewerProp:r})}},doGetWidgetClassName:function($super){return $super()+" "+r.VIEWER_GRID},createWidget:function($super){var t=this.getDocument(),r=new e.ChemWidget.LoadDataDialog(t),i=this;r.openModal(function(e){if(r.isPositiveResult(e)){var n=r.getChemObj();if(n){i.doCreateNewChildWidget(t,n).setParent(i)}}},this.getAddingCell())},doCreateNewChildWidget:function(t,r){var i=new e.ChemWidget.Viewer(t,null,this.getRenderType(),this.getViewerConfigs());return this.doSetShadowedPropValuesToViewer(i),r&&i.setChemObj(r),i},doSetShadowedPropValuesToViewer:function(e){for(var t=0,r=this._shadowedPropPairs.length;t<r;++t){var i=this._shadowedPropPairs[t],n=this.getPropValue(i.prop);void 0!==n&&e.setPropValue(i.viewerProp,n)}},addChemObj:function(e){return this.doCreateNewChildWidget(this.getDocument(),e).setParent(this),this},removeChemObj:function(e){var t=this;return this.each(function(r){r.getChemObj()===e&&t.removeWidget(r,!0)}),this}}),e.ChemWidget.ViewerGrid2D=i.create(e.ChemWidget.ViewerGrid,{CLASS_NAME:"Kekule.ChemWidget.ViewerGrid2D",initialize:function($super,t,r){$super(t,e.Render.RendererType.R2D,r)}}),e.ChemWidget.ViewerGrid3D=i.create(e.ChemWidget.ViewerGrid,{CLASS_NAME:"Kekule.ChemWidget.ViewerGrid3D",initialize:function($super,t,r){$super(t,e.Render.RendererType.R3D,r)}}),e}},function(e,t,r){"use strict";var i=r(0).Class,n=r(0).ClassEx,a=(r(0).ObjectEx,r(0).DataType);r(1).JsonUtility;e.exports=function(e){var t=i.PropertyScope,r=e.DomUtils,o=e.ArrayUtils;e.ChemWidget;e.ChemWidget.HtmlClassNames=Object.extend(e.ChemWidget.HtmlClassNames,{CHEMOBJSETTER:"K-Chem-Obj-Setter",CHEMOBJSETTER_FLEX_LAYOUT:"K-Chem-Obj-Setter-Flex-Layout",CHEMOBJSETTER_TOOLBAR_AREA:"K-Chem-Obj-Setter-Toolbar-Area",CHEMOBJSETTER_CLIENT:"K-Chem-Obj-Setter-Client",CHEMOBJSETTER_VIEWER:"K-Chem-Obj-Setter-Viewer",CHEMOBJSETTER_TABGROUP:"K-Chem-Obj-Setter-TabGroup",CHEMOBJSETTER_INFOLABEL:"K-Chem-Obj-Setter-InfoLabel",CHEMOBJSETTER_REGION:"K-Chem-Obj-Setter-Region",CHEMOBJSETTER_REGION_LABEL:"K-Chem-Obj-Setter-Region-Label",CHEMOBJSETTER_LINE:"K-Chem-Obj-Setter-Line",CHEMOBJSETTER_CONFIGURATOR:"K-Chem-Obj-Setter-Configurator"});var s=e.Widget.HtmlClassNames,l=e.ChemWidget.HtmlClassNames;return e.ChemWidget.ChemObjInserter=i.create(e.ChemWidget.AbstractWidget,{CLASS_NAME:"Kekule.ChemWidget.ChemObjInserter",DEF_BGCOLOR_2D:"transparent",DEF_BGCOLOR_3D:"#000000",initialize:function($super,t,r,i,n){this._configAction=new e.Widget.ActionOpenConfigWidget(this),this._toolbarParentElem=null,this._infoLabel=null,this._infoLabelTemplate=e.$L("ChemWidgetTexts.CAPTION_WIDTH_HEIGHT"),$super(t);var a=this.getViewer();i&&a.setRenderType(i),n&&a.setViewerConfigs(n),this.adjustChildrenSizes()},doFinalize:function($super){this._configAction&&this._configAction.finalize(),$super()},initProperties:function(){this.defineProp("viewer",{dataType:"Kekule.ChemWidget.Viewer",serializable:!1,setter:null,getter:function(){var e=this.getPropStoreFieldValue("viewer");return e||(e=this.createViewer(),this.setPropStoreFieldValue("viewer",e)),e}}),this.defineProp("chemObj",{dataType:"Kekule.ChemObject",serializable:!1,scope:t.PUBLIC,getter:function(){var e=this.getPropStoreFieldValue("viewer");return e?e.getChemObj():this.getPropStoreFieldValue("chemObj")},setter:function(e){this.setPropStoreFieldValue("chemObj",e),this.getViewer()&&this.getViewer().setChemObj(e)}}),this.defineProp("renderType",{dataType:a.INT,serializable:!1,scope:t.PUBLIC,setter:function(t){if(t!==this.getRenderType()){this.setPropStoreFieldValue("renderType",t),this.getViewer().setRenderType(t);var r=this.getTabs();if(r){var i=t===e.Render.RendererType.R3D?1:0;r.getChildWidgets()[i].setChecked(!0)}}}}),this.defineProp("is3D",{dataType:a.BOOL,serializable:!1,getter:function(){return this.getRenderType()===e.Render.RendererType.R3D},setter:function(t){this.setRenderType(t?e.Render.RendererType.R3D:e.Render.RendererType.R2D)}}),this.defineProp("showInfo",{dataType:a.BOOL,serializable:!1,getter:function(){return this._infoLabel&&e.StyleUtils.isShown(this._infoLabel)},setter:function(t){this._infoLabel&&e.StyleUtils.setDisplay(this._infoLabel,t)}}),this.defineProp("autoSizeExport",{dataType:a.BOOL}),this.defineProp("backgroundColor2D",{dataType:a.STRING,setter:function(e){this.setPropStoreFieldValue("backgroundColor2D",e),this.backgroundColorChange()}}),this.defineProp("backgroundColor3D",{dataType:a.STRING,setter:function(e){this.setPropStoreFieldValue("backgroundColor3D",e),this.backgroundColorChange()}}),this.defineProp("exportViewerPredefinedSetting",{dataType:a.STRING}),this.defineProp("clientPanel",{dataType:a.OBJECT,serializable:!1,setter:!1,scope:t.PRIVATE}),this.defineProp("tabs",{dataType:a.OBJECT,serializable:!1,setter:!1,scope:t.PRIVATE}),this._defineViewerDelegatedProp("chemObjLoaded"),this._defineViewerDelegatedProp("renderConfigs"),this._defineViewerDelegatedProp("drawOptions"),this._defineViewerDelegatedProp("allowCoordBorrow"),this._defineViewerDelegatedProp("autoSize"),this._defineViewerDelegatedProp("autofit"),this._defineViewerDelegatedProp("viewerConfigs"),this._defineViewerDelegatedProp("allowedMolDisplayTypes"),this._defineViewerDelegatedProp("enableEdit"),this._defineViewerDelegatedProp("enableEditFromVoid"),this._defineViewerDelegatedProp("modalEdit"),this._defineViewerDelegatedProp("toolButtons"),this._defineViewerDelegatedProp("enableDirectInteraction"),this._defineViewerDelegatedProp("enableTouchInteraction")},initPropValues:function($super){$super(),this.setAutoSizeExport(!0),this.setBackgroundColor3D(this.DEF_BGCOLOR_3D),this.setExportViewerPredefinedSetting("basic")},_defineViewerDelegatedProp:function(t,r){r||(r=t);var i=n.getPropInfo(e.ChemWidget.Viewer,r),a=Object.create(i);return a.getter=null,a.setter=null,i.getter&&(a.getter=function(){return this.getViewer().getPropValue(r)}),i.setter&&(a.setter=function(e){this.getViewer().setPropValue(r,e)}),this.defineProp(t,a)},loadPredefinedResDataToProp:function(t,r,i){if("chemObj"===t)if(i){var n=e.IO.loadTypedData(r.data,r.resType,r.resUri);this.setChemObj(n)}else e.error(e.$L("ErrorMsg.CANNOT_LOAD_RES_OF_URI")+r.resUri||"")},doGetWidgetClassName:function($super){var e=$super()+" "+l.CHEMOBJSETTER;return this._isUsingFlexLayout()&&(e+=" "+l.CHEMOBJSETTER_FLEX_LAYOUT),e},_isUsingFlexLayout:function(){return e.BrowserFeature.cssFlex},doCreateRootElement:function(e){return e.createElement("div")},doCreateSubElements:function($super,t,r){var i=$super(t,r);this.createToolbarParent(r);var n=new e.Widget.Panel(this);return n.addClassName(l.CHEMOBJSETTER_CLIENT),n.setUseCornerDecoration(!1),n.appendToElem(r),this.setPropStoreFieldValue("clientPanel",n),this.createViewer(n.getCoreElement()),this.createInfoLabel(r,this.getViewer()),this.createTabs(r),i},elementBound:function(e){this.setObserveElemResize(!0)},doResize:function($super){this.adjustChildrenSizes()},doWidgetShowStateChanged:function($super,e){$super(e),this.adjustChildrenSizes()},getResizerElement:function(){return this.getClientPanel()?this.getClientPanel().getCoreElement():this.getCoreElement()},getBackgroundColor:function(t){var r=t===e.Render.RendererType.R3D?this.getBackgroundColor3D():this.getBackgroundColor2D();return r===e.Widget.ColorPicker.SpecialColors.TRANSPARENT&&(r="transparent"),r},setBackgroundColor:function(t,r){if(r===e.Render.RendererType.R3D){var i=t||this.DEF_BGCOLOR_3D;this.setBackgroundColor3D(i)}else{var i=t||this.DEF_BGCOLOR_2D;this.setBackgroundColor2D(i)}},backgroundColorChange:function(){var e=this.getBackgroundColor(this.getRenderType()),t=this.getPropStoreFieldValue("viewer");t&&t.setBackgroundColor(e)},adjustChildrenSizes:function(){if(this._isUsingFlexLayout());else{var t=(this.getPageRect(),e.HtmlElementUtils.getElemPageRect(this._toolbarParentElem)),r=this.getTabs(),i=r&&r.getPageRect(),n=i.top-t.bottom;this.getClientPanel().setHeight(n+"px")}this.getViewer().resized()},createViewer:function(t){var r=e.ChemWidget.ComponentWidgetNames,i=e.Widget.EvokeMode,n=new e.ChemWidget.Viewer(this,null,this.getRenderType());n.addClassName([s.DYN_CREATED,l.CHEMOBJSETTER_VIEWER]),n.setRenderType(e.Render.RendererType.R2D),n.setEnableEdit(!0),n.setEnableEditFromVoid(!0),n.setRestrainEditorWithCurrObj(!1),n.setEnableToolbar(!0),n.setPredefinedSetting("fullFunc");var a=o.exclude(n.getDefaultToolBarButtons(),r.config);return a.push({action:this._configAction}),a.splice(2,0,r.clearObjs),n.setToolbarParentElem(this._toolbarParentElem),n.setToolButtons(a),n.setToolbarPos(e.Widget.Position.BOTTOM),n.setToolbarMarginVertical(-2),n.setToolbarEvokeModes([i.ALWAYS]),n.addEventListener("resize",this.updateInfoLabel,this),n.appendToElem(t),n.setChemObj(this.getChemObj()),this.setPropStoreFieldValue("viewer",n),this.backgroundColorChange(),n},createToolbarParent:function(e){var t=e.ownerDocument.createElement("div");return t.className=l.CHEMOBJSETTER_TOOLBAR_AREA,e.appendChild(t),this._toolbarParentElem=t,t},createTabs:function(t){var r=[e.$L("ChemWidgetTexts.CAPTION_2D"),e.$L("ChemWidgetTexts.CAPTION_3D")],i=this.getRenderType()===e.Render.RendererType.R3D?1:0,n=new e.Widget.TabButtonGroup(this);n.setTabButtonPosition(e.Widget.Position.BOTTOM),n.addClassName([s.DYN_CREATED,l.CHEMOBJSETTER_TABGROUP]);for(var a=[],o=0,d=r.length;o<d;++o){var u=new e.Widget.RadioButton(n);u.setText(r[o]),o===i&&u.setChecked(!0),a.push(u)}return n.addEventListener("switch",function(t){var r=t.button,i=a.indexOf(r),n=1===i?e.Render.RendererType.R3D:e.Render.RendererType.R2D;this.setRenderType(n),this.backgroundColorChange()},this),n.appendToElem(t),this.setPropStoreFieldValue("tabs",n),n},createInfoLabel:function(e,t){var r=this.getDocument().createElement("div");return r.className=s.DYN_CREATED+" "+l.CHEMOBJSETTER_INFOLABEL,t.getElement().appendChild(r),this._infoLabel=r,r},updateInfoLabel:function(){var t=this.getViewer();if(t&&this._infoLabel){var r=t.getContextDimension(),i=r?this._infoLabelTemplate.format(Math.round(r.width),Math.round(r.height)):"";e.DomUtils.setElementText(this._infoLabel,i)}},getContextDimension:function(){return this.getViewer().getContextDimension()},setContextDimension:function(e){var t=this.getContextDimension(),r=e.width-t.width,i=e.height-t.height,n=this.getDimension(),a={width:n.width+r,height:n.height+i};return this.setDimension(a.width,a.height),this},exportToDataUri:function(e,t){return this.getViewer().exportToDataUri(e,t)},exportDetails:function(t,r){this.getAutoSizeExport()&&this.setAutoSize(!0);var i=this.getViewer().getActualDrawOptions(),n=this.getViewer().getContextDimension(),a={dataUri:this.exportToDataUri(t,r),drawOptions:i,drawOptionsJson:JSON.stringify(i),chemObj:this.getChemObj(),chemObjJson:e.IO.saveMimeData(this.getChemObj(),"chemical/x-kekule-json"),autoSize:this.getAutoSizeExport(),autofit:this.getAutofit(),width:Math.round(n.width),height:Math.round(n.height),renderType:this.getRenderType()||e.Render.RendererType.R2D,backgroundColor:this.getBackgroundColor(this.getRenderType()),predefinedSetting:this.getExportViewerPredefinedSetting()};if(this.getAutoSizeExport()){this.setAutoSize(!1);var o=this.getViewer().getElement();o.style.width="auto",o.style.height="auto",this.getViewer().resized()}return a},getExportImgElemAttributes:function(t,r){var i=this.exportDetails(t,r),n="width:"+i.width+"px; height:"+i.height+"px",a={src:i.dataUri,style:n,width:i.width,height:i.height,"data-kekule-widget":"Kekule.ChemWidget.Viewer","data-render-type":i.renderType,"data-chem-obj":i.chemObjJson,"data-draw-options":i.drawOptionsJson,"data-predefined-setting":i.predefinedSetting};return e.ObjUtils.notUnset(i.autoSize)&&(a["data-auto-size"]=i.autoSize),e.ObjUtils.notUnset(i.autofit)&&(a["data-auto-fit"]=i.autofit),e.ObjUtils.notUnset(i.backgroundColor)&&(a["data-background-color"]=i.backgroundColor),a},createExportImgElement:function(t,r,i){var n=t.createElement("img"),a=this.getExportImgElemAttributes(r,i);return e.DomUtils.setElemAttributes(n,a),n},importChemObjWithDetails:function(t,r){return this.setChemObj(t),this.setRenderType(r.renderType||e.Render.RendererType.R2D),e.ObjUtils.notUnset(r.autoSize)&&this.setAutoSizeExport(!!r.autoSize),e.ObjUtils.notUnset(r.autofit)&&this.setAutofit(!!r.autofit),!r.width||!r.height||r.autoSize&&r.renderType!==e.Render.RendererType.R3D||this.setContextDimension({width:r.width,height:r.height}),r.drawOptions&&this.getViewer().setDrawOptions(r.drawOptions),r.backgroundColor&&this.setBackgroundColor(r.backgroundColor,this.getRenderType()),this},importFromElemAttribs:function(t){t.width=a.JsonUtility.parse(t.width),t.height=a.JsonUtility.parse(t.height);var r=t["data-chem-obj"],i=r?e.IO.loadMimeData(r,"chemical/x-kekule-json"):null;return t["data-render-type"]&&(t.renderType=a.JsonUtility.parse(t["data-render-type"])),t["data-draw-options"]&&(t.drawOptions=a.JsonUtility.parse(t["data-draw-options"])),t["data-auto-size"]&&(t.autoSize=a.JsonUtility.parse(t["data-auto-size"])),t["data-autofit"]&&(t.autofit=a.JsonUtility.parse(t["data-autofit"])),t["data-background-color"]&&(t.backgroundColor=t["data-background-color"]),this.importChemObjWithDetails(i,t)},importFromElem:function(t){var r=e.HtmlElementUtils.getElemPageRect(t),i=e.DomUtils.fetchAttributeValuesToJson(t);return i.width||(i.width=r.width),i.height||(i.height=r.height),this.importFromElemAttribs(i)}}),e.ChemWidget.ChemObjInserter.Configurator=i.create(e.Widget.Configurator,{CLASS_NAME:"Kekule.ChemWidget.ChemObjInserter.Configurator",initialize:function($super,e){this._checkBoxAutoSize=null,this._checkBoxAutofit=null,this._checkBoxShowInfo=null,this._textBoxWidth=null,this._textBoxHeight=null,this._colorPicker=null,$super(e),this.addEventListener("valueChange",function(e){this.saveConfigValues()},this)},initPropValues:function($super){$super(),this.setAutoUpdate(!0)},doGetWidgetClassName:function($super){return $super()+" "+l.CHEMOBJSETTER_CONFIGURATOR},doCreateSubElements:function(t,i){var n=t.createElement("div");n.className=l.CHEMOBJSETTER_REGION;var a=new e.Widget.CheckBox(this);a.setText(e.$L("ChemWidgetTexts.CAPTION_AUTOSIZE")),a.addClassName(l.CHEMOBJSETTER_LINE),a.appendToElem(n),this._checkBoxAutoSize=a;var o=t.createElement("span");o.className=s.PART_ASSOC_TEXT_CONTENT,r.setElementText(o,e.$L("ChemWidgetTexts.HINT_AUTOSIZE")),n.appendChild(o);var a=new e.Widget.CheckBox(this);a.setText(e.$L("ChemWidgetTexts.CAPTION_AUTOFIT")),a.addClassName(l.CHEMOBJSETTER_LINE),a.appendToElem(n),this._checkBoxAutofit=a;var o=t.createElement("span");o.className=s.PART_ASSOC_TEXT_CONTENT,r.setElementText(o,e.$L("ChemWidgetTexts.HINT_AUTOFIT")),n.appendChild(o),i.appendChild(n);var n=t.createElement("div");n.className=l.CHEMOBJSETTER_REGION;var d=t.createElement("label");d.className=l.CHEMOBJSETTER_REGION_LABEL,r.setElementText(d,e.$L("ChemWidgetTexts.CAPTION_LABEL_SIZE")),n.appendChild(d),n.appendChild(t.createElement("br"));var u=new e.Widget.TextBox(this);u.setPlaceholder(e.$L("ChemWidgetTexts.PLACEHOLDER_WIDTH")),u.appendToElem(n),this._textBoxWidth=u;var d=t.createElement("span");r.setElementText(d,"×"),n.appendChild(d);var u=new e.Widget.TextBox(this);u.setPlaceholder(e.$L("ChemWidgetTexts.PLACEHOLDER_HEIGHT")),u.appendToElem(n),this._textBoxHeight=u;var a=new e.Widget.CheckBox(this);a.setText(e.$L("ChemWidgetTexts.CAPTION_SHOWSIZEINFO")),a.appendToElem(n),this._checkBoxShowInfo=a,i.appendChild(n);var n=t.createElement("div");n.className=l.CHEMOBJSETTER_REGION;var d=t.createElement("label");d.className=l.CHEMOBJSETTER_REGION_LABEL,r.setElementText(d,e.$L("ChemWidgetTexts.CAPTION_BACKGROUND_COLOR")),n.appendChild(d),n.appendChild(t.createElement("br"));var c=new e.Widget.ColorPicker(this);c.setSpecialColors([e.Widget.ColorPicker.SpecialColors.TRANSPARENT]),c.appendToElem(n),this._colorPicker=c,i.appendChild(n)},loadConfigValues:function($super){$super();var t=this.getWidget();if(t){var r=!t.getIs3D();this._checkBoxAutoSize.setChecked(r&&t.getAutoSizeExport()),this._checkBoxAutoSize.setEnabled(r),this._checkBoxAutofit.setChecked(r&&t.getAutofit()),this._checkBoxAutofit.setEnabled(r),this._checkBoxShowInfo.setChecked(t.getShowInfo());var i=t.getContextDimension();this._textBoxWidth.setText(Math.round(i.width)),this._textBoxHeight.setText(Math.round(i.height));var n=r?t.getBackgroundColor2D():t.getBackgroundColor3D();this._colorPicker.setValue(n||e.Widget.ColorPicker.SpecialColors.TRANSPARENT)}},saveConfigValues:function($super){$super();var e=this.getWidget();if(e){!e.getIs3D()?(e.setAutoSizeExport(this._checkBoxAutoSize.getChecked()),e.setAutofit(this._checkBoxAutofit.getChecked()),e.setBackgroundColor2D(this._colorPicker.getValue())):e.setBackgroundColor3D(this._colorPicker.getValue()),e.setShowInfo(this._checkBoxShowInfo.getChecked());var t={width:parseInt(this._textBoxWidth.getText()),height:parseInt(this._textBoxHeight.getText())};e.setContextDimension(t),e.invokeEvent("configSave")}}}),e}},function(e,t,r){"use strict";var i=r(0).Class,n=r(0).ClassEx,a=r(0).DataType;e.exports=function(e){var t=e.CoordMode,r=e.ArrayUtils;return n.extend(e.ChemObject,{isStandalone:function(){return!this.getIsAttachedToParent()},getStandaloneAncestor:function(){for(var e=this;e.isStandalone&&!e.isStandalone()&&e.getParent&&e.getParent();)e=e.getParent();return e},getCascadeDeleteObjs:function(){return[]},cascadeRemove:function(e){var t=this.getParent();t&&t.notifyBeforeCascadeRemove&&t.notifyBeforeCascadeRemove(this),e?this.finalize():this.removeSelf(),t&&t.notifyAfterCascadeRemove&&t.notifyAfterCascadeRemove(this)},notifyBeforeCascadeRemove:function(e,t){},notifyAfterCascadeRemove:function(e,t){!this.getKeepEmptyEvenOnCascadeRemove()&&this.isEmpty()&&this.cascadeRemove(t)},isCoordDependent:function(){return!1},getCoordDependentObjects:function(){var e=[];return this.isCoordDependent()||e.push(this),e},getCoordDeterminateObjects:function(){var e=[];if(this.getAttachedMarkers)for(var t=this.getAttachedMarkers()||[],i=0,n=t.length;i<n;++i)e=e.concat(t[i].getCoordDependentObjects());for(var a=this.getAttachedCoordStickNodes(),i=0,n=a.length;i<n;++i){var o=a[i];r.pushUnique(e,o),r.pushUnique(e,o.getCoordDeterminateObjects())}return e},getAllContainingConnectors:function(){return[]},getConstraintManipulationBaseObj:function(){if(this.isAttachedMarker&&this.isAttachedMarker()){var t=this.getParent();return t instanceof e.StructureFragment?null:t}return null},transformAbsCoordByMatrix:function(t,r,i,n,a,o){if(this.getChildCount&&(n||e.ObjUtils.isUnset(n)))for(var s=0,l=this.getChildCount();s<l;++s){var d=this.getChildAt(s);d&&d.transformAbsCoordByMatrix&&d.transformAbsCoordByMatrix(r,r,i,n,a,!0)}var u=i===e.CoordMode.COORD3D?e.CoordUtils.transform3DByMatrix:e.CoordUtils.transform2DByMatrix;if(o){if(this.getCoordOfMode&&this.setCoordOfMode){var c=this.getCoordOfMode(i,a),h=u(c,t);this.setCoordOfMode(h,i)}}else if(this.getAbsCoordOfMode&&this.setAbsCoordOfMode){var c=this.getAbsCoordOfMode(i,a),h=u(c,t);this.setAbsCoordOfMode(h,i)}},scaleSize:function(t,r,i,n){if(this.getSizeOfMode&&this.setSizeOfMode){var a=this.getSizeOfMode(r,n),o=e.CoordUtils.multiply(a,t);this.setSizeOfMode(o,r)}if(this.getChildCount&&(i||e.ObjUtils.isUnset(i)))for(var s=0,l=this.getChildCount();s<l;++s){var d=this.getChildAt(s);d&&d.scaleSize&&d.scaleSize(t,r,i,n)}}}),n.extendMethod(e.ChemObject,"_attachedMarkerAdded",function(e,t){var r=e(t);return t&&t.setIsAttachedToParent(!0),t.setParent(this),r}),n.extendMethod(e.ChemObject,"_attachedMarkerRemoved",function(e,t){var r=e(t);return t&&t.setIsAttachedToParent(!1),t.setParent(null),r}),n.defineProps(e.ChemObject,[{name:"keepEmptyEvenOnCascadeRemove",dataType:a.BOOL,scope:i.PropertyScope.PUBLIC},{name:"isAttachedToParent",dataType:a.BOOL,scope:i.PropertyScope.PUBLIC}]),n.extend(e.ChemStructureObject,{getCascadeDeleteObjs:function($super){for(var t=$super(),r=this.getLinkedConnectors?this.getLinkedConnectors():[],i=0,n=r.length;i<n;++i){var a=r[i];if(a.getConnectedObjs().length<=2){e.ArrayUtils.pushUnique(t,a);var o=a.getCascadeDeleteObjs();e.ArrayUtils.pushUnique(t,o)}}return t},isStandalone:function($super){return!1},getCoordDeterminateObjects:function($super){for(var e=$super(),t=this.getLinkedConnectors(),i=0,n=t.length;i<n;++i){var a=t[i];r.pushUnique(e,a),r.pushUnique(e,a.getCoordDeterminateObjects())}return e}}),n.extend(e.BaseStructureNode,{getCascadeDeleteObjs:function($super){return $super()},isCoordDependent:function(){return!1},getCoordDependentObjects:function($super){return $super()},move:function(t,r){var i=this.getCoordOfMode(r),n=e.CoordUtils.add(i,t);return this.setCoordOfMode(n,r),n},move2D:function(e){return this.move(e,t.COORD2D)},move3D:function(e){return this.move(e,t.COORD3D)}}),n.extend(e.BaseStructureConnector,{getCascadeDeleteObjs:function($super){for(var t=$super(),r=this.getConnectedObjs(),i=0,n=r.length;i<n;++i){var a=r[i];a instanceof e.BaseStructureNode&&a.getLinkedConnectors().length<=1&&e.ArrayUtils.pushUnique(t,a)}return t},isCoordDependent:function(){return!0},getCoordDependentObjects:function($super){for(var e=$super(),t=this.getConnectedObjs(),i=0,n=t.length;i<n;++i){var a,o=t[i];if(o.isExposed)var a=o.isExposed()?o:o.getExposedAncestor();else a=o;a&&r.pushUnique(e,a.getCoordDependentObjects())}return e},move:function(e,t){for(var r=0,i=this.getConnectedObjCount();r<i;++r){var n=this.getConnectedObjAt(r);n.move&&n.move(e,t)}},move2D:function(e){return this.move(e,t.COORD2D)},move3D:function(e){return this.move(e,t.COORD3D)},setAbsBaseCoord:function(t,r){var i=this.getAbsBaseCoord(),n=e.CoordUtils.substract(t,i);this.move(n,r)},setAbsBaseCoord2D:function(t){this.setAbsCoordOfMode(t,e.CoordMode.COORD2D)},setAbsBaseCoord3D:function(t){this.setAbsCoordOfMode(t,e.CoordMode.COORD3D)}}),n.extend(e.ChemStructureNode,{getConstraintManipulationBaseObj:function($super){var e=this.getLinkedObjs();return 1===e.length?e[0]:$super()}}),n.extend(e.Glyph.PathGlyphNode,{getCascadeDeleteObjs:function($super){return[this.getParent()]},getConstraintManipulationBaseObj:function($super){var e=this.getLinkedObjs();return 1===e.length?e[0]:$super()}}),n.extend(e.Glyph.PathGlyphConnectorControlNode,{getCoordDeterminateObjects:function($super){var e=$super(),t=this.getParentConnector();return t&&(e=(e||[]).concat([t])),e}}),n.extend(e.Glyph.PathGlyphConnector,{getCascadeDeleteObjs:function($super){return[this.getParent()]},getCoordDependentObjects:function($super){var e=$super(),t=this.getControlPoints&&this.getControlPoints();return t&&t.length&&(e=(e||[]).concat(t)),e}}),n.extend(e.StructureFragment,{isStandalone:function($super){return!this.getCrossConnectors().length},notifyBeforeCascadeRemove:function($super,e,t){var r=this._getObjsNeedToBeCascadeRemoved(e);if(r&&r.length)for(var i=r.length-1;i>=0;--i){var n=r[i];t?n.finalize():n.removeSelf()}$super(e,t)},getCoordDependentObjects:function($super){if(this.isExpanded&&!this.isExpanded())return $super();if(this.hasCtab()){for(var e=[],t=this.getChildCount(),i=0;i<t;++i){var n=this.getChildAt(i);r.pushUnique(e,n.getCoordDependentObjects())}return e}return $super()},transformAbsCoordByMatrix:function($super,t,r,i,n,a,o){if(n||e.ObjUtils.isUnset(n))for(var s=0,l=this.getNodeCount();s<l;++s){var d=this.getNodeAt(s);d&&d.transformAbsCoordByMatrix&&d.transformAbsCoordByMatrix(r,r,i,n,a,!0)}$super(t,r,i,!1,a,o)}}),n.extend(e.Glyph.Base,{isStandalone:function($super){return $super()}}),n.extend(e.Glyph.PathGlyph,{getCoordDependentObjects:function(){for(var e=[],t=this.getNodeCount(),r=0;r<t;++r){var i=this.getNodeAt(r);e.push(i)}return e},transformAbsCoordByMatrix:function($super,t,r,i,n,a,o){if(n||e.ObjUtils.isUnset(n))for(var s=0,l=this.getNodeCount();s<l;++s){var d=this.getNodeAt(s);d&&d.transformAbsCoordByMatrix&&d.transformAbsCoordByMatrix(r,r,i,n,a,!0)}$super(t,r,i,!1,a,o)}}),n.extend(e.Glyph.BaseArc,{ownerChanged:function($super,e,t){var r=!t&&e,i=$super(e,t);return r&&this.getIsEditing()&&this._autoAdjustClass(),i},_getChemStickTargets:function(){for(var e=[],t=0,r=this.getNodeCount();t<r;++t){var i=this.getNodeAt(t),n=i.getCoordStickTarget();this._isValidChemNodeOrConnectorStickTarget(n)&&e.push(n)}return e},notifyChildCoordStickTargetChanged:function(e,t,r){this._autoAdjustClass()},_autoAdjustClass:function(){if(this.getIsEditing()){this._getChemStickTargets().length>=2?this instanceof e.Glyph.ElectronPushingArrow||this.__changeClass__(e.Glyph.ElectronPushingArrow):this instanceof e.Glyph.ElectronPushingArrow&&this.__changeClass__(e.Glyph.Arc)}}}),n.extendMethod(e.Glyph.BaseArc,"createDefaultStructure",function(e,t,r){var i=e(t,r);return this._autoAdjustClass(),i}),n.extend(e.Glyph.BaseTwinArc,{ownerChanged:function($super,e,t){var r=!t&&e,i=$super(e,t);return r&&this.getIsEditing()&&this._autoAdjustClass(),i},_getChemStickTargets:function(){for(var e=[],t=this._getArrowStartingNodes(),r=0,i=t.length;r<i;++r){var n=t[r],a=n.getCoordStickTarget();this._isValidChemNodeOrConnectorStickTarget(a)&&e.push(a)}return e},notifyChildCoordStickTargetChanged:function(e,t,r){this._autoAdjustClass()},_autoAdjustClass:function(){if(this.getIsEditing()){this._getChemStickTargets().length>=2?this instanceof e.Glyph.BondFormingElectronPushingArrow||(this.__changeClass__(e.Glyph.BondFormingElectronPushingArrow),this.getElectronCount()||this.setElectronCount(1)):this instanceof e.Glyph.BondFormingElectronPushingArrow&&this.__changeClass__(e.Glyph.TwinArc)}}}),e}},function(e,t,r){"use strict";var i=r(0).Class,n=r(0).ClassEx,a=r(0).DataType;e.exports=function(e){var t=e.ObjUtils,r=e.ArrayUtils,o=e.HtmlElementUtils,s=e.CoordUtils,l=e.Widget.HtmlClassNames,d=e.ChemWidget.HtmlClassNames;e.ChemWidget.HtmlClassNames=Object.extend(e.ChemWidget.HtmlClassNames,{EDITOR:"K-Chem-Editor",EDITOR_CLIENT:"K-Chem-Editor-Client",EDITOR_UIEVENT_RECEIVER:"K-Chem-Editor-UiEvent-Receiver",EDITOR2D:"K-Chem-Editor2D",EDITOR3D:"K-Chem-Editor3D"}),e.ChemWidget.Editor={},e.Editor=e.ChemWidget.Editor,e.Editor.CoordSys=e.Render.CoordSystem,e.Editor.BoxRegion={OUTSIDE:0,CORNER_TL:1,CORNER_TR:2,CORNER_BL:3,CORNER_BR:4,EDGE_TOP:11,EDGE_LEFT:12,EDGE_BOTTOM:13,EDGE_RIGHT:14,INSIDE:20},e.Editor.SelectMode={RECT:0,POLYGON:1,POLYLINE:2,ANCESTOR:10},e.Editor.BaseEditor=i.create(e.ChemWidget.ChemObjDisplayer,{CLASS_NAME:"Kekule.Editor.BaseEditor",BINDABLE_TAG_NAMES:["div","span"],OBSERVING_GESTURES:["rotate","rotatestart","rotatemove","rotateend","rotatecancel","pinch","pinchstart","pinchmove","pinchend","pinchcancel","pinchin","pinchout"],initialize:function($super,e,t,r,i){this._objSelectFlag=0,this._objectUpdateFlag=0,this._objectManipulateFlag=0,this._uiMarkerUpdateFlag=0,this._updatedObjectDetails=[],this._operatingObjs=[],this._operatingRenderers=[],this._initialRenderTransformParams=null,this._objChanged=!1,this._lengthCaches={},this.setPropStoreFieldValue("enableCreateNewDoc",!0),this.setPropStoreFieldValue("enableOperHistory",!0),this.setPropStoreFieldValue("enableOperContext",!0),this.setPropStoreFieldValue("initOnNewDoc",!0),$super(e,t,r),!this.getChemObj()&&this.getInitOnNewDoc()&&this.getEnableCreateNewDoc()&&this.newDoc(),this.setPropStoreFieldValue("editorConfigs",i||this.createDefaultConfigs()),this.setEnableGesture(!0)},initProperties:function(){this.defineProp("editorConfigs",{dataType:"Kekule.Editor.BaseEditorConfigs",serializable:!1,getter:function(){return this.getDisplayerConfigs()},setter:function(e){return this.setDisplayerConfigs(e)}}),this.defineProp("defBondLength",{dataType:a.FLOAT,serializable:!1,getter:function(){var e=this.getPropStoreFieldValue("defBondLength");return e||(e=this.getEditorConfigs().getStructureConfigs().getDefBondLength()),e}}),this.defineProp("defBondScreenLength",{dataType:a.FLOAT,serializable:!1,setter:null,getter:function(){var t=this._lengthCaches.defBondScreenLength;if(t)return t;var r=this.getDefBondLength()||0,i=this.translateDistance(r,e.Render.CoordSystem.CHEM,e.Render.CoordSystem.SCREEN);return this._lengthCaches.defBondScreenLength=i,i}}),this.defineProp("currBoundInflation",{dataType:a.NUMBER,serializable:!1,setter:null,getter:function(){var e=this.getCurrPointerType();return this.getInteractionBoundInflation(e)}}),this.defineProp("currPointerType",{dataType:a.STRING,serializable:!1}),this.defineProp("enableCreateNewDoc",{dataType:a.BOOL,serializable:!1}),this.defineProp("initOnNewDoc",{dataType:a.BOOL,serializable:!1}),this.defineProp("enableOperHistory",{dataType:a.BOOL,serializable:!1}),this.defineProp("operHistory",{dataType:"Kekule.OperationHistory",serializable:!1,getter:function(){var t=this.getPropStoreFieldValue("operHistory");return t||(t=new e.OperationHistory,this.setPropStoreFieldValue("operHistory",t),t.addEventListener("push",this.reactOperHistoryPush,this),t.addEventListener("pop",this.reactOperHistoryPop,this),t.addEventListener("undo",this.reactOperHistoryUndo,this),t.addEventListener("redo",this.reactOperHistoryRedo,this),t.addEventListener("clear",this.reactOperHistoryClear,this),t.addEventListener("change",this.reactOperHistoryChange,this)),t},setter:null}),this.defineProp("operationsInCurrManipulation",{dataType:a.ARRAY,scope:i.PropertyScope.PRIVATE,serializable:!1}),this.defineProp("selection",{dataType:a.ARRAY,serializable:!1,getter:function(){var e=this.getPropStoreFieldValue("selection");return e||(e=[],this.setPropStoreFieldValue("selection",e)),e},setter:function(e){this.setPropStoreFieldValue("selection",e),this.selectionChanged()}}),this.defineProp("selectMode",{dataType:a.INT,getter:function(){var t=this.getPropStoreFieldValue("selectMode");return e.ObjUtils.isUnset(t)&&(t=e.Editor.SelectMode.RECT),t},setter:function(e){this.getSelectMode()!==e&&(this.setPropStoreFieldValue("selectMode",e),this.hideSelectingMarker())}}),this.defineProp("isToggleSelectOn",{dataType:a.BOOL}),this.defineProp("hotTrackedObjs",{dataType:a.ARRAY,serializable:!1,setter:function(t){var r=t?e.ArrayUtils.toArray(t):[];if(this.getEditorConfigs()&&this.getEditorConfigs().getInteractionConfigs().getEnableHotTrack()){this.setPropStoreFieldValue("hotTrackedObjs",r);var i;if(r&&r.length){i=[];for(var n=0,a=r.length;n<a;++n){var o=this.getBoundInfoRecorder().getBound(this.getObjContext(),r[n]);i&&e.ArrayUtils.pushUnique(i,o)}}i?this.changeHotTrackMarkerBounds(i):this.getUiHotTrackMarker().getVisible()&&this.hideHotTrackMarker()}}}),this.defineProp("hotTrackedObj",{dataType:a.OBJECT,serializable:!1,getter:function(){return this.getHotTrackedObjs()&&this.getHotTrackedObjs()[0]},setter:function(e){this.setHotTrackedObjs(e)}}),this.defineProp("enableOperContext",{dataType:a.BOOL,setter:function(e){if(this.setPropStoreFieldValue("enableOperContext",!!e),!e){var t=this.getPropStoreFieldValue("operContext"),r=this.getPropStoreFieldValue("drawBridge");r&&t&&r.releaseContext(t)}}}),this.defineProp("enableGesture",{dataType:a.BOOL,setter:function(e){var t=!!e;this.getEnableGesture()!==t&&(this.setPropStoreFieldValue("enableGesture",t),this.startObservingGestureEvents(this.OBSERVING_GESTURES))}}),this.defineProp("uiEventReceiverElem",{dataType:a.OBJECT,serializable:!1,setter:null}),this.defineProp("objContextParentElem",{dataType:a.OBJECT,serializable:!1,setter:null}),this.defineProp("operContextParentElem",{dataType:a.OBJECT,serializable:!1,setter:null}),this.defineProp("uiContextParentElem",{dataType:a.OBJECT,serializable:!1,setter:null}),this.defineProp("objContext",{dataType:a.OBJECT,serializable:!1,setter:null,getter:function(){return this.getDrawContext()}}),this.defineProp("operContext",{dataType:a.OBJECT,serializable:!1,setter:null,getter:function(){if(this.getEnableOperContext()){var t=this.getPropStoreFieldValue("operContext");if(!t){var r=this.getDrawBridge();if(r){var i=this.getOperContextParentElem();if(!i)return null;var n=e.HtmlElementUtils.getElemScrollDimension(i);t=r.createContext(i,n.width,n.height),this.setPropStoreFieldValue("operContext",t)}}return t}return null}}),this.defineProp("uiContext",{dataType:a.OBJECT,serializable:!1,getter:function(){var t=this.getPropStoreFieldValue("uiContext");if(!t){var r=this.getUiDrawBridge();if(r){var i=this.getUiContextParentElem();if(!i)return null;var n=e.HtmlElementUtils.getElemScrollDimension(i);t=r.createContext(i,n.width,n.height),this.setPropStoreFieldValue("uiContext",t)}}return t}}),this.defineProp("objDrawBridge",{dataType:a.OBJECT,serializable:!1,setter:null,getter:function(){return this.getDrawBridge()}}),this.defineProp("uiDrawBridge",{dataType:a.OBJECT,serializable:!1,setter:null,getter:function(){var e=this.getPropStoreFieldValue("uiDrawBridge");return e||(e=this.createUiDrawBridge(),this.setPropStoreFieldValue("uiDrawBridge",e)),e}}),this.defineProp("uiPainter",{dataType:"Kekule.Render.ChemObjPainter",serializable:!1,setter:null,getter:function(){var t=this.getPropStoreFieldValue("uiPainter");if(!t){var r=this.getUiMarkers();return t=new e.Render.ChemObjPainter(e.Render.RendererType.R2D,r,this.getUiDrawBridge()),t.setCanModifyTargetObj(!0),this.setPropStoreFieldValue("uiPainter",t),t}return t}}),this.defineProp("uiRenderer",{dataType:"Kekule.Render.AbstractRenderer",serializable:!1,setter:null,getter:function(){var e=this.getUiPainter();if(e){return e.getRenderer()||e.prepareRenderer(),e.getRenderer()||null}return null}}),this.defineProp("uiMarkers",{dataType:"Kekule.ChemWidget.UiMarkerCollection",serializable:!1,setter:null,getter:function(){var t=this.getPropStoreFieldValue("uiMarkers");return t||(t=new e.ChemWidget.UiMarkerCollection,this.setPropStoreFieldValue("uiMarkers",t)),t}}),this._defineUiMarkerProp("uiHotTrackMarker"),this._defineUiMarkerProp("uiSelectionAreaMarker"),this._defineUiMarkerProp("uiSelectingMarker"),this.defineProp("uiSelectionAreaContainerBox",{dataType:a.Object,serializable:!1,scope:i.PropertyScope.PRIVATE}),this.defineProp("objRendererMap",{dataType:"Kekule.MapEx",serializable:!1,setter:null,getter:function(){var t=this.getPropStoreFieldValue("objRendererMap");return t||(t=new e.MapEx(!0),this.setPropStoreFieldValue("objRendererMap",t)),t}}),this.defineProp("zoomCenter",{dataType:a.HASH})},initPropValues:function($super){$super(),this.setOperationsInCurrManipulation([])},elementBound:function(e){this.setObserveElemResize(!0)},_defineUiMarkerProp:function(e,t){return this.defineProp(e,{dataType:"Kekule.ChemWidget.AbstractUIMarker",serializable:!1,getter:function(){var t=this.getPropStoreFieldValue(e);return t||(t=this.createShapeBasedMarker(e,null,null,!1)),t},setter:function(r){t||(t=this.getUiMarkers());var i=this.getPropValue(e);i&&(t.removeMarker(i),i.finalize()),t.addMarker(r),this.setPropStoreFieldValue(e,r)}})},doFinalize:function($super){var e=this.getPropStoreFieldValue("operHistory");e&&(e.finalize(),this.setPropStoreFieldValue("operHistory",null));var t=this.getPropStoreFieldValue("objDrawBridge"),r=this.getPropStoreFieldValue("operContext");t&&r&&t.releaseContext(r),this.setPropStoreFieldValue("operContext",null);var t=this.getPropStoreFieldValue("uiDrawBridge"),r=this.getPropStoreFieldValue("uiContext");t&&r&&t.releaseContext(r),this.setPropStoreFieldValue("uiDrawBridge",null),this.setPropStoreFieldValue("uiContext",null);var i=this.getPropStoreFieldValue("objRendererMap");i&&i.finalize(),this.setPropStoreFieldValue("objRendererMap",null),$super()},createDefaultConfigs:function(){return new e.Editor.BaseEditorConfigs},doCreateRootElement:function(e){return e.createElement("div")},doCreateSubElements:function(e,t){var r=e.createElement("div");return r.className=d.EDITOR_CLIENT,t.appendChild(r),this._editClientElem=r,[r]},getCoreElement:function($super){return this._editClientElem||$super()},getEditClientElem:function(){return this._editClientElem},doGetWidgetClassName:function($super){var t=$super()+" "+d.EDITOR;return t+=" "+(this.getRenderType()===e.Render.RendererType.R3D?d.EDITOR3D:d.EDITOR2D)},doBindElement:function(e){this.createContextParentElems(),this.createUiEventReceiverElem()},doGetInitialZoom:function($super){var e,t=this.getEditorConfigs();return t&&(e=t.getInteractionConfigs().getEditorInitialZoom()),e||(e=$super()),e},doSetInitialZoom:function($super,e){var t=this.getEditorConfigs();t&&t.getInteractionConfigs().setEditorInitialZoom(e),$super(e)},zoomTo:function($super,t,r,i){var n=e.CoordUtils,a=(this.getCurrZoom(),$super(t,r)),o=this.getElement(),s={x:o.scrollLeft,y:o.scrollTop};return i||(i=this.getZoomCenter()),i||(i=n.add(s,{x:o.clientWidth/2,y:o.clientHeight/2})),a},zoomIn:function(t,r){var i=this.getCurrZoom(),n=e.ZoomUtils.getNextZoomInRatio(i,t||1);return this.zoomTo(n,null,r)},zoomOut:function(t,r){var i=this.getCurrZoom(),n=e.ZoomUtils.getNextZoomOutRatio(i,t||1);return this.zoomTo(n,null,r)},resetZoom:function(e){return this.zoomTo(this.getInitialZoom()||1,null,e)},changeClientSize:function(e,t,r){this._initialRenderTransformParams=null;var i=this.getCoreElement(),n=i.style;r||(r=1);var a=e*r,o=t*r;a&&(n.width=a+"px"),o&&(n.height=o+"px");for(var s=[this.getObjContext(),this.getOperContext(),this.getUiContext()],l=0,d=s.length;l<d;++l){var u=s[l];u&&this.getDrawBridge().setContextDimension(u,a,o)}this.repaint()},getVisibleClientScreenBox:function(){var t=this.getEditClientElem().parentNode,r=e.HtmlElementUtils.getElemClientDimension(t),i=this.getClientScrollPosition();return r.x1=i.x,r.y1=i.y,r.x2=r.x1+r.width,r.y2=r.y1+r.height,r},getVisibleClientBoxOfSys:function(t){var r=this.getVisibleClientScreenBox(),i=e.BoxUtils.getMinMaxCoords(r),n=this.translateCoord(i.min,e.Editor.CoordSys.SCREEN,t),a=this.translateCoord(i.max,e.Editor.CoordSys.SCREEN,t);return e.BoxUtils.createBox(n,a)},getVisibleClientObjBox:function(t){return this.getVisibleClientBoxOfSys(e.Editor.CoordSys.CHEM)},isDirty:function(){return this.getEnableOperHistory()?this.getOperHistory().getCurrIndex()>=0:this._objChanged},getChemObjSrcInfo:function(e){return this.isDirty()?null:e.getSrcInfo?e.getSrcInfo():null},getActualDrawOptions:function($super){var e=$super();if(this._initialRenderTransformParams){var t=Object.extend({},this._initialRenderTransformParams);return t=Object.extend(t,e)}return e},repaint:function($super,e){var t=e,r=$super(t);return this._initialRenderTransformParams||(this._initialRenderTransformParams=this.getPainter().getActualInitialRenderTransformOptions(this.getObjContext())),this.recalcUiMarkers(),r},newDoc:function(){this.load(this.doCreateNewDocObj())},doCreateNewDocObj:function(){return new e.Molecule},getExportableClasses:function(){var e=this.getChemObj();return e?e.getClass?e.getClass():null:[]},exportObj:function(e){return this.exportObjs(e)[0]},exportObjs:function(e){var t=this.getChemObj();return e?t&&t instanceof e?[t]:[]:[t]},doLoad:function($super,e){this.deselectAll(),this._initialRenderTransformParams=null,this.getObjRendererMap().clear(),this.getOperHistory()&&this.getOperHistory().clear(),$super(e),this._objChanged=!1},doLoadEnd:function($super,e){$super(),e||(this._initialRenderTransformParams=null)},doResize:function($super){this._initialRenderTransformParams=null,$super()},geometryOptionChanged:function($super){var e=this.getDrawOptions().zoom;this.zoomChanged(e),this._clearLengthCaches(),$super()},zoomChanged:function(e){},_clearLengthCaches:function(){this._lengthCaches={}},chemObjChanged:function($super,e,t){$super(e,t),e!==t&&(t&&this._uninstallChemObjEventListener(t),e&&this._installChemObjEventListener(e))},_installChemObjEventListener:function(e){e.addEventListener("change",this.reactChemObjChange,this)},_uninstallChemObjEventListener:function(e){e.removeEventListener("change",this.reactChemObjChange,this)},createUiEventReceiverElem:function(){var e=this.getCoreElement();if(e){var t=e.ownerDocument.createElement("div");return t.className=d.EDITOR_UIEVENT_RECEIVER,e.appendChild(t),o.addClass(t,l.DYN_CREATED),this.setPropStoreFieldValue("uiEventReceiverElem",t),t}},createContextParentElems:function(){var e=this.getCoreElement();if(e){e.style.height="340px";var t=e.ownerDocument;this._createContextParentElem(t,e,"objContextParentElem"),this._createContextParentElem(t,e,"operContextParentElem"),this._createContextParentElem(t,e,"uiContextParentElem")}},_createContextParentElem:function(e,t,r){var i=e.createElement("div");return i.style.position="absolute",i.className=r+" "+l.DYN_CREATED,this.setPropStoreFieldValue(r,i),t.appendChild(i),i},createNewPainter:function($super,e){var t=$super(e);return t&&(t.setCanModifyTargetObj(!0),this.installPainterEventHandlers(t)),t},getDrawContextParentElem:function(){return this.getObjContextParentElem()},createUiDrawBridge:function(){var t=e.Render.DrawBridge2DMananger.getPreferredBridgeInstance();return t||e.error(e.$L("ErrorMsg.DRAW_BRIDGE_NOT_SUPPORTED")),t},changeContextDimension:function($super,e){var t=$super(e);return t&&(this._resizeContext(this.getOperContext(),this.getObjDrawBridge(),e.width,e.height),this._resizeContext(this.getUiContext(),this.getUiDrawBridge(),e.width,e.height)),t},_resizeContext:function(e,t,r,i){e&&t&&t.setContextDimension(e,r,i)},_clearSpecContext:function(e,t){t&&e&&t.clearContext(e)},clearObjContext:function(){this._clearSpecContext(this.getObjContext(),this.getDrawBridge()),this.getBoundInfoRecorder()&&this.getBoundInfoRecorder().clear(this.getObjContext())},clearOperContext:function(){this._clearSpecContext(this.getOperContext(),this.getDrawBridge())},clearUiContext:function(){this._clearSpecContext(this.getUiContext(),this.getUiDrawBridge())},clearContext:function(){this.clearObjContext(),this._operatingRenderers&&this.clearOperContext()},repaintOperContext:function(e){if(this._operatingRenderers&&this._operatingObjs){this.clearOperContext();var t={partialDrawObjs:this._operatingObjs,doNotClear:!0};this.repaint(t)}},getOperatingRenderers:function(){return this._operatingRenderers||(this._operatingRenderers=[]),this._operatingRenderers},setOperatingRenderers:function(e){this._operatingRenderers=e},installPainterEventHandlers:function(e){e.addEventListener("prepareDrawing",this.reactChemObjPrepareDrawing,this),e.addEventListener("clear",this.reactChemObjClear,this)},reactChemObjPrepareDrawing:function(e){var t=e.context,i=e.obj;if(i&&(t===this.getObjContext()||t===this.getOperContext())){var n=e.target;if(this.getObjRendererMap().set(i,n),this.getEnableOperContext()){for(var a=this._operatingObjs||[],o=!1,s=0,l=a.length;s<l;++s)if(this._isChemObjDirectlyRenderedByRenderer(this.getObjContext(),a[s],n)){o=!0;break}o&&(this._setRendererToOperContext(n),r.pushUnique(this.getOperatingRenderers(),n))}}},reactChemObjClear:function(e){var t=e.context,i=e.obj;if(i&&(t===this.getObjContext()||t===this.getOperContext())){var n=e.target;this.getObjRendererMap().remove(i),r.remove(this.getOperatingRenderers(),n)}},reactChemObjChange:function(t){var r=t.target,i=t.changedPropNames||[],n=["id","owner","ownedObjs"];i=e.ArrayUtils.exclude(i,n),!i.length&&t.changedPropNames||this.objectChanged(r,i)},reactOperHistoryPush:function(e){this.invokeEvent("operPush",e)},reactOperHistoryPop:function(e){this.invokeEvent("operPop",e)},reactOperHistoryUndo:function(e){this.invokeEvent("operUndo",e)},reactOperHistoryRedo:function(e){this.invokeEvent("operRedo",e)},reactOperHistoryClear:function(e){this.invokeEvent("operHistoryClear",e)},reactOperHistoryChange:function(e){this.invokeEvent("operChange",e)},beginUpdateObject:function(){this._objectUpdateFlag>=0&&this.invokeEvent("beginUpdateObject"),--this._objectUpdateFlag},endUpdateObject:function(){++this._objectUpdateFlag,this.isUpdatingObject()||(this._updatedObjectDetails&&this._updatedObjectDetails.length&&(this.objectsChanged(this._updatedObjectDetails),this._updatedObjectDetails=[]),this._execAfterUpdateObjectProcs(),this.invokeEvent("endUpdateObject"))},isUpdatingObject:function(){return this._objectUpdateFlag<0},_registerAfterUpdateObjectProc:function(e){this.isUpdatingObject()?(this.endUpdateObject.suspendedProcs||(this.endUpdateObject.suspendedProcs=[]),this.endUpdateObject.suspendedProcs.push(e)):e.apply(this)},_execAfterUpdateObjectProcs:function(){var e=this.endUpdateObject.suspendedProcs;if(e)for(;e.length;){var t=e.shift();t&&t.apply(this)}},_mergeObjUpdatedDetails:function(e,t){for(var r=0,i=t.length;r<i;++r)this._mergeObjUpdatedDetailItem(e,t[r])},_mergeObjUpdatedDetailItem:function(t,r){for(var i=0,n=t.length;i<n;++i){var a=t[i];if(a.obj===r.obj)return a.propNames||(a.propNames=[]),void(r.propNames&&e.ArrayUtils.pushUnique(a.propNames,r.propNames))}t.push(r)},_logUpdatedDetail:function(e){var t="";e.forEach(function(e){t+="Obj: "+e.obj.getId()+"["+e.obj.getClassName()+"]     ",t+="Props: ["+e.propNames.join(", ")+"]",t+="\n"}),console.log(t)},objectChanged:function(e,t){var r={obj:e,propNames:t},i=this.objectsChanged(r);return this.invokeEvent("editObjChanged",Object.extend({},r)),i},objectsChanged:function(t){var i=a.isArrayValue(t)?t:[t];if(this.isUpdatingObject())this._mergeObjUpdatedDetails(this._updatedObjectDetails,i);else{var n=e.Render.UpdateObjUtils._extractObjsOfUpdateObjDetails(i);this.doObjectsChanged(i,n),this.invokeEvent("editObjsUpdated",{details:Object.extend({},t)})}this._objChanged=!0,this.invokeEvent("editObjsChanged",{details:Object.extend({},t)});var o=this.getSelection();if(o&&n){var s=r.intersect(o,n);s.length&&this.invokeEvent("selectedObjsUpdated",{objs:s})}},doObjectsChanged:function(t,r){var i=e.ArrayUtils.clone(t);r||(r=e.Render.UpdateObjUtils._extractObjsOfUpdateObjDetails(i));var n=this._getAdditionalRenderRelatedObjs(r);if(n.length){var a=e.Render.UpdateObjUtils._createUpdateObjDetailsFromObjs(n);e.ArrayUtils.pushUnique(i,a)}e.ArrayUtils.pushUnique(r,n);var o=this._operatingRenderers,s=o&&this._isAllObjsRenderedByRenderers(this.getObjContext(),r,o);this.canModifyPartialGraphic()?(this.getRootRenderer().modify(this.getObjContext(),i),this.recalcUiMarkers()):s?this.repaintOperContext():this.repaint()},beginManipulateObject:function(){this._objectManipulateFlag>=0&&this.invokeEvent("beginManipulateObject"),--this._objectManipulateFlag},endManipulateObject:function(){++this._objectManipulateFlag,this.isManipulatingObject()||(this._objectManipulateFlag=0,this.doManipulationEnd())},isManipulatingObject:function(){return this._objectManipulateFlag<0},doManipulationEnd:function(){this.setOperationsInCurrManipulation([]),this.invokeEvent("endManipulateObject")},beginManipulateAndUpdateObject:function(){this.beginManipulateObject(),this.beginUpdateObject()},endManipulateAndUpdateObject:function(){this.endUpdateObject(),this.endManipulateObject()},_needToCanonicalizeBeforeSaving:function(){return!0},_getAdditionalRenderRelatedObjs:function(t){for(var r=[],i=0,n=t.length;i<n;++i){var a=t[i],o=a.getCoordDeterminateObjects?a.getCoordDeterminateObjects():[];e.ArrayUtils.pushUnique(r,o)}return r},_isAllObjsRenderedByRenderers:function(e,t,r){for(var i=0,n=t.length;i<n;++i){for(var a=t[i],o=!1,s=0,l=r.length;s<l;++s){if(r[s].isChemObjRenderedBySelf(e,a)){o=!0;break}}if(!o)return!1}return!0},prepareOperatingObjs:function(e){this._operatingRenderers&&this._operatingRenderers.length&&this.endOperatingObjs(!0),this.getEnableOperContext()&&(this._prepareRenderObjsInOperContext(e),this._operatingObjs=e),this.repaint()},endOperatingObjs:function(e){this.getEnableOperContext()&&(this._endRenderObjsInOperContext(),this._operatingObjs=null,e||this.repaint())},_isChemObjDirectlyRenderedByRenderer:function(e,t,r){var i=t.getStandaloneAncestor?t.getStandaloneAncestor():t;return r.isChemObjRenderedDirectlyBySelf(e,i)},_getStandaloneRenderObjsInOperContext:function(t){for(var r=[],i=0,n=t.length;i<n;++i){var a=t[i];a.getStandaloneAncestor&&(a=a.getStandaloneAncestor()),e.ArrayUtils.pushUnique(r,a)}return r},_prepareRenderObjsInOperContext:function(t){for(var r=[],i=this.getObjRendererMap(),n=i.getValues(),a=this.getObjContext(),o=this._getStandaloneRenderObjsInOperContext(t),s=0,l=o.length;s<l;++s)for(var d=o[s],u=0,c=n.length;u<c;++u){var h=n[u];h.isChemObjRenderedDirectlyBySelf(a,d)&&e.ArrayUtils.pushUnique(r,h)}if(r.length>0){for(var s=0,l=r.length;s<l;++s){var h=r[s];this._setRendererToOperContext(h)}this._operatingRenderers=r}else this._operatingRenderers=null},_endRenderObjsInOperContext:function(){var e=this._operatingRenderers;if(e&&e.length){for(var t=0,r=e.length;t<r;++t){var i=e[t];this._unsetRendererToOperContext(i)}this.clearOperContext()}this._operatingRenderers=null},_setRendererToOperContext:function(e){e.setRedirectContext(this.getOperContext())},_unsetRendererToOperContext:function(e){e.setRedirectContext(null)},getInteractionBoundInflation:function(e){var t=this._lengthCaches.interactionBoundInflations,r=e||"default";if(t&&t[r])return t[r];var i,n=this.getEditorConfigs().getInteractionConfigs(),a=n.getPropValue("objBoundTrackInflationRatio");if(e){var o=e.upperFirst(),s="objBoundTrackInflationRatio"+o;n.hasProperty(s)&&(i=n.getPropValue(s))}var l,d=i||a,u=d&&this.getDefBondScreenLength()*d,c=n.getPropValue("objBoundTrackMinInflation");if(e){var h="objBoundTrackMinInflation"+o;n.hasProperty(h)&&(l=n.getPropValue(h))}var m=l||c,g=Math.max(u||0,m);return t||(t={},this._lengthCaches.interactionBoundInflations=t),t[r]=g,g},clearBoundMap:function(){this.getBoundInfoRecorder().clear(this.getObjContext())},findTopmostBoundInfo:function(e,t){if(e&&e.length){var r=null,i=e.length-1;for(r=e[i];i>=0&&t&&t.indexOf(r.obj)>=0;)--i,r=e[i];return r}return null},getBoundInfosAtCoord:function(t,r,i){var n=this.getBoundInfoRecorder(),a=i||this.getCurrBoundInflation()||this.getEditorConfigs().getInteractionConfigs().getObjBoundTrackMinInflation(),o=this.screenCoordToContext(t),s=this.getRenderType()===e.Render.RendererType.R3D?{x:0,y:0}:null;return n.getIntersectionInfos(this.getObjContext(),o,s,a,r)},getTopmostBoundInfoAtCoord:function(t,r,i){if(!this.getEditorConfigs().getInteractionConfigs().getEnableTrackOnNearest())return this.findTopmostBoundInfo(this.getBoundInfosAtCoord(t,null,i),r,i);for(var n,a,o,s=e.Render.MetaShapeUtils,l=this.getBoundInfosAtCoord(t,null,i),d=function(r,i,l){n=r,a=i||r.boundInfo,o=e.ObjUtils.notUnset(l)?l:s.getDistance(t,a)},u=l.length-1;u>=0;--u){var c=l[u];if(!(r&&r.indexOf(c.obj)>=0))if(n){var h=c.boundInfo;if(h.shapeType<a.shapeType)d(c,h);else if(h.shapeType===a.shapeType){var m=s.getDistance(t,h);m<o&&d(c,h,m)}}else d(c)}return n},getBasicObjectsAtCoord:function(t,i,n,a){var o=this.getBoundInfosAtCoord(t,null,i),s=[];if(o){n&&(o=r.filter(o,function(e){var t=o[u].obj;return!!t&&!(t&&n&&n.indexOf(t)>=0)}));var l=function(e){return e&&e.getCoordStickTarget&&e.getCoordStickTarget()?1:0};o.sort(function(e,t){return l(e.obj)-l(t.obj)});if(this.getEditorConfigs().getInteractionConfigs().getEnableTrackOnNearest()){var d=e.Render.MetaShapeUtils;o.sort(function(e,r){var i=0,n=e.boundInfo,a=r.boundInfo;if(!(i=-(n.shapeType-a.shapeType))){i=-(d.getDistance(t,n)-d.getDistance(t,a))}return i})}for(var u=o.length-1;u>=0;--u){var c=o[u].obj;c&&n&&n.indexOf(c)>=0||s.push(c)}s&&a&&(s=r.filter(s,function(e){for(var t=0,r=a.length;t<r;++t)if(e instanceof a[t])return!0;return!1}))}return s},getTopmostBasicObjectAtCoord:function(e,t,r){var i=this.getBasicObjectsAtCoord(e,t,null,r);return i&&i[0]},getChemObjBounds:function(t,r){var i=[],n=this.getBoundInfoRecorder().getBelongedInfos(this.getObjContext(),t);if(n&&n.length)for(var a=0,o=n.length;a<o;++a){var s=n[a],l=s.boundInfo;l&&(l=e.Render.MetaShapeUtils.inflateShape(l,r),i.push(l))}return i},beginUpdateUiMarkers:function(){--this._uiMarkerUpdateFlag},endUpdateUiMarkers:function(){++this._uiMarkerUpdateFlag,this.isUpdatingUiMarkers()||this.repaintUiMarker()},isUpdatingUiMarkers:function(){return this._uiMarkerUpdateFlag<0},recalcUiMarkers:function(){this.beginUpdateUiMarkers();try{this.recalcHotTrackMarker(),this.recalcSelectionAreaMarker()}finally{this.endUpdateUiMarkers()}},repaintUiMarker:function(){if(!this.isUpdatingUiMarkers()){this.clearUiContext();var e=this.calcDrawParams();this.getUiPainter().draw(this.getUiContext(),e.baseCoord,e.drawOptions)}},createShapeBasedMarker:function(t,r,i,n){var a=new e.ChemWidget.MetaShapeUIMarker;return r&&a.setShapeInfo(r),i&&a.setDrawStyles(i),this.setPropStoreFieldValue(t,a),this.getUiMarkers().addMarker(a),n&&this.repaintUiMarker(),a},modifyShapeBasedMarker:function(t,r,i,n){e.Render.ObjectUpdateType.MODIFY;r&&t.setShapeInfo(r),i&&t.setDrawStyles(i),n&&this.repaintUiMarker()},hideUiMarker:function(e,t){e.setVisible(!1),t&&this.repaintUiMarker()},showUiMarker:function(e,t){e.setVisible(!0),t&&this.repaintUiMarker()},removeUiMarker:function(e){e&&(this.getUiMarkers().removeMarker(e),this.repaintUiMarker())},clearUiMarkers:function(){this.getUiMarkers().clearMarkers(),this.repaintUiMarker()},changeHotTrackMarkerBounds:function(t){for(var r=e.ArrayUtils.toArray(t),i=this.getEditorConfigs().getUiMarkerConfigs(),n={color:i.getHotTrackerColor(),opacity:i.getHotTrackerOpacity()},a=this.getCurrBoundInflation()||this.getEditorConfigs().getInteractionConfigs().getObjBoundTrackMinInflation(),o=[],s=0,l=r.length;s<l;++s){var d=r[s],u=a?e.Render.MetaShapeUtils.inflateShape(d,a):d;u&&o.push(u)}var c=this.getUiHotTrackMarker();return c.setVisible(!0),this.modifyShapeBasedMarker(c,o,n,!0),this},hideHotTrackMarker:function(){var e=this.getUiHotTrackMarker();return e&&this.hideUiMarker(e,!0),this},showHotTrackMarker:function(){var e=this.getUiHotTrackMarker();return e&&this.showUiMarker(e,!0),this},hotTrackOnCoord:function(e){return this.getEditorConfigs().getInteractionConfigs().getEnableHotTrack()&&this.setHotTrackedObj(this.getTopmostBasicObjectAtCoord(e,this.getCurrBoundInflation())),this},hotTrackOnObj:function(e){return this.setHotTrackedObj(e),this},hideHotTrack:function(e){return this.hideHotTrackMarker(),e||this.clearHotTrackedObjs(),this},clearHotTrackedObjs:function(){this.setHotTrackedObjs([])},addHotTrackedObj:function(t){var r=this.getHotTrackedObjs()||[];return e.ArrayUtils.pushUnique(r,t),this.setHotTrackedObjs(r),this},recalcHotTrackMarker:function(){this.setHotTrackedObjs(this.getHotTrackedObjs())},changeSelectionAreaMarkerBound:function(e,t){var r=this.getEditorConfigs().getUiMarkerConfigs();t||(t={strokeColor:r.getSelectionMarkerStrokeColor(),strokeWidth:r.getSelectionMarkerStrokeWidth(),fillColor:r.getSelectionMarkerFillColor(),opacity:r.getSelectionMarkerOpacity()});var i=this.getUiSelectionAreaMarker();return i&&(i.setVisible(!0),this.modifyShapeBasedMarker(i,e,t,!0)),this},hideSelectionAreaMarker:function(){var e=this.getUiSelectionAreaMarker();e&&this.hideUiMarker(e,!0)},showSelectionAreaMarker:function(){var e=this.getUiSelectionAreaMarker();e&&this.showUiMarker(e,!0)},recalcSelectionAreaMarker:function(t){this.beginUpdateUiMarkers();try{var r=this.getSelection(),i=r.length;if(i<=0)this.hideSelectionAreaMarker();else{for(var n=[],a=null,o=this.getEditorConfigs().getInteractionConfigs().getSelectionMarkerInflation(),s=0;s<i;++s){var l=r[s],d=this.getBoundInfoRecorder().getBelongedInfos(this.getObjContext(),l);if(d&&d.length)for(var u=0,c=d.length;u<c;++u){var h=d[u],m=h.boundInfo;if(m){m=e.Render.MetaShapeUtils.inflateShape(m,o),n.push(m);var g=e.Render.MetaShapeUtils.getContainerBox(m);a=a?e.BoxUtils.getContainerBox(a,g):g}}}if(this.setUiSelectionAreaContainerBox(a),a){var f=e.Render.MetaShapeUtils.createShapeInfo(e.Render.MetaShapeType.RECT,[{x:a.x1,y:a.y1},{x:a.x2,y:a.y2}]);n.push(f)}else this.hideSelectionAreaMarker();n.length&&this.changeSelectionAreaMarkerBound(n)}}finally{this.endUpdateUiMarkers()}},_highlightSelectionAreaMarker:function(){var e=this.getEditorConfigs().getUiMarkerConfigs(),t={strokeColor:e.getSelectionMarkerStrokeColor(),strokeWidth:e.getSelectionMarkerStrokeWidth(),fillColor:e.getSelectionMarkerFillColor(),opacity:e.getSelectionMarkerEmphasisOpacity()};this.changeSelectionAreaMarkerBound(null,t)},_restoreSelectionAreaMarker:function(){var e=this.getEditorConfigs().getUiMarkerConfigs(),t={strokeColor:e.getSelectionMarkerStrokeColor(),strokeWidth:e.getSelectionMarkerStrokeWidth(),fillColor:e.getSelectionMarkerFillColor(),opacity:e.getSelectionMarkerOpacity()};this.changeSelectionAreaMarkerBound(null,t)},pulseSelectionAreaMarker:function(e,t){if(this.getUiSelectionAreaMarker()){if(e||(e=this.getEditorConfigs().getInteractionConfigs().getSelectionMarkerDefPulseDuration()||0),t||(t=this.getEditorConfigs().getInteractionConfigs().getSelectionMarkerDefPulseCount()||1),!e)return;var r=e/t;this.doPulseSelectionAreaMarker(r,t)}return this},doPulseSelectionAreaMarker:function(e,t){this._highlightSelectionAreaMarker(),setTimeout(this._restoreSelectionAreaMarker.bind(this),e),t>1&&setTimeout(this.doPulseSelectionAreaMarker.bind(this,e,t-1),2*e)},startSelecting:function(t,r){void 0===r&&(r=this.getIsToggleSelectOn()),r||this.deselectAll();var i=e.Editor.SelectMode,n=this.getSelectMode();return this._currSelectMode=n,n===i.POLYLINE||n===i.POLYGON?this.startSelectingCurveDrag(t,r):this.startSelectingBoxDrag(t,r)},addSelectingAnchorCoord:function(t){var r=e.Editor.SelectMode,i=this._currSelectMode;return i===r.POLYLINE||i===r.POLYGON?this.dragSelectingCurveToCoord(t):this.dragSelectingBoxToCoord(t)},endSelecting:function(t,r){void 0===r&&(r=this.getIsToggleSelectOn());var i,n=e.Editor.SelectMode,a=this._currSelectMode,o=this.getEditorConfigs().getInteractionConfigs().getEnablePartialAreaSelecting();if(a===n.POLYLINE||a===n.POLYGON){var s=this._selectingCurveCoords,l=this.getEditorConfigs().getInteractionConfigs().getSelectingCurveSimplificationDistanceThreshold(),d=e.GeometryUtils.simplifyCurveToLineSegments(s,l);if(this.endSelectingCurveDrag(t,r),a===n.POLYLINE){var u=this.getEditorConfigs().getInteractionConfigs().getSelectingBrushWidth();i=this.getObjectsIntersetExtendedPolyline(d,u)}else i=this.getObjectsInPolygon(d,o),this.endSelectingCurveDrag(t,r)}else{var c=this._selectingBoxStartCoord,h=e.BoxUtils.createBox(c,t);i=this.getObjectsInScreenBox(h,o),this.endSelectingBoxDrag(t,r)}i=this._getActualSelectedObjsInSelecting(i),r?this.toggleSelectingState(i):this.select(i),this.hideSelectingMarker()},cancelSelecting:function(){this.hideSelectingMarker()},_getActualSelectedObjsInSelecting:function(e){return e&&e.length?(this._isInAncestorSelectMode()&&(e=this._getAllStandaloneAncestorObjs(e)),e):[]},_isInAncestorSelectMode:function(){return this.getSelectMode()===e.Editor.SelectMode.ANCESTOR},_getAllStandaloneAncestorObjs:function(e){for(var t=[],i=0,n=e.length;i<n;++i){var a=e[i];a&&a.getStandaloneAncestor&&(a=a.getStandaloneAncestor()),r.pushUnique(t,a)}return t},startSelectingBoxDrag:function(e,t){this._selectingBoxStartCoord=e},dragSelectingBoxToCoord:function(e){var t=this._selectingBoxStartCoord,r=e;this.changeSelectingMarkerBox(t,r)},endSelectingBoxDrag:function(e,t){this._selectingBoxStartCoord;this._selectingBoxEndCoord=e},startSelectingCurveDrag:function(e,t){this._selectingCurveCoords=[e]},dragSelectingCurveToCoord:function(t){this._selectingCurveCoords.push(t),this.changeSelectingMarkerCurve(this._selectingCurveCoords,this._currSelectMode===e.Editor.SelectMode.POLYGON)},endSelectingCurveDrag:function(e,t){this._selectingCurveCoords.push(e)},selectOnCoord:function(e,t){void 0===t&&(t=this.getIsToggleSelectOn());var r=this.getTopmostBasicObjectAtCoord(e,this.getCurrBoundInflation());if(r){var i=this._getActualSelectedObjsInSelecting([r]);i&&(t?this.toggleSelectingState(i):this.select(i))}},changeSelectingMarkerBound:function(e,t){var r=this.getEditorConfigs().getUiMarkerConfigs();t||(t={strokeColor:r.getSelectingMarkerStrokeColor(),strokeWidth:r.getSelectingMarkerStrokeWidth(),strokeDash:r.getSelectingMarkerStrokeDash(),fillColor:r.getSelectingMarkerFillColor(),opacity:r.getSelectingMarkerOpacity()});var i=this.getUiSelectingMarker();return i.setVisible(!0),this.modifyShapeBasedMarker(i,e,t,!0),this},changeSelectingMarkerCurve:function(t,r){for(var i=[],n=0,a=t.length-1;n<a;++n)i.push(this.screenCoordToContext(t[n]));var o,s=e.Render.MetaShapeUtils.createShapeInfo(r?e.Render.MetaShapeType.POLYGON:e.Render.MetaShapeType.POLYLINE,i);if(!r){var l=this.getEditorConfigs().getUiMarkerConfigs();o={strokeColor:l.getSelectingBrushMarkerStrokeColor(),strokeWidth:this.getEditorConfigs().getInteractionConfigs().getSelectingBrushWidth(),strokeDash:l.getSelectingBrushMarkerStrokeDash(),lineCap:l.getSelectingBrushMarkerStrokeLineCap(),lineJoin:l.getSelectingBrushMarkerStrokeLineJoin(),opacity:l.getSelectingBrushMarkerOpacity()}}return this.changeSelectingMarkerBound(s,o)},changeSelectingMarkerBox:function(t,r){var i=this.screenCoordToContext(t),n=this.screenCoordToContext(r),a=e.Render.MetaShapeUtils.createShapeInfo(e.Render.MetaShapeType.RECT,[{x:Math.min(i.x,n.x),y:Math.min(i.y,n.y)},{x:Math.max(i.x,n.x),y:Math.max(i.y,n.y)}]);return this.changeSelectingMarkerBound(a)},hideSelectingMarker:function(){var e=this.getUiSelectingMarker();e&&this.hideUiMarker(e,!0)},showSelectingMarker:function(){var e=this.getUiSelectingMarker();e&&this.showUiMarker(e,!0)},getCoordRegionInSelectionMarker:function(t,r){var i=e.Editor.BoxRegion,n=e.CoordUtils,a=this.screenCoordToContext(t),o=this.getUiSelectionAreaMarker();if(o&&o.getVisible()){var s=this.getUiSelectionAreaContainerBox();e.ObjUtils.isUnset(r)&&(r=this.getEditorConfigs().getInteractionConfigs().getSelectionMarkerEdgeInflation());var l=r/2||0,d=n.substract({x:s.x1,y:s.y1},{x:l,y:l}),u=n.add({x:s.x2,y:s.y2},{x:l,y:l});if(a.x<d.x||a.y<d.y||a.x>u.x||a.y>u.y)return i.OUTSIDE;var c=n.substract(a,d),h=n.substract(u,a),m=c.x,g=h.x,f=c.y,p=h.y;return f<p?m<g?f<=r?m<=r?i.CORNER_TL:i.EDGE_TOP:m<=r?i.EDGE_LEFT:i.INSIDE:f<=r?g<=r?i.CORNER_TR:i.EDGE_TOP:g<=r?i.EDGE_RIGHT:i.INSIDE:m<g?p<=r?m<=r?i.CORNER_BL:i.EDGE_BOTTOM:m<=r?i.EDGE_LEFT:i.INSIDE:p<=r?g<=r?i.CORNER_BR:i.EDGE_BOTTOM:g<=r?i.EDGE_RIGHT:i.INSIDE}return i.OUTSIDE},isCoordInSelectionMarkerBound:function(t){return this.getCoordRegionInSelectionMarker(t)!==e.Editor.BoxRegion.OUTSIDE},getObjSelectedRenderOptions:function(){return this._selectedRenderOptions},_getObjRenderOptionItemAppendMethod:function(t){return this.getRenderType()===e.Render.RendererType.R3D?t.addOverrideRender3DOptionItem:t.addOverrideRenderOptionItem},_getObjRenderOptionItemRemoveMethod:function(t){return this.getRenderType()===e.Render.RendererType.R3D?t.removeOverrideRender3DOptionItem:t.removeOverrideRenderOptionItem},_addSelectRenderOptions:function(e){var t=this.getObjSelectedRenderOptions();if(t){return this._getObjRenderOptionItemAppendMethod(e).apply(e,[t])}return null},_removeSelectRenderOptions:function(e){if(this.getObjSelectedRenderOptions())return this._getObjRenderOptionItemRemoveMethod(e).apply(e,[this.getObjSelectedRenderOptions()]);return null},beginUpdateSelection:function(){this.beginUpdateObject(),--this._objSelectFlag},endUpdateSelection:function(){++this._objSelectFlag,this._objSelectFlag>=0&&this.selectionChanged(),this.endUpdateObject()},isUpdatingSelection:function(){return this._objSelectFlag<0},selectionChanged:function(){if(!this.isUpdatingSelection())return this.notifyPropSet("selection",this.getSelection()),this.invokeEvent("selectionChange"),this.doSelectionChanged()},doSelectionChanged:function(){this.recalcSelectionAreaMarker()},isInSelection:function(e){return!!e&&this.getSelection().indexOf(e)>=0},addObjToSelection:function(t){if(!t)return this;var r=this.getSelection();return e.ArrayUtils.pushUnique(r,t.getNearestSelectableObject()),this._addSelectRenderOptions(t),this.selectionChanged(),this},removeObjFromSelection:function(t,r){if(!t)return this;var i=this.getSelection(),n=t.getNearestSelectableObject&&t.getNearestSelectableObject();e.ArrayUtils.remove(i,t),this._removeSelectRenderOptions(t),n&&(e.ArrayUtils.remove(i,n),this._removeSelectRenderOptions(n));for(var a=i.length-1;a>=0;--a){var o=i[a];o.isChildOf&&(o.isChildOf(t)||n&&o.isChildOf(n))&&this.removeObjFromSelection(o,!0)}return r||this.selectionChanged(),this},deselectAll:function(){var e=this.getSelection();return this.removeFromSelection(e)},select:function(e){this.beginUpdateSelection();try{this.deselectAll(),this.addToSelection(e)}finally{this.endUpdateSelection()}return this},addToSelection:function(e){if(e){var t=a.isArrayValue(e)?e:[e];this.beginUpdateSelection();try{for(var r=0,i=t.length;r<i;++r)this.addObjToSelection(t[r])}finally{this.endUpdateSelection()}return this}},removeFromSelection:function(e){if(e){var t=a.isArrayValue(e)?e:[e];this.beginUpdateSelection();try{for(var r=t.length-1;r>=0;--r)this.removeObjFromSelection(t[r])}finally{this.endUpdateSelection()}return this}},toggleSelectingState:function(e){if(e){var t=a.isArrayValue(e)?e:[e];this.beginUpdateSelection();try{for(var r=0,i=t.length;r<i;++r){var n=t[r],o=n.getNearestSelectableObject&&n.getNearestSelectableObject();this.isInSelection(n)?this.removeObjFromSelection(n):o&&this.isInSelection(o)?this.removeObjFromSelection(o):this.addObjToSelection(n)}}finally{this.endUpdateSelection()}return this}},hasSelection:function(){return!!this.getSelection().length},deleteSelectedObjs:function(){},getObjectsIntersetExtendedPolyline:function(t,r){for(var i=[],n=0,a=t.length;n<a;++n)i.push(this.screenCoordToContext(t[n]));for(var o=[],s=this.getBoundInfoRecorder().getAllRecordedInfoOfContext(this.getObjContext()),l=e.Render.MetaShapeUtils.isIntersectingPolyline,n=0,a=s.length;n<a;++n){var d=s[n],u=d.boundInfo;u&&l(u,i,r)&&o.push(d.obj)}return o},getObjectsInPolygon:function(t,r){for(var i=[],n=0,a=t.length;n<a;++n)i.push(this.screenCoordToContext(t[n]));for(var o=[],s=this.getBoundInfoRecorder().getAllRecordedInfoOfContext(this.getObjContext()),l=r?e.Render.MetaShapeUtils.isIntersectingPolygon:e.Render.MetaShapeUtils.isInsidePolygon,n=0,a=s.length;n<a;++n){var d=s[n],u=d.boundInfo;u&&l(u,i)&&o.push(d.obj)}return o},getObjectsInScreenBox:function(t,r){for(var i=this.screenBoxToContext(t),n=[],a=this.getBoundInfoRecorder().getAllRecordedInfoOfContext(this.getObjContext()),o=r?e.Render.MetaShapeUtils.isIntersectingBox:e.Render.MetaShapeUtils.isInsideBox,s=0,l=a.length;s<l;++s){var d=a[s],u=d.boundInfo;u&&o(u,i)&&n.push(d.obj)}return n},selectObjectsInScreenBox:function(e,t){var r=this.getObjectsInScreenBox(e,t);return r&&r.length&&this.select(r),r},addObjectsInScreenBoxToSelection:function(e,t){var r=this.getObjectsInScreenBox(e,t);return r&&r.length&&this.addToSelection(r),r},removeObjectsInScreenBoxFromSelection:function(e,t){var r=this.getObjectsInScreenBox(e,t);return r&&r.length&&this.removeFromSelection(r),r},toggleSelectingStateOfObjectsInScreenBox:function(e,t){var r=this.getObjectsInScreenBox(e,t);return r&&r.length&&this.toggleSelectingState(r),r},getObjectsContainerBox:function(t,r){for(var i=e.ArrayUtils.toArray(t),n=r||0,a=null,o=0,s=i.length;o<s;++o){var l=i[o],d=this.getBoundInfoRecorder().getBelongedInfos(this.getObjContext(),l);if(d&&d.length)for(var u=0,c=d.length;u<c;++u){var h=d[u],m=h.boundInfo;if(m){n&&(m=e.Render.MetaShapeUtils.inflateShape(m,n));var g=e.Render.MetaShapeUtils.getContainerBox(m);a=a?e.BoxUtils.getContainerBox(a,g):g}}}return a},getSelectionContainerBox:function(e){return this.getObjectsContainerBox(this.getSelection(),e)},isSelectionVisible:function(){var t=this.getSelectionContainerBox();if(t){var r=this.getClientDimension(),i=this.getClientScrollPosition(),n={x1:i.x,y1:i.y,x2:i.x+r.width,y2:i.y+r.height};return e.BoxUtils.hasIntersection(t,n)}return!1},getObjSize:function(e){return this.doGetObjSize(e)},doGetObjSize:function(e){var t=this.getCoordMode();return e.getSizeOfMode?e.getSizeOfMode(t):null},setObjSize:function(e,t){this.doSetObjSize(e,t),this.objectChanged(e)},doSetObjSize:function(e,t){e.setSizeOfMode&&e.setSizeOfMode(t,this.getCoordMode())},getObjCoord:function(e,t){return this.doGetObjCoord(e,t)},doGetObjCoord:function(t,r){if(!t)return null;var i=this.getCoordMode(),n=this.getAllowCoordBorrow(),a=t.getAbsBaseCoord?t.getAbsBaseCoord(i,n):t.getAbsCoordOfMode?t.getAbsCoordOfMode(i,n):t.getCoordOfMode?t.getCoordOfMode(i,n):null;if(i===e.CoordMode.COORD2D&&e.ObjUtils.notUnset(r)){if(r!==e.Render.CoordPos.DEFAULT){var n=this.getAllowCoordBorrow(),o=t.getExposedContainerBox?t.getExposedContainerBox(i,n):t.getContainerBox?t.getContainerBox(i,n):null;if(o&&r===e.Render.CoordPos.CORNER_TL){var s={x:(o.x2-o.x1)/2,y:(o.y2-o.y1)/2};a.x=a.x-s.x,a.y=a.y+s.y}}}return a},setObjCoord:function(e,t,r){this.doSetObjCoord(e,t,r),this.objectChanged(e)},doSetObjCoord:function(t,r,i){var n=Object.create(r),a=this.getCoordMode();if(a===e.CoordMode.COORD2D&&e.ObjUtils.notUnset(i)){if(i!==e.Render.CoordPos.DEFAULT){var o=this.getAllowCoordBorrow(),s=t.getExposedContainerBox?t.getExposedContainerBox(a,o):t.getContainerBox?t.getContainerBox(a,o):null;if(s){var l={x:(s.x2-s.x1)/2,y:(s.y2-s.y1)/2};i===e.Render.CoordPos.CORNER_TL&&(n.x=r.x+l.x,n.y=r.y-l.y)}}}t.setAbsBaseCoord?t.setAbsBaseCoord(n,a):t.setAbsCoordOfMode?t.setAbsCoordOfMode(n,a):t.setAbsCoordOfMode&&t.setCoordOfMode(n,a)},getObjectContextCoord:function(e,t){var r=this.getObjCoord(e,t);return this.objCoordToContext(r)},setObjectContextCoord:function(e,t,r){var i=this.contextCoordToObj(t);i&&this.setObjCoord(e,i,r)},getObjectScreenCoord:function(e,t){var r=this.getObjCoord(e,t);return this.objCoordToScreen(r)},setObjectScreenCoord:function(e,t,r){var i=this.screenCoordToObj(t);i&&this.setObjCoord(e,i,r)},getCoord:function(t,r,i){var n=this.getObjCoord(t,i);return this.translateCoord(n,e.Editor.CoordSys.OBJ,r)},setCoord:function(t,r,i,n){var a=this.translateCoord(r,i,e.Editor.CoordSys.OBJ);this.setObjCoord(t,a,n)},getSize:function(t,r){var i=this.getObjSize(t);return this.translateCoord(i,e.Editor.CoordSys.OBJ,r)},setSize:function(t,r,i){var n=this.translateCoord(r,i,e.Editor.CoordSys.OBJ);this.setObjSize(t,n)},translateCoord:function(t,r,i){if(!t)return null;var n=e.Editor.CoordSys;if(r===n.SCREEN){if(i===n.SCREEN)return t;if(i===n.CONTEXT)return this.getObjDrawBridge().transformScreenCoordToContext(this.getObjContext(),t);var a=this.getObjDrawBridge().transformScreenCoordToContext(this.getObjContext(),t);return this.getRootRenderer().transformCoordToObj(this.getObjContext(),this.getChemObj(),a)}if(r===n.CONTEXT)return i===n.SCREEN?this.getObjDrawBridge().transformContextCoordToScreen(this.getObjContext(),t):i===n.CONTEXT?t:this.getRootRenderer().transformCoordToObj(this.getObjContext(),this.getChemObj(),t);if(i===n.SCREEN){var a=this.getRootRenderer().transformCoordToContext(this.getObjContext(),this.getChemObj(),t);return this.getObjDrawBridge().transformContextCoordToScreen(this.getObjContext(),a)}return i===n.CONTEXT?this.getRootRenderer().transformCoordToContext(this.getObjContext(),this.getChemObj(),t):t},translateDistance:function(t,r,i){var n={x:0,y:0,z:0},a={x:t,y:0,z:0},o=this.translateCoord(n,r,i),s=this.translateCoord(a,r,i);return e.CoordUtils.getDistance(o,s)},transformCoordAndSizeOfObjects:function(t,r){var i=this.getCoordMode(),n=this.getAllowCoordBorrow(),a=i===e.CoordMode.COORD3D?e.CoordUtils.calcTransform3DMatrix(r):e.CoordUtils.calcTransform2DMatrix(r),o=Object.extend({},r);o=Object.extend(o,{translateX:0,translateY:0,translateZ:0,center:{x:0,y:0,z:0}});for(var s=i===e.CoordMode.COORD3D?e.CoordUtils.calcTransform3DMatrix(o):e.CoordUtils.calcTransform2DMatrix(o),l=0,d=t.length;l<d;++l){var u=t[l];u.transformAbsCoordByMatrix(a,s,i,!0,n),u.scaleSize(r.scale,i,!0,n)}},objCoordToContext:function(t){var r=e.Editor.CoordSys;return this.translateCoord(t,r.OBJ,r.CONTEXT)},contextCoordToObj:function(t){var r=e.Editor.CoordSys;return this.translateCoord(t,r.CONTEXT,r.OBJ)},objCoordToScreen:function(t){var r=e.Editor.CoordSys;return this.translateCoord(t,r.OBJ,r.SCREEN)},screenCoordToObj:function(t){var r=e.Editor.CoordSys;return this.translateCoord(t,r.SCREEN,r.OBJ)},screenCoordToContext:function(t){var r=e.Editor.CoordSys;return this.translateCoord(t,r.SCREEN,r.CONTEXT)},contextCoordToScreen:function(t){var r=e.Editor.CoordSys;return this.translateCoord(t,r.CONTEXT,r.SCREEN)},screenBoxToContext:function(e){var t=this.screenCoordToContext({x:e.x1,y:e.y1}),r=this.screenCoordToContext({x:e.x2,y:e.y2});return{x1:t.x,y1:t.y,x2:r.x,y2:r.y}},createDefaultNode:function(t,r,i){var n=this.getEditorConfigs().getStructureConfigs().getDefIsotopeId(),a=new e.Atom;return a.setIsotopeId(n),i&&i.appendNode(a),this.setCoord(a,t,r),a},operationDone:function(e){this.doOperationDone(e)},doOperationDone:function(e){},clearOperHistory:function(){var e=this.getOperHistory();e&&e.clear()},pushOperation:function(e,t){if(e){var r=this.getOperHistory();if(r&&r.push(e),this.getOperationsInCurrManipulation().push(e),t){this.beginUpdateObject();try{e.execute()}finally{this.endUpdateObject()}}}},popOperation:function(e){var t,r=this.getOperHistory();if(r){if(t=r.pop(),e){this.beginUpdateObject();try{t.reverse()}finally{this.endUpdateObject()}}var i=this.getOperationsInCurrManipulation(),n=i.indexOf(t);return n>=0&&i.splice(n,1),t}return null},execOperation:function(e){var t=r.toArray(e);this.beginManipulateAndUpdateObject();try{for(var i=0,n=t.length;i<n;++i){var a=t[i];a.execute(),this.getEnableOperHistory()&&this.pushOperation(a,!1)}}finally{this.endManipulateAndUpdateObject()}return this},replaceOperationInHistory:function(e,t){var r=this.getOperHistory();return r&&r.replaceOperation(e,t)},undo:function(){var e,t=this.getOperHistory();if(t){this.beginUpdateObject();try{e=t.undo()}finally{this.endUpdateObject(),e&&this.operationDone(e)}this._removeOrphans("undo")}return e},redo:function(){var e,t=this.getOperHistory();if(t){this.beginUpdateObject();try{e=t.redo()}finally{this.endUpdateObject(),e&&this.operationDone(e)}this._removeOrphans("redo")}return e},_removeOrphans:function(e){var t=this.getChemSpace();if(t){var r=t.getChildren().filter(function(e){return"Kekule.Glyph.PathGlyphArcConnectorControlNode"===e.CLASS_NAME}),i=!0,n=!1,a=void 0;try{for(var o,s=r[Symbol.iterator]();!(i=(o=s.next()).done);i=!0){var l=o.value;l.getParent().removeChild(l)}}catch(e){n=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(n)throw a}}}},undoAll:function(){var e,t=this.getOperHistory();if(t){this.beginUpdateObject();try{e=t.undoAll()}finally{this.endUpdateObject()}}return e},canUndo:function(){var e=this.getOperHistory();return!!e&&e.canUndo()},canRedo:function(){var e=this.getOperHistory();return!!e&&e.canRedo()},modifyObjects:function(t,r,i){var n=e.ArrayUtils.toArray(t);try{for(var a=new e.MacroOperation,o=0,s=n.length;o<s;++o){var l=n[o],d=new e.ChemObjOperation.Modify(l,r,this);a.add(d)}a.execute()}finally{i&&this.getEnableOperHistory()&&a.getChildCount()&&this.pushOperation(a)}return this},modifyObjectsRenderOptions:function(t,r,i,n){var a=e.ArrayUtils.toArray(t),o=i?"render3DOptions":"renderOptions",s=i?"getRender3DOptions":"getRenderOptions";try{for(var l=new e.MacroOperation,d=0,u=a.length;d<u;++d){var c=a[d];if(c[s]){var h=c[s](),m=Object.extend({},h);m=Object.extend(m,r);var g={};g[o]=m;var f=new e.ChemObjOperation.Modify(c,g,this);l.add(f)}}this.beginManipulateAndUpdateObject(),l.execute()}finally{n&&this.getEnableOperHistory()&&l.getChildCount()&&this.pushOperation(l),this.endManipulateAndUpdateObject()}return this},getClientDimension:function(){var e=this.getElement();return{width:e.clientWidth,height:e.clientHeight}},getClientScrollPosition:function(){var e=this.getEditClientElem().parentNode;return e?{x:e.scrollLeft,y:e.scrollTop}:null},getClientScrollCoord:function(r){var i=this.getClientScrollPosition();return t.isUnset(r)||r===e.Editor.CoordSys.SCREEN?i:this.translateCoord(i,e.Editor.CoordSys.SCREEN,r)},getClientVisibleRect:function(){var e=this.getClientDimension(),t=this.getClientScrollPosition();return e.x1=e.left=t.x,e.y1=e.top=t.y,e.x2=e.x1+e.width,e.y2=e.y1+e.height,e},scrollClientTo:function(e,t){return this.scrollClientToCoord({y:e,x:t})},scrollClientToTop:function(){return this.scrollClientTo(0,null)},scrollClientToBottom:function(){var t=this.getEditClientElem(),r=e.HtmlElementUtils.getElemClientDimension(t);return this.scrollClientTo(r.height,null)},scrollClientToCoord:function(r,i,n){var a,o=t.notUnset(r.x),s=t.notUnset(r.y),l=n&&n.scrollToCenter;if(a=t.isUnset(i)?r:this.translateCoord(r,i,e.Editor.CoordSys.SCREEN),l){var d=this.getVisibleClientScreenBox(),u={x:d.width/2,y:d.height/2};a=e.CoordUtils.substract(a,u)}var c=this.getEditClientElem().parentNode;return s&&(c.scrollTop=a.y),o&&(c.scrollLeft=a.x),this},scrollClientToObject:function(t,i){e.BoxUtils;if(!t)return this;var n=this.getChemObj();if(!n)return this;var a=r.toArray(t),o=this._getTargetObjsExposedContainerBoxInfo(a,n),s=o.totalBox,l=o.boxes;if(s){var d=Object.extend({scrollToCenter:!0,coverMostObjs:!0},i||{});return this._scrollClientToContainerBox(s,l,d)}return this},_scrollClientToContainerBox:function(t,r,i){var n,a=e.BoxUtils,o=this.getVisibleClientBoxOfSys(e.Editor.CoordSys.CHEM);n=(t.x2-t.x1>o.x2-o.x1||t.y2-t.y1>o.y2-o.y1)&&i.coverMostObjs?this._getMostIntersectedContainerBox(o.x2-o.x1,o.y2-o.y1,r,t):t;var s=i.scrollToCenter?a.getCenterCoord(n):{x:n.x1,y:n.y2};return this.scrollClientToCoord(s,e.Editor.CoordSys.CHEM,i)},_getTargetObjsExposedContainerBoxInfo:function(t,r){var i=e.BoxUtils;if(r||(r=this.getChemObj()),r)for(var n=null,a=[],o=0,s=t.length;o<s;++o){var l=t[o];if(l.getExposedContainerBox&&l.isChildOf&&l.isChildOf(r)){var d=l.getExposedContainerBox(this.getCoordMode());d&&(a.push(d),n=n?i.getContainerBox(n,d):d)}}return{totalBox:n,boxes:a}},_getMostIntersectedContainerBox:function(t,r,i,n){for(var a,o=e.BoxUtils,l=function(e,i){var a=s.add(e,{x:t*i.x,y:r*i.y});a.x<n.x1?a.x=n.x1:a.x>n.x2&&(a.x=n.x2),a.y<n.y1?a.y=n.y1:a.y>n.y2&&(a.y=n.y2);var l=s.add(a,{x:-t*i.x,y:-r*i.y});return o.createBox(l,a)},d=0,u=0,c=i.length;u<c;++u)for(var h=o.getCornerCoords(i[u]),m=[l(h[0],{x:1,y:1}),l(h[1],{x:1,y:-1}),l(h[2],{x:-1,y:1}),l(h[3],{x:-1,y:-1})],g=0,f=m.length;g<f;++g){var p=function(e,t){for(var r=0,i=0,n=t.length;i<n;++i){var a=t[i];o.hasIntersection(a,e)&&++r}return r}(m[g],i);p>d&&(d=p,a=m[g])}return a},doBeforeDispatchUiEvent:function($super,e){return["pointerdown","pointermove","pointerup"].indexOf(e.getType())>=0&&this.setCurrPointerType(e.pointerType),$super(e)}}),e.Editor.BaseEditor.Settings=i.create(e.ChemWidget.ChemObjDisplayer.Settings,{CLASS_NAME:"Kekule.Editor.BaseEditor.Settings",initProperties:function(){this.defineProp("enableCreateNewDoc",{dataType:a.BOOL,serializable:!1,getter:function(){return this.getEditor().getEnableCreateNewDoc()},setter:function(e){this.getEditor().setEnableCreateNewDoc(e)}}),this.defineProp("initOnNewDoc",{dataType:a.BOOL,serializable:!1,getter:function(){return this.getEditor().getInitOnNewDoc()},setter:function(e){this.getEditor().setInitOnNewDoc(e)}}),this.defineProp("enableOperHistory",{dataType:a.BOOL,serializable:!1,getter:function(){return this.getEditor().getEnableOperHistory()},setter:function(e){this.getEditor().setEnableOperHistory(e)}})},getEditor:function(){return this.getDisplayer()}}),e.Editor.IaControllerManager={_controllerMap:new e.MapEx(!0),register:function(e,t){u._controllerMap.set(e,t)},unregister:function(e){u._controllerMap.remove(e)},getAllControllerClasses:function(){return u._controllerMap.getKeys()},getAvailableControllerClasses:function(e){for(var t=[],r=u.getAllControllerClasses(),i=0,a=r.length;i<a;++i){var o=r[i],s=u._controllerMap.get(o);s&&!n.isOrIsDescendantOf(e,s)||t.push(o)}return t}};var u=e.Editor.IaControllerManager;return e.Editor.BaseEditorIaController=i.create(e.Widget.InteractionController,{CLASS_NAME:"Kekule.Editor.BaseEditorIaController",initialize:function($super,e){$super(e)},initProperties:function(){this.defineProp("manuallyHotTrack",{dataType:a.BOOL,serializable:!1}),this.defineProp("currBoundInflation",{dataType:a.NUMBER,serializable:!1,getter:function(){return this.getEditor().getCurrBoundInflation()},setter:null}),this.defineProp("activePointerType",{dataType:a.BOOL,serializable:!1,getter:function(){var e=this.getEditor();return e&&e.getCurrPointerType()||this.getPropStoreFieldValue("activePointerType")},setter:function(e){var t=this.getEditor();t?t.setCurrPointerType(e):this.setStoreFieldValue("activePointerType",e)}})},getDefId:function(){return e.ClassUtils.getLastClassName(this.getClassName())},getEditor:function(){return this.getWidget()},setEditor:function(e){return this.setWidget(e)},getEditorConfigs:function(){var e=this.getEditor();return e?e.getEditorConfigs():null},getInteractionBoundInflation:function(e){return this.getEditor().getInteractionBoundInflation(e)},handleUiEvent:function($super,t){var r=!1,i=t.getTarget&&t.getTarget()||t.target,n=this.getEditor().getUiEventReceiverElem();n?(i===n||e.DomUtils.isDescendantOf(i,n))&&(r=!0):r=!0,r&&$super(t)},canInteractWithObj:function(e){return!!e},getInteractableTargetClasses:function(){return null},getAllInteractableObjsAtScreenCoord:function(e){return this.getEditor().getBasicObjectsAtCoord(e,this.getCurrBoundInflation(),null,this.getInteractableTargetClasses())},getTopmostInteractableObjAtScreenCoord:function(e){var t=this.getAllInteractableObjsAtScreenCoord(e);if(t)for(var r=0,i=t.length;r<i;++r)if(this.canInteractWithObj(t[r]))return t[r];return null},hotTrackOnObj:function(e){this.getEditor().hotTrackOnObj(e)},zoomEditor:function(e,t){e>0?this.getEditor().zoomIn(e,t):e<0&&this.getEditor().zoomOut(-e,t)},_filterBasicObjectsInEditor:function(e){for(var t=this.getEditor(),r=t.getChemObj(),i=[],n=0,a=e.length;n<a;++n){var o=e[n];o.isChildOf(r)&&i.push(o)}return i},doneInsertOrModifyBasicObjects:function(e){if(this.needAutoSelectNewlyInsertedObjects()){var t=this._filterBasicObjectsInEditor(e);this.getEditor().select(t)}},needAutoSelectNewlyInsertedObjects:function(){var e=this.getActivePointerType(),t=this.getEditorConfigs().getInteractionConfigs();return t.getAutoSelectNewlyInsertedObjectsOnTouch()&&"touch"===e||t.getAutoSelectNewlyInsertedObjects()},react_pointerdown:function(e){return this.setActivePointerType(e.pointerType),e.preventDefault(),!0},react_pointermove:function(e){var t=this._getEventMouseCoord(e),r=this.getTopmostInteractableObjAtScreenCoord(t);return this.getManuallyHotTrack()||(r?this.hotTrackOnObj(r):this.hotTrackOnObj(null)),e.preventDefault(),!0},react_mousewheel:function(e){if(e.getCtrlKey()){var t=this._getEventMouseCoord(e);try{var r=e.wheelDeltaY||e.wheelDelta;r&&(r/=120),this.zoomEditor(r,t)}finally{}return e.preventDefault(),!0}},_getEventMouseCoord:function($super,e,t){return $super(e,t||this.getWidget().getCoreElement())}}),e.Editor.ClientDragScrollIaController=i.create(e.Editor.BaseEditorIaController,{CLASS_NAME:"Kekule.Editor.ClientDragScrollIaController",initialize:function($super,e){$super(e),this._isExecuting=!1},canInteractWithObj:function(e){return!1},doTestMouseCursor:function(e,t){return this.isExecuting()?["grabbing","-webkit-grabbing","-moz-grabbing","move"]:["grab","-webkit-grab","-moz-grab","pointer"]},isExecuting:function(){return this._isExecuting},startScroll:function(e){this._startCoord=e,this._originalScrollPos=this.getEditor().getClientScrollPosition(),this._isExecuting=!0},endScroll:function(){this._isExecuting=!1,this._startCoord=null,this._originalScrollPos=null},scrollTo:function(t){if(this.isExecuting()){var r=this._startCoord,i=e.CoordUtils.substract(r,t),n=e.CoordUtils.add(this._originalScrollPos,i);this.getEditor().scrollClientTo(n.y,n.x)}},react_pointerdown:function(t){if(this.setActivePointerType(t.pointerType),t.getButton()===e.X.Event.MouseButton.LEFT){if(!this.isExecuting()){var r={x:t.getScreenX(),y:t.getScreenY()};this.startScroll(r),t.preventDefault()}}else t.getButton()===e.X.Event.MouseButton.RIGHT&&this.isExecuting()&&(this.endScroll(),t.preventDefault())},react_pointerup:function(t){t.getButton()===e.X.Event.MouseButton.LEFT&&this.isExecuting()&&(this.endScroll(),t.preventDefault())},react_pointermove:function($super,e){if($super(e),this.isExecuting()){var t={x:e.getScreenX(),y:e.getScreenY()};this.scrollTo(t),e.preventDefault()}return!0}}),e.Editor.IaControllerManager.register(e.Editor.ClientDragScrollIaController,e.Editor.BaseEditor),e.Editor.BasicEraserIaController=i.create(e.Editor.BaseEditorIaController,{CLASS_NAME:"Kekule.Editor.BasicEraserIaController",initialize:function($super,e){$super(e),this._isExecuting=!1},canInteractWithObj:function(e){return!!e},removeObjs:function(e){if(e&&e.length){var t=this.getEditor();t.beginUpdateObject();try{var r=this.doGetActualRemovedObjs(e);this.doRemoveObjs(r)}finally{t.endUpdateObject()}}},doRemoveObjs:function(e){},doGetActualRemovedObjs:function(e){return e},removeSelection:function(){var e=this.getEditor();this.removeObjs(e.getSelection()),e.deselectAll()},removeOnScreenCoord:function(e){var t=this.getEditor().getTopmostBasicObjectAtCoord(e);return!!t&&(this.removeObjs([t]),!0)},startRemove:function(){this._isExecuting=!0},endRemove:function(){this._isExecuting=!1},isRemoving:function(){return this._isExecuting},reactUiEvent:function($super,e){var t=$super(e);return["touchstart","touchend","touchcancel","touchmove"].indexOf(e.getType())>=0&&e.preventDefault(),t},react_pointerdown:function(t){if(this.setActivePointerType(t.pointerType),t.getButton()===e.X.Event.MOUSE_BTN_LEFT){this.startRemove();var r=this._getEventMouseCoord(t);this.removeOnScreenCoord(r),t.preventDefault()}else t.getButton()===e.X.Event.MOUSE_BTN_RIGHT&&(this.endRemove(),t.preventDefault())},react_pointerup:function(t){t.getButton()===e.X.Event.MOUSE_BTN_LEFT&&(this.endRemove(),t.preventDefault())},react_pointermove:function($super,e){if($super(e),this.isRemoving()){var t=this._getEventMouseCoord(e);this.removeOnScreenCoord(t),e.preventDefault()}return!0}}),e.Editor.IaControllerManager.register(e.Editor.BasicEraserIaController,e.Editor.BaseEditor),e.Editor.BasicManipulationIaController=i.create(e.Editor.BaseEditorIaController,{CLASS_NAME:"Kekule.Editor.BasicManipulationIaController",initialize:function($super,t){$super(t),this.setState(e.Editor.BasicManipulationIaController.State.NORMAL),this.setEnableSelect(!1),this.setEnableGestureManipulation(!1),this.setEnableMove(!0),this.setEnableResize(!0),this.setEnableAspectRatioLockedResize(!0),this.setEnableRotate(!0),this._suppressConstrainedResize=!1,this._manipulationStepBuffer={},this._suspendedOperations=null,this.execManipulationStepBind=this.execManipulationStep.bind(this)},initProperties:function(){this.defineProp("selectMode",{dataType:a.INT,serializable:!1}),this.defineProp("enableSelect",{dataType:a.BOOL,serializable:!1}),this.defineProp("enableMove",{dataType:a.BOOL,serializable:!1}),this.defineProp("enableResize",{dataType:a.BOOL,serializable:!1}),this.defineProp("enableRotate",{dataType:a.BOOL,serializable:!1}),this.defineProp("enableGestureManipulation",{dataType:a.BOOL,serializable:!1}),this.defineProp("state",{dataType:a.INT,serializable:!1}),this.defineProp("baseCoord",{dataType:a.HASH,serializable:!1}),this.defineProp("startCoord",{dataType:a.HASH,serializable:!1}),this.defineProp("endCoord",{dataType:a.HASH,serializable:!1}),this.defineProp("startBox",{dataType:a.HASH,serializable:!1}),this.defineProp("endBox",{dataType:a.HASH,serializable:!1}),this.defineProp("lastRotateAngle",{dataType:a.FLOAT,serializable:!1}),this.defineProp("rotateRefCoord",{dataType:a.HASH,serializable:!1}),this.defineProp("rotateCenter",{dataType:a.HASH,serializable:!1,getter:function(){var e=this.getPropStoreFieldValue("rotateCenter");if(!e){var t=this._getManipulateObjsCenterCoord();e=this.getEditor().objCoordToScreen(t),this.setPropStoreFieldValue("rotateCenter",e)}return e}}),this.defineProp("resizeStartingRegion",{dataType:a.INT,serializable:!1}),this.defineProp("enableAspectRatioLockedResize",{dataType:a.BOOL,serializable:!1}),this.defineProp("rotateStartingRegion",{dataType:a.INT,serializable:!1}),this.defineProp("manipulateOriginObjs",{dataType:a.ARRAY,serializable:!1}),this.defineProp("manipulateObjs",{dataType:a.ARRAY,serializable:!1,setter:function(e){this.setPropStoreFieldValue("manipulateObjs",e),e?this.getEditor().prepareOperatingObjs(e):this.getEditor().endOperatingObjs()}}),this.defineProp("manipulateObjInfoMap",{dataType:a.OBJECT,serializable:!1,setter:null,getter:function(){var t=this.getPropStoreFieldValue("manipulateObjInfoMap");return t||(t=new e.MapEx(!0),this.setPropStoreFieldValue("manipulateObjInfoMap",t)),t}}),this.defineProp("manipulateObjCurrInfoMap",{dataType:a.OBJECT,serializable:!1,setter:null,getter:function(){var t=this.getPropStoreFieldValue("manipulateObjCurrInfoMap");return t||(t=new e.MapEx(!0),this.setPropStoreFieldValue("manipulateObjCurrInfoMap",t)),t}}),this.defineProp("manipulationType",{dataType:a.INT,serializable:!1}),this.defineProp("isManipulatingSelection",{dataType:a.BOOL,serializable:!1}),this.defineProp("isOffsetManipulating",{dataType:a.BOOL,serializable:!1}),this.defineProp("manipulationPointerType",{dataType:a.BOOL,serializable:!1,getter:function(){return this.getActivePointerType()},setter:function(e){this.setActivePointerType(e)}}),this.defineProp("moveOperations",{dataType:a.ARRAY,serializable:!1}),this.defineProp("moveWrapperOperation",{dataType:a.OBJECT,serializable:!1}),this.defineProp("objOperationMap",{dataType:"Kekule.MapEx",serializable:!1,getter:function(){var t=this.getPropStoreFieldValue("objOperationMap");return t||(t=new e.MapEx(!0),this.setPropStoreFieldValue("objOperationMap",t)),t}})},doFinalize:function($super){var e=this.getPropStoreFieldValue("manipulateObjInfoMap");e&&e.clear(),e=this.getPropStoreFieldValue("objOperationMap"),e&&e.clear(),$super()},hotTrackOnObj:function($super,t){if(this.getEnableSelect()&&this.getSelectMode()===e.Editor.SelectMode.ANCESTOR){var r=this.getStandaloneAncestor(t);return t&&t.getStandaloneAncestor&&t.getStandaloneAncestor(),$super(r)}return $super(t)},getStandaloneAncestor:function(e){return e&&e.getStandaloneAncestor?e.getStandaloneAncestor():e},isInAncestorSelectMode:function(){return this.getEnableSelect()&&this.getSelectMode()===e.Editor.SelectMode.ANCESTOR},isAspectRatioLockedResize:function(){return this.getEnableAspectRatioLockedResize()&&!this._suppressConstrainedResize},getCoordOnSelectionRotationRegion:function(t){var r=e.Editor.BoxRegion,i=this.getEditor();if(i.getCoordRegionInSelectionMarker(t)!==r.OUTSIDE)return!1;var n=i.getEditorConfigs().getInteractionConfigs().getRotationRegionInflation(),a=i.getUiSelectionAreaContainerBox();if(a&&i.hasSelection()){for(var o=[r.CORNER_TL,r.CORNER_TR,r.CORNER_BR,r.CORNER_BL],s=[{x:a.x1,y:a.y1},{x:a.x2,y:a.y1},{x:a.x2,y:a.y2},{x:a.x1,y:a.y2}],l=!1,d=n,u=0,c=o.length;u<c;++u){var h=o[u],m=s[u],g=e.CoordUtils.getDistance(m,t);g<=d&&(l=h,d=g)}return l}return!1},createManipulateOperation:function(){return this.doCreateManipulateMoveAndResizeOperation()},doCreateManipulateMoveAndResizeOperation:function(){var t=[];this.setMoveOperations(t);var r=this.getManipulateObjs(),i=this.getManipulateObjInfoMap();this.getObjOperationMap().clear();var n=[],a=new e.ChemObjOperation.MoveAndResizeObjs([],n,this.getEditor().getCoordMode(),!0,this.getEditor());a.setDisableIndirectCoord(!0);for(var o=0,s=r.length;o<s;++o){var l=r[o],d=i.get(l),u=new e.ChemObjOperation.MoveAndResize(l,null,null,this.getEditor().getCoordMode(),!0,this.getEditor());u.setAllowCoordBorrow(this.getEditor().getAllowCoordBorrow()),u.setOldCoord(d.objCoord),u.setOldDimension(d.size),t.push(u),a.getChildOperations().push(u),this.setMoveWrapperOperation(a)}return[a]},updateChildMoveOperation:function(e,t,r){this.getMoveOperations()[e].setNewCoord(r)},updateChildResizeOperation:function(e,t,r){this.getMoveOperations()[e].setNewDimension(r)},getAllObjOperations:function(t){var r=this.getMoveOperations(),i=r?e.ArrayUtils.clone(r):[];if(i.length){var n=this.getMoveWrapperOperation();return n.setChildOperations(i),[n]}return[]},getActiveOperation:function(t){var r=this.getAllObjOperations(t);return r=e.ArrayUtils.toUnique(r),r.length<=0?null:1===r.length?r[0]:new e.MacroOperation(r)},reverseActiveOperation:function(){return this.getActiveOperation().reverse()},addOperationToEditor:function(){var e=this.getEditor();if(e&&e.getEnableOperHistory()){var t=this.getActiveOperation(!0);t&&e.pushOperation(t)}},getCurrAvailableManipulationTypes:function(){var t=e.Editor.BasicManipulationIaController.ManipulationType,r=this.getEditor().getSelectionContainerBox();if(r){var i=[];return this.getEnableMove()&&i.push(t.MOVE),e.NumUtils.isFloatEqual(r.x1,r.x2,1e-10)&&e.NumUtils.isFloatEqual(r.y1,r.y2,1e-10)||(this.getEnableResize()&&i.push(t.RESIZE),this.getEnableRotate()&&i.push(t.ROTATE),(this.getEnableResize()||this.getEnableRotate())&&i.push(t.TRANSFORM)),i}return[]},getActualManipulatingObjects:function(t){for(var r=[],i=0,n=t.length;i<n;++i){var a=t[i],o=a.getCoordDependentObjects?a.getCoordDependentObjects():[a];e.ArrayUtils.pushUnique(r,o)}return r},doPrepareManipulatingObjects:function(e,t){var r=this.getActualManipulatingObjects(e);this.setManipulateOriginObjs(e),this.setManipulateObjs(r);var i=this.getManipulateObjInfoMap();i.clear();for(var n=(this.getEditor(),0),a=r.length;n<a;++n){var o=r[n],s=this.createManipulateObjInfo(o,n,t);i.set(o,s)}},doPrepareManipulatingStartingCoords:function(e,t,r,i){this.setStartBox(t),this.setRotateCenter(r),this.setRotateRefCoord(i),this.setLastRotateAngle(null)},prepareManipulating:function(e,t,r,i,n,a){this.setManipulationType(e),this.doPrepareManipulatingObjects(t,r),this.doPrepareManipulatingStartingCoords(r,i,n,a),this.createManipulateOperation(),this._runManipulationStepId=window.requestAnimationFrame(this.execManipulationStepBind)},cancelManipulate:function(){this.getEditor(),this.getManipulateObjs();this.reverseActiveOperation(),this.notifyCoordChangeOfObjects(this.getManipulateObjs()),this.manipulateEnd()},_getManipulateObjsCenterCoord:function(){var t=this.getManipulateObjs();if(!t||!t.length)return null;for(var r=this.getEditor().getCoordMode(),i=this.getEditor().getAllowCoordBorrow(),n={x:0,y:0,z:0},a=0,o=t.length;a<o;++a){var s=t[a],l=s.getAbsBaseCoord?s.getAbsBaseCoord(r,i):s.getAbsCoord?s.getAbsCoord(r,i):s.getCoordOfMode?s.getCoordOfMode(r,i):null;l&&(n=e.CoordUtils.add(n,l))}return e.CoordUtils.divide(n,t.length)},_maniplateObjsFrameEnd:function(e){},_addManipultingObjNewInfo:function(e,t){var r=this.getManipulateObjCurrInfoMap(),i=r.get(e)||{};i=Object.extend(i,t),r.set(e,i)},applyManipulatingObjsInfo:function(e){var t=this.getManipulateObjs(),r=this.getManipulateObjCurrInfoMap(),i=this._getIndirectCoordObjs(t);this._setEnableIndirectCoordOfObjs(i,!1);try{for(var n=0,a=t.length;n<a;++n){var o=t[n],s=r.get(o);this.applySingleManipulatingObjInfo(n,o,s,e)}}finally{this._setEnableIndirectCoordOfObjs(i,!0)}},_getIndirectCoordObjs:function(e){for(var t=[],r=0,i=e.length;r<i;++r){var n=e[r];n.getEnableIndirectCoord&&n.getEnableIndirectCoord()&&t.push(n)}return t},_setEnableIndirectCoordOfObjs:function(e,t){if(e)for(var r=0,i=e.length;r<i;++r)e[r].setEnableIndirectCoord(t)},applySingleManipulatingObjInfo:function(e,t,r,i){r&&(r.screenCoord&&this.doMoveManipulatedObj(e,t,r.screenCoord,i),r.size&&this.doResizeManipulatedObj(e,t,r.size))},_calcRotateAngle:function(t){var r,i=e.CoordUtils,n=!1,a=this.getRotateCenter(),o=this.getRotateRefCoord()||this.getStartCoord(),s=this.getEditorConfigs().getInteractionConfigs().getRotationLocationPointDistanceThreshold();if(s){if(i.getDistance(o,a)<s)return r=0,n=!0,this.setStartCoord(t),!1;if(i.getDistance(t,a)<s)return r=0,n=!0,!1}if(!n){var l=i.substract(t,a),d=Math.atan2(l.y,l.x);l=i.substract(o,a);var u=Math.atan2(l.y,l.x);r=d-u}return{angle:r,startAngle:u,endAngle:d}},_calcActualRotateAngle:function(e,t,r,i){return t},_calcManipulateObjsRotationParams:function(t,r){if(!this.getEnableRotate())return!1;var i=this.getRotateCenter(),n=this._calcRotateAngle(r);if(!n)return!1;var a=this._calcActualRotateAngle(t,n.angle,n.startAngle,n.endAngle),o=this.getLastRotateAngle();return(!e.ObjUtils.notUnset(o)||!e.NumUtils.isFloatEqual(a,o,.0175))&&(this.setLastRotateAngle(a),{center:i,rotateAngle:a})},_calcActualResizeScales:function(e,t){return t},_calcManipulateObjsResizeParams:function(t,r,i){if(!this.getEnableResize())return!1;var n,a,o=e.Editor.BoxRegion,s=e.CoordUtils,l=this.getStartBox(),d=s.substract(i,this.getStartCoord());r===o.EDGE_TOP?(d.x=0,n={x:(l.x1+l.x2)/2,y:l.y2}):r===o.EDGE_BOTTOM?(d.x=0,n={x:(l.x1+l.x2)/2,y:l.y1}):r===o.EDGE_LEFT?(d.y=0,n={x:l.x2,y:(l.y1+l.y2)/2}):r===o.EDGE_RIGHT?(d.y=0,n={x:l.x1,y:(l.y1+l.y2)/2}):(this.isAspectRatioLockedResize()&&(a=!0),n=r===o.CORNER_TL?{x:l.x2,y:l.y2}:r===o.CORNER_TR?{x:l.x1,y:l.y2}:r===o.CORNER_BL?{x:l.x2,y:l.y1}:{x:l.x1,y:l.y1});var u,c,h=r===o.CORNER_TL||r===o.CORNER_BL||r===o.EDGE_LEFT,m=r===o.CORNER_TL||r===o.CORNER_TR||r===o.EDGE_TOP;if(u=e.NumUtils.isFloatEqual(l.x1,l.x2,1e-10)?1:1+d.x/(l.x2-l.x1)*(h?-1:1),c=e.NumUtils.isFloatEqual(l.y1,l.y2,1e-10)?1:1+d.y/(l.y2-l.y1)*(m?-1:1),a){var g=Math.abs(u),f=Math.abs(c);g>=f?c=(Math.sign(c)||1)*g:u=(Math.sign(u)||1)*f}var p=this._calcActualResizeScales(t,{scaleX:u,scaleY:c});return{center:n,scaleX:p.scaleX,scaleY:p.scaleY}},_calcManipulateObjsTransformInfo:function(t,r){for(var i=e.CoordUtils,n=i.calcTransform2DMatrix(r),a=r.scaleX||r.scale,o=r.scaleY||r.scale,s=this._isManipulatingSingleStickedObj(t),l=0,d=t.length;l<d;++l){var u=t[l],c=this.getManipulateObjInfoMap().get(u),h={};if(!c.hasNoCoord){var m=c.screenCoord;if(!c.stickTarget||s){var g=i.transform2DByMatrix(m,n);h.screenCoord=g}else h.screenCoord=m}if(c.size&&(a||o)){var f={x:c.size.x*Math.abs(a||1),y:c.size.y*Math.abs(o||1)};h.size=f}this._addManipultingObjNewInfo(u,h)}return!0},_isStickedObj:function(e){return e&&e.getCoordStickTarget&&e.getCoordStickTarget()},_isManipulatingSingleStickedObj:function(e){var t=!1;if(1===e.length){var r=e[0];t=!!this.getManipulateObjInfoMap().get(r).stickTarget}return t},doTransformManipulatedObjs:function(t,r,i){var n=e.Editor.BasicManipulationIaController.ManipulationType,a=this.getEditor(),o=this.getManipulateObjs(),s=i;if(s||(t===n.RESIZE?s=this._calcManipulateObjsResizeParams(o,this.getResizeStartingRegion(),r):t===n.ROTATE&&(s=this._calcManipulateObjsRotationParams(o,r))),!this._lastTransformParams||!this._isSameTransformParams(this._lastTransformParams,s,null,a.getCoordMode())){if(s&&this._calcManipulateObjsTransformInfo(o,s)){this._lastTransformParams=s,a.beginUpdateObject();this.getManipulateObjCurrInfoMap();try{this.applyManipulatingObjsInfo(r),this._maniplateObjsFrameEnd(o),this.notifyCoordChangeOfObjects(o)}finally{a.endUpdateObject(),this.manipulateStepDone()}}}},_isSameTransformParams:function(t,r,i,n){return i||(i=.1),n===e.CoordMode.COORD2D?s.isSameTransform2DOptions(t,r,{translate:i,scale:i,rotate:i}):s.isSameTransform3DOptions(t,r,{translate:i,scale:i,rotate:i})},_calcActualMovedScreenCoord:function(e,t,r){return r},_calcManipulateObjsMoveInfo:function(t,r){var i=e.CoordUtils,n=(this.getManipulateObjCurrInfoMap(),this._isManipulatingSingleStickedObj(t)),a=this.isDirectManipulating()&&1===t.length,o=a&&this.getEditorConfigs().getInteractionConfigs().getFollowPointerCoordOnDirectManipulatingSingleObj();if(o){var s=this.getStartCoord();i.getDistance(r,s)<=this.getEditorConfigs().getInteractionConfigs().getFollowPointerCoordOnDirectManipulatingSingleObjDistanceThreshold()&&(o=!1)}for(var l=0,d=t.length;l<d;++l){var u=t[l],c=this.getManipulateObjInfoMap().get(u);if(!c.hasNoCoord&&(!c.stickTarget||n)){var h;h=o?r:i.add(r,c.screenCoordOffset),h=this._calcActualMovedScreenCoord(u,c,h),this._addManipultingObjNewInfo(u,{screenCoord:h})}}},moveManipulatedObjs:function(t){var r=(e.CoordUtils,this.getEditor()),i=this.getManipulateObjs();this._calcManipulateObjsMoveInfo(i,t),r.beginUpdateObject();this.getManipulateObjCurrInfoMap();try{this.applyManipulatingObjsInfo(t),this._maniplateObjsFrameEnd(i),this.notifyCoordChangeOfObjects(i)}finally{r.endUpdateObject(),this.manipulateStepDone()}},doMoveManipulatedObj:function(e,t,r,i){var n=this.getEditor();this.updateChildMoveOperation(e,t,n.screenCoordToObj(r)),n.setObjectScreenCoord(t,r)},doResizeManipulatedObj:function(e,t,r){this.updateChildResizeOperation(e,t,r),t.setSizeOfMode&&t.setSizeOfMode(r,this.getEditor().getCoordMode())},isDirectManipulating:function(){return this.getState()===e.Editor.BasicManipulationIaController.State.MANIPULATING&&!this.getIsManipulatingSelection()},startDirectManipulate:function(t,r,i,n,a,o){var s=e.ArrayUtils.toArray(r);this.setState(e.Editor.BasicManipulationIaController.State.MANIPULATING),this.setBaseCoord(i),this.setStartCoord(i),this.setRotateRefCoord(o),this.setIsManipulatingSelection(!1),this.prepareManipulating(t||e.Editor.BasicManipulationIaController.ManipulationType.MOVE,s,i,n,a,o)},manipulateStepDone:function(){},doManipulateObjectsEnd:function(e){for(var t=this.getManipulateObjInfoMap(),r=e.length-1;r>=0;--r)this.doManipulateObjectEnd(e[r],t.get(e[r]))},doManipulateObjectEnd:function(e,t){},manipulateEnd:function(){this._runManipulationStepId&&(window.cancelAnimationFrame(this._runManipulationStepId),this._runManipulationStepId=null),this.doManipulateObjectsEnd(this.getManipulateObjs()),this.getEditor().endManipulateObject(),this._lastTransformParams=null,this.setIsOffsetManipulating(!1),this.setManipulateObjs(null),this.getManipulateObjInfoMap().clear(),this.getObjOperationMap().clear()},manipulateBeforeStopping:function(){},stopManipulate:function(){this.manipulateEnd()},refreshManipulateObjs:function(){this.setManipulateObjs(this.getManipulateObjs())},createManipulateObjInfo:function(t,r,i){var n=this.getEditor(),a={objCoord:n.getObjCoord(t),screenCoord:n.getObjectScreenCoord(t),size:n.getObjSize(t),enableIndirectCoord:!(!t.getEnableIndirectCoord||!t.getEnableIndirectCoord())};return a.hasNoCoord=!a.objCoord,!a.hasNoCoord&&i&&(a.screenCoordOffset=e.CoordUtils.substract(a.screenCoord,i)),t.getCoordStickTarget&&(a.stickTarget=t.getCoordStickTarget()),a},notifyCoordChangeOfObjects:function(t){for(var r=[],i=this.getEditor(),n=this.getEditor().getCoordMode()===e.CoordMode.COORD3D?"coord3D":"coord2D",a=0,o=t.length;a<o;++a){var s=t[a];e.ArrayUtils.pushUnique(r,{obj:s,propNames:[n]});for(var l=s.getCoordDeterminateObjects?s.getCoordDeterminateObjects():[s],d=0,u=l.length;d<u;++d)e.ArrayUtils.pushUnique(r,{obj:l[d],propNames:[n]})}i.objectsChanged(r)},canInteractWithObj:function(t){return this.getState()===e.Editor.BasicManipulationIaController.State.NORMAL&&t},doTestMouseCursor:function(t,r){var i="",n=this._getEventMouseCoord(r,this.getEditor().getEditClientElem());if(this.getState()===e.Editor.BasicManipulationIaController.State.NORMAL){var i,a=e.Editor.BoxRegion,o=this.getEditor().getCoordRegionInSelectionMarker(n);if(this.getEnableSelect()){var s=e.Editor.BasicManipulationIaController.ManipulationType,l=this.getCurrAvailableManipulationTypes();if(l.indexOf(s.MOVE)>=0&&(i=o===a.INSIDE?"move":""),!i&&l.indexOf(s.RESIZE)>=0)var i=o===a.CORNER_TL?"nwse-resize":o===a.CORNER_TR?"nesw-resize":o===a.CORNER_BL?"nesw-resize":o===a.CORNER_BR?"nwse-resize":o===a.EDGE_TOP||o===a.EDGE_BOTTOM?"ns-resize":o===a.EDGE_LEFT||o===a.EDGE_RIGHT?"ew-resize":"";if(!i&&l.indexOf(s.ROTATE)>=0){var o=this.getCoordOnSelectionRotationRegion(n);if(o){var d=e.Widget.StyleResourceNames;i=o===a.CORNER_TL?d.CURSOR_ROTATE_NW:o===a.CORNER_TR?d.CURSOR_ROTATE_NE:o===a.CORNER_BL?d.CURSOR_ROTATE_SW:o===a.CORNER_BR?d.CURSOR_ROTATE_SE:d.CURSOR_ROTATE}}}}return i},setSuspendedOperations:function(e,t,r){this._suspendedOperations&&this.haltSuspendedOperations();return this._suspendedOperations={immediate:e,delayed:t,delayExecId:setTimeout(this.execSuspendedDelayOperation.bind(this),r)},this._suspendedOperations},execSuspendedImmediateOperation:function(){if(this._suspendedOperations){clearTimeout(this._suspendedOperations.delayExecId);var e=this._suspendedOperations.immediate;return this._suspendedOperations=null,e.apply(this)}},execSuspendedDelayOperation:function(){if(this._suspendedOperations){clearTimeout(this._suspendedOperations.delayExecId);var e=this._suspendedOperations.delayed;return this._suspendedOperations=null,e.apply(this)}},haltSuspendedOperations:function(){this._suspendedOperations&&(clearTimeout(this._suspendedOperations.delayExecId),this._suspendedOperations=null)},_startNewSelecting:function(t,r){this.getEnableSelect()&&(this.getEditor().startSelecting(t,r||this.getEditor().getIsToggleSelectOn()),this.setState(e.Editor.BasicManipulationIaController.State.SELECTING))},_startOffSelectionManipulation:function(t){this.setIsOffsetManipulating(!0),this.beginManipulation(t,null,e.Editor.BasicManipulationIaController.ManipulationType.MOVE),this.getEditor().pulseSelectionAreaMarker()},beginManipulation:function(t,r,i){var n=e.Editor.BasicManipulationIaController.State,a=e.Editor.BasicManipulationIaController.ManipulationType,o=this.getCurrAvailableManipulationTypes(),s=r&&"touch"===r.pointerType;r&&this.setManipulationPointerType(r&&r.pointerType),this.getEditor().beginManipulateObject(),this.setBaseCoord(t),this.setStartCoord(t);var l=this.getEditor().getTopmostBasicObjectAtCoord(t,this.getCurrBoundInflation());if(l&&!s&&(this.isInAncestorSelectMode()&&(l=this.getStandaloneAncestor(l)),l=l.getNearestMovableObject(),this.getEnableMove()))return void this.startDirectManipulate(null,l,t);this._lastTransformParams=null;var d=t&&this.getEditor().getCoordRegionInSelectionMarker(t),u=e.Editor.BoxRegion,c=t&&this.getCoordOnSelectionRotationRegion(t),h=o.indexOf(a.TRANSFORM)>=0&&i===a.TRANSFORM;if(h)this._availTransformTypes=o;else var m=!s&&o.indexOf(a.RESIZE)>=0&&(i===a.RESIZE||d!==u.INSIDE&&d!==u.OUTSIDE),g=!m&&o.indexOf(a.MOVE)>=0&&(i===a.MOVE||d!==u.OUTSIDE),f=!s&&!m&&!g&&o.indexOf(a.ROTATE)>=0&&(i===a.ROTATE||!!c);if(h)this.setState(n.MANIPULATING),this.setIsManipulatingSelection(!0),this.setResizeStartingRegion(d),this.setRotateStartingRegion(c),this.prepareManipulating(a.TRANSFORM,this.getEditor().getSelection(),t,this.getEditor().getSelectionContainerBox());else if(m)this.setState(n.MANIPULATING),this.setIsManipulatingSelection(!0),this.setResizeStartingRegion(d),this.prepareManipulating(a.RESIZE,this.getEditor().getSelection(),t,this.getEditor().getSelectionContainerBox());else if(g)this.setState(n.MANIPULATING),this.setIsManipulatingSelection(!0),this.prepareManipulating(a.MOVE,this.getEditor().getSelection(),t);else if(f)this.setState(n.MANIPULATING),this.setIsManipulatingSelection(!0),this.setRotateStartingRegion(c),this.prepareManipulating(a.ROTATE,this.getEditor().getSelection(),t,this.getEditor().getSelectionContainerBox());else if(l)this.getEnableMove()&&this.startDirectManipulate(null,l,t);else if(this.getEnableMove()&&this.getEnableSelect()&&this.getEditorConfigs().getInteractionConfigs().getEnableOffSelectionManipulation()&&this.getEditor().hasSelection()&&this.getEditor().isSelectionVisible()){this.setState(n.SUSPENDING);var p=this.getEditorConfigs().getInteractionConfigs().getOffSelectionManipulationActivatingTimeThreshold(),C=r&&r.getShiftKey();this.setSuspendedOperations(this._startNewSelecting.bind(this,t,C),this._startOffSelectionManipulation.bind(this,t),p)}else if(this.getEnableSelect()){var C=r&&r.getShiftKey();this._startNewSelecting(t,C)}},execManipulationStep:function(t){if(this.getState()!==e.Editor.BasicManipulationIaController.State.MANIPULATING)return!1;var r=this._manipulationStepBuffer.coord,i=this._manipulationStepBuffer.event,n=this._manipulationStepBuffer.explicitTransformParams;r&&i?this.doExecManipulationStep(r,i,this._manipulationStepBuffer):n&&this.doExecManipulationStepWithExplicitTransformParams(n,this._manipulationStepBuffer),this._manipulationStepBuffer.coord=null,this._manipulationStepBuffer.event=null,this._manipulationStepBuffer.explicitTransformParams=null,this._runManipulationStepId=window.requestAnimationFrame(this.execManipulationStepBind)},doExecManipulationStep:function(t,r,i){var n=e.Editor.BasicManipulationIaController.ManipulationType,a=this.getManipulationType(),o=this.getEditor();o.beginUpdateObject();try{this._isBusy=!0,a===n.MOVE?this.moveManipulatedObjs(t):a===n.RESIZE?(this._suppressConstrainedResize=r.getAltKey(),this.doTransformManipulatedObjs(a,t)):a===n.ROTATE&&this.doTransformManipulatedObjs(a,t)}finally{o.endUpdateObject(),this._isBusy=!1}},doExecManipulationStepWithExplicitTransformParams:function(t,r){var i=e.Editor.BasicManipulationIaController.ManipulationType,n=this.getManipulationType();if(n===i.TRANSFORM){var a=this.getEditor();a.beginUpdateObject();try{this._isBusy=!0,this.doTransformManipulatedObjs(n,null,t)}finally{a.endUpdateObject(),this._isBusy=!1}}},updateManipulationStepBuffer:function(e,t){Object.extend(e,t)},react_pointermove:function($super,t){if($super(t),this._isBusy)return!0;var r,i=e.Editor.BasicManipulationIaController.State,n=(e.Editor.BasicManipulationIaController.ManipulationType,this._getEventMouseCoord(t));if(this._lastMouseMoveCoord){var a=e.CoordUtils.getDistance(n,this._lastMouseMoveCoord);if(r=a,a<4)return!0}if(this._lastMouseMoveCoord=n,this.getState()===i.SUSPENDING){var o=this.getEditorConfigs().getInteractionConfigs().getUnmovePointerDistanceThreshold()||0;e.ObjUtils.notUnset(r)&&r>o&&this.execSuspendedImmediateOperation()}var s=this.getState();return s===i.SELECTING?(this.getEnableSelect()&&this.getEditor().addSelectingAnchorCoord(n),t.preventDefault()):s===i.MANIPULATING&&(this.updateManipulationStepBuffer(this._manipulationStepBuffer,{coord:n,event:t}),t.preventDefault()),!0},react_pointerdown:function($super,t){$super(t);var r=e.Editor.BasicManipulationIaController.State;if(t.getButton()===e.X.Event.MouseButton.LEFT){this._lastMouseMoveCoord=null;var i=this._getEventMouseCoord(t);if(this.getState()===r.NORMAL){var n=this,a=function(){n.getState()===r.NORMAL&&(n.beginManipulation(i,t),t.preventDefault())};this.setSuspendedOperations(a,a,50)}}else t.getButton()===e.X.Event.MouseButton.RIGHT&&(this.getState()===r.MANIPULATING?(this.cancelManipulate(),this.setState(r.NORMAL),t.stopPropagation(),t.preventDefault()):this.getState()===r.SUSPENDING&&this.haltSuspendedOperations());return!0},react_pointerup:function(t){if(t.getButton()===e.X.Event.MouseButton.LEFT){var r=this._getEventMouseCoord(t);this.setEndCoord(r);var i=this.getStartCoord(),n=r,a=t.getShiftKey(),o=e.Editor.BasicManipulationIaController.State;this.getState()===o.SUSPENDING&&this.execSuspendedImmediateOperation();var s=this.getState();if(s===o.SELECTING){this.getEditor().endSelecting(r,a||this.getEditor().getIsToggleSelectOn()),this.setState(o.NORMAL),t.preventDefault();this.getEditor().endManipulateObject()}else s===o.MANIPULATING&&(e.CoordUtils.isEqual(i,n)?this.getEnableSelect()&&this.getEditor().selectOnCoord(i,a||this.getEditor().getIsToggleSelectOn()):(this.manipulateBeforeStopping(),this.addOperationToEditor()),this.stopManipulate(),this.setState(o.NORMAL),t.preventDefault())}return!0},react_mousewheel:function($super,t){if(t.getCtrlKey()){if(this.getState()===e.Editor.BasicManipulationIaController.State.NORMAL)return $super(t);t.preventDefault()}},_isGestureManipulationEnabled:function(){return this.getEditorConfigs().getInteractionConfigs().getEnableGestureManipulation()},_isGestureZoomOnEditorEnabled:function(){return this.getEditorConfigs().getInteractionConfigs().getEnableGestureZoomOnEditor()},_isInGestureManipulation:function(){return!!this._initialGestureTransformParams},_isGestureZoomOnEditor:function(){return!!this._initialGestureZoomLevel},beginGestureTransform:function(t){this.getEditor().hasSelection()?(this._initialGestureZoomLevel=null,this._isGestureManipulationEnabled()?(this.haltSuspendedOperations(),this._initialGestureTransformParams={angle:t.rotation*Math.PI/180||0},this.getState()!==e.Editor.BasicManipulationIaController.State.MANIPULATING?this.beginManipulation(null,null,e.Editor.BasicManipulationIaController.ManipulationType.TRANSFORM):this.getManipulationType()!==e.Editor.BasicManipulationIaController.ManipulationType.TRANSFORM&&this.setManipulationType(e.Editor.BasicManipulationIaController.ManipulationType.TRANSFORM)):this._initialGestureTransformParams=null):this._isGestureZoomOnEditorEnabled()&&(this.getEditor().cancelSelecting(),this.setState(e.Editor.BasicManipulationIaController.State.NORMAL),this._initialGestureZoomLevel=this.getEditor().getZoom())},endGestureTransform:function(){this.getState()===e.Editor.BasicManipulationIaController.State.MANIPULATING&&this._isInGestureManipulation()&&(this.manipulateBeforeStopping(),this.addOperationToEditor(),this.stopManipulate(),this.setState(e.Editor.BasicManipulationIaController.State.NORMAL),this._initialGestureTransformParams=null),this._isGestureZoomOnEditor()&&(this._initialGestureZoomLevel=null)},doGestureTransformStep:function(t){var r=e.Editor.BasicManipulationIaController.ManipulationType;if(this.getState()===e.Editor.BasicManipulationIaController.State.MANIPULATING&&this.getManipulationType()===r.TRANSFORM&&this._isInGestureManipulation()){var i,n,a=this._availTransformTypes||[],o=this.getRotateCenter();if(a.indexOf(r.RESIZE)>=0){var s=t.scale;i=this._calcActualResizeScales(this.getManipulateObjs(),{scaleX:s,scaleY:s})}else i={scaleX:1,scaleY:1};if(a.indexOf(r.ROTATE)>=0){var l=t.rotation*Math.PI/180,n=l-this._initialGestureTransformParams.angle;n=this._calcActualRotateAngle(this.getManipulateObjs(),n,this._initialGestureTransformParams.angle,l)}else n=0;this.updateManipulationStepBuffer(this._manipulationStepBuffer,{explicitTransformParams:{center:o,scaleX:i.scaleX,scaleY:i.scaleY,rotateAngle:n}}),t.preventDefault()}else if(this._isGestureZoomOnEditor()){var d=this.getEditor(),s=t.scale,u=this._initialGestureZoomLevel;d.zoomTo(u*s,null,t.center)}},react_rotatestart:function(e){this.getEnableGestureManipulation()&&this.beginGestureTransform(e)},react_rotate:function(e){this.getEnableGestureManipulation()&&this.doGestureTransformStep(e)},react_rotateend:function(e){this.getEnableGestureManipulation()&&this.endGestureTransform()},react_rotatecancel:function(e){this.getEnableGestureManipulation()&&this.endGestureTransform()},react_pinchstart:function(e){this.getEnableGestureManipulation()&&this.beginGestureTransform(e)},react_pinchmove:function(e){this.getEnableGestureManipulation()&&this.doGestureTransformStep(e)},react_pinchend:function(e){this.getEnableGestureManipulation()&&this.endGestureTransform()},react_pinchcancel:function(e){this.getEnableGestureManipulation()&&this.endGestureTransform()}}),e.Editor.BasicManipulationIaController.State={NORMAL:0,SELECTING:1,MANIPULATING:2,SUSPENDING:11},e.Editor.BasicManipulationIaController.ManipulationType={MOVE:0,ROTATE:1,RESIZE:2,TRANSFORM:4},e.Editor.IaControllerManager.register(e.Editor.BasicManipulationIaController,e.Editor.BaseEditor),e}},function(e,t,r){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=r(0).Class,a=(r(0).ClassEx,r(0).DataType);e.exports=function(e){var t=e.ArrayUtils;return e.ChemObjOperation={},e.ChemObjOperation.Base=n.create(e.Operation,{CLASS_NAME:"Kekule.ChemObjOperation.Base",initialize:function($super,e,t){$super(),this.setTarget(e),t&&this.setEditor(t)},initProperties:function(){this.defineProp("target",{dataType:"Kekule.ChemObject",serializable:!1}),this.defineProp("allowCoordBorrow",{dataType:a.BOOL}),this.defineProp("editor",{dataType:"Kekule.Editor.BaseEditor",serializable:!1})},moveCurveArrowToMatchChemStructure:function(t){var r=this.getTarget(),i=this.getDest(),n=Object.assign({},t);if(i&&i.id&&i.id===r.anchorObj){var a=this.getEditor().getChemObj().getObjById(r.anchorObj);if(!a)return;a.coord2D&&Object.assign(n,a.coord2D);var o=a.getParent();o&&o.coord2D&&(n.x+=o.coord2D.x,n.y+=o.coord2D.y);new e.ChemObjOperation.MoveTo(r,n,e.CoordMode.COORD2D,!0,this.getEditor()).execute()}},getArcNodesFromChemStructObj:function(t){var r=t.getAttachedArcNodeIds(),i=[],n=this.getEditor(),a=n&&n.getChemObj&&n.getChemObj();return a&&a.getOwnedObjs().forEach(function(t){t instanceof e.Glyph.Arc&&t.getNodes().forEach(function(e){r[e.getId()]&&i.push(e)})}),i},removeCurveArrowAnchor:function(e){var t=this,r=this.getTarget();if(r.setAnchorObj)r.anchorObj&&r.anchorObj.length&&this.removeListenersOnCurveArrow(r);else{this.getArcNodesFromChemStructObj(r).forEach(function(e){t.removeListenersOnCurveArrow(e)})}},removeListenersOnCurveArrow:function(e,t){t||(t=this.getEditor().getChemObj().getObjById(e.getAnchorObj())),e.getAnchorObj()&&t&&(delete t.getAttachedArcNodeIds()[e.getId()],t.removeEventListener("objectMoved",this.moveCurveArrowToMatchChemStructure,this)),e.setAnchorObj("")},notifyBeforeAddingByEditor:function(e,t,r){e.beforeAddingByEditor&&e.beforeAddingByEditor(t,r)},notifyBeforeRemovingByEditor:function(e,t){e.beforeRemovingByEditor&&e.beforeRemovingByEditor(t)},notifyBeforeModifyingByEditor:function(e,t){e.beforeModifyingByEditor&&e.beforeModifyingByEditor(t)},notifyAfterAddingByEditor:function(e,t,r){e.afterAddingByEditor&&e.afterAddingByEditor(t,r)},notifyAfterRemovingByEditor:function(e,t){e.afterRemovingByEditor&&e.afterRemovingByEditor(t)},notifyAfterModifyingByEditor:function(e,t){e.afterModifyingByEditor&&e.afterModifyingByEditor(t)}}),e.ChemObjOperation.ChangeClass=n.create(e.ChemObjOperation.Base,{CLASS_NAME:"Kekule.ChemObjOperation.ChangeClass",initialize:function($super,e,t,r){$super(e,r),t&&this.setNewClass(t)},initProperties:function(){this.defineProp("newClass",{dataType:a.CLASS,serializable:!1}),this.defineProp("oldClass",{dataType:a.CLASS,serializable:!1})},doExecute:function(){var e=this.getTarget();e.beginUpdate();try{this.notifyBeforeModifyingByEditor(e,{}),this.getOldClass()||this.setOldClass(e.getClass()),e.__changeClass__(this.getNewClass()),this.notifyAfterModifyingByEditor(e,{})}finally{e.endUpdate()}},doReverse:function(){var e=this.getTarget();e.beginUpdate();try{this.notifyBeforeModifyingByEditor(e,{}),e.__changeClass__(this.getOldClass()),this.notifyAfterModifyingByEditor(e,{})}finally{e.endUpdate()}}}),e.ChemObjOperation.Modify=n.create(e.ChemObjOperation.Base,{CLASS_NAME:"Kekule.ChemObjOperation.Modify",initialize:function($super,e,t,r){$super(e,r),t&&this.setNewPropValues(t)},initProperties:function(){this.defineProp("newPropValues",{dataType:a.HASH}),this.defineProp("oldPropValues",{dataType:a.HASH})},doExecute:function(){var e={},t=this.getNewPropValues(),r=this.getTarget();r.beginUpdate();try{this.notifyBeforeModifyingByEditor(r,t);for(var i in t){var n=t[i];e[i]=r.getPropValue(i),r.setPropValue(i,n)}this.notifyAfterModifyingByEditor(r,t)}finally{r.endUpdate()}this.setOldPropValues(e)},doReverse:function(){var e=this.getOldPropValues(),t=this.getTarget();t.beginUpdate();try{this.notifyBeforeModifyingByEditor(t,e);for(var r in e){var i=e[r];t.setPropValue(r,i)}this.notifyAfterModifyingByEditor(t,e)}finally{t.endUpdate()}}}),e.ChemObjOperation.ModifyHashProp=n.create(e.ChemObjOperation.Base,{CLASS_NAME:"Kekule.ChemObjOperation.ModifyHashProp",initialize:function($super,e,t,r,i){$super(e,i),t&&this.setPropName(t),r&&this.setNewPropValue(r)},initProperties:function(){this.defineProp("propName",{dataType:a.STRING}),this.defineProp("newPropValue",{dataType:a.HASH}),this.defineProp("oldPropValue",{dataType:a.HASH})},_extendHash:function(e,t){},doExecute:function(){var e=this.getTarget(),t=this.getPropName(),r=e.getPropValue(this.getPropName()),i=Object.extend(Object.extend({},r),this.getNewPropValue(),!1),n={};n[t]=i,e.beginUpdate();try{this.notifyBeforeModifyingByEditor(e,n),e.setPropValue(t,i),this.notifyAfterModifyingByEditor(e,n)}finally{e.endUpdate()}this.getOldPropValue()||this.setOldPropValue(r)},doReverse:function(){var e=this.getTarget(),t=this.getPropName(),r=this.getOldPropValue(),i=(e.getPropValue(t),r),n={};n[t]=i,e.beginUpdate();try{this.notifyBeforeModifyingByEditor(e,n),e.setPropValue(t,i),this.notifyAfterModifyingByEditor(e,n)}finally{e.endUpdate()}}}),e.ChemObjOperation.MoveTo=n.create(e.ChemObjOperation.Base,{CLASS_NAME:"Kekule.ChemObjOperation.MoveTo",initialize:function($super,t,r,i,n,a){$super(t,a),r&&this.setNewCoord(r),this.setCoordMode(i||e.CoordMode.COORD2D),this.setUseAbsBaseCoord(!!n)},initProperties:function(){this.defineProp("newCoord",{dataType:a.HASH}),this.defineProp("oldCoord",{dataType:a.HASH}),this.defineProp("coordMode",{dataType:a.INT}),this.defineProp("useAbsBaseCoord",{dataType:a.BOOL})},setObjCoord:function(t,r,n){if(t&&r&&n){var a=!1;if(this.getUseAbsBaseCoord()?t.setAbsBaseCoord&&(t.setAbsBaseCoord(r,n,this.getAllowCoordBorrow()),a=!0):t.setCoordOfMode&&(t.setCoordOfMode(r,n),a=!0),!a){var o=t.getClassName?t.getClassName():void 0===t?"undefined":i(t);e.warn(e.$L("ErrorMsg.CAN_NOT_SET_COORD_OF_CLASS").format(o))}}},getObjCoord:function(e,t){if(this.getUseAbsBaseCoord()){if(e.getAbsBaseCoord)return e.getAbsBaseCoord(t,this.getAllowCoordBorrow())}else if(e.getCoordOfMode)return e.getCoordOfMode(t,this.getAllowCoordBorrow());return null},doExecute:function(){var e=this.getTarget();this.getOldCoord()||this.setOldCoord(this.getObjCoord(e,this.getCoordMode())),this.getNewCoord()&&this.setObjCoord(this.getTarget(),this.getNewCoord(),this.getCoordMode())},doReverse:function(){var t=this.getTarget();e.Glyph.PathGlyphNode,this.getOldCoord()&&this.setObjCoord(t,this.getOldCoord(),this.getCoordMode())}}),e.ChemObjOperation.MoveAndResize=n.create(e.ChemObjOperation.MoveTo,{CLASS_NAME:"Kekule.ChemObjOperation.MoveAndResize",initialize:function($super,e,t,r,i,n,a){$super(e,r,i,n,a)},initProperties:function(){this.defineProp("newDimension",{dataType:a.HASH}),this.defineProp("oldDimension",{dataType:a.HASH})},setObjSize:function(t,r,n){if(t&&r)if(t.setSizeOfMode)t.setSizeOfMode(r,n);else{var a=t.getClassName?t.getClassName():void 0===t?"undefined":i(t);e.warn(e.$L("ErrorMsg.CAN_NOT_SET_DIMENSION_OF_CLASS").format(a))}},getObjSize:function(e,t){return e.getSizeOfMode?e.getSizeOfMode(t,this.getAllowCoordBorrow()):null},doExecute:function($super){$super();var e=this.getTarget();this.getOldDimension()||this.setOldDimension(this.getObjSize(e,this.getCoordMode())),this.getNewDimension()&&this.setObjSize(this.getTarget(),this.getNewDimension(),this.getCoordMode())},doReverse:function($super){this.getOldDimension()&&this.setObjSize(this.getTarget(),this.getOldDimension(),this.getCoordMode()),$super()}}),e.ChemObjOperation.MoveAndResizeObjs=n.create(e.ChemObjOperation.Base,{CLASS_NAME:"Kekule.ChemObjOperation.MoveAndResizeObjs",initialize:function($super,t,r,i,n){$super(null,n),t&&this.setObjCoordAndSizeInfo(t),this.setCoordMode(r||e.CoordMode.COORD2D),this.setUseAbsCoord(!!i),this.setPropStoreFieldValue("childOperations",[])},initProperties:function(){this.defineProp("objCoordAndSizeInfo",{dataType:a.ARRAY,serializable:!1}),this.defineProp("coordMode",{dataType:a.INT}),this.defineProp("useAbsCoord",{dataType:a.BOOL}),this.defineProp("disableIndirectCoord",{dataType:a.BOOL}),this.defineProp("childOperations",{dataType:a.ARRAY,serializable:!1}),this.defineProp("indirectCoordObjs",{dataType:a.ARRAY,serializable:!1})},_setEnableIndirectCoordOfObjs:function(e,t){if(e)for(var r=0,i=e.length;r<i;++r)e[r].setEnableIndirectCoord(t)},_prepareIndirectCoordObjs:function(t){var r=this.getDisableIndirectCoord(),i=[];if(r)for(var n=0,a=t.length;n<a;++n){var o=t[n];if(o&&o instanceof e.ChemObjOperation.MoveAndResize){var s=o.getTarget();s.hasProperty("enableIndirectCoord")&&s.getEnableIndirectCoord()&&(s.setEnableIndirectCoord(!1),i.push(s))}}this.setIndirectCoordObjs(i)},_prepareExecute:function(){var t=this.getChildOperations();if(!t.length){t.length=0;for(var r=this.getObjCoordAndSizeInfo(),i=0,n=r.length;i<n;++i){var a=r[i],o=a.obj,s=new e.ChemObjOperation.MoveAndResize(o,a.newDimension,a.newCoord,this.getCoordMode(),this.getUseAbsCoord(),this.getEditor());s.setAllowCoordBorrow(this.getAllowCoordBorrow()),a.oldDimension&&s.setOldDimension(a.oldDimension),a.oldCoord&&s.setOldCoord(a.oldCoord),t.push(s)}}this._prepareIndirectCoordObjs(t)},_prepareReverse:function(){this.getDisableIndirectCoord()&&(this.getIndirectCoordObjs()||this._prepareIndirectCoordObjs(this.getChildOperations()),this._setEnableIndirectCoordOfObjs(this.getIndirectCoordObjs(),!1))},_doneMoveAndResize:function(){this._setEnableIndirectCoordOfObjs(this.getIndirectCoordObjs(),!0)},doExecute:function($super){$super();try{this._prepareExecute();for(var e=this.getChildOperations(),t=0,r=e.length;t<r;++t)e[t].execute()}finally{this._doneMoveAndResize()}},doReverse:function($super){try{this._prepareReverse();for(var e=this.getChildOperations(),t=e.length-1;t>=0;--t)e[t].reverse()}finally{this._doneMoveAndResize()}$super()}}),e.ChemObjOperation.StickTo=n.create(e.ChemObjOperation.Base,{CLASS_NAME:"Kekule.ChemObjOperation.StickTo",initialize:function($super,e,t,r){$super(e,r),t&&this.setStickTarget(t)},initProperties:function(){this.defineProp("stickTarget",{dataType:e.ChemObject,serializable:!1}),this.defineProp("oldStickTarget",{dataType:e.ChemObject,serializable:!1})},_canExecute:function(e){return e&&e.getAllowCoordStickTo&&e.getAllowCoordStickTo(this.getStickTarget())},doExecute:function($super){$super();var e=this.getTarget();this._canExecute(e)&&(void 0===this.getOldStickTarget()&&this.setOldStickTarget(e.getCoordStickTarget()||null),e.setCoordStickTarget(this.getStickTarget()))},doReverse:function($super){this.getTarget().setCoordStickTarget(this.getOldStickTarget()),$super()}}),e.ChemObjOperation.StickTo.canStick=function(t,r,i,n){var a=t&&t.getAllowCoordStickTo&&t.getAllowCoordStickTo(r);if(r&&(a=a&&r&&r.getAbsCoordOfMode,a=a&&r!==t,a=a&&r.getAcceptCoordStickFrom&&r.getAcceptCoordStickFrom(t),a=a&&(!r.getCoordStickTarget||r.getCoordStickTarget()!==t),(a=a&&(i||!(r instanceof e.StructureFragment)))&&!n)){var o=t.getParent(),s=r.getParent();a=o!==s||!o||!s}return a},e.ChemObjOperation.Add=n.create(e.ChemObjOperation.Base,{CLASS_NAME:"Kekule.ChemObjOperation.Add",initialize:function($super,e,t,r,i){$super(e,i),this.setParentObj(t),this.setRefSibling(r)},initProperties:function(){this.defineProp("parentObj",{dataType:"Kekule.ChemObject",serializable:!1}),this.defineProp("refSibling",{dataType:"Kekule.ChemObject",serializable:!1})},doExecute:function(){var e=this.getParentObj(),t=this.getTarget();if(e&&t){var r=this.getRefSibling()||null;this.notifyBeforeAddingByEditor(t,e,r),e.insertBefore(t,r),this.notifyAfterAddingByEditor(t,e,r)}},doReverse:function(){var e=this.getTarget(),t=this.getParentObj();if(t&&e){var r=this.getRefSibling();r||(r=e.getNextSibling(),this.setRefSibling(r)),this.notifyBeforeRemovingByEditor(e,t),t.removeChild(e),this.notifyAfterRemovingByEditor(e,t)}}}),e.ChemObjOperation.Remove=n.create(e.ChemObjOperation.Base,{CLASS_NAME:"Kekule.ChemObjOperation.Remove",initialize:function($super,e,t,r,i){$super(e,i),this.setParentObj(t),this.setRefSibling(r)},initProperties:function(){this.defineProp("parentObj",{dataType:"Kekule.ChemObject",serializable:!1}),this.defineProp("ownerObj",{dataType:"Kekule.ChemObject",serializable:!1}),this.defineProp("refSibling",{dataType:"Kekule.ChemObject",serializable:!1}),this.defineProp("dest",{dataType:"Kekule.ChemStructureNode",serializable:!1}),this.defineProp("attachedArcNodeIds",{dataType:a.HASH}),this.defineProp("removedRelations",{dataType:a.ARRAY,serializable:!1})},_isInEditorSelection:function(e){var t=this.getEditor();return(t&&t.getSelection&&t.getSelection()||[]).indexOf(e)>=0},_getRelatedObjRefRelations:function(e){var r=[],i=e.getOwner();if(i){var n=i.findObjRefRelations({dest:e},{checkDestChildren:!0});if(n&&n.length)for(var a=0,o=n.length;a<o;++a){var s=Object.extend({},n[a]);t.isArray(s.dest)&&(s.dest=t.clone(s.dest)),r.push(s)}}return r},_restoreRelations:function(e){if(e)for(var t=0,r=e.length;t<r;++t){var i=e[t];i.srcObj.setPropValue(i.srcProp.name,i.dest)}},doExecute:function(){var t=this,r=this.getTarget();r instanceof e.Glyph.PathGlyphArcConnectorControlNode&&r.getParent()&&(r=r.getParent().getParent());var i=this.getParentObj(),n=this.getOwnerObj();if(!i&&r.getParent&&(i=r.getParent(),this.setParentObj(i)),!n&&r.getOwner&&(n=r.getOwner(),this.setOwnerObj(n)),r instanceof e.Glyph.Arc&&r.nodes.forEach(function(e){return t.removeListenersOnCurveArrow(e)}),i&&r){var a={};if(Object.keys(r.getAttachedArcNodeIds()).forEach(function(e){var i=t.editor&&t.getEditor().getChemObj().getObjById(e);i&&i.anchorObj===r.id&&(a[e]=e,i.setAnchorObj("")),r.removeEventListener("objectMoved",t.moveCurveArrowToMatchChemStructure,t)}),this.setAttachedArcNodeIds(a),!this.getRefSibling()){var o=r.getNextSibling?r.getNextSibling():null;this.setRefSibling(o)}var s=this._getRelatedObjRefRelations(r);this.setRemovedRelations(s);var l=this.getEditor(),d=this._isInEditorSelection(r);d&&l.beginUpdateSelection(),this.notifyBeforeRemovingByEditor(r,i),i.removeChild(r),this.notifyAfterRemovingByEditor(r,i),d&&(l.removeFromSelection(r),l.endUpdateSelection())}},doReverse:function(){var t=this,r=this.getParentObj(),i=this.getOwnerObj(),n=this.getTarget();if(n instanceof e.Glyph.PathGlyphNode&&this.addEventListenerToAnchorObj(n),n instanceof e.Glyph.Arc&&n.nodes.forEach(function(e){return t.addEventListenerToAnchorObj(e)}),r&&n){n.setAttachedArcNodeIds(this.getAttachedArcNodeIds());this.getArcNodesFromChemStructObj(n).forEach(function(e){e.setAnchorObj(n.getId()),t.addEventListenerToAnchorObj(e,n)});var a=this.getRefSibling();i&&n.setOwner(i),this.notifyBeforeAddingByEditor(n,r,a),r.insertBefore(n,a),this._restoreRelations(this.getRemovedRelations()),this.setRemovedRelations([]),this.notifyAfterAddingByEditor(n,r,a)}},addEventListenerToAnchorObj:function(e,t){if(e.anchorObj){var r=this.getEditor().getChemObj();return t=t||r.getObjById(e.anchorObj),t.addEventListener("objectMoved",this.moveCurveArrowToMatchChemStructure,this),t}}}),e.ChemStructOperation={},e.ChemStructOperation.AddNode=n.create(e.ChemObjOperation.Add,{CLASS_NAME:"Kekule.ChemStructOperation.AddNode"}),e.ChemStructOperation.RemoveNode=n.create(e.ChemObjOperation.Remove,{CLASS_NAME:"Kekule.ChemStructOperation.RemoveNode",initProperties:function(){this.defineProp("linkedConnectorInfos",{dataType:a.ARRAY,serializable:!1})},doExecute:function($super){if(this.getTarget()instanceof e.ChemMarker.UnbondedElectronSet){var t=this.getTarget().getParent();t&&t.removeMarker(this.getTarget())}if(!this.getLinkedConnectorInfos()){for(var r=this.getTarget(),i=r.getLinkedConnectors(),n=[],a=0,o=i.length;a<o;++a){var s=i[a],l=s.indexOfConnectedObj(r),d=s.getConnectedObjAt(l+1)||null;n.push({connector:s,refSibling:d})}this.setLinkedConnectorInfos(n)}$super()},doReverse:function($super){$super();var e=this.getLinkedConnectorInfos();if(e)for(var t=this.getTarget(),r=0,i=e.length;r<i;++r){var n=e[r].connector,a=e[r].refSibling;n.insertConnectedObjBefore(t,a)}}}),e.ChemStructOperation.ReplaceNode=n.create(e.Operation,{CLASS_NAME:"Kekule.ChemStructOperation.ReplaceNode",initialize:function($super,e,t,r,i){$super(),this.setOldNode(e),this.setNewNode(t),this.setParentObj(r),this.setEditor(i)},initProperties:function(){this.defineProp("oldNode",{dataType:"Kekule.ChemStructureNode",serializable:!1}),this.defineProp("newNode",{dataType:"Kekule.ChemStructureNode",serializable:!1}),this.defineProp("parentObj",{dataType:"Kekule.ChemStructureFragment",serializable:!1}),this.defineProp("editor",{dataType:"Kekule.Editor.BaseEditor",serializable:!1})},_isInEditorSelection:function(e){var t=this.getEditor();return(t&&t.getSelection&&t.getSelection()||[]).indexOf(e)>=0},doExecute:function(){var e=this.getOldNode(),t=this.getNewNode();if(e&&t){var r=this.getParentObj();if(r||(r=e.getParent(),this.setParentObj(r)),r.replaceNode){var i=this.getEditor(),n=this._isInEditorSelection(e);n&&i.beginUpdateSelection(),r.replaceNode(e,t),n&&(i.removeFromSelection(e),i.addObjToSelection(t),i.endUpdateSelection())}}},doReverse:function(){var e=this.getOldNode(),t=this.getNewNode();if(e&&t){var r=this.getParentObj()||t.getParent();if(r.replaceNode){var i=this.getEditor(),n=this._isInEditorSelection(t);n&&i.beginUpdateSelection(),r.replaceNode(t,e),n&&(i.removeFromSelection(t),i.addObjToSelection(e),i.endUpdateSelection())}}}}),e.ChemStructOperation.AddConnector=n.create(e.ChemObjOperation.Add,{CLASS_NAME:"Kekule.ChemStructOperation.AddConnector",initialize:function($super,e,t,r,i,n){$super(e,t,r,n),this.setConnectedObjs(i)},initProperties:function(){this.defineProp("connectedObjs",{dataType:a.ARRAY,serializable:!1})},doExecute:function($super){$super();var t=e.ArrayUtils.clone(this.getConnectedObjs());t&&t.length&&this.getTarget().setConnectedObjs(t)},doReverse:function($super){$super()}}),e.ChemStructOperation.RemoveConnector=n.create(e.ChemObjOperation.Remove,{CLASS_NAME:"Kekule.ChemStructOperation.RemoveConnector",initProperties:function(){this.defineProp("connectedObjs",{dataType:a.ARRAY,serializable:!1})},doExecute:function($super){this.getConnectedObjs()||this.setConnectedObjs(e.ArrayUtils.clone(this.getTarget().getConnectedObjs())),$super()},doReverse:function($super){$super();var e=this.getConnectedObjs();e&&e.length&&this.getTarget().setConnectedObjs(e)}}),e.ChemStructOperation.MergeNodesBase=n.create(e.ChemObjOperation.Base,{CLASS_NAME:"Kekule.ChemStructOperation.MergeNodesBase",initialize:function($super,e,t,r,i){$super(e,i),this.setDest(t),this.setEnableStructFragmentMerge(r||!1),this._refSibling=null,this._nodeParent=null},initProperties:function(){this.defineProp("dest",{dataType:"Kekule.ChemStructureNode",serializable:!1}),this.defineProp("enableStructFragmentMerge",{dataType:a.BOOL})},getCommonSiblings:function(t,r){var i=t instanceof e.ChemMarker.UnbondedElectronSet?t.getParent().getLinkedObjs():t.getLinkedObjs(),n=r instanceof e.ChemMarker.UnbondedElectronSet?r.getParent().getLinkedObjs():r.getLinkedObjs();return e.ArrayUtils.intersect(i,n)},doExecute:function(){},doReverse:function(){}}),e.ChemStructOperation.MergeNodes=n.create(e.ChemStructOperation.MergeNodesBase,{CLASS_NAME:"Kekule.ChemStructOperation.MergeNodes",initialize:function($super,e,t,r,i){$super(e,t,r,i),this._refSibling=null,this._nodeParent=null,this._structFragmentMergeOperation=null,this._removeConnectorOperations=[],this._removeNodeOperation=null},initProperties:function(){this.defineProp("changedConnectors",{dataType:a.ARRAY,serializable:!1}),this.defineProp("removedConnectors",{dataType:a.ARRAY,serializable:!1}),this.defineProp("changedGlyphNodes",{dataType:a.HASH})},doExecute:function(){var t=this.getTarget(),r=this.getDest(),i=t instanceof e.ChemMarker.UnbondedElectronSet?t.getParent().getParentFragment():t.getParentFragment(),n=r instanceof e.ChemMarker.UnbondedElectronSet?r.getParent().getParentFragment():r.getParentFragment();if(i!==n){if(!this.getEnableStructFragmentMerge())return null;this._structFragmentMergeOperation=new e.ChemStructOperation.MergeStructFragment(i,n,this.getEditor()),this._structFragmentMergeOperation.execute(),i=n}this._nodeParent=i,i.beginUpdate();try{var a=this.getEditor(),o={};Object.keys(t.getAttachedArcNodeIds()).forEach(function(e){var i=a.chemObj.getObjById(e);i&&i.anchorObj===t.id&&(o[e]={fromNodeId:t.id,toNodeId:r.id})});var s=this.getRemovedConnectors();if(!(s||t instanceof e.ChemMarker.UnbondedElectronSet)){var l=this.getCommonSiblings(t,r),s=[];if(l.length)for(var d=0,u=l.length;d<u;++d){var c=l[d],h=t.getConnectorTo(c);h&&2==h.getConnectedObjCount()&&s.push(h)}var m=t.getConnectorTo(r);m&&s.push(m),this.setRemovedConnectors(s)}var g=this.getChangedConnectors();if(!(g||t instanceof e.ChemMarker.UnbondedElectronSet)){var f=t.getLinkedConnectors(),g=e.ArrayUtils.clone(f)||[];g=e.ArrayUtils.exclude(g,s),this.setChangedConnectors(g)}if(this._refSibling=t instanceof e.ChemMarker.UnbondedElectronSet?t.getParent().getNextSibling():t.getNextSibling(),g)for(var d=0,u=g.length;d<u;++d){var h=g[d],p=h.indexOfConnectedObj(t);h.removeConnectedObj(t),h.insertConnectedObjAt(r,p)}if(this._removeConnectorOperations=[],s)for(var d=0,u=s.length;d<u;++d){var h=s[d],C=new e.ChemStructOperation.RemoveConnector(h,null,null,a);C.execute(),this._removeConnectorOperations.push(C)}this._removeNodeOperation=new e.ChemStructOperation.RemoveNode(t,null,null,a),this._removeNodeOperation.execute()}finally{i.endUpdate()}},doReverse:function(){var e=this.getTarget(),t=this.getDest(),r=this._nodeParent;r.beginUpdate();try{if(this._removeNodeOperation.reverse(),this._removeConnectorOperations.length)for(var i=this._removeConnectorOperations.length-1;i>=0;--i){var n=this._removeConnectorOperations[i];n.reverse()}this._removeConnectorOperations=[];for(var a=this.getChangedConnectors(),i=0,o=a.length;i<o;++i){var s=a[i],l=s.indexOfConnectedObj(t);s.removeConnectedObj(t),s.insertConnectedObjAt(e,l)}}finally{r.endUpdate()}this._structFragmentMergeOperation&&this._structFragmentMergeOperation.reverse()}}),e.ChemStructOperation.MergeNodes.canMerge=function(t,r,i,n){if(t instanceof e.StructureFragment||r instanceof e.StructureFragment)return!1;if(!(t instanceof e.ChemStructureNode||t instanceof e.ChemMarker.UnbondedElectronSet)||!(r instanceof e.ChemStructureNode||r instanceof e.ChemMarker.UnbondedElectronSet))return!1;if(t.getClassName()!==r.getClassName())return!1;var a=t.getParent(),o=r.getParent(),s=a===o||i;return n||(s=s&&!t.getConnectorTo(r)),s},e.ChemStructOperation.AnchorNodesPreview=n.create(e.ChemStructOperation.MergeNodesBase,{CLASS_NAME:"Kekule.ChemStructOperation.AnchorNodesPreview",initialize:function($super,e,t,r){$super(e,t,!0,r)},doExecute:function(){this._moveNodeOperations=[];var t=this.getTarget(),r=this.getDest(),i=e.CoordMode,n=[i.COORD2D];try{for(var a=0,o=n.length;a<o;++a){var s=r.getAbsBaseCoord(n[a],!1),l=new e.ChemObjOperation.MoveTo(t,s,n[a],!0,this.getEditor());l.execute(),this._moveNodeOperations.push(l)}t.setAnchorObj(r.getId()),r.getAttachedArcNodeIds()[t.getId()]=t.getId(),r.addEventListener("objectMoved",this.moveCurveArrowToMatchChemStructure,this)}finally{}try{if(t instanceof e.Glyph.PathGlyphNode&&r instanceof e.Bond){var d=r.getParent();if(d&&d instanceof e.Molecule){var u=d.getConnectors();if(u&&u.length){var c=!0,h=!1,m=void 0;try{for(var g,f=u[Symbol.iterator]();!(c=(g=f.next()).done);c=!0){var p=g.value;if(p.id!==r.id){var C=p.getAttachedArcNodeIds();C[t.id]&&delete C[t.id]}}}catch(e){h=!0,m=e}finally{try{!c&&f.return&&f.return()}finally{if(h)throw m}}}}}}catch(e){console.error(e)}},doReverse:function(){var e=this.getTarget(),t=this.getDest();try{for(var r=this._moveNodeOperations,i=r.length-1;i>=0;--i)r[i].reverse();this.removeListenersOnCurveArrow(e,t)}finally{}this._moveNodeOperations=null}}),e.ChemStructOperation.MergeNodesPreview=n.create(e.ChemStructOperation.MergeNodesBase,{CLASS_NAME:"Kekule.ChemStructOperation.MergeNodesPreview",initialize:function($super,e,t,r,i){$super(e,t,r,i),this._nodeParent=null},doExecute:function(){this._moveNodeOperations=[];var t=this.getTarget(),r=this.getDest(),i=t instanceof e.ChemMarker.UnbondedElectronSet?t.getParent().getParentFragment():t.getParentFragment(),n=e.CoordMode,a=[n.COORD2D,n.COORD3D];i&&i.beginUpdate();try{for(var o=0,s=a.length;o<s;++o){var l=r.getAbsBaseCoord(a[o],!1),d=new e.ChemObjOperation.MoveTo(t,l,a[o],!0,this.getEditor());d.execute(),this._moveNodeOperations.push(d)}this._nodeParent=i}finally{i&&i.endUpdate()}},doReverse:function(){var e=this._nodeParent;e&&e.beginUpdate();try{for(var t=this._moveNodeOperations,r=t.length-1;r>=0;--r)t[r].reverse()}finally{e&&e.endUpdate()}this._moveNodeOperations=null}}),e.ChemStructOperation.MergeNodesPreview.canMerge=e.ChemStructOperation.MergeNodes.canMerge,e.ChemStructOperation.MergeConnectorsBase=n.create(e.ChemObjOperation.Base,{CLASS_NAME:"Kekule.ChemStructOperation.MergeConnectorsBase",initialize:function($super,t,r,i,n,a){$super(t,a),this.setDest(r),this.setCoordMode(i||e.CoordMode.COORD2D),this.setEnableStructFragmentMerge(n||!1),this._refSibling=null,this._nodeParent=null,this._nodeMergeOperations=[]},initProperties:function(){this.defineProp("dest",{dataType:"Kekule.ChemStructureConnector",serializable:!1}),this.defineProp("enableStructFragmentMerge",{dataType:a.BOOL}),this.defineProp("coordMode",{dataType:a.INT})},getMergeNodeOperationClass:function(){},doExecute:function(){e.ChemStructOperation.MergeConnectors.canMerge(this.getTarget(),this.getDest(),this.getEnableStructFragmentMerge())||e.error(e.$L("ErrorMsg.CAN_NOT_MERGE_CONNECTORS"));for(var t=this.getCoordMode(),r=[this.getTarget(),this.getDest()],i=e.ArrayUtils,n=i.clone(this.getTarget().getConnectedObjs()),a=i.clone(this.getDest().getConnectedObjs()),o=this.getAllowCoordBorrow(),s=0,l=r.length;s<l;++s){var d=r[s],u=d.getConnectedObjAt(0).getAbsCoordOfMode(t,o),c=d.getConnectedObjAt(1).getAbsCoordOfMode(t,o),h=e.CoordUtils.substract(u,c),m=Math.abs(h.x)>Math.abs(h.y)?"x":"y";e.ObjUtils.notUnset(u.z)&&Math.abs(h.z)>Math.abs(h.x)&&(m="z");(0===s?n:a).sort(function(e,r){var i=e.getAbsCoordOfMode(t,o),n=r.getAbsCoordOfMode(t,o);return i[m]-n[m]||0})}var g=i.intersect(n,a);n=i.exclude(n,g),a=i.exclude(a,g),this._nodeMergeOperations=[];for(var f=this.getMergeNodeOperationClass(),s=0,l=n.length;s<l;++s){if(n[s]!==a[s]){var p=new f(n[s],a[s],this.getEnableStructFragmentMerge());p.execute()}this._nodeMergeOperations.push(p)}},doReverse:function(){for(var e=this._nodeMergeOperations.length-1;e>=0;--e){this._nodeMergeOperations[e].reverse()}this._nodeMergeOperations=[]}}),e.ChemStructOperation.MergeConnectors=n.create(e.ChemStructOperation.MergeConnectorsBase,{CLASS_NAME:"Kekule.ChemStructOperation.MergeConnectors",getMergeNodeOperationClass:function(){return e.ChemStructOperation.MergeNodes}}),e.ChemStructOperation.MergeConnectors.canMerge=function(t,r,i){if(!r||!r.isConnectingConnector)return!1;if(!i&&t.getParent()!==r.getParent())return!1;if(t.isConnectingConnector()||r.isConnectingConnector())return!1;var n=t.getConnectedExposedObjs(),a=r.getConnectedObjs();return n.length===a.length&&(2===n.length&&(!(e.ArrayUtils.intersect(n,a).length>=1)&&!(t instanceof e.Bond&&r instanceof e.Glyph.PathGlyphArcConnector)))},e.ChemStructOperation.MergeConnectorsPreview=n.create(e.ChemStructOperation.MergeConnectorsBase,{CLASS_NAME:"Kekule.ChemStructOperation.MergeConnectors",getMergeNodeOperationClass:function(){return e.ChemStructOperation.MergeNodesPreview}}),e.ChemStructOperation.MergeConnectorsPreview.canMerge=e.ChemStructOperation.MergeConnectors.canMerge,e.ChemStructOperation.MergeStructFragment=n.create(e.ChemObjOperation.Base,{CLASS_NAME:"Kekule.ChemStructOperation.MergeStructFragment",initialize:function($super,e,t,r){$super(e,r),this.setDest(t),this._removeOperation=null},initProperties:function(){this.defineProp("dest",{dataType:"Kekule.StructureFragment",serializable:!1}),this.defineProp("mergedNodes",{dataType:a.ARRAY,serializable:!1}),this.defineProp("mergedConnectors",{dataType:a.ARRAY,serializable:!1})},moveChildBetweenStructFragment:function(t,r,i,n){e.ChemStructureUtils.moveChildBetweenStructFragment(t,r,i,n)},doExecute:function(){var t=this.getTarget(),r=this.getDest();if(t&&r){var i=e.ArrayUtils.clone(t.getNodes());this.setMergedNodes(i);var n=e.ArrayUtils.clone(t.getConnectors());this.setMergedConnectors(n),this.moveChildBetweenStructFragment(t,r,i,n);var a=t.getParent();a&&(this._removeOperation=new e.ChemObjOperation.Remove(t,a,null,this.getEditor()),this._removeOperation.execute())}},doReverse:function(){var e=this.getTarget(),t=this.getDest();if(e&&t){this._removeOperation&&(this._removeOperation.reverse(),this._removeOperation=null);var r=this.getMergedNodes(),i=this.getMergedConnectors();this.moveChildBetweenStructFragment(t,e,r,i)}}}),e.ChemStructOperation.SplitStructFragment=n.create(e.ChemObjOperation.Base,{CLASS_NAME:"Kekule.ChemStructOperation.SplitStructFragment",initialize:function($super,e,t){$super(e,t)},initProperties:function(){this.defineProp("splittedFragments",{dataType:a.ARRAY,serializable:!1,setter:null})},doExecute:function(){var t=e.ChemStructureUtils.splitStructFragment(this.getTarget());if(t.length>1){this.setPropStoreFieldValue("splittedFragments",t);var r=this.getTarget().getParent(),i=this.getTarget().getNextSibling();r.beginUpdate();try{if(r)for(var n=1,a=t.length;n<a;++n){var o=t[n];r.insertBefore(o,i)}}finally{r.endUpdate()}}else this.setPropStoreFieldValue("splittedFragments",null)},doReverse:function(){var t=this.getSplittedFragments();if(t&&t.length)for(var r=this.getTarget(),i=0,n=t.length;i<n;++i){var a=t[i];if(a!==r){e.ChemStructureUtils.moveChildBetweenStructFragment(a,r,e.ArrayUtils.clone(a.getNodes()),e.ArrayUtils.clone(a.getConnectors()));var o=a.getParent();o&&o.removeChild(a),a.finalize()}}}}),e.ChemStructOperation.StandardizeStructFragment=n.create(e.ChemObjOperation.Base,{CLASS_NAME:"Kekule.ChemStructOperation.StandardizeStructFragment",initialize:function($super,e,t){$super(e,t),this.setEnableSplit(!0),this.setEnableRemove(!0),this._concreteOper=null},initProperties:function(){this.defineProp("enableRemove",{dataType:a.BOOL}),this.defineProp("enableSplit",{dataType:a.BOOL})},doExecute:function(){var t=this.getTarget(),r=t.getNodeCount();this._concreteOper=null;var i=this.getEditor();return r<=0?this.getEnableRemove()&&(this._concreteOper=new e.ChemObjOperation.Remove(t,null,null,i)):this.getEnableSplit()&&(this._concreteOper=new e.ChemStructOperation.SplitStructFragment(t,i)),this._concreteOper?this._concreteOper.execute():null},doReverse:function(){return this._concreteOper?this._concreteOper.reverse():null}}),e.ChemSpaceEditorOperation={},e.ChemSpaceEditorOperation.ChangeSpaceSize=n.create(e.ChemObjOperation.Base,{CLASS_NAME:"Kekule.ChemSpaceEditorOperation.ChangeSpaceSize",initialize:function($super,t,r,i,n){$super(t,n),this.setCoordMode(i||e.CoordMode.COORD2D),r&&this.setNewSize(r)},initProperties:function(){this.defineProp("coordMode",{dataType:a.INT}),this.defineProp("newSize",{dataType:a.HASH}),this.defineProp("oldSize",{dataType:a.HASH})},doExecute:function(){var e=this.getEditor(),t=this.getTarget();try{var r=this.getCoordMode();this.getOldSize()||this.setOldSize(Object.extend({},t.getSizeOfMode(r,e.getAllowCoordBorrow()))),e.changeChemSpaceSize(this.getNewSize(),r)}finally{}},doReverse:function(){var e=this.getEditor();this.getTarget();if(this.getOldSize())try{var t=this.getCoordMode();e.changeChemSpaceSize(this.getOldSize(),t)}finally{}}}),e.ChemSpaceEditorOperation.ShiftChildrenCoords=n.create(e.ChemObjOperation.Base,{CLASS_NAME:"Kekule.ChemSpaceEditorOperation.ShiftChildrenCoords",initialize:function($super,t,r,i,n){$super(t,n),this.setCoordMode(i||e.CoordMode.COORD2D),r&&this.setCoordDelta(r)},initProperties:function(){this.defineProp("coordMode",{dataType:a.INT}),this.defineProp("coordDelta",{dataType:a.HASH})},doExecute:function(){var e=this.getEditor(),t=(this.getTarget(),this.getCoordDelta()),r=this.getCoordMode();try{e._shiftChemSpaceChildCoord(t,r)}finally{}},doReverse:function(){var t=this.getEditor(),r=(this.getTarget(),e.CoordUtils.multiply(this.getCoordDelta(),-1)),i=this.getCoordMode();try{t._shiftChemSpaceChildCoord(r,i)}finally{}}}),e.ChemSpaceEditorOperation.ChangeSpaceSizeAndShiftChildrenCoords=n.create(e.ChemObjOperation.Base,{CLASS_NAME:"Kekule.ChemSpaceEditorOperation.ChangeSpaceSizeAndShiftChildrenCoords",initialize:function($super,t,r,i,n,a){this.setPropStoreFieldValue("restoreScrollPosition",!0),$super(t,a),this.setCoordMode(n||e.CoordMode.COORD2D),r&&this.setNewSize(r),i&&this.setCoordDelta(i)},initProperties:function(){this.defineProp("restoreScrollPosition",{dataType:a.BOOL}),this.defineProp("coordMode",{dataType:a.INT}),this.defineProp("coordDelta",{dataType:a.HASH}),this.defineProp("newSize",{dataType:a.HASH}),this.defineProp("oldSize",{dataType:a.HASH,serializable:!1})},doExecute:function(){var t=this.getEditor(),r=this.getTarget();try{var i,n=this.getCoordMode(),a=this.getRestoreScrollPosition();a&&(i=t.getClientScrollCoord(e.Editor.CoordSys.CHEM)),this.getNewSize()&&(this.getOldSize()||this.setOldSize(Object.extend({},r.getSizeOfMode(n,t.getAllowCoordBorrow()))),t.changeChemSpaceSize(this.getNewSize(),n)),this.getCoordDelta()&&(t._shiftChemSpaceChildCoord(this.getCoordDelta(),n),i=e.CoordUtils.add(i,this.getCoordDelta())),a&&t._registerAfterUpdateObjectProc(function(){t.scrollClientToCoord(i,e.Editor.CoordSys.CHEM)})}finally{}},doReverse:function(){var t=this.getEditor();this.getTarget();if(this.getOldSize()||this.getCoordDelta())try{var r,i=this.getRestoreScrollPosition(),n=this.getCoordMode();i&&(r=t.getClientScrollCoord(e.Editor.CoordSys.CHEM)),this.getCoordDelta()&&(t._shiftChemSpaceChildCoord(e.CoordUtils.multiply(this.getCoordDelta(),-1),n),r=e.CoordUtils.substract(r,this.getCoordDelta())),this.getOldSize()&&t.changeChemSpaceSize(this.getOldSize(),n),this.getRestoreScrollPosition()&&r&&t._registerAfterUpdateObjectProc(function(){t.scrollClientToCoord(r,e.Editor.CoordSys.CHEM)})}finally{}}}),e}},function(e,t,r){"use strict";r(0).Class,r(0).ClassEx,r(0).DataType;e.exports=function(e){return e.Editor.StructureUtils={getCascadeDeleteObjs:function(t){return e.ChemStructureUtils.getCascadeDeleteObjs(t)},getSurroundingObjs:function(t){var r=t instanceof e.ChemMarker.UnbondedElectronSet?t.getParent().getLinkedObjs():t.getLinkedObjs();if(t instanceof e.ChemStructureConnector){var i=t.getConnectedObjs();e.ArrayUtils.pushUnique(r,i)}return r},calcMostEmptyDirectionAngleOfChemObj:function(t,r,i){var n=[];r||(r=t.getLinkedObjs());for(var a=t.getAbsBaseCoord2D(i),o=0,s=r.length;o<s;++o){var l=r[o].getAbsBaseCoord2D(i);l=e.CoordUtils.substract(l,a);var d=Math.atan2(l.y,l.x);d<0&&(d=2*Math.PI+d),n.push(d)}n.sort();var s=n.length;if(0===s)return 0;if(1===s)return-n[0];for(var u=0,c=0,o=0;o<s;++o){var h=n[o],m=n[(o+1)%s],g=m-h;g<0&&(g+=2*Math.PI),g>u&&(u=g,c=o)}return n[c]+u/2},calcPreferred2DBondGrowingDirection:function(t,r,i){var n=t.getAbsBaseCoord2D(i),a=e.Editor.StructureUtils.getSurroundingObjs(t);switch(a?a.length:0){case 0:return r;case 1:var o=a[0],s=o.getAbsBaseCoord2D(i),l=e.CoordUtils.substract(s,n),d=Math.atan2(l.y,l.x),u=d-r,c=d+r;u<0&&(u+=2*Math.PI),c<0&&(c+=2*Math.PI);var h;return h=u!==c?Math.min(u>Math.PI?Math.abs(u-2*Math.PI):u,Math.abs(u-Math.PI))<=Math.min(c>Math.PI?Math.abs(c-2*Math.PI):c,Math.abs(c-Math.PI))?u:c:u;default:var h=e.Editor.StructureUtils.calcMostEmptyDirectionAngleOfChemObj(t,a,i);return h}},calcPreferred2DBondGrowingLocation:function(t,r,i,n){var a=t.getAbsBaseCoord2D(n),o=e.Editor.StructureUtils.calcPreferred2DBondGrowingDirection(t,i,n);return e.CoordUtils.add(a,{x:r*Math.cos(o),y:r*Math.sin(o)})},isBondPropsMatch:function(t,r,i){var n=["bondType","bondOrder","stereo"],a=!0;return a&&i.indexOf("bondType")>=0&&(a=t.bondType==r.bondType||!t.bondType&&!r.bondType),a&&t.bondType===e.BondType.COVALENT&&((a&&i.indexOf("bondOrder")>=0||!t.bondOrder&&!r.bondOrder)&&(a=t.bondOrder==r.bondOrder),a&&i.indexOf("stereo")>=0&&(a=t.stereo==r.stereo||!t.stereo&&!r.stereo)),a&&(a=e.ObjUtils.equal(t,r,n)),a},getChemStructureNodeLabel:function(t,r){if(t.getIsotopeId)return t.getIsotopeId();if(t instanceof e.SubGroup){var i=t.getAbbr()||t.getFormulaText();return r&&(i=i||r.getRgroup()),i}var n=t.getCoreDisplayRichTextItem(null,null,r);return e.Render.RichTextUtils.toText(n)},getAllChemStructureNodesLabel:function(t,r){for(var i,n=0,a=t.length;n<a;++n){var o=t[n],s=e.Editor.StructureUtils.getChemStructureNodeLabel(o,r);if(i){if(i!==s)return null}else i=s}return i},getAllChemStructureNodesHtmlCode:function(t,r,i,n){for(var a,o=0,s=t.length;o<s;++o){var l=t[o],d=l.getCoreDisplayRichTextItem(r,i,n),u=e.Render.RichTextUtils.toSimpleHtmlCode(d);if(a){if(a!==u)return null}else a=u}return a},getStructureCenterAbsBaseCoord:function(t,r,i){for(var n=null,a=e.CoordUtils.add,o=t.getNodeCount(),s=0;s<o;++s){var l=t.getNodeAt(s),d=l.getAbsBaseCoord(r,i);n=n?a(n,d):d}return n=e.CoordUtils.divide(n,o)}},e.Editor.RepositoryStructureUtils={_calcNodeMergeAdjustRotateAngle:function(t,r,i){var n=0,a=t.getCoordMode();if(a!==e.CoordMode.COORD3D){var o=t.getAllowCoordBorrow(),s=t.getEditorConfigs().getStructureConfigs(),l=e.Editor.StructureUtils.getSurroundingObjs(r),d=e.Editor.StructureUtils.getSurroundingObjs(i);if(1===l.length){var u=r.getLinkedConnectorAt(0),c=u.getBondOrder?u.getBondOrder():0,h=s.getNewBondDefAngle(i,c);g=e.Editor.StructureUtils.calcPreferred2DBondGrowingDirection(i,h,o);var m=e.ChemStructureUtils.getAbsCoordVectorBetweenObjs(r,l[0],a,o);n=g-Math.atan2(m.y,m.x)}else if(1===d.length){var u=i.getLinkedConnectorAt(0),c=u.getBondOrder?u.getBondOrder():0,h=s.getNewBondDefAngle(r,c),g=e.Editor.StructureUtils.calcPreferred2DBondGrowingDirection(r,h,o),m=e.ChemStructureUtils.getAbsCoordVectorBetweenObjs(i,d[0],a,o),f=Math.atan2(m.y,m.x);n=f-g}else{for(var h=s.getNewBondDefAngle(i,null),g=e.Editor.StructureUtils.calcPreferred2DBondGrowingDirection(i,h,o),p={},C=0,b=l.length;C<b;++C){var m=e.ChemStructureUtils.getAbsCoordVectorBetweenObjs(r,l[C],a,o),E=Math.atan2(m.y,m.x);(e.ObjUtils.isUnset(p.min)||E<p.min)&&(p.min=E),(e.ObjUtils.isUnset(p.max)||E>p.max)&&(p.max=E)}var N=(p.max+p.min)/2;n=g-N}}return n},_calcConnectorMergeTransformParams:function(t,r,i){var n=r.getConnectedObjAt(0),a=r.getConnectedObjAt(1),o=i.getConnectedObjAt(0),s=i.getConnectedObjAt(1),l=t.getObjCoord(n),d=t.getObjCoord(a),u=t.getObjCoord(o),c=t.getObjCoord(s);return e.CoordUtils.calcCoordGroup2DTransformParams(l,d,c,u)},calcRepObjInitialTransformParams:function(t,r,i,n,a){var o,s=i.baseObjCoord,l=t.getDefBondLength(),d=l/r.getRefLength(),u=s;if(i.mergeObj){var n=i.mergeDest||n;if(n)if(a=t.getObjectScreenCoord(n),i.mergeObj instanceof e.ChemStructureNode&&n instanceof e.ChemStructureNode)o=e.Editor.RepositoryStructureUtils._calcNodeMergeAdjustRotateAngle(t,i.mergeObj,n);else if(i.mergeObj instanceof e.ChemStructureConnector&&n instanceof e.ChemStructureConnector)return e.Editor.RepositoryStructureUtils._calcConnectorMergeTransformParams(t,i.mergeObj,n)}var c=t.translateCoord(a,e.Editor.CoordSys.SCREEN,e.Editor.CoordSys.CHEM);return s&&(c=e.CoordUtils.substract(c,s)),{scale:d,translateX:c.x,translateY:c.y,translateZ:c.z,rotateAngle:o,center:u}},transformChemObjectsCoordAndSize:function(t,r,i){var n=t.getCoordMode(),a=t.getAllowCoordBorrow(),o=n===e.CoordMode.COORD3D?e.CoordUtils.calcTransform3DMatrix(i):e.CoordUtils.calcTransform2DMatrix(i),s=Object.extend({},i);s=Object.extend(s,{translateX:0,translateY:0,translateZ:0,center:{x:0,y:0,z:0}});for(var l=n===e.CoordMode.COORD3D?e.CoordUtils.calcTransform3DMatrix(s):e.CoordUtils.calcTransform2DMatrix(s),d=0,u=r.length;d<u;++d){var c=r[d];c.transformAbsCoordByMatrix(o,l,n,!0,a),c.scaleSize(i.scale,n,!0,a)}}},e}},function(e,t,r){"use strict";var i=r(0).Class,n=(r(0).ClassEx,r(0).DataType);e.exports=function(e){var t=i.PropertyScope;return e.Editor.BaseEditorConfigs=i.create(e.ChemWidget.ChemObjDisplayerConfigs,{CLASS_NAME:"Kekule.Editor.BaseEditorConfigs",initProperties:function(){this.addConfigProp("uiMarkerConfigs","Kekule.EditorConfigs.UiMarkerConfigs"),this.addConfigProp("interactionConfigs","Kekule.EditorConfigs.InteractionConfigs"),this.addConfigProp("structureConfigs","Kekule.Editor.StructureConfigs")},initPropValues:function($super){$super(),this.setPropStoreFieldValue("uiMarkerConfigs",new e.Editor.UiMarkerConfigs),this.setPropStoreFieldValue("interactionConfigs",new e.Editor.InteractionConfigs),this.setPropStoreFieldValue("structureConfigs",new e.Editor.StructureConfigs)}}),e.Editor.ChemSpaceEditorConfigs=i.create(e.Editor.BaseEditorConfigs,{CLASS_NAME:"Kekule.Editor.ChemSpaceEditorConfigs",initProperties:function(){this.addConfigProp("chemSpaceConfigs","Kekule.Editor.ChemSpaceConfigs"),this.addConfigProp("styleSetterConfigs","Kekule.Editor.StyleSetterConfigs",void 0,{scope:t.PUBLIC})},initPropValues:function($super){$super(),this.setPropStoreFieldValue("chemSpaceConfigs",new e.Editor.ChemSpaceConfigs),this.setPropStoreFieldValue("styleSetterConfigs",new e.Editor.StyleSetterConfigs)}}),e.ClassUtils.makeSingleton(e.Editor.ChemSpaceEditorConfigs),e.Editor.InteractionConfigs=i.create(e.AbstractConfigs,{CLASS_NAME:"Kekule.Editor.InteractionConfigs",initProperties:function(){var e=Math.PI/180;this.addBoolConfigProp("enableTrackOnNearest",!0),this.addBoolConfigProp("enableHotTrack",!0),this.addBoolConfigProp("scrollToObjAfterLoading",!0),this.addBoolConfigProp("autoExpandClientSizeAfterLoading",!0),this.addBoolConfigProp("autoExpandClientSizeAfterManipulation",!1),this.addBoolConfigProp("autoSelectNewlyInsertedObjects",!1),this.addBoolConfigProp("autoSelectNewlyInsertedObjectsOnTouch",!0),this.addIntConfigProp("objBoundTrackMinInflation",5),this.addIntConfigProp("objBoundTrackMinInflationMouse",null),this.addIntConfigProp("objBoundTrackMinInflationPen",null),this.addIntConfigProp("objBoundTrackMinInflationTouch",10),this.addFloatConfigProp("objBoundTrackInflationRatio",.2),this.addFloatConfigProp("objBoundTrackInflationRatioMouse",null),this.addFloatConfigProp("objBoundTrackInflationRatioPen",null),this.addFloatConfigProp("objBoundTrackInflationRatioTouch",.33),this.addBoolConfigProp("enablePartialAreaSelecting",!1),this.addFloatConfigProp("selectingBrushWidth",12),this.addBoolConfigProp("enableOffSelectionManipulation",!0),this.addIntConfigProp("offSelectionManipulationActivatingTimeThreshold",800),this.addFloatConfigProp("unmovePointerDistanceThreshold",5,{scope:t.PUBLIC}),this.addIntConfigProp("selectingCurveSimplificationDistanceThreshold",2,{scope:t.PUBLIC}),this.addIntConfigProp("selectionMarkerInflation",5),this.addIntConfigProp("selectionMarkerEdgeInflation",5),this.addIntConfigProp("selectionMarkerDefPulseDuration",500),this.addIntConfigProp("selectionMarkerDefPulseCount",2),this.addBoolConfigProp("followPointerCoordOnDirectManipulatingSingleObj",!0),this.addIntConfigProp("followPointerCoordOnDirectManipulatingSingleObjDistanceThreshold",2),this.addFloatConfigProp("constrainedResizeStep",.125),this.addIntConfigProp("rotationRegionInflation",10),this.addFloatConfigProp("constrainedRotateStep",7.5*e),this.addIntConfigProp("rotationLocationPointDistanceThreshold",10),this.addIntConfigProp("directedMoveDistanceThreshold",10),this.addBoolConfigProp("enableMergePreview",!0),this.addBoolConfigProp("enableGestureManipulation",!0),this.addBoolConfigProp("enableGestureZoomOnEditor",!0),this.addIntConfigProp("clonedObjectScreenOffset",10),this.addIntConfigProp("atomSetterFontSize",14),this.addBoolConfigProp("allowUnknownAtomSymbol",!0),this.addBoolConfigProp("enableBondKekulizeHucklize",!0),this.addIntConfigProp("trackSimplifierDistanceThreshold",8),this.addIntConfigProp("trackSimplifierIgnoreSegmentThreshold",10),this.addIntConfigProp("trackMergeDistanceThreshold",20),this.addFloatConfigProp("trackOptimizationAngleConstraint",30*e),this.addConfigProp("trackOptimizationDistanceConstraints",n.ARRAY,void 0,{scope:t.PUBLIC}),this.addIntConfigProp("trackOptimizationPrimaryDistanceConstraint",1),this.addFloatConfigProp("trackTouchRefLength",.5,{scope:t.PUBLIC}),this.addBoolConfigProp("autoAdjustZoomLevelOnTrackTouching",!1,{scope:t.PUBLIC}),this.addFloatConfigProp("editorInitialZoom",1.5)},initPropValues:function($super){$super(),this.setTrackOptimizationDistanceConstraints([.5,1,3,4,5])}}),e.Editor.UiMarkerConfigs=i.create(e.AbstractConfigs,{CLASS_NAME:"Kekule.Editor.UiMarkerConfigs",initProperties:function(){this.addStrConfigProp("hotTrackerColor","#0000FF"),this.addFloatConfigProp("hotTrackerOpacity",.5),this.addStrConfigProp("selectionMarkerStrokeColor","#0000FF"),this.addFloatConfigProp("selectionMarkerStrokeWidth",2),this.addStrConfigProp("selectionMarkerFillColor","#0000FF"),this.addFloatConfigProp("selectionMarkerOpacity",.2),this.addFloatConfigProp("selectionMarkerEmphasisOpacity",.4),this.addFloatConfigProp("selectionTransformMarkerSize",8,{scope:t.PUBLIC}),this.addFloatConfigProp("selectionTransformMarkerOpacity",.4,{scope:t.PUBLIC}),this.addStrConfigProp("selectingMarkerStrokeColor","#000000"),this.addFloatConfigProp("selectingMarkerStrokeWidth",1),this.addStrConfigProp("selectingMarkerStrokeDash",!0),this.addStrConfigProp("selectingMarkerFillColor",null),this.addFloatConfigProp("selectingMarkerOpacity",.7),this.addStrConfigProp("selectingBrushMarkerStrokeColor","#0000FF"),this.addStrConfigProp("selectingBrushMarkerStrokeDash",!1),this.addFloatConfigProp("selectingBrushMarkerStrokeLineCap","round"),this.addFloatConfigProp("selectingBrushMarkerStrokeLineJoin","round"),this.addFloatConfigProp("selectingBrushMarkerOpacity",.3),this.addStrConfigProp("trackMarkerStrokeColor","#0000AA"),this.addFloatConfigProp("trackMarkerStrokeWidth",2),this.addStrConfigProp("trackMarkerStrokeDash",!1),this.addFloatConfigProp("trackMarkerOpacity",.5),this.addStrConfigProp("flexStructureAssocMarkerColor","#0000AA"),this.addFloatConfigProp("flexStructureAssocMarkerOpacity",.5),this.addIntConfigProp("flexStructureAssocMarkerFontSize",14),this.addStrConfigProp("flexStructureAssocMarkerFontFamily","Arial, Helvetica, sans-serif")}}),e.Editor.StructureConfigs=i.create(e.AbstractConfigs,{CLASS_NAME:"Kekule.Editor.StructureConfigs",initProperties:function(){this.addStrConfigProp("defBondType",e.BondType.DEFAULT,{enumSource:e.BondType}),this.addIntConfigProp("defBondOrder",e.BondOrder.SINGLE,{enumSource:e.BondOrder}),this.addFloatConfigProp("defBondLength",.8),this.addConfigProp("defBondAngles",n.ARRAY,void 0,{scope:t.PUBLIC}),this.addFloatConfigProp("bondConstrainedDirectionDelta",void 0,{scope:t.PUBLIC}),this.addConfigProp("bondConstrainedDirectionAngles",n.ARRAY,void 0,{scope:t.PUBLIC}),this.addFloatConfigProp("bondConstrainedDirectionAngleThreshold",void 0,{scope:t.PUBLIC}),this.addFloatConfigProp("initialBondDirection",void 0,{scope:t.PUBLIC}),this.addStrConfigProp("defIsotopeId","C"),this.addConfigProp("primaryOrgChemAtoms",n.ARRAY,void 0,{scope:t.PUBLIC}),this.addIntConfigProp("maxFlexChainAtomCount",0),this.addIntConfigProp("minFlexRingAtomCount",3),this.addIntConfigProp("maxFlexRingAtomCount",18),this.addHashConfigProp("enabledNonAtomNodeTypes",{RGroup:!1,pseudoatomDummy:!0,pseudoatomHetero:!0,pseudoatomAny:!0,variableAtomList:!0,variableAtomNotList:!0}),this.addHashConfigProp("enabledBondForms",{single:!0,double:!0,triple:!0,quad:!0,explicitAromatic:!0,up:!0,upInverted:!0,down:!0,downInverted:!0,upOrDown:!0,eOrZ:!0,closer:!0,ionic:!1,coordinate:!1,metallic:!1,hydrogen:!0})},initPropValues:function($super){$super();var t=Math.PI/180,r=[],i=e.BondOrder,n=2*Math.PI/3;r[0]=n,r[i.EXPLICIT_AROMATIC]=[n],r[i.TRIPLE]=[Math.PI],r[i.DOUBLE]=[n],r[i.DOUBLE][i.DOUBLE]=Math.PI,r[i.SINGLE]=[n],this.setDefBondAngles(r),this.setBondConstrainedDirectionDelta(10*Math.PI/180),this.setBondConstrainedDirectionAngles([0,90*t,180*t,270*t]),this.setBondConstrainedDirectionAngleThreshold(3*t),this.setInitialBondDirection(30*t),this.setPrimaryOrgChemAtoms(["C","H","O","N","P","S","F","Cl","Br","I","Si","D","C13"])},getDefAngleOfBonds:function(e,t){var r=e||0,i=t||0;r>i&&(r=t||0,i=e||0);var n=this.getDefBondAngles(),a=n[i];if(a){return a[r]||a[0]}return n[0]},getNewBondDefAngle:function(t,r){e.ObjUtils.isUnset(r)&&(r=this.getDefBondOrder());var i,n=e.Editor.StructureUtils.getSurroundingObjs(t);if(1===n.length){var a=t.getLinkedConnectorAt(0);if(a&&a.getConnectedObjs().indexOf(n[0])>=0){var o=a.getBondOrder?a.getBondOrder():null;e.ObjUtils.notUnset(o)&&(i=this.getDefAngleOfBonds(r,o))}}else i=0===n.length?this.getInitialBondDirection():this.getDefAngleOfBonds(r,0);return i}}),e.Editor.ChemSpaceConfigs=i.create(e.AbstractConfigs,{CLASS_NAME:"Kekule.Editor.ChemSpaceConfigs",initProperties:function(){this.addHashConfigProp("defScreenSize2D"),this.addHashConfigProp("defScreenSize3D"),this.addHashConfigProp("autoExpandScreenSize2D"),this.addHashConfigProp("autoExpandScreenSize3D"),this.addNumConfigProp("defPadding",50)},initPropValues:function($super){$super(),this.setDefScreenSize3D({x:600,y:600,z:600}),this.setAutoExpandScreenSize2D({x:200,y:200}),this.setAutoExpandScreenSize3D({x:100,y:100,z:100})}}),e.Editor.StyleSetterConfigs=i.create(e.AbstractConfigs,{CLASS_NAME:"Kekule.Editor.StyleSetterConfigs",initProperties:function(){this.defineProp("listedFontSizes",{dataType:n.ARRAY}),this.defineProp("listedFontNames",{dataType:n.ARRAY})},initPropValues:function($super){$super(),this.setListedFontSizes([8,9,10,11,12,14,16,18,20,24,28,32,36,40,44,48,54,60,66,72,80,88,96]),this.setListedFontNames(e.Widget.FontEnumerator.getAvailableFontFamilies())}}),e}},function(e,t,r){"use strict";e.exports=function(e){return e.Editor.RepositoryData={subGroups:[{name:"methyl",inputTexts:["Me","CH3"],dataFormat:"Kekule-JSON",structData:'{"id":null,"info":{"generator":"ChemDraw","date":{"__type__":"date","date":"Thu, 15 Sep 2016 15:49:02 GMT"},"__type__":"object"},"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[],"connectors":[],"__type__":"Kekule.StructureConnectionTable"},"abbr":"Me","__type__":"Kekule.SubGroup"}'},{name:"ethyl",inputTexts:["Et","C2H5"],structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":-0.34641016151377535,"y":-0.19999999999999574,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.34641016151377535,"y":0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]}],"__type__":"Kekule.StructureConnectionTable"},"abbr":"Et","__type__":"Kekule.SubGroup"}'},{name:"n-propyl",inputTexts:["n-Pr","nPr","C3H7"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":-0.6928203230275507,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0,"y":0.19999999999999574,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.6928203230275507,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,2]}],"__type__":"Kekule.StructureConnectionTable"},"abbr":"n-Pr","formulaText":"C3H7","__type__":"Kekule.SubGroup"}'},{name:"i-propyl",inputTexts:["i-Pr","iPr"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[],"coord2D":{"x":-0.6928203230275507,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":0,"y":0.19999999999999574,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[],"coord2D":{"x":0.6928203230275507,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[1],"connectors":[{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,2]}],"__type__":"Kekule.StructureConnectionTable"},"abbr":"i-Pr","__type__":"Kekule.SubGroup"}'},{name:"n-butyl",inputTexts:["n-Bu","nBu","C4H9"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":-1.039230484541326,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[],"coord2D":{"x":-0.34641016151377535,"y":0.19999999999999574,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[],"coord2D":{"x":0.34641016151377535,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":1.039230484541326,"y":0.19999999999999574,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,2]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[2,3]}],"__type__":"Kekule.StructureConnectionTable"},"abbr":"n-Bu","formulaText":"C4H9","__type__":"Kekule.SubGroup"}'},{name:"i-butyl",inputTexts:["i-Bu","iBu"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":-0.6928203230275507,"y":-0.5999999999999943,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[],"coord2D":{"x":0,"y":-0.19999999999999574,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[],"coord2D":{"x":0.6928203230275507,"y":-0.5999999999999943,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0,"y":0.6000000000000014,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,2]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,3]}],"__type__":"Kekule.StructureConnectionTable"},"abbr":"i-Bu","__type__":"Kekule.SubGroup"}'},{name:"s-butyl",inputTexts:["s-Bu","sBu"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[],"coord2D":{"x":-1.039230484541326,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":-0.34641016151377535,"y":0.19999999999999574,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[],"coord2D":{"x":0.34641016151377535,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":1.039230484541326,"y":0.19999999999999574,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[1],"connectors":[{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,2]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[2,3]}],"__type__":"Kekule.StructureConnectionTable"},"abbr":"s-Bu","__type__":"Kekule.SubGroup"}'},{name:"t-butyl",inputTexts:["t-Bu","tBu"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":0,"y":-0.3999999999999915,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.6928203230275507,"y":7.105427357601002e-15,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.6928203230275507,"y":7.105427357601002e-15,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0,"y":0.3999999999999986,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,2]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,3]}],"__type__":"Kekule.StructureConnectionTable"},"abbr":"t-Bu","__type__":"Kekule.SubGroup"}'},{name:"phenyl",inputTexts:["Ph","C6H5"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":8.881784197001252e-16,"y":-0.7999999999999972,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.6928203230275516,"y":-0.3999999999999986,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.6928203230275516,"y":0.3999999999999986,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":8.881784197001252e-16,"y":0.7999999999999972,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.6928203230275516,"y":0.3999999999999986,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.6928203230275516,"y":-0.3999999999999986,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[1,2]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[2,3]},{"__type__":"Kekule.Bond","id":null,"overrideRenderOptionItems":[],"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[3,4]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[4,5]},{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[5,0]}],"__type__":"Kekule.StructureConnectionTable"},"abbr":"Ph","formulaText":"C6H5","__type__":"Kekule.SubGroup"}'},{name:"benzyl",inputTexts:["Bn"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":8.881784197001252e-16,"y":-1.1999999999999957,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.6928203230275516,"y":-0.7999999999999972,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.6928203230275516,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":8.881784197001252e-16,"y":0.3999999999999986,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.6928203230275516,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.6928203230275516,"y":-0.7999999999999972,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":8.881784197001252e-16,"y":1.1999999999999957,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[6],"connectors":[{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[1,2]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[2,3]},{"__type__":"Kekule.Bond","id":null,"overrideRenderOptionItems":[],"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[3,4]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[4,5]},{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[5,0]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[3,6]}],"__type__":"Kekule.StructureConnectionTable"},"abbr":"Bn","__type__":"Kekule.SubGroup"}'},{name:"benzoyl",inputTexts:["Bz"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":8.881784197001252e-16,"y":-1.399999999999995,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.6928203230275516,"y":-0.9999999999999964,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.6928203230275516,"y":-0.1999999999999993,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":8.881784197001252e-16,"y":0.1999999999999993,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.6928203230275516,"y":-0.1999999999999993,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.6928203230275516,"y":-0.9999999999999964,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":8.881784197001252e-16,"y":0.9999999999999964,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.6928203230275498,"y":1.399999999999995,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"}],"anchorNodes":[6],"connectors":[{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[1,2]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[2,3]},{"__type__":"Kekule.Bond","id":null,"overrideRenderOptionItems":[],"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[3,4]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[4,5]},{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[5,0]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[3,6]},{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[6,7]}],"__type__":"Kekule.StructureConnectionTable"},"abbr":"Bz","__type__":"Kekule.SubGroup"}'},{inputTexts:["CF3"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":0,"y":-0.3999999999999986,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.6928203230275507,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"F"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.6928203230275507,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"F"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0,"y":0.3999999999999915,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"F"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,2]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,3]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"CF3","__type__":"Kekule.SubGroup"}'},{inputTexts:["CCl3"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":0,"y":-0.3999999999999986,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.6928203230275507,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"Cl"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.6928203230275507,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"Cl"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0,"y":0.3999999999999915,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"Cl"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,2]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,3]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"CCl3","__type__":"Kekule.SubGroup"}'},{inputTexts:["CBr3"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":0,"y":-0.3999999999999986,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.6928203230275507,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"Br"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.6928203230275507,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"Br"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0,"y":0.3999999999999915,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"Br"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,2]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,3]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"CBr3","__type__":"Kekule.SubGroup"}'},{inputTexts:["CI3"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":0,"y":-0.3999999999999986,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.6928203230275507,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"I"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.6928203230275507,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"I"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0,"y":0.3999999999999915,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"I"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,2]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,3]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"CI3","__type__":"Kekule.SubGroup"}'},{inputTexts:["OMe","OCH3"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.34641016151377535,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.34641016151377535,"y":0.19999999999999574,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"OMe","__type__":"Kekule.SubGroup"}'},{inputTexts:["OEt","OC2H5"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.6928203230275507,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0,"y":0.19999999999999574,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.6928203230275507,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,2]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"OEt","__type__":"Kekule.SubGroup"}'},{inputTexts:["Ot-Bu","OtBu"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.6928203230275525,"y":-0.5999999999999943,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-1.7763568394002505e-15,"y":-0.19999999999999574,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.6928203230275454,"y":0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.6928203230275525,"y":-0.6000000000000014,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":1.7763568394002505e-15,"y":0.6000000000000014,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,2]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,3]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,4]}],"__type__":"Kekule.StructureConnectionTable"},"abbr":"Ot-Bu","__type__":"Kekule.SubGroup"}'},{inputTexts:["CO"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":0,"y":-0.3999999999999986,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0,"y":0.3999999999999986,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[0,1]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"CO","__type__":"Kekule.SubGroup"}'},{inputTexts:["CHO"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":0,"y":-0.3999999999999986,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0,"y":0.3999999999999986,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[0,1]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"CHO","__type__":"Kekule.SubGroup"}'},{name:"carboxyl",inputTexts:["COOH","CO2H"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":-0.34641016151377535,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.34641016151377535,"y":0.5999999999999943,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.34641016151377535,"y":-0.6000000000000014,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,2]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"COOH","__type__":"Kekule.SubGroup"}'},{inputTexts:["COOOH","CO3H","CO2OH"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":-0.6928203230275507,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.6928203230275507,"y":0.5999999999999943,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0,"y":-0.6000000000000014,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.6928203230275507,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,2]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[2,3]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"CO3H","__type__":"Kekule.SubGroup"}'},{inputTexts:["COONa"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":-0.6928203230275507,"y":-0.19999999999999574,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.6928203230275507,"y":0.6000000000000014,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0,"y":-0.5999999999999943,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.6928203230275507,"y":-0.19999999999999574,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"Na"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,2]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[2,3]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"COONa","__type__":"Kekule.SubGroup"}'},{inputTexts:["COOK"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":-0.6928203230275507,"y":-0.19999999999999574,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.6928203230275507,"y":0.6000000000000014,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0,"y":-0.5999999999999943,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.6928203230275507,"y":-0.19999999999999574,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"K"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,2]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[2,3]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"COOK","__type__":"Kekule.SubGroup"}'},{inputTexts:["COOCH3","COOMe"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":-0.6928203230275507,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.6928203230275507,"y":0.5999999999999943,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0,"y":-0.6000000000000014,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.6928203230275507,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,2]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[2,3]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"COOMe","__type__":"Kekule.SubGroup"}'},{inputTexts:["COOC2H5","COOEt"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":-1.039230484541326,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-1.039230484541326,"y":0.5999999999999943,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.34641016151377535,"y":-0.6000000000000014,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.34641016151377535,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":1.039230484541326,"y":-0.6000000000000014,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,2]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[2,3]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[3,4]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"COOEt","__type__":"Kekule.SubGroup"}'},{inputTexts:["COCl"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":-0.34641016151377535,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.34641016151377535,"y":0.5999999999999943,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.34641016151377535,"y":-0.6000000000000014,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"Cl"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,2]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"COCl","__type__":"Kekule.SubGroup"}'},{inputTexts:["COBr"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":-0.34641016151377535,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.34641016151377535,"y":0.5999999999999943,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.34641016151377535,"y":-0.6000000000000014,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"Br"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,2]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"COBr","__type__":"Kekule.SubGroup"}'},{inputTexts:["CONH2"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":-0.34641016151377535,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.34641016151377535,"y":0.5999999999999943,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.34641016151377535,"y":-0.6000000000000014,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"N"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,2]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"CONH2","__type__":"Kekule.SubGroup"}'},{inputTexts:["Ac"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":-0.34641016151377535,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.34641016151377535,"y":0.5999999999999943,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.34641016151377535,"y":-0.6000000000000014,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,2]}],"__type__":"Kekule.StructureConnectionTable"},"abbr":"Ac","__type__":"Kekule.SubGroup"}'},{inputTexts:["OAc"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":0,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0,"y":0.5999999999999943,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.6928203230275507,"y":-0.6000000000000014,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.6928203230275507,"y":-0.6000000000000014,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"}],"anchorNodes":[3],"connectors":[{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,2]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,3]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"OAc","__type__":"Kekule.SubGroup"}'},{inputTexts:["MeCO","COMe"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":0.34641016151377535,"y":-0.19999999999999574,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.3464101615137771,"y":0.6000000000000014,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.3464101615137771,"y":-0.5999999999999943,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,2]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"COMe","__type__":"Kekule.SubGroup"}'},{inputTexts:["EtCO","COEt"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":0.6928203230275507,"y":-0.19999999999999574,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.6928203230275525,"y":0.6000000000000014,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-1.7763568394002505e-15,"y":-0.5999999999999943,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.6928203230275507,"y":-0.19999999999999574,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,2]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[2,3]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"COEt","__type__":"Kekule.SubGroup"}'},{name:"hydroxymethyl",inputTexts:["CH2OH"],dataFormat:"Kekule-JSON",structData:'{"coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"coord2D":{"x":-0.3999999999999986,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0.3999999999999968,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"CH2OH","__type__":"Kekule.SubGroup"}'},{name:"amino",inputTexts:["NH2"],dataFormat:"Kekule-JSON",structData:'{"id":null,"info":{"generator":"ChemDraw","date":{"__type__":"date","date":"Thu, 15 Sep 2016 15:49:26 GMT"},"__type__":"object"},"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"N"}],"anchorNodes":[0],"connectors":[],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"NH2","name":"Untitled Document-1","__type__":"Kekule.SubGroup"}'},{inputTexts:["NMe2"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.6928203230275507,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0,"y":0.19999999999999574,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"N"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.6928203230275507,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[1],"connectors":[{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,2]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"NMe2","__type__":"Kekule.SubGroup"}'},{name:"nitro",inputTexts:["NO2"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.6928203230275507,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":0,"y":0.19999999999999574,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"N"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.6928203230275507,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"}],"anchorNodes":[1],"connectors":[{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[1,2]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"NO2","__type__":"Kekule.SubGroup"}'},{name:"nitroso",inputTexts:["NO"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[],"coord2D":{"x":-0.34641016151377535,"y":0.19999999999999574,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"N"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.34641016151377535,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[1,0]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"NO","__type__":"Kekule.SubGroup"}'},{name:"diazo",inputTexts:["N2","NN","N2 +"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"coord2D":{"x":-0.3999999999999986,"y":0,"__type__":"object"},"charge":1,"radical":0,"parity":null,"isotopeId":"N"},{"__type__":"Kekule.Atom","id":null,"coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0.3999999999999986,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"N"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":3,"electronCount":6,"isInAromaticRing":false,"connectedObjs":[0,1]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"N2 +","__type__":"Kekule.SubGroup"}'},{inputTexts:["N2Cl","NNCl","N2 +Cl-"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"coord2D":{"x":1.7763568394002505e-15,"y":0,"__type__":"object"},"charge":1,"radical":0,"parity":null,"isotopeId":"N"},{"__type__":"Kekule.Atom","id":null,"coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0.7999999999999989,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"N"},{"__type__":"Kekule.Atom","id":null,"coordPos2D":0,"coordPos3D":0,"coord2D":{"x":-0.7999999999999989,"y":0,"__type__":"object"},"charge":-1,"radical":0,"parity":null,"isotopeId":"Cl"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":3,"electronCount":6,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"parity":null,"bondType":"ionic","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,2]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"N2 +Cl-","__type__":"Kekule.SubGroup"}'},{inputTexts:["N2Br","NNBr","N2 +Br-"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"coord2D":{"x":1.7763568394002505e-15,"y":0,"__type__":"object"},"charge":1,"radical":0,"parity":null,"isotopeId":"N"},{"__type__":"Kekule.Atom","id":null,"coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0.7999999999999989,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"N"},{"__type__":"Kekule.Atom","id":null,"coordPos2D":0,"coordPos3D":0,"coord2D":{"x":-0.7999999999999989,"y":0,"__type__":"object"},"charge":-1,"radical":0,"parity":null,"isotopeId":"Br"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":3,"electronCount":6,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"parity":null,"bondType":"ionic","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,2]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"N2 +Br-","__type__":"Kekule.SubGroup"}'},{name:"nitrile group",inputTexts:["CN"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[],"coord2D":{"x":-0.34641016151377535,"y":0.19999999999999574,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.34641016151377535,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"N"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":3,"electronCount":6,"isInAromaticRing":false,"connectedObjs":[1,0]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"CN","__type__":"Kekule.SubGroup"}'},{name:"pyridyl",inputTexts:["Py"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-8.881784197001252e-16,"y":-0.7999999999999972,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"N"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.6928203230275498,"y":-0.3999999999999986,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.6928203230275498,"y":0.3999999999999986,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-8.881784197001252e-16,"y":0.7999999999999972,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.6928203230275498,"y":0.3999999999999986,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.6928203230275498,"y":-0.3999999999999986,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[1,2]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[2,3]},{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[3,4]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[4,5]},{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[5,0]}],"__type__":"Kekule.StructureConnectionTable"},"abbr":"Py","__type__":"Kekule.SubGroup"}'},{name:"sulfonic group",inputTexts:["SO3H"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":-0.40000000000000213,"y":7.105427357601002e-15,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"S"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.40000000000000213,"y":0.8000000000000043,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.399999999999995,"y":-0.7999999999999972,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.40000000000000036,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[0,2]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,3]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"SO3H","__type__":"Kekule.SubGroup"}'},{inputTexts:["SO2Cl"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":-0.40000000000000036,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"S"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.40000000000000036,"y":0.7999999999999972,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.40000000000000036,"y":-0.7999999999999972,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.40000000000000036,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"Cl"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[0,2]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,3]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"SO2Cl","__type__":"Kekule.SubGroup"}'},{inputTexts:["SO2Br"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":-0.40000000000000036,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"S"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.40000000000000036,"y":0.7999999999999972,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.40000000000000036,"y":-0.7999999999999972,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.40000000000000036,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"Br"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[0,2]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,3]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"SO2Br","__type__":"Kekule.SubGroup"}'},{inputTexts:["MgCl"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":-0.40000000000000036,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"Mg"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.40000000000000036,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"Cl"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"MgCl","__type__":"Kekule.SubGroup"}'},{inputTexts:["MgBr"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":-0.40000000000000036,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"Mg"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.40000000000000036,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"Br"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"MgBr","__type__":"Kekule.SubGroup"}'},{inputTexts:["TMS"],dataFormat:"Kekule-JSON",structData:'{"coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"coord2D":{"x":-0.40000000000000036,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"Si"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0.40000000000000036,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":-0.40000000000000036,"y":0.7999999999999972,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":-0.40000000000000036,"y":-0.7999999999999972,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,2]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,3]}],"__type__":"Kekule.StructureConnectionTable"},"abbr":"TMS","__type__":"Kekule.SubGroup"}'},{inputTexts:["OTMS"],dataFormat:"Kekule-JSON",structData:'{"coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"coord2D":{"x":-0.6928203230275507,"y":-0.3999999999999986,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"Si"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0.6928203230275507,"y":-0.3999999999999986,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0,"y":0.7999999999999972,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0,"y":-0.7999999999999972,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,2]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,3]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,4]}],"__type__":"Kekule.StructureConnectionTable"},"abbr":"OTMS","__type__":"Kekule.SubGroup"}'}],fragments:[{name:"methane",dataFormat:"Kekule-JSON",structData:'{"info":{"generator":"ChemDraw","date":{"__type__":"date","date":"Sat, 25 Feb 2017 04:21:08 GMT"},"__type__":"object"},"coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[0],"connectors":[],"__type__":"Kekule.StructureConnectionTable"},"name":"Untitled Document-1","__type__":"Kekule.Molecule"}'},{name:"fischer1",dataFormat:"Kekule-JSON",structData:'{"coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":-0.8000000000000007,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"coord2D":{"x":0,"y":0.8000000000000043,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0.7999999999999989,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":1.7763568394002505e-15,"y":-0.7999999999999972,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[2],"connectors":[{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,2]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,3]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,4]}],"__type__":"Kekule.StructureConnectionTable"},"__type__":"Kekule.Molecule"}'},{name:"fischer2",dataFormat:"Kekule-JSON",structData:'{"coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":-0.7999999999999972,"y":0.3999999999999986,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0,"y":0.3999999999999986,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"coord2D":{"x":-1.7763568394002505e-15,"y":1.2000000000000028,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0.7999999999999989,"y":0.3999999999999986,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0,"y":-0.3999999999999986,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0,"y":-1.2000000000000028,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":-0.8000000000000007,"y":-0.3999999999999986,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0.8000000000000007,"y":-0.3999999999999986,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[2],"connectors":[{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,2]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,3]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,4]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[4,5]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[4,6]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[4,7]}],"__type__":"Kekule.StructureConnectionTable"},"__type__":"Kekule.Molecule"}'},{name:"fischer3",dataFormat:"Kekule-JSON",structData:'{"coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":-0.7999999999999972,"y":0.7999999999999972,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0,"y":0.7999999999999972,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"coord2D":{"x":-1.7763568394002505e-15,"y":1.6000000000000014,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0.7999999999999989,"y":0.7999999999999972,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0,"y":-0.8000000000000043,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":-0.8000000000000007,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0.8000000000000007,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0.7999999999999972,"y":-0.8000000000000043,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0,"y":-1.6000000000000085,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":-0.8000000000000007,"y":-0.8000000000000043,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[2],"connectors":[{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,2]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,3]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,4]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[4,5]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[4,6]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[4,7]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[5,8]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[5,9]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[5,10]}],"__type__":"Kekule.StructureConnectionTable"},"__type__":"Kekule.Molecule"}'},{name:"sawhorseStaggered",dataFormat:"Kekule-JSON",structData:'{"info":{"generator":"ChemDraw","date":{"__type__":"date","date":"Tue, 17 Jan 2017 12:51:35 GMT"},"__type__":"object"},"coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"coord2D":{"x":0.34060000000000024,"y":-0.642199999999999,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"zIndex2D":1,"coord2D":{"x":-0.37219999999999764,"y":-1.0575999999999972,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"coord2D":{"x":-1.0877999999999997,"y":-0.648899999999994,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"coord2D":{"x":-0.3686000000000007,"y":-1.8829999999999991,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"coord2D":{"x":-0.34060000000000024,"y":0.6422000000000061,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"coord2D":{"x":1.0877999999999997,"y":0.6489000000000011,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"coord2D":{"x":0.3686000000000007,"y":1.8829999999999991,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null,null],"zIndex2D":0,"coord2D":{"x":0.3722000000000012,"y":1.0576000000000043,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[6],"connectors":[{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,2]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,3]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,7]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[7,4]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[7,5]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[6,7]}],"__type__":"Kekule.StructureConnectionTable"},"name":"Untitled Document-6","__type__":"Kekule.Molecule"}'},{name:"sawhorseEclipsed",dataFormat:"Kekule-JSON",structData:'{"info":{"generator":"ChemDraw","date":{"__type__":"date","date":"Tue, 17 Jan 2017 12:50:51 GMT"},"__type__":"object"},"coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"coord2D":{"x":-0.3022000000000009,"y":0.4405000000000001,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"zIndex2D":0,"coord2D":{"x":0.4229000000000003,"y":0.8340999999999994,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"coord2D":{"x":1.1265,"y":0.4025999999999996,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null,null],"coord2D":{"x":0.44500000000000206,"y":1.657899999999998,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"coord2D":{"x":-1.1265,"y":-1.6214000000000084,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"zIndex2D":1,"coord2D":{"x":-0.4015000000000004,"y":-1.2276999999999987,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"coord2D":{"x":0.3013999999999992,"y":-1.657899999999998,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"coord2D":{"x":-0.38010000000000055,"y":-0.4025999999999996,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[3],"connectors":[{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,2]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,3]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[4,5]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[5,6]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[5,7]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,5]}],"__type__":"Kekule.StructureConnectionTable"},"name":"Untitled Document-5","__type__":"Kekule.Molecule"}'},{name:"cyclohexaneChair1",dataFormat:"Kekule-JSON",structData:'{"info":{"generator":"ChemDraw","date":{"__type__":"date","date":"Tue, 17 Jan 2017 12:43:26 GMT"},"__type__":"object"},"attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"zIndex2D":-1,"coord2D":{"x":-0.5715736151962387,"y":0.3463377359594517,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"zIndex2D":0,"coord2D":{"x":-0.9715297072546738,"y":-0.3463377359594517,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"zIndex2D":1,"coord2D":{"x":-0.20235354281841378,"y":-0.12653156366939555,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"zIndex2D":1,"coord2D":{"x":0.5714766561436155,"y":-0.3463377359594517,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"zIndex2D":0,"coord2D":{"x":0.9715297072546738,"y":0.3463377359594517,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"zIndex2D":-1,"coord2D":{"x":0.20225658376579414,"y":0.1266285227220152,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[1],"connectors":[{"__type__":"Kekule.Bond","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,2]},{"__type__":"Kekule.Bond","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[2,3]},{"__type__":"Kekule.Bond","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[3,4]},{"__type__":"Kekule.Bond","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[4,5]},{"__type__":"Kekule.Bond","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[5,0]}],"__type__":"Kekule.StructureConnectionTable"},"name":"Untitled Document-1","__type__":"Kekule.Molecule"}'},{name:"cyclohexaneChair2",dataFormat:"Kekule-JSON",structData:'{"info":{"generator":"ChemDraw","date":{"__type__":"date","date":"Tue, 17 Jan 2017 12:44:10 GMT"},"__type__":"object"},"attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"zIndex2D":0,"coord2D":{"x":-0.9716412105880998,"y":0.3464120575127936,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"zIndex2D":1,"coord2D":{"x":-0.5715992908679759,"y":-0.3464120575127936,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"zIndex2D":1,"coord2D":{"x":0.20239696641355032,"y":-0.14362717166194017,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"zIndex2D":0,"coord2D":{"x":0.9716412105880998,"y":-0.3464120575127936,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"zIndex2D":-1,"coord2D":{"x":0.571696270727303,"y":0.3464120575127936,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"zIndex2D":-1,"coord2D":{"x":-0.20239696641355032,"y":0.14372415152126905,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[3],"connectors":[{"__type__":"Kekule.Bond","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,2]},{"__type__":"Kekule.Bond","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[2,3]},{"__type__":"Kekule.Bond","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[3,4]},{"__type__":"Kekule.Bond","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[4,5]},{"__type__":"Kekule.Bond","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[5,0]}],"__type__":"Kekule.StructureConnectionTable"},"name":"Untitled Document-2","__type__":"Kekule.Molecule"}'},{name:"cyclohexaneHaworth1",dataFormat:"Kekule-JSON",structData:'{"info":{"generator":"ChemDraw","date":{"__type__":"date","date":"Tue, 17 Jan 2017 12:47:35 GMT"},"__type__":"object"},"attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"zIndex2D":-1,"coord2D":{"x":0.47495070097202685,"y":0.4693161866221871,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"zIndex2D":-1,"coord2D":{"x":-0.4999174283497734,"y":0.4693161866221871,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"zIndex2D":0,"coord2D":{"x":1.1228227044047205,"y":-0.002525816777513512,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"zIndex2D":0,"coord2D":{"x":-1.1228227044047205,"y":-0.002525816777513512,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"zIndex2D":1,"coord2D":{"x":0.47495070097202685,"y":-0.4693161866221871,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"zIndex2D":1,"coord2D":{"x":-0.4999174283497734,"y":-0.4693161866221871,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[3],"connectors":[{"__type__":"Kekule.Bond","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,2]},{"__type__":"Kekule.Bond","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,3]},{"__type__":"Kekule.Bond","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[2,4]},{"__type__":"Kekule.Bond","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[3,5]},{"__type__":"Kekule.Bond","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[4,5]}],"__type__":"Kekule.StructureConnectionTable"},"name":"Untitled Document-3","__type__":"Kekule.Molecule"}'},{name:"cyclohexaneHaworth2",dataFormat:"Kekule-JSON",structData:'{"info":{"generator":"ChemDraw","date":{"__type__":"date","date":"Tue, 17 Jan 2017 12:47:08 GMT"},"__type__":"object"},"attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"zIndex2D":-1,"coord2D":{"x":0.47495070097202685,"y":0.4693161866221871,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"zIndex2D":-1,"coord2D":{"x":-0.49991742834977515,"y":0.4693161866221871,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"zIndex2D":0,"coord2D":{"x":1.1228227044047205,"y":-0.002525816777513512,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"zIndex2D":0,"coord2D":{"x":-1.1228227044047205,"y":-0.002525816777513512,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"zIndex2D":1,"coord2D":{"x":0.47495070097202685,"y":-0.4693161866221871,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"zIndex2D":1,"coord2D":{"x":-0.49991742834977515,"y":-0.4693161866221871,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[3],"connectors":[{"__type__":"Kekule.Bond","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,2]},{"__type__":"Kekule.Bond","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,3]},{"__type__":"Kekule.Bond","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"stereo":1,"isInAromaticRing":false,"connectedObjs":[2,4]},{"__type__":"Kekule.Bond","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"stereo":1,"isInAromaticRing":false,"connectedObjs":[3,5]},{"__type__":"Kekule.Bond","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"stereo":10,"isInAromaticRing":false,"connectedObjs":[4,5]}],"__type__":"Kekule.StructureConnectionTable"},"name":"Untitled Document-3","__type__":"Kekule.Molecule"}'},{name:"cyclopentaneHaworth1",dataFormat:"Kekule-JSON",structData:'{"info":{"generator":"ChemDraw","date":{"__type__":"date","date":"Tue, 17 Jan 2017 12:48:11 GMT"},"__type__":"object"},"attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"zIndex2D":-1,"coord2D":{"x":0.48039814732735664,"y":0.23639868521610907,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"zIndex2D":-1,"coord2D":{"x":-0.4815600495278858,"y":0.23639868521610907,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"zIndex2D":0,"coord2D":{"x":0.7788133624967433,"y":-0.05620701895063007,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"zIndex2D":0,"coord2D":{"x":-0.7788133624967433,"y":-0.05620701895063007,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"zIndex2D":1,"coord2D":{"x":0.0006293636919529888,"y":-0.23639868521610907,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[3],"connectors":[{"__type__":"Kekule.Bond","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,2]},{"__type__":"Kekule.Bond","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,3]},{"__type__":"Kekule.Bond","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[2,4]},{"__type__":"Kekule.Bond","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[3,4]}],"__type__":"Kekule.StructureConnectionTable"},"name":"Untitled Document-4","__type__":"Kekule.Molecule"}'},{name:"cyclopentaneHaworth2",dataFormat:"Kekule-JSON",structData:'{"info":{"generator":"ChemDraw","date":{"__type__":"date","date":"Tue, 17 Jan 2017 12:48:04 GMT"},"__type__":"object"},"attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"zIndex2D":-1,"coord2D":{"x":0.4804171472781027,"y":0.23640551451237002,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"zIndex2D":-1,"coord2D":{"x":-0.48158784071773564,"y":0.23640551451237002,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"zIndex2D":0,"coord2D":{"x":-0.7788490794655241,"y":-0.05617585542339043,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"zIndex2D":1,"coord2D":{"x":0.0005848625620670234,"y":-0.23640551451237002,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"zIndex2D":0,"coord2D":{"x":0.7788490794655241,"y":-0.05617585542339043,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[2],"connectors":[{"__type__":"Kekule.Bond","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,2]},{"__type__":"Kekule.Bond","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"stereo":1,"isInAromaticRing":false,"connectedObjs":[2,3]},{"__type__":"Kekule.Bond","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"stereo":1,"isInAromaticRing":false,"connectedObjs":[4,3]},{"__type__":"Kekule.Bond","attachedMarkers":[],"coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,4]}],"__type__":"Kekule.StructureConnectionTable"},"name":"Untitled Document-4","__type__":"Kekule.Molecule"}'},{name:"substituentMark",dataFormat:"Kekule-JSON",scale:.7,structData:'{"coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":-0.40000000000000036,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Pseudoatom","coordPos2D":0,"coordPos3D":0,"renderOptions":{"nodeDisplayMode":-1,"__type__":"object"},"coord2D":{"x":0.40000000000000036,"y":0,"__type__":"object"},"charge":0,"parity":null,"atomType":"any","symbol":"A"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"renderOptions":{"opacity":0.5,"__type__":"object"},"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]}],"__type__":"Kekule.StructureConnectionTable"},"__type__":"Kekule.Molecule"}'}]},e}},function(e,t,r){"use strict";var i=r(0).Class,n=(r(0).ClassEx,r(0).ObjectEx),a=r(0).DataType;e.exports=function(e){e.Editor.AbstractRepositoryItem=i.create(n,{CLASS_NAME:"Kekule.Editor.AbstractRepositoryItem",initialize:function($super){$super()},initProperties:function(){this.defineProp("name",{dataType:a.STRING})},getAvailableCoordModes:function(){return[]},createObjects:function(e,t){},getScale:function(){return this.doGetScale()||1},doGetScale:function(){return 1},getRefLength:function(){return this.doGetRefLength()/(this.getScale()||1)},doGetRefLength:function(){},isOneStructureFragmentObj:function(){return!1}}),e.Editor.MolRepositoryItem2D=i.create(e.Editor.AbstractRepositoryItem,{CLASS_NAME:"Kekule.Editor.MolRepositoryItem2D",initialize:function($super){$super()},initProperties:function(){this.defineProp("molScale",{dataType:a.FLOAT}),this.defineProp("molManipulationCenterCoord",{dataType:a.HASH}),this.defineProp("molManipulationDefDirectionCoord",{dataType:a.HASH})},doGetScale:function($super){return this.getMolScale()||$super()},getAvailableCoordModes:function(){return e.CoordMode.COORD2D},isOneStructureFragmentObj:function(){return!0},createObjects:function(t,r){var i=this.doCreateObjects(t,r);if(!i)return null;var n=null,a=null,o={x:0,y:0};return t&&(n=t instanceof e.ChemStructureNode?this.doGetMergableNode(i,t):t instanceof e.ChemStructureConnector?this.doGetMergableConnector(i,t):null)&&(a=t,o=n.getAbsBaseCoord2D()),{objects:[i],mergeObj:n,mergeDest:a,baseObjCoord:o,centerCoord:{x:0,y:0}}},doCreateObjects:function(e,t){return null},doGetMergableNode:function(e,t){return null},doGetMergableConnector:function(e,t){return null}}),e.Editor.StoredStructFragmentRepositoryItem2D=i.create(e.Editor.MolRepositoryItem2D,{CLASS_NAME:"Kekule.Editor.StoredStructFragmentRepositoryItem2D",initialize:function($super,e,t,r){$super(),this.beginUpdate();try{t&&this.setDataFormat(t),e&&this.setStructData(e),r&&this.setMolScale(r)}finally{this.endUpdate()}},initProperties:function(){this.defineProp("structureFragment",{dataType:"Kekule.StructureFragment",setter:null,serializable:!1}),this.defineProp("structData",{dataType:a.STRING}),this.defineProp("dataFormat",{dataType:a.STRING})},objectChange:function($super,e){if($super(e),e.indexOf("structData")>=0||e.indexOf("dataFormat")>=0){var t=null;this.getStructData()&&(t=this._createTemplateStructFragment()),this.setPropStoreFieldValue("structureFragment",t)}},_createTemplateStructFragment:function(){var t=null;return this.getStructData()&&(t=e.IO.loadFormatData(this.getStructData(),this.getDataFormat()||e.IO.DataFormat.KEKULE_JSON)),t&&this._adjustTemplateStructureFragmentCoords(t),t},_adjustTemplateStructureFragmentCoords:function(t){t.setCoord2D({x:0,y:0});var r=e.Render.ObjUtils.getContainerBox(t,e.CoordMode.COORD2D,!0);if(r){var i=(t.getCoordOfMode&&t.getCoordOfMode(e.CoordMode.COORD2D,!0),{});i.x=-(r.x2+r.x1)/2,i.y=-(r.y2+r.y1)/2,t.beginUpdate();try{for(var n=0,a=t.getNodeCount();n<a;++n){var o=t.getNodeAt(n),s=o.getCoord2D(!0);s=e.CoordUtils.add(s,i),o.setCoord2D(s)}}finally{t.endUpdate()}}},doGetRefLength:function(){var t=this.getStructureFragment();return t?t.getConnectorLengthMedian(e.CoordMode.COORD2D,!0):0},doCreateObjects:function(e,t){var r=this.getStructureFragment();return r?r.clone():null},doGetMergableNode:function(e,t){return e.getAnchorNodeAt(0)||e.getNodeAt(0)},doGetMergableConnector:function(e,t){return null}}),e.Editor.StoredSubgroupRepositoryItem2D=i.create(e.Editor.StoredStructFragmentRepositoryItem2D,{CLASS_NAME:"Kekule.Editor.StoredSubgroupRepositoryItem2D",initialize:function($super,e,t,r){$super(e,t,r)},initProperties:function(){this.defineProp("inputTexts",{dataType:a.STRING})},doCreateObjects:function(t,r){var i=this.getStructureFragment();if(i){var n=new e.SubGroup;return n.assign(i,!1),n}return null},createObjects:function($super,e){return $super(e)},_adjustTemplateStructureFragmentCoords:function(t){t.setCoord2D({x:0,y:0});var r=t.getCurrConnectableObj();if(r){var i=e.CoordUtils.substract({x:0,y:0},r.getCoord2D(!0));t.beginUpdate();try{for(var n=0,a=t.getNodeCount();n<a;++n){var o=t.getNodeAt(n),s=o.getCoord2D(!0);s=e.CoordUtils.add(s,i),o.setCoord2D(s)}}finally{t.endUpdate()}}}}),e.Editor.StoredSubgroupRepositoryItem2D.getRepItemOfInputText=function(t){for(var r=e.Editor.RepositoryItemManager.getAllItems(e.Editor.StoredSubgroupRepositoryItem2D)||[],i=0,n=r.length;i<n;++i){var a=r[i];if((a.getInputTexts()||[]).indexOf(t)>=0)return a}return null},e.Editor.StoredSubgroupRepositoryItem2D.getAllRepItems=function(){return e.Editor.RepositoryItemManager.getAllItems(e.Editor.StoredSubgroupRepositoryItem2D)||[]},e.Editor.MolRingRepositoryItem2D=i.create(e.Editor.MolRepositoryItem2D,{CLASS_NAME:"Kekule.Editor.MolRingRepositoryItem2D",initialize:function($super,e,t){$super(),this.setRingAtomCount(e),this.setBondLength(t||1)},initProperties:function(){this.defineProp("ringAtomCount",{dataType:a.INT}),this.defineProp("bondLength",{dataType:a.FLOAT,setter:function(e){e!==this.getBondLength()&&this.setPropStoreFieldValue("bondLength",e)}}),this.defineProp("isAromatic",{dataType:a.BOOL}),this.defineProp("enableCoordCache",{dataType:a.BOOL,setter:function(e){e!==this.getEnableCoordCache()&&(this.setPropStoreFieldValue("enableCoordCache",e),e&&!this._coordCache&&this._initCoordCache())}})},doGetRefLength:function(){return this.getBondLength()},doCreateObjects:function(e,t){var r=t&&t.originalStructFragment;return this.generateRing(r)},doGetMergableNode:function(e,t){return e.getNodeAt(0)},doGetMergableConnector:function(e,t){return e.getConnectorAt(0)},generateRing:function(t,r){r||(r=e.Molecule);var i;i=t||new r;var n=this.getRingAtomCount();i.beginUpdate();try{i.setCoord2D({x:0,y:0});var a=i.getNodeCount();if(a>n)for(var o=a-1;o>=n;--o)i.removeNodeAt(o);for(var s=i.getConnectorCount(),o=s-1;o>=0;--o)i.removeConnectorAt(o);var l,d=this.getEnableCoordCache(),u=d&&this._hasCoordCache(n);l=u?this._getCachedCoords(n):this._calcAtomCoords(n);for(var c,h,m,g=this.getBondLength(),o=0;o<n;++o){var f=i.getNodeAt(o);f||(f=this._generateAtom(o),i.appendNode(f));var p=l[o];if(1!==g&&(p=e.CoordUtils.multiply(p)),f.setCoord2D(p),0===o&&(m=f),c){var C=this._generateBond(h,o);i.appendConnector(C),C.appendConnectedObj(c),C.appendConnectedObj(f)}c=f,h=o}var C=this._generateBond(n-1,0);i.appendConnector(C),C.appendConnectedObj(c),C.appendConnectedObj(m)}finally{i.endUpdate()}return i},_generateAtom:function(t){return new e.Atom(null,"C")},_generateBond:function(t,r){var i=e.BondOrder.SINGLE;return this.getIsAromatic()&&t%2&&(i=e.BondOrder.DOUBLE),new e.Bond(null,null,i)},_calcAtomCoords:function(e){for(var t=this.getEnableCoordCache(),r=Math.PI/e,i=Math.sin(r),n=2*r,a=.5/i,o=4===e||8===e?-Math.PI/2-n/2:-Math.PI/2,s=o,l=[],d=0;d<e;++d){var u=a*Math.cos(s),c=a*Math.sin(s),h={x:u,y:c};l.push(h),t&&this._setCoordToCache(h,e,d),s+=n}return l},_initCoordCache:function(){this._coordCache=[];for(var e=3;e<13;++e)this._calcAtomCoords(e)},_clearCoordCache:function(){this._coordCache=[]},_setCoordToCache:function(e,t,r){var i=this._coordCache[t];i||(i=[],this._coordCache[t]=i),i[r]=e},_getCachedCoord:function(e,t){var r=this._coordCache[e];return r&&r[t]},_getCachedCoords:function(e){return this._coordCache[e]},_hasCoordCache:function(e){return!(!this._coordCache||!this._coordCache[e])}}),e.Editor.MolChainRepositoryItem2D=i.create(e.Editor.MolRepositoryItem2D,{CLASS_NAME:"Kekule.Editor.MolChainRepositoryItem2D",STEP_X_INC:Math.cos(30/180*Math.PI),STEP_Y_INC:Math.sin(30/180*Math.PI),initialize:function($super,e,t){$super(),this.setAtomCount(e),this.setBondLength(t||1)},initProperties:function(){this.defineProp("atomCount",{dataType:a.INT}),this.defineProp("bondLength",{dataType:a.FLOAT}),this.defineProp("negativeDirection",{dataType:a.BOOL}),this.defineProp("enableCoordCache",{dataType:a.BOOL,setter:function(e){e!==this.getEnableCoordCache()&&(this.setPropStoreFieldValue("enableCoordCache",e),e&&!this._coordCache&&this._initCoordCache())}})},doGetRefLength:function(){return this.getBondLength()},doCreateObjects:function(e,t){var r=t&&t.originalStructFragment;return this.generateChain(r)},doGetMergableNode:function(e,t){return e.getNodeAt(0)},doGetMergableConnector:function(e,t){return null},generateChain:function(t,r){r||(r=e.Molecule);var i=t||new r,n=this.getAtomCount(),a=this.getBondLength()||1,o=this.getNegativeDirection();i.beginUpdate();try{i.setCoord2D({x:0,y:0});var s=i.getNodeCount();if(s>n)for(var l=s-1;l>=n;--l)i.removeNodeAt(l);var d=i.getConnectorCount();if(d>n-1)for(var l=d-1;l>=n-1;--l)i.removeConnectorAt(l);for(var u,c,h,l=0,m=n;l<m;++l){u=c;var g=!1,c=i.getNodeAt(l);c||(c=this._generateAtom(l),g=!0);var f=this._getCachedCoord(l);f||(f=this._calcAtomCoord(l)),1!==a&&(f=e.CoordUtils.multiply(f,a)),o&&(f={x:f.x,y:-f.y}),c.setCoord2D(f),g&&i.appendNode(c),u&&g&&(h=this._generateBond(l-1,l),i.appendConnector(h),h.appendConnectedObj(u),h.appendConnectedObj(c))}}finally{i.endUpdate()}return this.setMolManipulationCenterCoord({x:0,y:0}),this.setMolManipulationDefDirectionCoord({x:1,y:0}),i},_generateAtom:function(t){return new e.Atom(null,"C")},_generateBond:function(t,r){var i=e.BondOrder.SINGLE;return new e.Bond(null,null,i)},_calcAtomSetCoords:function(e){var t=this.getEnableCoordCache(),r={x:1*this.STEP_X_INC,y:1*this.STEP_Y_INC},i=[],n={x:0,y:0};i.push(n),this._coordCache[0]=n;for(var a=1,o=e;a<o;++a)n={x:n.x+r.x,y:a%2?r.y:0},i.push(n),t&&(this._coordCache[a]=n);return i},_calcAtomCoord:function(e){var t={x:1*this.STEP_X_INC,y:1*this.STEP_Y_INC},r={x:t.x*e,y:e%2?t.y:0};return this._coordCache&&(this._coordCache[e]=r),r},_initCoordCache:function(){this._coordCache=[];this._calcAtomSetCoords(30)},_clearCoordCache:function(){this._coordCache=[]},_getCachedCoord:function(e){return this._coordCache&&this._coordCache[e]}}),e.Editor.PathGlyphRepositoryItem2D=i.create(e.Editor.AbstractRepositoryItem,{CLASS_NAME:"Kekule.Editor.PathGlyphRepositoryItem2D",initialize:function($super,e,t,r){$super(),this.setGlyphClass(e),this.setGlyphRefLength(t||1),this.setGlyphInitialParams(r)},initProperties:function(){this.defineProp("glyphRefLength",{dataType:a.FLOAT}),this.defineProp("glyphClass",{dataType:a.CLASS,serializable:!1}),this.defineProp("glyphInitialParams",{dataType:a.HASH})},getAvailableCoordModes:function(){return e.CoordMode.COORD2D},doGetRefLength:function(){return this.getGlyphRefLength()},createObjects:function(e){var t=this.generateGlyph(),r={x:0,y:0};return{objects:[t],mergeObj:null,mergeDest:null,baseObjCoord:r,centerCoord:r}},generateGlyph:function(){return new(this.getGlyphClass())(null,this.getGlyphRefLength(),this.getGlyphInitialParams())}}),e.Editor.RepositoryItemManager={_itemClassMap:new e.MapEx(!0),_itemNameMap:new e.MapEx(!0),getAllItems:function(e){return t._itemClassMap.get(e)},getItem:function(e){return t._itemNameMap.get(e)},register:function(r){var i,n=r.getName();n&&(i=t.getItem(),t._itemNameMap.set(n,r));var a=r.getClass(),o=t.getAllItems(a);o?i?e.ArrayUtils.replace(o,i,r):e.ArrayUtils.pushUnique(o,r):(o=[r],t._itemClassMap.set(a,o))},unregister:function(r){var i=r.getClass(),n=t.getAllItems(i);n&&e.ArrayUtils.remove(n,r);var a=r.getName();a&&t._itemNameMap.remove(a)}};var t=e.Editor.RepositoryItemManager;return e._registerAfterLoadSysProc(function(){if(e.Editor.RepositoryData){for(var r=e.Editor.RepositoryData.subGroups||[],i=0,n=r.length;i<n;++i){var a=r[i],o=new e.Editor.StoredSubgroupRepositoryItem2D(a.structData,a.dataFormat,a.scale);o.setInputTexts(a.inputTexts).setName(a.name||a.inputTexts[0]),t.register(o)}for(var r=e.Editor.RepositoryData.fragments||[],i=0,n=r.length;i<n;++i){var a=r[i],o=new e.Editor.StoredStructFragmentRepositoryItem2D(a.structData,a.dataFormat,a.scale);o.setName(a.name),t.register(o)}}}),e}},function(e,t,r){"use strict";var i=r(0).Class,n=r(0).ClassEx,a=(r(0).ObjectEx,r(0).DataType);e.exports=function(e){var t=e.ObjUtils,r=e.ArrayUtils,o=e.Widget.HtmlClassNames,s=e.ChemWidget.HtmlClassNames;return e.ChemWidget.HtmlClassNames=Object.extend(e.ChemWidget.HtmlClassNames,{STRUCTURE_NODE_SELECT_PANEL:"K-Chem-StructureNodeSelectPanel",STRUCTURE_NODE_SELECT_PANEL_SET_BUTTON:"K-Chem-StructureNodeSelectPanel-SetButton",STRUCTURE_NODE_SETTER:"K-Chem-StructureNodeSetter",STRUCTURE_NODE_SETTER_INPUTBOX:"K-Chem-StructureNodeSetter-InputBox",STRUCTURE_CONNECTOR_SELECT_PANEL:"K-Chem-StructureConnectorSelectPanel",STRUCTURE_CONNECTOR_SELECT_PANEL_SET_BUTTON:"K-Chem-StructureConnectorSelectPanel-SetButton",STRUCTURE_CONNECTOR_SELECT_PANEL_ADV:"K-Chem-StructureConnectorSelectPanelAdv",STRUCTURE_CONNECTOR_SELECT_PANEL_ADV_EXTRA_SECTION:"K-Chem-StructureConnectorSelectPanelAdv-ExtraSection",STRUCTURE_CONNECTOR_SELECT_PANEL_EXTRA_SECTION_BUTTON:"K-Chem-StructureConnectorSelectPanelAdv-ExtraSection-Button",STRUCTURE_CONNECTOR_SELECT_PANEL_EXTRA_SECTION_BUTTON_KEKULIZE:"K-Chem-StructureConnectorSelectPanelAdv-ExtraSection-Button-Kekulize",STRUCTURE_CONNECTOR_SELECT_PANEL_EXTRA_SECTION_BUTTON_HUCKLIZE:"K-Chem-StructureConnectorSelectPanelAdv-ExtraSection-Button-Hucklize",CHARGE_SELECT_PANEL:"K-Chem-Charge-SelectPanel",CHARGE_SELECT_PANEL_BTNGROUP:"K-Chem-Charge-SelectPanel-BtnGroup",CHARGE_SELECT_PANEL_CHARGE_BUTTON:"K-Chem-Charge-SelectPanel-ChargeButton",GLYPH_PATH_ARROW_SETTING_PANEL:"K-Chem-GlyphPath-Arrow-SettingPanel",GLYPH_PATH_ARROW_STYLE_BTNGROUP:"K-Chem-GlyphPath-Arrow-StyleButtonGroup",GLYPH_PATH_ARROW_STYLE_BUTTON:"K-Chem-GlyphPath-Arrow-StyleButton",GLYPH_PATH_ARROW_CONTINUOUS_SIDES_BTNGROUP:"K-Chem-GlyphPath-Arrow-ContinuousSidesButtonGroup",GLYPH_PATH_ARROW_CONTINUOUS_SIDES_BUTTON:"K-Chem-GlyphPath-Arrow-ContinuousSidesButton",GLYPH_Path_ARROW_SIZE_SETTER:"K-Chem-GlyphPath-Arrow-SizeSetter",GLYPH_REACTION_ARROW_PRESET_SELECTOR:"K-Chem-Glyph-ReactionArrow-PresetSelector",GLYPH_REACTION_ARROW_PRESET_SELECTOR_BTNSET:"K-Chem-Glyph-ReactionArrow-PresetSelector-ButtonSet",GLYPH_REACTION_ARROW_PRESET_SELECTOR_BTNSET_DROPDOWN:"K-Chem-Glyph-ReactionArrow-PresetSelector-ButtonSet-DropDown",GLYPH_REACTION_ARROW_PRESET_SELECTOR_BUTTON:"K-Chem-Glyph-ReactionArrow-PresetSelector-Button",GLYPH_ELECTRON_PUSHING_ARROW_PRESET_SELECTOR:"K-Chem-Glyph-ElectronPushingArrow-PresetSelector",GLYPH_ELECTRON_PUSHING_ARROW_PRESET_SELECTOR_BTNGROUP:"K-Chem-Glyph-ReactionArrow-PresetSelector-ButtonGroup",GLYPH_ELECTRON_PUSHING_ARROW_PRESET_SELECTOR_BUTTON:"K-Chem-Glyph-ElectronPushingArrow-PresetSelector-Button",GLYPH_PATH_LINE_SETTING_PANEL:"K-Chem-GlyphPath-Line-SettingPanel",GLYPH_PATH_SETTING_PANEL:"K-Chem-GlyphPath-SettingPanel",GLYPH_PATH_SETTING_PANEL_SECTION:"K-Chem-GlyphPath-SettingPanel-Section",GLYPH_PATH_SETTING_PANEL_SECTION_TITLE:"K-Chem-GlyphPath-SettingPanel-Section-Title",GLYPH_PATH_SETTING_PANEL_SECTION_PANEL:"K-Chem-GlyphPath-SettingPanel-Section-Panel",GLYPH_MULTIPATH_SETTING_PANEL:"K-Chem-GlyphMultiPath-SettingPanel",GLYPH_MULTIPATH_SETTING_PANEL_PATH_TABGROUP:"K-Chem-GlyphMultiPath-SettingPanel-PathTabGroup",GLYPH_MULTIPATH_SETTING_PANEL_PATH_SETTING_PANEL:"K-Chem-GlyphMultiPath-SettingPanel-PathSettingPanel",GLYPH_REACTION_ARROW_PATH_SETTING_PANEL:"K-Chem-ReactionArrow-SettingPanel",GLYPH_REACTION_ARROW_PATH_SETTING_PANEL_ARROW_PRESET_SECTION:"K-Chem-ReactionArrow-SettingPanel-ArrowPresetSection",GLYPH_ARC_PATH_SETTING_PANEL:"K-Chem-ArcPath-SettingPanel",GLYPH_MULTIARC_PATH_SETTING_PANEL:"K-Chem-MultiArcPath-SettingPanel",GLYPH_ELECTRON_PUSHING_ARROW_SETTING_PANEL:"K-Chem-ElectronPusingArrow-SettingPanel",GLYPH_MULTI_ELECTRON_PUSHING_ARROW_SETTING_PANEL:"K-Chem-MultiElectronPusingArrow-SettingPanel"}),e.ChemWidget.StructureNodeSelectPanel=i.create(e.Widget.Panel,{CLASS_NAME:"Kekule.ChemWidget.StructureNodeSelectPanel",BTN_DATA_FIELD:"__$btn_data__",initialize:function($super,e){this.setPropStoreFieldValue("displayElements",!0),this.setPropStoreFieldValue("displayNonElements",!0),this.setPropStoreFieldValue("displaySubgroups",!0),$super(e),this.addEventListener("execute",this.reactSelButtonExec.bind(this))},initProperties:function(){this.defineProp("elementSymbols",{dataType:a.ARRAY,scope:i.PropertyScope.PUBLIC}),this.defineProp("nonElementInfos",{dataType:a.ARRAY,scope:i.PropertyScope.PUBLIC}),this.defineProp("subGroupInfos",{dataType:a.ARRAY,scope:i.PropertyScope.PUBLIC}),this.defineProp("subGroupRepItems",{dataType:a.ARRAY,scope:i.PropertyScope.PUBLIC,setter:function(e){this.setPropStoreFieldValue("subGroupRepItems",e),this._updateSubGroupInfosFromRepItems(e)}}),this.defineProp("displayElements",{dataType:a.BOOL,scope:i.PropertyScope.PUBLISHED}),this.defineProp("displayNonElements",{dataType:a.BOOL,scope:i.PropertyScope.PUBLISHED}),this.defineProp("displaySubgroups",{dataType:a.BOOL,scope:i.PropertyScope.PUBLISHED}),this.defineProp("activeNode",{dataType:a.ARRAY,serializable:!1,setter:function(e){this.setPropStoreFieldValue("activeNode",e),this.activeNodeChanged(e)}}),this.defineProp("periodicTableDialog",{dataType:a.OBJECT,scope:i.PropertyScope.PRIVATE,serializable:!1,setter:null,getter:function(e){var t=this.getPropStoreFieldValue("periodicTableDialog");if(!t&&e){var r=this.getCoreElement(),i=this.getDocument();t=this._createPeriodicTableDialogWidget(i,r),this.setPropStoreFieldValue("periodicTableDialog",t)}return t}})},initPropValues:function($super){return $super()},doFinalize:function($super){var e=this.getPeriodicTableDialog();e&&e.finalize(),$super()},setSelectableInfos:function(e){this.beginUpdate();try{this.setPropValues(e)}finally{this.endUpdate()}},reactSelButtonExec:function(t){var r=this,i=t.target;if(this._selButtons.indexOf(i)>=0){var n=i[this.BTN_DATA_FIELD];n&&(n.isPeriodicTable?this._openPeriodicTableDialog(i,function(t){if(t===e.Widget.DialogButtons.OK){var i=r._periodicTable.getSelectedSymbol();r.notifyValueChange(r.generateSelectableDataFromElementSymbol(i))}},{isSimpleAtom:!0}):n.isVarList||n.isVarNotList?this._openPeriodicTableDialog(i,function(t){if(t===e.Widget.DialogButtons.OK){var i=r._periodicTable.getSelectedSymbols(),a=e.VariableAtom,o=n.isVarList?{allowedIsotopeIds:i,disallowedIsotopeIds:null}:{allowedIsotopeIds:null,disallowedIsotopeIds:i};r.notifyValueChange({nodeClass:a,props:o})}},{isVarList:n.isVarList,isVarNotList:n.isVarNotList}):this.notifyValueChange(n))}},notifyValueChange:function(e){this.invokeEvent("valueChange",{value:{nodeClass:e.nodeClass,props:e.props,repositoryItem:e.repositoryItem}})},activeNodeChanged:function(e){},doObjectChange:function(t){var r=["elementSymbols","nonElementInfos","subGroupInfos","displayElements","displayNonElements","displaySubGroups"];e.ArrayUtils.intersect(t,r).length&&this.updatePanelContent(this.getDocument(),this.getCoreElement())},doGetWidgetClassName:function($super){return $super()+" "+s.STRUCTURE_NODE_SELECT_PANEL},doCreateRootElement:function(e){return e.createElement("span")},doCreateSubElements:function($super,e,t){var r=$super(e,t);return this.updatePanelContent(e,this.getChildrenHolderElement()),r},_updateSubGroupInfosFromRepItems:function(t){var r=[];if(t&&t.length){for(var i=0,n=t.length;i<n;++i){var a=t[i],o=a.getStructureFragment(),s=o.getAbbr();if(!s){var l=o.getFormulaText(),d=e.FormulaUtils.textToFormula(l),u=d.getDisplayRichText();s=e.Render.RichTextUtils._toDebugHtml(u)}var c={text:s,repositoryItem:a,nodeClass:o.getClass(),node:o,hint:a.getName()};r.push(c)}this.setSubGroupInfos(r)}},updatePanelContent:function(t,r){if(this._selButtons)for(var i=this._selButtons.length-1;i>=0;--i){var n=this._selButtons[i];this.removeWidget(n)}this._selButtons=[],e.DomUtils.clearChildContent(r);var a=this.generateSelectableData(),o=this._getDisplayedTabPageNames(),s=new e.Widget.TabView(this);if(o.indexOf("atom")>=0){var l=s.createNewTabPage(e.$L("ChemWidgetTexts.CAPTION_ATOM"));if(this.getDisplayElements()){this.doCreateSelButtonSection(t,l.getCoreElement(),a.elementData)}if(this.getDisplayNonElements()){this.doCreateSelButtonSection(t,l.getCoreElement(),a.nonElementData,!0)}}if(o.indexOf("subgroup")>=0){var d=s.createNewTabPage(e.$L("ChemWidgetTexts.CAPTION_SUBGROUP"));this.doCreateSelButtonSection(t,d.getCoreElement(),a.subGroupData,!0)}s.setShowTabButtons(o.length>1)},_getDisplayedTabPageNames:function(){var e=[];return(this.getDisplayElements()||this.getDisplayNonElements())&&e.push("atom"),this.getDisplaySubgroups()&&e.push("subgroup"),e},generateSelectableDataFromElementSymbol:function(t){var r=t,i=e.IsotopesDataUtil.getIsotopeInfoById(t);return i&&(r=i.isotopeAlias?i.isotopeAlias:"<sup>"+i.massNumber+"</sup>"+i.elementSymbol),{text:r,nodeClass:e.Atom,props:{isotopeId:t}}},generateSelectableData:function(){for(var t=this.getElementSymbols()||[],r=[],i=0,n=t.length;i<n;++i){var a;a="..."===t[i]?{text:"…",nodeClass:null,hint:e.$L("ChemWidgetTexts.CAPTION_ATOMLIST_PERIODIC_TABLE"),isPeriodicTable:!0}:this.generateSelectableDataFromElementSymbol(t[i]),r.push(a)}return{elementData:r,nonElementData:this.getNonElementInfos(),subGroupData:this.getSubGroupInfos()}},doCreateSelButton:function(t,r,i,n){var a=i.text;n&&i.description&&(a+='<span style="font-size:80%"> '+i.description+"</span>");var o=e.Widget.Button,l=new o(t,a);return l.addClassName(s.STRUCTURE_NODE_SELECT_PANEL_SET_BUTTON),l.setGroup&&l.setGroup(this.getClassName()),i.hint&&l.setHint(i.hint),l[this.BTN_DATA_FIELD]=i,this._selButtons.push(l),l},doCreateSectionSelButtons:function(e,t,r,i){if(r)for(var n=0,a=r.length;n<a;++n){var o=this.doCreateSelButton(e,t,r[n],i);o.setParent(this),o.appendToElem(t)}},doCreateSection:function(e,t){var r=e.createElement("div");return r.className=o.SECTION,t&&t.appendChild(r),r},doCreateSelButtonSection:function(e,t,r,i){var n=this.doCreateSection(e,t);return this.doCreateSectionSelButtons(e,n,r,i),n},_createPeriodicTableDialogWidget:function(t,r){var i=new e.Widget.Dialog(t,e.$L("ChemWidgetTexts.CAPTION_PERIODIC_TABLE_DIALOG"),[e.Widget.DialogButtons.OK,e.Widget.DialogButtons.CANCEL]),n=new e.ChemWidget.PeriodicTable(t);return n.setUseMiniMode(!0).setEnableSelect(!0),n.setParent(i),n.appendToElem(i.getClientElem()),this._periodicTable=n,i},_openPeriodicTableDialog:function(t,r,i){var n=this.getPeriodicTableDialog(!0),a=i.isVarList||i.isVarNotList;this._periodicTable.setEnableMultiSelect(a).setSelectedSymbol(null);var o=this.getActiveNode();if((i.isVarList||i.isVarNotList)&&o instanceof e.VariableAtom){var s=o.getAllowedIsotopeIds(),l=o.getDisallowedIsotopeIds();this._periodicTable.setSelectedSymbols(i.isVarList?s:l)}!a&&o instanceof e.Atom&&this._periodicTable.setSelectedSymbol(o.getSymbol()),n.openPopup(r,this||t)}}),e.ChemWidget.StructureNodeSetter=i.create(e.Widget.BaseWidget,{CLASS_NAME:"Kekule.ChemWidget.StructureNodeSetter",initialize:function($super,e){$super(e),this._valueSetBySelectPanel=!1},initProperties:function(){this.defineProp("nodes",{dataType:a.ARRAY,serializable:!1,setter:function(t){var r=e.ArrayUtils.toArray(t);this.setPropStoreFieldValue("nodes",r),this.nodesChanged(r)}}),this.defineProp("value",{dataType:a.HASH,serializable:!1,setter:null,getter:function(){var e=this.getPropStoreFieldValue("value");if(!e&&!this._valueSetBySelectPanel){var t=this.getNodeInputBox().getValue();e=this._getValueFromDirectInputText(t)}return e}}),this.defineProp("nodeLabel",{dataType:a.STRING,serializable:!1,setter:null,getter:function(){return this.getNodeInputBox().getValue()}}),this.defineProp("nodeInputBox",{dataType:"Kekule.Widget.ButtonTextBox",serializable:!1,setter:!1}),this.defineProp("nodeSelectPanel",{dataType:"Kekule.ChemWidget.StructureNodeSelectPanel",serializable:!1,setter:!1}),this.defineProp("showInputBox",{dataType:a.BOOL,getter:function(){return this.getNodeInputBox().getDisplayed()},setter:function(e){this.getNodeInputBox().setDisplayed(e)}}),this.defineProp("showSelectPanel",{dataType:a.BOOL,getter:function(){return this.getNodeSelectPanel().getDisplayed()},setter:function(e){this.getNodeSelectPanel().setDisplayed(e)}}),this.defineProp("useDropDownSelectPanel",{dataType:a.BOOL,setter:function(e){this.getUseDropDownSelectPanel()!==e&&(this.setPropStoreFieldValue("useDropDownSelectPanel",e),this._updateDropDownSettings(e))}}),this.defineProp("labelConfigs",{dataType:a.OBJECT,serializable:!1}),this._defineSelectPanelDelegatedProp("selectableElementSymbols","elementSymbols"),this._defineSelectPanelDelegatedProp("selectableNonElementInfos","nonElementInfos"),this._defineSelectPanelDelegatedProp("selectableSubGroupInfos","subGroupInfos"),this._defineSelectPanelDelegatedProp("selectableSubGroupRepItems","subGroupRepItems"),this._defineSelectPanelDelegatedProp("displaySelectableElements","displayElements"),this._defineSelectPanelDelegatedProp("displaySelectableNonElements","displayNonElements"),this._defineSelectPanelDelegatedProp("displaySelectableSubgroups","displaySubgroups")},initPropValues:function($super){$super()},doFinalize:function($super){this.getNodeSelectPanel().finalize(),$super()},_defineSelectPanelDelegatedProp:function(t,r){r||(r=t);var i=n.getPropInfo(e.ChemWidget.StructureNodeSelectPanel,r),a=Object.create(i);return a.getter=null,a.setter=null,i.getter&&(a.getter=function(){return this.getNodeSelectPanel().getPropValue(r)}),i.setter&&(a.setter=function(e){this.getNodeSelectPanel().setPropValue(r,e)}),this.defineProp(t,a)},doGetWidgetClassName:function($super){return $super()+" "+s.STRUCTURE_NODE_SETTER},doCreateRootElement:function(e){return e.createElement("span")},doCreateSubElements:function($super,t,r){var i=$super(t,r),n=this,a=new e.Widget.ButtonTextBox(this);this.setPropStoreFieldValue("nodeInputBox",a),a.addClassName(s.STRUCTURE_NODE_SETTER_INPUTBOX),a.appendToElem(this.getCoreElement()),a.addEventListener("valueChange",function(e){n._valueSetBySelectPanel=!1,e.stopPropagation()}),a.addEventListener("keyup",function(t){var r=t.htmlEvent,i=r.getKeyCode();i===e.X.Event.KeyCode.ENTER&&n._applyDirectInput(),n.getUseDropDownSelectPanel()&&(i===e.X.Event.KeyCode.DOWN?n.showNodeSelectPanel():i===e.X.Event.KeyCode.UP&&n.hideNodeSelectPanel())}),a.addEventListener("blur",function(e){e.target===a.getTextBox()&&a.getIsDirty()&&n._applyDirectInput()}),a.getButton().addEventListener("execute",function(e){n.getUseDropDownSelectPanel()?n.toggleNodeSelectPanel():n._applyDirectInput()});var o=new e.ChemWidget.StructureNodeSelectPanel(this);return this.setPropStoreFieldValue("nodeSelectPanel",o),o.appendToElem(this.getCoreElement()),o.addEventListener("valueChange",function(e){Object.extend({},e);e.stopPropagation(),n._valueSetBySelectPanel=!0,n.notifyValueChange(e.value,!0),n.getUseDropDownSelectPanel()&&o.hide()}),this._updateDropDownSettings(this.getUseDropDownSelectPanel()),i},_updateDropDownSettings:function(t){var r=this.getNodeInputBox(),i=this.getNodeSelectPanel();t?(r.setButtonKind(e.Widget.Button.Kinds.DROPDOWN),i.removeFromDom(),i.hide(null,null,e.Widget.ShowHideType.DEFAULT)):(r.setButtonKind(e.Widget.Button.Kinds.ENTER),i.appendToElem(this.getCoreElement()),i.setStyleProperty("position",""),i.show(null,null,e.Widget.ShowHideType.DEFAULT))},_indexOfNonElementLabel:function(e){for(var t=this.getNonAtomLabelInfos(),r=0,i=t.length;r<i;++r){if(t[r].nodeLabel===e)return r}return-1},_getNonAtomInfo:function(e){var t=this.getSelectableNonElementInfos();if(t)for(var r=0,i=t.length;r<i;++r){var n=t[r];if(n.text===e)return n}return null},_getValueFromDirectInputText:function(t){var r,i,n,a,o,s=this._getNonAtomInfo(t);if(s)r=s.nodeClass,i=s.props;else{var l=e.Editor.StoredSubgroupRepositoryItem2D.getRepItemOfInputText(t);a=l,l?(n=l.getStructureFragment(),r=n.getClass()):t&&(r=e.ChemStructureNodeFactory.getClassByLabel(t,null),r||(r=e.Pseudoatom,o=!0),i=r===e.Atom?{isotopeId:t}:r===e.Pseudoatom?{symbol:t}:{})}return{nodeClass:r,props:i,repositoryItem:a,isUnknownPseudoatom:o}},_applyDirectInput:function(){this._valueSetBySelectPanel=!1;var e=this.getNodeInputBox(),t=e.getValue(),r=this._getValueFromDirectInputText(t);this.notifyValueChange(r),e.setIsDirty(!1)},_getVarAtomListLabel:function(){var t=this.getLabelConfigs();return t?t.getVariableAtom():e.ChemStructureNodeLabels.VARIABLE_ATOM},_getVarAtomNotListLabel:function(){var t=this.getLabelConfigs();return"~"+(t?t.getVariableAtom():e.ChemStructureNodeLabels.VARIABLE_ATOM)},_getAllNodeLabels:function(t){return e.Editor.StructureUtils.getAllChemStructureNodesLabel(t,this.getLabelConfigs())},nodesChanged:function(e){var t=this._getAllNodeLabels(e)||"",r=t?e[0]:null;this.getNodeSelectPanel().setActiveNode(r),this.getNodeInputBox().setValue(t),this.getNodeInputBox().setIsDirty(!1),this.setPropStoreFieldValue("value",null),this._valueSetBySelectPanel=!1},notifyValueChange:function(e,t){this.setPropStoreFieldValue("value",e);var r={nodeClass:e.nodeClass,props:e.props,repositoryItem:e.repositoryItem,isUnknownPseudoatom:e.isUnknownPseudoatom};t&&this.invokeEvent("valueSelect",{value:r}),this.invokeEvent("valueChange",{value:r})},setSelectableInfos:function(e){this.getNodeSelectPanel().setSelectableInfos(e)},showNodeSelectPanel:function(){var t=this.getNodeSelectPanel();t.isShown()||t.show(this.getNodeInputBox(),null,e.Widget.ShowHideType.DROPDOWN)},hideNodeSelectPanel:function(){var e=this.getNodeSelectPanel();e.isShown()&&e.hide()},toggleNodeSelectPanel:function(){var t=this.getNodeSelectPanel();t.isShown()?t.hide():t.show(this.getNodeInputBox(),null,e.Widget.ShowHideType.DROPDOWN)}}),e.ChemWidget.StructureConnectorSelectPanel=i.create(e.Widget.Panel,{CLASS_NAME:"Kekule.ChemWidget.StructureConnectorSelectPanel",BTN_DATA_FIELD:"__$btn_data__",BTN_GROUP:"__$bond_btn_group__",initialize:function($super,e){$super(e),this._selButtons=[],this._activeBtn=null,this.addEventListener("execute",this.reactSelButtonExec.bind(this))},initProperties:function(){this.defineProp("bondData",{dataType:a.ARRAY,scope:i.PropertyScope.PUBLIC}),this.defineProp("activeBondPropValues",{dataType:a.HASH,scope:i.PropertyScope.PUBLIC,setter:function(e){this.setPropStoreFieldValue("activeBondPropValues",e),this.activeBondPropsChanged(e)}}),this.defineProp("activeBondHtmlClass",{dataType:a.STRING,scope:i.PropertyScope.PRIVATE,setter:null,getter:function(){var e=this._activeBtn;if(e){var t=e[this.BTN_DATA_FIELD];return t&&t.htmlClass}return null}}),this.defineProp("bondPropNames",{dataType:a.ARRAY,serializable:!1})},doObjectChange:function(t){var r=["bondData"];e.ArrayUtils.intersect(t,r).length&&this.updatePanelContent(this.getDocument(),this.getCoreElement())},doGetWidgetClassName:function($super){return $super()+" "+s.STRUCTURE_CONNECTOR_SELECT_PANEL},doCreateRootElement:function(e){return e.createElement("span")},doCreateSubElements:function($super,e,t){var r=$super(e,t);return this.updatePanelContent(e,t),r},activeBondPropsChanged:function(e){if(this._activeBtn&&(this._activeBtn.setChecked(!1),this._activeBtn=null),e)for(var t=this._selButtons,r=0,i=t.length;r<i;++r){var n=t[r][this.BTN_DATA_FIELD];if(n&&this._isBondPropsMatch(e,n.bondProps,this.getBondPropNames())){t[r].setChecked(!0),this._activeBtn=t[r];break}}},_isBondPropsMatch:function(t,r,i){return e.Editor.StructureUtils.isBondPropsMatch(t,r,i)},reactSelButtonExec:function(e){var t=e.target;if(this._selButtons.indexOf(t)>=0){this._activeBtn=t;var r=t[this.BTN_DATA_FIELD];r&&(this.setPropStoreFieldValue("activeBondPropValues",r.bondProps),this.notifyValueChange(r.bondProps))}},notifyValueChange:function(e){this.invokeEvent("valueChange",{value:e})},updatePanelContent:function(t,i){if(this._selButtons)for(var n=this._selButtons.length-1;n>=0;--n){var a=this._selButtons[n];this.removeWidget(a)}var o=[];this._selButtons=[];var s=this.getBondData();if(s)for(var n=0,l=s.length;n<l;++n){var d=s[n],u=d.bondProps,a=this._createBondSelButton(t,d);a.appendToElem(i),this._selButtons.push(a),u&&r.pushUnique(o,e.ObjUtils.getOwnedFieldNames(u))}this.getBondPropNames()||this.setPropStoreFieldValue("bondPropNames",o)},_createBondSelButton:function(t,r){var i=new e.Widget.RadioButton(this);return i.addClassName(s.STRUCTURE_CONNECTOR_SELECT_PANEL_SET_BUTTON),i.setGroup(this.BTN_GROUP).setShowGlyph(!0).setShowText(!1),i.setText(r.text||null).setHint(r.hint||r.description||null),r.htmlClass&&i.addClassName(r.htmlClass),i[this.BTN_DATA_FIELD]=r,i}}),e.ChemWidget.StructureConnectorSelectPanelAdv=i.create(e.ChemWidget.StructureConnectorSelectPanel,{CLASS_NAME:"Kekule.ChemWidget.StructureConnectorSelectPanelAdv",initialize:function($super,t){this.setPropStoreFieldValue("extraComponents",[e.ChemWidget.StructureConnectorSelectPanelAdv.Components.KEKULIZE]),this._additionalCompWidgets=[],$super(t)},initProperties:function(){this.defineProp("extraComponents",{dataType:a.ARRAY,scope:i.PropertyScope.PUBLIC})},doGetWidgetClassName:function($super){return $super()+" "+s.STRUCTURE_CONNECTOR_SELECT_PANEL_ADV},doObjectChange:function($super,t){$super(t);var r=["extraComponents"];e.ArrayUtils.intersect(t,r).length&&this.updatePanelContent(this.getDocument(),this.getCoreElement())},updatePanelContent:function($super,t,r){this.clearAdditionalSections(),$super(t,r);var i=this.getExtraComponents();i&&i.indexOf(e.ChemWidget.StructureConnectorSelectPanelAdv.Components.KEKULIZE)>=0&&this._createKekulizeSection(t,r).appendToElem(r)},reactSelButtonExec:function($super,e){$super(e);var t=e.target;t._command&&this.invokeEvent("command",{command:t._command})},clearAdditionalSections:function(){if(this._additionalCompWidgets){for(var e=0,t=this._additionalCompWidgets.length;e<t;++e){this._additionalCompWidgets[e].finalize()}this._additionalCompWidgets=[]}},createAdditionalSection:function(t,r){var i=new e.Widget.Container(t);return i.addClassName(s.STRUCTURE_CONNECTOR_SELECT_PANEL_ADV_EXTRA_SECTION),this._additionalCompWidgets.push(i),i.appendToElem(r),i.setParent(this),i},_createKekulizeSection:function(t,r){var i=this.createAdditionalSection(t,r),n=new e.Widget.Button(i);n.addClassName([s.STRUCTURE_CONNECTOR_SELECT_PANEL_EXTRA_SECTION_BUTTON,s.STRUCTURE_CONNECTOR_SELECT_PANEL_EXTRA_SECTION_BUTTON_KEKULIZE]).setText(e.$L("ChemWidgetTexts.CAPTION_MOL_BOND_KEKULIZE")).setHint(e.$L("ChemWidgetTexts.HINT_MOL_BOND_KEKULIZE")).setShowGlyph(!0).setShowText(!1),n._command=e.ChemWidget.StructureConnectorSelectPanelAdv.Commands.KEKULIZE,i.appendWidget(n);var a=t.createElement("span");e.DomUtils.setElementText(a," ◀ ▶ "),i.getElement().appendChild(a);var o=new e.Widget.Button(i);return o.addClassName([s.STRUCTURE_CONNECTOR_SELECT_PANEL_EXTRA_SECTION_BUTTON,s.STRUCTURE_CONNECTOR_SELECT_PANEL_EXTRA_SECTION_BUTTON_HUCKLIZE]).setText(e.$L("ChemWidgetTexts.CAPTION_MOL_BOND_HUCKLIZE")).setHint(e.$L("ChemWidgetTexts.HINT_MOL_BOND_HUCKLIZE")).setShowGlyph(!0).setShowText(!1),o._command=e.ChemWidget.StructureConnectorSelectPanelAdv.Commands.HUCKLIZE,i.appendWidget(o),i}}),e.ChemWidget.StructureConnectorSelectPanelAdv.Components={KEKULIZE:"kekulize"},e.ChemWidget.StructureConnectorSelectPanelAdv.Commands={KEKULIZE:"kekulize",HUCKLIZE:"hucklize"},e.ChemWidget.ChargeSelectPanel=i.create(e.Widget.Panel,{CLASS_NAME:"Kekule.ChemWidget.ChargeSelectPanel",CHARGE_FIELD:"__$charge__",initialize:function($super,e){this._chargeBtnGroups={},this._selectedButton=null,this._chargeButtonMap=[],this.setPropStoreFieldValue("maxCharge",4),this.setPropStoreFieldValue("minCharge",-4),$super(e),this.addEventListener("execute",this.reactSelButtonExec.bind(this))},initProperties:function(){this.defineProp("value",{dataType:a.NUMBER,scope:i.PropertyScope.PUBLIC,setter:function(e){var t=this.getValue();if(e!==t){var r=this._chargeButtonMap[t];r&&(r.setChecked(!1),r.blur()),this.setPropStoreFieldValue("value",e);var i=this._chargeButtonMap[e];i&&i.setChecked(!0),this._selectedButton=i}}}),this.defineProp("minCharge",{dataType:a.NUMBER,scope:i.PropertyScope.PUBLIC,setter:function(e){e!==this.getMinCharge()&&(this.setPropStoreFieldValue("minCharge",e),this.updateChargeButtons())}}),this.defineProp("maxCharge",{dataType:a.NUMBER,scope:i.PropertyScope.PUBLIC,setter:function(e){e!==this.getMaxCharge()&&(this.setPropStoreFieldValue("maxCharge",e),this.updateChargeButtons())}})},doGetWidgetClassName:function($super){return $super()+" "+s.CHARGE_SELECT_PANEL},doCreateSubElements:function($super,e,t){var r=$super(e,t);return this.updateChargeButtons(e,t),r},updateChargeButtons:function(t,r){for(var i=this._chargeBtnGroups,n=["zero","positive","negative"],a=0,o=n.length;a<o;++a){var l=i[n[a]];l?l.clearWidgets():(l=new e.Widget.ButtonGroup(this),l.addClassName(s.CHARGE_SELECT_PANEL_BTNGROUP),l.appendToElem(r),i[n[a]]=l)}var d=Math.floor(this.getMaxCharge()),u=Math.floor(this.getMinCharge()),c=e.$L("ChemWidgetTexts.TEXT_CHARGE_POSITIVE"),h=e.$L("ChemWidgetTexts.TEXT_CHARGE_NEGATIVE");if(d>=1){var l=this._chargeBtnGroups.positive;if(l)for(var a=Math.max(u,1);a<=d;++a)this._createChargeButton(l,a,a+c)}if(d>=0&&u<=0){var l=this._chargeBtnGroups.zero;l&&this._createChargeButton(l,0,e.$L("ChemWidgetTexts.TEXT_CHARGE_NONE"),e.$L("ChemWidgetTexts.HINT_CHARGE_NONE"))}if(u<=-1){var l=this._chargeBtnGroups.negative;if(l)for(var a=Math.min(d,-1);a>=u;--a)this._createChargeButton(l,a,Math.abs(a)+h)}},_createChargeButton:function(t,r,i,n){var a=new e.Widget.RadioButton(t,i);return a[this.CHARGE_FIELD]=r,this._chargeButtonMap[r]=a,n&&a.setHint(n),a.addClassName(s.CHARGE_SELECT_PANEL_CHARGE_BUTTON),a.appendToWidget(t),this.getValue()===r&&(a.setChecked(!0),this._selectedButton=a),a},reactSelButtonExec:function(t){var r=t.target,i=r[this.CHARGE_FIELD];e.ObjUtils.notUnset(i)&&(this.setValue(i),this.notifyValueChange(i))},notifyValueChange:function(e){this.invokeEvent("valueChange",{value:e})}}),e.ChemWidget.GlyphPathArrowSettingPanel=i.create(e.Widget.Panel,{CLASS_NAME:"Kekule.ChemWidget.GlyphPathArrowSettingPanel",DATA_FIELD:"__$data$__",initialize:function($super,t){this._isSettingValue=!1,this._arrowWidthInputter=null,this._arrowLengthInputter=null,this._arrowStyleButtons=null,this.setPropStoreFieldValue("arrowWidthMin",0),this.setPropStoreFieldValue("arrowWidthMax",.5),this.setPropStoreFieldValue("arrowWidthStep",.1),this.setPropStoreFieldValue("arrowLengthMin",0),this.setPropStoreFieldValue("arrowLengthMax",.5),this.setPropStoreFieldValue("arrowLengthStep",.1),this.setPropStoreFieldValue("showContinousArrowSidesSetter",!1),this.setPropStoreFieldValue("defaultValue",{arrowType:e.Glyph.ArrowType.NONE,arrowSide:e.Glyph.ArrowSide.BOTH}),$super(t),this.addEventListener("check",this.reactArrowStyleButtonCheck.bind(this)),this.addEventListener("valueChange",this.reactArrowSizeInputterChange.bind(this)),this.addEventListener("valueInput",this.reactArrowSizeInputterInput.bind(this))},initProperties:function(){this.defineProp("defaultValue",{dataType:a.HASH,scope:i.PropertyScope.PRIVATE}),this.defineProp("value",{dataType:a.HASH,getter:function(){var e=this.getPropStoreFieldValue("value");return e||(e={},this.setPropStoreFieldValue("value",e)),e},setter:function(t){this._isSettingValue=!0;try{this.setPropStoreFieldValue("value",t);for(var r=Object.extend(Object.extend({},this.getDefaultValue()),t,!1,!0),i=0,n=this._arrowStyleButtons.length;i<n;++i){var a=this._arrowStyleButtons[i],o=a[this.DATA_FIELD];o.arrowType!==r.arrowType||o.arrowSide!==r.arrowSide&&o.arrowType!==e.Glyph.ArrowType.NONE?a.setChecked(!1):a.setChecked(!0)}this._arrowWidthInputter.setValue(r.arrowWidth||0),this._arrowLengthInputter.setValue(r.arrowLength||0)}finally{this._isSettingValue=!1}}}),this.defineProp("allowedArrowTypes",{dataType:a.ARRAY}),this.defineProp("allowedArrowSides",{dataType:a.ARRAY}),this.defineProp("arrowWidthMin",{dataType:a.NUMBER}),this.defineProp("arrowWidthMax",{dataType:a.NUMBER}),this.defineProp("arrowWidthStep",{dataType:a.NUMBER}),this.defineProp("arrowLengthMin",{dataType:a.NUMBER}),this.defineProp("arrowLengthMax",{dataType:a.NUMBER}),this.defineProp("arrowLengthStep",{dataType:a.NUMBER})},doObjectChange:function($super,e){(e.indexOf("allowedArrowTypes")>=0||e.indexOf("allowedArrowSides")>=0)&&this._updateStyleButtons(),r.intersect(e,["arrowWidthMin","arrowWidthMax","arrowWidthStep"]).length&&this._updateWidthInputter(),r.intersect(e,["arrowLengthMin","arrowLengthMax","arrowLengthStep"]).length&&this._updateLengthInputter()},doGetWidgetClassName:function($super){return $super()+" "+s.GLYPH_PATH_ARROW_SETTING_PANEL},doCreateSubElements:function($super,e,t){var r=$super(e,t),i=this.doCreateSectionElem(e,t),n=this.doCreateArrowStyleButtons(e,i),a=this.doCreateSectionElem(e,t),o=this.doCreateArrowSizeControls(e,a);return r.concat(n).concat(o)},doCreateSectionElem:function(e,t){var r=e.createElement("div");return t.appendChild(r),r},doCreateArrowStyleButtons:function(t,r){var i=e.Glyph.ArrowType,n=e.Glyph.ArrowSide,a={};a[i.NONE]="None",a[i.OPEN]="Open",a[i.TRIANGLE]="Triangle";var o={};o[n.BOTH]="Both",o[n.SINGLE]="Single",o[n.REVERSED]="Reversed";var l=[i.NONE,i.OPEN,i.TRIANGLE],d=[n.BOTH,n.SINGLE,n.REVERSED],u=new e.Widget.ButtonGroup(this);u.addClassName(s.GLYPH_PATH_ARROW_STYLE_BTNGROUP),this._arrowStyleButtons=[];var c=l.indexOf(i.NONE);if(c>=0){l.splice(c,1);var h=a[i.NONE],m=h,g=m,f=s.GLYPH_PATH_ARROW_STYLE_BUTTON+"-"+h,p=new e.Widget.RadioButton(u,m);p.setHint(g).addClassName(f),p[this.DATA_FIELD]={arrowType:i.NONE,arrowSide:(this.getDefaultValue()||{}).arrowSide},this._arrowStyleButtons.push(p)}for(var C=0,b=l.length;C<b;++C)for(var E=0,N=d.length;E<N;++E){var h=a[l[C]],T=o[d[E]],m=h+" / "+T,g=m,f=s.GLYPH_PATH_ARROW_STYLE_BUTTON+"-"+h+"-"+T,p=new e.Widget.RadioButton(u,m);p.setHint(g).addClassName(f),p[this.DATA_FIELD]={arrowType:l[C],arrowSide:d[E]},this._arrowStyleButtons.push(p)}return u.setShowGlyph(!0).setShowText(!1),this._updateStyleButtons(this._arrowStyleButtons),u.appendToElem(r),[u]},doCreateArrowSizeControls:function(t,r){var i=this._createArrowSizeSlider(t,r,e.$L("ChemWidgetTexts.CAPTION_WIDTH")+":"),n=this._createArrowSizeSlider(t,r,e.$L("ChemWidgetTexts.CAPTION_LENGTH")+":");return this._arrowWidthInputter=i,this._arrowLengthInputter=n,this._updateWidthInputter(i),this._updateLengthInputter(n),[i,n]},_createArrowSizeSlider:function(t,r,i){var n=t.createElement("div");n.className=s.GLYPH_Path_ARROW_SIZE_SETTER;var a=t.createElement("label");e.DomUtils.setElementText(a,i);var o=new e.Widget.NumInput(this);return o.appendToElem(a),n.appendChild(a),r.appendChild(n),o},_updateStyleButtons:function(e){var t=this.getAllowedArrowTypes(),r=this.getAllowedArrowSides();if(e||(e=this._arrowStyleButtons),e)for(var i=0,n=e.length;i<n;++i){var a=e[i][this.DATA_FIELD],o=t&&t.indexOf(a.arrowType)<0||r&&r.indexOf(a.arrowSide)<0;e[i].setDisplayed(!o)}},_updateSizeInputter:function(e,r,i,n,a){var o=t.notUnset;o(i)&&e.setMinValue(i),o(n)&&e.setMaxValue(n),o(a)&&e.setStep(a),o(r)&&e.setValue(r)},_updateWidthInputter:function(e){e||(e=this._arrowWidthInputter),this._updateSizeInputter(e,this.getValue().arrowWidth,this.getArrowWidthMin(),this.getArrowWidthMax(),this.getArrowWidthStep())},_updateLengthInputter:function(e){e||(e=this._arrowLengthInputter),this._updateSizeInputter(e,this.getValue().arrowLength,this.getArrowLengthMin(),this.getArrowLengthMax(),this.getArrowLengthStep())},getDefaultAllowedArrowTypes:function(){var t=e.Glyph.ArrowType;return[t.NONE,t.OPEN,t.TRIANGLE]},notifyValueChange:function(e){this.notifyPropSet("value",e),this.invokeEvent("valueChange",{value:e})},notifyValueInput:function(e){this.notifyPropSet("value",e),this.invokeEvent("valueInput",{value:e})},reactArrowStyleButtonCheck:function(e){if(!this._isSettingValue){var t=e.widget;if(t&&t[this.DATA_FIELD]){var r=this.getValue();r.arrowType=t[this.DATA_FIELD].arrowType,r.arrowSide=t[this.DATA_FIELD].arrowSide,this.notifyValueChange(r),e.stopPropagation()}}},reactArrowSizeInputterChange:function(e){if(!this._isSettingValue){var r=e.widget;if(r===this._arrowWidthInputter||r===this._arrowLengthInputter){var i=r.getValue()&&r.getValue();if(t.notUnset(i)){var n=this.getValue();r===this._arrowWidthInputter?n.arrowWidth=i:r===this._arrowLengthInputter&&(n.arrowLength=i),this.notifyValueChange(n),e.stopPropagation()}}}},reactArrowSizeInputterInput:function(e){if(!this._isSettingValue){var r=e.widget;if(r===this._arrowWidthInputter||r===this._arrowLengthInputter){var i=r.getValue()&&r.getValue();if(t.notUnset(i)){var n=this.getValue();r===this._arrowWidthInputter?n.arrowWidth=i:r===this._arrowLengthInputter&&(n.arrowLength=i),this.notifyValueInput(n),e.stopPropagation()}}}}}),e.ChemWidget.GlyphReactionArrowPresetSelector=i.create(e.Widget.Container,{CLASS_NAME:"Kekule.ChemWidget.GlyphReactionArrowPresetSelector",DATA_FIELD:"__$data$__",initialize:function($super,e){this._isSettingValue=!1,this._buttonSet=null,$super(e)},initProperties:function(){this.defineProp("value",{dataType:a.STRING,getter:function(){return this.getPropStoreFieldValue("value")||""},setter:function(e){this._isSettingValue=!0;try{this.setPropStoreFieldValue("value",e);for(var t=this._buttonSet.getButtonSet().getChildWidgets(),r=0,i=t.length;r<i;++r){var n=t[r];n[this.DATA_FIELD].reactionArrowType===e?n.setChecked(!0):n.setChecked(!1)}}finally{this._isSettingValue=!1}}}),this.defineProp("allowedReactionArrowTypes",{dataType:a.ARRAY})},doGetWidgetClassName:function($super){return $super()+" "+s.GLYPH_REACTION_ARROW_PRESET_SELECTOR},doCreateSubElements:function($super,e,t){var r=$super(e,t),i=this.doCreateButtonSet(e,t);return r.concat([i.getElement()])},doCreateButtonSet:function(t,r){var i=new e.Widget.CompactButtonSet(this);i.addClassName(s.GLYPH_REACTION_ARROW_PRESET_SELECTOR_BTNSET),i.getButtonSet().addClassName(s.GLYPH_REACTION_ARROW_PRESET_SELECTOR_BTNSET_DROPDOWN);for(var n=this.getAllowedReactionArrowTypes()||this.getDefaultAllowedReactionTypes(),a=0,o=n.length;a<o;++a){var l=new e.Widget.RadioButton(i),d=this._getPresetButtonDetails(n[a]);l.addClassName(d.className,!0).setText(d.caption).setHint(d.hint).setShowText(!0).setShowGlyph(!0),l[this.DATA_FIELD]={reactionArrowType:n[a]},i.append(l)}var u=this;return i.addEventListener("select",function(e){if(!u._isSettingValue&&e.target===i){var t=e.selected;if(t&&t[u.DATA_FIELD]){var r=t[u.DATA_FIELD].reactionArrowType;u.setPropStoreFieldValue("value",r),u.notifyValueChange(r)}}}),i.appendToElem(r),this._buttonSet=i,i},_getPresetButtonDetails:function(t){var r=(e.Glyph.ReactionArrowType,t?t.toUpperCase():"UNSET"),i=t?t.upperFirst():"Unset",n="REACTION_ARROW_"+r;return{caption:e.$L("ChemWidgetTexts.CAPTION_"+n),hint:e.$L("ChemWidgetTexts.HINT_"+n),className:s.GLYPH_REACTION_ARROW_PRESET_SELECTOR_BUTTON+" "+s.GLYPH_REACTION_ARROW_PRESET_SELECTOR_BUTTON+"-"+i}},notifyValueChange:function(e){this.notifyPropSet("value",e),this.invokeEvent("valueChange",{value:e})},getDefaultAllowedReactionTypes:function(){var t=e.Glyph.ReactionArrowType;return[null,t.NORMAL,t.REVERSIBLE,t.RESONANCE,t.RETROSYNTHESIS,t.CUSTOM]}}),e.ChemWidget.GlyphElectronPushingArrowPresetSelector=i.create(e.Widget.Container,{CLASS_NAME:"Kekule.ChemWidget.GlyphElectronPushingArrowPresetSelector",DATA_FIELD:"__$data$__",initialize:function($super,e){this._isSettingValue=!1,this._buttonGroup=null,$super(e)},initProperties:function(){this.defineProp("value",{dataType:a.INT,getter:function(){return this.getPropStoreFieldValue("value")||""},setter:function(e){this._isSettingValue=!0;try{this.setPropStoreFieldValue("value",e);for(var t=this._buttonGroup.getChildWidgets(),r=0,i=t.length;r<i;++r){var n=t[r];n[this.DATA_FIELD].electronCount===e?n.setChecked(!0):n.setChecked(!1)}}finally{this._isSettingValue=!1}}}),this.defineProp("allowedReactionArrowTypes",{dataType:a.ARRAY})},doGetWidgetClassName:function($super){return $super()+" "+s.GLYPH_ELECTRON_PUSHING_ARROW_PRESET_SELECTOR},doCreateSubElements:function($super,e,t){var r=$super(e,t),i=this.doCreateButtonGroup(e,t);return r.concat([i.getElement()])},doCreateButtonGroup:function(t,r){var i=new e.Widget.ButtonGroup(this);i.addClassName(s.GLYPH_ELECTRON_PUSHING_ARROW_PRESET_SELECTOR_BTNGROUP);for(var n=[2,1],a=0,o=n.length;a<o;++a){var l=n[a],d=new e.Widget.RadioButton(i),u=this._getPresetButtonDetails(l);d.addClassName(u.className,!0).setText(u.caption).setHint(u.hint).setShowText(!0).setShowGlyph(!0),d[this.DATA_FIELD]={electronCount:l},i.appendWidget(d)}var c=this;return i.addEventListener("check",function(e){if(!c._isSettingValue){var t=e.widget;if(t&&t[c.DATA_FIELD]){var r=t[c.DATA_FIELD].electronCount;c.setPropStoreFieldValue("value",r),c.notifyValueChange(r)}}}),i.appendToElem(r),this._buttonGroup=i,i},_getPresetButtonDetails:function(t){var r=t.toString(),i="ELECTRON_PUSHING_ARROW_"+t;return{caption:e.$L("ChemWidgetTexts.CAPTION_"+i+"_ABBR"),hint:e.$L("ChemWidgetTexts.HINT_"+i),className:s.GLYPH_ELECTRON_PUSHING_ARROW_PRESET_SELECTOR_BUTTON+" "+s.GLYPH_ELECTRON_PUSHING_ARROW_PRESET_SELECTOR_BUTTON+"-"+r}},notifyValueChange:function(e){this.notifyPropSet("value",e),this.invokeEvent("valueChange",{value:e})}}),e.ChemWidget.GlyphPathLineSettingPanel=i.create(e.Widget.Panel,{CLASS_NAME:"Kekule.ChemWidget.GlyphPathLineSettingPanel",initialize:function($super,e){this._isSettingValue=!1,this.setPropStoreFieldValue("lineCountMin",1),this.setPropStoreFieldValue("lineCountMax",5),this.setPropStoreFieldValue("lineCountStep",1),this.setPropStoreFieldValue("lineGapMin",0),this.setPropStoreFieldValue("lineGapMax",.8),this.setPropStoreFieldValue("lineGapStep",.1),$super(e),this.addEventListener("valueChange",this.reactInputWidgetChange.bind(this))},initProperties:function(){this.defineProp("value",{dataType:a.HASH,getter:function(){var e=this.getPropStoreFieldValue("value");return e||(e={},this.setPropStoreFieldValue("value",e)),e},setter:function(e){this._isSettingValue=!0;try{this.setPropStoreFieldValue("value",e),t.notUnset(e.lineCount)&&this._lineCountInput.setValue(e.lineCount),t.notUnset(e.lineGap)&&this._lineGapInput.setValue(e.lineGap)}finally{this._isSettingValue=!1}}}),this.defineProp("lineCountMin",{dataType:a.NUMBER}),this.defineProp("lineCountMax",{dataType:a.NUMBER}),this.defineProp("lineCountStep",{dataType:a.NUMBER}),this.defineProp("lineGapMin",{dataType:a.NUMBER}),this.defineProp("lineGapMax",{dataType:a.NUMBER}),this.defineProp("lineGapStep",{dataType:a.NUMBER})},doGetWidgetClassName:function($super){return $super()+" "+s.GLYPH_PATH_LINE_SETTING_PANEL},doCreateSubElements:function($super,t,r){var i=$super(t,r),n=this.doCreateNumInputSection(t,r,e.$L("ChemWidgetTexts.CAPTION_LINE_COUNT")+":");this._lineCountInput=n.widget,this._updateLineCountInput();var a=this.doCreateNumInputSection(t,r,e.$L("ChemWidgetTexts.CAPTION_LINE_GAP")+":");return this._lineGapInput=a.widget,this._updateLineGapInput(),i.concat([n,a])},doCreateNumInputSection:function(t,r,i){var n=t.createElement("span"),a=t.createElement("label");e.DomUtils.setElementText(a,i);var o=new e.Widget.NumInput(this,null,null,null,"number");return o.appendToElem(a),n.appendChild(a),r.appendChild(n),{elem:n,widget:o}},_updateInputWidget:function(e,r,i,n,a){var o=t.notUnset;e&&(e.setValue(r),o(i)&&e.setMinValue(i),o(n)&&e.setMaxValue(n),o(a)&&e.setStep(a))},_updateLineCountInput:function(){this._updateInputWidget(this._lineCountInput,this.getValue().lineCount,this.getLineCountMin(),this.getLineCountMax(),this.getLineCountStep())},_updateLineGapInput:function(){this._updateInputWidget(this._lineGapInput,this.getValue().lineGap,this.getLineGapMin(),this.getLineGapMax(),this.getLineGapStep())},notifyValueChange:function(e){this.notifyPropSet("value",e),this.invokeEvent("valueChange",{value:e})},reactInputWidgetChange:function(e){if(!this._isSettingValue){var r=e.widget;if(r===this._lineCountInput||r===this._lineGapInput){var i=r.getValue()&&r.getValue();if(t.notUnset(i)){var n=this.getValue();r===this._lineCountInput?n.lineCount=i:r===this._lineGapInput&&(n.lineGap=i),this.notifyValueChange(n),e.stopPropagation()}}}}}),e.ChemWidget.GlyphPathSettingPanel=i.create(e.Widget.Panel,{CLASS_NAME:"Kekule.ChemWidget.GlyphPathSettingPanel",DEF_COMPONENTS:["startingArrow","endingArrow","line"],initialize:function($super,e){$super(e),this.addEventListener("valueChange",this.reactChildSetterValueChange.bind(this)),this.addEventListener("valueInput",this.reactChildSetterValueInput.bind(this))},initProperties:function(){this.defineProp("value",{dataType:a.HASH,getter:function(){var e={};return this._startingArrowSetter&&(e=Object.extend(e,this._addPropPrefix(this._startingArrowSetter.getValue(),"start"))),this._endingArrowSetter&&(e=Object.extend(e,this._addPropPrefix(this._endingArrowSetter.getValue(),"end"))),this._lineSetter&&(e=Object.extend(e,this._lineSetter.getValue())),e},setter:function(e){if(e){var t=this._splitChildSetterValues(e);this._startingArrowSetter&&this._startingArrowSetter.setValue(t.startingArrow),this._endingArrowSetter&&this._endingArrowSetter.setValue(t.endingArrow),this._lineSetter&&this._lineSetter.setValue(t.line)}}}),this.defineProp("components",{dataType:a.ARRAY})},doObjectChange:function($super,e){return e.indexOf("components")>=0&&this.updateComponents(),$super(e)},doGetWidgetClassName:function($super){return $super()+" "+s.GLYPH_PATH_SETTING_PANEL},doCreateSubElements:function($super,t,r){var i=$super(t,r),n=this.doCreateArrowSettingSection(t,r,e.$L("ChemWidgetTexts.CAPTION_STARTING_ARROW"));this._startingArrowSetter=n.widget,this._startingArrowElem=n.elem;var a=this.doCreateArrowSettingSection(t,r,e.$L("ChemWidgetTexts.CAPTION_ENDING_ARROW"));this._endingArrowSetter=a.widget,this._endingArrowElem=a.elem;var o=this.doCreateLineSettingSection(t,r,e.$L("ChemWidgetTexts.CAPTION_LINE"));return this._lineSetter=o.widget,this._lineElem=o.elem,i=i.concat([n.elem,a.elem,o.elem]),this.updateComponents(),i},doCreateSectionElem:function(t,r,i,n){var a=t.createElement("div"),o=t.createElement("label");e.DomUtils.setElementText(o,i),o.className=s.GLYPH_PATH_SETTING_PANEL_SECTION_TITLE,a.appendChild(o);var l=s.GLYPH_PATH_SETTING_PANEL_SECTION;return n&&(l+=" "+n),a.className=l,r.appendChild(a),a},doCreateArrowSettingSection:function(t,r,i){var n=this.doCreateSectionElem(t,r,i),a=new e.ChemWidget.GlyphPathArrowSettingPanel(this);return a.addClassName(s.GLYPH_PATH_SETTING_PANEL_SECTION_PANEL),a.appendToElem(n),{elem:n,widget:a}},doCreateLineSettingSection:function(t,r,i){var n=this.doCreateSectionElem(t,r,i),a=new e.ChemWidget.GlyphPathLineSettingPanel(this);return a.addClassName(s.GLYPH_PATH_SETTING_PANEL_SECTION_PANEL),a.appendToElem(n),{elem:n,widget:a}},updateComponents:function(){var t=this.getComponents()||this.DEF_COMPONENTS,r=e.StyleUtils;r.setDisplay(this._startingArrowElem,t.indexOf("startingArrow")>=0),r.setDisplay(this._endingArrowElem,t.indexOf("endingArrow")>=0),r.setDisplay(this._lineElem,t.indexOf("line")>=0)},reactChildSetterValueChange:function(e){var t=e.widget;if(t&&this.getChildValueSetterWidgets().indexOf(t)>=0){var r=this.getValue();e.stopPropagation(),this.notifyPropSet("value",r),this.invokeEvent("valueChange",{value:r})}},reactChildSetterValueInput:function(e){var t=e.widget;if(t&&this.getChildValueSetterWidgets().indexOf(t)>=0){var r=this.getValue();e.stopPropagation(),this.notifyPropSet("value",r),this.invokeEvent("valueInput",{value:r})}},getChildValueSetterWidgets:function(e){return[this._startingArrowSetter,this._endingArrowSetter,this._lineSetter]},getStartingArrowSetter:function(){return this._startingArrowSetter},getEndingArrowSetter:function(){return this._endingArrowSetter},_addPropPrefix:function(e,r){for(var i={},n=t.getOwnedFieldNames(e,!1),a=0,o=n.length;a<o;++a){var s=e[n[a]];i[r+n[a].capitalizeFirst()]=s}return i},_splitChildSetterValues:function(e){for(var r={startingArrow:{},endingArrow:{},line:{}},i=t.getOwnedFieldNames(e),n=0,a=i.length;n<a;++n){var o,s=i[n],l=e[s];s.startsWith("startArrow")?(o="arrow"+s.substr(10),r.startingArrow[o]=l):s.startsWith("endArrow")?(o="arrow"+s.substr(8),r.endingArrow[o]=l):r.line[s]=l}return r}}),e.ChemWidget.GlyphMultiPathSettingPanel=i.create(e.Widget.Panel,{CLASS_NAME:"Kekule.ChemWidget.GlyphMultiPathSettingPanel",DEF_PATH_COUNT:2,DEF_COMPONENTS:["endingArrow"],initialize:function($super,e){this.setPropStoreFieldValue("value",[]),$super(e),this.getPathCount()||this.setPathCount(this.DEF_PATH_COUNT),this.setActivePathIndex(0);var t=this.reactChildSetterValueChange.bind(this),r=this.reactChildSetterValueInput.bind(this);this.addEventListener("valueChange",t),this.addEventListener("valueInput",r),this.addEventListener("switch",this.reactPathTabSwitch.bind(this))},initProperties:function(){this.defineProp("pathCount",{dataType:a.INT,getter:function(){return this.getPathTabGroup().getTabButtons().length},setter:function(e){this._updatePathTabGroup(e)}}),this.defineProp("pathSettingPanel",{dataType:"Kekule.ChemWidget.GlyphPathSettingPanel",serializable:!1,setter:null}),this.defineProp("pathTabGroup",{dataType:"Kekule.Widget.TabButtonGroup",serializable:!1,setter:null}),this.defineProp("activePathIndex",{dataType:a.INT,getter:function(){return this.getPathTabGroup().getActiveTabIndex()},setter:function(e){this.getPathTabGroup().setActiveTabIndex(e),this._switchToNewPathTab(e)}}),this.defineProp("value",{dataType:a.HASH,setter:function(e){if(e){var t=r.toArray(e);this.setPropStoreFieldValue("value",t),t.length>this.getActivePathIndex()&&this.getPathSettingPanel().setValue(t[this.getActivePathIndex()])}else this.setPropStoreFieldValue("value",[])}}),this.defineProp("components",{dataType:a.ARRAY,serializable:!1,getter:function(){var e=this.getPathSettingPanel();return e&&e.getComponents()},setter:function(e){this.getPathSettingPanel().setComponents(e)}})},doGetWidgetClassName:function($super){return $super()+" "+s.GLYPH_MULTIPATH_SETTING_PANEL},doCreateSubElements:function($super,t,r){var i=$super(t,r),n=new e.Widget.TabButtonGroup(this);n.setTabButtonPosition(e.Widget.Position.TOP).addClassName(s.GLYPH_MULTIPATH_SETTING_PANEL_PATH_TABGROUP),this.setPropStoreFieldValue("pathTabGroup",n);var a=new e.ChemWidget.GlyphPathSettingPanel(this);return a.addClassName(s.GLYPH_MULTIPATH_SETTING_PANEL_PATH_SETTING_PANEL),a.setComponents(this.DEF_COMPONENTS),this.setPropStoreFieldValue("pathSettingPanel",a),i},getStartingArrowSetter:function(){return this.getPathSettingPanel().getStartingArrowSetter()},getEndingArrowSetter:function(){return this.getPathSettingPanel().getEndingArrowSetter()},_updatePathTabGroup:function(t){var r=(this.getActivePathIndex(),this.getPathCount());if(r!==t){var i=this.getPathTabGroup(),n=i.getTabButtons();if(r>t)for(var a=r-1;a>=t;--a){var o=n[a];i.removeWidget(o)}else for(var a=r;a<t;++a){var o=new e.Widget.RadioButton(i),s=e.$L("ChemWidgetTexts.CAPTION_PATH_INDEX").format(""+(a+1)),l=e.$L("ChemWidgetTexts.HINT_PATH_INDEX").format(""+(a+1));o.setText(s).setHint(l)}}},_switchToNewPathTab:function(e){if(e>=0){var t=(this.getValue()||[])[e];this.getPathSettingPanel().setValue(t||{})}},reactChildSetterValueChange:function(e){var t=this.getActivePathIndex();if(t>=0){var r=e.widget;if(r===this.getPathSettingPanel()){var i=r.getValue();e.stopPropagation();var n=this.getValue()||[];n[t]=i,this.setPropStoreFieldValue("value",n),this.notifyPropSet("value",n),this.invokeEvent("valueChange",{value:n})}}},reactChildSetterValueInput:function(e){var t=this.getActivePathIndex();if(t>=0){var r=e.widget;if(r===this.getPathSettingPanel()){var i=r.getValue();e.stopPropagation();var n=this.getValue()||[];n[t]=i,this.setPropStoreFieldValue("value",n),this.notifyPropSet("value",n),this.invokeEvent("valueInput",{value:n})}}},reactPathTabSwitch:function(e){if(e.widget===this.getPathTabGroup()){var t=e.button,r=this.getPathTabGroup().getTabButtons(),i=r.indexOf(t);this._switchToNewPathTab(i)}}}),e.ChemWidget.GlyphReactionArrowPathSettingPanel=i.create(e.ChemWidget.GlyphPathSettingPanel,{CLASS_NAME:"Kekule.ChemWidget.GlyphReactionArrowPathSettingPanel",doGetValue:function($super){var e=$super()||{};return this._reactionArrowPresetSelector&&(e.reactionArrowType=this._reactionArrowPresetSelector.getValue()),e},doSetValue:function($super,e){$super(e),this._reactionArrowPresetSelector&&(this._reactionArrowPresetSelector.setValue(e.reactionArrowType),this._updateArrowSettingPanelEnableState())},doGetWidgetClassName:function($super){return $super()+" "+s.GLYPH_REACTION_ARROW_PATH_SETTING_PANEL},doCreateSubElements:function($super,t,r){var i=this.doCreateReactionArrowPresetSection(t,r,e.$L("ChemWidgetTexts.CAPTION_REACTION_ARROW_TYPE"));this._reactionArrowPresetSelector=i.widget,this._reactionArrowPresetElem=i.elem;var n=$super(t,r);return this.updateComponents(),n},doCreateReactionArrowPresetSection:function(t,r,i){var n=this.doCreateSectionElem(t,r,i,s.GLYPH_REACTION_ARROW_PATH_SETTING_PANEL_ARROW_PRESET_SECTION),a=new e.ChemWidget.GlyphReactionArrowPresetSelector(this);return a.appendToElem(n),{elem:n,widget:a}},updateComponents:function($super){$super(),this._updateArrowSettingPanelEnableState()},_updateArrowSettingPanelEnableState:function(){var t=e.Glyph.ReactionArrowType,i=this._reactionArrowPresetSelector.getValue(),n=null,a=null,o=t.getDefPathParamOfArrowType(i);if(o){var s=(o.startArrowType,o.endArrowType,o.hasOwnProperty("startArrowType")&&o.startArrowType),l=o.hasOwnProperty("endArrowType")&&o.endArrowType;if(s&&(n=this._startingArrowSetter.getDefaultAllowedArrowTypes(),n=r.exclude(n,[e.Glyph.ArrowType.NONE])),l){var a=this._endingArrowSetter.getDefaultAllowedArrowTypes();a=r.exclude(a,[e.Glyph.ArrowType.NONE])}this._startingArrowSetter.setEnabled(s),this._endingArrowSetter.setEnabled(l)}else this._startingArrowSetter.setEnabled(!0),this._endingArrowSetter.setEnabled(!0);this._startingArrowSetter.setAllowedArrowTypes(n),this._endingArrowSetter.setAllowedArrowTypes(a)},_updatePathParamsByReactionArrowPreset:function(r){var i=e.Glyph.ArrowType,n=e.Glyph.ReactionArrowType.getDefPathParamOfArrowType(r);if(n||r||(n={startArrowType:i.NONE,endArrowType:i.NONE}),n){var a={},o={},s={};void 0!==n.startArrowType&&(a.arrowType=n.startArrowType),void 0!==n.startArrowSide&&(a.arrowSide=n.startArrowSide),void 0!==n.endArrowType&&(o.arrowType=n.endArrowType),void 0!==n.endArrowSide&&(o.arrowSide=n.endArrowSide),n.lineCount&&(s.lineCount=n.lineCount),n.lineGap&&(s.lineGap=n.lineGap),t.getOwnedFieldNames(a).length&&this._startingArrowSetter.setValue(Object.extend(this._startingArrowSetter.getValue(),a)),t.getOwnedFieldNames(o).length&&this._endingArrowSetter.setValue(Object.extend(this._endingArrowSetter.getValue(),o)),t.getOwnedFieldNames(s).length&&this._lineSetter.setValue(Object.extend(this._lineSetter.getValue(),s))}},getChildValueSetterWidgets:function($super){var e=$super();return e.push(this._reactionArrowPresetSelector),e},reactChildSetterValueChange:function($super,e){e.widget===this._reactionArrowPresetSelector&&(this._updateArrowSettingPanelEnableState(),this._updatePathParamsByReactionArrowPreset(e.value)),$super(e)}}),e.ChemWidget.GlyphArcPathSettingPanel=i.create(e.ChemWidget.GlyphPathSettingPanel,{CLASS_NAME:"Kekule.ChemWidget.GlyphArcPathSettingPanel",DEF_COMPONENTS:["startingArrow","endingArrow"],doGetWidgetClassName:function($super){return $super()+" "+s.GLYPH_ARC_PATH_SETTING_PANEL}}),e.ChemWidget.GlyphMultiArcPathSettingPanel=i.create(e.ChemWidget.GlyphMultiPathSettingPanel,{CLASS_NAME:"Kekule.ChemWidget.GlyphMultiArcPathSettingPanel",DEF_COMPONENTS:["startingArrow","endingArrow"],doGetWidgetClassName:function($super){return $super()+" "+s.GLYPH_MULTIARC_PATH_SETTING_PANEL}}),e.ChemWidget.BaseGlyphElectronArrowSettingPanel=i.create(e.Widget.Panel,{CLASS_NAME:"Kekule.ChemWidget.BaseGlyphElectronArrowSettingPanel",DEF_COMPONENTS:["endingArrow"],initialize:function($super,e){this._glyphPathSettingPanel=null,this._endingArrowSetter=null,this._arrowPresetSelector=null,$super(e),this.addEventListener("valueChange",this.reactChildSetterValueChange.bind(this)),this.addEventListener("valueInput",this.reactChildSetterValueInput.bind(this))},initProperties:function(){this.defineProp("value",{dataType:a.HASH,getter:function(){var e=this._glyphPathSettingPanel.getValue()||{};return e.electronCount=this._arrowPresetSelector.getValue(),e},setter:function(e){this._glyphPathSettingPanel.setValue(e),this._arrowPresetSelector.setValue(e&&e.electronCount),this._updateArrowSettingPanel()}})},doCreateSubElements:function($super,t,r){var i=$super(t,r),n=this.doCreateArrowPresetSection(t,r,e.$L("ChemWidgetTexts.CAPTION_ELECTRON_PUSHING_ARROW_TYPE"));this._arrowPresetSelector=n.widget,this._arrowPresetElem=n.elem,e.HtmlElementUtils.addClass(this._arrowPresetElem,s.GLYPH_REACTION_ARROW_PATH_SETTING_PANEL_ARROW_PRESET_SECTION);var a=this.doCreateGlyphPathSettingSection(t,r);if(this._glyphPathSettingPanel=a.widget,this._glyphPathSettingPanel&&(this._glyphPathSettingPanel.removeClassName(o.PANEL),this._glyphPathSettingPanel.setComponents&&this._glyphPathSettingPanel.setComponents(this.DEF_COMPONENTS),this._glyphPathSettingPanel.getEndingArrowSetter)){this._endingArrowSetter=this._glyphPathSettingPanel.getEndingArrowSetter();var l=e.Glyph.ArrowType;this._endingArrowSetter.setAllowedArrowTypes([l.OPEN,l.TRIANGLE])}return i.concat([n.elem,a.elem])},doCreateSectionElem:function(t,r,i,n){var a=t.createElement("div");if(i){var o=t.createElement("label");e.DomUtils.setElementText(o,i),o.className=s.GLYPH_PATH_SETTING_PANEL_SECTION_TITLE,a.appendChild(o)}var l=s.GLYPH_PATH_SETTING_PANEL_SECTION;return n&&(l+=" "+n),a.className=l,r.appendChild(a),a},doCreateArrowPresetSection:function(t,r,i){var n=this.doCreateSectionElem(t,r,i),a=new e.ChemWidget.GlyphElectronPushingArrowPresetSelector(this);return a.appendToElem(n),{elem:n,widget:a}},doCreateGlyphPathSettingSection:function(e,t,r){var i=this.doCreateGlyphPathSettingWidget();if(i){var n=this.doCreateSectionElem(e,t,r);return i.appendToElem(n),{elem:n,widget:i}}return null},doCreateGlyphPathSettingWidget:function(){return null},reactChildSetterValueChange:function($super,e){var t=e.widget;t===this._arrowPresetSelector&&this._updateArrowSettingPanel(),[this._arrowPresetSelector,this._glyphPathSettingPanel].indexOf(t)>=0&&(e.stopPropagation(),this.invokeEvent("valueChange",{value:this.getValue()})),$super(e)},reactChildSetterValueInput:function($super,e){var t=e.widget;t===this._arrowPresetSelector&&this._updateArrowSettingPanel(),[this._arrowPresetSelector,this._glyphPathSettingPanel].indexOf(t)>=0&&(e.stopPropagation(),this.invokeEvent("valueInput",{value:this.getValue()})),$super(e)},_updateArrowSettingPanel:function(){var t=e.Glyph.ArrowSide,r=this._endingArrowSetter,i=this._arrowPresetSelector.getValue(),n=[];n=i>=2?[t.BOTH]:1===i?[t.SINGLE,t.REVERSED]:[t.BOTH,t.SINGLE,t.REVERSED],r.setAllowedArrowSides(n)}}),e.ChemWidget.GlyphElectronPushingArrowSettingPanel=i.create(e.ChemWidget.BaseGlyphElectronArrowSettingPanel,{CLASS_NAME:"Kekule.ChemWidget.GlyphElectronPushingArrowSettingPanel",doCreateGlyphPathSettingWidget:function(){return new e.ChemWidget.GlyphArcPathSettingPanel(this)}}),e.ChemWidget.GlyphMultiElectronPushingArrowSettingPanel=i.create(e.ChemWidget.BaseGlyphElectronArrowSettingPanel,{CLASS_NAME:"Kekule.ChemWidget.GlyphMultiElectronPushingArrowSettingPanel",doCreateGlyphPathSettingWidget:function(){return new e.ChemWidget.GlyphMultiArcPathSettingPanel(this)}}),e.ChemWidget.GlyphElectronPushingArrowSettingPanel=i.create(e.ChemWidget.BaseGlyphElectronArrowSettingPanel,{CLASS_NAME:"Kekule.ChemWidget.GlyphElectronPushingArrowSettingPanel",doCreateGlyphPathSettingWidget:function(){return new e.ChemWidget.GlyphArcPathSettingPanel(this)}}),e.ChemWidget.GlyphMultiElectronPushingArrowSettingPanel=i.create(e.ChemWidget.BaseGlyphElectronArrowSettingPanel,{CLASS_NAME:"Kekule.ChemWidget.GlyphMultiElectronPushingArrowSettingPanel",doCreateGlyphPathSettingWidget:function(){return new e.ChemWidget.GlyphMultiArcPathSettingPanel(this)}}),e.ChemWidget.GlyphElectronPushingArrowSettingPanel_OLD=i.create(e.ChemWidget.GlyphPathSettingPanel,{CLASS_NAME:"Kekule.ChemWidget.GlyphElectronPushingArrowSettingPanel",DEF_COMPONENTS:["endingArrow"],initialize:function($super,t){$super(t);var r=e.Glyph.ArrowType;this._endingArrowSetter.setAllowedArrowTypes([r.OPEN,r.TRIANGLE])},doGetValue:function($super){var e=$super()||{};return this._arrowPresetSelector&&(e.electronCount=this._arrowPresetSelector.getValue()),e},doSetValue:function($super,e){$super(e),this._arrowPresetSelector&&(this._arrowPresetSelector.setValue(e.electronCount),this._updateArrowSettingPanel())},doGetWidgetClassName:function($super){return $super()+" "+s.GLYPH_ELECTRON_PUSHING_ARROW_SETTING_PANEL},doCreateSubElements:function($super,t,r){var i=this.doCreateArrowPresetSection(t,r,e.$L("ChemWidgetTexts.CAPTION_ELECTRON_PUSHING_ARROW_TYPE"));return this._arrowPresetSelector=i.widget,this._arrowPresetElem=i.elem,$super(t,r)},doCreateArrowPresetSection:function(t,r,i){var n=this.doCreateSectionElem(t,r,i),a=new e.ChemWidget.GlyphElectronPushingArrowPresetSelector(this);return a.appendToElem(n),{elem:n,widget:a}},getChildValueSetterWidgets:function($super){var e=$super();return e.push(this._arrowPresetSelector),e.push(this._reversedArrowSideCheckBox),e},reactChildSetterValueChange:function($super,e){e.widget===this._arrowPresetSelector&&this._updateArrowSettingPanel(),$super(e)},_updateArrowSettingPanel:function(){var t=e.Glyph.ArrowSide,r=this.getEndingArrowSetter(),i=this._arrowPresetSelector.getValue(),n=[];n=i>=2?[t.BOTH]:1===i?[t.SINGLE,t.REVERSED]:[t.BOTH,t.SINGLE,t.REVERSED],r.setAllowedArrowSides(n)}}),e.ChemWidget.GlyphMultiElectronPushingArrowSettingPanel_OLD=i.create(e.ChemWidget.GlyphMultiPathSettingPanel,{CLASS_NAME:"Kekule.ChemWidget.GlyphMultiElectronPushingArrowSettingPanel",DEF_COMPONENTS:["endingArrow"],doGetWidgetClassName:function($super){return $super()+" "+s.GLYPH_MULTI_ELECTRON_PUSHING_ARROW_SETTING_PANEL},initialize:function($super,t){$super(t);var r=e.Glyph.ArrowType;this._endingArrowSetter=this.getPathSettingPanel().getEndingArrowSetter(),this._endingArrowSetter.setAllowedArrowTypes([r.OPEN,r.TRIANGLE])},doGetValue:function($super){var e=$super()||{};return this._arrowPresetSelector&&(e.electronCount=this._arrowPresetSelector.getValue()),e},doSetValue:function($super,e){$super(e),this._arrowPresetSelector&&(this._arrowPresetSelector.setValue(e.electronCount),this._updateArrowSettingPanel())},doCreateSubElements:function($super,t,r){var i=this.doCreateArrowPresetSection(t,r,e.$L("ChemWidgetTexts.CAPTION_ELECTRON_PUSHING_ARROW_TYPE"));return this._arrowPresetSelector=i.widget,this._arrowPresetElem=i.elem,$super(t,r)},doCreateSectionElem:function(t,r,i,n){var a=t.createElement("div"),o=t.createElement("label");e.DomUtils.setElementText(o,i),a.appendChild(o);var l=s.GLYPH_PATH_SETTING_PANEL_SECTION;return n&&(l+=" "+n),a.className=l,r.appendChild(a),a},doCreateArrowPresetSection:function(t,r,i){var n=this.doCreateSectionElem(t,r,i),a=new e.ChemWidget.GlyphElectronPushingArrowPresetSelector(this);return a.appendToElem(n),{elem:n,widget:a}},_updateArrowSettingPanel:function(){var t=e.Glyph.ArrowSide,r=this.getEndingArrowSetter(),i=this._arrowPresetSelector.getValue(),n=[];n=i>=2?[t.BOTH]:1===i?[t.SINGLE,t.REVERSED]:[t.BOTH,t.SINGLE,t.REVERSED],r.setAllowedArrowSides(n)}}),e}},function(e,t,r){"use strict";var i=r(0).Class,n=r(0).ClassEx,a=r(0).DataType;e.exports=function(e){var t=e.ArrayUtils,r=e.CoordUtils,o=e.ChemWidget.HtmlClassNames;e.ChemWidget.HtmlClassNames=Object.extend(e.ChemWidget.HtmlClassNames,{CHEMSPACE_EDITOR:"K-Chem-Space-Editor",CHEMSPACE_EDITOR2D:"K-Chem-Space-Editor2D",CHEMSPACE_EDITOR3D:"K-Chem-Space-Editor3D",CHEMEDITOR_ATOM_SETTER:"K-ChemEditor-Atom-Setter",CHEMEDITOR_TEXT_SETTER:"K-ChemEditor-Text-Setter",CHEMEDITOR_FORMULA_SETTER:"K-ChemEditor-Formula-Setter"}),e.Editor.ChemSpaceEditor=i.create(e.Editor.BaseEditor,{CLASS_NAME:"Kekule.Editor.ChemSpaceEditor",initialize:function($super,e,t,r,i,n){this.setPropStoreFieldValue("allowCreateNewChild",!0),this.setPropStoreFieldValue("autoCreateNewStructFragment",!0),this.setPropStoreFieldValue("allowAppendDataToCurr",!0),this._screenSize=n,$super(e,t,r,i),this._containerChemSpace=null,console.log("+++++++++++ HI!!! I'm CherryPickToApril Kekule.Editor.ChemSpaceEditor.")},initProperties:function(){this.defineProp("chemSpace",{dataType:"Kekule.ChemSpace",serializable:!1,getter:function(){return this.getChemObj()},setter:function(e){this.setChemObj(e)}}),this.defineProp("autoCreateNewStructFragment",{dataType:a.BOOL,getter:function(){return this.getPropStoreFieldValue("autoCreateNewStructFragment")&&this.canCreateNewChild()}}),this.defineProp("allowCreateNewChild",{dataType:a.BOOL}),this.defineProp("allowAppendDataToCurr",{dataType:a.BOOL})},initPropValues:function($super){$super(),this.setFileDroppable(!0)},canCreateNewChild:function(){return this.getChemSpace()&&(this.getAllowCreateNewChild()||this.getChemSpace().getChildCount()<=0)},getActualDrawOptions:function($super){var e=$super();return e.useExplicitSpaceSize=!0,e},doSetChemObj:function($super,t){var r=this.getChemObj();if(r!==t)if(r&&this._containerChemSpace&&(r.finalize(),this._containerChemSpace=null),t){if(t instanceof e.ChemSpace)this._initChemSpaceDefProps(t),$super(t);else{var i=this.createContainerChemSpace(null,t);this._containerChemSpace=i,$super(i)}if(this.getEditorConfigs().getInteractionConfigs().getAutoExpandClientSizeAfterLoading()&&this.autoExpandChemSpaceSize(),t instanceof e.ChemSpace&&this.getEditorConfigs().getInteractionConfigs().getScrollToObjAfterLoading()){var n=t.getChildren();n&&n.length&&this.scrollClientToObject(n)}}else $super(t);else $super(t)},getExportableClasses:function($super){var t=$super(),r=this.getChemSpace();if(r)for(var i=0,n=r.getChildCount();i<n;++i){var a=r.getChildAt(i);a&&a.getClass&&e.ArrayUtils.pushUnique(t,a.getClass())}return t},exportObjs:function($super,e){var t=$super(e);if((!t||!t.length)&&e){t=[];var r=this.getChemSpace();if(r)for(var i=0,n=r.getChildCount();i<n;++i){var a=r.getChildAt(i);a&&a instanceof e&&t.push(a)}}return t},getSavingTargetObj:function($super){var e=this.getChemSpace();return 1===e.getChildCount()?e.getChildAt(0):$super()},createDefaultConfigs:function(){return e.Editor.ChemSpaceEditorConfigs.getInstance()},doCreateNewDocObj:function(){return this.createContainerChemSpace()},doLoad:function($super,e){this._supplyChemMarkersOnObj(e),$super(e)},doLoadEnd:function($super,t){var r=$super(t),i=null;if(t){var n=t.getAllContainingConnectors();if(n&&n.length){var a=this.getRenderType()===e.Render.RendererType.R3D?e.CoordMode.COORD3D:e.CoordMode.COORD2D;i=e.ChemStructureUtils.getConnectorLengthMedian(n,a,this.getAllowCoordBorrow())}}return this.setDefBondLength(i),r},resetDisplay:function($super){$super(),this.resetClientDisplay()},resetClientDisplay:function(e){if(!this.isUpdatingObject())return this._resetClientDisplayCore(e);var t=this;this._registerAfterUpdateObjectProc(function(){t._resetClientDisplayCore(e)})},_resetClientDisplayCore:function(t){var r=this.getChemObj();if(r){var i;t&&(i=this.getClientScrollPosition());var n=r.getScreenSize(),a=this.getCurrZoom();this.changeClientSize(n.x,n.y,a);var o=this.getEditClientElem().parentNode,s=e.HtmlElementUtils.getElemClientDimension(o);t?this.scrollClientTo(i.y,i.x):this.scrollClientTo(0,(n.x*this.getCurrZoom()-s.width)/2)}},zoomChanged:function($super,e){$super();var t=this.getChemObj();if(t){var r=t.getScreenSize();this.changeClientSize(r.x,r.y,e)}},createNewBoundInfoRecorder:function($super,e){$super(e);var t=this.getBoundInfoRecorder();t&&t.addEventListener("updateBasicDrawObject",this.reactUpdateBasicDrawObject,this)},reactUpdateBasicDrawObject:function(t){var r=t.obj;if(r&&r instanceof e.TextBlock){var i=t.boundInfo;this.updateTextBlockSize(r,i)}},objectChanged:function($super,e,t){return $super(e,t)},doManipulationEnd:function($super){if(this.getEditorConfigs().getInteractionConfigs().getAutoExpandClientSizeAfterManipulation()){var e=this._calcChemSpaceAutoExpandInfo();if(e){var t=this._createChemSpaceAutoExpandOperations(e);if(t){this.getEnableOperHistory()&&this._appendOpersToLastManipulationOperation(t);for(var r=0,i=t.length;r<i;++r)t[r].execute()}}}return $super()},_appendOpersToLastManipulationOperation:function(t){var r=this.getOperationsInCurrManipulation();if(r&&r.length){var i=r[r.length-1],n=this.getOperHistory();if(n){var a=n.getOperations(),o=a.indexOf(i);if(o>=0){var s;i instanceof e.MacroOperation?s=i:(s=new e.MacroOperation([i]),a.splice(o,1,s),r.splice(r.length-1,1,s));for(var l=0,d=t.length;l<d;++l)s.add(t[l])}}}},updateTextBlockSize:function(t,r){if(this.getCoordMode()===e.CoordMode.COORD2D&&t.getNeedRecalcSize()){r.shapeType;e.Render.BoundShapeType.RECT}},createContainerChemSpace:function(t,r){var i=new e.ChemDocument(t);if(this._initChemSpaceDefProps(i,r),r){i.appendChild(r);var n,a,o=i.getSizeOfMode(this.getCoordMode(),this.getAllowCoordBorrow()),s=e.Render.ObjUtils.getContainerBox(r,this.getCoordMode(),this.getAllowCoordBorrow());if(this.getCoordMode()===e.CoordMode.COORD2D)var l=this.getEditorConfigs().getChemSpaceConfigs().getDefPadding(),a=i.getObjScreenLengthRatio();var d=r.getAbsBaseCoord?r.getAbsBaseCoord(this.getCoordMode(),this.getAllowCoordBorrow())||{}:{};if(a&&s){n=e.CoordUtils.divide(o,2);var u={x:(s.x1+s.x2)/2,y:(s.y1+s.y2)/2},c={x:n.x,y:o.y-l*a-(s.y2-s.y1)/2},h=e.CoordUtils.substract(c,u);n=e.CoordUtils.add(d,h)}else n=e.CoordUtils.divide(o,2);r.setAbsBaseCoord&&r.setAbsBaseCoord(n,this.getCoordMode())}return i},_initChemSpaceDefProps:function(t,r,i){var n=this.getEditorConfigs(),a=n.getChemSpaceConfigs();if(this.getCoordMode()===e.CoordMode.COORD2D){var o=this._screenSize;if(o.x||o.y||(o=a.getDefScreenSize2D()),t.setScreenSize(o),!t.getDefAutoScaleRefLength()){var s;if(r&&r.getAllAutoScaleRefLengths){var l=r.getAllAutoScaleRefLengths(this.getCoordMode(),this.getAllowCoordBorrow());s=l&&l.length?e.ArrayUtils.getMedian(l):null}else{var l=t.getAllAutoScaleRefLengths(this.getCoordMode(),this.getAllowCoordBorrow());s=l.length?e.ArrayUtils.getMedian(l):null}s||(s=n.getStructureConfigs().getDefBondLength()),t.setDefAutoScaleRefLength(s)}if(!t.getSize2D()||i){var d=this.getRenderConfigs().getLengthConfigs().getDefBondLength(),u=t.getDefAutoScaleRefLength()/d;t.setObjScreenLengthRatio(u),t.setSize2D({x:o.x*u,y:o.y*u})}}t.setIsEditing&&t.setIsEditing(!0)},_getChemSpaceObjScreenLengthRatio:function(){var e=this.getChemSpace(),t=e.getObjScreenLengthRatio();if(!t){var r=this.getRenderConfigs().getLengthConfigs().getDefBondLength();t=e.getDefAutoScaleRefLength()/r}return t},changeChemSpaceSize:function(t,r){var i=this.getChemSpace();i.beginUpdate();try{if(i.setSizeOfMode(t,r),r===e.CoordMode.COORD2D){var n=this._getChemSpaceObjScreenLengthRatio();n&&i.setScreenSize({x:t.x/n,y:t.y/n})}}finally{i.endUpdate()}this.resetClientDisplay(!0)},changeChemSpaceScreenSize:function(e){var t=this.getChemSpace();t.beginUpdate();try{var r=this._getChemSpaceObjScreenLengthRatio();r&&t.setSize2D({x:e.x*r,y:e.y*r}),t.setScreenSize(e)}finally{t.endUpdate()}this.resetClientDisplay(!0)},_shiftChemSpaceChildCoord:function(t,i,n){var a=this.getChemSpace(),o=a.getChildren();if(o){var s;n&&(s=this.getClientScrollCoord(e.Editor.CoordSys.CHEM)),this.beginUpdateObject();try{a.beginUpdate();try{for(var l=this.getAllowCoordBorrow(),d=0,u=o.length;d<u;++d){var c=o[d];c&&c.setCoordOfMode&&c.setCoordOfMode(r.add(c.getCoordOfMode(i,l),t))}n&&this.scrollClientToCoord(s,e.Editor.CoordSys.CHEM)}finally{a.endUpdate()}}finally{this.endUpdateObject()}}},_calcExpandChemSpaceSizeToTargetObjsInfo:function(e,t){if(e&&e.length){var r=this._getTargetObjsExposedContainerBoxInfo(e),i=r.totalBox;if(i)return this._calcExpandChemSpaceSizeToContainerBoxInfo(i,t)}return null},_calcExpandChemSpaceSizeToContainerBoxInfo:function(t,i){var n=e.CoordMode,a=this.getChemSpace(),o=i===n.COORD3D,s=["x","y"];o&&s.push("z");for(var l=this.getEditorConfigs().getChemSpaceConfigs(),d=this._getChemSpaceObjScreenLengthRatio(),u=l.getDefPadding(),c=u*d,h=o?a.getSize3D():a.getSize2D(),m=e.BoxUtils.getMinMaxCoords(t),g=m.min,f={},p=!1,C=0,b=s.length;C<b;++C){var E=g[s[C]];E<c?(f[s[C]]=c-E,p=!0):f[s[C]]=0}for(var N=m.max,T={},O=!1,C=0,b=s.length;C<b;++C){var E=N[s[C]];E>h[s[C]]-c?(T[s[C]]=E-(h[s[C]]-c),O=!0):T[s[C]]=0}var _={},S={};if(p||O){for(var v=o?l.getAutoExpandScreenSize2D():l.getAutoExpandScreenSize3D(),y=r.multiply(v,d),C=0,b=s.length;C<b;++C){var A=s[C];_[A]=f[A]+T[A];var M=Math.ceil(_[A]/y[A]);S[A]=M*y[A]}var I=r.add(h,S),R={newSize:I};return p&&(R.coordShift=f),R}return null},_expandChemSpaceSizeAndShiftChildrenCoords:function(e,t,r){this.beginUpdateObject();try{t&&this._shiftChemSpaceChildCoord(t,r,!0),this.changeChemSpaceSize(e,r)}finally{this.endUpdateObject()}},_expandChemSpaceSizeToContainerBox:function(e,t){var r=this._calcExpandChemSpaceSizeToContainerBoxInfo(e,t);return r&&this._expandChemSpaceSizeAndShiftChildrenCoords(r.newSize,r.coordShift,t),r},expandChemSpaceSizeToTargetObjs:function(t,r){if(e.ObjUtils.isUnset(r)&&(r=this.getCoordMode()),t&&t.length){var i=this._getTargetObjsExposedContainerBoxInfo(t),n=i.totalBox;n&&this._expandChemSpaceSizeToContainerBox(n,r)}return this},autoExpandChemSpaceSize:function(){if(this._isAutoExpandingChemSpace)return this;this._isAutoExpandingChemSpace=!0;try{var e=this.getChemSpace(),t=e.getChildren();t&&this.expandChemSpaceSizeToTargetObjs(t,this.getCoordMode())}finally{this._isAutoExpandingChemSpace=!1}return this},_calcChemSpaceAutoExpandInfo:function(){var e=this.getChemSpace(),t=e.getChildren();return t?this._calcExpandChemSpaceSizeToTargetObjsInfo(t,this.getCoordMode):null},_createChemSpaceAutoExpandOperations:function(t){if(t){var r=[],i=this.getChemSpace(),n=this.getCoordMode();return r.push(new e.ChemSpaceEditorOperation.ChangeSpaceSizeAndShiftChildrenCoords(i,t.newSize,t.coordShift,n,this)),r}return null},createNewStructFragmentAnchor:function(t){if(this.getAutoCreateNewStructFragment()){var r=new e.Molecule(t);return this.getChemSpace().appendChild(r),r}return null},createStructStartingAtom:function(t,r,i,n){this.beginUpdateObject();try{if(t){n||(n=this.getEditorConfigs().getStructureConfigs().getDefIsotopeId());var a=new e.Atom(null,n);return t.appendNode(a),a.setAbsCoordOfMode(i,this.getCoordMode()),a}return null}finally{this.endUpdateObject()}},createNewStructFragmentAndStartingAtom:function(e,t,r){this.beginUpdateObject();try{var i;return i=this.createNewStructFragmentAnchor(e),i?this.createStructStartingAtom(i,e,t,r):null}finally{this.endUpdateObject()}},hasOnlyOneBlankStructFragment:function(){var t=!1;if(1===this.getChemSpace().getChildCount()){var r=this.getChemSpace().getChildAt(0);r instanceof e.StructureFragment&&r.getNodeCount()<=0&&r.getConnectorCount()<=0&&!r.hasFormula()&&(t=!0)}return t},getOnlyOneBlankStructFragment:function(){if(this.hasOnlyOneBlankStructFragment())return this.getChemSpace().getChildAt(0)},canAddNewStandaloneObject:function(){return this.getAllowCreateNewChild()||this.getChemSpace().getChildCount()<=0},canAddUnconnectedStructFragment:function(){return this.canAddNewStandaloneObject()||this.hasOnlyOneBlankStructFragment()},canCloneObjects:function(){return this.getAllowCreateNewChild()},cloneObjects:function(r,i,n,a){var o=this;if(!this.getChemSpace())return null;for(var s=this.getAllowCreateNewChild(),l=function(e,t){for(var r=0,i=t.length;r<i;++r){if(t[r].isChildOf(e))return!0}return!1},d=function(e,t){for(var r=0,i=t.length;r<i;++r){var n=t[r];if(e===n||e.isChildOf&&e.isChildOf(n))return n}return null},u=e.ArrayUtils.toArray(r),c=[],h=new e.MapEx,m=0,g=u.length;m<g;++m){var f=u[m],p=f.getStandaloneAncestor?f.getStandaloneAncestor():f;if(p.clone){e.ArrayUtils.pushUnique(c,p);var C=h.get(p);C||(C=[],h.set(p,C)),C.push(f)}}for(var b=this.getChemSpace(),E=function(e,r){var i=[];r||(r=o.getChemObj());var n=r.getObjRefRelations&&r.getObjRefRelations();if(n)for(var a=0,s=n.length;a<s;++a){var l=n[a],u=l.srcObj,c=t.toArray(l.dest),h=d(u,e),m=[],g=!1;if(h){for(var f=0,p=c.length;f<p;++f){var C=c[f],b=d(C,e);b&&(g=!0),m.push(b)}g&&i.push({relation:l,srcParent:h,destParents:m})}}return i}(c,b),N=this.getChemSpace(),T=[],O=(this.getCoordMode(),this.getAllowCoordBorrow(),c.length),m=0;m<O;++m){var f=c[m],_=f.clone();_.clearIds&&_.clearIds(),T.push(_)}for(var S=[],m=0,g=E.length;m<g;++m){var v=E[m],y=function(e,r,i){var n,a,o=e.relation,s=e.srcParent,l=e.destParents,d=[],u=r.indexOf(s),c=i[u];if(o.srcObj===s?a=c:(n=s.indexStackOfChild&&s.indexStackOfChild(o.srcObj))&&(a=c.getChildAtIndexStack&&c.getChildAtIndexStack(n)),!a)return null;for(var h=t.isArray(o.dest),m=h?o.dest:[o.dest],g=0,f=l.length;g<f;++g){var p,C=l[g],b=r.indexOf(C),E=i[b];C&&(C===m[g]?d.push(E):m[g]&&(n=C.indexStackOfChild&&C.indexStackOfChild(m[g]))&&(p=E.getChildAtIndexStack&&E.getChildAtIndexStack(n))&&d.push(p))}if(!d.length)return null;var N=h?d:d[0];return{srcObj:a,srcProp:o.srcProp,dest:N}}(v,c,T);y&&S.push(y)}for(var m=0;m<O;++m){var f=c[m],_=T[m];if(function e(r,i,n){if(n.indexOf(i)>=0)return void t.remove(n,i);if(r.getChildAt&&i.getChildAt)for(var a=i.getChildCount(),o=a-1;o>=0;--o){var s=r.getChildAt(o);if(n.length){var d=i.getChildAt(o);n.indexOf(d)>=0?t.remove(n,d):l(d,n)?d.getChildObjs&&e(s,d,n):r.removeChild(s)}else r.removeChild(s)}}(_,f,h.get(f)),n&&s&&(N.appendChild(_),i)){var A=this.getObjectScreenCoord(_),M=e.CoordUtils.add(A,i);this.setObjectScreenCoord(_,M)}}for(var m=0,g=S.length;m<g;++m){var I,y=S[m];if(d(y.srcObj,T)){if(t.isArray(y.dest)){I=[];for(var R=0,L=y.dest.length;R<L;++R){var x=y.dest[R];d(x,T)&&I.push(x)}I.length||(I=null)}else d(y.dest,T)&&(I=y.dest);I&&y.srcObj.setPropValue(y.srcProp.name,I)}}return h.finalize(),T},cloneSelection:function(r,i,n){void 0===r&&(r=this.getDefaultCloneScreenCoordOffset());var a=this.getSelection();a=function(r,i){for(var n=[],a=0,o=r.length;a<o;++a){var s=r[a];if(s instanceof e.ChemSpace&&!i){var l=s.getChildren();t.pushUnique(n,l)}else t.pushUnique(n,s)}return n}(a,n);var o=this.cloneObjects(a,r,i);return i&&this.setSelection(o),o},getDefaultCloneScreenCoordOffset:function(){var t=this.getEditorConfigs().getInteractionConfigs().getClonedObjectScreenOffset()||0,r=this.getCoordMode(),i={x:t,y:t};return r===e.CoordMode.COORD3D&&(i.z=t),i},_supplyChemMarkersOnObj:function(t){if(t){var r=e.ChemStructureUtils.getAllStructFragments(t,!0);if(r||r.length)for(var i=0,n=r.length;i<n;++i)this._createLosingChemMarkerOnStructFragment(r[i])}},_createLosingChemMarkerOnStructFragment:function(e){e.beginUpdate();try{e.getCharge&&e.getCharge()&&e.fetchChargeMarker(!0);for(var t=(e.getNodes(),0),r=e.getNodeCount();t<r;++t){var i=e.getNodeAt(t);i.beginUpdate();try{i.getCharge()&&i.fetchChargeMarker(!0),i.getRadical()&&i.fetchRadicalMarker(!0),i.getNodeAt&&this._createLosingChemMarkerOnStructFragment(i)}finally{i.endUpdate()}}}finally{e.endUpdate()}},getEnabledNonAtomInputData:function(){var t=[],r=this.getRenderConfigs().getDisplayLabelConfigs(),i=this.getEditorConfigs().getStructureConfigs().getEnabledNonAtomNodeTypes();return i.RGroup&&t.push({text:r.getRgroup(),nodeClass:e.RGroup,description:e.$L("ChemWidgetTexts.CAPTION_RGROUP")}),i.pseudoatomDummy&&t.push({text:r.getDummyAtom(),nodeClass:e.Pseudoatom,props:{atomType:e.PseudoatomType.DUMMY},description:e.$L("ChemWidgetTexts.CAPTION_DUMMY_ATOM")}),i.pseudoatomHetero&&t.push({text:r.getHeteroAtom(),nodeClass:e.Pseudoatom,props:{atomType:e.PseudoatomType.HETERO},description:e.$L("ChemWidgetTexts.CAPTION_HETERO_ATOM")}),i.pseudoatomAny&&t.push({text:r.getAnyAtom(),nodeClass:e.Pseudoatom,props:{atomType:e.PseudoatomType.ANY},description:e.$L("ChemWidgetTexts.CAPTION_ANY_ATOM")}),i.variableAtomList&&t.push({text:this._getVarAtomListLabel(),nodeClass:e.VariableAtom,isVarList:!0,description:e.$L("ChemWidgetTexts.CAPTION_VARIABLE_ATOM")}),i.variableAtomNotList&&t.push({text:this._getVarAtomNotListLabel(),nodeClass:e.VariableAtom,isNotVarList:!0,description:e.$L("ChemWidgetTexts.CAPTION_VARIABLE_NOT_ATOM")}),t},_getVarAtomListLabel:function(){var t=this.getRenderConfigs().getDisplayLabelConfigs();return t?t.getVariableAtom():e.ChemStructureNodeLabels.VARIABLE_ATOM},_getVarAtomNotListLabel:function(){var t=this.getRenderConfigs().getDisplayLabelConfigs();return"~"+(t?t.getVariableAtom():e.ChemStructureNodeLabels.VARIABLE_ATOM)},getEnabledBondFormData:function(){for(var t=e.BondType,r=e.BondOrder,i=e.BondStereo,n=e.$L,o="K-Chem-MolBondIaController-",s={single:{text:n("ChemWidgetTexts.CAPTION_MOL_BOND_SINGLE"),hint:n("ChemWidgetTexts.HINT_MOL_BOND_SINGLE"),htmlClass:o+"Single",isDefault:!0,bondProps:{bondType:t.COVALENT,bondOrder:r.SINGLE,stereo:i.NONE}},double:{text:n("ChemWidgetTexts.CAPTION_MOL_BOND_DOUBLE"),hint:n("ChemWidgetTexts.HINT_MOL_BOND_DOUBLE"),htmlClass:o+"Double",bondProps:{bondType:t.COVALENT,bondOrder:r.DOUBLE,stereo:i.NONE}},triple:{text:n("ChemWidgetTexts.CAPTION_MOL_BOND_TRIPLE"),hint:n("ChemWidgetTexts.HINT_MOL_BOND_TRIPLE"),htmlClass:o+"Triple",bondProps:{bondType:t.COVALENT,bondOrder:r.TRIPLE,stereo:i.NONE}},quad:{text:n("ChemWidgetTexts.CAPTION_MOL_BOND_QUAD"),hint:n("ChemWidgetTexts.HINT_MOL_BOND_QUAD"),htmlClass:o+"Quad",bondProps:{bondType:t.COVALENT,bondOrder:r.QUAD,stereo:i.NONE}},explicitAromatic:{text:n("ChemWidgetTexts.CAPTION_MOL_BOND_EXPLICIT_AROMATIC"),hint:n("ChemWidgetTexts.HINT_MOL_BOND_EXPLICIT_AROMATIC"),htmlClass:o+"Aromatic",bondProps:{bondType:t.COVALENT,bondOrder:r.EXPLICIT_AROMATIC,stereo:i.NONE}},up:{text:n("ChemWidgetTexts.CAPTION_MOL_BOND_WEDGEUP"),hint:n("ChemWidgetTexts.HINT_MOL_BOND_WEDGEUP"),htmlClass:o+"WedgeUp",bondProps:{bondType:t.COVALENT,bondOrder:r.SINGLE,stereo:i.UP}},upInverted:{text:n("ChemWidgetTexts.CAPTION_MOL_BOND_WEDGEUP_INVERTED"),hint:n("ChemWidgetTexts.HINT_MOL_BOND_WEDGEUP_INVERTED"),htmlClass:o+"WedgeUpInverted",bondProps:{bondType:t.COVALENT,bondOrder:r.SINGLE,stereo:i.UP_INVERTED}},down:{text:n("ChemWidgetTexts.CAPTION_MOL_BOND_WEDGEDOWN"),hint:n("ChemWidgetTexts.HINT_MOL_BOND_WEDGEDOWN"),htmlClass:o+"WedgeDown",bondProps:{bondType:t.COVALENT,bondOrder:r.SINGLE,stereo:i.DOWN}},downInverted:{text:n("ChemWidgetTexts.CAPTION_MOL_BOND_WEDGEDOWN_INVERTED"),hint:n("ChemWidgetTexts.HINT_MOL_BOND_WEDGEDOWN_INVERTED"),htmlClass:o+"WedgeDownInverted",bondProps:{bondType:t.COVALENT,bondOrder:r.SINGLE,stereo:i.DOWN_INVERTED}},upOrDown:{text:n("ChemWidgetTexts.CAPTION_MOL_BOND_WAVY"),hint:n("ChemWidgetTexts.HINT_MOL_BOND_WAVY"),htmlClass:o+"WedgeUpOrDown",bondProps:{bondType:t.COVALENT,bondOrder:r.SINGLE,stereo:i.UP_OR_DOWN}},closer:{text:n("ChemWidgetTexts.CAPTION_MOL_BOND_CLOSER"),hint:n("ChemWidgetTexts.HINT_MOL_BOND_CLOSER"),htmlClass:o+"Closer",bondProps:{bondType:t.COVALENT,bondOrder:r.SINGLE,stereo:i.CLOSER}},eOrZ:{text:n("ChemWidgetTexts.CAPTION_MOL_BOND_DOUBLE_EITHER"),hint:n("ChemWidgetTexts.HINT_MOL_BOND_DOUBLE_EITHER"),htmlClass:o+"Double-Either",bondProps:{bondType:t.COVALENT,bondOrder:r.DOUBLE,stereo:i.E_OR_Z}},ionic:{text:n("ChemWidgetTexts.CAPTION_MOL_BOND_IONIC"),hint:n("ChemWidgetTexts.HINT_MOL_BOND_IONIC"),htmlClass:o+"Ionic",bondProps:{bondType:t.IONIC}},coordinate:{text:n("ChemWidgetTexts.CAPTION_MOL_BOND_COORDINATE"),hint:n("ChemWidgetTexts.HINT_MOL_BOND_COORDINATE"),htmlClass:o+"Coordinate",bondProps:{bondType:t.COORDINATE}},metallic:{text:n("ChemWidgetTexts.CAPTION_MOL_BOND_METALLIC"),hint:n("ChemWidgetTexts.HINT_MOL_BOND_METALLIC"),htmlClass:o+"Metallic",bondProps:{bondType:t.METALLIC}},hydrogen:{text:n("ChemWidgetTexts.CAPTION_MOL_BOND_HYDROGEN"),hint:n("ChemWidgetTexts.HINT_MOL_BOND_HYDROGEN"),htmlClass:o+"Hydrogen",bondProps:{bondType:t.HYDROGEN}}},l=(n("ChemWidgetTexts.CAPTION_MOL_BOND_DOUBLE"),n("ChemWidgetTexts.HINT_MOL_BOND_DOUBLE"),this.getEditorConfigs().getStructureConfigs().getEnabledBondForms()),d=e.ObjUtils.getOwnedFieldNames(l,!1),u=[],c=0,h=d.length;c<h;++c){var m=d[c];l[m]&&(a.isObjectValue(l[m])?u.push(l[m]):s[m]&&u.push(s[m]))}return u}}),e.Editor.ChemSpaceEditor.Settings=i.create(e.Editor.BaseEditor.Settings,{CLASS_NAME:"Kekule.Editor.ChemSpaceEditor.Settings",initProperties:function(){this.defineProp("allowCreateNewChild",{dataType:a.BOOL,serializable:!1,getter:function(){return this.getEditor().getAllowCreateNewChild()},setter:function(e){this.getEditor().setAllowCreateNewChild(e)}})}}),e.Editor.BasicMolEraserIaController=i.create(e.Editor.BasicEraserIaController,{CLASS_NAME:"Kekule.Editor.BasicMolEraserIaController",initialize:function($super,e){$super(e)},doGetActualRemovedObjs:function(t){for(var r=[],i=this.getEditor().getChemObj(),n=0,a=t.length;n<a;++n){var o,s=t[n];s instanceof e.ChemSpace&&s===i?o=s.getChildren():(e.ArrayUtils.pushUnique(r,s),o=s.getCascadeDeleteObjs?s.getCascadeDeleteObjs():[]),o&&e.ArrayUtils.pushUnique(r,o)}return r},doRemoveObjs:function(t){if(t.length){for(var r=new e.MacroOperation,i=[],n=0,a=t.length;n<a;++n){var o=t[n];o.invokeEvent("objectRemoved",o);var s,l=(o.getParent(),this.getEditor());o instanceof e.BaseStructureNode?(s=new e.ChemStructOperation.RemoveNode(o,null,null,l),e.ArrayUtils.pushUnique(i,o.getParent())):o instanceof e.BaseStructureConnector?(s=new e.ChemStructOperation.RemoveConnector(o,null,null,l),e.ArrayUtils.pushUnique(i,o.getParent())):s=new e.ChemObjOperation.Remove(o,null,null,l),s&&r.add(s)}for(var n=0,a=i.length;n<a;++n){var d=i[n];if(d&&d instanceof e.StructureFragment){var u=new e.ChemStructOperation.StandardizeStructFragment(d,l);u.setEnableSplit(this.getEditor().canCreateNewChild()),r.add(u)}}l.execOperation(r)}}}),e.Editor.IaControllerManager.register(e.Editor.BasicMolEraserIaController,e.Editor.ChemSpaceEditor),e.Editor.BasicMolManipulationIaController=i.create(e.Editor.BasicManipulationIaController,{CLASS_NAME:"Kekule.Editor.BasicMolManipulationIaController",initialize:function($super,e){$super(e),this.setEnableMagneticMerge(!0),this.setEnableNodeMerge(!0),this.setEnableNeighborNodeMerge(!0),this.setEnableConnectorMerge(!0),this.setEnableStructFragmentMerge(!0),this.setEnableNodeStick(!0),this.setEnableStructFragmentStick(!0),this.setEnableConstrainedMove(!0),this.setEnableConstrainedRotate(!0),this.setEnableConstrainedResize(!0),this.setEnableDirectedMove(!0),this._suppressConstrainedMoving=!1,this._suppressConstrainedRotating=!1,this._isInDirectedMoving=!1,this._directedMovingDirection=null},initProperties:function(){this.defineProp("enableMagneticMerge",{dataType:a.BOOL}),this.defineProp("enableNodeMerge",{dataType:a.BOOL}),this.defineProp("enableNeighborNodeMerge",{dataType:a.BOOL}),this.defineProp("enableConnectorMerge",{dataType:a.BOOL}),this.defineProp("enableStructFragmentMerge",{dataType:a.BOOL}),this.defineProp("allManipulateObjsMerged",{dataType:a.BOOL,serializable:!1}),this.defineProp("isMergeDone",{dataType:a.BOOL,serializable:!1}),this.defineProp("enableNodeStick",{dataType:a.BOOL}),this.defineProp("enableSiblingStick",{dataType:a.BOOL}),this.defineProp("enableStructFragmentStick",{dataType:a.BOOL}),this.defineProp("enableConstrainedMove",{dataType:a.BOOL,serializable:!1}),this.defineProp("enableConstrainedRotate",{dataType:a.BOOL,serializable:!1}),this.defineProp("enableConstrainedResize",{dataType:a.BOOL,serializable:!1}),this.defineProp("enableDirectedMove",{dataType:a.BOOL,serializable:!1}),this.defineProp("stickOperations",{dataType:a.ARRAY,serializable:!1}),this.defineProp("mergeOperations",{dataType:a.ARRAY,serializable:!1}),this.defineProp("mergePreviewOperations",{dataType:a.ARRAY,serializable:!1}),this.defineProp("anchorPreviewOperations",{dataType:a.ARRAY,serializable:!1}),this.defineProp("mergingDests",{dataType:a.ARRAY,serializable:!1}),this.defineProp("anchorDests",{dataType:a.ARRAY,serializable:!1})},canInteractWithObj:function($super,e){return $super(e)||this._isMerging&&e},doSetManipulateObjs:function($super,e){var r=e?t.clone(e):[];this.getMergingDests()&&!this.useMergePreview()&&t.pushUnique(r,this.getMergingDests()),this.setPropStoreFieldValue("manipulateObjs",e),e?this.getEditor().prepareOperatingObjs(r):this.getEditor().endOperatingObjs()},isConstrainedRotate:function(){return this.getEnableConstrainedMove()},isConstrainedResize:function(){return this.getEnableConstrainedResize()},isConstrainedMove:function(){if(!this.getEnableConstrainedMove())return!1;var e=this.getManipulateObjs();if(1===e.length){var t=e[0],r=this.getEditor().getSelection();if(r&&r.indexOf(t)<0)return t.getConstraintManipulationBaseObj&&t.getConstraintManipulationBaseObj()}return!1},isInActualConstrainedRotation:function(){return this.isConstrainedRotate()&&!this._suppressConstrainedRotating},isDirectedMove:function(){return this.getEnableDirectedMove()&&!this.isConstrainedMove()&&this._isInDirectedMoving},useMergePreview:function(){return this._useMergePreview},setUseMergePreview:function(e){this._useMergePreview=e},getMergeOperationsInManipulating:function(){return this._useMergePreview?this.getMergePreviewOperations():this.getMergeOperations()},getAnchorOperationsInManipulating:function(){return this.getAnchorPreviewOperations()},createManipulateObjInfo:function($super,t,r,i){var n=this.getEditor(),a=$super(t,r,i);if(this.isConstrainedMove()){var o=t.getConstraintManipulationBaseObj();if(o&&(a.isConstrained=!0,!a.hasNoCoord)){a.originScreenCoord=n.getObjectScreenCoord(t),a.refScreenCoord=n.getObjectScreenCoord(o),a.connectorScreenLength=e.CoordUtils.getDistance(a.screenCoord,a.refScreenCoord),a.connectorObjLength=e.CoordUtils.getDistance(n.getObjCoord(t),n.getObjCoord(o));var s=e.CoordUtils.substract(a.originScreenCoord,a.refScreenCoord);a.originBondDirectionAngle=Math.atan2(s.y,s.x),a.constrainedBondDirectionDelta=this.getEditorConfigs().getStructureConfigs().getBondConstrainedDirectionDelta(),a.constrainedBondDirectionAngles=this.getEditorConfigs().getStructureConfigs().getBondConstrainedDirectionAngles(),a.constrainedBondDirectionAngleThreshold=this.getEditorConfigs().getStructureConfigs().getBondConstrainedDirectionAngleThreshold()}}return a},getAllowLengthChangeInConstrainedMoving:function(t){return t instanceof e.Glyph.PathGlyphNode},_calcActualMovedScreenCoord:function($super,t,r,i){var n,a=e.CoordUtils,o=i;if(r.isConstrained&&!this._suppressConstrainedMoving){var s,l=r.constrainedBondDirectionDelta||null,d=r.constrainedBondDirectionAngles||null,u=r.constrainedBondDirectionAngleThreshold||null,c=!1,h=a.substract(i,r.refScreenCoord),m=Math.atan2(h.y,h.x),g=a.getDistance(h);if(d&&u)for(var f=0,p=d.length;f<p;++f){var C=d[f];Math.abs(C-m)<=u&&(c=!0,s=C)}if(!c&&l){var b=Math.round((m-r.originBondDirectionAngle)/l);s=r.originBondDirectionAngle+b*l,c=!0}c||(s=m);var E;if(this.getAllowLengthChangeInConstrainedMoving(t)){var N=this.getEditor().getDefBondScreenLength(),T=g/N,O=this.getEditorConfigs().getInteractionConfigs().getConstrainedResizeStep();T=(Math.round(T/O)||1)*O,E=N*T}else E=r.connectorScreenLength;n=a.add(r.refScreenCoord,{x:E*Math.cos(s),y:E*Math.sin(s)})}else n=o;return n},_calcActualRotateAngle:function($super,e,t,r,i){var n=this.isConstrainedRotate()&&!this._suppressConstrainedRotating,a=n?this.getEditorConfigs().getInteractionConfigs().getConstrainedRotateStep():null;if(a){return Math.round(t/a)*a}return $super(e,t)},_calcActualResizeScales:function(e,t){if(this.isConstrainedResize()&&!this._suppressConstrainedResize){var r=this.getEditorConfigs().getInteractionConfigs().getConstrainedResizeStep();return r?{scaleX:(Math.round(t.scaleX/r)||1)*r,scaleY:(Math.round(t.scaleY/r)||1)*r}:t}return t},prepareManipulating:function($super,e,t,r,i,n,a){this.setUseMergePreview(this.getEditorConfigs().getInteractionConfigs().getEnableMergePreview()),this.setMergeOperations([]),this.setMergePreviewOperations([]),this.setAnchorPreviewOperations([]),this.setStickOperations([]),$super(e,t,r,i,n,a),this._directedMovingDirection=null,this.setManuallyHotTrack(!0)},manipulateBeforeStopping:function($super){if($super(),this.useMergePreview()){var t=this.getMergePreviewOperations();if(t&&t.length){for(var r=this.getMergeOperations(),i=0,n=t.length;i<n;++i){var a=t[i];if(a){var o=a instanceof e.ChemStructOperation.MergeConnectorsBase,s=o?this.createConnectorMergeOperation(a.getTarget(),a.getDest()):this.createNodeMergeOperation(a.getTarget(),a.getDest());r.push(s)}}this.executeMergeOpers(r)}}},manipulateEnd:function($super){$super(),this.getEditor().hideHotTrack(),this.setManuallyHotTrack(!1)},createManipulateOperation:function($super){$super(),this.setMergeOperations([]),this.setMergePreviewOperations([]),this.setAnchorPreviewOperations([]),this.setStickOperations([])},getAllObjOperations:function($super,t){var r=this.getMergeOperations(),i=$super()||[];r&&r.length&&e.ArrayUtils.pushUnique(i,r);var n=this.getStickOperations();if(n&&n.length)for(var a=0,o=n.length;a<o;++a){var s=n[a];s&&(s.getStickTarget&&!s.getStickTarget()?i.unshift(s):i.push(s))}return i},_canMergeArrowNodes:function(t,r){var i=t.getParent(),n=t instanceof e.Glyph.PathGlyphNode&&i instanceof e.Glyph.Arc,a=r instanceof e.ChemStructureNode||r instanceof e.ChemMarker.UnbondedElectronSet||r instanceof e.ChemStructureConnector,o=!1;i.getNodes().forEach(function(e){e.getId()!==t.getId()&&e.anchorObj===r.getId()&&(o=!0)});var s=r instanceof e.ChemMarker.UnbondedElectronSet&&i.getNodes()[1].getId()===t.getId();return n&&a&&!o&&!s},_objCanBeMagneticMerged:function(t){return!(t instanceof e.StructureFragment)&&(t instanceof e.ChemStructureNode||t instanceof e.ChemStructureConnector)},_objCanBeMagneticSticked:function(t){return!(t instanceof e.StructureFragment)&&(t instanceof e.BaseStructureNode&&t.getAllowCoordStickTo())},_canStickNode:function(t,r){if(this.getEnableNodeStick()){var i=this.getEnableStructFragmentStick(),n=this.getEnableSiblingStick();return e.ChemObjOperation.StickTo.canStick(t,r,i,n)}return!1},_canMergeNodes:function(t,r){if(this.getEnableNodeMerge()){var i=this.getEnableStructFragmentMerge(),n=this.getEnableNeighborNodeMerge();return e.ChemStructOperation.MergeNodes.canMerge(t,r,i,n)}return!1},_canMergeConnectors:function(t,r){if(this.getEnableConnectorMerge()){var i=this.getEnableStructFragmentMerge();return e.ChemStructOperation.MergeConnectors.canMerge(t,r,i)}return!1},_findSuitableMergeTargetBoundInfo:function(e,t,r,i){Array.isArray(r)||(r=[r]);for(var n=e.length-1;n>=0;--n){var a=e[n],o=a.obj;if(!(t.indexOf(o)>=0)){for(var s=!1,l=r.length-1;l>=0;--l)if(o instanceof r[l]){s=!0;break}if(s&&(!i||i(o)))return a}}return null},_getCoordStickActualTarget:function(e){for(var t=e,r=t.getCoordStickTarget&&t.getCoordStickTarget();r;)t=r,r=t.getCoordStickTarget&&t.getCoordStickTarget();return t},_getMagneticNodeMergeOrStickDestInfo:function(t,r,i){var n=this.getEditor(),a=this,o=function(r){var n=r.obj,o=a._getCoordStickActualTarget(n);return t!==n&&i.indexOf(n)<0&&(n instanceof e.BaseStructureNode&&a._canMergeNodes(t,n)||a._canStickNode(t,o))};if(r){var s=n.getBoundInfosAtCoord(r,o,this.getCurrBoundInflation()),l=s.length?s[s.length-1]:null;if(l){var d=l.obj,u=this._getCoordStickActualTarget(d);return this._canMergeNodes(t,d)?{obj:d,isMerge:!0}:this._canStickNode(t,u)?{obj:u,isStick:!0}:null}return null}return null},moveManipulatedObjs:function($super,t){var r;if(this.isDirectedMove()){var i=e.CoordUtils,n=this.getStartCoord(),a=i.getDistance(n,t),o=i.substract(t,n),s=this._directedMovingDirection;this._directedMovingDirection||(s=Math.abs(o.x)>=Math.abs(o.y)?"x":"y",a<this.getEditor().getEditorConfigs().getInteractionConfigs().getDirectedMoveDistanceThreshold()||(this._directedMovingDirection=s)),r=Object.extend({},n),r[s]=t[s]}else r=t;return $super(r)},applyManipulatingObjsInfo:function($super,t){var r={MERGE:0,MERGE_BOND:1,STICK:10,UNSTICK:20};this.setAllManipulateObjsMerged(!1);var i=this.useMergePreview(),n=this.getEditor();n.hotTrackOnObj(null);var a=e.Editor.BasicManipulationIaController.ManipulationType,o=this.getManipulationType(),s=this.getManipulateOriginObjs(),l=this.getManipulateObjs(),d=[],u=[],c=[].concat(s);e.ArrayUtils.pushUnique(c,l);var h=this.getMergeOperationsInManipulating(),m=this.getAnchorOperationsInManipulating(),g=this.getStickOperations(),f=this,p=1===s.length&&s[0]instanceof e.ChemStructureConnector,C=1===l.length&&(l[0]instanceof e.BaseStructureNode||l[0]instanceof e.ChemMarker.UnbondedElectronSet)&&(this._objCanBeMagneticMerged(l[0])||this._objCanBeMagneticSticked(l[0])),b=1===l.length&&l[0]instanceof e.Glyph.PathGlyphNode&&this._objCanBeMagneticMerged(l[0]),E=1===s.length&&s[0]instanceof e.Glyph.Arc,N=o===a.MOVE&&(p&&this.getEnableConnectorMerge()||C&&this.getEnableNodeMerge()),T=!p&&!b&&!E&&this.getEnableMagneticMerge();if(T||N){var O=this.getManipulateObjCurrInfoMap(),_=this.getManipulateObjInfoMap(),S=[],v=[],y=[],A=[];if(N){var M=p?s[0]:l[0],I=this._calcMagneticMergeOrStickInfoOnScreenCoord(t,M,this._isManipulatingSingleStickedObj(l),O,_,c,r);if(I)S=[0],v=[I.magneticObj],y=[I.magneticDest],A=[I.magneticType];else if(p&&this.getEnableConnectorMerge()){var R=n.getBoundInfosAtCoord(t,null,this.getCurrBoundInflation()),L=e.ChemStructureConnector,M=s[0],x=function(e){return f._canMergeConnectors(M,e)},D=this._findSuitableMergeTargetBoundInfo(R,c,L,x);D&&(S=[0],v=[M],y=[D.obj],A=[r.MERGE_BOND])}}if(!v.length&&T){var P=this._calcMagneticMergeOrStickInfos(l,O,_,c,r);S=P.magneticObjIndexes,v=P.magneticObjs,y=P.magneticDests,A=P.magneticTypes}if(v.length||g.length){var B=v.length;this.setAllManipulateObjsMerged(B===l.length);for(var w=1===B,k=!1,U=!1,j=[],F=[],W=0,V=v.length;W<V;++W){var H=v[W],G=y[W],K=S[W];if(A[W]===r.STICK){if(!U){var z=g[K];if(!z||!this.isSameNodeStick(z,H,G)){U=!0;break}F.push(z)}}else if(!k){var Y=h[K];Y&&this.isSameNodeMerge(Y,H,G)?j.push(Y):k=!0}if(k&&U)break}for(var W=0,V=h.length;W<V;++W){var Y=h[W];if(Y){var K=j.indexOf(Y);if(K<0){k=!0;break}j.splice(K,1)}}for(var W=0,V=g.length;W<V;++W){var z=g[W];if(z){var K=F.indexOf(z);if(K<0){U=!0;break}F.splice(K,1)}}for(var W=0,V=g.length;W<V;++W){var z=g[W];if(z){var K=F.indexOf(z);if(K<0){U=!0;break}F.splice(K,1)}}if(k||U||w){k&&this.reverseMergeOpers(this.getMergeOperationsInManipulating()),U&&this.reverseStickOpers(this.getStickOperations());var X=e.CoordUtils;if(1===B||n.getCoordMode()===e.CoordMode.COORD3D){if(A[0]!==r.MERGE_BOND){var $=O.get(v[0]),J=$&&$.screenCoord,Z=n.getObjectScreenCoord(y[0]);if(J&&Z){var q=X.substract(Z,J),Q=!1,ee=e.NumUtils.isFloatEqual,te=1e-10;if(!ee(q.x,0,te)||!ee(q.y,0,te))for(var W=0,V=l.length;W<V;++W){var H=l[W],re=O.get(H);if(H!==v[0]){if(re&&re.screenCoord){var ie=X.add(re.screenCoord,q);re.screenCoord=ie,this._getMagneticNodeMergeOrStickDestInfo(H,ie,c)&&(Q=!0)}}else re&&re.screenCoord&&(re.screenCoord=Z)}if(Q)return this.applyManipulatingObjsInfo(t);for(var W=0,V=l.length;W<V;++W){var H=l[W],re=O.get(H);this.applySingleManipulatingObjInfo(W,H,re,t)}}}}else if(B>1&&n.getCoordMode()!==e.CoordMode.COORD3D){var ne=v[0],ae=v[1];if(ne&&ae){for(var oe=_.get(ne).screenCoord,se=_.get(ae).screenCoord,le=n.getObjectScreenCoord(y[0]),de=n.getObjectScreenCoord(y[1]),ue=X.calcCoordGroup2DTransformParams(oe,se,le,de),ce=X.calcTransform2DMatrix(ue),Q=!1,W=0,V=l.length;W<V;++W){var H=l[W];if(d.indexOf(H)<0){var re=_.get(H),$=O.get(H);if(re.screenCoord){var ie=X.transform2DByMatrix(re.screenCoord,ce);$.screenCoord=ie,this._getMagneticNodeMergeOrStickDestInfo(H,ie,c)&&(Q=!0)}re.size&&($.size=X.multiply(re.size,ue.scale))}}if(Q)return this.applyManipulatingObjsInfo(t);for(var W=0,V=l.length;W<V;++W){var H=l[W];if(v.indexOf(H)<0){var $=O.get(H);this.applySingleManipulatingObjInfo(W,H,$,t)}}}}if(k||U){var he=[];this._mergeOperationsChanged(B,v,y);for(var W=0,V=B;W<V;++W){var H=v[W],G=y[W],K=S[W],me=A[W];if(me===r.STICK){var ge=_.get(H),fe=ge.stickTarget;if(G!==fe)var pe=this.createNodeStickOperation(H,G);this.getStickOperations()[K]=pe,G||he.push({index:K,obj:H,newInfo:O.get(H)})}else if(i){var Ce=me===r.MERGE_BOND?this.createConnectorMergeOperation(H,G,!0):this.createNodeMergeOperation(H,G,!0);this.getMergePreviewOperations()[K]=Ce}else{var be=me===r.MERGE_BOND?this.createConnectorMergeOperation(H,G):this.createNodeMergeOperation(H,G);this.getMergeOperations()[K]=be}}if(k&&this.executeMergeOpers(this.getMergeOperationsInManipulating()),U&&this.executeStickOpers(this.getStickOperations()),he.length)for(var W=0,V=he.length;W<V;++W){var Ee=he[W];this.applySingleManipulatingObjInfo(Ee.index,Ee.obj,Ee.newInfo,t)}}}n.hotTrackOnObj(u)}}var O=this.getManipulateObjCurrInfoMap(),_=this.getManipulateObjInfoMap(),f=this,Ne=[];if(b||E){for(var W=0,V=l.length;W<V;++W){var H=l[W];if(objCanBeMerged(H)){var $=O.get(H),J=$.screenCoord;if(J){var R=n.getBoundInfosAtCoord(J,null,this.getCurrBoundInflation()),Te=this._getMagneticArrowNodeMergeDest(H,J,c);Te&&(Ne.push(W),d.push(H),u.push(Te))}}}if(d.length){for(var Oe=d.length,_e=Oe<=1,Se=!1,ve=[],W=0,V=d.length;W<V;++W){var K=Ne[W],ye=m[K];if(!ye){Se=!0;break}ve.push(ye)}for(var W=0,V=m.length;W<V;++W){var ye=m[W];if(ye){var K=ve.indexOf(ye);if(K<0){Se=!0;break}ve.splice(K,1)}}if(Se||_e){Se&&this.reverseMergeOpers(this.getMergeOperationsInManipulating());var X=e.CoordUtils;if(1===Oe){var $=O.get(d[0]),J=$.screenCoord,Z=n.getObjectScreenCoord(d[0]),q=X.substract(Z,J),Q=!1,ee=e.NumUtils.isFloatEqual,te=1e-10;if(!ee(q.x,0,te)||!ee(q.y,0,te))for(var W=0,V=l.length;W<V;++W){var H=l[W];if(H!==d[0])for(var W=0,V=l.length;W<V;++W){var ie=X.add(re.screenCoord,q);re.screenCoord=ie,this._getMagneticArrowNodeMergeDest(H,ie,c)&&(Q=!0)}}if(Q)return this.applyManipulatingObjsInfo(t);for(var W=0,V=l.length;W<V;++W){var H=l[W],re=O.get(H);this.applySingleManipulatingObjInfo(W,H,re,t)}}else if(Oe>1){for(var ne=d[0],ae=d[1],oe=_.get(ne).screenCoord,se=_.get(ae).screenCoord,le=n.getObjectScreenCoord(u[0]),de=n.getObjectScreenCoord(u[1]),ue=X.calcCoordGroup2DTransformParams(oe,se,le,de),ce=X.calcTransform2DMatrix(ue),Q=!1,W=0,V=l.length;W<V;++W){var H=l[W];if(d.indexOf(H)<0){var re=_.get(H),$=O.get(H);if(re.screenCoord){var ie=X.transform2DByMatrix(re.screenCoord,ce);$.screenCoord=ie,this._getMagneticArrowNodeMergeDest(H,ie,c)&&(Q=!0)}re.size&&($.size=X.multiply(re.size,ue.scale))}}if(Q)return this.applyManipulatingObjsInfo(t);for(var oe=_.get(ne).screenCoord,se=_.get(ae).screenCoord,le=n.getObjectScreenCoord(y[0]),de=n.getObjectScreenCoord(y[1]),ue=X.calcCoordGroup2DTransformParams(oe,se,le,de),ce=X.calcTransform2DMatrix(ue),Q=!1,W=0,V=l.length;W<V;++W){var H=l[W];if(d.indexOf(H)<0){var re=_.get(H),$=O.get(H);if(re.screenCoord){var ie=X.transform2DByMatrix(re.screenCoord,ce);$.screenCoord=ie,this._getMagneticNodeMergeOrStickDestInfo(H,ie,c)&&(Q=!0)}re.size&&($.size=X.multiply(re.size,ue.scale))}}if(Q)return this.applyManipulatingObjsInfo(t);for(var W=0,V=l.length;W<V;++W){var H=l[W];if(v.indexOf(H)<0){var $=O.get(H);this.applySingleManipulatingObjInfo(W,H,$,t)}}}if(k||U){var he=[];this._mergeOperationsChanged(B,v,y);for(var W=0,V=B;W<V;++W){var H=v[W],G=y[W],K=S[W],me=A[W];if(me===r.STICK){var ge=_.get(H),fe=ge.stickTarget;if(G!==fe)var pe=this.createNodeStickOperation(H,G);this.getStickOperations()[K]=pe,G||he.push({index:K,obj:H,newInfo:O.get(H)})}else if(i){var Ce=me===r.MERGE_BOND?this.createConnectorMergeOperation(H,G,!0):this.createNodeMergeOperation(H,G,!0);this.getMergePreviewOperations()[K]=Ce}else{var be=me===r.MERGE_BOND?this.createConnectorMergeOperation(H,G):this.createNodeMergeOperation(H,G);this.getMergeOperations()[K]=be}}if(k&&this.executeMergeOpers(this.getMergeOperationsInManipulating()),U&&this.executeStickOpers(this.getStickOperations()),he.length)for(var W=0,V=he.length;W<V;++W){var Ee=he[W];this.applySingleManipulatingObjInfo(Ee.index,Ee.obj,Ee.newInfo,t)}}}n.hotTrackOnObj(u)}}var h=this.getMergeOperationsInManipulating();h&&h.length&&(this._mergeOperationsChanged(0,[],[]),this.reverseMergeOpers(h));var Ae=this.getAnchorOperationsInManipulating();Ae&&Ae.length&&this.reverseAnchorOpers(Ae),$super(t)},_calcMagneticMergeOrStickInfoOnScreenCoord:function(e,t,r,i,n,a,o){var s=this.getEditor(),l=(this._objCanBeMagneticMerged,this._objCanBeMagneticSticked,t),d=e;if(d){var u=(s.getBoundInfosAtCoord(d,null,this.getCurrBoundInflation()),this._getMagneticNodeMergeOrStickDestInfo(l,d,a)),c=null,h=null;if(u&&(u.isStick?h=u.obj:u.isMerge&&(c=u.obj)),c||h)return{magneticObj:l,magneticDest:c||h,magneticType:h?o.STICK:o.MERGE};if(!h&&r){if(n.get(l).stickTarget)return{magneticObj:l,magneticDest:null,magneticType:o.STICK}}}},_calcMagneticMergeOrStickInfos:function(e,t,r,i,n){for(var a=this._isManipulatingSingleStickedObj(e),o=this._objCanBeMagneticMerged,s=this._objCanBeMagneticSticked,l=(this.getEditor(),[]),d=[],u=[],c=[],h=0,m=e.length;h<m;++h){var g=e[h];if(o(g)||s(g)){var f=t.get(g),p=f&&f.screenCoord;if(p){var C=this._calcMagneticMergeOrStickInfoOnScreenCoord(p,g,a,t,r,i,n);C&&(l.push(h),d.push(C.magneticObj),u.push(C.magneticDest),c.push(C.magneticType))}}}return{magneticObjIndexes:l,magneticObjs:d,magneticDests:u,magneticTypes:c}},_mergeOperationsChanged:function(e,t,r){},doMoveManipulatedObj_old:function($super,t,r,i,n){var a=this.getEditor(),o=this.getManipulateObjInfoMap().get(r),s=i,l=this.getManipulateOriginObjs(),d=this.getManipulationType(),u=d===e.Editor.BasicManipulationIaController.ManipulationType.MOVE&&1===l.length&&l[0]instanceof e.ChemStructureConnector,c=s,h=null,m=this.getMergeOperations(),g=m[t],f=this.getManipulateObjs();if(!u&&this.getEnableMagneticMerge()&&(r instanceof e.ChemStructureNode||r instanceof e.ChemMarker.UnbondedElectronSet)){var p=a.getBoundInfosAtCoord(c);if(p&&p.length){for(var C=p.length-1;C>=0;--C){var o=p[C],b=o.obj;if(b!==r&&(!(f.indexOf(b)>=0)&&(b instanceof e.ChemStructureNode||r instanceof e.ChemMarker.UnbondedElectronSet)&&this._canMergeNodes(r,b))){if(a.addHotTrackedObj(b),this.isSameNodeMerge(g,r,b))return;h=this.createNodeMergeOperation(r,b);break}}h?(g&&this.reverseMergeOpers(t),this.getMergeOperations()[t]=h,this.executeMergeOpers()):a.hotTrackOnObj(null)}}var c=n;if(d===e.Editor.BasicManipulationIaController.ManipulationType.MOVE){var E=l[0];if(l&&1===l.length){var N=a.getTopmostBoundInfoAtCoord(c,[E]);if(N){var T=N.obj;if(T&&f.indexOf(T)<0){if(u&&E instanceof e.ChemStructureConnector&&T instanceof e.ChemStructureConnector)this.getEnableConnectorMerge()&&(a.hotTrackOnObj(T),(!!this.getEnableStructFragmentMerge()||E.getParent()===T.getParent())&&(h=this.createConnectorMergeOperation(E,T)));else if((E instanceof e.ChemStructureNode||r instanceof e.ChemMarker.UnbondedElectronSet)&&(T instanceof e.ChemStructureNode||r instanceof e.ChemMarker.UnbondedElectronSet)&&this._canMergeNodes(E,T)){if(a.hotTrackOnObj(T),this.isSameNodeMerge(g,E,T))return;h=this.createNodeMergeOperation(E,T)}if(h){var g=m[t];return g&&this.reverseMergeOpers(t),this.getMergeOperations()[t]=h,void this.executeMergeOpers()}}}}}if(!h){a.hideHotTrack();/*!this._mergeReversed &&*/!!this.getMergeOperations().length&&this.reverseMergeOpers(t),$super(t,r,i,n)}},createNodeAnchorOperation:function(t,r){if(t instanceof e.Glyph.PathGlyphNode&&(r instanceof e.ChemStructureNode||r instanceof e.ChemMarker.UnbondedElectronSet||r instanceof e.ChemStructureConnector)){return new e.ChemStructOperation.AnchorNodesPreview(t,r,this.getEditor())}return null},createNodeMergeOperation:function(t,r,i){var n=this.getEnableStructFragmentMerge();if(e.ChemStructOperation.MergeNodes.canMerge(t,r,n,this.getEnableNeighborNodeMerge())){return i?new e.ChemStructOperation.MergeNodesPreview(t,r,n,this.getEditor()):new e.ChemStructOperation.MergeNodes(t,r,n,this.getEditor())}return null},createConnectorMergeOperation:function(t,r,i){var n=this.getEnableStructFragmentMerge();if(e.ChemStructOperation.MergeConnectors.canMerge(t,r,n)){return new(i?e.ChemStructOperation.MergeConnectorsPreview:e.ChemStructOperation.MergeConnectors)(t,r,this.getEditor().getCoordMode(),n,this.getEditor())}return null},createNodeStickOperation:function(t,r){this.getEnableStructFragmentStick();if(this._canStickNode(t,r)){return new e.ChemObjOperation.StickTo(t,r,this.getEditor())}return null},isSameConnectorMerge:function(t,r,i){return t&&t instanceof e.ChemStructOperation.MergeConnectorsBase&&r===t.getTarget()&&i===t.getDest()},isSameNodeMerge:function(t,r,i){return t&&t instanceof e.ChemStructOperation.MergeNodesBase&&r===t.getTarget()&&i===t.getDest()},isSameNodeStick:function(t,r,i){return t&&t instanceof e.ChemObjOperation.StickTo&&r===t.getTarget()&&i===t.getStickTarget()},isSameNodeMergeOrStick:function(e,t,r){return this.isSameNodeMerge(e,t,r)||this.isSameNodeStick(e,t,r)},executeStickOpers:function(t){var r=this.getEditor(),i=e.ArrayUtils.toUnique(t||this.getStickOperations());r.beginUpdateObject();try{for(var n=0,a=i.length;n<a;++n)i[n]&&i[n].execute()}finally{r.endUpdateObject()}},reverseStickOpers:function(t){var r=this.getEditor(),i=t||this.getStickOperations(),n=e.ArrayUtils.toUnique(i);if(n&&n.length){r.beginUpdateObject();try{for(var a=n.length-1;a>=0;--a)n[a]&&n[a].reverse();i.length=0}finally{r.endUpdateObject()}}else;},executeMergeOpers:function(r){var i=this.getEditor(),n=e.ArrayUtils.toUnique(r||this.getMergeOperationsInManipulating()),a=[];i.beginUpdateObject();try{for(var o=0,s=n.length;o<s;++o)if(n[o]){n[o].execute();var l=n[o].getDest?n[o].getDest():null;l&&t.pushUnique(a,l)}this.setMergingDests(a.length?a:null),this.refreshManipulateObjs(),this._mergeJustReversed=!1}finally{i.endUpdateObject()}},reverseMergeOpers:function(t){var r=this.getEditor();this.setMergingDests(null);var i=t||this.getMergeOperationsInManipulating(),n=e.ArrayUtils.toUnique(i);if(n&&n.length){r.beginUpdateObject();try{for(var a=n.length-1;a>=0;--a)n[a]&&n[a].reverse();i.length=0,this._mergeJustReversed=!0,this.refreshManipulateObjs()}finally{r.endUpdateObject()}}else;},react_pointermove:function($super,e){return this._suppressConstrainedMoving=e.getAltKey(),this._suppressConstrainedRotating=e.getAltKey(),this._isInDirectedMoving=e.getShiftKey(),$super(e)}}),e.Editor.IaControllerManager.register(e.Editor.BasicMolManipulationIaController,e.Editor.ChemSpaceEditor),e.Editor.SelectIaController=i.create(e.Editor.BasicMolManipulationIaController,{CLASS_NAME:"Kekule.Editor.SelectIaController",initialize:function($super,e){$super(e),this.setEnableSelect(!0),this.setEnableGestureManipulation(!0)}}),e.Editor.IaControllerManager.register(e.Editor.SelectIaController,e.Editor.ChemSpaceEditor),e.Editor.StructureInsertIaController=i.create(e.Editor.BasicMolManipulationIaController,{CLASS_NAME:"Kekule.Editor.StructureInsertIaController",initialize:function($super,e){$super(e),this._manipulatedBasicObjs=null},getInsertedObjs:function(){return this._manipulatedBasicObjs},doSetManipulateOriginObjs:function($super,e){return this._manipulatedBasicObjs=this._getManipulatedBasicObjects(e),$super(e)},_getManipulatedBasicObjects:function(r){for(var i=[],n=0,a=r.length;n<a;++n){var o=r[n];if(o instanceof e.ChemStructureObject)if(o instanceof e.StructureFragment&&o.isExpanded()){var s=[].concat(o.getNodes()).concat(o.getConnectors());t.pushUnique(i,s)}else t.pushUnique(i,o);else t.pushUniqueEx(i,o)}return i},stopManipulate:function($super){if(this.needAutoSelectNewlyInsertedObjects()){var e=this.getInsertedObjs();this.doneInsertOrModifyBasicObjects(e)}return $super()}}),e.Editor.MolBondIaController=i.create(e.Editor.StructureInsertIaController,{CLASS_NAME:"Kekule.Editor.MolBondIaController",initialize:function($super,t){$super(t),this.setState(s.State.INITIAL),this.setBondOrder(e.BondOrder.SINGLE),this.setAllowBondingToBond(!1),this.setEnableBondModification(!0),this.setEnableSelect(!1),this.setEnableMove(!0),this.setAutoSwitchBondOrder(!1),this.setEnableNeighborNodeMerge(!1)},initProperties:function(){this.defineProp("allowBondingToBond",{dataType:a.BOOL,serializable:!1}),this.defineProp("state",{dataType:a.INT,serializable:!1}),this.defineProp("enableBondModification",{dataType:a.BOOL,serializable:!1}),this.defineProp("autoSwitchBondOrder",{dataType:a.BOOL,serializable:!1}),this.defineProp("startingObj",{dataType:"Kekule.ChemStructureObject",serializable:!1}),this.defineProp("endingObj",{dataType:"Kekule.ChemStructureObject",serializable:!1}),this.defineProp("structFragment",{dataType:"Kekule.ChemStructureFragment",serializable:!1}),this.defineProp("autoCreatedStructFragment",{dataType:"Kekule.StructureFragment",serializable:!1}),this.defineProp("autoCreatedStartingObj",{dataType:"Kekule.ChemStructureObject",serializable:!1}),this.defineProp("bond",{dataType:"Kekule.Bond",serializable:!1}),this.defineProp("bondType",{dataType:a.STRING,serializable:!1}),this.defineProp("bondOrder",{dataType:a.INT,serializable:!1}),this.defineProp("bondStereo",{dataType:a.INT,serializable:!1}),this.defineProp("initialBondDirection",{dataType:a.FLOAT})},_isBondDifferent:function(t){var r=this.getBondStereo(),i=e.BondStereo;return r===i.UP||r===i.UP_INVERTED||r===i.DOWN||r===i.DOWN_INVERTED||(t.getBondType()!==this.getBondType()||t.getBondOrder()!==this.getBondOrder()||t.getStereo()!==this.getBondStereo())},canInteractWithObj:function($super,t){if(this.getState()!==s.State.INITIAL)return $super(t);if(t instanceof e.ChemStructureNode||t instanceof e.ChemMarker.UnbondedElectronSet)return!0;if(t instanceof e.ChemStructureConnector){if(this.getAllowBondingToBond())return!0;if(!this.getEnableBondModification())return!1;if(t instanceof e.Bond)return this._isBondDifferent(t)}},doTestMouseCursor:function(e,t){return""},getInsertedObjs:function($super){var e=this.getBond();return e?[e]:$super()},isObjValidBondTerminator:function(t){return!!t&&(this.getAllowBondingToBond()?t instanceof e.ChemStructureNode||t instanceof e.ChemStructureConnector||t instanceof e.ChemMarker.UnbondedElectronSet:t instanceof e.ChemStructureNode||t instanceof e.ChemMarker.UnbondedElectronSet)},isBond:function(t){return t instanceof e.Bond},getNewBondDefAngle:function(e,t){return this.getEditorConfigs().getStructureConfigs().getNewBondDefAngle(e,t)},addDefBond:function(t,r,i){var n,a=this.getEditor();a.beginUpdateObject();try{if(r)this.setAutoCreatedStartingObj(null),this.setAutoCreatedStructFragment(null);else{if(!this.getEditor().canAddUnconnectedStructFragment())return null;var o=this.getEditor().screenCoordToObj(t),s=this.getEditor().getOnlyOneBlankStructFragment();s?(r=this.getEditor().createStructStartingAtom(s,null,o),this.setAutoCreatedStructFragment(null),this.setAutoCreatedStartingObj(r)):(r=this.getEditor().createNewStructFragmentAndStartingAtom(null,o),this.setAutoCreatedStartingObj(null),this.setAutoCreatedStructFragment(r?r.getParent():null))}if(this.isObjValidBondTerminator(r)){var a=this.getEditor();this.setStartingObj(r);var l=r.getParent();this.setStructFragment(l);var d=this.getEditorConfigs().getStructureConfigs(),u=e.oneOf(this.getBondType(),d.getDefBondType()),c=e.oneOf(this.getBondOrder(),d.getDefBondOrder()),h=e.oneOf(this.getBondStereo(),e.BondStereo.NONE),m=a.getDefBondLength?a.getDefBondLength():d.getDefBondLength(),g=this.getNewBondDefAngle(r,c),f=e.Editor.StructureUtils.calcPreferred2DBondGrowingLocation(r,m,g,this.getEditor().getAllowCoordBorrow()),p=this.getEditor().createDefaultNode(f,e.Editor.CoordSys.OBJ,l);this.setEndingObj(p);var C=new e.Bond;C.setBondType(u),C.setBondOrder(c),C.setStereo(h),l.appendConnector(C),C.appendConnectedObj(r),C.appendConnectedObj(p),this.setBond(C),i&&this.getEditor().objectsChanged([{obj:C},{obj:p}]),n=f}else n=null}finally{a.endUpdateObject()}return n},addOperationToEditor:function($super){return $super()},getAllObjOperations:function($super,e){var t=$super(e)||[],r=this.getAddBondOperation();return r&&t.unshift(r),t},getAddBondOperation:function(){var t=new e.MacroOperation,r=this.getEditor(),i=this.getAutoCreatedStructFragment();if(i){var n=new e.ChemObjOperation.Add(i,this.getEditor().getChemObj(),null,this.getEditor());t.add(n)}var a=this.getStartingObj(),o=this.getEndingObj(),s=this.getBond(),l=this.getStructFragment(),r=this.getEditor(),d=this.getAutoCreatedStartingObj();if(d){var u=new e.ChemStructOperation.AddNode(d,l,null,r);t.add(u)}var u=new e.ChemStructOperation.AddNode(o,l,null,r);t.add(u);var c=new e.ChemStructOperation.AddConnector(s,l,null,[a,o],r);return t.add(c),t},modifyBond:function(t){var r,i=this.getBondType(),n=e.BondOrder,a=[n.SINGLE,n.DOUBLE,n.TRIPLE];if(this.getAutoSwitchBondOrder()&&i===e.BondType.COVALENT&&t.getBondType===e.BondType.COVALENT){var o=t.getBondOrder(),s=a.indexOf(o);s=s>=0?++s%a.length:0,r=a[s]}else r=this.getBondOrder();var l=t.getStereo(),d=this.getBondStereo();l===d&&(d=e.BondStereo.getInvertedDirection(d));var u={bondType:i,bondOrder:r,stereo:d},c=!1;for(var h in u){if(t.getPropValue(h)!==u[h]){c=!0;break}}if(c){var m=this.getEditor();m.beginUpdateObject();try{var g=new e.ChemObjOperation.Modify(t,u,this.getEditor());g.execute(),m.pushOperation(g);for(var f=[t].concat(t.getConnectedObjs()),p=[],C=0,b=f.length;C<b;++C)p.push({obj:f[C]});this.getEditor().objectsChanged(p)}finally{m.endUpdateObject()}}},react_pointerdown:function(t){if(this.setActivePointerType(t.pointerType),t.getButton()===e.X.Event.MOUSE_BTN_LEFT){var r=s.State,i=this._getEventMouseCoord(t);if(this.getState()===r.INITIAL){var n=this.getEditor().getTopmostBoundInfoAtCoord(i,null,this.getCurrBoundInflation());if(n){var a=n.obj;if(this.isObjValidBondTerminator(a)){var o=this.addDefBond(i,a,!0);return o&&(this.startDirectManipulate(null,this.getEndingObj(),i),this.moveManipulatedObjs(i)),!0}if(this.isBond(a)&&this.getEnableBondModification())return this.modifyBond(a),!0;t.preventDefault()}else if(this.getEditor().canAddUnconnectedStructFragment()){var o=this.addDefBond(i,null,!0);return o&&(this.startDirectManipulate(null,this.getEndingObj(),i),this.moveManipulatedObjs(i)),t.preventDefault(),!0}}}},react_pointerup:function($super,t){var r=this.getState(),i=this.getStartCoord(),n=this._getEventMouseCoord(t),a=e.Editor.BasicManipulationIaController.State;if(r===a.MANIPULATING&&t.getButton()===e.X.Event.MOUSE_BTN_LEFT&&(t.preventDefault(),e.CoordUtils.isEqual(i,n)))return this.manipulateBeforeStopping(),this.addOperationToEditor(),this.stopManipulate(),this.setState(a.NORMAL),this.getEditor().getSelection().length>0&&this.getEditor().setSelection(null),!0;var o=$super(t);return this.getEditor().getSelection().length>0&&this.getEditor().setSelection(null),o}}),e.Editor.MolBondIaController.State={INITIAL:0,START_NODE_SET:21,ADJUSTING:22};var s=e.Editor.MolBondIaController;return e.Editor.IaControllerManager.register(e.Editor.MolBondIaController,e.Editor.ChemSpaceEditor),e.Editor.MolAtomIaController_OLD=i.create(e.Editor.BaseEditorIaController,{CLASS_NAME:"Kekule.Editor.MolAtomIaController_OLD",initialize:function($super,e){$super(e),this._createNonAtomLabelInfos(),this._setterShown=!1},finalize:function($super){this.getAtomSetter()&&this.getAtomSetter().finalize(),$super()},initProperties:function(){this.defineProp("currAtom",{dataType:a.OBJECT,serializable:!1}),this.defineProp("atomSetter",{dataType:a.OBJECT,serializable:!1}),this.defineProp("periodicTable",{dataType:a.OBJECT,serializable:!1}),this.defineProp("periodicTableDialog",{dataType:a.OBJECT,serializable:!1}),this.defineProp("nonAtomLabelInfos",{dataType:a.ARRAY,serializable:!1})},canInteractWithObj:function($super,e){return!!this.isValidNode(e)},isValidNode:function(t){return t instanceof e.ChemStructureNode},getNodeLabel:function(t){var r=this.getEditor(),i=r.getRenderConfigs().getDisplayLabelConfigs();if(t.getIsotopeId)return t.getIsotopeId();if(t instanceof e.SubGroup){return t.getAbbr()||t.getFormulaText()||i.getRgroup()}if(t instanceof e.VariableAtom){var n=t.getAllowedIsotopeIds(),a=t.getDisallowedIsotopeIds();return n&&n.length?this._getVarAtomListLabel():a&&a.length?this._getVarAtomNotListLabel():this._getVarAtomListLabel()}var o=t.getCoreDisplayRichTextItem(null,null,i);return e.Render.RichTextUtils.toText(o)},_getVarAtomListLabel:function(){return this.getEditor().getRenderConfigs().getDisplayLabelConfigs().getVariableAtom()},_getVarAtomNotListLabel:function(){return"~"+this.getEditor().getRenderConfigs().getDisplayLabelConfigs().getVariableAtom()},_createNonAtomLabelInfos:function(){var t=[],r=this.getEditor().getRenderConfigs().getDisplayLabelConfigs();return t.push({nodeLabel:r.getRgroup(),nodeClass:e.RGroup,description:e.$L("ChemWidgetTexts.CAPTION_RGROUP")}),t.push({nodeLabel:r.getDummyAtom(),nodeClass:e.Pseudoatom,props:{atomType:e.PseudoatomType.DUMMY},description:e.$L("ChemWidgetTexts.CAPTION_DUMMY_ATOM")}),t.push({nodeLabel:r.getHeteroAtom(),nodeClass:e.Pseudoatom,props:{atomType:e.PseudoatomType.HETERO},description:e.$L("ChemWidgetTexts.CAPTION_HETERO_ATOM")}),t.push({nodeLabel:r.getAnyAtom(),nodeClass:e.Pseudoatom,props:{atomType:e.PseudoatomType.ANY},description:e.$L("ChemWidgetTexts.CAPTION_ANY_ATOM")}),t.push({nodeLabel:this._getVarAtomListLabel(),nodeClass:e.VariableAtom,description:e.$L("ChemWidgetTexts.CAPTION_VARIABLE_ATOM")}),t.push({nodeLabel:this._getVarAtomNotListLabel(),nodeClass:e.VariableAtom,description:e.$L("ChemWidgetTexts.CAPTION_VARIABLE_NOT_ATOM")}),this.setNonAtomLabelInfos(t),t},_indexOfNonAtomLabel:function(e){for(var t=this.getNonAtomLabelInfos(),r=0,i=t.length;r<i;++r){if(t[r].nodeLabel===e)return r}return-1},_getNonAtomInfo:function(e){var t=this._indexOfNonAtomLabel(e);return t<0?null:this.getNonAtomLabelInfos()[t]},getAtomSetterWidget:function(e){var t=this.getAtomSetter();if(!t&&e){var r=this.getEditor().getCoreElement(),i=r.ownerDocument;t=this._createAtomSetterWidget(i,r),this.setAtomSetter(t)}return t},_createAtomSetterWidget:function(t,r){for(var i=new e.Widget.ComboBox(t),n=this.getEditor().getEditorConfigs().getStructureConfigs().getPrimaryOrgChemAtoms(),a=[],o=0,s=n.length;o<s;++o)a.push({value:n[o],data:{props:{isotopeId:n[o]}}});a.push({value:e.$L("ChemWidgetTexts.CAPTION_ATOMLIST_PERIODIC_TABLE")});for(var l=this.getNonAtomLabelInfos(),o=0,s=l.length;o<s;++o){var d=l[o],u={value:d.nodeLabel,data:{props:d.props}};d.description&&(u.text=d.nodeLabel+" - "+d.description),a.push(u)}i.setItems(a),i.appendToElem(r);var c=this;return i.addEventListener("keyup",function(t){t.htmlEvent.getKeyCode()===e.X.Event.KeyCode.ENTER&&(c.applySetter(i),i.dismiss())}),i.addEventListener("valueSelect",function(e){c.applySetter(i),i.dismiss()}),i.addEventListener("showStateChange",function(e){e.isShown||e.isDismissed||c.getAtomSetter()&&c.getAtomSetter().isShown()&&c.applySetter(i)}),i},getPeriodicTableDialogWidget:function(e){var t=this.getPeriodicTableDialog();if(!t&&e){var r=this.getEditor().getCoreElement(),i=r.ownerDocument;t=this._createPeriodicTableDialogWidget(i,r),this.setPeriodicTableDialog(t)}return t},_createPeriodicTableDialogWidget:function(t,r){var i=new e.Widget.Dialog(t,e.$L("ChemWidgetTexts.CAPTION_PERIODIC_TABLE_DIALOG"),[e.Widget.DialogButtons.OK,e.Widget.DialogButtons.CANCEL]),n=new e.ChemWidget.PeriodicTable(t);return n.setUseMiniMode(!0),n.setEnableSelect(!0),n.appendToElem(i.getClientElem()),this.setPeriodicTable(n),i},openSetterUi:function(t,r){this.getAtomSetter();if(this.isValidNode(r)){this.setCurrAtom(r);var i=this.getEditor().getEditorConfigs().getInteractionConfigs().getAtomSetterFontSize()||0,n=i/1.5,a=this.getNodeLabel(r),o=this.getAtomSetterWidget(!0);o.setValue(a),o.setIsDirty(!1);var s=o.getElement().style;s.position="absolute",s.fontSize=i,s.left=t.x-n+"px",s.top=t.y-n+"px",o._applied=!1,o.setStandaloneOnShowHide(!0),o.show(this.getEditor(),null,e.Widget.ShowHideType.POPUP),function(){o.focus(),o.selectAll()}.defer()}},applySetter:function(t,r){if(!t._applied&&t.getIsDirty()){r||(r=this.getCurrAtom());var i,n,a=null,o=t.getValue();if(o===e.$L("ChemWidgetTexts.CAPTION_ATOMLIST_PERIODIC_TABLE")){var n=this.getPeriodicTableDialogWidget(!0);n.setCaption(e.$L("ChemWidgetTexts.CAPTION_PERIODIC_TABLE_DIALOG_SEL_ELEM"));var s=r.getSymbol?r.getSymbol():null;this.getPeriodicTable().setEnableSelect(!0).setEnableMultiSelect(!1).setSelectedSymbol(s)}else if(o===this._getVarAtomListLabel()||o===this._getVarAtomNotListLabel()){var l=o===this._getVarAtomNotListLabel(),n=this.getPeriodicTableDialogWidget(!0);n.setCaption(e.$L("ChemWidgetTexts.CAPTION_PERIODIC_TABLE_DIALOG_SEL_ELEM"));var d=r.getAllowedIsotopeIds?r.getAllowedIsotopeIds():null,u=r.getDisallowedIsotopeIds?r.getDisallowedIsotopeIds():null;this.getPeriodicTable().setEnableSelect(!0).setEnableMultiSelect(!0).setSelectedSymbols(l?u:d)}if(n){var c=this;return void n.openModal(function(t){if(t===e.Widget.DialogButtons.OK){var i,n;if(o===e.$L("ChemWidgetTexts.CAPTION_ATOMLIST_PERIODIC_TABLE")){var a=c.getPeriodicTable().getSelectedSymbol();i=e.Atom,n={isotopeId:a}}if(o===c._getVarAtomListLabel()){var s=c.getPeriodicTable().getSelectedSymbols();i=e.VariableAtom,n={allowedIsotopeIds:s,disallowedIsotopeIds:null}}if(o===c._getVarAtomNotListLabel()){var s=c.getPeriodicTable().getSelectedSymbols();i=e.VariableAtom,n={allowedIsotopeIds:null,disallowedIsotopeIds:s}}c.applyModification(r,null,i,n)}},this)}var h=null,m=this._getNonAtomInfo(o);if(m)i=m.nodeClass,a=m.props;else{var g=e.Editor.StoredSubgroupRepositoryItem2D.getRepItemOfInputText(o);if(g){var f=g.createObjects(r)||{},p=f.objects,C=e.Editor.RepositoryStructureUtils.calcRepObjInitialTransformParams(this.getEditor(),g,f,r,null);this.getEditor().transformCoordAndSizeOfObjects(p,C),h=p[0],i=h.getClass()}else i=e.ChemStructureNodeFactory.getClassByLabel(o,null),i||this.getEditorConfigs().getInteractionConfigs().getAllowUnknownAtomSymbol()&&(i=e.Pseudoatom),a=i===e.Atom?{isotopeId:o}:i===e.Pseudoatom?{symbol:o}:{}}i?(this.applyModification(r,h,i,a),t._applied=!0):e.error(e.$L("ErrorMsg.INVALID_ATOM_SYMBOL"))}},applyModification:function(t,r,i,n){var r,a,o,s=t.getClass();if(r&&!i&&(i=r.getClass()),r||i!==s){a=new e.MacroOperation,r||(r=new i);var l=new e.ChemStructureNode;l.assign(t),r.assign(l);var d=new e.ChemStructOperation.ReplaceNode(t,r,null,this.getEditor());a.add(d)}else r=t;n&&(o=new e.ChemObjOperation.Modify(r,n,this.getEditor()),a&&a.add(o));var u=a||o;if(u){var c=this.getEditor();c.beginManipulateAndUpdateObject();try{u.execute()}catch(e){throw e}finally{c.endManipulateAndUpdateObject()}c&&c.getEnableOperHistory()&&u&&c.pushOperation(u)}},react_pointerup:function(t){if(t.getButton()===e.X.Event.MOUSE_BTN_LEFT){this.getEditor().setSelection(null);var r=this._getEventMouseCoord(t),i=this.getEditor().getTopmostBoundInfoAtCoord(r,null,this.getCurrBoundInflation());if(i){var n=i.obj;if(this.isValidNode(n)){var a=this.getEditor().getObjectScreenCoord(n);t.preventDefault(),t.stopPropagation(),this.openSetterUi(a,n),this.getEditor().setSelection([n])}return!0}}}}),e.Editor.MolAtomIaController=i.create(e.Editor.BaseEditorIaController,{CLASS_NAME:"Kekule.Editor.MolAtomIaController",initialize:function($super,e){$super(e),this._createNonAtomLabelInfos(),this._setterShown=!1},finalize:function($super){this.getAtomSetter()&&this.getAtomSetter().finalize(),$super()},initProperties:function(){this.defineProp("currAtom",{dataType:a.OBJECT,serializable:!1}),this.defineProp("atomSetter",{dataType:a.OBJECT,serializable:!1}),this.defineProp("nonAtomLabelInfos",{dataType:a.ARRAY,serializable:!1})},canInteractWithObj:function($super,e){return!!this.isValidNode(e)},isValidNode:function(t){return t instanceof e.ChemStructureNode&&!(t instanceof e.StructureFragment&&t.isStandalone())},_createNonAtomLabelInfos:function(){var e=this.getEditor(),t=e&&e.getEnabledNonAtomInputData&&e.getEnabledNonAtomInputData();return this.setNonAtomLabelInfos(t),t},_indexOfNonAtomLabel:function(e){for(var t=this.getNonAtomLabelInfos(),r=0,i=t.length;r<i;++r){if(t[r].nodeLabel===e)return r}return-1},_getNonAtomInfo:function(e){var t=this._indexOfNonAtomLabel(e);return t<0?null:this.getNonAtomLabelInfos()[t]},getAtomSetterWidget:function(e){var t=this.getAtomSetter();if(!t&&e){var r=this.getEditor().getCoreElement(),i=r.ownerDocument;t=this._createAtomSetterWidget(i,r),this.setAtomSetter(t)}return t},_createAtomSetterWidget:function(r,i){var n=new e.ChemWidget.StructureNodeSetter(this.getEditor());n.setUseDropDownSelectPanel(!0),n.addClassName(o.CHEMEDITOR_ATOM_SETTER);var a=t.clone(this.getEditor().getEditorConfigs().getStructureConfigs().getPrimaryOrgChemAtoms());a.push("...");var s=this.getNonAtomLabelInfos();n.setSelectableInfos({elementSymbols:a,nonElementInfos:s,subGroupRepItems:e.Editor.StoredSubgroupRepositoryItem2D.getAllRepItems()});var l=this;return n.addEventListener("keyup",function(t){t.htmlEvent.getKeyCode()===e.X.Event.KeyCode.ENTER&&(l.applySetter(n),n.dismiss())}),n.addEventListener("valueSelect",function(e){l.getAtomSetter()&&l.getAtomSetter().isShown()&&(l.applySetter(n),n.dismiss())}),n.addEventListener("showStateChange",function(e){e.target!==n||e.byDomChange||e.isShown||e.isDismissed||l.getAtomSetter()&&l.getAtomSetter().isShown()&&l.applySetter(n)}),n.appendToElem(i),n},getPeriodicTableDialogWidget:function(e){var t=this.getPeriodicTableDialog();if(!t&&e){var r=this.getEditor().getCoreElement(),i=r.ownerDocument;t=this._createPeriodicTableDialogWidget(i,r),this.setPeriodicTableDialog(t)}return t},_createPeriodicTableDialogWidget:function(t,r){var i=new e.Widget.Dialog(t,e.$L("ChemWidgetTexts.CAPTION_PERIODIC_TABLE_DIALOG"),[e.Widget.DialogButtons.OK,e.Widget.DialogButtons.CANCEL]),n=new e.ChemWidget.PeriodicTable(t);return n.setUseMiniMode(!0),n.setEnableSelect(!0),n.appendToElem(i.getClientElem()),this.setPeriodicTable(n),i},openSetterUi:function(t,r){var i=this.getAtomSetter();if(i&&i.isShown()&&(i.hide(),i._haltPrevShowHideProcess()),this.isValidNode(r)){this.setCurrAtom(r);var n=this.getEditor().getEditorConfigs().getInteractionConfigs().getAtomSetterFontSize()||0;n*=this.getEditor().getZoom()||1;var a=n/1.5,o=this.getAtomSetterWidget(!0);o.setLabelConfigs(this.getEditor().getRenderConfigs().getDisplayLabelConfigs()),o.setNodes([r]);var s=this.getEditor().getCoreElement();o.appendToElem(s);var l=o.getNodeInputBox(),d=o.getElement().style;d.position="absolute",d.left=t.x-a+"px",d.top=t.y-a+"px",d.opacity=1,l.getElement().style.fontSize=n+"px",o._applied=!1,o.setStandaloneOnShowHide(!0),o.show(this.getEditor(),null,e.Widget.ShowHideType.POPUP),function(){l.focus(),l.selectAll()}.defer()}},applySetter:function(t,r){if(!t._applied){r||(r=this.getCurrAtom());var i=t.getValue();if(i){var n,a=i.nodeClass,o=i.props,s=i.repositoryItem;if(s){var l=s.createObjects(r)||{},d=l.objects,u=e.Editor.RepositoryStructureUtils.calcRepObjInitialTransformParams(this.getEditor(),s,l,r,null);this.getEditor().transformCoordAndSizeOfObjects(d,u),n=d[0],a=n.getClass()}i.isUnknownPseudoatom&&!this.getEditorConfigs().getInteractionConfigs().getAllowUnknownAtomSymbol()&&(a=null),a?(this.applyModification(r,n,a,o),t._applied=!0):e.error(e.$L("ErrorMsg.INVALID_ATOM_SYMBOL"))}}},applyModification:function(t,r,i,n){var r,a,o,s=t.getClass();if(r&&!i&&(i=r.getClass()),r||i!==s){a=new e.MacroOperation,r||(r=new i);var l=new e.ChemStructureNode;l.assign(t),r.assign(l);var d=new e.ChemStructOperation.ReplaceNode(t,r,null,this.getEditor());a.add(d)}else r=t;n&&(o=new e.ChemObjOperation.Modify(r,n,this.getEditor()),a&&a.add(o));var u=a||o;if(u){var c=this.getEditor();c.beginManipulateAndUpdateObject();try{u.execute()}catch(e){throw e}finally{c.endManipulateAndUpdateObject()}c&&c.getEnableOperHistory()&&u&&c.pushOperation(u)}},react_pointerup:function(t){if(t.getButton()===e.X.Event.MOUSE_BTN_LEFT){this.getEditor().setSelection(null);var r=this._getEventMouseCoord(t),i=this.getTopmostInteractableObjAtScreenCoord(r),n=this.getEditor().getObjectScreenCoord(i);return t.preventDefault(),t.stopPropagation(),this.openSetterUi(n,i),this.doneInsertOrModifyBasicObjects([i]),!0}}}),e.Editor.IaControllerManager.register(e.Editor.MolAtomIaController,e.Editor.ChemSpaceEditor),e.Editor.RepositoryIaController=i.create(e.Editor.StructureInsertIaController,{CLASS_NAME:"Kekule.Editor.RepositoryIaController",initialize:function($super,e){$super(e),this.setEnableSelect(!1),this._repObjStartingScreenCoord=null},initProperties:function(){this.defineProp("repositoryItem",{dataType:"Kekule.AbstractRepositoryItem",serializable:!1}),this.defineProp("addRepObjsOper",{dataType:"Kekule.MacroOperation",serializable:!1}),this.defineProp("initialTransformParams",{dataType:a.HASH,serializable:!1}),this.defineProp("currRepositoryObjects",{dataType:"Kekule.ChemObject",serializable:!1})},doTestMouseCursor:function(e,t){return""},canInteractWithObj:function($super,e){return $super(e)},isValidStartingObj:function(e){return!0},calcInitialTransformParams:function(t,r,i,n){return e.Editor.RepositoryStructureUtils.calcRepObjInitialTransformParams(this.getEditor(),t,r,i,n)},getRepObjCreationOptions:function(){return null},createObjFromRepositoryItem:function(e,t){return t.createObjects(e,this.getRepObjCreationOptions())||{}},addRepositoryObj:function(t,r,i){var n=this.getEditor();this.setAddRepObjsOper(null);var a=null;n.beginUpdateObject();try{var o=n.getChemSpace(),s=this.getRepositoryItem(),a=this.createObjFromRepositoryItem(t,s),l=a.objects;this.setCurrRepositoryObjects(l);var d=s.isOneStructureFragmentObj(),u=!1,c=this.getEditor().getOnlyOneBlankStructFragment();if(!n.canCreateNewChild()&&!a.mergeObj&&!i){if(!d||!n.canAddUnconnectedStructFragment())return null;u=!0}for(var h=new e.MacroOperation,m=0,g=l.length;m<g;++m){var f,p=l[m];f=u?new e.ChemStructOperation.MergeStructFragment(p,c,n):new e.ChemObjOperation.Add(p,o,null,n),h.add(f)}h.execute(),this.setAddRepObjsOper(h);var C=u?[c]:l,b=this.calcInitialTransformParams(s,a,t,r);this._transformObjectsCoordAndSize(C,b),this.setInitialTransformParams(b),a.objects=C;var E=s.getMolManipulationCenterCoord&&s.getMolManipulationCenterCoord();E&&(a.manipulationCenterCoord=e.CoordUtils.transform2D(E,b));var N=s.getMolManipulationDefDirectionCoord&&s.getMolManipulationDefDirectionCoord();N&&(a.manipulationDefDirectionCoord=e.CoordUtils.transform2D(N,b))}finally{n.endUpdateObject()}return a},doRefreshRepositoryObj:function(e,t,r,i,n){this.doPrepareManipulatingObjects(e,t),this.doPrepareManipulatingStartingCoords(t,r,i,n),this.doCreateManipulateMoveAndResizeOperation()},_transformObjectsCoordAndSize:function(e,t){return this.getEditor().transformCoordAndSizeOfObjects(e,t)},getAllObjOperations:function($super,e){var t=$super(e)||[],r=this.getAddRepObjsOper();return r&&t.unshift(r),t},addOperationToEditor:function($super){return $super()},getInitManipulationType:function(){return e.Editor.BasicManipulationIaController.ManipulationType.ROTATE},doInsertRepositoryObjToEditor:function(t,r,i,n){n||(this._initialStartingObj=i,this._repObjStartingScreenCoord=r);var a=t;if(a){var o=a.objects,s=null,l=null,d=this.getInitManipulationType();a.mergeObj?(s=this.getEditor().getObjectScreenCoord(a.mergeObj),d=e.Editor.BasicManipulationIaController.ManipulationType.ROTATE):a.manipulationCenterCoord&&(s=this.getEditor().objCoordToScreen(a.manipulationCenterCoord)),a.manipulationDefDirectionCoord&&(l=this.getEditor().objCoordToScreen(a.manipulationDefDirectionCoord));return{objects:o,manipulateType:d,coord:r,box:this.getEditor().getObjectsContainerBox(o),rotateCenter:s,rotateRefCoord:l,startingObj:i}}return null},insertRepositoryObjToEditor:function(e,t,r){var i=this.addRepositoryObj(t,e);return this.doInsertRepositoryObjToEditor(i,e,t,r)},updateRepositoryObjInEditor:function(){var e=this.getEditor();e.beginUpdateObject();try{this.useMergePreview()||this.reverseActiveOperation();for(var r=this.getCurrRepositoryObjects(),i=this.addRepositoryObj(this._initialStartingObj,this._repObjStartingScreenCoord,!0),n=t.exclude(r,(i||{}).objects),a=0,o=n.length;a<o;++a){var s=n[a],l=s.getParent();l&&l.removeChild(s)}this.useMergePreview()&&!n.length||(this.setMergeOperations([]),this.setMergePreviewOperations([]),this.setAnchorPreviewOperations([]));var d=this.doInsertRepositoryObjToEditor(i,this._repObjStartingScreenCoord,this._initialStartingObj,!0);d&&(this.doRefreshRepositoryObj(d.objects,d.coord,d.box,d.rotateCenter,d.rotateRefCoord),this.moveManipulatedObjs(this._repObjStartingScreenCoord))}finally{e.endUpdateObject()}return d},getDirectManipulateObjs:function(e,t){return e},react_pointerdown:function(r){if(this.setActivePointerType(r.pointerType),r.getButton()===e.X.Event.MOUSE_BTN_LEFT){var i=s.State,n=this._getEventMouseCoord(r);if(this.getState()===i.INITIAL){var a=this.getEditor().getTopmostBoundInfoAtCoord(n,null,this.getCurrBoundInflation()),o=a?a.obj:null,l=this.insertRepositoryObjToEditor(n,o);if(l){var d=l.objects||[],u=this.getDirectManipulateObjs(l.objects,l)||[];t.exclude(d,u).length||t.exclude(u,d).length?(this.startDirectManipulate(l.manipulateType,d,l.coord,l.box,l.rotateCenter),this.moveManipulatedObjs(n),this.startDirectManipulate(l.manipulateType,u,l.coord,l.box,l.rotateCenter),this.moveManipulatedObjs(n)):(this.startDirectManipulate(l.manipulateType,d,l.coord,l.box,l.rotateCenter),this.moveManipulatedObjs(n))}return r.preventDefault(),!0}}},react_pointerup:function($super,t){var r=this.getState(),i=this.getStartCoord(),n=this._getEventMouseCoord(t),a=e.Editor.BasicManipulationIaController.State;if(r===a.MANIPULATING&&t.getButton()===e.X.Event.MOUSE_BTN_LEFT&&e.CoordUtils.isEqual(i,n))return this.manipulateBeforeStopping(),this.addOperationToEditor(),this.stopManipulate(),this.setState(a.NORMAL),t.preventDefault(),this.getEditor().getSelection().length>0&&this.getEditor().setSelection(null),!0;var o=$super(t);return this.getEditor().getSelection().length>0&&this.getEditor().setSelection(null),o}}),e.Editor.MolRingIaController=i.create(e.Editor.RepositoryIaController,{CLASS_NAME:"Kekule.Editor.MolRingIaController",initialize:function($super,e){$super(e)}}),e.Editor.RepositoryStructureFragmentIaController=i.create(e.Editor.RepositoryIaController,{CLASS_NAME:"Kekule.Editor.RepositoryStructureFragmentIaController",initialize:function($super,e){$super(e)},initProperties:function(){this.defineProp("repItemName",{dataType:a.STRING,setter:function(t){if(t!==this.getRepItemName()){var r=e.Editor.RepositoryItemManager.getItem(t);r&&(this.setRepositoryItem(r),this.setPropStoreFieldValue("repItemName",t))}}})}}),e.Editor.IaControllerManager.register(e.Editor.RepositoryStructureFragmentIaController,e.Editor.ChemSpaceEditor),e.Editor.MolFlexStructureIaController=i.create(e.Editor.RepositoryIaController,{CLASS_NAME:"Kekule.Editor.MolFlexStructureIaController",initialize:function($super,e){$super(e),this.setEnableSelect(!1)},initProperties:function(){this.defineProp("assocMarker",{dataType:a.OBJECT,serializable:!1,setter:null,getter:function(){var t=this.getPropStoreFieldValue("assocMarker");return t||(t=new e.ChemWidget.TextUiMarker,this.setPropStoreFieldValue("assocMarker",t)),t}})},manipulateEnd:function($super){$super(),this.hideAssocMarker()},initAssocMarker:function(){var t=this.getAssocMarker(),r=this.getEditorConfigs().getUiMarkerConfigs(),i={color:r.getFlexStructureAssocMarkerColor(),opacity:r.getFlexStructureAssocMarkerOpacity(),fontSize:r.getFlexStructureAssocMarkerFontSize(),fontFamily:r.getFlexStructureAssocMarkerFontFamily(),textBoxXAlignment:e.Render.BoxXAlignment.CENTER,textBoxYAlignment:e.Render.BoxYAlignment.CENTER};return t.setDrawStyles(i),t.setVisible(!0),this.getEditor().getUiMarkers().addMarker(t),t},hideAssocMarker:function(){var e=this.getPropStoreFieldValue("assocMarker");e&&(e.setVisible(!1),this.getEditor().getUiMarkers().removeMarker(e),this.repaintMarker())},updateAssocMarker:function(e,t,r){var i=this.getAssocMarker();e&&i.setCoord(e),t&&i.setPropValues(t),r||this.repaintMarker()},repaintMarker:function(){this.getEditor().repaintUiMarker()}}),e.Editor.MolFlexChainIaController=i.create(e.Editor.MolFlexStructureIaController,{CLASS_NAME:"Kekule.Editor.MolFlexChainIaController",initialize:function($super,t){$super(t),this.setEnableSelect(!1),this._deltaDistance=null,this._deltaCount=0,this._lastDeltaCount=1,this._repObjStartingScreenCoord=null,this._repObjNeedUpdate=!1,this._isForceReversedChainDirection=!1,this._assocMarkerInitCoord=null,this._manipulateObjInfoCache=[],this._chain=null;var r=new e.Editor.MolChainRepositoryItem2D(2);r.setEnableCoordCache(!0),this.setRepositoryItem(r)},updateAssocMarker:function($super,t,i,n){var a=this.getEditor(),o=this.getAssocMarker().getDrawStyles(),s=this._chain,l=t;if(!l&&s){var d=s.getNodeAt(0),u=s.getNodeAt(s.getNodeCount()-1),c=a.getObjectContextCoord(d);l=a.getObjectContextCoord(u);var h;if(l&&c&&(h=r.substract(l,c)),h){var m=o.fontSize||10,g=m/2,f={x:0,y:0};if(l){var p=r.getDistance(h),C=h.x/p,b=h.y/p,f={x:g*C,y:g*b};l=e.CoordUtils.add(l,f)}}}$super(l,i,n)},getChainMaxAtomCount:function(){return Math.max(this.getEditorConfigs().getStructureConfigs().getMaxFlexChainAtomCount(),0)},manipulateEnd:function($super){this._clearManipulateObjInfoCache(),$super()},createManipulateObjInfo:function($super,e,t,r){var i=this.getRepositoryItem().getNegativeDirection(),n=this._getCachedManipulateObjInfo(t,i);if(n)return n;var a=$super(e,t,r);return this._setCachedManipulateObjInfo(a,t,i),a},canInteractWithObj:function($super,t){return $super(t)&&(t instanceof e.ChemStructureNode||t instanceof e.ChemMarker.UnbondedElectronSet)},getActualManipulatingObjects:function(e){var r=this.getCurrRepositoryObjects()[0];return r?t.clone(r.getNodes()):[]},_setCachedManipulateObjInfo:function(e,t,r){var i=r?1:0,n=this._manipulateObjInfoCache[i];n||(n=[],this._manipulateObjInfoCache[i]=n),n[t]=e},_getCachedManipulateObjInfo:function(e,t){var r=t?1:0,i=this._manipulateObjInfoCache[r];return i&&i[e]},_clearManipulateObjInfoCache:function(){this._manipulateObjInfoCache=[]},_calcStepDeltaDistance:function(){var t=this.getRepositoryItem().getBondLength(),r=this.getInitialTransformParams(),i=this.getEditor(),n=i.objCoordToScreen(e.CoordUtils.transform2D({x:0,y:0},r)),a=i.objCoordToScreen(e.CoordUtils.transform2D({x:t*Math.cos(Math.PI/6),y:0},r));return e.CoordUtils.getDistance(n,a)},getRepObjCreationOptions:function(){if(this._isUpdateRepObj){return{originalStructFragment:this.getCurrRepositoryObjects()[0]}}return null},addRepositoryObj:function($super,e,t,r){var i=$super(e,t,r);return this._deltaDistance=this._calcStepDeltaDistance(),this._repObjNeedUpdate=!1,i},insertRepositoryObjToEditor:function($super,e,t,r){if(!r){this._deltaDistance=null,this._deltaCount=0,this._lastDeltaCount=1;var i=2;this.getRepositoryItem().setAtomCount(i)}this._isUpdateRepObj=r;var n=$super(e,t,r);if(this._chain=n&&n.objects[0],n&&!r){this.initAssocMarker();this.updateAssocMarker(null,{text:""+i})}return n},_updateChain:function(){this._isUpdateRepObj=!0;var e=this.updateRepositoryObjInEditor();return this._chain=e.objects[0],this._repObjNeedUpdate=!1,e},doTransformManipulatedObjs:function($super,t,r,i){var n=r;if(this.getState()===e.Editor.BasicManipulationIaController.State.MANIPULATING){var a=this.getBaseCoord();if(a){var o=e.CoordUtils.getDistance(n,a),s=Math.max(Math.round(o/this._deltaDistance),1);if(!this._lastDeltaCount||s!==this._lastDeltaCount){this._deltaCount=s;var l=this.getChainMaxAtomCount(),d=l?Math.min(l,s+1):s+1;this.getRepositoryItem().getAtomCount()!==d&&(this.getRepositoryItem().setAtomCount(d),this._repObjNeedUpdate=!0,this.updateAssocMarker(null,{text:""+d},!0)),this._lastDeltaCount=s}var u,c=this._calcRotateAngle(n),h=c&&c.angle,m=this.isInActualConstrainedRotation();if(m){var g=m?2*this.getEditorConfigs().getInteractionConfigs().getConstrainedRotateStep():null;u=Math.round(h/g)*g-h<0}else u=!1;this._isForceReversedChainDirection&&(u=!u),!!this.getRepositoryItem().getNegativeDirection()!==u&&(this.getRepositoryItem().setNegativeDirection(u),this._repObjNeedUpdate=!0)}}this._repObjNeedUpdate&&this._updateChain();var f=this.getCurrRepositoryObjects()[0];f.beginUpdate();try{var p=$super(t,r,i);this.updateAssocMarker(null,null,!1)}finally{f.endUpdate()}return p},react_pointermove:function($super,e){return this._isForceReversedChainDirection=!!e.getShiftKey(),$super(e)}}),e.Editor.IaControllerManager.register(e.Editor.MolFlexChainIaController,e.Editor.ChemSpaceEditor),e.Editor.MolFlexRingIaController=i.create(e.Editor.MolFlexStructureIaController,{CLASS_NAME:"Kekule.Editor.MolFlexRingIaController",initialize:function($super,t){$super(t),this.setEnableSelect(!1),this._deltaDistance=null,this._lastDeltaCount=1,this._repObjStartingScreenCoord=null,this._repObjNeedUpdate=!1,this._manipulateObjInfoCache=[];var r=new e.Editor.MolRingRepositoryItem2D(3);r.setEnableCoordCache(!0),this.setRepositoryItem(r)},getRingMaxAtomCount:function(){return Math.max(this.getEditorConfigs().getStructureConfigs().getMaxFlexRingAtomCount(),0)},getRingMinAtomCount:function(){return Math.max(this.getEditorConfigs().getStructureConfigs().getMinFlexRingAtomCount(),3)},getActualManipulatingObjects:function(e){var r=this.getCurrRepositoryObjects()[0];return r?t.clone(r.getNodes()):[]},manipulateEnd:function($super){this._clearManipulateObjInfoCache(),$super()},createManipulateObjInfo:function($super,e,t,r){var i=this.getRepositoryItem().getRingAtomCount(),n=this._getCachedManipulateObjInfo(t,i);if(n)return n;var a=$super(e,t,r);return this._setCachedManipulateObjInfo(a,t,i),a},_setCachedManipulateObjInfo:function(e,t,r){var i=this._manipulateObjInfoCache[r];i||(i=[],this._manipulateObjInfoCache[r]=i),i[t]=e},_getCachedManipulateObjInfo:function(e,t){var r=this._manipulateObjInfoCache[t];return r&&r[e]},_clearManipulateObjInfoCache:function(){this._manipulateObjInfoCache=[]},_calcStepDeltaDistance:function(){var t=this.getRepositoryItem().getBondLength(),r=this.getInitialTransformParams(),i=this.getEditor(),n=i.objCoordToScreen(e.CoordUtils.transform2D({x:0,y:0},r)),a=i.objCoordToScreen(e.CoordUtils.transform2D({x:t,y:0},r));return e.CoordUtils.getDistance(n,a)/3},getRepObjCreationOptions:function(){if(this._isUpdateRepObj){return{originalStructFragment:this.getCurrRepositoryObjects()[0]}}return null},addRepositoryObj:function($super,e,t,r){var i=$super(e,t,r);return this._deltaDistance=this._calcStepDeltaDistance(),this._repObjNeedUpdate=!1,i},insertRepositoryObjToEditor:function($super,e,t,r){if(!r){this._deltaDistance=null,this._lastDeltaCount=1;var i=this.getEditorConfigs().getStructureConfigs().getMinFlexRingAtomCount();this.getRepositoryItem().setRingAtomCount(i)}this._isUpdateRepObj=r;var n=$super(e,t);if(n&&!r){var a=n.objects[0];this.initAssocMarker(),this.updateAssocMarker(this._getRingCenterAbsContextCoord(a),{text:""+i})}return n},updateAssocMarker:function($super,e,t,r){if(!e){var i=this._getManipulateObjsCenterCoord();e=this.getEditor().objCoordToContext(i)}return $super(e,t,r)},_getRingCenterAbsContextCoord:function(t){var r=this.getEditor(),i=e.Editor.StructureUtils.getStructureCenterAbsBaseCoord(t,r.getCoordMode(),r.getAllowCoordBorrow());return r.objCoordToContext(i)},_updateRing:function(){this._isUpdateRepObj=!0;var e=this.updateRepositoryObjInEditor();return this._repObjNeedUpdate=!1,e},doTransformManipulatedObjs:function($super,t,r,i){var n=r;if(this.getState()===e.Editor.BasicManipulationIaController.State.MANIPULATING){var a=this.getBaseCoord();if(a){var o=this.getRingMinAtomCount(),s=e.CoordUtils.getDistance(n,a),l=Math.round(s/this._deltaDistance)+o;if(!this._lastDeltaCount||l!==this._lastDeltaCount){var d=this.getRingMaxAtomCount(),u=d?Math.min(d,l):l;u=o?Math.max(u,o):u,this.getRepositoryItem().getRingAtomCount()!==u&&(this.getRepositoryItem().setRingAtomCount(u),this._repObjNeedUpdate=!0,this.updateAssocMarker(null,{text:""+u},!0)),this._lastDeltaCount=l}}}this._repObjNeedUpdate&&this._updateRing();var c=this.getCurrRepositoryObjects()[0];c.beginUpdate();try{var h=$super(t,r,i);this.updateAssocMarker(null,null,!1)}finally{c.endUpdate()}return h}}),e.Editor.IaControllerManager.register(e.Editor.MolFlexRingIaController,e.Editor.ChemSpaceEditor),e.Editor.MolRingIaController=i.create(e.Editor.MolFlexStructureIaController,{CLASS_NAME:"Kekule.Editor.MolRingIaController",initialize:function($super,t){$super(t),this.setRepositoryItem(new e.Editor.MolRingRepositoryItem2D),this.setEnableSelect(!1),this._currBondOrders=null},initProperties:function(){this.defineProp("ringAtomCount",{dataType:a.INT,getter:function(){return this.getRepositoryItem().getRingAtomCount()},setter:function(e){this.getRepositoryItem().setRingAtomCount(e)}}),this.defineProp("isAromatic",{dataType:a.INT})},getActualManipulatingObjects:function(e){var r=this.getCurrRepositoryObjects()[0];return r?t.clone(r.getNodes()):[]},createNodeMergeOperation:function($super,e,t,r){var i=$super(e,t,r);return this.getIsAromatic()&&i&&i.setMergeConnectorPropsFromTarget&&i.setMergeConnectorPropsFromTarget(!0),i},manipulateBeforeStopping:function($super){return this._currBondOrders&&this.useMergePreview()&&this._applyBondOrdersToSrcStruct(null,this._currBondOrders),$super()},_mergeOperationsChanged:function($super,e,t,r){$super(e,t,r);var i=this.getCurrRepositoryObjects(),n=i&&i[0];if(n){var a=this._getMergedDestObjs(n,e,t,r);this.updateRepStructureBondOrders(n,a,this.useMergePreview())}},createObjFromRepositoryItem:function($super,e,t){var r=$super(e,t);return this.updateRepStructureBondOrders(r.objects[0],null),this._currBondOrders=null,r},updateRepStructureBondOrders:function(e,t,r){if(this.getIsAromatic()){if(!e)var i=this.getCurrRepositoryObjects(),e=i&&i[0];t||(t={nodes:[],connectors:[],nodeCount:0,connectorCount:0});var n=this._calcSrcBondOrders(e,t),a=n.bondOrders,o=n.previewBondOrders;this._currBondOrders=a,this._applyBondOrdersToSrcStruct(e,r?o:a)}},_applyBondOrdersToSrcStruct:function(e,t){if(!e)var r=this.getCurrRepositoryObjects(),e=r&&r[0];var i=this.getEditor();try{i.beginUpdateObject(),e.beginUpdate();try{for(var n=0,a=e.getConnectorCount();n<a;++n){var o=e.getConnectorAt(n);if(o&&o.setBondOrder){var s=t[n];o.setBondOrder(s)}}}finally{e.endUpdate()}}finally{i.endUpdateObject()}},_getMergedDestObjs:function(e,t,r,i){var n=e;if(n){for(var a={nodes:[],connectors:[],nodeCount:0,connectorCount:0},o=0,s=n.getNodeCount();o<s;++o){var l=n.getNodeAt(o),d=r.indexOf(l),u=d>=0?i[d]:null;a.nodes.push(u),u&&++a.nodeCount}for(var o=0,s=n.getConnectorCount();o<s;++o){var c=n.getConnectorAt(o),h=function(e,t,r){for(var i=e.getConnectedChemNodes(),n=[],a=0,o=i.length;a<o;++a){var s=i[a],l=t.indexOf(s),d=r[l];if(!d)return null;n.push(d)}if(2===n.length)for(var u=n[0].getLinkedConnectors(),a=0,o=u.length;a<o;++a){var c=u[a],h=c.getConnectedChemNodes();if(2===h.length&&h.indexOf(n[1])>=0)return c}return null}(c,n.getNodes(),a.nodes)||null;a.connectors.push(h),h&&++a.connectorCount}}return a},_calcSrcBondOrders:function(r,i){if(r&&r.getNodeCount()){for(var n=(i&&i.nodeCount,r.getConnectors()),a=i.connectors,o=r.getNodes(),s=i.nodes,l=function(t){return t>e.BondOrder.SINGLE&&t<=e.BondOrder.QUAD},d=function(r,i){var a=r.getLinkedBonds(e.BondType.COVALENT),o=t.exclude(a,i);o=t.exclude(o,n);var s=!1;if(o.length)for(var d=0,u=o.length;d<u;++d){var c=o[d].getBondOrder();if(l(c)){s=!0;break}}return s},u=function(r,i){var n=r.getLinkedBonds(e.BondType.COVALENT),a=t.intersect(n,i),o=!1;if(a.length)for(var s=0,d=a.length;s<d;++s){var u=a[s].getBondOrder();if(l(u)){o=!0;break}}return o},c=[],h=[],m=!1,g=0,f=s.length;g<f;++g){var p=s[g];if(p&&function(t){var r=t.getLinkedBonds(e.BondType.COVALENT),i=!1;if(r.length)for(var n=0,a=r.length;n<a;++n){var o=r[n].getBondOrder();if(o===e.BondOrder.EXPLICIT_AROMATIC){i=!0;break}}return i}(p)){m=!0;break}}if(m){c=[];for(var g=0,f=n.length;g<f;++g)c[g]=e.BondOrder.EXPLICIT_AROMATIC;return c}for(var g=0,f=a.length;g<f;++g){var C=a[g];if(C){var b=C.getBondOrder();l(b)&&(c[g]=b)}}(function t(r,i,n,a,o,s,c){var h,m,g=e.BondOrder,f=r-1;f<0&&(f=i.length-1);var p=!!s[f],C=p?s[f]:null,b=i[r],E=a[r],N=E&&E.getBondOrder(),T=0;if(N&&l(N))h=[N],m=[g.SINGLE],C&&l(C)&&++T;else if(p&&l(C))h=[g.SINGLE];else{for(var O=b.getConnectedChemNodes(),_=!1,S=!1,v=0,y=O.length;v<y;++v){var A=n.indexOf(O[v]),M=o[A];if(M&&(_=d(M,a),S=u(M,a),_||S))break}h=_||S?[g.SINGLE]:[g.DOUBLE,g.SINGLE]}for(var I,v=0,y=h.length;v<y;++v){var R=h[v];if(s[r]=R,c[r]=m&&m[v]||R,r<i.length-1&&(T+=t(++r,i,n,a,o,s,c),(e.ObjUtils.isUnset(I)||I>T)&&(I=T,R),T<=0))break}return T})(0,n,o,a,s,c,h);return{bondOrders:c,previewBondOrders:h}}}}),e.Editor.IaControllerManager.register(e.Editor.MolRingIaController,e.Editor.ChemSpaceEditor),e.Editor.PathGlyphIaController=i.create(e.Editor.RepositoryIaController,{CLASS_NAME:"Kekule.Editor.PathGlyphIaController",initialize:function($super,e){$super(e)},getDirectManipulateObjs:function($super,e,t){if(1===e.length){var r=e[0];if(r.getNodeAt&&r.getNodeCount){r.getNodeCount();if(r.getDirectManipulationTarget)return r.getDirectManipulationTarget()}}return $super(e,t)},getInsertedObjs:function($super){return this.getCurrRepositoryObjects()}}),e.Editor.ArrowLineIaController=i.create(e.Editor.PathGlyphIaController,{CLASS_NAME:"Kekule.Editor.ArrowLineIaController",initialize:function($super,t){$super(t),this.setRepositoryItem(new e.Editor.PathGlyphRepositoryItem2D)},initProperties:function(){this.defineProp("glyphRefLength",{dataType:a.FLOAT,getter:function(){return this.getRepositoryItem().getGlyphRefLength()},setter:function(e){this.getRepositoryItem().setGlyphRefLength(e)}}),this.defineProp("glyphClass",{dataType:a.CLASS,serializable:!1,getter:function(){return this.getRepositoryItem().getGlyphClass()},setter:function(e){this.getRepositoryItem().setGlyphClass(e)}}),this.defineProp("glyphInitialParams",{dataType:a.HASH,getter:function(){return this.getRepositoryItem().getGlyphInitialParams()},setter:function(e){this.getRepositoryItem().setGlyphInitialParams(e)}})},getInitManipulationType:function(){return e.Editor.BasicManipulationIaController.ManipulationType.MOVE},addRepositoryObj:function($super,e,t,r){return this.getRepositoryItem().setGlyphRefLength(this.getEditor().getChemSpace().getDefAutoScaleRefLength()),$super(e,t,r)}}),e.Editor.IaControllerManager.register(e.Editor.ArrowLineIaController,e.Editor.ChemSpaceEditor),e.Editor.FormulaIaController=i.create(e.Editor.BaseEditorIaController,{CLASS_NAME:"Kekule.Editor.FormulaIaController",initialize:function($super,e){$super(e),this._operAddMol=null},initProperties:function(){this.defineProp("currMol",{dataType:a.OBJECT,serializable:!1}),this.defineProp("textSetter",{dataType:a.OBJECT,serializable:!1})},canInteractWithObj:function($super,e){return!(!e||!this.isValidMol(e))},isValidMol:function(t){return t instanceof e.StructureFragment&&t.hasFormula()&&!t.hasCtab()},getFormulaText:function(e){return e.hasFormula()?e.getFormula().getText():""},createNewMol:function(t,r){var i,n=this.getEditor();if(!n.canCreateNewChild()&&!(i=n.getOnlyOneBlankStructFragment()))return null;n.beginUpdateObject();try{if(!i)var i=new e.Molecule;i.getFormula(!0),t.appendChild(i),n.setObjectScreenCoord(i,r);var a=new e.ChemObjOperation.Add(i,t,null,n);this._operAddBlock=a}finally{n.endUpdateObject()}return i},getTextSetterWidget:function(e){var t=this.getTextSetter();if(!t&&e){var r=this.getEditor().getCoreElement(),i=r.ownerDocument;t=this._createTextSetterWidget(i,r),this.setTextSetter(t)}return t},_createTextSetterWidget:function(t,r){var i=new e.Widget.TextBox(this.getEditor());i.addClassName(o.CHEMEDITOR_FORMULA_SETTER),i.appendToElem(r);var n=this;return i.addEventListener("keyup",function(t){var r=t.htmlEvent,a=r.getKeyCode();a===e.X.Event.KeyCode.ENTER?(n.applySetter(i),i.dismiss()):a===e.X.Event.KeyCode.ESC&&(i.dismiss(),n.cancelSetter())}),i.addEventListener("showStateChange",function(e){e.byDomChange||(e.isShown||e.isDismissed||n.applySetter(i),e.isShown&&(i._applied=!1))}),i},cancelSetter:function(){this._operAddBlock&&(this._operAddBlock.reverse(),this._operAddBlock=null)},applySetter:function(t,r){if(!t._applied){r||(r=this.getCurrMol());var i,n=t.getText();if(n)var i=new e.ChemObjOperation.Modify(r.getFormula(),{text:n},this.getEditor());else this._operAddBlock?this.cancelSetter():i=new e.ChemObjOperation.Remove(r,r.getParent(),null,this.getEditor());var a=this.getEditor();if(a&&i){a.beginManipulateAndUpdateObject();try{if(i.execute(),a.getEnableOperHistory()){if(this._operAddBlock){var o=new e.MacroOperation;o.add(this._operAddBlock),o.add(i),a.pushOperation(o),this._operAddBlock=null}else a.pushOperation(i);this.doneInsertOrModifyBasicObjects([r])}}finally{a.endManipulateAndUpdateObject()}}t._applied=!0}},openSetterUi:function(t,r){var i=this.getTextSetter();if(i&&i.isShown()&&(this.applySetter(i,this.getCurrMol()),i.hide(),i._haltPrevShowHideProcess()),r||(r=this.createNewMol(this.getEditor().getChemObj(),t)),this.isValidMol(r)){this.setCurrMol(r),this.getEditor().setSelection([r]);var n=r.getCascadedRenderOption("fontSize")||this.getEditor().getEditorConfigs().getInteractionConfigs().getAtomSetterFontSize();n*=this.getEditor().getZoom()||1;var a=r.getCascadedRenderOption("fontFamily")||"",o=this.getFormulaText(r),s=this.getTextSetterWidget(!0),l=this.getEditor().getCoreElement();s.appendToElem(l);var d=o||"";s.setValue(d);var u=s.getElement().style;u.position="absolute",u.fontSize=n+"px",u.left=t.x+"px",u.top=t.y+"px",u.fontFamily=a,s._applied=!1,s.setStandaloneOnShowHide(!0),s.show(this.getEditor(),null,e.Widget.ShowHideType.POPUP),s.selectAll(),s.focus()}},react_pointerup:function(t){if(t.getButton()===e.X.Event.MOUSE_BTN_LEFT){this.getEditor().setSelection(null);var r,i=this._getEventMouseCoord(t),n=this.getTopmostInteractableObjAtScreenCoord(i);r=n;var a,o=n&&this.getEditor().getChemObjBounds(n),s=o&&o[0];return a=s&&s.boundInfo?s.boundInfo.coords[0]:i,t.preventDefault(),t.stopPropagation(),this.openSetterUi(a,r),!0}}}),e.Editor.IaControllerManager.register(e.Editor.FormulaIaController,e.Editor.ChemSpaceEditor),e.Editor.ContentBlockIaController=i.create(e.Editor.BaseEditorIaController,{CLASS_NAME:"Kekule.Editor.ContentBlockIaController",initialize:function($super,e){$super(e)},initProperties:function(){this.defineProp("currBlock",{dataType:a.OBJECT,serializable:!1})},canInteractWithObj:function($super,e){return e&&this.isValidBlock(e)},isValidBlock:function(t){return t instanceof e.ContentBlock},execute:function(e,t,r){},react_pointerup:function(t){if(t.getButton()===e.X.Event.MouseButton.LEFT){this.getEditor().setSelection(null);var r=this._getEventMouseCoord(t),i=this.getTopmostInteractableObjAtScreenCoord(r),n=i?this.getEditor().getObjectScreenCoord(i):r;return t.preventDefault(),t.stopPropagation(),this.execute(this.getEditor().getChemObj(),n,i),!0}}}),e.Editor.TextBlockIaController=i.create(e.Editor.ContentBlockIaController,{CLASS_NAME:"Kekule.Editor.TextBlockIaController",initialize:function($super,e){$super(e),this._operAddBlock=null},initProperties:function(){this.defineProp("textSetter",{dataType:a.OBJECT,serializable:!1})},isValidBlock:function(t){return t instanceof e.TextBlock},createNewBlock:function(t,r){var i=this.getEditor();if(!i.canCreateNewChild())return null;i.beginUpdateObject();try{var n=new e.TextBlock;if(n){t.appendChild(n),i.setObjectScreenCoord(n,r,e.Render.CoordPos.CORNER_TL);var a=new e.ChemObjOperation.Add(n,t,null,i);this._operAddBlock=a}}finally{i.endUpdateObject()}return n},getBlockText:function(e){return e.getText()},execute:function(e,t,r){this.openSetterUi(t,r)},getTextSetterWidget:function(e){var t=this.getTextSetter();if(!t&&e){var r=this.getEditor().getCoreElement(),i=r.ownerDocument;t=this._createTextSetterWidget(i,r),this.setTextSetter(t)}return t},_createTextSetterWidget:function(t,r){var i=new e.Widget.TextArea(this.getEditor());i.setAutoSizeX(!0),i.setAutoSizeY(!0),i.setDisplayed(!1),i.addClassName(o.CHEMEDITOR_TEXT_SETTER),i.appendToElem(r);var n=this;return i.addEventListener("keyup",function(t){var r=t.htmlEvent,a=r.getKeyCode();a===e.X.Event.KeyCode.ENTER&&r.getCtrlKey()?(n.applySetter(i),i.dismiss()):a===e.X.Event.KeyCode.ESC&&(i.dismiss(),n.cancelSetter())}),i.addEventListener("showStateChange",function(e){e.byDomChange||(e.isShown||e.isDismissed||n.applySetter(i),e.isShown&&(i._applied=!1))}),i},cancelSetter:function(){this._operAddBlock&&(this._operAddBlock.reverse(),this._operAddBlock=null)},applySetter:function(t,r){if(!t._applied){r||(r=this.getCurrBlock());var i,n=t.getText();n?i=new e.ChemObjOperation.Modify(r,{text:n},this.getEditor()):this._operAddBlock?this.cancelSetter():i=new e.ChemObjOperation.Remove(r,r.getParent(),null,this.getEditor());var a=this.getEditor();if(i&&a){a.beginManipulateAndUpdateObject();try{if(i.execute(),a.getEnableOperHistory())if(this._operAddBlock){var o=new e.MacroOperation;o.add(this._operAddBlock),o.add(i),a.pushOperation(o),this._operAddBlock=null}else a.pushOperation(i)}finally{a.endManipulateAndUpdateObject()}this.doneInsertOrModifyBasicObjects([r])}t._applied=!0}},openSetterUi:function(t,r){var i=this.getTextSetter();if(i&&i.isShown()&&(this.applySetter(i,this.getCurrBlock()),i._haltPrevShowHideProcess()),r||(r=this.createNewBlock(this.getEditor().getChemObj(),t)),this.isValidBlock(r)){this.setCurrBlock(r);var n=this.getEditor().getObjectScreenCoord(r,e.Render.CoordPos.CORNER_TL),a=r.getCascadedRenderOption("fontSize")||this.getEditor().getEditorConfigs().getInteractionConfigs().getAtomSetterFontSize();a*=this.getEditor().getZoom()||1;var o=r.getCascadedRenderOption("fontFamily")||"",s=this.getBlockText(r),l=this.getTextSetterWidget(!0);l._applied=!1,l.setValue(s);var d=s||e.$L("ChemWidgetTexts.CAPTION_TEXTBLOCK_INIT");l.setPlaceholder(d);var u=this.getEditor().getCoreElement();l.appendToElem(u);var c=l.getElement().style;c.position="absolute",c.fontSize=a+"px",c.left=n.x+"px",c.top=n.y+"px",c.fontFamily=o,c.opacity=1,l.setStandaloneOnShowHide(!0),l.show(this.getEditor(),null,e.Widget.ShowHideType.POPUP),function(){l.selectAll(),l.focus()}.defer()}}}),e.Editor.IaControllerManager.register(e.Editor.TextBlockIaController,e.Editor.ChemSpaceEditor),e.Editor.ImageBlockIaController=i.create(e.Editor.ContentBlockIaController,{CLASS_NAME:"Kekule.Editor.ImageBlockIaController",initialize:function($super,e){$super(e),this._operAddBlock=null,this._imgProbeElem=null,this._actionOpenFile=this.createOpenAction()},doFinalize:function(){this._actionOpenFile&&this.actionOpenFile.finalize()},initProperties:function(){},isValidBlock:function(t){return t instanceof e.ImageBlock},createNewBlock:function(t,r,i,n){var a=this.getEditor();if(!a.canCreateNewChild())return null;a.beginUpdateObject();try{var o=new e.ImageBlock;n&&o.setSrc(n),i&&o.setSize2D(i),a.setObjectScreenCoord(o,r,e.Render.CoordPos.CORNER_TL);var s=new e.ChemObjOperation.Add(o,t,null,a);this._operAddBlock=s}finally{a.endUpdateObject()}return o},_getImgFilters:function(){return[{title:e.$L("WidgetTexts.TITLE_IMG_FORMAT_PNG"),filter:".png"},{title:e.$L("WidgetTexts.TITLE_IMG_FORMAT_JPG"),filter:".jpg,.jpeg"},{title:e.$L("WidgetTexts.TITLE_IMG_FORMAT_GIF"),filter:".gif"},{title:e.$L("WidgetTexts.TITLE_IMG_FORMAT_SVG"),filter:".svg"},e.NativeServices.FILTER_ALL_SUPPORT,e.NativeServices.FILTER_ANY]},createOpenAction:function(){var t=new e.ActionFileOpen;return t.setFilters(this._getImgFilters()),t.on("open",this.reactImageFileOpen,this),t},reactImageFileOpen:function(t){var r=t.file;if(r){var i=this,n=new FileReader;n.addEventListener("load",function(){var t=i._getImageProbeElem();t.ownerDocument;try{delete t.width,delete t.height}catch(e){}t.src=n.result;var r=i.getEditor();(function(){var a={x:t.width,y:t.height};if(a.x<=0||a.y<=0)return void e.error(e.$L("ErrorMsg.INVALID_OR_EMPTY_IMAGE"));var o=i._currCoord,s=r.objCoordToContext(o),l=e.CoordUtils.add(s,a),d=r.contextCoordToObj(l),a=e.CoordUtils.substract(d,o);a=e.CoordUtils.absValue(a);var u,c=i.getCurrBlock(),h=r.getChemObj();if(c)u=new e.ChemObjOperation.Modify(c,{src:n.result,size2D:a});else{var m=i.createNewBlock(i.getEditor().getChemObj(),i._currCoord,a,n.result);i.setCurrBlock(m),u=new e.ChemObjOperation.Add(m,h,null,r)}if(u){r.beginManipulateAndUpdateObject();try{u.execute(),r&&r.getEnableOperHistory()&&r.pushOperation(u),i.doneInsertOrModifyBasicObjects([i.getCurrBlock()])}finally{r.endManipulateAndUpdateObject()}}}).defer()}),n.readAsDataURL(r)}},_getImageProbeElem:function(){if(!this._imgProbeElem){var e=this.getEditor().getElement().ownerDocument;this._imgProbeElem=e.createElement("img")}return this._imgProbeElem},execute:function(e,t,r){this.setCurrBlock(r),this._currCoord=t,this._actionOpenFile.execute(this.getEditor())}}),e.Editor.IaControllerManager.register(e.Editor.ImageBlockIaController,e.Editor.ChemSpaceEditor),e.Editor.AttachedMarkerIaController=i.create(e.Editor.BaseEditorIaController,{CLASS_NAME:"Kekule.Editor.AttachedMarkerIaController",initialize:function($super,e){$super(e)},initProperties:function(){this.defineProp("markerClass",{dataType:a.CLASS,serializable:!1}),this.defineProp("targetClass",{dataType:a.CLASS,serializable:!1}),this.defineProp("markerClassName",{dataType:a.STRING,getter:function(){return n.getClassName(this.getMarkerClass())},setter:function(t){this.setMarkerClass(n.findClass(t,void 0,e))}}),this.defineProp("targetClassName",{dataType:a.STRING,getter:function(){return n.getClassName(this.getTargetClass())},setter:function(t){this.setTargetClass(n.findClass(t,void 0,e))}}),this.defineProp("initialPropValues",{dataType:a.HASH})},canInteractWithObj:function($super,e){return this.isValidTarget(e)},isValidTarget:function(e){var t=this.getTargetClass();return e instanceof t||!t},createMarker:function(){var e,t=this.getMarkerClass();if(t){e=new t;var r=this.getInitialPropValues();r&&e&&e.setPropValues&&e.setPropValues(r)}return e},createOperations:function(t){var r,i=this.createMarker();return i&&(r=new e.ChemObjOperation.Add(i,t,null,this.getEditor())),[r]},apply:function(t){var r=this.createOperations(t),i=r.length<=0?null:1===r.length?r[0]:new e.MacroOperation(r);if(i){i.execute();var n=this.getEditor();n&&n.getEnableOperHistory()&&n.pushOperation(i)}},react_pointerup:function(t){if(t.getButton()===e.X.Event.MouseButton.LEFT){var r=this._getEventMouseCoord(t),i=this.getEditor().getTopmostBoundInfoAtCoord(r,null,this.getCurrBoundInflation());if(i){var n=i.obj;return this.isValidTarget(n)&&n.getAtomicNumber()<113&&(this.apply(n),t.preventDefault(),t.stopPropagation()),!0}}}}),e.Editor.IaControllerManager.register(e.Editor.AttachedMarkerIaController,e.Editor.ChemSpaceEditor),e.Editor.MolNodeChargeIaController=i.create(e.Editor.AttachedMarkerIaController,{CLASS_NAME:"Kekule.Editor.MolNodeChargeIaController",initialize:function($super,e){$super(e),this.setChargeInc(1)},initProperties:function(){this.defineProp("chargeInc",{dataType:a.NUMBER,serializable:!1}),this.defineProp("charge",{dataType:a.NUMBER,serializable:!1}),this.defineProp("radical",{dataType:a.INT,serializable:!1}),this.defineProp("currNode",{dataType:a.OBJECT,serializable:!1})},initPropValues:function($super){$super(),this.setTargetClass(e.ChemStructureNode)},createOperations:function(t){var r,i=!1,n=!1,a={},o=t.getCharge();e.ObjUtils.notUnset(this.getCharge())?o!==this.getCharge()&&(a.charge=this.getCharge(),i=!0):this.getChargeInc()&&(o+=this.getChargeInc(),a.charge=o,i=!0);var s=t.getRadical();this.getRadical()!==s&&(a.radical=this.getRadical(),n=!0),0===a.charge&&(a.radical=void 0,n=!0);var l,r=[],d=[],u=this.getEditor();if(i){var c=t.fetchChargeMarker(!1);0===a.charge||c||(l=new e.ChemMarker.Charge,l.setValue(a.charge),d.push(new e.ChemObjOperation.Add(l,t,null,u))),0===a.charge&&c&&d.push(new e.ChemObjOperation.Remove(c,null,null,u))}if(n){var h=t.fetchRadicalMarker(!1);0===a.radical||h||(l=new e.ChemMarker.Radical,l.setValue(a.radical),d.push(new e.ChemObjOperation.Add(l,t,null,u))),0===a.radical&&h&&d.push(new e.ChemObjOperation.Remove(h,null,null,u))}r=r.concat(d);var m;return(i||n)&&(m=new e.ChemObjOperation.Modify(t,a,this.getEditor()),r.push(m)),r}}),e.Editor.IaControllerManager.register(e.Editor.MolNodeChargeIaController,e.Editor.ChemSpaceEditor),e}},function(e,t,r){"use strict";var i=r(0).Class,n=(r(0).ClassEx,r(0).ObjectEx);r(0).DataType;e.exports=function(e){return e.Editor.EditorNexus=i.create(n,{CLASS_NAME:"Kekule.Editor.EditorNexus",initialize:function($super,e){$super(),this._currInvoker=null,e&&(e.editor&&this.setEditor(e.editor),e.structureTreeView&&this.setStructureTreeView(e.structureTreeView),e.objectInspector&&this.setObjectInspector(e.objectInspector))},initProperties:function(){this.defineProp("editor",{dataType:"Kekule.Editor.BaseEditor",serializable:!1,setter:function(e){var t=this.getPropStoreFieldValue("editor");this.setPropStoreFieldValue("editor",e),this.editorChanged(e,t)}}),this.defineProp("structureTreeView",{dataType:"Kekule.ChemWidget.StructureTreeView",serializable:!1,setter:function(e){var t=this.getPropStoreFieldValue("structureTreeView");this.setPropStoreFieldValue("structureTreeView",e),this.structureTreeViewChanged(e,t)}}),this.defineProp("objectInspector",{dataType:"Kekule.Widget.ObjectInspector",serializable:!1,setter:function(e){var t=this.getPropStoreFieldValue("objectInspector");this.setPropStoreFieldValue("objectInspector",e),this.objectInspectorChanged(e,t)}})},editorChanged:function(e,t){t&&this._uninstallEditorEventHandler(t),e&&this._installEditorEventHandler(e)},structureTreeViewChanged:function(e,t){t&&this._uninstallStructureTreeViewEventHandler(t),e&&(this._installStructureTreeViewEventHandler(e),this._updateByEditor())},objectInspectorChanged:function(e,t){var r=this.getEditor();r&&(t&&t.getOperHistory()===r.getOperHistory()&&t.setOperHistory(null),e&&(e.setOperHistory(r.getOperHistory()),e.setEnableOperHistory(r.getEnableOperHistory()),this._updateByEditor()))},_installEditorEventHandler:function(e){e.addEventListener("change",this._reactEditorChanged,this),e.addEventListener("beginUpdateObject",this._reactEditorBeginUpdateObject,this),e.addEventListener("endUpdateObject",this._reactEditorEndUpdateObject,this)},_uninstallEditorEventHandler:function(e){e.removeEventListener("change",this._reactEditorChanged,this),e.removeEventListener("beginUpdateObject",this._reactEditorBeginUpdateObject,this),e.removeEventListener("endUpdateObject",this._reactEditorEndUpdateObject,this)},_installStructureTreeViewEventHandler:function(e){e.addEventListener("change",this._reactStructureTreeViewChanged,this)},_uninstallStructureTreeViewEventHandler:function(e){e.removeEventListener("change",this._reactStructureTreeViewChanged,this)},_reactEditorChanged:function(e){if(!this._currInvoker){var t=e.target;if(t===this.getEditor()){var r=e.changedPropNames;if(r.indexOf("chemObj")>=0&&this.changeRootObj(t.getChemObj(),t),r.indexOf("selection")>=0&&this.changeSelection(t.getSelection(),t),r.indexOf("operHistory")>=0||r.indexOf("enableOperHistory")>=0){var i=this.getObjectInspector();i&&(i.setOperHistory(t.getOperHistory()),i.setEnableOperHistory(t.getEnableOperHistory()))}}}},_reactEditorBeginUpdateObject:function(e){this.pauseLiveUpdate()},_reactEditorEndUpdateObject:function(e){this.resumeLiveUpdate()},_updateByEditor:function(){this._reactEditorChanged({target:this.getEditor(),changedPropNames:["chemObj","selection","operHistory"]})},_reactStructureTreeViewChanged:function(e){if(!this._currInvoker){var t=e.target;if(t===this.getStructureTreeView()){if(e.changedPropNames.indexOf("selection")>=0){var r=t.getSelectedChemObjs();this.changeSelection(r,t)}}}},pauseLiveUpdate:function(){var e=this.getStructureTreeView();e&&e.pauseLiveUpdate()},resumeLiveUpdate:function(){var e=this.getStructureTreeView();e&&e.resumeLiveUpdate()},changeSelection:function(e,t){this._currInvoker=t;try{var r=this.getEditor();r&&this._currInvoker!==r&&r.setSelection(e);var i=this.getStructureTreeView();i&&this._currInvoker!==i&&i.selectChemObjs(e);var n=this.getObjectInspector();n&&this._currInvoker!==n&&n.setObjects(e)}finally{this._currInvoker=null}},changeRootObj:function(e,t){this._currInvoker=t;try{var r=this.getEditor();r&&this._currInvoker!==r&&r.setChemObj(e);var i=this.getStructureTreeView();i&&this._currInvoker!==i&&i.setRootObj(e)}finally{this._currInvoker=null}}}),e}},function(e,t,r){"use strict";var i=r(0).Class,n=r(0).ClassEx,a=r(0).DataType;e.exports=function(e){var t=(i.PropertyScope,e.ArrayUtils),r=(e.ChemWidget,e.Editor,e.Widget.HtmlClassNames),o=e.ChemWidget.HtmlClassNames,s=e.ChemWidget.ComponentWidgetNames;return e.ChemWidget.HtmlClassNames=Object.extend(e.ChemWidget.HtmlClassNames,{COMPOSER:"K-Chem-Composer",COMPOSER_GRID_LAYOUT:"K-Chem-Composer-Grid-Layout",COMPOSER_EDITOR_STAGE:"K-Chem-Composer-Editor-Stage",COMPOSER_ADV_PANEL:"K-Chem-Composer-Adv-Panel",COMPOSER_TOP_REGION:"K-Chem-Composer-Top-Region",COMPOSER_LEFT_REGION:"K-Chem-Composer-Left-Region",COMPOSER_BOTTOM_REGION:"K-Chem-Composer-Bottom-Region",COMPOSER_TOOLBAR:"K-Chem-Composer-Toolbar",COMPOSER_COMMON_TOOLBAR:"K-Chem-Composer-Common-Toolbar",COMPOSER_ZOOM_TOOLBAR:"K-Chem-Composer-Zoom-Toolbar",COMPOSER_CHEM_TOOLBAR:"K-Chem-Composer-Chem-Toolbar",COMPOSER_ASSOC_TOOLBAR:"K-Chem-Composer-Assoc-Toolbar",COMPOSER_STYLE_TOOLBAR:"K-Chem-Composer-Style-Toolbar",COMPOSER_OBJMODIFIER_TOOLBAR:"K-Chem-Composer-ObjModifier-Toolbar",COMPOSER_FONTNAME_BOX:"K-Chem-Composer-FontName-Box",COMPOSER_FONTSIZE_BOX:"K-Chem-Composer-FontSize-Box",COMPOSER_NODEDISPLAYMODE_BOX:"K-Chem-Composer-NodeDisplayMode-Box",COMPOSER_COLOR_BOX:"K-Chem-Composer-Color-Box",COMPOSER_TEXTDIRECTION_BUTTON:"K-Chem-Composer-TextDirection-Button",COMPOSER_TEXTDIRECTION_BUTTON_DEFAULT:"K-Chem-Composer-TextDirection-Button-Default",COMPOSER_TEXTDIRECTION_BUTTON_LTR:"K-Chem-Composer-TextDirection-Button-LTR",COMPOSER_TEXTDIRECTION_BUTTON_RTL:"K-Chem-Composer-TextDirection-Button-RTL",COMPOSER_TEXTDIRECTION_BUTTON_TTB:"K-Chem-Composer-TextDirection-Button-TTB",COMPOSER_TEXTDIRECTION_BUTTON_BTT:"K-Chem-Composer-TextDirection-Button-BTT",COMPOSER_TEXTALIGN_BUTTON:"K-Chem-Composer-TextAlign-Button",COMPOSER_TEXTALIGN_BUTTON_HORIZONTAL:"K-Chem-Composer-TextAlign-Button-Horizontal",COMPOSER_TEXTALIGN_BUTTON_VERTICAL:"K-Chem-Composer-TextAlign-Button-Vertical",COMPOSER_TEXTALIGN_BUTTON_DEFAULT:"K-Chem-Composer-TextAlign-Button",COMPOSER_TEXTALIGN_BUTTON_LEADING:"K-Chem-Composer-TextAlign-Button-Leading",COMPOSER_TEXTALIGN_BUTTON_TRAILING:"K-Chem-Composer-TextAlign-Button-Trailing",COMPOSER_TEXTALIGN_BUTTON_CENTER:"K-Chem-Composer-TextAlign-Button-Center",COMPOSER_TEXTALIGN_BUTTON_LEFT:"K-Chem-Composer-TextAlign-Button-Left",COMPOSER_TEXTALIGN_BUTTON_RIGHT:"K-Chem-Composer-TextAlign-Right",COMPOSER_TEXTALIGN_BUTTON_TOP:"K-Chem-Composer-TextAlign-Top",COMPOSER_TEXTALIGN_BUTTON_BOTTOM:"K-Chem-Composer-TextAlign-Bottom",COMPOSER_DIALOG:"K-Chem-ComposerDialog",COMPOSER_FRAME:"K-Chem-ComposerFrame",COMPOSER_FRAME_CONTENT_DOC:"K-Chem-ComposerFrame-ContentDoc",COMPOSER_FRAME_CONTENT_BODY:"K-Chem-ComposerFrame-ContentBody"}),e.globalOptions.add("chemWidget.composer",{commonToolButtons:[s.newDoc,s.loadData,s.saveData,s.undo,s.redo,s.copy,s.cut,s.paste,s.zoomIn,s.zoomOut,s.config,s.objInspector],chemToolButtons:[s.manipulate,s.erase,s.molBond,s.molAtomAndFormula,s.molRing,s.molCharge,s.glyph,s.textImage],styleToolComponentNames:[s.fontName,s.fontSize,s.color,s.textDirection,s.textAlign]}),e.Editor.ComposerStyleToolbar=i.create(e.Widget.Toolbar,{CLASS_NAME:"Kekule.Editor.ComposerStyleToolbar",ATOM_COLOR_SPECIAL_VALUE_INFO:{text:e.$L("ChemWidgetTexts.HINT_USE_ATOM_CUSTOM_COLOR"),value:"Atom",className:r.COLORPICKER_SPEC_COLOR_MIXED},LINKED_VALUE_FIELD:"__$value__",initialize:function($super,t){$super(t),this.setPropStoreFieldValue("composer",t),this.createChildWidgets(),this.appendToWidget(t),this._relatedPropNames=t.getCoordMode()===e.CoordMode.COORD3D?["renderOptions","render3DOptions"]:["renderOptions"],this.getEditor().addEventListener("selectionChange",function(e){this._isApplying||this.updateStyleValues()},this),this.getEditor().addEventListener("editObjChanged",function(t){var r=t.propNames;r&&r.length&&e.ArrayUtils.intersect(this._relatedPropNames,r).length&&(this._isApplying||this.updateStyleValues())},this),this._isApplying=!1},doFinalize:function($super){this.clearWidgets(),$super()},initProperties:function(){this.defineProp("composer",{dataType:"Kekule.Editor.Composer",serializable:!1,setter:null}),this.defineProp("fontNameBox",{dataType:"Kekule.Widget.ComboBox",serializable:!1,setter:null}),this.defineProp("fontSizeBox",{dataType:"Kekule.Widget.ComboBox",serializable:!1,setter:null}),this.defineProp("colorBox",{dataType:"Kekule.Widget.ColorDropButton",serializable:!1,setter:null}),this.defineProp("textDirectionButtonSet",{dataType:"Kekule.Widget.CompactButtonSet",serializable:!1,setter:null}),this.defineProp("textHorizontalAlignButtonSet",{dataType:"Kekule.Widget.CompactButtonSet",serializable:!1,setter:null}),this.defineProp("textVerticalAlignButtonSet",{dataType:"Kekule.Widget.CompactButtonSet",serializable:!1,setter:null}),this.defineProp("fontName",{dataType:a.STRING,serializable:!1,getter:function(){return this.getFontNameBox()?this.getFontNameBox().getValue():null},setter:function(e){this.getFontNameBox()&&this.getFontNameBox().setValue(e)}}),this.defineProp("fontSize",{dataType:a.NUMBER,serializable:!1,getter:function(){return this.getFontSizeBox()?parseFloat(this.getFontSizeBox().getValue()):null},setter:function(e){this.getFontSizeBox()&&this.getFontSizeBox().setValue(e)}}),this.defineProp("color",{dataType:a.STRING,serializable:!1,getter:function(){return this.getColorBox()?this.getColorBox().getValue():void 0},setter:function(e){this.getColorBox()&&this.getColorBox().setValue(e)}}),this.defineProp("textDirection",{dataType:a.INT,serializable:!1,getter:function(){return this._getButtonSetLinkedValue(this.getTextDirectionButtonSet())},setter:function(e){this._setButtonSetLinkedValue(this.getTextDirectionButtonSet(),e)}}),this.defineProp("textHorizontalAlign",{dataType:a.INT,serializable:!1,getter:function(){return this._getButtonSetLinkedValue(this.getTextHorizontalAlignButtonSet())},setter:function(e){this._setButtonSetLinkedValue(this.getTextHorizontalAlignButtonSet(),e)}}),this.defineProp("textVerticalAlign",{dataType:a.INT,serializable:!1,getter:function(){return this._getButtonSetLinkedValue(this.getTextVerticalAlignButtonSet())},setter:function(e){this._setButtonSetLinkedValue(this.getTextVerticalAlignButtonSet(),e)}}),this.defineProp("componentNames",{dataType:a.ARRAY,serializable:!1,getter:function(){var e=this.getPropStoreFieldValue("componentNames");return e||(e=this.getDefaultComponentNames(),this.setPropStoreFieldValue("componentNames",e)),e},setter:function(e){this.setPropStoreFieldValue("componentNames",e),this.recreateComponents()}})},initPropValues:function($super){$super(),this.setShowGlyph(!0)},removeWidget:function($super,e,t){e===this.getFontNameBox()&&this.setPropStoreFieldValue("fontNameBox",null),e===this.getFontSizeBox()&&this.setPropStoreFieldValue("fontSizeBox",null),e===this.getColorBox()&&this.setPropStoreFieldValue("colorBox",null),e===this.getTextDirectionButtonSet()&&this.setPropStoreFieldValue("textDirectionButtonSet",null),e===this.getTextHorizontalAlignButtonSet()&&this.setPropStoreFieldValue("textHorizontalAlignButtonSet",null),e===this.getTextVerticalAlignButtonSet()&&this.setPropStoreFieldValue("textVerticalAlignButtonSet",null),$super(e,t)},doGetWidgetClassName:function($super){return $super()+" "+o.COMPOSER_TOOLBAR+" "+o.COMPOSER_STYLE_TOOLBAR},getEditor:function(){return this.getComposer().getEditor()},getEditorConfigs:function(){return this.getEditor().getEditorConfigs()},createChildWidgets:function(t){t||(t=this.getComponentNames());for(var r=0,i=t.length;r<i;++r){var n=t[r];if(n===s.fontName){var a=new e.Widget.ComboBox(this);this.fillFontNameBox(a),a.addClassName(o.COMPOSER_FONTNAME_BOX),a.setHint(e.$L("ChemWidgetTexts.HINT_FONTNAME")),a.addEventListener("valueChange",function(e){this.applyFontName()},this),this.setPropStoreFieldValue("fontNameBox",a)}else if(n===s.fontSize)a=new e.Widget.ComboBox(this),this.fillFontSizeBox(a),a.addClassName(o.COMPOSER_FONTSIZE_BOX),a.setHint(e.$L("ChemWidgetTexts.HINT_FONTSIZE")),a.addEventListener("valueChange",function(e){this.applyFontSize()},this),this.setPropStoreFieldValue("fontSizeBox",a);else if(n===s.color){var l=new e.Widget.ColorDropButton(this);l.setHint(e.$L("ChemWidgetTexts.HINT_PICK_COLOR")),l.setShowText(!1),l.setSpecialColors([e.Widget.ColorPicker.SpecialColors.UNSET,this.ATOM_COLOR_SPECIAL_VALUE_INFO]),l.addClassName(o.COMPOSER_COLOR_BOX),l.addEventListener("valueChange",function(e){this.applyColor()},this),this.setPropStoreFieldValue("colorBox",l)}else if(n===s.textDirection){var d=e.Render.TextDirection,u=[{value:d.DEFAULT,text:e.$L("ChemWidgetTexts.CAPTION_TEXT_DIRECTION_DEFAULT"),className:o.COMPOSER_TEXTDIRECTION_BUTTON_DEFAULT},{value:d.LTR,text:e.$L("ChemWidgetTexts.CAPTION_TEXT_DIRECTION_LTR"),className:o.COMPOSER_TEXTDIRECTION_BUTTON_LTR},{value:d.RTL,text:e.$L("ChemWidgetTexts.CAPTION_TEXT_DIRECTION_RTL"),className:o.COMPOSER_TEXTDIRECTION_BUTTON_RTL},{value:d.TTB,text:e.$L("ChemWidgetTexts.CAPTION_TEXT_DIRECTION_TTB"),className:o.COMPOSER_TEXTDIRECTION_BUTTON_TTB},{value:d.BTT,text:e.$L("ChemWidgetTexts.CAPTION_TEXT_DIRECTION_BTT"),className:o.COMPOSER_TEXTDIRECTION_BUTTON_BTT}],c=this._createStyleButtonSet(e.$L("ChemWidgetTexts.CAPTION_TEXT_DIRECTION"),e.$L("ChemWidgetTexts.HINT_TEXT_DIRECTION"),o.COMPOSER_TEXTDIRECTION_BUTTON,u);c.addEventListener("select",function(e){this.applyTextDirection()},this),this.setPropStoreFieldValue("textDirectionButtonSet",c)}else if(n===s.textAlign){var h=e.Render.TextAlign,u=[{value:h.DEFAULT,text:e.$L("ChemWidgetTexts.CAPTION_TEXT_ALIGN_DEFAULT"),className:o.COMPOSER_TEXTALIGN_BUTTON_DEFAULT},{value:h.LEADING,text:e.$L("ChemWidgetTexts.CAPTION_TEXT_ALIGN_LEADING"),className:o.COMPOSER_TEXTALIGN_BUTTON_LEADING},{value:h.TRAILING,text:e.$L("ChemWidgetTexts.CAPTION_TEXT_ALIGN_TRAILING"),className:o.COMPOSER_TEXTALIGN_BUTTON_TRAILING},{value:h.CENTER,text:e.$L("ChemWidgetTexts.CAPTION_TEXT_ALIGN_CENTER"),className:o.COMPOSER_TEXTALIGN_BUTTON_CENTER},{value:h.LEFT,text:e.$L("ChemWidgetTexts.CAPTION_TEXT_ALIGN_LEFT"),className:o.COMPOSER_TEXTALIGN_BUTTON_LEFT},{value:h.RIGHT,text:e.$L("ChemWidgetTexts.CAPTION_TEXT_ALIGN_RIGHT"),className:o.COMPOSER_TEXTALIGN_BUTTON_RIGHT}],c=this._createStyleButtonSet(e.$L("ChemWidgetTexts.CAPTION_TEXT_HORIZONTAL_ALIGN"),e.$L("ChemWidgetTexts.HINT_TEXT_HORIZONTAL_ALIGN"),o.COMPOSER_TEXTALIGN_BUTTON_HORIZONTAL,u);c.addEventListener("select",function(e){this.applyTextHorizontalAlign()},this),this.setPropStoreFieldValue("textHorizontalAlignButtonSet",c);var h=e.Render.TextAlign,u=[{value:h.DEFAULT,text:e.$L("ChemWidgetTexts.CAPTION_TEXT_ALIGN_DEFAULT"),className:o.COMPOSER_TEXTALIGN_BUTTON_DEFAULT},{value:h.LEADING,text:e.$L("ChemWidgetTexts.CAPTION_TEXT_ALIGN_LEADING"),className:o.COMPOSER_TEXTALIGN_BUTTON_LEADING},{value:h.TRAILING,text:e.$L("ChemWidgetTexts.CAPTION_TEXT_ALIGN_TRAILING"),className:o.COMPOSER_TEXTALIGN_BUTTON_TRAILING},{value:h.CENTER,text:e.$L("ChemWidgetTexts.CAPTION_TEXT_ALIGN_CENTER"),className:o.COMPOSER_TEXTALIGN_BUTTON_CENTER},{value:h.TOP,text:e.$L("ChemWidgetTexts.CAPTION_TEXT_ALIGN_TOP"),className:o.COMPOSER_TEXTALIGN_BUTTON_TOP},{value:h.BOTTOM,text:e.$L("ChemWidgetTexts.CAPTION_TEXT_ALIGN_BOTTOM"),className:o.COMPOSER_TEXTALIGN_BUTTON_BOTTOM}],c=this._createStyleButtonSet(e.$L("ChemWidgetTexts.CAPTION_TEXT_VERTICAL_ALIGN"),e.$L("ChemWidgetTexts.HINT_TEXT_VERTICAL_ALIGN"),o.COMPOSER_TEXTALIGN_BUTTON_VERTICAL,u);c.addEventListener("select",function(e){this.applyTextVerticalAlign()},this),this.setPropStoreFieldValue("textVerticalAlignButtonSet",c)}}this.updateStyleValues()},_createStyleButtonSet:function(t,r,i,n){var a=new e.Widget.CompactButtonSet(this);if(a.setText(t),a.setHint(r),a.addClassName(i),a.setShowText(!1),a.setShowCompactMark(!1),a.setButtonKind(e.Widget.Button.Kinds.DROPDOWN),a.getButtonSet().addClassName(o.COMPOSER_STYLE_TOOLBAR),a.getButtonSet().setShowText(!0),n)for(var s=0,l=n.length;s<l;++s){var d=n[s],u=new e.Widget.RadioButton(a,d.text||"");u.setHint(d.hint||""),u.addClassName(d.className),u[this.LINKED_VALUE_FIELD]=d.value,a.append(u,d.selected)}return a},_getButtonSetLinkedValue:function(e){var t=e?e.getSelected():null;return t?t[this.LINKED_VALUE_FIELD]:void 0},_setButtonSetLinkedValue:function(e,t){if(e){var r=e.getButtonSet(),i=r.getChildWidgets();e.setSelected(null);for(var n=0,a=i.length;n<a;++n){var o=i[n];if(o.hasOwnProperty(this.LINKED_VALUE_FIELD)&&o[this.LINKED_VALUE_FIELD]==t){e.setSelected(o);break}}}},getDefaultComponentNames:function(){return e.globalOptions.chemWidget.composer.styleToolComponentNames},recreateComponents:function(){var e=this.getComponentNames();this.clearWidgets(),this.createChildWidgets(e)},fillFontSizeBox:function(t){for(var r=this.getEditorConfigs().getStyleSetterConfigs().getListedFontSizes(),i=[{text:e.$L("ChemWidgetTexts.S_VALUE_DEFAULT"),value:void 0}],n=0,a=r.length;n<a;++n)i.push({text:r[n]+" px",value:r[n]});t.setItems(i)},fillFontNameBox:function(t){for(var r=this.getEditorConfigs().getStyleSetterConfigs().getListedFontNames(),i=[{text:e.$L("ChemWidgetTexts.S_VALUE_DEFAULT"),value:""}],n=0,a=r.length;n<a;++n)i.push({text:r[n],value:r[n]});t.setItems(i)},applyStyle:function(e,t,r){this._isApplying=!0;try{this.getEditor().modifyObjectsRenderOptions(e,t,r,!0)}finally{this._isApplying=!1}},getStyleValue:function(t,r,i){return e.Render.RenderOptionUtils.getCascadeRenderOptionValueOfObjs(t,r,i)},applyStyleToEditorSelection:function(e,t){var r=this.getEditor().getSelection();if(r&&r.length)return this.applyStyle(r,e,t)},applyFontName:function(e){if(e||(e=this.getEditor().getSelection()),e&&e.length){var t=this.getFontName();this.applyStyle(e,{fontFamily:t})}},applyFontSize:function(e){if(e||(e=this.getEditor().getSelection()),e&&e.length){var t=this.getFontSize();this.applyStyle(e,{fontSize:t})}},applyColor:function(t){if(t||(t=this.getEditor().getSelection()),t&&t.length){var r=this.getColor();r===this.ATOM_COLOR_SPECIAL_VALUE_INFO.value?this.applyStyle(t,{useAtomSpecifiedColor:!0,color:void 0}):(r==e.Widget.ColorPicker.SpecialColors.UNSET&&(r=void 0),this.applyStyle(t,{useAtomSpecifiedColor:!1,color:r}))}},applyTextDirection:function(e){if(e||(e=this.getEditor().getSelection()),e&&e.length){var t=this.getTextDirection();this.applyStyle(e,{charDirection:t})}},applyTextHorizontalAlign:function(e){if(e||(e=this.getEditor().getSelection()),e&&e.length){var t=this.getTextHorizontalAlign();this.applyStyle(e,{horizontalAlign:t})}},applyTextVerticalAlign:function(e){if(e||(e=this.getEditor().getSelection()),e&&e.length){var t=this.getTextVerticalAlign();this.applyStyle(e,{verticalAlign:t})}},updateStyleValues:function(e){e||(e=this.getEditor().getSelection()),e&&e.length&&(this.updateFontName(e),this.updateFontSize(e),this.updateColor(e),this.updateTextDirection(e),this.updateTextHorizontalAlign(e),this.updateTextVerticalAlign(e))},updateFontName:function(e){if(e&&e.length&&this.getFontNameBox()){var t=this.getStyleValue(e,"fontFamily");this.setFontName(t||"")}},updateFontSize:function(e){if(e&&e.length&&this.getFontSizeBox()){var t=this.getStyleValue(e,"fontSize");this.setFontSize(t||void 0)}},updateColor:function(e){if(e&&e.length&&this.getColorBox()){var t,r=this.getStyleValue(e,"useAtomSpecifiedColor"),t=this.getStyleValue(e,"color");this.getColorBox().setColorClassName(null),t?this.getColorBox().setColorClassName(null):r&&(t=this.ATOM_COLOR_SPECIAL_VALUE_INFO.value,this.getColorBox().setColorClassName(this.ATOM_COLOR_SPECIAL_VALUE_INFO.className)),this.setColor(t||void 0)}},updateTextDirection:function(e){if(e&&e.length&&this.getTextDirectionButtonSet()){var t=this.getStyleValue(e,"charDirection");this.setTextDirection(t)}},updateTextHorizontalAlign:function(e){if(e&&e.length&&this.getTextHorizontalAlignButtonSet()){var t=this.getStyleValue(e,"horizontalAlign");this.setTextHorizontalAlign(t)}},updateTextVerticalAlign:function(e){if(e&&e.length&&this.getTextVerticalAlignButtonSet()){var t=this.getStyleValue(e,"verticalAlign");this.setTextVerticalAlign(t)}},updateState:function(){var e=this.getEditor(),t=e&&e.hasSelection();this.getFontNameBox()&&this.getFontNameBox().setEnabled(t),this.getFontSizeBox()&&this.getFontSizeBox().setEnabled(t),this.getColorBox()&&this.getColorBox().setEnabled(t),this.getTextDirectionButtonSet()&&this.getTextDirectionButtonSet().setEnabled(t),this.getTextHorizontalAlignButtonSet()&&this.getTextHorizontalAlignButtonSet().setEnabled(t),this.getTextVerticalAlignButtonSet()&&this.getTextVerticalAlignButtonSet().setEnabled(t)}}),e.Editor.ComposerObjModifierToolbar=i.create(e.Widget.Toolbar,{CLASS_NAME:"Kekule.Editor.ComposerObjModifierToolbar",initialize:function($super,t){$super(t),this.setPropStoreFieldValue("modifiers",[]),this.setPropStoreFieldValue("modifierMap",new e.MapEx),this.setPropStoreFieldValue("composer",t),this.appendToWidget(t),t.addEventListener("selectionChange",function(e){this._isApplying||this.updateModifierValues()},this),t.addEventListener("selectedObjsUpdated",function(e){this._isApplying||(t.getEditor().isManipulatingObject()?this._suppressUpdateModifierValuesInManipulation=!0:this.updateModifierValues())},this),t.addEventListener("endManipulateObject",function(e){this._suppressUpdateModifierValuesInManipulation&&(this.updateModifierValues(),this._suppressUpdateModifierValuesInManipulation=!1)},this),this._isApplying=!1},initProperties:function(){this.defineProp("composer",{dataType:"Kekule.Editor.Composer",serializable:!1,setter:null}),this.defineProp("modifierMap",{dataType:a.OBJECT,serializable:!1,setter:null}),this.defineProp("modifiers",{dataType:a.ARRAY,serializable:!1,setter:null})},initPropValues:function($super){$super(),this.setShowGlyph(!0)},doFinalize:function($super){this.clearWidgets(),this.getModifierMap().finalize();for(var e=this.getModifiers(),t=0,r=e.length;t<r;++t)e[t].finalize();$super()},doGetWidgetClassName:function($super){return $super()+" "+o.COMPOSER_TOOLBAR+" "+o.COMPOSER_OBJMODIFIER_TOOLBAR},getEditor:function(){return this.getComposer().getEditor()},getEditorConfigs:function(){return this.getEditor().getEditorConfigs()},getAllowedModifierCategories:function(){var e=this.getComposer();return e&&e.getAllowedObjModifierCategories()},getTargetObjs:function(){return this.getEditor().getSelection()},getAvailableModifierClasses:function(){for(var r=[],i=this.getTargetObjs(),a=0,o=i.length;a<o;++a)i[a].getClass&&t.pushUnique(r,i[a].getClass());for(var s=[],l=this.getAllowedModifierCategories(),a=0,o=r.length;a<o;++a){var d=e.Editor.ObjModifierManager.getModifierClasses(r[a],l);d&&t.pushUnique(s,d)}return s.length&&s.sort(function(e,t){var r=e&&n.getPrototype(e),i=t&&n.getPrototype(t),a=r&&r.getModifierName&&r.getModifierName(),o=i&&i.getModifierName&&i.getModifierName();return a===o?0:a<o?-1:1}),s},getModifierInstanceOfClass:function(e,t){var r=this.getModifierMap(),i=r.get(e);return!i&&t&&(i=new e(this.getEditor()),r.set(e,i)),i},updateModifierWidgets:function(){var e=[];this.clearWidgets(!0);for(var t=this.getAvailableModifierClasses(),i=0,n=t.length;i<n;++i){var a=t[i],o=this.getModifierInstanceOfClass(a,!0),s=o.getWidget();s&&(this.appendWidget(s),e.push(o))}this.setPropStoreFieldValue("modifiers",e),this.updateModifierValues(),this._isAllModifierWidgetButtons(e)?this.removeClassName(r.TOOLBAR).addClassName(r.BUTTON_GROUP):this.removeClassName(r.BUTTON_GROUP).addClassName(r.TOOLBAR)},updateState:function(){this.updateModifierWidgets()},updateModifierValues:function(){for(var e=this.getModifiers(),t=0,r=e.length;t<r;++t)e[t].loadFromTargets()},_isAllModifierWidgetButtons:function(t){for(var r=0,i=t.length;r<i;++r){var n=t[r],a=n&&n.getWidget();if(a&&a.getDisplayed()&&!(a instanceof e.Widget.Button))return!1}return!0}}),e.Editor.Composer=i.create(e.ChemWidget.AbstractWidget,{CLASS_NAME:"Kekule.Editor.Composer",BINDABLE_TAG_NAMES:["div"],CHEM_TOOL_CHILD_FIELDS:"__$children__",initialize:function($super,t,r){this.updateSelectionAssocToolbarStateBind=this.updateSelectionAssocToolbarState.bind(this),this.setPropStoreFieldValue("enableStyleToolbar",!0),this.setPropStoreFieldValue("enableObjModifierToolbar",!0),this.setPropStoreFieldValue("editor",r),this.setPropStoreFieldValue("editorNexus",new e.Editor.EditorNexus),$super(t),this.bindEditor(r);var i=this.getEditor();i&&i.setChemObj(i.getChemObj()),this.getCommonBtnGroup()||this.createCommonToolbar(),this.getChemBtnGroup()||this.createChemToolbar(),this.getZoomBtnGroup()||this.createZoomToolbar(),this.uiLayoutChanged()},doFinalize:function($super){var e=this.getCommonBtnGroup();e&&e.finalize();var e=this.getChemBtnGroup();e&&e.finalize();var t=this.getPropStoreFieldValue("editor");t&&t.finalize(),this.getEditorNexus().finalize(),$super()},initProperties:function(){this.defineProp("editor",{dataType:"Kekule.Editor.BaseEditor",serializable:!1,setter:null,getter:function(){var e=this.getPropStoreFieldValue("editor");return e||(e=this.createDefaultEditor(),this.setPropStoreFieldValue("editor",e)),e}}),this.defineProp("showInspector",{dataType:a.BOOL,setter:function(e){this.getShowInspector()!==e&&(this.setPropStoreFieldValue("showInspector",e),this.showInspectorChanged())}}),this.defineProp("autoSetMinDimension",{dataType:a.BOOL}),this.defineProp("editorStageElem",{dataType:a.OBJECT,serializable:!1,setter:null}),this.defineProp("advPanelElem",{dataType:a.OBJECT,serializable:!1,setter:null}),this.defineProp("topRegionElem",{dataType:a.OBJECT,serializable:!1,setter:null}),this.defineProp("leftRegionElem",{dataType:a.OBJECT,serializable:!1,setter:null}),this.defineProp("bottomRegionElem",{dataType:a.OBJECT,serializable:!1,setter:null}),this.defineProp("editorNexus",{dataType:"Kekule.Editor.EditorNexus",serializable:!1,setter:null}),this.defineProp("objInspector",{dataType:"Kekule.Widget.ObjectInspector",serializable:!1,setter:null}),this.defineProp("structureTreeView",{dataType:"Kekule.ChemWidget.StructureTreeView",serializable:!1,setter:null}),this.defineProp("commonBtnGroup",{dataType:"Kekule.Widget.ButtonGroup",serializable:!1}),this.defineProp("zoomBtnGroup",{dataType:"Kekule.Widget.ButtonGroup",serializable:!1}),this.defineProp("chemBtnGroup",{dataType:"Kekule.Widget.ButtonGroup",serializable:!1}),this.defineProp("assocBtnGroup",{dataType:"Kekule.Widget.ButtonGroup",serializable:!1}),this.defineProp("styleToolbar",{dataType:"Kekule.Widget.Toolbar",serializable:!1,getter:function(){var e=this.getPropStoreFieldValue("styleToolbar");return e||this.getEnableStyleToolbar()&&(e=this.createStyleToolbar(),this.setPropStoreFieldValue("styleToolbar",e)),e}}),this.defineProp("styleToolComponentNames",{dataType:a.ARRAY,serializable:!1,getter:function(){var e=this.getStyleToolbar();return e?e.getComponentNames():null},setter:function(e){var t=this.getStyleToolbar();return t&&t.setComponentNames(e),this}}),this.defineProp("enableStyleToolbar",{dataType:a.BOOL,getter:function(){return this.getPropStoreFieldValue("enableStyleToolbar")&&!this.getEnableObjModifierToolbar()},setter:function(e){this.setPropStoreFieldValue("enableStyleToolbar",e),e&&this.setPropStoreFieldValue("enableObjModifierToolbar",!1),this.updateSelectionAssocToolbarState()}}),this.defineProp("objModifierToolbar",{dataType:"Kekule.Widget.Toolbar",serializable:!1,getter:function(){var e=this.getPropStoreFieldValue("objModifierToolbar");return e||this.getEnableObjModifierToolbar()&&(e=this.createObjModifierToolbar(),this.setPropStoreFieldValue("objModifierToolbar",e)),e}}),this.defineProp("enableObjModifierToolbar",{dataType:a.BOOL,setter:function(e){this.setPropStoreFieldValue("enableObjModifierToolbar",e),e&&this.setPropStoreFieldValue("enableStyleToolbar",!1),this.updateSelectionAssocToolbarState()}}),this.defineProp("allowedObjModifierCategories",{dataType:a.ARRAY,setter:function(e){this.setPropStoreFieldValue("allowedObjModifierCategories",e),this.updateObjModifierToolbarState()}}),this.defineProp("commonToolButtons",{dataType:a.HASH,serializable:!1,getter:function(){var e=this.getPropStoreFieldValue("commonToolButtons");return e||(e=this.getDefaultCommonToolBarButtons(),this.setPropStoreFieldValue("commonToolButtons",e)),e},setter:function(e){this.setPropStoreFieldValue("commonToolButtons",e),this.updateCommonToolbar(),this.updateZoomToolbar()}}),this.defineProp("chemToolButtons",{dataType:a.HASH,serializable:!1,getter:function(){var e=this.getPropStoreFieldValue("chemToolButtons");return e||(e=this.getDefaultChemToolBarButtons(),this.setPropStoreFieldValue("chemToolButtons",e)),e},setter:function(e){this.setPropStoreFieldValue("chemToolButtons",e),this.updateChemToolbar()}}),this.defineProp("styleBarComponents",{dataType:a.ARRAY,serializable:!1,getter:function(){var e=this.getPropStoreFieldValue("styleBarComponents");return e||(e=null,this.setPropStoreFieldValue("styleBarComponents",e)),e},setter:function(e){this.setPropStoreFieldValue("styleBarComponents",e),this.getStyleToolbar()&&this.getStyleToolbar().setComponentNames(e)}}),this.defineProp("commonActions",{dataType:"Kekule.ActionList",serializable:!1,setter:null,getter:function(){var t=this.getPropStoreFieldValue("commonActions");return t||(t=new e.ActionList,this.setPropStoreFieldValue("commonActions",t)),t}}),this.defineProp("zoomActions",{dataType:"Kekule.ActionList",serializable:!1,setter:null,getter:function(){var t=this.getPropStoreFieldValue("zoomActions");return t||(t=new e.ActionList,this.setPropStoreFieldValue("zoomActions",t)),t}}),this.defineProp("chemActions",{dataType:"Kekule.ActionList",serializable:!1,setter:null,getter:function(){var t=this.getPropStoreFieldValue("chemActions");return t||(t=new e.ActionList,this.setPropStoreFieldValue("chemActions",t)),t}}),this.defineProp("actionMap",{dataType:"Kekule.MapEx",serializable:!1,setter:null,getter:function(){var t=this.getPropStoreFieldValue("actionMap");return t||(t=new e.MapEx,this.setPropStoreFieldValue("actionMap",t)),t}}),this.defineProp("allowCreateNewChild",{dataType:a.BOOL,getter:function(){var e=this.getEditor();return e&&e.getAllowCreateNewChild?e.getAllowCreateNewChild():null},setter:function(e){var t=this.getEditor();return t.setAllowCreateNewChild&&t.setAllowCreateNewChild(e),this}}),this.defineProp("allowAppendDataToCurr",{dataType:a.BOOL,getter:function(){var e=this.getEditor();return e&&e.getAllowAppendDataToCurr?e.getAllowAppendDataToCurr():null},setter:function(e){var t=this.getEditor();return t.setAllowAppendDataToCurr&&t.setAllowAppendDataToCurr(e),this}}),this._defineEditorDelegatedProp("chemObj"),this._defineEditorDelegatedProp("chemObjLoaded"),this._defineEditorDelegatedProp("renderType"),this._defineEditorDelegatedProp("renderConfigs"),this._defineEditorDelegatedProp("drawOptions"),this._defineEditorDelegatedProp("allowCoordBorrow"),this._defineEditorDelegatedProp("editorConfigs"),this._defineEditorDelegatedProp("operHistory"),this._defineEditorDelegatedProp("enableOperHistory"),this._defineEditorDelegatedProp("selection"),this._defineEditorDelegatedProp("hotTrackedObjs"),this._defineEditorDelegatedProp("enableOperContext"),this._defineEditorDelegatedProp("enableCreateNewDoc"),this._defineEditorDelegatedProp("enableLoadNewFile"),this._defineEditorDelegatedProp("initOnNewDoc")},_defineEditorDelegatedProp:function(t,r){r||(r=t);var i=n.getPropInfo(e.Editor.BaseEditor,r),a=Object.create(i);return a.getter=null,a.setter=null,i.getter&&(a.getter=function(){return this.getEditor().getPropValue(r)}),i.setter&&(a.setter=function(e){this.getEditor().setPropValue(r,e),"chemObj"===r&&this.createChemToolbar()}),this.defineProp(t,a)},loadPredefinedResDataToProp:function(t,r,i){if("chemObj"===t)if(i)try{var n=e.IO.loadTypedData(r.data,r.resType,r.resUri);this.setChemObj(n)}catch(t){e.raise(t,e.ExceptionLevel.ERROR)}else e.throwException(e.$L("ErrorMsg.CANNOT_LOAD_RES_OF_URI")+r.resUri||"")},doCreateRootElement:function(e){return e.createElement("div")},doCreateSubElements:function(e,t){var r=[],i=this._doCreateSubElement(e,t,"div",o.COMPOSER_EDITOR_STAGE,"editorStageElem");return r.push(i),i=this._doCreateSubElement(e,t,"div",o.COMPOSER_ADV_PANEL,"advPanelElem"),r.push(i),r.push(this._doCreateSubElement(e,t,"div",o.COMPOSER_TOP_REGION,"topRegionElem")),r.push(this._doCreateSubElement(e,t,"div",o.COMPOSER_LEFT_REGION,"leftRegionElem")),r.push(this._doCreateSubElement(e,t,"div",o.COMPOSER_BOTTOM_REGION,"bottomRegionElem")),r},_doCreateSubElement:function(e,t,r,i,n){var a=e.createElement(r);return a.className=i,t&&t.appendChild(a),n&&this.setPropStoreFieldValue(n,a),a},doGetWidgetClassName:function($super){var e=$super()+" "+o.COMPOSER;return this._isUsingGridLayout()&&(e+=" "+o.COMPOSER_GRID_LAYOUT),e},_isUsingGridLayout:function(){return e.BrowserFeature.cssGrid},elementBound:function(e){this.setObserveElemResize(!0)},doWidgetShowStateChanged:function($super,e){$super(e),e&&this.adjustComponentPositions()},getResizerElement:function(){return this.getEditorStageElem()},getChildActionClass:function($super,e,t){var r=$super(e,t);return r||(r=this.getEditor().getChildActionClass(e,t)),r},getCoordMode:function(){return this.getEditor().getCoordMode()},isDirty:function(){return this.getEditor().isDirty()},newDoc:function(){return this.getEditor().newDoc()},load:function(e){return this.getEditor().load(e)},getSavingTargetObj:function(){var e=this.getEditor();return e?e.getSavingTargetObj():null},getExportableClasses:function(){return this.getEditor().getExportableClasses()},exportObj:function(e){return this.getEditor().exportObj(e)},exportObjs:function(e){return this.getEditor().exportObjs(e)},undo:function(){return this.getEditor().undo()},redo:function(){return this.getEditor().redo()},undoAll:function(){return this.getEditor().undoAll()},canUndo:function(){return this.getEditor().canUndo()},canRedo:function(){return this.getEditor().canRedo()},repaint:function(e){return this.getEditor().repaint(e),this},uiLayoutChanged:function(){this.adjustComponentPositions()},doResize:function($super){this.adjustComponentPositions()},adjustComponentPositions:function(){var t=this.getCommonBtnGroup()?this.getCommonBtnGroup().getElement():null,r=this.getZoomBtnGroup()?this.getZoomBtnGroup().getElement():null,i=this.getChemBtnGroup()?this.getChemBtnGroup().getElement():null;if(t&&i){if(t)var n=e.HtmlElementUtils.getElemPageRect(t);if(r)var a=e.HtmlElementUtils.getElemPageRect(r);if(i)var o=e.HtmlElementUtils.getElemPageRect(i);if(n.width&&o.width){var s=n.height,l=o.width,d=a&&a.height||s,u=!this._isUsingGridLayout(),c=this.getTopRegionElem(),h=this.getBottomRegionElem(),m=this.getLeftRegionElem(),g=e.HtmlElementUtils.getElemPageRect(h),f=g.width-(a?a.width:0),p=e.HtmlElementUtils.getElemPageRect(m),C=p.height-o.height;if(u){var b=c.style;b.top="0px",b.left=l+"px",b.right="0px",b.height=s+"px",b=h.style,b.bottom="0px",b.height=d+"px",b.left=l+"px",b.right="0px",b=m.style,b.left="0px",b.top=s+"px",b.bottom="0px",b.width=l+"px";var E,N=s,T=l,O=d;if(this.getShowInspector()){var _=this.getAdvPanelElem();E=e.HtmlElementUtils.getElemPageRect(_).width}else E=0;var S=this.getEditorStageElem(),b=S.style;b.position="absolute",b.top=N+"px",b.left=T+"px",b.bottom=O+"px",b.right=E+"px",_=this.getAdvPanelElem(),b=_.style,b.position="absolute",b.top=N+"px",b.bottom=O+"px"}if(C/f>.9?this.changeAssocToolbarRegion(!0):this.changeAssocToolbarRegion(!1),this.getAutoSetMinDimension()){var v={width:l+n.width,height:s+o.height};v.width&&v.height&&this.setMinDimension(v)}}}},adjustAssocToolbarPositions:function(){this.adjustStyleAndObjModifierToolbarPosition()},adjustStyleAndObjModifierToolbarPosition:function(){},bindEditor:function(e){e?e.setParent(this):e=this.getEditor(),e.setTouchAction("none");var t=this.getCommonActions();this.getChemActions();this.createIaControllers(e),e.addEventListener("load",function(e){this.updateAllActions(),this.updateUiWidgets();var t=this.getChemActions(),r=t.getActionAt(0);r&&r.execute()},this),e.addEventListener("operChange",function(e){t.updateAll(),this.updateUiWidgets()},this),e.addEventListener("selectionChange",function(e){t.updateAll(),this.updateUiWidgets()},this),e.appendToElem(this.getEditorStageElem()),this.getEditorNexus().setEditor(e)},createDefaultEditor:function(){var t,i=this.getEditorStageElem();i&&(t={x:i.clientWidth,y:i.offsetParent&&i.offsetParent.clientHeight||1e3});var n=new e.Editor.ChemSpaceEditor(this,null,e.Render.RendererType.R2D,null,t);return n.addClassName(r.DYN_CREATED),n},createIaControllers:function(t){for(var r=e.Editor.IaControllerManager.getAvailableControllerClasses(t.getClass()),i=0,n=r.length;i<n;++i){var a=r[i],o=new a(t);t.addIaController(o.getDefId(),o)}},showInspectorChanged:function(){this.getShowInspector()?(this.getObjInspector()||this.createAdvControls(),this.showAdvPanel()):this.hideAdvPanel(),this.uiLayoutChanged()},createAdvControls:function(t){t||(t=this.getAdvPanelElem());var r=this.getDocument(),i=new e.ChemWidget.StructureTreeView(r);i.setItemInitialExpanded(!0),i.appendToElem(t),this.setPropStoreFieldValue("structureTreeView",i);var n=new e.Widget.ObjectInspector(r);n.setShowPropInfoPanel(!1),n.appendToElem(t),this.setPropStoreFieldValue("objInspector",n);var a=this.getEditorNexus();a.setObjectInspector(n),a.setStructureTreeView(i)},showAdvPanel:function(){this.getAdvPanelElem().style.display="block"},hideAdvPanel:function(){this.getAdvPanelElem().style.display="none"},getDefaultCommonToolBarButtons:function(){return e.globalOptions.chemWidget.composer.commonToolButtons},getZoomButtonNames:function(){return[s.zoomIn,s.zoomOut,s.reset,s.resetZoom]},getDefaultChemToolBarButtons:function(){return e.globalOptions.chemWidget.composer.chemToolButtons},getCompActionClass:function(e){return this.getChildActionClass(e,!0)},_getActionTargetWidget:function(t){return n.isOrIsDescendantOf(t,e.Editor.ActionOnComposer)||n.isOrIsDescendantOf(t,e.Widget.ActionOpenConfigWidget)?this:this.getEditor()},createToolButton:function(t,r,i,n){var o=null,l=a.isObjectValue(t)?t.name:t,d=this.getCompActionClass(l),u=this._createToolButtonAction(t,i,n);if(a.isObjectValue(t)&&!d){var c,h=n?e.Widget.RadioButton:e.Widget.Button;c=Object.extend({widget:h},t),o=e.Widget.Utils.createFromHash(r,c)}else{var m=u.getPreferredWidgetClass&&u.getPreferredWidgetClass();o=new(m||(t===s.objInspector?e.Widget.CheckButton:n?e.Widget.RadioButton:e.Widget.Button))(r)}return u&&o.setAction(u),o},_createActionButton:function(t,r){var i=t.getCheckGroup(),n=t.getPreferredWidgetClass&&t.getPreferredWidgetClass(),a=n||(i?e.Widget.RadioButton:e.Widget.Button),o=new a(r);return o.setAction(t),o},_createToolButtonAction:function(t,r,i){var o,s=a.isObjectValue(t),o=null,l=s?t.name:t,d=s?t.attached:null,u=this.getCompActionClass(l);if(s&&!u){var c=t,u=c.actionClass;u&&"string"==typeof u&&(u=n.findClass(c.actionClass,void 0,e))}if(u){var h=this.getActionMap(),o=h.get(u);if(!o){var o=new u(this._getActionTargetWidget(u));s&&(t.text&&o.setText(t.text),t.hint&&o.setHint(t.hint),(t.htmlClass||t.htmlClassName)&&o.setHtmlClassName((o.getHtmlClassName()||"")+(t.htmlClass||t.htmlClassName))),h.set(u,o)}var m=i||"",g=o.getExplicitGroup&&o.getExplicitGroup();if(e.ObjUtils.notUnset(g)&&(m=g),m&&o.setCheckGroup(m),o&&r&&r.add(o),o&&o.addAttachedAction){var f=o.getClassName(),p=e.ArrayUtils.clone(o.getAttachedActions().getActions()||[]),C=function(t,r,i,n,a){if(!r)return null;var o=i.indexOf(r);o>=0?i[o]=null:t.addAttachedAction(r,n),e.ObjUtils.notUnset(a)&&t.setAttachedActionIndex(r,a)};if(d)for(var b=0,E=d.length;b<E;++b){var N=d[b],T=this._createToolButtonAction(N,null,f);C(o,T,p,0===b,b)}else{var O=o.getAttachedActionClasses();if(O)for(var b=0,E=O.length;b<E;++b){var _=O[b],T=h.get(_);if(!T){T=new _(this._getActionTargetWidget(_));var S=T.getExplicitGroup&&T.getExplicitGroup();e.ObjUtils.notUnset(S)?T.setCheckGroup(S):T.setCheckGroup(f),h.set(_,T)}C(o,T,p,0===b,b)}}if(p.length)for(var b=0,E=p.length;b<E;++b){var v=p[b];v&&(o.removeAttachedAction(v),h.remove(v.getClass()))}}}return o},createInnerToolbar:function(t,i){var n=new e.Widget.ButtonGroup(this);n.addClassName(o.COMPOSER_TOOLBAR),n.addClassName(o.INNER_TOOLBAR),n.addClassName(r.DYN_CREATED),n.setShowText(!1),n.doSetShowGlyph(!0);var a=t||this.getElement();if(i){var s=e.DomUtils.getFirstChildElem(a);s?n.insertToElem(a,s):n.appendToElem(a)}else n.appendToElem(a);return n},createCommonToolbar:function(){var t=this.getBottomRegionElem(),i=this.createInnerToolbar(t);i.addClassName(o.COMPOSER_COMMON_TOOLBAR);var n=this.getCommonToolButtons();n=e.ArrayUtils.exclude(n,this.getZoomButtonNames());var a=this.getCommonActions();this.getEditor();a.clear();for(var s=0,l=n.length;s<l;++s){var d=n[s];this.createToolButton(d,i,a)}return this.setCommonBtnGroup(i),i.addClassName(r.DYN_CREATED),this.updateZoomToolbar(),this.adjustComponentPositions(),i},createZoomToolbar:function(){var t=e.ArrayUtils.intersect(this.getCommonToolButtons(),this.getZoomButtonNames());if(t.length){var i=this.getBottomRegionElem(),n=this.createInnerToolbar(i);n.addClassName(o.COMPOSER_ZOOM_TOOLBAR);var a=this.getZoomActions();this.getEditor();a.clear();for(var s=0,l=t.length;s<l;++s){var d=t[s];this.createToolButton(d,n,a)}return this.setZoomBtnGroup(n),n.addClassName(r.DYN_CREATED),this.adjustComponentPositions(),n}return this.setZoomBtnGroup(null),null},updateCommonToolbar:function(){var e=this.getCommonBtnGroup();e&&e.finalize(),this.createCommonToolbar()},updateZoomToolbar:function(){var e=this.getZoomBtnGroup();e&&e.finalize(),this.createZoomToolbar()},createChemToolbar:function(){var t=this.getLeftRegionElem(),i=this.createInnerToolbar(t,!0);i.addClassName(o.COMPOSER_CHEM_TOOLBAR),i.setLayout(e.Widget.Layout.VERTICAL);var n=this.getChemToolButtons(),a=this.getChemActions();a.clear();for(var s,l=0,d=n.length;l<d;++l){var u=n[l],c=this.createToolButton(u,i,a,"chemTools");(0===l&&"btnSelect"!==c.getElement().id||"btnDraw"===c.getElement().id)&&(s=c)}if(this.setChemBtnGroup(i),i.addClassName(r.DYN_CREATED),this.adjustComponentPositions(),s){var h=s.getAction();if(h){h.setChecked(!0);var m=h.getAttachedActions&&h.getAttachedActions();this.bindAssocActions(m||null)}}return i},updateChemToolbar:function(){var e=this.getChemBtnGroup();e&&e.finalize(),this.createChemToolbar()},createAssocToolbar:function(){var e=this.getBottomRegionElem(),t=this.createInnerToolbar(e);return t.addClassName(o.COMPOSER_ASSOC_TOOLBAR),this.setAssocBtnGroup(t),this.adjustAssocToolbarPositions(),t.addClassName(r.DYN_CREATED),t},changeAssocToolbarRegion:function(t){var r=this.getAssocBtnGroup();r||(r=this.createAssocToolbar());var i;if(t)i=this.getLeftRegionElem(),r.getElement().parentNode!==i&&(r.setLayout(e.Widget.Layout.VERTICAL),r.appendToElem(i));else if(i=this.getBottomRegionElem(),r.getElement().parentNode!==i){r.setLayout(e.Widget.Layout.HORIZONTAL);var n=e.DomUtils.getFirstChildElem(i);i.insertBefore(r.getElement(),n)}},showAssocToolbar:function(){var e=this.getAssocBtnGroup();e||(e=this.createAssocToolbar());var t=this;return e.show(null,function(){t.uiLayoutChanged(),setTimeout(t.updateSelectionAssocToolbarStateBind,0)}),this},hideAssocToolbar:function(){var e=this.getAssocBtnGroup();if(e){var t=this;e.hide(null,function(){t.uiLayoutChanged(),setTimeout(t.updateSelectionAssocToolbarStateBind,0)})}return this},isAssocToolbarShown:function(){var e=this.getAssocBtnGroup();return e&&e.isShown()},bindAssocActions:function(e){var t=this.getAssocBtnGroup();if(t||(t=this.createAssocToolbar()),t.clearWidgets(),e)for(var r=0,i=e.getActionCount();r<i;++r){var n=e.getActionAt(r);this._createActionButton(n,t)}},createObjModifierToolbar:function(){if(this.getEnableObjModifierToolbar()){var t=new e.Editor.ComposerObjModifierToolbar(this);return t.appendToElem(this.getBottomRegionElem()),this.setObjModifierToolbar(t),this.adjustAssocToolbarPositions(),this.updateObjModifierToolbarState(),t}return null},showObjModifierToolbar:function(){if(this.getEnableObjModifierToolbar()){var e=this.getObjModifierToolbar();if(!e.isShown()){var t=this;e.show(null,function(){t.uiLayoutChanged()})}}return this},hideObjModifierToolbar:function(){var e=this.getPropStoreFieldValue("objModifierToolbar");if(e&&e.isShown()){var t=this;e.hide(null,function(){t.uiLayoutChanged()},null,{instantly:!0})}return this},isObjModifierToolbarShown:function(){var e=this.getPropStoreFieldValue("objModifierToolbar");return e&&e.isShown()},updateObjModifierToolbarState:function(){var e=!1;this.getEnableObjModifierToolbar()&&this.needShowSelectionAssocToolbar()&&(e=!0),e?(this.showObjModifierToolbar(),this.getObjModifierToolbar().updateState()):this.hideObjModifierToolbar()},createStyleToolbar:function(){if(this.getEnableStyleToolbar()){var t=new e.Editor.ComposerStyleToolbar(this);return t.setComponentNames(this.getStyleBarComponents()),t.appendToElem(this.getBottomRegionElem()),this.setStyleToolbar(t),this.adjustAssocToolbarPositions(),this.updateStyleToolbarState(),t}return null},showStyleToolbar:function(){if(this.getEnableStyleToolbar()){var e=this.getStyleToolbar();if(!e.isShown()){var t=this;e.show(null,function(){t.uiLayoutChanged()})}}return this},hideStyleToolbar:function(){var e=this.getPropStoreFieldValue("styleToolbar");if(e&&e.isShown()){var t=this;e.hide(null,function(){t.uiLayoutChanged()})}return this},isStyleToolbarShown:function(){var e=this.getPropStoreFieldValue("styleToolbar");return e&&e.isShown()},updateStyleToolbarState:function(){this.getEnableStyleToolbar()&&this.needShowSelectionAssocToolbar()?(this.showStyleToolbar(),this.getStyleToolbar().updateState()):this.hideStyleToolbar()},needShowSelectionAssocToolbar:function(){var e=this.getEditor();return e&&e.hasSelection()},updateSelectionAssocToolbarState:function(){this.adjustStyleAndObjModifierToolbarPosition(),this.updateStyleToolbarState(),this.updateObjModifierToolbarState()},updateAllActions:function(){this.getCommonActions().updateAll(),this.getZoomActions().updateAll(),this.getChemActions().updateAll()},updateUiWidgets:function(){this.updateStyleToolbarState(),this.updateObjModifierToolbarState()},createConfigurator:function($super){var e=$super();return e.addEventListener("configChange",function(e){this.getEditor().repaint()},this),e}}),e.Editor.Composer.getMinPreferredDimension=function(){return{width:630,height:350}},e.Editor.Composer.Settings=i.create(e.Widget.BaseWidget.Settings,{CLASS_NAME:"Kekule.Editor.Composer.Settings",initialize:function($super,e){$super(e)},initProperties:function(){this.defineDelegatedProps(["enableCreateNewDoc","enableLoadNewFile","initOnNewDoc","enableOperHistory","allowCreateNewChild","allowAppendDataToCurr","enableStyleToolbar","enableObjModifierToolbar"])}}),e.Editor.Composer.Configurator=i.create(e.Widget.Configurator,{CLASS_NAME:"Kekule.Editor.Composer.Configurator",TAB_BTN_DATA_FIELD:"__$data__",initialize:function($super,e){$super(e)},initPropValues:function($super){$super(),this.setLayout(e.Widget.Layout.HORIZONTAL)},getCategoryInfos:function($super){for(var e=$super(),t=this.getComposer(),r=t.getEditor(),n=[r.getDisplayerConfigs(),r.getRenderConfigs()],a=0,o=n.length;a<o;++a)for(var s=n[a],l=s.getPropListOfScopes([i.PropertyScope.PUBLISHED]),d=0,u=l.getLength();d<u;++d){var c=l.getPropInfoAt(d),h=s.getPropValue(c.name);h&&e.push({obj:h,name:c.name,title:c.title,description:c.description})}return e},getComposer:function(){return this.getWidget()},getEditor:function(){return this.getComposer().getEditor()}}),e._registerAfterLoadSysProc(function(){var t=e.Editor.ObjModifier.Category,r=e.ObjPropSettingManager;r.register("Kekule.Editor.Composer.fullFunc",{enableObjModifierToolbar:!0,enableOperHistory:!0,enableLoadNewFile:!0,enableCreateNewDoc:!0,allowCreateNewChild:!0,commonToolButtons:null,chemToolButtons:null,styleToolComponentNames:null,allowedObjModifierCategories:null}),r.register("Kekule.Editor.Composer.molOnly",{enableObjModifierToolbar:!0,enableOperHistor:!0,enableLoadNewFile:!0,enableCreateNewDoc:!0,allowCreateNewChild:!0,commonToolButtons:null,chemToolButtons:[s.manipulate,s.erase,s.molBond,s.molAtom,s.molRing,s.molCharge],styleToolComponentNames:null,allowedObjModifierCategories:[t.GENERAL,t.CHEM_STRUCTURE]}),r.register("Kekule.Editor.Composer.compact",{enableObjModifierToolbar:!0,commonToolButtons:[s.newDoc,s.loadData,s.saveData,s.undo,s.redo,s.zoomIn,s.zoomOut],chemToolButtons:null,styleToolComponentNames:null,allowedObjModifierCategories:null}),r.register("Kekule.Editor.Composer.singleObj",{allowCreateNewChild:!1})}),e.Editor.ComposerDialog=i.create(e.Widget.Dialog,{CLASS_NAME:"Kekule.Editor.ComposerDialog",initialize:function($super,t,r,i){$super(t,r,i||[e.Widget.DialogButtons.OK,e.Widget.DialogButtons.CANCEL])},initProperties:function(){this.defineProp("composer",{dataType:"Kekule.Editor.Composer",serializable:!1,setter:null}),this.defineProp("chemObj",{dataType:"Kekule.ChemObject",serializable:!1,getter:function(){var e=this.getComposer();return e&&e.getChemObj()},setter:function(e){var t=this.getComposer();t&&t.setChemObj(e)}})},initPropValues:function($super){$super()},doGetWidgetClassName:function($super){return $super()+" "+o.COMPOSER_DIALOG},doCreateClientContents:function($super,e){$super();var t=this.doCreateComposerWidget();this.setPropStoreFieldValue("composer",t),t.appendToElem(e)},getSavingTargetObj:function(){var e=this.getComposer();return e?e.getSavingTargetObj():null},doCreateComposerWidget:function(){var t=new e.Editor.Composer(this);return t.addClassName(r.DYN_CREATED),t.setResizable&&t.setResizable(!0),t.getEditor().addClassName(r.DYN_CREATED),t}}),e.Editor.ComposerFrame=i.create(e.ChemWidget.AbstractWidget,{CLASS_NAME:"Kekule.Editor.ComposerFrame",BINDABLE_TAG_NAMES:["iframe"],initialize:function($super,e){$super(e)},initProperties:function(){this.defineProp("composer",{dataType:"Kekule.Editor.Composer",scope:i.PropertyScope.PUBLIC,serializable:!1,setter:null}),this.defineProp("frameDocument",{dataType:a.OBJECT,scope:i.PropertyScope.PUBLIC,serializable:!1,setter:null,getter:function(){return this.getElement().contentDocument}}),this.defineProp("frameWindow",{dataType:a.OBJECT,scope:i.PropertyScope.PUBLIC,serializable:!1,setter:null,getter:function(){return e.DocumentUtils.getDefaultView(this.getFrameDocument())}})},initPropValues:function($super){$super(),this.setMinDimension({width:550,height:350}),this.setEnableDimensionTransform(!0)},doGetWidgetClassName:function($super){return $super()+" "+o.COMPOSER_FRAME},doCreateRootElement:function(e){return e.createElement("iframe")},doBindElement:function($super,e){($super(e),e.parentNode)||(this.setDisplayed(!1),e.ownerDocument.body.appendChild(e));this._createComposerWidgetInFrame()},_initFrame:function(){var e=this.getFrameDocument();e.open("text/htmlreplace"),e.write("<!DOCTYPE html><html><head></head><body></body></html>"),e.close()},_createComposerWidgetInFrame:function(t){this._initFrame();var r=this,i=this.getFrameDocument();i.documentElement.className=o.COMPOSER_FRAME_CONTENT_DOC,i.body.className=o.COMPOSER_FRAME_CONTENT_BODY,e.X.Event.addListener(i.body,"kekuleload",function(n){var a=new e.Editor.Composer(i);a.appendToElem(i.body),r.setPropStoreFieldValue("composer",a),t&&t(a)}),this._insertKekuleScriptAndStyleSheetFiles(i)},_insertKekuleScriptAndStyleSheetFiles:function(t,r){var i=(e.scriptSrcInfo,t.head),n=t.createElement("link");n.setAttribute("rel","stylesheet"),n.setAttribute("type","text/css"),n.setAttribute("href",e.getStyleSheetUrl()),i.appendChild(n),e.ScriptFileUtils.appendScriptFile(t,e.getScriptSrc(),r)}}),e}},function(e,t,r){"use strict";var i=r(0).Class,n=r(0).DataType;e.exports=function(e){var t=e.ArrayUtils,r=e.ChemWidget.ComponentWidgetNames,a=e.ChemWidget.HtmlClassNames,o=(e.ActionManager,[]);return e.ChemWidget.HtmlClassNames=Object.extend(e.ChemWidget.HtmlClassNames,{ACTION_UNDO:"K-Chem-Undo",ACTION_REDO:"K-Chem-Redo",ACTION_NEWDOC:"K-Chem-NewDoc",ACTION_CLONE_SELECTION:"K-Chem-Clone-Selection",ACTION_COPY:"K-Chem-Copy",ACTION_CUT:"K-Chem-Cut",ACTION_PASTE:"K-Chem-Paste",ACTION_TOGGLE_SELECT:"K-Chem-Toggle-Select-State",ACTION_TOGGLE_INSPECTOR:"K-Chem-Toggle-Inspector"}),Object.extend(e.ChemWidget.ComponentWidgetNames,{manipulateMarquee:"manipulateMarquee",manipulateLasso:"manipulateLasso",manipulateBrush:"manipulateBrush",manipulateAncestor:"manipulateAncestor",molBondSingle:"bondSingle",molBondDouble:"bondDouble",molBondTriple:"bondTriple",molBondCloser:"bondCloser",molBondWedgeUp:"bondWedgeUp",molBondWedgeDown:"bondWedgeDown",molBondWedgeUpOrDown:"bondWedgeUpOrDown",molBondDoubleEither:"bondDoubleEither",molChargeClear:"chargeClear",molChargePositive:"chargePositive",molChargeNegative:"chargeNegative",molRadicalSinglet:"radicalSinglet",molRadicalTriplet:"radicalTriplet",molRadicalDoublet:"radicalDoublet",molElectronLonePair:"electronLonePair",molElectronSingle:"electronSingle",molChain:"chain",molRing3:"ring3",molRing4:"ring4",molRing5:"ring5",molRing6:"ring6",molRing7:"ring7",molRing8:"ring8",molRingAr6:"ringAr6",molRingAr5:"ringAr5",molFlexRing:"flexRing",molRepCyclopentaneHaworth1:"repCyclopentaneHaworth1",molRepCyclopentaneHaworth2:"repCyclopentaneHaworth2",molRepCyclohexaneHaworth1:"repCyclohexaneHaworth1",molRepCyclohexaneHaworth2:"repCyclohexaneHaworth2",molRepCyclohexaneChair1:"repCyclohexaneChair1",molRepCyclohexaneChair2:"repCyclohexaneChair2",molRepSubBondMark:"subBondMark",molRepMethane:"methane",molRepFischer1:"repFischer1",molRepFischer2:"repFischer2",molRepFischer3:"repFischer3",molRepSawhorseStaggered:"repSawhorseStaggered",molRepSawhorseEclipsed:"repSawhorseEclipsed",glyphRepLine:"repLine",glyphRepOpenArrowLine:"repOpenArrowLine",glyphRepTriangleArrowLine:"repTriangleArrowLine",glyphRepDiOpenArrowLine:"repDiOpenArrowLine",glyphRepDiTriangleArrowLine:"repDiTriangleArrowLine",glyphRepReversibleArrowLine:"repReversibleArrowLine",glyphRepOpenArrowDiLine:"repOpenArrowDiLine",glyphRepOpenArrowArc:"repOpenArrowArc",glyphRepSingleSideOpenArrowArc:"repSingleSideOpenArrowArc",glyphRepHeatSymbol:"repHeatSymbol",glyphRepAddSymbol:"repAddSymbol",glyphElectronPushingArrow:"repElectronPushingArrow",glyphElectronPushingArrowDouble:"repElectronPushingArrowDouble",glyphElectronPushingArrowSingle:"repElectronPushingArrowSingle",glyphElectronPushingArrowBondForming:"repElectronPushingArrowBondForming",glyphRepSegment:"repGlyphSegment",glyphReactionArrowNormal:"repGlyphReactionArrowNormal",glyphReactionArrowReversible:"glyphReactionArrowReversible",glyphReactionArrowResonance:"glyphReactionArrowResonance",glyphReactionArrowRetrosynthesis:"glyphReactionArrowRetrosynthesis"}),e.Editor.ActionOperUtils={getObjsCenterScreenCoord:function(t,r){for(var i=e.BoxUtils,n=e.CoordUtils,a=null,o=0,s=r.length;o<s;++o){var l=e.Render.ObjUtils.getContainerBox(r[o],t.getCoordMode(),t.getAllowCoordBorrow());a=a?i.getContainerBox(l,a):l}var d=i.getMinMaxCoords(a),u={min:t.objCoordToScreen(d.min),max:t.objCoordToScreen(d.max)},c=n.add(u.min,u.max),c=n.divide(c,2);return c},addObjectsToChemSpaceEditor:function(r,i,n){var a=Object.extend({autoAdjustPosition:!0},n),o=r.getChemSpace&&r.getChemSpace();if(r&&o&&r.canAddNewStandaloneObject&&r.canAddNewStandaloneObject()){for(var s=[],l=0,d=i.length;l<d;++l){var u=function(r,i){var n=[],a=i;return a&&r&&(n=r.getClass()===a.getClass()||r instanceof e.ChemSpace?t.clone(r.getChildren()):[r]),n}(i[l],o);u&&u.length&&t.pushUnique(s,u)}r.beginManipulateAndUpdateObject();try{for(var c=new e.MacroOperation,l=0,d=s.length;l<d;++l){var h=s[l],m=new e.ChemObjOperation.Add(h,o,null,r);c.add(m)}c.execute();var g=a.screenCoordOffset;if(!g&&a.autoAdjustPosition){var f=r.getClientVisibleRect(),p={x:f.left+f.width/2,y:f.top+f.height/2},C=this.getObjsCenterScreenCoord(r,s);g=e.CoordUtils.substract(p,C)}if(g)for(var l=0,d=s.length;l<d;++l){var h=s[l],b=r.getObjectScreenCoord(h),E=e.CoordUtils.add(b,g);r.setObjectScreenCoord(h,E)}r.pushOperation(c),a.autoSelect&&r.select(s)}finally{r.endManipulateAndUpdateObject()}}}},e.Editor.ActionOnEditor=i.create(e.ChemWidget.ActionOnDisplayer,{CLASS_NAME:"Kekule.Editor.ActionOnEditor",initialize:function($super,e,t,r){$super(e,t,r)},initProperties:function(){this.defineProp("explicitGroup",{dataType:n.STRING})},getPreferredWidgetClass:function(){return null},doUpdate:function(){var e=this.getDisplayer();this.setEnabled(e&&e.getChemObj()&&e.getChemObjLoaded()&&e.getEnabled())},getEditor:function(){var t=this.getDisplayer();return t instanceof e.Editor.BaseEditor?t:null}}),e.Editor.ActionEditorUndo=i.create(e.Editor.ActionOnEditor,{CLASS_NAME:"Kekule.Editor.ActionEditorUndo",HTML_CLASSNAME:a.ACTION_UNDO,initialize:function($super,t){$super(t,e.$L("ChemWidgetTexts.CAPTION_UNDO"),e.$L("ChemWidgetTexts.HINT_UNDO"))},doUpdate:function($super){$super(),this.getEnabled()&&this.setEnabled(this.getEditor().getEnableOperHistory()&&this.getEditor().canUndo())},doExecute:function(){var e=this.getEditor();e&&e.undo()}}),e.Editor.ActionEditorRedo=i.create(e.Editor.ActionOnEditor,{CLASS_NAME:"Kekule.Editor.ActionEditorRedo",HTML_CLASSNAME:a.ACTION_REDO,initialize:function($super,t){$super(t,e.$L("ChemWidgetTexts.CAPTION_REDO"),e.$L("ChemWidgetTexts.HINT_REDO"))},doUpdate:function($super){$super(),this.getEnabled()&&this.setEnabled(this.getEditor().getEnableOperHistory()&&this.getEditor().canRedo())},doExecute:function(){var e=this.getEditor();e&&e.redo()}}),e.Editor.ActionEditorNewDoc=i.create(e.Editor.ActionOnEditor,{CLASS_NAME:"Kekule.Editor.ActionEditorNewDoc",HTML_CLASSNAME:a.ACTION_NEWDOC,initialize:function($super,t){$super(t,e.$L("ChemWidgetTexts.CAPTION_NEWDOC"),e.$L("ChemWidgetTexts.HINT_NEWDOC"))},doUpdate:function(){var e=this.getDisplayer();this.setEnabled(e&&e.getEnabled()&&e.getEnableCreateNewDoc())},doExecute:function(){var e=this.getEditor();e&&e.newDoc()}}),e.Editor.ActionEditorLoadData=i.create(e.ChemWidget.ActionDisplayerLoadData,{CLASS_NAME:"Kekule.Editor.ActionEditorLoadData",initialize:function($super,e){$super(e)},initProperties:function(){this.defineProp("enableAppend",{dataType:n.BOOL})},doExecute:function($super,e){var t=this.getDataDialog();return t&&t.setDisplayAppendCheckBox&&t.setDisplayAppendCheckBox(this._isEditorRootObjAppendable()&&!this._isEditorEmpty()),$super(e)},_getEditorRootObj:function(){return this.getDisplayer().getChemObj()},_isEditorRootObjAppendable:function(){var t=this.getDisplayer(),r=this._getEditorRootObj();return r&&r instanceof e.ChemSpace&&t.canAddNewStandaloneObject&&t.canAddNewStandaloneObject()&&t.getAllowAppendDataToCurr&&t.getAllowAppendDataToCurr()},_isEditorEmpty:function(){var e=this._getEditorRootObj();return!e||e.getChildCount&&0===e.getChildCount()},createDataDialog:function(){var t=this.getDisplayer().getDocument();return new e.ChemWidget.LoadOrAppendDataDialog(t)},doLoadToDisplayer:function($super,t,r){var i=this.getDisplayer();if(!r.getIsAppending()||this._isEditorEmpty()||!this._isEditorRootObjAppendable())return $super(t,r);i.beginUpdateObject();try{var n=this._getEditorRootObj();n.beginUpdate();try{e.Editor.ActionOperUtils.addObjectsToChemSpaceEditor(i,[t],{autoSelect:!0})}finally{n.endUpdate()}}finally{i.endUpdateObject()}}}),e.Editor.ActionCloneSelection=i.create(e.Editor.ActionOnEditor,{CLASS_NAME:"Kekule.Editor.ActionCloneSelection",HTML_CLASSNAME:a.ACTION_CLONE_SELECTION,initialize:function($super,t){$super(t,e.$L("ChemWidgetTexts.CAPTION_CLONE_SELECTION"),e.$L("ChemWidgetTexts.HINT_CLONE_SELECTION"))},_hasCloneMethod:function(){var e=this.getEditor();return e&&e.cloneSelection},doUpdate:function($super){$super(),this.getEnabled()&&this.setEnabled(this._hasCloneMethod()&&this.getEditor().hasSelection()),this.setDisplayed(this._hasCloneMethod()&&this.getEditor().canCloneObjects())},doExecute:function(){var t=this.getEditor();if(t&&t.getChemSpace){var r=t.getDefaultCloneScreenCoordOffset&&t.getDefaultCloneScreenCoordOffset(),i=t.cloneSelection();e.Editor.ActionOperUtils.addObjectsToChemSpaceEditor(t,i,{screenCoordOffset:r,autoSelect:!0})}}}),e.Editor.ActionCopySelection=i.create(e.Editor.ActionOnEditor,{CLASS_NAME:"Kekule.Editor.ActionCopySelection",HTML_CLASSNAME:a.ACTION_COPY,initialize:function($super,t){$super(t,e.$L("ChemWidgetTexts.CAPTION_COPY"),e.$L("ChemWidgetTexts.HINT_COPY"))},doUpdate:function($super){$super(),this.getEnabled()&&this.setEnabled(this.getEditor().hasSelection())},doExecute:function(){var t=this.getEditor(),r=t.getChemSpace&&t.getChemSpace();if(t&&r){var i=t.cloneSelection(),n=new e.IntermediateChemSpace;try{n.appendChildren(i),e.Widget.clipboard.setObjects(e.IO.MimeType.JSON,[n])}finally{n.finalize()}}}}),e.Editor.ActionCutSelection=i.create(e.Editor.ActionOnEditor,{CLASS_NAME:"Kekule.Editor.ActionCutSelection",HTML_CLASSNAME:a.ACTION_CUT,initialize:function($super,t){$super(t,e.$L("ChemWidgetTexts.CAPTION_CUT"),e.$L("ChemWidgetTexts.HINT_CUT"))},doUpdate:function($super){$super(),this.getEnabled()&&this.setEnabled(this.getEditor().hasSelection())},doExecute:function(){var t=this.getEditor(),r=t.getChemSpace&&t.getChemSpace();if(t&&r){var i=t.cloneSelection(),n=new e.IntermediateChemSpace;try{n.appendChildren(i),e.Widget.clipboard.setObjects(e.IO.MimeType.JSON,[n])}finally{n.finalize()}var a=t.getIaController("BasicMolEraserIaController");a&&a.removeSelection()}}}),e.Editor.ActionPaste=i.create(e.Editor.ActionOnEditor,{CLASS_NAME:"Kekule.Editor.ActionPaste",HTML_CLASSNAME:a.ACTION_PASTE,initialize:function($super,t){$super(t,e.$L("ChemWidgetTexts.CAPTION_PASTE"),e.$L("ChemWidgetTexts.HINT_PASTE")),e.Widget.clipboard.addEventListener("setData",this._reactClipboardChange,this)},finalize:function($super){e.Widget.clipboard.removeEventListener("setData",this._reactClipboardChange,this),$super()},_reactClipboardChange:function(){this.update()},doUpdate:function($super){$super(),this.getEnabled()&&this.setEnabled(e.Widget.clipboard.hasData(e.IO.MimeType.JSON)&&this.getEditor().canAddNewStandaloneObject())},getObjsCenterScreenCoord:function(t,r){return e.Editor.ActionOperUtils.getObjsCenterScreenCoord(t,r)},doExecute:function(){var r=this.getEditor();if(r&&r.getChemSpace){var i,n,a=e.Widget.clipboard.getObjects(e.IO.MimeType.JSON);1===a.length&&a[0]instanceof e.IntermediateChemSpace?(i=a[0],n=t.clone(i.getChildren()),i.removeChildren(n)):n=a,i&&i.finalize();var o=null,s=r.getSelection();if(s&&s.length){o=r.getDefaultCloneScreenCoordOffset?r.getDefaultCloneScreenCoordOffset():null;var l=t.clone(s);if(l&&l.length&&o){var d=this.getObjsCenterScreenCoord(r,l),u=this.getObjsCenterScreenCoord(r,n),c=e.CoordUtils.substract(d,u);o=e.CoordUtils.add(o,c)}}e.Editor.ActionOperUtils.addObjectsToChemSpaceEditor(r,n,{screenCoordOffset:o,autoSelect:!0})}}}),e.Editor.ActionToggleSelectState=i.create(e.Editor.ActionOnEditor,{CLASS_NAME:"Kekule.Editor.ActionToggleSelectState",HTML_CLASSNAME:a.ACTION_TOGGLE_SELECT,initialize:function($super,t){$super(t,e.$L("ChemWidgetTexts.CAPTION_TOGGLE_SELECT"),e.$L("ChemWidgetTexts.HINT_TOGGLE_SELECT")),this.setExplicitGroup("")},getPreferredWidgetClass:function(){return e.Widget.CheckButton},doUpdate:function($super){$super(),this.setChecked(this.getEditor().getIsToggleSelectOn())},checkedChanged:function($super){$super()},doExecute:function($super,e,t){$super(e,t);var r=this.getChecked();this.getEditor().setIsToggleSelectOn(!r),this.setChecked(!r)}}),e.Editor.ActionOnComposer=i.create(e.Action,{CLASS_NAME:"Kekule.Editor.ActionOnComposer",initialize:function($super,e,t,r){$super(),this.setText(t),this.setHint(r),this.setComposer(e)},initProperties:function(){this.defineProp("composer",{dataType:"Kekule.Editor.Composer",serializable:!1})},doUpdate:function(){var e=this.getComposer(),t=this.getEditor();this.setEnabled(e&&e.getEnabled()&&t&&t.getChemObj()&&t.getChemObjLoaded()&&t.getEnabled())},getEditor:function(){var e=this.getComposer();return e?e.getEditor():null}}),e.Editor.ActionOnComposerAdv=i.create(e.Editor.ActionOnComposer,{CLASS_NAME:"Kekule.Editor.ActionOnComposerAdv",initialize:function($super,t,r,i){var n=new e.ActionList;n.setOwnActions(!0),this.setPropStoreFieldValue("attachedActions",n),$super(t,r,i)},finalize:function($super){this.getAttachedActions().finalize(),$super()},initProperties:function(){this.defineProp("attachedActionClasses",{dataType:n.ARRAY,serializable:!1,setter:null}),this.defineProp("attachedActions",{dataType:"Kekule.ActionList",serializable:!1,setter:null}),this.defineProp("defaultAttachedAction",{dataType:"Kekule.Action",serializable:!1})},checkedChanged:function($super){$super();var e=this.getChecked();if(this.hasAttachedActions()){var t=this.getComposer();if(t)if(e){var r=this.getAttachedActions();t.bindAssocActions(r),t.showAssocToolbar();var i=r.getCheckedAction(this.getClassName());i||(i=this.getDefaultAttachedAction()),i&&(i.setChecked(!1),i.execute())}else t.hideAssocToolbar()}},hasAttachedActions:function(){return!!this.getAttachedActions().getActionCount()},setAttachedActionIndex:function(e,t){var r=this.getAttachedActions();return r&&r.setActionIndex(e,t),this},addAttachedAction:function(e,t){return this.getAttachedActions().add(e),t&&this.setDefaultAttachedAction(e),this},removeAttachedAction:function(e){return this.getDefaultAttachedAction()===e&&this.setDefaultAttachedAction(null),this.getAttachedActions().remove(e),this},clearAttachedActions:function(){this.setDefaultAttachedAction(null),this.getAttachedActions().clear()},doExecute:function(){},update:function($super){$super(),this.getAttachedActions().updateAll()}}),e.Editor.ActionComposerToggleInspector=i.create(e.Editor.ActionOnComposer,{CLASS_NAME:"Kekule.Editor.ActionComposerToggleInspector",HTML_CLASSNAME:a.ACTION_TOGGLE_INSPECTOR,initialize:function($super,t){$super(t,e.$L("ChemWidgetTexts.CAPTION_TOGGLE_INSPECTOR"),e.$L("ChemWidgetTexts.HINT_TOGGLE_INSPECTOR"))},doUpdate:function(){var e=this.getComposer();e&&this.setChecked(e.getShowInspector())},doExecute:function(){var e=this.getComposer();e&&(this.setChecked(!this.getChecked()),e.setShowInspector(this.getChecked()))}}),e.Editor.ActionComposerSetIaController=i.create(e.Editor.ActionOnComposerAdv,{CLASS_NAME:"Kekule.Editor.ActionComposerSetIaController",initialize:function($super,e,t,r,i){$super(e,t,r),this.setPropStoreFieldValue("iaControllerId",i)},initProperties:function(){this.defineProp("iaControllerId",{dataType:n.STRING,serializable:!1,setter:null})},doExecute:function(){this.getEditor().setActiveIaControllerId(this.getIaControllerId())}}),e.Editor.createComposerIaControllerActionClass=function(t,r,n,a,s,l,d,u,c,h){s||(s=a),s.startsWith(e.ChemWidget.HtmlClassNames.PREFIX)||(s=e.ChemWidget.HtmlClassNames.PREFIX+s);var m={CLASS_NAME:t,HTML_CLASSNAME:s,initialize:function($super,e){$super(e,r,n,a),this.initAttachedActions&&this.initAttachedActions()}};if(u&&(m=Object.extend(m,u)),l){var g;m.doExecute&&(g=m.doExecute),m.doExecute=function($super){var e=this.getEditor(),t=e.getIaController(a);t&&t.setPropValues(l),g?g.apply(this,[$super]):$super()}}d&&(m.initAttachedActions=function(){this.setPropStoreFieldValue("attachedActionClasses",d)});var f=i.create(e.Editor.ActionComposerSetIaController,m);return c&&o.push({name:c,actionClass:f,widgetClass:h}),f},e.Editor.ActionComposerClientDragScrollController=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerClientDragScrollController",e.$L("ChemWidgetTexts.CAPTION_CLIENT_DRAGSCROLL"),e.$L("ChemWidgetTexts.HINT_CLIENT_DRAGSCROLL"),"ClientDragScrollIaController",null,null,null,null,r.dragScroll),e.Editor.ActionComposerSetManipulateControllerMarquee=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetManipulateControllerMarquee",e.$L("ChemWidgetTexts.CAPTION_MANIPULATE_MARQUEE"),e.$L("ChemWidgetTexts.HINT_MANIPULATE_MARQUEE"),"SelectIaController","SelectIaController-Marquee",{enableGestureManipulation:!0,selectMode:e.Editor.SelectMode.RECT},null,{doExecute:function($super){$super(),this.getEditor().setSelectMode(e.Editor.SelectMode.RECT)}},r.manipulateMarquee),e.Editor.ActionComposerSetManipulateControllerLasso=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetManipulateControllerLasso",e.$L("ChemWidgetTexts.CAPTION_MANIPULATE_LASSO"),e.$L("ChemWidgetTexts.HINT_MANIPULATE_LASSO"),"SelectIaController","SelectIaController-Lasso",{enableGestureManipulation:!0,selectMode:e.Editor.SelectMode.POLYGON},null,{doExecute:function($super){$super(),this.getEditor().setSelectMode(e.Editor.SelectMode.POLYGON)}},r.manipulateLasso),e.Editor.ActionComposerSetManipulateControllerBrush=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetManipulateControllerBrush",e.$L("ChemWidgetTexts.CAPTION_MANIPULATE_BRUSH"),e.$L("ChemWidgetTexts.HINT_MANIPULATE_BRUSH"),"SelectIaController","SelectIaController-Brush",{enableGestureManipulation:!0,selectMode:e.Editor.SelectMode.POLYLINE},null,{doExecute:function($super){$super(),this.getEditor().setSelectMode(e.Editor.SelectMode.POLYLINE)}},r.manipulateBrush),e.Editor.ActionComposerSetManipulateControllerAncestor=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetManipulateControllerAncestor",e.$L("ChemWidgetTexts.CAPTION_MANIPULATE_ANCESTOR"),e.$L("ChemWidgetTexts.HINT_MANIPULATE_ANCESTOR"),"SelectIaController","SelectIaController-Ancestor",{enableGestureManipulation:!0,selectMode:e.Editor.SelectMode.ANCESTOR},null,{doExecute:function($super){$super(),this.getEditor().setSelectMode(e.Editor.SelectMode.ANCESTOR)}},r.manipulateAncestor),e.Editor.ActionComposerSetManipulateController=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetManipulateController",e.$L("ChemWidgetTexts.CAPTION_MANIPULATE"),e.$L("ChemWidgetTexts.HINT_MANIPULATE"),"SelectIaController",null,null,[e.Editor.ActionComposerSetManipulateControllerMarquee,e.Editor.ActionComposerSetManipulateControllerLasso,e.Editor.ActionComposerSetManipulateControllerBrush,e.Editor.ActionComposerSetManipulateControllerAncestor,e.Editor.ActionComposerClientDragScrollController,e.Editor.ActionToggleSelectState],null,r.manipulate),e.Editor.ActionComposerSetEraserController=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetEraserController",e.$L("ChemWidgetTexts.CAPTION_ERASE"),e.$L("ChemWidgetTexts.HINT_ERASE"),"BasicMolEraserIaController",null,null,null,{doExecute:function($super){$super();var e=this.getEditor();e.hasSelection()&&e.getActiveIaController().removeSelection()}},r.erase),e.Editor.ActionComposerSetTrackController=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetTrackController",e.$L("ChemWidgetTexts.CAPTION_TRACK_INPUT"),e.$L("ChemWidgetTexts.HINT_TRACK_INPUT"),"TrackInputIaController",null,null,null,null,r.trackInput),e.Editor.ActionComposerSetBondControllerSingle=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetBondControllerSingle",e.$L("ChemWidgetTexts.CAPTION_MOL_BOND_SINGLE"),e.$L("ChemWidgetTexts.HINT_MOL_BOND_SINGLE"),"MolBondIaController","MolBondIaController-Single",{bondType:e.BondType.COVALENT,bondOrder:e.BondOrder.SINGLE,bondStereo:e.BondStereo.NONE},null,null,r.molBondSingle),e.Editor.ActionComposerSetBondControllerDouble=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetBondControllerDouble",e.$L("ChemWidgetTexts.CAPTION_MOL_BOND_DOUBLE"),e.$L("ChemWidgetTexts.HINT_MOL_BOND_DOUBLE"),"MolBondIaController","MolBondIaController-Double",{bondType:e.BondType.COVALENT,bondOrder:e.BondOrder.DOUBLE,bondStereo:e.BondStereo.NONE},null,null,r.molBondDouble),e.Editor.ActionComposerSetBondControllerTriple=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetBondControllerTriple",e.$L("ChemWidgetTexts.CAPTION_MOL_BOND_TRIPLE"),e.$L("ChemWidgetTexts.HINT_MOL_BOND_TRIPLE"),"MolBondIaController","MolBondIaController-Triple",{bondType:e.BondType.COVALENT,bondOrder:e.BondOrder.TRIPLE,bondStereo:e.BondStereo.NONE},null,null,r.molBondTriple),e.Editor.ActionComposerSetBondControllerCloser=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetBondControllerCloser",e.$L("ChemWidgetTexts.CAPTION_MOL_BOND_CLOSER"),e.$L("ChemWidgetTexts.HINT_MOL_BOND_CLOSER"),"MolBondIaController","MolBondIaController-Closer",{bondType:e.BondType.COVALENT,bondOrder:e.BondOrder.SINGLE,bondStereo:e.BondStereo.CLOSER},null,null,r.molBondCloser),e.Editor.ActionComposerSetBondControllerWedgeUp=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetBondControllerWedgeUp",e.$L("ChemWidgetTexts.CAPTION_MOL_BOND_WEDGEUP"),e.$L("ChemWidgetTexts.HINT_MOL_BOND_WEDGEUP"),"MolBondIaController","MolBondIaController-WedgeUp",{bondType:e.BondType.COVALENT,bondOrder:e.BondOrder.SINGLE,bondStereo:e.BondStereo.UP},null,null,r.molBondWedgeUp),e.Editor.ActionComposerSetBondControllerWedgeDown=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetBondControllerWedgeDown",e.$L("ChemWidgetTexts.CAPTION_MOL_BOND_WEDGEDOWN"),e.$L("ChemWidgetTexts.HINT_MOL_BOND_WEDGEDOWN"),"MolBondIaController","MolBondIaController-WedgeDown",{bondType:e.BondType.COVALENT,bondOrder:e.BondOrder.SINGLE,bondStereo:e.BondStereo.DOWN},null,null,r.molBondWedgeDown),e.Editor.ActionComposerSetBondControllerWedgeUpOrDown=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetBondControllerWedgeUpOrDown",e.$L("ChemWidgetTexts.CAPTION_MOL_BOND_WAVY"),e.$L("ChemWidgetTexts.HINT_MOL_BOND_WAVY"),"MolBondIaController","MolBondIaController-WedgeUpOrDown",{bondType:e.BondType.COVALENT,bondOrder:e.BondOrder.SINGLE,bondStereo:e.BondStereo.UP_OR_DOWN},null,null,r.molBondWedgeUpOrDown),e.Editor.ActionComposerSetBondControllerDoubleEither=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetBondControllerDoubleEither",e.$L("ChemWidgetTexts.CAPTION_MOL_BOND_DOUBLE_EITHER"),e.$L("ChemWidgetTexts.HINT_MOL_BOND_DOUBLE_EITHER"),"MolBondIaController","MolBondIaController-Double-Either",{bondType:e.BondType.COVALENT,bondOrder:e.BondOrder.DOUBLE,bondStereo:e.BondStereo.E_OR_Z},null,null,r.molBondDoubleEither),e.Editor.ActionComposerSetRepositoryFischer1Controller=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryFischer1Controller",e.$L("ChemWidgetTexts.CAPTION_REPOSITORY_FISCHER1"),e.$L("ChemWidgetTexts.HINT_REPOSITORY_FISCHER1"),"RepositoryStructureFragmentIaController","RepositoryStructureFragmentIaController-Fischer1",{repItemName:"fischer1"},null,null,r.molRepFischer1),e.Editor.ActionComposerSetRepositoryFischer2Controller=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryFischer2Controller",e.$L("ChemWidgetTexts.CAPTION_REPOSITORY_FISCHER2"),e.$L("ChemWidgetTexts.HINT_REPOSITORY_FISCHER2"),"RepositoryStructureFragmentIaController","RepositoryStructureFragmentIaController-Fischer2",{repItemName:"fischer2"},null,null,r.molRepFischer2),e.Editor.ActionComposerSetRepositoryFischer3Controller=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryFischer3Controller",e.$L("ChemWidgetTexts.CAPTION_REPOSITORY_FISCHER3"),e.$L("ChemWidgetTexts.HINT_REPOSITORY_FISCHER3"),"RepositoryStructureFragmentIaController","RepositoryStructureFragmentIaController-Fischer3",{repItemName:"fischer3"},null,null,r.molRepFischer3),e.Editor.ActionComposerSetRepositorySawhorseStaggeredController=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositorySawhorseStaggeredController",e.$L("ChemWidgetTexts.CAPTION_REPOSITORY_SAWHORSE_STAGGERED"),e.$L("ChemWidgetTexts.HINT_REPOSITORY_SAWHORSE_STAGGERED"),"RepositoryStructureFragmentIaController","RepositoryStructureFragmentIaController-SawhorseStaggered",{repItemName:"sawhorseStaggered"},null,null,r.molRepSawhorseStaggered),e.Editor.ActionComposerSetRepositorySawhorseEclipsedController=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositorySawhorseEclipsedController",e.$L("ChemWidgetTexts.CAPTION_REPOSITORY_SAWHORSE_ECLIPSED"),e.$L("ChemWidgetTexts.HINT_REPOSITORY_SAWHORSE_ECLIPSED"),"RepositoryStructureFragmentIaController","RepositoryStructureFragmentIaController-SawhorseEclipsed",{repItemName:"sawhorseEclipsed"},null,null,r.molRepSawhorseEclipsed),e.Editor.ActionComposerSetRepositoryMethaneController=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryMethaneController",e.$L("ChemWidgetTexts.CAPTION_REPOSITORY_METHANE"),e.$L("ChemWidgetTexts.HINT_REPOSITORY_METHANE"),"RepositoryStructureFragmentIaController","RepositoryStructureFragmentIaController-Methane",{repItemName:"methane"},null,null,r.molRepMethane),e.Editor.ActionComposerSetRepositorySubBondMarkController=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositorySubBondMarkController",e.$L("ChemWidgetTexts.CAPTION_REPOSITORY_SUBBOND_MARK"),e.$L("ChemWidgetTexts.HINT_REPOSITORY_SUBBOND_MARK"),"RepositoryStructureFragmentIaController","RepositoryStructureFragmentIaController-SubBondMark",{repItemName:"substituentMark"},null,null,r.molRepSubBondMark),e.Editor.ActionComposerSetRepositoryMolFlexChainController=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryMolFlexChainController",e.$L("ChemWidgetTexts.CAPTION_MOL_FLEXCHAIN"),e.$L("ChemWidgetTexts.HINT_MOL_FLEXCHAIN"),"MolFlexChainIaController","MolFlexChainIaController",null,null,null,r.molChain),e.Editor.ActionComposerSetBondController=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetBondController",e.$L("ChemWidgetTexts.CAPTION_MOL_BOND"),e.$L("ChemWidgetTexts.HINT_MOL_BOND"),"MolBondIaController",null,null,[e.Editor.ActionComposerSetBondControllerSingle,e.Editor.ActionComposerSetBondControllerDouble,e.Editor.ActionComposerSetBondControllerTriple,e.Editor.ActionComposerSetBondControllerWedgeUp,e.Editor.ActionComposerSetBondControllerWedgeDown,e.Editor.ActionComposerSetRepositoryMolFlexChainController,e.Editor.ActionComposerSetTrackController,e.Editor.ActionComposerSetRepositoryFischer1Controller,e.Editor.ActionComposerSetRepositorySawhorseStaggeredController,e.Editor.ActionComposerSetRepositorySawhorseEclipsedController],null,r.molBond),e.Editor.ActionComposerSetAtomController=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetAtomController",e.$L("ChemWidgetTexts.CAPTION_MOL_ATOM"),e.$L("ChemWidgetTexts.HINT_MOL_ATOM"),"MolAtomIaController",null,null,null,null,r.molAtom),e.Editor.ActionComposerSetFormulaController=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetFormulaController",e.$L("ChemWidgetTexts.CAPTION_MOL_FORMULA"),e.$L("ChemWidgetTexts.HINT_MOL_FORMULA"),"FormulaIaController",null,null,null,null,r.molFormula),e.Editor.ActionComposerSetAtomAndFormulaController=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetAtomAndFormulaController",e.$L("ChemWidgetTexts.CAPTION_MOL_ATOM_AND_FORMULA"),e.$L("ChemWidgetTexts.HINT_MOL_ATOM_AND_FORMULA"),"MolAtomIaController",null,null,[e.Editor.ActionComposerSetAtomController,e.Editor.ActionComposerSetRepositoryMethaneController,e.Editor.ActionComposerSetFormulaController],null,r.molAtomAndFormula),e.Editor.ActionComposerSetAttachedMarkerIaControllerLonePair=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetAttachedMarkerIaControllerLonePair",e.$L("ChemWidgetTexts.CAPTION_MOL_ELECTRON_LONEPAIR"),e.$L("ChemWidgetTexts.HINT_MOL_ELECTRON_LONEPAIR"),"AttachedMarkerIaController","AttachedMarkerIaController-LonePair",{markerClassName:"Kekule.ChemMarker.UnbondedElectronSet",targetClassName:"Kekule.AbstractAtom",initialPropValues:{electronCount:2}},null,null,r.molElectronLonePair),e.Editor.ActionComposerSetAttachedMarkerIaControllerSingle=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetAttachedMarkerIaControllerSingleElectron",e.$L("ChemWidgetTexts.CAPTION_MOL_ELECTRON_SINGLE"),e.$L("ChemWidgetTexts.HINT_MOL_ELECTRON_SINGLE"),"AttachedMarkerIaController","AttachedMarkerIaController-SingleElectron",{markerClassName:"Kekule.ChemMarker.UnbondedElectronSet",targetClassName:"Kekule.AbstractAtom",initialPropValues:{electronCount:1}},null,null,r.molElectronSingle),e.Editor.ActionComposerSetNodeChargeControllerClear=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetNodeChargeControllerClear",e.$L("ChemWidgetTexts.CAPTION_MOL_CHARGE_CLEAR"),e.$L("ChemWidgetTexts.HINT_MOL_CHARGE_CLEAR"),"MolNodeChargeIaController","MolNodeChargeIaController-Clear",{charge:0,chargeInc:0,radical:e.RadicalOrder.NONE},null,null,r.molChargeClear),e.Editor.ActionComposerSetNodeChargeControllerPositive=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetNodeChargeControllerPositive",e.$L("ChemWidgetTexts.CAPTION_MOL_CHARGE_POSITIVE"),e.$L("ChemWidgetTexts.HINT_MOL_CHARGE_POSITIVE"),"MolNodeChargeIaController","MolNodeChargeIaController-Positive",{charge:null,chargeInc:1,radical:e.RadicalOrder.NONE},null,null,r.molChargePositive),e.Editor.ActionComposerSetNodeChargeControllerNegative=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetNodeChargeControllerNegative",e.$L("ChemWidgetTexts.CAPTION_MOL_CHARGE_NEGATIVE"),e.$L("ChemWidgetTexts.HINT_MOL_CHARGE_NEGATIVE"),"MolNodeChargeIaController","MolNodeChargeIaController-Negative",{charge:null,chargeInc:-1,radical:e.RadicalOrder.NONE},null,null,r.molChargeNegative),e.Editor.ActionComposerSetNodeChargeControllerRadicalSinglet=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetNodeChargeControllerRadicalSinglet",e.$L("ChemWidgetTexts.CAPTION_MOL_CHARGE_SINGLET"),e.$L("ChemWidgetTexts.HINT_MOL_CHARGE_SINGLET"),"MolNodeChargeIaController","MolNodeChargeIaController-Singlet",{charge:null,chargeInc:0,radical:e.RadicalOrder.SINGLET},null,null,r.molRadicalSinglet),e.Editor.ActionComposerSetNodeChargeControllerRadicalTriplet=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetNodeChargeControllerRadicalTriplet",e.$L("ChemWidgetTexts.CAPTION_MOL_CHARGE_TRIPLET"),e.$L("ChemWidgetTexts.HINT_MOL_CHARGE_TRIPLET"),"MolNodeChargeIaController","MolNodeChargeIaController-Triplet",{charge:null,chargeInc:0,radical:e.RadicalOrder.TRIPLET},null,null,r.molRadicalTriplet),e.Editor.ActionComposerSetNodeChargeControllerRadicalDoublet=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetNodeChargeControllerRadicalDoublet",e.$L("ChemWidgetTexts.CAPTION_MOL_CHARGE_DOUBLET"),e.$L("ChemWidgetTexts.HINT_MOL_CHARGE_DOUBLET"),"MolNodeChargeIaController","MolNodeChargeIaController-Doublet",{charge:null,chargeInc:0,radical:e.RadicalOrder.DOUBLET},null,null,r.molRadicalDoublet),e.Editor.ActionComposerSetNodeChargeController=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetNodeChargeController",e.$L("ChemWidgetTexts.CAPTION_MOL_CHARGE"),e.$L("ChemWidgetTexts.HINT_MOL_CHARGE"),"MolNodeChargeIaController",null,null,[e.Editor.ActionComposerSetNodeChargeControllerClear,e.Editor.ActionComposerSetNodeChargeControllerPositive,e.Editor.ActionComposerSetNodeChargeControllerNegative,e.Editor.ActionComposerSetNodeChargeControllerRadicalSinglet,e.Editor.ActionComposerSetNodeChargeControllerRadicalTriplet,e.Editor.ActionComposerSetNodeChargeControllerRadicalDoublet,e.Editor.ActionComposerSetAttachedMarkerIaControllerLonePair,e.Editor.ActionComposerSetAttachedMarkerIaControllerSingle],null,r.molCharge),e.Editor.ActionComposerSetTextBlockController=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetTextBlockController",e.$L("ChemWidgetTexts.CAPTION_TEXT_BLOCK"),e.$L("ChemWidgetTexts.HINT_TEXT_BLOCK"),"TextBlockIaController",null,null,null,null,r.textBlock),e.Editor.ActionComposerSetImageBlockController=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetImageBlockController",e.$L("ChemWidgetTexts.CAPTION_IMAGE_BLOCK"),e.$L("ChemWidgetTexts.HINT_IMAGE_BLOCK"),"ImageBlockIaController",null,null,null,null,r.imageBlock),e.Editor.ActionComposerSetTextImageController=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetTextImageController",e.$L("ChemWidgetTexts.CAPTION_TEXT_IMAGE"),e.$L("ChemWidgetTexts.HINT_TEXT_IMAGE"),"TextImageIaController","TextImageIaController",null,[e.Editor.ActionComposerSetTextBlockController,e.Editor.ActionComposerSetImageBlockController],null,r.textImage),e.Editor.ActionComposerSetRepositoryRing3Controller=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryRing3Controller",e.$L("ChemWidgetTexts.CAPTION_REPOSITORY_RING_3"),e.$L("ChemWidgetTexts.HINT_REPOSITORY_RING_3"),"MolRingIaController","MolRingIaController-3",{ringAtomCount:3,isAromatic:!1},null,null,r.molRing3),e.Editor.ActionComposerSetRepositoryRing4Controller=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryRing4Controller",e.$L("ChemWidgetTexts.CAPTION_REPOSITORY_RING_4"),e.$L("ChemWidgetTexts.HINT_REPOSITORY_RING_4"),"MolRingIaController","MolRingIaController-4",{ringAtomCount:4,isAromatic:!1},null,null,r.molRing4),e.Editor.ActionComposerSetRepositoryRing5Controller=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryRing5Controller",e.$L("ChemWidgetTexts.CAPTION_REPOSITORY_RING_5"),e.$L("ChemWidgetTexts.HINT_REPOSITORY_RING_5"),"MolRingIaController","MolRingIaController-5",{ringAtomCount:5,isAromatic:!1},null,null,r.molRing5),e.Editor.ActionComposerSetRepositoryRing6Controller=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryRing6Controller",e.$L("ChemWidgetTexts.CAPTION_REPOSITORY_RING_6"),e.$L("ChemWidgetTexts.HINT_REPOSITORY_RING_6"),"MolRingIaController","MolRingIaController-6",{ringAtomCount:6,isAromatic:!1},null,null,r.molRing6),e.Editor.ActionComposerSetRepositoryRing7Controller=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryRing7Controller",e.$L("ChemWidgetTexts.CAPTION_REPOSITORY_RING_7"),e.$L("ChemWidgetTexts.HINT_REPOSITORY_RING_7"),"MolRingIaController","MolRingIaController-7",{ringAtomCount:7,isAromatic:!1},null,null,r.molRing7),e.Editor.ActionComposerSetRepositoryRing8Controller=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryRing8Controller",e.$L("ChemWidgetTexts.CAPTION_REPOSITORY_RING_8"),e.$L("ChemWidgetTexts.HINT_REPOSITORY_RING_8"),"MolRingIaController","MolRingIaController-8",{ringAtomCount:8,isAromatic:!1},null,null,r.molRing8),e.Editor.ActionComposerSetRepositoryRingAr6Controller=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryRingAr6Controller",e.$L("ChemWidgetTexts.CAPTION_REPOSITORY_RING_AR_6"),e.$L("ChemWidgetTexts.HINT_REPOSITORY_RING_AR_6"),"MolRingIaController","MolRingIaController-Ar-6",{ringAtomCount:6,isAromatic:!0},null,null,r.molRingAr6),e.Editor.ActionComposerSetRepositoryRingAr5Controller=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryRingAr5Controller",e.$L("ChemWidgetTexts.CAPTION_REPOSITORY_RING_AR_5"),e.$L("ChemWidgetTexts.HINT_REPOSITORY_RING_AR_5"),"MolRingIaController","MolRingIaController-Ar-5",{ringAtomCount:5,isAromatic:!0},null,null,r.molRingAr5),e.Editor.ActionComposerSetRepositoryMolFlexRingController=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryMolFlexRingController",e.$L("ChemWidgetTexts.CAPTION_MOL_FLEXRING"),e.$L("ChemWidgetTexts.HINT_MOL_FLEXRING"),"MolFlexRingIaController","MolFlexRingIaController",null,null,null,r.molFlexRing),e.Editor.ActionComposerSetRepositoryCyclopentaneHaworth1Controller=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryCyclopentaneHaworth1Controller",e.$L("ChemWidgetTexts.CAPTION_REPOSITORY_CYCLOPENTANE_HARWORTH1"),e.$L("ChemWidgetTexts.HINT_REPOSITORY_CYCLOPENTANE_HARWORTH1"),"RepositoryStructureFragmentIaController","RepositoryStructureFragmentIaController-CyclopentaneHaworth1",{repItemName:"cyclopentaneHaworth1"},null,null,r.molRepCyclopentaneHaworth1),e.Editor.ActionComposerSetRepositoryCyclopentaneHaworth2Controller=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryCyclopentaneHaworth2Controller",e.$L("ChemWidgetTexts.CAPTION_REPOSITORY_CYCLOPENTANE_HARWORTH2"),e.$L("ChemWidgetTexts.HINT_REPOSITORY_CYCLOPENTANE_HARWORTH2"),"RepositoryStructureFragmentIaController","RepositoryStructureFragmentIaController-CyclopentaneHaworth2",{repItemName:"cyclopentaneHaworth2"},null,null,r.molRepCyclopentaneHaworth2),e.Editor.ActionComposerSetRepositoryCyclohexaneHaworth1Controller=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryCyclohexaneHaworth1Controller",e.$L("ChemWidgetTexts.CAPTION_REPOSITORY_CYCLOHEXANE_HARWORTH1"),e.$L("ChemWidgetTexts.HINT_REPOSITORY_CYCLOHEXANE_HARWORTH1"),"RepositoryStructureFragmentIaController","RepositoryStructureFragmentIaController-CyclohexaneHaworth1",{repItemName:"cyclohexaneHaworth1"},null,null,r.molRepCyclohexaneHaworth1),e.Editor.ActionComposerSetRepositoryCyclohexaneHaworth2Controller=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryCyclohexaneHaworth2Controller",e.$L("ChemWidgetTexts.CAPTION_REPOSITORY_CYCLOHEXANE_HARWORTH2"),e.$L("ChemWidgetTexts.HINT_REPOSITORY_CYCLOHEXANE_HARWORTH2"),"RepositoryStructureFragmentIaController","RepositoryStructureFragmentIaController-CyclohexaneHaworth2",{repItemName:"cyclohexaneHaworth2"},null,null,r.molRepCyclohexaneHaworth2),e.Editor.ActionComposerSetRepositoryCyclohexaneChair1Controller=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryCyclohexaneChair1Controller",e.$L("ChemWidgetTexts.CAPTION_REPOSITORY_CYCLOHEXANE_CHAIR1"),e.$L("ChemWidgetTexts.HINT_REPOSITORY_CYCLOHEXANE_CHAIR1"),"RepositoryStructureFragmentIaController","RepositoryStructureFragmentIaController-CyclohexaneChair1",{repItemName:"cyclohexaneChair1"},null,null,r.molRepCyclohexaneChair1),e.Editor.ActionComposerSetRepositoryCyclohexaneChair2Controller=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryCyclohexaneChair2Controller",e.$L("ChemWidgetTexts.CAPTION_REPOSITORY_CYCLOHEXANE_CHAIR2"),e.$L("ChemWidgetTexts.HINT_REPOSITORY_CYCLOHEXANE_CHAIR2"),"RepositoryStructureFragmentIaController","RepositoryStructureFragmentIaController-CyclohexaneChair2",{repItemName:"cyclohexaneChair2"},null,null,r.molRepCyclohexaneChair2),e.Editor.ActionComposerSetRepositoryRingController=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryRingController",e.$L("ChemWidgetTexts.CAPTION_REPOSITORY_RING"),e.$L("ChemWidgetTexts.HINT_REPOSITORY_RING"),"MolRingIaController",null,null,[e.Editor.ActionComposerSetRepositoryRing3Controller,e.Editor.ActionComposerSetRepositoryRing4Controller,e.Editor.ActionComposerSetRepositoryRing5Controller,e.Editor.ActionComposerSetRepositoryRing6Controller,e.Editor.ActionComposerSetRepositoryMolFlexRingController,e.Editor.ActionComposerSetRepositoryRingAr6Controller,e.Editor.ActionComposerSetRepositoryCyclopentaneHaworth1Controller,e.Editor.ActionComposerSetRepositoryCyclohexaneHaworth1Controller,e.Editor.ActionComposerSetRepositoryCyclohexaneChair1Controller,e.Editor.ActionComposerSetRepositoryCyclohexaneChair2Controller],null,r.molRing),e.Editor.ActionComposerSetRepositoryPathLineController=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryPathGlyphLineController",e.$L("ChemWidgetTexts.CAPTION_REPOSITORY_GLYPH_LINE"),e.$L("ChemWidgetTexts.HINT_REPOSITORY_GLYPH_LINE"),"ArrowLineIaController","ArrowLineIaController-Line",{glyphClass:e.Glyph.StraightLine,glyphInitialParams:null,lineLength:1.5},null,null,r.glyphRepLine),e.Editor.ActionComposerSetRepositoryPathOpenArrowLineController=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryPathOpenArrowLineController",e.$L("ChemWidgetTexts.CAPTION_REPOSITORY_GLYPH_OPEN_ARROW_LINE"),e.$L("ChemWidgetTexts.HINT_REPOSITORY_GLYPH_OPEN_ARROW_LINE"),"ArrowLineIaController","ArrowLineIaController-OpenArrowLine",{glyphClass:e.Glyph.StraightLine,glyphInitialParams:{endArrowType:e.Glyph.ArrowType.OPEN,endArrowWidth:.25,endArrowLength:.25,lineLength:1.5}},null,null,r.glyphRepOpenArrowLine),e.Editor.ActionComposerSetRepositoryPathTriangleArrowLineController=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryPathTriangleArrowLineController",e.$L("ChemWidgetTexts.CAPTION_REPOSITORY_GLYPH_TRIANGLE_ARROW_LINE"),e.$L("ChemWidgetTexts.HINT_REPOSITORY_GLYPH_TRIANGLE_ARROW_LINE"),"ArrowLineIaController","ArrowLineIaController-TriangleArrowLine",{glyphClass:e.Glyph.StraightLine,glyphInitialParams:{endArrowType:e.Glyph.ArrowType.TRIANGLE,endArrowWidth:.25,endArrowLength:.25,lineLength:1.5}},null,null,r.glyphRepTriangleArrowLine),e.Editor.ActionComposerSetRepositoryPathDiOpenArrowLineController=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryPathDiOpenArrowLineController",e.$L("ChemWidgetTexts.CAPTION_REPOSITORY_GLYPH_DI_OPEN_ARROW_LINE"),e.$L("ChemWidgetTexts.HINT_REPOSITORY_GLYPH_DI_OPEN_ARROW_LINE"),"ArrowLineIaController","ArrowLineIaController-DiOpenArrowLine",{glyphClass:e.Glyph.StraightLine,glyphInitialParams:{startArrowType:e.Glyph.ArrowType.OPEN,startArrowWidth:.25,startArrowLength:.25,endArrowType:e.Glyph.ArrowType.OPEN,endArrowWidth:.25,endArrowLength:.25,lineLength:1.5}},null,null,r.glyphRepDiOpenArrowLine),e.Editor.ActionComposerSetRepositoryPathDiTriangleArrowLineController=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryPathDiTriangleArrowLineController",e.$L("ChemWidgetTexts.CAPTION_REPOSITORY_GLYPH_DI_TRIANGLE_ARROW_LINE"),e.$L("ChemWidgetTexts.HINT_REPOSITORY_GLYPH_DI_TRIANGLE_ARROW_LINE"),"ArrowLineIaController","ArrowLineIaController-DiTriangleArrowLine",{glyphClass:e.Glyph.StraightLine,glyphInitialParams:{startArrowType:e.Glyph.ArrowType.TRIANGLE,startArrowWidth:.25,startArrowLength:.25,endArrowType:e.Glyph.ArrowType.TRIANGLE,endArrowWidth:.25,endArrowLength:.25,lineLength:1.5}},null,null,r.glyphRepDiTriangleArrowLine),e.Editor.ActionComposerSetRepositoryPathReversibleArrowLineController=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryPathReversibleArrowLineController",e.$L("ChemWidgetTexts.CAPTION_REPOSITORY_GLYPH_REV_ARROW_LINE"),e.$L("ChemWidgetTexts.HINT_REPOSITORY_GLYPH_REV_ARROW_LINE"),"ArrowLineIaController","ArrowLineIaController-ReversibleArrowLine",{glyphClass:e.Glyph.StraightLine,glyphInitialParams:{startArrowType:e.Glyph.ArrowType.OPEN,startArrowSide:e.Glyph.ArrowSide.REVERSED,startArrowWidth:.25,startArrowLength:.25,endArrowType:e.Glyph.ArrowType.OPEN,endArrowSide:e.Glyph.ArrowSide.SINGLE,endArrowWidth:.25,endArrowLength:.25,lineLength:1.5,lineGap:.1,lineCount:2}},null,null,r.glyphRepReversibleArrowLine),e.Editor.ActionComposerSetRepositoryPathOpenArrowDblLineController=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryPathOpenArrowDblLineController",e.$L("ChemWidgetTexts.CAPTION_REPOSITORY_GLYPH_OPEN_ARROW_DILINE"),e.$L("ChemWidgetTexts.HINT_REPOSITORY_GLYPH_OPEN_ARROW_DILINE"),"ArrowLineIaController","ArrowLineIaController-OpenArrowDiLine",{glyphClass:e.Glyph.StraightLine,glyphInitialParams:{endArrowType:e.Glyph.ArrowType.OPEN,endArrowWidth:.25,endArrowLength:.25,lineLength:1.5,lineGap:.1,lineCount:2}},null,null,r.glyphRepOpenArrowDiLine),e.Editor.ActionComposerSetRepositoryPathOpenArrowArcController=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryPathOpenArrowArcController",e.$L("ChemWidgetTexts.CAPTION_REPOSITORY_GLYPH_OPEN_ARROW_ARC"),e.$L("ChemWidgetTexts.HINT_REPOSITORY_GLYPH_OPEN_ARROW_ARC"),"ArrowLineIaController","ArrowLineIaController-OpenArrowArc",{glyphClass:e.Glyph.Arc,glyphInitialParams:{endArrowType:e.Glyph.ArrowType.OPEN,endArrowWidth:.25,endArrowLength:.25,lineLength:1,lineGap:.1,lineCount:1}},null,null,r.glyphRepOpenArrowArc),e.Editor.ActionComposerSetRepositoryPathSingleSideOpenArrowArcController=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryPathSingleSideOpenArrowArcController",e.$L("ChemWidgetTexts.CAPTION_REPOSITORY_GLYPH_SINGLE_SIDE_OPEN_ARROW_ARC"),e.$L("ChemWidgetTexts.HINT_REPOSITORY_GLYPH_SINGLE_SIDE_OPEN_ARROW_ARC"),"ArrowLineIaController","ArrowLineIaController-SingleSideOpenArrowArc",{glyphClass:e.Glyph.Arc,glyphInitialParams:{endArrowType:e.Glyph.ArrowType.OPEN,endArrowSide:e.Glyph.ArrowSide.REVERSED,endArrowWidth:.25,endArrowLength:.25,lineLength:1,lineGap:.1,lineCount:1}},null,null,r.glyphRepSingleSideOpenArrowArc),e.Editor.ActionComposerSetRepositoryHeatSymbolController=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryHeatSymbolController",e.$L("ChemWidgetTexts.CAPTION_REPOSITORY_HEAT_SYMBOL"),e.$L("ChemWidgetTexts.HINT_REPOSITORY_HEAT_SYMBOL"),"ArrowLineIaController","ArrowLineIaController-HeatSymbol",{glyphClass:e.Glyph.HeatSymbol,glyphInitialParams:{lineLength:1}},null,null,r.glyphRepHeatSymbol),e.Editor.ActionComposerSetRepositoryAddSymbolController=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryAddSymbolController",e.$L("ChemWidgetTexts.CAPTION_REPOSITORY_ADD_SYMBOL"),e.$L("ChemWidgetTexts.HINT_REPOSITORY_ADD_SYMBOL"),"ArrowLineIaController","ArrowLineIaController-AddSymbol",{glyphClass:e.Glyph.AddSymbol,glyphInitialParams:{lineLength:1}},null,null,r.glyphRepAddSymbol),e.Editor.ActionComposerSetRepositoryLineSegmentController=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryLineSegmentController",e.$L("ChemWidgetTexts.CAPTION_REPOSITORY_GLYPH_LINE"),e.$L("ChemWidgetTexts.HINT_REPOSITORY_GLYPH_LINE"),"ArrowLineIaController","ArrowLineIaController-Line",{glyphClass:e.Glyph.Segment,glyphInitialParams:{startArrowWidth:.25,startArrowLength:.25,endArrowWidth:.25,endArrowLength:.25,lineLength:1.5,lineGap:.1}},null,null,r.glyphRepSegment),e.Editor.ActionComposerSetRepositoryNormalReactionArrowController=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryNormalReactionArrowController",e.$L("ChemWidgetTexts.CAPTION_REACTION_ARROW_NORMAL"),e.$L("ChemWidgetTexts.HINT_REACTION_ARROW_NORMAL"),"ArrowLineIaController","ArrowLineIaController-ReactionArrowNormal",{glyphClass:e.Glyph.ReactionArrow,glyphInitialParams:{reactionArrowType:e.Glyph.ReactionArrowType.NORMAL,startArrowWidth:.25,startArrowLength:.25,endArrowWidth:.25,endArrowLength:.25,lineLength:1.5,lineGap:.1}},null,null,r.glyphReactionArrowNormal),e.Editor.ActionComposerSetRepositoryReversibleReactionArrowController=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryReversibleReactionArrowController",e.$L("ChemWidgetTexts.CAPTION_REACTION_ARROW_REVERSIBLE"),e.$L("ChemWidgetTexts.HINT_REACTION_ARROW_REVERSIBLE"),"ArrowLineIaController","ArrowLineIaController-ReactionArrowReversible",{glyphClass:e.Glyph.ReactionArrow,glyphInitialParams:{reactionType:e.Glyph.ReactionArrowType.REVERSIBLE,startArrowWidth:.25,startArrowLength:.25,endArrowWidth:.25,endArrowLength:.25,lineLength:1.5,lineGap:.1}},null,null,r.glyphReactionArrowReversible),e.Editor.ActionComposerSetRepositoryResonanceReactionArrowController=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryResonanceReactionArrowController",e.$L("ChemWidgetTexts.CAPTION_REACTION_ARROW_RESONANCE"),e.$L("ChemWidgetTexts.HINT_REACTION_ARROW_RESONANCE"),"ArrowLineIaController","ArrowLineIaController-ReactionArrowResonance",{glyphClass:e.Glyph.ReactionArrow,glyphInitialParams:{reactionType:e.Glyph.ReactionArrowType.RESONANCE,startArrowWidth:.25,startArrowLength:.25,endArrowWidth:.25,endArrowLength:.25,lineLength:1.5,lineGap:.1}},null,null,r.glyphReactionArrowResonance),e.Editor.ActionComposerSetRepositoryRetrosynthesisReactionArrowController=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryRetrosynthesisReactionArrowController",e.$L("ChemWidgetTexts.CAPTION_REACTION_ARROW_RETROSYNTHESIS"),e.$L("ChemWidgetTexts.HINT_REACTION_ARROW_RETROSYNTHESIS"),"ArrowLineIaController","ArrowLineIaController-ReactionArrowRetrosynthesis",{glyphClass:e.Glyph.ReactionArrow,glyphInitialParams:{reactionType:e.Glyph.ReactionArrowType.RETROSYNTHESIS,startArrowWidth:.25,startArrowLength:.25,endArrowWidth:.25,endArrowLength:.25,lineLength:1.5,lineGap:.1}},null,null,r.glyphReactionArrowRetrosynthesis),e.Editor.ActionComposerSetRepositoryDoubleElectronPushingArrowController=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryDoubleElectronPushingArrowController",e.$L("ChemWidgetTexts.CAPTION_ELECTRON_PUSHING_ARROW_2"),e.$L("ChemWidgetTexts.HINT_ELECTRON_PUSHING_ARROW_2"),"ArrowLineIaController","ArrowLineIaController-ElectronPushingArrowDouble",{glyphClass:e.Glyph.ElectronPushingArrow,glyphInitialParams:{electronCount:2,endArrowWidth:.25,endArrowLength:.25,lineLength:1,lineGap:.1,lineCount:1}},null,null,r.glyphElectronPushingArrowDouble),e.Editor.ActionComposerSetRepositorySingleElectronPushingArrowController=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositorySingleElectronPushingArrowController",e.$L("ChemWidgetTexts.CAPTION_ELECTRON_PUSHING_ARROW_1"),e.$L("ChemWidgetTexts.HINT_ELECTRON_PUSHING_ARROW_1"),"ArrowLineIaController","ArrowLineIaController-ElectronPushingArrowSingle",{glyphClass:e.Glyph.ElectronPushingArrow,glyphInitialParams:{electronCount:1,endArrowWidth:.25,endArrowLength:.25,lineLength:1,lineGap:.1,lineCount:1}},null,null,r.glyphElectronPushingArrowSingle),e.Editor.ActionComposerSetRepositoryBondFormingElectronPushingArrowController=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryBondFormingElectronPushingArrowController",e.$L("ChemWidgetTexts.CAPTION_BOND_FORMING_ELECTRON_PUSHING_ARROW_1"),e.$L("ChemWidgetTexts.HINT_BOND_FORMING_ELECTRON_PUSHING_ARROW_1"),"ArrowLineIaController","ArrowLineIaController-BondFormingElectronPushingArrowSingle",{glyphClass:e.Glyph.BondFormingElectronPushingArrow,glyphInitialParams:{endArrowWidth:.25,endArrowLength:.25,lineLength:1,pathEndGap:.1,lineCount:1}},null,null,r.glyphElectronPushingArrowBondForming),e.Editor.ActionComposerSetRepositoryGlyphController=e.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryGlyphController",e.$L("ChemWidgetTexts.CAPTION_REPOSITORY_ARROWLINE"),e.$L("ChemWidgetTexts.HINT_REPOSITORY_ARROWLINE"),"ArrowLineIaController",null,null,[e.Editor.ActionComposerSetRepositoryNormalReactionArrowController,e.Editor.ActionComposerSetRepositoryReversibleReactionArrowController,e.Editor.ActionComposerSetRepositoryResonanceReactionArrowController,e.Editor.ActionComposerSetRepositoryRetrosynthesisReactionArrowController,e.Editor.ActionComposerSetRepositoryLineSegmentController,e.Editor.ActionComposerSetRepositoryDoubleElectronPushingArrowController,e.Editor.ActionComposerSetRepositorySingleElectronPushingArrowController,e.Editor.ActionComposerSetRepositoryBondFormingElectronPushingArrowController,e.Editor.ActionComposerSetRepositoryHeatSymbolController,e.Editor.ActionComposerSetRepositoryAddSymbolController],null,r.glyph),e._registerAfterLoadSysProc(function(){var t=e.ActionManager,i=e.ChemWidget,n=e.Editor,a=e.Editor.ChemSpaceEditor,s=t.registerNamedActionClass;s(r.newDoc,n.ActionEditorNewDoc,a),s(r.loadFile,i.ActionDisplayerLoadFile,a),s(r.loadData,n.ActionEditorLoadData,a),s(r.saveData,i.ActionDisplayerSaveFile,a),s(r.zoomIn,i.ActionDisplayerZoomIn,a),s(r.zoomOut,i.ActionDisplayerZoomOut,a),s(r.resetZoom,i.ActionDisplayerResetZoom,a),s(r.reset,i.ActionDisplayerReset,a),s(r.config,e.Widget.ActionOpenConfigWidget,a),s(r.undo,n.ActionEditorUndo,a),s(r.redo,n.ActionEditorRedo,a),s(r.cloneSelection,n.ActionCloneSelection,a),s(r.copy,n.ActionCopySelection,a),s(r.cut,n.ActionCutSelection,a),s(r.paste,n.ActionPaste,a),s(r.toggleSelect,n.ActionToggleSelectState,a),s(r.objInspector,n.ActionComposerToggleInspector,a);for(var l=0,d=o.length;l<d;++l){var u=o[l];s(u.name,u.actionClass,u.widgetClass||a)}}),e}},function(e,t,r){"use strict";var i=r(0).Class,n=r(0).ObjectEx,a=r(0).DataType;e.exports=function(e){var t=e.ArrayUtils,r=e.CoordUtils;return e.Editor.PointerTrackConstraint={NONE:0,LEADING:1,BOTH:2,CIRCLE:5},e.Editor.TrackParser=i.create(n,{CLASS_NAME:"Kekule.Editor.TrackParser",simplifyCurveToLineSegments:function(t,r){return e.GeometryUtils.simplifyCurveToLineSegments(t,r)},addLineCrossPoints:function(t){for(var r=[],i=t.length,n=0;n<i-1;++n)for(var a={coord1:t[n],coord2:t[n+1]},o=n+2;o<i-1;++o){var s={coord1:t[o],coord2:t[o+1]},l=e.GeometryUtils.getCrossPointOfLines(a.coord1,a.coord2,s.coord1,s.coord2);l&&(this._addInsertedPoint(n,l,r),this._addInsertedPoint(o,l,r))}for(var n=0;n<i-1;++n)r[n]&&this._sortInsertedPointsInLine(r[n],t[n],t[n+1]);for(var d=[],n=0;n<i-1;++n)if(d.push(t[n]),r[n])for(var o=0,u=r[n].length;o<u;++o)d.push(r[n][o]);return d.push(t[i-1]),d},addVertexToLineMergePoint:function(t,r){if(r<=0)return t;for(var i=t.length,n=[],a=0;a<i-1;++a)for(var o=t[a],s=0;s<i-1;++s)if(s<a-1||s>a+1){var l=e.GeometryUtils.getPerpendicularCrossPointFromCoordToLine(o,t[s],t[s+1],!1);if(l){var d=e.CoordUtils.getDistance(o,l);d<=r&&(o.x=l.x,o.y=l.y,this._addInsertedPoint(s,o,n))}}for(var u=[],a=0;a<i-1;++a)if(u.push(t[a]),n[a]){this._sortInsertedPointsInLine(n[a],t[a],t[a+1]);for(var s=0,c=n[a].length;s<c;++s)u.push(n[a][s])}return u.push(t[i-1]),u},_addInsertedPoint:function(e,t,r){r[e]||(r[e]=[]),r[e].push(t)},_sortInsertedPointsInLine:function(e,t,r){if(e){var i=r.x-t.x,n=r.y-t.y;e.sort(function(e,t){return Math.abs(n)>Math.abs(i)?-(t.y-e.y)*n:-(t.x-e.x)*i})}},mergeNearbyTrackPoints:function(t,i){if(i<=0)return t;for(var n=t.length,a=t.concat([]),o=0;o<n;++o){var s=a[o];if(!s.__$merge_handled__)for(var l=o+1;l<n;++l){var d=a[l];if(!d.__$merge_handled__){var u=s.__$merge_weight__||1,c=d.__$merge_weight__||1,h=e.CoordUtils.getDistance(s,d);if(h<=i){var m,g=u+c;s.__$merge_weight__=g,s.boundObj?m=s:d.boundObj?(m=d,s.boundObj=d.boundObj):(m=1===u?s:r.multiply(s,u),m=r.add(m,1===c?d:r.multiply(d,c)),m=r.divide(m,g)),s.x=m.x,s.y=m.y,a.splice(l,1,s)}}}s.__$merge_handled__=!0}return a},mergeCloseVertexes:function(e,t){return t=t||this.getVertexMergeRadius(),t<=0?e:this._doMergeCloseVertexes(e,t)},_doMergeCloseVertexes:function(t,r){for(var i=t.getVertexes(),n=i.length,a=!1,o=0;o<n;++o){for(var s=i[o],l=i[o].getData("coord"),d=o+1;d<n;++d){var u=i[d],c=u.getData("coord");if(e.CoordUtils.getDistance(l,c)<=r){this._doMergeVertex(t,s,u),a=!0;break}}if(a)break}return a?this._doMergeCloseVertexes(t,r):t},_doMergeVertex:function(e,i,n){for(var a=i.getData("coord"),o=i.getData("weight")||1,s=n.getData("coord"),l=n.getData("weight")||1,d=t.clone(n.getEdges()),u=0,c=d.length;u<c;++u){d[u].replaceVertex(n,i)}e.removeVertex(n);var h=1===o?a:r.multiply(a,o);h+=1===l?s:r.multiply(s,l),h=r.divide(h,o+l),i.setData("coord",h)},removeRepetitivePoints:function(e){for(var t=[],r=null,i=0,n=e.length;i<n;++i)e[i]!==r&&(t.push(e[i]),r=e[i]);return t},refineTrack:function(e,t,r){var i=this.simplifyCurveToLineSegments(e,t);return i=this.addLineCrossPoints(i),i=this.addVertexToLineMergePoint(i,r),i=this.mergeNearbyTrackPoints(i,r),i=this.removeRepetitivePoints(i)},convertTrackToStructure:function(t,r,i,n){if(!r||!r.length)return null;var a=r.length;if(a<2)return null;for(var o,s=n||new e.StructureFragment,l=0;l<a;++l){var d=r[l],u=d.__$structure_node__;if(u||(u=new e.Atom,u.setIsotopeId(i),t.setObjectScreenCoord(u,d),d.__$structure_node__=u,s.appendNode(u)),o&&o!==u&&!u.getConnectorTo(o)){var c=new e.Bond(null,[o,u]);c.setBondOrder(1),s.appendConnector(c)}o=u}return s},convertLinesToGraph:function(t){if(t&&t.length){for(var r,i,n=new e.Graph,a=t.length,o=0;o<a;++o){var s=t[o],r=s.__$graph_vertex__;if(r||(r=new e.GraphVertex,r.setData("coord",s),s.__$graph_vertex__=r,n.addVertex(r)),i&&!r.getEdgeTo(i)){var l=new e.GraphEdge;n.addEdge(l,i,r)}i=r}return n}return null}}),e.Editor.TrackLayoutOptimizer=i.create(n,{CLASS_NAME:"Kekule.Editor.TrackLayoutOptimizer",OPTIMIZED_COORD_FIELD:"__$optimizedCoord__",COORD_INDEX_FIELD:"__$coordIndex__",RING_END_INDEX_FIELD:"__$ringEndIndex__",initialize:function($super){$super()},initProperties:function(){},initPropValues:function($super){$super()},splitTrackByRings:function(e){for(var t=[],r=0,i=e.length;r<i;++r){var n=e[r];if(void 0===n[this.COORD_INDEX_FIELD])n[this.COORD_INDEX_FIELD]=r;else{var a=n[this.COORD_INDEX_FIELD],o=r;n[this.RING_END_INDEX_FIELD]=o,function(e,r){for(var i=0,n=t.length;i<n;++i){var a=t[i];if(!(a.startIndex>r||a.endIndex<e))return!1}return!0}(a,o)&&t.push({startIndex:a,endIndex:o})}}var s=[],l=t.length;if(l>0){for(var d=0,r=0;r<l;++r){var u=t[r];u.startIndex>d&&s.push({track:e.slice(d,u.startIndex+1),isRing:!1}),s.push({track:e.slice(u.startIndex,u.endIndex+1),isRing:!0}),d=u.endIndex}return d<e.length-1&&s.push({track:e.slice(d,e.length),isRing:!1}),s}return[{track:e,isRing:!1}]},optimize:function(r,i){var n,a=r,o=e.Editor.PointerTrackConstraint,s=r[0],l=s.boundObj,d=r[r.length-1],u=d.boundObj;l&&u?n=l===u?o.CIRCLE:o.BOTH:l||u?(n=o.LEADING,u&&(a=t.reverse(r))):n=s===d?o.CIRCLE:o.LEADING;var c=Object.extend({},i);return c.preferredStartingAngles=i.preferredStartingAngles||[0],c.segmentsInfo=this._calcTrackSegmentsInfo(a),c.distanceMedian=t.getMedian(c.segmentsInfo.distances),n===o.CIRCLE?this.doOptimizeOnCircleConstraint(a,c):n===o.BOTH?this.doOptimizeOnBothConstraint(a,c):this.doOptimizeOnLeadingConstraint(a,c)},_calcTrackSegmentsInfo:function(e){for(var t=[],i=[],n=0,a=e.length;n<a-1;++n){var o=e[n],s=e[n+1],l=r.getDistance(o,s),d=r.substract(s,o),u=Math.atan2(d.y,d.x);t.push(l),i.push(u)}return{distances:t,angles:i}},doOptimizeOnLeadingConstraint:function(t,i,n){var a=e.GeometryUtils,o=[];if(n){var s=(e.Editor.PointerTrackConstraint,this.splitTrackByRings(t));if(1===s.length)return s[d].isRing?this.doOptimizeOnCircleConstraint(c,i,!0):this.doOptimizeOnLeadingConstraint(c,i,!0);for(var l,d=0,u=s.length;d<u;++d){var c=s[d].track,h=s[d].isRing?this.doOptimizeOnCircleConstraint(c,i,!0):this.doOptimizeOnLeadingConstraint(c,i,!0);if(l){for(var m=h[0],g=r.substract(l,m),f=0,p=h.length;f<p;++f)h[f]=r.add(h[f],g);l=h[h.length-1],h.shift(),o=o.concat(h)}else l=h[h.length-1],o=o.concat(h)}return o}var C,b=i.preferredStartingAngles;o.push(t[0]);for(var d=(i.preferredIncludeAngle,i.preferredIncludeAngle,1),u=t.length;d<u;++d)if(t[d][this.OPTIMIZED_COORD_FIELD])o.push(t[d][this.OPTIMIZED_COORD_FIELD]);else{var E,N=t[d-1],T=o[d-1],O=t[d],g=r.substract(O,N),_=r.getDistance(N,O),S=this._optimizeLineSegmentDistance(_,i),v=Math.atan2(g.y,g.x);E=this._optimizeDirectionAngle(v,b,i,C),C=E;var y=Math.PI-i.preferredIncludeAngle,b=[a.standardizeAngle(E-y),a.standardizeAngle(E+y)],A={x:S*Math.cos(E),y:S*Math.sin(E)},M=r.add(T,A);o.push(M),t[d][this.OPTIMIZED_COORD_FIELD]=M}return o},doOptimizeOnBothConstraint:function(t,i,n){var a=t.length,o=this.doOptimizeOnLeadingConstraint(t,i,n),s=o[a-1],l=t[a-1],d=t[0],u=r.substract(l,d),c=Math.atan2(u.y,u.x),h=r.substract(s,d),m=Math.atan2(h.y,h.x),g=r.getDistance(u)/r.getDistance(h);if(g<=2){var f=r.calcTransform2DMatrix({rotateAngle:-m,center:d}),p=r.calcTransform2DMatrix({scale:g,center:d}),C=r.calcTransform2DMatrix({rotateAngle:c,center:d}),b=e.MatrixUtils.multiply(f,p);b=e.MatrixUtils.multiply(b,C);for(var E=[o[0]],N=1;N<a-1;++N)E.push(r.transform2DByMatrix(o[N],b));E.push(t[a-1])}else{for(var T=r.divide(r.substract(l,s),a-1),E=[o[0]],O={x:0,y:0},N=0;N<a-1;++N)O=r.add(O,T),E.push(r.add(o[N],O));E.push(t[a-1])}return E},doOptimizeOnCircleConstraint:function(e,t,i){var n=e.length-1,a=Object.create(t);if(n<=8){var o=(1-2/n)*Math.PI,a=Object.create(t);a.preferredIncludeAngle=o}for(var s=e.length,l=this.doOptimizeOnLeadingConstraint(e,a,i),d=l[s-1],u=e[s-1],c=r.divide(r.substract(u,d),s-1),h=[l[0]],m={x:0,y:0},g=1;g<s-1;++g)m=r.add(m,c),h.push(r.add(l[g],m));return h.push(e[s-1]),h},_optimizeIncludeAngle:function(e,t,r){return this._optimizeDirectionAngle(e,t,r)},_optimizeDirectionAngle:function(t,r,i,n){var a=e.GeometryUtils,o=null,s=null;if(r&&r.length){for(var l=null,d=0,u=r.length;d<u;++d){var c=Math.abs(a.standardizeAngle(t)-r[d]);(null===l||c<l)&&(s=r[d],l=c)}l<=Math.PI/6&&(o=s)}if(null===o){var h=i.angleConstraint;if(!h)return t;null===s&&(s=0);var c=t-s;if(o=s+Math.round(c/h)*h,n){var m=5*Math.PI/180,g=Math.abs(a.standardizeAngle(o-n,-Math.PI));if(e.NumUtils.isFloatEqual(g,0,m)||e.NumUtils.isFloatEqual(g,Math.PI,m)){var f=o+h,p=o-h;o=Math.abs(t-f)<Math.abs(t-p)?f:p}}}return o},_optimizeLineSegmentDistance:function(e,t){var r=t.defBondScreenLength,i=t.distanceConstraints||[];if(!i)return e;if(e>i[i.length-1]*r)return Math.round(e/r)*r;var n=t.primaryDistanceConstraint,a=i.length,o=i.indexOf(n);o<0&&(o=0);for(var s,l=a-1;l>=o;--l){var d=i[l];if(s=d*r,e>s)return s}for(var l=0;l<=o;++l)if(s=d*r,e<s)return s;return s}}),e.Editor.TrackInputIaController=i.create(e.Editor.StructureInsertIaController,{CLASS_NAME:"Kekule.Editor.TrackInputIaController",initialize:function($super,t){$super(t),this.setEnableSelect(!1),this._isTracking=!1,this._trackCoordToObjBindings=null,this._trackParser=new e.Editor.TrackParser,this._trackLayoutOptimizer=new e.Editor.TrackLayoutOptimizer,this._addStructureOperation=null,this._editorScaled=!1,this._editorOriginalZoomLevel=1,this._lastRenderedMarkerCoord=null,this._debugMarkers={}},doFinalize:function($super){this._trackLayoutOptimizer.finalize(),this._trackParser.finalize();var e=this.getPropStoreFieldValue("trackMarker");e&&e.finalize(),$super()},initProperties:function(){this.defineProp("trackMarker",{dataType:a.OBJECT,serializable:!1,setter:null,getter:function(){var t=this.getPropStoreFieldValue("trackMarker");return t||(t=new e.ChemWidget.MetaShapeUIMarker({shapeType:e.Render.MetaShapeType.POLYLINE,coords:[]}),this.setPropStoreFieldValue("trackMarker",t)),t}})},initPropValues:function($super){$super()},getEditorUiMarkers:function(){return this.getEditor().getUiMarkers()},refineTrackCoords:function(e){var t=this.getEditor(),i=this.getEditorConfigs(),n={angleConstraint:i.getInteractionConfigs().getTrackOptimizationAngleConstraint(),distanceConstraints:i.getInteractionConfigs().getTrackOptimizationDistanceConstraints(),primaryDistanceConstraint:i.getInteractionConfigs().getTrackOptimizationPrimaryDistanceConstraint(),preferredIncludeAngle:2*Math.PI/3},a=t.getDefBondLength?t.getDefBondLength():i.getStructureConfigs().getDefBondLength(),o=t.objCoordToScreen({x:0,y:0}),s=t.objCoordToScreen({x:a,y:0}),l=r.getDistance(o,s);n.defBondScreenLength=l;for(var d=this.getEditorConfigs().getInteractionConfigs().getTrackSimplifierDistanceThreshold(),u=this.getEditorConfigs().getInteractionConfigs().getTrackMergeDistanceThreshold(),c=this._mergeCoordsToBoundNodesAndSplitTrack(e),h=[],m=0,g=c.length;m<g;++m){var f=c[m];f=this._trackParser.refineTrack(f,d,u);var p=f[0].obj||f[f.length-1].obj,C=p?i.getStructureConfigs.getNewBondDefAngle(p,1):-Math.PI/6;n.preferredStartingAngles=[C],f=this._trackLayoutOptimizer.optimize(f,n),h.push(f)}return h},_mergeCoordsToBoundNodesAndSplitTrack:function(e){var t=this._trackCoordToObjBindings,r=t.length;if(r){for(var i=this.getEditor(),n=[],a=t[0].obj,o=t[0].coordIndex,s=0,l=1;l<=r;++l){var d=t[l];if(l<r&&d&&(a!==d.obj||d.coordIndex-o>10)||l===r){o>s&&n.push(e.slice(s,o));var u=i.getObjectScreenCoord(a);u.boundObj=a;s=t[l-1].coordIndex+1,n.push([u]),l!==r&&(a=d.obj,o=d.coordIndex)}}e.length-1>t[r-1].coordIndex&&n.push(e.slice(t[r-1].coordIndex));for(var c=[],h=[],l=0,m=n.length;l<m;++l){var g=n[l];c=c.concat(g),l===m-1?h.push(c):g[0].boundObj&&l>0&&(h.push(c),c=g)}return h}return[e]},convertTracksToStructure:function(t,r){var i=new e.Molecule;i.setCoord2D({x:0,y:0});for(var n=this.getEditor(),a=0,o=t.length;a<o;++a)this._trackParser.convertTrackToStructure(n,t[a],r,i);return i.getNodeCount()<2?null:i},getStructureSelectableChildren:function(e){return[].concat(e.getNodes()).concat(e.getConnectors())},addStructureToEditor:function(t){var r=this.getEditor();this._addStructureOperation=null,r.beginUpdateObject();try{var i,n=r.getChemSpace();this._targetMol?(i=new e.ChemStructOperation.MergeStructFragment(t,this._targetMol,r),this._targetMol=null):i=new e.ChemObjOperation.Add(t,n,null,r),i.execute(),this._addStructureOperation=i}finally{r.endUpdateObject()}},getTrackCoords:function(){return this.getTrackMarker().getShapeInfo().coords},clearTrackCoords:function(){this.getTrackMarker().getShapeInfo().coords=[]},startTracking:function(t,r){this._targetMol=null;var i=this.getEditor(),n=this._getMergeDestObjAtCoord(r);if(!i.canCreateNewChild()&&!n){if(!i.canAddUnconnectedStructFragment())return null;var a=i.getOnlyOneBlankStructFragment();this._targetMol=a}this._isTracking=!0,this._trackCoordToObjBindings=[],this.setManuallyHotTrack(!0),this.clearTrackCoords();var o=this.getTrackMarker();this.getEditorUiMarkers().addMarker(o);var s=this.getEditorConfigs().getUiMarkerConfigs(),l={strokeColor:s.getTrackMarkerStrokeColor(),strokeWidth:s.getTrackMarkerStrokeWidth(),strokeDash:s.getTrackMarkerStrokeDash(),opacity:s.getTrackMarkerOpacity()};if(o.setDrawStyles(l),o.setVisible(!0),this.addTrackCoord(r,!1),this.getEditorConfigs().getInteractionConfigs().getAutoAdjustZoomLevelOnTrackTouching()){var i=this.getEditor(),d=this.getEditorConfigs().getInteractionConfigs().getTrackTouchRefLength();if(d){var u=i.getDocument(),c=i.getDefBondScreenLength(),h=e.DocumentUtils.getDevicePPI(u)*d/e.DocumentUtils.getClientScaleLevel(u),m=h/c;if(m>.9){var g=i.getCurrZoom();i.setZoomCenter(r),i.zoomTo(g*m);var f=this._getEventMouseCoord(t),p=this.getTrackCoords(),C=p[p.length-1];r=f,Object.extend(C,f),this._editorScaled=!0,this._editorOriginalZoomLevel=g,this._autoScaleStartCoord=f}else this._editorScaled=!1,this._editorOriginalZoomLevel=null}}this.repaintMarker(),this._lastRenderedMarkerCoord=r},endTracking:function(e){var t=this.getEditorConfigs().getStructureConfigs().getDefIsotopeId()||"C";this._isTracking=!1,this.addTrackCoord(e);var r=this.refineTrackCoords(this.getTrackCoords());if(r.length){var i=this.convertTracksToStructure(r,t);if(i){this.addStructureToEditor(i),this.startDirectManipulate(null,i,e),this.moveManipulatedObjs(e),this.stopManipulate();var n=this.getStructureSelectableChildren(i);this.doneInsertOrModifyBasicObjects(n)}}this.doneTracking()},cancelTracking:function(){this._isTracking=!1,this.getEditorUiMarkers().removeMarker(this.getTrackMarker()),this.doneTracking()},doneTracking:function(){if(this._editorScaled){var e=this.getTrackCoords();e[e.length-1];this._editorScaled=!1,this.getEditor().zoomTo(this._editorOriginalZoomLevel,null,this._autoScaleStartCoord),this._editorOriginalZoomLevel=null,this._autoScaleStartCoord=null}this.setManuallyHotTrack(!1),this.getEditor().hideHotTrack(),this.clearTrackCoords(),this.repaintMarker()},_getMergeDestObjAtCoord:function(e){for(var t=this.getEditor().getBasicObjectsAtCoord(e,this.getCurrBoundInflation()),r=0,i=t.length;r<i;++r){var n=t[r];if(this.isValidMergeDestObj(n))return n}return null},addTrackCoord:function(t,r){var i=this.getTrackCoords(),n=i&&i[i.length-1];if(!n||!e.CoordUtils.isEqual(t,n)){var a=this._getMergeDestObjAtCoord(t);if(a&&(this._trackCoordToObjBindings.push({coord:t,obj:a,coordIndex:this.getTrackCoords().length}),this.getEditor().addHotTrackedObj(a)),i.push(t),!r){this._lastRenderedMarkerCoord?e.CoordUtils.getDistance(this._lastRenderedMarkerCoord,t)>5&&(this.repaintMarker(),this._lastRenderedMarkerCoord=t):(this.repaintMarker(),this._lastRenderedMarkerCoord=t)}}},repaintMarker:function(){this.getEditor().repaintUiMarker()},isValidMergeDestObj:function(t){return t instanceof e.ChemStructureNode},canInteractWithObj:function(t){return t instanceof e.ChemStructureNode},getAllObjOperations:function($super,e){var t=$super(e)||[],r=this._addStructureOperation;return r&&t.unshift(r),t},react_pointerdown:function($super,t){if(this.setActivePointerType(t.pointerType),t.getButton()===e.X.Event.MouseButton.LEFT){var r=this._getEventMouseCoord(t);this.startTracking(t,r),t.preventDefault()}else t.getButton()===e.X.Event.MouseButton.RIGHT&&(this.cancelTracking(),t.preventDefault())},react_pointerup:function($super,t){if(t.getButton()===e.X.Event.MouseButton.LEFT){if(this._isTracking){var r=this._getEventMouseCoord(t);this.endTracking(r),this.addOperationToEditor()}this.setState(e.Editor.BasicManipulationIaController.State.NORMAL),t.preventDefault()}},react_pointermove:function($super,e){if($super(e),this._isTracking){var t=this._getEventMouseCoord(e);this.addTrackCoord(t),e.preventDefault()}}}),e.Editor.IaControllerManager.register(e.Editor.TrackInputIaController,e.Editor.ChemSpaceEditor),e}},function(e,t,r){"use strict";var i=r(0).Class,n=r(0).ClassEx,a=r(0).ObjectEx,o=r(0).DataType;e.exports=function(e){var t=e.ArrayUtils;e.Editor,e.Widget.HtmlClassNames,e.ChemWidget.HtmlClassNames,e.ChemWidget.ComponentWidgetNames;e.Editor.ObjModifier={},e.Editor.ObjModifier.Category={GENERAL:"general",CHEM_STRUCTURE:"chemStruct",GLYPH:"glyph",STYLE:"style",MISC:"misc"},e.Editor.ObjModifier.Base=i.create(a,{CLASS_NAME:"Kekule.Editor.ObjModifier.Base",initialize:function($super,e){$super(),this.setEditor(e),this.modifierWidgetValueChangedBind=this.modifierWidgetValueChanged.bind(this)},initProperties:function(){this.defineProp("editor",{dataType:"Kekule.Editor.BaseEditor",serializable:!1}),this.defineProp("targetObjs",{dataType:o.ARRAY,serializable:!1,getter:function(){return this.getEditor().getSelection()}}),this.defineProp("widget",{dataType:"Kekule.Widget.BaseWidget",serializable:!1,setter:null,getter:function(){var e=this.getPropStoreFieldValue("widget");return e||(e=this.createWidget(),this.setPropStoreFieldValue("widget",e)),e}})},getEditorConfigs:function(){return this.getEditor().getEditorConfigs()},getModifierName:function(){return this.getClassLocalName().toLowerCase()},createWidget:function(){var e=this.doCreateWidget();return e&&this.installValueChangeEventHandler(e),e},doCreateWidget:function(){return null},installValueChangeEventHandler:function(e){e.on("valueChange",this.modifierWidgetValueChangedBind)},modifierWidgetValueChanged:function(){this.applyToTargets()},loadFromTargets:function(){var e=this.getEditor();if(e){var t=this.getTargetObjs();t&&this.doLoadFromTargets(e,t)}return this},doLoadFromTargets:function(e,t){},applyToTargets:function(){var e=this.getEditor();if(e){var t=this.getTargetObjs();t&&this.doApplyToTargets(e,t)}return this},doApplyToTargets:function(e,t){var r=this.createModificationOper();r&&e.execOperation(r)},createModificationOper:function(t){var r=[];if(t&&t.length)for(var i=0,n=t.length;i<n;++i){var a=this.createModificationOperOnTarget(t[i]);a&&r.push(a)}var o=r.length;return o<=0?null:1===o?r[0]:new e.MacroOperation(r)},createModificationOperOnTarget:function(e){var t=this.getModifiedPropValues();return t?this.createModificationOperation(e,t):null},getModifiedPropValues:function(){return null},createModificationOperation:function(t,r){return new e.ChemObjOperation.Modify(t,r,this.getEditor())}}),e.Editor.ObjModifierManager={_modifierMap:new e.MapEx(!0),register:function(e,i){if(i&&e)for(var n=t.toArray(i),a=t.toArray(e),o=0,s=a.length;o<s;++o){var l=a[o],d=r._modifierMap.get(l);d?t.pushUnique(d,n):(d=n,r._modifierMap.set(l,d))}},unregister:function(e){if(e)for(var i=t.toArray(e),n=r._modifierMap.getKeys(),a=0,o=n.length;a<o;++a){var s=r._modifierMap.get(n[a]);s&&s.length&&r._modifierMap.set(n[a],t.exclude(s,i))}},getModifierCategories:function(e){var i=e.getCategories&&e.getCategories()||[],a=n.getSuperClass(e);return a&&t.pushUnique(i,r.getModifierCategories(a)),i},getModifierClasses:function(e,i){var a=r._modifierMap.get(e)||[],o=n.getSuperClass(e);if(o&&t.pushUnique(a,r.getModifierClasses(o,i)),i&&i.length){var s=a;a=[];for(var l=0,d=s.length;l<d;++l){var u=r.getModifierCategories(s[l]);t.intersect(u,i).length&&a.push(s[l])}}return a}};var r=e.Editor.ObjModifierManager;return e}},function(e,t,r){"use strict";var i=r(0).Class;r(0).DataType;e.exports=function(e){var t=(e.ArrayUtils,e.Editor,e.Widget.HtmlClassNames),r=e.ChemWidget.HtmlClassNames;e.ChemWidget.ComponentWidgetNames;return e.Editor.ObjModifier.BaseRenderOptionModifier=i.create(e.Editor.ObjModifier.Base,{CLASS_NAME:"Kekule.Editor.ObjModifier.BaseRenderOptionModifier",getRenderOptionValue:function(t,r,i){return e.Render.RenderOptionUtils.getCascadeRenderOptionValueOfObjs(t,r,i)}}),e.Editor.ObjModifier.BaseRenderOptionModifier.getCategories=function(){return[e.Editor.ObjModifier.Category.STYLE]},e.Editor.ObjModifier.Color=i.create(e.Editor.ObjModifier.BaseRenderOptionModifier,{CLASS_NAME:"Kekule.Editor.ObjModifier.Color",ATOM_COLOR_SPECIAL_VALUE_INFO:{text:e.$L("ChemWidgetTexts.HINT_USE_ATOM_CUSTOM_COLOR"),value:"Atom",className:t.COLORPICKER_SPEC_COLOR_MIXED},initProperties:function(){this.defineProp("colorBox",{dataType:"Kekule.Widget.BaseWidget",serializable:!1,setter:null})},doCreateWidget:function(){var t=new e.Widget.ColorDropButton(this.getEditor());return t.setHint(e.$L("ChemWidgetTexts.HINT_PICK_COLOR")),t.setShowText(!1),t.setSpecialColors([e.Widget.ColorPicker.SpecialColors.UNSET,this.ATOM_COLOR_SPECIAL_VALUE_INFO]),t.addClassName(r.COMPOSER_COLOR_BOX),this.setPropStoreFieldValue("colorBox",t),t},doLoadFromTargets:function(e,t){if(t&&t.length){var r=this.getColorBox();if(r){var i,n=this.getRenderOptionValue(t,"useAtomSpecifiedColor"),i=this.getRenderOptionValue(t,"color");n?(i=this.ATOM_COLOR_SPECIAL_VALUE_INFO.value,r.setColorClassName(this.ATOM_COLOR_SPECIAL_VALUE_INFO.className),r.setValue(i)):(r.setColorClassName(null),r.setValue(i))}}},doApplyToTargets:function($super,t,r){var i=this.getWidget().getValue();i===this.ATOM_COLOR_SPECIAL_VALUE_INFO.value?t.modifyObjectsRenderOptions(r,{useAtomSpecifiedColor:!0,color:void 0},!1,!0):(i==e.Widget.ColorPicker.SpecialColors.UNSET&&(i=void 0),t.modifyObjectsRenderOptions(r,{useAtomSpecifiedColor:!1,color:i},!1,!0))}}),e.Editor.ObjModifierManager.register(e.ChemObject,[e.Editor.ObjModifier.Color]),e}},function(e,t,r){"use strict";var i=r(0).Class;r(0).DataType;e.exports=function(e){var t=e.DomUtils,r=(e.HtmlElementUtils,e.Widget.HtmlClassNames,e.ChemWidget.HtmlClassNames),n=e.ChemWidget.ComponentWidgetNames;return e.ChemWidget.HtmlClassNames=Object.extend(e.ChemWidget.HtmlClassNames,{COMPOSER_TEXTFORMAT_BUTTON:"K-Chem-Composer-TextFormat-Button",COMPOSER_MODIFIER_RICHTEXT_PANEL:"K-Chem-Composer-Modifier-RichText-Panel",COMPOSER_MODIFIER_RICHTEXT_PANEL_GROUP:"K-Chem-Composer-Modifier-RichText-Panel-Group",COMPOSER_MODIFIER_RICHTEXT_PANEL_GROUP_LABELCELL:"K-Chem-Composer-Modifier-RichText-Panel-Group-LabelCell",COMPOSER_MODIFIER_RICHTEXT_PANEL_GROUP_CTRLCELL:"K-Chem-Composer-Modifier-RichText-Panel-Group-CtrlCell",COMPOSER_MODIFIER_RICHTEXT_PANEL_GROUP_LABEL:"K-Chem-Composer-Modifier-RichText-Panel-Group-Label",COMPOSER_TEXTDIRECTION_BOX:"K-Chem-Composer-TextDirection-Box",COMPOSER_TEXTALIGN_BOX:"K-Chem-Composer-TextAlign-Box"}),e.globalOptions.add("chemWidget.composer.objModifier.richText",{componentNames:[n.fontName,n.fontSize,n.textDirection,n.textAlign,n.nodeDisplayMode]}),e.Editor.ObjModifier.RichText=i.create(e.Editor.ObjModifier.BaseRenderOptionModifier,{CLASS_NAME:"Kekule.Editor.ObjModifier.RichText",initialize:function($super,e){$super(e),this._valueStorage={},this._nodeLabelDisplayModeGroup=null},initProperties:function(){this.defineProp("fontPanel",{dataType:"Kekule.Widget.BaseWidget",serializable:!1,setter:null}),this.defineProp("fontNameBox",{dataType:"Kekule.Widget.BaseWidget",serializable:!1,setter:null}),this.defineProp("fontSizeBox",{dataType:"Kekule.Widget.BaseWidget",serializable:!1,setter:null}),this.defineProp("textDirectionBox",{dataType:"Kekule.Widget.BaseWidget",serializable:!1,setter:null}),this.defineProp("textHorizontalAlignBox",{dataType:"Kekule.Widget.BaseWidget",serializable:!1,setter:null}),this.defineProp("textVerticalAlignBox",{dataType:"Kekule.Widget.BaseWidget",serializable:!1,setter:null}),this.defineProp("nodeLabelDisplayModeBox",{dataType:"Kekule.Widget.BaseWidget",serializable:!1,setter:null})},_createCtrlGroup:function(e,i,n,a){var o=e.createElement("tr");o.className=r.COMPOSER_MODIFIER_RICHTEXT_PANEL_GROUP;var s=e.createElement("td");s.className=r.COMPOSER_MODIFIER_RICHTEXT_PANEL_GROUP_LABELCELL;var l=e.createElement("label");l.className=r.COMPOSER_MODIFIER_RICHTEXT_PANEL_GROUPLABEL,t.setElementText(l,n),s.appendChild(l),o.appendChild(s);var s=e.createElement("td");return s.className=r.COMPOSER_MODIFIER_RICHTEXT_PANEL_GROUP_CTRLCELL,a.appendToElem(s),o.appendChild(s),i.appendChild(o),o},_doCreateDropDownPanel:function(){var t=new e.Widget.Panel(this.getEditor());t.addClassName(r.COMPOSER_MODIFIER_RICHTEXT_PANEL).setCaption(e.$L("ChemWidgetTexts.CAPTION_TEXT_FORMAT"));var i,a,o=e.globalOptions.chemWidget.composer.objModifier.richText.componentNames,s=this.getEditor().getDocument(),l=s.createElement("table");if(t.getContainerElement().appendChild(l),o.indexOf(n.fontName)>=0){var i=new e.Widget.ComboBox(t);this.fillFontNameBox(i),i.addClassName(r.COMPOSER_FONTNAME_BOX),i.setHint(e.$L("ChemWidgetTexts.HINT_FONTNAME")),i.addEventListener("valueChange",function(e){this.getEditor().modifyObjectsRenderOptions(this.getTargetObjs(),{fontFamily:this.getFontNameBox().getValue()},!1,!0)},this),this.setPropStoreFieldValue("fontNameBox",i),this._createCtrlGroup(s,l,e.$L("ChemWidgetTexts.CAPTION_FONTNAME"),i)}if(o.indexOf(n.fontSize)>=0&&(i=new e.Widget.ComboBox(t),this.fillFontSizeBox(i),i.addClassName(r.COMPOSER_FONTSIZE_BOX),i.setHint(e.$L("ChemWidgetTexts.HINT_FONTSIZE")),i.addEventListener("valueChange",function(e){this.getEditor().modifyObjectsRenderOptions(this.getTargetObjs(),{fontSize:this.getFontSizeBox().getValue()},!1,!0)},this),this.setPropStoreFieldValue("fontSizeBox",i),this._createCtrlGroup(s,l,e.$L("ChemWidgetTexts.CAPTION_FONTSIZE"),i)),o.indexOf(n.textDirection)>=0){a=new e.Widget.SelectBox(t);var d=e.Render.TextDirection,u=[{value:d.DEFAULT,text:e.$L("ChemWidgetTexts.CAPTION_TEXT_DIRECTION_DEFAULT")},{value:d.LTR,text:e.$L("ChemWidgetTexts.CAPTION_TEXT_DIRECTION_LTR")},{value:d.RTL,text:e.$L("ChemWidgetTexts.CAPTION_TEXT_DIRECTION_RTL")},{value:d.TTB,text:e.$L("ChemWidgetTexts.CAPTION_TEXT_DIRECTION_TTB")},{value:d.BTT,text:e.$L("ChemWidgetTexts.CAPTION_TEXT_DIRECTION_BTT")}];a.setItems(u),i.addClassName(r.COMPOSER_TEXTDIRECTION_BOX),a.setHint(e.$L("ChemWidgetTexts.HINT_TEXT_DIRECTION")),a.addEventListener("valueChange",function(e){this.getEditor().modifyObjectsRenderOptions(this.getTargetObjs(),{charDirection:this.getTextDirectionBox().getValue()},!1,!0)},this),this.setPropStoreFieldValue("textDirectionBox",a),this._createCtrlGroup(s,l,e.$L("ChemWidgetTexts.CAPTION_TEXT_DIRECTION"),a)}if(o.indexOf(n.textAlign)>=0){a=new e.Widget.SelectBox(t);var c=e.Render.TextAlign,u=[{value:c.DEFAULT,text:e.$L("ChemWidgetTexts.CAPTION_TEXT_ALIGN_DEFAULT")},{value:c.LEADING,text:e.$L("ChemWidgetTexts.CAPTION_TEXT_ALIGN_LEADING")},{value:c.TRAILING,text:e.$L("ChemWidgetTexts.CAPTION_TEXT_ALIGN_TRAILING")},{value:c.CENTER,text:e.$L("ChemWidgetTexts.CAPTION_TEXT_ALIGN_CENTER")},{value:c.LEFT,text:e.$L("ChemWidgetTexts.CAPTION_TEXT_ALIGN_LEFT")},{value:c.RIGHT,text:e.$L("ChemWidgetTexts.CAPTION_TEXT_ALIGN_RIGHT")}];a.setItems(u),i.addClassName(r.COMPOSER_TEXTALIGN_BOX),a.setHint(e.$L("ChemWidgetTexts.HINT_TEXT_HORIZONTAL_ALIGN")),a.addEventListener("valueChange",function(e){this.getEditor().modifyObjectsRenderOptions(this.getTargetObjs(),{horizontalAlign:this.getTextHorizontalAlignBox().getValue()},!1,!0)},this),this.setPropStoreFieldValue("textHorizontalAlignBox",a),this._createCtrlGroup(s,l,e.$L("ChemWidgetTexts.CAPTION_TEXT_HORIZONTAL_ALIGN"),a),a=new e.Widget.SelectBox(t);var c=e.Render.TextAlign,u=[{value:c.DEFAULT,text:e.$L("ChemWidgetTexts.CAPTION_TEXT_ALIGN_DEFAULT")},{value:c.LEADING,text:e.$L("ChemWidgetTexts.CAPTION_TEXT_ALIGN_LEADING")},{value:c.TRAILING,text:e.$L("ChemWidgetTexts.CAPTION_TEXT_ALIGN_TRAILING")},{value:c.CENTER,text:e.$L("ChemWidgetTexts.CAPTION_TEXT_ALIGN_CENTER")},{value:c.TOP,text:e.$L("ChemWidgetTexts.CAPTION_TEXT_ALIGN_TOP")},{value:c.BOTTOM,text:e.$L("ChemWidgetTexts.CAPTION_TEXT_ALIGN_BOTTOM")}];a.setItems(u),i.addClassName(r.COMPOSER_TEXTALIGN_BOX),a.setHint(e.$L("ChemWidgetTexts.HINT_TEXT_VERTICAL_ALIGN")),a.addEventListener("valueChange",function(e){this.getEditor().modifyObjectsRenderOptions(this.getTargetObjs(),{verticalAlign:this.getTextVerticalAlignBox().getValue()},!1,!0)},this),this.setPropStoreFieldValue("textVerticalAlignBox",a),this._createCtrlGroup(s,l,e.$L("ChemWidgetTexts.CAPTION_TEXT_VERTICAL_ALIGN"),a)}if(o.indexOf(n.nodeDisplayMode)>=0){var i=new e.Widget.SelectBox(t);this.fillNodeDisplayModeBox(i),i.addClassName(r.COMPOSER_NODEDISPLAYMODE_BOX),i.setHint(e.$L("ChemWidgetTexts.HINT_NODE_LABEL_DISPLAY_MODE")),i.addEventListener("valueChange",function(e){this.getEditor().modifyObjectsRenderOptions(this.getTargetObjs(),{nodeDisplayMode:this.getNodeLabelDisplayModeBox().getValue()},!1,!0)},this),this.setPropStoreFieldValue("nodeLabelDisplayModeBox",i),this._nodeLabelDisplayModeGroup=this._createCtrlGroup(s,l,e.$L("ChemWidgetTexts.CAPTION_NODE_LABEL_DISPLAY_MODE"),i)}this.setPropStoreFieldValue("fontPanel",t);var h=this._valueStorage;return h&&this._updateUiValuesFromStorage(h),t},doCreateWidget:function(){var t=new e.Widget.DropDownButton(this.getEditor());return t.setHint(e.$L("ChemWidgetTexts.HINT_TEXT_FORMAT")),t.setText(e.$L("ChemWidgetTexts.CAPTION_TEXT_FORMAT")),t.setShowText(!1),t.setButtonKind(e.Widget.Button.Kinds.DROPDOWN),t.addClassName(r.COMPOSER_TEXTFORMAT_BUTTON),t.setDropDownWidgetGetter(this._doCreateDropDownPanel.bind(this)),t},_filterNodeLabelDisplayModeTargets:function(t){for(var r=[],i=0,n=t.length;i<n;++i){var a=t[i];a instanceof e.ChemStructureNode&&(a instanceof e.StructureFragment&&a.hasCtab(),r.push(a))}return r},_hasNodeLabelDisplayModeTarget:function(e){return!!this._filterNodeLabelDisplayModeTargets(e).length},_updateUiValuesFromStorage:function(t){this.getFontPanel()&&(this.getFontNameBox()&&this.getFontNameBox().setValue(t.fontName),this.getFontSizeBox()&&this.getFontSizeBox().setValue(t.fontSize),this.getTextDirectionBox()&&this.getTextDirectionBox().setValue(t.textDirection),this.getTextHorizontalAlignBox()&&this.getTextHorizontalAlignBox().setValue(t.textHAlign),this.getTextVerticalAlignBox()&&this.getTextVerticalAlignBox().setValue(t.textVAlign),this.getNodeLabelDisplayModeBox()&&this.getNodeLabelDisplayModeBox().setValue(t.nodeDisplayMode),this._nodeLabelDisplayModeGroup&&e.StyleUtils.setDisplay(this._nodeLabelDisplayModeGroup,t.hasNodeLabelDisplayModeTarget))},doLoadFromTargets:function(t,r){if(r&&r.length){var i=this._valueStorage;i.fontName=this.getRenderOptionValue(r,"fontFamily")||"",i.fontSize=this.getRenderOptionValue(r,"fontSize")||void 0,i.textDirection=this.getRenderOptionValue(r,"charDirection")||e.Render.TextDirection.DEFAULT,i.textHAlign=this.getRenderOptionValue(r,"horizontalAlign")||e.Render.TextAlign.DEFAULT,i.textVAlign=this.getRenderOptionValue(r,"verticalAlign")||e.Render.TextAlign.DEFAULT,i.nodeDisplayMode=this.getRenderOptionValue(this._filterNodeLabelDisplayModeTargets(r),"nodeDisplayMode")||e.Render.NodeLabelDisplayMode.DEFAULT,i.hasNodeLabelDisplayModeTarget=this._hasNodeLabelDisplayModeTarget(r),this.getFontPanel()&&this._updateUiValuesFromStorage(i)}},doApplyToTargets:function($super,e,t){},fillFontSizeBox:function(t){for(var r=this.getEditorConfigs().getStyleSetterConfigs().getListedFontSizes(),i=[{text:e.$L("ChemWidgetTexts.S_VALUE_DEFAULT"),value:void 0}],n=0,a=r.length;n<a;++n)i.push({text:r[n]+" px",value:r[n]});t.setItems(i)},fillFontNameBox:function(t){for(var r=this.getEditorConfigs().getStyleSetterConfigs().getListedFontNames(),i=[{text:e.$L("ChemWidgetTexts.S_VALUE_DEFAULT"),value:""}],n=0,a=r.length;n<a;++n)i.push({text:r[n],value:r[n]});t.setItems(i)},fillNodeDisplayModeBox:function(t){var r=e.Render.NodeLabelDisplayMode,i=[{text:e.$L("ChemWidgetTexts.CAPTION_NODE_LABEL_DISPLAY_MODE_DEFAULT"),value:r.DEFAULT},{text:e.$L("ChemWidgetTexts.CAPTION_NODE_LABEL_DISPLAY_MODE_SHOWN"),value:r.SHOWN},{text:e.$L("ChemWidgetTexts.CAPTION_NODE_LABEL_DISPLAY_MODE_HIDDEN"),value:r.HIDDEN},{text:e.$L("ChemWidgetTexts.CAPTION_NODE_LABEL_DISPLAY_MODE_SMART"),value:r.SMART}];t.setItems(i)}}),e.Editor.ObjModifierManager.register(e.ChemObject,[e.Editor.ObjModifier.RichText]),e}},function(e,t,r){"use strict";var i=r(0).Class;r(0).DataType;e.exports=function(e){var t=e.ArrayUtils,r=e.DomUtils,n=(e.HtmlElementUtils,e.Widget.HtmlClassNames),a=e.ChemWidget.HtmlClassNames;e.ChemWidget.ComponentWidgetNames;e.ChemWidget.HtmlClassNames=Object.extend(e.ChemWidget.HtmlClassNames,{COMPOSER_ATOM_MODIFIER_BUTTON:"K-Chem-Composer-AtomModifier-Button",COMPOSER_ATOM_MODIFIER_DROPDOWN:"K-Chem-Composer-AtomModifier-DropDown",COMPOSER_BOND_MODIFIER_BUTTON:"K-Chem-Composer-BondModifier-Button",COMPOSER_BOND_MODIFIER_DROPDOWN:"K-Chem-Composer-BondModifier-DropDown",COMPOSER_CHARGE_MODIFIER_BUTTON:"K-Chem-Composer-ChargeModifier-Button",COMPOSER_CHARGE_MODIFIER_DROPDOWN:"K-Chem-Composer-ChargeModifier-DropDown"}),e.Editor.ObjModifier.ChemStructureModifier=i.create(e.Editor.ObjModifier.Base,{CLASS_NAME:"Kekule.Editor.ObjModifier.ChemStructureModifier",installValueChangeEventHandler:function(e){}}),e.Editor.ObjModifier.ChemStructureModifier.getCategories=function(){return[e.Editor.ObjModifier.Category.CHEM_STRUCTURE]},e.Editor.ObjModifier.Atom=i.create(e.Editor.ObjModifier.ChemStructureModifier,{CLASS_NAME:"Kekule.Editor.ObjModifier.Atom",initialize:function($super,e){$super(e),this._valueStorage={}},initProperties:function(){this.defineProp("atomSetter",{dataType:"Kekule.Widget.BaseWidget",serializable:!1,setter:null})},doCreateWidget:function(){var t=new e.Widget.DropDownButton(this.getEditor());return t.setHint(e.$L("ChemWidgetTexts.HINT_ATOM_MODIFIER")),t.setText(e.$L("ChemWidgetTexts.CAPTION_ATOM_MODIFIER")),t.setShowText(!0),t.setButtonKind(e.Widget.Button.Kinds.DROPDOWN),t.addClassName(a.COMPOSER_ATOM_MODIFIER_BUTTON),t.setDropDownWidgetGetter(this._createAtomSetter.bind(this)),t},_createAtomSetter:function(i){i||(i=this.getEditor());var o=this.getEditor(),s=new e.ChemWidget.StructureNodeSetter(i);s.addClassName([n.PANEL,a.COMPOSER_ATOM_MODIFIER_DROPDOWN,n.CORNER_ALL]),s.setLabelConfigs(this.getEditor().getRenderConfigs().getDisplayLabelConfigs());var l=i.getDocument().createElement("div");l.className=n.PANEL_CAPTION,r.setElementText(l,e.$L("ChemWidgetTexts.CAPTION_ATOM_MODIFIER"));var d=s.getElement();d.insertBefore(l,e.DomUtils.getFirstChildElem(d));var u=t.clone(this.getEditor().getEditorConfigs().getStructureConfigs().getPrimaryOrgChemAtoms());u.push("...");var c=o&&o.getEnabledNonAtomInputData&&o.getEnabledNonAtomInputData();s.setSelectableInfos({elementSymbols:u,nonElementInfos:c,subGroupRepItems:e.Editor.StoredSubgroupRepositoryItem2D.getAllRepItems()});var h=this;return s.addEventListener("valueChange",function(e){h.applyToTargets(),s.dismiss()}),this.setPropStoreFieldValue("atomSetter",s),this._valueStorage.nodes&&s.setNodes(this._valueStorage.nodes),s},_filterStructureNodes:function(t){for(var r=[],i=0,n=t.length;i<n;++i){var a=t[i];a instanceof e.ChemStructureNode&&r.push(a)}return r},_getActualModificationNodes:function(r,i){for(var n=[],a=0,o=r.length;a<o;++a){var s=r[a];if(s instanceof e.StructureFragment&&s.isExpanded()){var l=this._getActualModificationNodes(s.getNodes(),!0);t.pushUnique(n,l)}else n.push(s)}return i||(n=this._filterStructureNodes(n)),n},doLoadFromTargets:function(t,r){var i,n=this._getActualModificationNodes(r);this._valueStorage.nodes=n,this.getAtomSetter()&&(this.getAtomSetter().setLabelConfigs(this.getEditor().getRenderConfigs().getDisplayLabelConfigs()),this.getAtomSetter().setNodes(n)),i=e.Editor.StructureUtils.getAllChemStructureNodesHtmlCode(n,null,null,this.getEditor().getRenderConfigs().getDisplayLabelConfigs()),this.getWidget().setText(i||e.$L("ChemWidgetTexts.CAPTION_ATOM_MODIFIER_MIXED")).setShowText(!0).setDisplayed(!!n.length)},doApplyToTargets:function($super,t,r){for(var i=this.getAtomSetter().getValue(),n=[],a=this._getActualModificationNodes(r),o=0,s=a.length;o<s;++o){var l=a[o];if(l instanceof e.ChemStructureNode){var d=this._createNewDataToAtomOperation(i,l);d&&n.push(d)}}var u;if(u=n.length>1?new e.MacroOperation(n):n[0]){this.getEditor().execOperation(u)}},_createNewDataToAtomOperation:function(t,r){if(t){var i,n=t.nodeClass,a=t.props,o=t.repositoryItem;if(o){var s=o.createObjects(r)||{},l=s.objects,d=e.Editor.RepositoryStructureUtils.calcRepObjInitialTransformParams(this.getEditor(),o,s,r,null);this.getEditor().transformCoordAndSizeOfObjects(l,d),i=l[0],n=i.getClass()}return t.isUnknownPseudoatom&&!this.getEditorConfigs().getInteractionConfigs().getAllowUnknownAtomSymbol()&&(n=null),n?this._createModificationOperation(r,i,n,a):(e.error(e.$L("ErrorMsg.INVALID_ATOM_SYMBOL")),null)}},_createModificationOperation:function(t,r,i,n){var r,a,o,s=t.getClass();if(r&&!i&&(i=r.getClass()),r||i!==s){a=new e.MacroOperation,r||(r=new i);var l=new e.ChemStructureNode;l.assign(t),r.assign(l);var d=new e.ChemStructOperation.ReplaceNode(t,r,null,this.getEditor());a.add(d)}else r=t;return n&&(o=new e.ChemObjOperation.Modify(r,n,this.getEditor()),a&&a.add(o)),a||o}}),e.Editor.ObjModifier.Bond=i.create(e.Editor.ObjModifier.ChemStructureModifier,{CLASS_NAME:"Kekule.Editor.ObjModifier.Bond",initialize:function($super,e){$super(e),this._activeSelBtnHtmlClass=null,this._defaultBondTypeData=null,this._valueStorage={};var t=this.getEditor().getEnabledBondFormData();this._defaultBondTypeData=t[0]},initProperties:function(){this.defineProp("bondSelector",{dataType:"Kekule.Widget.BaseWidget",serializable:!1,setter:null})},doCreateWidget:function(){var t=new e.Widget.DropDownButton(this.getEditor());return t.setHint(e.$L("ChemWidgetTexts.HINT_BOND_MODIFIER")),t.setText(e.$L("ChemWidgetTexts.CAPTION_BOND_MODIFIER")),t.setShowText(!1),t.setButtonKind(e.Widget.Button.Kinds.DROPDOWN),t.addClassName(a.COMPOSER_BOND_MODIFIER_BUTTON),t.setDropDownWidgetGetter(this._createBondSelector.bind(this)),this._defaultBondTypeData.htmlClass&&t.addClassName(this._defaultBondTypeData.htmlClass),t},_filterBond:function(t){for(var r=[],i=0,n=t.length;i<n;++i){var a=t[i];a instanceof e.Bond&&r.push(a)}return r},_getActualModificationBonds:function(r,i){for(var n=[],a=0,o=r.length;a<o;++a){var s=r[a];if(s instanceof e.StructureFragment&&s.isExpanded()){var l=this._getActualModificationBonds(s.getNodes(),!0);t.pushUnique(n,l),t.pushUnique(n,s.getConnectors())}else s instanceof e.Bond&&n.push(s)}return i||(n=this._filterBond(n)),n},_createBondSelector:function(t){t||(t=this.getEditor());var r=new e.ChemWidget.StructureConnectorSelectPanelAdv(t);if(r.setCaption(e.$L("ChemWidgetTexts.CAPTION_BOND_MODIFIER")),r.addClassName(a.COMPOSER_BOND_MODIFIER_DROPDOWN),this.getEditor().getEnabledBondFormData){var i=this.getEditor().getEnabledBondFormData();r.setBondPropNames(this._getBondComparePropNames(i)),r.setBondData(i);var n=this.getEditor().getEditorConfigs().getInteractionConfigs().getEnableBondKekulizeHucklize();r.setExtraComponents(n?[e.ChemWidget.StructureConnectorSelectPanelAdv.Components.KEKULIZE]:[])}this._valueStorage.bondsPropValues&&r.setActiveBondPropValues(this._valueStorage.bondsPropValues),this.setPropStoreFieldValue("bondSelector",r);var o=this;return r.addEventListener("valueChange",function(e){o.applyToTargets(),r.dismiss()}),r.addEventListener("command",function(e){o.execExtraCommand(e.command)}),r},_setActiveBondHtmlClass:function(e){var t=this._activeSelBtnHtmlClass;t&&this.getWidget().removeClassName(t),this._activeSelBtnHtmlClass=e,e||(e=this._defaultBondTypeData.htmlClass),e&&this.getWidget().addClassName(e)},_extractBondPropValues:function(e,t){return e.getPropValues(t)},_extractBondsPropValues:function(t,r){for(var i,n,a=0,o=t.length;a<o;++a)if(n=this._extractBondPropValues(t[a],r),i){if(!e.Editor.StructureUtils.isBondPropsMatch(i,n,r)){i=null;break}}else i=n;return i},_getBondComparePropNames:function(r){for(var i=[],n=0,a=r.length;n<a;++n){var o=r[n],s=o.bondProps;s&&t.pushUnique(i,e.ObjUtils.getOwnedFieldNames(s))}return i},_getMatchedBondData:function(t,r,i){if(!t)return null;for(var n=0,a=r.length;n<a;++n){var o=r[n];if(o&&e.Editor.StructureUtils.isBondPropsMatch(t,o.bondProps,i))return o}return null},_createBondModificationOperation:function(t,r){return new e.ChemObjOperation.Modify(r,t,this.getEditor())},_execModificationOperations:function(t){var r;if(r=t.length>1?new e.MacroOperation(t):t[0]){this.getEditor().execOperation(r)}},doLoadFromTargets:function(e,t){var r=this.getEditor().getEnabledBondFormData();this._defaultBondTypeData=r[0];var i=this._getActualModificationBonds(t);if(this._valueStorage.connectors=i,this.getBondSelector()){var n=this.getBondSelector().getBondPropNames(),a=this._extractBondsPropValues(i,n);this.getBondSelector().setActiveBondPropValues(a),this._setActiveBondHtmlClass(this.getBondSelector().getActiveBondHtmlClass())}else{this._valueStorage.bondPropNames=this._getBondComparePropNames(r),this._valueStorage.bondsPropValues=this._extractBondsPropValues(i,this._valueStorage.bondPropNames);var o=this._getMatchedBondData(this._valueStorage.bondsPropValues,r,this._valueStorage.bondPropNames);this._setActiveBondHtmlClass(o&&o.htmlClass)}this.getWidget().setDisplayed(!!i.length)},doApplyToTargets:function($super,e,t){for(var r=this.getBondSelector().getActiveBondPropValues(),i=[],n=this._getActualModificationBonds(t),a=0,o=n.length;a<o;++a){var s=n[a],l=this._createBondModificationOperation(r,s);l&&i.push(l)}this._execModificationOperations(i),this._setActiveBondHtmlClass(this.getBondSelector().getActiveBondHtmlClass())},execExtraCommand:function(t){var r=this._getActualModificationBonds(this.getTargetObjs());if(r&&r.length){var i=this.getEditor().getChemObj();if(i&&i.getKekulizationChanges){var n,a=e.ChemWidget.StructureConnectorSelectPanelAdv.Commands;if(t===a.KEKULIZE?n=i.getKekulizationChanges(r):t===a.HUCKLIZE&&(n=i.getHucklizationChanges(r)),n&&n.length){for(var o=[],s=0,l=n.length;s<l;++s){var d=n[s].bond,u=n[s].bondOrder,c=this._createBondModificationOperation({bondOrder:u},d);o.push(c)}this._execModificationOperations(o)}}}},_getKekulizeOrHucklizeBondModifications:function(e){this.getEditor()}}),e.Editor.ObjModifier.Charge=i.create(e.Editor.ObjModifier.ChemStructureModifier,{CLASS_NAME:"Kekule.Editor.ObjModifier.Charge",initialize:function($super,e){$super(e),this._valueStorage={}},initProperties:function(){this.defineProp("chargeSelector",{dataType:"Kekule.Widget.BaseWidget",serializable:!1,setter:null})},doCreateWidget:function(){var t=new e.Widget.DropDownButton(this.getEditor());return t.setHint(e.$L("ChemWidgetTexts.HINT_CHARGE_MODIFIER")).setText(e.$L("ChemWidgetTexts.TEXT_CHARGE_UNKNOWN")).setShowText(!0).setButtonKind(e.Widget.Button.Kinds.DROPDOWN),t.addClassName(a.COMPOSER_CHARGE_MODIFIER_BUTTON),t.setDropDownWidgetGetter(this._createChargeSelector.bind(this)),t},_createChargeSelector:function(t){t||(t=this.getEditor());var r=new e.ChemWidget.ChargeSelectPanel(t);r.setCaption(e.$L("ChemWidgetTexts.CAPTION_CHARGE_MODIFIER")),r.addClassName(a.COMPOSER_CHARGE_MODIFIER_DROPDOWN),e.ObjUtils.notUnset(this._valueStorage.charge)&&r.setValue(this._valueStorage.charge),this.setPropStoreFieldValue("chargeSelector",r);var i=this;return r.addEventListener("valueChange",function(e){i.applyToTargets(),r.dismiss()}),r},_filterStructureNodes:function(t){for(var r=[],i=0,n=t.length;i<n;++i){var a=t[i];a instanceof e.ChemStructureNode&&a.getCharge&&r.push(a)}return r},_getActualModificationNodes:function(r,i){for(var n=[],a=0,o=r.length;a<o;++a){var s=r[a];if(s instanceof e.StructureFragment&&s.isExpanded()){var l=this._getActualModificationNodes(s.getNodes(),!0);t.pushUnique(n,l)}else n.push(s)}return i||(n=this._filterStructureNodes(n)),n},_getChargeOfNodes:function(e){for(var t=null,r=0,i=e.length;r<i;++r){var n=e[r];if(n.getCharge){var a=n.getCharge()||0;if(null===t)t=a;else if(t!==a)return null}}return t},doLoadFromTargets:function(t,r){var i=this._getActualModificationNodes(r),n=i.length>=0&&i.length<=1;if(n){var a=this._getChargeOfNodes(i);this._valueStorage.charge=a,this.getChargeSelector()&&this.getChargeSelector().setValue(a);var o;if(a){var s=a>0?e.$L("ChemWidgetTexts.TEXT_CHARGE_POSITIVE"):e.$L("ChemWidgetTexts.TEXT_CHARGE_NEGATIVE"),l=e.NumUtils.toDecimals(a,1);o=Math.abs(l)+s}else o=e.$L("ChemWidgetTexts.TEXT_CHARGE_UNKNOWN");this.getWidget().setText(o).setShowText(!0)}this.getWidget().setDisplayed(n)},doApplyToTargets:function($super,t,r){for(var i=this.getChargeSelector().getValue(),n=[],a=this._getActualModificationNodes(r),t=this.getEditor(),o=0,s=a.length;o<s;++o){var l=a[o];if(l instanceof e.ChemStructureNode){var d=new e.ChemObjOperation.Modify(l,{charge:i},t);d&&n.push(d)}}var u;if(u=n.length>1?new e.MacroOperation(n):n[0]){var t=this.getEditor();t.execOperation(u)}}});var o=e.Editor.ObjModifierManager;return o.register(e.ChemStructureNode,[e.Editor.ObjModifier.Atom]),o.register(e.ChemStructureNode,[e.Editor.ObjModifier.Charge]),o.register([e.Bond,e.StructureFragment],[e.Editor.ObjModifier.Bond]),e}},function(e,t,r){"use strict";var i=r(0).Class,n=r(0).ClassEx,a=(r(0).ObjectEx,r(0).DataType);e.exports=function(e){var t=e.PropertyEditor.EditorAttributes;return e.PropertyEditor.ChemIdEditor=i.create(e.PropertyEditor.SimpleEditor,{CLASS_NAME:"Kekule.PropertyEditor.ChemIdEditor",getAttributes:function($super){var e=$super();return e&t.MULTIOBJS&&(e^=t.MULTIOBJS),e}}),e.PropertyEditor.register(e.PropertyEditor.ChemIdEditor,null,e.ChemObject,"id"),e.PropertyEditor.ChemCoordSizeFieldEditor=i.create(e.PropertyEditor.SimpleEditor,{CLASS_NAME:"Kekule.PropertyEditor.ChemCoordSizeFieldEditor",initProperties:function(){this.defineProp("parentObjects",{dataType:a.Object,serializable:!1}),this.defineProp("parentPropName",{dataType:a.STRING,serializable:!1})},getCoordFieldValue:function(e,t,r){if(e.length){var i=e[0].getPropValue(t);if(i){for(var n=i[r],a=1,o=e.length;a<o;++a){if(e[a].getPropValue(t)[r]!==n)return}return n}}},getValue:function($super){var e=this.getParentObjects(),t=this.getParentPropName();return e&&t?this.getCoordFieldValue(e,t,this.getPropertyName()):$super()}}),e.PropertyEditor.ChemCoordEditor=i.create(e.PropertyEditor.ObjectEditor,{CLASS_NAME:"Kekule.PropertyEditor.ChemCoordEditor",is3DCoord:function(){return this.getPropertyName().indexOf("3")>=0},getFieldEditorClass:function(t,r){return e.PropertyEditor.ChemCoordSizeFieldEditor},createFieldEditor:function($super,e,t){var r=$super(e,t);return r.setParentObjects&&r.setParentObjects(this.getObjects()),r.setParentPropName&&r.setParentPropName(this.getPropertyName()),r},getFieldValueType:function(e,t){return a.FLOAT},getObjFields:function(e){return this.is3DCoord()?["x","y","z"]:["x","y"]},getValueText:function($super){var t=e.Widget.ValueListEditor.ValueDisplayMode;if(this.getValueTextMode()===t.JSON)return $super();var r=this.getValue();if(r){for(var i=this.getObjFields(),n="",a=0,o=i.length;a<o;++a){var s=r[i[a]];e.ObjUtils.notUnset(s)&&(n&&(n+=", "),n+=i[a]+": "+s)}return"{"+n+"}"}return""}}),e.PropertyEditor.register(e.PropertyEditor.ChemCoordEditor,null,e.ChemObject,"coord2D"),e.PropertyEditor.register(e.PropertyEditor.ChemCoordEditor,null,e.ChemObject,"coord3D"),e.PropertyEditor.register(e.PropertyEditor.ChemCoordEditor,null,e.ChemObject,"absCoord2D"),e.PropertyEditor.register(e.PropertyEditor.ChemCoordEditor,null,e.ChemObject,"absCoord3D"),e.PropertyEditor.ChemSizeEditor=i.create(e.PropertyEditor.ObjectEditor,{CLASS_NAME:"Kekule.PropertyEditor.ChemSizeEditor",is3DSize:function(){return this.getPropertyName().indexOf("3")>=0},getFieldEditorClass:function(t,r){return e.PropertyEditor.ChemCoordSizeFieldEditor},createFieldEditor:function($super,e,t){var r=$super(e,t);return r.setParentObjects&&r.setParentObjects(this.getObjects()),r.setParentPropName&&r.setParentPropName(this.getPropertyName()),r},getFieldValueType:function(e,t){return a.FLOAT},getObjFields:function(e){return this.is3DSize()?["x","y","z"]:["x","y"]},getValueText:function($super){var t=e.Widget.ValueListEditor.ValueDisplayMode;if(this.getValueTextMode()===t.JSON)return $super();var r=this.getValue();if(r){for(var i=this.getObjFields(),n="",a=0,o=i.length;a<o;++a){var s=r[i[a]];e.ObjUtils.notUnset(s)&&(n&&(n+=", "),n+=i[a]+": "+s)}return"{"+n+"}"}return""}}),e.PropertyEditor.register(e.PropertyEditor.ChemSizeEditor,null,e.ChemObject,"size2D"),e.PropertyEditor.register(e.PropertyEditor.ChemSizeEditor,null,e.ChemObject,"size3D"),e.PropertyEditor.register(e.PropertyEditor.ChemSizeEditor,null,e.ChemObject,"screenSize"),e.PropertyEditor.ChemOptionObjectEditor=i.create(e.PropertyEditor.ObjectEditor,{CLASS_NAME:"Kekule.PropertyEditor.ChemOptionObjectEditor",CHILD_FIELD_INFOS:null,initialize:function($super){$super(),this.setAllowEmpty(!0)},getObjFieldInfos:function(e){for(var t=n.getCommonSuperClass(this.getObjects()),r=[],i=this.CHILD_FIELD_INFOS,a=0,o=i.length;a<o;++a){var s=i[a];s.targetClass&&t&&!n.isOrIsDescendantOf(t,s.targetClass)||r.push(s)}return r.sort(function(e,t){return e.name>t.name?1:e.name<t.name?-1:0}),r},notifyChildEditorValueChange:function($super,t,r){var i=this.getValue()||this._initialObjValue;i=Object.extend({},i),e.ObjUtils.notUnset(r)?i[t]=r:delete i[t],this.setValue(i)}}),e.PropertyEditor.ChemRender2DOptionsEditor=i.create(e.PropertyEditor.ChemOptionObjectEditor,{CLASS_NAME:"Kekule.PropertyEditor.ChemRender2DOptionsEditor",CHILD_FIELD_INFOS:[{name:"expanded",dataType:a.BOOL,targetClass:e.StructureFragment},{name:"unitLength",dataType:a.FLOAT,targetClass:e.ChemObject},{name:"moleculeDisplayType",dataType:a.INT,enumSource:e.Render.MoleculeDisplayType,targetClass:e.StructureFragment},{name:"renderType",dataType:a.INT,enumSource:e.Render.BondRenderType,targetClass:e.ChemStructureConnector},{name:"nodeDisplayMode",dataType:a.INT,enumSource:e.Render.NodeLabelDisplayMode,targetClass:e.ChemStructureNode},{name:"hydrogenDisplayLevel",dataType:a.INT,enumSource:e.Render.HydrogenDisplayLevel,targetClass:e.ChemStructureNode},{name:"showCharge",dataType:a.BOOL,targetClass:e.ChemStructureNode},{name:"chargeMarkType",dataType:a.INT,enumSource:e.Render.ChargeMarkRenderType,targetClass:e.ChemStructureNode},{name:"chargeMarkFontSize",dataType:a.FLOAT,targetClass:e.ChemStructureNode},{name:"chargeMarkMargin",dataType:a.FLOAT,targetClass:e.ChemStructureNode},{name:"chemMarkerFontSize",dataType:a.FLOAT,targetClass:e.ChemStructureNode},{name:"chemMarkerMargin",dataType:a.FLOAT,targetClass:e.ChemStructureNode},{name:"distinguishSingletAndTripletRadical",dataType:a.BOOL,targetClass:e.ChemStructureNode},{name:"fontSize",dataType:a.NUMBER},{name:"fontFamily",dataType:a.STRING},{name:"supFontSizeRatio",dataType:a.FLOAT},{name:"subFontSizeRatio",dataType:a.FLOAT},{name:"superscriptOverhang",dataType:a.FLOAT},{name:"subscriptOversink",dataType:a.FLOAT},{name:"textBoxXAlignment",dataType:a.INT,enumSource:e.Render.BoxXAlignment},{name:"textBoxYAlignment",dataType:a.INT,enumSource:e.Render.BoxYAlignment},{name:"horizontalAlign",dataType:a.INT,enumSource:e.Render.TextAlign},{name:"verticalAlign",dataType:a.INT,enumSource:e.Render.TextAlign},{name:"charDirection",dataType:a.INT,enumSource:e.Render.TextDirection},{name:"customLabel",dataType:a.STRING,targetClass:e.ChemStructureNode},{name:"bondLineWidth",dataType:a.NUMBER,targetClass:e.ChemStructureObject},{name:"boldBondLineWidth",dataType:a.NUMBER,targetClass:e.ChemStructureObject},{name:"hashSpacing",dataType:a.NUMBER,targetClass:e.ChemStructureObject},{name:"multipleBondSpacingRatio",dataType:a.NUMBER,targetClass:e.ChemStructureObject},{name:"multipleBondSpacingAbs",dataType:a.NUMBER,targetClass:e.ChemStructureObject},{name:"multipleBondMaxAbsSpacing",dataType:a.NUMBER,targetClass:e.ChemStructureObject},{name:"bondArrowLength",dataType:a.NUMBER,targetClass:e.ChemStructureObject},{name:"bondArrowWidth",dataType:a.NUMBER,targetClass:e.ChemStructureObject},{name:"bondWedgeWidth",dataType:a.NUMBER,targetClass:e.ChemStructureObject},{name:"bondWedgeHashMinWidth",dataType:a.NUMBER,targetClass:e.ChemStructureObject},{name:"bondLengthScaleRatio",dataType:a.NUMBER,targetClass:e.ChemStructureObject},{name:"color",dataType:a.STRING},{name:"atomColor",dataType:a.STRING,targetClass:e.ChemStructureNode},{name:"bondColor",dataType:a.STRING,targetClass:e.ChemStructureObject},{name:"useAtomSpecifiedColor",dataType:a.BOOL,targetClass:e.ChemStructureObject},{name:"opacity",dataType:a.FLOAT,targetClass:e.ChemObject},{name:"fillColor",dataType:a.STRING},{name:"strokeColor",dataType:a.STRING},{name:"strokeWidth",dataType:a.NUMBER},{name:"atomRadius",dataType:a.NUMBER,targetClass:e.ChemStructureObject}]}),e.PropertyEditor.register(e.PropertyEditor.ChemRender2DOptionsEditor,null,e.ChemObject,"renderOptions"),e.PropertyEditor.ChemRender3DOptionsEditor=i.create(e.PropertyEditor.ChemOptionObjectEditor,{CLASS_NAME:"Kekule.PropertyEditor.ChemRender3DOptionsEditor",CHILD_FIELD_INFOS:[{name:"displayMultipleBond",dataType:a.BOOL,targetClass:e.ChemStructureNode},{name:"useVdWRadius",dataType:a.BOOL,targetClass:e.ChemStructureNode},{name:"nodeRadius",dataType:a.NUMBER,targetClass:e.ChemStructureNode},{name:"connectorRadius",dataType:a.NUMBER,targetClass:e.ChemStructureObject},{name:"nodeRadiusRatio",dataType:a.NUMBER,targetClass:e.ChemStructureNode},{name:"connectorRadiusRatio",dataType:a.NUMBER,targetClass:e.ChemStructureObject},{name:"connectorLineWidth",dataType:a.NUMBER,targetClass:e.ChemStructureObject},{name:"color",dataType:a.STRING},{name:"atomColor",dataType:a.STRING,targetClass:e.ChemStructureObject},{name:"bondColor",dataType:a.STRING,targetClass:e.ChemStructureObject},{name:"useAtomSpecifiedColor",dataType:a.BOOL,targetClass:e.ChemStructureObject},{name:"hideHydrogens",dataType:a.BOOL,targetClass:e.StructureFragment},{name:"bondSpliceMode",dataType:a.INT,enumSource:e.Render.Bond3DSpliceMode,targetClass:e.ChemStructureObject}]}),e.PropertyEditor.register(e.PropertyEditor.ChemRender3DOptionsEditor,null,e.ChemObject,"render3DOptions"),e.PropertyEditor.GlyphPathParamsEditor=i.create(e.PropertyEditor.ChemOptionObjectEditor,{CLASS_NAME:"Kekule.PropertyEditor.GlyphPathParamsEditor",CHILD_FIELD_INFOS:[{name:"lineCount",dataType:a.INT,targetClass:e.Glyph.PathGlyphConnector},{name:"lineGap",dataType:a.FLOAT,targetClass:e.Glyph.PathGlyphConnector},{name:"startArrowType",dataType:a.STRING,enumSource:e.Glyph.ArrowType,targetClass:e.Glyph.PathGlyphConnector},{name:"startArrowSide",dataType:a.INT,enumSource:e.Glyph.ArrowSide,targetClass:e.Glyph.PathGlyphConnector},{name:"startArrowLength",dataType:a.FLOAT,targetClass:e.Glyph.PathGlyphConnector},{name:"startArrowWidth",dataType:a.FLOAT,targetClass:e.Glyph.PathGlyphConnector},{name:"endArrowType",dataType:a.INT,enumSource:e.Glyph.ArrowType,targetClass:e.Glyph.PathGlyphConnector},{name:"endArrowSide",dataType:a.INT,enumSource:e.Glyph.ArrowSide,targetClass:e.Glyph.PathGlyphConnector},{name:"endArrowLength",dataType:a.FLOAT,targetClass:e.Glyph.PathGlyphConnector},{name:"endArrowWidth",dataType:a.FLOAT,targetClass:e.Glyph.PathGlyphConnector}]}),e.PropertyEditor.GlyphPathNodeParamsEditor=i.create(e.PropertyEditor.ChemOptionObjectEditor,{CLASS_NAME:"Kekule.PropertyEditor.GlyphPathNodeParamsEditor",CHILD_FIELD_INFOS:[{name:"useStickingOffset",dataType:a.BOOL,targetClass:e.Glyph.PathGlyphNode},{name:"stickingOffsetRelLength",dataType:a.FLOAT,targetClass:e.Glyph.PathGlyphNode}]}),e.PropertyEditor.GlyphPathNodeParamsEditor=i.create(e.PropertyEditor.ChemOptionObjectEditor,{CLASS_NAME:"Kekule.PropertyEditor.GlyphPathNodeParamsEditor",CHILD_FIELD_INFOS:[{name:"useStickingOffset",dataType:a.BOOL,targetClass:e.Glyph.PathGlyphNode},{name:"stickingOffsetRelLength",dataType:a.FLOAT,targetClass:e.Glyph.PathGlyphNode}]}),e.PropertyEditor.register(e.PropertyEditor.GlyphPathNodeParamsEditor,null,e.Glyph.PathGlyphNode,"pathNodeParams"),e}},function(e,t,r){"use strict";var i=r(0).Class,n=(r(0).ClassEx,r(0).ObjectEx),a=r(0).DataType;e.exports=function(e){e.Calculator={},e.Calculator.getWorkerBasePath=function(){var t=e.scriptSrcInfo.useMinFile,r=t?"workers/":"calculation/workers/";return r=e.scriptSrcInfo.path+r},e.Calculator.Base=i.create(n,{CLASS_NAME:"Kekule.Calculator.Base",initProperties:function(){this.defineProp("async",{dataType:a.BOOL}),this.defineProp("worker",{dataType:a.OBJECT,setter:null})},initPropValues:function($super){$super(),this.setAsync(!0),this.reactWorkerMessageBind=this.reactWorkerMessage.bind(this),this.reactWorkerErrorBind=this.reactWorkerError.bind(this)},getWorkerBasePath:function(){return e.Calculator.getWorkerBasePath()},execute:function(t,r,i){if(this._doneCallback=t,this._errCallback=r,this._msgCallback=i,this.getAsync()&&this.isWorkerSupported()&&this.createWorker()){var n=this.getWorker();this.workerStartCalc(n)}else{var a,o;try{o=this.executeSync(t)}catch(e){a=e}a?(e.error(a),this.error(a)):o&&(a?this.error(a):this.done())}},executeSync:function(e){},error:function(t){e.error(t),this._errCallback&&this._errCallback(t)},done:function(){this._doneCallback&&this._doneCallback.apply(this,arguments),this.workerJobDone()},halt:function(){var t=this.getWorker();t&&(t.terminate(),this.error(e.$L("ErrorMsg.CALC_TERMINATED_BY_USER")))},isWorkerSupported:function(){return e.BrowserFeature.workers},createWorker:function(){if(this.isWorkerSupported()){var e=this.getWorkerScriptFile();if(e){var t=new Worker(e);return t.addEventListener("message",this.reactWorkerMessageBind),t.addEventListener("error",this.reactWorkerErrorBind),this.setPropStoreFieldValue("worker",t),t}}},getWorkerScriptFile:function(){return null},importWorkerScriptFile:function(e){this.postWorkerMessage({type:"importScript",url:e})},postWorkerMessage:function(e){var t=this.getWorker();t&&t.postMessage(e)},reactWorkerMessage:function(e){return this._msgCallback&&this._msgCallback(e.data),this.doReactWorkerMessage(e.data,e)},doReactWorkerMessage:function(e,t){},reactWorkerError:function(t){e.error(t.message),this.error(t.message)},workerStartCalc:function(e){},workerJobDone:function(){var e=this.getWorker();e&&(e.terminate(),this.setPropStoreFieldValue("worker",null))}}),e.Calculator.AbstractStructure3DGenerator=i.create(e.Calculator.Base,{CLASS_NAME:"Kekule.Calculator.AbstractStructure3DGenerator",initProperties:function(){this.defineProp("sourceMol",{dataType:"Kekule.StructureFragment",serializable:!1}),this.defineProp("generatedMol",{dataType:"Kekule.StructureFragment",serializable:!1}),this.defineProp("options",{dataType:a.HASH,getter:function(){var e=this.getPropStoreFieldValue("options");return e||(e={},this.setPropStoreFieldValue("options",e)),e}})}}),e.Calculator.ServiceManager={_services:{},_getServiceClasses:function(e,r){var i=t._services[e];return!i&&r&&(i=[],t._services[e]=i),i},register:function(e,r){var i=t._getServiceClasses(e,!0),n=i.indexOf(r);n>=0&&i.splice(n,1),i.push(r)},unregister:function(e,r){var i=t._getServiceClasses(e,!0),n=i.indexOf(r);n>=0&&i.splice(n,1)},getServiceClass:function(e){var r=null,i=t._getServiceClasses(e);return i&&i.length&&(r=i[i.length-1]),r}};var t=e.Calculator.ServiceManager;return e.Calculator.Services={GEN3D:"3D structure generator"},e.Calculator.generate3D=function(r,i,n,a,o){var s=e.Calculator.Services.GEN3D,l=t.getServiceClass(s);if(l){var d=new l,u=function(){n&&n(d.getGeneratedMol())},c=function(e){a&&a(e)},h=function(e){o&&o(e)};try{d.setSourceMol(r),d.setOptions(i),d.execute(u,c,h)}catch(e){c(e)}return d}var m=e.$L("ErrorMsg.CALC_SERVICE_UNAVAILABLE").format(s);return n&&n(m),null},e}},function(e,t,r){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r(0).Class,r(0).ClassEx,r(0).ObjectEx,r(0).DataType;e.exports=function(e){e.EmscriptenUtils={DEF_MODULE_NAME:"Module",_createdModules:{},_getActualModule:function(r){return e.$jsRoot[r||t.DEF_MODULE_NAME]},isSupported:function(e){return void 0!==t._getActualModule(e)},getRootModule:function(e,r){var i=t._createdModules[e];if(i)return i;var n=t._getActualModule(e);return i=n,"function"==typeof n&&(i=n(r)),i&&(t._createdModules[e]=i),i},getModuleObj:function(e){return"object"===(void 0===e?"undefined":i(e))?e:t.getRootModule(e)},getClassCtor:function(e,r){return(t.getModuleObj(r)||{})[e]},cwrap:function(e,r,i,n){var a=t.getModuleObj(n);return a&&a.cwrap&&a.cwrap(e,r,i)},initModule:function(r,i,n){r||(r=e.$jsRoot.document);var a=i.moduleName,o=i.moduleInitEventName,s=i.moduleInitCallbackName,l=function(e){n&&n(e)};if(t.isModuleReady(a))return void l();try{if(o&&r){var d=function t(){l(),e.X.Event.removeListener(r,o,t)};e.X.Event.addListener(r,o,d)}else s&&(e.$jsRoot[s]=function(){l()});a&&t.getRootModule(a)}catch(e){throw l(e),e}},isModuleReady:function(e){return!!t._createdModules[e]},ensureModuleReady:function(e,r,i){return t.initModule(e,r,i)},loadScript:function(r,i,n,a){n||(n=e.$jsRoot.document);var o=function(e){e?i(e):t.initModule(n,a,i)};if(e.environment.isNode)try{var s=e.environment.nodeRequire(r);a.moduleName&&(e.$jsRoot[a.moduleName]=s),o()}catch(e){throw o(e),e}else e.ScriptFileUtils.appendScriptFile(n,r,o)}};var t=e.EmscriptenUtils;return e}},function(e,t,r){"use strict";var i=r(0).Class;e.exports=function(e){var t=e.EmscriptenUtils,r={usingModulaize:!0,moduleName:"InChIModule",moduleInitEventName:"InChI.Initialized",moduleInitCallbackName:"__$inChIInitialized$__"};e.InChI={_autoEnabled:!0,_scriptLoadedBySelf:!1,_module:null,_enableFuncs:[],SCRIPT_FILE:"inchi.js",isScriptLoaded:function(){return t.isSupported(r.moduleName)},getModule:function(){return n._module||(n._module=t.getRootModule(r.moduleName)),n._module},getInChIPath:function(){var t=e.scriptSrcInfo.useMinFile,r=t?"extra/":"_extras/InChI/";return r=e.scriptSrcInfo.path+r},getInChIScriptUrl:function(){var t=n.getInChIPath()+n.SCRIPT_FILE;return e.scriptSrcInfo.useMinFile||(t+=".dev"),t},loadInChIScript:function(i,a){i||(i=e.$jsRoot.document);var o=function(e){n._scriptLoadedBySelf=!e,a&&a(e)};if(n._scriptLoadedBySelf||n.isScriptLoaded())o();else{var s=n.getInChIScriptUrl();t.loadScript(s,o,i,r)}},molDataToInChI:function(e,t){var r=n._molToInChI;if(!r){r=n.getModule().cwrap("molToInchiJson","string",["string","string"])}var i=r(e,t);return JSON.parse(i)},getInChIInfo:function(t){var r=e.IO.saveFormatData(t,e.IO.DataFormat.MOL);return n.molDataToInChI(r)},enable:function(t){n.isScriptLoaded()?(n._enableAllFunctions(),t&&t()):n.loadInChIScript(e.$jsRoot.document,function(e){e||n._enableAllFunctions(),t&&t(e)})},_enableAllFunctions:function(){if(t.isModuleReady(r.moduleName))for(var e=n._enableFuncs,i=0,a=e.length;i<a;++i){var o=e[i];o&&o()}}};var n=e.InChI;return e.IO.InChIWriter=i.create(e.IO.ChemDataWriter,{CLASS_NAME:"Kekule.IO.InChIWriter",doWriteData:function(e,t,r){var i=n.getInChIInfo(e);if(i&&i.inchi){var a=i.inchi;return i.auxInfo&&(a+="\n"+i.auxInfo),a}return null},isAllowedObj:function(t){var r=e.IO.InChIWriter.ALLOWED_CLASSES;return e.ObjUtils.isInstanceOf(t,r)}}),e.IO.InChIWriter.ALLOWED_CLASSES=[e.StructureFragment,e.Reaction,e.ChemObjList,e.ChemStructureObjectGroup,e.ChemSpaceElement,e.ChemSpace],e.IO.registerAllInChIFormats=function(){if(n.isScriptLoaded()){e.IO.DataFormat.INCHI="inchi",e.IO.MimeType.INCHI="chemical/x-inchi",e.IO.DataFormatsManager.register("inchi",e.IO.MimeType.INCHI,"inchi",e.IO.ChemDataType.TEXT,"InChI format"),e.IO.ChemDataWriterManager.register("inchi",e.IO.InChIWriter,e.IO.InChIWriter.ALLOWED_CLASSES,"inchi")}},e.IO.enableInChIFormats=function(){n.enable()},n._enableFuncs.push(e.IO.registerAllInChIFormats),e._registerAfterLoadSysProc(function(){n._autoEnabled&&n.isScriptLoaded()&&t.ensureModuleReady(e.$jsRoot.document,r,n._enableAllFunctions)}),e}},function(e,t,r){"use strict";e.exports=function(e){return e.LOCAL_RES=!0,e.Localization.setCurrModule("extra.openbabel"),e.Localization.addResource("en","ErrorMsg",{OpenBabel:{CHEM_NODE_TYPE_NOT_SUITABLE:"Unsuitable node type",CHEM_CONNECTOR_TYPE_NOT_SUITABLE:"Unsuitable connector type",ONLY_STR_INPUT_DATA_ALLOWED:"Input data must be text",ONLY_STR_OUTPUT_DATA_ALLOWED:"Output data must be text",FAIL_TO_GENERATE_3D_STRUCTURE:"Fail to generate 3D structure coordinates"}}),e}},function(e,t,r){"use strict";r(0).Class;e.exports=function(e){var t=e.EmscriptenUtils,r={usingModulaize:!0,moduleName:"OpenBabelModule",moduleInitEventName:"OpenBabel.Initialized",moduleInitCallbackName:"__$openBabelInitialized$__"};e.OpenBabel={_autoEnabled:!0,_module:null,SCRIPT_FILE:"openbabel.js",_enableFuncs:[],BondOrder:{SINGLE:1,DOUBLE:2,TRIPLE:3,EXPLICIT_AROMATIC:5},getObInitOptions:function(){return r},getModule:function(){return i._module||(i._module=t.getRootModule(r.moduleName)),i._module},getClassCtor:function(e){return t.getClassCtor(e,i.getModule())},isScriptLoaded:function(){return t.isSupported(r.moduleName)},isModuleReady:function(){return t.isModuleReady(r.moduleName)},enable:function(t){i.isScriptLoaded()?(i._enableAllFunctions(),t&&t()):i.loadObScript(e.$jsRoot.document,function(e){e||i._enableAllFunctions(),t&&t(e)})},_enableAllFunctions:function(){if(i.isModuleReady())for(var e=i._enableFuncs,t=0,r=e.length;t<r;++t){var n=e[t];n&&n()}}};var i=e.OpenBabel;return e._registerAfterLoadSysProc(function(){i._autoEnabled&&i.isScriptLoaded()&&t.ensureModuleReady(e.$jsRoot.document,r,i._enableAllFunctions)}),e.OpenBabel.getObPath=function(){var t=e.scriptSrcInfo.useMinFile,r=t?"extra/":"_extras/OpenBabel/";return r=e.scriptSrcInfo.path+r},e.OpenBabel.getObScriptUrl=function(){var t=e.OpenBabel.getObPath()+e.OpenBabel.SCRIPT_FILE;return e.scriptSrcInfo.useMinFile||(t+=".dev"),t},e.OpenBabel.loadObScript=function(n,a){n||(n=e.$jsRoot.document);var o=function(e){i._obScriptLoadedBySelf=!e,a&&a(e)};if(i._obScriptLoadedBySelf||i.isScriptLoaded())o();else{var s=e.OpenBabel.getObScriptUrl();t.loadScript(s,o,n,r)}},e.OpenBabel.AdaptUtils={DEF_ATOM_ID_PREFIX:"A",DEF_BOND_ID_PREFIX:"B",DEF_MOL_ID_PREFIX:"M",wrapCFuncs:function(){if(!e.OpenBabel._funcInited){var t={};Object.extend(e.OpenBabel,t),e.OpenBabel._funcInited=!0}},isAvailable:function(){return void 0!==i.getClassCtor("ObBaseHelper")},obObjToKekule:function(t){var r=e.OpenBabel.AdaptUtils,i=e.ObjUtils.getPrototypeOf(t).constructor.name;return("OBReaction"===i?r.obReactionToKekule:"OBMol"===i?r.obMolToKekule:"OBAtom"===i?r.obAtomToKekule:"OBBond"===i?r.obBondToKekule:r.obBaseToKekule)(t)},kObjToOB:function(t){var r=e.OpenBabel.AdaptUtils,i=t instanceof e.Reaction?r.kReactionToOB:t instanceof e.StructureFragment?r.kMolToOB:t instanceof e.ChemStructureNode?r.kChemNodeToOB:t instanceof e.ChemStructureConnector?r.kBondToOB:null;return i?i(t):null},kIdToOB:function(e){var t=parseInt(e,10);return t||null},obBondOrderToKekule:function(t){return t<=3?t:t===e.OpenBabel.BondOrder.EXPLICIT_AROMATIC?e.BondOrder.EXPLICIT_AROMATIC:e.BondOrder.OTHER},kBondOrderToOB:function(t){return t<=3?t:t===e.BondOrder.EXPLICIT_AROMATIC?e.OpenBabel.BondOrder.EXPLICIT_AROMATIC:0},obBaseToKekule:function(t,r){var n=r||new e.ChemObject,a=new(i.getClassCtor("ObBaseHelper"))(t),o=a.getTitle();o&&n.setName&&n.setName(o);var s=a.getDataSize();if(s)for(var l=n.getInfo(!0),d=0;d<s;++d){var u=a.getDataAt(d);if(u){var c=u.GetAttribute(),h=u.GetValue();c&&h&&(l[c]=h)}}return n},kChemObjToOB:function(t,r){var n=r||new(i.getClassCtor("OBBase"));t.getName&&n.SetTitle&&n.SetTitle(t.getName());var a=t.getInfo();if(a)for(var o=e.ObjUtils.getOwnedFieldNames(a),s=0,l=o.length;s<l;++s){var d=o[s],u=a[d];if(d&&u){var c=new(i.getClassCtor("OBPairData"));c.SetAttribute(""+d),c.SetValue(""+u),n.SetData(c)}}},obAtomToKekule:function(t,r,i){var n=t.GetAtomicNum(),a=n?e.Atom:e.SubGroup;!r||r instanceof a||e.Error(e.$L("ErrorMsg.OpenBabel.CHEM_NODE_TYPE_NOT_SUITABLE"));var o=r||new a;e.OpenBabel.AdaptUtils.obBaseToKekule(t,o);var s;return s=t.GetId(),e.ObjUtils.notUnset(s)&&o.setId(e.OpenBabel.AdaptUtils.DEF_ATOM_ID_PREFIX+s),s=t.GetFormalCharge(),s&&o.setCharge(s),s=t.GetSpinMultiplicity(),s&&o.setRadical(s),s={x:t.GetX(),y:t.GetY()},i===e.CoordMode.COORD3D&&(s.z=t.GetZ()),o.setAbsCoordOfMode?o.setAbsCoordOfMode(s,i):o.setCoordOfMode(s,i),o instanceof e.Atom&&(n&&o.setAtomicNumber(n),s=t.GetIsotope(),s&&o.setMassNumber(s),(s=t.GetHyb())&&o.setHybridizationType(s)),o},kChemNodeToOB:function(t,r,n){var a,o=r||new(i.getClassCtor("OBAtom"));if(a=t.getId(),a=e.OpenBabel.AdaptUtils.kIdToOB(a),e.ObjUtils.notUnset(a)&&o.SetId(a),a=t.getCharge())if(parseInt(a,10)===parseFloat(a))o.SetFormalCharge(a);else{var s=parseInt(a,10),l=a-s;o.SetFormalCharge(s),o.SetPartialCharge(l)}return a=t.getRadical(),a&&o.SetSpinMultiplicity(a),a=t.getAbsCoordOfMode?t.getAbsCoordOfMode(n):t.getCoordOfMode(n),o.SetVector(a.x||0,a.y||0,a.z||0),t instanceof e.Atom?(o.SetAtomicNum(t.getAtomicNumber()),a=t.getMassNumber(),a&&o.SetIsotope(a),(a=t.getHybridizationType())&&o.SetHyb(a)):o.SetAtomicNum(0),o},obBondToKekule:function(t,r,i){var n=r||new e.Bond;e.OpenBabel.AdaptUtils.obBaseToKekule(t,n);var a;a=t.GetId(),e.ObjUtils.notUnset(a)&&n.setId(e.OpenBabel.AdaptUtils.DEF_BOND_ID_PREFIX+a),a=t.GetBondOrder(),n.setBondOrder(e.OpenBabel.AdaptUtils.obBondOrderToKekule(a));var o=e.BondStereo;if(a=t.IsWedge()?o.UP:t.IsHash()?o.DOWN:t.IsWedgeOrHash()?o.UP_OR_DOWN:t.IsCisOrTrans()?o.CIS_OR_TRANS:t.IsDoubleBondGeometry()?o.E_Z_BY_COORDINATES:o.NONE,n.setStereo(a),i){a=null;for(var s=[t.GetBeginAtom(),t.GetEndAtom()],l=0,d=s.length;l<d;++l){var u=s[l];u&&(a=i.get(u.GetIdx()))&&n.appendConnectedObj(a)}}return n},kBondToOB:function(t,r,n,a){var o=r||new(i.getClassCtor("OBBond"));e.OpenBabel.AdaptUtils.kChemObjToOB(t,o);var s;s=e.OpenBabel.AdaptUtils.kIdToOB(t.getId()),e.ObjUtils.notUnset(s)&&o.SetId(s),s=t.getBondOrder(),s&&(o.SetBondOrder(e.OpenBabel.AdaptUtils.kBondOrderToOB(s)),s===e.BondOrder.EXPLICIT_AROMATIC&&o.SetAromatic()),o.UnsetHash(),o.UnsetWedge(),o.UnsetUp(),o.UnsetDown(),o.UnsetAromatic();var l=e.BondStereo;if(s=t.getStereo(),s===l.UP?o.SetWedge():s===l.DOWN?o.SetHash():s===l.UP_OR_DOWN&&o.SetWedgeOrHash(),n)for(var d=0,u=0,c=t.getConnectedObjCount();u<c;++u){var h=t.getConnectedObjAt(u);if(h&&h instanceof e.ChemStructureNode){var s=n.get(h);if(s&&(0===d?o.SetBegin(s):1===d&&o.SetEnd(s),++d),d>1)break}}return o},obMolToKekule:function(t,r){var i=r||new e.Molecule;e.OpenBabel.AdaptUtils.obBaseToKekule(t,i);var n=t.Has3D()?e.CoordMode.COORD3D:e.CoordMode.COORD2D;i.clearNodes(),i.clearConnectors();for(var a=new e.MapEx(!0),o=t.NumAtoms(),s=0;s<o;++s){var l=t.GetAtom(s+1);if(l){var d=e.OpenBabel.AdaptUtils.obAtomToKekule(l,null,n);d&&(i.appendNode(d),a.set(l.GetIdx(),d))}}for(var o=t.NumBonds(),s=0;s<o;++s){var u=t.GetBond(s);if(u){var c=e.OpenBabel.AdaptUtils.obBondToKekule(u,null,a);c&&i.appendConnector(c)}}return a.finalize(),a=null,i},kMolToOB:function(t,r){var n=t.nodesHasCoord3D()?e.CoordMode.COORD3D:e.CoordMode.COORD2D,a=r||new(i.getClassCtor("OBMol"));r&&a.Clear();for(var o=new e.MapEx(!1),s=0,l=t.getNodeCount();s<l;++s){var d=t.getNodeAt(s);if(d){var u=e.OpenBabel.AdaptUtils.kChemNodeToOB(d,a.NewAtom(),n);u&&o.set(d,u)}}for(var s=0,l=t.getConnectorCount();s<l;++s){var c=t.getConnectorAt(s);if(c&&c instanceof e.Bond){e.OpenBabel.AdaptUtils.kBondToOB(c,a.NewBond(),o,a)}}return o.finalize(),o=null,a},obReactionToKekule:function(t,r){var i=r||new e.Reaction;i.clearAll(),e.OpenBabel.AdaptUtils.obBaseToKekule(t,i),i.setDirection(t.IsReversible()?e.ReactionDirection.BIDIRECTION:e.ReactionDirection.FORWARD);for(var n=0,a=t.NumReactants();n<a;++n){var o=t.GetReactant(n),s=e.OpenBabel.AdaptUtils.obMolToKekule(o);i.appendReactant(s)}for(var n=0,a=t.NumProducts();n<a;++n){var o=t.GetProduct(n),s=e.OpenBabel.AdaptUtils.obMolToKekule(o);i.appendProduct(s)}return i},kReactionToOB:function(t,r){var n=r||new(i.getClassCtor("OBReaction"));n.Clear(),e.OpenBabel.AdaptUtils.kChemObjToOB(t,n);var a=!1,o=t.getDirection();o===e.ReactionDirection.BIDIRECTION?n.SetReversible(!0):o===e.ReactionDirection.BACKWARD&&(a=!0);for(var s=0,l=t.getReactantCount();s<l;++s){var d=t.getReactantAt(s);if(d){var u=e.OpenBabel.AdaptUtils.kMolToOB(d);a?n.AddProduct(u):n.AddReactant(u)}}for(var s=0,l=t.getProductCount();s<l;++s){var d=t.getProductAt(s);if(d){var u=e.OpenBabel.AdaptUtils.kMolToOB(d);a?n.AddReactant(u):n.AddProduct(u)}}}},e}},function(e,t,r){"use strict";var i=r(0).Class;e.exports=function(e){var t=(e.EmscriptenUtils,e.OpenBabel),r=e.OpenBabel.AdaptUtils;return e.IO.OpenBabelReader=i.create(e.IO.ChemDataReader,{CLASS_NAME:"Kekule.IO.OpenBabelReader",initialize:function($super,e){$super()},finalize:function($super){$super()},getFormatTargetObClassName:function(e){return e.getTypeName().toLowerCase().indexOf("reaction")>=0?"OBReaction":"OBMol"},doReadData:function(i,n,a){this._obConv=new(t.getClassCtor("ObConversionWrapper"));try{var o=e.IO.DataFormatsManager.getFormatInfo(a),s=o.mimeType,l=o.fileExts[0],d=this._obConv.setInFormat(s,l),u=this.getFormatTargetObClassName(d);try{var c=[];this._obConv.setInStr(i);for(var h=new(t.getClassCtor(u)),m=this._obConv.readFromInput(h);m;){if(h.NumAtoms&&h.NumAtoms()>0){var g=r.obObjToKekule(h);c.push(g)}m=this._obConv.readFromInput(h)}var f=c.length;if(f<=0)return null;if(1===f)return c[0];for(var p=new e.ChemObjList,C=0;C<f;++C)p.append(c[C]);return p}finally{h&&(h.delete(),h=null)}}finally{this._obConv&&(this._obConv.delete(),this._obConv=null)}}}),e.IO.OpenBabelWriter=i.create(e.IO.ChemDataWriter,{CLASS_NAME:"Kekule.IO.OpenBabelWriter",initialize:function($super,e){$super(e)},finalize:function($super){$super()},doWriteData:function(i,n,a){this._obConv=new(t.getClassCtor("ObConversionWrapper"));try{var o=e.IO.DataFormatsManager.getFormatInfo(a),s=o.mimeType,l=o.fileExts[0];this._obConv.setOutFormat(s,l);for(var d=e.ChemStructureUtils.getChildStructureObjs(i,!0),u=0,c=d.length;u<c;++u){var h=d[u];if(h){var m=r.kObjToOB(h);if(m)try{if(!this._obConv.writeToOutput(m))break}finally{m.delete(),m=null}}}return this._obConv.getOutStr()}finally{this._obConv&&this._obConv.delete()}},isAllowedObj:function(t){var r=e.IO.OpenBabelWriter.ALLOWED_CLASSES;return e.ObjUtils.isInstanceOf(t,r)}}),e.IO.OpenBabelWriter.ALLOWED_CLASSES=[e.StructureFragment,e.Reaction,e.ChemObjList,e.ChemStructureObjectGroup,e.ChemSpaceElement,e.ChemSpace],e.OpenBabel.IORegHelper=i.create({listFormatInfo:function(e,t){var r,i=[];r="in"===e?t.getSupportedInputFormatsStr("\n"):t.getSupportedOutputFormatsStr("\n");for(var n=r.split("\n"),a=0,o=n.length;a<o;++a){var s=n[a],l=s.indexOf("--");if(l>0){var d=s.substring(0,l).trim(),u=t.getFormatInfoById(d);i.push(u)}}return i},registerByInfos:function(t,r){for(var i=e.IO.DataFormatsManager,n=[],a=0,o=t.length;a<o;++a){var s=t[a],l=s.id,d=s.mimeType,u=i.findFormatId(d);if(u&&(u=i.findFormatId(null,l)),!u)var c=i.register(l,d,l,e.IO.ChemDataType.UNKNOWN,s.description,s.description,{specificationUrl:s.specificationURL}),u=c.id;("in"===r?e.IO.ChemDataReaderManager.getReaderInfoByFormat(u):e.IO.ChemDataWriterManager.getWriterInfoByFormat(u))||e.ArrayUtils.pushUnique(n,u)}n.length&&("in"===r?e.IO.ChemDataReaderManager.register("openbabel",e.IO.OpenBabelReader,n):e.IO.ChemDataWriterManager.register("openbabel",e.IO.OpenBabelWriter,e.IO.OpenBabelWriter.ALLOWED_CLASSES,n))},registerAll:function(){var e=new(t.getClassCtor("ObConversionWrapper"));try{var r=this.listFormatInfo("in",e);this.registerByInfos(r,"in");var r=this.listFormatInfo("out",e);this.registerByInfos(r,"out")}finally{e.delete()}}}),e.IO.registerAllOpenBabelFormats=function(){if(e.OpenBabel.AdaptUtils.isAvailable())try{var t=new e.OpenBabel.IORegHelper;t.registerAll()}finally{t=null}},e.OpenBabel._enableFuncs.push(e.IO.registerAllOpenBabelFormats),e.IO.enableOpenBabelFormats=function(){e.OpenBabel.AdaptUtils.isAvailable()?e.IO.registerAllOpenBabelFormats():e.OpenBabel.loadObScript(document,function(){e.IO.registerAllOpenBabelFormats()})},e}},function(e,t,r){"use strict";var i=r(0).Class;e.exports=function(e){var t=(e.EmscriptenUtils,e.OpenBabel),r=e.OpenBabel.AdaptUtils;return e.OpenBabel.StructUtils={generate3DStructure:function(i,n){var a=new(t.getClassCtor("OB3DGenWrapper"));try{var o=e.IO.saveMimeData(i,"chemical/x-mdl-molfile");try{var s=a.generate3DStructureFromMolData(o,n||"");if(s)var l=r.obObjToKekule(s);else e.raise(e.$L("ErrorMsg.OpenBabel.FAIL_TO_GENERATE_3D_STRUCTURE"));s.delete()}finally{}}finally{a.delete()}return l}},e.Calculator&&(e.Calculator.ObStructure3DGenerator=i.create(e.Calculator.AbstractStructure3DGenerator,{CLASS_NAME:"Kekule.Calculator.ObStructure3DGenerator",getObInitOptions:function(){return e.OpenBabel.getObInitOptions()},getForceField:function(){return this.getOptions().forceField},createWorker:function($super){var t=$super();if(t){var r=e.OpenBabel.getObScriptUrl();this.importWorkerScriptFile(r);var i=this.getObInitOptions();this.postWorkerMessage({type:"obInit",usingModulaize:i.usingModulaize,moduleName:i.moduleName,initCallbackName:i.moduleInitCallbackName})}return t},getWorkerScriptFile:function(){return e.OpenBabel.getObPath()+"kekule.worker.obStructure3DGenerator.js"},doReactWorkerMessage:function($super,t,r){if($super(t,r),"output3D"===t.type){var i=t.molData;if(i){var n=e.IO.loadMimeData(i,"chemical/x-mdl-molfile");this.setGeneratedMol(n),this.done()}}},workerStartCalc:function(t){var r=this.getSourceMol(),i=e.IO.saveMimeData(r,"chemical/x-mdl-molfile");this.postWorkerMessage({type:"gen3D",molData:i,forceField:this.getForceField()})},executeSync:function(t){if(e.OpenBabel&&document){var r=this;e.OpenBabel.loadObScript(document,function(){var i;try{var n=e.OpenBabel.StructUtils.generate3DStructure(r.getSourceMol(),r.getForceField());r.setGeneratedMol(n)}catch(e){i=e}t&&t(i)})}else e.error(e.$L("ErrorMsg.MODULE_NOT_LOADED").format("OpenBabel"));return!1}}),e.Calculator.ServiceManager.register(e.Calculator.Services.GEN3D,e.Calculator.ObStructure3DGenerator)),e}},function(e,t,r){"use strict";r(0).Class;e.exports=function(e){var t=e.EmscriptenUtils,r={usingModulaize:!0,moduleName:"IndigoModule",moduleInitEventName:"Indigo.Initialized",moduleInitCallbackName:"__$indigoInitialized$__",indigoAdaptFuncName:"CreateIndigo"};e.Indigo={_autoEnabled:!0,_module:null,_indigo:null,SCRIPT_FILE:"indigo.js",HELPER_SCRIPT_FILE:"indigoAdapter.js",_enableFuncs:[],isScriptLoaded:function(){return t.isSupported(r.moduleName)&&void 0!==$root[r.indigoAdaptFuncName]},getModule:function(){return i._module||(i._module=t.getRootModule(r.moduleName)),i._module},getIndigo:function(){if(!i._indigo){var e=i.getModule();e&&(i._indigo=$root[r.indigoAdaptFuncName](e))}return i._indigo},getClassCtor:function(e){return t.getClassCtor(e,i.getModule())},isAvailable:function(){return i.getModule()&&i.getIndigo()},enable:function(t){i.isScriptLoaded()?(i._enableAllFunctions(),t&&t()):i.loadIndigoScript(e.$jsRoot.document,function(e){e||i._enableAllFunctions(),t&&t(e)})},_enableAllFunctions:function(){if(t.isModuleReady(r.moduleName))for(var e=i._enableFuncs,n=0,a=e.length;n<a;++n){var o=e[n];o&&o()}}},e.Indigo.getIndigoPath=function(){var t=e.scriptSrcInfo.useMinFile,r=t?"extra/":"_extras/Indigo/";return r=e.scriptSrcInfo.path+r},e.Indigo.getIndigoScriptUrl=function(){var t=i.getIndigoPath()+i.SCRIPT_FILE;return e.scriptSrcInfo.useMinFile||(t+=".dev"),t},e.Indigo.getIndigoHelperScriptUrl=function(){return i.getIndigoPath()+i.HELPER_SCRIPT_FILE},e.Indigo.loadIndigoScript=function(n,a){n||(n=e.$jsRoot.document);var o=function(t){i._scriptLoadedBySelf=!t,t||e.Indigo.getIndigo(),a&&a(t)};if(i._scriptLoadedBySelf||i.isScriptLoaded())o();else{var s=i.getIndigoScriptUrl();t.loadScript(s,function(t){t?o(t):e.ScriptFileUtils.appendScriptFiles(n,[i.getIndigoHelperScriptUrl()],o)},n,r)}};var i=e.Indigo;return e.Indigo.AdaptUtils={},e._registerAfterLoadSysProc(function(){i._autoEnabled&&i.isScriptLoaded()&&t.ensureModuleReady(e.$jsRoot.document,r,i._enableAllFunctions)}),e}},function(e,t,r){"use strict";var i=r(0).Class;e.exports=function(e){var t=(e.EmscriptenUtils,e.Indigo);return e.IO.IndigoReader=i.create(e.IO.ChemDataReader,{CLASS_NAME:"Kekule.IO.InChIWriter",doReadData:function(r,i,n){var a=t.getIndigo(),o=a.loadMoleculeFromString(r);if(o>=0){n===e.IO.DataFormat.SMILES&&(a.setOption("smart-layout","true"),a.layout(o));var s=a.molfile(o);a.free(o);return e.IO.loadFormatData(s,e.IO.DataFormat.MOL)}return null}}),e.IO.registerAllIndigoFormats=function(){t.isAvailable()&&e.IO.ChemDataReaderManager.register("Indigo-smiles",e.IO.IndigoReader,e.IO.DataFormat.SMILES)},e.IO.enableIndigoFormats=function(){t.isAvailable()?e.IO.registerAllIndigoFormats():t.loadIndigoScript(document,function(){e.IO.registerAllIndigoFormats()})},t._enableFuncs.push(e.IO.registerAllIndigoFormats),e}}]);