module.exports=function(modules){function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}var installedModules={};return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{configurable:!1,enumerable:!0,get:getter})},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function(){return module.default}:function(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=3)}([function(module,exports,__webpack_require__){"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};!function($jsRoot){function emptyFunction(){}function __$A__(iterable){if(!iterable)return[];if(iterable.toArray)return iterable.toArray();for(var length=iterable.length||0,results=new Array(length);length--;)results[length]=iterable[length];return results}var Class={createCore:function(){function klass(){this.initialize.apply(this,arguments)}var parent=null,properties=__$A__(arguments);if(Object.isFunction(properties[0])&&(parent=properties.shift()),Object.extend(klass,Class.Methods),klass.superclass=parent,klass.subclasses=[],parent){var subclass=function(){};subclass.prototype=parent.prototype,klass.prototype=new subclass,parent.subclasses.push(klass)}for(var i=0;i<properties.length;i++)klass.addMethods(properties[i]);return klass.prototype.initialize||(klass.prototype.initialize=emptyFunction),klass.prototype.constructor=klass,klass},create:function(){return Class.createCore.apply(this,arguments)},free:function(obj){obj.finalize&&obj.finalize(),obj=null}};Class.Methods={addMethods:function(source){if(!source)return this;var ancestor=this.superclass&&this.superclass.prototype,properties=Object.keys(source);Object.keys({toString:!0}).length||properties.push("toString","valueOf");for(var doNothing=function(){},i=0,length=properties.length;i<length;i++){var property=properties[i],value=source[property],isFunction=Object.isFunction(value);if(ancestor&&isFunction&&"$super"===FunctionUtils.argumentNames(value)[0]){var method=value;value=function(m){return function(){return(ancestor[m]||doNothing).apply(this,arguments)}}(property).wrap(method),value.valueOf=method.valueOf.bind(method),value.toString=method.toString.bind(method)}this.prototype[property]=value}return this}},Object.extend=function(destination,source,ignoreUnsetValue,ignoreEmptyString){for(var property in source){var value=source[property];(!ignoreUnsetValue||void 0!==value&&null!==value)&&(ignoreEmptyString&&""===value||(destination[property]=value))}return destination},Object.extendEx=function(destination,source,options){var ops=options||{};for(var property in source){var value=source[property];if((!ops.ignoreUnsetValue||void 0!==value&&null!==value)&&(!ops.ignoreEmptyString||""!==value)){var oldValue=destination[property];if(!options.preserveExisted||!oldValue){var oldProto=oldValue&&oldValue.constructor&&oldValue.constructor.prototype,newProto=value&&value.constructor&&value.constructor.prototype;oldValue&&"object"===(void 0===oldValue?"undefined":_typeof(oldValue))&&oldProto===newProto?Object.extendEx(oldValue,value,options):destination[property]=value}}}return destination},Object._extendSupportMethods=function(destination,methods){return Object.extendEx(destination,methods,{ignoreUnsetValue:!0,preserveExisted:!0})},Object.getCascadeFieldValue=function(fieldName,root,Kekule){var result,cascadeNames;cascadeNames=fieldName.length&&fieldName.splice?fieldName:fieldName.split("."),root||(root=this);var i,l;if("Kekule"===cascadeNames[0])for(cascadeNames.shift(),i=0,l=cascadeNames.length;i<l&&(result=Kekule[cascadeNames[i]]);++i)root=result;else for(i=0,l=cascadeNames.length;i<l&&(result=root[cascadeNames[i]]);++i)root=result;return result},Object.setCascadeFieldValue=function(fieldName,value,root,forceCreateEssentialObjs){var cascadeNames;cascadeNames=fieldName.length&&fieldName.splice?fieldName:fieldName.split(".");for(var parent=root,i=0,l=cascadeNames.length;i<l;++i){var name=cascadeNames[i];if(i===l-1)return parent[name]=value,value;var obj=parent[name];if(!obj&&forceCreateEssentialObjs&&(obj={},parent[name]=obj),!obj)return!1;parent=obj}},Object._inherit=function(proto){function f(){}null===proto&&(proto={});var t=void 0===proto?"undefined":_typeof(proto);if(!DataType.isFunctionType(t)&&!DataType.isObjectType(t))throw TypeError();return f.prototype=proto,new f},Object.create||(Object.create=Object._inherit),Object.copyValues=function(dest,src,propNames){if(propNames){for(var i=0,l=propNames.length;i<l;++i){var prop=propNames[i],value=src[prop];void 0!==value&&(dest[prop]=value)}return dest}return Object.extend(dest,src)},Object._extendSupportMethods(Object,{keys:function(object){var keys=[];for(var property in object)keys.push(property);return keys},isFunction:function(object){return"function"==typeof object},isUndefined:function(object){return void 0===object}});var FunctionUtils={argumentNames:function(f){var names=((f.toString().match(/^[\s(]*function[^(]*\(([^)]*)\)/)||[])[1]||"").replace(/\s+/g,"").split(",");return 1!=names.length||names[0]?names:[]}};Object._extendSupportMethods(Function.prototype,{argumentNames:function(){var names=this.toString().match(/^[\s(]*function[^(]*\(([^)]*)\)/)[1].replace(/\s+/g,"").split(",");return 1!=names.length||names[0]?names:[]},wrap:function(wrapper){var __method=this;return function(){return wrapper.apply(this,[__method.bind(this)].concat(__$A__(arguments)))}},methodize:function(){if(this._methodized)return this._methodized;var __method=this;return this._methodized=function(){var a=Array.prototype.slice.call(arguments);return a.unshift(this),__method.apply(null,a)}},bind:function(){if(arguments.length<2&&Object.isUndefined(arguments[0]))return this;var __method=this,args=__$A__(arguments),object=args.shift();return function(){return __method.apply(object,args.concat(__$A__(arguments)))}},delay:function(){var __method=this,args=__$A__(arguments),timeout=args.shift();return window.setTimeout(function(){return __method.apply(__method,args)},timeout)},defer:function(){var __method=this,args=__$A__(arguments);return args.shift(),window.setTimeout(function(){return __method.apply(__method,args)},10)}}),Array.prototype.indexOf||(Array.prototype.indexOf=function(item,i){i||(i=0);var length=this.length;for(i<0&&(i=length+i);i<length;i++)if(this[i]===item)return i;return-1}),Array.prototype.lastIndexOf||(Array.prototype.lastIndexOf=function(item,i){i=isNaN(i)?this.length:(i<0?this.length+i:i)+1;var n=this.slice(0,i).reverse().indexOf(item);return n<0?n:i-n-1}),Object._extendSupportMethods(String.prototype,{toArray:function(){return this.split("")},camelize:function(){var parts=this.split("-"),len=parts.length;if(1==len)return parts[0];for(var camelized="-"==this.charAt(0)?parts[0].charAt(0).toUpperCase()+parts[0].substring(1):parts[0],i=1;i<len;i++)camelized+=parts[i].charAt(0).toUpperCase()+parts[i].substring(1);return camelized},capitalizeFirst:function(){return this.charAt(0).toUpperCase()+this.substring(1)},include:function(pattern){return this.indexOf(pattern)>-1},startsWith:function(pattern){return 0===this.indexOf(pattern)},endsWith:function(pattern){var d=this.length-pattern.length;return d>=0&&this.lastIndexOf(pattern)===d}}),Object._extendSupportMethods(String.prototype,{upperFirst:function(){return this.charAt(0).toUpperCase()+this.substring(1)},format:function(){for(var formatted=this,i=0;i<arguments.length;i++){var regexp=new RegExp("\\{"+i+"\\}","gi");formatted=formatted.replace(regexp,arguments[i])}return formatted},trim:function(){return this.replace(/^\s*|\s*$/g,"")},ltrim:function(){return this.replace(/^\s+/,"")},rtrim:function(){return this.replace(/\s+$/,"")},trimLeft:function(){return this.ltrim()},trimRight:function(){return this.rtrim()},pad:function(length,padString,rightPad){for(var p=padString||" ",a=[],i=0,l=length-this.length;i<l;++i)a.push(p);var str=this;return rightPad?str+a.join(""):a.join("")+str},lpad:function(length,padString){return this.pad(length,padString,!1)},rpad:function(length,padString){return this.pad(length,padString,!0)},reverse:function(){for(var length=this.length,a=[],i=length-1;i>=0;--i)a.push(this.charAt(i));return a.join("")},toCharArray:function(){for(var a=[],i=0,l=this.length;i<l;++i)a.push(this.charAt(i));return a},hyphenize:function(hyphen){hyphen||(hyphen="-");for(var len=this.length,a=[],i=0;i<len;++i){var c=this.charAt(i);0!==i&&c>="A"&&c<="Z"?a.push(hyphen+c.toLowerCase()):a.push(c)}return a.join("")}});var StringUtils={STRUE:"$TRUE",SFALSE:"$FALSE",SUNDEFINED:"$UNDEFINED",SNULL:"$NULL",SNAN:"$NAN",SPOSITIVE:"+",SNEGATIVE:"-",SDATEPREFIX:"@",isAllDigitalChar:function(str){for(var i=0,l=str.length;i<l;++i){var c=str.charAt(i);if(!(c>="0"&&c<="9")&&"."!=c)return!1}return!0},isNumbericStr:function(str){var a=Number(str);return!isNaN(a)},serializeValue:function(value,unchangeTypes){var utypes=unchangeTypes||[],vtype=DataType.getType(value);if(utypes.indexOf(vtype)>=0)return value.toString();if(null===value)return StringUtils.SNULL;if(void 0===value)return StringUtils.SUNDEFINED;if(value!=value)return StringUtils.SNAN;switch(vtype){case"boolean":return value?StringUtils.STRUE:StringUtils.SFALSE;case"number":case DataType.INT:case DataType.FLOAT:return(value>=0?StringUtils.SPOSITIVE:"")+value;case DataType.DATE:return StringUtils.SDATEPREFIX+value.toString();default:return value.toString()}},deserializeValue:function(str,preferedType){if("string"!=typeof str)return str;switch(str){case StringUtils.STRUE:return!0;case StringUtils.SFALSE:return!1;case StringUtils.SNULL:return null;case StringUtils.SUNDEFINED:return;case StringUtils.SNAN:return NaN;default:if(preferedType)switch(preferedType){case DataType.FLOAT:return parseFloat(str);case DataType.INT:return parseInt(str);case"number":return parseFloat(str);case"boolean":return!!str;default:return str}else{var s,firstChar=str.charAt(0);switch(firstChar){case StringUtils.SPOSITIVE:case StringUtils.SNEGATIVE:return s=str.substring(1),StringUtils.isNumbericStr(s)?parseFloat(str):str;case StringUtils.SDATEPREFIX:return s=str.substr(1),new Date(s);default:return str}}}}};Object.extend(Date.prototype,{copyFrom:function(src){this.setFullYear(src.getFullYear(),src.getMonth(),src.getDate()),this.setTime(src.getTime())}}),Math.sqr||(Math.sqr=function(x){return x*x}),Math.sign||(Math.sign=function(x){return x>0?1:x<0?-1:0}),$jsRoot||"undefined"==typeof window||($jsRoot=window),$jsRoot.Node||($jsRoot.Node={}),$jsRoot.Node.ELEMENT_NODE||Object.extend($jsRoot.Node,{ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12}),Class.PropertyScope={DEFAULT:3,PUBLISHED:3,PUBLIC:2,PRIVATE:1},Class.PropList=function(){this.props=[]},Class.PropList.prototype={addProperty:function(propName,options){options||(options={});var propInfo;return propInfo=this.getPropInfo(propName),propInfo||(propInfo={},this.props.push(propInfo)),propInfo=Object.extend(propInfo,options),void 0===propInfo.serializable&&(propInfo.serializable=!0),propInfo.name=propName,propInfo},removeProperty:function(propName){var index=this.indexOf(propName);index>=0&&this.props.splice(index,1)},removePropAt:function(index){if(index>=0){this.props[index]&&this.props.splice(index,1)}},getLength:function(){return this.props.length},indexOf:function(propName){for(var i=0,l=this.props.length;i<l;++i)if(this.props[i].name===propName)return i;return-1},getPropInfoAt:function(index){return index>=0?this.props[index]:null},getPropInfo:function(propName){var index=this.indexOf(propName);return this.getPropInfoAt(index)},hasProperty:function(propName){return this.indexOf(propName)>=0},clear:function(){this.props.clear()},clone:function(){var result=new Class.PropList;return result.props=this.props.slice(),result},appendList:function(propList){for(var i=0,l=propList.props.length;i<l;++i)this.props.push(propList.props[i])}},Class.PropList.prototype.constructor=Class.PropList,Class.EventHandlerList=function(){this.handlers=[],this._$flag_="KekuleEventList"},Class.EventHandlerList.prototype={add:function(handler,thisArg){thisArg||(thisArg=null),this.handlers.push({thisArg:thisArg,handler:handler})},remove:function(handler,thisArg){var indexes=this.indexesOf(handler,thisArg);if(indexes.length>0)for(var i=indexes.length-1;i>=0;--i)this.removeAt(indexes[i])},removeAt:function(index){for(var i=index,l=this.handlers.length;i<l;++i)this.handlers[i]=this.handlers[i+1];this.handlers.length=this.handlers.length-1},clear:function(){this.handlers=[]},getHandlerInfo:function(index){return this.handlers[index]},indexOf:function(handler,thisArg){for(var i=0,l=this.handlers.length;i<l;++i)if(this.handlers[i].handler==handler){if(void 0!==thisArg&&this.handlers[i].thisArg===thisArg)return i;if(void 0===thisArg)return i}return-1},indexesOf:function(handler,thisArg){for(var result=[],i=0,l=this.handlers.length;i<l;++i)this.handlers[i].handler==handler&&(void 0!==thisArg&&this.handlers[i].thisArg===thisArg?result.push(i):void 0===thisArg&&result.push(i));return result},getLength:function(){return this.handlers.length}},Class.EventHandlerList.constructor=Class.EventHandlerList;var DataType={UNKNOWN:null,VARIANT:null,PRIMARY:"primary",UNDEFINED:"undefined",BOOL:"boolean",BOOLEAN:"boolean",NUMBER:"number",INT:"int",INTEGER:"int",FLOAT:"float",STRING:"string",ARRAY:"array",FUNCTION:"function",DATE:"date",HASH:"object",OBJECT:"object",OBJECTEX:"objectex",CLASS:"class",isSimpleType:function(typeName){return typeName==DataType.STRING||typeName==DataType.NUMBER||typeName==DataType.INT||typeName==DataType.FLOAT||typeName==DataType.BOOL||typeName==DataType.UNDEFINED||typeName==DataType.PRIMARY},isComplexType:function(typeName){return!(DataType.isSimpleType(typeName)||DataType.isFunctionType(typeName))},isFunctionType:function(typeName){return typeName==DataType.FUNCTION},isObjectType:function(typeName){return typeName==DataType.OBJECT},isDateType:function(typeName){return typeName==DataType.DATE},isObjectExType:function(typeName,Kekule){var result=DataType.isComplexType(typeName)&&!DataType.isObjectType(typeName)&&!DataType.isDateType(typeName);if(result){var classObj=ClassEx.findClass(typeName,void 0,Kekule);result=classObj&&ClassEx.isOrIsDescendantOf(classObj,ObjectEx)}return result},getType:function(value){var stype=void 0===value?"undefined":_typeof(value);switch(stype){case"undefined":return DataType.UNDEFINED;case"function":return DataType.FUNCTION;case"boolean":return DataType.BOOL;case"string":return DataType.STRING;case"number":return Math.floor(value)==value?DataType.INT:DataType.FLOAT;case"object":return this.isDateValue(value)?DataType.DATE:DataType.isArrayValue(value)?DataType.ARRAY:ClassEx.isClass(value)?DataType.CLASS:DataType.isObjectExValue(value)&&value.getClassName?value.getClassName():DataType.OBJECT;default:return stype}},isSimpleValue:function(value){return DataType.isSimpleType(void 0===value?"undefined":_typeof(value))},isUndefinedValue:function(value){return void 0===value},isNullValue:function(value){return null===value},isFunctionValue:function(value){return"function"==typeof value},isObjectValue:function(value){return!!value&&("object"==(void 0===value?"undefined":_typeof(value))&&!DataType.isArrayValue(value)&&!DataType.isDateValue(value))},isDateValue:function(value){return!!value&&("object"==(void 0===value?"undefined":_typeof(value))&&void 0!==value.getFullYear)},isArrayValue:function(value){return!!value&&("object"==(void 0===value?"undefined":_typeof(value))&&void 0!==value.length)},isObjectExValue:function(value){return value instanceof ObjectEx},createInstance:function(typeName,Kekule){switch(typeName){case DataType.UNDEFINED:return;case DataType.DATE:return new Date;case DataType.ARRAY:return new Array;case DataType.OBJECT:return new Object;case DataType.FUNCTION:return new Function;default:return new(ClassEx.findClass(typeName.capitalizeFirst(),void 0,Kekule))}}},ClassEx={isClass:function(classObj){return!!classObj&&!(!classObj.superclass&&!classObj.subclasses)},findClass:function(className,root,Kekule){return Object.getCascadeFieldValue(className,root||$jsRoot,Kekule)},getClassName:function(aClass){return aClass?aClass.prototype.CLASS_NAME:null},getClassLocalName:function(aClass){var className=ClassEx.getClassName(aClass),pos=className.lastIndexOf(".");return pos>=0?className.substring(pos+1):className},getPrototype:function(aClass){return aClass.prototype},getSuperClass:function(aClass){return aClass.superclass||aClass.constructor.superclass},getSuperClassPrototype:function(aClass){return aClass.superclass?aClass.superclass.prototype:null},_getCommonSuperClass2:function(class1,class2){for(var result=class1;result&&!ClassEx.isOrIsDescendantOf(class2,result);)result=ClassEx.getSuperClass(result);return result},getCommonSuperClass:function(objects){if(!objects||!objects.length)return null;var result=objects[0].getClass?objects[0].getClass():null;if(!result)return null;for(var i=1,l=objects.length;i<l;++i){var classObj=objects[i].getClass?objects[i].getClass():null;if(!classObj)return null;result=ClassEx._getCommonSuperClass2(result,classObj)}return result},isDescendantOf:function(aClass,superClass){for(var ancestor=ClassEx.getSuperClass(aClass);ancestor&&ancestor!==superClass;)ancestor=ClassEx.getSuperClass(ancestor);return!!ancestor},isOrIsDescendantOf:function(aClass,superClass){return aClass===superClass||ClassEx.isDescendantOf(aClass,superClass)},isOrIsDescendantOfClasses:function(aClass,superClasses){for(var i=0,l=superClasses.length;i<l;++i)if(ClassEx.isOrIsDescendantOf(aClass,superClasses[i]))return!0;return!1},_ensurePropertySystem:function(aClass){var proto=ClassEx.getPrototype(aClass);if(proto&&!proto.hasOwnProperty("properties")){var parent=ClassEx.getSuperClass(aClass);parent&&ClassEx._ensurePropertySystem(parent),ClassEx._createPropertyList(aClass),proto.hasOwnProperty("initProperties")&&proto.initProperties.apply(proto)}},_createPropertyList:function(aClass){ClassEx.getPrototype(aClass).hasOwnProperty("properties")||(ClassEx.getPrototype(aClass).properties=new Class.PropList)},getOwnPropList:function(aClass){var proto=ClassEx.getPrototype(aClass);return proto?(proto._initPropertySystem(),proto.properties):null},getAllPropList:function(aClass){var result,s=ClassEx.getSuperClassPrototype(aClass);return s?(result=s.getAllPropList().clone(),result.appendList(ClassEx.getOwnPropList(aClass))):result=ClassEx.getOwnPropList(aClass),result},getPropListOfScopes:function(aClass,scopes){var result,findOwnList=function(aClass,scopes){var list=ClassEx.getOwnPropList(aClass).clone();if(list)for(var i=list.getLength()-1;i>=0;--i){var propInfo=list.getPropInfoAt(i),propScope=propInfo.scope||Class.PropertyScope.DEFAULT;scopes.indexOf(propScope)<0&&list.removePropAt(i)}return list},s=ClassEx.getSuperClass(aClass);return s?(result=ClassEx.getPropListOfScopes(s,scopes).clone(),result.appendList(findOwnList(aClass,scopes))):result=findOwnList(aClass,scopes),result},defineProp:function(aClass,propName,options){return ClassEx._ensurePropertySystem(aClass),ClassEx.getPrototype(aClass).defineProp(propName,options)},defineProps:function(aClass,propDefItems){ClassEx._ensurePropertySystem(aClass);for(var proto=ClassEx.getPrototype(aClass),i=0,l=propDefItems.length;i<l;++i){var item=propDefItems[i],propName=item.name,options=item;proto.defineProp(propName,options)}},getPropInfo:function(aClass,propName){return ClassEx.getPrototype(aClass).getPropInfo(propName)},defineEvent:function(aClass,eventName){return ClassEx.getPrototype(aClass).defineEvent(eventName)},getUnusedMethodName:function(aClass,baseName,fromIndex){for(var start=fromIndex||0,i=start,p=ClassEx.getPrototype(aClass),name=baseName+Number(i).toString();p[name];)++i,name=baseName+Number(i).toString();return name},extendMethod:function(aClass,methodName,method){var proto=ClassEx.getPrototype(aClass),originMethod=proto[methodName],newName=ClassEx.getUnusedMethodName(aClass,"__$changed$_"+methodName+"__");proto[newName]=originMethod;var value=function(m){return function(){return proto[m].apply(this,arguments)}}(newName).wrap(method);proto[methodName]=value,value.valueOf=method.valueOf.bind(method),value.toString=method.toString.bind(method)},extend:function(aClass,extension){var proto=ClassEx.getPrototype(aClass),ancestor=ClassEx.getSuperClassPrototype(aClass),properties=Object.keys(extension);Object.keys({toString:!0}).length||properties.push("toString","valueOf");for(var i=0,length=properties.length;i<length;i++){var property=properties[i],value=extension[property];if("function"==typeof value){var args=FunctionUtils.argumentNames(value),first=args[0];if("$origin"==first){var method=value,originMethod=proto[property],newName=ClassEx.getUnusedMethodName(aClass,"__$changed$_"+property+"__");proto[newName]=originMethod,value=function(m){return function(){return proto[m].apply(this,arguments)}}(newName).wrap(method),value.valueOf=method.valueOf.bind(method),value.toString=method.toString.bind(method),args.shift(),first=args.first()}"$super"==first&&(method=value,value=function(m){return function(){return ancestor[m].apply(this,arguments)}}(property).wrap(method),value.valueOf=method.valueOf.bind(method),value.toString=method.toString.bind(method))}proto[property]=value}return aClass}},ObjectEx=Class.create({CLASS_NAME:"ObjectEx",initialize:function(){this._initPropertySystem(),this.initPropValues(),this._updateStatus=0,this._childChangeEventSuppressed=!1,this._modifiedProps=[],this._finalized=!1,this.afterInitialization()},afterInitialization:function(){},finalize:function(){this._finalized||(this.doFinalize(),this.invokeEvent("finalize",{obj:this}),this.setPropStoreFieldValue("eventHandlers",null),this._finalized=!0)},doFinalize:function(){},initProperties:function(){this.defineProp("enablePropValueGetEvent",{dataType:DataType.BOOL,serializable:!1,scope:Class.PropertyScope.PUBLIC}),this.defineProp("enablePropValueSetEvent",{dataType:DataType.BOOL,serializable:!1,scope:Class.PropertyScope.PUBLIC}),this.defineProp("bubbleEvent",{dataType:DataType.BOOL,serializable:!1,scope:Class.PropertyScope.PUBLIC}),this.defineProp("suppressChildChangeEventInUpdating",{dataType:DataType.BOOL,serializable:!1,scope:Class.PropertyScope.PUBLIC}),this.defineProp("eventHandlers",{dataType:DataType.HASH,serializable:!1,scope:Class.PropertyScope.PRIVATE,getter:function(){var r=this.getPropStoreFieldValue("eventHandlers");return r||(r={},this.setPropStoreFieldValue("eventHandlers",r)),r}})},initPropValues:function(){},getHigherLevelObj:function(){return null},saved:function(){},loaded:function(){},_initPropertySystem:function(){if(!this.getPrototype().hasOwnProperty("properties")){var parent=this.getSuperClassPrototype();parent&&parent._initPropertySystem.apply(parent),this._createPropertyList(),this.getPrototype().hasOwnProperty("initProperties")&&this.getPrototype().initProperties.apply(this.getPrototype())}},_createPropertyList:function(){this.getPrototype().hasOwnProperty("properties")||(this.getPrototype().properties=new Class.PropList)},getClass:function(){return this.constructor},getSuperClass:function(){return this.getClass().superclass},getClassName:function(){return this.getPrototype().CLASS_NAME},getClassLocalName:function(){return ClassEx.getClassLocalName(this.getClass())},getSerializationName:function(){return this.getClassName()},getPrototype:function(){return this.prototype?this.prototype:this.constructor.prototype},getSuperClassPrototype:function(){return this.constructor&&this.constructor.superclass?this.constructor.superclass.prototype:null},getOwnPropList:function(){return this._initPropertySystem(),this.getPrototype().properties},getAllPropList:function(){var result,s=this.getSuperClassPrototype();return s?(result=s.getAllPropList().clone(),result.appendList(this.getOwnPropList())):result=this.getOwnPropList().clone(),result},getPropListOfScopes:function(scopes){return ClassEx.getPropListOfScopes(this.getClass(),scopes)},getPropInfoHashKey:function(propName){return ObjectEx._PROPINFO_HASHKEY_PREFIX+propName},getDefPropStoreFieldName:function(propName){return ObjectEx._PROP_STOREFIELD_PREFIX+propName},defineProp:function(propName,options){options||(options={}),void 0===options.serializable&&(options.serializable=!0),options.storeField||(options.storeField=this.getDefPropStoreFieldName(propName));var list=this.getOwnPropList(),prop=list.addProperty(propName,options);return null!==options.getter&&(prop.getter=this.createPropGetter(prop,options.getter)),null!==options.setter&&(prop.setter=this.createPropSetter(prop,options.setter)),this[this.getPropInfoHashKey(propName)]=prop,prop},createPropGetter:function(prop,getter){var propNameBase=prop.name.toString().upperFirst(),getterName="get"+propNameBase,doGetterName="doGet"+propNameBase,actualGetter=this[doGetterName];return actualGetter||(actualGetter=getter||new Function('return this["'+prop.storeField+'"];'),this.getPrototype()[doGetterName]=actualGetter),this.getPrototype()[getterName]=function(){var args=arguments;return this[doGetterName].apply(this,args)},doGetterName},createPropSetter:function(prop,setter){var propName=prop.name.toString(),propNameBase=propName.upperFirst(),setterName="set"+propNameBase,doSetterName="doSet"+propNameBase,actualSetter=this[doSetterName];return this[doSetterName]||(actualSetter=setter||new Function("value",'this["'+prop.storeField+'"] = value;'),this.getPrototype()[doSetterName]=actualSetter),this.getPrototype()[setterName]=function(){var args=Array.prototype.slice.call(arguments),value=args[0];return this[doSetterName].apply(this,args),this.notifyPropSet(propName,value),this},doSetterName},hasProperty:function(propName){return null!=this.getPropInfo(propName)},getPropInfo:function(propName){var pname=propName||"",hashKey=this.getPropInfoHashKey(pname)||"",result=this[hashKey];if(!result&&!(result=this.getOwnPropList().getPropInfo(pname))){var parent=this.getSuperClassPrototype();result=parent&&parent.getPropInfo?parent.getPropInfo(pname):null}return result},getPropertyDataType:function(propName){var info=this.getPropInfo(propName);return info?info.dataType:null},isPropertySerializable:function(propName){var info=this.getPropInfo(propName),s=info&&info.serializable;return void 0===s||!!s},getPropStoreFieldValue:function(propName){var info=this.getPropInfo(propName);return info.storeField?this[info.storeField]:void 0},getPropValue:function(propName){var result,info=this.getPropInfo(propName);if(info){if(info.getter){var args=Array.prototype.slice.call(arguments);args.shift(),result=this[info.getter].apply(this,args)}else result=this[info.storeField];return result}return null},getPropValues:function(propNames){var i,l,result={};if(DataType.isArrayValue(propNames))for(i=0,l=propNames.length;i<l;++i){var pname=propNames[i];result[pname]=this.getPropValue(pname)}else if(DataType.isObjectValue(propNames))for(pname in propNames)propNames.hasOwnProperty(pname)&&"function"!=typeof pname&&(result[pname]=this.getPropValue(pname));return result},setPropStoreFieldValue:function(propName,value){var info=this.getPropInfo(propName);info.storeField&&(this[info.storeField]=value)},setPropValue:function(propName,value,ignoreReadOnly){var info=this.getPropInfo(propName);return info&&(info.setter?this[info.setter].apply(this,[value]):ignoreReadOnly&&(this[info.storeField]=value),this.notifyPropSet(propName,value)),this},setPropValueX:function(){var args=Array.prototype.slice.call(arguments),propName=args.shift(),info=this.getPropInfo(propName);return info&&(info.setter&&this[info.setter].apply(this,args),this.notifyPropSet(propName,this.getPropValue(propName))),this},setPropValues:function(hash,ignoreReadOnly){for(var propName in hash)if(hash.hasOwnProperty(propName)&&this.hasProperty(propName)){var propValue=hash[propName];this.setPropValue(propName,propValue,ignoreReadOnly)}return this},_isPropGetOrSetEvent:function(propName){return"propValueGet"==propName||"propValueSet"==propName},notifyPropSet:function(propName,newValue,doNotEvokeObjChange){if(this.isUpdating())return void(this._modifiedProps.indexOf(propName)<0&&this._modifiedProps.push(propName));this._isPropGetOrSetEvent(propName)||this.isEventPropName(propName)||(this.doPropChanged(propName,newValue),this.getPropStoreFieldValue("enablePropValueSetEvent")&&this.invokeEvent("propValueSet",{propName:propName,propValue:newValue}),doNotEvokeObjChange||this.objectChange([propName]))},objectChange:function(modifiedPropNames){this.doObjectChange(modifiedPropNames),this.invokeEvent("change",{changedPropNames:modifiedPropNames})},doObjectChange:function(){},doPropChanged:function(){},defineEvent:function(){},eventNameToPropName:function(eventName){return"__event_"+eventName},isEventPropName:function(propName){return"string"==typeof propName&&propName.indexOf("__event_")>=0},isEventHandlerList:function(value){return value&&"object"==(void 0===value?"undefined":_typeof(value))&&value instanceof Class.EventHandlerList},getEventHandlerList:function(eventName){var hs=this.getEventHandlers(),result=hs[eventName];return result||(result=new Class.EventHandlerList,hs[eventName]=result),result},addEventListener:function(eventName,listener,thisArg){var handlerList=this.getEventHandlerList(eventName);return this.isEventHandlerList(handlerList)?handlerList.add(listener,thisArg):null},addOnceEventListener:function(eventName,listener,thisArg){var self=this,wrapper=function wrapper(event){self.removeEventListener(eventName,wrapper,thisArg),listener(event)};return this.addEventListener(eventName,wrapper,thisArg)},removeEventListener:function(eventName,listener,thisArg){var handlerList=this.getEventHandlerList(eventName);if(this.isEventHandlerList(handlerList))return handlerList.remove(listener,thisArg)},on:function(eventName,listener,thisArg){return this.addEventListener(eventName,listener,thisArg)},once:function(eventName,listener,thisArg){return this.addOnceEventListener(eventName,listener,thisArg)},off:function(eventName,listener,thisArg){return this.removeEventListener(eventName,listener,thisArg)},invokeEvent:function(eventName,event){event||(event={}),event.name=eventName,event.target=this,event.stopPropagation=function(){event.cancelBubble=!0},this.dispatchEvent(eventName,event)},relayEvent:function(eventName,event){event.currentTarget=this,"change"===eventName&&this.getSuppressChildChangeEventInUpdating()&&this.isUpdating()?this._childChangeEventSuppressed=!0:this.dispatchEvent(eventName,event)},dispatchEvent:function(eventName,event){var handlerList=this.getEventHandlerList(eventName);if(this.isEventHandlerList(handlerList))for(var i=0,l=handlerList.getLength();i<l;++i){var handlerInfo=handlerList.getHandlerInfo(i);handlerInfo.handler&&handlerInfo.handler.apply(handlerInfo.thisArg,[event])}var higherObj=this.getHigherLevelObj();!event.cancelBubble&&this.getBubbleEvent()&&higherObj&&higherObj.relayEvent&&higherObj.relayEvent(eventName,event)},stopEventPropagation:function(event){event.cancelBubble=!0},overwriteMethod:function(methodName,newMethod){var self=this,oldMethod=this[methodName];return this[methodName]=function(){var args=Array.prototype.slice.call(arguments);return args.unshift(oldMethod.bind(self)),newMethod.apply(self,args)},this},assign:function(srcObj){return srcObj.assignTo(this)},assignTo:function(targetObj,Kekule){var jsonObj={};this.saveObj(jsonObj,"json"),targetObj.loadObj(jsonObj,"json",Kekule)},clone:function(){var classObj=this.getClass(),result=new classObj;return this.assignTo(result),result},beginUpdate:function(){++this._updateStatus},endUpdate:function(){if(--this._updateStatus,this.checkUpdateStatus(),!this.isUpdating()){var modifiedProps=this._modifiedProps||[];this._modifiedProps=[],this._childChangeEventSuppressed&&(modifiedProps.push("[children]"),this._childChangeEventSuppressed=!1),this.doEndUpdate(modifiedProps)}},doEndUpdate:function(modifiedPropNames){if(modifiedPropNames.length){if(this.getPropStoreFieldValue("enablePropValueSetEvent"))for(var i=0,l=modifiedPropNames.length;i<l;++i){var propName=modifiedPropNames[i],propValue=this.getPropValue(propName);this.notifyPropSet(propName,propValue,!0)}this.objectChange(modifiedPropNames)}},isUpdating:function(){return this._updateStatus>0},isPropUpdated:function(propName){return this._modifiedProps.indexOf(propName)>=0},checkUpdateStatus:function(){this._updateStatus<=0&&(this._updateStatus=0)},copyPropsTo:function(dest){for(var props=this.getAllPropList(),i=0,l=props.getLength();i<l;++i){var propName=props.getPropInfoAt(i).name;if(dest.hasProperty(propName)){var propValue=this.getPropValue(propName);dest.setPropValue(propName,propValue,!0)}}}});ObjectEx._PROPINFO_HASHKEY_PREFIX="__$propInfo__",ObjectEx._PROP_STOREFIELD_PREFIX="__$",DataType.StringUtils=StringUtils,$jsRoot.Class=Class,$jsRoot.ClassEx=ClassEx,$jsRoot.ObjectEx=ObjectEx,$jsRoot.DataType=DataType,module.exports={Class:Class,ClassEx:ClassEx,ObjectEx:ObjectEx,DataType:DataType}}(void 0)},function(module,exports,__webpack_require__){"use strict";var JsonUtility={DEF_LOAD_TIMEOUT:2e4,FILE_EXT_JSON:".json",FILE_EXT_JSON_JS_WRAPPER:".jsonjs",DEF_SERIALIZE_TO_JSCODE_VARNAME:"__jsonvar__",parse:function(text){return JSON.parse(text)},parseFromJsWrappedCode:function parseFromJsWrappedCode(code,jsVarName){return jsVarName||(jsVarName=JsonUtility.DEF_SERIALIZE_TO_JSCODE_VARNAME),eval(code),JsonUtility.parse(eval(jsVarName))},load:function(url,callback,options){return WebShow.URL.getFileExt(url).toLowerCase()==JsonUtility.FILE_EXT_JSON_JS_WRAPPER?JsonUtility.loadJsWrapper(url,callback,options):JsonUtility.loadJson(url,callback,options)},loadJsWrapper:function loadJsWrapper(url,callback,options){var loptions=options||{},wrapperVarName=loptions.wrapperVarName||JsonUtility.DEF_SERIALIZE_TO_JSCODE_VARNAME;loptions.timeout||(loptions.timeout=JsonUtility.DEF_LOAD_TIMEOUT);var runCallBack=function(jsonObj,isSuccess){callback&&callback(jsonObj,isSuccess)},wrapperCallback=function wrapperCallback(src,isSuccess){var jsonObj=null;if(isSuccess){var wrapperVar=eval(wrapperVarName);wrapperVar&&(jsonObj="string"==typeof wrapperVar?JsonUtility.parse(wrapperVar):wrapperVar),runCallBack(jsonObj,!0)}else runCallBack(null,!1)};WebShow.ScriptLoader.load(url,wrapperCallback,loptions)},loadJson:function(url,callback,options){var loptions=options||{};loptions.timeout||(loptions.timeout=JsonUtility.DEF_LOAD_TIMEOUT),loptions.resultType=WebShow.FileLoader.ResultType.TEXT,loptions.extractBody=!1;var wrapperCallback=function(content,isSuccess,url){if(isSuccess){var jsonObj=JsonUtility.parse(content);callback(jsonObj,!0)}else callback(null,!1)};(new WebShow.XHRLoader).load(url,wrapperCallback,loptions)},serializeToStr:function(srcObj,options){return options&&options.prettyPrint?JSON.stringify(srcObj,null,options.indentSpaces||2):JSON.stringify(srcObj)},serializeToJsCode:function(srcObj,jsVarName,quoteChar){quoteChar||(quoteChar="'"),jsVarName||(jsVarName=JsonUtility.DEF_SERIALIZE_TO_JSCODE_VARNAME);var jsonStr=JsonUtility.serializeToStr(srcObj),sreg=new RegExp(quoteChar,"g");return jsonStr=jsonStr.replace(sreg,"\\"+quoteChar),"var "+jsVarName+" = "+quoteChar+jsonStr+quoteChar}},XmlUtility={DEF_INCLUDE_TAG_NAME:"include",DEF_INCLUDE_SRC_ATTRIB:"src",DEF_LOAD_TIMEOUT:2e4,DEF_BYPASS_ROOT_ELEM:!0,DEF_SERIALIZE_TO_JSCODE_VARNAME:"__xmlStr__",FILE_EXT_XML:".xml",FILE_EXT_XML_JS_WRAPPER:".xmljs",newDocument:function(rootTagName,namespaceURL){if(rootTagName||(rootTagName=""),namespaceURL||(namespaceURL=""),document.implementation&&document.implementation.createDocument){var doc=document.implementation.createDocument(namespaceURL,rootTagName,null);return doc}var doc=new ActiveXObject("MSXML2.DOMDocument");if(rootTagName){var prefix="",tagname=rootTagName,p=rootTagName.indexOf(":");-1!=p&&(prefix=rootTagName.substring(0,p),tagname=rootTagName.substring(p+1));var text="<"+(prefix?prefix+":":"")+tagname+(namespaceURL?(prefix?" xmlns:":" xmlns")+prefix+'="'+namespaceURL+'"':"")+"/>";doc.loadXML(text)}return doc},parse:function(text){if("undefined"!=typeof DOMParser)return(new DOMParser).parseFromString(text,"application/xml");if("undefined"!=typeof ActiveXObject){var doc=XmlUtility.newDocument();return doc.loadXML(text),doc}var url="data:text/xml;charset=utf-8,"+encodeURIComponent(text),request=new XMLHttpRequest;return request.open("GET",url,!1),request.send(null),request.responseXML},load:function(url,callback,options){return WebShow.URL.getFileExt(url).toLowerCase()==XmlUtility.FILE_EXT_XML_JS_WRAPPER?XmlUtility.loadHelper.loadJsWrapper(url,callback,options):(options||(options={disableInclude:!1}),options.disableInclude?XmlUtility.loadHelper.loadSimple(url,callback,options.timeout):XmlUtility.loadHelper.loadAndHandleIncludeElement(url,callback,options))},loadHelper:{loadSimple:function(url,callback,loadTimeout){var async=null!=callback;if(null!==loadTimeout&&void 0!==loadTimeout||(loadTimeout=XmlUtility.DEF_LOAD_TIMEOUT),document.implementation&&document.implementation.createDocument){var req=new XMLHttpRequest,timeoutHandle=null;loadTimeout&&(timeoutHandle=setTimeout(function(){runCallBack(null,!1)},loadTimeout));var runCallBack=function(xmldoc,isSuccess){timeoutHandle&&clearTimeout(timeoutHandle),callback&&callback(xmldoc,isSuccess)};async&&(req.onreadystatechange=function(){if(4==req.readyState){var xmldoc=req.responseXML;xmldoc&&xmldoc.documentElement?runCallBack(xmldoc,!0):runCallBack(null,!1)}});try{req.open("get",url,async),req.send(null)}catch(e){WebShow.reportError(e),runCallBack(null,!1)}var doc=req.responseXML;return doc&&doc.documentElement?doc:null}return XmlUtility.loadHelper.loadSimpleViaDoc(url,callback)},loadSimpleViaDoc:function(url,callback){var async=null!=callback,xmldoc=XmlUtility.newDocument("dummy_dummy_dummy_dummy");return xmldoc.async=async,async&&(xmldoc.onreadystatechange=function(){4==xmldoc.readyState&&(xmldoc.documentElement&&"dummy_dummy_dummy_dummy"!=xmldoc.documentElement.tag?callback(xmldoc,!0):callback(xmldoc,!1))}),xmldoc.load(url),xmldoc},loadAndHandleIncludeElement:function(url,callback,options){var loadTimeout;if(loadTimeout=options?options.timeout:null,null==callback){var xmldoc=XmlUtility.loadHelper.loadSimple(url,null,loadTimeout);return xmldoc&&xmldoc.documentElement?(XmlUtility.loadHelper.handleIncludedXmlInElement(xmldoc.documentElement,null,options),xmldoc):null}return XmlUtility.loadHelper.loadSimple(url,function(xmldoc,isSuccess){isSuccess?XmlUtility.loadHelper.handleIncludedXmlInElement(xmldoc.documentElement,function(count){callback(xmldoc,!0)},options):callback(xmldoc,!1)},loadTimeout)},loadJsWrapper:function loadJsWrapper(url,callback,options){options=options||{};var wrapperVarName=options.wrapperVarName||XmlUtility.DEF_SERIALIZE_TO_JSCODE_VARNAME,loadTimeout=options.timeout;null!==loadTimeout&&void 0!==loadTimeout||(loadTimeout=XmlUtility.DEF_LOAD_TIMEOUT);var runCallBack=function(xmldoc,isSuccess){callback&&callback(xmldoc,isSuccess)},wrapperCallback=function wrapperCallback(src,isSuccess){if(isSuccess){var xmlContent=eval(wrapperVarName),doc=XmlUtility.parse(xmlContent);runCallBack(doc,!0)}else runCallBack(null,!1)};options.timeout=loadTimeout,WebShow.ScriptLoader.load(url,wrapperCallback,options)},getIncludeElements:function(rootElement,includeTagName){return includeTagName||(includeTagName=XmlUtility.DEF_INCLUDE_TAG_NAME),rootElement.getElementsByTagName(includeTagName)},handleIncludedXmlInElement:function(rootElement,callback,options){options||(options={});var includeTagName=options.includeTagName||XmlUtility.DEF_INCLUDE_TAG_NAME,srcAttribName=options.srcAttribName||XmlUtility.DEF_INCLUDE_SRC_ATTRIB,bypassRootElem=null!=options.bypassRootElem?options.bypassRootElem:XmlUtility.DEF_BYPASS_ROOT_ELEM,sync=null==callback,docURL=XmlUtility.getXmlDocUrl(rootElement.ownerDocument),includeElems=XmlUtility.loadHelper.getIncludeElements(rootElement,includeTagName);if(!srcAttribName)var srcURL=null;var includeElem=null,finishedLoadCount=0,totalLoadCount=includeElems.length;if(totalLoadCount<=0)return callback&&callback(0),null;for(var includedDoc,i=includeElems.length-1;i>=0;--i)includeElem=includeElems[i],(srcURL=includeElem.getAttribute(srcAttribName))&&(srcURL=WebShow.URL.mergePath(srcURL,docURL),sync?(includedDoc=XmlUtility.loadHelper.loadSimple(srcURL))&&XmlUtility.loadHelper.insertIncludedSection(includedDoc,includeElem,bypassRootElem):XmlUtility.loadHelper.loadSimple(srcURL,function(originIncludeElem,doc,isSuccess){isSuccess&&doc&&(includedDoc=doc,XmlUtility.loadHelper.insertIncludedSection(includedDoc,originIncludeElem,bypassRootElem)),++finishedLoadCount==totalLoadCount&&callback(finishedLoadCount)}.bind(this,includeElem)));return rootElement},insertIncludedSection:function(includedDoc,originIncludeElem,bypassRootElem){var elems=[];if(bypassRootElem)for(var child=includedDoc.documentElement.firstChild;child;)child.nodeType==Node.ELEMENT_NODE&&elems.push(child),child=child.nextSibling;else elems.push(includedDoc.documentElement);for(var elem,originDoc=originIncludeElem.ownerDocument,i=(originDoc.documentElement,0),l=elems.length;i<l;++i){var elem=elems[i];originDoc.importNode&&(elem=originDoc.importNode(elem,!0)),originIncludeElem.parentNode.insertBefore(elem,originIncludeElem)}return originIncludeElem.parentNode.removeChild(originIncludeElem),originDoc}},serializeNode:function(node,options){if(options&&options.prettyPrint)return XmlUtility.serializeNodePretty(node);if("undefined"!=typeof XMLSerializer)return(new XMLSerializer).serializeToString(node);if(node.xml)return node.xml;throw"XML.serialize is not supported or can't serialize "+node},serializeNodePretty:function(node){try{return XML((new XMLSerializer).serializeToString(node)).toXMLString()}catch(e){return XmlUtility.serializeNode(node)}},serializeNodeToJsCode:function(node,jsVarName,quoteChar){quoteChar||(quoteChar="'"),jsVarName||(jsVarName=XmlUtility.DEF_SERIALIZE_TO_JSCODE_VARNAME);var xmlString=XmlUtility.serializeNode(node),sreg=new RegExp(quoteChar,"g");return xmlString=xmlString.replace(sreg,"\\"+quoteChar),"var "+jsVarName+" = "+quoteChar+xmlString+quoteChar+";"},parseFromJsWrappedCode:function parseFromJsWrappedCode(code,jsVarName){eval(code);var xmlText=eval(jsVarName);return XmlUtility.parse(xmlText)},getXmlDocUrl:function(xmlDoc){return xmlDoc.url||xmlDoc.documentURI||xmlDoc.URL||xmlDoc.location}};module.exports={JsonUtility:JsonUtility,XmlUtility:XmlUtility}},function(module,exports,__webpack_require__){"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},Class=__webpack_require__(0).Class,ClassEx=__webpack_require__(0).ClassEx,ObjectEx=__webpack_require__(0).ObjectEx,DataType=__webpack_require__(0).DataType,ObjSerializer=Class.create({CLASS_NAME:"ObjSerializer",serializeValue:function(value){return value},deserializeValue:function(value,preferedType){return value},propNameToStorageName:function(name){return name},storageNameToPropName:function(name){return name},getObjCustomSaveMethod:function(obj){return obj.doSaveObj},getObjCustomLoadMethod:function(obj){return obj.doLoadObj},getObjCustomPropSaveMethod:function(obj){return obj.doSaveProp},getObjCustomPropLoadMethod:function(obj){return obj.doLoadProp},isUndefined:function(value){return DataType.isUndefinedValue(value)},isNull:function(value){return null===value},isNaN:function(value){return value!=value},isFunction:function(value){return DataType.isFunctionValue(value)},isArray:function(value){return DataType.isArrayValue(value)},isDate:function(value){return DataType.isDateValue(value)},isObject:function(value){return DataType.isObjectValue(value)},isObjectEx:function(value){return DataType.isObjectExValue(value)},isSimpleType:function(value){var s=void 0===value?"undefined":_typeof(value);return"string"==s||"number"==s||"boolean"==s||"undefined"==s||this.isNull(value)},isComplexType:function(value){return!this.isSimpleType(value)},createChildStorageNode:function(storageNode,name,isForArray){},appendArrayItemStorageNode:function(parentNode,name,isForArray){},getNameForArrayItemStorageNode:function(arrayItemObj){return this.getDefaultArrayItemStorageName()},getChildStorageNode:function(parentNode,nodeName){},getAllArrayItemStorageNodes:function(arrayNode){},getAllStoredStorageNames:function(storageNode){},setStorageNodeExplicitType:function(storageNode,explicitType){},getStorageNodeExplicitType:function(storageNode){},getStorageNodeName:function(storageNode){},isComplexStorageNode:function(storageNode){},isComplexArrayItemStorageNode:function(storageNode){},isSimpleStorageNode:function(storageNode){},getValueExplicitType:function(value){return value instanceof ObjectEx?value.getClassName():this.isObject(value)?DataType.OBJECT:this.isArray(value)?DataType.ARRAY:this.isDate(value)?DataType.DATE:void 0===value?"undefined":_typeof(value)},getDefaultArrayItemStorageName:function(){return"item"},getDefaultDateStorageName:function(){return"date"},save:function(obj,storageNode,options){if("object"==(void 0===obj?"undefined":_typeof(obj))){var customSaveMethod=this.getObjCustomSaveMethod(obj);if(customSaveMethod)return customSaveMethod(obj,storageNode,this)}var result=this.doSave(obj,storageNode,options||{});return result&&this.isFunction(obj.saved)&&obj.saved(),result},doSave:function(obj,storageNode,options){return"object"==(void 0===obj?"undefined":_typeof(obj))&&(obj instanceof ObjectEx?this.doSaveObjectEx(obj,storageNode,options):this.isArray(obj)?this.doSaveArray(obj,storageNode):this.isDate(obj)?this.doSaveDate(obj,storageNode):this.doSaveSimpleObject(obj,storageNode)),this.setStorageNodeExplicitType(storageNode,this.getValueExplicitType(obj)),obj},doSaveSimpleObject:function(obj,storageNode){for(var fieldName in obj)if(obj.hasOwnProperty(fieldName)){var explicitType,fieldValue=obj[fieldName];this.isComplexType(fieldValue)&&(explicitType=this.getValueExplicitType(fieldValue)),this.doSaveFieldValue(obj,fieldName,fieldValue,storageNode,explicitType)}},doSaveArray:function(arrayObj,storageNode){for(var i=0,l=arrayObj.length;i<l;++i){var item=arrayObj[i],nodeName=this.getNameForArrayItemStorageNode(item);if(this.isComplexType(item)){var subNode=this.appendArrayItemStorageNode(storageNode,this.propNameToStorageName(nodeName),this.isArray(item));this.setStorageNodeExplicitType(subNode,this.getValueExplicitType(item)),this.save(item,subNode)}else this.doAppendArrayItemSimpleValue(this.serializeValue(item),void 0===item?"undefined":_typeof(item),storageNode)}},doSaveDate:function(obj,storageNode){var s=obj.toUTCString();this.doSaveSimpleValue(obj,this.propNameToStorageName(this.getDefaultDateStorageName()),this.serializeValue(s),DataType.DATE,storageNode)},doSaveObjectEx:function(obj,storageNode,options){for(var props=obj.getAllPropList(),propFilter=options.propFilter,i=0,l=props.getLength();i<l;++i){var prop=props.getPropInfoAt(i);if(!propFilter||propFilter(prop,obj)){var customSaveMethod=this.getObjCustomPropSaveMethod(obj),saved=!1;customSaveMethod&&(saved=customSaveMethod(obj,prop,storageNode,this)),saved||prop.serializable&&this.doSaveObjectExProp(obj,prop,storageNode,options)}}},doSaveObjectExProp:function(obj,prop,storageNode,options){var propName=prop.name,propType=prop.dataType,propValue=obj.getPropValue(propName);if(options.saveDefaultValues||propValue!==prop.defaultValue){var explicitType;propValue instanceof ObjectEx?propValue.getClassName()!=propType&&(explicitType=propValue.getClassName()):this.isComplexType(propValue)&&(explicitType=this.getValueExplicitType(propValue))==propType&&(explicitType=void 0),this.doSaveFieldValue(obj,propName,propValue,storageNode,explicitType)}},doSaveFieldValue:function(obj,fieldName,fieldValue,storageNode,explicitType){if("function"!=typeof fieldValue)if(this.isComplexType(fieldValue)){var subNode=this.createChildStorageNode(storageNode,this.propNameToStorageName(fieldName),this.isArray(fieldValue));explicitType&&this.setStorageNodeExplicitType(subNode,explicitType),this.save(fieldValue,subNode)}else this.doSaveSimpleValue(obj,this.propNameToStorageName(fieldName),this.serializeValue(fieldValue),this.getValueExplicitType(fieldValue),storageNode)},doSaveSimpleValue:function(obj,storageName,storageValue,valueType,storageNode){},doAppendArrayItemSimpleValue:function(storageValue,valueType,arrayStorageNode){},load:function(obj,storageNode,Kekule){if(!obj){var objType=this.getStorageNodeExplicitType(storageNode);if(!objType)return this.doLoadUntypedNode?this.doLoadUntypedNode(storageNode):null;obj=DataType.createInstance(objType,Kekule)}if("object"===(void 0===obj?"undefined":_typeof(obj))){var customLoadMethod=this.getObjCustomLoadMethod(obj);if(customLoadMethod)return customLoadMethod(obj,storageNode,this)}var result=this.doLoad(obj,storageNode,Kekule);return result&&this.isFunction(obj.loaded)&&obj.loaded(),result},doLoad:function(obj,storageNode,Kekule){this.getStorageNodeExplicitType(storageNode);return"object"==(void 0===obj?"undefined":_typeof(obj))&&(obj=obj instanceof ObjectEx?this.doLoadObjectEx(obj,storageNode,Kekule):this.isArray(obj)?this.doLoadArray(obj,storageNode,Kekule):this.isDate(obj)?this.doLoadDate(obj,storageNode):this.doLoadSimpleObject(obj,storageNode)),obj},doLoadArray:function(arrayObj,storageNode,Kekule){for(var itemNodes=this.getAllArrayItemStorageNodes(storageNode),i=0,l=itemNodes.length;i<l;++i){var node=itemNodes[i];if(this.isComplexArrayItemStorageNode(node)){var obj,valueType=this.getStorageNodeExplicitType(node)||this.getStorageNodeName(node);valueType?(obj=DataType.createInstance(valueType,Kekule),this.load(obj,node)):(obj={},this.load(obj,node)),arrayObj.push(obj)}else{var value=this.deserializeValue(this.doGetArrayItemSimpleStorageValue(node));arrayObj.push(value)}}return arrayObj},doLoadDate:function(obj,storageNode){var storageName=this.propNameToStorageName(this.getDefaultDateStorageName()),s=this.doLoadSimpleValue(obj,storageName,DataType.DATE,storageNode);if(s){var r=new Date(s);return obj.copyFrom(r),obj}},doLoadSimpleObject:function(obj,storageNode,Kekule){for(var storageNames=this.getAllStoredStorageNames(storageNode),i=0,l=storageNames.length;i<l;++i){var storageName=storageNames[i],fieldName=this.storageNameToPropName(storageName),subNode=this.getChildStorageNode(storageNode,storageName);if(subNode){var subObj,explicitType=this.getStorageNodeExplicitType(subNode);subObj=explicitType?DataType.createInstance(explicitType,Kekule):{},this.load(subObj,subNode),obj[fieldName]=subObj}else{var value=this.doLoadSimpleValue(obj,storageName,null,storageNode);obj[fieldName]=value}}return obj},doLoadObjectEx:function(obj,storageNode,Kekule){for(var props=obj.getAllPropList(),i=0,l=props.getLength();i<l;++i){var prop=props.getPropInfoAt(i);if(prop.serializable){var customLoadMethod=this.getObjCustomPropLoadMethod(obj),loaded=!1;customLoadMethod&&(loaded=customLoadMethod(obj,prop,storageNode,this)),loaded||this.doLoadObjectExProp(obj,prop,storageNode,Kekule)}}return obj},doLoadObjectExProp:function(obj,prop,storageNode,Kekule){var propName=prop.name,propType=prop.dataType,propValue=this.doLoadFieldValue(obj,propName,storageNode,propType,Kekule);null!==propValue&&void 0!==propValue&&obj.setPropValue(propName,propValue,!0)},doLoadFieldValue:function(obj,fieldName,storageNode,supposedValueType,Kekule){var result,handled=!1;if(DataType.isComplexType(supposedValueType)){var subNode=this.getChildStorageNode(storageNode,this.propNameToStorageName(fieldName));if(subNode){var explicitType=this.getStorageNodeExplicitType(subNode);result=explicitType&&explicitType!=supposedValueType?DataType.createInstance(explicitType,Kekule):DataType.createInstance(supposedValueType,Kekule),this.load(result,subNode,Kekule),handled=!0}}return!DataType.isSimpleType(supposedValueType)&&handled||(result=this.doLoadSimpleValue(obj,this.propNameToStorageName(fieldName),supposedValueType,storageNode)),result},doLoadSimpleValue:function(obj,storageName,valueType,storageNode){var storageValue=this.doLoadSimpleStorageValue(storageName,storageNode);return this.deserializeValue(storageValue,valueType)},doLoadSimpleStorageValue:function(storageName,storageNode){},doGetArrayItemSimpleStorageValue:function(arrayItemStorageNode){}}),JsonObjSerializer=Class.create(ObjSerializer,{CLASS_NAME:"JsonObjSerializer",TYPE_TAG_NAME:"__type__",createChildStorageNode:function(storageNode,name,isForArray){var result=isForArray?[]:{};return storageNode[name]=result,result},appendArrayItemStorageNode:function(parentNode,name,isForArray){var result=isForArray?[]:{};return parentNode.push(result),result},getChildStorageNode:function(parentNode,nodeName){var result=parentNode[nodeName];return this.isSimpleType(result)&&(result=null),result},getAllArrayItemStorageNodes:function(arrayNode){return Array.prototype.slice.call(arrayNode)},getAllStoredStorageNames:function(storageNode){var result=[];for(var name in storageNode)storageNode.hasOwnProperty(name)&&name!=this.TYPE_TAG_NAME&&result.push(name);return result},isComplexStorageNode:function(storageNode){return this.isComplexType(storageNode)},isComplexArrayItemStorageNode:function(storageNode){return this.isComplexStorageNode(storageNode)},isSimpleStorageNode:function(storageNode){return this.isSimpleType(storageNode)},setStorageNodeExplicitType:function(storageNode,explicitType){this.isArray(storageNode)||(storageNode[this.TYPE_TAG_NAME]=explicitType)},getStorageNodeExplicitType:function(storageNode){var r=storageNode[this.TYPE_TAG_NAME]||null;return!r&&this.isArray(storageNode)?DataType.ARRAY:r},doSaveSimpleValue:function(obj,storageName,storageValue,valueType,storageNode){storageNode[storageName]=storageValue},doAppendArrayItemSimpleValue:function(storageValue,valueType,arrayStorageNode){return arrayStorageNode.push(storageValue)},doLoadSimpleStorageValue:function(storageName,storageNode){return storageNode[storageName]},doLoadUntypedNode:function(storageNode){return storageNode},doGetArrayItemSimpleStorageValue:function(arrayItemStorageNode){return arrayItemStorageNode}}),XmlObjSerializer=Class.create(ObjSerializer,{CLASS_NAME:"XmlObjSerializer",TYPE_TAG_NAME:"dataType",getLocalName:function(elem){return elem.localName||elem.baseName||elem.nodeName},getElemTextValue:function(elem){for(var result="",i=0,l=elem.childNodes.length;i<l;++i)elem.childNodes[i].nodeType==Node.TEXT_NODE&&(result+=elem.childNodes[i].nodeValue);return result},serializeValue:function(value){return DataType.StringUtils.serializeValue(value)},deserializeValue:function(value,preferedType){return DataType.StringUtils.deserializeValue(value,preferedType)},createChildStorageNode:function(storageNode,name,isForArray){var result=storageNode.ownerDocument.createElement(name);return storageNode.appendChild(result),result},appendArrayItemStorageNode:function(parentNode,name,isForArray){return this.createChildStorageNode(parentNode,name,isForArray)},getAllArrayItemStorageNodes:function(arrayNode){for(var result=[],i=0,l=arrayNode.childNodes.length;i<l;++i){var node=arrayNode.childNodes[i];node.nodeType==Node.ELEMENT_NODE&&result.push(node)}return result},getAllStoredStorageNames:function(storageNode){for(var result=[],i=0,l=storageNode.childNodes.length;i<l;++i){var node=storageNode.childNodes[i];node.nodeType==Node.ELEMENT_NODE&&this.getLocalName(node)!=this.TYPE_TAG_NAME&&result.push(this.getLocalName(node))}for(var i=0,l=storageNode.attributes.length;i<l;++i){var attrib=storageNode.attributes[i];this.getLocalName(attrib)!=this.TYPE_TAG_NAME&&result.push(this.getLocalName(attrib))}return result},getChildStorageNode:function(parentNode,nodeName){for(var result=null,i=0,l=parentNode.childNodes.length;i<l;++i){var node=parentNode.childNodes[i];node.nodeType==Node.ELEMENT_NODE&&this.getLocalName(node)==nodeName&&(result=node)}return result},isComplexStorageNode:function(storageNode){return storageNode.nodeType==Node.ELEMENT_NODE},isComplexArrayItemStorageNode:function(storageNode){return this.isComplexStorageNode(storageNode)&&storageNode.attributes.length&&!this.getElemTextValue(storageNode).trim()},isSimpleStorageNode:function(storageNode){return storageNode.nodeType==Node.ATTRIBUTE_NODE},setStorageNodeExplicitType:function(storageNode,explicitType){storageNode.setAttribute(this.TYPE_TAG_NAME,explicitType)},getStorageNodeExplicitType:function(storageNode){return storageNode.getAttribute(this.TYPE_TAG_NAME)||null},getStorageNodeName:function(storageNode){var result=storageNode.tagName;return result==this.getDefaultArrayItemStorageName()?null:result},doSaveSimpleObject:function($super,obj,storageNode){$super(obj,storageNode)},doSaveArray:function($super,arrayObj,storageNode){$super(arrayObj,storageNode)},doSaveSimpleValue:function(obj,storageName,storageValue,valueType,storageNode){storageNode.setAttribute(storageName,storageValue)},doAppendArrayItemSimpleValue:function(storageValue,valueType,arrayStorageNode){var node=this.appendArrayItemStorageNode(arrayStorageNode,this.propNameToStorageName(this.getDefaultArrayItemStorageName()),!1),textNode=node.ownerDocument.createTextNode(storageValue);node.appendChild(textNode)},doLoadSimpleStorageValue:function(storageName,storageNode){return storageNode.getAttribute(storageName)},doGetArrayItemSimpleStorageValue:function(arrayItemStorageNode){return this.getElemTextValue(arrayItemStorageNode)}}),ObjSerializerFactory={_serializerClasses:{},_defaultName:null,registerSerializer:function(name,serializerClass,isDefault){var sClass="string"==typeof serializerClass?ClassEx.findClass(serializerClass):serializerClass;ObjSerializerFactory._serializerClasses[name]=sClass,isDefault&&(ObjSerializerFactory._defaultName=name)},getSerializer:function(name){var sName=name||ObjSerializerFactory._defaultName;if(sName){var sClass=ObjSerializerFactory._serializerClasses[sName];return sClass?new sClass:null}return null}};!function(){ObjSerializerFactory.registerSerializer("json",JsonObjSerializer,!0),ObjSerializerFactory.registerSerializer("xml",XmlObjSerializer)}(),ClassEx.extend(ObjectEx,{saveObj:function(destNode,serializerOrName,options){var serializer;return serializer=serializerOrName?"string"==typeof serializerOrName?ObjSerializerFactory.getSerializer(serializerOrName):serializerOrName:ObjSerializerFactory.getSerializer(),serializer.save(this,destNode,options)},loadObj:function(srcNode,serializerOrName,Kekule){var serializer;return serializer=serializerOrName?"string"==typeof serializerOrName?ObjSerializerFactory.getSerializer(serializerOrName):serializerOrName:ObjSerializerFactory.getSerializer(),serializer.load(this,srcNode,Kekule)}}),Object.extend(ClassEx,{saveObj:function(obj,destNode,serializerOrName,options){var serializer;return serializer=serializerOrName?"string"==typeof serializerOrName?ObjSerializerFactory.getSerializer(serializerOrName):serializerOrName:ObjSerializerFactory.getSerializer(),serializer.save(obj,destNode,options)},loadObj:function(obj,srcNode,serializerOrName){var serializer;return serializer=serializerOrName?"string"==typeof serializerOrName?ObjSerializerFactory.getSerializer(serializerOrName):serializerOrName:ObjSerializerFactory.getSerializer(),serializer.load(obj,srcNode)}}),Object.extend(DataType,{valueToJson:function(value,options){if(DataType.isSimpleValue(value))return JSON.stringify(value);var result=DataType.isArrayValue(value)?[]:{};return ClassEx.saveObj(value,result,"json",options),JSON.stringify(result)},jsonToValue:function(jsonStr){var jsonObj=JSON.parse(jsonStr);return!jsonObj||DataType.isSimpleValue(jsonObj)?jsonObj:ClassEx.loadObj(null,jsonObj,"json")}}),module.exports={ObjSerializerFactory:ObjSerializerFactory}},function(module,exports,__webpack_require__){"use strict";Array.prototype.indexOf||(Array.prototype.indexOf=function(item,i){i||(i=0);var length=this.length;for(i<0&&(i=length+i);i<length;i++)if(this[i]===item)return i;return-1}),__webpack_require__(0),__webpack_require__(1),__webpack_require__(2);var Kekule={};Kekule=__webpack_require__(4)(Kekule),Kekule=__webpack_require__(5)(Kekule),Kekule=__webpack_require__(7)(Kekule),Kekule=__webpack_require__(8)(Kekule),Kekule=__webpack_require__(9)(Kekule),Kekule=__webpack_require__(10)(Kekule),Kekule=__webpack_require__(11)(Kekule),Kekule=__webpack_require__(12)(Kekule),Kekule=__webpack_require__(13)(Kekule),Kekule=__webpack_require__(17)(Kekule),Kekule=__webpack_require__(18)(Kekule),Kekule=__webpack_require__(19)(Kekule),Kekule=__webpack_require__(20)(Kekule),Kekule=__webpack_require__(21)(Kekule),Kekule=__webpack_require__(22)(Kekule),Kekule=__webpack_require__(23)(Kekule),Kekule=__webpack_require__(24)(Kekule),Kekule=__webpack_require__(25)(Kekule),Kekule=__webpack_require__(26)(Kekule),Kekule=__webpack_require__(27)(Kekule),Kekule=__webpack_require__(28)(Kekule),Kekule=__webpack_require__(29)(Kekule),Kekule=__webpack_require__(30)(Kekule),Kekule=__webpack_require__(31)(Kekule),Kekule=__webpack_require__(32)(Kekule),Kekule=__webpack_require__(33)(Kekule),Kekule=__webpack_require__(34)(Kekule),Kekule=__webpack_require__(35)(Kekule),Kekule=__webpack_require__(36)(Kekule),Kekule=__webpack_require__(37)(Kekule),Kekule=__webpack_require__(38)(Kekule),Kekule=__webpack_require__(39)(Kekule),Kekule=__webpack_require__(40)(Kekule),Kekule=__webpack_require__(41)(Kekule),Kekule=__webpack_require__(42)(Kekule),Kekule=__webpack_require__(43)(Kekule),Kekule=__webpack_require__(44)(Kekule),Kekule=__webpack_require__(45)(Kekule),Kekule=__webpack_require__(46)(Kekule),Kekule=__webpack_require__(47)(Kekule),Kekule=__webpack_require__(48)(Kekule),Kekule=__webpack_require__(49)(Kekule),Kekule=__webpack_require__(50)(Kekule),Kekule=__webpack_require__(51)(Kekule),Kekule=__webpack_require__(52)(Kekule),Kekule=__webpack_require__(53)(Kekule),Kekule=__webpack_require__(54)(Kekule),Kekule=__webpack_require__(55)(Kekule),Kekule=__webpack_require__(56)(Kekule),Kekule=__webpack_require__(57)(Kekule),Kekule=__webpack_require__(58)(Kekule),Kekule=__webpack_require__(59)(Kekule),Kekule=__webpack_require__(60)(Kekule),Kekule=__webpack_require__(61)(Kekule),Kekule=__webpack_require__(62)(Kekule),Kekule=__webpack_require__(63)(Kekule),Kekule=__webpack_require__(65)(Kekule),Kekule=__webpack_require__(66)(Kekule),Kekule=__webpack_require__(67)(Kekule),Kekule=__webpack_require__(68)(Kekule),Kekule=__webpack_require__(69)(Kekule),Kekule=__webpack_require__(70)(Kekule),Kekule=__webpack_require__(71)(Kekule),Kekule=__webpack_require__(72)(Kekule),Kekule=__webpack_require__(73)(Kekule),Kekule=__webpack_require__(74)(Kekule),Kekule=__webpack_require__(75)(Kekule),Kekule=__webpack_require__(76)(Kekule),Kekule=__webpack_require__(77)(Kekule),Kekule=__webpack_require__(78)(Kekule),Kekule=__webpack_require__(79)(Kekule),Kekule=__webpack_require__(80)(Kekule),Kekule=__webpack_require__(81)(Kekule),Kekule=__webpack_require__(82)(Kekule),Kekule=__webpack_require__(83)(Kekule),Kekule=__webpack_require__(84)(Kekule),Kekule=__webpack_require__(85)(Kekule),Kekule=__webpack_require__(86)(Kekule),Kekule=__webpack_require__(87)(Kekule),Kekule=__webpack_require__(88)(Kekule),Kekule=__webpack_require__(89)(Kekule),Kekule=__webpack_require__(90)(Kekule),Kekule=__webpack_require__(91)(Kekule),Kekule=__webpack_require__(92)(Kekule),Kekule=__webpack_require__(93)(Kekule),Kekule=__webpack_require__(94)(Kekule),Kekule=__webpack_require__(95)(Kekule),Kekule=__webpack_require__(96)(Kekule),Kekule=__webpack_require__(97)(Kekule),Kekule=__webpack_require__(98)(Kekule),Kekule=__webpack_require__(99)(Kekule),Kekule=__webpack_require__(100)(Kekule),Kekule=__webpack_require__(101)(Kekule),Kekule=__webpack_require__(102)(Kekule),Kekule=__webpack_require__(103)(Kekule),Kekule=__webpack_require__(104)(Kekule),Kekule=__webpack_require__(105)(Kekule),Kekule=__webpack_require__(106)(Kekule),Kekule=__webpack_require__(107)(Kekule),Kekule=__webpack_require__(108)(Kekule),Kekule=__webpack_require__(109)(Kekule),Kekule=__webpack_require__(110)(Kekule),Kekule=__webpack_require__(111)(Kekule),Kekule=__webpack_require__(112)(Kekule),Kekule=__webpack_require__(113)(Kekule),Kekule=__webpack_require__(114)(Kekule),Kekule=__webpack_require__(115)(Kekule),Kekule=__webpack_require__(116)(Kekule),Kekule=__webpack_require__(117)(Kekule),Kekule=__webpack_require__(118)(Kekule),Kekule=__webpack_require__(119)(Kekule),Kekule=__webpack_require__(120)(Kekule),Kekule=__webpack_require__(121)(Kekule),Kekule=__webpack_require__(122)(Kekule),Kekule=__webpack_require__(123)(Kekule),Kekule=__webpack_require__(124)(Kekule),Kekule=__webpack_require__(125)(Kekule),Kekule=__webpack_require__(126)(Kekule),Kekule=__webpack_require__(127)(Kekule),Kekule=__webpack_require__(128)(Kekule),Kekule=__webpack_require__(129)(Kekule),Kekule=__webpack_require__(130)(Kekule),Kekule=__webpack_require__(131)(Kekule),Kekule=__webpack_require__(132)(Kekule),Kekule=__webpack_require__(133)(Kekule),Kekule._loaded();var Class=__webpack_require__(0).Class,ClassEx=__webpack_require__(0).ClassEx,ObjectEx=__webpack_require__(0).ObjectEx,DataType=__webpack_require__(0).DataType;exports.Kekule=Kekule,exports.Class=Class,exports.ClassEx=ClassEx,exports.ObjectEx=ObjectEx,exports.DataType=DataType},function(module,exports,__webpack_require__){"use strict";module.exports=function(Kekule){return Kekule={LIBNAME:"Kekule.js",LIBNAME_CORE:"Kekule",VERSION:"0.7.7.18010501",LOADED:!1,_afterLoadProcedures:[],PROP_AUTO_TITLE:!0},Kekule._loaded=function(){Kekule.LOADED=!0;for(var procs=Kekule._afterLoadProcedures;procs.length;){var proc=procs.shift();proc&&proc()}},Kekule._isLoaded=function(){return Kekule.LOADED},Kekule._registerAfterLoadProc=function(proc){proc&&Kekule._afterLoadProcedures.push(proc)},"undefined"!=typeof window&&(Kekule.$jsRoot=window),"undefined"!=typeof document&&(Kekule.$document=document),Kekule.scriptSrcInfo=Kekule.$jsRoot.__$kekule_load_info__,Kekule.scriptSrcInfo&&Kekule.scriptSrcInfo.language&&(Kekule.language=Kekule.scriptSrcInfo.language),!Kekule.scriptSrcInfo&&Kekule.$jsRoot.document&&(Kekule.scriptSrcInfo=function(){for(var entranceSrc=/^(.*\/?)kekule\..*\.js(\?.*)?$/,scriptElems=document.getElementsByTagName("script"),i=scriptElems.length-1;i>=0;--i){var elem=scriptElems[i];if(elem.src){var matchResult=elem.src.match(entranceSrc);if(matchResult){var pstr=matchResult[2];pstr&&(pstr=pstr.substr(1));return{src:elem.src,path:matchResult[1],paramStr:pstr,useMinFile:!0}}}}return null}()),Kekule.getScriptPath=function(){return Kekule.scriptSrcInfo.path},Kekule.$jsRoot&&Kekule.$jsRoot.addEventListener&&Kekule.$jsRoot.postMessage&&Kekule.$jsRoot.addEventListener("message",function(event){"kekule-sys-info-query"===event.data&&Kekule.$jsRoot.postMessage({msg:"kekule-sys-info-result",libName:Kekule.LIBNAME,version:Kekule.VERSION},"*")},!1),Kekule}},function(module,exports,__webpack_require__){"use strict";(function(global){module.exports=function(Kekule){function analysisLanguage(lanName){var parts=lanName.split("-");return{language:parts[0],local:parts[1]}}function getLanguages(){var result=[];for(var name in localizationRootObj)result.push(name);return result}function getLanguageRoot(languageName,canCreate,localRoot){var result=localRoot||localizationRootObj[languageName];return!result&&canCreate&&(result={},localizationRootObj[languageName]=result),result}function getLocalizationValueOfLan(cascadeName,languageName,localRoot){var lanObj=getLanguageRoot(languageName,!1,localRoot);if(lanObj){var value=Object.getCascadeFieldValue(cascadeName,lanObj);if(void 0!==value)return value}}function findLocalizationValue(cascadeName,preferedLanguageName,localRoot){for(var lanNames=(preferedLanguageName?[preferedLanguageName]:[]).concat(candicateLanNames),j=0,k=lanNames.length;j<k;++j){var lanName=lanNames[j],value=getLocalizationValueOfLan(cascadeName,lanName,localRoot);if(void 0!==value)return value}}function getLocalizationValue(cascadeName,preferedLanguageName,localRoot){var result=findLocalizationValue(cascadeName,preferedLanguageName,localRoot);if(void 0!==result)return result;Kekule.error("Can not find localization resource: "+cascadeName)}function setLocalizationValueOfLan(cascadeName,value,languageName,canCreate,localRoot){var lanRoot=getLanguageRoot(languageName,canCreate,localRoot);return!!lanRoot&&Object.setCascadeFieldValue(cascadeName,value,lanRoot,canCreate)}function setCurrLocalizationModule(moduleName){currLocModuleName=moduleName,locModuleNames.indexOf(moduleName)<0&&locModuleNames.push(moduleName)}function getLocModuleRootObj(moduleName,canCreate){var moduleName=moduleName||"GLOBAL",result=Object.getCascadeFieldValue(moduleName,locModuleInfo);return!result&&canCreate&&(result=Object.setCascadeFieldValue(moduleName,{},locModuleInfo,!0)),result}function getLocalizationModuleNames(){return locModuleNames}function addLocalizationResources(languageName,resourceName,resources,localRoot){if(resources){var newValue,oldValue=getLocalizationValueOfLan(resourceName,languageName,localRoot);newValue=oldValue?Object.extendEx(oldValue,resources,{cascade:!0}):JSON.parse(JSON.stringify(resources)),setLocalizationValueOfLan(resourceName,newValue,languageName,!0,localRoot)}}function getLocalizationModuleInfos(){return locModuleInfo}var rootObj=Kekule,language=Kekule.language||(global.navigator?navigator.language||navigator.browserLanguage:"en-US");rootObj.language=language;var lanInfo=analysisLanguage(language),defLanInfo=analysisLanguage("en-US"),candicateLanNames=[lanInfo.language+"_"+lanInfo.local,lanInfo.language,defLanInfo.language+defLanInfo.local,defLanInfo.language];Kekule.Localization={},Kekule.LocalizationRes={};var currLocModuleName,localizationRootObj=Kekule.LocalizationRes,locModuleNames=[],saveLocModuleInfo=!!(global||global.window).__kekuleMarkLocalizationModuleInfo__,locModuleInfo={};return Kekule.$L=getLocalizationValue,Kekule.Localization.getLanguages=getLanguages,Kekule.Localization.getValue=getLocalizationValue,Kekule.Localization.findValue=findLocalizationValue,Kekule.Localization.getModuleInfos=getLocalizationModuleInfos,Kekule.Localization.setCurrModule=setCurrLocalizationModule,Kekule.Localization.getModuleNames=getLocalizationModuleNames,Kekule.Localization.addResource=function(languageName,resourceName,resources){if(addLocalizationResources(languageName,resourceName,resources),saveLocModuleInfo){addLocalizationResources(languageName,resourceName,resources,getLocModuleRootObj(currLocModuleName,!0))}},Kekule}}).call(exports,__webpack_require__(6))},function(module,exports){var g;g=function(){return this}();try{g=g||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(g=window)}module.exports=g},function(module,exports,__webpack_require__){"use strict";module.exports=function(Kekule){return Kekule.LOCAL_RES=!0,Kekule.Localization.setCurrModule("general"),Kekule.Localization.addResource("en","Texts",{UNNAMED:"unnamed"}),Kekule.Localization.addResource("en","ErrorMsg",{MODULE_NOT_LOADED:"Module {0} is not loaded",NON_OWN_PROPERTY_CANNOT_BE_REPLACED:"Only directly owned property of object can be replaced",EMPTY_DOC:"Document is empty",ELEMENT_NOTSET:"Element not set",EMPTY_RESURI:"Resource URI is empty",CANNOT_LOAD_RES_OF_URI:"Can not load resource of URI: ",LIST_ITEM_CLASS_MISMATCH:"Mismatched item class, can not add to list",CANNOT_CLEAR_WEAKMAP:"Can not clear a weak map",CANNOT_GET_KEY_LIST_IN_WEAKMAP:"Can not get key array from a weak map",CANNOT_GET_VALUE_LIST_IN_WEAKMAP:"Can not get value array from a weak map",INVALID_CHEMELEMENT:"Invalid chemical element",INVALID_ISOTOPE:"Invalid isotope",UNABLE_ADD_MISTYPED_NODE:"Unable to link mistyped node to connector",UNABLE_ADD_DIFF_OWNER_OBJ:"Object with different owner can not be linked to connector",CHEMSTRUCTUREOBJECTGROUP_ITEMCLASS_MISMATCH:"Mismatched group item class",SORT_FUNC_UNSET:"Sort function is not set",SOURCE_FRAGMENT_NOT_SET:"Source structure fragment not set",UNABLE_ADD_NONMOLECULE_MAP:"Unable to add non-molecule to reactants or products",CANNOT_ADD_NON_NODE_NOR_CONNECTOR_TO_STRUCT_CONTAINER:"Can not add object other than node or connector to structure object container",REGISTERED_CANONICALIZATION_EXECUTOR_NOT_FOUND:"Can not find registered canonicalization executor",ERROR_LOADING_FILE:"Error loading file: ",READER_ID_ALREADY_EXISTS:"Can not register reader: id already exists",WRITER_ID_ALREADY_EXISTS:"Can not register writer: id already exists",FAIL_TO_READ_FORMAT:"Fail to load data of format: ",NO_SUITABLE_READER_FOR_FORMAT:"Can not read data of format: ",NO_SUITABLE_READER_FOR_MIMETYPE:"Can not read data of MIME type: ",NO_SUITABLE_READER_FOR_FILEEXT:"Can not read data of file extension: ",NO_SUITABLE_WRITER_FOR_FORMAT:"Can not write data of format: ",NO_SUITABLE_WRITER_FOR_MIMETYPE:"Can not write data of MIME type: ",NO_SUITABLE_WRITER_FOR_FILEEXT:"Can not write data of file extension: ",AJAX_FILELOADER_NOT_FOUND:"AJAX file loader not found, can not load URL",FAIL_TO_LOAD_FILE_URL:"Fail to load file of URL: ",CML_ELEM_READER_NOT_FOUND:"Reader for element <{0}> not found",ATOMID_NOT_EXISTS:"Atom id not exists: ",BONDID_NOT_EXISTS:"Bond id not exists: ",CML_ELEM_WRITER_TYPE_INPROPER:"{0} is not a proper CML element writer for {1}",CML_CAN_NOT_OUTPUT_TO_EMPTY_ELEMENT:"Can not output content to empty element",UNABLE_TO_OUTPUT_AS_CML:"Unable to output object <{0}> to CML data",MDL_CTAB_ATOM_CANNOT_CREATE:"Can not create atom from source MDL format data",MDL_CTAB_BOND_CANNOT_CREATE:"Can not create bond from source MDL format data",CAN_NOT_WRITE_NON_MOLECULE_TO_MOL:"Object is not a molecule and can not be output to connection table",MOLECULE_HAS_NO_CTAB_TO_OUTPUT:"Molecule has no connection table and can not be output to MDL format",NOT_MDL2000_FORMAT_DATA:"Data format wrong: not MDL 2000",NOT_MDL_RXN_DATA:"Not MDL Reaction(RXN) data",MALFORMED_MDL3000_COUNTLINE:"Malformed MDL 3000 count line",MDL3000_ATOMBLOCK_NOT_FOUND:"Atom block not found, malformed MDL 3000 data?",NOT_MDL_FORMAT_DATA:"Data format wrong: not MDL 2000 or 3000",NOT_MDL2000_RXN_DATA:"Not MDL RXN 2000 data",NOT_MDL3000_RXN_DATA:"Not MDL RXN 3000 data",NOT_MDL3000_RXN_COUNTLINE:"Error in reading RXN 3000 count line",MDL_OUTPUT_DATATYPE_NOT_TEXT:"MDL data can not be output to non text format",MDL_INPUT_DATATYPE_NOT_TEXT:"Non text format is not a legal MDL source data",UNABLE_TO_OUTPUT_AS_MDL:"Unable to output object <{0}> to MDL data",KCJ_INPUT_DATATYPE_NOT_JSON_OR_TEXT:"Non text or JSON format data is not a legal KCJ source",KCJ_OUTPUT_DATATYPE_NOT_JSON_OR_TEXT:"Can not output as non text or JSON data",KCX_INPUT_DATATYPE_NOT_DOM_OR_TEXT:"Non text or DOM data is not a legal KCX source",KCX_OUTPUT_DATATYPE_NOT_DOM_OR_TEXT:"Can not output as non text or DOM data",JSON_SERIALIZER_NOT_EXISTS:"Serializer for JSON not exists",XML_SERIALIZER_NOT_EXISTS:"Serializer for XML not exists",INAVAILABLE_AUTOSCALE_REF_LENGTH:"Can not determine the length for calculation of auto scale",FORMULA_RENDERER_3D_NOT_AVAILABLE:"3D renderer for molecule formula is not available",CANNOT_FIND_SUITABLE_RENDERER_FOR_OBJ:"Can not find suitable renderer for object",CALC_TERMINATED_BY_USER:"Calculation terminated by user",CALC_SERVICE_UNAVAILABLE:'Calculation service "{0}" is unavailable'}),Kekule}},function(module,exports,__webpack_require__){"use strict";module.exports=function(Kekule){return Kekule.LOCAL_RES=!0,Kekule.Localization.setCurrModule("widget"),Kekule.Localization.addResource("en","WidgetTexts",{CAPTION_OK:"OK",CAPTION_CANCEL:"Cancel",CAPTION_YES:"Yes",CAPTION_NO:"No",CAPTION_BROWSE_COLOR:"Browse colors",HINT_BROWSE_COLOR:"Browse more colors",S_COLOR_UNSET:"(unset)",S_COLOR_DEFAULT:"(default)",S_COLOR_MIXED:"(mixed)",S_COLOR_TRANSPARENT:"(transparent)",S_OBJECT_UNSET:"(none)",S_ITEMS:"item(s)",S_OBJECT:"object",S_VALUE_UNSET:"(Unset)",CAPTION_MENU:"Menu",HINT_MENU:"Open menu",S_INSPECT_NONE:"(none)",S_INSPECT_OBJECTS:"({0} objects)",S_INSPECT_ID_OBJECT:"{0}: {1}",S_INSPECT_ANONYMOUS_OBJECT:"({0})",CAPTION_TOGGLE_TEXTWRAP:"Toggle text wrapping",CAPTION_INC_TEXT_SIZE:"Increase text size",CAPTION_DEC_TEXT_SIZE:"Decrease text size",HINT_TOGGLE_TEXTWRAP:"Toggle the state of text wrapping",HINT_INC_TEXT_SIZE:"Increase text size",HINT_DEC_TEXT_SIZE:"Decrease text size",HINT_CHOOSE_FONT_FAMILY:"Choose font family",CAPTION_FIRST_PAGE:"First",CAPTION_LAST_PAGE:"Last",CAPTION_PREV_PAGE:"Prev",CAPTION_NEXT_PAGE:"Next",HINT_FIRST_PAGE:"First page",HINT_LAST_PAGE:"Last page",HINT_PREV_PAGE:"Previous page",HINT_NEXT_PAGE:"Next page",HINT_CURR_PAGE:"Current page",MSG_RETRIEVING_DATA:"Loading data...",CAPTION_DATATABLE_EDIT:"Edit",CAPTION_DATATABLE_DELETE:"Delete",CAPTION_DATATABLE_INSERT:"Insert",HINT_DATATABLE_EDIT:"Edit",HINT_DATATABLE_DELETE:"Delete",HINT_DATATABLE_INSERT:"Insert",CAPTION_ADD_CELL:"+",HINT_ADD_CELL:"Add new cell",CAPTION_REMOVE_CELL:"Remove",HINT_REMOVE_CELL:"Remove cell",CAPTION_CONFIG:"Settings...",HINT_CONFIG:"Change settings",TITLE_IMG_FORMAT_PNG:"PNG format image",TITLE_IMG_FORMAT_JPG:"Jpeg format image",TITLE_IMG_FORMAT_GIF:"GIF format image",TITLE_IMG_FORMAT_SVG:"SVG format image"}),Kekule.Localization.addResource("en","ChemWidgetTexts",{CAPTION_CLEAROBJS:"Clear",CAPTION_LOADFILE:"Load...",CAPTION_LOADDATA:"Load...",CAPTION_SAVEFILE:"Save...",CAPTION_ZOOMIN:"Zoom In",CAPTION_ZOOMOUT:"Zoom Out",CAPTION_RESETZOOM:"Reset Zoom",CAPTION_RESETVIEW:"Reset",CAPTION_ROTATE:"Rotate",CAPTION_ROTATELEFT:"Left Rotate",CAPTION_ROTATERIGHT:"Right Rotate",CAPTION_ROTATEX:"X Rotate",CAPTION_ROTATEY:"Y Rotate",CAPTION_ROTATEZ:"Z Rotate",CAPTION_MOL_DISPLAY_TYPE:"Molecule Display Style",CAPTION_SKELETAL:"Skeletal",CAPTION_CONDENSED:"Condensed",CAPTION_WIRE:"Wire Frame",CAPTION_STICKS:"Sticks",CAPTION_BALLSTICK:"Ball Stick",CAPTION_SPACEFILL:"Space Fill",CAPTION_HIDEHYDROGENS:"Show/hide hydrogens",CAPTION_OPENEDITOR:"Edit...",CAPTION_EDIT_OBJ:"Edit",HINT_CLEAROBJS:"Clear objects",HINT_LOADFILE:"Load from file",HINT_LOADDATA:"Load data",HINT_SAVEFILE:"Save to file",HINT_ZOOMIN:"Zoom in",HINT_ZOOMOUT:"Zoom out",HINT_RESETZOOM:"Reset zoom",HINT_RESETVIEW:"Reset zoom and rotation",HINT_ROTATE:"Rotate",HINT_ROTATELEFT:"Rotate in anticlockwise direction",HINT_ROTATERIGHT:"Rotate in clockwise direction",HINT_ROTATEX:"Rotate around X axis",HINT_ROTATEY:"Rotate around Y axis",HINT_ROTATEZ:"Rotate around Z axis",HINT_MOL_DISPLAY_TYPE:"Change molecule display style",HINT_SKELETAL:"Show molecule in skeletal style",HINT_CONDENSED:"Show molecule in condensed style",HINT_WIRE:"Show molecule in wire frame style",HINT_STICKS:"Show molecule in sticks style",HINT_BALLSTICK:"Show molecule in ball-stick style",HINT_SPACEFILL:"Show molecule in space-fill style",HINT_HIDEHYDROGENS:"Show/hide hydrogen atoms in model",HINT_OPENEDITOR:"Open an editor to modify displayed object",CAPTION_NEWDOC:"New",CAPTION_UNDO:"Undo",CAPTION_REDO:"Redo",CAPTION_COPY:"Copy",CAPTION_CUT:"Cut",CAPTION_PASTE:"Paste",CAPTION_CLONE_SELECTION:"Clone selection",CAPTION_TOGGLE_INSPECTOR:"Object inspector",CAPTION_MANIPULATE:"Select",CAPTION_ERASE:"Erase",CAPTION_MOL_BOND:"Bond",CAPTION_MOL_BOND_SINGLE:"Single bond",CAPTION_MOL_BOND_DOUBLE:"Double bond",CAPTION_MOL_BOND_TRIPLE:"Triple bond",CAPTION_MOL_BOND_WEDGEUP:"Wedge up bond",CAPTION_MOL_BOND_WEDGEDOWN:"Wedge down bond",CAPTION_MOL_BOND_CLOSER:"Outer bond",CAPTION_MOL_BOND_WAVY:"Wavy bond",CAPTION_MOL_BOND_DOUBLE_EITHER:"Double Either bond",CAPTION_MOL_ATOM:"Atom",CAPTION_MOL_FORMULA:"Formula",CAPTION_MOL_CHARGE:"Charge",CAPTION_MOL_CHARGE_CLEAR:"Charge clear",CAPTION_MOL_CHARGE_POSITIVE:"Positive charge",CAPTION_MOL_CHARGE_NEGATIVE:"Negative charge",CAPTION_MOL_CHARGE_SINGLET:"Singlet radical",CAPTION_MOL_CHARGE_DOUBLET:"Monoradical",CAPTION_MOL_CHARGE_TRIPLET:"Triplet radical",CAPTION_MOL_ELECTRON_LONEPAIR:"Lone pair",CAPTION_TEXT_BLOCK:"Text Block",CAPTION_IMAGE_BLOCK:"Image Block",CAPTION_TEXT_IMAGE:"Text and Image",CAPTION_REPOSITORY_RING:"Rings",CAPTION_REPOSITORY_RING_3:"Cyclopropane",CAPTION_REPOSITORY_RING_4:"Cyclobutane",CAPTION_REPOSITORY_RING_5:"Cyclopentane",CAPTION_REPOSITORY_RING_6:"Cyclohexane",CAPTION_REPOSITORY_RING_7:"Cycloheptane",CAPTION_REPOSITORY_RING_8:"Cyclooctane",CAPTION_REPOSITORY_RING_AR_6:"Benzene",CAPTION_REPOSITORY_RING_AR_5:"Cyclopentadiene",CAPTION_REPOSITORY_CYCLOHEXANE_CHAIR1:"Cyclohexane chair 1",CAPTION_REPOSITORY_CYCLOHEXANE_CHAIR2:"Cyclohexane chair 2",CAPTION_REPOSITORY_CYCLOHEXANE_HARWORTH1:"Cyclohexane Haworth 1",CAPTION_REPOSITORY_CYCLOHEXANE_HARWORTH2:"Cyclohexane Haworth 2",CAPTION_REPOSITORY_CYCLOPENTANE_HARWORTH1:"Cyclopentane Haworth 1",CAPTION_REPOSITORY_CYCLOPENTANE_HARWORTH2:"Cyclopentane Haworth 2",CAPTION_REPOSITORY_METHANE:"Methane",CAPTION_REPOSITORY_FISCHER1:"Fischer projection 1",CAPTION_REPOSITORY_FISCHER2:"Fischer projection 2",CAPTION_REPOSITORY_FISCHER3:"Fischer projection 3",CAPTION_REPOSITORY_SAWHORSE_STAGGERED:"Sawhorse staggered",CAPTION_REPOSITORY_SAWHORSE_ECLIPSED:"Sawhorse eclipsed",CAPTION_REPOSITORY_SUBBOND_MARK:"Substituent bond",CAPTION_REPOSITORY_ARROWLINE:"Arrows & lines",CAPTION_REPOSITORY_GLYPH:"Glyphs",CAPTION_REPOSITORY_GLYPH_LINE:"Line",CAPTION_REPOSITORY_GLYPH_OPEN_ARROW_LINE:"Open arrow line",CAPTION_REPOSITORY_GLYPH_TRIANGLE_ARROW_LINE:"Triangle arrow line",CAPTION_REPOSITORY_GLYPH_DI_OPEN_ARROW_LINE:"Bidirectional open arrow line",CAPTION_REPOSITORY_GLYPH_DI_TRIANGLE_ARROW_LINE:"Bidirectional triangle arrow line",CAPTION_REPOSITORY_GLYPH_REV_ARROW_LINE:"Reversible arrow line",CAPTION_REPOSITORY_GLYPH_OPEN_ARROW_DILINE:"Open arrow double line",CAPTION_REPOSITORY_HEAT_SYMBOL:"Heat symbol",CAPTION_REPOSITORY_ADD_SYMBOL:"Add symbol",CAPTION_PICK_COLOR:"Color",CAPTION_TEXT_DIRECTION:"Text direction",CAPTION_TEXT_DIRECTION_DEFAULT:"Default",CAPTION_TEXT_DIRECTION_LTR:"Left to right",CAPTION_TEXT_DIRECTION_RTL:"Right to left",CAPTION_TEXT_DIRECTION_TTB:"Top to bottom",CAPTION_TEXT_DIRECTION_BTT:"Bottom to top",CAPTION_TEXT_HORIZONTAL_ALIGN:"Text horizontal alignment",CAPTION_TEXT_VERTICAL_ALIGN:"Text vertical alignment",CAPTION_TEXT_ALIGN_DEFAULT:"Default",CAPTION_TEXT_ALIGN_LEADING:"Leading",CAPTION_TEXT_ALIGN_TRAILING:"Trailing",CAPTION_TEXT_ALIGN_CENTER:"Center",CAPTION_TEXT_ALIGN_LEFT:"Left",CAPTION_TEXT_ALIGN_RIGHT:"Right",CAPTION_TEXT_ALIGN_TOP:"Top",CAPTION_TEXT_ALIGN_BOTTOM:"Bottom",HINT_NEWDOC:"Create new document",HINT_UNDO:"Undo",HINT_REDO:"Redo",HINT_COPY:"Copy selection to internal clipboard",HINT_CUT:"Cut selection to internal clipboard",HINT_PASTE:"Paste from internal clipboard",HINT_CLONE_SELECTION:"Clone selection",HINT_TOGGLE_INSPECTOR:"Show or hide object inspector panel",HINT_MANIPULATE:"Select tool",HINT_ERASE:"Erase tool",HINT_MOL_BOND:"Bond tool",HINT_MOL_BOND_SINGLE:"Single bond",HINT_MOL_BOND_DOUBLE:"Double bond",HINT_MOL_BOND_TRIPLE:"Triple bond",HINT_MOL_BOND_WEDGEUP:"Wedge up bond",HINT_MOL_BOND_WEDGEDOWN:"Wedge down bond",HINT_MOL_BOND_CLOSER:"Outer bond",HINT_MOL_BOND_WAVY:"Wavy bond",HINT_MOL_BOND_DOUBLE_EITHER:"Double Either bond",HINT_MOL_ATOM:"Atom tool",HINT_MOL_FORMULA:"Formula tool",HINT_MOL_CHARGE:"Charge tool",HINT_MOL_CHARGE_CLEAR:"Clear charge and radical",HINT_MOL_CHARGE_POSITIVE:"Positive charge",HINT_MOL_CHARGE_NEGATIVE:"Negative charge",HINT_MOL_CHARGE_SINGLET:"Singlet radical",HINT_MOL_CHARGE_DOUBLET:"Monoradical",HINT_MOL_CHARGE_TRIPLET:"Triplet radical",HINT_MOL_ELECTRON_LONEPAIR:"Lone pair electrons",HINT_TEXT_BLOCK:"Text block tool",HINT_IMAGE_BLOCK:"Image block tool",HINT_TEXT_IMAGE:"Text and image tool",HINT_REPOSITORY_RING:"Ring structures",HINT_REPOSITORY_RING_3:"Cyclopropane",HINT_REPOSITORY_RING_4:"Cyclobutane",HINT_REPOSITORY_RING_5:"Cyclopentane",HINT_REPOSITORY_RING_6:"Cyclohexane",HINT_REPOSITORY_RING_7:"Cycloheptane",HINT_REPOSITORY_RING_8:"Cyclooctane",HINT_REPOSITORY_RING_AR_6:"Benzene",HINT_REPOSITORY_RING_AR_5:"Cyclopentadiene",HINT_REPOSITORY_CYCLOHEXANE_CHAIR1:"Cyclohexane chair 1",HINT_REPOSITORY_CYCLOHEXANE_CHAIR2:"Cyclohexane chair 2",HINT_REPOSITORY_CYCLOHEXANE_HARWORTH1:"Cyclohexane Haworth 1",HINT_REPOSITORY_CYCLOHEXANE_HARWORTH2:"Cyclohexane Haworth 2",HINT_REPOSITORY_CYCLOPENTANE_HARWORTH1:"Cyclopentane Haworth 1",HINT_REPOSITORY_CYCLOPENTANE_HARWORTH2:"Cyclopentane Haworth 2",HINT_REPOSITORY_SUBBOND_MARK:"Substituent bond",HINT_REPOSITORY_METHANE:"Methane",HINT_REPOSITORY_FISCHER1:"Fischer projection with one chiral center",HINT_REPOSITORY_FISCHER2:"Fischer projection with two chiral centers",HINT_REPOSITORY_FISCHER3:"Fischer projection with three chiral centers",HINT_REPOSITORY_SAWHORSE_STAGGERED:"Sawhorse staggered",HINT_REPOSITORY_SAWHORSE_ECLIPSED:"Sawhorse eclipsed",HINT_REPOSITORY_ARROWLINE:"Arrows and lines",HINT_REPOSITORY_GLYPH:"Glyphs",HINT_REPOSITORY_GLYPH_LINE:"Line",HINT_REPOSITORY_GLYPH_OPEN_ARROW_LINE:"Open arrow line",HINT_REPOSITORY_GLYPH_TRIANGLE_ARROW_LINE:"Triangle arrow line",HINT_REPOSITORY_GLYPH_DI_OPEN_ARROW_LINE:"Bidirectional open arrow line",HINT_REPOSITORY_GLYPH_DI_TRIANGLE_ARROW_LINE:"Bidirectional triangle arrow line",HINT_REPOSITORY_GLYPH_REV_ARROW_LINE:"Reversible arrow line",HINT_REPOSITORY_GLYPH_OPEN_ARROW_DILINE:"Open arrow double line",HINT_REPOSITORY_HEAT_SYMBOL:"Heat symbol",HINT_REPOSITORY_ADD_SYMBOL:"Add symbol",HINT_FONTNAME:"Set font name",HINT_FONTSIZE:"Set font size",HINT_PICK_COLOR:"Select color",HINT_TEXT_DIRECTION:"Set text direction",HINT_TEXT_HORIZONTAL_ALIGN:"Set text horizontal alignment",HINT_TEXT_VERTICAL_ALIGN:"Set text vertical alignment",CAPTION_LOADDATA_DIALOG:"Load data",CAPTION_DATA_FORMAT:"Data format:",CAPTION_DATA_SRC:"Input or paste data below:",CAPTION_LOADDATA_FROM_FILE:"Load from file",CAPTION_CHOOSEFILEFORMAT:"Choose file format",CAPTION_SELECT_FORMAT:"Select format:",CAPTION_PREVIEW_FILE_CONTENT:"Preview: ",S_DEF_SAVE_FILENAME:"Unnamed",CAPTION_ATOMLIST_PERIODIC_TABLE:"more...",CAPTION_RGROUP:"Sub group",CAPTION_VARIABLE_ATOM:"Variable Atom (list)",CAPTION_VARIABLE_NOT_ATOM:"Variable Atom (not list)",CAPTION_PSEUDOATOM:"Pseudoatom",CAPTION_DUMMY_ATOM:"Dummy Atom",CAPTION_HETERO_ATOM:"Hetero Atom",CAPTION_ANY_ATOM:"Any Atom",CAPTION_PERIODIC_TABLE_DIALOG:"Periodic table",CAPTION_PERIODIC_TABLE_DIALOG_SEL_ELEM:"Select element",CAPTION_PERIODIC_TABLE_DIALOG_SEL_ELEMS:"Select elements",CAPTION_TEXTBLOCK_INIT:"Enter text here",LEGEND_CAPTION:"Legend",LEGEND_ELEM_SYMBOL:"Symbol",LEGEND_ELEM_NAME:"name",LEGEND_ATOMIC_NUM:"atomic number",LEGEND_ATOMIC_WEIGHT:"atomic weight",CAPTION_2D:"2D",CAPTION_3D:"3D",CAPTION_AUTOSIZE:"Autosize",CAPTION_AUTOFIT:"Autofit",CAPTION_SHOWSIZEINFO:"Show size info",CAPTION_LABEL_SIZE:"Size: ",CAPTION_BACKGROUND_COLOR:"Background color: ",CAPTION_WIDTH_HEIGHT:"width: {0}, height: {1}",PLACEHOLDER_WIDTH:"width",PLACEHOLDER_HEIGHT:"height",HINT_AUTOSIZE:"Whether graph size is determined by object automatically",HINT_AUTOFIT:"Whether object is zoomed to fullfill the whole graph",S_VALUE_DEFAULT:"(Default)"}),Kekule.Localization.addResource("en","ErrorMsg",{WIDGET_CLASS_NOT_FOUND:"Widget class not found",WIDGET_CAN_NOT_BIND_TO_ELEM:"Widget {0} can not be binded to element <{1}>",LOAD_CHEMDATA_FAILED:"Failed to load data",FILE_API_NOT_SUPPORTED:"File operations are not supported by your current web browser. Please update it.",DRAW_BRIDGE_NOT_SUPPORTED:"It seems that your web browser is not modern enough to support the drawing function. Please update it.",COMMAND_NOT_REVERSIBLE:"Command can not be undone",PAGE_INDEX_OUTOF_RANGE:"Page index out of range",FETCH_DATA_TIMEOUT:"Time out to fetch data",RENDER_TYPE_CHANGE_NOT_ALLOWED:"It is not allowed to change render type",CAN_NOT_CREATE_EDITOR:"Creating editor failed",CAN_NOT_SET_COORD_OF_CLASS:"Can not set coordinate of instance of {0}.",CAN_NOT_SET_DIMENSION_OF_CLASS:"Can not set dimension of instance of {0}.",CAN_NOT_MERGE_CONNECTORS:"Specified connectors can not be merged.",NOT_A_VALID_ATOM:"Not a valid atom",INVALID_ATOM_SYMBOL:"Invalid atom symbol",INVALID_OR_EMPTY_IMAGE:"Image is empty or invalidate"}),Kekule}},function(module,exports,__webpack_require__){"use strict";module.exports=function(Kekule){return Kekule.LOCAL_RES=!0,Kekule.Localization.setCurrModule("objDefines"),Kekule.OBJDEF_TEXTS={},Kekule.Localization.addResource("en","OBJDEF_TEXTS",{TITLE_PREFIX:"TITLE_",DESCRIPTION_PREFIX:"DES_",DES_ID:"Unique ID for object.",Render:{GeneralConfigs:{TITLE_drawOpacity:"Opacity",DES_drawOpacity:"Opacity (between 0-1) to draw objects"},Render2DConfigs:{TITLE_generalConfigs:"General render settings",DES_generalConfigs:"General render settings",TITLE_moleculeDisplayConfigs:"Molecule display settings",DES_moleculeDisplayConfigs:"Settings about molecule display styles",TITLE_displayLabelConfigs:"Display label settings",DES_displayLabelConfigs:"Settings of displayed label in molecule/chem object",TITLE_textFontConfigs:"Text and font settings",DES_textFontConfigs:"Settings about text and font of display",TITLE_lengthConfigs:"Lengths settings",DES_lengthConfigs:"Lengths to display molecule/chem object",TITLE_colorConfigs:"Color settings",DES_colorConfigs:"Color settings to display molecule/chem object"},MoleculeDisplayConfigs:{TITLE_defMoleculeDisplayType:"Default molecule display mode",DES_defMoleculeDisplayType:"Default display type of molecule: in skeletal or in condensed mode",TITLE_defNodeDisplayMode:"Default atom display mode",DES_defNodeDisplayMode:"Default mode to display atom in molecule",TITLE_defHydrogenDisplayLevel:"Default hydrogen display level",DES_defHydrogenDisplayLevel:"How to display explicit or implicit hydrogens of atom",TITLE_defChargeMarkType:"Default charge mark type",DES_defChargeMarkType:null,TITLE_partialChargeDecimalsLength:"Decimal length of partial charge",DES_partialChargeDecimalsLength:"If an atom has a partical charge (e.g., +1.5), how many digits after decimal point should be displayed"},DisplayLabelConfigs:{TITLE_enableIsotopeAlias:"Enable isotope alias",DES_enableIsotopeAlias:"Whether isotope alias (e.g. D for 2H) is used to display atom label.",TITLE_unsetElement:"Unset element",DES_unsetElement:"Label for unset or unknown element",TITLE_dummyAtom:"Dummy atom",DES_dummyAtom:"Label for dummy atom",TITLE_heteroAtom:"Hetero atom",DES_heteroAtom:"Label for general hetero atom",TITLE_anyAtom:"Any atom",DES_anyAtom:"Label for atom wildcard",TITLE_variableAtom:"Variable atom",DES_variableAtom:"Label for variable atom or atom list",TITLE_rgroup:"RGroup",DES_rgroup:"Label for RGroup",TITLE_isoListLeadingBracket:"Atom list leading bracket",TITLE_isoListTailingBracket:"Atom list tailing bracket",TITLE_isoListDelimiter:"Atom delimiter in list",TITLE_isoListDisallowPrefix:"Prefix of not-atom list"},TextFontConfigs:{TITLE_labelFontFamily:"Label font",DES_labelFontFamily:"Font to draw general label",TITLE_atomFontFamily:"Atom font",DES_atomFontFamily:"Font to draw atom label",TITLE_supFontSizeRatio:"Superscript font size ratio",DES_supFontSizeRatio:"Ratio of Superscript text size to normal text size",TITLE_subFontSizeRatio:"Subscript font size ratio",DES_subFontSizeRatio:"Ratio of Subscript text size to normal text size",TITLE_superscriptOverhang:"Superscript text overhang",DES_superscriptOverhang:null,TITLE_subscriptOversink:"Subscript text oversink",DES_subscriptOversink:null,TITLE_textCharDirection:"Text direction",DES_textCharDirection:"Default text direction",TITLE_textHorizontalAlign:"Horizontal text alignment",DES_textHorizontalAlign:"Default horizontal text alignment of label",TITLE_textVerticalAlign:"Vertical text alignment",DES_textVerticalAlign:"Default vertical text alignment of label"},LengthConfigs:{TITLE_labelFontSize:"Label text size",DES_labelFontSize:"Size of general label text",TITLE_atomFontSize:"Atom text size",DES_atomFontSize:"Size of atom label text",TITLE_allenCenterAtomRadius:"Allen center radius",DES_allenCenterAtomRadius:"Radius to draw dot on center carbon atom in allen",TITLE_chargeMarkFontSize:"Charge mark size",DES_chargeMarkFontSize:"Font size of charge mark",TITLE_chargeMarkMargin:"Charge mark margin",DES_chargeMarkMargin:"Margin between charge mark and atom",TITLE_defBondLength:"Default bond length",DES_defBondLength:"Default length of a chemical bond",TITLE_bondLineWidth:"Bond line width",DES_bondLineWidth:"Line width to draw a chemical bond",TITLE_hashSpacing:"Hash spacing",DES_hashSpacing:"Spacing between small lines in hash bond",TITLE_multipleBondSpacingRatio:"Multiple bond spacing ratio",DES_multipleBondSpacingRatio:"Ratio of spacing between two lines in double or triple bond to bond length.",TITLE_multipleBondMaxAbsSpacing:"Max multiple bond spacing",DES_multipleBondMaxAbsSpacing:"Maximum spacing between multiple bond",TITLE_bondArrowLength:"Bond arrow length",DES_bondArrowLength:"The length of end triangle in arrow bond",TITLE_bondArrowWidth:"Bond arrow width",DES_bondArrowWidth:"The width of end triangle in arrow bond",TITLE_bondWedgeWidth:"Bond wedge max width",DES_bondWedgeWidth:"The width of ending point in wedge bond",TITLE_bondWedgeHashMinWidth:"Bond wedge min width",DES_bondWedgeHashMinWidth:"The width of starting point in wedge bond",TITLE_bondWavyRadius:"Bond wavy radius",DES_bondWavyRadius:"Radius to draw arc of wavy bond",TITLE_glyphStrokeWidth:"Glyph stroke width",DES_glyphStrokeWidth:"The default width of glyph strokes",TITLE_autofitContextPadding:"Autofit context padding",DES_autofitContextPadding:"Padding of autofit widget edge and drawn object"},ColorConfigs:{TITLE_useAtomSpecifiedColor:"Use element specified color",DES_useAtomSpecifiedColor:"Whether use different color on different element",TITLE_labelColor:"Label color",DES_labelColor:"Default color of general label",TITLE_atomColor:"Atom color",DES_atomColor:"Default color of atom label",TITLE_bondColor:"Bond color",DES_bondColor:"Default color of bond",TITLE_glyphStrokeColor:"Glyph stroke color",DES_glyphStrokeColor:"Default stroke color of glyph",TITLE_glyphFillColor:"Glyph fill color",DES_glyphFillColor:"Default fill color of glyph"},Render3DConfigs:{TITLE_generalConfigs:"General render settings",DES_generalConfigs:"General render settings",TITLE_moleculeDisplayConfigs:"Molecule display settings",DES_moleculeDisplayConfigs:"Settings about molecule display styles",TITLE_environmentConfigs:"3D environment settings",DES_environmentConfigs:"Settings of 3D environment",TITLE_modelConfigs:"3D model settings",DES_modelConfigs:"Settings to render a 3D molecule model",TITLE_lengthConfigs:"Lengths settings",DES_lengthConfigs:"Lengths to display molecule"},Render3DEnvironmentConfigs:{TITLE_graphicQuality:"Graphic quality",DES_graphicQuality:"Quality of 3D graphic"},Molecule3DDisplayConfigs:{TITLE_defMoleculeDisplayType:"Default molecule display type",DES_defMoleculeDisplayType:"Draw molecule in wire, stick, ball stick or space fill mode",TITLE_defBondSpliceMode:"Bond splice mode",DES_defBondSpliceMode:"How to draw a splice mode between two atoms with different color",TITLE_defDisplayMultipleBond:"Display multiple bond",DES_defDisplayMultipleBond:"Whether draw multiple bond lines for double or triple bond",TITLE_defBondColor:"Default bond color",DES_defBondColor:"Default bond color",TITLE_defAtomColor:"Default atom color",DES_defAtomColor:"Default atom color",TITLE_useAtomSpecifiedColor:"Use element specified color",DES_useAtomSpecifiedColor:"Whether use different color on different element"},Model3DConfigs:{TITLE_hideHydrogens:"Hide hydrogens",DES_hideHydrogens:"Whether hide all hydrogen atoms in 3D model",TITLE_useVdWRadius:"Use von dar Waals radius",DES_useVdWRadius:"Whether use atom's von dar Waals radius to draw 3D model",TITLE_multiConnectorRadiusRatio:"Multi-bond radius ratio",DES_multiConnectorRadiusRatio:"If use multi-cylinder for multibond, this value is the radius ratio between multi and single bond",TITLE_multiConnectorMarginRatio:"Multi-bond margin ratio",DES_multiConnectorMarginRatio:"If multi-cylinder is used for multibond, ratio of margin between cylinders and radius of cylinder"},Length3DConfigs:{TITLE_fixedNodeRadius:"Fixed atom radius",DES_fixedNodeRadius:"If vdW radius of atom is not used, this value will be used for all atom's radius",TITLE_connectorRadius:"Bond radius",DES_connectorRadius:"Bond will be draw based on this radius in stick or ball_stick mode",TITLE_connectorLineWidth:"Bond line width",DES_connectorLineWidth:"Bond will be draw on this width in wire mode"}},Widget:{BaseWidget:{TITLE_settingFacade:"General settings",DES_settingFacade:"General settings"}},ChemWidget:{ChemObjDisplayer:{TITLE_enableLoadNewFile:"Enable load data",DES_enableLoadNewFile:"Whether loading new data is enabled"},ChemObjDisplayerConfigs:{TITLE_ioConfigs:"I/O settings",DES_ioConfigs:"Settings of input/output"},ChemObjDisplayerIOConfigs:{TITLE_canonicalizeBeforeSave:"Canonicalize before save",DES_canonicalizeBeforeSave:"Whether canonicalize molecule before saving it"},Viewer:{TITLE_enableDirectInteraction:"Enable direct interaction",DES_enableDirectInteraction:"Whether interaction with chem object in viewer is enabled",TITLE_enableTouchInteraction:"Enable touch interaction",DES_enableTouchInteraction:"Whether touch interaction is enabled",TITLE_enableToolbar:"Enable toolbar",DES_enableToolbar:"Whether toolbar of viewer is displayed",TITLE_toolbarPos:"Toolbar Position",DES_toolbarPos:"Position of toolbar in viewer",TITLE_toolbarMarginHorizontal:"Toolbar horizontal margin",DES_toolbarMarginHorizontal:"Horizontal margin of toolbar to viewer edge",TITLE_toolbarMarginVertical:"Toolbar vertical margin",DES_toolbarMarginVertical:"Vertical margin of toolbar to viewer edge",TITLE_enableEdit:"Enable editing",DES_enableEdit:"Whether edit chem object in viewer is enabled",TITLE_modalEdit:"Modal editing",DES_modalEdit:"Using modal dialog or popup dialog to edit chem object"}},Editor:{BaseEditorConfigs:{TITLE_uiMarkerConfigs:"UI marker settings",DES_uiMarkerConfigs:"Settings of interaction marker",TITLE_interactionConfigs:"Interaction settings",DES_interactionConfigs:"Settings about interaction of editor",TITLE_structureConfigs:"Structure settings",DES_structureConfigs:"Settings about creating molecule structure"},ChemSpaceEditorConfigs:{TITLE_chemSpaceConfigs:"Chem space settings",DES_chemSpaceConfigs:"Settings about chem space/chem document",TITLE_styleSetterConfigs:"Style setter settings",DES_styleSetterConfigs:"Settings of style toolbar of editor"},InteractionConfigs:{TITLE_enableTrackOnNearest:"Enale track on nearest",DES_enableTrackOnNearest:"If setting to true, hot track or selection will focus on nearest object to current position, otherwise, the topmost object around will be focused.",TITLE_enableHotTrack:"Enable hot track",DES_enableHotTrack:"Whether highlighting objects under mouse position",TITLE_objBoundTrackInflation:"Object bound inflation",DES_objBoundTrackInflation:"Inflates the bound of object to make it easier to select",TITLE_selectionMarkerInflation:"Selection marker inflation",DES_selectionMarkerInflation:"Inflation of object selection mark, makes it easier to see the containing objects",TITLE_selectionMarkerEdgeInflation:"Selection edge inflation",DES_selectionMarkerEdgeInflation:"Inflation when judging if a coord is on selection mark edge",TITLE_constrainedRotateStep:"Constrained rotation step",DES_constrainedRotateStep:null,TITLE_rotationLocationPointDistanceThreshold:"Rotation starting min distance",DES_rotationLocationPointDistanceThreshold:"Rotation will occur only when mouse point distance (from rotation center) larger than this value",TITLE_directedMoveDistanceThreshold:"Direct move min distance",DES_directedMoveDistanceThreshold:"Direct moving will only be done if moved distance large than this value",TITLE_enablePartialAreaSelecting:"Enable partial selecting",DES_enablePartialAreaSelecting:"If this value is true, when drag a selecting rubber band, object partly in the band will be totally selected",TITLE_atomSetterFontSize:"Atom setter font size",DES_atomSetterFontSize:"Font size of atom setter",TITLE_allowUnknownAtomSymbol:"Allow unknown atom symbol",DES_allowUnknownAtomSymbol:"Allow inputting unknown symbol and handle it as pseudo atom in atom setter",TITLE_clonedObjectScreenOffset:"Copied object coord offset",DES_clonedObjectScreenOffset:"The distance between copied objects and origin objects when doing paste selection action in editor"},UiMarkerConfigs:{TITLE_hotTrackerColor:"Hot track mark color",DES_hotTrackerColor:"Color of hot track mark",TITLE_hotTrackerOpacity:"Hot track mark opacity",DES_hotTrackerOpacity:"Opacity of hot track marker, value from 0 to 1",TITLE_selectionMarkerStrokeColor:"Selection mark stroke color",DES_selectionMarkerStrokeColor:"Stroke color of selection mark",TITLE_selectionMarkerStrokeWidth:"Selection mark stroke width",DES_selectionMarkerStrokeWidth:"Width of selection mark stroke",TITLE_selectionMarkerFillColor:"Selection mark fill color",DES_selectionMarkerFillColor:"Fill color of selection mark.",TITLE_selectionMarkerOpacity:"Selection mark opacity",DES_selectionMarkerOpacity:"Opacity of selection mark, value from 0 to 1",TITLE_selectingMarkerStrokeColor:"Selecting mark stroke color",DES_selectingMarkerStrokeColor:"Stroke color of selecting rubber band mark",TITLE_selectingMarkerStrokeWidth:"Selecting mark stroke width",DES_selectingMarkerStrokeWidth:"Stroke width of selection rubber band",TITLE_selectingMarkerStrokeDash:"Selecting mark dash style",DES_selectingMarkerStrokeDash:"Dash style of selecting rubber band",TITLE_selectingMarkerFillColor:"Selecting mark fill color",DES_selectingMarkerFillColor:"Fill color of selecting mark. Usually this value should be left blank (not filled)",TITLE_selectingMarkerOpacity:"Selecting mark opacity",DES_selectingMarkerOpacity:"Opacity of selecting mark, value from 0 to 1"},StructureConfigs:{TITLE_defBondType:"Default bond type",DES_defBondType:"Default type of bond",TITLE_defBondOrder:"Default bond order",DES_defBondOrder:"Default bond order",TITLE_defBondLength:"Default bond length",DES_defBondLength:"Default bond length",TITLE_defIsotopeId:"Default isotope",DES_defIsotopeId:"Default isotope when adding a new atom"},ChemSpaceConfigs:{TITLE_defScreenSize2D:"Default 2D screen size",TITLE_defScreenSize3D:"Default 3D screen size",TITLE_defPadding:"Default padding",DES_defPadding:"Padding on top when adding an unpositioned object to container chem space"},BaseEditor:{TITLE_enableCreateNewDoc:"Enable create new document",DES_enableCreateNewDoc:"Whether creating a new document is allowed",TITLE_initOnNewDoc:"Starts with a new document",DES_initOnNewDoc:"Whether create a new document automatically when composer is initialized",TITLE_enableOperHistory:"Enable undo",DES_enableOperHistory:"Whether undo/redo is enabled"},Composer:{TITLE_enableStyleToolbar:"Enable style toolbar",DES_enableStyleToolbar:"Whether display style toolbar to set color, font and size of objects",TITLE_allowCreateNewChild:"Enable create new child object",DES_allowCreateNewChild:"Whether new direct child of document can be created"}}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},Class=__webpack_require__(0).Class,ClassEx=__webpack_require__(0).ClassEx,ObjectEx=__webpack_require__(0).ObjectEx,DataType=__webpack_require__(0).DataType;module.exports=function(Kekule){if(Kekule.PROP_AUTO_TITLE){var originMethod=ClassEx.getPrototype(ObjectEx).defineProp,newMethod=function(propName,options){if(!options.title&&!options.description){var className=this.getClassName();className.startsWith("Kekule.")&&(className=className.substr(7));var titleField="TITLE_"+propName,desField="DES_"+propName,title=Kekule.Localization.findValue("OBJDEF_TEXTS."+className+"."+titleField),description=Kekule.Localization.findValue("OBJDEF_TEXTS."+className+"."+desField);options.title=title,options.description=description}return originMethod.apply(this,[propName,options])};ClassEx.getPrototype(ObjectEx).defineProp=newMethod}return Kekule.ExceptionLevel={ERROR:-1,WARNING:-2,NOTE:-3,LOG:-4},Kekule.throwException=function(e,exceptionLevel){if(Kekule.exceptionHandler)return Kekule.exceptionHandler.throwException(e,exceptionLevel);var EL=Kekule.ExceptionLevel;if(!exceptionLevel||exceptionLevel===EL.ERROR)throw"string"==typeof e&&(e=new Kekule.Exception(e)),e;if("undefined"!=typeof console){"string"!=typeof e&&(e=e.message);var method=exceptionLevel===EL.WARNING?console.warn:exceptionLevel===EL.NOTE?console.info:console.log;method?method(e):console.log(e)}},Kekule.getExceptionMsg=function(e){return"string"==typeof e?e:"object"===(void 0===e?"undefined":_typeof(e))?e.message:""},Kekule.raise=Kekule.throwException,Kekule.error=function(e){return Kekule.raise(e,Kekule.ExceptionLevel.ERROR)},Kekule.chemError=function(e){return"string"==typeof e&&(e=new Kekule.ChemError(e)),Kekule.error(e)},Kekule.warn=function(e){return Kekule.raise(e,Kekule.ExceptionLevel.WARNING)},Kekule.notify=function(e){return Kekule.raise(e,Kekule.ExceptionLevel.NOTE)},Kekule.log=function(e){return Kekule.raise(e,Kekule.ExceptionLevel.LOG)},Kekule.hasLocalRes=function(){return!!Kekule.LOCAL_RES},Kekule.globalOptions={add:function(optionName,valueOrHash){Object.setCascadeFieldValue(optionName,valueOrHash,Kekule.globalOptions,!0)}},Kekule.HashEx=Class.create({CLASS_NAME:"Kekule.HashEx",PROP_NAME_PREFIX:"__$key$__",initialize:function(){this._map={}},finalize:function(){this._map=null},keyToPropName:function(key){return this.PROP_NAME_PREFIX+key},has:function(key){return this._map.hasOwnProperty(this.keyToPropName(key))},set:function(key,value){return this._map[this.keyToPropName(key)]=value,this},get:function(key,defaultValue){var propName=this.keyToPropName(key);return this._map.hasOwnProperty(propName)?this._map[propName]:defaultValue},remove:function(key){var propName=this.keyToPropName(key);return this._map.hasOwnProperty(propName)&&delete this._map[propName],this},clear:function(){this._map={}}}),Kekule.MapEx=Class.create({CLASS_NAME:"Kekule.MapEx",initialize:function(nonWeak){this.isWeak=!nonWeak,Kekule.MapEx._inited||Kekule.MapEx._init(),Kekule.MapEx._implementation&&this.isWeak?this._implementation=new Kekule.MapEx._implementation:(this.keys=[],this.values=[])},finalize:function($super){this._implementation||(this.keys=null,this.values=null)},set:function(key,value){if(this._implementation)this._implementation.set(key,value);else{var index=this.keys.indexOf(key);index>=0?this.values[index]=value:(this.keys.push(key),this.values.push(value))}return this},get:function(key,defaultValue){if(this._implementation)return this._implementation.get(key,defaultValue);var index=this.keys.indexOf(key);return index>=0?this.values[index]:defaultValue},has:function(key){return this._implementation?this._implementation.has(key):this.keys.indexOf(key)>=0},remove:function(key){if(this._implementation)return this._implementation.delete(key);var index=this.keys.indexOf(key);return index>=0&&(this.keys.splice(index,1),this.values.splice(index,1)),this},clear:function(){return this._implementation?Kekule.error(Kekule.$L("ErrorMsg.CANNOT_CLEAR_WEAKMAP")):(this.keys=[],this.values=[]),this},getKeys:function(){return this._implementation?(Kekule.error(Kekule.$L("ErrorMsg.CANNOT_GET_KEY_LIST_IN_WEAKMAP")),[]):[].concat(this.keys)},getValues:function(){return this._implementation?(Kekule.error(Kekule.$L("ErrorMsg.CANNOT_GET_VALUE_LIST_IN_WEAKMAP")),[]):this.values}}),Kekule.MapEx._init=function(){Kekule.$jsRoot.WeakMap?Kekule.MapEx._implementation=Kekule.$jsRoot.WeakMap:Kekule.MapEx._implementation=null,Kekule.MapEx._inited=!0},Kekule.MapEx._inited=!1,Kekule.TwoTupleMapEx=Class.create({CLASS_NAME:"Kekule.TwoTupleMapEx",initialize:function(nonWeak){this.nonWeak=nonWeak,this.map=new Kekule.MapEx(nonWeak)},finalize:function(){this.map.finalize()},getSecondLevelMap:function(key1,allowCreate){var result=this.map.get(key1);return!result&&allowCreate&&(result=new Kekule.MapEx(this.nonWeak),this.map.set(key1,result)),result},set:function(key1,key2,value){return this.getSecondLevelMap(key1,!0).set(key2,value),this},get:function(key1,key2,defaultValue){var map=this.getSecondLevelMap(key1,!1);return map?map.get(key2,defaultValue):defaultValue},has:function(key1,key2){var map=this.getSecondLevelMap(key1,!1);return!!map&&map.has(key2)},remove:function(key1,key2){var map=this.getSecondLevelMap(key1,!1);if(map)return map.remove(key2)},clear:function(){this.map.clear()}}),Kekule.CoordMode={UNKNOWN:0,COORD2D:2,COORD3D:3},Kekule.ClassDefineUtils={CommonSizeMethods:{getSizeOfMode:function(coordMode,allowSizeBorrow){return coordMode===Kekule.CoordMode.COORD3D?this.getSize3D(allowSizeBorrow):this.getSize2D(allowSizeBorrow)},setSizeOfMode:function(value,coordMode){return coordMode===Kekule.CoordMode.COORD3D?this.setSize3D(value):this.setSize2D(value)},getBoxOfMode:function(coordMode,allowCoordBorrow){return coordMode===Kekule.CoordMode.COORD3D?this.getBox3D(allowCoordBorrow):this.getBox2D(allowCoordBorrow)}},Size2DMethods:{fetchSize2D:function(){var c=this.getPropStoreFieldValue("size2D");return c||(c={},this.setPropStoreFieldValue("size2D",c)),c},notifySize2DChanged:function(newValue){this.notifyPropSet("size2D",newValue)},hasSize2D:function(allowSizeBorrow){var c=this.getPropStoreFieldValue("size2D"),result=c&&(void 0!==c.x||void 0!==c.y);return!result&&allowSizeBorrow&&(result=!!this.hasSize3D&&this.hasSize3D()),result},getBox2D:function(allowCoordBorrow){var coord1=this.getCoord2D(allowCoordBorrow)||{x:0,y:0},size=this.getSize2D(allowCoordBorrow);if(size&&(size.x||size.y)){var delta={x:size.x,y:-size.y},coord2=Kekule.CoordUtils.add(coord1,delta);return{x1:coord1.x,y1:coord1.y,x2:coord2.x,y2:coord2.y}}return{x1:coord1.x,y1:coord1.y,x2:coord1.x,y2:coord1.y}},get2DSizeX:function(allowSizeBorrow){var c=this.getSize2D(allowSizeBorrow);return c?c.x||0:0},set2DSizeX:function(x){var c=this.fetchSize2D();c.x!=x&&(c.x=x,this.notifySize2DChanged(c))},get2DSizeY:function(allowSizeBorrow){var c=this.getSize2D(allowSizeBorrow);return c?c.y||0:0},set2DSizeY:function(y){var c=this.fetchSize2D();c.y!=y&&(c.y=y,this.notifySize2DChanged(c))}},Size3DMethods:{fetchSize3D:function(){var c=this.getPropStoreFieldValue("size3D");return c||(c={},this.setPropStoreFieldValue("size3D",c)),c},notifySize3DChanged:function(newValue){this.notifyPropSet("size3D",newValue)},hasSize3D:function(allowSizeBorrow){var c=this.getPropStoreFieldValue("size3D"),result=c&&(void 0!==c.x||void 0!==c.y||void 0!==c.z);return!result&&allowSizeBorrow&&(result=!!this.hasSize2D&&this.hasSize2D()),result},getBox3D:function(allowCoordBorrow){var coord1=this.getCoord3D(allowCoordBorrow),size=this.getSize3D(allowCoordBorrow);if(coord1&&size){var coord2=Kekule.CoordUtils.add(coord1,size);return{x1:coord1.x,y1:coord1.y,z1:coord1.z,x2:coord2.x,y2:coord2.y,z2:coord2.z}}},get3DSizeX:function(allowSizeBorrow){var c=this.getSize3D(allowSizeBorrow);return c?c.x||0:0},set3DSizeX:function(x){var c=this.fetchSize3D();c.x!=x&&(c.x=x,this.notifySize3DChanged(c))},get3DSizeY:function(allowSizeBorrow){var c=this.getSize3D(allowSizeBorrow);return c?c.y||0:0},set3DSizeY:function(y){var c=this.fetchSize3D();c.y!=y&&(c.y=y,this.notifySize3DChanged(c))},get3DSizeZ:function(allowSizeBorrow){var c=this.getSize3D(allowSizeBorrow);return c?c.z||0:0},set3DSizeZ:function(z){var c=this.fetchSize3D();c.z!=z&&(c.z=z,this.notifySize3DChanged(c))}},addStandardSizeSupport:function(aClass,props){ClassEx.extend(aClass,Kekule.ClassDefineUtils.CommonSizeMethods),(!props||props.indexOf("size2D")>=0)&&(ClassEx.defineProp(aClass,"size2D",{dataType:DataType.HASH,getter:function(allowSizeBorrow,allowCreateNew){var c=this.getPropStoreFieldValue("size2D");!c&&allowSizeBorrow&&this.hasSize3D()&&(c=this.getSize3D()),!c&&allowCreateNew&&(c={x:0,y:0},this.setPropStoreFieldValue("size2D",c));var result=c?{x:c.x,y:c.y}:void 0;return result&&(result=Kekule.CoordUtils.absValue(result)),result},setter:function(value){var c=this.fetchSize2D();void 0!==value.x&&(c.x=value.x),void 0!==value.y&&(c.y=value.y),this.notifySize2DChanged(c)}}),ClassEx.extend(aClass,Kekule.ClassDefineUtils.Size2DMethods)),(!props||props.indexOf("size3D")>=0)&&(ClassEx.defineProp(aClass,"size3D",{dataType:DataType.HASH,getter:function(allowSizeBorrow,allowCreateNew){var c=this.getPropStoreFieldValue("size3D");return!c&&allowSizeBorrow&&this.hasSize2D()&&(c=this.getSize2D(),c.z=0),!c&&allowCreateNew&&(c={x:0,y:0,z:0},this.setPropStoreFieldValue("size3D",c)),c?{x:c.x,y:c.y,z:c.z}:void 0},setter:function(value){var c=this.fetchSize3D();void 0!==value.x&&(c.x=value.x),void 0!==value.y&&(c.y=value.y),void 0!==value.z&&(c.z=value.z),this.notifySize3DChanged(c)}}),ClassEx.extend(aClass,Kekule.ClassDefineUtils.Size3DMethods))},CommonCoordMethods:{getCoordOfMode:function(coordMode,allowCoordBorrow){return coordMode===Kekule.CoordMode.COORD3D?this.getCoord3D(allowCoordBorrow):this.getCoord2D(allowCoordBorrow)},setCoordOfMode:function(value,coordMode){return coordMode===Kekule.CoordMode.COORD3D?this.setCoord3D(value):this.setCoord2D(value)},getAbsCoordOfMode:function(coordMode,allowCoordBorrow){return coordMode===Kekule.CoordMode.COORD3D?this.getAbsCoord3D(allowCoordBorrow):this.getAbsCoord2D(allowCoordBorrow)},setAbsCoordOfMode:function(value,coordMode){return coordMode===Kekule.CoordMode.COORD3D?this.setAbsCoord3D(value):this.setAbsCoord2D(value)}},Coord2DMethods:{fetchCoord2D:function(){var c=this.getPropStoreFieldValue("coord2D");return c||(c={},this.setPropStoreFieldValue("coord2D",c)),c},notifyCoord2DChanged:function(newValue){this.notifyPropSet("coord2D",newValue)},hasCoord2D:function(allowCoordBorrow){var c=this.getPropStoreFieldValue("coord2D"),result=c&&(void 0!==c.x||void 0!==c.y);return!result&&allowCoordBorrow&&(result=!!this.hasCoord3D&&this.hasCoord3D()),result},get2DX:function(allowCoordBorrow){var c=this.getCoord2D(allowCoordBorrow);return c?c.x||0:0},set2DX:function(x){var c=this.fetchCoord2D();c.x!=x&&(c.x=x,this.notifyCoord2DChanged(c))},get2DY:function(allowCoordBorrow){var c=this.getCoord2D(allowCoordBorrow);return c?c.y||0:0},set2DY:function(y){var c=this.fetchCoord2D();c.y!=y&&(c.y=y,this.notifyCoord2DChanged(c))}},Coord3DMethods:{fetchCoord3D:function(){var c=this.getPropStoreFieldValue("coord3D");return c||(c={},this.setPropStoreFieldValue("coord3D",c)),c},notifyCoord3DChanged:function(newValue){this.notifyPropSet("coord3D",newValue)},hasCoord3D:function(allowCoordBorrow){var c=this.getPropStoreFieldValue("coord3D"),result=c&&(void 0!==c.x||void 0!==c.y||void 0!==c.z);return!result&&allowCoordBorrow&&(result=!!this.hasCoord2D&&this.hasCoord2D()),result},get3DX:function(allowCoordBorrow){var c=this.getCoord3D(allowCoordBorrow);return c?c.x||0:0},set3DX:function(x){var c=this.fetchCoord3D();c.x!=x&&(c.x=x,this.notifyCoord3DChanged(c))},get3DY:function(allowCoordBorrow){var c=this.getCoord3D(allowCoordBorrow);return c?c.y||0:0},set3DY:function(y){var c=this.fetchCoord3D();c.y!=y&&(c.y=y,this.notifyCoord3DChanged(c))},get3DZ:function(allowCoordBorrow){var c=this.getCoord3D(allowCoordBorrow);return c?c.z||0:0},set3DZ:function(z){var c=this.fetchCoord3D();c.z!=z&&(c.z=z,this.notifyCoord3DChanged(c))}},addStandardCoordSupport:function(aClass,props){ClassEx.extend(aClass,Kekule.ClassDefineUtils.CommonCoordMethods),(!props||props.indexOf("coord2D")>=0)&&(ClassEx.defineProp(aClass,"coord2D",{dataType:DataType.HASH,getter:function(allowCoordBorrow,allowCreateNew){var c=this.getPropStoreFieldValue("coord2D");return!c&&allowCoordBorrow&&this.hasCoord3D()&&(c=this.getCoord3D()),!c&&allowCreateNew&&(c={x:0,y:0},this.setPropStoreFieldValue("coord2D",c)),c?{x:c.x,y:c.y}:void 0},setter:function(value){var c=this.fetchCoord2D();void 0!==value.x&&(c.x=value.x),void 0!==value.y&&(c.y=value.y),this.notifyCoord2DChanged(c)}}),ClassEx.extend(aClass,Kekule.ClassDefineUtils.Coord2DMethods)),(!props||props.indexOf("coord3D")>=0)&&(ClassEx.defineProp(aClass,"coord3D",{dataType:DataType.HASH,getter:function(allowCoordBorrow,allowCreateNew){var c=this.getPropStoreFieldValue("coord3D");return!c&&allowCoordBorrow&&this.hasCoord2D()&&(c=this.getCoord2D(),c.z=0),!c&&allowCreateNew&&(c={x:0,y:0,z:0},this.setPropStoreFieldValue("coord3D",c)),c?{x:c.x,y:c.y,z:c.z}:void 0},setter:function(value){var c=this.fetchCoord3D();void 0!==value.x&&(c.x=value.x),void 0!==value.y&&(c.y=value.y),void 0!==value.z&&(c.z=value.z),this.notifyCoord3DChanged(c)}}),ClassEx.extend(aClass,Kekule.ClassDefineUtils.Coord3DMethods)),(!props||props.indexOf("absCoord2D")>=0)&&ClassEx.defineProp(aClass,"absCoord2D",{dataType:DataType.HASH,serializable:!1,getter:function(allowCoordBorrow){var c=this.getCoord2D(allowCoordBorrow)||{},p=this.getParent?this.getParent():null;return p&&p.getAbsCoord2D?Kekule.CoordUtils.add(c,p.getAbsCoord2D(allowCoordBorrow)||{}):Object.extend({},c)},setter:function(value){var c=value;this.getParent&&this.getParent()&&this.getParent().getAbsCoord2D&&(c=Kekule.CoordUtils.substract(value,this.getParent().getAbsCoord2D())),this.setCoord2D(c)}}),(!props||props.indexOf("absCoord3D")>=0)&&ClassEx.defineProp(aClass,"absCoord3D",{dataType:DataType.HASH,serializable:!1,getter:function(allowCoordBorrow){var c=this.getCoord3D(allowCoordBorrow)||{},p=this.getParent?this.getParent():null;return p&&p.getAbsCoord3D?Kekule.CoordUtils.add(c,p.getAbsCoord3D(allowCoordBorrow)||{}):Object.extend({},c)},setter:function(value){var c=value;this.getParent&&this.getParent()&&(c=Kekule.CoordUtils.substract(value,this.getParent().getAbsCoord3D())),this.setCoord3D(c)}})},ExtraObjMapMethods:{getExtraProp:function(obj,propName){var info=this.getExtraObjMap().get(obj);return info?propName?info[propName]:info:void 0},setExtraProp:function(obj,propName,propValue){var info=this.getExtraProp(obj);if(info)info[propName]=propValue;else{var info={};info[propName]=propValue,this.getExtraObjMap().set(obj,info)}},removeExtraProp:function(obj,propName){if(propName){var info=this.getExtraProp(obj);info[propName]=void 0,delete info[propName]}else this.getExtraObjMap().remove(obj)}},addExtraObjMapSupport:function(aClass){ClassEx.defineProp(aClass,"extraObjMap",{dataType:"Kekule.MapEx",serializable:!1,getter:function(){var result=this.getPropStoreFieldValue("extraObjMap");return result||(result=new Kekule.MapEx(!0),this.setPropStoreFieldValue("extraObjMap",result)),result}}),ClassEx.extend(aClass,Kekule.ClassDefineUtils.ExtraObjMapMethods)},ExtraTwoTupleObjMapMethods:{getExtraProp2:function(obj1,obj2,propName){var info=this.getExtraTwoTupleObjMap().get(obj1,obj2);return info?propName?info[propName]:info:void 0},setExtraProp2:function(obj1,obj2,propName,propValue){var info=this.getExtraProp2(obj1,obj2);if(info)info[propName]=propValue;else{var info={};info[propName]=propValue,this.getExtraTwoTupleObjMap().set(obj1,obj2,info)}},removeExtraProp2:function(obj1,obj2,propName){if(propName){var info=this.getExtraProp2(obj1,obj2);info[propName]=void 0,delete info[propName]}else this.getExtraTwoTupleObjMap().remove(obj1,obj2)}},addExtraTwoTupleObjMapSupport:function(aClass){var mapName="extraTwoTupleObjMap";ClassEx.defineProp(aClass,mapName,{dataType:"Kekule.TwoTupleMapEx",serializable:!1,getter:function(){var result=this.getPropStoreFieldValue(mapName);return result||(result=new Kekule.TwoTupleMapEx(!0),this.setPropStoreFieldValue(mapName,result)),result}}),ClassEx.extend(aClass,Kekule.ClassDefineUtils.ExtraTwoTupleObjMapMethods)}},Kekule.ObjPropSettingManager={_items:new Kekule.MapEx(!0),register:function(name,settings){Kekule.ObjPropSettingManager._items.set(name,settings)},unregister:function(name){Kekule.ObjPropSettingManager._items.remove(name)},getSetting:function(name){return Kekule.ObjPropSettingManager._items.get(name)}},ClassEx.defineProp(ObjectEx,"predefinedSetting",{dataType:DataType.STRING,scope:Class.PropertyScope.PUBLIC,setter:function(value){var vs=Kekule.StrUtils.splitTokens(value||"",",");if(vs.length){for(var i=0,l=vs.length;i<l;++i){for(var currClass=this.getClass(),v=vs[i],setting=null,sname="";currClass&&!setting;){var cname=ClassEx.getClassName(currClass),sname=cname+"."+v,setting=Kekule.ObjPropSettingManager.getSetting(sname);currClass=ClassEx.getSuperClass(currClass)}setting||(setting=Kekule.ObjPropSettingManager.getSetting(v)),setting&&this.setPropValues(setting)}this.setPropStoreFieldValue("predefinedSetting",sname)}}}),Kekule.ChemObjInteractMode={DEFAULT:0,HIDDEN:-1},Kekule.ComparisonMethod={DEFAULT:0,PROPERTIES:1,CHEM_STRUCTURE:10},Kekule.ObjComparer={equal:function(obj1,obj2,options){return 0===Kekule.ObjComparer.compare(obj1,obj2,options)},compare:function(obj1,obj2,options){return Kekule.ObjComparer._compareValue(obj1,obj2,options)},_compareValue:function(v1,v2,options){var D=DataType;if(v1===v2)return 0;if(v1<v2&&!(v1>v2))return-1;if(v1>v2&&!(v1<v2))return 1;var result=null,type1=D.getType(v1),type2=D.getType(v2);if(type1!==type2){var typeIndexes=[D.UNKNOWN,D.VARIANT,D.UNDEFINED,D.BOOL,D.NUMBER,D.INT,D.FLOAT,D.STRING,D.ARRAY,D.FUNCTION,D.DATE,D.OBJECT,D.OBJECTEX,D.CLASS],index1=typeIndexes.indexOf(type1),index2=typeIndexes.indexOf(type2);result=index1<0&&index2<0?null:index1-index2}else if(!v1&&v2)result=-1;else if(v1&&!v2)result=1;else if(v1.doCompare)result=v1.doCompare(v2,options);else if(v2.doCompare)result=-v2.doCompare(v1,options);else if(type1===DataType.ARRAY){if(!(result=v1.length-v2.length))for(var i=0,l=v1.length;i<l&&!(result=Kekule.ObjComparer._compareValue(v1[i],v2[i],options));++i);}else if(type1===DataType.OBJECT){var s1=JSON.toString(v1),s2=JSON.toString(v2);result=s1<s2?-1:s1>s2?1:0}else result=null;if(null===result){var s1=v1.toString&&v1.toString()||"",s2=v2.toString&&v2.toString()||"";result=s1<s2?-1:s1>s2?1:null,null===result&&(result=-1)}return result}},Kekule.ChemObject=Class.create(ObjectEx,{CLASS_NAME:"Kekule.ChemObject",initialize:function($super,id){$super(),id&&this.setId(id),this.setBubbleEvent(!0),this.addEventListener("change",function(e){var srcInfo=this.getPropStoreFieldValue("srcInfo");if(srcInfo&&srcInfo.data){for(var target=e.target,propNames=e.changedPropNames,clearSrcInfo=!1,i=0,l=propNames.length;i<l;++i){var name=propNames[i];if(name&&"srcInfo"!==name&&target.isPropertySerializable(name)){clearSrcInfo=!0;break}if("[children]"===name){clearSrcInfo=!0;break}}clearSrcInfo&&(srcInfo.data=null)}},this)},doFinalize:function($super){this.removeSelf(),$super()},initProperties:function(){this.defineProp("id",{dataType:DataType.STRING}),this.defineProp("interactMode",{dataType:DataType.INT}),this.defineProp("info",{dataType:DataType.HASH,getter:function(canCreate){var r=this.getPropStoreFieldValue("info");return!r&&canCreate&&(r={},this.setPropStoreFieldValue("info",r)),r}}),this.defineProp("scalarAttribs",{dataType:DataType.ARRAY,setter:null}),this.defineProp("parent",{dataType:"Kekule.ChemObject",serializable:!1,scope:Class.PropertyScope.PUBLIC,setter:function(value){var oldParent=this.getParent();oldParent!==value&&(oldParent&&oldParent._removeChildObj&&oldParent._removeChildObj(this),this.setPropStoreFieldValue("parent",value),value&&value._appendChildObj&&value._appendChildObj(this),this.parentChanged(value))}}),this.defineProp("owner",{dataType:"Kekule.ChemSpace",serializable:!1,scope:Class.PropertyScope.PUBLIC,setter:function(value){var oldOwner=this.getOwner();oldOwner!==value&&(oldOwner&&oldOwner._removeOwnedObj(this),this.setPropStoreFieldValue("owner",value),value&&value._appendOwnedObj(this),this.ownerChanged(value))}}),this.defineProp("srcInfo",{dataType:DataType.OBJECT,serializable:!1,scope:Class.PropertyScope.PUBLISHED,getter:function(){var result=this.getPropStoreFieldValue("srcInfo");return result||(result={},this.setPropStoreFieldValue("srcInfo",result)),result}})},getHigherLevelObj:function(){return this.getParent()||this.getOwner()},getAutoIdPrefix:function(){return"o"},isSelectable:function(){return this.getInteractMode()!==Kekule.ChemObjInteractMode.HIDDEN},getNearestSelectableObject:function(){return this.isSelectable()?this:this.getParent()?this.getParent().getNearestSelectableObject():null},removeSelf:function(){this.setParent(null),this.setOwner(null)},notifyScalarAttribsChange:function(){this.notifyPropSet("scalarAttribs",this.getPropStoreFieldValue("scalarAttribs"))},notifyInfoChange:function(){this.notifyPropSet("info",this.getPropStoreFieldValue("info"))},ownerChanged:function(newOwner){for(var i=0,l=this.getScalarAttribCount();i<l;++i)this.getScalarAttribAt(i).setOwner(newOwner)},parentChanged:function(newParent){},isChildOf:function(obj){for(var p=this.getParent();p&&p!==obj;)p=p.getParent?p.getParent():null;return!!p},getNextSibling:function(){var parent=this.getParent();return parent&&parent.getNextSiblingOfChild?parent.getNextSiblingOfChild(this):null},getChildCount:function(){return 0},getChildAt:function(index){return null},indexOfChild:function(obj){return-1},removeChild:function(obj){return null},insertBefore:function(obj,refChild){return-1},appendChild:function(obj){return this.insertBefore(obj,null)},cascadeOnChildren:function(func){if(!func)return this;for(var i=0,l=this.getChildCount();i<l;++i){var obj=this.getChildAt(i);obj.cascadeOnChildren&&obj.cascadeOnChildren(func),func(obj)}return this},cascade:function(func){return func?(this.cascadeOnChildren(func),func(this),this):this},isEmpty:function(){return!1},clearIds:function(){this.setId(void 0);for(var i=0,l=this.getChildCount();i<l;++i){var child=this.getChildAt(i);child.clearIds&&child.clearIds()}},assignTo:function($super,targetObj,withId){var result=$super(targetObj,Kekule);return!withId&&targetObj.clearIds&&targetObj.clearIds(),result},assign:function(srcObj,withId){return srcObj.assignTo(this,withId)},clone:function(withId){var classObj=this.getClass(),result=new classObj;return this.assignTo(result,withId),result},getScalarAttribCount:function(){var a=this.getScalarAttribs();return a?a.length:0},getScalarAttribAt:function(index){var a=this.getScalarAttribs();return a?a[index]:null},appendScalarAttrib:function(scalar){this.getScalarAttribs()||this.setPropStoreFieldValue("scalarAttribs",[]);var r=Kekule.ArrayUtils.pushUniqueEx(this.getScalarAttribs(),scalar);return r.isPushed&&(scalar.setParent(this),this.notifyScalarAttribsChange()),r.index},removeScalarAttribAt:function(index){if(this.getScalarAttribs()){var r=Kekule.ArrayUtils.removeAt(this.getScalarAttribs(),index);return r&&(r.setParent(null),this.notifyScalarAttribsChange()),r}return null},removeScalarAttrib:function(scalar){if(this.getScalarAttribs()){var r=Kekule.ArrayUtils.remove(this.getScalarAttribs(),scalar);return r&&(r.setParent(null),this.notifyScalarAttribsChange()),r}return null},getInfoKeys:function(){return this.getInfo()?Kekule.ObjUtils.getOwnedFieldNames(this.getInfo()):[]},getInfoValue:function(key){return this.getInfo()?this.getInfo()[key]:null},setInfoValue:function(key,value){this.doGetInfo(!0)[key]=value,this.notifyInfoChange()},getContainerBox:function(coordMode,allowCoordBorrow){if(this.getAbsCoordOfMode){var coord1=this.getAbsCoordOfMode(coordMode,allowCoordBorrow)||{},coord2=coord1;if(this.getSizeOfMode){var size=this.getSizeOfMode(coordMode,allowCoordBorrow)||{};if(coordMode===Kekule.CoordMode.COORD3D)var coord2=Kekule.CoordUtils.add(coord1,this.getSizeOfMode(coordMode,allowCoordBorrow)||{});else coord2={x:coord1.x+size.x,y:coord1.y-size.y}}return Kekule.BoxUtils.createBox(coord1,coord2)}return null},equal:function(targetObj,options){return 0===this.compare(targetObj,options)},compare:function(targetObj,options){if(targetObj===this)return 0;if(!targetObj)return 1;var result,actualOps=this.doGetActualCompareOptions(options);return result=actualOps.customMethod?actualOps.customMethod(this,targetObj,actualOps):this.doCompare(targetObj,actualOps),0===result?0:result<0?-1:1},doGetActualCompareOptions:function(options){return options||{}},doCompare:function(targetObj,options){if(targetObj===this)return 0;if(this.getClass()!==(targetObj.getClass&&targetObj.getClass()))return this.getClassName()<(targetObj.getClassName&&targetObj.getClassName()||"")?-1:1;return this.doCompareOnProperties(targetObj,options)},doCompareOnProperties:function(targetObj,options){var propNames;options.properties?propNames=options.properties:(propNames=this.doGetComparisonPropNames(options))||(propNames=this.doGetDefaultComparisonPropNames());for(var result=0,i=0,l=propNames.length;i<l;++i)if(0!==(result=this.doCompareProperty(targetObj,propNames[i],options)))return result;return 0},doGetComparisonPropNames:function(options){return null},doGetDefaultComparisonPropNames:function(){for(var propNames=[],props=this.getPropListOfScopes([Class.PropertyScope.PUBLIC,Class.PropertyScope.PUBLISHED]),i=0,l=props.getLength();i<l;++i){var propInfo=props.getPropInfoAt(i);propNames.push(propInfo.name)}return propNames},doCompareProperty:function(targetObj,propName,options){var v2=targetObj.getPropValue&&targetObj.getPropValue(propName),v1=this.getPropValue(propName);return v1===v2?0:this.doCompareOnValue(v1,v2,options)},doCompareOnValue:function(v1,v2,options){return Kekule.ObjComparer._compareValue(v1,v2,options)}}),Kekule.Scalar=Class.create(Kekule.ChemObject,{CLASS_NAME:"Kekule.Scalar",initialize:function($super,id,name,value,unit){$super(id),name&&this.setName(name),void 0!==value&&this.setValue(value),unit&&this.setUnit(unit)},initProperties:function(){this.defineProp("name",{dataType:DataType.STRING}),this.defineProp("value",{dataType:DataType.PRIMARY}),this.defineProp("errorValue",{dataType:DataType.PRIMARY}),this.defineProp("unit",{dataType:DataType.STRING}),this.defineProp("title",{dataType:DataType.STRING})}}),Kekule.ChemObjList=Class.create(Kekule.ChemObject,{CLASS_NAME:"Kekule.ChemObjList",initialize:function($super,id,itemBaseClass,transparent){$super(id),this.setPropStoreFieldValue("itemBaseClass",itemBaseClass),this._transparent=!!transparent},initProperties:function(){this.defineProp("itemBaseClass",{dataType:DataType.CLASS,serializable:!1,scope:Class.PropertyScope.PUBLIC}),this.defineProp("items",{dataType:DataType.ARRAY,scope:Class.PropertyScope.PUBLIC,setter:null,getter:function(canCreate){var r=this.getPropStoreFieldValue("items");return!r&&canCreate&&(r=[],this.setPropStoreFieldValue("items",r)),r}})},loaded:function($super){this.ownerChanged(this.getOwner()),this.parentChanged(this.getParent())},ownerChanged:function($super,newOwner){this.changeAllItemsOwner(),$super(newOwner)},parentChanged:function($super,newParent){this.changeAllItemsParent(),$super(newParent)},isEmpty:function(){return!1},checkItemType:function(item){var c=this.getItemBaseClass(),r=!c||item instanceof c;return r||Kekule.raise(Kekule.$L("ErrorMsg.LIST_ITEM_CLASS_MISMATCH")),r},notifyItemsChange:function(){this.notifyPropSet("items",this.getPropStoreFieldValue("items"))},getItemOwner:function(){return this.getOwner()},changeAllItemsOwner:function(){var items=this.getItems();if(items)for(var owner=this.getItemOwner(),i=0,l=items.length;i<l;++i){var obj=items[i];obj&&obj.setOwner&&obj.setOwner(owner)}},getItemParent:function(){return this._transparent?this.getParent()||this:this},changeAllItemsParent:function(){var items=this.getItems();if(items)for(var parent=this.getItemParent(),i=0,l=items.length;i<l;++i){var obj=items[i];obj&&obj.setParent&&obj.setParent(parent)}},getItemCount:function(){var a=this.getPropStoreFieldValue("items");return a?a.length:0},getItemAt:function(index){var a=this.getPropStoreFieldValue("items");return a?a[index]:null},indexOf:function(obj){var a=this.getPropStoreFieldValue("items");return a?a.indexOf(obj):-1},getNextSiblingOfChild:function(childObj){var index=this.indexOf(childObj);return index>=0?this.getItemAt(index+1):null},getChildCount:function(){return this.getItemCount()},getChildAt:function(index){return this.getItemAt(index)},indexOfChild:function(obj){return this.indexOf(obj)},append:function(obj){if(this.checkItemType(obj),obj){var r=Kekule.ArrayUtils.pushUniqueEx(this.doGetItems(!0),obj);return r.isPushed&&(this.notifyItemsChange(),obj.setOwner&&obj.setOwner(this.getItemOwner()),obj.setParent&&obj.setParent(this.getItemParent())),r.index}return-1},insert:function(obj,index){if(this.checkItemType(obj),obj){var r=Kekule.ArrayUtils.insertUniqueEx(this.doGetItems(!0),obj,index);return r.isInserted&&(this.notifyItemsChange(),obj.setOwner&&obj.setOwner(this.getItemOwner()),obj.setParent&&obj.setParent(this.getItemParent())),r.index}return-1},insertBefore:function(obj,refChild){if(refChild){var refIndex=this.indexOf(refChild);return refIndex>=0?this.insert(obj,refIndex):this.append(obj)}return this.append(obj)},removeAt:function(index){if(this.getItems()){var r=Kekule.ArrayUtils.removeAt(this.getItems(),index);return r&&(r.setOwner&&r.setOwner(null),r.setParent&&r.setParent(null),this.notifyItemsChange()),r}},removeChildAt:function(index){return this.removeAt(index)},remove:function(obj){if(this.getItems()){var r=Kekule.ArrayUtils.remove(this.getItems(),obj);return r&&(r.setOwner&&r.setOwner(null),r.setParent&&r.setParent(null),this.notifyItemsChange()),r}},removeChild:function($super,obj){return this.remove(obj)||$super(obj)},toArray:function(){return this.getItems()},getContainerBox:function(coordMode,allowCoordBorrow){for(var result,childObjs=this.toArray(),i=0,l=childObjs.length;i<l;++i){var obj=childObjs[i],box=obj.getContainerBox?obj.getContainerBox(coordMode,allowCoordBorrow):null;box&&(result=result?Kekule.BoxUtils.getContainerBox(result,box):Object.extend({},box))}return result}}),Kekule.ChemSpaceElement=Class.create(Kekule.ChemObject,{CLASS_NAME:"Kekule.ChemSpaceElement",initialize:function($super,id){$super(id);var list=new Kekule.ChemObjList(null,Kekule.ChemObject,!0);list.setParent(this),list.addEventListener("change",function(){this.objectChange(["children"])},this),this.setPropStoreFieldValue("children",list)},initProperties:function(){this.defineProp("children",{dataType:"Kekule.ChemObjList",scope:Class.PropertyScope.PUBLIC,setter:function(value){var old=this.getChildren();old&&old.finalize(),value&&(value.setParent(this),value.setOwner(this.getOwner())),this.setPropStoreFieldValue("children",value)}})},ownerChanged:function($super,newOwner){this.getChildren().setOwner(newOwner)},_removeChildObj:function(obj){var index=this.indexOfChild(obj);index>=0&&this.removeChildAt(index)},getChildCount:function(){return this.getChildren().getItemCount()},getChildAt:function(index){return this.getChildren().getItemAt(index)},indexOfChild:function(obj){return this.getChildren().indexOf(obj)},getNextSiblingOfChild:function(childObj){return this.getChildren().getNextSiblingOfChild(childObj)},appendChild:function(obj){return this.getChildren().append(obj)},insertChild:function(obj,index){return this.getChildren().insert(obj,index)},insertBefore:function(obj,refChild){return this.getChildren().insertBefore(obj,refChild)},removeChildAt:function(index){return this.getChildren().removeChildAt(index)},removeChild:function($super,obj){return this.getChildren().removeChild(obj)||$super(obj)}}),Kekule.ChemSpace=Class.create(Kekule.ChemObject,{CLASS_NAME:"Kekule.ChemSpace",initialize:function($super,id){$super(id),this._autoIdMap={},this.setPropStoreFieldValue("enableAutoId",!0),this.setPropStoreFieldValue("ownedObjs",[]);var root=new Kekule.ChemSpaceElement;this.setPropStoreFieldValue("root",root),root.setParent(this),root.setOwner(this)},initProperties:function(){this.defineProp("ownedObjs",{dataType:DataType.ARRAY,serializable:!1,setter:null,scope:Class.PropertyScope.PUBLIC}),this.defineProp("root",{dataType:"Kekule.ChemSpaceElement",setter:null}),this.defineProp("enableAutoId",{dataType:DataType.BOOL}),this.defineProp("objScreenLengthRatio",{dataType:DataType.FLOAT,serializable:!1,scope:Class.PropertyScope.PRIVATE}),this.defineProp("screenSize",{dataType:DataType.HASH,getter:function(){var o=this.getPropStoreFieldValue("screenSize")||{};return{x:o.x,y:o.y}},setter:function(value){var o=this.getPropStoreFieldValue("screenSize");o||(o={},this.setPropStoreFieldValue("screenSize",o)),o.x=value.x,o.y=value.y}})},loaded:function($super){$super();var root=this.getRoot();root&&(root.setParent(this),root.setOwner(this))},notifyOwnedObjsChange:function(){this.notifyPropSet("ownedObjs",this.getPropStoreFieldValue("ownedObjs"))},getChildren:function(){return this.getRoot().getChildren().toArray()},getChildCount:function(){return this.getRoot().getChildCount()},getChildAt:function(index){return this.getRoot().getChildAt(index)},indexOfChild:function(obj){return this.getRoot().indexOfChild(obj)},getNextSiblingOfChild:function(childObj){return this.getRoot().getNextSiblingOfChild(childObj)},appendChild:function(obj){return this.getRoot().appendChild(obj)},insertChild:function(obj,index){return this.getRoot().insertChild(obj,index)},insertBefore:function(obj,refChild){return this.getRoot().insertBefore(obj,refChild)},removeChildAt:function(index){return this.getRoot().removeChildAt(index)},removeChild:function($super,obj){return this.getRoot().removeChild(obj)||$super(obj)},getObjById:function(id){for(var i=0,l=this.getOwnedObjCount();i<l;++i){var obj=this.getOwnedObjAt(i);if(obj.getId&&obj.getId()==id)return obj}return null},getAutoId:function(obj,fromIndex){var prefix;prefix=obj&&obj.getAutoIdPrefix?obj.getAutoIdPrefix():"o";var index,prefix=obj.getAutoIdPrefix?obj.getAutoIdPrefix():"o";Kekule.ObjUtils.notUnset(fromIndex)?index=fromIndex:(index=this._autoIdMap[prefix]||0,++index);var index=this._getAutoIdIndex(prefix,index);return this._autoIdMap[prefix]=index,prefix+Number(index).toString()},_getAutoIdIndex:function(prefix,fromIndex){for(var start=fromIndex||0,i=start,id=prefix+Number(i).toString();this.getObjById(id);)++i,id=prefix+Number(i).toString();return i},assignAutoIdToObj:function(obj){if(obj.setId){var id=this.getAutoId(obj);obj.setId(id)}},getOwnedObjCount:function(){return this.getOwnedObjs().length},getOwnedObjAt:function(index){return this.getOwnedObjs()[index]},indexOfOwnedObj:function(obj){return this.getOwnedObjs().indexOf(obj)},_appendOwnedObj:function(obj){this.indexOfOwnedObj(obj)>=0||(this.getEnableAutoId()&&obj.getId&&!obj.getId()&&this.assignAutoIdToObj(obj),this.getOwnedObjs().push(obj),this.notifyOwnedObjsChange())},_removeOwnedObjAt:function(index){this.getOwnedObjAt(index)&&(this.getOwnedObjs().splice(index,1),this.notifyOwnedObjsChange())},_removeOwnedObj:function(obj){var index=this.getOwnedObjs().indexOf(obj);index>=0&&this._removeOwnedObjAt(index)}}),Kekule.ClassDefineUtils.addStandardSizeSupport(Kekule.ChemSpace),Kekule.ChemDocument=Class.create(Kekule.ChemSpace,{CLASS_NAME:"Kekule.ChemDocument",initProperties:function(){},getAutoIdPrefix:function(){return"d"}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,ObjectEx=__webpack_require__(0).ObjectEx;module.exports=function(Kekule){return Kekule.ExceptionHandler=Class.create(ObjectEx,{CLASS_NAME:"Kekule.ExceptionHandler",initProperties:function(){this.defineEvent("exceptionThrown")},notifyExceptionThrown:function(e,exceptionLevel){var eventArg={exception:e,level:exceptionLevel};return this.invokeEvent("exceptionThrown",eventArg),eventArg},throwException:function(e,exceptionLevel){var EL=Kekule.ExceptionLevel;if(exceptionLevel||(exceptionLevel=EL.ERROR),!this.notifyExceptionThrown(e,exceptionLevel||EL.ERROR).stop){if(!exceptionLevel||exceptionLevel===EL.ERROR){var eo=e;throw"string"==typeof e&&(eo=new Kekule.Exception(e)),eo}if("undefined"!=typeof console){"string"!=typeof e&&(e=e.message);var method=exceptionLevel===EL.WARNING?"warn":exceptionLevel===EL.NOTE?"info":"log";method?console[method](e):console.log(e)}}},raise:function(e,exceptionLevel){return this.throwException(e,exceptionLevel||Kekule.ExceptionLevel.ERROR)}}),Kekule.ExceptionHandler.getInstance=function(){return this.instance||(this.instance=new Kekule.ExceptionHandler),this.instance},Kekule.exceptionHandler=Kekule.ExceptionHandler.getInstance(),Kekule.Exception=function(message,name){this.message=message,this.name=name},Kekule.Exception.prototype=new Error,Kekule.Exception.prototype.constructor=Kekule.Exception,Object.extend(Kekule.Exception.prototype,{getMessage:function(){return this.message}}),Kekule.Error=function(message,name){this.message=message,this.name=name},Kekule.Error.prototype=Kekule.Exception.prototype,Kekule.Error.prototype.constructor=Kekule.Error,Kekule.ChemError=function(message,name){this.message=message,this.name=name},Kekule.ChemError.prototype=Kekule.Error.prototype,Kekule.ChemError.prototype.constructor=Kekule.ChemError,"undefined"==typeof console&&(console={log:function(){},warn:function(){},info:function(){},error:function(){}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},ClassEx=(__webpack_require__(0).Class,__webpack_require__(0).ClassEx),DataType=(__webpack_require__(0).ObjectEx,__webpack_require__(0).DataType);module.exports=function(Kekule){return Kekule.oneOf=function(){for(var args=arguments,notUnset=Kekule.ObjUtils.notUnset,i=0,l=args.length;i<l;++i)if(notUnset(args[i]))return args[i];return null},Kekule.ClassUtils={getShortClassName:function(className){var p=className.indexOf(".");return p>=0?className.substring(p+1):className},getLastClassName:function(className){var p=className.lastIndexOf(".");return p>=0?className.substring(p+1):className},makeSingleton:function(classObj){return Object.extend(classObj,{_instance:null,getInstance:function(p1,p2,p3,p4,p5,p6,p7,p8,p9,p10){return classObj._instance||(classObj._instance=new classObj(p1,p2,p3,p4,p5,p6,p7,p8,p9,p10)),classObj._instance}})}},Kekule.NumUtils={isInteger:function(num){return"number"==typeof num&&parseInt(num,10)===parseFloat(num)},toDecimals:function(num,decimalsLength){if(Kekule.NumUtils.isInteger(num))return num.toString();var times=Math.pow(10,decimalsLength),n=Math.round(num*times);n/=times;var i=parseInt(n),f=n-i,sf=f.toString();return sf.length>decimalsLength+2?(sf=sf.substr(2,decimalsLength),i.toString()+"."+sf):n.toString()},isFloatEqual:function(f1,f2,threshold){return Kekule.ObjUtils.isUnset(threshold)&&(threshold=1e-100),Math.abs(f1-f2)<=threshold}},Kekule.ObjUtils={getPrototypeOf:function(obj){return Object.getPrototypeOf?Object.getPrototypeOf(obj):obj.prototype||obj.__proto__},getOwnedFieldNames:function(obj,includeFuncFields){var result=[];for(var fname in obj)obj.hasOwnProperty(fname)&&(includeFuncFields||"function"!=typeof obj[fname])&&result.push(fname);return result},replacePropName:function(obj,oldName,newName){return void 0!==obj[oldName]&&(obj.hasOwnProperty(oldName)?(obj[newName]=obj[oldName],delete obj[oldName]):Kekule.raise(Kekule.$L("ErrorMsg.NON_OWN_PROPERTY_CANNOT_BE_REPLACED"))),obj},isUnset:function(value){return null===value||void 0===value},notUnset:function(value){return null!==value&&void 0!==value},equal:function(src,dest,excludingFields){for(var fname in src)if(!(excludingFields&&excludingFields.indexOf(fname)>=0)&&src[fname]!==dest[fname])return!1;return!0},match:function(src,condition){for(var fname in condition)if(condition.hasOwnProperty(fname)&&src[fname]!==condition[fname])return!1;return!0},isInstanceOf:function(obj,classes){if(DataType.isArrayValue(classes)){for(var i=0,l=classes.length;i<l;++i)if(obj instanceof classes[i])return!0;return!1}return obj instanceof classes},getLeafFieldCascadeNames:function(obj,includeFuncFields){var result=[];return function fillCascadeNames(names,prefix,obj,includeFuncFields){for(var fname in obj)if(obj.hasOwnProperty(fname)&&(includeFuncFields||"function"!=typeof obj[fname])){var value=obj[fname];"object"===(void 0===value?"undefined":_typeof(value))?fillCascadeNames(names,prefix+fname+".",value,includeFuncFields):names.push(prefix+fname)}}(result,"",obj,includeFuncFields),result}},Kekule.ArrayUtils={isArray:function(value){return!!value&&("object"==(void 0===value?"undefined":_typeof(value))&&void 0!==value.length)},toArray:function(value){return Kekule.ArrayUtils.isArray(value)?value:[value]},clone:function(src){return src.slice(0)},divide:function(src,memberCount){for(var result=[],curr=[],offset=0,i=0,l=src.length;i<l;++i)curr.push(src[i]),++offset>=memberCount&&(result.push(curr),curr=[],offset=0);return curr.length&&result.push(curr),result},pushUnique:function(targetArray,obj){var r=Kekule.ArrayUtils.pushUniqueEx(targetArray,obj);return r?r.index:null},pushUniqueEx:function(targetArray,obj){if(DataType.isArrayValue(obj)){for(var r,i=0,l=obj.length;i<l;++i)Kekule.ObjUtils.isUnset(r)?r=Kekule.ArrayUtils.pushUniqueEx(targetArray,obj[i]):Kekule.ArrayUtils.pushUniqueEx(targetArray,obj[i]);return r}if(!obj)return{index:-1,isPushed:!1};var index=targetArray.indexOf(obj);return index<0?{index:targetArray.push(obj),isPushed:!0}:{index:index,isPushed:!1}},insertUnique:function(targetArray,obj,index){return Kekule.ArrayUtils.insertUniqueEx(targetArray,obj,index).index},insertUniqueEx:function(targetArray,obj,index){if(!obj)return{index:-1,isInserted:!1};(Kekule.ObjUtils.isUnset(index)||index<0)&&(index=targetArray.length);var i=targetArray.indexOf(obj);return i<0?(targetArray.splice(index,0,obj),{index:index,isInserted:!0}):i!=index?(targetArray.splice(i,1),targetArray.splice(index,0,obj),{index:index,isInserted:!1}):void 0},removeAt:function(targetArray,index){var obj=targetArray[index];return void 0!==obj?(targetArray.splice(index,1),obj):null},remove:function(targetArray,obj,removeAll){var index=targetArray.indexOf(obj);return index>=0?(Kekule.ArrayUtils.removeAt(targetArray,index),removeAll&&Kekule.ArrayUtils.remove(targetArray,obj,removeAll),obj):null},replace:function(targetArray,oldObj,newObj,replaceAll){var index=targetArray.indexOf(oldObj);return index>=0?(targetArray[index]=newObj,replaceAll&&Kekule.ArrayUtils.replace(targetArray,oldObj,newObj,replaceAll),oldObj):null},changeIndex:function(targetArray,oldIndex,newIndex){if(oldIndex>=0&&oldIndex<=targetArray.length){var obj=targetArray[oldIndex];return targetArray.splice(oldIndex,1),targetArray.splice(newIndex,0,obj),obj}return null},changeItemIndex:function(targetArray,item,newIndex){var index=targetArray.indexOf(item);return Kekule.ArrayUtils.changeIndex(targetArray,index,newIndex)},toUnique:function(a){for(var b=[],i=0,l=a.length;i<l;++i){var e=a[i];b.indexOf(e)<0&&b.push(e)}return b},getUniqueElemCount:function(a){return Kekule.ArrayUtils.toUnique(a).length},reverse:function(a){for(var result=[],i=0,l=a.length;i<l;++i)Kekule.ObjUtils.notUnset(a[i])&&(result[l-i-1]=a[i]);return result},randomize:function(src){if(!src)return null;if(!src.length)return[];for(var result=[],remaining=src.slice(0);remaining.length>1;){var index=Math.round(Math.random()*(remaining.length-1));result.push(remaining.splice(index,1)[0])}return result.push(remaining[0]),result},exclude:function(src,excludes){for(var result=[],exs=Kekule.ArrayUtils.toArray(excludes),i=0,l=src.length;i<l;++i){var item=src[i];exs.indexOf(item)<0&&result.push(item)}return result},intersect:function(a1,a2){for(var result=[],i=0,l=a1.length;i<l;++i)a2.indexOf(a1[i])>=0&&result.push(a1[i]);return result},compare:function(a1,a2,itemCompareFunc){itemCompareFunc||(itemCompareFunc=function(i1,i2){return i1>i2?1:i1<i2?-1:0});for(var l=Math.min(a1.length,a2.length),i=0;i<l;++i){var item1=a1[i],item2=a2[i],compareResult=itemCompareFunc(item1,item2);if(0!==compareResult)return compareResult}return a1.length>l?1:a2.length>l?-1:0},compareNestedArray:function(a1,a2,compareFunc){var l=Math.min(a1.length,a2.length);compareFunc||(compareFunc=function(i,j){return i-j});for(var i=0;i<l;++i){var compareValue=0,item1=a1[i],item2=a2[i],isArray1=DataType.isArrayValue(item1),isArray2=DataType.isArrayValue(item2);if(0!=(compareValue=isArray1&&isArray2?Kekule.ArrayUtils.compareNestedArray(item1,item2,compareFunc):isArray1?1:isArray2?-1:compareFunc(item1,item2)))return compareValue}return a1.length>l?1:a2.length>l?-1:0},group:function(arr,compareFunc){compareFunc||(compareFunc=function(a,b){return a<b?-1:a>b?1:0});var sortedArray=Kekule.ArrayUtils.clone(arr);sortedArray.sort(compareFunc);for(var lastCompareItem,result=[],i=0,l=sortedArray.length;i<l;++i){var item=sortedArray[i];if(lastCompareItem&&0===compareFunc(item,lastCompareItem)){var lastResultItem=result.length?result[result.length-1]:null;Kekule.ArrayUtils.isArray(lastResultItem)||(result.pop(),lastResultItem=[lastCompareItem],result.push(lastResultItem)),lastResultItem.push(item)}else result.push(item);lastCompareItem=item}return result},getMedian:function(arr){var a=[].concat(arr),l=a.length;return 0===l?null:l<=1?a[0]:(a.sort(function(a,b){return a-b}),l%2?a[l+1>>1]:(a[l>>1]+a[(l>>1)-1])/2)},sortHashArray:function(arr,sortFields){for(var sortFieldInfos=[],i=0,l=sortFields.length;i<l;++i){var info={},field=sortFields[i]||"";field.startsWith("!")?(info.field=field.substr(1),info.desc=!0):(info.field=field,info.desc=!1),sortFieldInfos.push(info)}var sortFunc=function(hash1,hash2){for(var compareValue=0,i=0,l=sortFieldInfos.length;i<l;++i){var field=sortFieldInfos[i].field,v1=hash1[field]||"",v2=hash2[field]||"";if(compareValue=v1>v2?1:v1<v2?-1:0,sortFieldInfos[i].desc&&(compareValue=-compareValue),0!==compareValue)break}return compareValue};return arr.sort(sortFunc),arr}},Kekule.StrUtils={STR_TRUES:["true","yes","t","y"],STR_FALSES:["false","no","f","n"],trim:function(str){return str.replace(/^\s*|\s*$/g,"")},normalizeSpace:function(str){return str.replace(/^\s*|\s(?=\s)|\s*$/g,"")},convertToStr:function(value){return""+value},convertToType:function(str,valueType){if("string"!=typeof str)return str;switch(valueType){case DataType.FLOAT:case DataType.NUMBER:return parseFloat(str);case DataType.INT:return parseInt(str);case DataType.BOOL:return Kekule.StrUtils.strToBool(str);default:return str}},boolToStr:function(value){return value?Kekule.StrUtils.STR_TRUES[0]:Kekule.StrUtils.STR_FALSES[0]},strToBool:function(value){for(var v=value.toLowerCase(),i=0,l=Kekule.StrUtils.STR_FALSES.length;i<l;++i)if(v==Kekule.StrUtils.STR_FALSES[i])return!1;return!!value},removeAroundPair:function(str,leading,tailing){return str.startsWith(leading)&&str.endsWith(tailing)?str.substring(leading.length,str.length-leading.length-tailing.length+1):str},unquote:function(str){var remove=Kekule.StrUtils.removeAroundPair,result=str;return result=remove(result,"'","'"),result=remove(result,'"','"')},splitTokens:function(str,separator){if(!str)return[];if(DataType.isArrayValue(str))return str;var reg=separator?new RegExp(separator,"g"):/\s+/g;return str.split(reg)},hasToken:function(str,token,separator){return Kekule.StrUtils.splitTokens(str,separator).indexOf(token)>=0},addTokens:function(str,tokens,separator){for(var ts=Kekule.StrUtils.splitTokens(str,separator),adds=Kekule.StrUtils.splitTokens(tokens,separator),i=0,l=adds.length;i<l;++i)ts.indexOf(adds[i])<0&&ts.push(adds[i]);return ts.join(separator||" ")},removeTokens:function(str,tokens,separator){for(var ts=Kekule.StrUtils.splitTokens(str,separator),removes=Kekule.StrUtils.splitTokens(tokens,separator),i=0,l=removes.length;i<l;++i){var index=ts.indexOf(removes[i]);index>=0&&ts.splice(index,1)}return ts.join(separator||" ")},toggleTokens:function(str,tokens,separator){for(var ts=Kekule.StrUtils.splitTokens(str,separator),modifies=Kekule.StrUtils.splitTokens(tokens,separator),added=[],i=0,l=modifies.length;i<l;++i){var index=ts.indexOf(modifies[i]);index>=0?ts.splice(index,1):added.push(modifies[i])}return ts=ts.concat(added),ts.join(separator||" ")},getLineCount:function(str,lineDelimiter){return lineDelimiter||(lineDelimiter="\n"),str.split(lineDelimiter).length},getMaxLineCharCount:function(str,lineDelimiter){lineDelimiter||(lineDelimiter="\n");for(var lines=str.split(lineDelimiter),result=0,i=0,l=lines.length;i<l;++i){var line=lines[i];result=Math.max(line.length,result)}return result}},Kekule.RoleMapUtils={KEY_ITEM:"item",KEY_ROLE:"role",NON_EXPLICIT_ROLE:null,createMap:function(item,role){var r={};return role=role||Kekule.RoleMapUtils.NON_EXPLICIT_ROLE,r[Kekule.RoleMapUtils.KEY_ITEM]=item,r[Kekule.RoleMapUtils.KEY_ROLE]=role,r},getItem:function(map){return map[Kekule.RoleMapUtils.KEY_ITEM]},setItem:function(map,item){map[Kekule.RoleMapUtils.KEY_ITEM]=item},getRole:function(map){return map[Kekule.RoleMapUtils.KEY_ROLE]},setRole:function(map,role){map[Kekule.RoleMapUtils.KEY_ROLE]=role}},Kekule.FactoryUtils={MATCH_EXACTLY:0,MATCH_BY_CLASS:1,DEF_ITEM_STORE_FIELD_NAME:"_items",createSimpleFactory:function(matchMethod){var FU=Kekule.FactoryUtils,result={_items:new Kekule.MapEx(!0),_matchMethod:matchMethod||Kekule.FactoryUtils.MATCH_EXACTLY,register:function(key,aClass){result._items.set(key,aClass)},unregister:function(key){result._items.remove(key)},getClass:function(key){if(result._matchMethod===FU.MATCH_EXACTLY)return result._items.get(key);if(result._matchMethod===FU.MATCH_BY_CLASS){var r=result._items.get(key);if(!r){var parent=ClassEx.getSuperClass(key);parent&&(r=result.getClass(parent))}return r}},getInstance:function(key,p1,p2,p3,p4,p5,p6,p7,p8,p9){var aClass=result.getClass(key);if(aClass)return new aClass(p1,p2,p3,p4,p5,p6,p7,p8,p9)}};return result}},Kekule.UrlUtils={EXT_DELIMITER:".",PATH_DELIMITER:"/",SEARCH_DELIMITER:"?",SEARCH_PAIR_DELIMITER:"&",KEY_VALUE_DELIMITER:"=",HASH_DELIMITER:"#",extractFileName:function(url){if(!url)return null;var p=url.lastIndexOf(Kekule.UrlUtils.PATH_DELIMITER);return p>=0?url.substr(p+1):url},extractFileExt:function(url){var fileName=Kekule.UrlUtils.extractFileName(url);if(fileName){var p=fileName.lastIndexOf(Kekule.UrlUtils.EXT_DELIMITER);return p>=0?fileName.substr(p+1):""}return null},extractFileCoreName:function(url){var fileName=Kekule.UrlUtils.extractFileName(url);if(fileName){var p=fileName.lastIndexOf(Kekule.UrlUtils.EXT_DELIMITER);return p>=0?fileName.substr(0,p):""}return null},extractSearch:function(url){if(!url)return null;var p=url.lastIndexOf(Kekule.UrlUtils.SEARCH_DELIMITER);return p>=0?url.substr(p):null},analysisSearch:function(url,returnHash){var s=Kekule.UrlUtils.extractSearch(url)||"";s=s.substr(1);for(var pairs=s.split(Kekule.UrlUtils.SEARCH_PAIR_DELIMITER),result=returnHash?{}:[],i=0,l=pairs.length;i<l;++i){var pair=pairs[i],a=pair.split(Kekule.UrlUtils.KEY_VALUE_DELIMITER);a[0]&&(returnHash?result[a[0]]=a[1]:result.push({key:a[0],value:a[1]}))}return result},generateSearchString:function(params){for(var U=Kekule.UrlUtils,parts=[],keys=Kekule.ObjUtils.getOwnedFieldNames(params),i=0,l=keys.length;i<l;++i){var key=keys[i],value=params[key];if(Kekule.ObjUtils.notUnset(value)){var value=encodeURIComponent(""+value);parts.push(key+U.KEY_VALUE_DELIMITER+value)}}return parts.join(U.SEARCH_PAIR_DELIMITER)},generateUrl:function(baseUrl,searchParams,hash){var U=Kekule.UrlUtils,result=baseUrl;if(searchParams){var ssearch=U.generateSearchString(searchParams);result+=U.SEARCH_DELIMITER+ssearch}return hash&&(result+=U.HASH_DELIMITER+hash),result}},Kekule.MatrixUtils={create:function(rowCount,colCount,prefilledValue){var preValueSet=!1,preValueIsArray=!1,OU=Kekule.ObjUtils;OU.notUnset(prefilledValue)&&(preValueSet=!0,Kekule.ArrayUtils.isArray(prefilledValue)&&(preValueIsArray=!0));for(var index=0,m=new Array(rowCount),i=0,l=m.length;i<l;++i){var r=new Array(colCount);if(preValueSet)for(var j=0,k=r.length;j<k;++j)preValueIsArray&&OU.notUnset(prefilledValue[index])?(r[j]=prefilledValue[index],++index):r[j]=prefilledValue;m[i]=r}return m},createIdentity:function(rowColCount){for(var result=Kekule.MatrixUtils.create(rowColCount,rowColCount,0),i=0;i<rowColCount-1;++i)result[i][i]=1;return result},getRowCount:function(matrix){return matrix.length},getColCount:function(matrix){return Kekule.MatrixUtils.getRowCount(matrix)>0?matrix[0].length:0},getValue:function(matrix,row,col){return matrix[row-1][col-1]||0},setValue:function(matrix,row,col,value){matrix[row-1][col-1]=value},transpose:function(m){for(var M=Kekule.MatrixUtils,rowCount=M.getColCount(m),colCount=M.getRowCount(m),result=M.create(rowCount,colCount),i=1;i<=rowCount;++i)for(var r=result[i-1],j=1;j<=colCount;++j)r[j-1]=M.getValue(m,j,i);return result},minus:function(matrix){for(var M=Kekule.MatrixUtils,rowCount=M.getRowCount(matrix),colCount=M.getColCount(matrix),result=this.create(rowCount,colCount),i=0;i<rowCount;++i)for(var r=result[i],m=matrix[i],j=0;j<colCount;++j)r[j]=-(m[j]||0)},add:function(m1,m2){for(var M=Kekule.MatrixUtils,rowCount=M.getRowCount(m1),colCount=M.getColCount(m1),result=this.create(rowCount,colCount),i=1;i<=rowCount;++i)for(var j=1;j<=colCount;++j)M.setValue(result,i,j,M.getValue(m1,i,j)+M.getValue(m2,i,j));return result},substract:function(m1,m2){var M=Kekule.MatrixUtils;return M.add(m1,M.minus(m2))},multiply:function(m1,m2){for(var M=Kekule.MatrixUtils,rowCount=M.getRowCount(m1),colCount=M.getColCount(m2),result=M.create(rowCount,colCount),i=1;i<=rowCount;++i)for(var j=1;j<=colCount;++j){for(var sum=0,k=1;k<=rowCount;++k)sum+=M.getValue(m1,i,k)*M.getValue(m2,k,j);M.setValue(result,i,j,sum)}return result}},Kekule.CoordUtils={create:function(x,y,z){var result={x:x,y:y};return(z||0===z)&&(result.z=z),result},is3D:function(coord){return coord.z||0===coord.z},isEqual:function(coord1,coord2){var r=coord1.x===coord2.x&&coord1.y===coord2.y,O=Kekule.ObjUtils;return r&&(O.notUnset(coord1.z)||O.notUnset(coord2.z))&&(r=coord1.z===coord2.z),r},isZero:function(coord,allowedError){var error=Kekule.ObjUtils.notUnset(allowedError)?allowedError:0;return Math.abs(coord.x||0)<=error&&Math.abs(coord.y||0)<=error&&Math.abs(coord.z||0)<=error},absValue:function(coord){if(coord){var result={};return Kekule.ObjUtils.isUnset(coord.x)||(result.x=Math.abs(coord.x)),Kekule.ObjUtils.isUnset(coord.y)||(result.y=Math.abs(coord.y)),Kekule.ObjUtils.isUnset(coord.z)||(result.z=Math.abs(coord.z)),result}},add:function(coord1,coord2){var r={};return Kekule.ObjUtils.isUnset(coord1.x)&&Kekule.ObjUtils.isUnset(coord2.x)||(r.x=(coord1.x||0)+(coord2.x||0)),Kekule.ObjUtils.isUnset(coord1.y)&&Kekule.ObjUtils.isUnset(coord2.y)||(r.y=(coord1.y||0)+(coord2.y||0)),Kekule.ObjUtils.isUnset(coord1.z)&&Kekule.ObjUtils.isUnset(coord2.z)||(r.z=(coord1.z||0)+(coord2.z||0)),r},substract:function(coord1,coord2){var r={};return Kekule.ObjUtils.isUnset(coord1.x)&&Kekule.ObjUtils.isUnset(coord2.x)||(r.x=(coord1.x||0)-(coord2.x||0)),Kekule.ObjUtils.isUnset(coord1.y)&&Kekule.ObjUtils.isUnset(coord2.y)||(r.y=(coord1.y||0)-(coord2.y||0)),Kekule.ObjUtils.isUnset(coord1.z)&&Kekule.ObjUtils.isUnset(coord2.z)||(r.z=(coord1.z||0)-(coord2.z||0)),r},multiply:function(coord,value){var r={};return Kekule.ObjUtils.isUnset(coord.x)||(r.x=coord.x*value),Kekule.ObjUtils.isUnset(coord.y)||(r.y=coord.y*value),Kekule.ObjUtils.isUnset(coord.z)||(r.z=coord.z*value),r},divide:function(coord,value){return Kekule.CoordUtils.multiply(coord,1/value)},standardize:function(coord){var len=Math.sqrt(Math.sqr(coord.x||0)+Math.sqr(coord.y||0)+Math.sqr(coord.z||0));return Kekule.CoordUtils.divide(coord,len||1)},toArray:function(coord){var result=[];result.push(coord.x,coord.y),Kekule.CoordUtils.is3D(coord)&&result.push(coord.z)},transform2D:function(coord,options){var matrix=Kekule.CoordUtils.calcTransform2DMatrix(options);return Kekule.CoordUtils.transform2DByMatrix(coord,matrix)},inverseTransform2D:function(coord,options){var matrix=Kekule.CoordUtils.calcInverseTransform2DMatrix(options);return Kekule.CoordUtils.transform2DByMatrix(coord,matrix)},transform2DByMatrix:function(coord,transformMatrix){var M=Kekule.MatrixUtils,coordV=M.create(3,1,[coord.x||0,coord.y||0,1]);return coordV=M.multiply(transformMatrix,coordV),{x:coordV[0][0],y:coordV[1][0]}},calcTransform2DMatrix:function(options,reverseOrder){var M=Kekule.MatrixUtils,op=options||{},center=op.center;if(center)var preMatrix=M.create(3,3,[1,0,-(center.x||0),0,1,-(center.y||0),0,0,1]),postMatrix=M.create(3,3,[1,0,center.x||0,0,1,center.y||0,0,0,1]);if(op.rotateAngle)var a=op.rotateAngle,cosA=Math.cos(a),sinA=Math.sin(a),rotateMatrix=M.create(3,3,[cosA,-sinA,0,sinA,cosA,0,0,0,1]);var scale=op.scale,scaleX=op.scaleX,scaleY=op.scaleY,defScale=scale||1;if(scale||scaleX||scaleY){var scaleMatrix=M.create(3,3);M.setValue(scaleMatrix,1,1,scaleX||defScale),M.setValue(scaleMatrix,2,2,scaleY||defScale),M.setValue(scaleMatrix,3,3,1)}var translateX=op.translateX,translateY=op.translateY;if(translateX||translateY){var translateMatrix=M.create(3,3);M.setValue(translateMatrix,1,1,1),M.setValue(translateMatrix,2,2,1),M.setValue(translateMatrix,3,3,1),M.setValue(translateMatrix,1,3,translateX||0),M.setValue(translateMatrix,2,3,translateY||0)}var transformMatrix=M.create(3,3,[1,0,0,0,1,0,0,0,1]);return reverseOrder?(preMatrix&&(transformMatrix=M.multiply(preMatrix,transformMatrix)),translateMatrix&&(transformMatrix=M.multiply(translateMatrix,transformMatrix)),scaleMatrix&&(transformMatrix=M.multiply(scaleMatrix,transformMatrix)),rotateMatrix&&(transformMatrix=M.multiply(rotateMatrix,transformMatrix)),postMatrix&&(transformMatrix=M.multiply(postMatrix,transformMatrix))):(preMatrix&&(transformMatrix=M.multiply(preMatrix,transformMatrix)),rotateMatrix&&(transformMatrix=M.multiply(rotateMatrix,transformMatrix)),scaleMatrix&&(transformMatrix=M.multiply(scaleMatrix,transformMatrix)),translateMatrix&&(transformMatrix=M.multiply(translateMatrix,transformMatrix)),postMatrix&&(transformMatrix=M.multiply(postMatrix,transformMatrix))),transformMatrix},calcInverseTransform2DMatrix:function(options){var op=Object.create(options);return options.center&&(op.center={x:options.center.x,y:options.center.y}),op.scale&&(op.scale=1/op.scale),op.scaleX&&(op.scaleX=1/op.scaleX),op.scaleY&&(op.scaleY=1/op.scaleY),op.translateX&&(op.translateX=-op.translateX),op.translateY&&(op.translateY=-op.translateY),op.rotateAngle&&(op.rotateAngle=-op.rotateAngle),Kekule.CoordUtils.calcTransform2DMatrix(op,!0)},transform3D:function(coord,options){var matrix=Kekule.CoordUtils.calcTransform3DMatrix(options);return Kekule.CoordUtils.transform3DByMatrix(coord,matrix)},transform3DByMatrix:function(coord,transformMatrix){var M=Kekule.MatrixUtils,coordV=M.create(4,1,[coord.x||0,coord.y||0,coord.z||0,1]);return coordV=M.multiply(transformMatrix,coordV),{x:coordV[0][0],y:coordV[1][0],z:coordV[2][0]}},_calcRotateXYZ3DMatrixCore:function(options){var M=Kekule.MatrixUtils,result=M.create(4,4,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),rotatePairs=[];if(options.rotateAngle&&options.rotateAxisVector){var srotateAxisV=Kekule.CoordUtils.standardize(options.rotateAxisVector);rotatePairs.push({vector:[srotateAxisV.x,srotateAxisV.y,srotateAxisV.z],angle:-options.rotateAngle})}else{var rx=options.rotateX,ry=options.rotateY,rz=options.rotateZ;rx&&rotatePairs.push({vector:[1,0,0],angle:-rx}),ry&&rotatePairs.push({vector:[0,1,0],angle:-ry}),rz&&rotatePairs.push({vector:[0,0,1],angle:-rz})}for(var i=0,l=rotatePairs.length;i<l;++i){for(var v,rotateMatrix=M.create(4,4),angle=rotatePairs[i].angle,rotateVectorArray=rotatePairs[i].vector,cosAngle=Math.cos(angle),sinAngle=Math.sin(angle),i=1;i<=4;++i)for(var j=1;j<=4;++j){if(i<4&&j<4){for(var k=1;k<=3&&(k===i||k===j);++k);var nij=rotateVectorArray[i-1]*rotateVectorArray[j-1];v=i<j?nij*(1-cosAngle)-Math.pow(-1,i+j)*rotateVectorArray[k-1]*sinAngle:i>j?nij*(1-cosAngle)+Math.pow(-1,i+j)*rotateVectorArray[k-1]*sinAngle:nij+(1-nij)*cosAngle}else v=i===j?1:0;M.setValue(rotateMatrix,i,j,v)}result=M.multiply(rotateMatrix,result)}return result},calcRotate3DMatrix:function(options){var rotateMatrix,M=Kekule.MatrixUtils,op=Object.extend({},options||{});if(op.rotateMatrix)rotateMatrix=op.rotateMatrix;else{var center=op.center;if(center)var preMatrix=M.create(4,4,[1,0,0,-(center.x||0),0,1,0,-(center.y||0),0,0,1,-(center.z||0),0,0,0,1]),postMatrix=M.create(4,4,[1,0,0,center.x||0,0,1,0,center.y||0,0,0,1,center.z||0,0,0,0,1]);var rotateMatrix=Kekule.CoordUtils._calcRotateXYZ3DMatrixCore(options);preMatrix&&(rotateMatrix=M.multiply(preMatrix,rotateMatrix)),postMatrix&&(rotateMatrix=M.multiply(postMatrix,rotateMatrix))}return rotateMatrix},calcTransform3DMatrix:function(options){var M=Kekule.MatrixUtils,op=options||{},center=op.center;if(center)var preMatrix=M.create(4,4,[1,0,0,-(center.x||0),0,1,0,-(center.y||0),0,0,1,-(center.z||0),0,0,0,1]),postMatrix=M.create(4,4,[1,0,0,center.x||0,0,1,0,center.y||0,0,0,1,center.z||0,0,0,0,1]);var rotateOptionFields=["rotateX","rotateY","rotateZ","rotateAngle","rotateAxisVector","rotateMatrix"],rotateOptions=Object.copyValues({},op,rotateOptionFields),rotateMatrix=Kekule.CoordUtils.calcRotate3DMatrix(rotateOptions),scale=op.scale,scaleX=op.scaleX,scaleY=op.scaleY,scaleZ=op.scaleZ;if(scale||scaleX||scaleY||scaleZ){var defScale=scale||1,scaleMatrix=M.create(4,4);M.setValue(scaleMatrix,1,1,scaleX||defScale),M.setValue(scaleMatrix,2,2,scaleY||defScale),M.setValue(scaleMatrix,3,3,scaleZ||defScale),M.setValue(scaleMatrix,4,4,1)}var translateX=op.translateX,translateY=op.translateY,translateZ=op.translateZ;if(translateX||translateY||translateZ){var translateMatrix=M.create(4,4);M.setValue(translateMatrix,1,1,1),M.setValue(translateMatrix,2,2,1),M.setValue(translateMatrix,3,3,1),M.setValue(translateMatrix,4,4,1),M.setValue(translateMatrix,1,4,translateX||0),M.setValue(translateMatrix,2,4,translateY||0),M.setValue(translateMatrix,3,4,translateZ||0)}var transformMatrix=M.create(4,4,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);return preMatrix&&(transformMatrix=M.multiply(preMatrix,transformMatrix)),rotateMatrix&&(transformMatrix=M.multiply(rotateMatrix,transformMatrix)),scaleMatrix&&(transformMatrix=M.multiply(scaleMatrix,transformMatrix)),translateMatrix&&(transformMatrix=M.multiply(translateMatrix,transformMatrix)),postMatrix&&(transformMatrix=M.multiply(postMatrix,transformMatrix)),transformMatrix},calcInverseTransform3DMatrix:function(options){var op=Object.create(options);return options.center&&(op.center={x:options.center.x,y:options.center.y,z:options.center.z}),op.scale&&(op.scale=1/op.scale),op.scaleX&&(op.scaleX=1/op.scaleX),op.scaleY&&(op.scaleY=1/op.scaleY),op.scaleZ&&(op.scaleZ=1/op.scaleZ),op.translateX&&(op.translateX=-op.translateX),op.translateY&&(op.translateY=-op.translateY),op.translateZ&&(op.translateZ=-op.translateZ),op.rotateAngle&&(op.rotateAngle=-op.rotateAngle),op.rotateX&&(op.rotateX=-op.rotateX),op.rotateX&&(op.rotateY=-op.rotateY),op.rotateZ&&(op.rotateZ=-op.rotateZ),Kekule.CoordUtils.calcTransform3DMatrix(op,!0)},calcCoordGroup2DTransformParams:function(targetCoord1,targetCoord2,destCoord1,destCoord2){var CU=Kekule.CoordUtils,distanceTarget=CU.getDistance(targetCoord1,targetCoord2),deltaTarget=CU.substract(targetCoord2,targetCoord1),angleTarget=Math.atan2(deltaTarget.y,deltaTarget.x),distanceDest=CU.getDistance(destCoord1,destCoord2),deltaDest=CU.substract(destCoord2,destCoord1),angleDest=Math.atan2(deltaDest.y,deltaDest.x),coordDelta=CU.substract(destCoord1,targetCoord1);return{translateX:coordDelta.x,translateY:coordDelta.y,scale:distanceDest/distanceTarget,rotateAngle:angleDest-angleTarget,center:targetCoord1}},getDistance:function(coord1,coord2){coord2||(coord2={x:0,y:0,z:0});var l=Math.sqr(coord2.x-coord1.x)+Math.sqr(coord2.y-coord1.y);return Kekule.ObjUtils.notUnset(coord1.z)&&Kekule.ObjUtils.notUnset(coord2.z)&&(l+=Math.sqr(coord2.z-coord1.z)),Math.sqrt(l)},getCenter:function(coords){var length=coords.length;if(length<=0)return null;for(var sum=Object.extend(coords[0]),i=1;i<length;++i)sum=Kekule.CoordUtils.add(sum,coords[i]);return Kekule.CoordUtils.divide(sum,length)},insideRect:function(coord,rectCoord1,rectCoord2){return(coord.x-rectCoord1.x)*(coord.x-rectCoord2.x)<=0&&(coord.y-rectCoord1.y)*(coord.y-rectCoord2.y)<=0},isInsideBox:function(coord,box){var b=box,result=Math.sign(coord.x-b.x1)*Math.sign(coord.x-b.x2)<=0&&Math.sign(coord.y-b.y1)*Math.sign(coord.y-b.y2)<=0;return Kekule.ObjUtils.notUnset(coord.z)&&(result=result&&Math.sign(coord.z-b.z1)*Math.sign(coord.z-b.z2)<=0),result},getContainerBox:function(coords){var minCoord={},maxCoord={},l=coords.length;if(!(l>0))return null;minCoord=Object.extend({},coords[0]),maxCoord=Object.extend({},coords[0]);for(var i=1;i<l;++i){var coord=coords[i];minCoord.x=Math.min(minCoord.x,coord.x),minCoord.y=Math.min(minCoord.y,coord.y),maxCoord.x=Math.max(maxCoord.x,coord.x),maxCoord.y=Math.max(maxCoord.y,coord.y),Kekule.ObjUtils.notUnset(minCoord.z)&&(minCoord.z=Math.min(minCoord.z,coord.z),maxCoord.z=Math.max(maxCoord.z,coord.z))}return Kekule.BoxUtils.createBox(minCoord,maxCoord)}},Kekule.GeometryUtils={getVectorScalarProduct:function(coord1,coord2){return(coord1.x||0)*(coord2.x||0)+(coord1.y||0)*(coord2.y||0)+(coord1.z||0)*(coord2.z||0)},getVectorCrossProduct:function(coord1,coord2){return{x:(coord1.y||0)*(coord2.z||0)-(coord1.z||0)*(coord2.y||0),y:(coord1.z||0)*(coord2.x||0)-(coord1.x||0)*(coord2.z||0),z:(coord1.x||0)*(coord2.y||0)-(coord1.y||0)*(coord2.x||0)}},getVectorIncludedAngle:function(coord1,coord2){var CU=Kekule.CoordUtils,cross=Kekule.GeometryUtils.getVectorCrossProduct(coord1,coord2),zeroCoord={x:0,y:0,z:0},divV=CU.getDistance(coord1,zeroCoord)*CU.getDistance(coord2,zeroCoord),sinAngleV=CU.getDistance(cross,zeroCoord)/divV;return Math.asin(sinAngleV)},getDihedralAngleOfVectors:function(v1,v2,v3){var CU=Kekule.CoordUtils,GU=Kekule.GeometryUtils,v1Xv2=GU.getVectorCrossProduct(v1,v2),v2Xv3=GU.getVectorCrossProduct(v2,v3),error=CU.getDistance(v2)/1e5;if(CU.isZero(v1Xv2,error)||CU.isZero(v2Xv3,error))return-1;var d=CU.standardize(v2),y=GU.getVectorScalarProduct(GU.getVectorCrossProduct(v1Xv2,v2Xv3),d),x=GU.getVectorScalarProduct(v1Xv2,v2Xv3),result=Math.atan2(y,x);return result<0&&(result+=2*Math.PI),result},getDihedralAngleOfPoints:function(c1,c2,c3,c4){var CU=Kekule.CoordUtils,v1=CU.substract(c2,c1),v2=CU.substract(c3,c2),v3=CU.substract(c4,c3);return Kekule.GeometryUtils.getDihedralAngleOfVectors(v1,v2,v3)}},Kekule.BoxUtils={createBox:function(coord1,coord2){var result={},x1=coord1.x||0,y1=coord1.y||0,x2=coord2.x||0,y2=coord2.y||0;return x1<=x2?(result.x1=x1,result.x2=x2):(result.x1=x2,result.x2=x1),y1<=y2?(result.y1=y1,result.y2=y2):(result.y1=y2,result.y2=y1),Kekule.ObjUtils.notUnset(coord1.z)&&Kekule.ObjUtils.notUnset(coord2.z)&&(coord1.z<=coord2.z?(result.z1=coord1.z,result.z2=coord2.z):(result.z1=coord2.z,result.z2=coord1.z)),result},convertToRect:function(box){var b=Kekule.BoxUtils.normalize(box);return Kekule.RectUtils.createRect(b.x1,b.y1,b.x2-b.x1,b.y2-b.y1)},normalize:function(box){var result={x1:Math.min(box.x1,box.x2),y1:Math.min(box.y1,box.y2),x2:Math.max(box.x1,box.x2),y2:Math.max(box.y1,box.y2)};return Kekule.ObjUtils.notUnset(box.z1)&&Kekule.ObjUtils.notUnset(box.z2)&&(result.z1=Math.min(box.z1,box.z2),result.z2=Math.max(box.z1,box.z2)),result},shiftBox:function(box,deltaX,deltaY,deltaZ){var dx=deltaX||0,dy=deltaY||0,dz=deltaZ||0,coord1={x:box.x1+dx,y:box.y1+dy},coord2={x:box.x2+dx,y:box.y2+dy};return Kekule.ObjUtils.notUnset(box.z1)&&Kekule.ObjUtils.notUnset(box.z2)&&(coord1.z=box.z1+dz,coord2.z=box.z2+dz),Kekule.BoxUtils.createBox(coord1,coord2)},inflateBox:function(box,inflationX,inflationY,inflationZ){Kekule.ObjUtils.isUnset(inflationY)&&(inflationY=inflationX),Kekule.ObjUtils.isUnset(inflationZ)&&(inflationZ=inflationX);var result=Kekule.BoxUtils.normalize(box),result={x1:result.x1-inflationX,y1:result.y1-inflationY,x2:result.x2+inflationX,y2:result.y2+inflationY};return Kekule.ObjUtils.notUnset(result.z1)&&Kekule.ObjUtils.notUnset(result.z2)&&(result.z1=result.z1-inflationZ,result.z2=result.z2+inflationZ),result},getContainerBox:function(box1,box2){if(!box1)return Object.extend({},box2);if(!box2)return Object.extend({},box1);var b1=Kekule.BoxUtils.normalize(box1),b2=Kekule.BoxUtils.normalize(box2),result={x1:Math.min(b1.x1,b2.x1),y1:Math.min(b1.y1,b2.y1),x2:Math.max(b1.x2,b2.x2),y2:Math.max(b1.y2,b2.y2)};return Kekule.ObjUtils.notUnset(b1.z1)&&Kekule.ObjUtils.notUnset(b1.z2)&&Kekule.ObjUtils.notUnset(b2.z1)&&Kekule.ObjUtils.notUnset(b2.z2)&&(result.z1=Math.min(b1.z1,b2.z1),result.z2=Math.max(b1.z2,b2.z2)),result},getIntersection:function(box1,box2){var b1=Kekule.BoxUtils.normalize(box1),b2=Kekule.BoxUtils.normalize(box2),r={x1:Math.max(b1.x1,b2.x1),y1:Math.max(b1.y1,b2.y1),x2:Math.min(b1.x2,b2.x2),y2:Math.max(b1.y2,b2.y2)};return r.x1>=r.x2||r.y1>=r.y2?null:Kekule.ObjUtils.notUnset(b1.z1)&&Kekule.ObjUtils.notUnset(b1.z2)&&Kekule.ObjUtils.notUnset(b2.z1)&&Kekule.ObjUtils.notUnset(b2.z2)&&(r.z1=Math.max(b1.z1,b2.z1),r.z2=Math.min(b1.z2,b2.z2),r.z1>=r.z2)?null:r},hasIntersection:function(box1,box2){return!!Kekule.BoxUtils.getIntersection(box1,box2)},isEqual:function(b1,b2){return Math.min(b1.x1,b1.x2)===Math.min(b2.x1,b2.x2)&&Math.max(b1.x1,b1.x2)===Math.max(b2.x1,b2.x2)&&Math.min(b1.y1,b1.y2)===Math.min(b2.y1,b2.y2)&&Math.max(b1.y1,b1.y2)===Math.max(b2.y1,b2.y2)},isInside:function(innerBox,outerBox){var b1=innerBox,b2=outerBox;return Math.min(b1.x1,b1.x2)>=Math.min(b2.x1,b2.x2)&&Math.max(b1.x1,b1.x2)<=Math.max(b2.x1,b2.x2)&&Math.min(b1.y1,b1.y2)>=Math.min(b2.y1,b2.y2)&&Math.max(b1.y1,b1.y2)<=Math.max(b2.y1,b2.y2)},getCenterCoord:function(box){var result={x:(box.x1||0+box.x2||0)/2,y:(box.y1||0+box.y2||0)/2};return(Kekule.ObjUtils.notUnset(box.z1)||Kekule.ObjUtils.notUnset(box.z2))&&(result.z=(box.z1||0+box.z2||0)/2),result},getMinMaxCoords:function(box){var b=Kekule.BoxUtils.normalize(box),result={min:{x:b.x1,y:b.y1},max:{x:b.x2,y:b.y2}};return Kekule.ObjUtils.notUnset(b.z1)&&(result.min.z=b.z1,result.max.z=b.z2),result},getCornerCoords:function(box){var b=Kekule.BoxUtils.normalize(box);return Kekule.ObjUtils.isUnset(b.z1)?[{x:b.x1,y:b.y1},{x:b.x1,y:b.y2},{x:b.x2,y:b.y1},{x:b.x2,y:b.y2}]:[{x:b.x1,y:b.y1,z:b.z1},{x:b.x1,y:b.y2,z:b.z1},{x:b.x2,y:b.y1,z:b.z1},{x:b.x2,y:b.y2,z:b.z1},{x:b.x1,y:b.y1,z:b.z2},{x:b.x1,y:b.y2,z:b.z2},{x:b.x2,y:b.y1,z:b.z2},{x:b.x2,y:b.y2,z:b.z2}]},transform2D:function(box,options){for(var coords=Kekule.BoxUtils.getCornerCoords(box),transformedCoords=[],i=0,l=coords.length;i<l;++i)transformedCoords.push(Kekule.CoordUtils.transform2D(coords[i],options));return Kekule.CoordUtils.getContainerBox(transformedCoords)},transform3D:function(box,options){for(var coords=Kekule.BoxUtils.getCornerCoords(box),transformedCoords=[],i=0,l=coords.length;i<l;++i)transformedCoords.push(Kekule.CoordUtils.transform3D(coords[i],options));return Kekule.CoordUtils.getContainerBox(transformedCoords)}},Kekule.RectUtils={createRect:function(left,top,width,height){return{left:left,top:top,width:width,height:height}},isZero:function(rect){return 0===rect.width&&0===rect.height},convertToBox:function(rect){var coord1=Kekule.CoordUtils.create(rect.left,rect.top),coord2=Kekule.CoordUtils.create(rect.left+rect.width,rect.top+rect.height);return Kekule.BoxUtils.createBox(coord1,coord2)},inflateRect:function(rect,inflateX,inflateY){return Kekule.ObjUtils.isUnset(inflateY)&&(inflateY=inflateX),Kekule.RectUtils.createRect(rect.left,rect.top,rect.width+inflateX,rect.height+inflateY)},shiftRect:function(rect,deltaX,deltaY){var dx=deltaX||0,dy=deltaY||0;return Kekule.RectUtils.createRect(rect.left+dx,rect.top+dy,rect.width,rect.height)},getContainerRect:function(rect1,rect2){var b1=Kekule.RectUtils.convertToBox(rect1),b2=Kekule.RectUtils.convertToBox(rect2),b3=Kekule.BoxUtils.getContainerBox(b1,b2);return Kekule.BoxUtils.convertToRect(b3)},getIntersection:function(rect1,rect2){var b1=Kekule.RectUtils.convertToBox(rect1),b2=Kekule.RectUtils.convertToBox(rect2),b3=Kekule.BoxUtils.getIntersection(b1,b2);return b3?Kekule.BoxUtils.convertToRect(b3):null},hasIntersection:function(rect1,rect2){return!!Kekule.RectUtils.getIntersection(rect1,rect2)}},Kekule.ZoomUtils={PREDEFINED_ZOOM_RATIOS:[.1,.3,.5,.66,.8,.9,1,1.1,1.25,1.5,1.75,2,2.5,3,4,5,7,10,15,20],getNextZoomInRatio:function(currRatio,step){step||(step=1);var rs=Kekule.ZoomUtils.PREDEFINED_ZOOM_RATIOS,len=rs.length;if(currRatio<rs[len-1])for(var i=0;i<len;++i)if(rs[i]>currRatio)return rs[Math.min(i+step,len)-1];return currRatio},getNextZoomOutRatio:function(currRatio,step){step||(step=1);var rs=Kekule.ZoomUtils.PREDEFINED_ZOOM_RATIOS,len=rs.length;if(currRatio>rs[0])for(var i=len-1;i>=0;--i)if(rs[i]<currRatio)return rs[Math.max(i-step+1,0)];return currRatio}},Kekule}},function(module,exports,__webpack_require__){"use strict";module.exports=function(Kekule){return Kekule.chemicalElementsData=__webpack_require__(14),Kekule.isotopesData=__webpack_require__(15),Kekule.structGenAtomTypesData=__webpack_require__(16),Kekule.ChemicalElementsDataUtil={_getElementInfoBySymbol:function(symbol){for(var result,i=0,l=Kekule.chemicalElementsData.length;i<l;++i)if((result=Kekule.chemicalElementsData[i])&&result.symbol==symbol)return result;return null},_getElementInfoByAtomicNumber:function(atomicNumber){var result=Kekule.chemicalElementsData[atomicNumber-1];if(result&&result.atomicNumber==atomicNumber)return result;if(!result||result.atomicNumber<atomicNumber){for(var i=atomicNumber,l=Kekule.chemicalElementsData.length;i<l;++i)if((result=Kekule.chemicalElementsData[i])&&result.atomicNumber==atomicNumber)return result;for(var i=atomicNumber-2;i>=0;--i)if((result=Kekule.chemicalElementsData[i])&&result.atomicNumber==atomicNumber)return result}else{for(var i=atomicNumber-2;i>=0;--i)if((result=Kekule.chemicalElementsData[i])&&result.atomicNumber==atomicNumber)return result;for(var i=atomicNumber,l=Kekule.chemicalElementsData.length;i<l;++i)if((result=Kekule.chemicalElementsData[i])&&result.atomicNumber==atomicNumber)return result}return null},getElementInfo:function(symbolOrAtomicNumber){return"number"==typeof symbolOrAtomicNumber?Kekule.ChemicalElementsDataUtil._getElementInfoByAtomicNumber(symbolOrAtomicNumber):Kekule.ChemicalElementsDataUtil._getElementInfoBySymbol(symbolOrAtomicNumber)},getElementProp:function(symbolOrAtomicNumber,propName){var info=Kekule.ChemicalElementsDataUtil.getElementInfo(symbolOrAtomicNumber);return info?info[propName]:null},getAtomicNumber:function(symbol){var info=Kekule.ChemicalElementsDataUtil._getElementInfoBySymbol(symbol);return info?info.atomicNumber:0},getElementSymbol:function(atomicNumber){var info=Kekule.ChemicalElementsDataUtil._getElementInfoByAtomicNumber(atomicNumber);return info?info.symbol:null},isAtomicNumberAvailable:function(atomicNumber){return!!Kekule.ChemicalElementsDataUtil._getElementInfoByAtomicNumber(atomicNumber)},isElementSymbolAvailable:function(symbol){return Kekule.ChemicalElementsDataUtil.getAtomicNumber(symbol)>0}},Kekule.IsotopeAliasUtil={enableAlias:!0,ALIAS:[{alias:"D",atomicNumber:1,massNumber:2}],getAllAlias:function(){return Kekule.IsotopeAliasUtil.enableAlias?Kekule.IsotopeAliasUtil.ALIAS:[]},getAliasInfo:function(alias){for(var as=Kekule.IsotopeAliasUtil.getAllAlias(),i=0,l=as.length;i<l;++i){var a=as[i];if(a.alias===alias)return Object.extend(Kekule.IsotopesDataUtil.getIsotopeInfo(a.atomicNumber,a.massNumber),{isotopeAlias:alias})}return null},getAlias:function(atomicNumber,massNumber){for(var as=Kekule.IsotopeAliasUtil.getAllAlias(),i=0,l=as.length;i<l;++i){var a=as[i];if(a.atomicNumber===atomicNumber&&a.massNumber===massNumber)return a.alias}return null}},Kekule.IsotopesDataUtil={getAllIsotopeInfos:function(symbolOrAtomicNumber){var atomicNumber;atomicNumber="number"==typeof symbolOrAtomicNumber?symbolOrAtomicNumber:Kekule.ChemicalElementsDataUtil.getAtomicNumber(symbolOrAtomicNumber);var element=Kekule.isotopesData[atomicNumber-1];if(!element||element.atomicNumber!=atomicNumber)for(var i=0,l=Kekule.isotopesData.length;i<l;++i){var element=Kekule.isotopesData[i];if(element&&element.atomicNumber==atomicNumber)break}return element?element.isotopes:null},getIsotopeInfo:function(symbolOrAtomicNumber,massNumber){var result=null;if(!massNumber&&"string"==typeof symbolOrAtomicNumber&&(result=Kekule.IsotopeAliasUtil.getAliasInfo(symbolOrAtomicNumber)))return result;var isotopes=Kekule.IsotopesDataUtil.getAllIsotopeInfos(symbolOrAtomicNumber);if(isotopes){if(massNumber)for(var j=0,k=isotopes.length;j<k&&(!(result=isotopes[j])||result.massNumber!=massNumber);++j);else 1===isotopes.length&&(result=isotopes[0]);if(result)return result}return null},getIsotopeInfoById:function(isotopeId){var detail=Kekule.IsotopesDataUtil.getIsotopeIdDetail(isotopeId);return Kekule.IsotopesDataUtil.getIsotopeInfo(detail.symbol,detail.massNumber)},isMassNumberAvailable:function(symbolOrAtomicNumber,massNumber){return!!Kekule.IsotopesDataUtil.getIsotopeInfo(symbolOrAtomicNumber,massNumber)},getIsotopeId:function(symbolOrAtomicNumber,massNumber){if("string"!=typeof symbolOrAtomicNumber||massNumber){var alias=Kekule.IsotopeAliasUtil.getAlias(symbolOrAtomicNumber,massNumber);if(alias)return alias}else{if(Kekule.IsotopeAliasUtil.getAliasInfo(symbolOrAtomicNumber))return symbolOrAtomicNumber}var elemInfo=Kekule.ChemicalElementsDataUtil.getElementInfo(symbolOrAtomicNumber);if(!elemInfo)return null;var symbol=elemInfo.symbol;return massNumber?symbol+massNumber.toString():symbol},getIsotopeIdDetail:function(id){if(!id)return null;for(var symbol="",massNumStr="",i=0,l=id.length;i<l;++i){var c=id.charAt(i);c>="0"&&c<="9"?massNumStr+=c:symbol+=c}var massNum=massNumStr?parseInt(massNumStr,10):null,r={symbol:symbol};return massNum&&(r.massNumber=massNum),r},isIsotopeIdAvailable:function(id){var d=Kekule.IsotopesDataUtil.getIsotopeIdDetail(id);if(Kekule.IsotopeAliasUtil.getAliasInfo(id))return!0;var result=Kekule.ChemicalElementsDataUtil.isElementSymbolAvailable(d.symbol);if(result&&d.massNum){result=!!Kekule.IsotopesDataUtil.getIsotopeInfo(d.symbol,d.massNum)}return result}},Kekule.AtomTypeDataUtil={getAtomTypeInfoObj:function(symbolOrAtomicNumber){var atomicNumber;atomicNumber="number"==typeof symbolOrAtomicNumber?symbolOrAtomicNumber:Kekule.ChemicalElementsDataUtil.getAtomicNumber(symbolOrAtomicNumber);var result=Kekule.structGenAtomTypesData[atomicNumber-1];if(result&&result.atomicNumber==atomicNumber)return result;for(var i=0,l=Kekule.structGenAtomTypesData.length;i<l;++i)if((result=Kekule.structGenAtomTypesData[i])&&result.atomicNumber==atomicNumber)return result;return null},getAllAtomTypes:function(symbolOrAtomicNumber){var info=Kekule.AtomTypeDataUtil.getAtomTypeInfoObj(symbolOrAtomicNumber);return info?info.atomTypes:null},getAtomTypeFromId:function(symbolOrAtomicNumber,id){if(!symbolOrAtomicNumber){for(var s="",i=0,l=id.length;i<l;++i){var c=id.chatAt(i);(c<"0"||c>"9")&&(s+=c)}symbolOrAtomicNumber=s}if(symbolOrAtomicNumber)for(var types=Kekule.AtomTypeDataUtil.getAllAtomTypes(symbolOrAtomicNumber),i=0,l=types.length;i<l;++i)if(types[i].id==id)return types[i];return null}},Kekule}},function(module,exports,__webpack_require__){"use strict";var chemicalElementsData=[{symbol:"H",casId:"1333-74-0",group:1,period:1,name:"Hydrogen",atomicNumber:1,chemicalSerie:"Nonmetals",phase:"Gas",radiiCova:.37,radiiVdw:1.2,paulingE:2.2,naturalMass:1.00794075382579},{symbol:"He",casId:"7440-59-7",group:18,period:1,name:"Helium",atomicNumber:2,chemicalSerie:"Noble Gasses",phase:"Gas",radiiCova:.32,radiiVdw:1.4,naturalMass:4.002601902393709},{symbol:"Li",casId:"7439-93-2",group:1,period:2,name:"Lithium",atomicNumber:3,chemicalSerie:"Alkali Metals",phase:"Solid",radiiCova:.32,radiiVdw:2.2,paulingE:.98,naturalMass:6.9400376247955},{symbol:"Be",casId:"7440-41-7",group:2,period:2,name:"Beryllium",atomicNumber:4,chemicalSerie:"Alkali Earth Metals",phase:"Solid",radiiCova:.9,radiiVdw:1.9,paulingE:1.57,naturalMass:9.0121822},{symbol:"B",casId:"7440-42-8",group:13,period:2,name:"Boron",atomicNumber:5,chemicalSerie:"Metalloids",phase:"Solid",radiiCova:.82,radiiVdw:1.8,paulingE:2.04,naturalMass:10.811028088400002},{symbol:"C",casId:"7440-44-0",group:14,period:2,name:"Carbon",atomicNumber:6,chemicalSerie:"Nonmetals",phase:"Solid",radiiCova:.77,radiiVdw:1.7,paulingE:2.55,naturalMass:12.010735896788},{symbol:"N",casId:"7727-37-9",group:15,period:2,name:"Nitrogen",atomicNumber:7,chemicalSerie:"Nonmetals",phase:"Gas",radiiCova:.77,radiiVdw:1.6,paulingE:3.04,naturalMass:14.006743088432001},{symbol:"O",casId:"7782-44-7",group:16,period:2,name:"Oxygen",atomicNumber:8,chemicalSerie:"Nonmetals",phase:"Gas",radiiCova:.73,radiiVdw:1.55,paulingE:3.44,naturalMass:15.999404927569397},{symbol:"F",casId:"7782-41-4",group:17,period:2,name:"Fluorine",atomicNumber:9,chemicalSerie:"Halogens",phase:"Gas",radiiCova:.73,radiiVdw:1.5,paulingE:3.98,naturalMass:18.99840322},{symbol:"Ne",casId:"7440-01-9",group:18,period:2,name:"Neon",atomicNumber:10,chemicalSerie:"Noble Gasses",phase:"Gas",radiiCova:.69,radiiVdw:1.54,naturalMass:20.180046383574997},{symbol:"Na",casId:"7440-23-5",group:1,period:3,name:"Sodium",atomicNumber:11,chemicalSerie:"Alkali Metals",phase:"Solid",radiiCova:1.54,radiiVdw:2.4,paulingE:.93,naturalMass:22.98976928},{symbol:"Mg",casId:"7439-95-4",group:2,period:3,name:"Magnesium",atomicNumber:12,chemicalSerie:"Alkali Earth Metals",phase:"Solid",radiiCova:1.3,radiiVdw:2.2,paulingE:1.31,naturalMass:24.305051612423004},{symbol:"Al",casId:"7429-90-5",group:13,period:3,name:"Aluminum",atomicNumber:13,chemicalSerie:"Metals",phase:"Solid",radiiCova:1.18,radiiVdw:2.1,paulingE:1.61,naturalMass:26.98153863},{symbol:"Si",casId:"7440-21-3",group:14,period:3,name:"Silicon",atomicNumber:14,chemicalSerie:"Metalloids",phase:"Solid",radiiCova:1.11,radiiVdw:2.1,paulingE:1.9,naturalMass:28.085384754933294},{symbol:"P",casId:"7723-14-0",group:15,period:3,name:"Phosphorus",atomicNumber:15,chemicalSerie:"Nonmetals",phase:"Solid",radiiCova:1.06,radiiVdw:1.95,paulingE:2.19,naturalMass:30.97376163},{symbol:"S",casId:"7704-34-9",group:16,period:3,name:"Sulfur",atomicNumber:16,chemicalSerie:"Nonmetals",phase:"Solid",radiiCova:1.02,radiiVdw:1.8,paulingE:2.58,naturalMass:32.066084993038},{symbol:"Cl",casId:"7782-50-5",group:17,period:3,name:"Chlorine",atomicNumber:17,chemicalSerie:"Halogens",phase:"Gas",radiiCova:.99,radiiVdw:1.8,paulingE:3.16,naturalMass:35.452538168202},{symbol:"Ar",casId:"7440-37-1",group:18,period:3,name:"Argon",atomicNumber:18,chemicalSerie:"Noble Gasses",phase:"Gas",radiiCova:.97,radiiVdw:1.8,naturalMass:39.947676710841314},{symbol:"K",casId:"7440-09-7",group:1,period:4,name:"Potassium",atomicNumber:19,chemicalSerie:"Alkali Metals",phase:"Solid",radiiCova:1.96,radiiVdw:2.8,paulingE:.82,naturalMass:39.09830112446276},{symbol:"Ca",casId:"7440-70-2",group:2,period:4,name:"Calcium",atomicNumber:20,chemicalSerie:"Alkali Earth Metals",phase:"Solid",radiiCova:1.74,radiiVdw:2.4,paulingE:1,naturalMass:40.078022651988505},{symbol:"Sc",casId:"7440-20-2",group:3,period:4,name:"Scandium",atomicNumber:21,chemicalSerie:"Transition metals",phase:"Solid",radiiCova:1.44,radiiVdw:2.3,paulingE:1.36,naturalMass:44.9559119},{symbol:"Ti",casId:"7440-32-6",group:4,period:4,name:"Titanium",atomicNumber:22,chemicalSerie:"Transition metals",phase:"Solid",radiiCova:1.44,radiiVdw:2.15,paulingE:1.54,naturalMass:47.866749245159994},{symbol:"V",casId:"7440-62-2",group:5,period:4,name:"Vanadium",atomicNumber:23,chemicalSerie:"Transition metals",phase:"Solid",radiiCova:1.25,radiiVdw:2.05,paulingE:1.63,naturalMass:50.94146749750001},{symbol:"Cr",casId:"7440-47-3",group:6,period:4,name:"Chromium",atomicNumber:24,chemicalSerie:"Transition metals",phase:"Solid",radiiCova:1.27,radiiVdw:2.05,paulingE:1.66,naturalMass:51.996133070619},{symbol:"Mn",casId:"7439-96-5",group:7,period:4,name:"Manganese",atomicNumber:25,chemicalSerie:"Transition metals",phase:"Solid",radiiCova:1.39,radiiVdw:2.05,paulingE:1.55,naturalMass:54.9380451},{symbol:"Fe",casId:"7439-89-6",group:8,period:4,name:"Iron",atomicNumber:26,chemicalSerie:"Transition metals",phase:"Solid",radiiCova:1.25,radiiVdw:2.05,paulingE:1.83,naturalMass:55.845145623527},{symbol:"Co",casId:"7440-48-4",group:9,period:4,name:"Cobalt",atomicNumber:27,chemicalSerie:"Transition metals",phase:"Solid",radiiCova:1.26,radiiVdw:2,paulingE:1.88,naturalMass:58.933195},{symbol:"Ni",casId:"7440-02-0",group:10,period:4,name:"Nickel",atomicNumber:28,chemicalSerie:"Transition metals",phase:"Solid",radiiCova:1.21,radiiVdw:2,paulingE:1.91,naturalMass:58.693351562447994},{symbol:"Cu",casId:"7440-50-8",group:11,period:4,name:"Copper",atomicNumber:29,chemicalSerie:"Transition metals",phase:"Solid",radiiCova:1.38,radiiVdw:2,paulingE:1.9,naturalMass:63.5456400936},{symbol:"Zn",casId:"7440-66-6",group:12,period:4,name:"Zinc",atomicNumber:30,chemicalSerie:"Transition metals",phase:"Solid",radiiCova:1.31,radiiVdw:2.1,paulingE:1.65,naturalMass:65.39556265691999},{symbol:"Ga",casId:"7440-55-3",group:13,period:4,name:"Gallium",atomicNumber:31,chemicalSerie:"Metals",phase:"Solid",radiiVdw:2.1,paulingE:1.81,naturalMass:69.723065622084},{symbol:"Ge",casId:"7440-56-4",group:14,period:4,name:"Germanium",atomicNumber:32,chemicalSerie:"Metalloids",phase:"Solid",radiiCova:1.22,radiiVdw:2.1,paulingE:2.01,naturalMass:72.61275825015},{symbol:"As",casId:"7440-38-2",group:15,period:4,name:"Arsenic",atomicNumber:33,chemicalSerie:"Metalloids",phase:"Solid",radiiCova:1.19,radiiVdw:2.05,paulingE:2.18,naturalMass:74.9215965},{symbol:"Se",casId:"7782-49-2",group:16,period:4,name:"Selenium",atomicNumber:34,chemicalSerie:"Nonmetals",phase:"Solid",radiiCova:1.16,radiiVdw:1.9,paulingE:2.55,naturalMass:78.9593882401},{symbol:"Br",casId:"7726-95-6",group:17,period:4,name:"Bromine",atomicNumber:35,chemicalSerie:"Halogens",phase:"Liquid",radiiCova:1.14,radiiVdw:1.9,paulingE:2.96,naturalMass:79.90352797085},{symbol:"Kr",casId:"7439-90-9",group:18,period:4,name:"Krypton",atomicNumber:36,chemicalSerie:"Noble Gasses",phase:"Gas",radiiCova:1.1,radiiVdw:2.02,paulingE:3,naturalMass:83.79932499157},{symbol:"Rb",casId:"7440-17-7",group:1,period:5,name:"Rubidium",atomicNumber:37,chemicalSerie:"Alkali Metals",phase:"Solid",radiiCova:2.11,radiiVdw:2.9,paulingE:.82,naturalMass:85.46766359685701},{symbol:"Sr",casId:"7440-24-6",group:2,period:5,name:"Strontium",atomicNumber:38,chemicalSerie:"Alkali Earth Metals",phase:"Solid",radiiCova:1.92,radiiVdw:2.55,paulingE:.95,naturalMass:87.61664410489999},{symbol:"Y",casId:"7440-65-5",group:3,period:5,name:"Yttrium",atomicNumber:39,chemicalSerie:"Transition metals",phase:"Solid",naturalMass:88.9058483},{symbol:"Zr",casId:"7440-67-7",group:4,period:5,name:"Zirconium",atomicNumber:40,chemicalSerie:"Transition metals",phase:"Solid",radiiCova:1.48,radiiVdw:2.3,naturalMass:91.22364760672002},{symbol:"Nb",casId:"7440-03-1",group:5,period:5,name:"Niobium",atomicNumber:41,chemicalSerie:"Transition metals",phase:"Solid",radiiCova:1.37,radiiVdw:2.15,naturalMass:92.9063781},{symbol:"Mo",casId:"7439-98-7",group:6,period:5,name:"Molybdenum",atomicNumber:42,chemicalSerie:"Transition metals",phase:"Solid",radiiCova:1.45,radiiVdw:2.1,naturalMass:95.93129211008},{symbol:"Tc",casId:"7440-26-8",group:7,period:5,name:"Technetium",atomicNumber:43,chemicalSerie:"Transition metals",phase:"Synthetic",radiiCova:1.56,radiiVdw:2.05},{symbol:"Ru",casId:"7440-18-8",group:8,period:5,name:"Ruthenium",atomicNumber:44,chemicalSerie:"Transition metals",phase:"Solid",radiiCova:1.26,radiiVdw:2.05,naturalMass:101.06494544279},{symbol:"Rh",casId:"7440-16-6",group:9,period:5,name:"Rhodium",atomicNumber:45,chemicalSerie:"Transition metals",phase:"Solid",radiiCova:1.35,radiiVdw:2,naturalMass:102.905504},{symbol:"Pd",casId:"7440-05-3",group:10,period:5,name:"Palladium",atomicNumber:46,chemicalSerie:"Transition metals",phase:"Solid",radiiCova:1.31,radiiVdw:2.05,naturalMass:106.41532878129999},{symbol:"Ag",casId:"7440-22-4",group:11,period:5,name:"Silver",atomicNumber:47,chemicalSerie:"Transition metals",phase:"Solid",radiiCova:1.53,radiiVdw:2.1,naturalMass:107.86815084455},{symbol:"Cd",casId:"7440-43-9",group:12,period:5,name:"Cadmium",atomicNumber:48,chemicalSerie:"Transition metals",phase:"Solid",radiiCova:1.48,radiiVdw:2.2,naturalMass:112.41155220052002},{symbol:"In",casId:"7440-74-6",group:13,period:5,name:"Indium",atomicNumber:49,chemicalSerie:"Metals",phase:"Solid",radiiVdw:2.25,naturalMass:114.818085722},{symbol:"Sn",casId:"7440-31-5",group:14,period:5,name:"Tin",atomicNumber:50,chemicalSerie:"Metals",phase:"Solid",radiiCova:1.41,radiiVdw:2.25,naturalMass:118.71010831537001},{symbol:"Sb",casId:"7440-36-0",group:15,period:5,name:"Antimony",atomicNumber:51,chemicalSerie:"Metalloids",phase:"Solid",radiiCova:1.38,radiiVdw:2.2,naturalMass:121.75978613257},{symbol:"Te",casId:"13494-80-9",group:16,period:5,name:"Tellurium",atomicNumber:52,chemicalSerie:"Metalloids",phase:"Solid",radiiCova:1.35,radiiVdw:2.1,naturalMass:127.60312784714},{symbol:"I",casId:"7553-56-2",group:17,period:5,name:"Iodine",atomicNumber:53,chemicalSerie:"Halogens",phase:"Solid",radiiCova:1.33,radiiVdw:2.1,naturalMass:126.904473},{symbol:"Xe",casId:"7440-63-3",group:18,period:5,name:"Xenon",atomicNumber:54,chemicalSerie:"Noble Gasses",phase:"Gas",radiiCova:1.3,radiiVdw:2.16,naturalMass:131.29248059059},{symbol:"Cs",casId:"7440-46-2",group:1,period:6,name:"Cesium",atomicNumber:55,chemicalSerie:"Alkali Metals",phase:"Solid",radiiCova:2.25,radiiVdw:3,naturalMass:132.9054519},{symbol:"Ba",casId:"7440-39-3",group:2,period:6,name:"Barium",atomicNumber:56,chemicalSerie:"Alkali Earth Metals",phase:"Solid",radiiCova:1.98,radiiVdw:2.7,naturalMass:137.32689183471098},{symbol:"La",casId:"7439-91-0",group:3,period:6,name:"Lanthanum",atomicNumber:57,chemicalSerie:"Lanthanides",phase:"Solid",radiiCova:1.69,radiiVdw:2.5,naturalMass:138.90545398283},{symbol:"Ce",casId:"7440-45-1",period:6,name:"Cerium",atomicNumber:58,chemicalSerie:"Lanthanides",phase:"Solid",radiiVdw:2.48,naturalMass:140.11572621392},{symbol:"Pr",casId:"7440-10-0",period:6,name:"Praseodymium",atomicNumber:59,chemicalSerie:"Lanthanides",phase:"Solid",radiiVdw:2.47,naturalMass:140.9076528},{symbol:"Nd",casId:"7440-00-8",period:6,name:"Neodymium",atomicNumber:60,chemicalSerie:"Lanthanides",phase:"Solid",radiiVdw:2.47,naturalMass:144.23613137220002},{symbol:"Pm",casId:"7440-12-2",period:6,name:"Promethium",atomicNumber:61,chemicalSerie:"Lanthanides",phase:"Synthetic",radiiVdw:2.43},{symbol:"Sm",casId:"7440-19-9",period:6,name:"Samarium",atomicNumber:62,chemicalSerie:"Lanthanides",phase:"Solid",radiiVdw:2.43,naturalMass:150.36634852618},{symbol:"Eu",casId:"7440-53-1",period:6,name:"Europium",atomicNumber:63,chemicalSerie:"Lanthanides",phase:"Solid",radiiCova:2.4,naturalMass:151.96437047419},{symbol:"Gd",casId:"7440-54-2",period:6,name:"Gadolinium",atomicNumber:64,chemicalSerie:"Lanthanides",phase:"Solid",radiiVdw:2.38,naturalMass:157.25212221544},{symbol:"Tb",casId:"7440-27-9",period:6,name:"Terbium",atomicNumber:65,chemicalSerie:"Lanthanides",phase:"Solid",radiiVdw:2.37,naturalMass:158.9253468},{symbol:"Dy",casId:"7429-91-6",period:6,name:"Dysprosium",atomicNumber:66,chemicalSerie:"Lanthanides",phase:"Solid",radiiVdw:2.35,naturalMass:162.49703350552},{symbol:"Ho",casId:"7440-60-0",period:6,name:"Holmium",atomicNumber:67,chemicalSerie:"Lanthanides",phase:"Solid",radiiVdw:2.33,naturalMass:164.9303221},{symbol:"Er",casId:"7440-52-0",period:6,name:"Erbium",atomicNumber:68,chemicalSerie:"Lanthanides",phase:"Solid",radiiVdw:2.32,naturalMass:167.25630413192},{symbol:"Tm",casId:"7440-30-4",period:6,name:"Thulium",atomicNumber:69,chemicalSerie:"Lanthanides",phase:"Solid",radiiVdw:2.3,naturalMass:168.9342133},{symbol:"Yb",casId:"7440-64-4",period:6,name:"Ytterbium",atomicNumber:70,chemicalSerie:"Lanthanides",phase:"Solid",radiiVdw:2.28,naturalMass:173.03769558789998},{symbol:"Lu",casId:"7439-94-3",period:6,name:"Lutetium",atomicNumber:71,chemicalSerie:"Lanthanides",phase:"Solid",radiiCova:1.6,radiiVdw:2.27,naturalMass:174.96672138555},{symbol:"Hf",casId:"7440-58-6",group:4,period:6,name:"Hafnium",atomicNumber:72,chemicalSerie:"Transition metals",phase:"Solid",radiiCova:1.5,radiiVdw:2.25,naturalMass:178.48497214162},{symbol:"Ta",casId:"7440-25-7",group:5,period:6,name:"Tantalum",atomicNumber:73,chemicalSerie:"Transition metals",phase:"Solid",radiiCova:1.38,radiiVdw:2.2,naturalMass:180.94787573628},{symbol:"W",casId:"7440-33-7",group:6,period:6,name:"Tungsten",atomicNumber:74,chemicalSerie:"Transition metals",phase:"Solid",radiiCova:1.46,radiiVdw:2.1,naturalMass:183.84177810241},{symbol:"Re",casId:"7440-15-5",group:7,period:6,name:"Rhenium",atomicNumber:75,chemicalSerie:"Transition metals",phase:"Solid",radiiCova:1.59,radiiVdw:2.05,naturalMass:186.2067066106},{symbol:"Os",casId:"7440-04-2",group:8,period:6,name:"Osmium",atomicNumber:76,chemicalSerie:"Transition metals",phase:"Solid",radiiCova:1.28,radiiVdw:2,naturalMass:190.22486304558998},{symbol:"Ir",casId:"7439-88-5",group:9,period:6,name:"Iridium",atomicNumber:77,chemicalSerie:"Transition metals",phase:"Solid",radiiCova:1.37,radiiVdw:2,naturalMass:192.2160564148},{symbol:"Pt",casId:"7440-06-4",group:10,period:6,name:"Platinum",atomicNumber:78,chemicalSerie:"Transition metals",phase:"Solid",radiiCova:1.28,radiiVdw:2.05,naturalMass:195.07780788031297},{symbol:"Au",casId:"7440-57-5",group:11,period:6,name:"Gold",atomicNumber:79,chemicalSerie:"Transition metals",phase:"Solid",radiiCova:1.44,radiiVdw:2.1,naturalMass:196.9665687},{symbol:"Hg",casId:"7439-97-6",group:12,period:6,name:"Mercury",atomicNumber:80,chemicalSerie:"Transition metals",phase:"Liquid",radiiCova:1.49,radiiVdw:2.05,naturalMass:200.59916661780002},{symbol:"Tl",casId:"7440-28-0",group:13,period:6,name:"Thallium",atomicNumber:81,chemicalSerie:"Metals",phase:"Solid",radiiCova:1.49,radiiVdw:2.2,naturalMass:204.38333242650796},{symbol:"Pb",casId:"7439-92-1",group:14,period:6,name:"Lead",atomicNumber:82,chemicalSerie:"Metals",phase:"Solid",radiiCova:1.48,radiiVdw:2.3,naturalMass:207.21690766300003},{symbol:"Bi",casId:"7440-69-9",group:15,period:6,name:"Bismuth",atomicNumber:83,chemicalSerie:"Metals",phase:"Solid",radiiCova:1.47,radiiVdw:2.3,naturalMass:208.9803987},{symbol:"Po",casId:"7440-08-6",group:16,period:6,name:"Polonium",atomicNumber:84,chemicalSerie:"Metalloids",phase:"Solid",radiiCova:1.46,radiiVdw:2},{symbol:"At",casId:"7440-08-6",group:17,period:6,name:"Astatine",atomicNumber:85,chemicalSerie:"Halogens",phase:"Solid",radiiVdw:2},{symbol:"Rn",casId:"10043-92-2",group:18,period:6,name:"Radon",atomicNumber:86,chemicalSerie:"Noble Gasses",phase:"Gas",radiiCova:1.45,radiiVdw:2},{symbol:"Fr",casId:"7440-73-5",group:1,period:7,name:"Francium",atomicNumber:87,chemicalSerie:"Alkali Metals",phase:"Solid",radiiVdw:2},{symbol:"Ra",casId:"7440-14-4",group:2,period:7,name:"Radium",atomicNumber:88,chemicalSerie:"Alkali Earth Metals",phase:"Solid",radiiVdw:2},{symbol:"Ac",casId:"7440-34-8",group:3,period:7,name:"Actinium",atomicNumber:89,chemicalSerie:"Actinides",phase:"Synthetic",radiiVdw:2},{symbol:"Th",casId:"7440-29-1",period:7,name:"Thorium",atomicNumber:90,chemicalSerie:"Actinides",phase:"Solid",radiiVdw:2.3,naturalMass:232.0380553},{symbol:"Pa",casId:"7440-13-3",period:7,name:"Protactinium",atomicNumber:91,chemicalSerie:"Actinides",phase:"Solid",radiiVdw:2,naturalMass:231.035884},{symbol:"U",casId:"7440-61-1",period:7,name:"Uranium",atomicNumber:92,chemicalSerie:"Actinides",phase:"Solid",radiiVdw:2.3,naturalMass:238.0289182792545},{symbol:"Np",casId:"7439-99-8",period:7,name:"Neptunium",atomicNumber:93,chemicalSerie:"Actinides",phase:"Synthetic",radiiVdw:2},{symbol:"Pu",casId:"7440-07-5",period:7,name:"Plutonium",atomicNumber:94,chemicalSerie:"Actinides",phase:"Synthetic",radiiVdw:2},{symbol:"Am",casId:"7440-35-9",period:7,name:"Americium",atomicNumber:95,chemicalSerie:"Actinides",phase:"Synthetic",radiiVdw:2},{symbol:"Cm",casId:"7440-51-9",period:7,name:"Curium",atomicNumber:96,chemicalSerie:"Actinides",phase:"Synthetic",radiiVdw:2},{symbol:"Bk",casId:"7440-40-6",period:7,name:"Berkelium",atomicNumber:97,chemicalSerie:"Actinides",phase:"Synthetic",radiiVdw:2},{symbol:"Cf",casId:"7440-71-3",period:7,name:"Californium",atomicNumber:98,chemicalSerie:"Actinides",phase:"Synthetic",radiiVdw:2},{symbol:"Es",casId:"7429-92-7",period:7,name:"Einsteinium",atomicNumber:99,chemicalSerie:"Actinides",phase:"Synthetic",radiiVdw:2},{symbol:"Fm",casId:"7440-72-4",period:7,name:"Fermium",atomicNumber:100,chemicalSerie:"Actinides",phase:"Synthetic",radiiVdw:2},{symbol:"Md",casId:"7440-11-1",period:7,name:"Mendelevium",atomicNumber:101,chemicalSerie:"Actinides",phase:"Synthetic",radiiVdw:2},{symbol:"No",casId:"10028-14-5",period:7,name:"Nobelium",atomicNumber:102,chemicalSerie:"Actinides",phase:"Synthetic",radiiVdw:2},{symbol:"Lr",casId:"22537-19-5",period:7,name:"Lawrencium",atomicNumber:103,chemicalSerie:"Actinides",phase:"Synthetic",radiiVdw:2},{symbol:"Rf",casId:"53850-36-5",group:4,period:7,name:"Rutherfordium",atomicNumber:104,chemicalSerie:"Transition metals",phase:"Synthetic"},{symbol:"Db",casId:"53850-35-4",group:5,period:7,name:"Dubnium",atomicNumber:105,chemicalSerie:"Transition metals",phase:"Synthetic"},{symbol:"Sg",casId:"54038-81-2",group:6,period:7,name:"Seaborgium",atomicNumber:106,chemicalSerie:"Transition metals",phase:"Synthetic"},{symbol:"Bh",casId:"54037-14-8",group:7,period:7,name:"Bohrium",atomicNumber:107,chemicalSerie:"Transition metals",phase:"Synthetic"},{symbol:"Hs",casId:"54037-57-9",group:8,period:7,name:"Hassium",atomicNumber:108,chemicalSerie:"Transition metals",phase:"Synthetic"},{symbol:"Mt",casId:"54038-01-6",group:9,period:7,name:"Meitnerium",atomicNumber:109,chemicalSerie:"Transition metals",phase:"Synthetic"},{symbol:"Ds",casId:"54083-77-1",group:10,period:7,name:"Darmstadtium",atomicNumber:110,chemicalSerie:"Transition metals",phase:"Synthetic"},{symbol:"Rg",casId:"54386-24-2",group:11,period:7,name:"Roentgenium",atomicNumber:111,chemicalSerie:"Transition metals",phase:"Synthetic"},{symbol:"Uub",group:12,period:7,name:"Ununbium",atomicNumber:112,chemicalSerie:"Transition metals",phase:"Synthetic"}];module.exports=chemicalElementsData},function(module,exports,__webpack_require__){"use strict";var isotopesData=[{elementSymbol:"H",atomicNumber:1,isotopes:[{id:"H1",massNumber:1,relativeAbundance:.999885,atomicNumber:1,exactMass:1.007825032,spin:"1/2+",magneticMoment:"+2.792846",halfLife:-1},{id:"H2",massNumber:2,relativeAbundance:115e-6,atomicNumber:1,exactMass:2.014101778,spin:"1+",magneticMoment:"+0.857438",halfLife:-1},{id:"H3",massNumber:3,exactMass:3.016049278,atomicNumber:1,spin:"1/2+",magneticMoment:"+2.978960",halfLife:388839e3,betaminusDecay:"0.01861",betaminusDecayLikeliness:"100.0"},{id:"H4",massNumber:4,exactMass:4.02781,atomicNumber:1},{id:"H5",massNumber:5,exactMass:5.03531,atomicNumber:1},{id:"H6",massNumber:6,exactMass:6.04494,atomicNumber:1},{id:"H7",massNumber:7,exactMass:7.05275,atomicNumber:1}]},{elementSymbol:"He",atomicNumber:2,isotopes:[{id:"He3",massNumber:3,relativeAbundance:137e-8,atomicNumber:2,exactMass:3.016029319,spin:"1/2+",magneticMoment:"-2.127624",halfLife:-1},{id:"He4",massNumber:4,relativeAbundance:.99999863,atomicNumber:2,exactMass:4.002603254,spin:"0+",halfLife:-1},{id:"He5",massNumber:5,exactMass:5.01222,atomicNumber:2},{id:"He6",massNumber:6,exactMass:6.0188891,atomicNumber:2,halfLife:.8067},{id:"He7",massNumber:7,exactMass:7.028021,atomicNumber:2},{id:"He8",massNumber:8,exactMass:8.033922,atomicNumber:2,halfLife:.119},{id:"He9",massNumber:9,exactMass:9.04395,atomicNumber:2},{id:"He10",massNumber:10,exactMass:10.0524,atomicNumber:2}]},{elementSymbol:"Li",atomicNumber:3,isotopes:[{id:"Li3",massNumber:3,exactMass:3.03078,atomicNumber:3},{id:"Li4",massNumber:4,exactMass:4.02719,atomicNumber:3},{id:"Li5",massNumber:5,exactMass:5.01254,atomicNumber:3},{id:"Li6",massNumber:6,relativeAbundance:.0759,atomicNumber:3,exactMass:6.015122795,spin:"1+",magneticMoment:"+0.822056",halfLife:-1},{id:"Li7",massNumber:7,relativeAbundance:.9240999999999999,atomicNumber:3,exactMass:7.01600455,spin:"3/2-",magneticMoment:"+3.25644",halfLife:-1},{id:"Li8",massNumber:8,exactMass:8.02248736,atomicNumber:3,halfLife:.838},{id:"Li9",massNumber:9,exactMass:9.0267895,atomicNumber:3,halfLife:.1783},{id:"Li10",massNumber:10,exactMass:10.035481,atomicNumber:3},{id:"Li11",massNumber:11,exactMass:11.043798,atomicNumber:3,halfLife:.0085},{id:"Li12",massNumber:12,exactMass:12.05378,atomicNumber:3}]},{elementSymbol:"Be",atomicNumber:4,isotopes:[{id:"Be5",massNumber:5,exactMass:5.04079,atomicNumber:4},{id:"Be6",massNumber:6,exactMass:6.019726,atomicNumber:4},{id:"Be7",massNumber:7,exactMass:7.01692983,atomicNumber:4,spin:"3/2-",halfLife:4589570,ecDecay:"0.862",ecDecayLikeliness:"100.0"},{id:"Be8",massNumber:8,exactMass:8.0053051,atomicNumber:4},{id:"Be9",massNumber:9,relativeAbundance:1,atomicNumber:4,exactMass:9.0121822,spin:"3/2-",magneticMoment:"-1.1776",halfLife:-1},{id:"Be10",massNumber:10,exactMass:10.0135338,atomicNumber:4,spin:"0+",halfLife:476194e8,betaminusDecay:"0.555",betaminusDecayLikeliness:"100.0"},{id:"Be11",massNumber:11,exactMass:11.021658,atomicNumber:4,halfLife:13.81},{id:"Be12",massNumber:12,exactMass:12.026921,atomicNumber:4,halfLife:.0236},{id:"Be13",massNumber:13,exactMass:13.03569,atomicNumber:4},{id:"Be14",massNumber:14,exactMass:14.04289,atomicNumber:4,halfLife:.00435},{id:"Be15",massNumber:15,exactMass:15.05346,atomicNumber:4},{id:"Be16",massNumber:16,exactMass:16.06192,atomicNumber:4}]},{elementSymbol:"B",atomicNumber:5,isotopes:[{id:"B6",massNumber:6,exactMass:6.04681,atomicNumber:5},{id:"B7",massNumber:7,exactMass:7.02992,atomicNumber:5},{id:"B8",massNumber:8,exactMass:8.0246072,atomicNumber:5,halfLife:.77},{id:"B9",massNumber:9,exactMass:9.0133288,atomicNumber:5},{id:"B10",massNumber:10,relativeAbundance:.19899999999999998,atomicNumber:5,exactMass:10.012937,spin:"3+",magneticMoment:"+1.80065",halfLife:-1},{id:"B11",massNumber:11,relativeAbundance:.8009999999999999,atomicNumber:5,exactMass:11.0093054,spin:"3/2-",magneticMoment:"+2.688637",halfLife:-1},{id:"B12",massNumber:12,exactMass:12.0143521,atomicNumber:5,halfLife:.0202},{id:"B13",massNumber:13,exactMass:13.0177802,atomicNumber:5,halfLife:.01736},{id:"B14",massNumber:14,exactMass:14.025404,atomicNumber:5,halfLife:.0138},{id:"B15",massNumber:15,exactMass:15.031103,atomicNumber:5,halfLife:.0105},{id:"B16",massNumber:16,exactMass:16.03981,atomicNumber:5},{id:"B17",massNumber:17,exactMass:17.04699,atomicNumber:5,halfLife:.00508},{id:"B18",massNumber:18,exactMass:18.05617,atomicNumber:5},{id:"B19",massNumber:19,exactMass:19.06373,atomicNumber:5}]},{elementSymbol:"C",atomicNumber:6,isotopes:[{id:"C8",massNumber:8,exactMass:8.037675,atomicNumber:6},{id:"C9",massNumber:9,exactMass:9.0310367,atomicNumber:6,halfLife:.126},{id:"C10",massNumber:10,exactMass:10.0168532,atomicNumber:6,halfLife:19.255},{id:"C11",massNumber:11,exactMass:11.0114336,atomicNumber:6,spin:"3/2-",halfLife:1223.4,betaplusDecay:"0.96",betaplusDecayLikeliness:"100.0"},{id:"C12",massNumber:12,relativeAbundance:.9893000000000001,atomicNumber:6,exactMass:12,spin:"0+",halfLife:-1},{id:"C13",massNumber:13,relativeAbundance:.010700000000000001,atomicNumber:6,exactMass:13.00335484,spin:"1/2-",magneticMoment:"+0.702411",halfLife:-1},{id:"C14",massNumber:14,exactMass:14.00324199,atomicNumber:6,halfLife:180701e6,betaminusDecay:"0.15648",betaminusDecayLikeliness:"100.0"},{id:"C15",massNumber:15,exactMass:15.0105993,atomicNumber:6,halfLife:2.449},{id:"C16",massNumber:16,exactMass:16.014701,atomicNumber:6,halfLife:.747},{id:"C17",massNumber:17,exactMass:17.022586,atomicNumber:6,halfLife:.193},{id:"C18",massNumber:18,exactMass:18.02676,atomicNumber:6,halfLife:.095},{id:"C19",massNumber:19,exactMass:19.03481,atomicNumber:6,halfLife:.046},{id:"C20",massNumber:20,exactMass:20.04032,atomicNumber:6,halfLife:.014},{id:"C21",massNumber:21,exactMass:21.04934,atomicNumber:6},{id:"C22",massNumber:22,exactMass:22.0572,atomicNumber:6}]},{elementSymbol:"N",atomicNumber:7,isotopes:[{id:"N10",massNumber:10,exactMass:10.04165,atomicNumber:7},{id:"N11",massNumber:11,exactMass:11.02609,atomicNumber:7},{id:"N12",massNumber:12,exactMass:12.0186132,atomicNumber:7,halfLife:.011},{id:"N13",massNumber:13,exactMass:13.00573861,atomicNumber:7,halfLife:597.9},{id:"N14",massNumber:14,relativeAbundance:.9963200000000001,atomicNumber:7,exactMass:14.003074,spin:"1+",magneticMoment:"+0.403761",halfLife:-1},{id:"N15",massNumber:15,relativeAbundance:.00368,atomicNumber:7,exactMass:15.0001089,spin:"1/2-",magneticMoment:"-0.283189",halfLife:-1},{id:"N16",massNumber:16,exactMass:16.0061017,atomicNumber:7,halfLife:7.13},{id:"N17",massNumber:17,exactMass:17.00845,atomicNumber:7,halfLife:4.173},{id:"N18",massNumber:18,exactMass:18.014079,atomicNumber:7,halfLife:.624},{id:"N19",massNumber:19,exactMass:19.017029,atomicNumber:7,halfLife:.304},{id:"N20",massNumber:20,exactMass:20.02337,atomicNumber:7,halfLife:.1},{id:"N21",massNumber:21,exactMass:21.02711,atomicNumber:7,halfLife:.085},{id:"N22",massNumber:22,exactMass:22.03439,atomicNumber:7,halfLife:.024},{id:"N23",massNumber:23,exactMass:23.04122,atomicNumber:7},{id:"N24",massNumber:24,exactMass:24.05104,atomicNumber:7},{id:"N25",massNumber:25,exactMass:25.06066,atomicNumber:7}]},{elementSymbol:"O",atomicNumber:8,isotopes:[{id:"O12",massNumber:12,exactMass:12.034405,atomicNumber:8},{id:"O13",massNumber:13,exactMass:13.024812,atomicNumber:8,halfLife:.00858},{id:"O14",massNumber:14,exactMass:14.00859625,atomicNumber:8,halfLife:70.606},{id:"O15",massNumber:15,exactMass:15.0030656,atomicNumber:8,halfLife:122.24},{id:"O16",massNumber:16,relativeAbundance:.9975700000000001,atomicNumber:8,exactMass:15.99491462,spin:"0+",halfLife:-1},{id:"O17",massNumber:17,relativeAbundance:.00037999999999999997,atomicNumber:8,exactMass:16.9991317,spin:"5/2+",magneticMoment:"-1.89379",halfLife:-1},{id:"O18",massNumber:18,relativeAbundance:.0020499999999999997,atomicNumber:8,exactMass:17.999161,spin:"0+",halfLife:-1},{id:"O19",massNumber:19,exactMass:19.00358,atomicNumber:8,halfLife:26.91},{id:"O20",massNumber:20,exactMass:20.0040767,atomicNumber:8,halfLife:13.51},{id:"O21",massNumber:21,exactMass:21.008656,atomicNumber:8,halfLife:3.42},{id:"O22",massNumber:22,exactMass:22.00997,atomicNumber:8,halfLife:2.25},{id:"O23",massNumber:23,exactMass:23.01569,atomicNumber:8,halfLife:.082},{id:"O24",massNumber:24,exactMass:24.02047,atomicNumber:8,halfLife:.061},{id:"O25",massNumber:25,exactMass:25.02946,atomicNumber:8},{id:"O26",massNumber:26,exactMass:26.03834,atomicNumber:8},{id:"O27",massNumber:27,exactMass:27.04826,atomicNumber:8},{id:"O28",massNumber:28,exactMass:28.05781,atomicNumber:8}]},{elementSymbol:"F",atomicNumber:9,isotopes:[{id:"F14",massNumber:14,exactMass:14.03506,atomicNumber:9},{id:"F15",massNumber:15,exactMass:15.01801,atomicNumber:9,halfLife:-1},{id:"F16",massNumber:16,exactMass:16.011466,atomicNumber:9},{id:"F17",massNumber:17,exactMass:17.00209524,atomicNumber:9,halfLife:64.49},{id:"F18",massNumber:18,exactMass:18.000938,atomicNumber:9,spin:"1+",halfLife:6586.2,betaplusDecay:"0.64",betaplusDecayLikeliness:"97.0",ecDecay:"",ecDecayLikeliness:"3.0"},{id:"F19",massNumber:19,relativeAbundance:1,atomicNumber:9,exactMass:18.99840322,spin:"1/2+",magneticMoment:"+2.628866",halfLife:-1},{id:"F20",massNumber:20,exactMass:19.99998132,atomicNumber:9,halfLife:11},{id:"F21",massNumber:21,exactMass:20.999949,atomicNumber:9,halfLife:4.158},{id:"F22",massNumber:22,exactMass:22.002999,atomicNumber:9,halfLife:4.23},{id:"F23",massNumber:23,exactMass:23.00357,atomicNumber:9,halfLife:2.23},{id:"F24",massNumber:24,exactMass:24.00812,atomicNumber:9,halfLife:.34},{id:"F25",massNumber:25,exactMass:25.0121,atomicNumber:9,halfLife:.059},{id:"F26",massNumber:26,exactMass:26.01962,atomicNumber:9},{id:"F27",massNumber:27,exactMass:27.02676,atomicNumber:9},{id:"F28",massNumber:28,exactMass:28.03567,atomicNumber:9},{id:"F29",massNumber:29,exactMass:29.04326,atomicNumber:9},{id:"F30",massNumber:30,exactMass:30.0525,atomicNumber:9},{id:"F31",massNumber:31,exactMass:31.06043,atomicNumber:9}]},{elementSymbol:"Ne",atomicNumber:10,isotopes:[{id:"Ne16",massNumber:16,exactMass:16.025761,atomicNumber:10},{id:"Ne17",massNumber:17,exactMass:17.017672,atomicNumber:10,halfLife:.1092},{id:"Ne18",massNumber:18,exactMass:18.0057082,atomicNumber:10,halfLife:1.672},{id:"Ne19",massNumber:19,exactMass:19.0018802,atomicNumber:10,halfLife:17.22},{id:"Ne20",massNumber:20,relativeAbundance:.9048,atomicNumber:10,exactMass:19.99244018,spin:"0+",halfLife:-1},{id:"Ne21",massNumber:21,relativeAbundance:.0027,atomicNumber:10,exactMass:20.99384668,spin:"3/2",magneticMoment:"-0.661796",halfLife:-1},{id:"Ne22",massNumber:22,relativeAbundance:.0925,atomicNumber:10,exactMass:21.99138511,spin:"0+",halfLife:-1},{id:"Ne23",massNumber:23,exactMass:22.9944669,atomicNumber:10,halfLife:37.24},{id:"Ne24",massNumber:24,exactMass:23.9936108,atomicNumber:10,halfLife:202.8},{id:"Ne25",massNumber:25,exactMass:24.997737,atomicNumber:10,halfLife:.602},{id:"Ne26",massNumber:26,exactMass:26.000461,atomicNumber:10,halfLife:.197},{id:"Ne27",massNumber:27,exactMass:27.00759,atomicNumber:10,halfLife:.032},{id:"Ne28",massNumber:28,exactMass:28.01207,atomicNumber:10,halfLife:.017},{id:"Ne29",massNumber:29,exactMass:29.01939,atomicNumber:10,halfLife:.2},{id:"Ne30",massNumber:30,exactMass:30.0248,atomicNumber:10},{id:"Ne31",massNumber:31,exactMass:31.03311,atomicNumber:10},{id:"Ne32",massNumber:32,exactMass:32.04002,atomicNumber:10},{id:"Ne33",massNumber:33,exactMass:33.04938,atomicNumber:10},{id:"Ne34",massNumber:34,exactMass:34.05703,atomicNumber:10}]},{elementSymbol:"Na",atomicNumber:11,isotopes:[{id:"Na18",massNumber:18,exactMass:18.02597,atomicNumber:11},{id:"Na19",massNumber:19,exactMass:19.013877,atomicNumber:11},{id:"Na20",massNumber:20,exactMass:20.007351,atomicNumber:11,halfLife:.4479},{id:"Na21",massNumber:21,exactMass:20.9976552,atomicNumber:11,halfLife:22.49},{id:"Na22",massNumber:22,exactMass:21.9944364,atomicNumber:11,spin:"3+",magneticMoment:"+1.746",halfLife:82053500,betaplusDecay:"2.842",betaplusDecayLikeliness:"100.0",ecDecay:"",ecDecayLikeliness:"100.0"},{id:"Na23",massNumber:23,relativeAbundance:1,atomicNumber:11,exactMass:22.98976928,spin:"3/2+",magneticMoment:"-2.217520",halfLife:-1},{id:"Na24",massNumber:24,exactMass:23.99096278,atomicNumber:11,spin:"4+",magneticMoment:"+1.6903",halfLife:14.959,betaminusDecay:"5.514",betaminusDecayLikeliness:"100.0"},{id:"Na25",massNumber:25,exactMass:24.989954,atomicNumber:11,halfLife:59.1},{id:"Na26",massNumber:26,exactMass:25.992633,atomicNumber:11,halfLife:1.072},{id:"Na27",massNumber:27,exactMass:26.994077,atomicNumber:11,halfLife:.301},{id:"Na28",massNumber:28,exactMass:27.998938,atomicNumber:11,halfLife:.0305},{id:"Na29",massNumber:29,exactMass:29.002861,atomicNumber:11,halfLife:.0449},{id:"Na30",massNumber:30,exactMass:30.008976,atomicNumber:11,halfLife:.048},{id:"Na31",massNumber:31,exactMass:31.01359,atomicNumber:11,halfLife:.017},{id:"Na32",massNumber:32,exactMass:32.02047,atomicNumber:11,halfLife:.0132},{id:"Na33",massNumber:33,exactMass:33.02672,atomicNumber:11,halfLife:.0082},{id:"Na34",massNumber:34,exactMass:34.03517,atomicNumber:11,halfLife:.0055},{id:"Na35",massNumber:35,exactMass:35.04249,atomicNumber:11,halfLife:.0015},{id:"Na36",massNumber:36,exactMass:36.05148,atomicNumber:11},{id:"Na37",massNumber:37,exactMass:37.05934,atomicNumber:11}]},{elementSymbol:"Mg",atomicNumber:12,isotopes:[{id:"Mg19",massNumber:19,exactMass:19.03547,atomicNumber:12},{id:"Mg20",massNumber:20,exactMass:20.018863,atomicNumber:12,halfLife:.095},{id:"Mg21",massNumber:21,exactMass:21.011713,atomicNumber:12,halfLife:.122},{id:"Mg22",massNumber:22,exactMass:21.9995738,atomicNumber:12,halfLife:3.857},{id:"Mg23",massNumber:23,exactMass:22.9941237,atomicNumber:12,halfLife:11.317},{id:"Mg24",massNumber:24,relativeAbundance:.7898999999999999,atomicNumber:12,exactMass:23.9850417,spin:"0+",halfLife:-1},{id:"Mg25",massNumber:25,relativeAbundance:.1,atomicNumber:12,exactMass:24.98583692,spin:"5/2+",magneticMoment:"-0.85545",halfLife:-1},{id:"Mg26",massNumber:26,relativeAbundance:.1101,atomicNumber:12,exactMass:25.98259293,spin:"0+",halfLife:-1},{id:"Mg27",massNumber:27,exactMass:26.98434059,atomicNumber:12,halfLife:567.48},{id:"Mg28",massNumber:28,exactMass:27.9838768,atomicNumber:12,halfLife:75276},{id:"Mg29",massNumber:29,exactMass:28.9886,atomicNumber:12,halfLife:1.3},{id:"Mg30",massNumber:30,exactMass:29.990434,atomicNumber:12,halfLife:.335},{id:"Mg31",massNumber:31,exactMass:30.996546,atomicNumber:12,halfLife:.23},{id:"Mg32",massNumber:32,exactMass:31.998975,atomicNumber:12,halfLife:.12},{id:"Mg33",massNumber:33,exactMass:33.005254,atomicNumber:12,halfLife:.09},{id:"Mg34",massNumber:34,exactMass:34.00946,atomicNumber:12,halfLife:.02},{id:"Mg35",massNumber:35,exactMass:35.01734,atomicNumber:12},{id:"Mg36",massNumber:36,exactMass:36.023,atomicNumber:12},{id:"Mg37",massNumber:37,exactMass:37.0314,atomicNumber:12},{id:"Mg38",massNumber:38,exactMass:38.03757,atomicNumber:12},{id:"Mg39",massNumber:39,exactMass:39.04677,atomicNumber:12},{id:"Mg40",massNumber:40,exactMass:40.05393,atomicNumber:12}]},{elementSymbol:"Al",atomicNumber:13,isotopes:[{id:"Al21",massNumber:21,exactMass:21.02804,atomicNumber:13},{id:"Al22",massNumber:22,exactMass:22.01952,atomicNumber:13,halfLife:.07},{id:"Al23",massNumber:23,exactMass:23.007267,atomicNumber:13,halfLife:.47},{id:"Al24",massNumber:24,exactMass:23.9999389,atomicNumber:13,halfLife:2.053},{id:"Al25",massNumber:25,exactMass:24.9904281,atomicNumber:13,halfLife:7.183},{id:"Al26",massNumber:26,exactMass:25.98689169,atomicNumber:13,spin:"5+",halfLife:74e4,betaplusDecay:"4.003",betaplusDecayLikeliness:"82",ecDecay:"",ecDecayLikeliness:"18"},{id:"Al27",massNumber:27,relativeAbundance:1,atomicNumber:13,exactMass:26.98153863,spin:"5/2+",magneticMoment:"+3.641504",halfLife:-1},{id:"Al28",massNumber:28,exactMass:27.98191031,atomicNumber:13,halfLife:134.484},{id:"Al29",massNumber:29,exactMass:28.980445,atomicNumber:13,halfLife:393.6},{id:"Al30",massNumber:30,exactMass:29.98296,atomicNumber:13,halfLife:3.6},{id:"Al31",massNumber:31,exactMass:30.983947,atomicNumber:13,halfLife:.644},{id:"Al32",massNumber:32,exactMass:31.98812,atomicNumber:13,halfLife:.033},{id:"Al33",massNumber:33,exactMass:32.99084,atomicNumber:13},{id:"Al34",massNumber:34,exactMass:33.99685,atomicNumber:13},{id:"Al35",massNumber:35,exactMass:34.99986,atomicNumber:13},{id:"Al36",massNumber:36,exactMass:36.00621,atomicNumber:13},{id:"Al37",massNumber:37,exactMass:37.01068,atomicNumber:13},{id:"Al38",massNumber:38,exactMass:38.01723,atomicNumber:13},{id:"Al39",massNumber:39,exactMass:39.02297,atomicNumber:13},{id:"Al40",massNumber:40,exactMass:40.03145,atomicNumber:13},{id:"Al41",massNumber:41,exactMass:41.03833,atomicNumber:13},{id:"Al42",massNumber:42,exactMass:42.04689,atomicNumber:13}]},{elementSymbol:"Si",atomicNumber:14,isotopes:[{id:"Si22",massNumber:22,exactMass:22.03453,atomicNumber:14,halfLife:.006},{id:"Si23",massNumber:23,exactMass:23.02552,atomicNumber:14},{id:"Si24",massNumber:24,exactMass:24.011546,atomicNumber:14,halfLife:.102},{id:"Si25",massNumber:25,exactMass:25.004106,atomicNumber:14,halfLife:.22},{id:"Si26",massNumber:26,exactMass:25.99233,atomicNumber:14,halfLife:2.234},{id:"Si27",massNumber:27,exactMass:26.98670491,atomicNumber:14,halfLife:4.16},{id:"Si28",massNumber:28,relativeAbundance:.9222969999999999,atomicNumber:14,exactMass:27.97692653,spin:"0+",halfLife:-1},{id:"Si29",massNumber:29,relativeAbundance:.046832000000000006,atomicNumber:14,exactMass:28.9764947,spin:"1/2+",magneticMoment:"-0.55529",halfLife:-1},{id:"Si30",massNumber:30,relativeAbundance:.030872,atomicNumber:14,exactMass:29.97377017,spin:"0+",halfLife:-1},{id:"Si31",massNumber:31,exactMass:30.97536323,atomicNumber:14,halfLife:9438},{id:"Si32",massNumber:32,exactMass:31.97414808,atomicNumber:14,halfLife:47304e5},{id:"Si33",massNumber:33,exactMass:32.978,atomicNumber:14,halfLife:6.18},{id:"Si34",massNumber:34,exactMass:33.978576,atomicNumber:14,halfLife:2.77},{id:"Si35",massNumber:35,exactMass:34.98458,atomicNumber:14,halfLife:.78},{id:"Si36",massNumber:36,exactMass:35.9866,atomicNumber:14,halfLife:.45},{id:"Si37",massNumber:37,exactMass:36.99294,atomicNumber:14},{id:"Si38",massNumber:38,exactMass:37.99563,atomicNumber:14},{id:"Si39",massNumber:39,exactMass:39.00207,atomicNumber:14},{id:"Si40",massNumber:40,exactMass:40.00587,atomicNumber:14},{id:"Si41",massNumber:41,exactMass:41.01456,atomicNumber:14},{id:"Si42",massNumber:42,exactMass:42.01979,atomicNumber:14},{id:"Si43",massNumber:43,exactMass:43.02866,atomicNumber:14},{id:"Si44",massNumber:44,exactMass:44.03526,atomicNumber:14}]},{elementSymbol:"P",atomicNumber:15,isotopes:[{id:"P24",massNumber:24,exactMass:24.03435,atomicNumber:15},{id:"P25",massNumber:25,exactMass:25.02026,atomicNumber:15},{id:"P26",massNumber:26,exactMass:26.01178,atomicNumber:15,halfLife:.02},{id:"P27",massNumber:27,exactMass:26.99923,atomicNumber:15,halfLife:.26},{id:"P28",massNumber:28,exactMass:27.992315,atomicNumber:15,halfLife:.2703},{id:"P29",massNumber:29,exactMass:28.9818006,atomicNumber:15,halfLife:4.14},{id:"P30",massNumber:30,exactMass:29.9783138,atomicNumber:15,halfLife:149.88},{id:"P31",massNumber:31,relativeAbundance:1,atomicNumber:15,exactMass:30.97376163,spin:"1/2+",magneticMoment:"+1.13160",halfLife:-1},{id:"P32",massNumber:32,exactMass:31.97390727,atomicNumber:15,spin:"1+",magneticMoment:"-0.2524",halfLife:1232240,betaminusDecay:"1.710",betaminusDecayLikeliness:"100.0"},{id:"P33",massNumber:33,exactMass:32.9717255,atomicNumber:15,halfLife:2189380},{id:"P34",massNumber:34,exactMass:33.973636,atomicNumber:15,halfLife:12.43},{id:"P35",massNumber:35,exactMass:34.9733141,atomicNumber:15,halfLife:47.3},{id:"P36",massNumber:36,exactMass:35.97826,atomicNumber:15,halfLife:5.6},{id:"P37",massNumber:37,exactMass:36.97961,atomicNumber:15,halfLife:2.31},{id:"P38",massNumber:38,exactMass:37.98416,atomicNumber:15,halfLife:.64},{id:"P39",massNumber:39,exactMass:38.98618,atomicNumber:15,halfLife:.16},{id:"P40",massNumber:40,exactMass:39.9913,atomicNumber:15,halfLife:.26},{id:"P41",massNumber:41,exactMass:40.99434,atomicNumber:15,halfLife:.12},{id:"P42",massNumber:42,exactMass:42.00101,atomicNumber:15,halfLife:.11},{id:"P43",massNumber:43,exactMass:43.00619,atomicNumber:15,halfLife:.033},{id:"P44",massNumber:44,exactMass:44.01299,atomicNumber:15},{id:"P45",massNumber:45,exactMass:45.01922,atomicNumber:15},{id:"P46",massNumber:46,exactMass:46.02738,atomicNumber:15}]},{elementSymbol:"S",atomicNumber:16,isotopes:[{id:"S26",massNumber:26,exactMass:26.02788,atomicNumber:16},{id:"S27",massNumber:27,exactMass:27.01883,atomicNumber:16,halfLife:.021},{id:"S28",massNumber:28,exactMass:28.00437,atomicNumber:16,halfLife:.125},{id:"S29",massNumber:29,exactMass:28.99661,atomicNumber:16,halfLife:.187},{id:"S30",massNumber:30,exactMass:29.984903,atomicNumber:16,halfLife:1.178},{id:"S31",massNumber:31,exactMass:30.9795547,atomicNumber:16,halfLife:2.572},{id:"S32",massNumber:32,relativeAbundance:.9493,atomicNumber:16,exactMass:31.972071,spin:"0+",halfLife:-1},{id:"S33",massNumber:33,relativeAbundance:.0076,atomicNumber:16,exactMass:32.97145876,spin:"3/2+",magneticMoment:"+0.643821",halfLife:-1},{id:"S34",massNumber:34,relativeAbundance:.0429,atomicNumber:16,exactMass:33.9678669,spin:"0+",halfLife:-1},{id:"S35",massNumber:35,exactMass:34.96903216,atomicNumber:16,spin:"3/2+",magneticMoment:"+1",halfLife:7544450,betaminusDecay:"0.1674",betaminusDecayLikeliness:"100.0"},{id:"S36",massNumber:36,relativeAbundance:2e-4,atomicNumber:16,exactMass:35.96708076,spin:"0+",halfLife:-1},{id:"S37",massNumber:37,exactMass:36.97112557,atomicNumber:16,halfLife:303},{id:"S38",massNumber:38,exactMass:37.971163,atomicNumber:16,halfLife:10218},{id:"S39",massNumber:39,exactMass:38.97513,atomicNumber:16,halfLife:11.5},{id:"S40",massNumber:40,exactMass:39.97545,atomicNumber:16,halfLife:8.8},{id:"S41",massNumber:41,exactMass:40.97958,atomicNumber:16},{id:"S42",massNumber:42,exactMass:41.98102,atomicNumber:16,halfLife:.56},{id:"S43",massNumber:43,exactMass:42.98715,atomicNumber:16,halfLife:.22},{id:"S44",massNumber:44,exactMass:43.99021,atomicNumber:16,halfLife:.123},{id:"S45",massNumber:45,exactMass:44.99651,atomicNumber:16,halfLife:.082},{id:"S46",massNumber:46,exactMass:46.00075,atomicNumber:16},{id:"S47",massNumber:47,exactMass:47.00859,atomicNumber:16},{id:"S48",massNumber:48,exactMass:48.01417,atomicNumber:16},{id:"S49",massNumber:49,exactMass:49.02362,atomicNumber:16}]},{elementSymbol:"Cl",atomicNumber:17,isotopes:[{id:"Cl28",massNumber:28,exactMass:28.02851,atomicNumber:17},{id:"Cl29",massNumber:29,exactMass:29.01411,atomicNumber:17},{id:"Cl30",massNumber:30,exactMass:30.00477,atomicNumber:17},{id:"Cl31",massNumber:31,exactMass:30.99241,atomicNumber:17,halfLife:.15},{id:"Cl32",massNumber:32,exactMass:31.98569,atomicNumber:17,halfLife:.298},{id:"Cl33",massNumber:33,exactMass:32.9774519,atomicNumber:17,halfLife:2.511},{id:"Cl34",massNumber:34,exactMass:33.97376282,atomicNumber:17,halfLife:1.5264},{id:"Cl35",massNumber:35,relativeAbundance:.7578,atomicNumber:17,exactMass:34.96885268,spin:"3/2+",magneticMoment:"+0.82187",halfLife:-1},{id:"Cl36",massNumber:36,exactMass:35.96830698,atomicNumber:17},{id:"Cl37",massNumber:37,relativeAbundance:.2422,atomicNumber:17,exactMass:36.96590259,spin:"3/2+",magneticMoment:"+0.68412",halfLife:-1},{id:"Cl38",massNumber:38,exactMass:37.96801043,atomicNumber:17,halfLife:2234.4},{id:"Cl39",massNumber:39,exactMass:38.9680082,atomicNumber:17,halfLife:3336},{id:"Cl40",massNumber:40,exactMass:39.97042,atomicNumber:17,halfLife:81},{id:"Cl41",massNumber:41,exactMass:40.97068,atomicNumber:17,halfLife:38.4},{id:"Cl42",massNumber:42,exactMass:41.97325,atomicNumber:17,halfLife:6.8},{id:"Cl43",massNumber:43,exactMass:42.97405,atomicNumber:17,halfLife:3.3},{id:"Cl44",massNumber:44,exactMass:43.97828,atomicNumber:17,halfLife:.434},{id:"Cl45",massNumber:45,exactMass:44.98029,atomicNumber:17,halfLife:.4},{id:"Cl46",massNumber:46,exactMass:45.98421,atomicNumber:17,halfLife:.223},{id:"Cl47",massNumber:47,exactMass:46.98871,atomicNumber:17},{id:"Cl48",massNumber:48,exactMass:47.99495,atomicNumber:17},{id:"Cl49",massNumber:49,exactMass:49.00032,atomicNumber:17},{id:"Cl50",massNumber:50,exactMass:50.00784,atomicNumber:17},{id:"Cl51",massNumber:51,exactMass:51.01449,atomicNumber:17}]},{elementSymbol:"Ar",atomicNumber:18,isotopes:[{id:"Ar30",massNumber:30,exactMass:30.02156,atomicNumber:18,halfLife:2e-8},{id:"Ar31",massNumber:31,exactMass:31.01212,atomicNumber:18,halfLife:.0151},{id:"Ar32",massNumber:32,exactMass:31.997638,atomicNumber:18,halfLife:.098},{id:"Ar33",massNumber:33,exactMass:32.9899257,atomicNumber:18,halfLife:.173},{id:"Ar34",massNumber:34,exactMass:33.9802712,atomicNumber:18,halfLife:.8445},{id:"Ar35",massNumber:35,exactMass:34.9752576,atomicNumber:18,halfLife:1.775},{id:"Ar36",massNumber:36,relativeAbundance:.0033650000000000004,atomicNumber:18,exactMass:35.96754511,spin:"0+",halfLife:-1},{id:"Ar37",massNumber:37,exactMass:36.96677632,atomicNumber:18,halfLife:3027460},{id:"Ar38",massNumber:38,relativeAbundance:.0006320000000000001,atomicNumber:18,exactMass:37.9627324,spin:"0+",halfLife:-1},{id:"Ar39",massNumber:39,exactMass:38.964313,atomicNumber:18,halfLife:848318e4},{id:"Ar40",massNumber:40,relativeAbundance:.9960030000000001,atomicNumber:18,exactMass:39.96238312,spin:"0+",halfLife:-1},{id:"Ar41",massNumber:41,exactMass:40.9645006,atomicNumber:18,halfLife:6560.4},{id:"Ar42",massNumber:42,exactMass:41.963046,atomicNumber:18,halfLife:103753e4},{id:"Ar43",massNumber:43,exactMass:42.965636,atomicNumber:18,halfLife:322.2},{id:"Ar44",massNumber:44,exactMass:43.964924,atomicNumber:18,halfLife:712.2},{id:"Ar45",massNumber:45,exactMass:44.96804,atomicNumber:18,halfLife:21.48},{id:"Ar46",massNumber:46,exactMass:45.96809,atomicNumber:18,halfLife:8.4},{id:"Ar47",massNumber:47,exactMass:46.97219,atomicNumber:18,halfLife:.7},{id:"Ar48",massNumber:48,exactMass:47.97454,atomicNumber:18},{id:"Ar49",massNumber:49,exactMass:48.98052,atomicNumber:18},{id:"Ar50",massNumber:50,exactMass:49.98443,atomicNumber:18},{id:"Ar51",massNumber:51,exactMass:50.99163,atomicNumber:18},{id:"Ar52",massNumber:52,exactMass:51.99678,atomicNumber:18},{id:"Ar53",massNumber:53,exactMass:53.00494,atomicNumber:18}]},{elementSymbol:"K",atomicNumber:19,isotopes:[{id:"K32",massNumber:32,exactMass:32.02192,atomicNumber:19},{id:"K33",massNumber:33,exactMass:33.00726,atomicNumber:19},{id:"K34",massNumber:34,exactMass:33.99841,atomicNumber:19},{id:"K35",massNumber:35,exactMass:34.98801,atomicNumber:19,halfLife:.19},{id:"K36",massNumber:36,exactMass:35.981292,atomicNumber:19,halfLife:.342},{id:"K37",massNumber:37,exactMass:36.97337589,atomicNumber:19,halfLife:1.226},{id:"K38",massNumber:38,exactMass:37.9690812,atomicNumber:19,halfLife:458.16},{id:"K39",massNumber:39,relativeAbundance:.932581,atomicNumber:19,exactMass:38.96370668,spin:"3/2+",magneticMoment:"+0.391466",halfLife:-1},{id:"K40",massNumber:40,relativeAbundance:117e-6,atomicNumber:19,exactMass:39.96399848,spin:"4-",magneticMoment:"-1.298099",halfLife:1277e6,betaminusDecay:"1.32",betaminusDecayLikeliness:"89.33",ecDecay:"",ecDecayLikeliness:"10.67"},{id:"K41",massNumber:41,relativeAbundance:.067302,atomicNumber:19,exactMass:40.96182576,spin:"3/2+",magneticMoment:"+0.2148699",halfLife:-1},{id:"K42",massNumber:42,exactMass:41.96240281,atomicNumber:19,halfLife:44496},{id:"K43",massNumber:43,exactMass:42.960716,atomicNumber:19,halfLife:80280},{id:"K44",massNumber:44,exactMass:43.96156,atomicNumber:19,halfLife:1327.8},{id:"K45",massNumber:45,exactMass:44.960699,atomicNumber:19,halfLife:1038},{id:"K46",massNumber:46,exactMass:45.961977,atomicNumber:19,halfLife:105},{id:"K47",massNumber:47,exactMass:46.961678,atomicNumber:19,halfLife:17.5},{id:"K48",massNumber:48,exactMass:47.965514,atomicNumber:19,halfLife:6.8},{id:"K49",massNumber:49,exactMass:48.96745,atomicNumber:19,halfLife:1.26},{id:"K50",massNumber:50,exactMass:49.97278,atomicNumber:19,halfLife:.472},{id:"K51",massNumber:51,exactMass:50.97638,atomicNumber:19,halfLife:.365},{id:"K52",massNumber:52,exactMass:51.98261,atomicNumber:19,halfLife:.105},{id:"K53",massNumber:53,exactMass:52.98712,atomicNumber:19,halfLife:.03},{id:"K54",massNumber:54,exactMass:53.9942,atomicNumber:19,halfLife:.01},{id:"K55",massNumber:55,exactMass:54.99971,atomicNumber:19}]},{elementSymbol:"Ca",atomicNumber:20,isotopes:[{id:"Ca34",massNumber:34,exactMass:34.01412,atomicNumber:20},{id:"Ca35",massNumber:35,exactMass:35.00494,atomicNumber:20,halfLife:.05},{id:"Ca36",massNumber:36,exactMass:35.99309,atomicNumber:20,halfLife:.102},{id:"Ca37",massNumber:37,exactMass:36.98587,atomicNumber:20,halfLife:.1811},{id:"Ca38",massNumber:38,exactMass:37.976318,atomicNumber:20,halfLife:.44},{id:"Ca39",massNumber:39,exactMass:38.9707197,atomicNumber:20,halfLife:.8596},{id:"Ca40",massNumber:40,relativeAbundance:.96941,atomicNumber:20,exactMass:39.96259098,spin:"0+",halfLife:-1},{id:"Ca41",massNumber:41,exactMass:40.96227806,atomicNumber:20},{id:"Ca42",massNumber:42,relativeAbundance:.00647,atomicNumber:20,exactMass:41.95861801,spin:"0+",halfLife:-1},{id:"Ca43",massNumber:43,relativeAbundance:.00135,atomicNumber:20,exactMass:42.9587666,spin:"7/2-",magneticMoment:"+1.31725",halfLife:-1},{id:"Ca44",massNumber:44,relativeAbundance:.02086,atomicNumber:20,exactMass:43.9554818,spin:"0+",halfLife:-1},{id:"Ca45",massNumber:45,exactMass:44.9561866,atomicNumber:20,spin:"7/2-",halfLife:14049500},{id:"Ca46",massNumber:46,relativeAbundance:4e-5,atomicNumber:20,exactMass:45.9536926,halfLife:-1,betaminusDecay:"0.257",betaminusDecayLikeliness:"100.0"},{id:"Ca47",massNumber:47,exactMass:46.954546,atomicNumber:20,halfLife:391910},{id:"Ca48",massNumber:48,relativeAbundance:.00187,atomicNumber:20,exactMass:47.952534,spin:"0+"},{id:"Ca49",massNumber:49,exactMass:48.955674,atomicNumber:20,halfLife:523.08},{id:"Ca50",massNumber:50,exactMass:49.957519,atomicNumber:20,halfLife:13.9},{id:"Ca51",massNumber:51,exactMass:50.9615,atomicNumber:20,halfLife:10},{id:"Ca52",massNumber:52,exactMass:51.9651,atomicNumber:20,halfLife:4.6},{id:"Ca53",massNumber:53,exactMass:52.97005,atomicNumber:20,halfLife:.09},{id:"Ca54",massNumber:54,exactMass:53.97435,atomicNumber:20},{id:"Ca55",massNumber:55,exactMass:54.98055,atomicNumber:20},{id:"Ca56",massNumber:56,exactMass:55.98557,atomicNumber:20},{id:"Ca57",massNumber:57,exactMass:56.99236,atomicNumber:20}]},{elementSymbol:"Sc",atomicNumber:21,isotopes:[{id:"Sc36",massNumber:36,exactMass:36.01492,atomicNumber:21},{id:"Sc37",massNumber:37,exactMass:37.00305,atomicNumber:21},{id:"Sc38",massNumber:38,exactMass:37.9947,atomicNumber:21},{id:"Sc39",massNumber:39,exactMass:38.98479,atomicNumber:21},{id:"Sc40",massNumber:40,exactMass:39.977967,atomicNumber:21,halfLife:.1823},{id:"Sc41",massNumber:41,exactMass:40.96925113,atomicNumber:21,halfLife:.5963},{id:"Sc42",massNumber:42,exactMass:41.96551643,atomicNumber:21,halfLife:.6813},{id:"Sc43",massNumber:43,exactMass:42.9611507,atomicNumber:21,halfLife:14007.6},{id:"Sc44",massNumber:44,exactMass:43.9594028,atomicNumber:21,halfLife:14137.2},{id:"Sc45",massNumber:45,relativeAbundance:1,atomicNumber:21,exactMass:44.9559119,spin:"7/2-",magneticMoment:"+4.756483",halfLife:-1},{id:"Sc46",massNumber:46,exactMass:45.9551719,atomicNumber:21,spin:"4+",halfLife:7239460,betaminusDecay:"2.367",betaminusDecayLikeliness:"100.0"},{id:"Sc47",massNumber:47,exactMass:46.9524075,atomicNumber:21,spin:"7/2-",halfLife:289371,betaminusDecay:"0.601",betaminusDecayLikeliness:"100.0"},{id:"Sc48",massNumber:48,exactMass:47.952231,atomicNumber:21,spin:"6+",halfLife:157212,betaminusDecay:"4.0",betaminusDecayLikeliness:"100.0"},{id:"Sc49",massNumber:49,exactMass:48.950024,atomicNumber:21,halfLife:3432},{id:"Sc50",massNumber:50,exactMass:49.952188,atomicNumber:21,halfLife:102.5},{id:"Sc51",massNumber:51,exactMass:50.953603,atomicNumber:21,halfLife:12.4},{id:"Sc52",massNumber:52,exactMass:51.95668,atomicNumber:21,halfLife:8.2},{id:"Sc53",massNumber:53,exactMass:52.95961,atomicNumber:21},{id:"Sc54",massNumber:54,exactMass:53.96326,atomicNumber:21},{id:"Sc55",massNumber:55,exactMass:54.96824,atomicNumber:21},{id:"Sc56",massNumber:56,exactMass:55.97287,atomicNumber:21},{id:"Sc57",massNumber:57,exactMass:56.97779,atomicNumber:21},{id:"Sc58",massNumber:58,exactMass:57.98371,atomicNumber:21},{id:"Sc59",massNumber:59,exactMass:58.98922,atomicNumber:21},{id:"Sc60",massNumber:60,exactMass:59.99571,atomicNumber:21}]},{elementSymbol:"Ti",atomicNumber:22,isotopes:[{id:"Ti38",massNumber:38,exactMass:38.00977,atomicNumber:22},{id:"Ti39",massNumber:39,exactMass:39.00161,atomicNumber:22,halfLife:.026},{id:"Ti40",massNumber:40,exactMass:39.9905,atomicNumber:22,halfLife:.05},{id:"Ti41",massNumber:41,exactMass:40.98315,atomicNumber:22,halfLife:.08},{id:"Ti42",massNumber:42,exactMass:41.973031,atomicNumber:22,halfLife:.199},{id:"Ti43",massNumber:43,exactMass:42.968522,atomicNumber:22,halfLife:.509},{id:"Ti44",massNumber:44,exactMass:43.9596901,atomicNumber:22,halfLife:198677e4},{id:"Ti45",massNumber:45,exactMass:44.9581256,atomicNumber:22,halfLife:11088},{id:"Ti46",massNumber:46,relativeAbundance:.0825,atomicNumber:22,exactMass:45.9526316,spin:"0+",halfLife:-1},{id:"Ti47",massNumber:47,relativeAbundance:.07440000000000001,atomicNumber:22,exactMass:46.9517631,spin:"5/2-",magneticMoment:"-0.78848",halfLife:-1},{id:"Ti48",massNumber:48,relativeAbundance:.7372,atomicNumber:22,exactMass:47.9479463,spin:"0+",halfLife:-1},{id:"Ti49",massNumber:49,relativeAbundance:.0541,atomicNumber:22,exactMass:48.94787,spin:"7/2-",magneticMoment:"-1.10417",halfLife:-1},{id:"Ti50",massNumber:50,relativeAbundance:.0518,atomicNumber:22,exactMass:49.9447912,spin:"0+",halfLife:-1},{id:"Ti51",massNumber:51,exactMass:50.946615,atomicNumber:22,halfLife:345.6},{id:"Ti52",massNumber:52,exactMass:51.946897,atomicNumber:22,halfLife:102},{id:"Ti53",massNumber:53,exactMass:52.94973,atomicNumber:22,halfLife:32.7},{id:"Ti54",massNumber:54,exactMass:53.95105,atomicNumber:22},{id:"Ti55",massNumber:55,exactMass:54.95527,atomicNumber:22,halfLife:.32},{id:"Ti56",massNumber:56,exactMass:55.9582,atomicNumber:22,halfLife:.16},{id:"Ti57",massNumber:57,exactMass:56.96399,atomicNumber:22,halfLife:.18},{id:"Ti58",massNumber:58,exactMass:57.96697,atomicNumber:22},{id:"Ti59",massNumber:59,exactMass:58.97293,atomicNumber:22},{id:"Ti60",massNumber:60,exactMass:59.97676,atomicNumber:22},{id:"Ti61",massNumber:61,exactMass:60.9832,atomicNumber:22},{id:"Ti62",massNumber:62,exactMass:61.98749,atomicNumber:22},{id:"Ti63",massNumber:63,exactMass:62.99442,atomicNumber:22}]},{elementSymbol:"V",atomicNumber:23,isotopes:[{id:"V40",massNumber:40,exactMass:40.01109,atomicNumber:23},{id:"V41",massNumber:41,exactMass:40.99978,atomicNumber:23},{id:"V42",massNumber:42,exactMass:41.99123,atomicNumber:23},{id:"V43",massNumber:43,exactMass:42.98065,atomicNumber:23,halfLife:.8},{id:"V44",massNumber:44,exactMass:43.97411,atomicNumber:23,halfLife:.09},{id:"V45",massNumber:45,exactMass:44.965776,atomicNumber:23,halfLife:.547},{id:"V46",massNumber:46,exactMass:45.9602005,atomicNumber:23,halfLife:.42237},{id:"V47",massNumber:47,exactMass:46.9549089,atomicNumber:23,halfLife:1956},{id:"V48",massNumber:48,exactMass:47.9522537,atomicNumber:23,halfLife:1380110},{id:"V49",massNumber:49,exactMass:48.9485161,atomicNumber:23,halfLife:28512e3},{id:"V50",massNumber:50,relativeAbundance:.0025,atomicNumber:23,exactMass:49.9471585,spin:"6+",magneticMoment:"+3.34745",halfLife:14e16,betaminusDecay:"",betaminusDecayLikeliness:"17.0",ecDecay:"",ecDecayLikeliness:"83"},{id:"V51",massNumber:51,relativeAbundance:.9975,atomicNumber:23,exactMass:50.9439595,spin:"7/2-",magneticMoment:"+5.1574",halfLife:-1},{id:"V52",massNumber:52,exactMass:51.9447755,atomicNumber:23,halfLife:224.58},{id:"V53",massNumber:53,exactMass:52.944338,atomicNumber:23,halfLife:96.6},{id:"V54",massNumber:54,exactMass:53.94644,atomicNumber:23,halfLife:49.8},{id:"V55",massNumber:55,exactMass:54.94723,atomicNumber:23,halfLife:6.54},{id:"V56",massNumber:56,exactMass:55.95053,atomicNumber:23,halfLife:.23},{id:"V57",massNumber:57,exactMass:56.95256,atomicNumber:23,halfLife:.32},{id:"V58",massNumber:58,exactMass:57.95683,atomicNumber:23,halfLife:.2},{id:"V59",massNumber:59,exactMass:58.96021,atomicNumber:23,halfLife:.13},{id:"V60",massNumber:60,exactMass:59.96503,atomicNumber:23,halfLife:.2},{id:"V61",massNumber:61,exactMass:60.96848,atomicNumber:23},{id:"V62",massNumber:62,exactMass:61.97378,atomicNumber:23},{id:"V63",massNumber:63,exactMass:62.97755,atomicNumber:23},{id:"V64",massNumber:64,exactMass:63.98347,atomicNumber:23},{id:"V65",massNumber:65,exactMass:64.98792,atomicNumber:23}]},{elementSymbol:"Cr",atomicNumber:24,isotopes:[{id:"Cr42",massNumber:42,exactMass:42.00643,atomicNumber:24},{id:"Cr43",massNumber:43,exactMass:42.99771,atomicNumber:24,halfLife:.021},{id:"Cr44",massNumber:44,exactMass:43.98555,atomicNumber:24,halfLife:.053},{id:"Cr45",massNumber:45,exactMass:44.97964,atomicNumber:24,halfLife:.05},{id:"Cr46",massNumber:46,exactMass:45.968359,atomicNumber:24,halfLife:.26},{id:"Cr47",massNumber:47,exactMass:46.9629,atomicNumber:24,halfLife:.5},{id:"Cr48",massNumber:48,exactMass:47.954032,atomicNumber:24,halfLife:77616},{id:"Cr49",massNumber:49,exactMass:48.9513357,atomicNumber:24,halfLife:2538},{id:"Cr50",massNumber:50,relativeAbundance:.043449999999999996,atomicNumber:24,exactMass:49.9460442,spin:"0+"},{id:"Cr51",massNumber:51,exactMass:50.9447674,atomicNumber:24,halfLife:2393500},{id:"Cr52",massNumber:52,relativeAbundance:.83789,atomicNumber:24,exactMass:51.9405075,spin:"0+",halfLife:-1},{id:"Cr53",massNumber:53,relativeAbundance:.09501,atomicNumber:24,exactMass:52.9406494,spin:"3/2-",magneticMoment:"-0.47454",halfLife:-1},{id:"Cr54",massNumber:54,relativeAbundance:.02365,atomicNumber:24,exactMass:53.9388804,spin:"0+",halfLife:-1},{id:"Cr55",massNumber:55,exactMass:54.9408397,atomicNumber:24,halfLife:209.82},{id:"Cr56",massNumber:56,exactMass:55.9406531,atomicNumber:24,halfLife:356.4},{id:"Cr57",massNumber:57,exactMass:56.943613,atomicNumber:24,halfLife:21.1},{id:"Cr58",massNumber:58,exactMass:57.94435,atomicNumber:24,halfLife:7},{id:"Cr59",massNumber:59,exactMass:58.94859,atomicNumber:24,halfLife:.74},{id:"Cr60",massNumber:60,exactMass:59.95008,atomicNumber:24,halfLife:.57},{id:"Cr61",massNumber:61,exactMass:60.95472,atomicNumber:24,halfLife:.27},{id:"Cr62",massNumber:62,exactMass:61.95661,atomicNumber:24,halfLife:.19},{id:"Cr63",massNumber:63,exactMass:62.96186,atomicNumber:24,halfLife:.11},{id:"Cr64",massNumber:64,exactMass:63.96441,atomicNumber:24},{id:"Cr65",massNumber:65,exactMass:64.97016,atomicNumber:24},{id:"Cr66",massNumber:66,exactMass:65.97338,atomicNumber:24},{id:"Cr67",massNumber:67,exactMass:66.97955,atomicNumber:24}]},{elementSymbol:"Mn",atomicNumber:25,isotopes:[{id:"Mn44",massNumber:44,exactMass:44.00687,atomicNumber:25},{id:"Mn45",massNumber:45,exactMass:44.99451,atomicNumber:25},{id:"Mn46",massNumber:46,exactMass:45.98672,atomicNumber:25,halfLife:.041},{id:"Mn47",massNumber:47,exactMass:46.9761,atomicNumber:25,halfLife:.1},{id:"Mn48",massNumber:48,exactMass:47.96852,atomicNumber:25,halfLife:.1581},{id:"Mn49",massNumber:49,exactMass:48.959618,atomicNumber:25,halfLife:.382},{id:"Mn50",massNumber:50,exactMass:49.9542382,atomicNumber:25,halfLife:.28388},{id:"Mn51",massNumber:51,exactMass:50.9482108,atomicNumber:25,halfLife:2772},{id:"Mn52",massNumber:52,exactMass:51.9455655,atomicNumber:25,halfLife:483062},{id:"Mn53",massNumber:53,exactMass:52.9412901,atomicNumber:25},{id:"Mn54",massNumber:54,exactMass:53.9403589,atomicNumber:25,spin:"3+",magneticMoment:"+3.2818",halfLife:26982700,ecDecay:"1.377",ecDecayLikeliness:"100.0"},{id:"Mn55",massNumber:55,relativeAbundance:1,atomicNumber:25,exactMass:54.9380451,spin:"5/2-",magneticMoment:"+3.4687",halfLife:-1},{id:"Mn56",massNumber:56,exactMass:55.9389049,atomicNumber:25,halfLife:9282.6},{id:"Mn57",massNumber:57,exactMass:56.9382854,atomicNumber:25,halfLife:85.4},{id:"Mn58",massNumber:58,exactMass:57.93998,atomicNumber:25,halfLife:3},{id:"Mn59",massNumber:59,exactMass:58.94044,atomicNumber:25,halfLife:4.6},{id:"Mn60",massNumber:60,exactMass:59.94291,atomicNumber:25,halfLife:51},{id:"Mn61",massNumber:61,exactMass:60.94465,atomicNumber:25,halfLife:.71},{id:"Mn62",massNumber:62,exactMass:61.94843,atomicNumber:25,halfLife:.88},{id:"Mn63",massNumber:63,exactMass:62.95024,atomicNumber:25,halfLife:.25},{id:"Mn64",massNumber:64,exactMass:63.95425,atomicNumber:25,halfLife:.14},{id:"Mn65",massNumber:65,exactMass:64.95634,atomicNumber:25,halfLife:.11},{id:"Mn66",massNumber:66,exactMass:65.96108,atomicNumber:25,halfLife:.09},{id:"Mn67",massNumber:67,exactMass:66.96414,atomicNumber:25},{id:"Mn68",massNumber:68,exactMass:67.9693,atomicNumber:25},{id:"Mn69",massNumber:69,exactMass:68.97284,atomicNumber:25}]},{elementSymbol:"Fe",atomicNumber:26,isotopes:[{id:"Fe45",massNumber:45,exactMass:45.01458,atomicNumber:26},{id:"Fe46",massNumber:46,exactMass:46.00081,atomicNumber:26,halfLife:.02},{id:"Fe47",massNumber:47,exactMass:46.99289,atomicNumber:26,halfLife:.027},{id:"Fe48",massNumber:48,exactMass:47.9805,atomicNumber:26,halfLife:.044},{id:"Fe49",massNumber:49,exactMass:48.97361,atomicNumber:26,halfLife:.07},{id:"Fe50",massNumber:50,exactMass:49.96299,atomicNumber:26,halfLife:.15},{id:"Fe51",massNumber:51,exactMass:50.95682,atomicNumber:26,halfLife:.305},{id:"Fe52",massNumber:52,exactMass:51.948114,atomicNumber:26,halfLife:29790},{id:"Fe53",massNumber:53,exactMass:52.9453079,atomicNumber:26,halfLife:510.6},{id:"Fe54",massNumber:54,relativeAbundance:.058449999999999995,atomicNumber:26,exactMass:53.9396105,spin:"0+",halfLife:-1},{id:"Fe55",massNumber:55,exactMass:54.9382934,atomicNumber:26,halfLife:86093300},{id:"Fe56",massNumber:56,relativeAbundance:.91754,atomicNumber:26,exactMass:55.9349375,spin:"0+",halfLife:-1},{id:"Fe57",massNumber:57,relativeAbundance:.02119,atomicNumber:26,exactMass:56.935394,spin:"1/2-",magneticMoment:"+0.09044",halfLife:-1},{id:"Fe58",massNumber:58,relativeAbundance:.0028199999999999996,atomicNumber:26,exactMass:57.9332756,spin:"0+",halfLife:-1},{id:"Fe59",massNumber:59,exactMass:58.9348755,atomicNumber:26,halfLife:3845060},{id:"Fe60",massNumber:60,exactMass:59.934072,atomicNumber:26},{id:"Fe61",massNumber:61,exactMass:60.936745,atomicNumber:26,halfLife:358.8},{id:"Fe62",massNumber:62,exactMass:61.936767,atomicNumber:26,halfLife:68},{id:"Fe63",massNumber:63,exactMass:62.94037,atomicNumber:26,halfLife:6.1},{id:"Fe64",massNumber:64,exactMass:63.9412,atomicNumber:26},{id:"Fe65",massNumber:65,exactMass:64.94538,atomicNumber:26,halfLife:.4},{id:"Fe66",massNumber:66,exactMass:65.94678,atomicNumber:26,halfLife:.44},{id:"Fe67",massNumber:67,exactMass:66.95095,atomicNumber:26,halfLife:.47},{id:"Fe68",massNumber:68,exactMass:67.9537,atomicNumber:26,halfLife:.1},{id:"Fe69",massNumber:69,exactMass:68.95878,atomicNumber:26,halfLife:.17},{id:"Fe70",massNumber:70,exactMass:69.96146,atomicNumber:26},{id:"Fe71",massNumber:71,exactMass:70.96672,atomicNumber:26},{id:"Fe72",massNumber:72,exactMass:71.96962,atomicNumber:26}]},{elementSymbol:"Co",atomicNumber:27,isotopes:[{id:"Co47",massNumber:47,exactMass:47.01149,atomicNumber:27},{id:"Co48",massNumber:48,exactMass:48.00176,atomicNumber:27},{id:"Co49",massNumber:49,exactMass:48.98972,atomicNumber:27},{id:"Co50",massNumber:50,exactMass:49.98154,atomicNumber:27,halfLife:.044},{id:"Co51",massNumber:51,exactMass:50.97072,atomicNumber:27},{id:"Co52",massNumber:52,exactMass:51.96359,atomicNumber:27,halfLife:.018},{id:"Co53",massNumber:53,exactMass:52.954219,atomicNumber:27,halfLife:.24},{id:"Co54",massNumber:54,exactMass:53.9484596,atomicNumber:27,halfLife:.19323},{id:"Co55",massNumber:55,exactMass:54.941999,atomicNumber:27,halfLife:63108},{id:"Co56",massNumber:56,exactMass:55.9398393,atomicNumber:27,spin:"4+",halfLife:6676130,betaplusDecay:"4.566",betaplusDecayLikeliness:"100.0",ecDecay:"",ecDecayLikeliness:"100.0"},{id:"Co57",massNumber:57,exactMass:56.9362914,atomicNumber:27,spin:"7/2-",halfLife:23482700,ecDecay:"0.836",ecDecayLikeliness:"100.0"},{id:"Co58",massNumber:58,exactMass:57.9357528,atomicNumber:27,spin:"2+",halfLife:6122300,betaplusDecay:"2.3",betaplusDecayLikeliness:"100.0",ecDecay:"",ecDecayLikeliness:"100.0"},{id:"Co59",massNumber:59,relativeAbundance:1,atomicNumber:27,exactMass:58.933195,spin:"7/2-",magneticMoment:"+4.627",halfLife:-1},{id:"Co60",massNumber:60,exactMass:59.9338171,atomicNumber:27,spin:"5+",magneticMoment:"+3.799",halfLife:166239e3,betaminusDecay:"2.824",betaminusDecayLikeliness:"100.0"},{id:"Co61",massNumber:61,exactMass:60.9324758,atomicNumber:27,halfLife:5940},{id:"Co62",massNumber:62,exactMass:61.934051,atomicNumber:27,halfLife:90},{id:"Co63",massNumber:63,exactMass:62.933612,atomicNumber:27,halfLife:27.4},{id:"Co64",massNumber:64,exactMass:63.93581,atomicNumber:27,halfLife:.3},{id:"Co65",massNumber:65,exactMass:64.936478,atomicNumber:27,halfLife:1.2},{id:"Co66",massNumber:66,exactMass:65.93976,atomicNumber:27,halfLife:.233},{id:"Co67",massNumber:67,exactMass:66.94089,atomicNumber:27,halfLife:.42},{id:"Co68",massNumber:68,exactMass:67.94487,atomicNumber:27,halfLife:.18},{id:"Co69",massNumber:69,exactMass:68.94632,atomicNumber:27,halfLife:.27},{id:"Co70",massNumber:70,exactMass:69.951,atomicNumber:27,halfLife:.15},{id:"Co71",massNumber:71,exactMass:70.9529,atomicNumber:27,halfLife:.21},{id:"Co72",massNumber:72,exactMass:71.95781,atomicNumber:27,halfLife:.09},{id:"Co73",massNumber:73,exactMass:72.96024,atomicNumber:27},{id:"Co74",massNumber:74,exactMass:73.96538,atomicNumber:27},{id:"Co75",massNumber:75,exactMass:74.96833,atomicNumber:27}]},{elementSymbol:"Ni",atomicNumber:28,isotopes:[{id:"Ni48",massNumber:48,exactMass:48.01975,atomicNumber:28},{id:"Ni49",massNumber:49,exactMass:49.00966,atomicNumber:28},{id:"Ni50",massNumber:50,exactMass:49.99593,atomicNumber:28},{id:"Ni51",massNumber:51,exactMass:50.98772,atomicNumber:28},{id:"Ni52",massNumber:52,exactMass:51.97568,atomicNumber:28,halfLife:.038},{id:"Ni53",massNumber:53,exactMass:52.96847,atomicNumber:28,halfLife:.045},{id:"Ni54",massNumber:54,exactMass:53.95791,atomicNumber:28},{id:"Ni55",massNumber:55,exactMass:54.95133,atomicNumber:28,halfLife:.2121},{id:"Ni56",massNumber:56,exactMass:55.942132,atomicNumber:28,halfLife:525053},{id:"Ni57",massNumber:57,exactMass:56.9397935,atomicNumber:28,halfLife:128160},{id:"Ni58",massNumber:58,relativeAbundance:.680769,atomicNumber:28,exactMass:57.9353429,spin:"0+",halfLife:-1},{id:"Ni59",massNumber:59,exactMass:58.9343467,atomicNumber:28,spin:"3/2-",halfLife:75e3,ecDecay:"1.072",ecDecayLikeliness:"100.0"},{id:"Ni60",massNumber:60,relativeAbundance:.262231,atomicNumber:28,exactMass:59.9307864,spin:"0+",halfLife:-1},{id:"Ni61",massNumber:61,relativeAbundance:.011399,atomicNumber:28,exactMass:60.931056,spin:"3/2-",magneticMoment:"-0.75002",halfLife:-1},{id:"Ni62",massNumber:62,relativeAbundance:.036345,atomicNumber:28,exactMass:61.9283451,spin:"0+",halfLife:-1},{id:"Ni63",massNumber:63,exactMass:62.9296694,atomicNumber:28,spin:"1/2-",halfLife:315675e4,betaminusDecay:"0.065",betaminusDecayLikeliness:"100.0"},{id:"Ni64",massNumber:64,relativeAbundance:.009256,atomicNumber:28,exactMass:63.927966,spin:"0+",halfLife:-1},{id:"Ni65",massNumber:65,exactMass:64.9300843,atomicNumber:28,halfLife:9061.92},{id:"Ni66",massNumber:66,exactMass:65.9291393,atomicNumber:28,halfLife:196560},{id:"Ni67",massNumber:67,exactMass:66.931569,atomicNumber:28,halfLife:21},{id:"Ni68",massNumber:68,exactMass:67.931869,atomicNumber:28,halfLife:19},{id:"Ni69",massNumber:69,exactMass:68.93561,atomicNumber:28,halfLife:11.4},{id:"Ni70",massNumber:70,exactMass:69.9365,atomicNumber:28},{id:"Ni71",massNumber:71,exactMass:70.94074,atomicNumber:28,halfLife:1.86},{id:"Ni72",massNumber:72,exactMass:71.94209,atomicNumber:28,halfLife:2.1},{id:"Ni73",massNumber:73,exactMass:72.94647,atomicNumber:28,halfLife:.7},{id:"Ni74",massNumber:74,exactMass:73.94807,atomicNumber:28,halfLife:.54},{id:"Ni75",massNumber:75,exactMass:74.95287,atomicNumber:28,halfLife:.6},{id:"Ni76",massNumber:76,exactMass:75.95533,atomicNumber:28,halfLife:.24},{id:"Ni77",massNumber:77,exactMass:76.96055,atomicNumber:28},{id:"Ni78",massNumber:78,exactMass:77.96318,atomicNumber:28}]},{elementSymbol:"Cu",atomicNumber:29,isotopes:[{id:"Cu52",massNumber:52,exactMass:51.99718,atomicNumber:29},{id:"Cu53",massNumber:53,exactMass:52.98555,atomicNumber:29},{id:"Cu54",massNumber:54,exactMass:53.97671,atomicNumber:29},{id:"Cu55",massNumber:55,exactMass:54.96605,atomicNumber:29},{id:"Cu56",massNumber:56,exactMass:55.95856,atomicNumber:29},{id:"Cu57",massNumber:57,exactMass:56.949211,atomicNumber:29,halfLife:.1994},{id:"Cu58",massNumber:58,exactMass:57.9445385,atomicNumber:29,halfLife:3.204},{id:"Cu59",massNumber:59,exactMass:58.939498,atomicNumber:29,halfLife:81.5},{id:"Cu60",massNumber:60,exactMass:59.937365,atomicNumber:29,halfLife:1422},{id:"Cu61",massNumber:61,exactMass:60.9334578,atomicNumber:29,halfLife:11998.8},{id:"Cu62",massNumber:62,exactMass:61.932584,atomicNumber:29,halfLife:584.4},{id:"Cu63",massNumber:63,relativeAbundance:.6917,atomicNumber:29,exactMass:62.9295975,spin:"3/2-",magneticMoment:"+2.2233",halfLife:-1},{id:"Cu64",massNumber:64,exactMass:63.9297642,atomicNumber:29,spin:"1+",magneticMoment:"-0.217",halfLife:45720,betaplusDecay:"1.7",betaplusDecayLikeliness:"19.0",betaminusDecay:"0.578",betaminusDecayLikeliness:"39.0",ecDecay:"1.675",ecDecayLikeliness:"41.0"},{id:"Cu65",massNumber:65,relativeAbundance:.30829999999999996,atomicNumber:29,exactMass:64.9277895,spin:"3/2-",magneticMoment:"+2.3817",halfLife:-1},{id:"Cu66",massNumber:66,exactMass:65.9288688,atomicNumber:29,halfLife:307.2},{id:"Cu67",massNumber:67,exactMass:66.9277303,atomicNumber:29,halfLife:222588},{id:"Cu68",massNumber:68,exactMass:67.9296109,atomicNumber:29,halfLife:31.1},{id:"Cu69",massNumber:69,exactMass:68.9294293,atomicNumber:29,halfLife:171},{id:"Cu70",massNumber:70,exactMass:69.9323923,atomicNumber:29,halfLife:4.5},{id:"Cu71",massNumber:71,exactMass:70.9326768,atomicNumber:29,halfLife:19.5},{id:"Cu72",massNumber:72,exactMass:71.9358203,atomicNumber:29,halfLife:6.6},{id:"Cu73",massNumber:73,exactMass:72.936675,atomicNumber:29,halfLife:3.9},{id:"Cu74",massNumber:74,exactMass:73.939875,atomicNumber:29,halfLife:1.594},{id:"Cu75",massNumber:75,exactMass:74.9419,atomicNumber:29,halfLife:1.224},{id:"Cu76",massNumber:76,exactMass:75.945275,atomicNumber:29,halfLife:.641},{id:"Cu77",massNumber:77,exactMass:76.94785,atomicNumber:29,halfLife:.469},{id:"Cu78",massNumber:78,exactMass:77.95196,atomicNumber:29,halfLife:.342},{id:"Cu79",massNumber:79,exactMass:78.95456,atomicNumber:29,halfLife:.188},{id:"Cu80",massNumber:80,exactMass:79.96087,atomicNumber:29}]},{elementSymbol:"Zn",atomicNumber:30,isotopes:[{id:"Zn54",massNumber:54,exactMass:53.99295,atomicNumber:30},{id:"Zn55",massNumber:55,exactMass:54.98398,atomicNumber:30},{id:"Zn56",massNumber:56,exactMass:55.97238,atomicNumber:30},{id:"Zn57",massNumber:57,exactMass:56.96479,atomicNumber:30,halfLife:.04},{id:"Zn58",massNumber:58,exactMass:57.95459,atomicNumber:30,halfLife:.065},{id:"Zn59",massNumber:59,exactMass:58.94926,atomicNumber:30,halfLife:.182},{id:"Zn60",massNumber:60,exactMass:59.941827,atomicNumber:30,halfLife:142.8},{id:"Zn61",massNumber:61,exactMass:60.939511,atomicNumber:30,halfLife:89.1},{id:"Zn62",massNumber:62,exactMass:61.93433,atomicNumber:30,halfLife:33069.6},{id:"Zn63",massNumber:63,exactMass:62.9332116,atomicNumber:30,halfLife:2308.2},{id:"Zn64",massNumber:64,relativeAbundance:.4863,atomicNumber:30,exactMass:63.9291422,spin:"0+",halfLife:-1},{id:"Zn65",massNumber:65,exactMass:64.929241,atomicNumber:30,spin:"5/2-",magneticMoment:"+0.7690",halfLife:21104100,betaplusDecay:"1.352",betaplusDecayLikeliness:"98.0",ecDecay:"",ecDecayLikeliness:"1.5"},{id:"Zn66",massNumber:66,relativeAbundance:.27899999999999997,atomicNumber:30,exactMass:65.9260334,spin:"0+",halfLife:-1},{id:"Zn67",massNumber:67,relativeAbundance:.040999999999999995,atomicNumber:30,exactMass:66.9271273,spin:"5/2-",magneticMoment:"+0.87515",halfLife:-1},{id:"Zn68",massNumber:68,relativeAbundance:.1875,atomicNumber:30,exactMass:67.9248442,spin:"0+",halfLife:-1},{id:"Zn69",massNumber:69,exactMass:68.9265503,atomicNumber:30,halfLife:3384},{id:"Zn70",massNumber:70,relativeAbundance:.0062,atomicNumber:30,exactMass:69.9253193,spin:"0+"},{id:"Zn71",massNumber:71,exactMass:70.927722,atomicNumber:30,halfLife:147},{id:"Zn72",massNumber:72,exactMass:71.926858,atomicNumber:30,halfLife:167400},{id:"Zn73",massNumber:73,exactMass:72.92978,atomicNumber:30,halfLife:23.5},{id:"Zn74",massNumber:74,exactMass:73.92946,atomicNumber:30,halfLife:95.6},{id:"Zn75",massNumber:75,exactMass:74.93294,atomicNumber:30,halfLife:10.2},{id:"Zn76",massNumber:76,exactMass:75.93329,atomicNumber:30,halfLife:5.7},{id:"Zn77",massNumber:77,exactMass:76.93696,atomicNumber:30,halfLife:2.08},{id:"Zn78",massNumber:78,exactMass:77.93844,atomicNumber:30,halfLife:1.47},{id:"Zn79",massNumber:79,exactMass:78.94265,atomicNumber:30,halfLife:.995},{id:"Zn80",massNumber:80,exactMass:79.94434,atomicNumber:30,halfLife:.545},{id:"Zn81",massNumber:81,exactMass:80.95048,atomicNumber:30,halfLife:.29},{id:"Zn82",massNumber:82,exactMass:81.95442,atomicNumber:30},{id:"Zn83",massNumber:83,exactMass:82.96103,atomicNumber:30}]},{elementSymbol:"Ga",atomicNumber:31,isotopes:[{id:"Ga56",massNumber:56,exactMass:55.99491,atomicNumber:31},{id:"Ga57",massNumber:57,exactMass:56.98293,atomicNumber:31},{id:"Ga58",massNumber:58,exactMass:57.97425,atomicNumber:31},{id:"Ga59",massNumber:59,exactMass:58.96337,atomicNumber:31},{id:"Ga60",massNumber:60,exactMass:59.95706,atomicNumber:31},{id:"Ga61",massNumber:61,exactMass:60.94945,atomicNumber:31,halfLife:.15},{id:"Ga62",massNumber:62,exactMass:61.944175,atomicNumber:31,halfLife:.11612},{id:"Ga63",massNumber:63,exactMass:62.9392942,atomicNumber:31,halfLife:32.4},{id:"Ga64",massNumber:64,exactMass:63.9368387,atomicNumber:31,halfLife:157.62},{id:"Ga65",massNumber:65,exactMass:64.9327348,atomicNumber:31,halfLife:912},{id:"Ga66",massNumber:66,exactMass:65.931589,atomicNumber:31,halfLife:34164},{id:"Ga67",massNumber:67,exactMass:66.9282017,atomicNumber:31,halfLife:281768},{id:"Ga68",massNumber:68,exactMass:67.9279801,atomicNumber:31,halfLife:4057.74},{id:"Ga69",massNumber:69,relativeAbundance:.60108,atomicNumber:31,exactMass:68.9255736,spin:"3/2-",magneticMoment:"+2.01659",halfLife:-1},{id:"Ga70",massNumber:70,exactMass:69.926022,atomicNumber:31,halfLife:1268.4},{id:"Ga71",massNumber:71,relativeAbundance:.39892000000000005,atomicNumber:31,exactMass:70.9247013,spin:"3/2-",magneticMoment:"2.56227",halfLife:-1},{id:"Ga72",massNumber:72,exactMass:71.9263663,atomicNumber:31,halfLife:50760},{id:"Ga73",massNumber:73,exactMass:72.9251747,atomicNumber:31,halfLife:17496},{id:"Ga74",massNumber:74,exactMass:73.926946,atomicNumber:31,halfLife:487.2},{id:"Ga75",massNumber:75,exactMass:74.9265002,atomicNumber:31,halfLife:126},{id:"Ga76",massNumber:76,exactMass:75.9288276,atomicNumber:31,halfLife:32.6},{id:"Ga77",massNumber:77,exactMass:76.9291543,atomicNumber:31,halfLife:13.2},{id:"Ga78",massNumber:78,exactMass:77.9316082,atomicNumber:31,halfLife:5.09},{id:"Ga79",massNumber:79,exactMass:78.93289,atomicNumber:31,halfLife:2.847},{id:"Ga80",massNumber:80,exactMass:79.93652,atomicNumber:31,halfLife:1.697},{id:"Ga81",massNumber:81,exactMass:80.93775,atomicNumber:31,halfLife:1.217},{id:"Ga82",massNumber:82,exactMass:81.94299,atomicNumber:31,halfLife:.599},{id:"Ga83",massNumber:83,exactMass:82.94698,atomicNumber:31,halfLife:.31},{id:"Ga84",massNumber:84,exactMass:83.95265,atomicNumber:31,halfLife:.085},{id:"Ga85",massNumber:85,exactMass:84.957,atomicNumber:31},{id:"Ga86",massNumber:86,exactMass:85.96312,atomicNumber:31}]},{elementSymbol:"Ge",atomicNumber:32,isotopes:[{id:"Ge58",massNumber:58,exactMass:57.99101,atomicNumber:32},{id:"Ge59",massNumber:59,exactMass:58.98175,atomicNumber:32},{id:"Ge60",massNumber:60,exactMass:59.97019,atomicNumber:32},{id:"Ge61",massNumber:61,exactMass:60.96379,atomicNumber:32,halfLife:.04},{id:"Ge62",massNumber:62,exactMass:61.95465,atomicNumber:32},{id:"Ge63",massNumber:63,exactMass:62.94964,atomicNumber:32,halfLife:.095},{id:"Ge64",massNumber:64,exactMass:63.94165,atomicNumber:32,halfLife:63.7},{id:"Ge65",massNumber:65,exactMass:64.93944,atomicNumber:32,halfLife:30.9},{id:"Ge66",massNumber:66,exactMass:65.93384,atomicNumber:32,halfLife:8136},{id:"Ge67",massNumber:67,exactMass:66.932734,atomicNumber:32,halfLife:1134},{id:"Ge68",massNumber:68,exactMass:67.928094,atomicNumber:32,halfLife:23397100},{id:"Ge69",massNumber:69,exactMass:68.9279645,atomicNumber:32,halfLife:140580},{id:"Ge70",massNumber:70,relativeAbundance:.2084,atomicNumber:32,exactMass:69.9242474,spin:"0+",halfLife:-1},{id:"Ge71",massNumber:71,exactMass:70.924951,atomicNumber:32,halfLife:987552},{id:"Ge72",massNumber:72,relativeAbundance:.2754,atomicNumber:32,exactMass:71.9220758,spin:"0+",halfLife:-1},{id:"Ge73",massNumber:73,relativeAbundance:.07730000000000001,atomicNumber:32,exactMass:72.9234589,spin:"9/2+",magneticMoment:"-0.879467",halfLife:-1},{id:"Ge74",massNumber:74,relativeAbundance:.3628,atomicNumber:32,exactMass:73.9211778,spin:"0+",halfLife:-1},{id:"Ge75",massNumber:75,exactMass:74.9228589,atomicNumber:32,halfLife:4966.8},{id:"Ge76",massNumber:76,relativeAbundance:.0761,atomicNumber:32,exactMass:75.9214026,spin:"0+",halfLife:-1},{id:"Ge77",massNumber:77,exactMass:76.9235486,atomicNumber:32,halfLife:40680},{id:"Ge78",massNumber:78,exactMass:77.922853,atomicNumber:32,halfLife:5280},{id:"Ge79",massNumber:79,exactMass:78.9254,atomicNumber:32,halfLife:18.98},{id:"Ge80",massNumber:80,exactMass:79.92537,atomicNumber:32,halfLife:29.5},{id:"Ge81",massNumber:81,exactMass:80.92882,atomicNumber:32,halfLife:7.6},{id:"Ge82",massNumber:82,exactMass:81.92955,atomicNumber:32,halfLife:4.6},{id:"Ge83",massNumber:83,exactMass:82.93462,atomicNumber:32,halfLife:1.85},{id:"Ge84",massNumber:84,exactMass:83.93747,atomicNumber:32},{id:"Ge85",massNumber:85,exactMass:84.94303,atomicNumber:32},{id:"Ge86",massNumber:86,exactMass:85.94649,atomicNumber:32},{id:"Ge87",massNumber:87,exactMass:86.95251,atomicNumber:32},{id:"Ge88",massNumber:88,exactMass:87.95691,atomicNumber:32},{id:"Ge89",massNumber:89,exactMass:88.96383,atomicNumber:32}]},{elementSymbol:"As",atomicNumber:33,isotopes:[{id:"As60",massNumber:60,exactMass:59.99313,atomicNumber:33},{id:"As61",massNumber:61,exactMass:60.98062,atomicNumber:33},{id:"As62",massNumber:62,exactMass:61.9732,atomicNumber:33},{id:"As63",massNumber:63,exactMass:62.96369,atomicNumber:33},{id:"As64",massNumber:64,exactMass:63.95757,atomicNumber:33},{id:"As65",massNumber:65,exactMass:64.94956,atomicNumber:33,halfLife:.19},{id:"As66",massNumber:66,exactMass:65.94471,atomicNumber:33,halfLife:.09577},{id:"As67",massNumber:67,exactMass:66.93919,atomicNumber:33,halfLife:42.5},{id:"As68",massNumber:68,exactMass:67.93677,atomicNumber:33,halfLife:151.6},{id:"As69",massNumber:69,exactMass:68.93227,atomicNumber:33,halfLife:912},{id:"As70",massNumber:70,exactMass:69.93092,atomicNumber:33,halfLife:3156},{id:"As71",massNumber:71,exactMass:70.927112,atomicNumber:33,halfLife:235008},{id:"As72",massNumber:72,exactMass:71.926752,atomicNumber:33,halfLife:93600},{id:"As73",massNumber:73,exactMass:72.923825,atomicNumber:33,halfLife:6937920},{id:"As74",massNumber:74,exactMass:73.9239287,atomicNumber:33,halfLife:1535330},{id:"As75",massNumber:75,relativeAbundance:1,atomicNumber:33,exactMass:74.9215965,spin:"3/2-",magneticMoment:"+1.43947",halfLife:-1},{id:"As76",massNumber:76,exactMass:75.922394,atomicNumber:33,spin:"2-",magneticMoment:"-0.906",halfLife:93121.9,betaminusDecay:"2.97",betaminusDecayLikeliness:"100.0"},{id:"As77",massNumber:77,exactMass:76.9206473,atomicNumber:33,halfLife:139788},{id:"As78",massNumber:78,exactMass:77.921827,atomicNumber:33,halfLife:5442},{id:"As79",massNumber:79,exactMass:78.920948,atomicNumber:33,halfLife:540.6},{id:"As80",massNumber:80,exactMass:79.922534,atomicNumber:33,halfLife:15.2},{id:"As81",massNumber:81,exactMass:80.922132,atomicNumber:33,halfLife:33.3},{id:"As82",massNumber:82,exactMass:81.9245,atomicNumber:33,halfLife:19.1},{id:"As83",massNumber:83,exactMass:82.92498,atomicNumber:33,halfLife:13.4},{id:"As84",massNumber:84,exactMass:83.92906,atomicNumber:33,halfLife:4.5},{id:"As85",massNumber:85,exactMass:84.93202,atomicNumber:33,halfLife:2.021},{id:"As86",massNumber:86,exactMass:85.9365,atomicNumber:33,halfLife:.945},{id:"As87",massNumber:87,exactMass:86.9399,atomicNumber:33,halfLife:.48},{id:"As88",massNumber:88,exactMass:87.94494,atomicNumber:33},{id:"As89",massNumber:89,exactMass:88.94939,atomicNumber:33},{id:"As90",massNumber:90,exactMass:89.9555,atomicNumber:33},{id:"As91",massNumber:91,exactMass:90.96043,atomicNumber:33},{id:"As92",massNumber:92,exactMass:91.9668,atomicNumber:33}]},{elementSymbol:"Se",atomicNumber:34,isotopes:[{id:"Se65",massNumber:65,exactMass:64.96466,atomicNumber:34},{id:"Se66",massNumber:66,exactMass:65.95521,atomicNumber:34},{id:"Se67",massNumber:67,exactMass:66.95009,atomicNumber:34,halfLife:.06},{id:"Se68",massNumber:68,exactMass:67.9418,atomicNumber:34,halfLife:35.5},{id:"Se69",massNumber:69,exactMass:68.93956,atomicNumber:34,halfLife:27.4},{id:"Se70",massNumber:70,exactMass:69.93339,atomicNumber:34,halfLife:2466},{id:"Se71",massNumber:71,exactMass:70.93224,atomicNumber:34,halfLife:284.4},{id:"Se72",massNumber:72,exactMass:71.927112,atomicNumber:34,halfLife:725760},{id:"Se73",massNumber:73,exactMass:72.926765,atomicNumber:34,halfLife:25740},{id:"Se74",massNumber:74,relativeAbundance:.0089,atomicNumber:34,exactMass:73.9224764,spin:"0+",halfLife:-1},{id:"Se75",massNumber:75,exactMass:74.9225234,atomicNumber:34,halfLife:10348900},{id:"Se76",massNumber:76,relativeAbundance:.09369999999999999,atomicNumber:34,exactMass:75.9192136,spin:"0+",halfLife:-1},{id:"Se77",massNumber:77,relativeAbundance:.07629999999999999,atomicNumber:34,exactMass:76.919914,spin:"1/2-",magneticMoment:"+0.535506",halfLife:-1},{id:"Se78",massNumber:78,relativeAbundance:.2377,atomicNumber:34,exactMass:77.9173091,spin:"0+",halfLife:-1},{id:"Se79",massNumber:79,exactMass:78.9184991,atomicNumber:34},{id:"Se80",massNumber:80,relativeAbundance:.4961,atomicNumber:34,exactMass:79.9165213,spin:"0+",halfLife:-1},{id:"Se81",massNumber:81,exactMass:80.9179925,atomicNumber:34,halfLife:1107},{id:"Se82",massNumber:82,relativeAbundance:.0873,atomicNumber:34,exactMass:81.9166994,spin:"0+"},{id:"Se83",massNumber:83,exactMass:82.919118,atomicNumber:34,halfLife:1338},{id:"Se84",massNumber:84,exactMass:83.918462,atomicNumber:34,halfLife:186},{id:"Se85",massNumber:85,exactMass:84.92225,atomicNumber:34,halfLife:31.7},{id:"Se86",massNumber:86,exactMass:85.924272,atomicNumber:34,halfLife:15.3},{id:"Se87",massNumber:87,exactMass:86.92852,atomicNumber:34,halfLife:5.29},{id:"Se88",massNumber:88,exactMass:87.93142,atomicNumber:34,halfLife:1.53},{id:"Se89",massNumber:89,exactMass:88.93645,atomicNumber:34,halfLife:.41},{id:"Se90",massNumber:90,exactMass:89.93996,atomicNumber:34},{id:"Se91",massNumber:91,exactMass:90.94596,atomicNumber:34,halfLife:.27},{id:"Se92",massNumber:92,exactMass:91.94992,atomicNumber:34},{id:"Se93",massNumber:93,exactMass:92.95629,atomicNumber:34},{id:"Se94",massNumber:94,exactMass:93.96049,atomicNumber:34}]},{elementSymbol:"Br",atomicNumber:35,isotopes:[{id:"Br67",massNumber:67,exactMass:66.96479,atomicNumber:35},{id:"Br68",massNumber:68,exactMass:67.95852,atomicNumber:35},{id:"Br69",massNumber:69,exactMass:68.95011,atomicNumber:35},{id:"Br70",massNumber:70,exactMass:69.94479,atomicNumber:35,halfLife:.0791},{id:"Br71",massNumber:71,exactMass:70.93874,atomicNumber:35,halfLife:21.4},{id:"Br72",massNumber:72,exactMass:71.93664,atomicNumber:35,halfLife:78.6},{id:"Br73",massNumber:73,exactMass:72.93169,atomicNumber:35,halfLife:204},{id:"Br74",massNumber:74,exactMass:73.929891,atomicNumber:35,halfLife:1524},{id:"Br75",massNumber:75,exactMass:74.925776,atomicNumber:35,halfLife:5802},{id:"Br76",massNumber:76,exactMass:75.924541,atomicNumber:35,halfLife:58320},{id:"Br77",massNumber:77,exactMass:76.921379,atomicNumber:35,halfLife:205330},{id:"Br78",massNumber:78,exactMass:77.921146,atomicNumber:35,halfLife:387.6},{id:"Br79",massNumber:79,relativeAbundance:.5069,atomicNumber:35,exactMass:78.9183371,spin:"3/2-",magneticMoment:"+2.1064",halfLife:-1},{id:"Br80",massNumber:80,exactMass:79.9185293,atomicNumber:35,halfLife:1060.8},{id:"Br81",massNumber:81,relativeAbundance:.49310000000000004,atomicNumber:35,exactMass:80.9162906,spin:"3/2-",magneticMoment:"+2.2706",halfLife:-1},{id:"Br82",massNumber:82,exactMass:81.9168041,atomicNumber:35,halfLife:127080},{id:"Br83",massNumber:83,exactMass:82.91518,atomicNumber:35,halfLife:8640},{id:"Br84",massNumber:84,exactMass:83.916479,atomicNumber:35,halfLife:1908},{id:"Br85",massNumber:85,exactMass:84.915608,atomicNumber:35,halfLife:174},{id:"Br86",massNumber:86,exactMass:85.918798,atomicNumber:35,halfLife:55.1},{id:"Br87",massNumber:87,exactMass:86.920711,atomicNumber:35,halfLife:55.6},{id:"Br88",massNumber:88,exactMass:87.92407,atomicNumber:35,halfLife:16.34},{id:"Br89",massNumber:89,exactMass:88.92639,atomicNumber:35,halfLife:4.348},{id:"Br90",massNumber:90,exactMass:89.93063,atomicNumber:35,halfLife:1.91},{id:"Br91",massNumber:91,exactMass:90.93397,atomicNumber:35,halfLife:.541},{id:"Br92",massNumber:92,exactMass:91.93926,atomicNumber:35,halfLife:.343},{id:"Br93",massNumber:93,exactMass:92.94305,atomicNumber:35,halfLife:.102},{id:"Br94",massNumber:94,exactMass:93.94868,atomicNumber:35,halfLife:.07},{id:"Br95",massNumber:95,exactMass:94.95287,atomicNumber:35},{id:"Br96",massNumber:96,exactMass:95.95853,atomicNumber:35},{id:"Br97",massNumber:97,exactMass:96.9628,atomicNumber:35}]},{elementSymbol:"Kr",atomicNumber:36,isotopes:[{id:"Kr69",massNumber:69,exactMass:68.96518,atomicNumber:36},{id:"Kr70",massNumber:70,exactMass:69.95526,atomicNumber:36},{id:"Kr71",massNumber:71,exactMass:70.94963,atomicNumber:36,halfLife:.064},{id:"Kr72",massNumber:72,exactMass:71.942092,atomicNumber:36,halfLife:17.2},{id:"Kr73",massNumber:73,exactMass:72.939289,atomicNumber:36,halfLife:27},{id:"Kr74",massNumber:74,exactMass:73.9330844,atomicNumber:36,halfLife:690},{id:"Kr75",massNumber:75,exactMass:74.930946,atomicNumber:36,halfLife:258},{id:"Kr76",massNumber:76,exactMass:75.92591,atomicNumber:36,halfLife:53280},{id:"Kr77",massNumber:77,exactMass:76.92467,atomicNumber:36,halfLife:4464},{id:"Kr78",massNumber:78,relativeAbundance:.0034999999999999996,atomicNumber:36,exactMass:77.9203648,spin:"0+",halfLife:-1},{id:"Kr79",massNumber:79,exactMass:78.920082,atomicNumber:36,halfLife:126144},{id:"Kr80",massNumber:80,relativeAbundance:.022799999999999997,atomicNumber:36,exactMass:79.916379,spin:"0+",halfLife:-1},{id:"Kr81",massNumber:81,exactMass:80.916592,atomicNumber:36},{id:"Kr82",massNumber:82,relativeAbundance:.1158,atomicNumber:36,exactMass:81.9134836,spin:"0+",halfLife:-1},{id:"Kr83",massNumber:83,relativeAbundance:.1149,atomicNumber:36,exactMass:82.914136,spin:"9/2+",magneticMoment:"-0.970669",halfLife:-1},{id:"Kr84",massNumber:84,relativeAbundance:.57,atomicNumber:36,exactMass:83.911507,spin:"0+",halfLife:-1},{id:"Kr85",massNumber:85,exactMass:84.9125273,atomicNumber:36,halfLife:339201e3},{id:"Kr86",massNumber:86,relativeAbundance:.17300000000000001,atomicNumber:36,exactMass:85.91061073,spin:"0+",halfLife:-1},{id:"Kr87",massNumber:87,exactMass:86.91335486,atomicNumber:36,halfLife:4578},{id:"Kr88",massNumber:88,exactMass:87.914447,atomicNumber:36,halfLife:10224},{id:"Kr89",massNumber:89,exactMass:88.91763,atomicNumber:36,halfLife:189},{id:"Kr90",massNumber:90,exactMass:89.919517,atomicNumber:36,halfLife:32.32},{id:"Kr91",massNumber:91,exactMass:90.92345,atomicNumber:36,halfLife:8.57},{id:"Kr92",massNumber:92,exactMass:91.926156,atomicNumber:36,halfLife:1.84},{id:"Kr93",massNumber:93,exactMass:92.93127,atomicNumber:36,halfLife:1.286},{id:"Kr94",massNumber:94,exactMass:93.93436,atomicNumber:36,halfLife:.2},{id:"Kr95",massNumber:95,exactMass:94.93984,atomicNumber:36,halfLife:.78},{id:"Kr96",massNumber:96,exactMass:95.94307,atomicNumber:36},{id:"Kr97",massNumber:97,exactMass:96.94856,atomicNumber:36},{id:"Kr98",massNumber:98,exactMass:97.95191,atomicNumber:36},{id:"Kr99",massNumber:99,exactMass:98.9576,atomicNumber:36},{id:"Kr100",massNumber:100,exactMass:99.96114,atomicNumber:36}]},{elementSymbol:"Rb",atomicNumber:37,isotopes:[{id:"Rb71",massNumber:71,exactMass:70.96532,atomicNumber:37},{id:"Rb72",massNumber:72,exactMass:71.95908,atomicNumber:37},{id:"Rb73",massNumber:73,exactMass:72.95056,atomicNumber:37},{id:"Rb74",massNumber:74,exactMass:73.944265,atomicNumber:37,halfLife:.0649},{id:"Rb75",massNumber:75,exactMass:74.93857,atomicNumber:37,halfLife:19},{id:"Rb76",massNumber:76,exactMass:75.9350722,atomicNumber:37,halfLife:36.5},{id:"Rb77",massNumber:77,exactMass:76.930408,atomicNumber:37,halfLife:226.2},{id:"Rb78",massNumber:78,exactMass:77.928141,atomicNumber:37,halfLife:1059.6},{id:"Rb79",massNumber:79,exactMass:78.923989,atomicNumber:37,halfLife:1374},{id:"Rb80",massNumber:80,exactMass:79.922519,atomicNumber:37,halfLife:34},{id:"Rb81",massNumber:81,exactMass:80.918996,atomicNumber:37,halfLife:16473.6},{id:"Rb82",massNumber:82,exactMass:81.9182086,atomicNumber:37,halfLife:76.38},{id:"Rb83",massNumber:83,exactMass:82.91511,atomicNumber:37,halfLife:7447680},{id:"Rb84",massNumber:84,exactMass:83.914385,atomicNumber:37,halfLife:2831330},{id:"Rb85",massNumber:85,relativeAbundance:.7217,atomicNumber:37,exactMass:84.91178974,spin:"5/2-",magneticMoment:"+1.3530",halfLife:-1},{id:"Rb86",massNumber:86,exactMass:85.91116742,atomicNumber:37,magneticMoment:"-1.6920",halfLife:1609720,betaminusDecay:"1.774",betaminusDecayLikeliness:"99.99",ecDecay:"",ecDecayLikeliness:"0.0052"},{id:"Rb87",massNumber:87,relativeAbundance:.2783,atomicNumber:37,exactMass:86.90918053,spin:"3/2-",magneticMoment:"+2.75124",halfLife:475e8},{id:"Rb88",massNumber:88,exactMass:87.91131559,atomicNumber:37,halfLife:1066.8},{id:"Rb89",massNumber:89,exactMass:88.912278,atomicNumber:37,halfLife:909},{id:"Rb90",massNumber:90,exactMass:89.914802,atomicNumber:37,halfLife:158},{id:"Rb91",massNumber:91,exactMass:90.916537,atomicNumber:37,halfLife:58.4},{id:"Rb92",massNumber:92,exactMass:91.919729,atomicNumber:37,halfLife:4.492},{id:"Rb93",massNumber:93,exactMass:92.922042,atomicNumber:37,halfLife:5.84},{id:"Rb94",massNumber:94,exactMass:93.926405,atomicNumber:37,halfLife:2.702},{id:"Rb95",massNumber:95,exactMass:94.929303,atomicNumber:37,halfLife:.3775},{id:"Rb96",massNumber:96,exactMass:95.93427,atomicNumber:37,halfLife:.199},{id:"Rb97",massNumber:97,exactMass:96.93735,atomicNumber:37,halfLife:.1699},{id:"Rb98",massNumber:98,exactMass:97.94179,atomicNumber:37,halfLife:.114},{id:"Rb99",massNumber:99,exactMass:98.94538,atomicNumber:37,halfLife:.0503},{id:"Rb100",massNumber:100,exactMass:99.94987,atomicNumber:37,halfLife:.051},{id:"Rb101",massNumber:101,exactMass:100.9532,atomicNumber:37,halfLife:.032},{id:"Rb102",massNumber:102,exactMass:101.95887,atomicNumber:37,halfLife:.037}]},{elementSymbol:"Sr",atomicNumber:38,isotopes:[{id:"Sr73",massNumber:73,exactMass:72.96597,atomicNumber:38},{id:"Sr74",massNumber:74,exactMass:73.95631,atomicNumber:38},{id:"Sr75",massNumber:75,exactMass:74.94995,atomicNumber:38,halfLife:.071},{id:"Sr76",massNumber:76,exactMass:75.94177,atomicNumber:38,halfLife:8.9},{id:"Sr77",massNumber:77,exactMass:76.937945,atomicNumber:38,halfLife:9},{id:"Sr78",massNumber:78,exactMass:77.93218,atomicNumber:38,halfLife:150},{id:"Sr79",massNumber:79,exactMass:78.929708,atomicNumber:38,halfLife:135},{id:"Sr80",massNumber:80,exactMass:79.924521,atomicNumber:38,halfLife:6378},{id:"Sr81",massNumber:81,exactMass:80.923212,atomicNumber:38,halfLife:1338},{id:"Sr82",massNumber:82,exactMass:81.918402,atomicNumber:38,halfLife:2207520},{id:"Sr83",massNumber:83,exactMass:82.917557,atomicNumber:38,halfLife:116676},{id:"Sr84",massNumber:84,relativeAbundance:.005600000000000001,atomicNumber:38,exactMass:83.913425,spin:"0+",halfLife:-1},{id:"Sr85",massNumber:85,exactMass:84.912933,atomicNumber:38,spin:"9/2+",halfLife:5602180,ecDecay:"1.08",ecDecayLikeliness:"100"},{id:"Sr86",massNumber:86,relativeAbundance:.0986,atomicNumber:38,exactMass:85.9092602,spin:"0+",halfLife:-1},{id:"Sr87",massNumber:87,relativeAbundance:.07,atomicNumber:38,exactMass:86.9088771,spin:"9/2+",magneticMoment:"-1.093",halfLife:-1},{id:"Sr88",massNumber:88,relativeAbundance:.8258,atomicNumber:38,exactMass:87.9056121,spin:"0+",halfLife:-1},{id:"Sr89",massNumber:89,exactMass:88.9074507,atomicNumber:38,halfLife:4365790},{id:"Sr90",massNumber:90,exactMass:89.907738,atomicNumber:38,halfLife:907921e3},{id:"Sr91",massNumber:91,exactMass:90.910203,atomicNumber:38,halfLife:34668},{id:"Sr92",massNumber:92,exactMass:91.911038,atomicNumber:38,halfLife:9756},{id:"Sr93",massNumber:93,exactMass:92.914026,atomicNumber:38,halfLife:445.38},{id:"Sr94",massNumber:94,exactMass:93.915361,atomicNumber:38,halfLife:75.3},{id:"Sr95",massNumber:95,exactMass:94.919359,atomicNumber:38,halfLife:23.9},{id:"Sr96",massNumber:96,exactMass:95.921697,atomicNumber:38,halfLife:1.07},{id:"Sr97",massNumber:97,exactMass:96.926153,atomicNumber:38,halfLife:.426},{id:"Sr98",massNumber:98,exactMass:97.928453,atomicNumber:38,halfLife:.653},{id:"Sr99",massNumber:99,exactMass:98.93324,atomicNumber:38,halfLife:.269},{id:"Sr100",massNumber:100,exactMass:99.93535,atomicNumber:38,halfLife:.202},{id:"Sr101",massNumber:101,exactMass:100.94052,atomicNumber:38,halfLife:.118},{id:"Sr102",massNumber:102,exactMass:101.94302,atomicNumber:38},{id:"Sr103",massNumber:103,exactMass:102.94895,atomicNumber:38},{id:"Sr104",massNumber:104,exactMass:103.95233,atomicNumber:38},{id:"Sr105",massNumber:105,exactMass:104.95858,atomicNumber:38}]},{elementSymbol:"Y",atomicNumber:39,isotopes:[{id:"Y76",massNumber:76,exactMass:75.95845,atomicNumber:39},{id:"Y77",massNumber:77,exactMass:76.94965,atomicNumber:39},{id:"Y78",massNumber:78,exactMass:77.94361,atomicNumber:39},{id:"Y79",massNumber:79,exactMass:78.93735,atomicNumber:39,halfLife:14.8},{id:"Y80",massNumber:80,exactMass:79.93428,atomicNumber:39,halfLife:35},{id:"Y81",massNumber:81,exactMass:80.92913,atomicNumber:39,halfLife:70.4},{id:"Y82",massNumber:82,exactMass:81.92679,atomicNumber:39,halfLife:9.5},{id:"Y83",massNumber:83,exactMass:82.92235,atomicNumber:39,halfLife:424.8},{id:"Y84",massNumber:84,exactMass:83.92039,atomicNumber:39,halfLife:4.6},{id:"Y85",massNumber:85,exactMass:84.916433,atomicNumber:39,halfLife:9648},{id:"Y86",massNumber:86,exactMass:85.914886,atomicNumber:39,halfLife:53064},{id:"Y87",massNumber:87,exactMass:86.9108757,atomicNumber:39,halfLife:287280},{id:"Y88",massNumber:88,exactMass:87.9095011,atomicNumber:39,halfLife:9214560},{id:"Y89",massNumber:89,relativeAbundance:1,atomicNumber:39,exactMass:88.9058483,spin:"1/2-",magneticMoment:"-0.1374153",halfLife:-1},{id:"Y90",massNumber:90,exactMass:89.9071519,atomicNumber:39,spin:"2-",magneticMoment:"-1.630",halfLife:230400,betaminusDecay:"2.283",betaminusDecayLikeliness:"100.0"},{id:"Y91",massNumber:91,exactMass:90.907305,atomicNumber:39,halfLife:5055260},{id:"Y92",massNumber:92,exactMass:91.908949,atomicNumber:39,halfLife:12744},{id:"Y93",massNumber:93,exactMass:92.909583,atomicNumber:39,halfLife:36648},{id:"Y94",massNumber:94,exactMass:93.911595,atomicNumber:39,halfLife:1122},{id:"Y95",massNumber:95,exactMass:94.912821,atomicNumber:39,halfLife:618},{id:"Y96",massNumber:96,exactMass:95.915891,atomicNumber:39,halfLife:5.34},{id:"Y97",massNumber:97,exactMass:96.918134,atomicNumber:39,halfLife:3.75},{id:"Y98",massNumber:98,exactMass:97.922203,atomicNumber:39},{id:"Y99",massNumber:99,exactMass:98.924636,atomicNumber:39},{id:"Y100",massNumber:100,exactMass:99.92776,atomicNumber:39},{id:"Y101",massNumber:101,exactMass:100.93031,atomicNumber:39},{id:"Y102",massNumber:102,exactMass:101.93356,atomicNumber:39},{id:"Y103",massNumber:103,exactMass:102.93673,atomicNumber:39},{id:"Y104",massNumber:104,exactMass:103.94105,atomicNumber:39},{id:"Y105",massNumber:105,exactMass:104.94487,atomicNumber:39},{id:"Y106",massNumber:106,exactMass:105.94979,atomicNumber:39},{id:"Y107",massNumber:107,exactMass:106.95414,atomicNumber:39},{id:"Y108",massNumber:108,exactMass:107.95948,atomicNumber:39}]},{elementSymbol:"Zr",atomicNumber:40,isotopes:[{id:"Zr78",massNumber:78,exactMass:77.95523,atomicNumber:40},{id:"Zr79",massNumber:79,exactMass:78.94916,atomicNumber:40},{id:"Zr80",massNumber:80,exactMass:79.9404,atomicNumber:40},{id:"Zr81",massNumber:81,exactMass:80.93721,atomicNumber:40,halfLife:15},{id:"Zr82",massNumber:82,exactMass:81.93109,atomicNumber:40,halfLife:32},{id:"Zr83",massNumber:83,exactMass:82.92865,atomicNumber:40,halfLife:44},{id:"Zr84",massNumber:84,exactMass:83.92325,atomicNumber:40,halfLife:1554},{id:"Zr85",massNumber:85,exactMass:84.92147,atomicNumber:40,halfLife:471.6},{id:"Zr86",massNumber:86,exactMass:85.91647,atomicNumber:40,halfLife:59400},{id:"Zr87",massNumber:87,exactMass:86.914816,atomicNumber:40,halfLife:6048},{id:"Zr88",massNumber:88,exactMass:87.910227,atomicNumber:40,halfLife:7205760},{id:"Zr89",massNumber:89,exactMass:88.90889,atomicNumber:40,halfLife:282276},{id:"Zr90",massNumber:90,relativeAbundance:.5145000000000001,atomicNumber:40,exactMass:89.9047044,spin:"0+",halfLife:-1},{id:"Zr91",massNumber:91,relativeAbundance:.11220000000000001,atomicNumber:40,exactMass:90.9056458,spin:"5/2+",magneticMoment:"-1.30362",halfLife:-1},{id:"Zr92",massNumber:92,relativeAbundance:.17149999999999999,atomicNumber:40,exactMass:91.9050408,spin:"0+",halfLife:-1},{id:"Zr93",massNumber:93,exactMass:92.906476,atomicNumber:40,spin:"5/2+",halfLife:153e4,betaminusDecay:"0.09",betaminusDecayLikeliness:"100.0"},{id:"Zr94",massNumber:94,relativeAbundance:.17379999999999998,atomicNumber:40,exactMass:93.9063152,spin:"0+",halfLife:-1},{id:"Zr95",massNumber:95,exactMass:94.9080426,atomicNumber:40,spin:"5/2+",halfLife:5531330,betaminusDecay:"1.121",betaminusDecayLikeliness:"100.0"},{id:"Zr96",massNumber:96,relativeAbundance:.027999999999999997,atomicNumber:40,exactMass:95.9082734,spin:"0+"},{id:"Zr97",massNumber:97,exactMass:96.9109531,atomicNumber:40,halfLife:60876},{id:"Zr98",massNumber:98,exactMass:97.912735,atomicNumber:40,halfLife:30.7},{id:"Zr99",massNumber:99,exactMass:98.916512,atomicNumber:40,halfLife:2.1},{id:"Zr100",massNumber:100,exactMass:99.91776,atomicNumber:40,halfLife:7.1},{id:"Zr101",massNumber:101,exactMass:100.92114,atomicNumber:40,halfLife:2.3},{id:"Zr102",massNumber:102,exactMass:101.92298,atomicNumber:40,halfLife:2.9},{id:"Zr103",massNumber:103,exactMass:102.9266,atomicNumber:40,halfLife:1.3},{id:"Zr104",massNumber:104,exactMass:103.92878,atomicNumber:40,halfLife:1.2},{id:"Zr105",massNumber:105,exactMass:104.93305,atomicNumber:40},{id:"Zr106",massNumber:106,exactMass:105.93591,atomicNumber:40},{id:"Zr107",massNumber:107,exactMass:106.94075,atomicNumber:40},{id:"Zr108",massNumber:108,exactMass:107.94396,atomicNumber:40},{id:"Zr109",massNumber:109,exactMass:108.94924,atomicNumber:40},{id:"Zr110",massNumber:110,exactMass:109.95287,atomicNumber:40}]},{elementSymbol:"Nb",atomicNumber:41,isotopes:[{id:"Nb81",massNumber:81,exactMass:80.94903,atomicNumber:41},{id:"Nb82",massNumber:82,exactMass:81.94313,atomicNumber:41},{id:"Nb83",massNumber:83,exactMass:82.93671,atomicNumber:41,halfLife:4.1},{id:"Nb84",massNumber:84,exactMass:83.93357,atomicNumber:41,halfLife:12},{id:"Nb85",massNumber:85,exactMass:84.92791,atomicNumber:41,halfLife:20.9},{id:"Nb86",massNumber:86,exactMass:85.92504,atomicNumber:41,halfLife:88},{id:"Nb87",massNumber:87,exactMass:86.92036,atomicNumber:41,halfLife:156},{id:"Nb88",massNumber:88,exactMass:87.91833,atomicNumber:41,halfLife:870},{id:"Nb89",massNumber:89,exactMass:88.913418,atomicNumber:41,halfLife:6840},{id:"Nb90",massNumber:90,exactMass:89.911265,atomicNumber:41,halfLife:52560},{id:"Nb91",massNumber:91,exactMass:90.906996,atomicNumber:41,halfLife:214445e5},{id:"Nb92",massNumber:92,exactMass:91.907194,atomicNumber:41},{id:"Nb93",massNumber:93,relativeAbundance:1,atomicNumber:41,exactMass:92.9063781,spin:"9/2+",halfLife:-1},{id:"Nb94",massNumber:94,exactMass:93.9072839,atomicNumber:41},{id:"Nb95",massNumber:95,exactMass:94.9068358,atomicNumber:41,spin:"9/2+",magneticMoment:"+6.123",halfLife:3021840,betaminusDecay:"0.925",betaminusDecayLikeliness:"100.0"},{id:"Nb96",massNumber:96,exactMass:95.908101,atomicNumber:41,halfLife:84060},{id:"Nb97",massNumber:97,exactMass:96.9080986,atomicNumber:41,halfLife:4326},{id:"Nb98",massNumber:98,exactMass:97.910328,atomicNumber:41,halfLife:2.86},{id:"Nb99",massNumber:99,exactMass:98.911618,atomicNumber:41,halfLife:15},{id:"Nb100",massNumber:100,exactMass:99.914182,atomicNumber:41},{id:"Nb101",massNumber:101,exactMass:100.915252,atomicNumber:41},{id:"Nb102",massNumber:102,exactMass:101.91804,atomicNumber:41},{id:"Nb103",massNumber:103,exactMass:102.91914,atomicNumber:41},{id:"Nb104",massNumber:104,exactMass:103.92246,atomicNumber:41},{id:"Nb105",massNumber:105,exactMass:104.92394,atomicNumber:41},{id:"Nb106",massNumber:106,exactMass:105.92797,atomicNumber:41},{id:"Nb107",massNumber:107,exactMass:106.93031,atomicNumber:41},{id:"Nb108",massNumber:108,exactMass:107.93484,atomicNumber:41},{id:"Nb109",massNumber:109,exactMass:108.93763,atomicNumber:41},{id:"Nb110",massNumber:110,exactMass:109.94244,atomicNumber:41},{id:"Nb111",massNumber:111,exactMass:110.94565,atomicNumber:41},{id:"Nb112",massNumber:112,exactMass:111.95083,atomicNumber:41},{id:"Nb113",massNumber:113,exactMass:112.9547,atomicNumber:41}]},{elementSymbol:"Mo",atomicNumber:42,isotopes:[{id:"Mo83",massNumber:83,exactMass:82.94874,atomicNumber:42},{id:"Mo84",massNumber:84,exactMass:83.94009,atomicNumber:42},{id:"Mo85",massNumber:85,exactMass:84.93655,atomicNumber:42},{id:"Mo86",massNumber:86,exactMass:85.9307,atomicNumber:42,halfLife:19.6},{id:"Mo87",massNumber:87,exactMass:86.92733,atomicNumber:42,halfLife:13.4},{id:"Mo88",massNumber:88,exactMass:87.921953,atomicNumber:42,halfLife:480},{id:"Mo89",massNumber:89,exactMass:88.91948,atomicNumber:42,halfLife:122.4},{id:"Mo90",massNumber:90,exactMass:89.913937,atomicNumber:42,halfLife:20016},{id:"Mo91",massNumber:91,exactMass:90.91175,atomicNumber:42,halfLife:929.4},{id:"Mo92",massNumber:92,relativeAbundance:.1484,atomicNumber:42,exactMass:91.906811,spin:"0+",halfLife:-1},{id:"Mo93",massNumber:93,exactMass:92.906813,atomicNumber:42,spin:"5/2+",halfLife:3500,ecDecay:"",ecDecayLikeliness:"100.0"},{id:"Mo94",massNumber:94,relativeAbundance:.0925,atomicNumber:42,exactMass:93.9050883,spin:"0+",halfLife:-1},{id:"Mo95",massNumber:95,relativeAbundance:.1592,atomicNumber:42,exactMass:94.9058421,spin:"5/2+",magneticMoment:"-0.9133",halfLife:-1},{id:"Mo96",massNumber:96,relativeAbundance:.1668,atomicNumber:42,exactMass:95.9046795,spin:"0+",halfLife:-1},{id:"Mo97",massNumber:97,relativeAbundance:.0955,atomicNumber:42,exactMass:96.9060215,spin:"5/2+",magneticMoment:"-0.9133",halfLife:-1},{id:"Mo98",massNumber:98,relativeAbundance:.2413,atomicNumber:42,exactMass:97.9054082,spin:"0+",halfLife:-1},{id:"Mo99",massNumber:99,exactMass:98.9077119,atomicNumber:42,spin:"1/2+",halfLife:237384,betaminusDecay:"1.357",betaminusDecayLikeliness:"100.0"},{id:"Mo100",massNumber:100,relativeAbundance:.09630000000000001,atomicNumber:42,exactMass:99.907477,spin:"0+",halfLife:-1},{id:"Mo101",massNumber:101,exactMass:100.910347,atomicNumber:42,halfLife:876.6},{id:"Mo102",massNumber:102,exactMass:101.910297,atomicNumber:42,halfLife:678},{id:"Mo103",massNumber:103,exactMass:102.91321,atomicNumber:42,halfLife:67.5},{id:"Mo104",massNumber:104,exactMass:103.91376,atomicNumber:42,halfLife:60},{id:"Mo105",massNumber:105,exactMass:104.91697,atomicNumber:42,halfLife:35.6},{id:"Mo106",massNumber:106,exactMass:105.918137,atomicNumber:42,halfLife:8.4},{id:"Mo107",massNumber:107,exactMass:106.92169,atomicNumber:42,halfLife:3.5},{id:"Mo108",massNumber:108,exactMass:107.92345,atomicNumber:42,halfLife:1.09},{id:"Mo109",massNumber:109,exactMass:108.92781,atomicNumber:42,halfLife:.53},{id:"Mo110",massNumber:110,exactMass:109.92973,atomicNumber:42,halfLife:.3},{id:"Mo111",massNumber:111,exactMass:110.93441,atomicNumber:42},{id:"Mo112",massNumber:112,exactMass:111.93684,atomicNumber:42},{id:"Mo113",massNumber:113,exactMass:112.94188,atomicNumber:42},{id:"Mo114",massNumber:114,exactMass:113.94492,atomicNumber:42},{id:"Mo115",massNumber:115,exactMass:114.95029,atomicNumber:42}]},{elementSymbol:"Tc",atomicNumber:43,isotopes:[{id:"Tc85",massNumber:85,exactMass:84.94883,atomicNumber:43},{id:"Tc86",massNumber:86,exactMass:85.94288,atomicNumber:43},{id:"Tc87",massNumber:87,exactMass:86.93653,atomicNumber:43},{id:"Tc88",massNumber:88,exactMass:87.93268,atomicNumber:43,halfLife:6.4},{id:"Tc89",massNumber:89,exactMass:88.92717,atomicNumber:43,halfLife:12.8},{id:"Tc90",massNumber:90,exactMass:89.92356,atomicNumber:43,halfLife:49.2},{id:"Tc91",massNumber:91,exactMass:90.91843,atomicNumber:43,halfLife:188.4},{id:"Tc92",massNumber:92,exactMass:91.91526,atomicNumber:43,halfLife:253.8},{id:"Tc93",massNumber:93,exactMass:92.910249,atomicNumber:43,halfLife:9900},{id:"Tc94",massNumber:94,exactMass:93.909657,atomicNumber:43,halfLife:17580},{id:"Tc95",massNumber:95,exactMass:94.907657,atomicNumber:43,halfLife:72e3},{id:"Tc96",massNumber:96,exactMass:95.907871,atomicNumber:43,halfLife:369792},{id:"Tc97",massNumber:97,exactMass:96.906365,atomicNumber:43,spin:"9/2+",halfLife:26e5,ecDecay:"0.32",ecDecayLikeliness:"100.0"},{id:"Tc98",massNumber:98,exactMass:97.907216,atomicNumber:43},{id:"Tc99",massNumber:99,exactMass:98.9062547,atomicNumber:43,spin:"9/2+",magneticMoment:"+5.6847",halfLife:211100,betaminusDecay:"0.293",betaminusDecayLikeliness:"100.0"},{id:"Tc100",massNumber:100,exactMass:99.9076578,atomicNumber:43,halfLife:15.8},{id:"Tc101",massNumber:101,exactMass:100.907315,atomicNumber:43,halfLife:853.2},{id:"Tc102",massNumber:102,exactMass:101.909215,atomicNumber:43,halfLife:5.28},{id:"Tc103",massNumber:103,exactMass:102.909181,atomicNumber:43,halfLife:54.2},{id:"Tc104",massNumber:104,exactMass:103.91145,atomicNumber:43,halfLife:1098},{id:"Tc105",massNumber:105,exactMass:104.91166,atomicNumber:43,halfLife:456},{id:"Tc106",massNumber:106,exactMass:105.914358,atomicNumber:43},{id:"Tc107",massNumber:107,exactMass:106.91508,atomicNumber:43},{id:"Tc108",massNumber:108,exactMass:107.91846,atomicNumber:43},{id:"Tc109",massNumber:109,exactMass:108.91998,atomicNumber:43},{id:"Tc110",massNumber:110,exactMass:109.92382,atomicNumber:43},{id:"Tc111",massNumber:111,exactMass:110.92569,atomicNumber:43},{id:"Tc112",massNumber:112,exactMass:111.92915,atomicNumber:43},{id:"Tc113",massNumber:113,exactMass:112.93159,atomicNumber:43},{id:"Tc114",massNumber:114,exactMass:113.93588,atomicNumber:43},{id:"Tc115",massNumber:115,exactMass:114.93869,atomicNumber:43},{id:"Tc116",massNumber:116,exactMass:115.94337,atomicNumber:43},{id:"Tc117",massNumber:117,exactMass:116.94648,atomicNumber:43},{id:"Tc118",massNumber:118,exactMass:117.95148,atomicNumber:43}]},{elementSymbol:"Ru",atomicNumber:44,isotopes:[{id:"Ru87",massNumber:87,exactMass:86.94918,atomicNumber:44},{id:"Ru88",massNumber:88,exactMass:87.94026,atomicNumber:44},{id:"Ru89",massNumber:89,exactMass:88.93611,atomicNumber:44},{id:"Ru90",massNumber:90,exactMass:89.92989,atomicNumber:44,halfLife:11},{id:"Ru91",massNumber:91,exactMass:90.92629,atomicNumber:44,halfLife:9},{id:"Ru92",massNumber:92,exactMass:91.92012,atomicNumber:44,halfLife:219},{id:"Ru93",massNumber:93,exactMass:92.91705,atomicNumber:44,halfLife:59.7},{id:"Ru94",massNumber:94,exactMass:93.91136,atomicNumber:44,halfLife:3108},{id:"Ru95",massNumber:95,exactMass:94.910413,atomicNumber:44,halfLife:5914.8},{id:"Ru96",massNumber:96,relativeAbundance:.0554,atomicNumber:44,exactMass:95.907598,spin:"0+",halfLife:-1},{id:"Ru97",massNumber:97,exactMass:96.907555,atomicNumber:44,spin:"5/2+",magneticMoment:"+0.687",halfLife:250560,ecDecay:"1.2",ecDecayLikeliness:"100.0"},{id:"Ru98",massNumber:98,relativeAbundance:.0187,atomicNumber:44,exactMass:97.905287,spin:"0+",halfLife:-1},{id:"Ru99",massNumber:99,relativeAbundance:.1276,atomicNumber:44,exactMass:98.9059393,spin:"5/2+",magneticMoment:"+0.6413",halfLife:-1},{id:"Ru100",massNumber:100,relativeAbundance:.126,atomicNumber:44,exactMass:99.9042195,spin:"0+",halfLife:-1},{id:"Ru101",massNumber:101,relativeAbundance:.17059999999999997,atomicNumber:44,exactMass:100.9055821,spin:"5/2+",magneticMoment:"-0.7188",halfLife:-1},{id:"Ru102",massNumber:102,relativeAbundance:.3155,atomicNumber:44,exactMass:101.9043493,spin:"0+",halfLife:-1},{id:"Ru103",massNumber:103,exactMass:102.9063238,atomicNumber:44,spin:"5/2+",magneticMoment:"+0.67",halfLife:3392060,betaminusDecay:"0.767",betaminusDecayLikeliness:"100.0"},{id:"Ru104",massNumber:104,relativeAbundance:.1862,atomicNumber:44,exactMass:103.905433,spin:"0+",halfLife:-1},{id:"Ru105",massNumber:105,exactMass:104.907753,atomicNumber:44,halfLife:15984},{id:"Ru106",massNumber:106,exactMass:105.907329,atomicNumber:44,halfLife:32278200},{id:"Ru107",massNumber:107,exactMass:106.90991,atomicNumber:44,halfLife:225},{id:"Ru108",massNumber:108,exactMass:107.91017,atomicNumber:44,halfLife:273},{id:"Ru109",massNumber:109,exactMass:108.9132,atomicNumber:44,halfLife:34.5},{id:"Ru110",massNumber:110,exactMass:109.91414,atomicNumber:44,halfLife:14.6},{id:"Ru111",massNumber:111,exactMass:110.9177,atomicNumber:44,halfLife:2.12},{id:"Ru112",massNumber:112,exactMass:111.91897,atomicNumber:44,halfLife:1.75},{id:"Ru113",massNumber:113,exactMass:112.92249,atomicNumber:44,halfLife:.8},{id:"Ru114",massNumber:114,exactMass:113.92428,atomicNumber:44,halfLife:.53},{id:"Ru115",massNumber:115,exactMass:114.92869,atomicNumber:44,halfLife:.4},{id:"Ru116",massNumber:116,exactMass:115.93081,atomicNumber:44},{id:"Ru117",massNumber:117,exactMass:116.93558,atomicNumber:44},{id:"Ru118",massNumber:118,exactMass:117.93782,atomicNumber:44},{id:"Ru119",massNumber:119,exactMass:118.94284,atomicNumber:44},{id:"Ru120",massNumber:120,exactMass:119.94531,atomicNumber:44}]},{elementSymbol:"Rh",atomicNumber:45,isotopes:[{id:"Rh89",massNumber:89,exactMass:88.94884,atomicNumber:45},{id:"Rh90",massNumber:90,exactMass:89.94287,atomicNumber:45},{id:"Rh91",massNumber:91,exactMass:90.93655,atomicNumber:45},{id:"Rh92",massNumber:92,exactMass:91.93198,atomicNumber:45},{id:"Rh93",massNumber:93,exactMass:92.92574,atomicNumber:45},{id:"Rh94",massNumber:94,exactMass:93.9217,atomicNumber:45,halfLife:70.6},{id:"Rh95",massNumber:95,exactMass:94.9159,atomicNumber:45,halfLife:301.2},{id:"Rh96",massNumber:96,exactMass:95.914461,atomicNumber:45,halfLife:594},{id:"Rh97",massNumber:97,exactMass:96.91134,atomicNumber:45,halfLife:1842},{id:"Rh98",massNumber:98,exactMass:97.910708,atomicNumber:45,halfLife:522},{id:"Rh99",massNumber:99,exactMass:98.908132,atomicNumber:45,halfLife:1391040},{id:"Rh100",massNumber:100,exactMass:99.908122,atomicNumber:45,halfLife:74880},{id:"Rh101",massNumber:101,exactMass:100.906164,atomicNumber:45,halfLife:104069e3},{id:"Rh102",massNumber:102,exactMass:101.906843,atomicNumber:45,halfLife:17884800},{id:"Rh103",massNumber:103,relativeAbundance:1,atomicNumber:45,exactMass:102.905504,spin:"1/2-",magneticMoment:"-0.08840",halfLife:-1},{id:"Rh104",massNumber:104,exactMass:103.906656,atomicNumber:45,halfLife:42.3},{id:"Rh105",massNumber:105,exactMass:104.905694,atomicNumber:45,halfLife:127296},{id:"Rh106",massNumber:106,exactMass:105.907287,atomicNumber:45,halfLife:29.8},{id:"Rh107",massNumber:107,exactMass:106.906748,atomicNumber:45,halfLife:1302},{id:"Rh108",massNumber:108,exactMass:107.90873,atomicNumber:45,halfLife:16.8},{id:"Rh109",massNumber:109,exactMass:108.908737,atomicNumber:45,halfLife:80},{id:"Rh110",massNumber:110,exactMass:109.91114,atomicNumber:45},{id:"Rh111",massNumber:111,exactMass:110.91159,atomicNumber:45},{id:"Rh112",massNumber:112,exactMass:111.91439,atomicNumber:45},{id:"Rh113",massNumber:113,exactMass:112.91553,atomicNumber:45},{id:"Rh114",massNumber:114,exactMass:113.91881,atomicNumber:45},{id:"Rh115",massNumber:115,exactMass:114.92033,atomicNumber:45},{id:"Rh116",massNumber:116,exactMass:115.92406,atomicNumber:45},{id:"Rh117",massNumber:117,exactMass:116.92598,atomicNumber:45},{id:"Rh118",massNumber:118,exactMass:117.93007,atomicNumber:45},{id:"Rh119",massNumber:119,exactMass:118.93211,atomicNumber:45},{id:"Rh120",massNumber:120,exactMass:119.93641,atomicNumber:45},{id:"Rh121",massNumber:121,exactMass:120.93872,atomicNumber:45},{id:"Rh122",massNumber:122,exactMass:121.94321,atomicNumber:45}]},{elementSymbol:"Pd",atomicNumber:46,isotopes:[{id:"Pd91",massNumber:91,exactMass:90.94911,atomicNumber:46},{id:"Pd92",massNumber:92,exactMass:91.94042,atomicNumber:46},{id:"Pd93",massNumber:93,exactMass:92.93591,atomicNumber:46},{id:"Pd94",massNumber:94,exactMass:93.92877,atomicNumber:46},{id:"Pd95",massNumber:95,exactMass:94.92469,atomicNumber:46},{id:"Pd96",massNumber:96,exactMass:95.91816,atomicNumber:46,halfLife:122},{id:"Pd97",massNumber:97,exactMass:96.91648,atomicNumber:46,halfLife:186},{id:"Pd98",massNumber:98,exactMass:97.912721,atomicNumber:46,halfLife:1062},{id:"Pd99",massNumber:99,exactMass:98.911768,atomicNumber:46,halfLife:1284},{id:"Pd100",massNumber:100,exactMass:99.908506,atomicNumber:46,halfLife:313632},{id:"Pd101",massNumber:101,exactMass:100.908289,atomicNumber:46,halfLife:30492},{id:"Pd102",massNumber:102,relativeAbundance:.0102,atomicNumber:46,exactMass:101.905609,spin:"0+",halfLife:-1},{id:"Pd103",massNumber:103,exactMass:102.906087,atomicNumber:46,spin:"5/2+",halfLife:1468020,ecDecay:"0.56",ecDecayLikeliness:"100.0"},{id:"Pd104",massNumber:104,relativeAbundance:.1114,atomicNumber:46,exactMass:103.904036,spin:"0+",halfLife:-1},{id:"Pd105",massNumber:105,relativeAbundance:.22329999999999997,atomicNumber:46,exactMass:104.905085,spin:"5/2+",magneticMoment:"-0.642",halfLife:-1},{id:"Pd106",massNumber:106,relativeAbundance:.2733,atomicNumber:46,exactMass:105.903486,spin:"0+",halfLife:-1},{id:"Pd107",massNumber:107,exactMass:106.905133,atomicNumber:46,spin:"5/2+",halfLife:65e5,betaminusDecay:"0.035",betaminusDecayLikeliness:"100.0"},{id:"Pd108",massNumber:108,relativeAbundance:.2646,atomicNumber:46,exactMass:107.903892,spin:"0+",halfLife:-1},{id:"Pd109",massNumber:109,exactMass:108.90595,atomicNumber:46,spin:"5/2+",halfLife:49324.3,betaminusDecay:"1.116",betaminusDecayLikeliness:"100.0"},{id:"Pd110",massNumber:110,relativeAbundance:.11720000000000001,atomicNumber:46,exactMass:109.905153,spin:"0+",halfLife:-1},{id:"Pd111",massNumber:111,exactMass:110.907671,atomicNumber:46,halfLife:1404},{id:"Pd112",massNumber:112,exactMass:111.907314,atomicNumber:46,halfLife:75708},{id:"Pd113",massNumber:113,exactMass:112.91015,atomicNumber:46,halfLife:93},{id:"Pd114",massNumber:114,exactMass:113.910363,atomicNumber:46,halfLife:145.2},{id:"Pd115",massNumber:115,exactMass:114.91368,atomicNumber:46,halfLife:25},{id:"Pd116",massNumber:116,exactMass:115.91416,atomicNumber:46,halfLife:11.8},{id:"Pd117",massNumber:117,exactMass:116.91784,atomicNumber:46,halfLife:4.3},{id:"Pd118",massNumber:118,exactMass:117.91898,atomicNumber:46,halfLife:1.9},{id:"Pd119",massNumber:119,exactMass:118.92311,atomicNumber:46,halfLife:.92},{id:"Pd120",massNumber:120,exactMass:119.92469,atomicNumber:46,halfLife:.5},{id:"Pd121",massNumber:121,exactMass:120.92887,atomicNumber:46},{id:"Pd122",massNumber:122,exactMass:121.93055,atomicNumber:46},{id:"Pd123",massNumber:123,exactMass:122.93493,atomicNumber:46},{id:"Pd124",massNumber:124,exactMass:123.93688,atomicNumber:46}]},{elementSymbol:"Ag",atomicNumber:47,isotopes:[{id:"Ag93",massNumber:93,exactMass:92.94978,atomicNumber:47},{id:"Ag94",massNumber:94,exactMass:93.94278,atomicNumber:47,halfLife:.01},{id:"Ag95",massNumber:95,exactMass:94.93548,atomicNumber:47},{id:"Ag96",massNumber:96,exactMass:95.93068,atomicNumber:47,halfLife:5.1},{id:"Ag97",massNumber:97,exactMass:96.92397,atomicNumber:47,halfLife:19},{id:"Ag98",massNumber:98,exactMass:97.92157,atomicNumber:47,halfLife:46.7},{id:"Ag99",massNumber:99,exactMass:98.9176,atomicNumber:47,halfLife:124},{id:"Ag100",massNumber:100,exactMass:99.9161,atomicNumber:47,halfLife:120.6},{id:"Ag101",massNumber:101,exactMass:100.9128,atomicNumber:47,halfLife:666},{id:"Ag102",massNumber:102,exactMass:101.91169,atomicNumber:47,halfLife:774},{id:"Ag103",massNumber:103,exactMass:102.908973,atomicNumber:47,halfLife:3942},{id:"Ag104",massNumber:104,exactMass:103.908629,atomicNumber:47,halfLife:4152},{id:"Ag105",massNumber:105,exactMass:104.906529,atomicNumber:47,spin:"1/2-",halfLife:3567460},{id:"Ag106",massNumber:106,exactMass:105.906669,atomicNumber:47,spin:"1+",halfLife:1437.6},{id:"Ag107",massNumber:107,relativeAbundance:.51839,atomicNumber:47,exactMass:106.905097,spin:"1/2-",magneticMoment:"-0.113570",halfLife:-1},{id:"Ag108",massNumber:108,exactMass:107.905956,atomicNumber:47,spin:"1+",halfLife:142.2},{id:"Ag109",massNumber:109,relativeAbundance:.48161000000000004,atomicNumber:47,exactMass:108.904752,spin:"1/2-",magneticMoment:"-0.1306905",halfLife:-1},{id:"Ag110",massNumber:110,exactMass:109.906107,atomicNumber:47,spin:"1+",halfLife:24.6},{id:"Ag111",massNumber:111,exactMass:110.905291,atomicNumber:47,halfLife:643680},{id:"Ag112",massNumber:112,exactMass:111.907005,atomicNumber:47,halfLife:11268},{id:"Ag113",massNumber:113,exactMass:112.906567,atomicNumber:47,halfLife:19332},{id:"Ag114",massNumber:114,exactMass:113.908804,atomicNumber:47,halfLife:4.6},{id:"Ag115",massNumber:115,exactMass:114.90876,atomicNumber:47,halfLife:1200},{id:"Ag116",massNumber:116,exactMass:115.91136,atomicNumber:47,halfLife:160.8},{id:"Ag117",massNumber:117,exactMass:116.91168,atomicNumber:47,halfLife:72.8},{id:"Ag118",massNumber:118,exactMass:117.91458,atomicNumber:47,halfLife:3.76},{id:"Ag119",massNumber:119,exactMass:118.91567,atomicNumber:47,halfLife:2.1},{id:"Ag120",massNumber:120,exactMass:119.91879,atomicNumber:47,halfLife:1.23},{id:"Ag121",massNumber:121,exactMass:120.91985,atomicNumber:47,halfLife:.78},{id:"Ag122",massNumber:122,exactMass:121.92353,atomicNumber:47,halfLife:.48},{id:"Ag123",massNumber:123,exactMass:122.9249,atomicNumber:47,halfLife:.309},{id:"Ag124",massNumber:124,exactMass:123.92864,atomicNumber:47,halfLife:.172},{id:"Ag125",massNumber:125,exactMass:124.93043,atomicNumber:47,halfLife:.166},{id:"Ag126",massNumber:126,exactMass:125.9345,atomicNumber:47,halfLife:.107},{id:"Ag127",massNumber:127,exactMass:126.93677,atomicNumber:47,halfLife:.109},{id:"Ag128",massNumber:128,exactMass:127.94117,atomicNumber:47,halfLife:.058},{id:"Ag129",massNumber:129,exactMass:128.94369,atomicNumber:47},{id:"Ag130",massNumber:130,exactMass:129.95045,atomicNumber:47}]},{elementSymbol:"Cd",atomicNumber:48,isotopes:[{id:"Cd95",massNumber:95,exactMass:94.94987,atomicNumber:48},{id:"Cd96",massNumber:96,exactMass:95.93977,atomicNumber:48},{id:"Cd97",massNumber:97,exactMass:96.93494,atomicNumber:48,halfLife:3},{id:"Cd98",massNumber:98,exactMass:97.9274,atomicNumber:48,halfLife:9.2},{id:"Cd99",massNumber:99,exactMass:98.92501,atomicNumber:48,halfLife:16},{id:"Cd100",massNumber:100,exactMass:99.92029,atomicNumber:48,halfLife:49.1},{id:"Cd101",massNumber:101,exactMass:100.91868,atomicNumber:48,halfLife:81.6},{id:"Cd102",massNumber:102,exactMass:101.91446,atomicNumber:48,halfLife:330},{id:"Cd103",massNumber:103,exactMass:102.913419,atomicNumber:48,halfLife:438},{id:"Cd104",massNumber:104,exactMass:103.909849,atomicNumber:48,halfLife:3462},{id:"Cd105",massNumber:105,exactMass:104.909468,atomicNumber:48,halfLife:3330},{id:"Cd106",massNumber:106,relativeAbundance:.0125,atomicNumber:48,exactMass:105.906459,spin:"0+",halfLife:-1},{id:"Cd107",massNumber:107,exactMass:106.906618,atomicNumber:48,spin:"5/2+",halfLife:23400,ecDecay:"",ecDecayLikeliness:"100.0"},{id:"Cd108",massNumber:108,relativeAbundance:.0089,atomicNumber:48,exactMass:107.904184,spin:"0+",halfLife:-1},{id:"Cd109",massNumber:109,exactMass:108.904982,atomicNumber:48,spin:"5/2+",magneticMoment:"-0.8270",halfLife:39968600,ecDecay:"0.16",ecDecayLikeliness:"100.0"},{id:"Cd110",massNumber:110,relativeAbundance:.1249,atomicNumber:48,exactMass:109.9030021,spin:"0+",halfLife:-1},{id:"Cd111",massNumber:111,relativeAbundance:.128,atomicNumber:48,exactMass:110.9041781,spin:"1/2+",magneticMoment:"-0.5943",halfLife:-1},{id:"Cd112",massNumber:112,relativeAbundance:.2413,atomicNumber:48,exactMass:111.9027578,spin:"0+",halfLife:-1},{id:"Cd113",massNumber:113,relativeAbundance:.1222,atomicNumber:48,exactMass:112.9044017,spin:"1/2+",magneticMoment:"-0.6217"},{id:"Cd114",massNumber:114,relativeAbundance:.2873,atomicNumber:48,exactMass:113.9033585,spin:"0+",halfLife:-1},{id:"Cd115",massNumber:115,exactMass:114.905431,atomicNumber:48,spin:"1/2+",magneticMoment:"-0.648",halfLife:192456},{id:"Cd116",massNumber:116,relativeAbundance:.07490000000000001,atomicNumber:48,exactMass:115.904756,spin:"0+",halfLife:-1},{id:"Cd117",massNumber:117,exactMass:116.907219,atomicNumber:48,halfLife:8964},{id:"Cd118",massNumber:118,exactMass:117.906915,atomicNumber:48,halfLife:3018},{id:"Cd119",massNumber:119,exactMass:118.90992,atomicNumber:48,halfLife:161.4},{id:"Cd120",massNumber:120,exactMass:119.90985,atomicNumber:48,halfLife:50.8},{id:"Cd121",massNumber:121,exactMass:120.91298,atomicNumber:48,halfLife:13.5},{id:"Cd122",massNumber:122,exactMass:121.91333,atomicNumber:48,halfLife:5.24},{id:"Cd123",massNumber:123,exactMass:122.917,atomicNumber:48,halfLife:2.1},{id:"Cd124",massNumber:124,exactMass:123.91765,atomicNumber:48,halfLife:1.25},{id:"Cd125",massNumber:125,exactMass:124.92125,atomicNumber:48,halfLife:.65},{id:"Cd126",massNumber:126,exactMass:125.92235,atomicNumber:48,halfLife:.506},{id:"Cd127",massNumber:127,exactMass:126.92644,atomicNumber:48,halfLife:.37},{id:"Cd128",massNumber:128,exactMass:127.92776,atomicNumber:48,halfLife:.34},{id:"Cd129",massNumber:129,exactMass:128.93215,atomicNumber:48,halfLife:.27},{id:"Cd130",massNumber:130,exactMass:129.9339,atomicNumber:48,halfLife:.2},{id:"Cd131",massNumber:131,exactMass:130.94067,atomicNumber:48},{id:"Cd132",massNumber:132,exactMass:131.94555,atomicNumber:48}]},{elementSymbol:"In",atomicNumber:49,isotopes:[{id:"In97",massNumber:97,exactMass:96.94954,atomicNumber:49},{id:"In98",massNumber:98,exactMass:97.94214,atomicNumber:49},{id:"In99",massNumber:99,exactMass:98.93422,atomicNumber:49},{id:"In100",massNumber:100,exactMass:99.93111,atomicNumber:49,halfLife:7},{id:"In101",massNumber:101,exactMass:100.92634,atomicNumber:49,halfLife:15.1},{id:"In102",massNumber:102,exactMass:101.92409,atomicNumber:49,halfLife:22},{id:"In103",massNumber:103,exactMass:102.919914,atomicNumber:49,halfLife:65},{id:"In104",massNumber:104,exactMass:103.9183,atomicNumber:49,halfLife:108},{id:"In105",massNumber:105,exactMass:104.914674,atomicNumber:49,halfLife:304.2},{id:"In106",massNumber:106,exactMass:105.913465,atomicNumber:49,halfLife:372},{id:"In107",massNumber:107,exactMass:106.910295,atomicNumber:49,halfLife:1944},{id:"In108",massNumber:108,exactMass:107.909698,atomicNumber:49,halfLife:3480},{id:"In109",massNumber:109,exactMass:108.907151,atomicNumber:49,halfLife:15120},{id:"In110",massNumber:110,exactMass:109.907165,atomicNumber:49,halfLife:17640},{id:"In111",massNumber:111,exactMass:110.905103,atomicNumber:49,spin:"9/2+",halfLife:242326},{id:"In112",massNumber:112,exactMass:111.905532,atomicNumber:49,spin:"1+",halfLife:898.2},{id:"In113",massNumber:113,relativeAbundance:.0429,atomicNumber:49,exactMass:112.904058,spin:"1/2-",magneticMoment:"+5.5229",halfLife:-1},{id:"In114",massNumber:114,exactMass:113.904914,atomicNumber:49,spin:"5+",halfLife:71.9},{id:"In115",massNumber:115,relativeAbundance:.9571,atomicNumber:49,exactMass:114.903878,spin:"9/2+",magneticMoment:"+5.534"},{id:"In116",massNumber:116,exactMass:115.90526,atomicNumber:49,spin:"1+",halfLife:14.1},{id:"In117",massNumber:117,exactMass:116.904514,atomicNumber:49,halfLife:2592},{id:"In118",massNumber:118,exactMass:117.906354,atomicNumber:49,halfLife:5},{id:"In119",massNumber:119,exactMass:118.905845,atomicNumber:49,halfLife:144},{id:"In120",massNumber:120,exactMass:119.90796,atomicNumber:49,halfLife:3.08},{id:"In121",massNumber:121,exactMass:120.907846,atomicNumber:49,halfLife:23.1},{id:"In122",massNumber:122,exactMass:121.91028,atomicNumber:49,halfLife:1.5},{id:"In123",massNumber:123,exactMass:122.910438,atomicNumber:49,halfLife:5.98},{id:"In124",massNumber:124,exactMass:123.91318,atomicNumber:49,halfLife:3.11},{id:"In125",massNumber:125,exactMass:124.9136,atomicNumber:49,halfLife:2.36},{id:"In126",massNumber:126,exactMass:125.91646,atomicNumber:49,halfLife:1.6},{id:"In127",massNumber:127,exactMass:126.91735,atomicNumber:49,halfLife:1.09},{id:"In128",massNumber:128,exactMass:127.92017,atomicNumber:49,halfLife:.84},{id:"In129",massNumber:129,exactMass:128.9217,atomicNumber:49,halfLife:.61},{id:"In130",massNumber:130,exactMass:129.92497,atomicNumber:49,halfLife:.32},{id:"In131",massNumber:131,exactMass:130.92685,atomicNumber:49,halfLife:.282},{id:"In132",massNumber:132,exactMass:131.93299,atomicNumber:49,halfLife:.201},{id:"In133",massNumber:133,exactMass:132.93781,atomicNumber:49,halfLife:.18},{id:"In134",massNumber:134,exactMass:133.94415,atomicNumber:49,halfLife:.138},{id:"In135",massNumber:135,exactMass:134.94933,atomicNumber:49}]},{elementSymbol:"Sn",atomicNumber:50,isotopes:[{id:"Sn99",massNumber:99,exactMass:98.94933,atomicNumber:50},{id:"Sn100",massNumber:100,exactMass:99.93904,atomicNumber:50,halfLife:.94},{id:"Sn101",massNumber:101,exactMass:100.93606,atomicNumber:50,halfLife:3},{id:"Sn102",massNumber:102,exactMass:101.9303,atomicNumber:50,halfLife:4.5},{id:"Sn103",massNumber:103,exactMass:102.9281,atomicNumber:50,halfLife:7},{id:"Sn104",massNumber:104,exactMass:103.92314,atomicNumber:50,halfLife:20.8},{id:"Sn105",massNumber:105,exactMass:104.92135,atomicNumber:50,halfLife:31},{id:"Sn106",massNumber:106,exactMass:105.91688,atomicNumber:50,halfLife:115},{id:"Sn107",massNumber:107,exactMass:106.91564,atomicNumber:50,halfLife:174},{id:"Sn108",massNumber:108,exactMass:107.911925,atomicNumber:50,halfLife:618},{id:"Sn109",massNumber:109,exactMass:108.911283,atomicNumber:50,halfLife:1080},{id:"Sn110",massNumber:110,exactMass:109.907843,atomicNumber:50,halfLife:14796},{id:"Sn111",massNumber:111,exactMass:110.907734,atomicNumber:50,halfLife:2118},{id:"Sn112",massNumber:112,relativeAbundance:.0097,atomicNumber:50,exactMass:111.904818,spin:"0+",halfLife:-1},{id:"Sn113",massNumber:113,exactMass:112.905171,atomicNumber:50,spin:"1/2+",halfLife:9943780,ecDecay:"1.02",ecDecayLikeliness:"100.0"},{id:"Sn114",massNumber:114,relativeAbundance:.0066,atomicNumber:50,exactMass:113.902779,spin:"0+",halfLife:-1},{id:"Sn115",massNumber:115,relativeAbundance:.0034000000000000002,atomicNumber:50,exactMass:114.903342,spin:"1/2+",magneticMoment:"-0.91883",halfLife:-1},{id:"Sn116",massNumber:116,relativeAbundance:.1454,atomicNumber:50,exactMass:115.901741,spin:"0+",halfLife:-1},{id:"Sn117",massNumber:117,relativeAbundance:.0768,atomicNumber:50,exactMass:116.902952,spin:"1/2+",magneticMoment:"1.00104",halfLife:-1},{id:"Sn118",massNumber:118,relativeAbundance:.2422,atomicNumber:50,exactMass:117.901603,spin:"0+",halfLife:-1},{id:"Sn119",massNumber:119,relativeAbundance:.0859,atomicNumber:50,exactMass:118.903308,spin:"1/2+",magneticMoment:"-1.04728",halfLife:-1},{id:"Sn120",massNumber:120,relativeAbundance:.3258,atomicNumber:50,exactMass:119.9021947,spin:"0+",halfLife:-1},{id:"Sn121",massNumber:121,exactMass:120.9042355,atomicNumber:50,spin:"11/2-",halfLife:97416},{id:"Sn122",massNumber:122,relativeAbundance:.0463,atomicNumber:50,exactMass:121.903439,spin:"0+",halfLife:-1},{id:"Sn123",massNumber:123,exactMass:122.9057208,atomicNumber:50,spin:"11/2-",halfLife:11162900},{id:"Sn124",massNumber:124,relativeAbundance:.0579,atomicNumber:50,exactMass:123.9052739,spin:"0+",halfLife:-1},{id:"Sn125",massNumber:125,exactMass:124.9077841,atomicNumber:50,halfLife:832896},{id:"Sn126",massNumber:126,exactMass:125.907653,atomicNumber:50,halfLife:-1},{id:"Sn127",massNumber:127,exactMass:126.91036,atomicNumber:50,halfLife:7560},{id:"Sn128",massNumber:128,exactMass:127.910537,atomicNumber:50,halfLife:3544.2},{id:"Sn129",massNumber:129,exactMass:128.91348,atomicNumber:50,halfLife:133.8},{id:"Sn130",massNumber:130,exactMass:129.913967,atomicNumber:50,halfLife:223.2},{id:"Sn131",massNumber:131,exactMass:130.917,atomicNumber:50,halfLife:56},{id:"Sn132",massNumber:132,exactMass:131.917816,atomicNumber:50,halfLife:39.7},{id:"Sn133",massNumber:133,exactMass:132.92383,atomicNumber:50,halfLife:1.45},{id:"Sn134",massNumber:134,exactMass:133.92829,atomicNumber:50,halfLife:1.12},{id:"Sn135",massNumber:135,exactMass:134.93473,atomicNumber:50},{id:"Sn136",massNumber:136,exactMass:135.93934,atomicNumber:50},{id:"Sn137",massNumber:137,exactMass:136.94599,atomicNumber:50}]},{elementSymbol:"Sb",atomicNumber:51,isotopes:[{id:"Sb103",massNumber:103,exactMass:102.93969,atomicNumber:51},{id:"Sb104",massNumber:104,exactMass:103.93647,atomicNumber:51},{id:"Sb105",massNumber:105,exactMass:104.93149,atomicNumber:51},{id:"Sb106",massNumber:106,exactMass:105.92879,atomicNumber:51},{id:"Sb107",massNumber:107,exactMass:106.92415,atomicNumber:51},{id:"Sb108",massNumber:108,exactMass:107.92216,atomicNumber:51,halfLife:7.4},{id:"Sb109",massNumber:109,exactMass:108.918132,atomicNumber:51,halfLife:17},{id:"Sb110",massNumber:110,exactMass:109.91675,atomicNumber:51,halfLife:23},{id:"Sb111",massNumber:111,exactMass:110.91316,atomicNumber:51,halfLife:75},{id:"Sb112",massNumber:112,exactMass:111.912398,atomicNumber:51,halfLife:51.4},{id:"Sb113",massNumber:113,exactMass:112.909372,atomicNumber:51,halfLife:400.2},{id:"Sb114",massNumber:114,exactMass:113.90927,atomicNumber:51,halfLife:209.4},{id:"Sb115",massNumber:115,exactMass:114.906598,atomicNumber:51,halfLife:1926},{id:"Sb116",massNumber:116,exactMass:115.906794,atomicNumber:51,halfLife:948},{id:"Sb117",massNumber:117,exactMass:116.904836,atomicNumber:51,halfLife:10080},{id:"Sb118",massNumber:118,exactMass:117.905529,atomicNumber:51,halfLife:216},{id:"Sb119",massNumber:119,exactMass:118.903942,atomicNumber:51,halfLife:137484},{id:"Sb120",massNumber:120,exactMass:119.905072,atomicNumber:51,spin:"1+",halfLife:953.4},{id:"Sb121",massNumber:121,relativeAbundance:.5721,atomicNumber:51,exactMass:120.9038157,spin:"5/2+",magneticMoment:"+3.3592",halfLife:-1},{id:"Sb122",massNumber:122,exactMass:121.9051737,atomicNumber:51,spin:"2-",halfLife:235336},{id:"Sb123",massNumber:123,relativeAbundance:.4279,atomicNumber:51,exactMass:122.904214,spin:"7/2+",magneticMoment:"+2.5466",halfLife:-1},{id:"Sb124",massNumber:124,exactMass:123.9059357,atomicNumber:51,spin:"3-",halfLife:5201280},{id:"Sb125",massNumber:125,exactMass:124.9052538,atomicNumber:51,halfLife:86982600},{id:"Sb126",massNumber:126,exactMass:125.90725,atomicNumber:51,halfLife:1076540},{id:"Sb127",massNumber:127,exactMass:126.906924,atomicNumber:51,halfLife:332640},{id:"Sb128",massNumber:128,exactMass:127.909169,atomicNumber:51,halfLife:32436},{id:"Sb129",massNumber:129,exactMass:128.909148,atomicNumber:51,halfLife:15840},{id:"Sb130",massNumber:130,exactMass:129.911656,atomicNumber:51,halfLife:2370},{id:"Sb131",massNumber:131,exactMass:130.911982,atomicNumber:51,halfLife:1381.8},{id:"Sb132",massNumber:132,exactMass:131.914467,atomicNumber:51,halfLife:167.4},{id:"Sb133",massNumber:133,exactMass:132.915252,atomicNumber:51,halfLife:150},{id:"Sb134",massNumber:134,exactMass:133.92038,atomicNumber:51,halfLife:.78},{id:"Sb135",massNumber:135,exactMass:134.92517,atomicNumber:51,halfLife:1.71},{id:"Sb136",massNumber:136,exactMass:135.93035,atomicNumber:51,halfLife:.82},{id:"Sb137",massNumber:137,exactMass:136.93531,atomicNumber:51},{id:"Sb138",massNumber:138,exactMass:137.94079,atomicNumber:51},{id:"Sb139",massNumber:139,exactMass:138.94598,atomicNumber:51}]},{elementSymbol:"Te",atomicNumber:52,isotopes:[{id:"Te105",massNumber:105,exactMass:104.94364,atomicNumber:52},{id:"Te106",massNumber:106,exactMass:105.9375,atomicNumber:52,halfLife:6e-5},{id:"Te107",massNumber:107,exactMass:106.93501,atomicNumber:52,halfLife:.0031},{id:"Te108",massNumber:108,exactMass:107.92944,atomicNumber:52,halfLife:2.1},{id:"Te109",massNumber:109,exactMass:108.92742,atomicNumber:52,halfLife:4.6},{id:"Te110",massNumber:110,exactMass:109.92241,atomicNumber:52,halfLife:18.6},{id:"Te111",massNumber:111,exactMass:110.92111,atomicNumber:52,halfLife:19.3},{id:"Te112",massNumber:112,exactMass:111.91701,atomicNumber:52},{id:"Te113",massNumber:113,exactMass:112.91589,atomicNumber:52,halfLife:102},{id:"Te114",massNumber:114,exactMass:113.91209,atomicNumber:52,halfLife:912},{id:"Te115",massNumber:115,exactMass:114.9119,atomicNumber:52,halfLife:348},{id:"Te116",massNumber:116,exactMass:115.90846,atomicNumber:52,halfLife:8964},{id:"Te117",massNumber:117,exactMass:116.908645,atomicNumber:52,halfLife:3720},{id:"Te118",massNumber:118,exactMass:117.905828,atomicNumber:52,halfLife:518400},{id:"Te119",massNumber:119,exactMass:118.906404,atomicNumber:52,halfLife:57708},{id:"Te120",massNumber:120,relativeAbundance:9e-4,atomicNumber:52,exactMass:119.90402,spin:"0+",halfLife:-1},{id:"Te121",massNumber:121,exactMass:120.904936,atomicNumber:52,spin:"1/2+",halfLife:1449790},{id:"Te122",massNumber:122,relativeAbundance:.0255,atomicNumber:52,exactMass:121.9030439,spin:"0+",magneticMoment:"-0.7359",halfLife:-1,ecDecay:"0.052",ecDecayLikeliness:"100.0"},{id:"Te123",massNumber:123,relativeAbundance:.0089,atomicNumber:52,exactMass:122.90427,spin:"1/2+",halfLife:-1},{id:"Te124",massNumber:124,relativeAbundance:.047400000000000005,atomicNumber:52,exactMass:123.9028179,spin:"0+",magneticMoment:"-0.8871",halfLife:-1},{id:"Te125",massNumber:125,relativeAbundance:.0707,atomicNumber:52,exactMass:124.9044307,spin:"1/2+",halfLife:-1},{id:"Te126",massNumber:126,relativeAbundance:.1884,atomicNumber:52,exactMass:125.9033117,spin:"0+",halfLife:-1,betaminusDecay:"0.697",betaminusDecayLikeliness:"100.0"},{id:"Te127",massNumber:127,exactMass:126.9052263,atomicNumber:52,spin:"3/2+",halfLife:33660},{id:"Te128",massNumber:128,relativeAbundance:.31739999999999996,atomicNumber:52,exactMass:127.9044631,spin:"0+"},{id:"Te129",massNumber:129,exactMass:128.9065982,atomicNumber:52,spin:"3/2+",halfLife:4176},{id:"Te130",massNumber:130,relativeAbundance:.3408,atomicNumber:52,exactMass:129.9062244,spin:"0+"},{id:"Te131",massNumber:131,exactMass:130.9085239,atomicNumber:52,halfLife:1500},{id:"Te132",massNumber:132,exactMass:131.908553,atomicNumber:52,halfLife:276826},{id:"Te133",massNumber:133,exactMass:132.910955,atomicNumber:52,halfLife:750},{id:"Te134",massNumber:134,exactMass:133.911369,atomicNumber:52,halfLife:2508},{id:"Te135",massNumber:135,exactMass:134.91645,atomicNumber:52,halfLife:19},{id:"Te136",massNumber:136,exactMass:135.9201,atomicNumber:52,halfLife:17.5},{id:"Te137",massNumber:137,exactMass:136.92532,atomicNumber:52,halfLife:2.49},{id:"Te138",massNumber:138,exactMass:137.92922,atomicNumber:52,halfLife:1.4},{id:"Te139",massNumber:139,exactMass:138.93473,atomicNumber:52},{id:"Te140",massNumber:140,exactMass:139.93885,atomicNumber:52},{id:"Te141",massNumber:141,exactMass:140.94465,atomicNumber:52},{id:"Te142",massNumber:142,exactMass:141.94908,atomicNumber:52}]},{elementSymbol:"I",atomicNumber:53,isotopes:[{id:"I108",massNumber:108,exactMass:107.94348,atomicNumber:53,halfLife:.036},{id:"I109",massNumber:109,exactMass:108.93815,atomicNumber:53,halfLife:1e-4},{id:"I110",massNumber:110,exactMass:109.93524,atomicNumber:53,halfLife:.65},{id:"I111",massNumber:111,exactMass:110.93028,atomicNumber:53,halfLife:2.5},{id:"I112",massNumber:112,exactMass:111.92797,atomicNumber:53,halfLife:3.42},{id:"I113",massNumber:113,exactMass:112.92364,atomicNumber:53,halfLife:6.6},{id:"I114",massNumber:114,exactMass:113.92185,atomicNumber:53,halfLife:2.1},{id:"I115",massNumber:115,exactMass:114.91805,atomicNumber:53,halfLife:78},{id:"I116",massNumber:116,exactMass:115.91681,atomicNumber:53,halfLife:2.91},{id:"I117",massNumber:117,exactMass:116.91365,atomicNumber:53,halfLife:133.2},{id:"I118",massNumber:118,exactMass:117.913074,atomicNumber:53,halfLife:822},{id:"I119",massNumber:119,exactMass:118.91007,atomicNumber:53,halfLife:1146},{id:"I120",massNumber:120,exactMass:119.910048,atomicNumber:53,halfLife:4860},{id:"I121",massNumber:121,exactMass:120.907367,atomicNumber:53,halfLife:7632},{id:"I122",massNumber:122,exactMass:121.907589,atomicNumber:53,halfLife:217.8},{id:"I123",massNumber:123,exactMass:122.905589,atomicNumber:53,halfLife:47772},{id:"I124",massNumber:124,exactMass:123.9062099,atomicNumber:53,halfLife:360806},{id:"I125",massNumber:125,exactMass:124.9046302,atomicNumber:53,spin:"5/2+",halfLife:5132850},{id:"I126",massNumber:126,exactMass:125.905624,atomicNumber:53,spin:"2-",halfLife:1132700},{id:"I127",massNumber:127,relativeAbundance:1,atomicNumber:53,exactMass:126.904473,spin:"5/2+",magneticMoment:"+2.808",halfLife:-1},{id:"I128",massNumber:128,exactMass:127.905809,atomicNumber:53,spin:"1+",halfLife:1499.4},{id:"I129",massNumber:129,exactMass:128.904988,atomicNumber:53,magneticMoment:"+2.617",halfLife:157e5,betaminusDecay:"0.193",betaminusDecayLikeliness:"100.0"},{id:"I130",massNumber:130,exactMass:129.906674,atomicNumber:53,halfLife:44496},{id:"I131",massNumber:131,exactMass:130.9061246,atomicNumber:53,halfLife:692988},{id:"I132",massNumber:132,exactMass:131.907997,atomicNumber:53,halfLife:8262},{id:"I133",massNumber:133,exactMass:132.907797,atomicNumber:53,halfLife:74880},{id:"I134",massNumber:134,exactMass:133.909744,atomicNumber:53,halfLife:3150},{id:"I135",massNumber:135,exactMass:134.910048,atomicNumber:53,halfLife:23652},{id:"I136",massNumber:136,exactMass:135.91465,atomicNumber:53,halfLife:83.4},{id:"I137",massNumber:137,exactMass:136.917871,atomicNumber:53,halfLife:24.5},{id:"I138",massNumber:138,exactMass:137.92235,atomicNumber:53,halfLife:6.49},{id:"I139",massNumber:139,exactMass:138.9261,atomicNumber:53,halfLife:2.29},{id:"I140",massNumber:140,exactMass:139.931,atomicNumber:53,halfLife:.86},{id:"I141",massNumber:141,exactMass:140.93503,atomicNumber:53,halfLife:.43},{id:"I142",massNumber:142,exactMass:141.94018,atomicNumber:53},{id:"I143",massNumber:143,exactMass:142.94456,atomicNumber:53},{id:"I144",massNumber:144,exactMass:143.94999,atomicNumber:53}]},{elementSymbol:"Xe",atomicNumber:54,isotopes:[{id:"Xe110",massNumber:110,exactMass:109.94428,atomicNumber:54,halfLife:6e-7},{id:"Xe111",massNumber:111,exactMass:110.9416,atomicNumber:54,halfLife:.74},{id:"Xe112",massNumber:112,exactMass:111.93562,atomicNumber:54,halfLife:2.7},{id:"Xe113",massNumber:113,exactMass:112.93334,atomicNumber:54,halfLife:2.74},{id:"Xe114",massNumber:114,exactMass:113.92798,atomicNumber:54,halfLife:10},{id:"Xe115",massNumber:115,exactMass:114.926294,atomicNumber:54,halfLife:18},{id:"Xe116",massNumber:116,exactMass:115.921581,atomicNumber:54,halfLife:59},{id:"Xe117",massNumber:117,exactMass:116.920359,atomicNumber:54,halfLife:61},{id:"Xe118",massNumber:118,exactMass:117.916179,atomicNumber:54,halfLife:228},{id:"Xe119",massNumber:119,exactMass:118.915411,atomicNumber:54,halfLife:348},{id:"Xe120",massNumber:120,exactMass:119.911784,atomicNumber:54,halfLife:2400},{id:"Xe121",massNumber:121,exactMass:120.911462,atomicNumber:54,halfLife:2406},{id:"Xe122",massNumber:122,exactMass:121.908368,atomicNumber:54,halfLife:72360},{id:"Xe123",massNumber:123,exactMass:122.908482,atomicNumber:54,halfLife:7488},{id:"Xe124",massNumber:124,relativeAbundance:9e-4,atomicNumber:54,exactMass:123.905893,spin:"0+"},{id:"Xe125",massNumber:125,exactMass:124.9063955,atomicNumber:54,spin:"1/2+",halfLife:60840,ecDecay:"",ecDecayLikeliness:"100.0"},{id:"Xe126",massNumber:126,relativeAbundance:9e-4,atomicNumber:54,exactMass:125.904274,spin:"0+",halfLife:-1},{id:"Xe127",massNumber:127,exactMass:126.905184,atomicNumber:54,spin:"1/2+",halfLife:3144960,ecDecay:"0.44",ecDecayLikeliness:"100.0"},{id:"Xe128",massNumber:128,relativeAbundance:.0192,atomicNumber:54,exactMass:127.9035313,spin:"0+",halfLife:-1},{id:"Xe129",massNumber:129,relativeAbundance:.2644,atomicNumber:54,exactMass:128.9047794,spin:"1/2+",magneticMoment:"-0.7768",halfLife:-1},{id:"Xe130",massNumber:130,relativeAbundance:.0408,atomicNumber:54,exactMass:129.903508,spin:"0+",halfLife:-1},{id:"Xe131",massNumber:131,relativeAbundance:.2118,atomicNumber:54,exactMass:130.9050824,spin:"3/2+",magneticMoment:"+0.691861",halfLife:-1},{id:"Xe132",massNumber:132,relativeAbundance:.26890000000000003,atomicNumber:54,exactMass:131.9041535,spin:"0+",halfLife:-1},{id:"Xe133",massNumber:133,exactMass:132.9059107,atomicNumber:54,spin:"3/2+",halfLife:452995},{id:"Xe134",massNumber:134,relativeAbundance:.10439999999999999,atomicNumber:54,exactMass:133.9053945,spin:"0+",halfLife:-1},{id:"Xe135",massNumber:135,exactMass:134.907227,atomicNumber:54,spin:"3/2+",halfLife:32904},{id:"Xe136",massNumber:136,relativeAbundance:.08869999999999999,atomicNumber:54,exactMass:135.907219,spin:"0+"},{id:"Xe137",massNumber:137,exactMass:136.911562,atomicNumber:54,halfLife:229.08},{id:"Xe138",massNumber:138,exactMass:137.91395,atomicNumber:54,halfLife:844.8},{id:"Xe139",massNumber:139,exactMass:138.918793,atomicNumber:54,halfLife:39.68},{id:"Xe140",massNumber:140,exactMass:139.92164,atomicNumber:54,halfLife:13.6},{id:"Xe141",massNumber:141,exactMass:140.92665,atomicNumber:54,halfLife:1.73},{id:"Xe142",massNumber:142,exactMass:141.92971,atomicNumber:54,halfLife:1.22},{id:"Xe143",massNumber:143,exactMass:142.93511,atomicNumber:54,halfLife:.3},{id:"Xe144",massNumber:144,exactMass:143.93851,atomicNumber:54,halfLife:1.15},{id:"Xe145",massNumber:145,exactMass:144.94407,atomicNumber:54,halfLife:.9},{id:"Xe146",massNumber:146,exactMass:145.94775,atomicNumber:54},{id:"Xe147",massNumber:147,exactMass:146.95356,atomicNumber:54}]},{elementSymbol:"Cs",atomicNumber:55,isotopes:[{id:"Cs112",massNumber:112,exactMass:111.9503,atomicNumber:55},{id:"Cs113",massNumber:113,exactMass:112.94449,atomicNumber:55,halfLife:17e-6},{id:"Cs114",massNumber:114,exactMass:113.94145,atomicNumber:55,halfLife:.57},{id:"Cs115",massNumber:115,exactMass:114.93591,atomicNumber:55,halfLife:1.4},{id:"Cs116",massNumber:116,exactMass:115.93337,atomicNumber:55,halfLife:3.84},{id:"Cs117",massNumber:117,exactMass:116.92867,atomicNumber:55,halfLife:8.4},{id:"Cs118",massNumber:118,exactMass:117.926559,atomicNumber:55,halfLife:14},{id:"Cs119",massNumber:119,exactMass:118.922377,atomicNumber:55,halfLife:43},{id:"Cs120",massNumber:120,exactMass:119.920677,atomicNumber:55,halfLife:64},{id:"Cs121",massNumber:121,exactMass:120.917229,atomicNumber:55,halfLife:155},{id:"Cs122",massNumber:122,exactMass:121.91611,atomicNumber:55,halfLife:21},{id:"Cs123",massNumber:123,exactMass:122.912996,atomicNumber:55,halfLife:356.4},{id:"Cs124",massNumber:124,exactMass:123.912258,atomicNumber:55,halfLife:30.8},{id:"Cs125",massNumber:125,exactMass:124.909728,atomicNumber:55,halfLife:2700},{id:"Cs126",massNumber:126,exactMass:125.909452,atomicNumber:55,halfLife:98.4},{id:"Cs127",massNumber:127,exactMass:126.907418,atomicNumber:55,halfLife:22500},{id:"Cs128",massNumber:128,exactMass:127.907749,atomicNumber:55,halfLife:219.6},{id:"Cs129",massNumber:129,exactMass:128.906064,atomicNumber:55,halfLife:115416},{id:"Cs130",massNumber:130,exactMass:129.906709,atomicNumber:55,halfLife:1752.6},{id:"Cs131",massNumber:131,exactMass:130.905464,atomicNumber:55,halfLife:837130},{id:"Cs132",massNumber:132,exactMass:131.9064343,atomicNumber:55,halfLife:559786},{id:"Cs133",massNumber:133,relativeAbundance:1,atomicNumber:55,exactMass:132.9054519,spin:"7/2+",magneticMoment:"+2.579",halfLife:-1},{id:"Cs134",massNumber:134,exactMass:133.9067185,atomicNumber:55,spin:"4+",halfLife:65115500},{id:"Cs135",massNumber:135,exactMass:134.905977,atomicNumber:55,spin:"7/2+",magneticMoment:"+2.729",halfLife:23e5,betaminusDecay:"2.05",betaminusDecayLikeliness:"100.0"},{id:"Cs136",massNumber:136,exactMass:135.9073116,atomicNumber:55,halfLife:1137020},{id:"Cs137",massNumber:137,exactMass:136.9070895,atomicNumber:55,halfLife:948288e3},{id:"Cs138",massNumber:138,exactMass:137.911017,atomicNumber:55,halfLife:2004.6},{id:"Cs139",massNumber:139,exactMass:138.913364,atomicNumber:55,halfLife:556.2},{id:"Cs140",massNumber:140,exactMass:139.917282,atomicNumber:55,halfLife:63.7},{id:"Cs141",massNumber:141,exactMass:140.920046,atomicNumber:55,halfLife:24.94},{id:"Cs142",massNumber:142,exactMass:141.924299,atomicNumber:55,halfLife:1.7},{id:"Cs143",massNumber:143,exactMass:142.927352,atomicNumber:55,halfLife:1.78},{id:"Cs144",massNumber:144,exactMass:143.932077,atomicNumber:55,halfLife:1.01},{id:"Cs145",massNumber:145,exactMass:144.935526,atomicNumber:55,halfLife:.594},{id:"Cs146",massNumber:146,exactMass:145.94029,atomicNumber:55,halfLife:.321},{id:"Cs147",massNumber:147,exactMass:146.94416,atomicNumber:55,halfLife:.225},{id:"Cs148",massNumber:148,exactMass:147.94922,atomicNumber:55,halfLife:.158},{id:"Cs149",massNumber:149,exactMass:148.95293,atomicNumber:55},{id:"Cs150",massNumber:150,exactMass:149.95817,atomicNumber:55},{id:"Cs151",massNumber:151,exactMass:150.96219,atomicNumber:55}]},{elementSymbol:"Ba",atomicNumber:56,isotopes:[{id:"Ba114",massNumber:114,exactMass:113.95068,atomicNumber:56,halfLife:.43},{id:"Ba115",massNumber:115,exactMass:114.94737,atomicNumber:56,halfLife:.4},{id:"Ba116",massNumber:116,exactMass:115.94138,atomicNumber:56,halfLife:.3},{id:"Ba117",massNumber:117,exactMass:116.9385,atomicNumber:56,halfLife:1.75},{id:"Ba118",massNumber:118,exactMass:117.93304,atomicNumber:56,halfLife:5.5},{id:"Ba119",massNumber:119,exactMass:118.93066,atomicNumber:56,halfLife:5.4},{id:"Ba120",massNumber:120,exactMass:119.92604,atomicNumber:56,halfLife:32},{id:"Ba121",massNumber:121,exactMass:120.92405,atomicNumber:56,halfLife:29.7},{id:"Ba122",massNumber:122,exactMass:121.9199,atomicNumber:56,halfLife:117},{id:"Ba123",massNumber:123,exactMass:122.918781,atomicNumber:56,halfLife:162},{id:"Ba124",massNumber:124,exactMass:123.915094,atomicNumber:56,halfLife:660},{id:"Ba125",massNumber:125,exactMass:124.914473,atomicNumber:56,halfLife:210},{id:"Ba126",massNumber:126,exactMass:125.91125,atomicNumber:56,halfLife:6e3},{id:"Ba127",massNumber:127,exactMass:126.911094,atomicNumber:56,halfLife:762},{id:"Ba128",massNumber:128,exactMass:127.908318,atomicNumber:56,halfLife:209952},{id:"Ba129",massNumber:129,exactMass:128.908679,atomicNumber:56,halfLife:8028},{id:"Ba130",massNumber:130,relativeAbundance:.00106,atomicNumber:56,exactMass:129.9063208,spin:"0+",halfLife:-1},{id:"Ba131",massNumber:131,exactMass:130.906941,atomicNumber:56,spin:"1/2+",halfLife:993600,ecDecay:"1.16",ecDecayLikeliness:"100.0"},{id:"Ba132",massNumber:132,relativeAbundance:.00101,atomicNumber:56,exactMass:131.9050613,spin:"0+",halfLife:-1},{id:"Ba133",massNumber:133,exactMass:132.9060075,atomicNumber:56,spin:"1/2+",halfLife:331443e3},{id:"Ba134",massNumber:134,relativeAbundance:.024169999999999997,atomicNumber:56,exactMass:133.9045084,spin:"0+",halfLife:-1},{id:"Ba135",massNumber:135,relativeAbundance:.06591999999999999,atomicNumber:56,exactMass:134.9056886,spin:"3/2+",magneticMoment:"+0.8365",halfLife:-1},{id:"Ba136",massNumber:136,relativeAbundance:.07854,atomicNumber:56,exactMass:135.9045759,spin:"0+",halfLife:-1},{id:"Ba137",massNumber:137,relativeAbundance:.11231999999999999,atomicNumber:56,exactMass:136.9058274,spin:"3/2+",magneticMoment:"+0.9357",halfLife:-1},{id:"Ba138",massNumber:138,relativeAbundance:.71698,atomicNumber:56,exactMass:137.9052472,spin:"0+",halfLife:-1},{id:"Ba139",massNumber:139,exactMass:138.9088413,atomicNumber:56,halfLife:4983.6},{id:"Ba140",massNumber:140,exactMass:139.910605,atomicNumber:56,halfLife:1101770},{id:"Ba141",massNumber:141,exactMass:140.914411,atomicNumber:56,halfLife:1096.2},{id:"Ba142",massNumber:142,exactMass:141.916453,atomicNumber:56,halfLife:636},{id:"Ba143",massNumber:143,exactMass:142.920627,atomicNumber:56,halfLife:14.33},{id:"Ba144",massNumber:144,exactMass:143.922953,atomicNumber:56,halfLife:11.5},{id:"Ba145",massNumber:145,exactMass:144.92763,atomicNumber:56,halfLife:4.31},{id:"Ba146",massNumber:146,exactMass:145.93022,atomicNumber:56,halfLife:2.22},{id:"Ba147",massNumber:147,exactMass:146.93495,atomicNumber:56,halfLife:.893},{id:"Ba148",massNumber:148,exactMass:147.93772,atomicNumber:56,halfLife:.607},{id:"Ba149",massNumber:149,exactMass:148.94258,atomicNumber:56,halfLife:.344},{id:"Ba150",massNumber:150,exactMass:149.94568,atomicNumber:56,halfLife:.3},{id:"Ba151",massNumber:151,exactMass:150.95081,atomicNumber:56},{id:"Ba152",massNumber:152,exactMass:151.95427,atomicNumber:56},{id:"Ba153",massNumber:153,exactMass:152.95961,atomicNumber:56}]},{elementSymbol:"La",atomicNumber:57,isotopes:[{id:"La117",massNumber:117,exactMass:116.95007,atomicNumber:57},{id:"La118",massNumber:118,exactMass:117.94673,atomicNumber:57},{id:"La119",massNumber:119,exactMass:118.94099,atomicNumber:57},{id:"La120",massNumber:120,exactMass:119.93807,atomicNumber:57,halfLife:2.8},{id:"La121",massNumber:121,exactMass:120.93301,atomicNumber:57,halfLife:5.3},{id:"La122",massNumber:122,exactMass:121.93071,atomicNumber:57,halfLife:8.7},{id:"La123",massNumber:123,exactMass:122.92624,atomicNumber:57,halfLife:17},{id:"La124",massNumber:124,exactMass:123.92457,atomicNumber:57,halfLife:29},{id:"La125",massNumber:125,exactMass:124.920816,atomicNumber:57,halfLife:76},{id:"La126",massNumber:126,exactMass:125.91951,atomicNumber:57,halfLife:54},{id:"La127",massNumber:127,exactMass:126.916375,atomicNumber:57,halfLife:306},{id:"La128",massNumber:128,exactMass:127.91559,atomicNumber:57,halfLife:300},{id:"La129",massNumber:129,exactMass:128.912693,atomicNumber:57,halfLife:696},{id:"La130",massNumber:130,exactMass:129.912369,atomicNumber:57,halfLife:522},{id:"La131",massNumber:131,exactMass:130.91007,atomicNumber:57,halfLife:3540},{id:"La132",massNumber:132,exactMass:131.9101,atomicNumber:57,halfLife:17280},{id:"La133",massNumber:133,exactMass:132.90822,atomicNumber:57,halfLife:14083.2},{id:"La134",massNumber:134,exactMass:133.908514,atomicNumber:57,halfLife:387},{id:"La135",massNumber:135,exactMass:134.906977,atomicNumber:57,halfLife:70200},{id:"La136",massNumber:136,exactMass:135.90764,atomicNumber:57,halfLife:592.2},{id:"La137",massNumber:137,exactMass:136.906494,atomicNumber:57},{id:"La138",massNumber:138,relativeAbundance:9e-4,atomicNumber:57,exactMass:137.907112,spin:"5-",magneticMoment:"+3.707",halfLife:105e9,betaminusDecay:"1.04",betaminusDecayLikeliness:"33.6",ecDecay:"1.75",ecDecayLikeliness:"66.4"},{id:"La139",massNumber:139,relativeAbundance:.9991,atomicNumber:57,exactMass:138.9063533,spin:"7/2+",magneticMoment:"+2.778",halfLife:-1},{id:"La140",massNumber:140,exactMass:139.9094776,atomicNumber:57,spin:"3-",magneticMoment:"+0.73",halfLife:144988,betaminusDecay:"3.761",betaminusDecayLikeliness:"100.0"},{id:"La141",massNumber:141,exactMass:140.910962,atomicNumber:57,halfLife:14112},{id:"La142",massNumber:142,exactMass:141.914079,atomicNumber:57,halfLife:5466},{id:"La143",massNumber:143,exactMass:142.916063,atomicNumber:57,halfLife:852},{id:"La144",massNumber:144,exactMass:143.9196,atomicNumber:57,halfLife:40.8},{id:"La145",massNumber:145,exactMass:144.92165,atomicNumber:57,halfLife:24.8},{id:"La146",massNumber:146,exactMass:145.92579,atomicNumber:57,halfLife:6.27},{id:"La147",massNumber:147,exactMass:146.92824,atomicNumber:57,halfLife:4.015},{id:"La148",massNumber:148,exactMass:147.93223,atomicNumber:57,halfLife:1.05},{id:"La149",massNumber:149,exactMass:148.93473,atomicNumber:57,halfLife:1.05},{id:"La150",massNumber:150,exactMass:149.93877,atomicNumber:57,halfLife:.86},{id:"La151",massNumber:151,exactMass:150.94172,atomicNumber:57},{id:"La152",massNumber:152,exactMass:151.94625,atomicNumber:57},{id:"La153",massNumber:153,exactMass:152.94962,atomicNumber:57},{id:"La154",massNumber:154,exactMass:153.9545,atomicNumber:57},{id:"La155",massNumber:155,exactMass:154.95835,atomicNumber:57}]},{elementSymbol:"Ce",atomicNumber:58,isotopes:[{id:"Ce119",massNumber:119,exactMass:118.95276,atomicNumber:58},{id:"Ce120",massNumber:120,exactMass:119.94664,atomicNumber:58},{id:"Ce121",massNumber:121,exactMass:120.94342,atomicNumber:58},{id:"Ce122",massNumber:122,exactMass:121.93791,atomicNumber:58},{id:"Ce123",massNumber:123,exactMass:122.9354,atomicNumber:58,halfLife:3.2},{id:"Ce124",massNumber:124,exactMass:123.93041,atomicNumber:58,halfLife:6},{id:"Ce125",massNumber:125,exactMass:124.92844,atomicNumber:58,halfLife:9},{id:"Ce126",massNumber:126,exactMass:125.92397,atomicNumber:58,halfLife:50},{id:"Ce127",massNumber:127,exactMass:126.92273,atomicNumber:58,halfLife:31},{id:"Ce128",massNumber:128,exactMass:127.91891,atomicNumber:58,halfLife:4.1},{id:"Ce129",massNumber:129,exactMass:128.9181,atomicNumber:58,halfLife:210},{id:"Ce130",massNumber:130,exactMass:129.91474,atomicNumber:58,halfLife:1500},{id:"Ce131",massNumber:131,exactMass:130.91442,atomicNumber:58,halfLife:612},{id:"Ce132",massNumber:132,exactMass:131.91146,atomicNumber:58,halfLife:12636},{id:"Ce133",massNumber:133,exactMass:132.911515,atomicNumber:58,halfLife:5820},{id:"Ce134",massNumber:134,exactMass:133.908925,atomicNumber:58,halfLife:273024},{id:"Ce135",massNumber:135,exactMass:134.909151,atomicNumber:58,halfLife:63720},{id:"Ce136",massNumber:136,relativeAbundance:.00185,atomicNumber:58,exactMass:135.907172,spin:"0+",halfLife:-1},{id:"Ce137",massNumber:137,exactMass:136.907806,atomicNumber:58,spin:"3/2+",halfLife:32400,betaplusDecay:"",betaplusDecayLikeliness:"100.0",ecDecay:"",ecDecayLikeliness:"100.0"},{id:"Ce138",massNumber:138,relativeAbundance:.00251,atomicNumber:58,exactMass:137.905991,spin:"0+",halfLife:-1},{id:"Ce139",massNumber:139,exactMass:138.906653,atomicNumber:58,magneticMoment:"0.9",halfLife:11892100,ecDecay:"0.27",ecDecayLikeliness:"100.0"},{id:"Ce140",massNumber:140,relativeAbundance:.8845000000000001,atomicNumber:58,exactMass:139.9054387,spin:"0+",halfLife:-1},{id:"Ce141",massNumber:141,exactMass:140.9082763,atomicNumber:58,spin:"7/2-",magneticMoment:"0.97",halfLife:2808090,betaminusDecay:"0.581",betaminusDecayLikeliness:"100.0"},{id:"Ce142",massNumber:142,relativeAbundance:.11114,atomicNumber:58,exactMass:141.909244,spin:"0+"},{id:"Ce143",massNumber:143,exactMass:142.912386,atomicNumber:58,halfLife:118940},{id:"Ce144",massNumber:144,exactMass:143.913647,atomicNumber:58,halfLife:24614800},{id:"Ce145",massNumber:145,exactMass:144.91723,atomicNumber:58,halfLife:180.6},{id:"Ce146",massNumber:146,exactMass:145.91876,atomicNumber:58,halfLife:811.2},{id:"Ce147",massNumber:147,exactMass:146.92267,atomicNumber:58,halfLife:56.4},{id:"Ce148",massNumber:148,exactMass:147.92443,atomicNumber:58,halfLife:56},{id:"Ce149",massNumber:149,exactMass:148.9284,atomicNumber:58,halfLife:5.3},{id:"Ce150",massNumber:150,exactMass:149.93041,atomicNumber:58,halfLife:4},{id:"Ce151",massNumber:151,exactMass:150.93398,atomicNumber:58,halfLife:1.02},{id:"Ce152",massNumber:152,exactMass:151.93654,atomicNumber:58,halfLife:1.4},{id:"Ce153",massNumber:153,exactMass:152.94058,atomicNumber:58},{id:"Ce154",massNumber:154,exactMass:153.94342,atomicNumber:58},{id:"Ce155",massNumber:155,exactMass:154.94804,atomicNumber:58},{id:"Ce156",massNumber:156,exactMass:155.95126,atomicNumber:58},{id:"Ce157",massNumber:157,exactMass:156.95634,atomicNumber:58}]},{elementSymbol:"Pr",atomicNumber:59,isotopes:[{id:"Pr121",massNumber:121,exactMass:120.95536,atomicNumber:59},{id:"Pr122",massNumber:122,exactMass:121.95181,atomicNumber:59},{id:"Pr123",massNumber:123,exactMass:122.94596,atomicNumber:59},{id:"Pr124",massNumber:124,exactMass:123.94296,atomicNumber:59,halfLife:1.2},{id:"Pr125",massNumber:125,exactMass:124.93783,atomicNumber:59,halfLife:3.3},{id:"Pr126",massNumber:126,exactMass:125.93531,atomicNumber:59,halfLife:3.14},{id:"Pr127",massNumber:127,exactMass:126.93083,atomicNumber:59,halfLife:4.2},{id:"Pr128",massNumber:128,exactMass:127.92879,atomicNumber:59,halfLife:3.1},{id:"Pr129",massNumber:129,exactMass:128.9251,atomicNumber:59,halfLife:30},{id:"Pr130",massNumber:130,exactMass:129.92359,atomicNumber:59,halfLife:40},{id:"Pr131",massNumber:131,exactMass:130.92026,atomicNumber:59,halfLife:91.8},{id:"Pr132",massNumber:132,exactMass:131.91926,atomicNumber:59,halfLife:96},{id:"Pr133",massNumber:133,exactMass:132.916331,atomicNumber:59,halfLife:390},{id:"Pr134",massNumber:134,exactMass:133.91571,atomicNumber:59,halfLife:1020},{id:"Pr135",massNumber:135,exactMass:134.913112,atomicNumber:59,halfLife:1440},{id:"Pr136",massNumber:136,exactMass:135.912692,atomicNumber:59,halfLife:786},{id:"Pr137",massNumber:137,exactMass:136.910705,atomicNumber:59,halfLife:4608},{id:"Pr138",massNumber:138,exactMass:137.910755,atomicNumber:59,halfLife:87},{id:"Pr139",massNumber:139,exactMass:138.908938,atomicNumber:59,halfLife:15876},{id:"Pr140",massNumber:140,exactMass:139.909076,atomicNumber:59,halfLife:203.4},{id:"Pr141",massNumber:141,relativeAbundance:1,atomicNumber:59,exactMass:140.9076528,spin:"5/2+",magneticMoment:"+4.3",halfLife:-1},{id:"Pr142",massNumber:142,exactMass:141.9100448,atomicNumber:59,spin:"2-",halfLife:68832,betaminusDecay:"2.160",betaminusDecayLikeliness:"99.98",ecDecay:"",ecDecayLikeliness:"0.02"},{id:"Pr143",massNumber:143,exactMass:142.9108169,atomicNumber:59,halfLife:1172450},{id:"Pr144",massNumber:144,exactMass:143.913305,atomicNumber:59,halfLife:1036.8},{id:"Pr145",massNumber:145,exactMass:144.914512,atomicNumber:59,halfLife:21542.4},{id:"Pr146",massNumber:146,exactMass:145.91764,atomicNumber:59,halfLife:1449},{id:"Pr147",massNumber:147,exactMass:146.918996,atomicNumber:59,halfLife:804},{id:"Pr148",massNumber:148,exactMass:147.922135,atomicNumber:59,halfLife:136.2},{id:"Pr149",massNumber:149,exactMass:148.92372,atomicNumber:59,halfLife:135.6},{id:"Pr150",massNumber:150,exactMass:149.926673,atomicNumber:59,halfLife:6.19},{id:"Pr151",massNumber:151,exactMass:150.928319,atomicNumber:59,halfLife:18.9},{id:"Pr152",massNumber:152,exactMass:151.9315,atomicNumber:59,halfLife:3.63},{id:"Pr153",massNumber:153,exactMass:152.93384,atomicNumber:59,halfLife:4.28},{id:"Pr154",massNumber:154,exactMass:153.93752,atomicNumber:59,halfLife:2.3},{id:"Pr155",massNumber:155,exactMass:154.94012,atomicNumber:59},{id:"Pr156",massNumber:156,exactMass:155.94427,atomicNumber:59},{id:"Pr157",massNumber:157,exactMass:156.94743,atomicNumber:59},{id:"Pr158",massNumber:158,exactMass:157.95198,atomicNumber:59},{id:"Pr159",massNumber:159,exactMass:158.9555,atomicNumber:59}]},{elementSymbol:"Nd",atomicNumber:60,isotopes:[{id:"Nd124",massNumber:124,exactMass:123.95223,atomicNumber:60},{id:"Nd125",massNumber:125,exactMass:124.94888,atomicNumber:60},{id:"Nd126",massNumber:126,exactMass:125.94322,atomicNumber:60},{id:"Nd127",massNumber:127,exactMass:126.9405,atomicNumber:60,halfLife:1.8},{id:"Nd128",massNumber:128,exactMass:127.93539,atomicNumber:60,halfLife:4},{id:"Nd129",massNumber:129,exactMass:128.93319,atomicNumber:60,halfLife:7},{id:"Nd130",massNumber:130,exactMass:129.92851,atomicNumber:60,halfLife:28},{id:"Nd131",massNumber:131,exactMass:130.92725,atomicNumber:60,halfLife:27},{id:"Nd132",massNumber:132,exactMass:131.923321,atomicNumber:60,halfLife:105},{id:"Nd133",massNumber:133,exactMass:132.92235,atomicNumber:60,halfLife:70},{id:"Nd134",massNumber:134,exactMass:133.91879,atomicNumber:60,halfLife:510},{id:"Nd135",massNumber:135,exactMass:134.918181,atomicNumber:60,halfLife:744},{id:"Nd136",massNumber:136,exactMass:135.914976,atomicNumber:60,halfLife:3039},{id:"Nd137",massNumber:137,exactMass:136.914567,atomicNumber:60,halfLife:2310},{id:"Nd138",massNumber:138,exactMass:137.91195,atomicNumber:60,halfLife:18144},{id:"Nd139",massNumber:139,exactMass:138.911978,atomicNumber:60,halfLife:1782},{id:"Nd140",massNumber:140,exactMass:139.90955,atomicNumber:60,halfLife:291168},{id:"Nd141",massNumber:141,exactMass:140.90961,atomicNumber:60,halfLife:8964},{id:"Nd142",massNumber:142,relativeAbundance:.272,atomicNumber:60,exactMass:141.9077233,spin:"0+",halfLife:-1},{id:"Nd143",massNumber:143,relativeAbundance:.122,atomicNumber:60,exactMass:142.9098143,spin:"7/2-",magneticMoment:"-1.08",halfLife:-1},{id:"Nd144",massNumber:144,relativeAbundance:.23800000000000002,atomicNumber:60,exactMass:143.9100873,spin:"0+",halfLife:229e13,alphaDecay:"1.83",alphaDecayLikeliness:"100.0"},{id:"Nd145",massNumber:145,relativeAbundance:.083,atomicNumber:60,exactMass:144.9125736,spin:"7/2-",magneticMoment:"-0.66",halfLife:-1},{id:"Nd146",massNumber:146,relativeAbundance:.172,atomicNumber:60,exactMass:145.9131169,spin:"0+",halfLife:-1},{id:"Nd147",massNumber:147,exactMass:146.9161004,atomicNumber:60,spin:"5/2-",magneticMoment:"0.59",halfLife:948672,betaminusDecay:"0.91",betaminusDecayLikeliness:"100.0"},{id:"Nd148",massNumber:148,relativeAbundance:.057,atomicNumber:60,exactMass:147.916893,spin:"0+",halfLife:-1},{id:"Nd149",massNumber:149,exactMass:148.920149,atomicNumber:60,spin:"5/2-",halfLife:6220.8,betaminusDecay:"1.66",betaminusDecayLikeliness:"100.0"},{id:"Nd150",massNumber:150,relativeAbundance:.055999999999999994,atomicNumber:60,exactMass:149.920891,spin:"0+"},{id:"Nd151",massNumber:151,exactMass:150.923829,atomicNumber:60,halfLife:746.4},{id:"Nd152",massNumber:152,exactMass:151.924682,atomicNumber:60,halfLife:684},{id:"Nd153",massNumber:153,exactMass:152.927698,atomicNumber:60,halfLife:31.6},{id:"Nd154",massNumber:154,exactMass:153.92948,atomicNumber:60,halfLife:25.9},{id:"Nd155",massNumber:155,exactMass:154.93293,atomicNumber:60,halfLife:8.9},{id:"Nd156",massNumber:156,exactMass:155.93502,atomicNumber:60,halfLife:5.47},{id:"Nd157",massNumber:157,exactMass:156.93903,atomicNumber:60},{id:"Nd158",massNumber:158,exactMass:157.9416,atomicNumber:60},{id:"Nd159",massNumber:159,exactMass:158.94609,atomicNumber:60},{id:"Nd160",massNumber:160,exactMass:159.94909,atomicNumber:60},{id:"Nd161",massNumber:161,exactMass:160.95388,atomicNumber:60}]},{elementSymbol:"Pm",atomicNumber:61,isotopes:[{id:"Pm126",massNumber:126,exactMass:125.95752,atomicNumber:61},{id:"Pm127",massNumber:127,exactMass:126.95163,atomicNumber:61},{id:"Pm128",massNumber:128,exactMass:127.94842,atomicNumber:61},{id:"Pm129",massNumber:129,exactMass:128.94316,atomicNumber:61},{id:"Pm130",massNumber:130,exactMass:129.94045,atomicNumber:61},{id:"Pm131",massNumber:131,exactMass:130.93587,atomicNumber:61},{id:"Pm132",massNumber:132,exactMass:131.93375,atomicNumber:61,halfLife:6.3},{id:"Pm133",massNumber:133,exactMass:132.92978,atomicNumber:61},{id:"Pm134",massNumber:134,exactMass:133.92835,atomicNumber:61,halfLife:5},{id:"Pm135",massNumber:135,exactMass:134.92488,atomicNumber:61,halfLife:45},{id:"Pm136",massNumber:136,exactMass:135.92357,atomicNumber:61,halfLife:47},{id:"Pm137",massNumber:137,exactMass:136.920479,atomicNumber:61,halfLife:144},{id:"Pm138",massNumber:138,exactMass:137.919548,atomicNumber:61,halfLife:10},{id:"Pm139",massNumber:139,exactMass:138.916804,atomicNumber:61,halfLife:249},{id:"Pm140",massNumber:140,exactMass:139.91604,atomicNumber:61,halfLife:9.2},{id:"Pm141",massNumber:141,exactMass:140.913555,atomicNumber:61,halfLife:1254},{id:"Pm142",massNumber:142,exactMass:141.912874,atomicNumber:61,halfLife:40.5},{id:"Pm143",massNumber:143,exactMass:142.910933,atomicNumber:61,halfLife:22896e3},{id:"Pm144",massNumber:144,exactMass:143.912591,atomicNumber:61,halfLife:31363200},{id:"Pm145",massNumber:145,exactMass:144.912749,atomicNumber:61,halfLife:558187e3},{id:"Pm146",massNumber:146,exactMass:145.914696,atomicNumber:61,halfLife:174394e3},{id:"Pm147",massNumber:147,exactMass:146.9151385,atomicNumber:61,magneticMoment:"+2.7",halfLife:82731500,betaminusDecay:"0.224",betaminusDecayLikeliness:"100.0"},{id:"Pm148",massNumber:148,exactMass:147.917475,atomicNumber:61,halfLife:463968,betaminusDecay:"2.46",betaminusDecayLikeliness:"100.0"},{id:"Pm149",massNumber:149,exactMass:148.918334,atomicNumber:61,magneticMoment:"3.3",halfLife:191088,betaminusDecay:"1.073",betaminusDecayLikeliness:"100.0"},{id:"Pm150",massNumber:150,exactMass:149.920984,atomicNumber:61,halfLife:9648,betaminusDecay:"3.43",betaminusDecayLikeliness:"100.0"},{id:"Pm151",massNumber:151,exactMass:150.921207,atomicNumber:61,halfLife:102240},{id:"Pm152",massNumber:152,exactMass:151.923497,atomicNumber:61,halfLife:247.2},{id:"Pm153",massNumber:153,exactMass:152.924117,atomicNumber:61,halfLife:315},{id:"Pm154",massNumber:154,exactMass:153.92646,atomicNumber:61,halfLife:103.8},{id:"Pm155",massNumber:155,exactMass:154.9281,atomicNumber:61,halfLife:41.5},{id:"Pm156",massNumber:156,exactMass:155.93106,atomicNumber:61,halfLife:26.7},{id:"Pm157",massNumber:157,exactMass:156.93304,atomicNumber:61,halfLife:10.56},{id:"Pm158",massNumber:158,exactMass:157.93656,atomicNumber:61,halfLife:4.8},{id:"Pm159",massNumber:159,exactMass:158.93897,atomicNumber:61},{id:"Pm160",massNumber:160,exactMass:159.94299,atomicNumber:61},{id:"Pm161",massNumber:161,exactMass:160.94586,atomicNumber:61},{id:"Pm162",massNumber:162,exactMass:161.95029,atomicNumber:61},{id:"Pm163",massNumber:163,exactMass:162.95368,atomicNumber:61}]},{elementSymbol:"Sm",atomicNumber:62,isotopes:[{id:"Sm128",massNumber:128,exactMass:127.95808,atomicNumber:62},{id:"Sm129",massNumber:129,exactMass:128.95464,atomicNumber:62},{id:"Sm130",massNumber:130,exactMass:129.94892,atomicNumber:62},{id:"Sm131",massNumber:131,exactMass:130.94611,atomicNumber:62,halfLife:1.2},{id:"Sm132",massNumber:132,exactMass:131.94069,atomicNumber:62,halfLife:4},{id:"Sm133",massNumber:133,exactMass:132.93867,atomicNumber:62,halfLife:3.7},{id:"Sm134",massNumber:134,exactMass:133.93397,atomicNumber:62,halfLife:10},{id:"Sm135",massNumber:135,exactMass:134.93252,atomicNumber:62,halfLife:10.3},{id:"Sm136",massNumber:136,exactMass:135.928276,atomicNumber:62,halfLife:47},{id:"Sm137",massNumber:137,exactMass:136.92697,atomicNumber:62,halfLife:45},{id:"Sm138",massNumber:138,exactMass:137.923244,atomicNumber:62,halfLife:186},{id:"Sm139",massNumber:139,exactMass:138.922297,atomicNumber:62,halfLife:154.2},{id:"Sm140",massNumber:140,exactMass:139.918995,atomicNumber:62,halfLife:889.2},{id:"Sm141",massNumber:141,exactMass:140.918476,atomicNumber:62,halfLife:612},{id:"Sm142",massNumber:142,exactMass:141.915198,atomicNumber:62,halfLife:4349.4},{id:"Sm143",massNumber:143,exactMass:142.914628,atomicNumber:62,halfLife:529.8},{id:"Sm144",massNumber:144,relativeAbundance:.030699999999999998,atomicNumber:62,exactMass:143.911999,spin:"0+",halfLife:-1},{id:"Sm145",massNumber:145,exactMass:144.91341,atomicNumber:62,spin:"7/2-",halfLife:29376e3,ecDecay:"0.65",ecDecayLikeliness:"100.0"},{id:"Sm146",massNumber:146,exactMass:145.913041,atomicNumber:62,spin:"0+",halfLife:1031e5,alphaDecay:"2.55",alphaDecayLikeliness:"100.0"},{id:"Sm147",massNumber:147,relativeAbundance:.1499,atomicNumber:62,exactMass:146.9148979,spin:"7/2-",magneticMoment:"-0.813",halfLife:106e9,alphaDecay:"2.31",alphaDecayLikeliness:"100.0"},{id:"Sm148",massNumber:148,relativeAbundance:.1124,atomicNumber:62,exactMass:147.9148227,spin:"0+",halfLife:12e12,alphaDecay:"2.00",alphaDecayLikeliness:"100.0"},{id:"Sm149",massNumber:149,relativeAbundance:.1382,atomicNumber:62,exactMass:148.9171847,spin:"7/2-",magneticMoment:"-0.670",halfLife:4e14,alphaDecay:"1.9",alphaDecayLikeliness:"100.0"},{id:"Sm150",massNumber:150,relativeAbundance:.0738,atomicNumber:62,exactMass:149.9172755,spin:"0+",halfLife:-1},{id:"Sm151",massNumber:151,exactMass:150.9199324,atomicNumber:62,spin:"7/2-",halfLife:283824e4,betaminusDecay:"0.076",betaminusDecayLikeliness:"100.0"},{id:"Sm152",massNumber:152,relativeAbundance:.2675,atomicNumber:62,exactMass:151.9197324,spin:"0+",halfLife:-1},{id:"Sm153",massNumber:153,exactMass:152.9220974,atomicNumber:62,spin:"3/2+",halfLife:166622},{id:"Sm154",massNumber:154,relativeAbundance:.2275,atomicNumber:62,exactMass:153.9222093,spin:"0+",halfLife:-1},{id:"Sm155",massNumber:155,exactMass:154.9246402,atomicNumber:62,halfLife:1338},{id:"Sm156",massNumber:156,exactMass:155.925528,atomicNumber:62,halfLife:33840},{id:"Sm157",massNumber:157,exactMass:156.92836,atomicNumber:62,halfLife:482},{id:"Sm158",massNumber:158,exactMass:157.92999,atomicNumber:62,halfLife:318},{id:"Sm159",massNumber:159,exactMass:158.93321,atomicNumber:62,halfLife:11.37},{id:"Sm160",massNumber:160,exactMass:159.93514,atomicNumber:62,halfLife:9.6},{id:"Sm161",massNumber:161,exactMass:160.93883,atomicNumber:62},{id:"Sm162",massNumber:162,exactMass:161.94122,atomicNumber:62},{id:"Sm163",massNumber:163,exactMass:162.94536,atomicNumber:62},{id:"Sm164",massNumber:164,exactMass:163.94828,atomicNumber:62},{id:"Sm165",massNumber:165,exactMass:164.95298,atomicNumber:62}]},{elementSymbol:"Eu",atomicNumber:63,isotopes:[{id:"Eu130",massNumber:130,exactMass:129.96357,atomicNumber:63},{id:"Eu131",massNumber:131,exactMass:130.95775,atomicNumber:63},{id:"Eu132",massNumber:132,exactMass:131.95437,atomicNumber:63},{id:"Eu133",massNumber:133,exactMass:132.94924,atomicNumber:63},{id:"Eu134",massNumber:134,exactMass:133.94651,atomicNumber:63,halfLife:.5},{id:"Eu135",massNumber:135,exactMass:134.94182,atomicNumber:63,halfLife:1.5},{id:"Eu136",massNumber:136,exactMass:135.9396,atomicNumber:63,halfLife:3.3},{id:"Eu137",massNumber:137,exactMass:136.93557,atomicNumber:63,halfLife:11},{id:"Eu138",massNumber:138,exactMass:137.93371,atomicNumber:63,halfLife:12.1},{id:"Eu139",massNumber:139,exactMass:138.929792,atomicNumber:63,halfLife:17.9},{id:"Eu140",massNumber:140,exactMass:139.92809,atomicNumber:63,halfLife:1.51},{id:"Eu141",massNumber:141,exactMass:140.924931,atomicNumber:63,halfLife:40.7},{id:"Eu142",massNumber:142,exactMass:141.92343,atomicNumber:63,halfLife:2.34},{id:"Eu143",massNumber:143,exactMass:142.920298,atomicNumber:63,halfLife:157.8},{id:"Eu144",massNumber:144,exactMass:143.918817,atomicNumber:63,halfLife:10.2},{id:"Eu145",massNumber:145,exactMass:144.916265,atomicNumber:63,halfLife:512352},{id:"Eu146",massNumber:146,exactMass:145.917206,atomicNumber:63,halfLife:398304},{id:"Eu147",massNumber:147,exactMass:146.916746,atomicNumber:63,halfLife:2082240},{id:"Eu148",massNumber:148,exactMass:147.918086,atomicNumber:63,halfLife:4708800},{id:"Eu149",massNumber:149,exactMass:148.917931,atomicNumber:63,halfLife:8043840},{id:"Eu150",massNumber:150,exactMass:149.919702,atomicNumber:63,halfLife:116368e4},{id:"Eu151",massNumber:151,relativeAbundance:.4781,atomicNumber:63,exactMass:150.9198502,spin:"5/2+",magneticMoment:"+3.464",halfLife:-1},{id:"Eu152",massNumber:152,exactMass:151.9217445,atomicNumber:63,spin:"3-",halfLife:426903e3},{id:"Eu153",massNumber:153,relativeAbundance:.5219,atomicNumber:63,exactMass:152.9212303,spin:"5/2+",magneticMoment:"+1.530",halfLife:-1},{id:"Eu154",massNumber:154,exactMass:153.9229792,atomicNumber:63,halfLife:270989e3},{id:"Eu155",massNumber:155,exactMass:154.9228933,atomicNumber:63,halfLife:150146e3},{id:"Eu156",massNumber:156,exactMass:155.924752,atomicNumber:63,halfLife:1312420},{id:"Eu157",massNumber:157,exactMass:156.925424,atomicNumber:63,halfLife:54648},{id:"Eu158",massNumber:158,exactMass:157.92785,atomicNumber:63,halfLife:2754},{id:"Eu159",massNumber:159,exactMass:158.929089,atomicNumber:63,halfLife:1086},{id:"Eu160",massNumber:160,exactMass:159.93197,atomicNumber:63,halfLife:38},{id:"Eu161",massNumber:161,exactMass:160.93368,atomicNumber:63,halfLife:26},{id:"Eu162",massNumber:162,exactMass:161.93704,atomicNumber:63,halfLife:10.6},{id:"Eu163",massNumber:163,exactMass:162.93921,atomicNumber:63},{id:"Eu164",massNumber:164,exactMass:163.94299,atomicNumber:63},{id:"Eu165",massNumber:165,exactMass:164.94572,atomicNumber:63},{id:"Eu166",massNumber:166,exactMass:165.94997,atomicNumber:63},{id:"Eu167",massNumber:167,exactMass:166.95321,atomicNumber:63}]},{elementSymbol:"Gd",atomicNumber:64,isotopes:[{id:"Gd134",massNumber:134,exactMass:133.95537,atomicNumber:64},{id:"Gd135",massNumber:135,exactMass:134.95257,atomicNumber:64},{id:"Gd136",massNumber:136,exactMass:135.94734,atomicNumber:64},{id:"Gd137",massNumber:137,exactMass:136.94502,atomicNumber:64},{id:"Gd138",massNumber:138,exactMass:137.94012,atomicNumber:64},{id:"Gd139",massNumber:139,exactMass:138.93824,atomicNumber:64,halfLife:4.9},{id:"Gd140",massNumber:140,exactMass:139.93367,atomicNumber:64,halfLife:15.8},{id:"Gd141",massNumber:141,exactMass:140.932126,atomicNumber:64,halfLife:14},{id:"Gd142",massNumber:142,exactMass:141.92812,atomicNumber:64,halfLife:70.2},{id:"Gd143",massNumber:143,exactMass:142.92675,atomicNumber:64,halfLife:39},{id:"Gd144",massNumber:144,exactMass:143.92296,atomicNumber:64,halfLife:270},{id:"Gd145",massNumber:145,exactMass:144.921709,atomicNumber:64,halfLife:1380},{id:"Gd146",massNumber:146,exactMass:145.918311,atomicNumber:64,halfLife:4170530},{id:"Gd147",massNumber:147,exactMass:146.919094,atomicNumber:64,halfLife:137016},{id:"Gd148",massNumber:148,exactMass:147.918115,atomicNumber:64,halfLife:235259e4},{id:"Gd149",massNumber:149,exactMass:148.919341,atomicNumber:64,halfLife:801792},{id:"Gd150",massNumber:150,exactMass:149.918659,atomicNumber:64},{id:"Gd151",massNumber:151,exactMass:150.920348,atomicNumber:64,halfLife:10713600},{id:"Gd152",massNumber:152,relativeAbundance:.002,atomicNumber:64,exactMass:151.919791,spin:"0+",halfLife:108e12,alphaDecay:"2.24",alphaDecayLikeliness:"100.0"},{id:"Gd153",massNumber:153,exactMass:152.9217495,atomicNumber:64,spin:"3/2+",halfLife:20770600},{id:"Gd154",massNumber:154,relativeAbundance:.0218,atomicNumber:64,exactMass:153.9208656,spin:"0+",halfLife:-1},{id:"Gd155",massNumber:155,relativeAbundance:.14800000000000002,atomicNumber:64,exactMass:154.922622,spin:"3/2-",magneticMoment:"-0.27",halfLife:-1},{id:"Gd156",massNumber:156,relativeAbundance:.2047,atomicNumber:64,exactMass:155.9221227,spin:"0+",halfLife:-1},{id:"Gd157",massNumber:157,relativeAbundance:.1565,atomicNumber:64,exactMass:156.9239601,spin:"3/2-",magneticMoment:"-0.36",halfLife:-1},{id:"Gd158",massNumber:158,relativeAbundance:.2484,atomicNumber:64,exactMass:157.9241039,spin:"0+",halfLife:-1},{id:"Gd159",massNumber:159,exactMass:158.9263887,atomicNumber:64,spin:"3/2-",halfLife:66524.4,betaminusDecay:"0.95",betaminusDecayLikeliness:"100.0"},{id:"Gd160",massNumber:160,relativeAbundance:.2186,atomicNumber:64,exactMass:159.9270541,spin:"0+"},{id:"Gd161",massNumber:161,exactMass:160.9296692,atomicNumber:64,halfLife:219.6},{id:"Gd162",massNumber:162,exactMass:161.930985,atomicNumber:64,halfLife:504},{id:"Gd163",massNumber:163,exactMass:162.93399,atomicNumber:64,halfLife:68},{id:"Gd164",massNumber:164,exactMass:163.93586,atomicNumber:64,halfLife:45},{id:"Gd165",massNumber:165,exactMass:164.93938,atomicNumber:64},{id:"Gd166",massNumber:166,exactMass:165.9416,atomicNumber:64},{id:"Gd167",massNumber:167,exactMass:166.94557,atomicNumber:64},{id:"Gd168",massNumber:168,exactMass:167.94836,atomicNumber:64},{id:"Gd169",massNumber:169,exactMass:168.95287,atomicNumber:64}]},{elementSymbol:"Tb",atomicNumber:65,isotopes:[{id:"Tb136",massNumber:136,exactMass:135.96138,atomicNumber:65},{id:"Tb137",massNumber:137,exactMass:136.95598,atomicNumber:65},{id:"Tb138",massNumber:138,exactMass:137.95316,atomicNumber:65},{id:"Tb139",massNumber:139,exactMass:138.94829,atomicNumber:65},{id:"Tb140",massNumber:140,exactMass:139.94581,atomicNumber:65,halfLife:2.4},{id:"Tb141",massNumber:141,exactMass:140.94145,atomicNumber:65,halfLife:3.5},{id:"Tb142",massNumber:142,exactMass:141.93874,atomicNumber:65,halfLife:.597},{id:"Tb143",massNumber:143,exactMass:142.93512,atomicNumber:65,halfLife:12},{id:"Tb144",massNumber:144,exactMass:143.93305,atomicNumber:65,halfLife:-1},{id:"Tb145",massNumber:145,exactMass:144.92927,atomicNumber:65},{id:"Tb146",massNumber:146,exactMass:145.92725,atomicNumber:65,halfLife:8},{id:"Tb147",massNumber:147,exactMass:146.924045,atomicNumber:65,halfLife:6120},{id:"Tb148",massNumber:148,exactMass:147.924272,atomicNumber:65,halfLife:3600},{id:"Tb149",massNumber:149,exactMass:148.923246,atomicNumber:65,halfLife:14824.8},{id:"Tb150",massNumber:150,exactMass:149.92366,atomicNumber:65,halfLife:12528},{id:"Tb151",massNumber:151,exactMass:150.923103,atomicNumber:65,halfLife:63392.4},{id:"Tb152",massNumber:152,exactMass:151.92407,atomicNumber:65,halfLife:63e3},{id:"Tb153",massNumber:153,exactMass:152.923435,atomicNumber:65,halfLife:202176},{id:"Tb154",massNumber:154,exactMass:153.92468,atomicNumber:65,halfLife:77400},{id:"Tb155",massNumber:155,exactMass:154.923505,atomicNumber:65,halfLife:459648},{id:"Tb156",massNumber:156,exactMass:155.924747,atomicNumber:65,halfLife:462240},{id:"Tb157",massNumber:157,exactMass:156.9240246,atomicNumber:65,halfLife:223906e4},{id:"Tb158",massNumber:158,exactMass:157.9254131,atomicNumber:65,halfLife:567648e4},{id:"Tb159",massNumber:159,relativeAbundance:1,atomicNumber:65,exactMass:158.9253468,spin:"3/2+",magneticMoment:"+1.95",halfLife:-1},{id:"Tb160",massNumber:160,exactMass:159.9271676,atomicNumber:65,spin:"3-",magneticMoment:"+1.702",halfLife:6246720,betaminusDecay:"1.72",betaminusDecayLikeliness:"100.0"},{id:"Tb161",massNumber:161,exactMass:160.9275699,atomicNumber:65,spin:"3/2+",halfLife:594432},{id:"Tb162",massNumber:162,exactMass:161.92949,atomicNumber:65,halfLife:456},{id:"Tb163",massNumber:163,exactMass:162.930648,atomicNumber:65,halfLife:1170},{id:"Tb164",massNumber:164,exactMass:163.93335,atomicNumber:65,halfLife:180},{id:"Tb165",massNumber:165,exactMass:164.93488,atomicNumber:65,halfLife:126.6},{id:"Tb166",massNumber:166,exactMass:165.93799,atomicNumber:65},{id:"Tb167",massNumber:167,exactMass:166.94005,atomicNumber:65},{id:"Tb168",massNumber:168,exactMass:167.94364,atomicNumber:65},{id:"Tb169",massNumber:169,exactMass:168.94622,atomicNumber:65},{id:"Tb170",massNumber:170,exactMass:169.95025,atomicNumber:65},{id:"Tb171",massNumber:171,exactMass:170.9533,atomicNumber:65}]},{elementSymbol:"Dy",atomicNumber:66,isotopes:[{id:"Dy138",massNumber:138,exactMass:137.96249,atomicNumber:66},{id:"Dy139",massNumber:139,exactMass:138.95954,atomicNumber:66},{id:"Dy140",massNumber:140,exactMass:139.95401,atomicNumber:66},{id:"Dy141",massNumber:141,exactMass:140.95135,atomicNumber:66,halfLife:.9},{id:"Dy142",massNumber:142,exactMass:141.94637,atomicNumber:66,halfLife:2.3},{id:"Dy143",massNumber:143,exactMass:142.94383,atomicNumber:66,halfLife:4.1},{id:"Dy144",massNumber:144,exactMass:143.93925,atomicNumber:66,halfLife:9.1},{id:"Dy145",massNumber:145,exactMass:144.93743,atomicNumber:66,halfLife:10},{id:"Dy146",massNumber:146,exactMass:145.932845,atomicNumber:66,halfLife:29},{id:"Dy147",massNumber:147,exactMass:146.931092,atomicNumber:66,halfLife:40},{id:"Dy148",massNumber:148,exactMass:147.92715,atomicNumber:66,halfLife:186},{id:"Dy149",massNumber:149,exactMass:148.927305,atomicNumber:66,halfLife:252},{id:"Dy150",massNumber:150,exactMass:149.925585,atomicNumber:66,halfLife:430.2},{id:"Dy151",massNumber:151,exactMass:150.926185,atomicNumber:66,halfLife:1074},{id:"Dy152",massNumber:152,exactMass:151.924718,atomicNumber:66,halfLife:8568},{id:"Dy153",massNumber:153,exactMass:152.925765,atomicNumber:66,halfLife:23040},{id:"Dy154",massNumber:154,exactMass:153.924424,atomicNumber:66},{id:"Dy155",massNumber:155,exactMass:154.925754,atomicNumber:66,halfLife:35640},{id:"Dy156",massNumber:156,relativeAbundance:6e-4,atomicNumber:66,exactMass:155.924283,spin:"0+",halfLife:-1},{id:"Dy157",massNumber:157,exactMass:156.925466,atomicNumber:66,spin:"3/2-",halfLife:29304},{id:"Dy158",massNumber:158,relativeAbundance:.001,atomicNumber:66,exactMass:157.924409,spin:"0+",halfLife:-1},{id:"Dy159",massNumber:159,exactMass:158.9257392,atomicNumber:66,spin:"3/2-",halfLife:12476200},{id:"Dy160",massNumber:160,relativeAbundance:.023399999999999997,atomicNumber:66,exactMass:159.9251975,spin:"0+",halfLife:-1},{id:"Dy161",massNumber:161,relativeAbundance:.1891,atomicNumber:66,exactMass:160.9269334,spin:"5/2+",magneticMoment:"-0.4805",halfLife:-1},{id:"Dy162",massNumber:162,relativeAbundance:.2551,atomicNumber:66,exactMass:161.9267984,spin:"0+",halfLife:-1},{id:"Dy163",massNumber:163,relativeAbundance:.249,atomicNumber:66,exactMass:162.9287312,spin:"5/2-",magneticMoment:"+0.6726",halfLife:-1},{id:"Dy164",massNumber:164,relativeAbundance:.2818,atomicNumber:66,exactMass:163.9291748,spin:"0+",halfLife:-1,betaminusDecay:"1.3",betaminusDecayLikeliness:"100.0"},{id:"Dy165",massNumber:165,exactMass:164.9317033,atomicNumber:66,halfLife:8402.4},{id:"Dy166",massNumber:166,exactMass:165.9328067,atomicNumber:66,halfLife:293760},{id:"Dy167",massNumber:167,exactMass:166.93566,atomicNumber:66,halfLife:372},{id:"Dy168",massNumber:168,exactMass:167.93713,atomicNumber:66,halfLife:522},{id:"Dy169",massNumber:169,exactMass:168.94031,atomicNumber:66,halfLife:39},{id:"Dy170",massNumber:170,exactMass:169.94239,atomicNumber:66},{id:"Dy171",massNumber:171,exactMass:170.9462,atomicNumber:66},{id:"Dy172",massNumber:172,exactMass:171.94876,atomicNumber:66},{id:"Dy173",massNumber:173,exactMass:172.953,atomicNumber:66}]},{elementSymbol:"Ho",atomicNumber:67,isotopes:[{id:"Ho140",massNumber:140,exactMass:139.96854,atomicNumber:67},{id:"Ho141",massNumber:141,exactMass:140.9631,atomicNumber:67},{id:"Ho142",massNumber:142,exactMass:141.95977,atomicNumber:67},{id:"Ho143",massNumber:143,exactMass:142.95461,atomicNumber:67},{id:"Ho144",massNumber:144,exactMass:143.95148,atomicNumber:67,halfLife:.7},{id:"Ho145",massNumber:145,exactMass:144.9472,atomicNumber:67,halfLife:2.4},{id:"Ho146",massNumber:146,exactMass:145.94464,atomicNumber:67,halfLife:3.6},{id:"Ho147",massNumber:147,exactMass:146.94006,atomicNumber:67,halfLife:5.8},{id:"Ho148",massNumber:148,exactMass:147.93772,atomicNumber:67,halfLife:2.2},{id:"Ho149",massNumber:149,exactMass:148.933775,atomicNumber:67,halfLife:21.1},{id:"Ho150",massNumber:150,exactMass:149.933496,atomicNumber:67,halfLife:72},{id:"Ho151",massNumber:151,exactMass:150.931688,atomicNumber:67,halfLife:35.2},{id:"Ho152",massNumber:152,exactMass:151.931714,atomicNumber:67,halfLife:161.8},{id:"Ho153",massNumber:153,exactMass:152.930199,atomicNumber:67,halfLife:120.6},{id:"Ho154",massNumber:154,exactMass:153.930602,atomicNumber:67,halfLife:705.6},{id:"Ho155",massNumber:155,exactMass:154.929103,atomicNumber:67,halfLife:2880},{id:"Ho156",massNumber:156,exactMass:155.92984,atomicNumber:67,halfLife:3360},{id:"Ho157",massNumber:157,exactMass:156.928256,atomicNumber:67,halfLife:756},{id:"Ho158",massNumber:158,exactMass:157.928941,atomicNumber:67,halfLife:678},{id:"Ho159",massNumber:159,exactMass:158.927712,atomicNumber:67,halfLife:1983},{id:"Ho160",massNumber:160,exactMass:159.928729,atomicNumber:67,halfLife:1536},{id:"Ho161",massNumber:161,exactMass:160.927855,atomicNumber:67,halfLife:8928},{id:"Ho162",massNumber:162,exactMass:161.929096,atomicNumber:67,halfLife:900},{id:"Ho163",massNumber:163,exactMass:162.9287339,atomicNumber:67,halfLife:14412e7},{id:"Ho164",massNumber:164,exactMass:163.9302335,atomicNumber:67,halfLife:1740},{id:"Ho165",massNumber:165,relativeAbundance:1,atomicNumber:67,exactMass:164.9303221,spin:"7/2-",magneticMoment:"+4.173",halfLife:-1},{id:"Ho166",massNumber:166,exactMass:165.9322842,atomicNumber:67,spin:"0-",halfLife:96588,betaminusDecay:"1.85",betaminusDecayLikeliness:"100.0"},{id:"Ho167",massNumber:167,exactMass:166.933133,atomicNumber:67,halfLife:11160},{id:"Ho168",massNumber:168,exactMass:167.93552,atomicNumber:67,halfLife:179.4},{id:"Ho169",massNumber:169,exactMass:168.936872,atomicNumber:67,halfLife:282},{id:"Ho170",massNumber:170,exactMass:169.93962,atomicNumber:67,halfLife:165.6},{id:"Ho171",massNumber:171,exactMass:170.94147,atomicNumber:67,halfLife:53},{id:"Ho172",massNumber:172,exactMass:171.94482,atomicNumber:67,halfLife:25},{id:"Ho173",massNumber:173,exactMass:172.94729,atomicNumber:67},{id:"Ho174",massNumber:174,exactMass:173.95115,atomicNumber:67},{id:"Ho175",massNumber:175,exactMass:174.95405,atomicNumber:67}]},{elementSymbol:"Er",atomicNumber:68,isotopes:[{id:"Er143",massNumber:143,exactMass:142.96634,atomicNumber:68},{id:"Er144",massNumber:144,exactMass:143.96038,atomicNumber:68},{id:"Er145",massNumber:145,exactMass:144.95739,atomicNumber:68,halfLife:.9},{id:"Er146",massNumber:146,exactMass:145.952,atomicNumber:68,halfLife:1.7},{id:"Er147",massNumber:147,exactMass:146.94949,atomicNumber:68,halfLife:2.5},{id:"Er148",massNumber:148,exactMass:147.94455,atomicNumber:68,halfLife:4.6},{id:"Er149",massNumber:149,exactMass:148.94231,atomicNumber:68,halfLife:4},{id:"Er150",massNumber:150,exactMass:149.937914,atomicNumber:68,halfLife:18.5},{id:"Er151",massNumber:151,exactMass:150.937449,atomicNumber:68,halfLife:23.5},{id:"Er152",massNumber:152,exactMass:151.93505,atomicNumber:68,halfLife:10.3},{id:"Er153",massNumber:153,exactMass:152.935063,atomicNumber:68,halfLife:37.1},{id:"Er154",massNumber:154,exactMass:153.932783,atomicNumber:68,halfLife:223.8},{id:"Er155",massNumber:155,exactMass:154.933209,atomicNumber:68,halfLife:318},{id:"Er156",massNumber:156,exactMass:155.931065,atomicNumber:68,halfLife:1170},{id:"Er157",massNumber:157,exactMass:156.93192,atomicNumber:68,halfLife:1119},{id:"Er158",massNumber:158,exactMass:157.929893,atomicNumber:68,halfLife:8244},{id:"Er159",massNumber:159,exactMass:158.930684,atomicNumber:68,halfLife:2160},{id:"Er160",massNumber:160,exactMass:159.929083,atomicNumber:68,halfLife:102888},{id:"Er161",massNumber:161,exactMass:160.929995,atomicNumber:68,halfLife:11556},{id:"Er162",massNumber:162,relativeAbundance:.0014000000000000002,atomicNumber:68,exactMass:161.928778,spin:"0+",halfLife:-1},{id:"Er163",massNumber:163,exactMass:162.930033,atomicNumber:68,spin:"5/2-",halfLife:4500},{id:"Er164",massNumber:164,relativeAbundance:.0161,atomicNumber:68,exactMass:163.9292,spin:"0+",halfLife:-1},{id:"Er165",massNumber:165,exactMass:164.930726,atomicNumber:68,spin:"5/2-",halfLife:37296},{id:"Er166",massNumber:166,relativeAbundance:.3361,atomicNumber:68,exactMass:165.9302931,spin:"0+",halfLife:-1},{id:"Er167",massNumber:167,relativeAbundance:.2293,atomicNumber:68,exactMass:166.9320482,spin:"7/2+",magneticMoment:"-0.5665",halfLife:-1},{id:"Er168",massNumber:168,relativeAbundance:.26780000000000004,atomicNumber:68,exactMass:167.9323702,spin:"0+",halfLife:-1},{id:"Er169",massNumber:169,exactMass:168.9345904,atomicNumber:68,spin:"1/2-",halfLife:812160},{id:"Er170",massNumber:170,relativeAbundance:.1493,atomicNumber:68,exactMass:169.9354643,spin:"0+",halfLife:-1},{id:"Er171",massNumber:171,exactMass:170.9380298,atomicNumber:68,halfLife:27057.6},{id:"Er172",massNumber:172,exactMass:171.939356,atomicNumber:68,halfLife:177480},{id:"Er173",massNumber:173,exactMass:172.9424,atomicNumber:68,halfLife:84},{id:"Er174",massNumber:174,exactMass:173.94423,atomicNumber:68,halfLife:198},{id:"Er175",massNumber:175,exactMass:174.94777,atomicNumber:68,halfLife:72},{id:"Er176",massNumber:176,exactMass:175.95008,atomicNumber:68},{id:"Er177",massNumber:177,exactMass:176.95405,atomicNumber:68}]},{elementSymbol:"Tm",atomicNumber:69,isotopes:[{id:"Tm145",massNumber:145,exactMass:144.97007,atomicNumber:69},{id:"Tm146",massNumber:146,exactMass:145.96643,atomicNumber:69,halfLife:.235},{id:"Tm147",massNumber:147,exactMass:146.96096,atomicNumber:69,halfLife:.56},{id:"Tm148",massNumber:148,exactMass:147.95784,atomicNumber:69,halfLife:.7},{id:"Tm149",massNumber:149,exactMass:148.95272,atomicNumber:69,halfLife:.9},{id:"Tm150",massNumber:150,exactMass:149.94996,atomicNumber:69,halfLife:2.2},{id:"Tm151",massNumber:151,exactMass:150.945483,atomicNumber:69,halfLife:4.17},{id:"Tm152",massNumber:152,exactMass:151.94442,atomicNumber:69,halfLife:8},{id:"Tm153",massNumber:153,exactMass:152.942012,atomicNumber:69,halfLife:1.48},{id:"Tm154",massNumber:154,exactMass:153.941568,atomicNumber:69,halfLife:8.1},{id:"Tm155",massNumber:155,exactMass:154.939199,atomicNumber:69,halfLife:21.6},{id:"Tm156",massNumber:156,exactMass:155.93898,atomicNumber:69,halfLife:83.8},{id:"Tm157",massNumber:157,exactMass:156.93697,atomicNumber:69,halfLife:217.8},{id:"Tm158",massNumber:158,exactMass:157.93698,atomicNumber:69,halfLife:238.8},{id:"Tm159",massNumber:159,exactMass:158.93498,atomicNumber:69,halfLife:547.8},{id:"Tm160",massNumber:160,exactMass:159.93526,atomicNumber:69,halfLife:564},{id:"Tm161",massNumber:161,exactMass:160.93355,atomicNumber:69,halfLife:1980},{id:"Tm162",massNumber:162,exactMass:161.933995,atomicNumber:69,halfLife:1302},{id:"Tm163",massNumber:163,exactMass:162.932651,atomicNumber:69,halfLife:6516},{id:"Tm164",massNumber:164,exactMass:163.93356,atomicNumber:69},{id:"Tm165",massNumber:165,exactMass:164.932435,atomicNumber:69,halfLife:108216},{id:"Tm166",massNumber:166,exactMass:165.933554,atomicNumber:69,halfLife:27720},{id:"Tm167",massNumber:167,exactMass:166.9328516,atomicNumber:69,halfLife:799200},{id:"Tm168",massNumber:168,exactMass:167.934173,atomicNumber:69,halfLife:8043840},{id:"Tm169",massNumber:169,relativeAbundance:1,atomicNumber:69,exactMass:168.9342133,spin:"1/2+",magneticMoment:"-0.2316",halfLife:-1},{id:"Tm170",massNumber:170,exactMass:169.9358014,atomicNumber:69,spin:"1-",halfLife:11111e3},{id:"Tm171",massNumber:171,exactMass:170.9364294,atomicNumber:69,spin:"1/2+",halfLife:60549100},{id:"Tm172",massNumber:172,exactMass:171.9384,atomicNumber:69,halfLife:228960},{id:"Tm173",massNumber:173,exactMass:172.939604,atomicNumber:69,halfLife:29664},{id:"Tm174",massNumber:174,exactMass:173.94217,atomicNumber:69,halfLife:324},{id:"Tm175",massNumber:175,exactMass:174.94384,atomicNumber:69,halfLife:912},{id:"Tm176",massNumber:176,exactMass:175.94699,atomicNumber:69,halfLife:114},{id:"Tm177",massNumber:177,exactMass:176.94904,atomicNumber:69,halfLife:85},{id:"Tm178",massNumber:178,exactMass:177.95264,atomicNumber:69},{id:"Tm179",massNumber:179,exactMass:178.95534,atomicNumber:69}]},{elementSymbol:"Yb",atomicNumber:70,isotopes:[{id:"Yb148",massNumber:148,exactMass:147.96742,atomicNumber:70},{id:"Yb149",massNumber:149,exactMass:148.96404,atomicNumber:70},{id:"Yb150",massNumber:150,exactMass:149.95842,atomicNumber:70},{id:"Yb151",massNumber:151,exactMass:150.9554,atomicNumber:70,halfLife:1.6},{id:"Yb152",massNumber:152,exactMass:151.95029,atomicNumber:70,halfLife:3.04},{id:"Yb153",massNumber:153,exactMass:152.94948,atomicNumber:70,halfLife:4.2},{id:"Yb154",massNumber:154,exactMass:153.946394,atomicNumber:70,halfLife:.409},{id:"Yb155",massNumber:155,exactMass:154.945782,atomicNumber:70,halfLife:1.8},{id:"Yb156",massNumber:156,exactMass:155.942818,atomicNumber:70,halfLife:26.1},{id:"Yb157",massNumber:157,exactMass:156.942628,atomicNumber:70,halfLife:38.6},{id:"Yb158",massNumber:158,exactMass:157.939866,atomicNumber:70,halfLife:89.4},{id:"Yb159",massNumber:159,exactMass:158.94005,atomicNumber:70,halfLife:94.8},{id:"Yb160",massNumber:160,exactMass:159.937552,atomicNumber:70,halfLife:288},{id:"Yb161",massNumber:161,exactMass:160.937902,atomicNumber:70,halfLife:252},{id:"Yb162",massNumber:162,exactMass:161.935768,atomicNumber:70,halfLife:1132.2},{id:"Yb163",massNumber:163,exactMass:162.936334,atomicNumber:70,halfLife:663},{id:"Yb164",massNumber:164,exactMass:163.934489,atomicNumber:70,halfLife:4548},{id:"Yb165",massNumber:165,exactMass:164.93528,atomicNumber:70,halfLife:594},{id:"Yb166",massNumber:166,exactMass:165.933882,atomicNumber:70,halfLife:204120},{id:"Yb167",massNumber:167,exactMass:166.93495,atomicNumber:70,halfLife:1050},{id:"Yb168",massNumber:168,relativeAbundance:.0013,atomicNumber:70,exactMass:167.933897,spin:"0+",halfLife:-1},{id:"Yb169",massNumber:169,exactMass:168.93519,atomicNumber:70,spin:"7/2+",halfLife:2767050},{id:"Yb170",massNumber:170,relativeAbundance:.0304,atomicNumber:70,exactMass:169.9347618,spin:"0+",halfLife:-1},{id:"Yb171",massNumber:171,relativeAbundance:.14279999999999998,atomicNumber:70,exactMass:170.9363258,spin:"1/2-",magneticMoment:"+0.4919",halfLife:-1},{id:"Yb172",massNumber:172,relativeAbundance:.2183,atomicNumber:70,exactMass:171.9363815,spin:"0+",halfLife:-1},{id:"Yb173",massNumber:173,relativeAbundance:.1613,atomicNumber:70,exactMass:172.9382108,spin:"5/2-",magneticMoment:"-0.6776",halfLife:-1},{id:"Yb174",massNumber:174,relativeAbundance:.31829999999999997,atomicNumber:70,exactMass:173.9388621,spin:"0+",halfLife:-1},{id:"Yb175",massNumber:175,exactMass:174.9412765,atomicNumber:70,spin:"7/2-",magneticMoment:"0.3",halfLife:361584,betaminusDecay:"0.467",betaminusDecayLikeliness:"100.0"},{id:"Yb176",massNumber:176,relativeAbundance:.1276,atomicNumber:70,exactMass:175.9425717,spin:"0+",halfLife:-1},{id:"Yb177",massNumber:177,exactMass:176.9452608,atomicNumber:70,halfLife:6879.6},{id:"Yb178",massNumber:178,exactMass:177.946647,atomicNumber:70,halfLife:4440},{id:"Yb179",massNumber:179,exactMass:178.95017,atomicNumber:70,halfLife:480},{id:"Yb180",massNumber:180,exactMass:179.95233,atomicNumber:70,halfLife:144},{id:"Yb181",massNumber:181,exactMass:180.95615,atomicNumber:70}]},{elementSymbol:"Lu",atomicNumber:71,isotopes:[{id:"Lu150",massNumber:150,exactMass:149.97323,atomicNumber:71,halfLife:.035},{id:"Lu151",massNumber:151,exactMass:150.96758,atomicNumber:71,halfLife:.088},{id:"Lu152",massNumber:152,exactMass:151.96412,atomicNumber:71,halfLife:.7},{id:"Lu153",massNumber:153,exactMass:152.95877,atomicNumber:71,halfLife:.9},{id:"Lu154",massNumber:154,exactMass:153.95752,atomicNumber:71},{id:"Lu155",massNumber:155,exactMass:154.954316,atomicNumber:71,halfLife:.14},{id:"Lu156",massNumber:156,exactMass:155.95303,atomicNumber:71,halfLife:.198},{id:"Lu157",massNumber:157,exactMass:156.950098,atomicNumber:71,halfLife:6.8},{id:"Lu158",massNumber:158,exactMass:157.949313,atomicNumber:71,halfLife:10.6},{id:"Lu159",massNumber:159,exactMass:158.94663,atomicNumber:71,halfLife:12.1},{id:"Lu160",massNumber:160,exactMass:159.94603,atomicNumber:71,halfLife:36.1},{id:"Lu161",massNumber:161,exactMass:160.94357,atomicNumber:71,halfLife:77},{id:"Lu162",massNumber:162,exactMass:161.94328,atomicNumber:71,halfLife:82.2},{id:"Lu163",massNumber:163,exactMass:162.94118,atomicNumber:71,halfLife:238},{id:"Lu164",massNumber:164,exactMass:163.94134,atomicNumber:71,halfLife:188.4},{id:"Lu165",massNumber:165,exactMass:164.939407,atomicNumber:71,halfLife:644.4},{id:"Lu166",massNumber:166,exactMass:165.93986,atomicNumber:71,halfLife:159},{id:"Lu167",massNumber:167,exactMass:166.93827,atomicNumber:71,halfLife:3090},{id:"Lu168",massNumber:168,exactMass:167.93874,atomicNumber:71,halfLife:330},{id:"Lu169",massNumber:169,exactMass:168.937651,atomicNumber:71,halfLife:122616},{id:"Lu170",massNumber:170,exactMass:169.938475,atomicNumber:71,halfLife:173837},{id:"Lu171",massNumber:171,exactMass:170.9379131,atomicNumber:71,halfLife:711936},{id:"Lu172",massNumber:172,exactMass:171.939086,atomicNumber:71,halfLife:578880},{id:"Lu173",massNumber:173,exactMass:172.9389306,atomicNumber:71,halfLife:43204300},{id:"Lu174",massNumber:174,exactMass:173.9403375,atomicNumber:71,halfLife:104384e3},{id:"Lu175",massNumber:175,relativeAbundance:.9741,atomicNumber:71,exactMass:174.9407718,spin:"7/2+",magneticMoment:"+2.2327",halfLife:-1},{id:"Lu176",massNumber:176,relativeAbundance:.0259,atomicNumber:71,exactMass:175.9426863,spin:"1-",magneticMoment:"3.19"},{id:"Lu177",massNumber:177,exactMass:176.9437581,atomicNumber:71,magneticMoment:"+2.239",halfLife:581818},{id:"Lu178",massNumber:178,exactMass:177.945955,atomicNumber:71,halfLife:1704},{id:"Lu179",massNumber:179,exactMass:178.947327,atomicNumber:71,halfLife:16524},{id:"Lu180",massNumber:180,exactMass:179.94988,atomicNumber:71,halfLife:342},{id:"Lu181",massNumber:181,exactMass:180.95197,atomicNumber:71,halfLife:210},{id:"Lu182",massNumber:182,exactMass:181.95504,atomicNumber:71},{id:"Lu183",massNumber:183,exactMass:182.95757,atomicNumber:71,halfLife:58},{id:"Lu184",massNumber:184,exactMass:183.96091,atomicNumber:71,halfLife:20}]},{elementSymbol:"Hf",atomicNumber:72,isotopes:[{id:"Hf153",massNumber:153,exactMass:152.97069,atomicNumber:72},{id:"Hf154",massNumber:154,exactMass:153.96486,atomicNumber:72},{id:"Hf155",massNumber:155,exactMass:154.96339,atomicNumber:72,halfLife:.89},{id:"Hf156",massNumber:156,exactMass:155.95936,atomicNumber:72,halfLife:.025},{id:"Hf157",massNumber:157,exactMass:156.9584,atomicNumber:72,halfLife:.11},{id:"Hf158",massNumber:158,exactMass:157.954799,atomicNumber:72,halfLife:2.85},{id:"Hf159",massNumber:159,exactMass:158.953995,atomicNumber:72,halfLife:5.6},{id:"Hf160",massNumber:160,exactMass:159.950684,atomicNumber:72,halfLife:13.6},{id:"Hf161",massNumber:161,exactMass:160.950275,atomicNumber:72,halfLife:16.8},{id:"Hf162",massNumber:162,exactMass:161.94721,atomicNumber:72,halfLife:37.6},{id:"Hf163",massNumber:163,exactMass:162.94709,atomicNumber:72,halfLife:40},{id:"Hf164",massNumber:164,exactMass:163.944367,atomicNumber:72,halfLife:111},{id:"Hf165",massNumber:165,exactMass:164.94457,atomicNumber:72,halfLife:76},{id:"Hf166",massNumber:166,exactMass:165.94218,atomicNumber:72,halfLife:406.2},{id:"Hf167",massNumber:167,exactMass:166.9426,atomicNumber:72,halfLife:123},{id:"Hf168",massNumber:168,exactMass:167.94057,atomicNumber:72,halfLife:1557},{id:"Hf169",massNumber:169,exactMass:168.94126,atomicNumber:72,halfLife:194.4},{id:"Hf170",massNumber:170,exactMass:169.93961,atomicNumber:72,halfLife:57636},{id:"Hf171",massNumber:171,exactMass:170.94049,atomicNumber:72,halfLife:43560},{id:"Hf172",massNumber:172,exactMass:171.939448,atomicNumber:72,halfLife:58972300},{id:"Hf173",massNumber:173,exactMass:172.94051,atomicNumber:72,halfLife:84960},{id:"Hf174",massNumber:174,relativeAbundance:.0016,atomicNumber:72,exactMass:173.940046,spin:"0+",halfLife:2e15,alphaDecay:"2.55",alphaDecayLikeliness:"100.0"},{id:"Hf175",massNumber:175,exactMass:174.941509,atomicNumber:72,spin:"5/2-",magneticMoment:"0.70",halfLife:6048e3,ecDecay:"0.59",ecDecayLikeliness:"100.0"},{id:"Hf176",massNumber:176,relativeAbundance:.0526,atomicNumber:72,exactMass:175.9414086,spin:"0+",halfLife:-1},{id:"Hf177",massNumber:177,relativeAbundance:.18600000000000003,atomicNumber:72,exactMass:176.9432207,spin:"7/2-",magneticMoment:"+0.7935",halfLife:-1},{id:"Hf178",massNumber:178,relativeAbundance:.2728,atomicNumber:72,exactMass:177.9436988,spin:"0+",halfLife:-1},{id:"Hf179",massNumber:179,relativeAbundance:.1362,atomicNumber:72,exactMass:178.9458161,spin:"9/2+",magneticMoment:"-0.6409",halfLife:-1},{id:"Hf180",massNumber:180,relativeAbundance:.3508,atomicNumber:72,exactMass:179.94655,spin:"0+",halfLife:-1},{id:"Hf181",massNumber:181,exactMass:180.9491012,atomicNumber:72,halfLife:3662500},{id:"Hf182",massNumber:182,exactMass:181.950554,atomicNumber:72},{id:"Hf183",massNumber:183,exactMass:182.95353,atomicNumber:72,halfLife:3841.2},{id:"Hf184",massNumber:184,exactMass:183.95545,atomicNumber:72,halfLife:14832},{id:"Hf185",massNumber:185,exactMass:184.95882,atomicNumber:72,halfLife:210},{id:"Hf186",massNumber:186,exactMass:185.96089,atomicNumber:72},{id:"Hf187",massNumber:187,exactMass:186.96459,atomicNumber:72},{id:"Hf188",massNumber:188,exactMass:187.96685,atomicNumber:72}]},{elementSymbol:"Ta",atomicNumber:73,isotopes:[{id:"Ta155",massNumber:155,exactMass:154.97459,atomicNumber:73},{id:"Ta156",massNumber:156,exactMass:155.9723,atomicNumber:73,halfLife:.144},{id:"Ta157",massNumber:157,exactMass:156.96819,atomicNumber:73,halfLife:.0101},{id:"Ta158",massNumber:158,exactMass:157.9667,atomicNumber:73,halfLife:.0365},{id:"Ta159",massNumber:159,exactMass:158.963018,atomicNumber:73,halfLife:.57},{id:"Ta160",massNumber:160,exactMass:159.96149,atomicNumber:73,halfLife:1.55},{id:"Ta161",massNumber:161,exactMass:160.95842,atomicNumber:73,halfLife:2.7},{id:"Ta162",massNumber:162,exactMass:161.95729,atomicNumber:73,halfLife:3.52},{id:"Ta163",massNumber:163,exactMass:162.95433,atomicNumber:73,halfLife:10.6},{id:"Ta164",massNumber:164,exactMass:163.95353,atomicNumber:73,halfLife:14.2},{id:"Ta165",massNumber:165,exactMass:164.950773,atomicNumber:73,halfLife:31},{id:"Ta166",massNumber:166,exactMass:165.95051,atomicNumber:73,halfLife:34.4},{id:"Ta167",massNumber:167,exactMass:166.94809,atomicNumber:73,halfLife:84},{id:"Ta168",massNumber:168,exactMass:167.94805,atomicNumber:73},{id:"Ta169",massNumber:169,exactMass:168.94601,atomicNumber:73,halfLife:294},{id:"Ta170",massNumber:170,exactMass:169.94618,atomicNumber:73,halfLife:405.6},{id:"Ta171",massNumber:171,exactMass:170.94448,atomicNumber:73,halfLife:1398},{id:"Ta172",massNumber:172,exactMass:171.9449,atomicNumber:73,halfLife:2208},{id:"Ta173",massNumber:173,exactMass:172.94375,atomicNumber:73,halfLife:11304},{id:"Ta174",massNumber:174,exactMass:173.94445,atomicNumber:73,halfLife:3780},{id:"Ta175",massNumber:175,exactMass:174.94374,atomicNumber:73,halfLife:37800},{id:"Ta176",massNumber:176,exactMass:175.94486,atomicNumber:73,halfLife:29124},{id:"Ta177",massNumber:177,exactMass:176.944472,atomicNumber:73,halfLife:203616},{id:"Ta178",massNumber:178,exactMass:177.945778,atomicNumber:73,halfLife:558.6},{id:"Ta179",massNumber:179,exactMass:178.9459295,atomicNumber:73,halfLife:57395500},{id:"Ta180",massNumber:180,relativeAbundance:12e-5,atomicNumber:73,exactMass:179.9474648,spin:"1-",halfLife:29347.2,betaminusDecay:"",betaminusDecayLikeliness:"14.0",ecDecay:"",ecDecayLikeliness:"86.0"},{id:"Ta181",massNumber:181,relativeAbundance:.99988,atomicNumber:73,exactMass:180.9479958,spin:"7/2+",magneticMoment:"+2.370",halfLife:-1},{id:"Ta182",massNumber:182,exactMass:181.9501518,atomicNumber:73,spin:"3-",magneticMoment:"2.6",halfLife:9886750,betaminusDecay:"1.811",betaminusDecayLikeliness:"100.0"},{id:"Ta183",massNumber:183,exactMass:182.9513726,atomicNumber:73,halfLife:440640},{id:"Ta184",massNumber:184,exactMass:183.954008,atomicNumber:73,halfLife:31320},{id:"Ta185",massNumber:185,exactMass:184.955559,atomicNumber:73,halfLife:2964},{id:"Ta186",massNumber:186,exactMass:185.95855,atomicNumber:73,halfLife:630},{id:"Ta187",massNumber:187,exactMass:186.96053,atomicNumber:73},{id:"Ta188",massNumber:188,exactMass:187.9637,atomicNumber:73},{id:"Ta189",massNumber:189,exactMass:188.96583,atomicNumber:73},{id:"Ta190",massNumber:190,exactMass:189.96923,atomicNumber:73}]},{elementSymbol:"W",atomicNumber:74,isotopes:[{id:"W158",massNumber:158,exactMass:157.97456,atomicNumber:74,halfLife:9e-4},{id:"W159",massNumber:159,exactMass:158.97292,atomicNumber:74,halfLife:.0073},{id:"W160",massNumber:160,exactMass:159.96848,atomicNumber:74,halfLife:.091},{id:"W161",massNumber:161,exactMass:160.96736,atomicNumber:74,halfLife:.41},{id:"W162",massNumber:162,exactMass:161.963497,atomicNumber:74,halfLife:1.39},{id:"W163",massNumber:163,exactMass:162.96252,atomicNumber:74,halfLife:2.75},{id:"W164",massNumber:164,exactMass:163.958954,atomicNumber:74,halfLife:6},{id:"W165",massNumber:165,exactMass:164.95828,atomicNumber:74,halfLife:5.1},{id:"W166",massNumber:166,exactMass:165.955027,atomicNumber:74,halfLife:18.8},{id:"W167",massNumber:167,exactMass:166.954816,atomicNumber:74,halfLife:19.9},{id:"W168",massNumber:168,exactMass:167.951808,atomicNumber:74,halfLife:53},{id:"W169",massNumber:169,exactMass:168.951779,atomicNumber:74,halfLife:76},{id:"W170",massNumber:170,exactMass:169.949228,atomicNumber:74,halfLife:145.2},{id:"W171",massNumber:171,exactMass:170.94945,atomicNumber:74,halfLife:142.8},{id:"W172",massNumber:172,exactMass:171.94729,atomicNumber:74,halfLife:396},{id:"W173",massNumber:173,exactMass:172.94769,atomicNumber:74,halfLife:456},{id:"W174",massNumber:174,exactMass:173.94608,atomicNumber:74,halfLife:1860},{id:"W175",massNumber:175,exactMass:174.94672,atomicNumber:74,halfLife:2112},{id:"W176",massNumber:176,exactMass:175.94563,atomicNumber:74,halfLife:9e3},{id:"W177",massNumber:177,exactMass:176.94664,atomicNumber:74,halfLife:8100},{id:"W178",massNumber:178,exactMass:177.945876,atomicNumber:74,halfLife:1866240},{id:"W179",massNumber:179,exactMass:178.94707,atomicNumber:74,halfLife:2223},{id:"W180",massNumber:180,relativeAbundance:.0012,atomicNumber:74,exactMass:179.946704,spin:"0+",halfLife:-1},{id:"W181",massNumber:181,exactMass:180.948197,atomicNumber:74,spin:"9/2+",halfLife:10471700,ecDecay:"0.19",ecDecayLikeliness:"100.0"},{id:"W182",massNumber:182,relativeAbundance:.265,atomicNumber:74,exactMass:181.9482042,spin:"0+",magneticMoment:"0+",halfLife:-1},{id:"W183",massNumber:183,relativeAbundance:.1431,atomicNumber:74,exactMass:182.950223,spin:"1/2-",magneticMoment:"+0.1177847"},{id:"W184",massNumber:184,relativeAbundance:.3064,atomicNumber:74,exactMass:183.9509312,spin:"0+"},{id:"W185",massNumber:185,exactMass:184.9534193,atomicNumber:74,halfLife:6488640,betaminusDecay:"0.432",betaminusDecayLikeliness:"100.0"},{id:"W186",massNumber:186,relativeAbundance:.2843,atomicNumber:74,exactMass:185.9543641,spin:"3/2-",halfLife:-1},{id:"W187",massNumber:187,exactMass:186.9571605,atomicNumber:74,magneticMoment:"0.688",halfLife:85392,betaminusDecay:"1.321",betaminusDecayLikeliness:"100.0"},{id:"W188",massNumber:188,exactMass:187.958489,atomicNumber:74,halfLife:5996160},{id:"W189",massNumber:189,exactMass:188.96191,atomicNumber:74,halfLife:690},{id:"W190",massNumber:190,exactMass:189.96318,atomicNumber:74,halfLife:1800},{id:"W191",massNumber:191,exactMass:190.9666,atomicNumber:74},{id:"W192",massNumber:192,exactMass:191.96817,atomicNumber:74}]},{elementSymbol:"Re",atomicNumber:75,isotopes:[{id:"Re160",massNumber:160,exactMass:159.98212,atomicNumber:75,halfLife:79e-5},{id:"Re161",massNumber:161,exactMass:160.97759,atomicNumber:75,halfLife:37e-5},{id:"Re162",massNumber:162,exactMass:161.976,atomicNumber:75,halfLife:.107},{id:"Re163",massNumber:163,exactMass:162.972081,atomicNumber:75,halfLife:.26},{id:"Re164",massNumber:164,exactMass:163.97032,atomicNumber:75,halfLife:.38},{id:"Re165",massNumber:165,exactMass:164.967089,atomicNumber:75,halfLife:2.4},{id:"Re166",massNumber:166,exactMass:165.96581,atomicNumber:75,halfLife:2.8},{id:"Re167",massNumber:167,exactMass:166.9626,atomicNumber:75,halfLife:6.1},{id:"Re168",massNumber:168,exactMass:167.96157,atomicNumber:75,halfLife:4.4},{id:"Re169",massNumber:169,exactMass:168.95879,atomicNumber:75},{id:"Re170",massNumber:170,exactMass:169.95822,atomicNumber:75,halfLife:9.2},{id:"Re171",massNumber:171,exactMass:170.95572,atomicNumber:75,halfLife:15.2},{id:"Re172",massNumber:172,exactMass:171.95542,atomicNumber:75,halfLife:15},{id:"Re173",massNumber:173,exactMass:172.95324,atomicNumber:75,halfLife:118.8},{id:"Re174",massNumber:174,exactMass:173.95312,atomicNumber:75,halfLife:144},{id:"Re175",massNumber:175,exactMass:174.95138,atomicNumber:75,halfLife:353.4},{id:"Re176",massNumber:176,exactMass:175.95162,atomicNumber:75,halfLife:318},{id:"Re177",massNumber:177,exactMass:176.95033,atomicNumber:75,halfLife:840},{id:"Re178",massNumber:178,exactMass:177.95099,atomicNumber:75,halfLife:792},{id:"Re179",massNumber:179,exactMass:178.949988,atomicNumber:75,halfLife:1170},{id:"Re180",massNumber:180,exactMass:179.950789,atomicNumber:75,halfLife:146.4},{id:"Re181",massNumber:181,exactMass:180.950068,atomicNumber:75,halfLife:71640},{id:"Re182",massNumber:182,exactMass:181.95121,atomicNumber:75,halfLife:230400},{id:"Re183",massNumber:183,exactMass:182.95082,atomicNumber:75,halfLife:6048e3},{id:"Re184",massNumber:184,exactMass:183.952521,atomicNumber:75,halfLife:3283200},{id:"Re185",massNumber:185,relativeAbundance:.374,atomicNumber:75,exactMass:184.952955,spin:"5/2+",magneticMoment:"+3.172",halfLife:-1},{id:"Re186",massNumber:186,exactMass:185.9549861,atomicNumber:75,spin:"1-",magneticMoment:"+1.739",halfLife:321261,betaminusDecay:"1.071",betaminusDecayLikeliness:"93.1",ecDecay:"",ecDecayLikeliness:"6.9"},{id:"Re187",massNumber:187,relativeAbundance:.626,atomicNumber:75,exactMass:186.9557531,spin:"5/2+",magneticMoment:"+3.2197",halfLife:435e8,betaminusDecay:"0.00251",betaminusDecayLikeliness:"100.0"},{id:"Re188",massNumber:188,exactMass:187.9581144,atomicNumber:75,spin:"1-",magneticMoment:"+1.788",halfLife:61218,betaminusDecay:"2.12",betaminusDecayLikeliness:"100.0"},{id:"Re189",massNumber:189,exactMass:188.959229,atomicNumber:75,halfLife:87480},{id:"Re190",massNumber:190,exactMass:189.96182,atomicNumber:75,halfLife:186},{id:"Re191",massNumber:191,exactMass:190.963125,atomicNumber:75,halfLife:588},{id:"Re192",massNumber:192,exactMass:191.96596,atomicNumber:75,halfLife:16},{id:"Re193",massNumber:193,exactMass:192.96747,atomicNumber:75},{id:"Re194",massNumber:194,exactMass:193.97042,atomicNumber:75}]},{elementSymbol:"Os",atomicNumber:76,isotopes:[{id:"Os162",massNumber:162,exactMass:161.98443,atomicNumber:76,halfLife:.0019},{id:"Os163",massNumber:163,exactMass:162.98269,atomicNumber:76},{id:"Os164",massNumber:164,exactMass:163.97804,atomicNumber:76,halfLife:.021},{id:"Os165",massNumber:165,exactMass:164.97676,atomicNumber:76,halfLife:.071},{id:"Os166",massNumber:166,exactMass:165.972691,atomicNumber:76,halfLife:.181},{id:"Os167",massNumber:167,exactMass:166.97155,atomicNumber:76,halfLife:.83},{id:"Os168",massNumber:168,exactMass:167.967804,atomicNumber:76,halfLife:2.1},{id:"Os169",massNumber:169,exactMass:168.967019,atomicNumber:76,halfLife:3.4},{id:"Os170",massNumber:170,exactMass:169.963577,atomicNumber:76,halfLife:7.3},{id:"Os171",massNumber:171,exactMass:170.963185,atomicNumber:76,halfLife:8},{id:"Os172",massNumber:172,exactMass:171.960023,atomicNumber:76,halfLife:19.2},{id:"Os173",massNumber:173,exactMass:172.959808,atomicNumber:76,halfLife:16},{id:"Os174",massNumber:174,exactMass:173.957062,atomicNumber:76,halfLife:44},{id:"Os175",massNumber:175,exactMass:174.956946,atomicNumber:76,halfLife:84},{id:"Os176",massNumber:176,exactMass:175.95481,atomicNumber:76,halfLife:216},{id:"Os177",massNumber:177,exactMass:176.954965,atomicNumber:76,halfLife:168},{id:"Os178",massNumber:178,exactMass:177.953251,atomicNumber:76,halfLife:300},{id:"Os179",massNumber:179,exactMass:178.953816,atomicNumber:76,halfLife:390},{id:"Os180",massNumber:180,exactMass:179.952379,atomicNumber:76,halfLife:1290},{id:"Os181",massNumber:181,exactMass:180.95324,atomicNumber:76,halfLife:6300},{id:"Os182",massNumber:182,exactMass:181.95211,atomicNumber:76,halfLife:79560},{id:"Os183",massNumber:183,exactMass:182.95313,atomicNumber:76,halfLife:46800},{id:"Os184",massNumber:184,relativeAbundance:2e-4,atomicNumber:76,exactMass:183.9524891,spin:"0+"},{id:"Os185",massNumber:185,exactMass:184.9540423,atomicNumber:76,spin:"1/2-",halfLife:8087040,ecDecay:"0.98",ecDecayLikeliness:"100.0"},{id:"Os186",massNumber:186,relativeAbundance:.0159,atomicNumber:76,exactMass:185.9538382,spin:"0+",halfLife:2e15,alphaDecay:"",alphaDecayLikeliness:"100.0"},{id:"Os187",massNumber:187,relativeAbundance:.0196,atomicNumber:76,exactMass:186.9557505,spin:"1/2-",magneticMoment:"+0.06465",halfLife:-1},{id:"Os188",massNumber:188,relativeAbundance:.1324,atomicNumber:76,exactMass:187.9558382,spin:"0+",halfLife:-1},{id:"Os189",massNumber:189,relativeAbundance:.16149999999999998,atomicNumber:76,exactMass:188.9581475,spin:"3/2-",magneticMoment:"+0.659933",halfLife:-1},{id:"Os190",massNumber:190,relativeAbundance:.2626,atomicNumber:76,exactMass:189.958447,spin:"0+",halfLife:-1},{id:"Os191",massNumber:191,exactMass:190.9609297,atomicNumber:76,spin:"9/2-",halfLife:1330560,betaminusDecay:"0.313",betaminusDecayLikeliness:"100.0"},{id:"Os192",massNumber:192,relativeAbundance:.4078,atomicNumber:76,exactMass:191.9614807,spin:"0+",halfLife:-1},{id:"Os193",massNumber:193,exactMass:192.9641516,atomicNumber:76,halfLife:108396},{id:"Os194",massNumber:194,exactMass:193.9651821,atomicNumber:76,halfLife:189216e3},{id:"Os195",massNumber:195,exactMass:194.96813,atomicNumber:76,halfLife:390},{id:"Os196",massNumber:196,exactMass:195.96964,atomicNumber:76,halfLife:2094}]},{elementSymbol:"Ir",atomicNumber:77,isotopes:[{id:"Ir164",massNumber:164,exactMass:163.9922,atomicNumber:77},{id:"Ir165",massNumber:165,exactMass:164.98752,atomicNumber:77,halfLife:3e-4},{id:"Ir166",massNumber:166,exactMass:165.98582,atomicNumber:77,halfLife:.0105},{id:"Ir167",massNumber:167,exactMass:166.981665,atomicNumber:77,halfLife:.005},{id:"Ir168",massNumber:168,exactMass:167.97988,atomicNumber:77,halfLife:.161},{id:"Ir169",massNumber:169,exactMass:168.976295,atomicNumber:77,halfLife:.4},{id:"Ir170",massNumber:170,exactMass:169.97497,atomicNumber:77,halfLife:1.05},{id:"Ir171",massNumber:171,exactMass:170.97163,atomicNumber:77,halfLife:1.5},{id:"Ir172",massNumber:172,exactMass:171.97046,atomicNumber:77,halfLife:4.4},{id:"Ir173",massNumber:173,exactMass:172.967502,atomicNumber:77,halfLife:9},{id:"Ir174",massNumber:174,exactMass:173.966861,atomicNumber:77,halfLife:9},{id:"Ir175",massNumber:175,exactMass:174.964113,atomicNumber:77,halfLife:9},{id:"Ir176",massNumber:176,exactMass:175.963649,atomicNumber:77,halfLife:8},{id:"Ir177",massNumber:177,exactMass:176.961302,atomicNumber:77,halfLife:30},{id:"Ir178",massNumber:178,exactMass:177.961082,atomicNumber:77,halfLife:12},{id:"Ir179",massNumber:179,exactMass:178.959122,atomicNumber:77,halfLife:79},{id:"Ir180",massNumber:180,exactMass:179.959229,atomicNumber:77,halfLife:90},{id:"Ir181",massNumber:181,exactMass:180.957625,atomicNumber:77,halfLife:294},{id:"Ir182",massNumber:182,exactMass:181.958076,atomicNumber:77,halfLife:900},{id:"Ir183",massNumber:183,exactMass:182.956846,atomicNumber:77,halfLife:3480},{id:"Ir184",massNumber:184,exactMass:183.95748,atomicNumber:77,halfLife:11124},{id:"Ir185",massNumber:185,exactMass:184.9567,atomicNumber:77,halfLife:51840},{id:"Ir186",massNumber:186,exactMass:185.957946,atomicNumber:77,halfLife:59904},{id:"Ir187",massNumber:187,exactMass:186.957363,atomicNumber:77,halfLife:37800},{id:"Ir188",massNumber:188,exactMass:187.958853,atomicNumber:77,halfLife:149400},{id:"Ir189",massNumber:189,exactMass:188.958719,atomicNumber:77,halfLife:1140480},{id:"Ir190",massNumber:190,exactMass:189.960546,atomicNumber:77,halfLife:1017790},{id:"Ir191",massNumber:191,relativeAbundance:.373,atomicNumber:77,exactMass:190.960594,spin:"3/2+",magneticMoment:"+0.1461",halfLife:-1},{id:"Ir192",massNumber:192,exactMass:191.962605,atomicNumber:77,spin:"4-",magneticMoment:"+1.880",halfLife:6379e3,betaplusDecay:"1.2",betaplusDecayLikeliness:"4.6",betaminusDecay:"1.454",betaminusDecayLikeliness:"95.4",ecDecay:"",ecDecayLikeliness:"4.6"},{id:"Ir193",massNumber:193,relativeAbundance:.627,atomicNumber:77,exactMass:192.9629264,spin:"3/2+",magneticMoment:"+0.1591",halfLife:-1},{id:"Ir194",massNumber:194,exactMass:193.9650784,atomicNumber:77,spin:"1-",halfLife:69408},{id:"Ir195",massNumber:195,exactMass:194.9659796,atomicNumber:77,halfLife:9e3},{id:"Ir196",massNumber:196,exactMass:195.9684,atomicNumber:77,halfLife:52},{id:"Ir197",massNumber:197,exactMass:196.969653,atomicNumber:77,halfLife:348},{id:"Ir198",massNumber:198,exactMass:197.97228,atomicNumber:77,halfLife:8},{id:"Ir199",massNumber:199,exactMass:198.9738,atomicNumber:77}]},{elementSymbol:"Pt",atomicNumber:78,isotopes:[{id:"Pt166",massNumber:166,exactMass:165.99486,atomicNumber:78},{id:"Pt167",massNumber:167,exactMass:166.99298,atomicNumber:78},{id:"Pt168",massNumber:168,exactMass:167.98815,atomicNumber:78},{id:"Pt169",massNumber:169,exactMass:168.98672,atomicNumber:78,halfLife:.005},{id:"Pt170",massNumber:170,exactMass:169.982495,atomicNumber:78,halfLife:.006},{id:"Pt171",massNumber:171,exactMass:170.98124,atomicNumber:78,halfLife:.025},{id:"Pt172",massNumber:172,exactMass:171.977347,atomicNumber:78,halfLife:.096},{id:"Pt173",massNumber:173,exactMass:172.97644,atomicNumber:78,halfLife:.342},{id:"Pt174",massNumber:174,exactMass:173.972819,atomicNumber:78,halfLife:.9},{id:"Pt175",massNumber:175,exactMass:174.972421,atomicNumber:78,halfLife:2.52},{id:"Pt176",massNumber:176,exactMass:175.968945,atomicNumber:78,halfLife:6.33},{id:"Pt177",massNumber:177,exactMass:176.968469,atomicNumber:78,halfLife:11},{id:"Pt178",massNumber:178,exactMass:177.965649,atomicNumber:78,halfLife:21.1},{id:"Pt179",massNumber:179,exactMass:178.965363,atomicNumber:78,halfLife:21.2},{id:"Pt180",massNumber:180,exactMass:179.963031,atomicNumber:78,halfLife:52},{id:"Pt181",massNumber:181,exactMass:180.963097,atomicNumber:78,halfLife:51},{id:"Pt182",massNumber:182,exactMass:181.961171,atomicNumber:78,halfLife:180},{id:"Pt183",massNumber:183,exactMass:182.961597,atomicNumber:78,halfLife:390},{id:"Pt184",massNumber:184,exactMass:183.959922,atomicNumber:78,halfLife:1038},{id:"Pt185",massNumber:185,exactMass:184.96062,atomicNumber:78,halfLife:4254},{id:"Pt186",massNumber:186,exactMass:185.959351,atomicNumber:78,halfLife:7920},{id:"Pt187",massNumber:187,exactMass:186.96059,atomicNumber:78,halfLife:8460},{id:"Pt188",massNumber:188,exactMass:187.959395,atomicNumber:78,halfLife:881280},{id:"Pt189",massNumber:189,exactMass:188.960834,atomicNumber:78,halfLife:39132},{id:"Pt190",massNumber:190,relativeAbundance:.00014000000000000001,atomicNumber:78,exactMass:189.959932,spin:"0+",halfLife:65e10,alphaDecay:"3.18",alphaDecayLikeliness:"100.0"},{id:"Pt191",massNumber:191,exactMass:190.961677,atomicNumber:78,spin:"3/2-",halfLife:242093},{id:"Pt192",massNumber:192,relativeAbundance:.00782,atomicNumber:78,exactMass:191.961038,spin:"0+",halfLife:-1,alphaDecay:"2.6",alphaDecayLikeliness:"100.0"},{id:"Pt193",massNumber:193,exactMass:192.9629874,atomicNumber:78,halfLife:15768e5},{id:"Pt194",massNumber:194,relativeAbundance:.32966999999999996,atomicNumber:78,exactMass:193.9626803,spin:"0+",halfLife:-1},{id:"Pt195",massNumber:195,relativeAbundance:.33832,atomicNumber:78,exactMass:194.9647911,spin:"1/2-",magneticMoment:"+0.60949",halfLife:-1},{id:"Pt196",massNumber:196,relativeAbundance:.25242000000000003,atomicNumber:78,exactMass:195.9649515,spin:"0+",halfLife:-1},{id:"Pt197",massNumber:197,exactMass:196.9673402,atomicNumber:78,spin:"1/2-",magneticMoment:"-0.51",halfLife:71609.4,betaminusDecay:"0.75",betaminusDecayLikeliness:"100.0"},{id:"Pt198",massNumber:198,relativeAbundance:.07163,atomicNumber:78,exactMass:197.967893,spin:"0+",halfLife:-1},{id:"Pt199",massNumber:199,exactMass:198.970593,atomicNumber:78,halfLife:1848},{id:"Pt200",massNumber:200,exactMass:199.971441,atomicNumber:78,halfLife:45e3},{id:"Pt201",massNumber:201,exactMass:200.97451,atomicNumber:78,halfLife:150},{id:"Pt202",massNumber:202,exactMass:201.97574,atomicNumber:78,halfLife:158400}]},{elementSymbol:"Au",atomicNumber:79,isotopes:[{id:"Au169",massNumber:169,exactMass:168.99808,atomicNumber:79},{id:"Au170",massNumber:170,exactMass:169.99612,atomicNumber:79},{id:"Au171",massNumber:171,exactMass:170.991879,atomicNumber:79},{id:"Au172",massNumber:172,exactMass:171.99004,atomicNumber:79,halfLife:.0063},{id:"Au173",massNumber:173,exactMass:172.986237,atomicNumber:79,halfLife:.059},{id:"Au174",massNumber:174,exactMass:173.98476,atomicNumber:79,halfLife:.12},{id:"Au175",massNumber:175,exactMass:174.98127,atomicNumber:79,halfLife:.2},{id:"Au176",massNumber:176,exactMass:175.9801,atomicNumber:79,halfLife:1.08},{id:"Au177",massNumber:177,exactMass:176.976865,atomicNumber:79,halfLife:1.18},{id:"Au178",massNumber:178,exactMass:177.97603,atomicNumber:79,halfLife:2.6},{id:"Au179",massNumber:179,exactMass:178.973213,atomicNumber:79,halfLife:7.1},{id:"Au180",massNumber:180,exactMass:179.972521,atomicNumber:79,halfLife:8.1},{id:"Au181",massNumber:181,exactMass:180.970079,atomicNumber:79,halfLife:11.4},{id:"Au182",massNumber:182,exactMass:181.969618,atomicNumber:79,halfLife:15.6},{id:"Au183",massNumber:183,exactMass:182.967593,atomicNumber:79,halfLife:42},{id:"Au184",massNumber:184,exactMass:183.967452,atomicNumber:79,halfLife:53},{id:"Au185",massNumber:185,exactMass:184.965789,atomicNumber:79,halfLife:255},{id:"Au186",massNumber:186,exactMass:185.965953,atomicNumber:79,halfLife:642},{id:"Au187",massNumber:187,exactMass:186.964568,atomicNumber:79,halfLife:504},{id:"Au188",massNumber:188,exactMass:187.965324,atomicNumber:79,halfLife:530.4},{id:"Au189",massNumber:189,exactMass:188.963948,atomicNumber:79,halfLife:1722},{id:"Au190",massNumber:190,exactMass:189.9647,atomicNumber:79,halfLife:2568},{id:"Au191",massNumber:191,exactMass:190.9637,atomicNumber:79,halfLife:11448},{id:"Au192",massNumber:192,exactMass:191.964813,atomicNumber:79,halfLife:17784},{id:"Au193",massNumber:193,exactMass:192.96415,atomicNumber:79,halfLife:63540},{id:"Au194",massNumber:194,exactMass:193.965365,atomicNumber:79,halfLife:136872},{id:"Au195",massNumber:195,exactMass:194.9650346,atomicNumber:79,magneticMoment:"0.148",halfLife:16078200,ecDecay:"0.230",ecDecayLikeliness:"100.0"},{id:"Au196",massNumber:196,exactMass:195.96657,atomicNumber:79,halfLife:534211},{id:"Au197",massNumber:197,relativeAbundance:1,atomicNumber:79,exactMass:196.9665687,spin:"3/2+",magneticMoment:"+0.1457",halfLife:-1},{id:"Au198",massNumber:198,exactMass:197.9682423,atomicNumber:79,spin:"2-",magneticMoment:"+0.5934",halfLife:232863,betaminusDecay:"1.372",betaminusDecayLikeliness:"100.0"},{id:"Au199",massNumber:199,exactMass:198.9687652,atomicNumber:79,spin:"3/2+",magneticMoment:"+0.2715",halfLife:271210,betaminusDecay:"0.453",betaminusDecayLikeliness:"100.0"},{id:"Au200",massNumber:200,exactMass:199.97073,atomicNumber:79,halfLife:2904},{id:"Au201",massNumber:201,exactMass:200.971657,atomicNumber:79,halfLife:1560},{id:"Au202",massNumber:202,exactMass:201.97381,atomicNumber:79,halfLife:28.8},{id:"Au203",massNumber:203,exactMass:202.975155,atomicNumber:79,halfLife:53},{id:"Au204",massNumber:204,exactMass:203.97772,atomicNumber:79,halfLife:39.8},{id:"Au205",massNumber:205,exactMass:204.97987,atomicNumber:79,halfLife:31}]},{elementSymbol:"Hg",atomicNumber:80,isotopes:[{id:"Hg171",massNumber:171,exactMass:171.00376,atomicNumber:80},{id:"Hg172",massNumber:172,exactMass:171.99883,atomicNumber:80},{id:"Hg173",massNumber:173,exactMass:172.99724,atomicNumber:80},{id:"Hg174",massNumber:174,exactMass:173.992864,atomicNumber:80},{id:"Hg175",massNumber:175,exactMass:174.99142,atomicNumber:80,halfLife:.02},{id:"Hg176",massNumber:176,exactMass:175.987355,atomicNumber:80,halfLife:.018},{id:"Hg177",massNumber:177,exactMass:176.98628,atomicNumber:80,halfLife:.13},{id:"Hg178",massNumber:178,exactMass:177.982483,atomicNumber:80,halfLife:.266},{id:"Hg179",massNumber:179,exactMass:178.981834,atomicNumber:80,halfLife:1.09},{id:"Hg180",massNumber:180,exactMass:179.978266,atomicNumber:80,halfLife:2.8},{id:"Hg181",massNumber:181,exactMass:180.977819,atomicNumber:80,halfLife:3.6},{id:"Hg182",massNumber:182,exactMass:181.97469,atomicNumber:80,halfLife:10.83},{id:"Hg183",massNumber:183,exactMass:182.97445,atomicNumber:80,halfLife:9.4},{id:"Hg184",massNumber:184,exactMass:183.971713,atomicNumber:80,halfLife:30.9},{id:"Hg185",massNumber:185,exactMass:184.971899,atomicNumber:80,halfLife:49.1},{id:"Hg186",massNumber:186,exactMass:185.969362,atomicNumber:80,halfLife:82.8},{id:"Hg187",massNumber:187,exactMass:186.969814,atomicNumber:80,halfLife:144},{id:"Hg188",massNumber:188,exactMass:187.967577,atomicNumber:80,halfLife:195},{id:"Hg189",massNumber:189,exactMass:188.96819,atomicNumber:80,halfLife:456},{id:"Hg190",massNumber:190,exactMass:189.966322,atomicNumber:80,halfLife:1200},{id:"Hg191",massNumber:191,exactMass:190.967157,atomicNumber:80,halfLife:2940},{id:"Hg192",massNumber:192,exactMass:191.965634,atomicNumber:80,halfLife:17460},{id:"Hg193",massNumber:193,exactMass:192.966665,atomicNumber:80,halfLife:13680},{id:"Hg194",massNumber:194,exactMass:193.965439,atomicNumber:80,halfLife:14002e6},{id:"Hg195",massNumber:195,exactMass:194.96672,atomicNumber:80,halfLife:35640},{id:"Hg196",massNumber:196,relativeAbundance:.0015,atomicNumber:80,exactMass:195.965833,spin:"0+",halfLife:-1},{id:"Hg197",massNumber:197,exactMass:196.967213,atomicNumber:80,spin:"1/2-",magneticMoment:"+0.5274",halfLife:230904,ecDecay:"0.42",ecDecayLikeliness:"100.0"},{id:"Hg198",massNumber:198,relativeAbundance:.09970000000000001,atomicNumber:80,exactMass:197.966769,spin:"0+",halfLife:-1},{id:"Hg199",massNumber:199,relativeAbundance:.16870000000000002,atomicNumber:80,exactMass:198.9682799,spin:"1/2-",magneticMoment:"+0.5058851",halfLife:-1},{id:"Hg200",massNumber:200,relativeAbundance:.231,atomicNumber:80,exactMass:199.968326,spin:"0+",halfLife:-1},{id:"Hg201",massNumber:201,relativeAbundance:.1318,atomicNumber:80,exactMass:200.9703023,spin:"3/2-",magneticMoment:"-0.560225",halfLife:-1},{id:"Hg202",massNumber:202,relativeAbundance:.2986,atomicNumber:80,exactMass:201.970643,spin:"0+",halfLife:-1},{id:"Hg203",massNumber:203,exactMass:202.9728725,atomicNumber:80,spin:"5/2-",magneticMoment:"+0.8489",halfLife:4027280,betaminusDecay:"0.492",betaminusDecayLikeliness:"100.0"},{id:"Hg204",massNumber:204,relativeAbundance:.0687,atomicNumber:80,exactMass:203.9734939,spin:"0+",halfLife:-1},{id:"Hg205",massNumber:205,exactMass:204.976073,atomicNumber:80,halfLife:312},{id:"Hg206",massNumber:206,exactMass:205.977514,atomicNumber:80,halfLife:489},{id:"Hg207",massNumber:207,exactMass:206.98259,atomicNumber:80,halfLife:174},{id:"Hg208",massNumber:208,exactMass:207.98594,atomicNumber:80,halfLife:2520},{id:"Hg209",massNumber:209,exactMass:208.99104,atomicNumber:80},{id:"Hg210",massNumber:210,exactMass:209.99451,atomicNumber:80}]},{elementSymbol:"Tl",atomicNumber:81,isotopes:[{id:"Tl176",massNumber:176,exactMass:176.00059,atomicNumber:81},{id:"Tl177",massNumber:177,exactMass:176.996427,atomicNumber:81},{id:"Tl178",massNumber:178,exactMass:177.9949,atomicNumber:81},{id:"Tl179",massNumber:179,exactMass:178.99109,atomicNumber:81,halfLife:.16},{id:"Tl180",massNumber:180,exactMass:179.98991,atomicNumber:81,halfLife:.7},{id:"Tl181",massNumber:181,exactMass:180.986257,atomicNumber:81},{id:"Tl182",massNumber:182,exactMass:181.98567,atomicNumber:81,halfLife:3.1},{id:"Tl183",massNumber:183,exactMass:182.982193,atomicNumber:81},{id:"Tl184",massNumber:184,exactMass:183.98187,atomicNumber:81,halfLife:11},{id:"Tl185",massNumber:185,exactMass:184.97879,atomicNumber:81,halfLife:19.5},{id:"Tl186",massNumber:186,exactMass:185.97833,atomicNumber:81,halfLife:27.5},{id:"Tl187",massNumber:187,exactMass:186.975906,atomicNumber:81,halfLife:51},{id:"Tl188",massNumber:188,exactMass:187.97601,atomicNumber:81,halfLife:71},{id:"Tl189",massNumber:189,exactMass:188.973588,atomicNumber:81,halfLife:138},{id:"Tl190",massNumber:190,exactMass:189.97388,atomicNumber:81,halfLife:156},{id:"Tl191",massNumber:191,exactMass:190.971786,atomicNumber:81},{id:"Tl192",massNumber:192,exactMass:191.97223,atomicNumber:81,halfLife:576},{id:"Tl193",massNumber:193,exactMass:192.97067,atomicNumber:81,halfLife:1296},{id:"Tl194",massNumber:194,exactMass:193.9712,atomicNumber:81,halfLife:1980},{id:"Tl195",massNumber:195,exactMass:194.969774,atomicNumber:81,halfLife:4176},{id:"Tl196",massNumber:196,exactMass:195.970481,atomicNumber:81,halfLife:6624},{id:"Tl197",massNumber:197,exactMass:196.969575,atomicNumber:81,halfLife:10224},{id:"Tl198",massNumber:198,exactMass:197.97048,atomicNumber:81,halfLife:19080},{id:"Tl199",massNumber:199,exactMass:198.96988,atomicNumber:81,halfLife:26712},{id:"Tl200",massNumber:200,exactMass:199.970963,atomicNumber:81,halfLife:93960},{id:"Tl201",massNumber:201,exactMass:200.970819,atomicNumber:81,halfLife:262483},{id:"Tl202",massNumber:202,exactMass:201.972106,atomicNumber:81,halfLife:1056670},{id:"Tl203",massNumber:203,relativeAbundance:.29524,atomicNumber:81,exactMass:202.9723442,spin:"1/2+",magneticMoment:"+1.622257",halfLife:-1},{id:"Tl204",massNumber:204,exactMass:203.9738635,atomicNumber:81,spin:"2-",magneticMoment:"-0.06",halfLife:119206e3,betaminusDecay:"0.763",betaminusDecayLikeliness:"97.43",ecDecay:"0.345",ecDecayLikeliness:"2.57"},{id:"Tl205",massNumber:205,relativeAbundance:.7047599999999999,atomicNumber:81,exactMass:204.9744275,spin:"1/2+",magneticMoment:"+1.6382134",halfLife:-1},{id:"Tl206",massNumber:206,exactMass:205.9761103,atomicNumber:81,spin:"0-",halfLife:251.94},{id:"Tl207",massNumber:207,exactMass:206.977419,atomicNumber:81,halfLife:286.2},{id:"Tl208",massNumber:208,exactMass:207.9820187,atomicNumber:81,halfLife:183.18},{id:"Tl209",massNumber:209,exactMass:208.985359,atomicNumber:81,halfLife:132},{id:"Tl210",massNumber:210,exactMass:209.990074,atomicNumber:81,halfLife:78},{id:"Tl211",massNumber:211,exactMass:210.99348,atomicNumber:81},{id:"Tl212",massNumber:212,exactMass:211.99823,atomicNumber:81}]},{elementSymbol:"Pb",atomicNumber:82,isotopes:[{id:"Pb178",massNumber:178,exactMass:178.00383,atomicNumber:82},{id:"Pb179",massNumber:179,exactMass:179.00215,atomicNumber:82},{id:"Pb180",massNumber:180,exactMass:179.997918,atomicNumber:82},{id:"Pb181",massNumber:181,exactMass:180.99662,atomicNumber:82,halfLife:.045},{id:"Pb182",massNumber:182,exactMass:181.992672,atomicNumber:82,halfLife:.055},{id:"Pb183",massNumber:183,exactMass:182.99187,atomicNumber:82,halfLife:.3},{id:"Pb184",massNumber:184,exactMass:183.988142,atomicNumber:82,halfLife:.55},{id:"Pb185",massNumber:185,exactMass:184.98761,atomicNumber:82,halfLife:4.1},{id:"Pb186",massNumber:186,exactMass:185.984239,atomicNumber:82,halfLife:4.83},{id:"Pb187",massNumber:187,exactMass:186.983918,atomicNumber:82,halfLife:18.3},{id:"Pb188",massNumber:188,exactMass:187.980874,atomicNumber:82,halfLife:24},{id:"Pb189",massNumber:189,exactMass:188.98081,atomicNumber:82,halfLife:51},{id:"Pb190",massNumber:190,exactMass:189.978082,atomicNumber:82,halfLife:72},{id:"Pb191",massNumber:191,exactMass:190.97827,atomicNumber:82,halfLife:79.8},{id:"Pb192",massNumber:192,exactMass:191.975785,atomicNumber:82,halfLife:210},{id:"Pb193",massNumber:193,exactMass:192.97617,atomicNumber:82},{id:"Pb194",massNumber:194,exactMass:193.974012,atomicNumber:82,halfLife:720},{id:"Pb195",massNumber:195,exactMass:194.974542,atomicNumber:82,halfLife:900},{id:"Pb196",massNumber:196,exactMass:195.972774,atomicNumber:82,halfLife:2220},{id:"Pb197",massNumber:197,exactMass:196.973431,atomicNumber:82,halfLife:480},{id:"Pb198",massNumber:198,exactMass:197.972034,atomicNumber:82,halfLife:8640},{id:"Pb199",massNumber:199,exactMass:198.972917,atomicNumber:82,halfLife:5400},{id:"Pb200",massNumber:200,exactMass:199.971827,atomicNumber:82,halfLife:77400},{id:"Pb201",massNumber:201,exactMass:200.972885,atomicNumber:82,halfLife:33588},{id:"Pb202",massNumber:202,exactMass:201.972159,atomicNumber:82},{id:"Pb203",massNumber:203,exactMass:202.973391,atomicNumber:82,halfLife:186743},{id:"Pb204",massNumber:204,relativeAbundance:.013999999999999999,atomicNumber:82,exactMass:203.9730436,spin:"0+"},{id:"Pb205",massNumber:205,exactMass:204.9744818,atomicNumber:82,spin:"5/2-"},{id:"Pb206",massNumber:206,relativeAbundance:.24100000000000002,atomicNumber:82,exactMass:205.9744653,spin:"0+",halfLife:-1},{id:"Pb207",massNumber:207,relativeAbundance:.221,atomicNumber:82,exactMass:206.9758969,spin:"1/2-",magneticMoment:"+0.5926",halfLife:-1},{id:"Pb208",massNumber:208,relativeAbundance:.524,atomicNumber:82,exactMass:207.9766521,spin:"0+",halfLife:-1},{id:"Pb209",massNumber:209,exactMass:208.9810901,atomicNumber:82,spin:"9/2+",halfLife:11710.8},{id:"Pb210",massNumber:210,exactMass:209.9841885,atomicNumber:82,halfLife:703253e3},{id:"Pb211",massNumber:211,exactMass:210.988737,atomicNumber:82,halfLife:2166},{id:"Pb212",massNumber:212,exactMass:211.9918975,atomicNumber:82,halfLife:38304},{id:"Pb213",massNumber:213,exactMass:212.996581,atomicNumber:82,halfLife:612},{id:"Pb214",massNumber:214,exactMass:213.9998054,atomicNumber:82,halfLife:1608},{id:"Pb215",massNumber:215,exactMass:215.00481,atomicNumber:82,halfLife:36}]},{elementSymbol:"Bi",atomicNumber:83,isotopes:[{id:"Bi184",massNumber:184,exactMass:184.00112,atomicNumber:83},{id:"Bi185",massNumber:185,exactMass:184.99763,atomicNumber:83,halfLife:44e-6},{id:"Bi186",massNumber:186,exactMass:185.9966,atomicNumber:83,halfLife:.015},{id:"Bi187",massNumber:187,exactMass:186.993158,atomicNumber:83,halfLife:.035},{id:"Bi188",massNumber:188,exactMass:187.99227,atomicNumber:83,halfLife:.21},{id:"Bi189",massNumber:189,exactMass:188.9892,atomicNumber:83,halfLife:.68},{id:"Bi190",massNumber:190,exactMass:189.9883,atomicNumber:83,halfLife:6.3},{id:"Bi191",massNumber:191,exactMass:190.985786,atomicNumber:83,halfLife:12},{id:"Bi192",massNumber:192,exactMass:191.98546,atomicNumber:83,halfLife:37},{id:"Bi193",massNumber:193,exactMass:192.98296,atomicNumber:83,halfLife:67},{id:"Bi194",massNumber:194,exactMass:193.98283,atomicNumber:83,halfLife:95},{id:"Bi195",massNumber:195,exactMass:194.980651,atomicNumber:83,halfLife:183},{id:"Bi196",massNumber:196,exactMass:195.980667,atomicNumber:83,halfLife:308},{id:"Bi197",massNumber:197,exactMass:196.978864,atomicNumber:83,halfLife:559.8},{id:"Bi198",massNumber:198,exactMass:197.97921,atomicNumber:83,halfLife:618},{id:"Bi199",massNumber:199,exactMass:198.977672,atomicNumber:83,halfLife:1620},{id:"Bi200",massNumber:200,exactMass:199.978132,atomicNumber:83,halfLife:2184},{id:"Bi201",massNumber:201,exactMass:200.977009,atomicNumber:83,halfLife:6480},{id:"Bi202",massNumber:202,exactMass:201.977742,atomicNumber:83,halfLife:6192},{id:"Bi203",massNumber:203,exactMass:202.976876,atomicNumber:83,halfLife:42336},{id:"Bi204",massNumber:204,exactMass:203.977813,atomicNumber:83,halfLife:40392},{id:"Bi205",massNumber:205,exactMass:204.977389,atomicNumber:83,halfLife:1322780},{id:"Bi206",massNumber:206,exactMass:205.978499,atomicNumber:83,halfLife:539395},{id:"Bi207",massNumber:207,exactMass:206.9784707,atomicNumber:83,halfLife:994961e3},{id:"Bi208",massNumber:208,exactMass:207.9797422,atomicNumber:83},{id:"Bi209",massNumber:209,relativeAbundance:1,atomicNumber:83,exactMass:208.9803987,spin:"9/2-",magneticMoment:"+4.11"},{id:"Bi210",massNumber:210,exactMass:209.9841204,atomicNumber:83,spin:"1-",magneticMoment:"-0.044",halfLife:433123,alphaDecay:"5.04",alphaDecayLikeliness:"100.0",betaminusDecay:"1.16",betaminusDecayLikeliness:"100.0"},{id:"Bi211",massNumber:211,exactMass:210.987269,atomicNumber:83,spin:"9/2-",halfLife:128.4},{id:"Bi212",massNumber:212,exactMass:211.9912857,atomicNumber:83,halfLife:3633},{id:"Bi213",massNumber:213,exactMass:212.994385,atomicNumber:83,halfLife:2735.4},{id:"Bi214",massNumber:214,exactMass:213.998712,atomicNumber:83,halfLife:1194},{id:"Bi215",massNumber:215,exactMass:215.00177,atomicNumber:83,halfLife:456},{id:"Bi216",massNumber:216,exactMass:216.006306,atomicNumber:83,halfLife:216},{id:"Bi217",massNumber:217,exactMass:217.00947,atomicNumber:83,halfLife:97},{id:"Bi218",massNumber:218,exactMass:218.01432,atomicNumber:83}]},{elementSymbol:"Po",atomicNumber:84,isotopes:[{id:"Po188",massNumber:188,exactMass:187.999422,atomicNumber:84},{id:"Po189",massNumber:189,exactMass:188.998481,atomicNumber:84},{id:"Po190",massNumber:190,exactMass:189.995101,atomicNumber:84},{id:"Po191",massNumber:191,exactMass:190.994574,atomicNumber:84,halfLife:.0155},{id:"Po192",massNumber:192,exactMass:191.991335,atomicNumber:84,halfLife:.0332},{id:"Po193",massNumber:193,exactMass:192.99103,atomicNumber:84,halfLife:.42},{id:"Po194",massNumber:194,exactMass:193.988186,atomicNumber:84,halfLife:.392},{id:"Po195",massNumber:195,exactMass:194.98811,atomicNumber:84,halfLife:4.64},{id:"Po196",massNumber:196,exactMass:195.985535,atomicNumber:84,halfLife:5.8},{id:"Po197",massNumber:197,exactMass:196.98566,atomicNumber:84,halfLife:53.6},{id:"Po198",massNumber:198,exactMass:197.983389,atomicNumber:84,halfLife:106.2},{id:"Po199",massNumber:199,exactMass:198.983666,atomicNumber:84,halfLife:328.8},{id:"Po200",massNumber:200,exactMass:199.981799,atomicNumber:84,halfLife:690},{id:"Po201",massNumber:201,exactMass:200.98226,atomicNumber:84,halfLife:918},{id:"Po202",massNumber:202,exactMass:201.980758,atomicNumber:84,halfLife:2682},{id:"Po203",massNumber:203,exactMass:202.98142,atomicNumber:84,halfLife:2202},{id:"Po204",massNumber:204,exactMass:203.980318,atomicNumber:84,halfLife:12708},{id:"Po205",massNumber:205,exactMass:204.981203,atomicNumber:84,halfLife:5976},{id:"Po206",massNumber:206,exactMass:205.980481,atomicNumber:84,halfLife:760320},{id:"Po207",massNumber:207,exactMass:206.981593,atomicNumber:84,halfLife:20880},{id:"Po208",massNumber:208,exactMass:207.9812457,atomicNumber:84,halfLife:91391300},{id:"Po209",massNumber:209,exactMass:208.9824304,atomicNumber:84,magneticMoment:"+0.77",halfLife:321667e4,alphaDecay:"4.976",alphaDecayLikeliness:"99.74",ecDecay:"",ecDecayLikeliness:"0.26"},{id:"Po210",massNumber:210,exactMass:209.9828737,atomicNumber:84,spin:"0+",halfLife:11955700,alphaDecay:"5.407",alphaDecayLikeliness:"100.0"},{id:"Po211",massNumber:211,exactMass:210.9866532,atomicNumber:84,spin:"9/2+",halfLife:.516,alphaDecay:"7.594",alphaDecayLikeliness:"100.0"},{id:"Po212",massNumber:212,exactMass:211.988868,atomicNumber:84,spin:"0+",halfLife:2.99e-7,alphaDecay:"",alphaDecayLikeliness:"100.0"},{id:"Po213",massNumber:213,exactMass:212.992857,atomicNumber:84,halfLife:42e-7},{id:"Po214",massNumber:214,exactMass:213.9952014,atomicNumber:84,spin:"0+",halfLife:1643e-7},{id:"Po215",massNumber:215,exactMass:214.99942,atomicNumber:84,spin:"9/2+",halfLife:.001781,alphaDecay:"",alphaDecayLikeliness:"99.9998",betaminusDecay:"",betaminusDecayLikeliness:"0.0002"},{id:"Po216",massNumber:216,exactMass:216.001915,atomicNumber:84,halfLife:.145,alphaDecay:"6.906",alphaDecayLikeliness:"100.0"},{id:"Po217",massNumber:217,exactMass:217.006335,atomicNumber:84,halfLife:10},{id:"Po218",massNumber:218,exactMass:218.008973,atomicNumber:84,halfLife:186,alphaDecay:"6.114",alphaDecayLikeliness:"99.98",betaminusDecay:"",betaminusDecayLikeliness:"0.02"},{id:"Po219",massNumber:219,exactMass:219.01374,atomicNumber:84},{id:"Po220",massNumber:220,exactMass:220.0166,atomicNumber:84}]},{elementSymbol:"At",atomicNumber:85,isotopes:[{id:"At193",massNumber:193,exactMass:192.99984,atomicNumber:85,halfLife:.04},{id:"At194",massNumber:194,exactMass:193.99873,atomicNumber:85,halfLife:.04},{id:"At195",massNumber:195,exactMass:194.996268,atomicNumber:85,halfLife:.63},{id:"At196",massNumber:196,exactMass:195.99579,atomicNumber:85,halfLife:.253},{id:"At197",massNumber:197,exactMass:196.99319,atomicNumber:85,halfLife:.35},{id:"At198",massNumber:198,exactMass:197.99284,atomicNumber:85,halfLife:4.2},{id:"At199",massNumber:199,exactMass:198.99053,atomicNumber:85,halfLife:7.2},{id:"At200",massNumber:200,exactMass:199.990351,atomicNumber:85,halfLife:43},{id:"At201",massNumber:201,exactMass:200.988417,atomicNumber:85,halfLife:89},{id:"At202",massNumber:202,exactMass:201.98863,atomicNumber:85,halfLife:184},{id:"At203",massNumber:203,exactMass:202.986942,atomicNumber:85,halfLife:444},{id:"At204",massNumber:204,exactMass:203.987251,atomicNumber:85,halfLife:552},{id:"At205",massNumber:205,exactMass:204.986074,atomicNumber:85,halfLife:1572},{id:"At206",massNumber:206,exactMass:205.986667,atomicNumber:85,halfLife:1800},{id:"At207",massNumber:207,exactMass:206.985784,atomicNumber:85,halfLife:6480},{id:"At208",massNumber:208,exactMass:207.98659,atomicNumber:85,halfLife:5868},{id:"At209",massNumber:209,exactMass:208.986173,atomicNumber:85,spin:"9/2+",halfLife:19476},{id:"At210",massNumber:210,exactMass:209.987148,atomicNumber:85,spin:"5+",halfLife:29160,alphaDecay:"5.63",alphaDecayLikeliness:"0.18",ecDecay:"3.98",ecDecayLikeliness:"99.82"},{id:"At211",massNumber:211,exactMass:210.9874963,atomicNumber:85,spin:"9/2-",halfLife:25970.4,alphaDecay:"5.981",alphaDecayLikeliness:"41.7",ecDecay:"0.784",ecDecayLikeliness:"58.3"},{id:"At212",massNumber:212,exactMass:211.990745,atomicNumber:85,halfLife:.314},{id:"At213",massNumber:213,exactMass:212.992937,atomicNumber:85,halfLife:1.25e-7},{id:"At214",massNumber:214,exactMass:213.996372,atomicNumber:85,halfLife:5.58e-7},{id:"At215",massNumber:215,exactMass:214.998653,atomicNumber:85,halfLife:1e-4,alphaDecay:"",alphaDecayLikeliness:"100.0"},{id:"At216",massNumber:216,exactMass:216.002423,atomicNumber:85,halfLife:3e-4,alphaDecay:"",alphaDecayLikeliness:"100"},{id:"At217",massNumber:217,exactMass:217.004719,atomicNumber:85,halfLife:.0323},{id:"At218",massNumber:218,exactMass:218.008694,atomicNumber:85,halfLife:1.5,alphaDecay:"",alphaDecayLikeliness:"99.99",betaminusDecay:"",betaminusDecayLikeliness:"0.01"},{id:"At219",massNumber:219,exactMass:219.011162,atomicNumber:85,halfLife:56,alphaDecay:"",alphaDecayLikeliness:"99.9",betaminusDecay:"",betaminusDecayLikeliness:"0.1"},{id:"At220",massNumber:220,exactMass:220.01541,atomicNumber:85,halfLife:222.6},{id:"At221",massNumber:221,exactMass:221.01805,atomicNumber:85,halfLife:138},{id:"At222",massNumber:222,exactMass:222.02233,atomicNumber:85,halfLife:54},{id:"At223",massNumber:223,exactMass:223.02519,atomicNumber:85,halfLife:50}]},{elementSymbol:"Rn",atomicNumber:86,isotopes:[{id:"Rn195",massNumber:195,exactMass:195.00544,atomicNumber:86},{id:"Rn196",massNumber:196,exactMass:196.002115,atomicNumber:86,halfLife:.003},{id:"Rn197",massNumber:197,exactMass:197.00158,atomicNumber:86,halfLife:.065},{id:"Rn198",massNumber:198,exactMass:197.998679,atomicNumber:86,halfLife:.064},{id:"Rn199",massNumber:199,exactMass:198.99837,atomicNumber:86,halfLife:.62},{id:"Rn200",massNumber:200,exactMass:199.995699,atomicNumber:86,halfLife:.96},{id:"Rn201",massNumber:201,exactMass:200.99563,atomicNumber:86,halfLife:7},{id:"Rn202",massNumber:202,exactMass:201.993263,atomicNumber:86,halfLife:10},{id:"Rn203",massNumber:203,exactMass:202.993387,atomicNumber:86,halfLife:45},{id:"Rn204",massNumber:204,exactMass:203.991429,atomicNumber:86,halfLife:74.4},{id:"Rn205",massNumber:205,exactMass:204.99172,atomicNumber:86,halfLife:168},{id:"Rn206",massNumber:206,exactMass:205.990214,atomicNumber:86,halfLife:340.2},{id:"Rn207",massNumber:207,exactMass:206.990734,atomicNumber:86,halfLife:555},{id:"Rn208",massNumber:208,exactMass:207.989642,atomicNumber:86,halfLife:1461},{id:"Rn209",massNumber:209,exactMass:208.990415,atomicNumber:86,halfLife:1710},{id:"Rn210",massNumber:210,exactMass:209.989696,atomicNumber:86,halfLife:8640},{id:"Rn211",massNumber:211,exactMass:210.990601,atomicNumber:86,halfLife:52560},{id:"Rn212",massNumber:212,exactMass:211.990704,atomicNumber:86,halfLife:1434},{id:"Rn213",massNumber:213,exactMass:212.993883,atomicNumber:86,halfLife:.025},{id:"Rn214",massNumber:214,exactMass:213.995363,atomicNumber:86,halfLife:2.7e-7},{id:"Rn215",massNumber:215,exactMass:214.998745,atomicNumber:86,halfLife:23e-7},{id:"Rn216",massNumber:216,exactMass:216.000274,atomicNumber:86,halfLife:45e-6},{id:"Rn217",massNumber:217,exactMass:217.003928,atomicNumber:86,halfLife:54e-5},{id:"Rn218",massNumber:218,exactMass:218.0056013,atomicNumber:86,halfLife:.035},{id:"Rn219",massNumber:219,exactMass:219.0094802,atomicNumber:86,halfLife:3.96},{id:"Rn220",massNumber:220,exactMass:220.011394,atomicNumber:86,spin:"0+",halfLife:55.6},{id:"Rn221",massNumber:221,exactMass:221.015537,atomicNumber:86,halfLife:1500},{id:"Rn222",massNumber:222,exactMass:222.0175777,atomicNumber:86,spin:"0+",halfLife:330350},{id:"Rn223",massNumber:223,exactMass:223.02179,atomicNumber:86,halfLife:1392},{id:"Rn224",massNumber:224,exactMass:224.02409,atomicNumber:86,halfLife:6420},{id:"Rn225",massNumber:225,exactMass:225.02844,atomicNumber:86,halfLife:270},{id:"Rn226",massNumber:226,exactMass:226.03089,atomicNumber:86,halfLife:444},{id:"Rn227",massNumber:227,exactMass:227.03541,atomicNumber:86,halfLife:22.5},{id:"Rn228",massNumber:228,exactMass:228.03799,atomicNumber:86,halfLife:65}]},{elementSymbol:"Fr",atomicNumber:87,isotopes:[{id:"Fr199",massNumber:199,exactMass:199.00726,atomicNumber:87},{id:"Fr200",massNumber:200,exactMass:200.00657,atomicNumber:87,halfLife:.019},{id:"Fr201",massNumber:201,exactMass:201.00386,atomicNumber:87,halfLife:.048},{id:"Fr202",massNumber:202,exactMass:202.00337,atomicNumber:87,halfLife:.34},{id:"Fr203",massNumber:203,exactMass:203.000925,atomicNumber:87,halfLife:.55},{id:"Fr204",massNumber:204,exactMass:204.000653,atomicNumber:87,halfLife:1.7},{id:"Fr205",massNumber:205,exactMass:204.998594,atomicNumber:87,halfLife:3.85},{id:"Fr206",massNumber:206,exactMass:205.99867,atomicNumber:87,halfLife:15.9},{id:"Fr207",massNumber:207,exactMass:206.99695,atomicNumber:87,halfLife:14.8},{id:"Fr208",massNumber:208,exactMass:207.99714,atomicNumber:87,halfLife:59.1},{id:"Fr209",massNumber:209,exactMass:208.995954,atomicNumber:87,halfLife:50},{id:"Fr210",massNumber:210,exactMass:209.996408,atomicNumber:87,halfLife:190.8},{id:"Fr211",massNumber:211,exactMass:210.995537,atomicNumber:87,halfLife:186},{id:"Fr212",massNumber:212,exactMass:211.996202,atomicNumber:87,halfLife:1200},{id:"Fr213",massNumber:213,exactMass:212.996189,atomicNumber:87,halfLife:34.6},{id:"Fr214",massNumber:214,exactMass:213.998971,atomicNumber:87,halfLife:.005},{id:"Fr215",massNumber:215,exactMass:215.000341,atomicNumber:87,halfLife:8.6e-8},{id:"Fr216",massNumber:216,exactMass:216.003198,atomicNumber:87,halfLife:7e-7},{id:"Fr217",massNumber:217,exactMass:217.004632,atomicNumber:87,halfLife:22e-6},{id:"Fr218",massNumber:218,exactMass:218.007578,atomicNumber:87,halfLife:-1},{id:"Fr219",massNumber:219,exactMass:219.009252,atomicNumber:87,halfLife:.02},{id:"Fr220",massNumber:220,exactMass:220.012327,atomicNumber:87,halfLife:27.4},{id:"Fr221",massNumber:221,exactMass:221.014255,atomicNumber:87,halfLife:294},{id:"Fr222",massNumber:222,exactMass:222.017552,atomicNumber:87,halfLife:852},{id:"Fr223",massNumber:223,exactMass:223.0197359,atomicNumber:87,spin:"3/2+",halfLife:1308},{id:"Fr224",massNumber:224,exactMass:224.02325,atomicNumber:87,halfLife:199.8},{id:"Fr225",massNumber:225,exactMass:225.02557,atomicNumber:87,halfLife:240},{id:"Fr226",massNumber:226,exactMass:226.02939,atomicNumber:87,halfLife:49},{id:"Fr227",massNumber:227,exactMass:227.03184,atomicNumber:87,halfLife:148.2},{id:"Fr228",massNumber:228,exactMass:228.03573,atomicNumber:87,halfLife:38},{id:"Fr229",massNumber:229,exactMass:229.03845,atomicNumber:87,halfLife:50},{id:"Fr230",massNumber:230,exactMass:230.04251,atomicNumber:87,halfLife:19.1},{id:"Fr231",massNumber:231,exactMass:231.04544,atomicNumber:87,halfLife:17.5},{id:"Fr232",massNumber:232,exactMass:232.04977,atomicNumber:87,halfLife:5}]},{elementSymbol:"Ra",atomicNumber:88,isotopes:[{id:"Ra202",massNumber:202,exactMass:202.00989,atomicNumber:88,halfLife:7e-4},{id:"Ra203",massNumber:203,exactMass:203.00927,atomicNumber:88,halfLife:-1},{id:"Ra204",massNumber:204,exactMass:204.0065,atomicNumber:88,halfLife:.059},{id:"Ra205",massNumber:205,exactMass:205.00627,atomicNumber:88,halfLife:.21},{id:"Ra206",massNumber:206,exactMass:206.003827,atomicNumber:88,halfLife:.24},{id:"Ra207",massNumber:207,exactMass:207.0038,atomicNumber:88,halfLife:1.3},{id:"Ra208",massNumber:208,exactMass:208.00184,atomicNumber:88,halfLife:1.3},{id:"Ra209",massNumber:209,exactMass:209.00199,atomicNumber:88,halfLife:4.6},{id:"Ra210",massNumber:210,exactMass:210.000495,atomicNumber:88,halfLife:3.7},{id:"Ra211",massNumber:211,exactMass:211.000898,atomicNumber:88,halfLife:13},{id:"Ra212",massNumber:212,exactMass:211.999794,atomicNumber:88,halfLife:13},{id:"Ra213",massNumber:213,exactMass:213.000384,atomicNumber:88,halfLife:164.4},{id:"Ra214",massNumber:214,exactMass:214.000108,atomicNumber:88,halfLife:2.46},{id:"Ra215",massNumber:215,exactMass:215.00272,atomicNumber:88,halfLife:.00159},{id:"Ra216",massNumber:216,exactMass:216.003533,atomicNumber:88,halfLife:1.82e-7},{id:"Ra217",massNumber:217,exactMass:217.00632,atomicNumber:88,halfLife:16e-7},{id:"Ra218",massNumber:218,exactMass:218.00714,atomicNumber:88,halfLife:256e-7},{id:"Ra219",massNumber:219,exactMass:219.010085,atomicNumber:88,halfLife:.01},{id:"Ra220",massNumber:220,exactMass:220.011028,atomicNumber:88,halfLife:.018},{id:"Ra221",massNumber:221,exactMass:221.013917,atomicNumber:88,halfLife:28},{id:"Ra222",massNumber:222,exactMass:222.015375,atomicNumber:88,halfLife:38},{id:"Ra223",massNumber:223,exactMass:223.0185022,atomicNumber:88,spin:"1/2+",halfLife:987984},{id:"Ra224",massNumber:224,exactMass:224.0202118,atomicNumber:88,spin:"0+",halfLife:316224},{id:"Ra225",massNumber:225,exactMass:225.023612,atomicNumber:88,halfLife:1287360},{id:"Ra226",massNumber:226,exactMass:226.0254098,atomicNumber:88,spin:"0+",halfLife:504576e5},{id:"Ra227",massNumber:227,exactMass:227.0291778,atomicNumber:88,halfLife:2532},{id:"Ra228",massNumber:228,exactMass:228.0310703,atomicNumber:88,spin:"0+",halfLife:181332e3},{id:"Ra229",massNumber:229,exactMass:229.034958,atomicNumber:88,halfLife:240},{id:"Ra230",massNumber:230,exactMass:230.037056,atomicNumber:88,halfLife:5580},{id:"Ra231",massNumber:231,exactMass:231.04122,atomicNumber:88,halfLife:103},{id:"Ra232",massNumber:232,exactMass:232.04364,atomicNumber:88,halfLife:250},{id:"Ra233",massNumber:233,exactMass:233.04806,atomicNumber:88,halfLife:30},{id:"Ra234",massNumber:234,exactMass:234.0507,atomicNumber:88,halfLife:30}]},{elementSymbol:"Ac",atomicNumber:89,isotopes:[{id:"Ac206",massNumber:206,exactMass:206.0145,atomicNumber:89,halfLife:.022},{id:"Ac207",massNumber:207,exactMass:207.01195,atomicNumber:89,halfLife:.022},{id:"Ac208",massNumber:208,exactMass:208.01155,atomicNumber:89,halfLife:.095},{id:"Ac209",massNumber:209,exactMass:209.00949,atomicNumber:89,halfLife:.1},{id:"Ac210",massNumber:210,exactMass:210.00944,atomicNumber:89,halfLife:.35},{id:"Ac211",massNumber:211,exactMass:211.00773,atomicNumber:89,halfLife:.25},{id:"Ac212",massNumber:212,exactMass:212.00781,atomicNumber:89,halfLife:.93},{id:"Ac213",massNumber:213,exactMass:213.00661,atomicNumber:89,halfLife:.8},{id:"Ac214",massNumber:214,exactMass:214.006902,atomicNumber:89,halfLife:8.2},{id:"Ac215",massNumber:215,exactMass:215.006454,atomicNumber:89,halfLife:.17},{id:"Ac216",massNumber:216,exactMass:216.00872,atomicNumber:89,halfLife:33e-5},{id:"Ac217",massNumber:217,exactMass:217.009347,atomicNumber:89,halfLife:6.9e-8},{id:"Ac218",massNumber:218,exactMass:218.01164,atomicNumber:89,halfLife:108e-8},{id:"Ac219",massNumber:219,exactMass:219.01242,atomicNumber:89,halfLife:118e-7},{id:"Ac220",massNumber:220,exactMass:220.014763,atomicNumber:89,halfLife:.0264},{id:"Ac221",massNumber:221,exactMass:221.01559,atomicNumber:89,halfLife:.052},{id:"Ac222",massNumber:222,exactMass:222.017844,atomicNumber:89,halfLife:5},{id:"Ac223",massNumber:223,exactMass:223.019137,atomicNumber:89,halfLife:126},{id:"Ac224",massNumber:224,exactMass:224.021723,atomicNumber:89,halfLife:10008},{id:"Ac225",massNumber:225,exactMass:225.02323,atomicNumber:89,halfLife:864e3},{id:"Ac226",massNumber:226,exactMass:226.026098,atomicNumber:89,halfLife:105732},{id:"Ac227",massNumber:227,exactMass:227.0277521,atomicNumber:89,spin:"3/2+",halfLife:686633e3},{id:"Ac228",massNumber:228,exactMass:228.0310211,atomicNumber:89,halfLife:22140},{id:"Ac229",massNumber:229,exactMass:229.03302,atomicNumber:89,halfLife:3762},{id:"Ac230",massNumber:230,exactMass:230.03629,atomicNumber:89,halfLife:122},{id:"Ac231",massNumber:231,exactMass:231.03856,atomicNumber:89,halfLife:450},{id:"Ac232",massNumber:232,exactMass:232.04203,atomicNumber:89,halfLife:119},{id:"Ac233",massNumber:233,exactMass:233.04455,atomicNumber:89,halfLife:145},{id:"Ac234",massNumber:234,exactMass:234.04842,atomicNumber:89,halfLife:44},{id:"Ac235",massNumber:235,exactMass:235.05123,atomicNumber:89},{id:"Ac236",massNumber:236,exactMass:236.0553,atomicNumber:89}]},{elementSymbol:"Th",atomicNumber:90,isotopes:[{id:"Th209",massNumber:209,exactMass:209.01772,atomicNumber:90},{id:"Th210",massNumber:210,exactMass:210.015075,atomicNumber:90,halfLife:.009},{id:"Th211",massNumber:211,exactMass:211.01493,atomicNumber:90,halfLife:.037},{id:"Th212",massNumber:212,exactMass:212.01298,atomicNumber:90,halfLife:.03},{id:"Th213",massNumber:213,exactMass:213.01301,atomicNumber:90,halfLife:.14},{id:"Th214",massNumber:214,exactMass:214.0115,atomicNumber:90,halfLife:.1},{id:"Th215",massNumber:215,exactMass:215.01173,atomicNumber:90,halfLife:1.2},{id:"Th216",massNumber:216,exactMass:216.011062,atomicNumber:90,halfLife:.028},{id:"Th217",massNumber:217,exactMass:217.013114,atomicNumber:90,halfLife:252e-6},{id:"Th218",massNumber:218,exactMass:218.013284,atomicNumber:90,halfLife:1.09e-7},{id:"Th219",massNumber:219,exactMass:219.01554,atomicNumber:90,halfLife:105e-8},{id:"Th220",massNumber:220,exactMass:220.015748,atomicNumber:90,halfLife:97e-7},{id:"Th221",massNumber:221,exactMass:221.018184,atomicNumber:90,halfLife:.00168},{id:"Th222",massNumber:222,exactMass:222.018468,atomicNumber:90,halfLife:.0028},{id:"Th223",massNumber:223,exactMass:223.020811,atomicNumber:90,halfLife:.6},{id:"Th224",massNumber:224,exactMass:224.021467,atomicNumber:90,halfLife:1.05},{id:"Th225",massNumber:225,exactMass:225.023951,atomicNumber:90,halfLife:523.2},{id:"Th226",massNumber:226,exactMass:226.024903,atomicNumber:90,halfLife:1834.2},{id:"Th227",massNumber:227,exactMass:227.0277041,atomicNumber:90,spin:"3/2+",halfLife:1617410,alphaDecay:"6.145",alphaDecayLikeliness:"100.0"},{id:"Th228",massNumber:228,exactMass:228.0287411,atomicNumber:90,spin:"0+",halfLife:60284200,alphaDecay:"5.52",alphaDecayLikeliness:"100.0"},{id:"Th229",massNumber:229,exactMass:229.031762,atomicNumber:90,magneticMoment:"+0.46",halfLife:231474e6,alphaDecay:"5.17",alphaDecayLikeliness:"100.0"},{id:"Th230",massNumber:230,exactMass:230.0331338,atomicNumber:90,spin:"0+",halfLife:75380,alphaDecay:"4.77",alphaDecayLikeliness:"100.0"},{id:"Th231",massNumber:231,exactMass:231.0363043,atomicNumber:90,spin:"5/2+",halfLife:91872,betaminusDecay:"0.389",betaminusDecayLikeliness:"100.0"},{id:"Th232",massNumber:232,relativeAbundance:1,atomicNumber:90,exactMass:232.0380553,spin:"0+",halfLife:14e9,alphaDecay:"4.081",alphaDecayLikeliness:"100.0"},{id:"Th233",massNumber:233,exactMass:233.0415818,atomicNumber:90,halfLife:1338},{id:"Th234",massNumber:234,exactMass:234.043601,atomicNumber:90,spin:"0+",halfLife:2082240,betaminusDecay:"0.27",betaminusDecayLikeliness:"100.0"},{id:"Th235",massNumber:235,exactMass:235.04751,atomicNumber:90,halfLife:426},{id:"Th236",massNumber:236,exactMass:236.04987,atomicNumber:90,halfLife:2250},{id:"Th237",massNumber:237,exactMass:237.05389,atomicNumber:90,halfLife:300},{id:"Th238",massNumber:238,exactMass:238.0565,atomicNumber:90}]},{elementSymbol:"Pa",atomicNumber:91,isotopes:[{id:"Pa212",massNumber:212,exactMass:212.0232,atomicNumber:91,halfLife:.0051},{id:"Pa213",massNumber:213,exactMass:213.02111,atomicNumber:91,halfLife:.0053},{id:"Pa214",massNumber:214,exactMass:214.02092,atomicNumber:91,halfLife:.017},{id:"Pa215",massNumber:215,exactMass:215.01919,atomicNumber:91,halfLife:.014},{id:"Pa216",massNumber:216,exactMass:216.01911,atomicNumber:91,halfLife:.2},{id:"Pa217",massNumber:217,exactMass:217.01832,atomicNumber:91,halfLife:.0049},{id:"Pa218",massNumber:218,exactMass:218.020042,atomicNumber:91,halfLife:12e-5},{id:"Pa219",massNumber:219,exactMass:219.01988,atomicNumber:91,halfLife:5.3e-8},{id:"Pa220",massNumber:220,exactMass:220.02188,atomicNumber:91,halfLife:7.8e-7},{id:"Pa221",massNumber:221,exactMass:221.02188,atomicNumber:91,halfLife:59e-7},{id:"Pa222",massNumber:222,exactMass:222.02374,atomicNumber:91,halfLife:.0029},{id:"Pa223",massNumber:223,exactMass:223.02396,atomicNumber:91,halfLife:.0065},{id:"Pa224",massNumber:224,exactMass:224.025626,atomicNumber:91,halfLife:.79},{id:"Pa225",massNumber:225,exactMass:225.02613,atomicNumber:91,halfLife:1.7},{id:"Pa226",massNumber:226,exactMass:226.027948,atomicNumber:91,halfLife:108},{id:"Pa227",massNumber:227,exactMass:227.028805,atomicNumber:91,halfLife:2298},{id:"Pa228",massNumber:228,exactMass:228.031051,atomicNumber:91,halfLife:79200},{id:"Pa229",massNumber:229,exactMass:229.0320968,atomicNumber:91,halfLife:129600},{id:"Pa230",massNumber:230,exactMass:230.034541,atomicNumber:91,halfLife:1503360},{id:"Pa231",massNumber:231,relativeAbundance:1,atomicNumber:91,exactMass:231.035884,spin:"3/2-",magneticMoment:"2.01",halfLife:103312e7,alphaDecay:"5.148",alphaDecayLikeliness:"100.0"},{id:"Pa232",massNumber:232,exactMass:232.038592,atomicNumber:91,magneticMoment:"+3.5",halfLife:113184,betaminusDecay:"1.34",betaminusDecayLikeliness:"100.0"},{id:"Pa233",massNumber:233,exactMass:233.0402473,atomicNumber:91,magneticMoment:"+3.5",halfLife:2329950,betaminusDecay:"0.572",betaminusDecayLikeliness:"100.0"},{id:"Pa234",massNumber:234,exactMass:234.043308,atomicNumber:91,spin:"4+",halfLife:24120},{id:"Pa235",massNumber:235,exactMass:235.04544,atomicNumber:91,halfLife:1470},{id:"Pa236",massNumber:236,exactMass:236.04868,atomicNumber:91,halfLife:546},{id:"Pa237",massNumber:237,exactMass:237.05115,atomicNumber:91,halfLife:522},{id:"Pa238",massNumber:238,exactMass:238.0545,atomicNumber:91,halfLife:138},{id:"Pa239",massNumber:239,exactMass:239.05726,atomicNumber:91},{id:"Pa240",massNumber:240,exactMass:240.06098,atomicNumber:91}]},{elementSymbol:"U",atomicNumber:92,isotopes:[{id:"U217",massNumber:217,exactMass:217.02437,atomicNumber:92},{id:"U218",massNumber:218,exactMass:218.02354,atomicNumber:92,halfLife:.0015},{id:"U219",massNumber:219,exactMass:219.02492,atomicNumber:92,halfLife:42e-6},{id:"U220",massNumber:220,exactMass:220.02472,atomicNumber:92},{id:"U221",massNumber:221,exactMass:221.0264,atomicNumber:92},{id:"U222",massNumber:222,exactMass:222.02609,atomicNumber:92,halfLife:-1},{id:"U223",massNumber:223,exactMass:223.02774,atomicNumber:92,halfLife:18e-6},{id:"U224",massNumber:224,exactMass:224.027605,atomicNumber:92,halfLife:9e-4},{id:"U225",massNumber:225,exactMass:225.029391,atomicNumber:92,halfLife:.095},{id:"U226",massNumber:226,exactMass:226.029339,atomicNumber:92,halfLife:.35},{id:"U227",massNumber:227,exactMass:227.031156,atomicNumber:92,halfLife:66},{id:"U228",massNumber:228,exactMass:228.031374,atomicNumber:92,halfLife:546},{id:"U229",massNumber:229,exactMass:229.033506,atomicNumber:92,halfLife:3480},{id:"U230",massNumber:230,exactMass:230.03394,atomicNumber:92,halfLife:1797120},{id:"U231",massNumber:231,exactMass:231.036294,atomicNumber:92,halfLife:362880},{id:"U232",massNumber:232,exactMass:232.0371562,atomicNumber:92,halfLife:217283e4,alphaDecay:"5.41",alphaDecayLikeliness:"100.0"},{id:"U233",massNumber:233,exactMass:233.0396352,atomicNumber:92,magneticMoment:"+0.55",halfLife:159200,alphaDecay:"4.91",alphaDecayLikeliness:"100.0"},{id:"U234",massNumber:234,relativeAbundance:54999999999999995e-21,atomicNumber:92,exactMass:234.0409521,spin:"0+",halfLife:245e3,alphaDecay:"4.856",alphaDecayLikeliness:"100.0"},{id:"U235",massNumber:235,relativeAbundance:.0072,atomicNumber:92,exactMass:235.0439299,spin:"7/2-",magneticMoment:"-0.35",halfLife:7038e5,alphaDecay:"4.6793",alphaDecayLikeliness:"100.0"},{id:"U236",massNumber:236,exactMass:236.045568,atomicNumber:92,halfLife:23415e3,alphaDecay:"4.569",alphaDecayLikeliness:"100.0"},{id:"U237",massNumber:237,exactMass:237.0487302,atomicNumber:92,halfLife:583200,betaminusDecay:"0.52",betaminusDecayLikeliness:"100.0"},{id:"U238",massNumber:238,relativeAbundance:.992745,atomicNumber:92,exactMass:238.0507882,spin:"0+",halfLife:4468e6,alphaDecay:"4.039",alphaDecayLikeliness:"100.0"},{id:"U239",massNumber:239,exactMass:239.0542933,atomicNumber:92,halfLife:1407},{id:"U240",massNumber:240,exactMass:240.056592,atomicNumber:92,halfLife:50760,betaminusDecay:"0.5",betaminusDecayLikeliness:"100.0"},{id:"U241",massNumber:241,exactMass:241.06033,atomicNumber:92},{id:"U242",massNumber:242,exactMass:242.06293,atomicNumber:92,halfLife:1008}]},{elementSymbol:"Np",atomicNumber:93,isotopes:[{id:"Np225",massNumber:225,exactMass:225.03391,atomicNumber:93,halfLife:.006},{id:"Np226",massNumber:226,exactMass:226.03515,atomicNumber:93,halfLife:.035},{id:"Np227",massNumber:227,exactMass:227.03496,atomicNumber:93,halfLife:.51},{id:"Np228",massNumber:228,exactMass:228.03618,atomicNumber:93,halfLife:61.4},{id:"Np229",massNumber:229,exactMass:229.03626,atomicNumber:93,halfLife:240},{id:"Np230",massNumber:230,exactMass:230.03783,atomicNumber:93,halfLife:276},{id:"Np231",massNumber:231,exactMass:231.03825,atomicNumber:93,halfLife:2928},{id:"Np232",massNumber:232,exactMass:232.04011,atomicNumber:93,halfLife:882},{id:"Np233",massNumber:233,exactMass:233.04074,atomicNumber:93,halfLife:2172},{id:"Np234",massNumber:234,exactMass:234.042895,atomicNumber:93,halfLife:380160},{id:"Np235",massNumber:235,exactMass:235.0440633,atomicNumber:93,halfLife:34223e3},{id:"Np236",massNumber:236,exactMass:236.04657,atomicNumber:93},{id:"Np237",massNumber:237,exactMass:237.0481734,atomicNumber:93,spin:"5/2+",halfLife:214e4,alphaDecay:"4.96",alphaDecayLikeliness:"100.0"},{id:"Np238",massNumber:238,exactMass:238.0509464,atomicNumber:93,halfLife:182909,betaminusDecay:"1.29",betaminusDecayLikeliness:"100.0"},{id:"Np239",massNumber:239,exactMass:239.052939,atomicNumber:93,halfLife:203602,betaminusDecay:"0.72",betaminusDecayLikeliness:"100.0"},{id:"Np240",massNumber:240,exactMass:240.056162,atomicNumber:93,halfLife:3714},{id:"Np241",massNumber:241,exactMass:241.05825,atomicNumber:93,halfLife:834},{id:"Np242",massNumber:242,exactMass:242.06164,atomicNumber:93,halfLife:330},{id:"Np243",massNumber:243,exactMass:243.06428,atomicNumber:93,halfLife:108},{id:"Np244",massNumber:244,exactMass:244.06785,atomicNumber:93,halfLife:137.4}]},{elementSymbol:"Pu",atomicNumber:94,isotopes:[{id:"Pu228",massNumber:228,exactMass:228.03874,atomicNumber:94,halfLife:.004},{id:"Pu229",massNumber:229,exactMass:229.04015,atomicNumber:94},{id:"Pu230",massNumber:230,exactMass:230.03965,atomicNumber:94},{id:"Pu231",massNumber:231,exactMass:231.041101,atomicNumber:94},{id:"Pu232",massNumber:232,exactMass:232.041187,atomicNumber:94,halfLife:2046},{id:"Pu233",massNumber:233,exactMass:233.043,atomicNumber:94,halfLife:1254},{id:"Pu234",massNumber:234,exactMass:234.043317,atomicNumber:94,halfLife:31680},{id:"Pu235",massNumber:235,exactMass:235.045286,atomicNumber:94,halfLife:1518},{id:"Pu236",massNumber:236,exactMass:236.046058,atomicNumber:94,halfLife:90129900,alphaDecay:"5.87",alphaDecayLikeliness:"100.0"},{id:"Pu237",massNumber:237,exactMass:237.0484097,atomicNumber:94,halfLife:3905280,alphaDecay:"",alphaDecayLikeliness:"0.004",ecDecay:"0.22",ecDecayLikeliness:"99.996"},{id:"Pu238",massNumber:238,exactMass:238.0495599,atomicNumber:94,halfLife:276571e4,alphaDecay:"5.59",alphaDecayLikeliness:"100.0"},{id:"Pu239",massNumber:239,exactMass:239.0521634,atomicNumber:94,spin:"1/2+",magneticMoment:"+0.203",halfLife:760333e6,alphaDecay:"5.24",alphaDecayLikeliness:"100.0"},{id:"Pu240",massNumber:240,exactMass:240.0538135,atomicNumber:94,spin:"0+",halfLife:206971e6,alphaDecay:"5.26",alphaDecayLikeliness:"100.0"},{id:"Pu241",massNumber:241,exactMass:241.0568515,atomicNumber:94,magneticMoment:"-0.683",halfLife:452542e3,betaminusDecay:"0.02",betaminusDecayLikeliness:"100.0"},{id:"Pu242",massNumber:242,exactMass:242.0587426,atomicNumber:94,spin:"0+",halfLife:373300,alphaDecay:"4.983",alphaDecayLikeliness:"100.0"},{id:"Pu243",massNumber:243,exactMass:243.062003,atomicNumber:94,halfLife:17841.6},{id:"Pu244",massNumber:244,exactMass:244.064204,atomicNumber:94},{id:"Pu245",massNumber:245,exactMass:245.067747,atomicNumber:94,halfLife:37800},{id:"Pu246",massNumber:246,exactMass:246.070205,atomicNumber:94,halfLife:936576},{id:"Pu247",massNumber:247,exactMass:247.07407,atomicNumber:94,halfLife:196128}]},{elementSymbol:"Am",atomicNumber:95,isotopes:[{id:"Am231",massNumber:231,exactMass:231.04556,atomicNumber:95},{id:"Am232",massNumber:232,exactMass:232.04659,atomicNumber:95,halfLife:79},{id:"Am233",massNumber:233,exactMass:233.04635,atomicNumber:95},{id:"Am234",massNumber:234,exactMass:234.04781,atomicNumber:95,halfLife:139.2},{id:"Am235",massNumber:235,exactMass:235.04795,atomicNumber:95,halfLife:900},{id:"Am236",massNumber:236,exactMass:236.04958,atomicNumber:95},{id:"Am237",massNumber:237,exactMass:237.05,atomicNumber:95,halfLife:4380},{id:"Am238",massNumber:238,exactMass:238.05198,atomicNumber:95,halfLife:5880},{id:"Am239",massNumber:239,exactMass:239.0530245,atomicNumber:95,halfLife:42840},{id:"Am240",massNumber:240,exactMass:240.0553,atomicNumber:95,halfLife:182880},{id:"Am241",massNumber:241,exactMass:241.0568291,atomicNumber:95,spin:"5/2-",magneticMoment:"+1.61",halfLife:136299e5,alphaDecay:"5.637",alphaDecayLikeliness:"100.0"},{id:"Am242",massNumber:242,exactMass:242.0595492,atomicNumber:95,halfLife:57672,betaminusDecay:"0.67",betaminusDecayLikeliness:"82.7",ecDecay:"0.73",ecDecayLikeliness:"17.3"},{id:"Am243",massNumber:243,exactMass:243.0613811,atomicNumber:95,spin:"5/2-",halfLife:23242e7,alphaDecay:"5.439",alphaDecayLikeliness:"100.0"},{id:"Am244",massNumber:244,exactMass:244.0642848,atomicNumber:95,halfLife:36360},{id:"Am245",massNumber:245,exactMass:245.066452,atomicNumber:95,halfLife:7380},{id:"Am246",massNumber:246,exactMass:246.069775,atomicNumber:95,halfLife:2340},{id:"Am247",massNumber:247,exactMass:247.07209,atomicNumber:95,halfLife:1380},{id:"Am248",massNumber:248,exactMass:248.07575,atomicNumber:95},{id:"Am249",massNumber:249,exactMass:249.07848,atomicNumber:95}]},{elementSymbol:"Cm",atomicNumber:96,isotopes:[{id:"Cm233",massNumber:233,exactMass:233.05077,atomicNumber:96},{id:"Cm234",massNumber:234,exactMass:234.05016,atomicNumber:96},{id:"Cm235",massNumber:235,exactMass:235.05143,atomicNumber:96},{id:"Cm236",massNumber:236,exactMass:236.05141,atomicNumber:96},{id:"Cm237",massNumber:237,exactMass:237.0529,atomicNumber:96},{id:"Cm238",massNumber:238,exactMass:238.05303,atomicNumber:96,halfLife:8640},{id:"Cm239",massNumber:239,exactMass:239.05496,atomicNumber:96,halfLife:10440},{id:"Cm240",massNumber:240,exactMass:240.0555295,atomicNumber:96,halfLife:2332800},{id:"Cm241",massNumber:241,exactMass:241.057653,atomicNumber:96,halfLife:2833920},{id:"Cm242",massNumber:242,exactMass:242.0588358,atomicNumber:96,halfLife:14065900},{id:"Cm243",massNumber:243,exactMass:243.0613891,atomicNumber:96,halfLife:917698e3},{id:"Cm244",massNumber:244,exactMass:244.0627526,atomicNumber:96,halfLife:570802e3},{id:"Cm245",massNumber:245,exactMass:245.0654912,atomicNumber:96,spin:"7/2+",halfLife:268056e6},{id:"Cm246",massNumber:246,exactMass:246.0672237,atomicNumber:96,spin:"0+",halfLife:149165e6},{id:"Cm247",massNumber:247,exactMass:247.070354,atomicNumber:96},{id:"Cm248",massNumber:248,exactMass:248.072349,atomicNumber:96,spin:"0+"},{id:"Cm249",massNumber:249,exactMass:249.075953,atomicNumber:96,halfLife:3849},{id:"Cm250",massNumber:250,exactMass:250.078357,atomicNumber:96,halfLife:283824e6},{id:"Cm251",massNumber:251,exactMass:251.082285,atomicNumber:96,halfLife:1008},{id:"Cm252",massNumber:252,exactMass:252.08487,atomicNumber:96}]},{elementSymbol:"Bk",atomicNumber:97,isotopes:[{id:"Bk235",massNumber:235,exactMass:235.05658,atomicNumber:97},{id:"Bk236",massNumber:236,exactMass:236.05733,atomicNumber:97},{id:"Bk237",massNumber:237,exactMass:237.057,atomicNumber:97},{id:"Bk238",massNumber:238,exactMass:238.05828,atomicNumber:97,halfLife:144},{id:"Bk239",massNumber:239,exactMass:239.05828,atomicNumber:97},{id:"Bk240",massNumber:240,exactMass:240.05976,atomicNumber:97,halfLife:288},{id:"Bk241",massNumber:241,exactMass:241.06023,atomicNumber:97},{id:"Bk242",massNumber:242,exactMass:242.06198,atomicNumber:97,halfLife:420},{id:"Bk243",massNumber:243,exactMass:243.063008,atomicNumber:97,halfLife:16200},{id:"Bk244",massNumber:244,exactMass:244.065181,atomicNumber:97,halfLife:15660},{id:"Bk245",massNumber:245,exactMass:245.0663616,atomicNumber:97,halfLife:426816},{id:"Bk246",massNumber:246,exactMass:246.06867,atomicNumber:97,halfLife:155520},{id:"Bk247",massNumber:247,exactMass:247.070307,atomicNumber:97,halfLife:435197e5},{id:"Bk248",massNumber:248,exactMass:248.07309,atomicNumber:97,halfLife:283824e3},{id:"Bk249",massNumber:249,exactMass:249.0749867,atomicNumber:97,spin:"7/2+",halfLife:27648e3},{id:"Bk250",massNumber:250,exactMass:250.078317,atomicNumber:97,halfLife:11581.2},{id:"Bk251",massNumber:251,exactMass:251.08076,atomicNumber:97,halfLife:3336},{id:"Bk252",massNumber:252,exactMass:252.08431,atomicNumber:97},{id:"Bk253",massNumber:253,exactMass:253.08688,atomicNumber:97},{id:"Bk254",massNumber:254,exactMass:254.0906,atomicNumber:97}]},{elementSymbol:"Cf",atomicNumber:98,isotopes:[{id:"Cf237",massNumber:237,exactMass:237.06207,atomicNumber:98,halfLife:2.1},{id:"Cf238",massNumber:238,exactMass:238.06141,atomicNumber:98,halfLife:.021},{id:"Cf239",massNumber:239,exactMass:239.06242,atomicNumber:98,halfLife:39},{id:"Cf240",massNumber:240,exactMass:240.0623,atomicNumber:98,halfLife:63.6},{id:"Cf241",massNumber:241,exactMass:241.06373,atomicNumber:98,halfLife:226.8},{id:"Cf242",massNumber:242,exactMass:242.0637,atomicNumber:98,halfLife:209.4},{id:"Cf243",massNumber:243,exactMass:243.06543,atomicNumber:98,halfLife:642},{id:"Cf244",massNumber:244,exactMass:244.066001,atomicNumber:98,halfLife:1164},{id:"Cf245",massNumber:245,exactMass:245.068049,atomicNumber:98,halfLife:2700},{id:"Cf246",massNumber:246,exactMass:246.0688053,atomicNumber:98,halfLife:128520},{id:"Cf247",massNumber:247,exactMass:247.071001,atomicNumber:98,halfLife:11196},{id:"Cf248",massNumber:248,exactMass:248.072185,atomicNumber:98,halfLife:28814400},{id:"Cf249",massNumber:249,exactMass:249.0748535,atomicNumber:98,spin:"9/2-",halfLife:110691e5},{id:"Cf250",massNumber:250,exactMass:250.0764061,atomicNumber:98,spin:"0+",halfLife:412491e3},{id:"Cf251",massNumber:251,exactMass:251.079587,atomicNumber:98,spin:"1/2+",halfLife:283193e5},{id:"Cf252",massNumber:252,exactMass:252.081626,atomicNumber:98,spin:"0+",halfLife:83412700},{id:"Cf253",massNumber:253,exactMass:253.085133,atomicNumber:98,halfLife:1538780},{id:"Cf254",massNumber:254,exactMass:254.087323,atomicNumber:98,halfLife:5227200},{id:"Cf255",massNumber:255,exactMass:255.09105,atomicNumber:98,halfLife:5100},{id:"Cf256",massNumber:256,exactMass:256.09344,atomicNumber:98,halfLife:738}]},{elementSymbol:"Es",atomicNumber:99,isotopes:[{id:"Es240",massNumber:240,exactMass:240.06892,atomicNumber:99},{id:"Es241",massNumber:241,exactMass:241.06854,atomicNumber:99,halfLife:9},{id:"Es242",massNumber:242,exactMass:242.06975,atomicNumber:99,halfLife:40},{id:"Es243",massNumber:243,exactMass:243.06955,atomicNumber:99,halfLife:21},{id:"Es244",massNumber:244,exactMass:244.07088,atomicNumber:99,halfLife:37},{id:"Es245",massNumber:245,exactMass:245.07132,atomicNumber:99,halfLife:66},{id:"Es246",massNumber:246,exactMass:246.0729,atomicNumber:99,halfLife:462},{id:"Es247",massNumber:247,exactMass:247.07366,atomicNumber:99,halfLife:273},{id:"Es248",massNumber:248,exactMass:248.07547,atomicNumber:99,halfLife:1620},{id:"Es249",massNumber:249,exactMass:249.07641,atomicNumber:99,halfLife:6132},{id:"Es250",massNumber:250,exactMass:250.07861,atomicNumber:99,halfLife:30960},{id:"Es251",massNumber:251,exactMass:251.079992,atomicNumber:99,halfLife:118800},{id:"Es252",massNumber:252,exactMass:252.08298,atomicNumber:99,halfLife:40754900},{id:"Es253",massNumber:253,exactMass:253.0848247,atomicNumber:99,spin:"7/2+",halfLife:1768610},{id:"Es254",massNumber:254,exactMass:254.088022,atomicNumber:99,halfLife:23820500},{id:"Es255",massNumber:255,exactMass:255.090273,atomicNumber:99,halfLife:3438720},{id:"Es256",massNumber:256,exactMass:256.0936,atomicNumber:99,halfLife:1524},{id:"Es257",massNumber:257,exactMass:257.09598,atomicNumber:99},{id:"Es258",massNumber:258,exactMass:258.09952,atomicNumber:99}]},{elementSymbol:"Fm",atomicNumber:100,isotopes:[{id:"Fm242",massNumber:242,exactMass:242.07343,atomicNumber:100,halfLife:8e-4},{id:"Fm243",massNumber:243,exactMass:243.07435,atomicNumber:100,halfLife:.18},{id:"Fm244",massNumber:244,exactMass:244.07408,atomicNumber:100,halfLife:.0033},{id:"Fm245",massNumber:245,exactMass:245.07539,atomicNumber:100,halfLife:4.2},{id:"Fm246",massNumber:246,exactMass:246.0753,atomicNumber:100,halfLife:1.1},{id:"Fm247",massNumber:247,exactMass:247.07685,atomicNumber:100,halfLife:35},{id:"Fm248",massNumber:248,exactMass:248.077195,atomicNumber:100,halfLife:36},{id:"Fm249",massNumber:249,exactMass:249.07903,atomicNumber:100,halfLife:156},{id:"Fm250",massNumber:250,exactMass:250.079521,atomicNumber:100,halfLife:1800},{id:"Fm251",massNumber:251,exactMass:251.081575,atomicNumber:100,halfLife:19080},{id:"Fm252",massNumber:252,exactMass:252.082467,atomicNumber:100,spin:"0+",halfLife:91404},{id:"Fm253",massNumber:253,exactMass:253.085185,atomicNumber:100,halfLife:259200},{id:"Fm254",massNumber:254,exactMass:254.0868542,atomicNumber:100,halfLife:11664},{id:"Fm255",massNumber:255,exactMass:255.089962,atomicNumber:100,halfLife:72252},{id:"Fm256",massNumber:256,exactMass:256.091773,atomicNumber:100,halfLife:9456},{id:"Fm257",massNumber:257,exactMass:257.095105,atomicNumber:100,halfLife:8683200},{id:"Fm258",massNumber:258,exactMass:258.09708,atomicNumber:100,halfLife:37e-5},{id:"Fm259",massNumber:259,exactMass:259.1006,atomicNumber:100,halfLife:1.5},{id:"Fm260",massNumber:260,exactMass:260.10268,atomicNumber:100}]},{elementSymbol:"Md",atomicNumber:101,isotopes:[{id:"Md245",massNumber:245,exactMass:245.08083,atomicNumber:101,halfLife:.35},{id:"Md246",massNumber:246,exactMass:246.08189,atomicNumber:101,halfLife:-1},{id:"Md247",massNumber:247,exactMass:247.08164,atomicNumber:101,halfLife:1.12},{id:"Md248",massNumber:248,exactMass:248.08282,atomicNumber:101,halfLife:7},{id:"Md249",massNumber:249,exactMass:249.08301,atomicNumber:101,halfLife:24},{id:"Md250",massNumber:250,exactMass:250.08442,atomicNumber:101,halfLife:52},{id:"Md251",massNumber:251,exactMass:251.08484,atomicNumber:101,halfLife:240},{id:"Md252",massNumber:252,exactMass:252.08656,atomicNumber:101,halfLife:138},{id:"Md253",massNumber:253,exactMass:253.08728,atomicNumber:101,halfLife:360},{id:"Md254",massNumber:254,exactMass:254.08966,atomicNumber:101,halfLife:600},{id:"Md255",massNumber:255,exactMass:255.091083,atomicNumber:101,halfLife:1620},{id:"Md256",massNumber:256,exactMass:256.09406,atomicNumber:101,halfLife:4686},{id:"Md257",massNumber:257,exactMass:257.095541,atomicNumber:101,halfLife:19872},{id:"Md258",massNumber:258,exactMass:258.098431,atomicNumber:101,halfLife:4449600},{id:"Md259",massNumber:259,exactMass:259.10051,atomicNumber:101,halfLife:5760},{id:"Md260",massNumber:260,exactMass:260.10365,atomicNumber:101,halfLife:2747520},{id:"Md261",massNumber:261,exactMass:261.10572,atomicNumber:101},{id:"Md262",massNumber:262,exactMass:262.10887,atomicNumber:101}]},{elementSymbol:"No",atomicNumber:102,isotopes:[{id:"No248",massNumber:248,exactMass:248.0866,atomicNumber:102},{id:"No249",massNumber:249,exactMass:249.08783,atomicNumber:102},{id:"No250",massNumber:250,exactMass:250.08751,atomicNumber:102,halfLife:25e-5},{id:"No251",massNumber:251,exactMass:251.08901,atomicNumber:102,halfLife:.8},{id:"No252",massNumber:252,exactMass:252.088977,atomicNumber:102,halfLife:2.3},{id:"No253",massNumber:253,exactMass:253.09068,atomicNumber:102,halfLife:102},{id:"No254",massNumber:254,exactMass:254.090955,atomicNumber:102,halfLife:55},{id:"No255",massNumber:255,exactMass:255.093241,atomicNumber:102,halfLife:186},{id:"No256",massNumber:256,exactMass:256.094283,atomicNumber:102,halfLife:2.91},{id:"No257",massNumber:257,exactMass:257.096877,atomicNumber:102,halfLife:25},{id:"No258",massNumber:258,exactMass:258.09821,atomicNumber:102,halfLife:.0012},{id:"No259",massNumber:259,exactMass:259.10103,atomicNumber:102,halfLife:3480},{id:"No260",massNumber:260,exactMass:260.10264,atomicNumber:102,halfLife:.106},{id:"No261",massNumber:261,exactMass:261.10575,atomicNumber:102},{id:"No262",massNumber:262,exactMass:262.1073,atomicNumber:102,halfLife:.005},{id:"No263",massNumber:263,exactMass:263.11055,atomicNumber:102},{id:"No264",massNumber:264,exactMass:264.11235,atomicNumber:102}]},{elementSymbol:"Lr",atomicNumber:103,isotopes:[{id:"Lr251",massNumber:251,exactMass:251.09436,atomicNumber:103},{id:"Lr252",massNumber:252,exactMass:252.09537,atomicNumber:103},{id:"Lr253",massNumber:253,exactMass:253.09521,atomicNumber:103,halfLife:1.3},{id:"Lr254",massNumber:254,exactMass:254.09645,atomicNumber:103,halfLife:13},{id:"Lr255",massNumber:255,exactMass:255.09668,atomicNumber:103,halfLife:22},{id:"Lr256",massNumber:256,exactMass:256.09863,atomicNumber:103,halfLife:28},{id:"Lr257",massNumber:257,exactMass:257.09956,atomicNumber:103,halfLife:.646},{id:"Lr258",massNumber:258,exactMass:258.10181,atomicNumber:103,halfLife:3.9},{id:"Lr259",massNumber:259,exactMass:259.1029,atomicNumber:103,halfLife:6.3},{id:"Lr260",massNumber:260,exactMass:260.1055,atomicNumber:103,halfLife:180},{id:"Lr261",massNumber:261,exactMass:261.10688,atomicNumber:103,halfLife:2340},{id:"Lr262",massNumber:262,exactMass:262.10963,atomicNumber:103,halfLife:12960},{id:"Lr263",massNumber:263,exactMass:263.11129,atomicNumber:103},{id:"Lr264",massNumber:264,exactMass:264.11404,atomicNumber:103},{id:"Lr265",massNumber:265,exactMass:265.11584,atomicNumber:103},{id:"Lr266",massNumber:266,exactMass:266.11931,atomicNumber:103}]},{elementSymbol:"Rf",atomicNumber:104,isotopes:[{id:"Rf253",massNumber:253,exactMass:253.10069,atomicNumber:104,halfLife:1.8},{id:"Rf254",massNumber:254,exactMass:254.10018,atomicNumber:104,halfLife:5e-4},{id:"Rf255",massNumber:255,exactMass:255.10134,atomicNumber:104,halfLife:1.5},{id:"Rf256",massNumber:256,exactMass:256.101166,atomicNumber:104,halfLife:.0067},{id:"Rf257",massNumber:257,exactMass:257.10299,atomicNumber:104,halfLife:4.7},{id:"Rf258",massNumber:258,exactMass:258.10349,atomicNumber:104,halfLife:.012},{id:"Rf259",massNumber:259,exactMass:259.10564,atomicNumber:104,halfLife:3.1},{id:"Rf260",massNumber:260,exactMass:260.10644,atomicNumber:104,halfLife:.0201},{id:"Rf261",massNumber:261,exactMass:261.10877,atomicNumber:104,halfLife:65},{id:"Rf262",massNumber:262,exactMass:262.10993,atomicNumber:104,halfLife:2.1},{id:"Rf263",massNumber:263,exactMass:263.11255,atomicNumber:104},{id:"Rf264",massNumber:264,exactMass:264.11399,atomicNumber:104},{id:"Rf265",massNumber:265,exactMass:265.1167,atomicNumber:104},{id:"Rf266",massNumber:266,exactMass:266.11796,atomicNumber:104},{id:"Rf267",massNumber:267,exactMass:267.12153,atomicNumber:104},{id:"Rf268",massNumber:268,exactMass:268.12364,atomicNumber:104}]},{elementSymbol:"Db",atomicNumber:105,isotopes:[{id:"Db255",massNumber:255,exactMass:255.1074,atomicNumber:105,halfLife:1.6},{id:"Db256",massNumber:256,exactMass:256.10813,atomicNumber:105,halfLife:2.6},{id:"Db257",massNumber:257,exactMass:257.10772,atomicNumber:105,halfLife:1.3},{id:"Db258",massNumber:258,exactMass:258.10923,atomicNumber:105,halfLife:4.4},{id:"Db259",massNumber:259,exactMass:259.10961,atomicNumber:105},{id:"Db260",massNumber:260,exactMass:260.1113,atomicNumber:105,halfLife:1.52},{id:"Db261",massNumber:261,exactMass:261.11206,atomicNumber:105,halfLife:1.8},{id:"Db262",massNumber:262,exactMass:262.11408,atomicNumber:105,halfLife:34},{id:"Db263",massNumber:263,exactMass:263.11499,atomicNumber:105,halfLife:27},{id:"Db264",massNumber:264,exactMass:264.1174,atomicNumber:105},{id:"Db265",massNumber:265,exactMass:265.1186,atomicNumber:105},{id:"Db266",massNumber:266,exactMass:266.12103,atomicNumber:105},{id:"Db267",massNumber:267,exactMass:267.12238,atomicNumber:105},{id:"Db268",massNumber:268,exactMass:268.12545,atomicNumber:105},{id:"Db269",massNumber:269,exactMass:269.12746,atomicNumber:105},{id:"Db270",massNumber:270,exactMass:270.13071,atomicNumber:105}]},{elementSymbol:"Sg",atomicNumber:106,isotopes:[{id:"Sg258",massNumber:258,exactMass:258.11317,atomicNumber:106,halfLife:.0029},{id:"Sg259",massNumber:259,exactMass:259.1145,atomicNumber:106,halfLife:.48},{id:"Sg260",massNumber:260,exactMass:260.11442,atomicNumber:106,halfLife:.0036},{id:"Sg261",massNumber:261,exactMass:261.11612,atomicNumber:106,halfLife:.23},{id:"Sg262",massNumber:262,exactMass:262.1164,atomicNumber:106},{id:"Sg263",massNumber:263,exactMass:263.11832,atomicNumber:106,halfLife:.8},{id:"Sg264",massNumber:264,exactMass:264.11893,atomicNumber:106},{id:"Sg265",massNumber:265,exactMass:265.12111,atomicNumber:106,halfLife:10},{id:"Sg266",massNumber:266,exactMass:266.12207,atomicNumber:106,halfLife:21},{id:"Sg267",massNumber:267,exactMass:267.12443,atomicNumber:106},{id:"Sg268",massNumber:268,exactMass:268.12561,atomicNumber:106},{id:"Sg269",massNumber:269,exactMass:269.12876,atomicNumber:106},{id:"Sg270",massNumber:270,exactMass:270.13033,atomicNumber:106},{id:"Sg271",massNumber:271,exactMass:271.13347,atomicNumber:106},{id:"Sg272",massNumber:272,exactMass:272.13516,atomicNumber:106},{id:"Sg273",massNumber:273,exactMass:273.13822,atomicNumber:106}]},{elementSymbol:"Bh",atomicNumber:107,isotopes:[{id:"Bh260",massNumber:260,exactMass:260.12197,atomicNumber:107},{id:"Bh261",massNumber:261,exactMass:261.12166,atomicNumber:107,halfLife:.0118},{id:"Bh262",massNumber:262,exactMass:262.12289,atomicNumber:107,halfLife:.102},{id:"Bh263",massNumber:263,exactMass:263.12304,atomicNumber:107},{id:"Bh264",massNumber:264,exactMass:264.1246,atomicNumber:107,halfLife:.44},{id:"Bh265",massNumber:265,exactMass:265.12515,atomicNumber:107,halfLife:.94},{id:"Bh266",massNumber:266,exactMass:266.12694,atomicNumber:107},{id:"Bh267",massNumber:267,exactMass:267.12765,atomicNumber:107},{id:"Bh268",massNumber:268,exactMass:268.12976,atomicNumber:107},{id:"Bh269",massNumber:269,exactMass:269.13069,atomicNumber:107},{id:"Bh270",massNumber:270,exactMass:270.13362,atomicNumber:107},{id:"Bh271",massNumber:271,exactMass:271.13518,atomicNumber:107},{id:"Bh272",massNumber:272,exactMass:272.13803,atomicNumber:107},{id:"Bh273",massNumber:273,exactMass:273.13962,atomicNumber:107},{id:"Bh274",massNumber:274,exactMass:274.14244,atomicNumber:107},{id:"Bh275",massNumber:275,exactMass:275.14425,atomicNumber:107}]},{elementSymbol:"Hs",atomicNumber:108,isotopes:[{id:"Hs263",massNumber:263,exactMass:263.12856,atomicNumber:108},{id:"Hs264",massNumber:264,exactMass:264.12839,atomicNumber:108,halfLife:85e-5},{id:"Hs265",massNumber:265,exactMass:265.13009,atomicNumber:108,halfLife:9e-4},{id:"Hs266",massNumber:266,exactMass:266.1301,atomicNumber:108},{id:"Hs267",massNumber:267,exactMass:267.13179,atomicNumber:108,halfLife:.026},{id:"Hs268",massNumber:268,exactMass:268.13216,atomicNumber:108},{id:"Hs269",massNumber:269,exactMass:269.13406,atomicNumber:108,halfLife:9},{id:"Hs270",massNumber:270,exactMass:270.13465,atomicNumber:108},{id:"Hs271",massNumber:271,exactMass:271.13766,atomicNumber:108},{id:"Hs272",massNumber:272,exactMass:272.13905,atomicNumber:108},{id:"Hs273",massNumber:273,exactMass:273.14199,atomicNumber:108},{id:"Hs274",massNumber:274,exactMass:274.14313,atomicNumber:108},{id:"Hs275",massNumber:275,exactMass:275.14595,atomicNumber:108},{id:"Hs276",massNumber:276,exactMass:276.14721,atomicNumber:108},{id:"Hs277",massNumber:277,exactMass:277.14984,atomicNumber:108}]},{elementSymbol:"Mt",atomicNumber:109,isotopes:[{id:"Mt265",massNumber:265,exactMass:265.13615,atomicNumber:109},{id:"Mt266",massNumber:266,exactMass:266.1373,atomicNumber:109,halfLife:8e-4},{id:"Mt267",massNumber:267,exactMass:267.13731,atomicNumber:109},{id:"Mt268",massNumber:268,exactMass:268.13873,atomicNumber:109,halfLife:.07},{id:"Mt269",massNumber:269,exactMass:269.13906,atomicNumber:109},{id:"Mt270",massNumber:270,exactMass:270.14066,atomicNumber:109},{id:"Mt271",massNumber:271,exactMass:271.14114,atomicNumber:109},{id:"Mt272",massNumber:272,exactMass:272.14374,atomicNumber:109},{id:"Mt273",massNumber:273,exactMass:273.14491,atomicNumber:109},{id:"Mt274",massNumber:274,exactMass:274.14749,atomicNumber:109},{id:"Mt275",massNumber:275,exactMass:275.14865,atomicNumber:109},{id:"Mt276",massNumber:276,exactMass:276.15116,atomicNumber:109},{id:"Mt277",massNumber:277,exactMass:277.15242,atomicNumber:109},{id:"Mt278",massNumber:278,exactMass:278.15481,atomicNumber:109},{id:"Mt279",massNumber:279,exactMass:279.15619,atomicNumber:109}]},{elementSymbol:"Ds",atomicNumber:110,isotopes:[{id:"Ds267",massNumber:267,exactMass:267.14434,atomicNumber:110,halfLife:3e-6},{id:"Ds268",massNumber:268,exactMass:268.1438,atomicNumber:110},{id:"Ds269",massNumber:269,exactMass:269.14512,atomicNumber:110,halfLife:17e-5},{id:"Ds270",massNumber:270,exactMass:270.14472,atomicNumber:110},{id:"Ds271",massNumber:271,exactMass:271.14606,atomicNumber:110,halfLife:.06},{id:"Ds272",massNumber:272,exactMass:272.14632,atomicNumber:110},{id:"Ds273",massNumber:273,exactMass:273.14886,atomicNumber:110,halfLife:18e-5},{id:"Ds274",massNumber:274,exactMass:274.14949,atomicNumber:110},{id:"Ds275",massNumber:275,exactMass:275.15218,atomicNumber:110},{id:"Ds276",massNumber:276,exactMass:276.15303,atomicNumber:110},{id:"Ds277",massNumber:277,exactMass:277.15565,atomicNumber:110},{id:"Ds278",massNumber:278,exactMass:278.15647,atomicNumber:110},{id:"Ds279",massNumber:279,exactMass:279.15886,atomicNumber:110},{id:"Ds280",massNumber:280,exactMass:280.1598,atomicNumber:110},{id:"Ds281",massNumber:281,exactMass:281.16206,atomicNumber:110}]},{elementSymbol:"Rg",atomicNumber:111,isotopes:[{id:"Rg272",massNumber:272,exactMass:272.15362,atomicNumber:111,halfLife:.0015},{id:"Rg273",massNumber:273,exactMass:273.15368,atomicNumber:111},{id:"Rg274",massNumber:274,exactMass:274.15571,atomicNumber:111},{id:"Rg275",massNumber:275,exactMass:275.15614,atomicNumber:111},{id:"Rg276",massNumber:276,exactMass:276.15849,atomicNumber:111},{id:"Rg277",massNumber:277,exactMass:277.15952,atomicNumber:111},{id:"Rg278",massNumber:278,exactMass:278.1616,atomicNumber:111},{id:"Rg279",massNumber:279,exactMass:279.16247,atomicNumber:111},{id:"Rg280",massNumber:280,exactMass:280.16447,atomicNumber:111},{id:"Rg281",massNumber:281,exactMass:281.16537,atomicNumber:111},{id:"Rg282",massNumber:282,exactMass:282.16749,atomicNumber:111},{id:"Rg283",massNumber:283,exactMass:283.16842,atomicNumber:111}]},{elementSymbol:"Uub",atomicNumber:112,isotopes:[{id:"Uub277",massNumber:277,exactMass:277.16394,atomicNumber:112,halfLife:24e-5},{id:"Uub278",massNumber:278,exactMass:278.16431,atomicNumber:112},{id:"Uub279",massNumber:279,exactMass:279.16655,atomicNumber:112},{id:"Uub280",massNumber:280,exactMass:280.16704,atomicNumber:112},{id:"Uub281",massNumber:281,exactMass:281.16929,atomicNumber:112},{id:"Uub282",massNumber:282,exactMass:282.16977,atomicNumber:112},{id:"Uub283",massNumber:283,exactMass:283.17179,atomicNumber:112},{id:"Uub284",massNumber:284,exactMass:284.17238,atomicNumber:112},{id:"Uub285",massNumber:285,exactMass:285.17411,atomicNumber:112}]}];module.exports=isotopesData},function(module,exports,__webpack_require__){"use strict";var structGenAtomTypesData=[{elementSymbol:"H",atomicNumber:1,atomTypes:[{id:"H1",maxBondOrder:1,bondOrderSum:1}]},null,{elementSymbol:"Li",atomicNumber:3,atomTypes:[{id:"Li1",maxBondOrder:1,bondOrderSum:1}]},null,{elementSymbol:"B",atomicNumber:5,atomTypes:[{id:"B3",maxBondOrder:2,bondOrderSum:3}]},{elementSymbol:"C",atomicNumber:6,atomTypes:[{id:"C4",maxBondOrder:3,bondOrderSum:4}]},{elementSymbol:"N",atomicNumber:7,atomTypes:[{id:"N3",maxBondOrder:3,bondOrderSum:3},{id:"N5",maxBondOrder:2,bondOrderSum:5}]},{elementSymbol:"O",atomicNumber:8,atomTypes:[{id:"O2",maxBondOrder:2,bondOrderSum:2}]},{elementSymbol:"F",atomicNumber:9,atomTypes:[{id:"F1",maxBondOrder:1,bondOrderSum:1}]},null,{elementSymbol:"Na",atomicNumber:11,atomTypes:[{id:"Na1",maxBondOrder:1,bondOrderSum:1}]},null,null,{elementSymbol:"Si",atomicNumber:14,atomTypes:[{id:"Si4",maxBondOrder:3,bondOrderSum:4}]},{elementSymbol:"P",atomicNumber:15,atomTypes:[{id:"P3",maxBondOrder:3,bondOrderSum:3},{id:"P4",maxBondOrder:3,bondOrderSum:5}]},{elementSymbol:"S",atomicNumber:16,atomTypes:[{id:"S2",maxBondOrder:2,bondOrderSum:2},{id:"S3",maxBondOrder:2,bondOrderSum:4},{id:"S4",maxBondOrder:2,bondOrderSum:6}]},{elementSymbol:"Cl",atomicNumber:17,atomTypes:[{id:"Cl1",maxBondOrder:1,bondOrderSum:1}]},null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,{elementSymbol:"As",atomicNumber:33,atomTypes:[{id:"As3",maxBondOrder:1,bondOrderSum:3}]},{elementSymbol:"Se",atomicNumber:34,atomTypes:[{id:"Se2",maxBondOrder:2,bondOrderSum:2}]},{elementSymbol:"Br",atomicNumber:35,atomTypes:[{id:"Br1",maxBondOrder:1,bondOrderSum:1}]},null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,{elementSymbol:"I",atomicNumber:53,atomTypes:[{id:"I1",maxBondOrder:1,bondOrderSum:1}]}];module.exports=structGenAtomTypesData},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,ObjectEx=__webpack_require__(0).ObjectEx,DataType=__webpack_require__(0).DataType;module.exports=function(Kekule){return Kekule.AbstractConfigs=Class.create(ObjectEx,{CLASS_NAME:"Kekule.AbstractConfigs",CONFIG_PROP_FLAG:"__$config_prop__",initialize:function($super,autoInitDefValue){$super(),void 0===autoInitDefValue&&(autoInitDefValue=!0),autoInitDefValue&&this.initPropDefValues()},addConfigProp:function(name,dataType,defaultValue,additionalOptions){var options={dataType:dataType};additionalOptions&&(options=Object.extend(options,additionalOptions)),void 0!==defaultValue&&(options.defaultValue=defaultValue);var result=this.defineProp(name,options);return result[this.CONFIG_PROP_FLAG]=!0,result},addHashConfigProp:function(name,defaultValue,additionalOptions){return this.addConfigProp(name,DataType.HASH,defaultValue,additionalOptions)},addStrConfigProp:function(name,defaultValue,additionalOptions){return this.addConfigProp(name,DataType.STRING,defaultValue,additionalOptions)},addNumConfigProp:function(name,defaultValue,additionalOptions){return this.addConfigProp(name,DataType.NUM,defaultValue,additionalOptions)},addIntConfigProp:function(name,defaultValue,additionalOptions){return this.addConfigProp(name,DataType.INT,defaultValue,additionalOptions)},addFloatConfigProp:function(name,defaultValue,additionalOptions){return this.addConfigProp(name,DataType.FLOAT,defaultValue,additionalOptions)},addBoolConfigProp:function(name,defaultValue,additionalOptions){return this.addConfigProp(name,DataType.BOOL,defaultValue,additionalOptions)},initPropDefValues:function(){this.beginUpdate();try{for(var props=this.getAllPropList(),i=0,l=props.getLength();i<l;++i){var prop=props.getPropInfoAt(i),propName=prop.name,defValue=prop.defaultValue;void 0!==defValue&&this.setPropValue(propName,defValue)}}finally{this.endUpdate()}},assign:function(src){src.copyPropsTo(this)},toHash:function(){var obj={},propFlagName=this.CONFIG_PROP_FLAG;return this.saveObj(obj,"json",{saveDefaultValues:!0,propFilter:function(prop,obj){return prop[propFlagName]}}),obj}}),Kekule.ConfigPresetMap=Class.create(ObjectEx,{CLASS_NAME:"Kekule.ConfigPresetMap",initialize:function($super){$super(),this.map=new Kekule.MapEx(!0)},doFinalize:function($super){this.map=null,$super()},set:function(name,configObj){this.map.set(name,configObj)},get:function(name){return this.map.get(name)},getHash:function(name){var obj=this.get(name);return obj?obj.toHash?obj.toHash():obj:null},remove:function(name){this.map.remove(name)},has:function(name){return this.map.has(name)},clear:function(){this.map.clear()}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,DataType=__webpack_require__(0).DataType;module.exports=function(Kekule){return Kekule.ElementSeries={NONMETAL:"Nonmetals",METAL:"Metals",ALKALI_METAL:"Alkali Metals",ALKALI_EARTH_METAL:"Alkali Earth Metals",TRANSITION_METAL:"Transition Metals",METALLOID:"Metalloids",HALOGEN:"Halogens",NOBLE_GAS:"Noble Gases",LANTHANIDE:"Lanthanides",ACTINIDE:"Actinides"},Kekule.Element=Class.create(Kekule.ChemObject,{CLASS_NAME:"Kekule.Element",initialize:function($super,symbolOrAtomicNumber){if($super(),symbolOrAtomicNumber!=Kekule.Element.UNSET_ELEMENT){var elemInfo=this.getElementInfo(symbolOrAtomicNumber);elemInfo?(this.setPropStoreFieldValue("symbol",elemInfo.symbol),this.setPropStoreFieldValue("atomicNumber",elemInfo.atomicNumber),this.setPropStoreFieldValue("group",elemInfo.group),this.setPropStoreFieldValue("period",elemInfo.period),this.setPropStoreFieldValue("series",elemInfo.chemicalSerie),this.setPropStoreFieldValue("naturalMass",elemInfo.naturalMass),elemInfo.name&&this.setPropStoreFieldValue("name",elemInfo.name)):Kekule.chemError(Kekule.hasLocalRes()?Kekule.$L("ErrorMsg.INVALID_CHEMELEMENT")+": "+symbolOrAtomicNumber:"Invalid chemical element: "+symbolOrAtomicNumber)}else this.setPropStoreFieldValue("symbol",Kekule.Element.UNSET_ELEMENT),this.setPropStoreFieldValue("atomicNumber",Kekule.Element.UNSET_ELEMENT)},initProperties:function(){this.defineProp("name",{dataType:DataType.STRING,serializable:!1,setter:null}),this.defineProp("atomicNumber",{dataType:DataType.INT,serializable:!1,setter:null}),this.defineProp("symbol",{dataType:DataType.STRING,serializable:!1,setter:null}),this.defineProp("group",{dataType:DataType.INT,serializable:!1,setter:null}),this.defineProp("period",{dataType:DataType.INT,serializable:!1,setter:null}),this.defineProp("series",{dataType:DataType.STRING,serializable:!1,setter:null}),this.defineProp("naturalMass",{dataType:DataType.FLOAT,serializable:!1,setter:null})},getElementInfo:function(symbolOrAtomicNumber){return symbolOrAtomicNumber==Kekule.Element.UNSET_ELEMENT?{symbol:Kekule.Element.UNSET_ELEMENT,atomicNumber:Kekule.Element.UNSET_ELEMENT}:Kekule.Element.isDummyElement(symbolOrAtomicNumber)?{symbol:Kekule.Element.DUMMY_ELEMENT,atomicNumber:Kekule.Element.DUMMY_ELEMENT_ATOMICNUM}:Kekule.Element.isRGroup(symbolOrAtomicNumber)?{symbol:Kekule.Element.RGROUP_ELEMENT,atomicNumber:Kekule.Element.RGROUP_ELEMENT_ATMOICNUM}:Kekule.ChemicalElementsDataUtil.getElementInfo(symbolOrAtomicNumber)},getTheoreticValence:function(){return this.getGroup()?Kekule.Element.getTheoreticValenceOfGroup(this.getGroup()):null},isDummyElement:function(){return this.getAtomicNumber()==Kekule.Element.DUMMY_ELEMENT_ATOMICNUM},isRGroupElement:function(){return this.getAtomicNumber()==Kekule.Element.RGROUP_ELEMENT_ATMOICNUM},isNormalElement:function(){return Kekule.Element.isNormalElement(this.getAtomicNumber())},isSameElement:function(symbolOrAtomicNumber){return symbolOrAtomicNumber==Kekule.Element.UNSET_ELEMENT?this.getAtomicNumber()==Kekule.Element.UNSET_ELEMENT:"number"==typeof symbolOrAtomicNumber?this.getAtomicNumber()==symbolOrAtomicNumber:this.getSymbol()==symbolOrAtomicNumber},isHetero:function(){return(this.getSeries()===Kekule.ElementSeries.NONMETAL||this.getSeries()===Kekule.ElementSeries.HALOGEN)&&6!==this.getAtomicNumber()&&1!==this.getAtomicNumber()},getLabel:function(){return this.getSymbol()}}),Object.extend(Kekule.Element,Kekule.ChemicalElementsDataUtil),Kekule.Element.UNSET_ELEMENT=void 0,Kekule.Element.DUMMY_ELEMENT="DU",Kekule.Element.DUMMY_ELEMENT_ATOMICNUM=-1,Kekule.Element.RGROUP_ELEMENT="R",Kekule.Element.RGROUP_ELEMENT_ATOMICNUM=-2,Kekule.Element.DEUTERIUM="D",Kekule.Element.isNormalElement=function(symbolOrAtomicNumber){return symbolOrAtomicNumber!=Kekule.Element.UNSET_ELEMENT&&!Kekule.Element.isPseudoElement(symbolOrAtomicNumber)},Kekule.Element.isPseudoElement=function(symbolOrAtomicNumber){return"string"==typeof symbolOrAtomicNumber?symbolOrAtomicNumber==Kekule.Element.DUMMY_ELEMENT||symbolOrAtomicNumber==Kekule.Element.RGROUP_ELEMENT:symbolOrAtomicNumber==Kekule.Element.DUMMY_ELEMENT_ATOMICNUM||symbolOrAtomicNumber==Kekule.Element.RGROUP_ELEMENT_ATMOICNUM},Kekule.Element.isDummyElement=function(symbolOrAtomicNumber){return symbolOrAtomicNumber===Kekule.Element.DUMMY_ELEMENT||symbolOrAtomicNumber===Kekule.Element.DUMMY_ELEMENT_ATOMICNUM},Kekule.Element.isRGroup=function(symbolOrAtomicNumber){return symbolOrAtomicNumber===Kekule.Element.RGROUP_ELEMENT||symbolOrAtomicNumber===Kekule.Element.RGROUP_ELEMENT_ATOMICNUM},Kekule.Element.getTheoreticValenceOfGroup=function(group){return group<=2?group:group<=12?null:group<=17?group-10:0},Kekule.Element.getTheoreticValence=function(symbolOrAtomicNumber){var atomInfo=Kekule.ChemicalElementsDataUtil.getElementInfo(symbolOrAtomicNumber);return atomInfo.group?Kekule.Element.getTheoreticValenceOfGroup(atomInfo.group):null},Object.extend(Kekule.Element,{isAtomicNumberAvailable:function(atomicNumber){return Kekule.ChemicalElementsDataUtil.isAtomicNumberAvailable(atomicNumber)},isElementSymbolAvailable:function(symbol){return Kekule.ChemicalElementsDataUtil.isElementSymbolAvailable(symbol)}}),Kekule.Isotope=Class.create(Kekule.Element,{CLASS_NAME:"Kekule.Isotope",initialize:function($super,symbolOrAtomicNumber,massNumber){var atomicNum=symbolOrAtomicNumber,massNum=massNumber,isoInfo=Kekule.IsotopesDataUtil.getIsotopeInfo(symbolOrAtomicNumber,massNumber);if(isoInfo&&(isoInfo.atomicNumber&&(atomicNum=isoInfo.atomicNumber),massNum=isoInfo.massNumber),$super(atomicNum),this.setPropStoreFieldValue("massNumber",massNum),isoInfo&&isoInfo.isotopeAlias&&this.setPropStoreFieldValue("isotopeAlias",isoInfo.isotopeAlias),Kekule.Element.isNormalElement(atomicNum)&&massNum!==Kekule.Isotope.UNSET_MASSNUMBER){var isotopeInfo=Kekule.IsotopesDataUtil.getIsotopeInfo(this.getAtomicNumber(),massNum);isotopeInfo?(this.setPropStoreFieldValue("exactMass",isotopeInfo.exactMass),this.setPropStoreFieldValue("naturalAbundance",isotopeInfo.naturalAbundance)):Kekule.chemError((Kekule.hasLocalRes()?Kekule.$L("ErrorMsg.INVALID_ISOTOPE"):"Invalid isotope")+": "+this.getSymbol()+"/"+massNumber)}},initProperties:function(){this.defineProp("massNumber",{dataType:DataType.INTEGER,serializable:!1,setter:null}),this.defineProp("exactMass",{dataType:DataType.FLOAT,serializable:!1,setter:null}),this.defineProp("naturalAbundance",{dataType:DataType.FLOAT,serializable:!1,setter:null}),this.defineProp("isotopeAlias",{dataType:DataType.STRING,serializable:!1,setter:null})},isSame:function(obj){return obj instanceof Kekule.Isotope&&(obj===this||obj.getAtomicNumber()==this.getAtomicNumber()&&obj.getMassNumber()==this.getMassNumber())},getIsotopeId:function(){return Kekule.IsotopesDataUtil.getIsotopeId(this.getAtomicNumber(),this.getMassNumber())},getLabel:function(){return""+(this.getMassNumber()||"")+this.getSymbol()}}),Object.extend(Kekule.Isotope,Kekule.IsotopesDataUtil),Kekule.Isotope.UNSET_MASSNUMBER=void 0,Kekule.Isotope.getIsotopeId=function(symbolOrAtomicNumber,massNumber){return Kekule.IsotopesDataUtil.getIsotopeId(symbolOrAtomicNumber,massNumber)},Object.extend(Kekule.Isotope,{isMassNumberAvailable:function(symbolOrAtomicNumber,massNumber){return Kekule.IsotopesDataUtil.isMassNumberAvailable(symbolOrAtomicNumber,massNumber)}}),Kekule.IsotopeFactory={GENERIC_ELEMENT_ID:"__GENERIC__",_isotopes:{},getIsotopeId:function(symbolOrAtomicNumber,massNumber){return symbolOrAtomicNumber?Kekule.IsotopesDataUtil.getIsotopeId(symbolOrAtomicNumber,massNumber):Kekule.IsotopeFactory.GENERIC_ELEMENT_ID},getIsotope:function(symbolOrAtomicNumber,massNumber){var id=Kekule.IsotopeFactory.getIsotopeId(symbolOrAtomicNumber,massNumber);if(!Kekule.IsotopeFactory._isotopes[id]){var isotope=new Kekule.Isotope(symbolOrAtomicNumber,massNumber);Kekule.IsotopeFactory._isotopes[id]=isotope}return Kekule.IsotopeFactory._isotopes[id]},getIsotopeById:function(id){if(Kekule.IsotopeFactory._isotopes[id])return Kekule.IsotopeFactory._isotopes[id];var detail=Kekule.IsotopesDataUtil.getIsotopeIdDetail(id);return detail?Kekule.IsotopeFactory.getIsotope(detail.symbol,detail.massNumber):null}},Kekule.AtomType={UNSET_ATOMTYPE:void 0},Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,DataType=__webpack_require__(0).DataType;module.exports=function(Kekule){return Kekule.ElectronSet=Class.create(Kekule.ChemObject,{CLASS_NAME:"Kekule.ElectronSet",initialize:function($super,electronCount){$super(),this.setElectronCount(electronCount||Kekule.ElectronSet.UNSET_ELECTRONCOUNT)},initProperties:function(){this.defineProp("electronCount",{dataType:DataType.FLOAT})}}),Kekule.ElectronSet.UNSET_ELECTRONCOUNT=null,Kekule.UnbondedElectronSet=Class.create(Kekule.ElectronSet,{CLASS_NAME:"Kekule.UnBondedElectronSet",initialize:function($super,electronCount){$super(electronCount)},initProperties:function(){}}),Kekule.BondType={COVALENT:"covalent",IONIC:"ionic",COORDINATE:"coordinate",METALLIC:"metallic",HYDROGEN:"hydrogen",UNKNOWN:null,DEFAULT:"covalent"},Kekule.BondOrder={SINGLE:1,DOUBLE:2,TRIPLE:3,QUAD:4,EXPLICIT_AROMATIC:10,OTHER:20,UNSET:null,DEFAULT:1,getBondValence:function(bondOrder){return bondOrder===Kekule.BondOrder.UNSET?0:bondOrder==Kekule.BondOrder.EXPLICIT_AROMATIC?1.5:bondOrder}},Kekule.BondForm=Class.create(Kekule.ElectronSet,{CLASS_NAME:"Kekule.BondForm",initialize:function($super,bondOrder,electronCount,bondType){$super(electronCount),this.setBondOrder(bondOrder||Kekule.BondOrder.DEFAULT),Kekule.ObjUtils.notUnset(bondType)&&this.setBondType(bondType),Kekule.ObjUtils.notUnset(electronCount)&&this.setElectronCount(electronCount)},initProperties:function(){this.defineProp("bondType",{dataType:DataType.STRING,enumSource:Kekule.BondType,getter:function(){var r=this.getPropStoreFieldValue("bondType");return r||Kekule.BondType.DEFAULT}}),this.defineProp("bondOrder",{dataType:DataType.FLOAT,enumSource:Kekule.BondOrder,setter:function(value){this.getPropStoreFieldValue("bondOrder")!=value&&(this.setPropStoreFieldValue("bondOrder",value),value?this.getBondType()==Kekule.BondType.COVALENT&&this.setElectronCount(2*this.getBondValence()):value===Kekule.BondOrder.UNSET&&this.setElectronCount(Kekule.ElectronSet.UNSET_ELECTRONCOUNT))}}),this.defineProp("electronCount",{dataType:DataType.FLOAT}),this.defineProp("bondValence",{dataType:DataType.FLOAT,serializable:!1,getter:function(){return Kekule.BondOrder.getBondValence(this.getBondOrder())},setter:null})}}),Kekule.BondFormFactory={_bondForms:{},getBondFormId:function(bondOrder,electronCount,bondType){var result="";return bondType&&(result+=bondType+"_"),bondOrder&&(result+=Number(bondOrder).toString()),electronCount&&(result+="_"+Number(electronCount).toString()),result},getBondForm:function(bondOrder,electronCount,bondType){if(bondOrder||electronCount||bondType){if(bondType||(bondType=Kekule.BondType.DEFAULT),!electronCount&&bondOrder&&bondType===Kekule.BondType.COVALENT){electronCount=2*Kekule.BondOrder.getBondValence(bondOrder)}var id=Kekule.BondFormFactory.getBondFormId(bondOrder,electronCount,bondType);return Kekule.BondFormFactory._bondForms[id]||(Kekule.BondFormFactory._bondForms[id]=new Kekule.BondForm(bondOrder,electronCount,bondType)),Kekule.BondFormFactory._bondForms[id]}}},Kekule.RadicalOrder={NONE:0,SINGLET:1,DOUBLET:2,TRIPLET:3,DEFAULT:0,getRadicalElectronCount:function(radicalOrder){var O=Kekule.RadicalOrder;return Kekule.ObjUtils.isUnset(radicalOrder)||radicalOrder===O.NONE?0:radicalOrder===O.DOUBLET?1:2}},Kekule.HybridizationType={UNKNOWN:null,SP:1,SP2:2,SP3:3,NONE:0},Kekule}},function(module,exports,__webpack_require__){"use strict";module.exports=function(Kekule){return Kekule.ValenceUtils={getImplicitMdlValence:function(atomicNumber,charge,explicitValence){var q=charge,val=explicitValence;switch(atomicNumber){case 1:case 3:case 11:case 19:case 37:case 55:case 87:if(0==q&&val<=1)return 1;break;case 4:case 12:case 20:case 38:case 56:case 88:switch(q){case 0:if(val<=2)return 2;break;case 1:if(val<=1)return 1}break;case 5:switch(q){case-4:if(val<=1)return 1;break;case-3:if(val<=2)return 2;break;case-2:if(val<=3)return 3;if(val<=5)return 5;break;case-1:if(val<=4)return 4;break;case 0:if(val<=3)return 3;break;case 1:if(val<=2)return 2;break;case 2:if(val<=1)return 1}break;case 6:switch(q){case-3:if(val<=1)return 1;break;case-2:if(val<=2)return 2;break;case-1:if(val<=3)return 3;if(val<=5)return 5;break;case 0:if(val<=4)return 4;break;case 1:if(val<=3)return 3;break;case 2:if(val<=2)return 2;break;case 3:if(val<=1)return 1}break;case 7:switch(q){case-2:if(val<=1)return 1;break;case-1:if(val<=2)return 2;break;case 0:if(val<=3)return 3;if(val<=5)return 5;break;case 1:if(val<=4)return 4;break;case 2:if(val<=3)return 3;break;case 3:if(val<=2)return 2;break;case 4:if(val<=1)return 1}break;case 8:switch(q){case-1:if(val<=1)return 1;break;case 0:if(val<=2)return 2;break;case 1:if(val<=3)return 3;if(val<=5)return 5;break;case 2:if(val<=4)return 4;break;case 3:if(val<=3)return 3;break;case 4:if(val<=2)return 2;break;case 5:if(val<=1)return 1}break;case 9:switch(q){case 0:if(val<=1)return 1;break;case 1:if(val<=2)return 2;break;case 2:if(val<=3)return 3;if(val<=5)return 5;break;case 3:if(val<=4)return 4;break;case 4:if(val<=3)return 3;break;case 5:if(val<=2)return 2;break;case 6:if(val<=1)return 1}break;case 13:switch(q){case-4:if(val<=1)return 1;if(val<=3)return 3;if(val<=5)return 5;if(val<=7)return 7;break;case-3:if(val<=2)return 2;if(val<=4)return 4;if(val<=6)return 6;break;case-2:if(val<=3)return 3;if(val<=5)return 5;break;case-1:if(val<=4)return 4;break;case 0:if(val<=3)return 3;break;case 1:if(val<=2)return 2;break;case 2:if(val<=1)return 1}break;case 14:switch(q){case-3:if(val<=1)return 1;if(val<=3)return 3;if(val<=5)return 5;if(val<=7)return 7;break;case-2:if(val<=2)return 2;if(val<=4)return 4;if(val<=6)return 6;break;case-1:if(val<=3)return 3;if(val<=5)return 5;break;case 0:if(val<=4)return 4;break;case 1:if(val<=3)return 3;break;case 2:if(val<=2)return 2;break;case 3:if(val<=1)return 1}break;case 15:switch(q){case-2:if(val<=1)return 1;if(val<=3)return 3;if(val<=5)return 5;if(val<=7)return 7;break;case-1:if(val<=2)return 2;if(val<=4)return 4;if(val<=6)return 6;break;case 0:if(val<=3)return 3;if(val<=5)return 5;break;case 1:if(val<=4)return 4;break;case 2:if(val<=3)return 3;break;case 3:if(val<=2)return 2;break;case 4:if(val<=1)return 1}break;case 16:switch(q){case-1:if(val<=1)return 1;if(val<=3)return 3;if(val<=5)return 5;if(val<=7)return 7;break;case 0:if(val<=2)return 2;if(val<=4)return 4;if(val<=6)return 6;break;case 1:if(val<=3)return 3;if(val<=5)return 5;break;case 2:if(val<=4)return 4;break;case 3:if(val<=3)return 3;break;case 4:if(val<=2)return 2;break;case 5:if(val<=1)return 1}break;case 17:switch(q){case 0:if(val<=1)return 1;if(val<=3)return 3;if(val<=5)return 5;if(val<=7)return 7;break;case 1:if(val<=2)return 2;if(val<=4)return 4;if(val<=6)return 6;break;case 2:if(val<=3)return 3;if(val<=5)return 5;break;case 3:if(val<=4)return 4;break;case 4:if(val<=3)return 3;break;case 5:if(val<=2)return 2;break;case 6:if(val<=1)return 1}break;case 31:switch(q){case-4:if(val<=1)return 1;if(val<=3)return 3;if(val<=5)return 5;if(val<=7)return 7;break;case-3:if(val<=2)return 2;if(val<=4)return 4;if(val<=6)return 6;break;case-2:if(val<=3)return 3;if(val<=5)return 5;break;case-1:if(val<=4)return 4;break;case 0:if(val<=3)return 3;break;case 2:if(val<=1)return 1}break;case 32:switch(q){case-3:if(val<=1)return 1;if(val<=3)return 3;if(val<=5)return 5;if(val<=7)return 7;break;case-2:if(val<=2)return 2;if(val<=4)return 4;if(val<=6)return 6;break;case-1:if(val<=3)return 3;if(val<=5)return 5;break;case 0:if(val<=4)return 4;break;case 1:if(val<=3)return 3;break;case 3:if(val<=1)return 1}break;case 33:switch(q){case-2:if(val<=1)return 1;if(val<=3)return 3;if(val<=5)return 5;if(val<=7)return 7;break;case-1:if(val<=2)return 2;if(val<=4)return 4;if(val<=6)return 6;break;case 0:if(val<=3)return 3;if(val<=5)return 5;break;case 1:if(val<=4)return 4;break;case 2:if(val<=3)return 3;break;case 4:if(val<=1)return 1}break;case 34:switch(q){case-1:if(val<=1)return 1;if(val<=3)return 3;if(val<=5)return 5;if(val<=7)return 7;break;case 0:if(val<=2)return 2;if(val<=4)return 4;if(val<=6)return 6;break;case 1:if(val<=3)return 3;if(val<=5)return 5;break;case 2:if(val<=4)return 4;break;case 3:if(val<=3)return 3;break;case 5:if(val<=1)return 1}break;case 35:switch(q){case 0:if(val<=1)return 1;if(val<=3)return 3;if(val<=5)return 5;if(val<=7)return 7;break;case 1:if(val<=2)return 2;if(val<=4)return 4;if(val<=6)return 6;break;case 2:if(val<=3)return 3;if(val<=5)return 5;break;case 3:if(val<=4)return 4;break;case 4:if(val<=3)return 3;break;case 6:if(val<=1)return 1}break;case 49:switch(q){case-4:if(val<=1)return 1;if(val<=3)return 3;if(val<=5)return 5;if(val<=7)return 7;break;case-3:if(val<=2)return 2;if(val<=4)return 4;if(val<=6)return 6;break;case-2:if(val<=3)return 3;if(val<=5)return 5;break;case-1:if(val<=2)return 2;if(val<=4)return 4;break;case 0:if(val<=3)return 3;break;case 2:if(val<=1)return 1}break;case 50:case 82:switch(q){case-3:if(val<=1)return 1;if(val<=3)return 3;if(val<=5)return 5;if(val<=7)return 7;break;case-2:if(val<=2)return 2;if(val<=4)return 4;if(val<=6)return 6;break;case-1:if(val<=3)return 3;if(val<=5)return 5;break;case 0:if(val<=2)return 2;if(val<=4)return 4;break;case 1:if(val<=3)return 3;break;case 3:if(val<=1)return 1}break;case 51:case 83:switch(q){case-2:if(val<=1)return 1;if(val<=3)return 3;if(val<=5)return 5;if(val<=7)return 7;break;case-1:if(val<=2)return 2;if(val<=4)return 4;if(val<=6)return 6;break;case 0:if(val<=3)return 3;if(val<=5)return 5;break;case 1:if(val<=2)return 2;if(val<=4)return 4;break;case 2:if(val<=3)return 3;break;case 4:if(val<=1)return 1}break;case 52:case 84:switch(q){case-1:if(val<=1)return 1;if(val<=3)return 3;if(val<=5)return 5;if(val<=7)return 7;break;case 0:if(val<=2)return 2;if(val<=4)return 4;if(val<=6)return 6;break;case 1:if(val<=3)return 3;if(val<=5)return 5;break;case 2:if(val<=2)return 2;if(val<=4)return 4;break;case 3:if(val<=3)return 3;break;case 5:if(val<=1)return 1}break;case 53:case 85:switch(q){case 0:if(val<=1)return 1;if(val<=3)return 3;if(val<=5)return 5;if(val<=7)return 7;break;case 1:if(val<=2)return 2;if(val<=4)return 4;if(val<=6)return 6;break;case 2:if(val<=3)return 3;if(val<=5)return 5;break;case 3:if(val<=2)return 2;if(val<=4)return 4;break;case 4:if(val<=3)return 3;break;case 6:if(val<=1)return 1}break;case 81:switch(q){case-4:if(val<=1)return 1;if(val<=3)return 3;if(val<=5)return 5;if(val<=7)return 7;break;case-3:if(val<=2)return 2;if(val<=4)return 4;if(val<=6)return 6;break;case-2:if(val<=3)return 3;if(val<=5)return 5;break;case-1:if(val<=2)return 2;if(val<=4)return 4;break;case 0:if(val<=1)return 1;if(val<=3)return 3}}return val},getImplicitHydValence:function(atomicNumber,charge,explicitValence){var elem=atomicNumber,q=charge,val=explicitValence,impval=0;return 6==elem?impval=4-Math.abs(q):7==elem||15==elem?impval=3+q:8!=elem&&16!=elem||(impval=2+q),impval<0&&(impval=0),val>impval&&(impval=val),impval}},Kekule.ValenceUtils.getImplicitValence=Kekule.ValenceUtils.getImplicitMdlValence,Kekule}},function(module,exports,__webpack_require__){"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},Class=__webpack_require__(0).Class,ClassEx=__webpack_require__(0).ClassEx,ObjectEx=__webpack_require__(0).ObjectEx,DataType=__webpack_require__(0).DataType;module.exports=function(Kekule){return Kekule.StructureComparationLevel={SKELETAL:1,CONSTITUTION:2,CONFIGURATION:3,EXACT:4,DEFAULT:4},Kekule.globalOptions.add("algorithm.structureComparation",{structureComparationLevel:Kekule.StructureComparationLevel.DEFAULT}),Kekule.ObjComparer.compareStructure=function(obj1,obj2,options){var ops=Object.create(options||{});return ops.method=Kekule.ComparisonMethod.CHEM_STRUCTURE,Kekule.ObjComparer.compare(obj1,obj2,ops)},Kekule.ObjComparer.equalStructure=function(obj1,obj2,options){return 0===Kekule.ObjComparer.compareStructure(obj1,obj2,options)},Kekule.ObjComparer.getStructureComparisonDetailOptions=function(initialOptions){var result=Object.extend({},initialOptions);if(initialOptions){var detailOps,CL=Kekule.StructureComparationLevel,level=initialOptions.structureLevel||initialOptions.level||Kekule.globalOptions.algorithm.structureComparation.structureComparationLevel,affectedFields=["atom","mass","linkedConnectorCount","charge","radical","stereo","hydrogenCount","connectedObjCount","bondType","bondOrder"];level===CL.SKELETAL?detailOps={atom:!1,mass:!1,linkedConnectorCount:!0,charge:!1,radical:!1,stereo:!1,hydrogenCount:!1,connectedObjCount:!0,bondType:!1,bondOrder:!1}:level===CL.CONSTITUTION?detailOps={atom:!0,mass:!1,linkedConnectorCount:!0,charge:!1,radical:!1,stereo:!1,hydrogenCount:!0,connectedObjCount:!0,bondType:!0,bondOrder:!0}:level===CL.CONFIGURATION?detailOps={atom:!0,mass:!1,linkedConnectorCount:!0,charge:!1,radical:!1,stereo:!0,hydrogenCount:!0,connectedObjCount:!0,bondType:!0,bondOrder:!0}:level===CL.EXACT&&(detailOps={atom:!0,mass:!0,linkedConnectorCount:!0,charge:!0,radical:!0,stereo:!0,hydrogenCount:!0,connectedObjCount:!0,bondType:!0,bondOrder:!0});for(var i=0,l=affectedFields.length;i<l;++i){var fieldName=affectedFields[i],compatibleFieldName="compare"+fieldName.capitalizeFirst(),oldValue=result[fieldName];Kekule.ObjUtils.isUnset(oldValue)&&(oldValue=result[compatibleFieldName]),Kekule.ObjUtils.isUnset(oldValue)?(result[fieldName]=detailOps[fieldName],result[compatibleFieldName]=detailOps[fieldName]):(result[fieldName]=oldValue,result[compatibleFieldName]=oldValue)}}return result},Kekule.ChemStructureObject=Class.create(Kekule.ChemObject,{CLASS_NAME:"Kekule.ChemStructureObject",initProperties:function(){this.defineProp("linkedConnectors",{dataType:DataType.ARRAY,serializable:!1,scope:Class.PropertyScope.PUBLIC,setter:null,getter:function(){return this.getPropStoreFieldValue("linkedConnectors")||this.setPropStoreFieldValue("linkedConnectors",[]),this.getPropStoreFieldValue("linkedConnectors")}}),this.defineProp("linkedObjs",{dataType:DataType.ARRAY,serializable:!1,scope:Class.PropertyScope.PUBLIC,setter:null,getter:function(){for(var result=[],i=0,l=this.getLinkedConnectorCount();i<l;++i)for(var connector=this.getLinkedConnectorAt(i),objs=connector.getConnectedObjs(),j=0,k=objs.length;j<k;++j){var currObj=objs[j];currObj===this||this.hasChildObj&&this.hasChildObj(currObj)||Kekule.ArrayUtils.pushUnique(result,objs[j])}return result}}),this.defineProp("linkedSiblings",{dataType:DataType.ARRAY,serializable:!1,scope:Class.PropertyScope.PUBLIC,setter:null,getter:function(){for(var result=[],parent=this.getParent(),i=0,l=this.getLinkedConnectorCount();i<l;++i)for(var connector=this.getLinkedConnectorAt(i),objs=connector.getConnectedObjs(),j=0,k=objs.length;j<k;++j){var obj=objs[j];obj!==this&&result.indexOf(obj)<0&&(obj.getParent()!==parent&&(obj=parent.getDirectChildOfNestedNode(obj)),obj&&result.push(obj))}return result}})},initPropValues:function($super){$super(),this.setPropStoreFieldValue("linkedConnectors",[]),this.setSuppressChildChangeEventInUpdating(!0)},getAutoIdPrefix:function(){return"o"},doGetActualCompareOptions:function($super,options){return options&&options.method===Kekule.ComparisonMethod.CHEM_STRUCTURE?Kekule.ObjComparer.getStructureComparisonDetailOptions(options):$super(options)},_getComparisonOptionFlagValue:function(options,flagName){var compatibleName="compare"+flagName.capitalizeFirst(),result=options[compatibleName];return Kekule.ObjUtils.isUnset(result)&&(result=options[flagName]),result},doGetComparisonPropNames:function($super,options){return options.method===Kekule.ComparisonMethod.CHEM_STRUCTURE?[]:$super(options)},doCompare:function($super,targetObj,options){var result=$super(targetObj,options);if(!result&&options.method===Kekule.ComparisonMethod.CHEM_STRUCTURE&&this._getComparisonOptionFlagValue(options,"linkedConnectorCount")){var c1=this.getLinkedNonHydrogenConnectors(),c2=targetObj.getLinkedNonHydrogenConnectors&&targetObj.getLinkedNonHydrogenConnectors();result=this.doCompareOnValue(c1.length,c2&&c2.length,options)}return result},compareStructure:function(targetObj,options){var ops=Object.create(options||{});return ops.method=Kekule.ComparisonMethod.CHEM_STRUCTURE,this.compare(targetObj,ops)},equalStructure:function(targetObj,options){return 0===this.compareStructure(targetObj,options)},getParentFragment:function(){var p=this.getParent();return p instanceof Kekule.StructureFragment?p:null},getRootFragment:function(){var p=this.getParentFragment();return p?p.getRootFragment()||p:p},notifyLinkedConnectorsChanged:function(){this.notifyPropSet("linkedConnectors",this.getPropStoreFieldValue("linkedConnectors"))},getCurrConnectableObj:function(){return this},getLinkedConnectorCount:function(){return this.getLinkedConnectors().length},getLinkedConnectorAt:function(index){return this.getLinkedConnectors()[index]},indexOfLinkedConnector:function(connector){return this.getLinkedConnectors().indexOf(connector)},appendLinkedConnector:function(connector){var result=this._doAppendLinkedConnector(connector);return connector&&connector._doAppendConnectedObj(this),result},_doAppendLinkedConnector:function(connector){if(!connector)return-1;var linkedConnectors=this.getPropStoreFieldValue("linkedConnectors"),r=Kekule.ArrayUtils.pushUniqueEx(linkedConnectors,connector);return r.isPushed&&this.notifyLinkedConnectorsChanged(),r.index},removeLinkedConnectorAt:function(index){var connector=this.getLinkedConnectorAt(index);return connector&&connector._doRemoveConnectedObjAt(connector.indexOfConnectedObj(this)),this._doRemoveLinkedConnectorAt(index)},_doRemoveLinkedConnectorAt:function(index){var r=Kekule.ArrayUtils.removeAt(this.getLinkedConnectors(),index);return r&&this.notifyLinkedConnectorsChanged(),r},removeLinkedConnector:function(connector){var index=this.getLinkedConnectors().indexOf(connector);index>=0&&this.removeLinkedConnectorAt(index)},getConnectorTo:function(obj){for(var i=0,l=this.getLinkedConnectorCount();i<l;++i){var c=this.getLinkedConnectorAt(i);if(c.hasConnectedObj(obj))return c}return null},removeThisFromLinkedConnector:function(){for(var i=this.getLinkedConnectorCount()-1;i>=0;--i){this.getLinkedConnectorAt(i).removeConnectedObj(this)}},getLinkedObjsOnConnector:function(connector){for(var result=[],objs=connector.getConnectedObjs(),j=0,k=objs.length;j<k;++j)objs[j]!==this&&Kekule.ArrayUtils.pushUnique(result,objs[j]);return result},getLinkedNonHydrogenConnectors:function(){for(var result=[],i=0,l=this.getLinkedConnectorCount();i<l;++i){var connector=this.getLinkedConnectorAt(i);connector.isNormalConnectorToHydrogen&&connector.isNormalConnectorToHydrogen()||Kekule.ArrayUtils.pushUnique(result,connector)}return result},getLinkedNonHydrogenObjs:function(){for(var result=[],i=0,l=this.getLinkedConnectorCount();i<l;++i)for(var connector=this.getLinkedConnectorAt(i),objs=connector.getConnectedObjs(),j=0,k=objs.length;j<k;++j)objs[j]===this||objs[j].isHydrogenAtom&&objs[j].isHydrogenAtom()||Kekule.ArrayUtils.pushUnique(result,objs[j]);return result},getLinkedHydrogenAtoms:function(){for(var result=[],i=0,l=this.getLinkedConnectorCount();i<l;++i)for(var connector=this.getLinkedConnectorAt(i),objs=connector.getConnectedObjs(),j=0,k=objs.length;j<k;++j)objs[j]!==this&&objs[j].isHydrogenAtom&&objs[j].isHydrogenAtom()&&Kekule.ArrayUtils.pushUnique(result,objs[j]);return result},getStructureRelatedPropNames:function(){return["linkedConnectors"]},structureChange:function(originObj){this.clearStructureFlags(),this.invokeEvent("structureChange",{origin:originObj||this})},clearStructureFlags:function(){},relayEvent:function($super,eventName,event){"structureChange"===eventName?this.structureChange(event.origin):$super(eventName,event)},doObjectChange:function($super,modifiedPropNames){Kekule.ArrayUtils.intersect(modifiedPropNames||[],this.getStructureRelatedPropNames()).length&&this.structureChange()}}),Kekule.BaseStructureNode=Class.create(Kekule.ChemStructureObject,{CLASS_NAME:"Kekule.BaseStructureNode",initialize:function($super,id,coord2D,coord3D){$super(id),coord2D&&this.setCoord2D(coord2D),coord3D&&this.setCoord3D(coord3D)},initProperties:function(){this.defineProp("zIndex2D",{dataType:DataType.INT,scope:Class.PropertyScope.PUBLISHED})},getStructureRelatedPropNames:function($super){return $super().concat(["coord2D","coord3D"])},getAutoIdPrefix:function(){return"n"},getContainerBox:function(coordMode,allowCoordBorrow){var coord=this.getAbsCoordOfMode(coordMode,allowCoordBorrow);return Kekule.BoxUtils.createBox(coord,coord)},getContainerBox2D:function(allowCoordBorrow){return this.getContainerBox(Kekule.CoordMode.COORD2D,allowCoordBorrow)},getContainerBox3D:function(allowCoordBorrow){return this.getContainerBox(Kekule.CoordMode.COORD3D,allowCoordBorrow)}}),Kekule.ClassDefineUtils.addStandardCoordSupport(Kekule.BaseStructureNode),Kekule.StereoParity={NONE:null,ODD:1,EVEN:2,UNKNOWN:0},Kekule.ChemStructureNode=Class.create(Kekule.BaseStructureNode,{CLASS_NAME:"Kekule.ChemStructureNode",initialize:function($super,id,coord2D,coord3D){$super(id),coord2D&&this.setCoord2D(coord2D),coord3D&&this.setCoord3D(coord3D)},initProperties:function(){this.defineProp("charge",{dataType:DataType.FLOAT,getter:function(){return this.getPropStoreFieldValue("charge")||0}}),this.defineProp("radical",{dataType:DataType.INT}),this.defineProp("parity",{dataType:DataType.INT}),this.defineProp("isAnchor",{dataType:DataType.BOOL,serializable:!1,getter:function(){var p=this.getParent();return!(!p||!p.indexOfAnchorNode)&&p.indexOfAnchorNode(this)>=0},setter:function(value){if(value!==this.getIsAnchor()){var p=this.getParent();p&&(value&&p.appendAnchorNode()?p.appendAnchorNode(this):!value&&p.removeAnchorNode&&p.removeAnchorNode(this))}}})},getStructureRelatedPropNames:function($super){return $super().concat(["charge","radical"])},getLabel:function(){return null},doGetComparisonPropNames:function($super,options){var result=$super(options);return options.method===Kekule.ComparisonMethod.CHEM_STRUCTURE&&(this._getComparisonOptionFlagValue(options,"charge")&&result.push("charge"),this._getComparisonOptionFlagValue(options,"radical")&&result.push("radical")),result},doCompare:function($super,targetObj,options){var result=$super(targetObj,options);if(!result&&options.method===Kekule.ComparisonMethod.CHEM_STRUCTURE&&this._getComparisonOptionFlagValue(options,"stereo")){var c1=this.getParity()||Kekule.StereoParity.UNKNOWN,c2=targetObj.getParity&&targetObj.getParity()||Kekule.StereoParity.UNKNOWN;result=this.doCompareOnValue(c1,c2,options)}return result},getPrimaryIsotope:function(){return null},getLinkedChemNodes:function(ignoreHydrogenAtoms){for(var linkedObjs=this.getLinkedObjs(),result=[],i=0,l=linkedObjs.length;i<l;++i){var obj=linkedObjs[i];!(obj instanceof Kekule.ChemStructureNode)||ignoreHydrogenAtoms&&obj.isHydrogenAtom&&obj.isHydrogenAtom()||result.push(obj)}return result},getLinkedBonds:function(bondType){for(var result=[],i=0,l=this.getLinkedConnectorCount();i<l;++i){var c=this.getLinkedConnectorAt(i);c instanceof Kekule.Bond&&(!bondType||c.getBondType()===bondType)&&result.push(c)}return result},getLinkedMultipleBonds:function(){for(var BO=Kekule.BondOrder,result=[],i=0,l=this.getLinkedConnectorCount();i<l;++i){var c=this.getLinkedConnectorAt(i);if(c instanceof Kekule.Bond&&c.getBondType()===Kekule.BondType.COVALENT){var bondOrder=c.getBondOrder();bondOrder!==BO.DOUBLE&&bondOrder!==BO.TRIPLE&&bondOrder!==BO.QUAD&&bondOrder!==BO.EXPLICIT_AROMATIC||result.push(c)}}return result},getLinkedDoubleBonds:function(){for(var BO=Kekule.BondOrder,result=[],i=0,l=this.getLinkedConnectorCount();i<l;++i){var c=this.getLinkedConnectorAt(i);if(c instanceof Kekule.Bond&&c.getBondType()===Kekule.BondType.COVALENT){c.getBondOrder()===BO.DOUBLE&&result.push(c)}}return result},clearStructureFlags:function(){this.setPropStoreFieldValue("parity",Kekule.StereoParity.NONE)},isHydrogenAtom:function(){return!1}}),Kekule.RadicalType=Kekule.RadicalOrder,Kekule.AbstractAtom=Class.create(Kekule.ChemStructureNode,{CLASS_NAME:"Kekule.AbstractAtom",initialize:function($super,id,coord2D,coord3D){$super(id,coord2D,coord3D)},initProperties:function(){this.defineProp("explicitHydrogenCount",{dataType:DataType.INT,scope:Class.PropertyScope.PUBLISHED})},getAutoIdPrefix:function(){return"a"},getStructureRelatedPropNames:function($super){return $super().concat(["explicitHydrogenCount"])},doCompare:function($super,targetObj,options){var result=$super(targetObj,options);if(!result&&options.method===Kekule.ComparisonMethod.CHEM_STRUCTURE&&this._getComparisonOptionFlagValue(options,"hydrogenCount")){var c1=this.getHydrogenCount(!0),c2=targetObj.getHydrogenCount&&targetObj.getHydrogenCount(!0);result=this.doCompareOnValue(c1,c2,options)}return result},getHydrogenCount:function(includingBondedHydrogen){var result=this.getExplicitHydrogenCount()||0;if(includingBondedHydrogen){result+=this.getLinkedHydrogenAtoms().length||0}return result},setHydrogenCount:function(value){return this.setExplicitHydrogenCount(value)},isSaturated:function(){return!this.getLinkedMultipleBonds().length},mayContainElement:function(atomicNumberOrSymbol){var num;return num="string"==typeof atomicNumberOrSymbol?Kekule.ChemicalElementsDataUtil.getAtomicNumber(atomicNumberOrSymbol):atomicNumberOrSymbol,this.doMayContainElement(num)},doMayContainElement:function(atomicNum){return!1}}),Kekule.Atom=Class.create(Kekule.AbstractAtom,{CLASS_NAME:"Kekule.Atom",initialize:function($super,id,elemSymbolOrAtomicNumber,massNumber,coord2D,coord3D){$super(id,coord2D,coord3D),(elemSymbolOrAtomicNumber||massNumber)&&this.changeIsotope(elemSymbolOrAtomicNumber,massNumber)},initProperties:function(){this.defineProp("isotope",{dataType:"Kekule.Isotope",serializable:!1}),this.defineProp("isotopeId",{dataType:DataType.STRING,serializable:!0,getter:function(){var i=this.getIsotope();return i?i.getIsotopeId():Kekule.Element.UNSET_ELEMENT},setter:function(value){var newIsotope=Kekule.IsotopeFactory.getIsotopeById(value);newIsotope&&this.setIsotope(newIsotope)}}),this.defineProp("symbol",{dataType:DataType.STRING,serializable:!1,getter:function(){var i=this.getIsotope();return i?i.getSymbol():Kekule.Element.UNSET_ELEMENT},setter:function(value){this.changeElement(value)}}),this.defineProp("atomicNumber",{dataType:DataType.INTEGER,serializable:!1,getter:function(){var i=this.getIsotope();return i?i.getAtomicNumber():0},setter:function(value){this.changeElement(value)}}),this.defineProp("massNumber",{dataType:DataType.INTEGER,getter:function(){var i=this.getIsotope();return i?i.getMassNumber():Kekule.Isotope.UNSET_MASSNUMBER},setter:function(value){this.changeMassNumber(value)}}),this.defineProp("isotopeAlias",{dataType:DataType.STRING,getter:function(){var i=this.getIsotope();return i?i.getIsotopeAlias():void 0},setter:function(value){this.changeElement(value)}}),this.defineProp("atomType",{dataType:DataType.OBJECT,serializable:!1,scope:Class.PropertyScope.PUBLIC}),this.defineProp("atomTypeId",{dataType:DataType.STRING,getter:function(){var atype=this.getPropStoreFieldValue("atomType");return atype?atype.id:Kekule.AtomType.UNSET_ATOMTYPE},setter:function(value){if(this.isNormalAtom()){var atype=Kekule.AtomTypeDataUtil.getAtomTypeFromId(this.getAtomicNumber(),value);this.setAtomType(atype)}}}),this.defineProp("hybridizationType",{dataType:DataType.INT,enumSource:Kekule.HybridizationType})},getAutoIdPrefix:function(){return"a"},getStructureRelatedPropNames:function($super){return $super().concat(["isotope","atomType"])},doGetComparisonPropNames:function($super,options){var result=$super(options);return options.method===Kekule.ComparisonMethod.CHEM_STRUCTURE&&(this._getComparisonOptionFlagValue(options,"atom")&&result.push("atomicNumber"),this._getComparisonOptionFlagValue(options,"mass")&&result.push("massNumber")),result},getPrimaryIsotope:function(){return this.getIsotope()},getLabel:function(){return""+(this.getMassNumber()||"")+this.getSymbol()},doMayContainElement:function(atomicNum){return this.getAtomicNumber()===atomicNum},changeIsotope:function(symbolOrAtomicNumber,massNumber){symbolOrAtomicNumber===Kekule.Element.UNSET_ELEMENT?massNumber=Kekule.Isotope.UNSET_MASSNUMBER:symbolOrAtomicNumber||(symbolOrAtomicNumber=this.getAtomicNumber()),massNumber||(massNumber=Kekule.Isotope.UNSET_MASSNUMBER),this.getAtomicNumber()!==symbolOrAtomicNumber&&this.setAtomType(Kekule.AtomType.UNSET_ATOMTYPE);var isotope=Kekule.IsotopeFactory.getIsotope(symbolOrAtomicNumber,massNumber);this.setIsotope(isotope)},changeElement:function(symbolOrAtomicNumber){return this.changeIsotope(symbolOrAtomicNumber,Kekule.Isotope.UNSET_MASSNUMBER)},changeMassNumber:function(massNumber){return this.changeIsotope(null,massNumber)},isElement:function(symbolOrAtomicNumber){return this.getSymbol()===symbolOrAtomicNumber||this.getAtomicNumber()===symbolOrAtomicNumber},isNormalAtom:function(){var isotope=this.getIsotope();return!!isotope&&isotope.isNormalElement()},isHydrogenAtom:function(){return this.isElement(1)&&(!this.getMassNumber()||this.getMassNumber()<=1)},_getCurrCovalentBondsInfo:function(){for(var valenceSum=0,maxValence=0,i=0,l=this.getLinkedConnectorCount();i<l;++i){var connector=this.getLinkedConnectorAt(i);if(connector instanceof Kekule.Bond&&connector.getBondType()==Kekule.BondType.COVALENT){var v=connector.getBondValence();valenceSum+=v,v>maxValence&&(maxValence=v)}}return{valenceSum:valenceSum,maxValence:maxValence}},_getCurrIonicBondsInfo:function(){for(var valenceSum=0,maxValence=0,i=0,l=this.getLinkedConnectorCount();i<l;++i){var connector=this.getLinkedConnectorAt(i);if(connector instanceof Kekule.Bond&&connector.getBondType()==Kekule.BondType.IONIC){var v=connector.getBondValence();valenceSum+=v,v>maxValence&&(maxValence=v)}}return{valenceSum:valenceSum,maxValence:maxValence}},guessAtomType:function(){if(this.isNormalAtom()){var possible=null,fallback=null,bondsInfo=this._getCurrCovalentBondsInfo(),atomTypes=Kekule.AtomTypeDataUtil.getAllAtomTypes(this.getAtomicNumber());if(atomTypes){for(var i=0,l=atomTypes.length;i<l;++i){var atomType=atomTypes[i];if(fallback=atomType,atomType.bondOrderSum>=bondsInfo.valenceSum&&(possible=atomType,atomType.maxBondOrder>=bondsInfo.maxValence))return atomType}return possible||fallback}}return null},getProximalAtomType:function(){return this.getAtomType()||this.guessAtomType()},getImplicitValence:function(){if(this.isNormalAtom()){var bondsInfo=this._getCurrCovalentBondsInfo(),expValence=bondsInfo.valenceSum,charge=Math.round(this.getCharge()||0);return Kekule.ValenceUtils.getImplicitValence(this.getAtomicNumber(),charge,expValence)}return 0},getImplicitHydrogenCount:function(){if(this.isNormalAtom()){var coValentBondsInfo=this._getCurrCovalentBondsInfo(),ionicBondsInfo=this._getCurrIonicBondsInfo(),valence=this.getImplicitValence();return valence-=Kekule.RadicalOrder.getRadicalElectronCount(this.getRadical()),Math.max(valence-coValentBondsInfo.valenceSum-ionicBondsInfo.valenceSum,0)}return 0},getHydrogenCount:function(includingBondedHydrogen){var result;return result=Kekule.ObjUtils.isUnset(this.getExplicitHydrogenCount())?this.getImplicitHydrogenCount()||0:this.getExplicitHydrogenCount()||0,includingBondedHydrogen&&(result+=this.getLinkedHydrogenAtoms().length||0),result},getAtomicMass:function(){var result=null,isotope=this.getIsotope();return isotope&&(result=isotope.getExactMass()||isotope.getNaturalMass()),result}}),Kekule.PseudoatomType={DUMMY:"dummy",ANY:"any",HETERO:"hetero",CUSTOM:"custom"},Kekule.Pseudoatom=Class.create(Kekule.AbstractAtom,{CLASS_NAME:"Kekule.Pseudoatom",initialize:function($super,id,atomType,symbol,coord2D,coord3D){$super(id,coord2D,coord3D),atomType&&this.setAtomType(atomType),symbol&&atomType==Kekule.PseudoatomType.CUSTOM&&this.setSymbol(symbol)},initProperties:function(){this.defineProp("atomType",{dataType:DataType.STRING,enumSource:Kekule.PseudoatomType}),this.defineProp("symbol",{dataType:DataType.STRING,getter:function(){var t=this.getAtomType(),PT=Kekule.PseudoatomType,NL=Kekule.ChemStructureNodeLabels;return t===PT.DUMMY?NL.DUMMY_ATOM:t===PT.ANY?NL.ANY_ATOM:t===PT.HETERO?NL.HETERO_ATOM:this.getPropStoreFieldValue("symbol")||NL.CUSTOM_ATOM},setter:function(value){var PT=Kekule.PseudoatomType,NL=Kekule.ChemStructureNodeLabels;if(value){var t=value===NL.DUMMY_ATOM?PT.DUMMY:value===NL.ANY_ATOM?PT.ANY:value===NL.HETERO_ATOM?PT.HETERO:PT.CUSTOM;this.setAtomType(t)}this.setPropStoreFieldValue("symbol",value)}})},getStructureRelatedPropNames:function($super){return $super().concat(["atomType","symbol"])},getPrimaryIsotope:function(){return null},getLabel:function(){return this.getSymbol()},doGetComparisonPropNames:function($super,options){var result=$super(options);return options.method===Kekule.ComparisonMethod.CHEM_STRUCTURE&&this._getComparisonOptionFlagValue(options,"atom")&&result.push("atomType"),result},doCompare:function($super,targetObj,options){var result=$super(targetObj,options);if(!result&&options.method===Kekule.ComparisonMethod.CHEM_STRUCTURE&&this._getComparisonOptionFlagValue(options,"atom")&&this.getAtomType()===Kekule.PseudoatomType.CUSTOM){var v1=this.getSymbol(),v2=targetObj.getSymbol&&targetObj.getSymbol();result=this.doCompareOnValue(v1,v2,options)}return result},doMayContainElement:function(atomicNum){var PT=Kekule.PseudoatomType,t=this.getAtomType();if(t===PT.ANY)return!0;if(t===PT.HETERO){if([1,6].indexOf(atomicNum)>=0)return!1;return"Nonmetals"===Kekule.ChemicalElementsDataUtil.getElementInfo(atomicNum).chemicalSerie}return!1}}),Kekule.VariableAtom=Class.create(Kekule.AbstractAtom,{CLASS_NAME:"Kekule.VariableAtom",initProperties:function(){this.defineProp("allowedIsotopeIds",{dataType:DataType.ARRAY,getter:function(canCreate){var r=this.getPropStoreFieldValue("allowedIsotopeIds");return!r&&canCreate&&(r=[],this.setPropStoreFieldValue("allowedIsotopeIds",r)),r}}),this.defineProp("disallowedIsotopeIds",{dataType:DataType.ARRAY,getter:function(canCreate){var r=this.getPropStoreFieldValue("disallowedIsotopeIds");return!r&&canCreate&&(r=[],this.setPropStoreFieldValue("disallowedIsotopeIds",r)),r}}),this.defineProp("allowedIsotopes",{dataType:DataType.ARRAY,setter:null,getter:function(){return this._getIsotopesFromIds(this.getAllowedIsotopeIds())}}),this.defineProp("disallowedIsotopes",{dataType:DataType.ARRAY,setter:null,getter:function(){return this._getIsotopesFromIds(this.getDisallowedIsotopeIds())}})},getStructureRelatedPropNames:function($super){return $super().concat(["allowedIsotopeIds","disallowedIsotopeIds"])},getPrimaryIsotope:function(){if(this.isDisallowedList())return null;var ids=this.getAllowedIsotopeIds(),id=ids?ids[0]:null;return id?Kekule.IsotopeFactory.getIsotopeById(id):null},getLabel:function(){return Kekule.ChemStructureNodeLabels.VARIABLE_ATOM},doCompare:function($super,targetObj,options){var result=$super(targetObj,options);if(!result&&options.method===Kekule.ComparisonMethod.CHEM_STRUCTURE&&this._getComparisonOptionFlagValue(options,"atom")){var AU=Kekule.ArrayUtils,allowedIds1=this.getAllowedIsotopeIds(),allowedIds2=targetObj.getAllowedIsotopeIds&&targetObj.getAllowedIsotopeIds();if(allowedIds1)allowedIds1=AU.clone(allowedIds1).sort(),allowedIds2&&allowedIds2.length&&(allowedIds2=AU.clone(allowedIds2).sort()),result=this.doCompareOnValue(allowedIds1,allowedIds2,options);else if(allowedIds2)result=1;else{var disallowedIds1=this.getDisallowedIsotopeIds(),disallowedIds2=targetObj.getDisallowedIsotopeIds&&targetObj.getDisallowedIsotopeIds();disallowedIds1&&disallowedIds1.length&&(disallowedIds1=AU.clone(disallowedIds1).sort()),disallowedIds2&&disallowedIds2.length&&(disallowedIds2=AU.clone(disallowedIds2).sort()),result=this.doCompareOnValue(disallowedIds1,disallowedIds2,options)}}return result},doMayContainElement:function(atomicNum){var atomicNumInIds=function(atomicNum,ids){if(!ids)return!1;for(var i=0,l=ids.length;i<l;++i){var id=ids[i],d=Kekule.IsotopesDataUtil.getIsotopeIdDetail(id),symbol=d.symbol;if(Kekule.ChemicalElementsDataUtil.getAtomicNumber(symbol)===atomicNum)return!0}return!1},isotopeIds=this.getAllowedIsotopeIds();return isotopeIds?atomicNumInIds(atomicNum,isotopeIds):(isotopeIds=this.getDisallowedIsotopeIds())?!atomicNumInIds(atomicNum,isotopeIds):void 0},isDisallowedList:function(){return this.getDisallowedIsotopeIds()&&!this.getAllowedIsotopeIds()},isListEmpty:function(){var list=this.getAllowedIsotopeIds(),result=!list||!list.length;return result&&(list=this.getDisallowedIsotopeIds(),result=!list||!list.length),result},fetchAllowedIsotopeIds:function(){return this.doGetAllowedIsotopeIds(!0)},fetchDisallowedIsotopeIds:function(){return this.doGetDisallowedIsotopeIds(!0)},_getIsotopesFromIds:function(ids){if(!ids)return null;for(var result=[],i=0,l=ids.length;i<l;++i){var id=ids[i],isotope=Kekule.IsotopeFactory.getIsotopeById(id);isotope&&result.push(isotope)}return result}}),Kekule.MolecularFormula=Class.create(ObjectEx,{CLASS_NAME:"Kekule.MolecularFormula",initialize:function($super,parent){$super(),this.setPropStoreFieldValue("sections",[]),parent&&this.setPropStoreFieldValue("parent",parent),this.setBubbleEvent(!0)},initProperties:function(){this.defineProp("parent",{dataType:"Kekule.StructureFragment",serializable:!1,setter:null,scope:Class.PropertyScope.PUBLIC}),this.defineProp("sections",{dataType:DataType.ARRAY,setter:null}),this.defineProp("charge",{dataType:DataType.FLOAT,getter:function(){return this.getPropStoreFieldValue("charge")||0}}),this.defineProp("radical",{dataType:DataType.INT,getter:function(){return this.getPropStoreFieldValue("radical")||0}})},getHigherLevelObj:function(){return this.getParent()},isEmpty:function(){return this.getSectionCount()<=0},notifySectionsChanged:function(){this.notifyPropSet("sections",this.getPropStoreFieldValue("sections"))},createSectionItem:function(atomOrSubFormula,count,charge){var result={obj:atomOrSubFormula,count:count||1};return charge&&atomOrSubFormula.setCharge(charge),atomOrSubFormula.setParent&&atomOrSubFormula.setParent(this.getParent()),result},getTotalCharge:function(){for(var result=0,sections=this.getSections(),i=0,l=sections.length;i<l;++i)sections[i].obj.getCharge&&(result+=sections[i].obj.getCharge()*(sections.count||1));return this.getCharge()&&(result+=this.getCharge()),result},indexOfObj:function(atomOrSubFormula){for(var sections=this.getSections(),i=0,l=sections.length;i<l;++i)if(sections[i].obj==atomOrSubFormula)return i;return-1},getSectionCount:function(){return this.getSections().length},getSectionAt:function(index){return this.getSections()[index]},getSectionCharge:function(itemOrIndex){var sec,result=0;return sec="object"!=(void 0===itemOrIndex?"undefined":_typeof(itemOrIndex))?this.getSectionAt(itemOrIndex):itemOrIndex,sec.obj.getCharge&&(result+=sec.obj.getCharge()||0),result},appendSection:function(atomOrSubFormula,count,charge){var result=this.createSectionItem(atomOrSubFormula,count,charge);return this.getSections().push(result),this.notifySectionsChanged(),result},insertSection:function(index,atomOrSubFormula,count,charge){var result=this.createSectionItem(atomOrSubFormula,count,charge);return this.getSections().splice(index,0,result),this.notifySectionsChanged(),result},removeSectionAt:function(index){var r=this.getSections().splice(index,1);return r&&this.notifySectionsChanged(),r},clear:function(){this.beginUpdate();try{this.setCharge(null),this.setRadical(null),this.setPropStoreFieldValue("sections",[]),this.notifySectionsChanged()}finally{this.endUpdate()}},removeObj:function(atomOrSubFormula){var i=this.indexOfObj(atomOrSubFormula);if(!(i>=0))return null;this.removeSectionAt(i);this.notifySectionsChanged()},getMaxNestedLevel:function(){for(var result=0,i=0,l=this.getSectionCount();i<l;++i){var section=this.getSectionAt(i);if(section.obj instanceof Kekule.MolecularFormula){var nestLevel=section.obj.getMaxNestedLevel()+1;nestLevel>result&&(result=nestLevel)}}return result},getSimpleIsotopeMaps:function(){}}),Kekule.StructureConnectionTable=Class.create(ObjectEx,{CLASS_NAME:"Kekule.StructureConnectionTable",initialize:function($super,owner,parent){$super(),owner&&this.setOwner(owner),parent&&this.setPropStoreFieldValue("parent",parent)},initProperties:function(){this.defineProp("owner",{dataType:"Kekule.ChemSpace",serializable:!1,scope:Class.PropertyScope.PUBLIC,setter:function(value){value!=this.getPropStoreFieldValue("owner")&&(this.setPropStoreFieldValue("owner",value),this.ownerChanged(value))}}),this.defineProp("parent",{dataType:"Kekule.StructureFragment",serializable:!1,scope:Class.PropertyScope.PUBLIC,setter:function(value){value!=this.getPropStoreFieldValue("parent")&&(this.setPropStoreFieldValue("parent",value),this.parentChanged(value))}}),this.defineProp("nodes",{dataType:DataType.ARRAY}),this.defineProp("anchorNodes",{dataType:DataType.ARRAY,setter:null}),this.defineProp("connectors",{dataType:DataType.ARRAY}),this.defineProp("nonHydrogenNodes",{dataType:DataType.ARRAY,scope:Class.PropertyScope.PUBLIC,serializable:!1,setter:null,getter:function(){for(var result=[],i=0,l=this.getNodeCount();i<l;++i){var node=this.getNodeAt(i);node.isHydrogenAtom&&node.isHydrogenAtom()||result.push(node)}return result}}),this.defineProp("nonHydrogenConnectors",{dataType:DataType.ARRAY,scope:Class.PropertyScope.PUBLIC,serializable:!1,setter:null,getter:function(){for(var result=[],i=0,l=this.getConnectorCount();i<l;++i){var conn=this.getConnectorAt(i);conn.isNormalConnectorToHydrogen&&conn.isNormalConnectorToHydrogen()||result.push(conn)}return result}})},initPropValues:function($super){$super(),this.setPropStoreFieldValue("nodes",[]),this.setPropStoreFieldValue("anchorNodes",[]),this.setPropStoreFieldValue("connectors",[])},getHigherLevelObj:function(){return this.getParent()||this.getOwner()},doSaveProp:function(obj,prop,storageNode,serializer){var propName=prop.name;switch(propName){case"anchorNodes":for(var indexes=[],i=0,l=obj.getAnchorNodeCount();i<l;++i){var node=obj.getAnchorNodeAt(i),index=obj.indexOfNode(node);indexes.push(index)}var subNode=serializer.createChildStorageNode(storageNode,serializer.propNameToStorageName(propName),!0);return serializer.save(indexes,subNode),!0;case"connectors":for(var subNode=serializer.createChildStorageNode(storageNode,serializer.propNameToStorageName(propName),!0),i=0,l=obj.getConnectorCount();i<l;++i){var item=obj.getConnectorAt(i),nodeName=serializer.getNameForArrayItemStorageNode(item),itemNode=serializer.appendArrayItemStorageNode(subNode,serializer.propNameToStorageName(nodeName),serializer.isArray(item));serializer.setStorageNodeExplicitType(itemNode,serializer.getValueExplicitType(item)),serializer.save(item,itemNode);for(var connectedObjs=[],j=0,k=item.getConnectedObjCount();j<k;++j){var conObj=item.getConnectedObjAt(j),index=obj.indexOfChild(conObj);if(index>=0)connectedObjs.push(index);else{var indexStack=obj.indexStackOfChild(conObj);null!==indexStack&&void 0!==indexStack&&connectedObjs.push(indexStack)}}if(connectedObjs.length){var conObjsNode=serializer.createChildStorageNode(itemNode,serializer.propNameToStorageName("connectedObjs"),!0);serializer.save(connectedObjs,conObjsNode)}}return!0;default:return!1}},doLoadProp:function(obj,prop,storageNode,serializer){var propName=prop.name;switch(propName){case"anchorNodes":var indexes=[],subNode=serializer.getChildStorageNode(storageNode,serializer.propNameToStorageName(propName));return serializer.load(indexes,subNode),obj.__load_anchorNodes_indexes=indexes,!0;case"connectors":for(var connector,subNode=serializer.getChildStorageNode(storageNode,serializer.propNameToStorageName(propName)),itemNodes=serializer.getAllArrayItemStorageNodes(subNode),i=0,l=itemNodes.length;i<l;++i){var itemNode=itemNodes[i],valueType=serializer.getStorageNodeExplicitType(itemNode)||serializer.getStorageNodeName(itemNode);if(valueType){connector=DataType.createInstance(valueType,Kekule),serializer.load(connector,itemNode);var conObjsNode=serializer.getChildStorageNode(itemNode,serializer.propNameToStorageName("connectedObjs"));if(conObjsNode){var connectedObjs=[];serializer.load(connectedObjs,conObjsNode),connector.__load_connectedObj_indexes=connectedObjs}var conNodeNode=serializer.getChildStorageNode(itemNode,serializer.propNameToStorageName("connectedNodes"));if(conNodeNode){var connectedNodes=[];serializer.load(connectedNodes,conNodeNode),connector.__load_connectedNode_indexes=connectedNodes}var conConnectorNode=serializer.getChildStorageNode(itemNode,serializer.propNameToStorageName("connectedConnectors"));if(conConnectorNode){var connectedConnectors=[];serializer.load(connectedConnectors,conConnectorNode),connector.__load_connectedConnector_indexes=connectedConnectors}obj.appendConnector(connector)}}return!0;default:return!1}},loaded:function($super){if(this.__load_anchorNodes_indexes){for(var i=0,l=this.__load_anchorNodes_indexes.length;i<l;++i){var index=this.__load_anchorNodes_indexes[i];this.appendAnchorNode(this.getNodeAt(index))}delete this.__load_anchorNodes_indexes}for(var i=0,l=this.getConnectorCount();i<l;++i){var connector=this.getConnectorAt(i);if(connector.__load_connectedObj_indexes){for(var j=0,k=connector.__load_connectedObj_indexes.length;j<k;++j){var connObj,index=connector.__load_connectedObj_indexes[j];connObj="object"==(void 0===index?"undefined":_typeof(index))?this.getChildAtIndexStack(index):this.getChildAt(index),connObj&&connector.appendConnectedObj(connObj)}delete connector.__load_connectedObj_indexes}if(connector.__load_connectedNode_indexes){for(var j=0,k=connector.__load_connectedNode_indexes.length;j<k;++j){var index=connector.__load_connectedNode_indexes[j];"object"==(void 0===index?"undefined":_typeof(index))?connector.appendConnectedObj(this.getNodeAtIndexStack(index)):connector.appendConnectedObj(this.getNodeAt(index))}delete connector.__load_connectedNode_indexes}if(connector.__load_connectedConnector_indexes){for(var j=0,k=connector.__load_connectedConnector_indexes.length;j<k;++j){var index=connector.__load_connectedConnector_indexes[j];connector.appendConnectedObj(this.getConnectorAt(index))}delete connector.__load_connectedConnector_indexes}}this.ownerChanged(this.getOwner()),this.parentChanged(this.getParent()),$super()},notifyNodesChanged:function(){this.notifyPropSet("nodes",this.getPropStoreFieldValue("nodes"))},notifyAnchorNodesChanged:function(){this.notifyPropSet("anchorNodes",this.getPropStoreFieldValue("anchorNodes"))},notifyConnectorsChanged:function(){this.notifyPropSet("connectors",this.getPropStoreFieldValue("connectors"))},ownerChanged:function(newOwner){for(var i=0,l=this.getNodeCount();i<l;++i)this.getNodeAt(i).setOwner(newOwner);for(var i=0,l=this.getConnectorCount();i<l;++i)this.getConnectorAt(i).setOwner(newOwner)},parentChanged:function(newParent){for(var i=0,l=this.getNodeCount();i<l;++i)this.getNodeAt(i).setParent(newParent);for(var i=0,l=this.getConnectorCount();i<l;++i)this.getConnectorAt(i).setParent(newParent)},isEmpty:function(){return this.getNodeCount()<=0&&this.getConnectorCount()<=0},getNodeById:function(id){for(var nodes=this.getNodes(),i=0,l=nodes.length;i<l;++i)if(nodes[i].getId()==id)return nodes[i];return null},getConnectorById:function(id){for(var connectors=this.getConnectors(),i=0,l=connectors.length;i<l;++i)if(connectors[i].getId()==id)return connectors[i];return null},getObjectById:function(id){var node=this.getNodeById(id);return node||this.getConnectorById(id)},getNodeCount:function(){return this.getNodes().length},getNodeAt:function(index){return this.getNodes()[index]},indexOfNode:function(node){return this.getNodes().indexOf(node)},hasNode:function(node,checkNestedStructure){var found=this.indexOfNode(node)>=0;if(!found&&checkNestedStructure)for(var i=0,l=this.getNodeCount();i<l;++i){var n=this.getNodeAt(i);if(n.hasNode&&(found=n.hasNode(node,!0)),found)break}return found},indexStackOfNode:function(node){var index=this.indexOfNode(node);if(index>=0)return index;for(var stack=null,i=0,l=this.getNodeCount();i<l;++i){var n=this.getNodeAt(i);if(n.indexStackOfNode&&(stack=n.indexStackOfNode(node),!Kekule.ObjUtils.isUnset(stack)))return"object"!=(void 0===stack?"undefined":_typeof(stack))&&(stack=[stack]),stack.unshift(i),stack}return stack},getNodeAtIndexStack:function(indexStack){if(indexStack=Kekule.ArrayUtils.toArray(indexStack),indexStack.length<=0)return null;for(var node=this.getNodeAt(indexStack[0]),i=1,l=indexStack.length;i<l;++i){if(!node||!node.getNodeAt)return null;node=node.getNodeAt(indexStack[i])}return node},appendNode:function(node){var r=Kekule.ArrayUtils.pushUniqueEx(this.getNodes(),node);return r.isPushed&&(node.setOwner&&node.setOwner(this.getOwner()),node.setParent&&node.setParent(this.getParent()),this.notifyNodesChanged()),r.index},insertNodeAt:function(node,index){var i=this.indexOfNode(node),nodes=this.getNodes();return(Kekule.ObjUtils.isUnset(index)||index<0)&&(index=nodes.length),i>=0?(nodes.splice(i,1),nodes.splice(index,0,node)):(nodes.splice(index,0,node),node.setOwner&&node.setOwner(this.getOwner()),node.setParent&&node.setParent(this.getParent())),this.notifyNodesChanged(),index},setNodeIndex:function(node,index){var nodes=this.getNodes(),i=this.indexOfNode(node);i>=0&&(nodes.splice(i,1),nodes.splice(index,0,node))},removeNodeAt:function(index,preserveLinkedConnectors){var node=this.getNodes()[index];node&&(preserveLinkedConnectors||node.removeThisFromLinkedConnector(),this.getNodes().splice(index,1),node.setOwner&&node.setOwner(null),node.setParent&&node.setParent(null),this.notifyNodesChanged())},removeNode:function(node,preserveLinkedConnectors){var index=this.getNodes().indexOf(node);index>=0&&this.removeNodeAt(index,preserveLinkedConnectors)},replaceNode:function(oldNode,newNode){if(!this.hasNode(oldNode))return this;this.insertBefore(newNode,oldNode);var anchorNodes=this.getAnchorNodes(),anchorIndex=anchorNodes.indexOf(oldNode);anchorIndex>=0&&anchorNodes.splice(anchorIndex,1,[newNode]);for(var connectors=Kekule.ArrayUtils.clone(oldNode.getLinkedConnectors()),i=0,l=connectors.length;i<l;++i){var connector=connectors[i];connector.replaceConnectedObj(oldNode,newNode)}if(oldNode.getNodes&&oldNode.getCrossConnectors)for(var crossConnectors=Kekule.ArrayUtils.clone(oldNode.getCrossConnectors()),i=0,l=crossConnectors.length;i<l;++i){var connector=crossConnectors[i];if(this.indexOfConnector(connector)>=0)for(var j=0,k=connector.getConnectedObjCount();j<k;++j){var obj=connector.getConnectedObjAt(j);oldNode.indexOfChild(obj)>=0&&connector.replaceConnectedObj(obj,newNode)}connector.replaceConnectedObj(oldNode,newNode)}this.removeNode(oldNode)},clearNodes:function(){this.clearAnchorNodes(),this.setPropStoreFieldValue("nodes",[]),this.notifyAnchorNodesChanged(),this.notifyNodesChanged()},sortNodes:function(sortFunc){sortFunc?(this.getNodes().sort(sortFunc),this.notifyNodesChanged()):Kekule.error(Kekule.$L("ErrorMsg.SORT_FUNC_UNSET"))},nodesHasCoord2D:function(allowCoordBorrow){for(var nodes=this.getNodes(),i=0,l=nodes.length;i<l;++i)if(nodes[i].hasCoord2D(allowCoordBorrow))return!0;return!1},nodesHasCoord3D:function(allowCoordBorrow){for(var nodes=this.getNodes(),i=0,l=nodes.length;i<l;++i)if(nodes[i].hasCoord3D(allowCoordBorrow))return!0;return!1},_createAtom:function(elemSymbolOrAtomicNumber,massNumber,coord2D,coord3D){return new Kekule.Atom(null,elemSymbolOrAtomicNumber,massNumber,coord2D,coord3D)},appendAtom:function(elemSymbolOrAtomicNumber,massNumber,coord2D,coord3D){var atom=this._createAtom(elemSymbolOrAtomicNumber,massNumber,coord2D,coord3D);return atom&&this.appendNode(atom),atom},getAnchorNodeCount:function(){return this.getAnchorNodes().length},indexOfAnchorNode:function(node){return this.getAnchorNodes().indexOf(node)},getAnchorNodeAt:function(index){return this.getAnchorNodes()[index]},appendAnchorNode:function(node){if(!node)return-1;if(this.getNodes().indexOf(node)>=0){var r=Kekule.ArrayUtils.pushUniqueEx(this.getAnchorNodes(),node);return r.isPushed&&this.notifyAnchorNodesChanged(),r.index}return-1},removeAnchorNodeAt:function(index){this.getAnchorNodes()[index]&&(this.getAnchorNodes().splice(index,1),this.notifyAnchorNodesChanged())},removeAnchorNode:function(node){var index=this.getAnchorNodes().indexOf(node);index>=0&&this.removeAnchorNodeAt(index)},clearAnchorNodes:function(){this.setPropStoreFieldValue("anchorNodes",[]),this.notifyAnchorNodesChanged()},getConnectorCount:function(){return this.getConnectors().length},indexOfConnector:function(connector){return this.getConnectors().indexOf(connector)},getConnectorAt:function(index){return this.getConnectors()[index]},indexStackOfConnector:function(connector){var index=this.indexOfConnector(connector);if(index>=0)return index;for(var stack=null,i=0,l=this.getNodeCount();i<l;++i){var n=this.getNodeAt(i);if(n.indexStackOfConnector&&(stack=n.indexStackOfConnector(connector),!Kekule.ObjUtils.isUnset(stack)))return"object"!=(void 0===stack?"undefined":_typeof(stack))&&(stack=[stack]),stack.unshift(i),stack}return stack},getConnectorAtIndexStack:function(indexStack){if(indexStack=Kekule.ArrayUtils.toArray(indexStack),indexStack.length<=0)return null;if(1===indexStack.length)return this.getConnectorAt(indexStack[0]);for(var stackTail=indexStack.length-1,node=this.getNodeAt(indexStack[0]),i=1;i<stackTail;++i){if(!node||!node.getNodeAt)return null;node=node.getNodeAt(indexStack[i])}return node?node.getConnectorAt(indexStack[stackTail]):null},appendConnector:function(connector){var r=Kekule.ArrayUtils.pushUniqueEx(this.getConnectors(),connector);return r.isPushed&&(connector.setOwner&&connector.setOwner(this.getOwner()),connector.setParent&&connector.setParent(this.getParent()),this.notifyConnectorsChanged()),r.index},insertConnectorAt:function(connector,index){var i=this.indexOfConnector(connector),connectors=this.getConnectors();(Kekule.ObjUtils.isUnset(index)||index<0)&&(index=connectors.length),i>=0?(connectors.splice(i,1),connectors.splice(index,0,connector)):(connectors.splice(index,0,connector),connector.setOwner&&connector.setOwner(this.getOwner()),connector.setParent&&connector.setParent(this.getParent())),this.notifyConnectorsChanged()},setConnectorIndex:function(connector,index){var connectors=this.getConnectors(),i=this.indexOfConnector(connector);i>=0&&(connectors.splice(i,1),connectors.splice(index,0,connector))},removeConnectorAt:function(index,preserveConnectedObjs){var connector=this.getConnectors()[index];connector&&(preserveConnectedObjs||connector.removeThisFromConnectedObjs(),this.getConnectors().splice(index,1),connector.setOwner&&connector.setOwner(null),connector.setParent&&connector.setParent(null),this.notifyConnectorsChanged())},removeConnector:function(connector,preserveConnectedObjs){var index=this.getConnectors().indexOf(connector);index>=0&&this.removeConnectorAt(index,preserveConnectedObjs)},clearConnectors:function(){this.setPropStoreFieldValue("connectors",[]),this.notifyConnectorsChanged()},hasConnector:function(connector,checkNestedStructure){var found=this.indexOfConnector(connector)>=0;if(!found&&checkNestedStructure)for(var i=0,l=this.getNodeCount();i<l;++i){var n=this.getNodeAt(i);if(n.hasConnector&&(found=n.hasConnector(connector,!0)),found)break}return found},sortConnectors:function(sortFunc){sortFunc?(this.getConnectors().sort(sortFunc),this.notifyConnectorsChanged()):Kekule.error(Kekule.$L("ErrorMsg.SORT_FUNC_UNSET"))},_createBond:function(nodesOrIndexes,bondOrder,bondType){for(var connectedObjs=[],i=0,l=nodesOrIndexes.length;i<l;++i){var a=nodesOrIndexes[i];DataType.isSimpleValue(a)&&(a=this.getNodeAt(a)),connectedObjs.push(a)}return new Kekule.Bond(null,connectedObjs,bondOrder,null,bondType)},appendBond:function(nodesOrIndexes,bondOrder,bondType){var bond=this._createBond(nodesOrIndexes,bondOrder,bondType);return bond&&this.appendConnector(bond),bond},_getObjsNeedToBeCascadeRemoved:function(childObj,ignoredChildObjs){for(var result=[],linkedConnectors=childObj.getLinkedConnectors?childObj.getLinkedConnectors():[],i=0,l=linkedConnectors.length;i<l;++i){var connector=linkedConnectors[i];(!ignoredChildObjs||ignoredChildObjs.indexOf(connector)<0)&&connector.getConnectedObjs().length<=2&&Kekule.ArrayUtils.pushUnique(result,connector)}if(childObj instanceof Kekule.ChemStructureNode);else if(childObj instanceof Kekule.ChemStructureConnector)for(var objs=childObj.getConnectedObjs(),i=0,l=objs.length;i<l;++i){var obj=objs[i];(!ignoredChildObjs||ignoredChildObjs.indexOf(obj)<0)&&obj instanceof Kekule.ChemStructureNode&&obj.getLinkedConnectors().length<=1&&Kekule.ArrayUtils.pushUnique(result,obj)}var ignoredObjs=[].concat(result);ignoredObjs.push(childObj);for(var secondLevelObjs=[],i=0,l=result.length;i<l;++i){var obj=result[i];if(obj!==childObj)var cascadeObjs=this._getObjsNeedToBeCascadeRemoved(obj,ignoredObjs);Kekule.ArrayUtils.pushUnique(secondLevelObjs,cascadeObjs)}return Kekule.ArrayUtils.pushUnique(result,secondLevelObjs),result},removeChildObj:function(childObj,cascadeRemove,freeRemoved){var objs;cascadeRemove?(objs=this._getObjsNeedToBeCascadeRemoved(childObj),Kekule.ArrayUtils.pushUnique(objs,childObj)):objs=[childObj];for(var i=0,l=objs.length;i<l;++i){var obj=objs[i];obj instanceof Kekule.BaseStructureConnector?this.removeConnector(obj):obj instanceof Kekule.BaseStructureNode&&this.removeNode(obj)}if(freeRemoved)for(var i=objs.length-1;i>=0;--i){var obj=objs[i];obj.finalize&&obj.finalize()}},removeChild:function($super,obj){return this.removeChildObj(obj)||$super(obj)},deleteChildObj:function(childObj,cascadeDelete){return this.removeChildObj(childObj,cascadeDelete,!0)},hasChildObj:function(childObj){return this.hasNode(childObj)||this.hasConnector(childObj)},getNextSiblingOfChild:function(childObj){if(childObj instanceof Kekule.ChemStructureNode){var index=this.indexOfNode(childObj);if(index>=0)return this.getNodeAt(index+1)}else if(childObj instanceof Kekule.ChemStructureConnector){var index=this.indexOfConnector(childObj);if(index>=0)return this.getConnectorAt(index+1)}return null},insertBefore:function(obj,refChild){if(obj instanceof Kekule.BaseStructureNode){var refIndex=this.indexOfNode(refChild);return this.insertNodeAt(obj,refIndex)}if(obj instanceof Kekule.BaseStructureConnector){var refIndex=this.indexOfConnector(refChild);return this.insertConnectorAt(obj,refIndex)}return-1},clear:function(){this.clearNodes(),this.clearConnectors()},getChildCount:function(){return this.getNodeCount()+this.getConnectorCount()},getChildAt:function(index){var nodeCount=this.getNodeCount();return index<nodeCount?this.getNodeAt(index):this.getConnectorAt(index-nodeCount)},indexOfChild:function(obj){var result;if(obj instanceof Kekule.BaseStructureNode)result=this.indexOfNode(obj);else if(obj instanceof Kekule.BaseStructureConnector){if((result=this.indexOfConnector(obj))>=0){var nodeCount=this.getNodeCount();result+=nodeCount}}else result=-1;return result},indexStackOfChild:function(obj){var result;if(obj instanceof Kekule.BaseStructureNode)result=this.indexStackOfNode(obj);else if(obj instanceof Kekule.BaseStructureConnector){var nodeCount=this.getNodeCount();result=this.indexStackOfConnector(obj),result.length?result[result.length-1]+=nodeCount:result+=nodeCount}else result=-1;return result},getChildAtIndexStack:function(indexStack){if(indexStack=Kekule.ArrayUtils.toArray(indexStack),indexStack.length<=0)return null;for(var child=this.getChildAt(indexStack[0]),i=1,l=indexStack.length;i<l;++i){if(!child||!child.getChildAt)return null;child=child.getChildAt(indexStack[i])}return child},isSubFragment:function(node){return node.getNodeCount&&node.getNodeCount()>0},getSubFragments:function(){for(var result=[],i=0,l=this.getNodeCount();i<l;++i){var node=this.getNodeAt(i);this.isSubFragment(node)&&result.push(node)}return result},hasSubFragments:function(){var subs=this.getSubFragments();return subs&&subs.length},getLeafNodes:function(){for(var result=[],i=0,l=this.getNodeCount();i<l;++i){var node=this.getNodeAt(i);if(this.isSubFragment(node)){if(node.getLeafNodes){var leafs=node.getLeafNodes();result=result.concat(leafs)}}else result.push(node)}return result},findDirectChildOfObj:function(originObj){for(var obj=originObj;obj&&this.indexOfChild(obj)<0;)obj=obj.getParent?obj.getParent():null;return obj},getAllChildConnectors:function(){for(var result=[].concat(this.getConnectors()),subFrags=this.getSubFragments(),i=0,l=subFrags.length;i<l;++i)subFrags[i].getAllChildConnectors&&(result=result.concat(subFrags[i].getAllChildConnectors()));return result},getAllContainingConnectors:function(){return this.getAllChildConnectors()},getIsotopeMaps:function(){var nodes=this.getNodes();if(nodes.length<=0)return[];for(var addIsotope=function(maps,isotope,count,charge){for(var isOldIsotope=!1,j=0,k=maps.length;j<k;++j)isotope.isSame(maps[j].isotope)&&(isOldIsotope=!0,maps[j].count+=count,maps[j].charge+=charge||0);if(!isOldIsotope){var item={isotope:isotope,count:count,charge:node.getCharge()||0};maps.push(item)}return maps},result=[],i=0,l=nodes.length;i<l;++i){var node=nodes[i];if(node instanceof Kekule.StructureFragment)for(var subMaps=node.getIsotopeMaps(),i=0,l=subMaps.length;i<l;++i)result=addIsotope(result,subMaps[i].isotope,subMaps[i].count,subMaps[i].charge||0);else if(node instanceof Kekule.Atom){node.getIsotope();result=addIsotope(result,node.getIsotope(),1,node.getCharge()||0);var hcount=node.getHydrogenCount();if(hcount>0){var helem=Kekule.IsotopeFactory.getIsotope(1);result=addIsotope(result,helem,hcount,0)}}}return result},calcFormula:function(){var isotopeMaps=this.getIsotopeMaps();if(isotopeMaps.length<=0)return null;for(var result=new Kekule.MolecularFormula,i=0,l=isotopeMaps.length;i<l;++i){var fakeAtom=new Kekule.Atom;fakeAtom.setIsotope(isotopeMaps[i].isotope),result.appendSection(fakeAtom,isotopeMaps[i].count,isotopeMaps[i].charge)}return result},getNodesContainBox:function(nodes,coordMode,allowCoordBorrow){for(var is3D=coordMode===Kekule.CoordMode.COORD3D,result={},i=0,l=nodes.length;i<l;++i){var node=nodes[i],coord=node.getAbsCoordOfMode(coordMode,allowCoordBorrow);0==i?(result.x1=result.x2=coord.x,result.y1=result.y2=coord.y,is3D&&(result.z1=result.z2=coord.z)):(coord.x<result.x1?result.x1=coord.x:coord.x>result.x2&&(result.x2=coord.x),coord.y<result.y1?result.y1=coord.y:coord.y>result.y2&&(result.y2=coord.y),is3D&&(coord.z<result.z1?result.z1=coord.z:coord.z>result.z2&&(result.z2=coord.z)))}return result},getContainerBox:function(coordMode,allowCoordBorrow){return this.getNodesContainBox(this.getNodes(),coordMode,allowCoordBorrow)},getContainerBox2D:function(allowCoordBorrow){var result=this.getContainerBox(Kekule.CoordMode.COORD2D,allowCoordBorrow);return result.width=result.x2-result.x1,result.height=result.y2-result.y1,result},getContainerBox3D:function(allowCoordBorrow){var result=this.getContainerBox(Kekule.CoordMode.COORD3D,allowCoordBorrow);return result.deltaX=result.x2-result.x1,result.deltaY=result.y2-result.y1,result.deltaZ=result.z2-result.z1,result}}),Kekule.StructureFragment=Class.create(Kekule.ChemStructureNode,{CLASS_NAME:"Kekule.StructureFragment",initialize:function($super,id,coord2D,coord3D){$super(id,coord2D,coord3D)},doFinalize:function($super){this.hasFormula()&&this.getFormula().finalize(),this.hasCtab()&&this.getCtab().finalize(),$super()},initProperties:function(){this.defineProp("formula",{dataType:"Kekule.MolecularFormula",getter:function(allowCreate){return this.getPropStoreFieldValue("formula")||allowCreate&&this.createFormula(),this.getPropStoreFieldValue("formula")},setter:function(value){var old=this.getPropStoreFieldValue("formula");old&&(old.finalize(),old=null),value&&(value.setPropValue("parent",this,!0),value.addEventListener("change",function(e){this.notifyPropSet("formula",this.getFormula())},this)),this.setPropStoreFieldValue("formula",value)}}),this.defineProp("ctab",{dataType:"Kekule.StructureConnectionTable",getter:function(allowCreate){return this.getPropStoreFieldValue("ctab")||allowCreate&&this.createCtab(),this.getPropStoreFieldValue("ctab")},setter:function(value){var old=this.getPropStoreFieldValue("ctab");old&&(old.finalize(),old=null),value&&(value.setPropValue("parent",this,!0),value.setOwner(this.getOwner()),value.addEventListener("propValueSet",function(e){"nodes"!=e.propName&&"anchorNodes"!=e.propName&&"connectors"!=e.propName||this.notifyPropSet(e.propName,e.propValue)},this),value.setEnablePropValueSetEvent(!0)),this.setPropStoreFieldValue("ctab",value)}}),this.defineProp("nodes",{dataType:DataType.ARRAY,serializable:!1,scope:Class.PropertyScope.PUBLISHED,setter:null,getter:function(){return this.hasCtab()?this.getCtab().getNodes():[]}}),this.defineProp("anchorNodes",{dataType:DataType.ARRAY,serializable:!1,scope:Class.PropertyScope.PUBLISHED,setter:null,getter:function(){return this.hasCtab()?this.getCtab().getAnchorNodes():[]}}),this.defineProp("connectors",{dataType:DataType.ARRAY,serializable:!1,scope:Class.PropertyScope.PUBLISHED,setter:null,getter:function(){return this.hasCtab()?this.getCtab().getConnectors():[]}}),this.defineProp("crossConnectors",{dataType:DataType.ARRAY,serializable:!1,setter:null,scope:Class.PropertyScope.PUBLIC,getter:function(){for(var result=[].concat(this.getPropStoreFieldValue("linkedConnectors")),i=0,l=this.getNodeCount();i<l;++i)for(var node=this.getNodeAt(i),connectors=node.getLinkedConnectors()||[],j=0,k=connectors.length;j<k;++j)this.indexOfConnector(connectors[j])<0&&Kekule.ArrayUtils.pushUnique(result,connectors[j]);return result}}),this.defineProp("nonHydrogenNodes",{dataType:DataType.ARRAY,scope:Class.PropertyScope.PUBLIC,serializable:!1,setter:null,getter:function(){return this.hasCtab()?this.getCtab().getNonHydrogenNodes():[]}}),this.defineProp("nonHydrogenConnectors",{dataType:DataType.ARRAY,scope:Class.PropertyScope.PUBLIC,serializable:!1,setter:null,getter:function(){return this.hasCtab()?this.getCtab().getNonHydrogenConnectors():[]}}),this.defineProp("canonicalizationInfo",{dataType:DataType.OBJECT,serializable:!1,scope:Class.PropertyScope.PUBLIC}),this.defineProp("aromaticRings",{dataType:DataType.ARRAY,serializable:!1,scope:Class.PropertyScope.PUBLIC,getter:function(){var result=this.getPropStoreFieldValue("aromaticRings");return result||(result=[],this.setPropStoreFieldValue("aromaticRings",result)),result}}),this.defineProp("flattenedShadow",{dataType:"Kekule.StructureFragmentShadow",serializable:!1,scope:Class.PropertyScope.PRIVATE,getter:function(autoCreate){var result=null;if(Kekule.ObjUtils.isUnset(autoCreate)&&(autoCreate=!0),this.getFlattenedShadowOnSelf())return null;if(!(result=this.getPropStoreFieldValue("flattenedShadow"))&&autoCreate){result=new Kekule.StructureFragmentShadow(this);var shadowFragment=result.getShadowFragment();shadowFragment.unmarshalAllSubFragments(!0),this._copyAdditionalInfoToShadowFragment(shadowFragment,result.getSourceToShadowMap(),result.getShadowToSourceMap()),this.setPropStoreFieldValue("flattenedShadow",result)}return result}}),this.defineProp("flattenedShadowOnSelf",{dataType:DataType.BOOL,serializable:!1,scope:Class.PropertyScope.PROVATE,setter:null,getter:function(){var result=this.setPropStoreFieldValue("flattenedShadowOnSelf");return Kekule.ObjUtils.isUnset(result)&&(result=!this.hasSubFragments(),this.setPropStoreFieldValue("flattenedShadowOnSelf",result)),result}})},getAutoIdPrefix:function(){return"f"},getStructureRelatedPropNames:function($super){return $super().concat(["ctab","formula","nodes","anchorNodes","connectors"])},doCompare:function($super,targetObj,options){var result=$super(targetObj,options);if(!result&&options.method===Kekule.ComparisonMethod.CHEM_STRUCTURE){var hasCtab1=this.hasCtab(),hasCtab2=targetObj.hasCtab&&targetObj.hasCtab();if(!(result=hasCtab1?hasCtab2?0:1:hasCtab2?-1:0)){var hasFormula1=this.hasFormula(),hasFormula2=targetObj.hasFormula&&targetObj.hasFormula();result=hasFormula1?hasFormula2?0:1:hasFormula2?-1:0}if(!result&&this.hasCtab()){if(0===result&&this.getNonHydrogenNodes&&targetObj.getNonHydrogenNodes){var nodes1=this.getNonHydrogenNodes(),nodes2=targetObj.getNonHydrogenNodes();if(0===(result=nodes1.length-nodes2.length))for(var i=0,l=nodes1.length;i<l&&0===(result=this.doCompareOnValue(nodes1[i],nodes2[i],options));++i);}if(0===result&&this.getConnectors&&targetObj.getConnectors){var connectors1=this.getNonHydrogenConnectors(),connectors2=targetObj.getNonHydrogenConnectors();if(0===(result=connectors1.length-connectors2.length))for(var i=0,l=connectors1.length;i<l&&0===(result=this.doCompareOnValue(connectors1[i],connectors2[i],options));++i);}}}return result},structureChange:function($super,originObj){this.setPropStoreFieldValue("flattenedShadowOnSelf",null);var shadow=this.getFlattenedShadow(!1);shadow&&(shadow.finalize(),this.setPropStoreFieldValue("flattenedShadow",null)),$super(originObj)},clearStructureFlags:function($super){$super(),this.setPropStoreFieldValue("canonicalizationInfo",null),this.setPropStoreFieldValue("aromaticRings",[]);for(var i=0,l=this.getChildCount();i<l;++i){var c=this.getChildAt(i);c.clearStructureFlags&&c.clearStructureFlags()}},ownerChanged:function($super,newOwner){this.hasCtab()&&this.getCtab().setOwner(newOwner),$super(newOwner)},_removeChildObj:function(obj){if(this.hasFormula()){this.getFormula()===obj&&this.removeFormula()}else if(this.hasCtab()){var ctab=this.getCtab();ctab===obj?this.removeCtab():ctab.hasChildObj(obj)&&ctab.removeChildObj(obj)}},isEmpty:function(){var result;return(result=!this.hasFormula())&&((result=!this.hasCtab())||(result=this.getCtab().isEmpty())),result},isCtabEmpty:function(){return!this.hasCtab()||this.getCtab().isEmpty()},doGetLinkedConnectors:function(){return this.getCrossConnectors()},appendLinkedConnector:function($super,connector){var actualLinkedNode=this.getCurrConnectableObj();return actualLinkedNode&&actualLinkedNode!==this?actualLinkedNode.appendLinkedConnector(connector):$super(connector)},getCurrConnectableObj:function(){var candidates=this.getAnchorNodeCount()>0?this.getAnchorNodes():this.getNodes();if(candidates.length<=0)return this;for(var allCrossConnectors=this.getCrossConnectors(),minCrossConnectorCount=null,minNode=null,i=0,l=candidates.length;i<l;++i){var node=candidates[i],connectors=node.getLinkedConnectors(),crossConnectors=Kekule.ArrayUtils.intersect(connectors,allCrossConnectors),crossConnectorCount=crossConnectors.length;(null===minCrossConnectorCount||minCrossConnectorCount>crossConnectorCount)&&(minCrossConnectorCount=crossConnectorCount,minNode=node)}return minNode},createCtab:function(){var ctab=new Kekule.StructureConnectionTable(this.getOwner(),this);this.setCtab(ctab)},createFormula:function(){var formula=new Kekule.MolecularFormula(this);this.setFormula(formula)},hasCtab:function(){return!!this.getPropStoreFieldValue("ctab")},hasFormula:function(){return!!this.getPropStoreFieldValue("formula")},removeFormula:function(){var f=this.getPropStoreFieldValue("formula");return f&&(f.finalize(),f=null,this.setPropStoreFieldValue("formula",null)),this},removeCtab:function(){var f=this.getPropStoreFieldValue("ctab");return f&&(f.finalize(),f=null,this.setPropStoreFieldValue("ctab",null)),this},getContainerBox:function($super,coordMode,allowCoordBorrow){return this.hasCtab()?this.getCtab().getContainerBox(coordMode,allowCoordBorrow):$super(coordMode)},getNodeById:function(id){return this.hasCtab()?this.getCtab().getNodeById(id):null},getConnectorById:function(id){return this.hasCtab()?this.getCtab().getConnectorById(id):null},getObjectById:function(id){var node=this.getNodeById(id);return node||this.getConnectorById(id)},getNodeCount:function(){return this.hasCtab()?this.getCtab().getNodeCount():0},getNodeAt:function(index){return this.hasCtab()?this.getCtab().getNodeAt(index):null},indexOfNode:function(node){return this.hasCtab()?this.getCtab().indexOfNode(node):-1},hasNode:function(node,checkNestedStructure){return this.hasCtab()?this.getCtab().hasNode(node,checkNestedStructure):null},indexStackOfNode:function(node){return this.hasCtab()?this.getCtab().indexStackOfNode(node):-1},getNodeAtIndexStack:function(indexStack){return this.hasCtab()?this.getCtab().getNodeAtIndexStack(indexStack):null},getDirectChildOfNestedNode:function(node){var p=node.getParent();if(p){if(p===this)return p;for(var curr=node;p&&p.getParent&&p!==this;)curr=p,p=p.getParent();return p===this?curr:null}return null},appendNode:function(node){return this.doGetCtab(!0).appendNode(node)},insertNodeAt:function(node,index){return this.doGetCtab(!0).insertNodeAt(node,index)},removeNodeAt:function(index,preserveLinkedConnectors){return this.hasCtab()?this.getCtab().removeNodeAt(index,preserveLinkedConnectors):null},removeNode:function(node,preserveLinkedConnectors){return this.hasCtab()?this.getCtab().removeNode(node,preserveLinkedConnectors):null},replaceNode:function(oldNode,newNode){return this.hasCtab()?this.getCtab().replaceNode(oldNode,newNode):null},clearNodes:function(){if(this.hasCtab())return this.getCtab().clearNodes()},sortNodes:function(sortFunc){if(this.hasCtab())return this.getCtab().sortNodes(sortFunc)},nodesHasCoord2D:function(allowCoordBorrow){return!!this.hasCtab()&&this.getCtab().nodesHasCoord2D(allowCoordBorrow)},nodesHasCoord3D:function(allowCoordBorrow){return!!this.hasCtab()&&this.getCtab().nodesHasCoord3D(allowCoordBorrow)},isNodeInAromaticRing:function(node){for(var rings=this.getAromaticRings(),i=0,l=rings.length;i<l;++i){if(rings[i].nodes.indexOf(node)>=0)return!0}return!1},appendAtom:function(elemSymbolOrAtomicNumber,massNumber,coord2D,coord3D){return this.doGetCtab(!0).appendAtom(elemSymbolOrAtomicNumber,massNumber,coord2D,coord3D)},getAnchorNodeCount:function(){return this.hasCtab()?this.getCtab().getAnchorNodeCount():0},getAnchorNodeAt:function(index){return this.hasCtab()?this.getCtab().getAnchorNodeAt(index):null},indexOfAnchorNode:function(node){return this.hasCtab()?this.getCtab().indexOfAnchorNode(node):-1},appendAnchorNode:function(node){return this.doGetCtab(!0).appendAnchorNode(node)},removeAnchorNodeAt:function(index){return this.hasCtab()?this.getCtab().removeAnchorNodeAt(index):null},removeAnchorNode:function(node){return this.hasCtab()?this.getCtab().removeAnchorNode(node):null},clearAnchorNodes:function(){if(this.hasCtab())return this.getCtab().clearAnchorNodes()},getConnectorCount:function(){return this.hasCtab()?this.getCtab().getConnectorCount():0},getConnectorAt:function(index){return this.hasCtab()?this.getCtab().getConnectorAt(index):null},indexOfConnector:function(connector){return this.hasCtab()?this.getCtab().indexOfConnector(connector):-1},hasConnector:function(connector,checkNestedStructure){return this.hasCtab()?this.getCtab().hasConnector(connector,checkNestedStructure):null},appendConnector:function(connector){return this.doGetCtab(!0).appendConnector(connector)},insertConnectorAt:function(connector,index){return this.doGetCtab(!0).insertConnectorAt(connector,index)},removeConnectorAt:function(index,preserveConnectedObjs){return this.hasCtab()?this.getCtab().removeConnectorAt(index,preserveConnectedObjs):null},removeConnector:function(connector,preserveConnectedObjs){return this.hasCtab()?this.getCtab().removeConnector(connector,preserveConnectedObjs):null},clearConnectors:function(){if(this.hasCtab())return this.getCtab().clearConnectors()},sortConnectors:function(sortFunc){if(this.hasCtab())return this.getCtab().sortConnectors(sortFunc)},isConnectorInAromaticRing:function(connector){for(var rings=this.getAromaticRings(),i=0,l=rings.length;i<l;++i){if(rings[i].connectors.indexOf(connector)>=0)return!0}return!1},appendBond:function(nodesOrIndexes,bondOrder,bondType){return this.doGetCtab(!0).appendBond(nodesOrIndexes,bondOrder,bondType)},insertBefore:function($super,obj,refChild){var result=-1;return this.hasCtab()&&obj instanceof Kekule.ChemStructureObject&&(!refChild||refChild instanceof Kekule.ChemStructureObject)&&(result=this.getCtab().insertBefore(obj,refChild)),result<0&&(result=$super(obj,refChild)),result},_getObjsNeedToBeCascadeRemoved:function(childObj,ignoredChildObjs){return this.hasCtab()?this.getCtab()._getObjsNeedToBeCascadeRemoved(childObj,ignoredChildObjs):[]},removeChildObj:function(childObj,cascadeRemove,freeRemoved){this.hasCtab()&&this.getCtab().removeChildObj(childObj,cascadeRemove,freeRemoved)},removeChild:function($super,obj){return this.removeChildObj(obj)||$super(obj)},hasChildObj:function(childObj){return!!this.hasCtab()&&this.getCtab().hasChildObj(childObj)},getNextSiblingOfChild:function(childObj){return this.hasCtab()?this.getCtab().getNextSiblingOfChild(childObj):null},getChildCount:function(){return this.hasCtab()?this.getCtab().getChildCount():0},getChildAt:function(index){return this.hasCtab()?this.getCtab().getChildAt(index):null},indexOfChild:function(obj){return this.hasCtab()?this.getCtab().indexOfChild(obj):-1},isSubFragment:function(node){return node.getNodeCount&&node.getNodeCount()>0},getSubFragments:function(){return this.hasCtab()?this.getCtab().getSubFragments():[]},hasSubFragments:function(){return!!this.hasCtab()&&this.getCtab().hasSubFragments()},getLeafNodes:function(){return this.hasCtab()?this.getCtab().getLeafNodes():[]},findDirectChildOfObj:function(originObj){return this.hasCtab()?this.getCtab().findDirectChildOfObj(originObj):null},getAllChildConnectors:function(){return this.hasCtab()?this.getCtab().getAllChildConnectors():[]},getAllContainingConnectors:function(){return this.hasCtab()?this.getCtab().getAllContainingConnectors():[]},clear:function(){this.hasCtab()&&this.setCtab(void 0),this.hasFormula()&&this.setFormula(void 0)},calcFormula:function(){return this.hasCtab()?this.getCtab().calcFormula():this.hasFormula()?this.getFormula():null},marshalSubFragment:function(groupNodes,subFragment){if(this.hasCtab()){this.beginUpdate();try{this.appendNode(subFragment);for(var nodes=[],anchors=[],innerConnectors=[],externalConnectors=[],i=0,l=groupNodes.length;i<l;++i){var node=groupNodes[i];if(!(this.indexOfNode(node)<0)){for(var isAnchor=!1,connectors=node.getLinkedConnectors(),j=0,k=connectors.length;j<k;++j){for(var connector=connectors[j],isExternalConnector=!1,objs=connector.getConnectedObjs(),m=0,n=objs.length;m<n;++m){var obj=objs[m];obj!=node&&groupNodes.indexOf(obj)<0&&(isAnchor=!0,isExternalConnector=!0)}isExternalConnector?Kekule.ArrayUtils.pushUnique(externalConnectors,connector):Kekule.ArrayUtils.pushUnique(innerConnectors,connector)}Kekule.ArrayUtils.pushUnique(nodes,node),isAnchor&&Kekule.ArrayUtils.pushUnique(anchors,node)}}for(var i=innerConnectors.length-1;i>=0;--i)this.removeConnector(innerConnectors[i],!0);for(var i=nodes.length-1;i>=0;--i)this.removeNode(nodes[i],!0);subFragment.beginUpdate();try{for(var i=0,l=nodes.length;i<l;++i)subFragment.appendNode(nodes[i]);for(var i=0,l=anchors.length;i<l;++i)subFragment.appendAnchorNode(anchors[i]);for(var i=0,l=innerConnectors.length;i<l;++i)subFragment.appendConnector(innerConnectors[i])}finally{subFragment.endUpdate()}}finally{this.endUpdate()}return subFragment}return null},unmarshalSubFragment:function(subFragment,cascade){if(this.hasCtab()){this.beginUpdate();try{subFragment.beginUpdate();try{cascade&&subFragment.unmarshalAllSubFragments&&subFragment.unmarshalAllSubFragments(cascade);var ctab=this.getCtab();Kekule.StructureFragment.moveChildBetweenStructFragment(subFragment,this,subFragment.getNodes(),subFragment.getConnectors(),!0),subFragment.clear(),ctab.removeNode(subFragment)}finally{subFragment.endUpdate(),subFragment.finalize()}}finally{this.endUpdate()}}},unmarshalAllSubFragments:function(cascade){var sfs=this.getSubFragments();if(sfs)for(var i=0,l=sfs.length;i<l;++i)this.unmarshalSubFragment(sfs[i],cascade)},recalcCoords:function(){if(this.hasCtab()){this.beginUpdate();try{for(var newCenter2D={},newCenter3D={},anchorCount=this.getAnchorNodeCount(),i=0,l=anchorCount;i<l;++i){var node=this.getAnchorNodeAt(i);newCenter2D=Kekule.CoordUtils.add(newCenter2D,node.getCoord2D()||{}),newCenter3D=Kekule.CoordUtils.add(newCenter3D,node.getCoord3D()||{})}var notUnset=Kekule.ObjUtils.notUnset,has2D=notUnset(newCenter2D.x)||notUnset(newCenter2D.y),has3D=notUnset(newCenter3D.x)||notUnset(newCenter3D.y)||notUnset(newCenter3D.z);if(has2D){var delta2D=Kekule.CoordUtils.substract({},newCenter2D);this.setCoord2D(Kekule.CoordUtils.substract(this.fetchCoord2D(),delta2D))}if(has3D){var delta3D=Kekule.CoordUtils.substract({},newCenter3D);this.setCoord3D(Kekule.CoordUtils.substract(this.fetchCoord3D(),delta3D))}for(var i=0,l=this.getNodeCount();i<l;++i){var node=this.getNodeAt(i);has2D&&node.setCoord2D(Kekule.CoordUtils.add(node.fetchCoord2D(),delta2D)),has3D&&node.setCoord3D(Kekule.CoordUtils.add(node.fetchCoord3D(),delta3D))}}finally{this.endUpdate()}}},_copyAdditionalInfoToShadowFragment:function(shadowFragment,srcToShadowMap,shadowToSrcMap){var sourceFragment=this,srcAromaticRings=sourceFragment.getAromaticRings();if(srcAromaticRings&&srcAromaticRings.length){for(var shadowAromaticRings=[],i=0,l=srcAromaticRings.length;i<l;++i){for(var srcAromaticRing=srcAromaticRings[i],shadowNodes=[],shadowConnectors=[],j=0,k=srcAromaticRing.nodes.length;j<k;++j){var shadowObj=srcToShadowMap.get(srcAromaticRing.nodes[j]);shadowObj&&shadowNodes.push(shadowObj)}for(var j=0,k=srcAromaticRing.connectors.length;j<k;++j){var shadowObj=srcToShadowMap.get(srcAromaticRing.connectors[j]);shadowObj&&shadowConnectors.push(shadowObj)}shadowAromaticRings.push({nodes:shadowNodes,connectors:shadowConnectors})}shadowFragment.setAromaticRings(shadowAromaticRings)}},getFlattenedShadowFragment:function(autoCreate){if(this.getFlattenedShadowOnSelf())return this;var shadow=this.getFlattenedShadow(autoCreate);return shadow?shadow.getShadowFragment():null},getFlatternedShadowShadowObj:function(srcObj,autoCreate){if(this.getFlattenedShadowOnSelf())return srcObj;var shadow=this.getFlattenedShadow(autoCreate);return shadow?shadow.getShadowObj(srcObj):null},getFlatternedShadowSourceObj:function(shadowObj,autoCreate){if(this.getFlattenedShadowOnSelf())return shadowObj;var shadow=this.getFlattenedShadow(autoCreate);return shadow?shadow.getSourceObj(shadowObj):null},getFlatternedShadowShadowObjs:function(srcObjs,autoCreate){if(this.getFlattenedShadowOnSelf())return srcObjs;var shadow=this.getFlattenedShadow(autoCreate),result=[];if(shadow)for(var i=0,l=srcObjs.length;i<l;++i)result.push(shadow.getShadowObj(srcObjs[i]));return result},getFlatternedShadowSourceObjs:function(shadowObjs,autoCreate){if(this.getFlattenedShadowOnSelf())return shadowObjs;var shadow=this.getFlattenedShadow(autoCreate),result=[];if(shadow)for(var i=0,l=shadowObjs.length;i<l;++i)result.push(shadow.getSourceObj(shadowObjs[i]));return result}}),Kekule.StructureFragment.moveChildBetweenStructFragment=function(target,dest,moveNodes,moveConnectors,ignoreAnchorNodes){var CU=Kekule.CoordUtils;target.beginUpdate(),dest.beginUpdate();var anchorNodes=target.getAnchorNodes();try{for(var targetCoord2D=target.getAbsCoord2D(),targetCoord3D=target.getAbsCoord3D(),destCoord2D=dest.getAbsCoord2D(),destCoord3D=dest.getAbsCoord3D(),coordDelta2D=CU.substract(targetCoord2D,destCoord2D),coordDelta3D=CU.substract(targetCoord3D,destCoord3D),nodes=Kekule.ArrayUtils.clone(moveNodes),connectors=Kekule.ArrayUtils.clone(moveConnectors),i=0,l=nodes.length;i<l;++i){var node=nodes[i],index=target.indexOfNode(node);if(index>=0){target.removeNodeAt(index,!0);var oldCoord2D=node.getCoord2D();if(oldCoord2D){var newCoord2D=CU.add(oldCoord2D,coordDelta2D);node.setCoord2D(newCoord2D)}var oldCoord3D=node.getCoord3D();if(oldCoord3D){var newCoord3D=CU.add(oldCoord3D,coordDelta3D);node.setCoord2D(newCoord3D)}dest.appendNode(node),anchorNodes.indexOf(node)>=0&&(target.removeAnchorNode(node),ignoreAnchorNodes||dest.appendAnchorNode(node))}}for(var i=0,l=connectors.length;i<l;++i){var connector=connectors[i],index=target.indexOfConnector(connector);index>=0&&(target.removeConnectorAt(index,!0),dest.appendConnector(connector))}}finally{dest.endUpdate(),target.endUpdate()}},Kekule.StructureFragmentShadow=Class.create(ObjectEx,{CLASS_NAME:"Kekule.StructureFragmentShadow",initialize:function($super,srcFragment){if(!srcFragment)return void Kekule.error(Kekule.$L("ErrorMsg.SOURCE_FRAGMENT_NOT_SET"));$super(),this.setPropStoreFieldValue("shadowToSourceMap",new Kekule.MapEx),this.setPropStoreFieldValue("sourceToShadowMap",new Kekule.MapEx);var shadowFragment=this._createShadowFragment(srcFragment,this.getSourceToShadowMap(),this.getShadowToSourceMap());this.setPropStoreFieldValue("shadowFragment",shadowFragment)},doFinalize:function($super){this.getShadowToSourceMap().finalize(),this.getSourceToShadowMap().finalize(),this.getShadowFragment().finalize(),this.setPropStoreFieldValue("shadowToSourceMap",null),this.setPropStoreFieldValue("sourceToShadowMap",null),this.setPropStoreFieldValue("shadowFragment",null),$super()},initProperties:function(){this.defineProp("shadowFragment",{dataType:"Kekule.StructureFragment",setter:null}),this.defineProp("sourceToShadowMap",{dataType:"Kekule.MapEx",setter:null}),this.defineProp("shadowToSourceMap",{dataType:"Kekule.MapEx",setter:null})},_createShadowFragment:function(sourceFragment,srcToShadowMap,shadowToSrcMap){var result=sourceFragment.clone();return this._mapFragmentChildren(sourceFragment,result,srcToShadowMap,shadowToSrcMap),result},_mapFragmentChildren:function(src,shadow,srcToShadowMap,shadowToSrcMap){for(var i=0,l=src.getChildCount();i<l;++i){var srcObj=src.getChildAt(i),shadowObj=shadow.getChildAt(i);srcToShadowMap.set(srcObj,shadowObj),shadowToSrcMap.set(shadowObj,srcObj),srcObj.getChildCount&&shadowObj.getChildCount&&this._mapFragmentChildren(srcObj,shadowObj,srcToShadowMap,shadowToSrcMap)}},getShadowObj:function(srcObj){return this.getSourceToShadowMap().get(srcObj)},getSourceObj:function(shadowObj){return this.getShadowToSourceMap().get(shadowObj)}}),Kekule.SubGroup=Class.create(Kekule.StructureFragment,{CLASS_NAME:"Kekule.SubGroup",initialize:function($super,id,abbr,name,coord2D,coord3D){$super(id,coord2D,coord3D),this.setPropStoreFieldValue("abbr",abbr),this.setPropStoreFieldValue("name",name)},initProperties:function(){this.defineProp("abbr",{dataType:DataType.STRING}),this.defineProp("formulaText",{dataType:DataType.STRING}),this.defineProp("name",{dataType:DataType.STRING})},getAutoIdPrefix:function(){return"g"},doPropChanged:function($super,propName,newValue){return"anchorNodes"==propName&&this.recalcCoords(),$super(propName,newValue)},getLabel:function(){return Kekule.ChemStructureNodeLabels.SUBGROUP}}),Kekule.RGroup=Kekule.SubGroup,Kekule.Molecule=Class.create(Kekule.StructureFragment,{CLASS_NAME:"Kekule.Molecule",initialize:function($super,id,name,withCtab){$super(id),this.setPropStoreFieldValue("name",name),withCtab&&this.setCtab(new Kekule.StructureConnectionTable)},initProperties:function(){this.defineProp("name",{dataType:DataType.STRING})},getAutoIdPrefix:function(){return"m"}}),Kekule.BaseStructureConnector=Class.create(Kekule.ChemStructureObject,{CLASS_NAME:"Kekule.BaseStructureConnector",initialize:function($super,id,connectedObjs){$super(id),this.setConnectedObjs(connectedObjs||[])},initProperties:function(){this.defineProp("connectedObjs",{dataType:DataType.ARRAY,serializable:!1,scope:Class.PropertyScope.PUBLISHED,setter:function(value){var objs=this.getPropStoreFieldValue("connectedObjs");objs||(this.setPropStoreFieldValue("connectedObjs",[]),objs=this.getPropStoreFieldValue("connectedObjs"));for(var i=0,l=objs.length;i<l;++i)objs[i].removeLinkedConnector(this);if(value){for(var i=0,l=value.length;i<l;++i)this.assertConnectedObjLegal(value[i]);for(var i=0,l=value.length;i<l;++i){var obj=value[i],actualConnObj=obj.getCurrConnectableObj?obj.getCurrConnectableObj():obj;Kekule.ArrayUtils.pushUnique(objs,actualConnObj)}}else this.setPropStoreFieldValue("connectedObjs",[]);objs=this.getPropStoreFieldValue("connectedObjs");for(var i=0,l=objs.length;i<l;++i)objs[i].appendLinkedConnector(this);this.notifyConnectedObjsChanged()}})},getAutoIdPrefix:function(){return"c"},getStructureRelatedPropNames:function($super){return $super().concat(["connectedObjs"])},doCompare:function($super,targetObj,options){var result=$super(targetObj,options);if(!result&&options.method===Kekule.ComparisonMethod.CHEM_STRUCTURE&&this._getComparisonOptionFlagValue(options,"connectedObjCount")){var c1=this.getConnectedObjCount(),c2=targetObj.getConnectedObjCount&&targetObj.getConnectedObjCount();result=this.doCompareOnValue(c1,c2,options)}return result},notifyConnectedObjsChanged:function(){this.notifyPropSet("connectedObjs",this.getPropStoreFieldValue("connectedObjs"))},assertConnectedObjLegal:function(obj){if(obj&&obj.getOwner)return!obj.getOwner()||obj.getOwner()==this.getOwner()||(Kekule.chemError(Kekule.hasLocalRes()?Kekule.$L("ErrorMsg.UNABLE_ADD_DIFF_OWNER_OBJ"):"Object with different owner can not be linked to connector"),!1);Kekule.chemError(Kekule.hasLocalRes()?Kekule.$L("ErrorMsg.UNABLE_ADD_MISTYPED_NODE"):"Unable to link mistyped node to connector")},connectedObjAdded:function(obj){this.notifyConnectedObjsChanged()},getConnectedObjCount:function(){return this.getConnectedObjs().length},indexOfConnectedObj:function(obj){return this.getConnectedObjs().indexOf(obj)},getConnectedObjAt:function(index){return this.getConnectedObjs()[index]},setConnectedObjAt:function(index,value){this.assertConnectedObjLegal(value);var node=this.getConnectedObjs()[index];node&&node.removeLinkedConnector(this),this.insertConnectedObjAt(value,index),this.connectedObjAdded(value)},appendConnectedObj:function(obj){this.assertConnectedObjLegal(obj);var actualConnObj=obj.getCurrConnectableObj?obj.getCurrConnectableObj():obj,result=this._doAppendConnectedObj(actualConnObj);return actualConnObj&&actualConnObj.appendLinkedConnector(this),result},_doAppendConnectedObj:function(obj){var r=Kekule.ArrayUtils.pushUniqueEx(this.getConnectedObjs(),obj);return r.isPushed&&this.connectedObjAdded(obj),r.index},insertConnectedObjAt:function(obj,index){this.assertConnectedObjLegal(obj);var actualConnObj=obj.getCurrConnectableObj?obj.getCurrConnectableObj():obj,i=this.indexOfConnectedObj(actualConnObj),objs=this.getConnectedObjs();i>=0?(objs.splice(i,1),objs.splice(index,0,actualConnObj),this.notifyConnectedObjsChanged()):(objs.splice(index,0,actualConnObj),actualConnObj&&actualConnObj.appendLinkedConnector(this),this.connectedObjAdded(actualConnObj))},removeConnectedObjAt:function(index){var node=this.getConnectedObjs()[index];node&&(this._doRemoveConnectedObjAt(index),node._doRemoveLinkedConnectorAt(node.indexOfLinkedConnector(this)),this.notifyConnectedObjsChanged())},_doRemoveConnectedObjAt:function(index){this.getConnectedObjs().splice(index,1)},removeConnectedObj:function(obj){var index=this.getConnectedObjs().indexOf(obj);index>=0&&this.removeConnectedObjAt(index)},replaceConnectedObj:function(oldObj,newObj){var index=this.indexOfConnectedObj(oldObj);index>=0&&this.setConnectedObjAt(index,newObj)},clearConnectedObjs:function(){this.setConnectedObjs([])},hasConnectedObj:function(obj){return this.getConnectedObjs().indexOf(obj)>=0},isConnectingWithObj:function(obj){return this.hasConnectedObj(obj)},sortConnectedObjs:function(compareFunc){this.getConnectedObjs().sort(compareFunc)},reverseConnectedObjOrder:function(){this.setPropStoreFieldValue("connectedObjs",Kekule.ArrayUtils.reverse(this.getConnectedObjs())),this.notifyConnectedObjsChanged()},removeThisFromConnectedObjs:function(){for(var i=this.getConnectedObjCount()-1;i>=0;--i){this.getConnectedObjAt(i).removeLinkedConnector(this)}},getConnectedSiblings:function(){for(var objs=this.getConnectedObjs(),result=[],parent=this.getParent(),i=0,l=objs.length;i<l;++i){var obj=objs[i];if(obj.getParent&&obj.getParent()!==parent){var o=function getSiblingParent(childObj){if(childObj.getParent){var p=childObj.getParent();return p===parent?p:getSiblingParent(p)}return childObj}(obj);o&&result.push(o)}else result.push(obj)}return result},isConnectingConnector:function(){for(var i=0,l=this.getConnectedObjCount();i<l;++i){if(this.getConnectedObjAt(i)instanceof Kekule.ChemStructureConnector)return!0}return!1}}),Kekule.ChemStructureConnector=Class.create(Kekule.BaseStructureConnector,{CLASS_NAME:"Kekule.ChemStructureConnector",initProperties:function(){this.defineProp("parity",{dataType:DataType.INT}),this.defineProp("connectedChemNodes",{dataType:DataType.ARRAY,serializable:!1,scope:Class.PropertyScope.PUBLIC,setter:null,getter:function(){for(var result=[],i=0,l=this.getConnectedObjCount();i<l;++i){var obj=this.getConnectedObjAt(i);obj instanceof Kekule.ChemStructureNode&&result.push(obj)}return result}})},doCompare:function($super,targetObj,options){var result=$super(targetObj,options);if(!result&&options.method===Kekule.ComparisonMethod.CHEM_STRUCTURE&&this._getComparisonOptionFlagValue(options,"stereo")){var c1=this.getParity()||Kekule.StereoParity.UNKNOWN,c2=targetObj.getParity&&targetObj.getParity()||Kekule.StereoParity.UNKNOWN;result=this.doCompareOnValue(c1,c2,options)}return result},clearStructureFlags:function(){this.setParity(Kekule.StereoParity.NONE)},getConnectedChemNodeCount:function(){return this.getConnectedChemNodes().length},getConnectedNonHydrogenObjs:function(){for(var result=[],objs=this.getConnectedObjs(),i=0,l=objs.length;i<l;++i){var obj=objs[i];obj.isHydrogenAtom&&obj.isHydrogenAtom()||result.push(obj)}return result},isNormalConnectorToHydrogen:function(){return this.getConnectedNonHydrogenObjs().length<=1}}),Kekule.BondStereo={NONE:0,UP:1,UP_INVERTED:2,DOWN:3,DOWN_INVERTED:4,UP_OR_DOWN:8,UP_OR_DOWN_INVERTED:9,CLOSER:10,E_OR_Z:20,E:21,Z:22,E_Z_BY_COORDINATES:23,CIS_OR_TRANS:30,CIS:31,TRANS:32,getInvertedDirection:function(direction){var S=Kekule.BondStereo;switch(direction){case S.UP:return S.UP_INVERTED;case S.UP_INVERTED:return S.UP;case S.DOWN:return S.DOWN_INVERTED;case S.DOWN_INVERTED:return S.DOWN;case S.UP_OR_DOWN:return S.UP_OR_DOWN_INVERTED;default:return direction}}},Kekule.Bond=Class.create(Kekule.ChemStructureConnector,{CLASS_NAME:"Kekule.Bond",initialize:function($super,id,connectedObjs,bondOrder,electronCount,bondType){$super(id,connectedObjs||[]),(bondOrder||electronCount||bondType)&&this.setBondForm(Kekule.BondFormFactory.getBondForm(bondOrder,electronCount,bondType))},initProperties:function(){this.defineProp("bondForm",{dataType:"Kekule.BondForm",serializable:!1,scope:Class.PropertyScope.PUBLIC}),this.defineProp("bondType",{dataType:DataType.STRING,enumSource:Kekule.BondType,getter:function(){var f=this.getBondForm();return f?f.getBondType():Kekule.BondType.DEFAULT},setter:function(value){this.changeBondForm(this.getBondOrder(),Kekule.ElectronSet.UNSET_ELECTRONCOUNT,value)}}),this.defineProp("bondOrder",{dataType:DataType.INT,enumSource:Kekule.BondOrder,getter:function(){var f=this.getBondForm();return f?f.getBondOrder():Kekule.BondOrder.UNSET},setter:function(value){this.changeBondForm(value,Kekule.ElectronSet.UNSET_ELECTRONCOUNT,this.getBondType())}}),this.defineProp("bondValence",{dataType:DataType.INT,serializable:!1,getter:function(){var f=this.getBondForm();return f?f.getBondValence():0},setter:null}),this.defineProp("electronCount",{dataType:DataType.FLOAT,getter:function(){if(this.isAromatic())return 3;var f=this.getBondForm();return f?f.getElectronCount():Kekule.ElectronSet.UNSET_ELECTRONCOUNT},setter:function(value){var order=this.getBondOrder();this.changeBondForm(order,value,this.getBondType())}}),this.defineProp("stereo",{dataType:DataType.INT,enumSource:Kekule.BondStereo,defaultValue:Kekule.BondStereo.NONE}),this.defineProp("isInAromaticRing",{dataType:DataType.BOOL,setter:null,getter:function(){var parent=this.getParent();return!(!parent||!parent.isConnectorInAromaticRing)&&parent.isConnectorInAromaticRing(this)}})},initPropValues:function($super){$super(),this.setPropStoreFieldValue("stereo",Kekule.BondStereo.NONE)},getAutoIdPrefix:function(){return"b"},getStructureRelatedPropNames:function($super){return $super().concat(["bondForm","stereo"])},clearStructureFlags:function(){this.setPropStoreFieldValue("isInAromaticRing",null)},doGetParity:function($super){return this.isDoubleBond()?$super():null},doGetComparisonPropNames:function($super,options){var result=$super(options);return options.method===Kekule.ComparisonMethod.CHEM_STRUCTURE&&this._getComparisonOptionFlagValue(options,"bondType")&&result.push("bondType"),result},doCompare:function($super,targetObj,options){var result=$super(targetObj,options);if(!result&&options.method===Kekule.ComparisonMethod.CHEM_STRUCTURE){if(this._getComparisonOptionFlagValue(options,"connectedObjCount")){var c1=this.getConnectedObjCount(),c2=targetObj.getConnectedObjCount&&targetObj.getConnectedObjCount();result=this.doCompareOnValue(c1,c2,options)}if(!result&&this._getComparisonOptionFlagValue(options,"bondOrder")){var eCount1=Math.round(this.getElectronCount()),eCount2=Math.round(targetObj.getElectronCount());result=this.doCompareOnValue(eCount1,eCount2,options)}}return result},changeBondForm:function(bondOrder,electronCount,bondType){this.setBondForm(Kekule.BondFormFactory.getBondForm(bondOrder,electronCount,bondType))},canInvertBondDirection:function(){var BT=Kekule.BondType,bType=this.getBondType();return[BT.COVALENT,BT.IONIC,BT.METALLIC,BT.HYDROGEN,BT.UNKNOWN].indexOf(bType)>=0},invertBondDirection:function(){this.setStereo(Kekule.BondStereo.getInvertedDirection(this.getStereo()))},reverseConnectedObjOrder:function($super){this.canInvertBondDirection()&&($super(),this.invertBondDirection())},normalizeDirection:function(){var S=Kekule.BondStereo,inverted=[S.UP_INVERTED,S.DOWN_INVERTED,S.UP_OR_DOWN_INVERTED],d=this.getBondStereo();inverted.indexOf(d)>=0&&this.reverseConnectedObjOrder()},isSingleBond:function(){return this.getBondType()===Kekule.BondType.COVALENT&&this.getBondOrder()===Kekule.BondOrder.SINGLE&&!this.getIsInAromaticRing()},isDoubleBond:function(){return this.getBondType()===Kekule.BondType.COVALENT&&this.getBondOrder()===Kekule.BondOrder.DOUBLE&&!this.getIsInAromaticRing()},isTripleBond:function(){return this.getBondType()===Kekule.BondType.COVALENT&&this.getBondOrder()===Kekule.BondOrder.TRIPLE},isAromatic:function(){return(!!this.getIsInAromaticRing()||this.getBondOrder()===Kekule.BondOrder.EXPLICIT_AROMATIC)&&this.getBondType()===Kekule.BondType.COVALENT},isBondBetween:function(atomicNumberOrSymbol1,atomicNumberOrSymbol2){var objs=this.getConnectedObjs();if(2!==objs.length)return!1;for(var found1,found2,i=0,l=objs.length;i<l;++i){var obj=objs[i];if(obj instanceof Kekule.Atom&&(obj.isElement(atomicNumberOrSymbol1)?found1=!0:obj.isElement(atomicNumberOrSymbol2)&&(found2=!0),found1&&found2))return!0}return!1}}),Kekule.ChemStructureObjectGroup=Class.create(Kekule.ChemStructureObject,{CLASS_NAME:"Kekule.ChemStructureObjectGroup",ITEM_BASE_CLASSES:["Kekule.ChemStructureObject","Kekule.ChemStructureObjectGroup"],initialize:function($super,id){$super(id),this.setPropStoreFieldValue("items",[]),this.setPropStoreFieldValue("raiseExceptionOnTypeMismatch",[])},initProperties:function(){this.defineProp("items",{dataType:DataType.ARRAY}),this.defineProp("raiseExceptionOnTypeMismatch",{dataType:DataType.BOOL,defaultValue:!0,scope:Class.PropertyScope.PUBLIC})},getAutoIdPrefix:function(){return"sg"},getStructureRelatedPropNames:function($super){return $super().concat(["items"])},doGetComparisonPropNames:function($super,options){var result=$super(options);return options.method===Kekule.ComparisonMethod.CHEM_STRUCTURE&&result.push("items"),result},ownerChanged:function($super,newOwner){for(var items=this.getItems(),i=0,l=items.length;i<l;++i){var obj=items[i].obj;obj&&obj.setOwner&&obj.setOwner(newOwner)}$super(newOwner)},_removeChildObj:function(obj){var index=this.indexOfObj(obj);index<0&&(index=this.indexOfItem(obj)),index>=0&&this.removeObjAt(index)},getObjectBaseClasses:function(){return this.getPrototype().ITEM_BASE_CLASSES},ensureItemClass:function(obj){var classes=this.getObjectBaseClasses();if(classes.length>0){for(var i=0,l=classes.length;i<l;++i)if(obj instanceof ClassEx.findClass(classes[i]))return!0;if(this.getRaiseExceptionOnTypeMismatch()){var msg=Kekule.hasLocalRes()?Kekule.$L("ErrorMsg.CHEMSTRUCTUREOBJECTGROUP_ITEMCLASS_MISMATCH"):"Mismatched group item class";Kekule.raise(msg)}return!1}return!0},notifyItemsChanged:function(){this.notifyPropSet("items",this.getPropStoreFieldValue("items"))},indexOfItem:function(item){return this.getItems().indexOf(item)},indexOfObj:function(obj){for(var items=this.getItems(),i=0,l=items.length;i<l;++i)if(items[i].obj==obj)return i;return-1},hasObj:function(obj){return this.indexOfObj(obj)>=0},setAttributesAt:function(index,attributes){var item=this.getItems()[index];if(item)for(var keys=Kekule.ObjUtils.getOwnedFieldNames(attributes),i=0,l=keys.length;i<l;++i)item[keys[i]]=attributes[keys[i]]},getItemCount:function(){return this.getItems().length},getItemAt:function(index){return this.getItems()[index]},appendItem:function(item){return this.getItems().push(item),this},insertItem:function(item,index){return Kekule.ArrayUtils.insertUniqueEx(this.getItems(),item,index).index},removeItemAt:function(index){this.getItems()[index]&&(this.getItems().splice(index,1),this.notifyItemsChanged())},removeItem:function(item){var index=this.getItems().indexOf(item);index>=0&&this.removeItemAt(index)},getObjAt:function(index){var item=this.getItemAt(index);return item?item.obj:null},insertObj:function(obj,index,attributes){if(obj)if(this.indexOfObj(obj)>=0);else if(this.ensureItemClass(obj)){var item={obj:obj};this.beginUpdate();try{var result=this.insertItem(item,index);attributes&&this.setAttributesAt(result,attributes),this.notifyItemsChanged()}finally{this.endUpdate()}return result}},appendObj:function(obj,attributes){return this.insertObj(obj,null,attributes)},removeObjAt:function(index){this.getItems()[index]&&(this.getItems().splice(index,1),this.notifyItemsChanged())},removeObj:function(obj){var index=this.indexOfObj(obj);index>=0&&this.removeObjAt(index)},getAllObjs:function(){for(var result=[],i=0,l=this.getItemCount();i<l;++i)result.push(this.getObjAt(i));return result},getChildCount:function(){return this.getItemCount()},getChildAt:function(index){return this.getObjAt(index)},indexOfChild:function(obj){var result=this.indexOfObj(obj);return result<0&&(result=this.indexOfItem(obj)),result},getNextSiblingOfChild:function(child){var refIndex=this.indexOfItem(child);return refIndex<0&&(refIndex=this.indexOfObj(child)),refIndex>=0?this.getChildAt(refIndex+1):null},appendChild:function(obj){return obj instanceof Kekule.ChemObject?this.appendObj(obj):this.appendItem(obj)},insertChild:function(obj,index){return obj instanceof Kekule.ChemObject?this.insertObj(obj,index):this.insertItem(obj,index)},insertBefore:function(item,refChild){var refIndex=this.indexOfItem(refChild);return refIndex<0&&(refIndex=this.indexOfObj(refChild)),this.insertChild(item,refIndex)},removeChildAt:function(index){return this.removeItemAt(index)},removeChild:function($super,obj){var result,index=this.indexOfItem(obj);return index<=0&&(index=this.indexOfObj(obj)),index>=0&&(result=this.removeItemAt(index)),result||$super(obj)}}),Kekule.StructureFragmentGroup=Class.create(Kekule.ChemStructureObjectGroup,{CLASS_NAME:"Kekule.ChemStructureObjectGroup",ITEM_BASE_CLASSES:["Kekule.StructureFragment","Kekule.StructureFragmentGroup"]}),Kekule.MoleculeGroup=Class.create(Kekule.ChemStructureObjectGroup,{CLASS_NAME:"Kekule.MoleculeGroup",ITEM_BASE_CLASSES:["Kekule.Molecule","Kekule.MoleculeGroup"]}),Kekule.CompositeMolecule=Class.create(Kekule.Molecule,{CLASS_NAME:"Kekule.CompositeMolecule",initialize:function($super,id,name){$super(id,name)},initProperties:function(){this.defineProp("subMolecules",{dataType:"Kekule.MoleculeGroup",getter:function(){return this.getPropStoreFieldValue("subMolecules")||this.setPropStoreFieldValue("subMolecules",new Kekule.MoleculeGroup),this.getPropStoreFieldValue("subMolecules")}})},doGetComparisonPropNames:function($super,options){var result=$super(options);return options.method===Kekule.ComparisonMethod.CHEM_STRUCTURE&&result.push("subMolecules"),result},ownerChanged:function($super,newOwner){var subMols=this.getPropStoreFieldValue("subMolecules");subMols&&subMols.setOwner(newOwner),$super(newOwner)},getSubMoleculeCount:function(){var subs=this.getPropStoreFieldValue("subMolecules");return subs?subs.length:0},hasCtab:function(){return!1},hasFormula:function(){return!1},getAllContainingConnectors:function(){for(var subMols=this.getSubMolecules(),result=[],i=0,l=subMols.getItemCount();i<l;++i){var m=subMols.getObjAt(i);if(m.getAllContainingConnectors){var a=m.getAllContainingConnectors();a&&a.length&&(result=result.concat(a))}}return result},getContainerBox:function(coordMode){var result=null,subMols=this.getPropStoreFieldValue("subMolecules");if(subMols)for(var i=0,l=subMols.getItemCount();i<l;++i){var mol=subMols.getObjAt(i),box=mol.getContainerBox(coordMode);box&&(result=result?Kekule.BoxUtils.getContainerBox(result,box):Object.extend({},box))}return result},doGetCtab:function(){return null},doSetCtab:function(){},doGetFormula:function(){return null},doSetFormula:function(){},getChildCount:function(){return this.getSubMolecules().getChildCount()},getChildAt:function(index){return this.getSubMolecules().getChildAt(index)},indexOfChild:function(obj){return this.getSubMolecules().indexOfChild(obj)},getNextSiblingOfChild:function(childObj){return this.getSubMolecules().getNextSiblingOfChild(childObj)},appendChild:function($super,obj){return $super(obj)},insertChild:function(obj,index){return this.getSubMolecules().insertChild(obj,index)},insertBefore:function($super,obj,refChild){return obj instanceof Kekule.StructureFragment?this.getSubMolecules().insertBefore(obj,refChild):$super(obj,refChild)},removeChildAt:function(index){return this.getSubMolecules().removeChildAt(index)},removeChild:function($super,obj){return this.getSubMolecules().removeChild(obj)||$super(obj)}}),Kekule.MoleculeList=Class.create(Kekule.ChemObjList,{CLASS_NAME:"Kekule.MoleculeList",initialize:function($super,id){$super(id,Kekule.Molecule)}}),Kekule.ChemStructureNodeLabels={ENABLE_ISOTOPE_ALIAS:!0,UNSET_ELEMENT:"?",DUMMY_ATOM:"Du",HETERO_ATOM:"Q",ANY_ATOM:"A",CUSTOM_ATOM:"@",VARIABLE_ATOM:"L",SUBGROUP:"R",ISO_LIST_LEADING_BRACKET:"[",ISO_LIST_TAILING_BRACKET:"]",ISO_LIST_DELIMITER:",",ISO_LIST_DISALLOW_PREFIX:"NOT"},Kekule.ChemStructureNodeFactory={CANDIDATE_CLASSES:[Kekule.SubGroup,Kekule.VariableAtom,Kekule.Pseudoatom],getClassByLabel:function(label,defaultClass){void 0===defaultClass&&(defaultClass=Kekule.Pseudoatom);for(var cclass,NL=Kekule.ChemStructureNodeLabels,candidateLabels=[[NL.SUBGROUP],[NL.VARIABLE_ATOM],[NL.DUMMY_ATOM,NL.HETERO_ATOM,NL.ANY_ATOM,NL.CUSTOM_ATOM]],classes=Kekule.ChemStructureNodeFactory.CANDIDATE_CLASSES,i=0,l=classes.length;i<l;++i){var c=classes[i];if(candidateLabels[i].indexOf(label)>=0){cclass=c;break}}return cclass||(cclass=Kekule.IsotopesDataUtil.isIsotopeIdAvailable(label)?Kekule.Atom:defaultClass),cclass},createByLabel:function(label){var cclass=Kekule.ChemStructureNodeFactory.getClassByLabel(label),result=new cclass;return result instanceof Kekule.Pseudoatom?result.setSymbol(label):result instanceof Kekule.Atom&&result.setIsotopeId(label),result}},Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,ObjectEx=__webpack_require__(0).ObjectEx;module.exports=function(Kekule){return Kekule.ChemStructureBuilder=Class.create(ObjectEx,{CLASS_NAME:"Kekule.ChemStructureBuilder",initialize:function($super,target){$super(),target&&this.setTarget(target)},initProperties:function(){this.defineProp("target",{dataType:"Kekule.StructureFragment"})},setNodeCoord:function(){for(var a=Array.prototype.slice.call(arguments),node=a.shift(),coords=a,i=0,l=coords.length;i<l&&i<2;++i){var coord=coords[i];void 0!==coord.z?node.setCoordOfMode(coord,Kekule.CoordMode.COORD3D):node.setCoordOfMode(coord,Kekule.CoordMode.COORD2D)}},createNode:function(){var a=Array.prototype.slice.call(arguments),nodeClass=a.shift(),id=a.shift(),coords=a,result=new nodeClass(id);return this.setNodeCoord(result,coords),this.appendNode(result),result},createConnector:function(connectorClass,id,connectedObjs){var result=new connectorClass(id);return result.setConnectedObjs(connectedObjs),result},appendNode:function(node){return node&&this.getTarget()?this.getTarget().appendNode(node):null},appendConnector:function(connector){return connector&&this.getTarget()?this.getTarget().appendConnector(connector):null},createAtom:function(){var a=Array.prototype.slice.call(arguments),id=a.shift(),elemSymbolOrAtomicNumber=a.shift(),massNumber=a.shift(),result=new Kekule.Atom(id,elemSymbolOrAtomicNumber,massNumber);return a.unshift(result),this.setNodeCoord.apply(this,a),this.appendNode(result),result},createBond:function(id,connectedObjs,bondOrder,bondStereo,bondType){var result=new Kekule.Bond(id,connectedObjs,bondOrder);return result.changeBondForm(bondOrder,null,bondType),bondStereo&&result.setStereo(bondStereo),this.appendConnector(result),result},deleteNode:function(){},marshalSubGroup:function(groupNodes,id){var target=this.getTarget();if(target&&target.hasCtab()){var group=new Kekule.SubGroup(id);return target.marshalSubFragment(groupNodes,group),group}return null}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,DataType=(__webpack_require__(0).ClassEx,__webpack_require__(0).ObjectEx,__webpack_require__(0).DataType);module.exports=function(Kekule){return Kekule.ReactionComponent={REACTANT:"reactant",PRODUCT:"product",SUBSTANCE:"substance",CONDITION:"condition"},Kekule.ReactionRole={REAGENT:"reagent",CATALYST:"catalyst",SOLVENT:"solvent",TEMPERATURE:"temperature",DURATION:"duration"},Kekule.ReactionDirection={FORWARD:1,BACKWARD:-1,BIDIRECTION:0},Kekule.Reaction=Class.create(Kekule.ChemObject,{CLASS_NAME:"Kekule.Reaction",initialize:function($super,id){$super(id),this.setDirection(Kekule.ReactionDirection.FORWARD)},initProperties:function(){this.defineProp("name",{dataType:DataType.STRING}),this.defineProp("title",{dataType:DataType.STRING}),this.defineProp("reactionType",{dataType:DataType.STRING}),this.defineProp("yield",{dataType:DataType.FLOAT}),this.defineProp("direction",{dataType:DataType.INT,defaultValue:Kekule.ReactionDirection.FORWARD,enumSource:Kekule.ReactionDirection}),this.defineProp("reactants",{dataType:DataType.ARRAY,setter:null,getter:function(canCreate){var r=this.getPropStoreFieldValue("reactants");return!r&&canCreate&&(r=[],this.setPropStoreFieldValue("reactants",r)),r}}),this.defineProp("products",{dataType:DataType.ARRAY,setter:null,getter:function(canCreate){var r=this.getPropStoreFieldValue("products");return!r&&canCreate&&(r=[],this.setPropStoreFieldValue("products",r)),r}}),this.defineProp("substances",{dataType:DataType.ARRAY,setter:null,getter:function(canCreate){var r=this.getPropStoreFieldValue("substances");return!r&&canCreate&&(r=[],this.setPropStoreFieldValue("substances",r)),r}}),this.defineProp("conditions",{dataType:DataType.ARRAY,setter:null,getter:function(canCreate){var r=this.getPropStoreFieldValue("conditions");return!r&&canCreate&&(r=[],this.setPropStoreFieldValue("conditions",r)),r}})},ownerChanged:function($super,newOwner){for(var components=["reactants","products","substances","conditions"],i=0,l=components.length;i<l;++i){var compName=components[i],a=this.getComponentArray(compName);if(a)for(var j=0,k=a.length;j<k;++j){var item=a[j].item;item.setOwner&&item.setOwner(newOwner)}}$super(newOwner)},assertAddingMolecule:function(obj){obj instanceof Kekule.Molecule||Kekule.chemError(Kekule.$L("ErrorMsg.UNABLE_ADD_NONMOLECULE_MAP"))},notifyReactantsChange:function(){this.notifyPropSet("reactants",this.getPropStoreFieldValue("reactants"))},notifyProductsChange:function(){this.notifyPropSet("products",this.getPropStoreFieldValue("products"))},notifySubstancesChange:function(){this.notifyPropSet("substances",this.getPropStoreFieldValue("substances"))},notifyConditionsChange:function(){this.notifyPropSet("conditions",this.getPropStoreFieldValue("conditions"))},notifyComponentChange:function(component){var propName=this.componentToPropName(component);propName&&this.notifyPropSet(propName,this.getPropStoreFieldValue(propName))},componentToPropName:function(component){return component+"s"},getComponentArray:function(component,canCreate){var pname=this.componentToPropName(component);if(!pname)return null;switch(pname){case"reactants":return this.doGetReactants(canCreate);case"products":return this.doGetProducts(canCreate);case"substances":return this.doGetSubstances(canCreate);case"conditions":return this.doGetConditions(canCreate);default:return null}},getComponentItemCount:function(component){var a=this.getComponentArray(component);return a?a.length:0},getMapAt:function(component,index){var a=this.getComponentArray(component);return a?a[index]:null},getMapItemAt:function(component,index){var r=this.getMapAt(component,index);return r?r.item:null},indexOfMap:function(component,map){var a=this.getComponentArray(component);return a?a.indexOf(map):-1},indexOfItem:function(component,item,role){var a=this.getComponentArray(component);if(a)for(var i=0,l=a.length;i<l;++i)if(a[i].item==item){if(void 0===role)return i;if(role===a[i].role)return i}return-1},appendMap:function(component,map){component!=Kekule.ReactionComponent.PRODUCT&&component!=Kekule.ReactionComponent.REACTANT||this.assertAddingMolecule(map.item);var r=Kekule.ArrayUtils.pushUniqueEx(this.getComponentArray(component,!0),map);return r.isPushed&&this.notifyComponentChange(component),r.index},appendItem:function(component,item,role,additionalInfo){var index=this.indexOfItem(component,item,role);if(index<0){component!=Kekule.ReactionComponent.PRODUCT&&component!=Kekule.ReactionComponent.REACTANT||this.assertAddingMolecule(item);var map=Kekule.RoleMapUtils.createMap(item,role);additionalInfo&&Object.extend(map,additionalInfo);var r=Kekule.ArrayUtils.pushUniqueEx(this.getComponentArray(component,!0),map);return this.notifyComponentChange(component),r.index}return index},removeMapAt:function(component,index){var r=null,a=this.getComponentArray(component);return a&&(r=Kekule.ArrayUtils.removeAt(a,index))&&this.notifyComponentChange(component),r},removeMap:function(component,map){var r=null,a=this.getComponentArray(component);return a&&(r=Kekule.ArrayUtils.remove(a,map))&&this.notifyComponentChange(component),r},removeItem:function(component,item,role){var index=this.indexOfItem(component,item,role);return index>=0?this.removeMapAt(component,index):null},clearComponent:function(component){this.getComponentArray(component);this.notifyComponentChange(component)},getReactantCount:function(){return this.getComponentItemCount(Kekule.ReactionComponent.REACTANT)},getProductCount:function(){return this.getComponentItemCount(Kekule.ReactionComponent.PRODUCT)},getSubstancesCount:function(){return this.getComponentItemCount(Kekule.ReactionComponent.SUBSTANCE)},getConditionCount:function(){return this.getComponentItemCount(Kekule.ReactionComponent.CONDITION)},getReactantMapAt:function(index){return this.getMapAt(Kekule.ReactionComponent.REACTANT,index)},getProductMapAt:function(index){return this.getMapAt(Kekule.ReactionComponent.PRODUCT,index)},getSubstanceMapAt:function(index){return this.getMapAt(Kekule.ReactionComponent.SUBSTANCE,index)},getConditionMapAt:function(index){return this.getMapAt(Kekule.ReactionComponent.CONDITION,index)},getReactantItemAt:function(index){return this.getMapItemAt(Kekule.ReactionComponent.REACTANT,index)},getReactantAt:function(index){return this.getMapItemAt(Kekule.ReactionComponent.REACTANT,index)},getProductItemAt:function(index){return this.getMapItemAt(Kekule.ReactionComponent.PRODUCT,index)},getProductAt:function(index){return this.getMapItemAt(Kekule.ReactionComponent.PRODUCT,index)},getSubstanceItemAt:function(index){return this.getMapItemAt(Kekule.ReactionComponent.SUBSTANCE,index)},getSubstanceAt:function(index){return this.getMapItemAt(Kekule.ReactionComponent.SUBSTANCE,index)},getConditionItemAt:function(index){return this.getMapItemAt(Kekule.ReactionComponent.CONDITION,index)},indexOfReactantMap:function(map){return this.indexOfMap(Kekule.ReactionComponent.REACTANT,map)},indexOfProductMap:function(map){return this.indexOfMap(Kekule.ReactionComponent.PRODUCT,map)},indexOfSubstanceMap:function(map){return this.indexOfMap(Kekule.ReactionComponent.SUBSTANCE,map)},indexOfConditionMap:function(map){return this.indexOfMap(Kekule.ReactionComponent.CONDITION,map)},indexOfReactant:function(item,role){return this.indexOfItem(Kekule.ReactionComponent.REACTANT,item,role)},indexOfProduct:function(item,role){return this.indexOfItem(Kekule.ReactionComponent.PRODUCT,item,role)},indexOfSubstance:function(item,role){return this.indexOfItem(Kekule.ReactionComponent.SUBSTANCE,item,role)},indexOfCondition:function(item,role){return this.indexOfItem(Kekule.ReactionComponent.CONDITION,item,role)},appendReactantMap:function(map){return this.appendMap(Kekule.ReactionComponent.REACTANT,map)},appendProductMap:function(map){return this.appendMap(Kekule.ReactionComponent.PRODUCT,map)},appendSubstanceMap:function(map){return this.appendMap(Kekule.ReactionComponent.SUBSTANCE,map)},appendConditionMap:function(map){return this.appendMap(Kekule.ReactionComponent.CONDITION,map)},appendReactant:function(item,role,amount,additionalInfo){var info=additionalInfo||{};return amount&&(info.amount=amount),this.appendItem(Kekule.ReactionComponent.REACTANT,item,role,info)},appendProduct:function(item,role,amount,additionalInfo){var info=additionalInfo||{};return amount&&(info.amount=amount),this.appendItem(Kekule.ReactionComponent.PRODUCT,item,role,info)},appendSubstance:function(item,role,amount,additionalInfo){var info=additionalInfo||{};return amount&&(info.amount=amount),this.appendItem(Kekule.ReactionComponent.SUBSTANCE,item,role,info)},appendCondition:function(item,role,additionalInfo){return this.appendItem(Kekule.ReactionComponent.CONDITION,item,role,additionalInfo)},removeReactantAt:function(index){return this.removeMapAt(Kekule.ReactionComponent.REACTANT,index)},removeProductAt:function(index){return this.removeMapAt(Kekule.ReactionComponent.PRODUCT,index)},removeSubstanceAt:function(index){return this.removeMapAt(Kekule.ReactionComponent.SUBSTANCE,index)},removeConditionAt:function(index){return this.removeMapAt(Kekule.ReactionComponent.CONDITION,index)},removeReactantMap:function(map){return this.removeMap(Kekule.ReactionComponent.REACTANT,map)},removeProductMap:function(map){return this.removeMap(Kekule.ReactionComponent.PRODUCT,map)},removeSubstanceMap:function(map){return this.removeMap(Kekule.ReactionComponent.SUBSTANCE,map)},removeConditionMap:function(map){return this.removeMap(Kekule.ReactionComponent.CONDITION,map)},removeReactant:function(item,role){return this.removeItem(Kekule.ReactionComponent.REACTANT,item,role)},removeProduct:function(item,role){return this.removeItem(Kekule.ReactionComponent.PRODUCT,item,role)},removeSubstance:function(item,role){return this.removeItem(Kekule.ReactionComponent.SUBSTANCE,item,role)},removeCondition:function(item,role){return this.removeItem(Kekule.ReactionComponent.CONDITION,item,role)},clearReactants:function(){return this.clearComponent(Kekule.ReactionComponent.REACTANT)},clearProducts:function(){return this.clearComponent(Kekule.ReactionComponent.PRODUCT)},clearSubstance:function(){return this.clearComponent(Kekule.ReactionComponent.SUBSTANCE)},clearConditions:function(){return this.clearComponent(Kekule.ReactionComponent.CONDITION)},clearAll:function(){this.clearProducts(),this.clearProducts(),this.clearSubstance(),this.clearConditions()},getAllContainingConnectors:function(){for(var C=Kekule.ReactionComponent,comps=[C.REACTANT,C.PRODUCT,C.SUBSTANCE],result=[],i=0,l=comps.length;i<l;++i)for(var comp=comps[i],j=0,k=this.getComponentItemCount(comp);j<k;++j){var item=this.getMapItemAt(comp,j);if(item.getAllContainingConnectors){var a=item.getAllContainingConnectors();a&&a.length&&(result=result.concat(a))}}return result}}),Kekule.ReactionList=Class.create(Kekule.ChemObjList,{CLASS_NAME:"Kekule.ReactionList",initialize:function($super,id){$super(id,Kekule.Reaction)}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,ClassEx=__webpack_require__(0).ClassEx,ObjectEx=__webpack_require__(0).ObjectEx,DataType=__webpack_require__(0).DataType;module.exports=function(Kekule){var AU=Kekule.ArrayUtils;Kekule.ChemStructureUtils={getConnectorLengthMedian:function(connectors,coordMode,allowCoordBorrow){for(var lengths=[],i=0,l=connectors.length;i<l;++i){var connector=connectors[i];if(connector&&connector.getLength){var length=connector.getLength(coordMode,allowCoordBorrow);length&&lengths.push(length)}}if(0===l)return 1;if(l<=1)return lengths[0];lengths.sort();var count=lengths.length;return count%2?lengths[count+1>>1]:(lengths[count>>1]+lengths[(count>>1)-1])/2},getChildStructureObjs:function(chemObj,cascade){var result;if(chemObj instanceof Kekule.CompositeMolecule)result=chemObj.getSubMolecules().getAllObjs();else if(chemObj instanceof Kekule.ChemStructureObjectGroup)result=chemObj.getAllObjs();else if(chemObj instanceof Kekule.ChemObjList)result=chemObj.getItems();else if(chemObj instanceof Kekule.ChemSpaceElement)result=chemObj.getChildren().getItems();else{if(!(chemObj instanceof Kekule.ChemSpace))return[chemObj];result=chemObj.getChildren()}if(result=[].concat(result),cascade){for(var newResult=[],i=0,l=result.length;i<l;++i){var obj=result[i],cascadeChilds=Kekule.ChemStructureUtils.getChildStructureObjs(obj,cascade);cascadeChilds.length<=1?Kekule.ArrayUtils.pushUnique(newResult,obj):Kekule.ArrayUtils.pushUnique(newResult,cascadeChilds)}result=newResult}return result},getAllStructFragments:function(chemObj,cascade){if(chemObj instanceof Kekule.StructureFragment)return[chemObj];for(var childObjs=Kekule.ChemStructureUtils.getChildStructureObjs(chemObj,cascade),result=[],i=0,l=childObjs.length;i<l;++i)childObjs[i]instanceof Kekule.StructureFragment&&Kekule.ArrayUtils.pushUnique(result,childObjs[i]);return result},getTotalStructFragment:function(chemObj,newFragmentClass){var fragments=Kekule.ChemStructureUtils.getAllStructFragments(chemObj,!0),count=fragments.length;return count<=0?null:1===count?fragments[0]:Kekule.ChemStructureUtils.mergeStructFragments(fragments,newFragmentClass)},getCascadeDeleteObjs:function(chemStructObj){for(var result=[],linkedConnectors=chemStructObj.getLinkedConnectors?chemStructObj.getLinkedConnectors():[],i=0,l=linkedConnectors.length;i<l;++i){var connector=linkedConnectors[i];if(connector.getConnectedObjs().length<=2){Kekule.ArrayUtils.pushUnique(result,connector);var newCascadeObjs=Kekule.ChemStructureUtils.getCascadeDeleteObjs(connector);Kekule.ArrayUtils.pushUnique(result,newCascadeObjs)}}if(chemStructObj instanceof Kekule.ChemStructureNode);else if(chemStructObj instanceof Kekule.ChemStructureConnector)for(var objs=chemStructObj.getConnectedObjs(),i=0,l=objs.length;i<l;++i){var obj=objs[i];obj instanceof Kekule.ChemStructureNode&&obj.getLinkedConnectors().length<=1&&Kekule.ArrayUtils.pushUnique(result,obj)}return result},moveChildBetweenStructFragment:function(target,dest,moveNodes,moveConnectors,ignoreAnchorNodes){return Kekule.StructureFragment.moveChildBetweenStructFragment(target,dest,moveNodes,moveConnectors,ignoreAnchorNodes)},_getCascadeConnectedNodesAndConnectors:function(connector,parentStructFragment){for(var connectors=[],nodes=[],objs=connector.getConnectedObjs(),j=0,k=objs.length;j<k;++j){var obj=objs[j];if(obj!==connector)if(parentStructFragment&&(obj=parentStructFragment.findDirectChildOfObj(obj)),obj instanceof Kekule.ChemStructureNode)Kekule.ArrayUtils.pushUnique(nodes,obj);else if(obj instanceof Kekule.ChemStructureConnector){Kekule.ArrayUtils.pushUnique(connectors,obj);var connected=Kekule.ChemStructureUtils._getCascadeConnectedNodesAndConnectors(obj);Kekule.ArrayUtils.pushUnique(connectors,connected.connectors),Kekule.ArrayUtils.pushUnique(nodes,connected.nodes)}}return{connectors:connectors,nodes:nodes}},mergeStructFragments:function(fragments,newFragmentClass){if(fragments.length<=1)return fragments[0];for(var fclass=newFragmentClass||Kekule.Molecule,result=new fclass,i=0,l=fragments.length;i<l;++i){var frag=fragments[i].clone();Kekule.ChemStructureUtils.moveChildBetweenStructFragment(frag,result,frag.getNodes(),frag.getConnectors())}return result},splitStructFragment:function(structFragment){if(!structFragment.hasCtab())return[structFragment];var allNodes=structFragment.getNodes();if(allNodes.length<=0)return[structFragment];var allConnectors=structFragment.getConnectors(),splits=[],currNodes=[allNodes[0]],currConnectors=[],currIndex=0;do{var node=currNodes[currIndex],connectors=node.getLinkedConnectors();node.getCrossConnectors&&connectors.concat(node.getCrossConnectors()||[]),Kekule.ArrayUtils.pushUnique(currConnectors,connectors);for(var i=0,l=connectors.length;i<l;++i){var connected=Kekule.ChemStructureUtils._getCascadeConnectedNodesAndConnectors(connectors[i],structFragment);Kekule.ArrayUtils.pushUnique(currConnectors,connected.connectors),Kekule.ArrayUtils.pushUnique(currNodes,connected.nodes)}++currIndex}while(currIndex<currNodes.length);splits.push(structFragment);var restNodes=Kekule.ArrayUtils.exclude(allNodes,currNodes),restConnectors=Kekule.ArrayUtils.exclude(allConnectors,currConnectors);if(restNodes.length>0){var fragClass=structFragment.getClass(),newFragment=new fragClass;Kekule.ChemStructureUtils.moveChildBetweenStructFragment(structFragment,newFragment,restNodes,restConnectors);var newSplits=Kekule.ChemStructureUtils.splitStructFragment(newFragment);splits=splits.concat(newSplits)}return splits},getAbsCoordVectorBetweenObjs:function(obj1,obj2,coordMode,allowCoordBorrow){var coord1=obj1.getAbsCoordOfMode(coordMode,allowCoordBorrow),coord2=obj2.getAbsCoordOfMode(coordMode,allowCoordBorrow);return Kekule.CoordUtils.substract(coord2,coord1)},_getRef2DCoordOfObj:function(obj,allowCoordBorrow){return obj.getAbsBaseCoord2D?obj.getAbsBaseCoord2D(allowCoordBorrow):obj.getAbsCoord2D?obj.getAbsCoord2D(allowCoordBorrow):obj.getCoord2D(allowCoordBorrow)},_getStandardizedLinkedObj2DRelCoords:function(baseObj,excludeObjs,allowCoordBorrow,includeAttachedMarkers,includeUnexposedSiblings){var result=[],baseCoord=Kekule.ChemStructureUtils._getRef2DCoordOfObj(baseObj,allowCoordBorrow),linkedObjs=includeUnexposedSiblings?baseObj.getLinkedObjs():baseObj.getLinkedExposedObjs();includeAttachedMarkers&&baseObj.getAttachedMarkers&&(linkedObjs=linkedObjs.concat(baseObj.getAttachedMarkers())),excludeObjs&&excludeObjs.length&&(linkedObjs=AU.exclude(linkedObjs,excludeObjs));for(var i=0,l=linkedObjs.length;i<l;++i){var obj=linkedObjs[i],coord=Kekule.ChemStructureUtils._getRef2DCoordOfObj(obj,allowCoordBorrow),newCoord=Kekule.CoordUtils.substract(coord,baseCoord);newCoord=Kekule.CoordUtils.standardize(newCoord),result.push(newCoord)}return result},_calcLinkedObj2DAnglesOfObj:function(baseObj,excludeObjs,allowCoordBorrow,includeAttachedMarkers,includeUnexposedSiblings){for(var result=[],linkedObjCoords=Kekule.ChemStructureUtils._getStandardizedLinkedObj2DRelCoords(baseObj,excludeObjs,allowCoordBorrow,includeAttachedMarkers,includeUnexposedSiblings),i=0,l=linkedObjCoords.length;i<l;++i){var c=linkedObjCoords[i];if(0!==c.x||0!==c.y){var angle=Math.atan2(c.y,c.x);angle<0&&(angle=2*Math.PI+angle),result.push(angle)}}return result.sort(),result},_getMostEmptyDirectionOfExistingAngles:function(angles){var l=angles.length;if(0===l)return 0;if(1===l)return-angles[0];for(var max=0,index=0,i=0;i<l;++i){var a1=angles[i],a2=angles[(i+1)%l],delta=a2-a1;delta<0&&(delta+=2*Math.PI),delta>max&&(max=delta,index=i)}return angles[index]+max/2},getMostEmptyDirection2DAngleOfObj:function(baseObj,excludeObjs,allowCoordBorrow,includeAttachedMarkers,includeUnexposedSiblings,avoidDirectionAngles){var angles=Kekule.ChemStructureUtils._calcLinkedObj2DAnglesOfObj(baseObj,excludeObjs,allowCoordBorrow,includeAttachedMarkers,includeUnexposedSiblings);return avoidDirectionAngles&&(angles=angles.concat(avoidDirectionAngles),angles.sort()),Kekule.ChemStructureUtils._getMostEmptyDirectionOfExistingAngles(angles)}},Kekule.TokenAnalyzer=Class.create(ObjectEx,{CLASS_NAME:"Kekule.TokenAnalyzer",initialize:function($super,text){$super(),this.setSrcText(text)},initProperties:function(){this.defineProp("srcText",{dataType:DataType.STRING,setter:function(value){var v=value||"";this.setPropStoreFieldValue("srcText",v),this.setPropStoreFieldValue("srcLength",v.length),this.setCurrPos(0)}}),this.defineProp("srcLength",{dataType:DataType.INT,setter:null,serializable:!1}),this.defineProp("currPos",{dataType:DataType.INT,serializable:!1})},getCharType:function(c){return 0},isCharTypeMatched:function(currT,lastT){return currT===lastT},nextCharInfo:function(){var p=this.getCurrPos();if(p>=this.getSrcLength())return null;var c=this.getSrcText().charAt(p);return this.setCurrPos(p+1),{char:c,charType:this.getCharType(c)}},nextTokenInfo:function(){var lastCharInfo=this.nextCharInfo();if(lastCharInfo){for(var token=lastCharInfo.char,tokenType=lastCharInfo.charType,currCharInfo=this.nextCharInfo();currCharInfo&&this.isCharTypeMatched(currCharInfo.charType,lastCharInfo.charType);)token+=currCharInfo.char,lastCharInfo=currCharInfo,currCharInfo=this.nextCharInfo();return currCharInfo&&this.setCurrPos(this.getCurrPos()-1),{token:token,tokenType:tokenType}}return null},getAllTokenInfos:function(){for(var result=[],info=this.nextTokenInfo();info;)result.push(info),info=this.nextTokenInfo();return result}}),Kekule.ChemTextTypes={CT_ATOM_SYMBOL_LEADING:1,CT_ATOM_SYMBOL_FOLLOWING:2,CT_CHARGE_SYMBOL:3,CT_NUMBER:4,CT_BRACKET_LEADING:10,CT_BRACKET_TAILING:11,CT_SEPARATOR:20,CT_UNKNOWN:0};var CT=Kekule.ChemTextTypes;Kekule.ChemTextAnalyzer=Class.create(Kekule.TokenAnalyzer,{CLASS_NAME:"Kekule.ChemTextAnalyzer",getCharType:function(c){return" "===c?CT.CT_SEPARATOR:c>="0"&&c<="9"?CT.CT_NUMBER:["+","-"].indexOf(c)>=0?CT.CT_CHARGE_SYMBOL:["(","[","{"].indexOf(c)>=0?CT.CT_BRACKET_LEADING:[")","]","}"].indexOf(c)>=0?CT.CT_BRACKET_TAILING:c>="A"&&c<="Z"?CT.CT_ATOM_SYMBOL_LEADING:c>="a"&&c<="z"?CT.CT_ATOM_SYMBOL_FOLLOWING:CT.CT_UNKNOWN},isCharTypeMatched:function(currT,lastT){return!Kekule.ArrayUtils.intersect([CT.CT_BRACKET_LEADING,CT.CT_BRACKET_TAILING],[currT,lastT]).length&&(currT===lastT&&lastT!==CT.CT_ATOM_SYMBOL_LEADING||lastT===CT.CT_ATOM_SYMBOL_LEADING&&currT===CT.CT_ATOM_SYMBOL_FOLLOWING)}}),Kekule.FormulaUtils={FORMULA_BRACKETS:[["(",")"],["[","]"],["{","}"]],FORMULA_BRACKET_TYPE_COUNT:3,textToFormula:function(text,parent,formula){var result=formula||null;result&&result.clear();var analyzer=new Kekule.ChemTextAnalyzer(text);try{var tokenInfos=analyzer.getAllTokenInfos();result||(result=new Kekule.MolecularFormula(parent));var tokenLength=tokenInfos.length;if(tokenLength){var currSection,currCharge,lastTokenInfo=null,currFormula=result;currSection={};for(var createNewSection=function(){currSection={}},wrapUpCurrSection=function(){currSection&&currSection.obj&&currFormula.appendSection(currSection.obj,currSection.count,currSection.charge)},i=0;i<tokenLength;++i){var tokenInfo=tokenInfos[i],tokenType=tokenInfo.tokenType,token=tokenInfo.token,handled=!1;if(tokenType===CT.CT_BRACKET_LEADING){wrapUpCurrSection();var subFormula=new Kekule.MolecularFormula(parent);subFormula._parentFormula=currFormula,currFormula=subFormula,createNewSection(),handled=!0}else if(tokenType===CT.CT_BRACKET_TAILING)wrapUpCurrSection(),createNewSection(),currSection.obj=currFormula,currFormula=currFormula._parentFormula,tokenInfo.asSymbol=!0,handled=!0;else if([CT.CT_ATOM_SYMBOL_LEADING,CT.CT_ATOM_SYMBOL_FOLLOWING].indexOf(tokenType)>=0){currSection.obj&&(wrapUpCurrSection(),createNewSection());var massNum=currSection.massNum;massNum||lastTokenInfo&&!lastTokenInfo.handled&&lastTokenInfo.tokenType===CT.CT_NUMBER&&(massNum=parseInt(lastTokenInfo.token,10)||null);var slabel=""+(massNum||"")+token;currSection.obj=Kekule.ChemStructureNodeFactory.createByLabel(slabel),tokenInfo.asSymbol=!0,handled=!0}else if(tokenType===CT.CT_CHARGE_SYMBOL){if(currCharge="+"===token?1:-1,tokenInfo.asCharge=!0,lastTokenInfo.tokenType===CT.CT_NUMBER){var schargeCount;if(lastTokenInfo.asCount)if(lastTokenInfo.token.length>1){var t=lastTokenInfo.token;schargeCount=t.substr(t.length-1),lastTokenInfo.asCount&&(currSection.count=parseInt(t.substring(0,t.length-1),10))}else schargeCount=lastTokenInfo.token,lastTokenInfo.asCount&&(currSection.count=1);else schargeCount=lastTokenInfo.token,lastTokenInfo.asChargeCount=!0;currCharge*=parseInt(schargeCount,10)}currSection.charge=currCharge,handled=!0}else if(tokenType===CT.CT_NUMBER){var num=parseInt(token,10);currCharge&&lastTokenInfo.tokenType===CT.CT_CHARGE_SYMBOL&&lastTokenInfo.asCharge?(currCharge*=num,currSection.charge=currCharge,tokenInfo.asChargeCount=!0,handled=!0):currSection.obj&&lastTokenInfo.asSymbol?(currSection.count=num,tokenInfo.asCount=!0,handled=!0):currSection.obj||(currSection.massNum=num,handled=!0)}tokenInfo.handled=handled,lastTokenInfo=tokenInfo}currSection&&currSection.obj&&wrapUpCurrSection()}return result}finally{analyzer.finalize()}},formulaToText:function(formula,showCharge,partialChargeDecimalsLength){return Kekule.ObjUtils.isUnset(showCharge)&&(showCharge=!0),FU._convFormulaToText(formula,!1,showCharge,partialChargeDecimalsLength)},_convFormulaToText:function(formula,showBracket,showCharge,partialChargeDecimalsLength){var result="",sections=formula.getSections();if(showBracket){var bracketIndex=formula.getMaxNestedLevel()%FU.FORMULA_BRACKET_TYPE_COUNT,bracketStart=FU.FORMULA_BRACKETS[bracketIndex][0],bracketEnd=FU.FORMULA_BRACKETS[bracketIndex][1];result+=bracketStart}for(var i=0,l=sections.length;i<l;++i){var obj=sections[i].obj,charge=formula.getSectionCharge(sections[i]),subgroup=null;if(obj instanceof Kekule.MolecularFormula)subgroup=FU._convFormulaToText(obj,!0,!1,!1,partialChargeDecimalsLength);else if(obj.getLabel){var subgroup=obj.getLabel();obj.getMassNumber&&obj.getMassNumber()&&(subgroup=(result?" ":"")+subgroup)}if(subgroup){var explicitCount=!1;if(1!=sections[i].count&&(subgroup+=sections[i].count,explicitCount=!0),showCharge&&charge){var chargelabel=FU._convChargeToText(charge,partialChargeDecimalsLength);subgroup+=(explicitCount?" ":"")+chargelabel}result+=subgroup}}if(showBracket&&(result+=bracketEnd),showCharge){var charge=formula.getCharge();if(charge){var chargelabel=FU._convChargeToText(charge,partialChargeDecimalsLength);result+=chargelabel}}return result},_convChargeToText:function(charge,partialChargeDecimalsLength){if(!charge)return null;var chargeSign=charge>0?"+":"-",chargeAmount=Math.abs(charge),chargelabel=chargeSign;return 1!=chargeAmount&&(chargelabel=(partialChargeDecimalsLength?Kekule.NumUtils.toDecimals(chargeAmount,partialChargeDecimalsLength):chargeAmount.toString())+chargeSign),chargelabel}};var FU=Kekule.FormulaUtils;return ClassEx.defineProp(Kekule.MolecularFormula,"text",{dataType:DataType.STRING,serializable:!1,getter:function(){return FU.formulaToText(this)},setter:function(value){FU.textToFormula(value,this.getParent(),this)}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class;module.exports=function(Kekule){return Kekule.Glyph={},Kekule.Glyph.Base=Class.create(Kekule.ChemObject,{CLASS_NAME:"Kekule.Glyph.Base",initialize:function($super,id,coord2D,coord3D){$super(id),coord2D&&this.setCoord2D(coord2D),coord3D&&this.setCoord3D(coord3D)},initProperties:function(){},getAutoIdPrefix:function(){return"g"}}),Kekule.ClassDefineUtils.addStandardCoordSupport(Kekule.Glyph.Base),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,DataType=__webpack_require__(0).DataType;module.exports=function(Kekule){return Kekule.Glyph.PathGlyphNode=Class.create(Kekule.BaseStructureNode,{CLASS_NAME:"Kekule.Glyph.PathGlyphNode",initialize:function($super,id,nodeType,coord2D,coord3D){$super(id),coord2D&&this.setCoord2D(coord2D),coord3D&&this.setCoord3D(coord3D),this.setNodeType(nodeType||Kekule.Glyph.NodeType.LOCATION)},initProperties:function(){this.defineProp("nodeType",{dataType:DataType.STRING,scope:Class.PropertyScope.PUBLIC})}}),Kekule.Glyph.NodeType={LOCATION:"location",HIDDEN:"hidden"},Kekule.Glyph.PathGlyphConnector=Class.create(Kekule.BaseStructureConnector,{CLASS_NAME:"Kekule.Glyph.PathGlyphConnector",initialize:function($super,id,pathType,connectedObjs){$super(id,connectedObjs),this.setPathType(pathType)},initProperties:function(){this.defineProp("pathType",{dataType:DataType.STRING,scope:Class.PropertyScope.PUBLISHED,enumSource:Kekule.Glyph.PathType}),this.defineProp("pathParams",{dataType:DataType.HASH,scope:Class.PropertyScope.PUBLISHED,getter:function(){var result=this.getPropStoreFieldValue("pathParams");return result||(result={},this.setPropStoreFieldValue("pathParams",result)),result},setter:function(value){value?this.setPropStoreFieldValue("pathParams",Object.extend({},value,!0)):this.setPropStoreFieldValue("pathParams",null)}})}}),Kekule.Glyph.PathType={LINE:"L"},Kekule.Glyph.ArrowType={NONE:null,OPEN:"open",TRIANGLE:"triangle"},Kekule.Glyph.ArrowSide={BOTH:0,SINGLE:1,REVERSED:-1},Kekule.Glyph.PathGlyph=Class.create(Kekule.Glyph.Base,{CLASS_NAME:"Kekule.Glyph.PathGlyph",initialize:function($super,id,refLength,initialParams,coord2D,coord3D){$super(id,coord2D,coord3D),this.createDefaultStructure(refLength||1,initialParams||{})},doFinalize:function($super){this.hasCtab()&&this.getCtab().finalize(),$super()},initProperties:function(){this.defineProp("ctab",{dataType:"Kekule.StructureConnectionTable",scope:Class.PropertyScope.PUBLIC,getter:function(allowCreate){return this.getPropStoreFieldValue("ctab")||allowCreate&&this.createCtab(),this.getPropStoreFieldValue("ctab")},setter:function(value){var old=this.getPropStoreFieldValue("ctab");old&&(old.finalize(),old=null),value&&(value.setPropValue("parent",this,!0),value.setOwner(this.getOwner())),this.setPropStoreFieldValue("ctab",value)}}),this.defineProp("nodes",{dataType:DataType.ARRAY,serializable:!1,scope:Class.PropertyScope.PUBLIC,setter:null,getter:function(){return this.hasCtab()?this.getCtab().getNodes():[]}}),this.defineProp("connectors",{dataType:DataType.ARRAY,serializable:!1,scope:Class.PropertyScope.PUBLIC,setter:null,getter:function(){return this.hasCtab()?this.getCtab().getConnectors():[]}})},createDefaultStructure:function(refLength,initialParams){refLength||(refLength=1);var actualParams={},lengthFields=["lineGap","startArrowLength","startArrowWidth","endArrowLength","endArrowWidth"];for(var field in initialParams)lengthFields.indexOf(field)>=0?actualParams[field]=initialParams[field]*refLength:actualParams[field]=initialParams[field];return this.doCreateDefaultStructure(refLength,actualParams)},doCreateDefaultStructure:function(refLength,initialParams){},getAutoIdPrefix:function(){return"p"},ownerChanged:function($super,newOwner){this.hasCtab()&&this.getCtab().setOwner(newOwner),$super(newOwner)},_removeChildObj:function(obj){if(this.hasCtab()){var ctab=this.getCtab();ctab===obj?this.removeCtab():ctab.hasChildObj(obj)&&ctab.removeChildObj(obj)}},isEmpty:function(){return this.getCtab().isEmpty()},createCtab:function(){var ctab=new Kekule.StructureConnectionTable(this.getOwner(),this);this.setPropStoreFieldValue("ctab",ctab),ctab.addEventListener("propValueSet",function(e){"nodes"==e.propName&&this.notifyPropSet(e.propName,e.propValue)},this),ctab.setEnablePropValueSetEvent(!0)},hasCtab:function(){return!!this.getPropStoreFieldValue("ctab")},getContainerBox:function($super,coordMode,allowCoordBorrow){return this.hasCtab()?this.getCtab().getContainerBox(coordMode,allowCoordBorrow):$super(coordMode)},getNodeById:function(id){return this.hasCtab()?this.getCtab().getNodeById(id):null},getConnectorById:function(id){return this.hasCtab()?this.getCtab().getConnectorById(id):null},getObjectById:function(id){var node=this.getNodeById(id);return node||this.getConnectorById(id)},getNodeCount:function(){return this.hasCtab()?this.getCtab().getNodeCount():0},getNodeAt:function(index){return this.hasCtab()?this.getCtab().getNodeAt(index):null},indexOfNode:function(node){return this.hasCtab()?this.getCtab().indexOfNode(node):-1},hasNode:function(node,checkNestedStructure){return this.hasCtab()?this.getCtab().hasNode(node,checkNestedStructure):null},appendNode:function(node){return this.doGetCtab(!0).appendNode(node)},insertNodeAt:function(node,index){return this.doGetCtab(!0).insertNodeAt(node,index)},removeNodeAt:function(index,preserveLinkedConnectors){return this.hasCtab()?this.getCtab().removeNodeAt(index,preserveLinkedConnectors):null},removeNode:function(node,preserveLinkedConnectors){return this.hasCtab()?this.getCtab().removeNode(node,preserveLinkedConnectors):null},replaceNode:function(oldNode,newNode){return this.hasCtab()?this.getCtab().replaceNode(oldNode,newNode):null},clearNodes:function(){if(this.hasCtab())return this.getCtab().clearNodes()},nodesHasCoord2D:function(allowCoordBorrow){return!!this.hasCtab()&&this.getCtab().nodesHasCoord2D(allowCoordBorrow)},nodesHasCoord3D:function(allowCoordBorrow){return!!this.hasCtab()&&this.getCtab().nodesHasCoord3D(allowCoordBorrow)},getConnectorCount:function(){return this.hasCtab()?this.getCtab().getConnectorCount():0},getConnectorAt:function(index){return this.hasCtab()?this.getCtab().getConnectorAt(index):null},indexOfConnector:function(connector){return this.hasCtab()?this.getCtab().indexOfConnector(connector):-1},hasConnector:function(connector,checkNestedStructure){return this.hasCtab()?this.getCtab().hasConnector(connector,checkNestedStructure):null},appendConnector:function(connector){return this.doGetCtab(!0).appendConnector(connector)},insertConnectorAt:function(connector,index){return this.doGetCtab(!0).insertConnectorAt(connector,index)},removeConnectorAt:function(index,preserveConnectedObjs){return this.hasCtab()?this.getCtab().removeConnectorAt(index,preserveConnectedObjs):null},removeConnector:function(connector,preserveConnectedObjs){return this.hasCtab()?this.getCtab().removeConnector(connector,preserveConnectedObjs):null},clearConnectors:function(){if(this.hasCtab())return this.getCtab().clearConnectors()},insertBefore:function(obj,refChild){if(this.hasCtab())return this.getCtab().insertBefore(obj,refChild)},_getObjsNeedToBeCascadeRemoved:function(childObj,ignoredChildObjs){return this.hasCtab()?this.getCtab()._getObjsNeedToBeCascadeRemoved(childObj,ignoredChildObjs):[]},removeChildObj:function(childObj,cascadeRemove,freeRemoved){this.hasCtab()&&this.getCtab().removeChildObj(childObj,cascadeRemove,freeRemoved)},removeChild:function($super,obj){return this.removeChildObj(obj)||$super(obj)},hasChildObj:function(childObj){return!!this.hasCtab()&&this.getCtab().hasChildObj(childObj)},getNextSiblingOfChild:function(childObj){return this.hasCtab()?this.getCtab().getNextSiblingOfChild(childObj):null},getChildCount:function(){return this.hasCtab()?this.getCtab().getChildCount():0},getChildAt:function(index){return this.hasCtab()?this.getCtab().getChildAt(index):null},indexOfChild:function(obj){return this.hasCtab()?this.getCtab().indexOfChild(obj):-1}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class;module.exports=function(Kekule){var PT=Kekule.Glyph.PathType;return Kekule.Glyph.StraightLine=Class.create(Kekule.Glyph.PathGlyph,{CLASS_NAME:"Kekule.Glyph.StraightLine",initialize:function($super,id,refLength,initialParams,coord2D,coord3D){$super(id,refLength,initialParams,coord2D,coord3D)},doCreateDefaultStructure:function(refLength,initialParams){var C=Kekule.CoordUtils,coord2D={x:0,y:0},coord3D={x:0,y:0,z:0},delta={x:refLength*(initialParams.lineLength||1)},node1=new Kekule.Glyph.PathGlyphNode(null,null,coord2D,coord3D),node2=new Kekule.Glyph.PathGlyphNode(null,null,C.add(coord2D,delta),C.add(coord3D,delta)),connector=new Kekule.Glyph.PathGlyphConnector(null,PT.LINE,[node1,node2]);this._applyParamsToConnector(connector,initialParams),this.appendNode(node1),this.appendNode(node2),this.appendConnector(connector)},_applyParamsToConnector:function(connector,initialParams){connector.setPathParams(initialParams)}}),Kekule.Glyph.Polygon=Class.create(Kekule.Glyph.PathGlyph,{CLASS_NAME:"Kekule.Glyph.Polygon",initialize:function($super,id,refLength,initialParams,coord2D,coord3D){$super(id,refLength,initialParams,coord2D,coord3D)},getRefLengthRatio:function(){return 1},doCreateDefaultStructure:function(refLength,initialParams){for(var firstNode,lastNode,C=Kekule.CoordUtils,coord2D={x:0,y:0},coord3D={x:0,y:0,z:0},nodeProps=initialParams.nodeProps,connectorProps=initialParams.connectorProps,r=refLength*(initialParams.lineLength||1)*this.getRefLengthRatio(),edgeCount=initialParams.edgeCount||3,angleDelta=2*Math.PI/edgeCount,startingAngle=edgeCount%2?0:-angleDelta/2,currAngle=startingAngle,i=0;i<edgeCount;++i){var c={x:r*Math.sin(currAngle),y:r*Math.cos(currAngle)},node=new Kekule.Glyph.PathGlyphNode(null,null,C.add(coord2D,c),C.add(coord3D,c));if(nodeProps&&node.setPropValues(nodeProps),this.appendNode(node),0===i&&(firstNode=node),lastNode){var connector=new Kekule.Glyph.PathGlyphConnector(null,PT.LINE,[lastNode,node]);connectorProps&&connector.setPropValues(connectorProps),this._applyParamsToConnector(connector,initialParams),this.appendConnector(connector)}lastNode=node,currAngle+=angleDelta}var connector=new Kekule.Glyph.PathGlyphConnector(null,PT.LINE,[node,firstNode]);connectorProps&&connector.setPropValues(connectorProps),this._applyParamsToConnector(connector,initialParams),this.appendConnector(connector)},_applyParamsToConnector:function(connector,initialParams){connector.setPathParams(initialParams)}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class;module.exports=function(Kekule){var PT=Kekule.Glyph.PathType;return Kekule.Glyph.HeatSymbol=Class.create(Kekule.Glyph.Polygon,{CLASS_NAME:"Kekule.Glyph.HeatSymbol",initialize:function($super,id,refLength,initialParams,coord2D,coord3D){$super(id,refLength,initialParams,coord2D,coord3D),this.setRenderOption("strokeWidth",1.5)},getRefLengthRatio:function(){return.25},doCreateDefaultStructure:function($super,refLength,initialParams){return initialParams.edgeCount=3,initialParams.nodeProps=Object.extend(initialParams.nodeProps||{},{interactMode:Kekule.ChemObjInteractMode.HIDDEN}),initialParams.connectorProps=Object.extend(initialParams.connectorProps||{},{interactMode:Kekule.ChemObjInteractMode.HIDDEN}),$super(refLength,initialParams)},_applyParamsToConnector:function($super,connector,initialParams){return $super(connector,initialParams)}}),Kekule.Glyph.AddSymbol=Class.create(Kekule.Glyph.PathGlyph,{CLASS_NAME:"Kekule.Glyph.AddSymbol",initialize:function($super,id,refLength,initialParams,coord2D,coord3D){$super(id,refLength,initialParams,coord2D,coord3D),this.setRenderOption("strokeWidth",1.5)},getRefLengthRatio:function(){return.5},doCreateDefaultStructure:function(refLength,initialParams){var nodeProps={interactMode:Kekule.ChemObjInteractMode.HIDDEN},connectorProps={interactMode:Kekule.ChemObjInteractMode.HIDDEN},C=Kekule.CoordUtils,coord2D={x:0,y:0},coord3D={x:0,y:0,z:0},length=refLength*this.getRefLengthRatio()*(initialParams.lineLength||1)/2,baseNode=new Kekule.Glyph.PathGlyphNode(null,null,coord2D,coord3D);baseNode.setPropValues(nodeProps),this.appendNode(baseNode);for(var adjustDeltas=[{x:-length,y:0},{x:0,y:-length},{x:length,y:0},{x:0,y:length}],i=0,l=adjustDeltas.length;i<l;++i){var delta=adjustDeltas[i],node=new Kekule.Glyph.PathGlyphNode(null,null,C.add(coord2D,delta),C.add(coord3D,delta));node.setPropValues(nodeProps);var connector=new Kekule.Glyph.PathGlyphConnector(null,PT.LINE,[baseNode,node]);connector.setPropValues(connectorProps),this._applyParamsToConnector(connector,initialParams),this.appendNode(node),this.appendConnector(connector)}},_applyParamsToConnector:function(connector,initialParams){connector.setPathParams(initialParams)}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,DataType=__webpack_require__(0).DataType;module.exports=function(Kekule){return Kekule.ContentBlock=Class.create(Kekule.ChemObject,{CLASS_NAME:"Kekule.ContentBlock",initialize:function($super,id,coord2D,coord3D){$super(id),coord2D&&this.setCoord2D(coord2D),coord3D&&this.setCoord3D(coord3D)},initProperties:function(){this.defineProp("needRecalcSize",{dataType:DataType.BOOL})},getAutoIdPrefix:function(){return"b"},getCornerCoord1:function(coordMode,allowCoordBorrow){return this.getCoordOfMode(coordMode,allowCoordBorrow)},getCornerCoord2:function(coordMode,allowCoordBorrow){var cornerCoord1=this.getCornerCoord1(coordMode,allowCoordBorrow),size=this.getSizeOfMode(coordMode,allowCoordBorrow);return Kekule.CoordUtils.add(cornerCoord1,size)},getContainerBox:function($super,coordMode,allowCoordBorrow){var coord1=this.getAbsCoordOfMode(coordMode,allowCoordBorrow)||{},size=this.getSizeOfMode(coordMode,allowCoordBorrow)||{};if(coordMode===Kekule.CoordMode.COORD3D)var coord2=Kekule.CoordUtils.add(coord1,this.getSizeOfMode(coordMode,allowCoordBorrow)||{});else coord2={x:coord1.x+size.x,y:coord1.y-size.y};return Kekule.BoxUtils.createBox(coord1,coord2)}}),Kekule.ClassDefineUtils.addStandardCoordSupport(Kekule.ContentBlock),Kekule.ClassDefineUtils.addStandardSizeSupport(Kekule.ContentBlock),Kekule.TextBlock=Class.create(Kekule.ContentBlock,{CLASS_NAME:"Kekule.TextBlock",initialize:function($super,id,text,coord2D,coord3D){$super(id,coord2D,coord3D),this.setText(text||"")},initProperties:function(){this.defineProp("text",{dataType:DataType.STRING})},getAutoIdPrefix:function(){return"t"},doObjectChange:function($super,modifiedPropNames){Kekule.ArrayUtils.intersect(["text","renderOptions"],modifiedPropNames).length&&this.setNeedRecalcSize(!0)}}),Kekule.ImageBlock=Class.create(Kekule.ContentBlock,{CLASS_NAME:"Kekule.ImageBlock",initialize:function($super,id,src,coord2D,coord3D){$super(id,coord2D,coord3D),src&&this.setSrc(src)},initProperties:function(){this.defineProp("src",{dataType:DataType.STRING,scope:Class.PropertyScope.PUBLISHED,setter:function(value){value!==this.getSrc()&&(this.setPropStoreFieldValue("src",value),this._clearCacheImg())}}),this.defineProp("cacheImg",{dataType:DataType.OBJECT,scope:Class.PropertyScope.PUBLIC,serializable:!1,setter:null,getter:function(){var result=this.getPropStoreFieldValue("cacheImg");return!result&&Kekule.$document&&(result=this._createCacheImg(this.getSrc())),result}})},getAutoIdPrefix:function(){return"g"},_createCacheImg:function(src){var result,doc=Kekule.$document;return doc&&doc.body&&doc.createElement&&(result=doc.createElement("img"),result.src=src),result},_clearCacheImg:function(){var img=this.getPropStoreFieldValue("cacheImg");if(img){img.src="";try{delete img.width,delete img.height}catch(e){}}}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,ClassEx=__webpack_require__(0).ClassEx,DataType=__webpack_require__(0).DataType;module.exports=function(Kekule){var AU=Kekule.ArrayUtils;return Kekule.ChemMarker={},ClassEx.extend(Kekule.ChemObject,{isAttachedMarker:function(){var p=this.getParent();return p&&p.hasMarker(this)},notifyAttachedMarkersChanged:function(){this.notifyPropSet("attachedMarkers",this.getPropStoreFieldValue("attachedMarkers"))},_attachedMarkerAdded:function(marker){},_attachedMarkerRemoved:function(marker){},getMarkerCount:function(){return this.getAttachedMarkers().length},getMarkerAt:function(index){return this.getAttachedMarkers()[index]},getMarkerOfType:function(classType,exactMatch){for(var i=0,l=this.getMarkerCount();i<l;++i){var marker=this.getMarkerAt(i);if(exactMatch&&marker.getClass()===classType||marker instanceof classType)return marker}return null},getMarkersOfType:function(classType,exactMatch){for(var result=[],i=0,l=this.getMarkerCount();i<l;++i){var marker=this.getMarkerAt(i);(exactMatch&&marker.getClass()===classType||marker instanceof classType)&&result.push(marker)}return result},fetchMarkerOfType:function(classType,canCreate,exactMatch,defProps){var result=this.getMarkerOfType(classType,exactMatch);return!result&&canCreate&&(result=new classType,defProps&&result.setPropValues(defProps),this.appendMarker(result)),result},getUnplacedMarkers:function(coordMode){for(var result=[],i=0,l=this.getMarkerCount();i<l;++i){var marker=this.getMarkerAt(i);marker.getCoordOfMode(coordMode)||result.push(marker)}return result},indexOfMarker:function(marker){return this.getAttachedMarkers().indexOf(marker)},hasMarker:function(marker){return this.indexOfMarker(marker)>=0},hasMarkerOfType:function(classType,exactMatch){return!!this.getMarkerOfType(classType,exactMatch)},appendMarker:function(marker){var index=this.indexOfMarker(marker);if(index>=0)return index;var result=this.getAttachedMarkers().push(marker);return marker.setOwner&&marker.setOwner(this.getOwner()),marker.setParent&&marker.setParent(this),this._attachedMarkerAdded(marker),this.notifyAttachedMarkersChanged(),result},insertMarkerBefore:function(marker,refMarker){var refIndex=this.indexOfMarker(refMarker);return this.insertMarkerAt(marker,refIndex)},insertMarkerAt:function(marker,index){var i=this.indexOfMarker(marker),markers=this.getAttachedMarkers();return(Kekule.ObjUtils.isUnset(index)||index<0)&&(index=markers.length),i>=0?(markers.splice(i,1),markers.splice(index,0,marker)):(markers.splice(index,0,marker),marker.setOwner&&marker.setOwner(this.getOwner()),marker.setParent&&marker.setParent(this),this._attachedMarkerAdded(marker)),this.notifyAttachedMarkersChanged(),index},setMarkerIndex:function(marker,index){var markers=this.getAttachedMarkers(),i=this.indexOfMarker(marker);i>=0&&(markers.splice(i,1),markers.splice(index,0,marker))},removeMarkerAt:function(index){var marker=this.getMarkerAt(index);if(marker){var result=this.getAttachedMarkers().splice(index,1);return marker.setOwner&&marker.setOwner(null),marker.setParent&&marker.setParent(null),this._attachedMarkerRemoved(marker),this.notifyAttachedMarkersChanged(),result}},removeMarker:function(marker){var index=this.indexOfMarker(marker);if(index>=0)return this.removeMarkerAt(index)},replaceMarker:function(oldMarker,newMarker){var oldIndex=this.indexOfMarker(oldMarker);return oldIndex<0?this:(this.removeMarkerAt(oldIndex),this.insertMarkerAt(newMarker,oldIndex),this)},clearMarkers:function(){var oldMarkers=AU.clone(this.getAttachedMarkers());this.setPropStoreFieldValue("attachedMarkers",[]);for(var i=0,l=oldMarkers.length;i<l;++i){var marker=oldMarkers[i];marker.setOwner&&marker.setOwner(null),marker.setParent&&marker.setParent(null),this._attachedMarkerRemoved(marker)}return this.notifyAttachedMarkersChanged(),this},autoSetMarker2DPos:function(marker,offset,allowCoordBorrow,avoidDirectionAngles){if(this.hasMarker(marker)){var angle=Kekule.ChemStructureUtils.getMostEmptyDirection2DAngleOfObj(this,[marker],allowCoordBorrow,!0,!1,avoidDirectionAngles),coord={x:offset*Math.cos(angle),y:offset*Math.sin(angle)};marker.setCoord2D(coord)}},_updateAttachedMarkersOwner:function(owner){owner||(owner=this.getOwner());for(var i=0,l=this.getMarkerCount();i<l;++i){var marker=this.getMarkerAt(i);marker.setOwner&&marker.setOwner(owner)}},_updateAttachedMarkersParent:function(parent){parent||(parent=this);for(var i=0,l=this.getMarkerCount();i<l;++i){var marker=this.getMarkerAt(i);marker.setParent&&marker.setParent(parent)}}}),ClassEx.extendMethod(Kekule.ChemObject,"ownerChanged",function($origin,newOwner){$origin(newOwner),this._updateAttachedMarkersOwner(newOwner)}),ClassEx.extendMethod(Kekule.ChemObject,"removeChild",function($origin,child){var result=$origin(child);return result||(result=this.removeMarker(child)||$origin(child)),result}),ClassEx.extendMethod(Kekule.ChemObject,"insertBefore",function($origin,child,refChild){var result=$origin(child,refChild);return result<0&&(refChild&&this.hasMarker(refChild)||child instanceof Kekule.ChemMarker.BaseMarker)&&(result=this.insertMarkerBefore(child,refChild)),result}),ClassEx.defineProp(Kekule.ChemObject,"attachedMarkers",{dataType:DataType.ARRAY,scope:Class.PropertyScope.PUBLISHED,getter:function(){var result=this.getPropStoreFieldValue("attachedMarkers");return result||(result=[],this.setPropStoreFieldValue("attachedMarkers",result)),result},setter:function(value){this.clearMarkers(),this.setPropStoreFieldValue("attachedMarkers",value),this._updateAttachedMarkersOwner(),this._updateAttachedMarkersParent()}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,ClassEx=__webpack_require__(0).ClassEx,DataType=__webpack_require__(0).DataType;module.exports=function(Kekule){return Kekule.ChemMarker.BaseMarker=Class.create(Kekule.ChemObject,{CLASS_NAME:"Kekule.ChemMarker.BaseMarker",initialize:function($super,id,coord2D,coord3D){$super(id,coord2D,coord3D)},getAutoIdPrefix:function(){return"marker"}}),Kekule.ClassDefineUtils.addStandardCoordSupport(Kekule.ChemMarker.BaseMarker),Kekule.ChemMarker.UnbondedElectronSet=Class.create(Kekule.ChemMarker.BaseMarker,{CLASS_NAME:"Kekule.ChemMarker.UnbondedElectronSet",initProperties:function(){this.defineProp("electronCount",{dataType:DataType.VARIANT})},initPropValues:function($super){$super(),this.setElectronCount(2)}}),Kekule.ChemMarker.ChemPropertyMarker=Class.create(Kekule.ChemMarker.BaseMarker,{CLASS_NAME:"Kekule.ChemMarker.ChemPropertyMarker",initProperties:function(){this.defineProp("value",{dataType:DataType.VARIANT,serializable:!1,getter:function(){var result,p=this.getParent(),propName=this.getPropertyName();return p&&propName?(result=p.getPropValue(propName),this.setPropStoreFieldValue("value",result)):result=this.getPropStoreFieldValue("value"),result},setter:function(value){this.setPropStoreFieldValue("value",value),this.setParentPropValue(value)}})},initPropValues:function($super){$super()},setParentPropValue:function(value){var p=this.getParent();if(p){var propName=this.getPropertyName();propName&&p&&p.setPropValue(propName,value)}return this},resetParentPropValue:function(){return this.setParentPropValue(void 0)},getPropertyName:function(){return null},beforAddingByEditor:function(newParent,refSibling,$super){if(newParent){var value=this.getPropStoreFieldValue("value");Kekule.ObjUtils.notUnset(value)&&this.setParentPropValue(value)}},beforeRemovingByEditor:function(parent){this.setPropStoreFieldValue("value",this.getValue()),this.resetParentPropValue()}}),Kekule.ChemMarker.Charge=Class.create(Kekule.ChemMarker.ChemPropertyMarker,{CLASS_NAME:"Kekule.ChemMarker.Charge",getPropertyName:function(){return"charge"}}),Kekule.ChemMarker.Radical=Class.create(Kekule.ChemMarker.ChemPropertyMarker,{CLASS_NAME:"Kekule.ChemMarker.Radical",getPropertyName:function(){return"radical"}}),ClassEx.extend(Kekule.ChemStructureNode,{fetchChargeMarker:function(canCreate,defProps){return this.fetchMarkerOfType(Kekule.ChemMarker.Charge,canCreate,!1,defProps)},fetchRadicalMarker:function(canCreate,defProps){return this.fetchMarkerOfType(Kekule.ChemMarker.Radical,canCreate,!1,defProps)}}),ClassEx.defineProp(Kekule.AbstractAtom,"lonePairCount",{dataType:DataType.INT,scope:Class.PropertyScope.PUBLISHED,serializable:!1,setter:null,getter:function(){for(var result=0,unbondedESets=this.getMarkersOfType(Kekule.ChemMarker.UnbondedElectronSet),i=0,l=unbondedESets.length;i<l;++i){2===unbondedESets[i].getElectronCount()&&++result}return result}}),ClassEx.extendMethod(Kekule.AbstractAtom,"doCompare",function($origin,targetObj,options){var result=$origin(targetObj,options);if(!result&&options.method===Kekule.ComparisonMethod.CHEM_STRUCTURE&&(this._getComparisonOptionFlagValue(options,"lonePair")||this._getComparisonOptionFlagValue(options,"unbondedElectron"))){var _getUnbondedElectronArray=function(atom){var result=[];if(atom.getMarkersOfType)for(var unbondedESets=atom.getMarkersOfType(Kekule.ChemMarker.UnbondedElectronSet),i=0,l=unbondedESets.length;i<l;++i){var eSet=unbondedESets[i];result.push(eSet.getElectronCount())}return result.sort(),result},a1=_getUnbondedElectronArray(this),a2=_getUnbondedElectronArray(targetObj);return Kekule.ArrayUtils.compare(a1,a2)}return result}),Kekule}},function(module,exports,__webpack_require__){"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};__webpack_require__(0).Class,__webpack_require__(0).ClassEx,__webpack_require__(0).ObjectEx,__webpack_require__(0).DataType;module.exports=function(Kekule){Kekule.Browser={},Kekule.$jsRoot.window&&(Kekule.Browser={IE:!(!window.attachEvent||window.opera),Opera:!!window.opera,WebKit:navigator.userAgent.indexOf("AppleWebKit/")>-1,Gecko:navigator.userAgent.indexOf("Gecko")>-1&&navigator.userAgent.indexOf("like Gecko")<0&&-1==navigator.userAgent.indexOf("KHTML"),MobileSafari:!!navigator.userAgent.match(/Apple.*Mobile.*Safari/),language:navigator.language||navigator.browserLanguage}),Kekule.BrowserFeature={},Kekule.$jsRoot.window&&(Kekule.BrowserFeature={typedArray:"undefined"!=typeof ArrayBuffer,svg:!!window.SVGSVGElement,canvas:!!window.CanvasRenderingContext2D,webgl:function(){return!!function(){try{var canvas=document.createElement("canvas");return!!window.WebGLRenderingContext&&(canvas.getContext("webgl")||canvas.getContext("experimental-webgl"))}catch(e){return!1}}()}(),downloadHref:function(doc){return"download"in doc.createElement("a")}(document),blob:!!window.Blob,workers:!!window.Worker,fileapi:!!(window.File&&window.FileReader&&window.FileList&&window.Blob),sessionStorage:function(){try{return!!window.sessionStorage}catch(e){return!1}}(),localStorage:function(){try{return!!window.localStorage}catch(e){return!1}}(),cssTransition:function(s){return"transition"in s||"WebkitTransition"in s||"MozTransition"in s||"msTransition"in s||"OTransition"in s}(document.createElement("div").style),cssTranform:function(s){return"transform"in s||"WebkitTransform"in s||"MozTransform"in s||"msTransform"in s||"OTransform"in s}(document.createElement("div").style),html5Form:{placeholder:function(elem){return"placeholder"in elem}(document.createElement("input")),supportType:function(typeName){var elem=document.createElement("input");elem.setAttribute("type",typeName);var result=elem.type===typeName,textTypes=["text","url","search"];if(result&&textTypes.indexOf(typeName.toLowerCase())<0){elem.value=":)",result=":)"!==elem.value}return result}},mutationObserver:window.MutationObserver||window.MozMutationObserver||window.WebkitMutationObserver}),Kekule.X={};var X=Kekule.X,isUnset=function(o){return null===o||void 0===o},notUnset=function(o){return!isUnset(o)},isElemPositioned=function(element){var pos=window.getComputedStyle?window.getComputedStyle(element,null).position:element.currentStyle?element.currentStyle.position:null;return!!pos&&(!!pos&&("relative"===(pos=pos.toString().toLowerCase())||"absolute"===pos))};if(Kekule.$jsRoot.window&&(X.MutationObserver=window.MutationObserver||window.MozMutationObserver||window.WebkitMutationObserver),X.Event={MOUSE_BTN_LEFT:0,MOUSE_BTN_RIGHT:2,MOUSE_BTN_MID:1,MOUSE_BTN_LR:3},X.Event.MouseButton={LEFT:0,RIGHT:2,MID:1,LR:3},X.Event.KeyCode={BACKSPACE:8,TAB:9,CLEAR:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPSLOCK:20,ESC:27,SPACE:32,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRTSC:44,INS:45,DEL:46,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SCROLLLOCK:145},X.Event.isSupported=function(){var cache={};return function(eventName){var TAGNAMES={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img",unload:"win",resize:"win"},shortEventName=eventName.replace(/^on/,"");if(cache[shortEventName])return cache[shortEventName];var elt="win"==TAGNAMES[shortEventName]?window:document.createElement(TAGNAMES[shortEventName]||"div");eventName="on"+shortEventName;var eventIsSupported=eventName in elt;return eventIsSupported||(elt.setAttribute(eventName,"return;"),eventIsSupported="function"==typeof elt[eventName]),elt=null,cache[shortEventName]=eventIsSupported,eventIsSupported}}(),X.Event.Methods={getType:function(event){return event.__$type__||event.type},getTarget:function(event){var target=event.target||event.srcElement;return 3==target.nodeType&&(target=target.parentNode),target},getCurrentTarget:function(event){return event.currentTarget},getEventPhase:function(event){return event.eventPhase},getAltKey:function(event){return event.altKey},getCtrlKey:function(event){return event.ctrlKey},getShiftKey:function(event){return event.shiftKey},getCharCode:function(event){return notUnset(event.charCode)?event.charCode:event.keyCode},getKeyCode:function(event){return event.keyCode},getClientX:function(event){var result;if(event.touches){var touch=event.touches[0];result=touch&&touch.clientX}else result=event.clientX;return result},getClientY:function(event){var result;if(event.touches){var touch=event.touches[0];result=touch&&touch.clientY}else result=event.clientY;return result},getScreenX:function(event){var result;if(event.touches){var touch=event.touches[0];result=touch&&touch.screenX}else result=event.screenX;return result},getScreenY:function(event){var result;if(event.touches){var touch=event.touches[0];result=touch&&touch.screenY}else result=event.screenY;return result},getPageX:function(event){if(event.touches){var touch=event.touches[0];if(touch&&notUnset(touch.pageX))return touch.pageX}else if(notUnset(event.pageX))return event.pageX;var doc=X.Event.getTarget(event).ownerDocument||X.Event.getTarget(event),body=doc?doc.body:null;return X.Event.getClientX(event)+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0)},getPageY:function(event){if(event.touches){var touch=event.touches[0];if(touch&&notUnset(touch.pageY))return touch.pageY}else if(notUnset(event.pageY))return event.pageY;var doc=X.Event.getTarget(event).ownerDocument||X.Event.getTarget(event),body=doc?doc.body:null;return X.Event.getClientY(event)+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0)},getOffsetX:function(event){if(notUnset(event.offsetX))return event.offsetX;var elem=X.Event.getTarget(event);if(elem.defaultView&&elem.body&&(elem=elem.body),notUnset(event.layerX)&&isElemPositioned(elem)&&!event.touches)return event.layerX;var clientX=X.Event.getClientX(event);return Math.round(clientX-elem.getBoundingClientRect().left)},getOffsetY:function(event){if(notUnset(event.offsetY))return event.offsetY;var elem=X.Event.getTarget(event);if(elem.defaultView&&elem.body&&(elem=elem.body),notUnset(event.layerY)&&isElemPositioned(elem)&&!event.touches)return event.layerY;var clientY=X.Event.getClientY(event);return Math.round(clientY-elem.getBoundingClientRect().top)},getWindowX:function(event){var x=X.Event.getPageX(event),doc=event.target.ownerDocument||event.target,win=doc&&doc.defaultView;return x-(win&&win.scrollX||0)},getWindowY:function(event){var y=X.Event.getPageY(event),doc=event.target.ownerDocument||event.target,win=doc&&doc.defaultView;return y-(win&&win.scrollY||0)},getRelXToCurrTarget:function(event){var elem=X.Event.getCurrentTarget(event);elem.defaultView&&elem.body&&(elem=elem.body);var clientX=X.Event.getClientX(event);return Math.round(clientX-elem.getBoundingClientRect().left)},getRelYToCurrTarget:function(event){var elem=X.Event.getCurrentTarget(event);elem.defaultView&&elem.body&&(elem=elem.body);var clientY=X.Event.getClientY(event);return Math.round(clientY-elem.getBoundingClientRect().top)},getTouches:function(event){return event.touches}},X.Event._MouseEventEx={isMouseEnterLeaveEvent:function(eventType){return"mouseenter"===eventType||"mouseleave"===eventType},addMouseEnterLeaveListener:function(element,eventType,handler,useCapture){if("mouseenter"===eventType&&X.Event.isSupported("mouseenter")||"mouseleave"===eventType&&X.Event.isSupported("mouseleave"))return element.addEventListener(eventType,handler,useCapture);var wrapper=function(e){var target=e.getTarget?e.getTarget():e.target,currTarget=e.getCurrentTarget?e.getCurrentTarget():e.currentTarget;if(target===currTarget||Kekule.DomUtils.isDescendantOf(target,currTarget)){var related=e.getRelatedTarget?e.getRelatedTarget():e.relatedTarget;if(!related||!Kekule.DomUtils.isDescendantOf(related,currTarget)){var event=new MouseEvent(eventType,{view:window,bubbles:!1,cancelable:!0,target:currTarget,currentTarget:currTarget,relatedTarget:related});handler.call(currTarget,event)}}};handler.__$mouseExListenerWrapper__=wrapper;var newType="mouseenter"===eventType?"mouseover":"mouseout";return element.addEventListener(newType,wrapper,useCapture)},removeMouseEnterLeaveListener:function(element,eventType,handler){if("mouseenter"===eventType&&X.Event.isSupported("mouseenter")||"mouseleave"===eventType&&X.Event.isSupported("mouseleave"))return element.removeEventListener(eventType,handler);var newType="mouseenter"===eventType?"mouseover":"mouseout";return element.removeEventListener(newType,handler.__$mouseExListenerWrapper__||handler)}},X.Event._W3C={addListener:function(element,eventType,handler,useCapture){return X.Event._MouseEventEx.isMouseEnterLeaveEvent(eventType)?X.Event._MouseEventEx.addMouseEnterLeaveListener(element,eventType,handler,useCapture):element.addEventListener(eventType,handler,useCapture)},removeListener:function(element,eventType,handler,useCapture){return X.Event._MouseEventEx.isMouseEnterLeaveEvent(eventType)&&handler&&handler.__$listenerWrapper__?X.Event._MouseEventEx.removeMouseEnterLeaveListener(element,eventType,handler.__$listenerWrapper__):element.removeEventListener(eventType,handler,useCapture)},stopPropagation:function(event){event.stopPropagation()},preventDefault:function(event){event.preventDefault()}},X.Event._W3CMethods={getRelatedTarget:function(event){return event.relatedTarget},getButton:function(event){return event.button}},X.Event._Gecko={addListener:function(element,eventType,handler,useCapture){if(X.Event._MouseEventEx.isMouseEnterLeaveEvent(eventType))return X.Event._MouseEventEx.addMouseEnterLeaveListener(element,eventType,handler,useCapture);if("mousewheel"===eventType){var wrapper=function(e){e.wheelDeltaY=e.wheelDelta=40*-e.detail,e.__$type__="mousewheel",handler.call(element,e)};handler.__$mousewheelListenerWrapper__=wrapper,element.addEventListener("DOMMouseScroll",wrapper,useCapture)}else element.addEventListener(eventType,handler,useCapture)},removeListener:function(element,eventType,handler,useCapture){"mousewheel"===eventType&&handler.__$mousewheelListenerWrapper__?element.removeEventListener("DOMMouseScroll",handler.__$mousewheelListenerWrapper__,useCapture):element.removeEventListener(eventType,handler,useCapture)}},X.Event._IE={_handlers:{},WIN_UNLOAD_FLAG_FIELD:"__$win_unload_linked__",addListener:function(element,eventType,handler,useCapture){if(!(X.Event.findHandlerIndex(element,eventType,handler)>=0)){var wrapper=function(e){e||(e=window.event),e.currentTarget=element,e.eventPhase=e.srcElement===element?2:3,hasEventPrototype||Object.extend(e,eventObjMethods),handler.call(element,e)};element.attachEvent(X.Event.getEventName(eventType),wrapper),X.Event.registerHandler(element,eventType,handler,wrapper);var doc=element.ownerDocument||element,win=doc.parentWindow||doc;X.Event._linkUnloadEvent(win)}},removeListener:function(element,eventType,handler,useCapture){var index=X.Event.findHandlerIndex(element,eventType,handler);if(index>=0){var wrapper=X.Event._handlers[eventType][index].wrapper;element.detachEvent(X.Event.getEventName(eventType),wrapper),X.Event._handlers[eventType].splice(index,1)}},stopPropagation:function(event){event.cancelBubble=!0},preventDefault:function(event){event.returnValue=!1},removeAllListeners:function(doc){var allHandlers=X.Event._handlers;if(allHandlers)for(var propName in allHandlers)if(allHandlers.hasOwnProperty(propName)){var hs=allHandlers[propName];if(hs&&hs.length)for(var eventName=X.Event.getEventName(propName),i=hs.length-1;i>=0;--i){var h=hs[i];doc&&h.element.ownerDocument!==doc||(h.element.detachEvent(eventName,h.wrapper),hs.splice(i,1))}}},getEventName:function(eventType){return"on"+eventType},registerHandler:function(element,eventType,handler,handlerWrapper){var handlers=X.Event._handlers;handlers[eventType]||(handlers[eventType]=[]),handlers[eventType].push({element:element,handler:handler,wrapper:handlerWrapper})},unregisterHandler:function(element,eventType,handler){var handlers=X.Event._handlers;if(handlers[eventType]){var hs=handlers[eventType],index=X.Event.findHandlerIndex(element,eventType,handler);index>=0&&hs.splice(index,1)}},findHandlerIndex:function(element,eventType,handler){var hs=X.Event._handlers[eventType];if(!hs)return-1;for(var i=0,l=hs.length;i<l;++i){var h=hs[i];if(h.element===element&&h.handler===handler)return i}return-1},_linkUnloadEvent:function(winObj){var flag=X.Event.WIN_UNLOAD_FLAG_FIELD;winObj[flag]||(winObj.attachEvent("onunload",X.Event.reactWinUnload),winObj[flag]=!0)},reactWinUnload:function(){var doc=this.ownerDocument;X.Event.removeAllListeners(doc)}},X.Event._IEMethods={getRelatedTarget:function(event){return event.fromElement||event.toElement},getButton:function(event){switch(event.button){case 1:return 0;case 2:return 2;case 4:return 1;case 3:return 3;default:return event.button}},stopPropagation:function(event){event.cancelBubble=!0},preventDefault:function(event){event.returnValue=!1}},Kekule.$document&&Kekule.$document.addEventListener)X.Event=Object.extend(X.Event,X.Event._W3C),X.Event.Methods=Object.extend(X.Event.Methods,X.Event._W3CMethods),Kekule.Browser.Gecko&&(X.Event=Object.extend(X.Event,X.Event._Gecko));else if(Kekule.$document&&Kekule.$document.attachEvent&&(X.Event=Object.extend(X.Event,X.Event._IE),X.Event.Methods=Object.extend(X.Event.Methods,X.Event._IEMethods),window.Element)){var elemPrototype=window.Element.prototype;elemPrototype.addEventListener=X.Event.addListener.methodize(),elemPrototype.removeEventListener=X.Event.removeListener.methodize()}Object.extend(X.Event,X.Event.Methods);var eproto=null;Kekule.$jsRoot.window&&Kekule.$jsRoot.window.Event&&(eproto=window.Event.prototype),eproto||Kekule.$document&&Kekule.$document.createEvent&&(eproto=document.createEvent("HTMLEvents").__proto__);var hasEventPrototype=!!eproto,eventObjMethods={},methods=X.Event.Methods;for(var name in methods)methods.hasOwnProperty(name)&&"function"==typeof methods[name]&&(eventObjMethods[name]=methods[name].methodize());eproto&&Object.extend(eproto,eventObjMethods),X.Ajax={XMLHttpFactories:[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],_availableFactoryIndex:-1,createXMLHTTPObject:function(){var xmlhttp=!1,F=X.Ajax.XMLHttpFactories,index=X.Ajax._availableFactoryIndex;if(index>=0)xmlhttp=F[index]();else for(var i=0;i<F.length;i++){try{xmlhttp=F[i](),X.Ajax._availableFactoryIndex=i}catch(e){continue}break}return xmlhttp},preparePostData:function(data){var result=data;return"object"===(void 0===data?"undefined":_typeof(data))&&(result=Kekule.UrlUtils.generateSearchString(data)),result},sendRequest:function(url,callback,postData,responseType,overwriteMimeType){var isBinary=!1,supportResponseType=!0,req=X.Ajax.createXMLHTTPObject();if(req){var method=postData?"POST":"GET";if(req.open(method,url,!0),req.setRequestHeader("User-Agent","XMLHTTP/1.0"),postData&&req.setRequestHeader("Content-type","application/x-www-form-urlencoded"),responseType){try{req.responseType=responseType}catch(e){}"arraybuffer"!==responseType&&"blob"!==responseType||(isBinary=!0),req.responseType!==responseType&&(supportResponseType=!1)}if(isBinary&&!supportResponseType&req.overwriteMimeType&&req.overrideMimeType("text/plain; charset=x-user-defined"),overwriteMimeType&&req.overwriteMimeType&&req.overwriteMimeType(overwriteMimeType),req.onreadystatechange=function(){if(4==req.readyState){if(200!=req.status&&304!=req.status)throw callback(null,req,!1),"HTTP error "+req.status;callback(req.response||req.responseText,req,!0)}},4!=req.readyState)return req.send(X.Ajax.preparePostData(postData)),req}},getResponseMimeType:function(request){return request.getResponseHeader("content-type")||""}},Kekule.Ajax=Kekule.X.Ajax,Kekule.X.DomReady={isReady:!1,suspendFlag:0,funcs:[],domReady:function(fn){if(DOM.initReady(),!DOM.isReady){var readyState=Kekule.$document&&Kekule.$document&&Kekule.$document.readyState;("complete"===readyState||"loaded"===readyState||"interactive"===readyState&&!Kekule.Browser.IE)&&(DOM.isReady=!0)}DOM.isReady?fn():DOM.funcs.push(fn)},fireReady:function(){DOM.isReady||(DOM.isReady=!0,DOM._execFuncs())},_execFuncs:function(){var funcs=DOM.funcs;if(funcs&&funcs.length)for(;funcs.length&&!DOM.isSuspending();){var fn=funcs.shift();fn&&fn()}},suspend:function(){++DOM.suspendFlag},resume:function(){DOM.suspendFlag>0&&--DOM.suspendFlag,DOM.isSuspending()||DOM._execFuncs()},isSuspending:function(){return DOM.suspendFlag>0},initReady:function(){Kekule.$document&&Kekule.$document.addEventListener?document.addEventListener("DOMContentLoaded",function(){DOM.fireReady()},!1):Kekule.$document&&Kekule.$document.getElementById&&(document.write('<script id="ie-domReady" defer="defer" src="//:"><\/script>'),document.getElementById("ie-domReady").onreadystatechange=function(){"complete"===this.readyState&&(DOM.fireReady(),this.onreadystatechange=null,this.parentNode.removeChild(this))})}};var DOM=Kekule.X.DomReady;return Kekule.X.domReady=DOM.domReady,Kekule}},function(module,exports,__webpack_require__){"use strict";module.exports=function(Kekule){Kekule.NativeServices={MODE_OPEN:"open",MODE_SAVE:"save",FILTER_ALL_SUPPORT:"all",FILTER_ANY:"any",showFilePickerDialog:function(doc,callback,options){if(Kekule.NativeServices.doShowFilePickerDialog)return Kekule.NativeServices.doShowFilePickerDialog(doc,callback,options)},canLoadFileData:function(doc){return!!KNS.doLoadFileData||!!KNS.doShowFilePickerDialog},loadFileData:function(doc,callback,options){if(Kekule.NativeServices.doLoadFileData)return Kekule.NativeServices.doLoadFileData(doc,callback,options);var ops=Object.create(options||{});ops.multiple=!1,ops.mode=KNS.MODE_OPEN;var done=function(result,file,files){if(result&&file)if(Kekule.BrowserFeature.fileapi){var fileName=file.name,isBinary=ops.binaryDetector&&ops.binaryDetector(fileName,file),reader=new FileReader;reader.onload=function(e){var content=reader.result;callback&&callback(!0,content,fileName)},reader.onerror=function(){callback&&callback(!1),Kekule.error(Kekule.$L("ErrorMsg.ERROR_LOADING_FILE"+fileName))},isBinary?reader.readAsArrayBuffer(file):reader.readAsText(file)}else Kekule.error(Kekule.$L("ErrorMsg.FILE_API_NOT_SUPPORTED"));else callback(result,null,null)};KNS.showFilePickerDialog(doc,done,ops)},canSaveFileData:function(doc){return!!KNS.doSaveFileData},saveFileData:function(doc,data,callback,options){if(Kekule.NativeServices.doSaveFileData)return Kekule.NativeServices.doSaveFileData(doc,data,callback,options)}};var KNS=Kekule.NativeServices;return Kekule.HtmlNativeServiceImpl={doShowFilePickerDialog:function(doc,callback,options){Kekule.HtmlNativeServiceImpl._createFileInputElem(doc,callback,options||{}).click()},_createFileInputElem:function(doc,callback,options){var result=doc.createElement("input");result.setAttribute("type","file");var ops=options||{};if(ops.multiple&&result.setAttribute("multiple","multiple"),ops.filters){for(var filterValues=[],i=0,l=ops.filters.length;i<l;++i){var filterItem=ops.filters[i];if(filterItem!==Kekule.NativeServices.FILTER_ALL_SUPPORT&&filterItem!==Kekule.NativeServices.FILTER_ANY){var sfilter=filterItem.filter;sfilter&&filterValues.push(sfilter)}}var sAllFilter=filterValues.join(",");result.setAttribute("accept",sAllFilter)}var style=result.style;style.position="absolute",style.left="-100000px",style.opacity=0,doc.body.appendChild(result);var reactChange=function reactChange(e){var target=e.getTarget(),files=target.files,firstFile=files&&files[0];callback&&callback(!0,firstFile,files),Kekule.X.Event.removeListener(target,"change",reactChange),target.ownerDocument.body.focus(),target.parentNode};return Kekule.X.Event.addListener(result,"change",reactChange),result},doSaveFileData:function(doc,data,callback,options){var fileName=options.initialFileName||null,dataElem=Kekule.HtmlNativeServiceImpl._createDataElem(doc,data,fileName);dataElem.click(),dataElem.parentNode.removeChild(dataElem),callback&&callback(null,null)},_createDataElem:function(doc,data,fileName){var elem=doc.createElement("a"),sHref="data:application/octet-stream,"+encodeURIComponent(data);elem.setAttribute("href",sHref),elem.setAttribute("download",fileName||"");elem.style;return elem.position="absolute",elem.left="-100000px",elem.opacity=0,doc.body.appendChild(elem),elem},doSaveFileDataIe:function(doc,data,callback,options){var fileName=options.initialFileName||null;if(Kekule.BrowserFeature.blob&&window.navigator.msSaveOrOpenBlob){var blobObject=new Blob([data]);window.navigator.msSaveBlob(blobObject,fileName)}else{var iframeElem=Kekule.HtmlNativeServiceImpl._createAndExecDataIframe(doc,data,fileName);iframeElem.parentNode.removeChild(iframeElem)}callback&&callback(null,null)},_createAndExecDataIframe:function(doc,data,fileName){var result=doc.createElement("iframe");doc.body.appendChild(result);var iframe=result.contentWindow||result.contentDocument;iframe.document.open("text/html","replace");var s=data.toString();return iframe.document.write(s),iframe.document.close(),iframe.focus(),iframe.document.execCommand("SaveAs",!0,Kekule.UrlUtils.extractFileCoreName(fileName)),result}},Kekule.BrowserFeature.fileapi&&(KNS.doShowFilePickerDialog=Kekule.HtmlNativeServiceImpl.doShowFilePickerDialog),Kekule.Browser.IE||Kekule.$jsRoot.navigator&&Kekule.$jsRoot.navigator.msSaveOrOpenBlob?KNS.doSaveFileData=Kekule.HtmlNativeServiceImpl.doSaveFileDataIe:Kekule.BrowserFeature.downloadHref&&(KNS.doSaveFileData=Kekule.HtmlNativeServiceImpl.doSaveFileData),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,ObjectEx=__webpack_require__(0).ObjectEx,DataType=__webpack_require__(0).DataType;module.exports=function(Kekule){return Kekule.PredefinedResLoader=Class.create(ObjectEx,{CLASS_NAME:"Kekule.PredefinedResLoader",initialize:function($super,doc,resUri,resType){$super(),resUri?(this.setPropStoreFieldValue("resUri",resUri),this.setDoc(doc),resType&&this.setResType(resType)):Kekule.Error(Kekule.$L("ErrorMsg.EMPTY_RESURI"))},initProperties:function(){this.defineProp("doc",{dataType:DataType.OBJECT,serializable:!1}),this.defineProp("resUri",{dataType:DataType.STRING,serializable:!1,setter:null}),this.defineProp("resType",{dataType:DataType.STRING,serializable:!1})},getLinkedResUrl:function(elem){var tagName=elem.tagName.toLowerCase();return"link"===tagName?elem.getAttribute("href"):"script"===tagName?elem.getAttribute("src"):null},getElemResType:function(elem){return elem.getAttribute("type")},load:function(callback){var resElem,url,uri=this.getResUri(),idMark=Kekule.PredefinedResReferer.ID_MARK;if(uri.startsWith(idMark)){var id=uri.substr(idMark.length).trim();if(resElem=this.getDoc().getElementById(id)){url=this.getLinkedResUrl(resElem);var resType=this.getElemResType(resElem);resType&&this.setResType(resType)}}else url=uri;var resInfo={resType:this.getResType(),resUri:uri};if(url)Kekule.X.Ajax.sendRequest(url,function(data,req,success){if(success){if(resInfo=Object.extend(resInfo,{data:data,text:req.responseText,success:!0}),!resInfo.resType&&(resInfo.resType=Kekule.X.Ajax.getResponseMimeType(req),resInfo.resType===Kekule.IO.MimeType.OCTSTREAM)){var fileExt=Kekule.UrlUtils.extractFileExt(url);if(fileExt){var chemFormat=Kekule.IO.DataFormatsManager.findFormat(null,fileExt);chemFormat&&(resInfo.resType=chemFormat.mimeType)}}callback(resInfo,success)}else callback(resInfo,!1)},null,null,this.getResType()||null);else if(resElem){var content=resElem.innerHTML,lbreak=2,p=content.indexOf("\r\n");p<0&&(p=content.indexOf("\n"),lbreak=1),0===p&&(content=content.substring(lbreak)),resInfo=Object.extend(resInfo,{data:content,text:content,resType:resInfo.resType||"text/plain",success:!0}),callback(resInfo,!0)}else callback(resInfo,!1)}}),Kekule.PredefinedResReferer={REFER_PATTERN:/^\s*url\((\S+)\)\s*$/,ID_MARK:"#",isResValue:function(str){return Kekule.PredefinedResReferer.isResReferrer(str)},isResReferrer:function(str){return Kekule.PredefinedResReferer.REFER_PATTERN.test(str)},extractReferedValue:function(str){var result=Kekule.PredefinedResReferer.REFER_PATTERN.exec(str);if(result){var value=result[1];if(value)return value=Kekule.StrUtils.unquote(value)}return null},loadResource:function(refStr,callback,resType,doc){doc||(doc=document);var resLoader,R=Kekule.PredefinedResReferer,refValue=R.extractReferedValue(refStr);(resLoader=new Kekule.PredefinedResLoader(doc,refValue))&&(resType&&resLoader.setResType(resType),resLoader.load(callback))}},Kekule._registerAfterLoadProc(function(){Kekule.IO&&(Kekule.IO.loadResourceData=function(refStr,callback,resType,doc){Kekule.PredefinedResReferer.loadResource(refStr,function(resData,success){var chemObj;success&&(chemObj=Kekule.IO.loadTypedData(resData.data,resData.resType,resData.resUri)),callback&&callback(chemObj,success)},resType,doc)})}),Kekule}},function(module,exports,__webpack_require__){"use strict";module.exports=function(Kekule){return Kekule.DomUtils={namespaceMatched:function(node,namespaceURI,allowEmptyNamespace){return void 0===allowEmptyNamespace&&(allowEmptyNamespace=!0),node.namespaceURI==namespaceURI||allowEmptyNamespace&&!node.namespaceURI},isElement:function(obj){return obj&&obj.tagName&&obj.nodeType},getElementText:function(elem){for(var result="",i=0,l=elem.childNodes.length;i<l;++i)3==elem.childNodes[i].nodeType&&(result+=elem.childNodes[i].nodeValue);return result},setElementText:function(elem,text){for(var i=0,l=elem.childNodes.length;i<l;++i)if(3==elem.childNodes[i].nodeType)return elem.childNodes[i].nodeValue=text,text;var textNode=elem.ownerDocument.createTextNode(text);return elem.appendChild(textNode),text},getLocalName:function(elemOrAttrib){return elemOrAttrib.localName||elemOrAttrib.baseName||elemOrAttrib.nodeName},getChildNodesOfTypes:function(node,nodeTypes){for(var result=[],types=Kekule.ArrayUtils.toArray(nodeTypes),i=0,l=node.childNodes.length;i<l;++i){var child=node.childNodes[i];(!nodeTypes||types.indexOf(child.nodeType)>=0)&&result.push(child)}return result},getFirstChildElem:function(elem,tagName,localName,namespaceURI){for(var i=0,l=elem.childNodes.length;i<l;++i){var node=elem.childNodes[i];if(node.nodeType===Node.ELEMENT_NODE&&(tagName&&tagName.toLowerCase()===node.tagName.toLowerCase()||localName&&localName.toLowerCase()===Kekule.DomUtils.getLocalName(node).toLowerCase()||!tagName&&!localName)&&(!namespaceURI||Kekule.DomUtils.namespaceMatched(node,namespaceURI)))return node}},getDirectChildElems:function(elem,tagName,localName,namespaceURI){for(var result=[],i=0,l=elem.childNodes.length;i<l;++i){var node=elem.childNodes[i];node.nodeType===Node.ELEMENT_NODE&&(tagName&&tagName.toLowerCase()===node.tagName.toLowerCase()||localName&&localName.toLowerCase()===Kekule.DomUtils.getLocalName(node).toLowerCase()||!tagName&&!localName)&&(namespaceURI&&!Kekule.DomUtils.namespaceMatched(node,namespaceURI)||result.push(node))}return result},getDirectChildElemsOfAttribValues:function(elem,attribValues,tagName,localName,namespaceURI){for(var elems=Kekule.DomUtils.getDirectChildElems(elem,tagName,localName,namespaceURI),result=[],i=0,l=elems.length;i<l;++i){for(var fitAttribValue=!0,j=0,k=attribValues.length;j<k;++j){var attribName=Kekule.ObjUtils.getOwnedFieldNames(attribValues[j])[0];if(elems[i].getAttribute(attribName)!=attribValues[j][attribName]){fitAttribValue=!1;break}}fitAttribValue&&result.push(elems[i])}return result},isDescendantOf:function(childElem,parentElem){try{if(childElem&&parentElem){if(childElem.documentElement)return!1;if(childElem.ownerDocument===parentElem)return!0;for(var parent=childElem.parentNode;parent;){if(parent===parentElem)return!0;parent=parent.parentNode}}return!1}catch(e){return!1}},isOrIsDescendantOf:function(childElem,parentElem){return childElem===parentElem||Kekule.DomUtils.isDescendantOf(childElem,parentElem)},getNearestAncestorByTagName:function(elem,tagName,includingSelf){var tag=tagName.toLowerCase();if(includingSelf&&elem.tagName&&elem.tagName.toLowerCase()===tag)return elem;for(var result=elem.parentNode;result&&result.tagName;){if(result.tagName.toLowerCase()===tag)return result;result=result.parentNode}return null},getSameNSAttributeValue:function(elem,attribName,domHelper){return elem.getAttribute(attribName)},setSameNSAttributeValue:function(elem,attribName,value,domHelper){return elem.setAttribute(attribName,value)},fetchAttributeValuesToArray:function(elem,namespaceURI,useLocalName){for(var result=[],i=0,l=elem.attributes.length;i<l;++i){var attrib=elem.attributes[i];if(!namespaceURI||Kekule.DomUtils.namespaceMatched(attrib,namespaceURI,!0)){var name;if(useLocalName)try{name=Kekule.DomUtils.getLocalName(attrib)}catch(e){name=attrib.name}else name=attrib.name;result.push({name:name,value:attrib.value})}}return result},fetchAttributeValuesToJson:function(elem,namespaceURI,useLocalName){for(var result={},i=0,l=elem.attributes.length;i<l;++i){var attrib=elem.attributes[i];if(!namespaceURI||Kekule.DomUtils.namespaceMatched(attrib,namespaceURI,!0)){var name;if(useLocalName)try{name=Kekule.DomUtils.getLocalName(attrib)}catch(e){name=attrib.name}else name=attrib.name;result[name]=attrib.value}}return result},hasAttribute:function(elem,attribName){return elem.hasAttribute?elem.hasAttribute(attribName):!!elem.getAttribute(attribName)},isDataAttribName:function(attribName){return attribName.toString().startsWith("data-")},getDataAttribCoreName:function(attribName){return Kekule.DomUtils.isDataAttribName(attribName)?attribName.substr(5):null},getDataAttrib:function(elem,attribName){return elem.dataset?elem.dataset[attribName]:elem.getAttribute("data-"+attribName.toString().hyphenize())},setDataAttrib:function(elem,attribName,value){elem.dataset?elem.dataset[attribName]=value:elem.setAttribute("data-"+attribName.toString().hyphenize(),value)},getDataset:function(elem){if(elem.dataset)return elem.dataset;for(var result={},attribs=elem.attributes,i=0,l=attribs.length;i<l;++i){var attrib=attribs[i],name=attrib.name;if(0===name.toLowerCase().indexOf("data-")){result[name.substring(5).camelize()]=attrib.value}}return result},clearChildContent:function(parentElem){for(var children=Kekule.ArrayUtils.toArray(parentElem.childNodes),i=children.length-1;i>=0;--i){var node=children[i];node.nodeType!==Node.ATTRIBUTE_NODE&&parentElem.removeChild(node)}return parentElem},replaceTagName:function(elem,newTagName){if(elem.tagName.toLowerCase()!==newTagName.toLowerCase()){for(var newElem=elem.ownerDocument.createElement(newTagName),attribs=Kekule.DomUtils.fetchAttributeValuesToArray(elem),i=0,l=attribs.length;i<l;++i)newElem.setAttribute(attribs[i].name,attribs[i].value);for(var children=Kekule.DomUtils.getDirectChildElems(elem),i=0,l=children.length;i<l;++i)newElem.appendChild(children[i]);var parent=elem.parentNode,sibling=elem.nextSibling;return parent.removeChild(elem),sibling?parent.insertBefore(newElem,sibling):parent.appendChild(newElem),newElem}return elem},setElemAttributes:function(elem,hash){for(var props=Kekule.ObjUtils.getOwnedFieldNames(hash),i=0,l=props.length;i<l;++i){var prop=props[i],value=hash[prop];prop&&value&&elem.setAttribute(prop,value)}return elem},isInDomTree:function(node,doc){if(!node)return!1;if(doc||(doc=node.ownerDocument),doc){var docElem=doc.documentElement;return Kekule.DomUtils.isDescendantOf(node,docElem)||node===docElem}return!1}},Kekule.StyleUtils={removeStyleProperty:function(style,propName){style.removeProperty?style.removeProperty(propName):style.removeAttribute?style.removeAttribute(propName):style[propName]=null},analysisUnitsValue:function(value){var r={};r.total=value,r.value=parseFloat(value);var sunit;if(value&&value.length&&void 0!==r.value&&!isNaN(r.value)){sunit="";for(var i=value.length-1;i>=0;--i){var c=value.charAt(i);c>="0"&&c<="9"||"."===c||"-"===c||(sunit=c+sunit)}}return r.units=sunit||"",r},multiplyUnitsValue:function(value,times){var v=Kekule.StyleUtils.analysisUnitsValue(value);return v.value*=times,""+v.value+v.units},colorStrToValue:function(str){var isLongFormat=str.length>4,sR=isLongFormat?str.substr(1,2):str.substr(1,1),sG=isLongFormat?str.substr(3,2):str.substr(2,1),sB=isLongFormat?str.substr(5,2):str.substr(3,1);return isLongFormat||(sR+=sR,sG+=sG,sB+=sB),(parseInt(sR,16)<<16)+(parseInt(sG,16)<<8)+parseInt(sB,16)},getComputedStyle:function(elem,propName){var styles,view=elem.ownerDocument.defaultView;return view&&view.getComputedStyle?styles=view.getComputedStyle(elem,null):elem.currentStyle&&(styles=elem.currentStyle),styles?propName?styles[propName]:styles:null},isShown:function(elem){var U=Kekule.StyleUtils;return U.isDisplayed(elem)&&U.isVisible(elem)},isDisplayed:function(elem){return"none"!==(Kekule.StyleUtils.getComputedStyle(elem,"display")||"").toLowerCase()},getDisplayed:function(elem){return Kekule.StyleUtils.getComputedStyle(elem,"display")},setDisplay:function(elem,value){elem&&(elem.style.display="string"==typeof value?value:value?"":"none")},isVisible:function(elem){return"hidden"!==(Kekule.StyleUtils.getComputedStyle(elem,"visibility")||"").toLowerCase()},getVisibility:function(elem){return Kekule.StyleUtils.getComputedStyle(elem,"visibility")},setVisibility:function(elem,value){elem&&(elem.style.visibility="string"==typeof value?value:value?"":"hidden")},isBlockElem:function(elem){return["block","list-item","table","flex","grid"].indexOf(Kekule.StyleUtils.getComputedStyle(elem,"display"))>=0}},Kekule.HtmlElementUtils={getClassNames:function(elem){return Kekule.StrUtils.splitTokens(elem.className)},hasClass:function(elem,className){return Kekule.HtmlElementUtils.getClassNames(elem).indexOf(className)>=0},addClass:function(elem,className){for(var U=Kekule.HtmlElementUtils,names=Kekule.ArrayUtils.isArray(className)?className:Kekule.StrUtils.splitTokens(className),i=0,l=names.length;i<l;++i)U.hasClass(elem,names[i])||(elem.className+=" "+names[i]);return U},removeClass:function(elem,className){for(var U=Kekule.HtmlElementUtils,removedNames=Kekule.ArrayUtils.isArray(className)?className:Kekule.StrUtils.splitTokens(className),names=U.getClassNames(elem),i=names.length;i>=0;--i){removedNames.indexOf(names[i])>=0&&names.splice(i,1)}return elem.className=names.join(" "),U},toggleClass:function(elem,className){for(var U=Kekule.HtmlElementUtils,names=Kekule.ArrayUtils.isArray(className)?className:Kekule.StrUtils.splitTokens(className),i=0,l=names.length;i<l;++i)U.hasClass(elem,names[i])?U.removeClass(elem,names[i]):U.addClass(elem,names[i]);return U},getInnerText:function(elem){return elem.innerText||elem.textContent},resizeElem:function(elem,width,height,unit){elem.style.width=width+(unit||"px"),elem.style.height=height+(unit||"px")},getElemClientDimension:function(elem){return{width:elem.clientWidth,height:elem.clientHeight}},getElemScrollDimension:function(elem){return{width:elem.scrollWidth,height:elem.scrollHeight}},getElemComputedDimension:function(elem){var SU=Kekule.StyleUtils,dim={width:SU.getComputedStyle(elem,"width"),height:SU.getComputedStyle(elem,"height")},wInfo=SU.analysisUnitsValue(dim.width),hInfo=SU.analysisUnitsValue(dim.height),result={};return"px"===wInfo.units&&(result.width=wInfo.value),"px"===hInfo.units&&(result.height=wInfo.value),result},getElemOffsetDimension:function(elem){return{width:elem.offsetWidth,height:elem.offsetHeight}},getViewportDimension:function(elemOrDocOrViewport){var w;if(elemOrDocOrViewport&&(w=elemOrDocOrViewport.ownerDocument?elemOrDocOrViewport.ownerDocument.defaultView:elemOrDocOrViewport.defaultView?elemOrDocOrViewport.defaultView:elemOrDocOrViewport),w=w||window,null!=w.innerWidth)return{width:w.innerWidth,height:w.innerHeight};var d=w.document;return"CSS1Compat"==d.compatMode?{width:d.documentElement.clientWidth,height:d.documentElement.clientHeight}:{width:d.body.clientWidth,height:d.body.clientHeight}},getElemBoundingClientRect:function(elem,includeScroll){var r=Object.extend({},elem.getBoundingClientRect());if(Kekule.ObjUtils.isUnset(r.width)&&(r.width=r.right-r.left),Kekule.ObjUtils.isUnset(r.height)&&(r.height=r.bottom-r.top),includeScroll){var doc=elem.ownerDocument,scrollTop=doc.documentElement.scrollTop||doc.body.scrollTop||0,scrollLeft=doc.documentElement.scrollLeft||doc.body.scrollLeft||0;r.left+=scrollLeft,r.right+=scrollLeft,r.top+=scrollTop,r.bottom+=scrollTop}var result=r;return result.x=result.left,result.y=result.top,result},getElemPagePos:function(elem){var xPosition=0,yPosition=0;if(elem.getBoundingClientRect){var box=elem.getBoundingClientRect(),doc=elem.ownerDocument,body=doc.body,docElem=doc.documentElement,clientTop=docElem.clientTop||body.clientTop||0,clientLeft=docElem.clientLeft||body.clientLeft||0;yPosition=box.top+(window&&window.pageYOffset||docElem&&docElem.scrollTop||body.scrollTop)-clientTop,xPosition=box.left+(window&&window.pageXOffset||docElem&&docElem.scrollLeft||body.scrollLeft)-clientLeft}else for(;elem;)xPosition+=elem.offsetLeft-elem.scrollLeft+elem.clientLeft,yPosition+=elem.offsetTop-elem.scrollTop+elem.clientTop,elem=elem.offsetParent;return{x:xPosition,y:yPosition}},getElemPageRect:function(elem){var pos=Kekule.HtmlElementUtils.getElemPagePos(elem),dim=Kekule.HtmlElementUtils.getElemClientDimension(elem);return{x:pos.x,y:pos.y,left:pos.x,top:pos.y,width:dim.width,height:dim.height}},getElemViewportPos:function(elem){var rect=Kekule.HtmlElementUtils.getElemBoundingClientRect(elem);return{x:rect.left,y:rect.top}},makePositioned:function(elem){var p=Kekule.StyleUtils.getComputedStyle(elem,"position");p&&"static"!==p.toLowerCase()||(elem.style.position="relative")},isFormCtrlElement:function(elem){var formCtrlTags=["input","button","textarea","select"],tagName=elem.tagName.toLowerCase();return formCtrlTags.indexOf(tagName)>=0}},Kekule.DocumentUtils={getClientDimension:function(document){return"BackCompat"==document.compatMode?{width:document.body.clientWidth,height:document.body.clientHeight}:{width:document.documentElement.clientWidth,height:document.documentElement.clientHeight}},getScrollPosition:function(document){var result={left:document.documentElement.scrollLeft||document.body.scrollLeft||0,top:document.documentElement.scrollTop||document.body.scrollTop||0};return result.x=result.left,result.y=result.top,result}},Kekule.DataSrcAttribUtils={isUrlBasedValue:function(str){return 0===str.toLowerCase().indexOf("url(")},getUrl:function(str){var result=str.trim();if(0===result.toLowerCase().indexOf("url(")){var p2=result.lastIndexOf(")");return result=result.substring(4,p2)}return null},getElementContent:function(elem){if(!elem)return null;var content=elem.innerHTML;return content=content.ltrim()},getElementMimeType:function(elem){return elem.getAttribute("type")}},Kekule.ScriptFileUtils={_existedScriptUrls:new Kekule.MapEx,appendScriptFile:function(doc,url,callback){var exists=Kekule.ScriptFileUtils._existedScriptUrls.get(doc);if(exists||(exists=[],Kekule.ScriptFileUtils._existedScriptUrls.set(doc,exists)),exists.indexOf(url)>=0)return void(callback&&callback());var result=doc.createElement("script");return result.src=url,result.onload=result.onreadystatechange=function(e){if(!result._loaded){var readyState=result.readyState;void 0!==readyState&&"loaded"!==readyState&&"complete"!==readyState||(result._loaded=!0,result.onload=result.onreadystatechange=null,exists.push(url),callback&&callback())}},(doc.getElementsByTagName("head")[0]||doc.body).appendChild(result),result},appendScriptFiles:function(doc,urls,callback){var dupUrls=[].concat(urls);!function(doc,urls,callback){if(urls.length<=0)return void(callback&&callback());var file=urls.shift();Kekule.ScriptFileUtils.appendScriptFile(doc,file,function(){Kekule.ScriptFileUtils.appendScriptFiles(doc,urls,callback)})}(doc,dupUrls,callback)}},Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,ObjectEx=(__webpack_require__(0).ClassEx,__webpack_require__(0).ObjectEx),DataType=__webpack_require__(0).DataType;module.exports=function(Kekule){return Kekule.DomHelper=Class.create(ObjectEx,{CLASS_NAME:"Kekule.DomHelper",NAMESPACE_DEFINE_PREFIX:"xmlns",NAMESPACE_DELIMITER:":",ERR_EMPTY_DOC:"Document is empty",ERR_ELEMENT_NOTSET:"Element not set",initialize:function($super,doc){$super(),this._supportNsMethods=null,doc&&this.setDocument(doc)},initProperties:function(){this.defineProp("document",{dataType:DataType.OBJECT,serializable:!1,getter:function(){var result=this.getPropStoreFieldValue("document");if(!result){var elem=this.getPropStoreFieldValue("rootElement");result=elem?elem.ownerDocument:null}return result},setter:function(value){value!=this.getPropStoreFieldValue("document")&&(this.setPropStoreFieldValue("document",value),this.analysisRootElem())}}),this.defineProp("rootElement",{dataType:DataType.OBJECT,serializable:!1,getter:function(){var result=this.getPropStoreFieldValue("rootElement");if(!result){var doc=this.getPropStoreFieldValue("document");result=doc?doc.documentElement:null}return result},setter:function(value){this.setPropStoreFieldValue("rootElement",value),this.analysisRootElem()}}),this.defineProp("namespaces",{dataType:DataType.ARRAY,serializable:!1,getter:function(){return this.getPropStoreFieldValue("namespaces")||this.setPropStoreFieldValue("namespaces",[]),this.getPropStoreFieldValue("namespaces")}}),this.defineProp("defNamespaceURI",{dataType:DataType.STRING,serializable:!1}),this.defineProp("forceAnalysisDoc",{dataType:DataType.BOOL})},analysisRootElem:function(){this.setNamespaces([]),this.setDefNamespaceURI(null);var docElem=this.getRootElement();if(docElem){var doc=docElem.ownerDocument;if(this._supportNsMethods=!!doc.getElementsByTagNameNS,!this._supportNsMethods||this.getForceAnalysisDoc())for(var i=0,l=docElem.attributes.length;i<l;++i){var attrib=docElem.attributes[i],attribName=attrib.name;if(attribName&&attribName.indexOf(this.NAMESPACE_DEFINE_PREFIX)>=0){var ns=attrib.value,delimiterPos=attribName.indexOf(this.NAMESPACE_DELIMITER),prefix=delimiterPos>=0?attribName.substring(delimiterPos+1):null;this.getNamespaces().push({namespaceURI:ns,prefix:prefix}),prefix||this.setDefNamespaceURI(ns)}}}},_getEmptyDocErrorMsg:function(){return Kekule.hasLocalRes()?Kekule.$L("ErrorMsg.EMPTY_DOC"):this.ERR_EMPTY_DOC},_getElementNotSetErrorMsg:function(){return Kekule.hasLocalRes()?Kekule.$L("ErrorMsg.ELEMENT_NOTSET"):this.ELEMENT_NOTSET},assertDocAvailable:function(doc){return!!doc||(Kekule.raise(this._getEmptyDocErrorMsg()),!1)},assertElementAvailable:function(element){return!!element||(Kekule.raise(this._getElementNotSetErrorMsg()),!1)},getNsPrefix:function(namespaceURI){if(namespaceURI==this.getDefNamespaceURI())return"";for(var namespaces=this.getNamespaces(),i=0,l=namespaces.length;i<l;++i)if(namespaces[i].namespaceURI==namespaceURI)return namespaces[i].prefix;return null},getQualifiedName:function(namespaceURI,localName){var prefix=this.getNsPrefix(namespaceURI);return null===prefix?null:prefix?prefix+this.NAMESPACE_DELIMITER+localName:localName},createElementNS:function(namespace,qualifiedName){var doc=this.getDocument();return this.assertDocAvailable(doc)?this._supportNsMethods?doc.createElementNS(namespace,qualifiedName):doc.createElement(qualifiedName):null},getElementsByTagNameNS:function(namespaceURI,localName,element){var root=this.getPropStoreFieldValue("document")||this.getPropStoreFieldValue("rootElement"),doc=this.getDocument();if(!this.assertDocAvailable(doc))return null;if(this._supportNsMethods)return element?element.getElementsByTagNameNS(namespaceURI,localName):root.getElementsByTagNameNS(namespaceURI,localName);var qualifiedName=this.getQualifiedName(namespaceURI,localName);return null===qualifiedName?[]:element?element.getElementsByTagName(qualifiedName):root.getElementsByTagName(qualifiedName)},getAttributeNodeNS:function(namespaceURI,localName,element){if(!this.assertElementAvailable(element))return null;if(this._supportNsMethods)return element.getAttributeNodeNS(namespaceURI,localName);var qualifiedName=this.getQualifiedName(namespaceURI,localName);return null===qualifiedName?null:element.getAttributeNode(qualifiedName)},getAttributeNS:function(namespaceURI,localName,element){if(!this.assertElementAvailable(element))return null;if(this._supportNsMethods)return element.getAttributeNS(namespaceURI,localName);var qualifiedName=this.getQualifiedName(namespaceURI,localName);return null===qualifiedName?null:element.getAttribute(qualifiedName)},setAttributeNS:function(namespaceURI,localName,value,element){if(!this.assertElementAvailable(element))return null;if(this._supportNsMethods)return element.setAttributeNS(namespaceURI,localName,value);var qualifiedName=this.getQualifiedName(namespaceURI,localName);return null===qualifiedName?null:element.setAttribute(qualifiedName,value)}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,ObjectEx=__webpack_require__(0).ObjectEx,DataType=__webpack_require__(0).DataType;module.exports=function(Kekule){return Kekule.TextLinesBuffer=Class.create(ObjectEx,{CLASS_NAME:"Kekule.TextLinesBuffer",LINEBREAK:"\n",initialize:function($super,textOrLines){$super(),this.setPropStoreFieldValue("lines",[]),textOrLines&&("string"==typeof textOrLines?this.setText(textOrLines):this.setLines(textOrLines)),this.setCurrLineNo(0)},initProperties:function(){this.defineProp("lines",{dataType:DataType.ARRAY,serializable:!1}),this.defineProp("text",{dataType:DataType.STRING,serializable:!1,getter:function(){return this.getLines().join(this.LINEBREAK)},setter:function(value){this.setPropStoreFieldValue("lines",[]),this.reset(),this.appendText(value)}}),this.defineProp("currLineNo",{dataType:DataType.INT,serializable:!1})},getUnreadLines:function(){var lines=[].concat(this.getLines());return lines.splice(0,this.getCurrLineNo()),lines},getUnreadText:function(){return this.getUnreadLines().join(this.LINEBREAK)},appendText:function(text){var lines=text.split(this.LINEBREAK);this.appendLines(lines)},appendLines:function(lines){this.setPropStoreFieldValue("lines",this.getLines().concat(lines)),this.notifyPropSet("lines",this.getPropStoreFieldValue("lines"))},clear:function(){this.setLines([]),this.setCurrLineNo(0)},incCurrLineNo:function(count){null!==count&&void 0!==count||(count=1);var i=this.getCurrLineNo();i+=count,this.setCurrLineNo(i)},getLineAt:function(index){var s=this.getLines()[index];return s&&s.length&&"\r"===s.charAt(s.length-1)&&(s=s.substring(0,s.length-1)),s},getCurrLine:function(){return this.getLineAt(this.getCurrLineNo())},readLine:function(){var r=this.getLineAt(this.getCurrLineNo());return this.incCurrLineNo(),r},writeLine:function(line){this.getLines().splice(this.getCurrLineNo(),0,line),this.incCurrLineNo()},writeLines:function(lines){for(var i=0,l=lines.length;i<l;++i)this.writeLine(lines[i])},writeText:function(text){var lines=text.split(this.LINEBREAK);this.writeLines(lines)},eof:function(){return this.getCurrLineNo()>=this.getLines().length},reset:function(){this.setCurrLineNo(0)}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,ClassEx=__webpack_require__(0).ClassEx,ObjectEx=__webpack_require__(0).ObjectEx,DataType=__webpack_require__(0).DataType;module.exports=function(Kekule){Kekule.globalOptions.add("IO",{}),Kekule.IO={},Kekule.IO.ChemDataType={TEXT:"text",DOM:"dom",JSON:"json",BINARY:"bin",OTHER:"other",UNKNOWN:"unknown",isBinaryType:function(dataType){var T=Kekule.IO.ChemDataType;return!dataType||dataType===T.BINARY||dataType===T.OTHER||dataType===T.UNKNOWN}},Kekule.IO.DataFormat={},Kekule.IO.MimeType={TEXT:"text/plain",HTML:"text/html",XML:"text/xml",JSON:"application/json",JAVASCRIPT:"application/javascript",GIF:"image/gif",JPEG:"image/jpeg",PNG:"image/png",XPNG:"image/x-png",OCTSTREAM:"application/octet-stream"},Kekule.IO.DataFormatsManager={_formats:{},register:function(id,mimeType,fileExts,dataType,title,description,additionalInfo){var result=null;result||(result=FM._formats[id]),result||(result={id:id},FM._formats[id]=result),result.mimeType=mimeType;var exts=DataType.isArrayValue(fileExts)?fileExts:[fileExts];return result.fileExts?Kekule.ArrayUtils.pushUnique(result.fileExts,exts):result.fileExts=exts,dataType&&dataType!==Kekule.IO.ChemDataType.UNKNOWN&&(result.dataType=dataType),result.title=title,result.description=description,additionalInfo&&(result=Object.extend(result,additionalInfo)),result},unregister:function(id){FM._formats[id]&&delete FM._formats[id]},getAllIds:function(){return Kekule.ObjUtils.getOwnedFieldNames(FM._formats)},getFormatInfo:function(id){return FM._formats[id]||null},getMimeType:function(id){var info=FM.getFormatInfo(id);return info?info.mimeType:null},getFileExts:function(id){var info=FM.getFormatInfo(id);return info?info.fileExts:null},findFormat:function(mimeType,fileExt){if(!mimeType&&!fileExt)return null;for(var ids=FM.getAllIds(),matched=!1,i=0,l=ids.length;i<l;++i){var info=FM.getFormatInfo(ids[i]);if(matched=mimeType&&mimeType===info.mimeType,matched||(matched=fileExt&&info.fileExts.indexOf(fileExt)>=0),matched)return info}return null},findFormatId:function(mimeType,fileExt){var info=Kekule.IO.DataFormatsManager.findFormat(mimeType,fileExt);return info?info.id:null}};var FM=Kekule.IO.DataFormatsManager;return Kekule.IO.dataFormatsManager=Kekule.IO.DataFormatsManager,Kekule.IO.ChemDataReader=Class.create(ObjectEx,{initialize:function($super,options){$super()},CLASS_NAME:"Kekule.IO.ChemDataReader",readData:function(data,dataType,format,options){if(!dataType){var finfo=Kekule.IO.DataFormatsManager.getFormatInfo(format);dataType=finfo?finfo.dataType:null,dataType||(dataType="string"==typeof data?Kekule.IO.ChemDataType.TEXT:data.getElementsByTagName?Kekule.IO.ChemDataType.DOM:Kekule.IO.ChemDataType.BINARY)}var result=this.doReadData(data,dataType,format,options||{});if(result instanceof Kekule.ChemObject&&result.getSrcInfo){var info=result.getSrcInfo();info.data=data,info.dataType=dataType;var formatDetail=Kekule.IO.DataFormatsManager.getFormatInfo(format);formatDetail&&(info.format=format,info.mimeType=formatDetail.mimeType,info.possibleFileExts=formatDetail.fileExts)}return result},doReadData:function(data,dataType,format,options){}}),Kekule.IO.ChemDataWriter=Class.create(ObjectEx,{CLASS_NAME:"Kekule.IO.ChemDataWriter",initialize:function($super,options){$super()},writeData:function(obj,dataType,format,options){if(!dataType){var finfo=Kekule.IO.DataFormatsManager.getFormatInfo(format);dataType=finfo?finfo.dataType:null}return this.doWriteData(obj,dataType,format,options||{})},doWriteData:function(obj,dataType,format,options){}}),Kekule.IO.ChemDataReaderManager={_readers:[],register:function(id,readerClass,formatId,additionalInfo){if(id&&readerClass&&formatId&&(!DataType.isArrayValue(formatId)||formatId.length)){if(Kekule.IO.ChemDataReaderManager.getReaderInfoById(id))return Kekule.raise(Kekule.$L("ErrorMsg.READER_ID_ALREADY_EXISTS")),null;var item={id:id,readerClass:readerClass,formatId:DataType.isArrayValue(formatId)?formatId:[formatId]};return item=Object.extend(item,additionalInfo),Kekule.IO.ChemDataReaderManager._readers.push(item),item}},getAllReadableFormatIds:function(){for(var result=[],readers=Kekule.IO.ChemDataReaderManager._readers,i=0,l=readers.length;i<l;++i){var item=readers[i],fids=item.formatId;Kekule.ArrayUtils.pushUnique(result,fids)}return result},getAllReadableFormats:function(){for(var result=[],ids=Kekule.IO.ChemDataReaderManager.getAllReadableFormatIds(),i=0,l=ids.length;i<l;++i){var info=FM.getFormatInfo(ids[i]);info&&result.push(info)}return result},getAvailableReaderInfos:function(condition){for(var result=[],rs=Kekule.IO.ChemDataReaderManager._readers,i=rs.length-1;i>=0;--i)Kekule.ObjUtils.match(rs[i],condition)&&result.push(rs[i]);return result},getReaderInfo:function(condition){for(var rs=Kekule.IO.ChemDataReaderManager._readers,i=rs.length-1;i>=0;--i)if(Kekule.ObjUtils.match(rs[i],condition))return rs[i];return null},getReaderInfoById:function(id){return Kekule.IO.ChemDataReaderManager.getReaderInfo({id:id})},getReaderInfoByFormat:function(formatId,otherConditions){for(var rs=Kekule.IO.ChemDataReaderManager._readers,i=rs.length-1;i>=0;--i)if((!otherConditions||Kekule.ObjUtils.match(rs[i],otherConditions))&&rs[i].formatId.indexOf(formatId)>=0)return rs[i];return null},getReaderInfoByFileExt:function(fileExt,otherConditions){var fid=Kekule.IO.DataFormatsManager.findFormatId(null,fileExt);return fid?Kekule.IO.ChemDataReaderManager.getReaderInfoByFormat(fid,otherConditions):null},createReaderOfInfo:function(info){return new info.readerClass(info.createOptions)},getReaderOfInfo:function(info){return info.instance||(info.instance=Kekule.IO.ChemDataReaderManager.createReaderOfInfo(info)),info.instance},createReader:function(condition){var info=Kekule.IO.ChemDataReaderManager.getReaderInfo(condition);if(info)return Kekule.IO.ChemDataReaderManager.createReaderOfInfo(info)},getReader:function(condition){var info=Kekule.IO.ChemDataReaderManager.getReaderInfo(condition);if(info)return Kekule.IO.ChemDataReaderManager.getReaderOfInfo(info)},createReaderById:function(id){return Kekule.IO.ChemDataReaderManager.createReader({id:id})},getReaderById:function(id){return Kekule.IO.ChemDataReaderManager.getReader({id:id})},createReaderByFormat:function(formatId,otherConditions){var info=Kekule.IO.ChemDataReaderManager.getReaderInfoByFormat(formatId,otherConditions);return info?Kekule.IO.ChemDataReaderManager.createReaderOfInfo(info):null},getReaderByFormat:function(formatId,otherConditions){var info=Kekule.IO.ChemDataReaderManager.getReaderInfoByFormat(formatId,otherConditions);return info?Kekule.IO.ChemDataReaderManager.getReaderOfInfo(info):null},createReaderByFileExt:function(fileExt,otherConditions){var info=Kekule.IO.ChemDataReaderManager.getReaderInfoByFileExt(fileExt,otherConditions);return info?Kekule.IO.ChemDataReaderManager.createReaderOfInfo(info):null},getReaderByFileExt:function(fileExt,otherConditions){var info=Kekule.IO.ChemDataReaderManager.getReaderInfoByFileExt(fileExt,otherConditions);return info?Kekule.IO.ChemDataReaderManager.getReaderOfInfo(info):null},createReaderByMimeType:function(mimeType){var fid=Kekule.IO.DataFormatsManager.findFormatId(mimeType,null);return fid?Kekule.IO.ChemDataReaderManager.createReaderByFormat(fid):null},getReaderByMimeType:function(mimeType){var fid=Kekule.IO.DataFormatsManager.findFormatId(mimeType,null);return fid?Kekule.IO.ChemDataReaderManager.getReaderByFormat(fid):null}},Kekule.IO.ChemDataWriterManager={_writers:[],register:function(id,writerClass,srcClasses,formatId,additionalInfo){if(id&&writerClass&&formatId&&(!DataType.isArrayValue(formatId)||formatId.length)){if(Kekule.IO.ChemDataWriterManager.getWriterInfoById(id))return Kekule.raise(Kekule.$L("ErrorMsg.WRITER_ID_ALREADY_EXISTS")),null;var item={id:id,writerClass:writerClass,srcClasses:srcClasses,formatId:DataType.isArrayValue(formatId)?formatId:[formatId]};return item=Object.extend(item,additionalInfo),Kekule.IO.ChemDataWriterManager._writers.push(item),item}},getAllWritableFormatIds:function(){for(var result=[],writers=Kekule.IO.ChemDataWriterManager._writers,i=0,l=writers.length;i<l;++i){var item=writers[i],fids=item.formatId;Kekule.ArrayUtils.pushUnique(result,fids)}return result},getAllWritableFormats:function(){for(var result=[],ids=Kekule.IO.ChemDataWriterManager.getAllWritableFormatIds(),i=0,l=ids.length;i<l;++i){var info=FM.getFormatInfo(ids[i]);info&&result.push(info)}return result},getAvailableWriterInfos:function(condition,srcObjOrClass){for(var result=[],srcClass=ClassEx.isClass(srcObjOrClass)?srcObjOrClass:srcObjOrClass.getClass?srcObjOrClass.getClass():srcObjOrClass?null:void 0,ws=Kekule.IO.ChemDataWriterManager._writers,i=ws.length-1;i>=0;--i)if(Kekule.ObjUtils.match(ws[i],condition))if(void 0!==srcClass){if(srcClass)for(var j=0,k=ws[i].srcClasses.length;j<k;++j)ClassEx.isOrIsDescendantOf(srcClass,ws[i].srcClasses[j])&&result.push(ws[i])}else result.push(ws[i]);return result},getWriterInfo:function(condition,srcObj){for(var ws=Kekule.IO.ChemDataWriterManager._writers,i=ws.length-1;i>=0;--i)if(Kekule.ObjUtils.match(ws[i],condition)){if(srcObj){for(var j=0,k=ws[i].srcClasses.length;j<k;++j)if(srcObj instanceof ws[i].srcClasses[j])return ws[i];return null}return ws[i]}return null},getWriterInfoById:function(id,srcObj){return Kekule.IO.ChemDataWriterManager.getWriterInfo({id:id},srcObj)},getWriterInfoByFormat:function(formatId,otherConditions,srcObj){for(var ws=Kekule.IO.ChemDataWriterManager._writers,i=ws.length-1;i>=0;--i)if((!otherConditions||Kekule.ObjUtils.match(ws[i],otherConditions))&&ws[i].formatId.indexOf(formatId)>=0){if(srcObj){for(var j=0,k=ws[i].srcClasses.length;j<k;++j)if(srcObj instanceof ws[i].srcClasses[j])return ws[i];return null}return ws[i]}return null},getWriterInfoByFileExt:function(fileExt,otherConditions,srcObj){var fid=Kekule.IO.DataFormatsManager.findFormatId(null,fileExt);return fid?Kekule.IO.ChemDataWriterManager.getWriterInfoByFormat(fid,otherConditions,srcObj):null},createWriterOfInfo:function(info){return new info.writerClass(info.createOptions)},getWriterOfInfo:function(info){return info.instance||(info.instance=Kekule.IO.ChemDataWriterManager.createWriterOfInfo(info)),info.instance},createWriter:function(condition,srcObj){var info=Kekule.IO.ChemDataWriterManager.getWriterInfo(condition,srcObj);return info?Kekule.IO.ChemDataWriterManager.createWriterOfInfo(info):null},getWriter:function(condition,srcObj){var info=Kekule.IO.ChemDataWriterManager.getWriterInfo(condition,srcObj);return info?Kekule.IO.ChemDataWriterManager.getWriterOfInfo(info):null},createWriterById:function(id,srcObj){return Kekule.IO.ChemDataWriterManager.createWriter({id:id},srcObj)},getWriterById:function(id,srcObj){return Kekule.IO.ChemDataWriterManager.getWriter({id:id},srcObj)},createWriterByFormat:function(formatId,otherConditions,srcObj){var info=Kekule.IO.ChemDataWriterManager.getWriterInfoByFormat(formatId,otherConditions,srcObj);return info?Kekule.IO.ChemDataWriterManager.createWriterOfInfo(info):null},getWriterByFormat:function(formatId,otherConditions,srcObj){var info=Kekule.IO.ChemDataWriterManager.getWriterInfoByFormat(formatId,otherConditions,srcObj);return info?Kekule.IO.ChemDataWriterManager.getWriterOfInfo(info):null},createWriterByFileExt:function(fileExt,otherConditions,srcObj){var info=Kekule.IO.ChemDataWriterManager.getWriterInfoByFileExt(fileExt,otherConditions,srcObj);return info?Kekule.IO.ChemDataWriterManager.createWriterOfInfo(info):null},getWriterByFileExt:function(fileExt,otherConditions,srcObj){var info=Kekule.IO.ChemDataWriterManager.getWriterInfoByFileExt(fileExt,otherConditions,srcObj);return info?Kekule.IO.ChemDataWriterManager.getWriterOfInfo(info):null},createWriterByMimeType:function(mimeType,srcObj){var fid=Kekule.IO.DataFormatsManager.findFormatId(mimeType,null);return fid?Kekule.IO.ChemDataWriterManager.createWriterByFormat(fid,null,srcObj):null},getWriterByMimeType:function(mimeType){var fid=Kekule.IO.DataFormatsManager.findFormatId(mimeType,null);return fid?Kekule.IO.ChemDataWriterManager.getWriterByFormat(fid,null):null}},Kekule.IO.loadFormatData=function(content,formatId,options){var reader=Kekule.IO.ChemDataReaderManager.getReaderByFormat(formatId);if(reader){var result=reader.readData(content,null,formatId,options);if(!1===result){var msg=Kekule.$L("ErrorMsg.FAIL_TO_READ_FORMAT")+formatId;Kekule.raise(msg)}return result}var msg=Kekule.$L("ErrorMsg.NO_SUITABLE_READER_FOR_FORMAT")+formatId;return Kekule.raise(msg),null},Kekule.IO.loadMimeData=function(content,mimeType,options){return Kekule.IO.loadTypedData(content,mimeType,null,options)},Kekule.IO.loadTypedData=function(content,mimeType,url,options){var fileExt;url&&(fileExt=Kekule.UrlUtils.extractFileExt(url));var result,formatId=Kekule.IO.DataFormatsManager.findFormatId(mimeType,mimeType?null:fileExt);if(formatId&&(result=Kekule.IO.loadFormatData(content,formatId,options)),!1!==result){if(result instanceof Kekule.ChemObject&&result.getSrcInfo){var info=result.getSrcInfo();mimeType&&(info.mimeType=mimeType),fileExt&&(info.fileExt=fileExt),url&&(info.url=url,info.fileName=url)}return result}var msg=mimeType?Kekule.$L("ErrorMsg.NO_SUITABLE_READER_FOR_MIMETYPE")+mimeType:Kekule.$L("ErrorMsg.NO_SUITABLE_READER_FOR_FILEEXT")+fileExt;return Kekule.raise(msg),null},Kekule.IO.loadFileData=function(file,callback,formatId,options){if(Kekule.BrowserFeature.fileapi){var formatInfo,fileName=file.name,ext=Kekule.UrlUtils.extractFileExt(fileName);if(!(formatInfo=formatId?Kekule.IO.DataFormatsManager.getFormatInfo(formatId):Kekule.IO.DataFormatsManager.findFormat(null,ext))){var msg=Kekule.$L("ErrorMsg.NO_SUITABLE_READER_FOR_FILEEXT")+ext;return void Kekule.raise(msg)}var isBinary=Kekule.IO.ChemDataType.isBinaryType(formatInfo.dataType),reader=new FileReader;reader.onload=function(e){var content=reader.result,chemObj=Kekule.IO.loadFormatData(content,formatInfo.id,options);chemObj.getSrcInfo().fileName=fileName,callback(chemObj,!1!==chemObj)},isBinary?reader.readAsArrayBuffer(file):reader.readAsText(file)}else Kekule.error(Kekule.$L("ErrorMsg.FILE_API_NOT_SUPPORTED"))},Kekule.IO.loadUrlData=function(fileUrl,callback,formatId,options){if(!Kekule.Ajax)return Kekule.raise(Kekule.$L("ErrorMsg.AJAX_FILELOADER_NOT_FOUND")),null;Kekule.Ajax.sendRequest(fileUrl,function(data,requestObj,success){if(data&&success){var formatInfo;if(formatId&&(formatInfo=Kekule.IO.DataFormatsManager.getFormatInfo(formatId)),!formatId){var mimeType=Kekule.Ajax.getResponseMimeType(requestObj);formatInfo=Kekule.IO.DataFormatsManager.findFormat(mimeType)}if(!formatId){var ext=Kekule.UrlUtils.extractFileExt(fileUrl);formatInfo=Kekule.IO.DataFormatsManager.findFormat(null,ext)}if(!formatInfo){var msg=Kekule.$L("ErrorMsg.NO_SUITABLE_READER_FOR_FILEEXT")+ext;return void Kekule.raise(msg)}var chemObj=Kekule.IO.loadFormatData(data,formatInfo.id,options);chemObj.getSrcInfo().fileName=fileUrl;var success=!1!==chemObj;callback(chemObj,success)}else Kekule.raise(Kekule.$L("ErrorMsg.FAIL_TO_LOAD_FILE_URL")+fileUrl)})},Kekule.IO.saveFormatData=function(chemObj,formatId,options){var writer=Kekule.IO.ChemDataWriterManager.getWriterByFormat(formatId,null,chemObj);if(writer){return writer.writeData(chemObj,null,formatId,options)}var msg=Kekule.$L("ErrorMsg.NO_SUITABLE_WRITER_FOR_FORMAT")+formatId;return Kekule.raise(msg),null},Kekule.IO.saveMimeData=function(chemObj,mimeType,options){return Kekule.IO.saveTypedData(chemObj,mimeType,null,options)},Kekule.IO.saveTypedData=function(chemObj,mimeType,urlOrFileExt,options){var fileExt;urlOrFileExt&&((fileExt=Kekule.UrlUtils.extractFileExt(urlOrFileExt))||(fileExt=urlOrFileExt));var result,formatId=Kekule.IO.DataFormatsManager.findFormatId(mimeType,mimeType?null:fileExt);if(formatId&&(result=Kekule.IO.saveFormatData(chemObj,formatId,options)),Kekule.ObjUtils.isUnset(result)){var msg=mimeType?Kekule.$L("ErrorMsg.NO_SUITABLE_WRITER_FOR_MIMETYPE")+mimeType:Kekule.$L("ErrorMsg.NO_SUITABLE_WRITER_FOR_FILEEXT")+fileExt;return Kekule.raise(msg),null}return result},Kekule}},function(module,exports,__webpack_require__){"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},Class=__webpack_require__(0).Class,ObjectEx=__webpack_require__(0).ObjectEx,DataType=__webpack_require__(0).DataType,XmlUtility=__webpack_require__(1).XmlUtility;module.exports=function(Kekule){return Kekule.globalOptions.add("IO.cml",{prettyPrint:!0}),Kekule.IO.CML={CML2CORE_NAMESPACE_URI:"http://www.xml-cml.org/schema/cml2/core",CML3_SCHEMA_NAMESPACE_URI:"http://www.xml-cml.org/schema",ARRAY_VALUE_DELIMITER:" ",TYPED_ELEM_NAMES:["string","integer","float"],TYPED_ARRAY_ELEM_NAMES:["stringArray","integerArray","floatArray"],ATOMS_REF_ATTRIBS:["atomRef","atomRefs2","atomRefs3","atomRefs4","atomRefs","atomRefArray"],BONDS_REF_ATTRIBS:["bondRef","bondRefs","bondRefArray"]},Kekule.IO.CML.LEGAL_CORE_NAMESPACE_URIS=[Kekule.IO.CML.CML2CORE_NAMESPACE_URI,Kekule.IO.CML.CML3_SCHEMA_NAMESPACE_URI],Kekule.IO.CmlUtils={cmlBondOrderToKekule:function(cmlOrder){var result=parseInt(cmlOrder);if(result!==result)switch(cmlOrder.toUpperCase()){case"A":result=Kekule.BondOrder.EXPLICIT_AROMATIC;break;case"D":result=Kekule.BondOrder.DOUBLE;break;case"T":result=Kekule.BondOrder.TRIPLE;break;case"S":default:result=Kekule.BondOrder.SINGLE}return result},kekuleBondOrderToCml:function(kekuleOrder){switch(kekuleOrder){case Kekule.BondOrder.EXPLICIT_AROMATIC:return"A";case Kekule.BondOrder.QUAD:return"4";case Kekule.BondOrder.DOUBLE:return"D";case Kekule.BondOrder.TRIPLE:return"T";default:return"S"}},cmlBondStereoToKekule:function(cmlStereo){var result;switch(cmlStereo.toUpperCase()){case"E":result=Kekule.BondStereo.E;break;case"Z":result=Kekule.BondStereo.Z;break;case"C":result=Kekule.BondStereo.CIS;break;case"T":result=Kekule.BondStereo.TRANS;break;case"W":result=Kekule.BondStereo.UP;break;case"H":result=Kekule.BondStereo.DOWN;break;default:result=Kekule.BondStereo.NONE}return result},kekuleBondStereoToCml:function(kekuleStereo){switch(kekuleStereo){case Kekule.BondStereo.UP:return{value:"W"};case Kekule.BondStereo.UP_INVERTED:return{value:"W",invert:!0};case Kekule.BondStereo.DOWN:return{value:"H"};case Kekule.BondStereo.DOWN_INVERTED:return{value:"H",invert:!0};case Kekule.BondStereo.E:return{value:"E"};case Kekule.BondStereo.Z:return{value:"Z"};case Kekule.BondStereo.CIS:return{value:"C"};case Kekule.BondStereo.TRANS:return{value:"T"};default:return{value:null}}},reagentRoleToKekule:function(cmlRole){var R=Kekule.ReactionRole;switch(cmlRole){case"reagent":return R.REAGENT;case"catalyst":case"solvent":return R.CATALYST;default:return cmlRole}},kekuleReagentRoleToCml:function(kekuleRole){var R=Kekule.ReactionRole;switch(kekuleRole){case R.REAGENT:return"reagent";case R.CATALYST:return"catalyst";case R.SOLVENT:return"solvent";default:return kekuleRole}},isDummyElementType:function(value){return"Du"==value||"Dummy"==value},isRGroupElementType:function(value){return"R"==value},isAtomListElementType:function(value){return"L"==value},getNodeElementType:function(node){if(node instanceof Kekule.Atom)return node.getSymbol();if(!(node instanceof Kekule.Pseudoatom))return node instanceof Kekule.VariableAtom?"R":node instanceof Kekule.StructureFragment?"R":node.getSymbol?node.getSymbol():"*";switch(node.getAtomType()){case Kekule.PseudoatomType.DUMMY:return"Du";case Kekule.PseudoatomType.ANY:return"A";case Kekule.PseudoatomType.HETERO:return"Q";case Kekule.PseudoatomType.CUSTOM:default:return node.getSymbol()}},createNodeByCmdElementType:function(id,elemType,massNumber){return Kekule.IO.CmlUtils.isDummyElementType(elemType)?new Kekule.Pseudoatom(id,Kekule.PseudoatomType.DUMMY):Kekule.IO.CmlUtils.isRGroupElementType(elemType)?new Kekule.RGroup(id):Kekule.IO.CmlUtils.isAtomListElementType(elemType)?new Kekule.VariableAtom(id):Kekule.Element.isElementSymbolAvailable(elemType)||elemType==Kekule.Element.UNSET_ELEMENT?new Kekule.Atom(id,elemType,Math.round(massNumber)):new Kekule.Pseudoatom(id,Kekule.PseudoatomType.CUSTOM,elemType)}},Kekule.IO.CmlDomUtils={splitCmlArrayValue:function(value){return"object"==(void 0===value?"undefined":_typeof(value))&&value.length?value:Kekule.StrUtils.normalizeSpace(Kekule.StrUtils.trim(value)).split(Kekule.IO.CML.ARRAY_VALUE_DELIMITER)},mergeToCmlArrayValue:function(arrayObj){return arrayObj.join(" ")},analysisCmlFormulaConciseValue:function(value){for(var formalCharge,tokens=Kekule.IO.CmlDomUtils.splitCmlArrayValue(value),i=0,l=tokens.length,isotopes=[],currIsotope=null;i<l;){var token=tokens[i],count=parseFloat(token);count!=count?(currIsotope&&isotopes.push(currIsotope),currIsotope={elementType:token}):currIsotope?(currIsotope.count=count,isotopes.push(currIsotope),currIsotope=null):i==l-1&&(formalCharge=count),++i}return{isotopes:isotopes,formalCharge:formalCharge}},getCmlBuiltinElemInfo:function(elem,namespaceURI,domHelper){var propName;if(propName=elem.getAttribute("builtin"),!propName&&namespaceURI&&(elem.getAttributeNS?propName=elem.getAttributeNS(namespaceURI,"builtin"):domHelper&&(propName=domHelper.getAttributeNS(namespaceURI,"builtin",elem))),propName){return{name:propName,value:Kekule.DomUtils.getElementText(elem)}}return null},readCmlTypedPropertyElem:function(elem,namespaceURI,domHelper){var propName;if(propName=elem.getAttribute("builtin"),!propName&&namespaceURI&&(elem.getAttributeNS?propName=elem.getAttributeNS(namespaceURI,"builtin"):domHelper&&(propName=domHelper.getAttributeNS(namespaceURI,"builtin",elem))),propName){var propValue=Kekule.DomUtils.getElementText(elem);switch(Kekule.DomUtils.getLocalName(elem)){case"float":propValue=parseFloat(propValue);break;case"integer":propValue=parseInt(propValue)}return{name:propName,value:propValue}}return null},readCmlTypedPropertyArrayElem:function(elem,namespaceURI,domHelper){var propName;if(propName=elem.getAttribute("builtin"),!propName&&namespaceURI&&(elem.getAttributeNS?propName=elem.getAttributeNS(namespaceURI,"builtin"):domHelper&&(propName=domHelper.getAttributeNS(namespaceURI,"builtin",elem))),propName){var propValue=Kekule.DomUtils.getElementText(elem),values=Kekule.IO.CmlDomUtils.splitCmlArrayValue(propValue);switch(Kekule.DomUtils.getLocalName(elem)){case"float":for(var i=0,l=values.length;i<l;++i)values[i]=parseFloat(values[i]);break;case"integer":for(var i=0,l=values.length;i<l;++i)values[i]=parseInt(values[i])}return{name:propName,values:values}}return null},hasDirectCmlTypedElemChildren:function(elem,namespaceURI){for(var i=0,l=Kekule.IO.CML.TYPED_ELEM_NAMES.length;i<l;++i){var localName=Kekule.IO.CML.TYPED_ELEM_NAMES[i];if(Kekule.DomUtils.getDirectChildElems(elem,null,localName,namespaceURI).length>0)return!0}return!1},hasDirectCmlTypedArrayElemChildren:function(elem,namespaceURI){for(var i=0,l=Kekule.IO.CML.TYPED_ARRAY_ELEM_NAMES.length;i<l;++i){var localName=Kekule.IO.CML.TYPED_ARRAY_ELEM_NAMES[i];if(Kekule.DomUtils.getDirectChildElems(elem,null,localName,namespaceURI).length>0)return!0}return!1},isCmlTypedElem:function(elem,namespaceURI){var result=Kekule.IO.CML.TYPED_ELEM_NAMES.indexOf(Kekule.DomUtils.getLocalName(elem))>=0;return namespaceURI&&(result=result&&elem.namespaceURI==namespaceURI),result},isCmlTypedArrayElem:function(elem,namespaceURI){var result=Kekule.IO.CML.TYPED_ARRAY_ELEM_NAMES.indexOf(Kekule.DomUtils.getLocalName(elem))>=0;return namespaceURI&&(result=result&&elem.namespaceURI==namespaceURI),result},isCmlBuiltInMarkedElem:function(elem,namespaceURI){var result=Kekule.DomUtils.hasAttribute(elem,"builtin");return namespaceURI&&result&&(result=elem.namespaceURI===namespaceURI),result},FILTER_TYPED_ELEM:1,FILTER_TYPEDARRAY_ELEM:2,FILTER_ALL:3,getCmlTypedElem:function(parent,builtinName,filter){var nsURI=parent.namespaceURI,elems=Kekule.DomUtils.getDirectChildElemsOfAttribValues(parent,[{builtin:builtinName}],null,null,nsURI);if(elems&&elems.length>0)for(var i=elems.length-1;i>=0;--i){if(filter&Kekule.IO.CmlDomUtils.FILTER_TYPED_ELEM&&Kekule.IO.CmlDomUtils.isCmlTypedElem(elems[i],nsURI))return elems[i];if(filter&Kekule.IO.CmlDomUtils.FILTER_TYPEDARRAY_ELEM&&Kekule.IO.CmlDomUtils.isCmlTypedArrayElem(elems[i],nsURI))return elems[i]}return null},getCmlTypedElems:function(parent,builtinName,filter){var result=[],nsURI=parent.namespaceURI,elems=Kekule.DomUtils.getDirectChildElemsOfAttribValues(parent,[{builtin:builtinName}],null,null,nsURI);if(elems&&elems.length>0)for(var i=elems.length-1;i>=0;--i)filter&Kekule.IO.CmlDomUtils.FILTER_TYPED_ELEM&&Kekule.IO.CmlDomUtils.isCmlTypedElem(elems[i],nsURI)?result.push(elems[i]):filter&Kekule.IO.CmlDomUtils.FILTER_TYPEDARRAY_ELEM&&Kekule.IO.CmlDomUtils.isCmlTypedArrayElem(elems[i],nsURI)&&result.push(elems[i]);return result.length?result:null},getCmlTypedElemValue:function(parent,builtinName,filter,domHelper){filter||(filter=Kekule.IO.CmlDomUtils.FILTER_ALL);var elem=Kekule.IO.CmlDomUtils.getCmlTypedElem(parent,builtinName,filter);if(elem)return Kekule.DomUtils.getElementText(elem)},getMultipleCmlTypedElemValues:function(parent,builtinName,filter,domHelper){filter||(filter=Kekule.IO.CmlDomUtils.FILTER_ALL);var elems=Kekule.IO.CmlDomUtils.getCmlTypedElems(parent,builtinName,filter);if(elems){for(var result=[],i=0,l=elems.length;i<l;++i)result.push(Kekule.DomUtils.getElementText(elems[i]));return result}return null},getCmlElemAttribute:function(elem,attribName,filter,domHelper){filter||(filter=Kekule.IO.CmlDomUtils.FILTER_ALL);var result=Kekule.DomUtils.getSameNSAttributeValue(elem,attribName,domHelper);return null!==result&&void 0!==result||(result=Kekule.IO.CmlDomUtils.getCmlTypedElemValue(elem,attribName,filter,domHelper)),result},getMultipleCmlElemAttribute:function(elem,attribName,filter,domHelper){filter||(filter=Kekule.IO.CmlDomUtils.FILTER_ALL);var result=Kekule.DomUtils.getSameNSAttributeValue(elem,attribName,domHelper);return null!==result&&void 0!==result||(result=Kekule.IO.CmlDomUtils.getMultipleCmlTypedElemValues(elem,attribName,filter,domHelper)),result},setCmlElemAttribute:function(elem,attribName,value,domHelper){return Kekule.DomUtils.setSameNSAttributeValue(elem,attribName,value,domHelper)},fetchCmlElemAttributeValuesToJson:function(elem,filter,mergeSameNameTypedElem,domHelper){filter||(filter=Kekule.IO.CmlDomUtils.FILTER_ALL);for(var nsURI=elem.namespaceURI,result=Kekule.DomUtils.fetchAttributeValuesToJson(elem,nsURI,!0),childElems=Kekule.DomUtils.getDirectChildElems(elem,null,null,nsURI),i=0,l=childElems.length;i<l;++i){var childElem=childElems[i];if(filter&Kekule.IO.CmlDomUtils.FILTER_TYPED_ELEM&&(Kekule.IO.CmlDomUtils.isCmlTypedElem(childElem,nsURI)||Kekule.IO.CmlDomUtils.isCmlBuiltInMarkedElem(childElem,nsURI))){var obj=Kekule.IO.CmlDomUtils.readCmlTypedPropertyElem(childElem,nsURI,domHelper);obj&&(result[obj.name]&&mergeSameNameTypedElem?result[obj.name]+=Kekule.IO.CML.ARRAY_VALUE_DELIMITER+obj.value:result[obj.name]=obj.value)}else if(filter&Kekule.IO.CmlDomUtils.FILTER_TYPEDARRAY_ELEM&&Kekule.IO.CmlDomUtils.isCmlTypedArrayElem(childElem,nsURI)){var obj=Kekule.IO.CmlDomUtils.getCmlBuiltinElemInfo(childElem,nsURI,domHelper);obj&&(result[obj.name]&&mergeSameNameTypedElem?result[obj.name]+=Kekule.IO.CML.ARRAY_VALUE_DELIMITER+obj.value:result[obj.name]=obj.value)}}return result},isScalarElem:function(elem,namespaceURI){var result="scalar"==Kekule.DomUtils.getLocalName(elem);return namespaceURI&&(result=result&&elem.namespaceURI==namespaceURI),result},getCmlId:function(elem,domHelper){return Kekule.IO.CmlDomUtils.getCmlElemAttribute(elem,"id",Kekule.IO.CmlDomUtils.FILTER_TYPED_ELEM,domHelper)},setCmlId:function(elem,id,domHelper){return Kekule.IO.CmlDomUtils.setCmlElemAttribute(elem,"id",id,domHelper)},getCmlTitle:function(elem,domHelper){return Kekule.IO.CmlDomUtils.getCmlElemAttribute(elem,"title",Kekule.IO.CmlDomUtils.FILTER_TYPED_ELEM,domHelper)},setCmlTitle:function(elem,title,domHelper){return Kekule.IO.CmlDomUtils.setCmlElemAttribute(elem,"title",title,domHelper)}},Kekule.IO.CmlElementReaderFactory={_readers:{},register:function(elemLocalName,readerClass){if(Kekule.ArrayUtils.isArray(elemLocalName))for(var i=0,l=elemLocalName.length;i<l;++i)Kekule.IO.CmlElementReaderFactory.register(elemLocalName[i],readerClass);else Kekule.IO.CmlElementReaderFactory._readers[elemLocalName]=readerClass},getReader:function(elemOrLocalName){var name;name="string"!=typeof elemOrLocalName?Kekule.DomUtils.getLocalName(elemOrLocalName):elemOrLocalName;var readerClass=Kekule.IO.CmlElementReaderFactory._readers[name];return readerClass?new readerClass:null}},Kekule.IO.CmlElementWriterFactory={_writers:{},register:function(objTypeName,writerClass){if(Kekule.ArrayUtils.isArray(objTypeName))for(var i=0,l=objTypeName.length;i<l;++i)Kekule.IO.CmlElementWriterFactory.register(objTypeName[i],writerClass);else Kekule.IO.CmlElementWriterFactory._writers[objTypeName]=writerClass},getWriter:function getWriter(objOrTypeName){var name;name="string"!=typeof objOrTypeName?DataType.getType(objOrTypeName):objOrTypeName;var writerClass=Kekule.IO.CmlElementWriterFactory._writers[name];if(!writerClass&&objOrTypeName.getClassName)for(var obj=objOrTypeName,typeNames=Kekule.ObjUtils.getOwnedFieldNames(Kekule.IO.CmlElementWriterFactory._writers),i=typeNames.length-1;i>=0;--i)if(obj instanceof eval(typeNames[i])){writerClass=Kekule.IO.CmlElementWriterFactory._writers[typeNames[i]];break}return writerClass?new writerClass:null}},Kekule.IO.CmlElementHandler=Class.create(ObjectEx,{CLASS_NAME:"Kekule.IO.CmlElementHandler",initProperties:function(){this.defineProp("domHelper",{dataType:"Kekule.DomHelper",serializable:!1,getter:function(){return this.getPropStoreFieldValue("domHelper")||this.setPropStoreFieldValue("domHelper",new Kekule.DomHelper),this.getPropStoreFieldValue("domHelper")}}),this.defineProp("coreNamespaceURI",{dataType:DataType.STRING,serializable:!1})},matchCoreNamespace:function(nodeOrNsURI){var nsURI;return nsURI=nodeOrNsURI?"string"!=typeof nodeOrNsURI?nodeOrNsURI.namespaceURI:nodeOrNsURI:"",!this.getCoreNamespaceURI()&&!nsURI||this.getCoreNamespaceURI()&&this.getCoreNamespaceURI()==nsURI},copySettingsToChildHandler:function(childHandler){childHandler.setDomHelper(this.getDomHelper()),childHandler.setCoreNamespaceURI(this.getCoreNamespaceURI())}}),Kekule.IO.CmlElementReader=Class.create(Kekule.IO.CmlElementHandler,{CLASS_NAME:"Kekule.IO.CmlElementReader",readElement:function(elem,parentObj){var result=this.doReadElement(elem,parentObj);if(result&&result.getId&&!result.getId()&&result.setId){var id=Kekule.IO.CmlDomUtils.getCmlId(elem,this.getDomHelper);id&&result.setId(id)}return result},doReadElement:function(elem,parentObj){},readChildElement:function(elem,parentObj){return this.doReadChildElement(elem,parentObj)},doReadChildElement:function(elem,parentObj){return this.doReadChildElementDef(elem,parentObj)},readChildElementDef:function(elem,parentObj){return this.doReadChildElementDef(elem,parentObj)},doReadChildElementDef:function(elem,parentObj){var reader=Kekule.IO.CmlElementReaderFactory.getReader(elem);return reader?(this.copySettingsToChildHandler(reader),reader.readElement(elem,parentObj)):null},iterateChildElements:function(elem,parentObj){for(var children=Kekule.DomUtils.getDirectChildElems(elem,null,null,this.getCoreNamespaceURI()),i=0,l=children.length;i<l;++i)this.readChildElement(children[i],parentObj)}}),Kekule.IO.CmlElementWriter=Class.create(Kekule.IO.CmlElementHandler,{CLASS_NAME:"Kekule.IO.CmlElementWriter",writeObject:function(obj,parentElem,doc){if(!parentElem&&!doc)return Kekule.error(Kekule.$L("ErrorMsg.CML_CAN_NOT_OUTPUT_TO_EMPTY_ELEMENT")),null;!parentElem&&doc?parentElem=doc.documentElement:doc||(doc=parentElem.ownerDocument),this.getDomHelper().getDocument!=doc&&this.getDomHelper().setDocument(doc);var targetElem=this.doCreateElem(obj,parentElem,doc);targetElem?parentElem.appendChild(targetElem):targetElem=parentElem;var result=this.doWriteObject(obj,targetElem)||targetElem;return result&&obj&&(this.writeObjId(obj,result),this.writeObjAdditionalInfo(obj,result)),result},writeObjId:function(obj,elem){obj.getId&&obj.getId()&&Kekule.IO.CmlDomUtils.setCmlId(elem,obj.getId(),this.getDomHelper())},writeScalarAttribs:function(obj,elem){if(obj.getScalarAttribs){var writer=Kekule.IO.CmlElementWriterFactory.getWriter("Kekule.Scalar");if(writer){this.copySettingsToChildHandler(writer);for(var i=0,l=obj.getScalarAttribCount();i<l;++i)writer.writeObject(obj.getScalarAttribAt(i),elem)}}},writeObjInfoValues:function(obj,elem){if(obj.getInfo)for(var metaListElem,keys=obj.getInfoKeys(),i=0,l=keys.length;i<l;++i){var key=keys[i],value=obj.getInfoValue(keys[i]);if(key&&value&&!Kekule.IO.CmlDomUtils.getCmlElemAttribute(elem,key,this.getDomHelper())){metaListElem||(metaListElem=this.createChildElem("metaDataList",elem));var metaElem=this.createChildElem("metaData",metaListElem);Kekule.IO.CmlDomUtils.setCmlElemAttribute(metaElem,"name",key,this.getDomHelper()),Kekule.IO.CmlDomUtils.setCmlElemAttribute(metaElem,"content",DataType.StringUtils.serializeValue(value),this.getDomHelper())}}},writeObjAdditionalInfo:function(obj,elem){this.writeScalarAttribs(obj,elem),this.writeObjInfoValues(obj,elem)},doCreateElem:function(obj,parentElem){},createChildElem:function(qualifiedName,parentElem,namespaceURI){var ns=namespaceURI||this.getCoreNamespaceURI(),result=this.getDomHelper().createElementNS(ns,qualifiedName);return parentElem&&parentElem.appendChild(result),result},doWriteObject:function(obj,targetElem){},reportTypeMismatchError:function(obj){Kekule.error(Kekule.$L("ErrorMsg.CML_ELEM_WRITER_TYPE_INPROPER").format(this.getClassName(),DataType.getType(obj)))}}),Kekule.IO.CmlNameReader=Class.create(Kekule.IO.CmlElementReader,{CLASS_NAME:"Kekule.IO.CmlNameReader",initialize:function($super){$super()},doReadElement:function(elem,parentObj){var name=Kekule.DomUtils.getElementText(elem),convention=Kekule.IO.CmlDomUtils.getCmlElemAttribute(elem,"convention");if(name){var result={};return result.name=name,convention?result.convention=convention:parentObj.setName&&parentObj.setName(name),result}return null}}),Kekule.IO.CmlScalarReader=Class.create(Kekule.IO.CmlElementReader,{CLASS_NAME:"Kekule.IO.CmlScalarReader",doReadElement:function(elem,parentObj){var scalar=this.readScalar(elem);return parentObj&&parentObj.appendScalarAttrib&&parentObj.appendScalarAttrib(scalar),scalar},readScalar:function(elem){var jsonObj=Kekule.DomUtils.fetchAttributeValuesToJson(elem,this.getCoreNamespaceURI(),!0),value=Kekule.DomUtils.getElementText(elem);if(value&&(jsonObj.value=value),jsonObj.value&&jsonObj.dataType)switch(jsonObj.dataType){case"xsd:boolean":jsonObj.value=Kekule.StrUtils.strToBool(jsonObj.value);break;case"xsd:float":case"xsd:double":case"xsd:duration":case"xsd:decimal":case"xsd:integer":case"xsd:nonPositiveInteger":case"xsd:negativeInteger":case"xsd:long":case"xsd:int":case"xsd:short":case"xsd:byte":case"xsd:nonNegativeInteger":case"xsd:unsignedLong":case"xsd:unsignedInt":case"xsd:unsignedShort":case"xsd:unsignedByte":case"xsd:positiveInteger":jsonObj.value=parseFloat(jsonObj.value),jsonObj.errorValue&&(jsonObj.errorValue=parseFloat(jsonObj.errorValue))}var result;if(jsonObj){result=new Kekule.Scalar;for(var keys=Kekule.ObjUtils.getOwnedFieldNames(jsonObj),i=0,l=keys.length;i<l;++i){var key=keys[i],value=jsonObj[key];switch(key){case"value":result.setValue(value);break;case"errorValue":result.setErrorValue(value);break;case"units":result.setUnit(value);break;case"title":result.setTitle(value);break;case"dictRef":result.setName(value);break;default:result.setInfoValue(key,value)}}}return result}}),Kekule.IO.CmlScalarWriter=Class.create(Kekule.IO.CmlElementWriter,{CLASS_NAME:"Kekule.IO.CmlScalarWriter",doCreateElem:function(obj,parentElem){return this.createChildElem("scalar",parentElem)},doWriteObject:function(obj,targetElem){if(!(obj instanceof Kekule.Scalar))return this.reportTypeMismatchError(obj),null;var sValueType;if(Kekule.ObjUtils.isUnset(obj.getValue())||(Kekule.DomUtils.setElementText(targetElem,obj.getValue()),sValueType=DataType.getType(obj.getValue())),obj.getName()&&Kekule.IO.CmlDomUtils.setCmlElemAttribute(targetElem,"dictRef",obj.getName(),this.getDomHelper()),obj.getErrorValue()&&Kekule.IO.CmlDomUtils.setCmlElemAttribute(targetElem,"errorValue",obj.getErrorValue(),this.getDomHelper()),obj.getUnit()&&Kekule.IO.CmlDomUtils.setCmlElemAttribute(targetElem,"units",obj.getUnit(),this.getDomHelper()),obj.getTitle()&&Kekule.IO.CmlDomUtils.setCmlElemAttribute(targetElem,"title",obj.getTitle(),this.getDomHelper()),sValueType){var sDataType=sValueType==DataType.INT?"xsd:integer":sValueType==DataType.FLOAT?"xsd:float":sValueType==DataType.BOOL?"xsd:boolean":null;sDataType&&Kekule.IO.CmlDomUtils.setCmlElemAttribute(targetElem,"datatype",sDataType,this.getDomHelper())}}}),Kekule.IO.CmlMetaDataReader=Class.create(Kekule.IO.CmlElementReader,{CLASS_NAME:"Kekule.IO.CmlMetaReader",doReadElement:function(elem,parentObj){var meta=this.readMeta(elem);return parentObj&&parentObj.setInfoValue&&meta.key&&meta.value&&parentObj.setInfoValue(meta.key,meta.value),meta},readMeta:function(elem){var jsonObj=Kekule.DomUtils.fetchAttributeValuesToJson(elem,this.getCoreNamespaceURI(),!0);return{key:jsonObj.name,value:DataType.StringUtils.deserializeValue(jsonObj.content)}}}),Kekule.IO.CmlMetaDataListReader=Class.create(Kekule.IO.CmlElementReader,{CLASS_NAME:"Kekule.IO.CmlMetaListReader",doReadElement:function(elem,parentObj){for(var metaElems=Kekule.DomUtils.getDirectChildElems(elem,null,"metaData",this.getCoreNamespaceURI()),i=0,l=metaElems.length;i<l;++i){var metaElem=metaElems[i],reader=Kekule.IO.CmlElementReaderFactory.getReader(metaElem);reader&&(this.copySettingsToChildHandler(reader),reader.readElement(metaElem,parentObj))}}}),Kekule.IO.CmlChemStructureReader=Class.create(Kekule.IO.CmlElementReader,{CLASS_NAME:"Kekule.IO.CmlChemStructureReader",initialize:function($super){$super()},hasAtomChildren:function(elem,domHelper){return domHelper.getElementsByTagNameNS(this.getCoreNamespaceURI(),"atom",elem).length},getAtomChildren:function(elem,domHelper){return domHelper.getElementsByTagNameNS(this.getCoreNamespaceURI(),"atom",elem)},atomInfoToJSON:function(elem,domHelper){return Kekule.IO.CmlDomUtils.fetchCmlElemAttributeValuesToJson(elem,Kekule.IO.CmlDomUtils.FILTER_TYPED_ELEM,!0,domHelper)},arrayedAtomInfosToJSON:function(elem,domHelper){for(var arrayedAttribNames=["id","atomID","elementType","isotope","hydrogenCount","formalCharge","count","xFract","yFract","zFract","x2","y2","x3","y3","z3"],attribNames=["id","id","elementType","isotope","hydrogenCount","formalCharge","count","xFract","yFract","zFract","x2","y2","x3","y3","z3"],atomAttribs=[],i=0,l=arrayedAttribNames.length;i<l;++i){var svalue,values=[];svalue=Kekule.IO.CmlDomUtils.getCmlElemAttribute(elem,arrayedAttribNames[i],Kekule.IO.CmlDomUtils.FILTER_TYPEDARRAY_ELEM,domHelper),svalue&&(values=Kekule.IO.CmlDomUtils.splitCmlArrayValue(svalue));for(var j=0,k=values.length;j<k;++j)atomAttribs[j]||(atomAttribs[j]={}),values[j]&&(atomAttribs[j][attribNames[i]]=values[j])}return atomAttribs}}),Kekule.IO.CmlFormulaReader=Class.create(Kekule.IO.CmlChemStructureReader,{CLASS_NAME:"Kekule.IO.CmlFormulaReader",doReadElement:function(elem,parentObj){return this.readFormula(elem,this.getDomHelper())},readFormula:function(elem,domHelper){var result=new Kekule.MolecularFormula,charge=Kekule.IO.CmlDomUtils.getCmlElemAttribute(elem,"formalCharge",Kekule.IO.CmlDomUtils.FILTER_TYPED_ELEM,domHelper);charge&&result.setCharge(parseFloat(charge));var concise=Kekule.IO.CmlDomUtils.getCmlElemAttribute(elem,"concise",Kekule.IO.CmlDomUtils.FILTER_TYPED_ELEM,domHelper);if(concise)this.setConcise(result,concise);else for(var childElems=Kekule.DomUtils.getDirectChildElems(elem,null,null,this.getCoreNamespaceURI()),i=0,l=childElems.length;i<l;++i)switch(Kekule.DomUtils.getLocalName(childElems[i])){case"formula":this.readSubFormula(result,childElems[i],domHelper);break;case"atomArray":this.readAtomArray(result,childElems[i],domHelper);break;default:Kekule.IO.CmlDomUtils.isCmlTypedElem(childElems[i])||Kekule.IO.CmlDomUtils.isCmlTypedArrayElem(childElems[i])||this.readChildElementDef(childElems[i],result)}return result},readConsice:function(concise){var result=null;return concise&&(result=new Kekule.MolecularFormula,this.setConcise(result,concise)),result},setConcise:function(formula,concise){var info=Kekule.IO.CmlDomUtils.analysisCmlFormulaConciseValue(concise);return info.isotopes&&info.isotopes.length&&this.createSectionsFromAtomAttribs(formula,info.isotopes),info.formalCharge&&formula.setCharge(info.formalCharge),formula},readAtomArray:function(parentFormula,elem,domHelper){var atomAttribs=[],atomElems=this.getAtomChildren(elem,domHelper);if(atomElems.length>0)for(var i=0,l=atomElems.length;i<l;++i){var atomElem=atomElems[i],atomAttrib=this.atomInfoToJSON(atomElem,domHelper);atomAttribs.push(atomAttrib)}else atomAttribs=this.arrayedAtomInfosToJSON(elem,domHelper);return this.createSectionsFromAtomAttribs(parentFormula,atomAttribs),parentFormula},createSectionsFromAtomAttribs:function(formula,atomAttribs){for(var i=0,l=atomAttribs.length;i<l;++i){var symbol=atomAttribs[i].elementType;if(symbol){var atom=Kekule.IO.CmlUtils.createNodeByCmdElementType(null,symbol),charge=atomAttribs[i].formalCharge||0,count=atomAttribs[i].count;formula.appendSection(atom,count,charge)}}},readSubFormula:function(parentFormula,elem,domHelper){var formula=this.readElement(elem,domHelper),count=Kekule.IO.CmlDomUtils.getCmlElemAttribute(elem,"count",Kekule.IO.CmlDomUtils.FILTER_TYPED_ELEM,domHelper);parentFormula.appendSection(formula,parseFloat(count)||1,formula.getCharge()||0)}}),Kekule.IO.CmlFormulaWriter=Class.create(Kekule.IO.CmlElementWriter,{CLASS_NAME:"Kekule.IO.CmlFormulaWriter",doCreateElem:function(obj,parentElem){return this.createChildElem("formula",parentElem)},doWriteObject:function(obj,targetElem){if(!(obj instanceof Kekule.MolecularFormula))return this.reportTypeMismatchError(obj),null;for(var atomSymbols=[],counts=[],charges=[],i=0,l=obj.getSectionCount();i<l;++i){var section=obj.getSectionAt(i);if(section.obj instanceof Kekule.MolecularFormula){this.createAtomArrayElem(atomSymbols,counts,charges,targetElem),atomSymbols=[],counts=[],charges=[];this.writeSubFormula(section.obj,section.count||1,targetElem)}else atomSymbols.push(Kekule.IO.CmlUtils.getNodeElementType(section.obj)),counts.push(section.count||1),charges.push(obj.getSectionCharge(section)||0),i==l-1&&this.createAtomArrayElem(atomSymbols,counts,charges,targetElem)}obj.getCharge()&&Kekule.IO.CmlDomUtils.setCmlElemAttribute(targetElem,"formalCharge",obj.getCharge(),this.getDomHelper())},writeSubFormula:function(formula,count,parentElem){var result=this.createChildElem("formula",parentElem);return this.doWriteObject(formula,result),count>1&&Kekule.IO.CmlDomUtils.setCmlElemAttribute(result,"count",count,this.getDomHelper()),result},createAtomArrayElem:function(atomSymbols,counts,charges,parentElem){if(!(atomSymbols.length<=0)){var result=this.createChildElem("atomArray",parentElem),sSymbols=Kekule.IO.CmlDomUtils.mergeToCmlArrayValue(atomSymbols),scounts=Kekule.IO.CmlDomUtils.mergeToCmlArrayValue(counts);Kekule.IO.CmlDomUtils.setCmlElemAttribute(result,"elementType",sSymbols,this.getDomHelper()),Kekule.IO.CmlDomUtils.setCmlElemAttribute(result,"count",scounts,this.getDomHelper());for(var needCharge=!1,i=0,l=charges.length;i<l;++i)if(charges[i]){needCharge=!0;break}if(needCharge){var scharges=Kekule.IO.CmlDomUtils.mergeToCmlArrayValue(counts);Kekule.IO.CmlDomUtils.setCmlElemAttribute(result,"formalCharge",scharges,this.getDomHelper())}return result}}}),Kekule.IO.CmlMoleculeReader=Class.create(Kekule.IO.CmlChemStructureReader,{CLASS_NAME:"Kekule.IO.CmlMoleculeReader",initialize:function($super){$super()},initProperties:function(){this.defineProp("structureBuilder",{dataType:"Kekule.ChemStructureBuilder",serializable:!1,getter:function(){return this.getPropStoreFieldValue("structureBuilder")||this.setPropStoreFieldValue("structureBuilder",new Kekule.ChemStructureBuilder),this.getPropStoreFieldValue("structureBuilder")},setter:null})},doReadElement:function(elem,parentObj){return this.readMolecule(elem,this.getDomHelper())},doReadChildElement:function($super,elem,parentObj){if("molecule"==Kekule.DomUtils.getLocalName(elem)&&this.matchCoreNamespace(elem)){if(parentObj.getSubMolecules){var result=this.readElement(elem,parentObj);if(result){var amount=Kekule.IO.CmlDomUtils.getCmlElemAttribute(elem,"amount",Kekule.IO.CmlDomUtils.FILTER_TYPED_ELEM)||Kekule.IO.CmlDomUtils.getCmlElemAttribute(elem,"count",Kekule.IO.CmlDomUtils.FILTER_TYPED_ELEM),attributes=amount?{amount:parseFloat(amount)}:null;parentObj.getSubMolecules().appendObj(result,attributes)}return result}return null}return $super(elem,parentObj)},hasSubMolecule:function(elem){return Kekule.DomUtils.getDirectChildElems(elem,null,"molecule",this.getCoreNamespaceURI()).length>0},readMolecule:function(elem,domHelper){var result;return this.hasSubMolecule(elem)?(result=new Kekule.CompositeMolecule,this.iterateChildElements(elem,result)):result=this.readMoleculeCore(elem,domHelper),this.readMoleculeAttribs(result,elem,domHelper),result},readMoleculeAttribs:function(molecule,elem,domHelper){for(var attribs=Kekule.IO.CmlDomUtils.fetchCmlElemAttributeValuesToJson(elem,null,!0,domHelper),attribKeys=Kekule.ObjUtils.getOwnedFieldNames(attribs),i=0,l=attribKeys.length;i<l;++i){var key=attribKeys[i],value=attribs[key];switch(key){case"id":molecule.setId(value);break;case"title":molecule.setInfoValue("title",value);break;case"formalCharge":value&&molecule.setCharge(parseFloat(value));break;case"formula":this.readFormulaAttrib(molecule,value);break;case"amount":case"count":break;default:molecule.setInfoValue(key,value)}}},readMoleculeCore:function(elem,domHelper){var result=new Kekule.Molecule;this.getStructureBuilder().setTarget(result);for(var node=elem.firstChild;node;){if(node.nodeType!=Node.ELEMENT_NODE);else if(this.matchCoreNamespace(node))switch(Kekule.DomUtils.getLocalName(node)){case"atomArray":this.readMoleculeAtomArray(result,node,this.getStructureBuilder(),domHelper);break;case"bondArray":this.readMoleculeBondArray(result,node,this.getStructureBuilder(),domHelper);break;case"formula":this.readFormula(result,node,domHelper);break;case"atom":this.getStructureBuilder().setTarget(result);var structureNode=this.readAtom(node,domHelper);this.getStructureBuilder().appendNode(structureNode);break;case"bond":this.getStructureBuilder().setTarget(result);var connector=this.readBond(result,node,domHelper);this.getStructureBuilder().appendConnector(connector);break;case"molecule":break;default:Kekule.IO.CmlDomUtils.isCmlTypedElem(node)||Kekule.IO.CmlDomUtils.isCmlTypedArrayElem(node)||this.readChildElementDef(node,result)}else;node=node.nextSibling}return result.hasCtab()&&this.connectUpBondAndAtom(result),result},connectUpBondAndAtom:function(molecule){for(var bonds=molecule.getConnectors(),i=0,l=bonds.length;i<l;++i){var bond=bonds[i],atomIds=bond[this._BOND_ATOM_REF_TEMP_FIELD];if(atomIds&&atomIds.length)for(var j=0,k=atomIds.length;j<k;++j){var refedAtom=molecule.getNodeById(atomIds[j]);refedAtom?bond.appendConnectedObj(refedAtom):Kekule.raise((Kekule.hasLocalRes()?Kekule.$L("ErrorMsg.ATOMID_NOT_EXISTS"):"Atom id not exists: ")+atomIds[j])}delete bond[this._BOND_ATOM_REF_TEMP_FIELD];var bondIds=bond[this._BOND_BOND_REF_TEMP_FIELD];if(bondIds&&bondIds.length)for(var j=0,k=bondIds.length;j<k;++j){var refedBond=molecule.getConnectorById(bondIds[j]);refedBond?bond.appendConnectedObj(refedBond):Kekule.raise((Kekule.hasLocalRes()?Kekule.$L("ErrorMsg.BONDID_NOT_EXISTS"):"Bond id not exists: ")+bondIds[j])}delete bond[this._BOND_BOND_REF_TEMP_FIELD]}},readMoleculeAtomArray:function(molecule,elem,structureBuilder,domHelper){structureBuilder.setTarget(molecule);var atomElems=this.getAtomChildren(elem,domHelper);if(atomElems.length>0)for(var i=0,l=atomElems.length;i<l;++i){var atomElem=atomElems[i],structureNode=this.readAtom(atomElem,domHelper);structureBuilder.appendNode(structureNode)}else for(var atoms=this.readArrayedAtoms(elem,domHelper),i=0,l=atoms.length;i<l;++i)structureBuilder.appendNode(atoms[i])},readAtom:function(elem,domHelper){var result,hasChildInfoElems=!Kekule.IO.CmlDomUtils.hasDirectCmlTypedElemChildren(elem,this.getCoreNamespaceURI()),attribs=this.atomInfoToJSON(elem,domHelper);if(result=this.createStructureNodeOfAttribs(attribs),hasChildInfoElems)for(var children=Kekule.DomUtils.getDirectChildElems(elem,null,null,this.getCoreNamespaceURI()),i=0,l=children.length;i<l;++i){var elem=children[i];this.readChildElementDef(elem,result)}return result},readArrayedAtoms:function(elem,domHelper){for(var atomAttribs=this.arrayedAtomInfosToJSON(elem,domHelper),result=[],i=0,l=atomAttribs.length;i<l;++i){var atom=this.createStructureNodeOfAttribs(atomAttribs[i]);atom&&result.push(atom)}return result},createStructureNodeOfAttribs:function(attribs){var result;attribs.elementType||(attribs.elementType=Kekule.Element.UNSET_ELEMENT);var id=null;void 0!==attribs.id&&(id=attribs.id),delete attribs.id;var massNumber=attribs.isotope?Math.round(attribs.isotope):null;result=Kekule.IO.CmlUtils.createNodeByCmdElementType(id,attribs.elementType,massNumber),delete attribs.elementType,void 0!==attribs.hydrogenCount&&result.setExplicitHydrogenCount&&result.setExplicitHydrogenCount(parseInt(attribs.hydrogenCount,10)),delete attribs.hydrogenCount,attribs.formalCharge&&result.setCharge(parseInt(attribs.formalCharge)),delete attribs.formalCharge,attribs.title&&result.setInfoValue("title",attribs.title),delete attribs.title,attribs.role&&result.setInfoValue("role",attribs.role),delete attribs.role;var coord2D,coord3D;if(void 0!==attribs.x2&&void 0!==attribs.y2)coord2D={x:parseFloat(attribs.x2),y:parseFloat(attribs.y2)};else if(attribs.xy2){var xy=Kekule.IO.CmlDomUtils.splitCmlArrayValue(attribs.xy2);2==xy.length&&(coord2D={x:parseFloat(xy[0]),y:parseFloat(xy[1])})}if(delete attribs.x2,delete attribs.y2,delete attribs.xy2,void 0!==attribs.x3&&void 0!==attribs.y3&&void 0!==attribs.z3)coord3D={x:parseFloat(attribs.x3),y:parseFloat(attribs.y3),z:parseFloat(attribs.z3)};else if(attribs.xyz3){var xyz=Kekule.IO.CmlDomUtils.splitCmlArrayValue(attribs.xyz3);3==xyz.length&&(coord2D={x:parseFloat(xyz[0]),y:parseFloat(xyz[1]),z:parseFloat(xyz[2])})}delete attribs.x3,delete attribs.y3,delete attribs.z3,delete attribs.xyz3,coord2D&&result.setCoord2D(coord2D),coord3D&&result.setCoord3D(coord3D);for(var keyName in attribs)attribs.hasOwnProperty(keyName)&&"string"==typeof attribs[keyName]&&result.setInfoValue(keyName,attribs[keyName]);return result},_BOND_ATOM_REF_TEMP_FIELD:"__cml_atomRefs",_BOND_BOND_REF_TEMP_FIELD:"__cml_bondRefs",readMoleculeBondArray:function(molecule,elem,structureBuilder,domHelper){structureBuilder.setTarget(molecule);var bondElems=domHelper.getElementsByTagNameNS(this.getCoreNamespaceURI(),"bond",elem);if(bondElems.length>0)for(var i=0,l=bondElems.length;i<l;++i){var bondElem=bondElems[i],connector=this.readBond(molecule,bondElem,domHelper);structureBuilder.appendConnector(connector)}else for(var bonds=this.readArrayedBonds(molecule,elem,domHelper),i=0,l=bonds.length;i<l;++i)structureBuilder.appendConnector(bonds[i])},readBond:function(molecule,elem,domHelper){var result,attribs=[],hasChildInfoElems=!1;if(hasChildInfoElems=!Kekule.IO.CmlDomUtils.hasDirectCmlTypedElemChildren(elem,this.getCoreNamespaceURI()),attribs=Kekule.IO.CmlDomUtils.fetchCmlElemAttributeValuesToJson(elem,Kekule.IO.CmlUtils.FILTER_TYPED_ELEM,!0,domHelper),result=this.createStructureConnectorOfAttribs(molecule,attribs),hasChildInfoElems)for(var children=Kekule.DomUtils.getDirectChildElems(elem,null,null,this.getCoreNamespaceURI()),i=0,l=children.length;i<l;++i){var elem=children[i];if("bondStereo"==Kekule.DomUtils.getLocalName(elem)){var cmlStereo=Kekule.DomUtils.getElementText(elem);cmlStereo||(cmlStereo=Kekule.IO.CmlDomUtils.getCmlElemAttribute(elem,"conversionValue",Kekule.IO.CmlDomUtils.FILTER_TYPED_ELEM,domHelper));var kStereo=Kekule.IO.CmlUtils.cmlBondStereoToKekule(cmlStereo);kStereo!=Kekule.BondStereo.NONE&&result.setStereo&&result.setStereo(kStereo)}else this.readChildElementDef(elem,result)}return result},readArrayedBonds:function(molecule,elem,domHelper){var arrayedAttribNames=["id","bondID","atomRef1","atomRef2","order","bondStereo"],attribNames=["id","id","atomRefs2","atomRefs2","order","bondStereo"],bondAttribs=[],svalues=Kekule.IO.CmlDomUtils.getMultipleCmlElemAttribute(elem,"atomRefs",Kekule.IO.CmlDomUtils.FILTER_TYPEDARRAY_ELEM,domHelper);if(svalues&&svalues.length)for(var i=0,l=svalues.length;i<l;++i)for(var svalue=svalues[i],values=Kekule.IO.CmlDomUtils.splitCmlArrayValue(svalue),j=0,k=values.length;j<k;++j)bondAttribs[j]||(bondAttribs[j]={}),void 0==bondAttribs[j].atomRefs&&(bondAttribs[j].atomRefs=[]),bondAttribs[j].atomRefs.push(values[j]);for(var i=0,l=arrayedAttribNames.length;i<l;++i){var svalue,values=[];svalue=Kekule.IO.CmlDomUtils.getCmlElemAttribute(elem,arrayedAttribNames[i],Kekule.IO.CmlDomUtils.FILTER_TYPEDARRAY_ELEM,domHelper),svalue&&(values=Kekule.IO.CmlDomUtils.splitCmlArrayValue(svalue));for(var j=0,k=values.length;j<k;++j)bondAttribs[j]||(bondAttribs[j]={}),values[j]&&("atomRef1"==arrayedAttribNames[i]||"atomRef2"==arrayedAttribNames[i]?(void 0==bondAttribs[j].atomRefs2&&(bondAttribs[j].atomRefs2=[]),"atomRef1"==arrayedAttribNames[i]?bondAttribs[j].atomRefs2[0]=values[j]:bondAttribs[j].atomRefs2[1]=values[j]):bondAttribs[j][attribNames[i]]=values[j])}for(var result=[],i=0,l=bondAttribs.length;i<l;++i){var bond=this.createStructureConnectorOfAttribs(molecule,bondAttribs[i]);bond&&result.push(bond)}return result},createStructureConnectorOfAttribs:function(molecule,attribs){var result,id,bondOrder;if(attribs.id&&(id=attribs.id),delete attribs.id,void 0!==attribs.order&&(bondOrder=Kekule.IO.CmlUtils.cmlBondOrderToKekule(attribs.order)),delete attribs.order,result=new Kekule.Bond(id,null,bondOrder),attribs.bondStereo){var kStereo=Kekule.IO.CmlUtils.cmlBondStereoToKekule(attribs.bondStereo);kStereo!=Kekule.BondStereo.NONE&&result.setStereo&&result.setStereo(kStereo)}delete attribs.bondStereo;for(var i=0,l=Kekule.IO.CML.ATOMS_REF_ATTRIBS.length;i<l;++i){var arName=Kekule.IO.CML.ATOMS_REF_ATTRIBS[i];if(void 0!=attribs[arName]){var atomIds=Kekule.IO.CmlDomUtils.splitCmlArrayValue(attribs[arName]);atomIds.length>0&&(result[this._BOND_ATOM_REF_TEMP_FIELD]=atomIds),delete attribs[arName];break}}for(var i=0,l=Kekule.IO.CML.BONDS_REF_ATTRIBS.length;i<l;++i){var arName=Kekule.IO.CML.BONDS_REF_ATTRIBS[i];if(void 0!=attribs[arName]){var bondIds=Kekule.IO.CmlDomUtils.splitCmlArrayValue(attribs[arName]);bondIds.length>0&&(result[this._BOND_BOND_REF_TEMP_FIELD]=bondIds),delete attribs[arName];break}}for(var keyName in attribs)attribs.hasOwnProperty(keyName)&&"string"==typeof attribs[keyName]&&result.setInfoValue(keyName,attribs[keyName]);return result},readFormula:function(molecule,elem,domHelper){var reader=Kekule.IO.CmlElementReaderFactory.getReader(elem);if(reader){this.copySettingsToChildHandler(reader);var formula=reader.readElement(elem,molecule);formula&&molecule.setFormula(formula)}},readFormulaAttrib:function(molecule,concise){var reader=Kekule.IO.CmlElementReaderFactory.getReader("formula");if(reader){var formula=reader.readConsice?reader.readConsice(concise):null;formula&&molecule.setFormula(formula)}}}),Kekule.IO.CmlMoleculeWriter=Class.create(Kekule.IO.CmlElementWriter,{CLASS_NAME:"Kekule.IO.CmlMoleculeWriter",initProperties:function(){this.defineProp("allowCascadeGroup",{dataType:DataType.BOOL})},doCreateElem:function(obj,parentElem){return this.createChildElem("molecule",parentElem)},doWriteObject:function(obj,targetElem){return this.writeMolecule(obj,targetElem)},writeMolecule:function(molecule,targetElem){return this.writeMoleculeAttribs(molecule,targetElem),molecule instanceof Kekule.CompositeMolecule?this.writeCompositeMolecule(molecule,targetElem):this.writeMoleculeCore(molecule,targetElem)},writeMoleculeAttribs:function(molecule,targetElem){var attribs=[];molecule.getCharge()&&attribs.push({key:"formalCharge",value:molecule.getCharge()});for(var cmlInfoAttribs=["title","dictRef","chirality","ref","spinMultiplicity","symmetryOriented","role"],i=0,l=cmlInfoAttribs.length;i<l;++i){var key=cmlInfoAttribs[i],value=molecule.getInfoValue(key);Kekule.ObjUtils.isUnset(value)||attribs.push({key:key,value:molecule.getInfoValue(key)})}for(var i=0,l=attribs.length;i<l;++i)Kekule.IO.CmlDomUtils.setCmlElemAttribute(targetElem,attribs[i].key,attribs[i].value,this.getDomHelper())},writeCompositeMolecule:function(compositeMolecule,targetElem){for(var subMolGroup=compositeMolecule.getSubMolecules(),i=0,l=subMolGroup.getItemCount();i<l;++i){var subItem=subMolGroup.getItemAt(i),subMol=subItem.obj,subElem=this.writeObject(subMol,targetElem);subItem.amount&&Kekule.IO.CmlDomUtils.setCmlElemAttribute(subElem,"amount",subItem.amount,this.getDomHelper())}return targetElem},writeMoleculeCore:function(molecule,targetElem){if(molecule.hasFormula()){var formula=molecule.getFormula(),formulaWriter=Kekule.IO.CmlElementWriterFactory.getWriter(formula);this.copySettingsToChildHandler(formulaWriter),formulaWriter.writeObject(formula,targetElem)}molecule.hasCtab()&&this.writeCtab(molecule.getCtab(),molecule,targetElem)},writeCtab:function(ctab,molecule,elem){this.identifyObjsInCtab(ctab,molecule);var nodes=this.getAllowCascadeGroup()?ctab.getNodes():ctab.getLeafNodes();if(nodes.length>0)for(var atomsElem=this.createChildElem("atomArray",elem),i=0,l=nodes.length;i<l;++i)this.writeCtabNode(nodes[i],atomsElem);var connectors=this.getAllowCascadeGroup()?ctab.getConnectors():ctab.getAllChildConnectors();if(connectors.length>0)for(var bondsElem=this.createChildElem("bondArray",elem),i=0,l=connectors.length;i<l;++i)this.writeCtabConnector(connectors[i],bondsElem)},writeCtabNode:function(node,elem){var result=this.createChildElem("atom",elem);this.writeObjId(node,result);var elementType=Kekule.IO.CmlUtils.getNodeElementType(node);Kekule.IO.CmlDomUtils.setCmlElemAttribute(result,"elementType",elementType,this.getDomHelper());var massNumber=node.getMassNumber?node.getMassNumber():null;massNumber&&Kekule.IO.CmlDomUtils.setCmlElemAttribute(result,"isotope",massNumber,this.getDomHelper());var hcount=node.getExplicitHydrogenCount?node.getExplicitHydrogenCount():null;Kekule.ObjUtils.isUnset(hcount)||Kekule.IO.CmlDomUtils.setCmlElemAttribute(result,"hydrogenCount",hcount,this.getDomHelper());var charge=node.getCharge?node.getCharge():null;charge&&Kekule.IO.CmlDomUtils.setCmlElemAttribute(result,"formalCharge",charge,this.getDomHelper());var title=(node.getParity&&node.getParity(),node.getInfoValue?node.getInfoValue("title"):null);title&&Kekule.IO.CmlDomUtils.setCmlElemAttribute(result,"title",title,this.getDomHelper());var role=node.getInfoValue?node.getInfoValue("role"):null;if(role&&Kekule.IO.CmlDomUtils.setCmlElemAttribute(result,"role",role,this.getDomHelper()),node.hasCoord2D&&node.hasCoord2D()){var coord2D=node.getAbsCoord2D();Kekule.ObjUtils.isUnset(coord2D.x)||Kekule.IO.CmlDomUtils.setCmlElemAttribute(result,"x2",coord2D.x,this.getDomHelper()),Kekule.ObjUtils.isUnset(coord2D.y)||Kekule.IO.CmlDomUtils.setCmlElemAttribute(result,"y2",coord2D.y,this.getDomHelper())}if(node.hasCoord3D&&node.hasCoord3D()){var coord3D=node.getAbsCoord3D();Kekule.ObjUtils.isUnset(coord3D.x)||Kekule.IO.CmlDomUtils.setCmlElemAttribute(result,"x3",coord3D.x,this.getDomHelper()),Kekule.ObjUtils.isUnset(coord3D.y)||Kekule.IO.CmlDomUtils.setCmlElemAttribute(result,"y3",coord3D.y,this.getDomHelper()),Kekule.ObjUtils.isUnset(coord3D.z)||Kekule.IO.CmlDomUtils.setCmlElemAttribute(result,"z3",coord3D.z,this.getDomHelper())}for(var cmlAdditionalAttribs=["occupancy","xFract","xyzFract","yFract","convention","dictRef","ref"],i=0,l=cmlAdditionalAttribs.length;i<l;++i){var key=cmlAdditionalAttribs[i],value=node.getInfoValue(key);value&&Kekule.IO.CmlDomUtils.setCmlElemAttribute(result,key,value,this.getDomHelper())}return this.writeObjAdditionalInfo(node,result),result},writeCtabConnector:function(connector,elem){var invertAtoms=!1,result=this.createChildElem("bond",elem);this.writeObjId(connector,result);var order=connector.getBondOrder?connector.getBondOrder():null;if(order){var cmlOrder=Kekule.IO.CmlUtils.kekuleBondOrderToCml(order);cmlOrder&&Kekule.IO.CmlDomUtils.setCmlElemAttribute(result,"order",cmlOrder,this.getDomHelper())}var stereo=connector.getStereo?connector.getStereo():null;if(stereo){var cmlStereo=Kekule.IO.CmlUtils.kekuleBondStereoToCml(stereo);if(cmlStereo.value){var stereoElem=this.createChildElem("bondStereo",result);Kekule.DomUtils.setElementText(stereoElem,cmlStereo.value),cmlStereo.invert&&(invertAtoms=!0)}}for(var refAtomIds=[],refBondIds=[],i=0,l=connector.getConnectedObjCount();i<l;++i){var obj=connector.getConnectedObjAt(i);if(obj.getId&&obj.getId()){var id=obj.getId();obj instanceof Kekule.ChemStructureNode?invertAtoms?refAtomIds.unshift(id):refAtomIds.push(id):obj instanceof Kekule.ChemStructureConnector&&refBondIds.push(id)}}var length=refAtomIds.length;if(length){var attribName=1==length?"atomRefs":length>=2&&length<=4?"atomRefs"+length:"atomRefs";Kekule.IO.CmlDomUtils.setCmlElemAttribute(result,attribName,Kekule.IO.CmlDomUtils.mergeToCmlArrayValue(refAtomIds),this.getDomHelper())}var length=refBondIds.length;if(length){var attribName="bondRefs";Kekule.IO.CmlDomUtils.setCmlElemAttribute(result,attribName,Kekule.IO.CmlDomUtils.mergeToCmlArrayValue(refBondIds),this.getDomHelper())}for(var cmlAdditionalAttribs=["convention","dictRef","ref"],i=0,l=cmlAdditionalAttribs.length;i<l;++i){var key=cmlAdditionalAttribs[i],value=connector.getInfoValue(key);value&&Kekule.IO.CmlDomUtils.setCmlElemAttribute(result,key,value,this.getDomHelper())}return this.writeObjAdditionalInfo(connector,result),result},identifyObjsInCtab:function(ctab,molecule){for(var i=0,l=ctab.getNodeCount();i<l;++i){var node=ctab.getNodeAt(i);node.getId()||this.autoIdentifyForObj(node,molecule),ctab.isSubFragment(node)&&node.hasCtab&&node.hasCtab()&&this.identifyObjsInCtab(node.getCtab(),molecule)}for(var i=0,l=ctab.getConnectorCount();i<l;++i){var connector=ctab.getConnectorAt(i);connector.getId()||this.autoIdentifyForObj(connector,molecule)}},autoIdentifyForObj:function(obj,molecule){obj.getId()||(obj.getOwner&&obj.getOwner()&&obj.getOwner().getAutoId?obj.setId(obj.getOwner().getAutoId(obj)):obj.setId(this.getAutoIdForObj(obj,molecule)))},getAutoIdForObj:function(obj,molecule){var prefix=obj.getAutoIdPrefix?obj.getAutoIdPrefix():"obj";return Kekule.IO.CmlMoleculeWriter._UID_SEED||(Kekule.IO.CmlMoleculeWriter._UID_SEED=(new Date).getTime()),++Kekule.IO.CmlMoleculeWriter._UID_SEED,""+prefix+Kekule.IO.CmlMoleculeWriter._UID_SEED.toString()}}),Kekule.IO.CmlMoleculeWriter._UID_SEED=null,Kekule.IO.CmlReactionReagentReader=Class.create(Kekule.IO.CmlElementReader,{CLASS_NAME:"Kekule.IO.CmlReactionReagentReader",doReadElement:function(elem,parentObj){return this.readReagent(elem,this.getDomHelper())},readReagent:function(elem,domHelper){var map=null,molElems=Kekule.DomUtils.getDirectChildElems(elem,null,"molecule",this.getCoreNamespaceURI());if(molElems&&molElems.length){var molElem=molElems[molElems.length-1],reader=Kekule.IO.CmlElementReaderFactory.getReader(molElem);this.copySettingsToChildHandler(reader);var molecule=reader.readElement(molElem,null);molecule&&(map={},Kekule.RoleMapUtils.setItem(map,molecule),this.readReagentAttribs(map,elem,domHelper))}return map},readReagentAttribs:function(map,elem,domHelper){for(var attribs=Kekule.IO.CmlDomUtils.fetchCmlElemAttributeValuesToJson(elem,Kekule.IO.CmlDomUtils.FILTER_TYPED_ELEM,!0,domHelper),keys=Kekule.ObjUtils.getOwnedFieldNames(attribs),i=0,l=keys.length;i<l;++i){var key=keys[i],value=attribs[key];switch(key){case"role":map.role=Kekule.IO.CmlUtils.reagentRoleToKekule(value);break;case"amount":case"count":map.amount=parseFloat(value);break;default:map[key]=value}}return map}}),Kekule.IO.CmlReactionReader=Class.create(Kekule.IO.CmlElementReader,{CLASS_NAME:"Kekule.IO.CmlReactionReader",doReadElement:function(elem,parentObj){return this.readReaction(elem,this.getDomHelper())},readReaction:function(elem,domHelper){for(var result=new Kekule.Reaction,children=Kekule.DomUtils.getDirectChildElems(elem,null,null,this.getCoreNamespaceURI()),i=0,l=children.length;i<l;++i)this.isComponentListElem(children[i])?this.readComponentList(result,children[i],domHelper):this.readChildElement(children[i],result);for(var attribs=Kekule.IO.CmlDomUtils.fetchCmlElemAttributeValuesToJson(elem,Kekule.IO.CmlDomUtils.FILTER_TYPED_ELEM,null,this.getDomHelper()),attribKeys=Kekule.ObjUtils.getOwnedFieldNames(attribs),i=0,l=attribKeys.length;i<l;++i){var key=attribKeys[i],value=attribs[key];switch(key){case"name":result.setName(value);break;case"title":result.setTitle(value);break;case"type":result.setReactionType(value);break;case"yield":result.setYield(parseFloat(value));break;default:result.setInfoValue(key,value)}}return result},readComponentList:function(reaction,elem,domHelper){var compName=this.getListElemComponentName(elem),compArray=reaction.getComponentArray(compName,!0);if(compArray)for(var children=Kekule.DomUtils.getDirectChildElems(elem,null,null,this.getCoreNamespaceURI()),i=0,l=children.length;i<l;++i){var childObj=this.readChildElement(children[i],compArray);childObj&&(compName==Kekule.ReactionComponent.CONDITION&&childObj instanceof ObjectEx?reaction.appendItem(compName,childObj):reaction.appendMap(compName,childObj))}},isComponentListElem:function(elem){return["reactantList","productList","substanceList","conditionList"].indexOf(Kekule.DomUtils.getLocalName(elem))>=0},getListElemComponentName:function(elem){switch(Kekule.DomUtils.getLocalName(elem)){case"reactantList":return Kekule.ReactionComponent.REACTANT;case"productList":return Kekule.ReactionComponent.PRODUCT;case"conditionList":return Kekule.ReactionComponent.CONDITION;default:return Kekule.ReactionComponent.SUBSTANCE}}}),Kekule.IO.CmlReactionWriter=Class.create(Kekule.IO.CmlElementWriter,{CLASS_NAME:"Kekule.IO.CmlReactionWriter",doCreateElem:function(obj,parentElem){return this.createChildElem("reaction",parentElem)},doWriteObject:function(obj,targetElem){return this.writeReaction(obj,targetElem)},writeReaction:function(reaction,targetElem){for(var reactionCompNames=[Kekule.ReactionComponent.REACTANT,Kekule.ReactionComponent.PRODUCT,Kekule.ReactionComponent.SUBSTANCE,Kekule.ReactionComponent.CONDITION],i=0,l=reactionCompNames.length;i<l;++i)this.writeCompList(reaction,reactionCompNames[i],targetElem);return this.writeReactionAttribs(reaction,targetElem),targetElem},writeReactionAttribs:function(reaction,targetElem){var attribs=[];reaction.getName()&&attribs.push({key:"name",value:reaction.getName()}),reaction.getTitle()&&attribs.push({key:"title",value:reaction.getTitle()}),reaction.getReactionType()&&attribs.push({key:"type",value:reaction.getReactionType()}),reaction.getYield()&&attribs.push({key:"yield",value:reaction.getYield()});for(var infoAttribs=["dictRef","convention","format","ref","role","type","state","yield","atomMap","electronMap"],i=0,l=infoAttribs.length;i<l;++i)Kekule.ObjUtils.isUnset(reaction.getInfoValue(infoAttribs[i]))||attribs.push({key:infoAttribs[i],value:reaction.getInfoValue(infoAttribs[i])});for(var i=0,l=attribs.length;i<l;++i)Kekule.IO.CmlDomUtils.setCmlElemAttribute(targetElem,attribs[i].key,attribs[i].value,this.getDomHelper())},writeCompList:function(reaction,compName,targetElem){if(reaction.getComponentItemCount(compName)<=0)return null;for(var cmlTagName=this.getReactionComponentCmlName(compName),listElem=this.createChildElem(cmlTagName+"List",targetElem),i=0,l=reaction.getComponentItemCount(compName);i<l;++i){var compMap=reaction.getMapAt(compName,i),obj=reaction.getMapItemAt(compName,i);if(compMap&&obj){var elem;compName!=Kekule.ReactionComponent.CONDITION?(elem=this.createChildElem(cmlTagName,listElem),Kekule.ObjUtils.isUnset(compMap.amount)||Kekule.IO.CmlDomUtils.setCmlElemAttribute(elem,"amount",compMap.amount,this.getDomHelper()),compMap.role&&Kekule.IO.CmlDomUtils.setCmlElemAttribute(elem,"role",Kekule.IO.CmlUtils.kekuleReagentRoleToCml(compMap.role),this.getDomHelper())):elem=listElem;var writer=Kekule.IO.CmlElementWriterFactory.getWriter(obj);writer&&(this.copySettingsToChildHandler(writer),writer.writeObject(obj,elem))}}},getReactionComponentCmlName:function(compName){switch(compName){case Kekule.ReactionComponent.REACTANT:return"reactant";case Kekule.ReactionComponent.PRODUCT:return"product";case Kekule.ReactionComponent.CONDITION:return"condition";default:return"substance"}}}),Kekule.IO.CmlListReader=Class.create(Kekule.IO.CmlElementReader,{CLASS_NAME:"Kekule.IO.CmlListReader",doReadElement:function(elem,parentObj){var result=this.createList(elem);return result=this.readList(result,elem,this.getDomHelper())},createList:function(elem){switch(Kekule.DomUtils.getLocalName(elem)){case"moleculeList":return new Kekule.MoleculeList;case"reactionList":return new Kekule.ReactionList;default:return new Kekule.ChemObjList}},readList:function(list,elem,domHelper){var children=Kekule.DomUtils.getDirectChildElems(elem,null,null,this.getCoreNamespaceURI());if(children)for(var i=0,l=children.length;i<l;++i){var child=children[i],reader=Kekule.IO.CmlElementReaderFactory.getReader(child);if(reader){this.copySettingsToChildHandler(reader);var obj=reader.readElement(child,null);obj&&list.append(obj)}}return list}}),Kekule.IO.CmlListWriter=Class.create(Kekule.IO.CmlElementWriter,{CLASS_NAME:"Kekule.IO.CmlListWriter",doCreateElem:function(obj,parentElem){var tagName;switch(DataType.getType(obj)){case"Kekule.MoleculeList":tagName="moleculeList";break;case"Kekule.ReactionList":tagName="reactionList";break;default:tagName="list"}return this.createChildElem(tagName,parentElem)},doWriteObject:function(obj,targetElem){var list=Kekule.ChemStructureUtils.getChildStructureObjs(obj,!1);return this.writeList(list,targetElem)},writeList:function(list,listElem){for(var i=0,l=list.length;i<l;++i){var item=list[i];if(item){var writer=Kekule.IO.CmlElementWriterFactory.getWriter(item);writer&&(this.copySettingsToChildHandler(writer),writer.writeObject(item,listElem))}}return listElem}}),Kekule.IO.CmlRootReader=Class.create(Kekule.IO.CmlElementReader,{CLASS_NAME:"Kekule.IO.CmlRootReader",doReadElement:function(elem,parentObj){this.analysisElem(elem);var reader;if("cml"!=Kekule.DomUtils.getLocalName(elem)&&(reader=this.getReader(elem)),reader)return reader.readElement(elem,null);var children=Kekule.DomUtils.getDirectChildElems(elem,null,null,this.getCoreNamespaceURI());if(children)for(var i=0,l=children.length;i<l;++i)if(reader=this.getReader(children[i]))return reader.readElement(children[i],null);return null},getReader:function(elem){var reader=Kekule.IO.CmlElementReaderFactory.getReader(elem);return reader?(this.copySettingsToChildHandler(reader),reader):null},analysisElem:function(rootElem){var domHelper=this.getDomHelper();domHelper.setForceAnalysisDoc(!0),this.getDomHelper().setRootElement(rootElem);for(var namespaces=domHelper.getNamespaces(),legalCoreUri=null,i=0,l=namespaces.length;i<l;++i){var uri=namespaces[i].namespaceURI;if(Kekule.IO.CML.LEGAL_CORE_NAMESPACE_URIS.indexOf(uri)>=0){legalCoreUri=uri;break}}this.setCoreNamespaceURI(legalCoreUri||null)}}),Kekule.IO.CmlRootWriter=Class.create(Kekule.IO.CmlElementWriter,{CLASS_NAME:"Kekule.IO.CmlRootWriter",getWriter:function(obj){var writer=Kekule.IO.CmlElementWriterFactory.getWriter(obj);return writer?(this.copySettingsToChildHandler(writer),writer):null},writeObject:function(obj,parentElem,doc){this.getDomHelper().setForceAnalysisDoc(!0),this.getDomHelper().setRootElement(parentElem);var o;o=obj instanceof Kekule.ChemSpace?obj.getRoot():obj;var writer=this.getWriter(o);return writer?writer.writeObject(o,parentElem):null}}),Kekule.IO.CmlReader=Class.create(Kekule.IO.ChemDataReader,{CLASS_NAME:"Kekule.IO.CmlReader",doReadData:function(data,dataType,format){var rootElem;if(dataType!=Kekule.IO.ChemDataType.DOM){rootElem=XmlUtility.parse(data).documentElement}else rootElem=data.documentElement?data.documentElement:data;return Kekule.IO.CmlElementReaderFactory.getReader("cml").readElement(rootElem,null)}}),Kekule.IO.CmlWriter=Class.create(Kekule.IO.ChemDataWriter,{CLASS_NAME:"Kekule.IO.CmlWriter",initialize:function($super,options){$super(options);var op=options||{};this.setPrettyPrint(Kekule.ObjUtils.isUnset(op.prettyPrint)?Kekule.globalOptions.IO.cml.prettyPrint:op.prettyPrint)},initProperties:function(){this.defineProp("prettyPrint",{dataType:DataType.BOOL,defaultValue:!0})},doWriteData:function(obj,dataType,format){var nsUri=Kekule.IO.CML.CML3_SCHEMA_NAMESPACE_URI,xmlDoc=XmlUtility.newDocument("cml",nsUri),writer=Kekule.IO.CmlElementWriterFactory.getWriter("Kekule.ChemDocument");if(writer){writer.setCoreNamespaceURI(nsUri);var result=writer.writeObject(obj,xmlDoc.documentElement);return dataType==Kekule.IO.ChemDataType.TEXT&&(result=XmlUtility.serializeNode(xmlDoc.documentElement,{prettyPrint:this.getPrettyPrint()})),result}return Kekule.error(Kekule.$L("ErrorMsg.UNABLE_TO_OUTPUT_AS_CML").format(DataType.getType(obj))),null}}),function(){Kekule.IO.MimeType.CML="chemical/x-cml";var RF=Kekule.IO.CmlElementReaderFactory;RF.register("name",Kekule.IO.CmlNameReader),RF.register("scalar",Kekule.IO.CmlScalarReader),RF.register("metaData",Kekule.IO.CmlMetaDataReader),RF.register("metaDataList",Kekule.IO.CmlMetaDataListReader),RF.register("formula",Kekule.IO.CmlFormulaReader),RF.register("molecule",Kekule.IO.CmlMoleculeReader),RF.register(["reactant","product","substance"],Kekule.IO.CmlReactionReagentReader),RF.register("reaction",Kekule.IO.CmlReactionReader),RF.register(["list","moleculeList","reactionList"],Kekule.IO.CmlListReader),RF.register("cml",Kekule.IO.CmlRootReader);var WF=Kekule.IO.CmlElementWriterFactory;WF.register("Kekule.Scalar",Kekule.IO.CmlScalarWriter),WF.register("Kekule.MolecularFormula",Kekule.IO.CmlFormulaWriter),WF.register(["Kekule.ChemStructureFragment","Kekule.Molecule","Kekule.CompositeMolecule"],Kekule.IO.CmlMoleculeWriter),WF.register("Kekule.Reaction",Kekule.IO.CmlReactionWriter),WF.register(["Kekule.ChemObjList","Kekule.ChemStructureObjectGroup","Kekule.ChemSpaceElement","Kekule.ChemSpace"],Kekule.IO.CmlListWriter),WF.register("Kekule.ChemDocument",Kekule.IO.CmlRootWriter),Kekule.IO.DataFormatsManager.register("cml",Kekule.IO.MimeType.CML,"cml",Kekule.IO.ChemDataType.TEXT,"Chemical Markup Language");var cmdFmtId=Kekule.IO.DataFormatsManager.findFormatId(Kekule.IO.MimeType.CML);Kekule.IO.ChemDataReaderManager.register("cml",Kekule.IO.CmlReader,[cmdFmtId]),Kekule.IO.ChemDataWriterManager.register("cml",Kekule.IO.CmlWriter,[Kekule.Scalar,Kekule.StructureFragment,Kekule.Reaction,Kekule.ChemObjList,Kekule.ChemSpace],[cmdFmtId])}(),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,ObjectEx=__webpack_require__(0).ObjectEx;module.exports=function(Kekule){return Kekule.IO.MdlVersion={V2000:2,V3000:3},Kekule.IO.MDL={VER2000:"V2000",VER3000:"V3000",SYMBOL_ANYATOM:"A",SYMBOL_STARATOM:"*",SYMBOL_HETEROATOM:"Q",SYMBOL_RGROUP:"R",SYMBOL_RGROUP2:"R#",SYMBOL_LONEPAIR:"LP",SYMBOL_ATOMLIST:"L",SYMBOL_DUMMYATOM:"Du",SD_DATA_HEAD_PREFIX:">",MOL_DELIMITER:"$$$$"},Kekule.IO.MdlUtils={isUnspecifiedAtomSymbol:function(value){return value===Kekule.IO.MDL.SYMBOL_ANYATOM||value===Kekule.IO.MDL.SYMBOL_STARATOM},isHeteroAtomSymbol:function(value){return value===Kekule.IO.MDL.SYMBOL_HETEROATOM},isRGroupSymbol:function(value){return value===Kekule.IO.MDL.SYMBOL_RGROUP||value===Kekule.IO.MDL.SYMBOL_RGROUP2},isLonePairSymbol:function(value){return value===Kekule.IO.MDL.SYMBOL_LONEPAIR},isAtomListSymbol:function(value){return value===Kekule.IO.MDL.SYMBOL_ATOMLIST},analysisMdlDateTimeStr:function(str,isLongFormat){var date=new Date,istart=0,ilength=2,month=(parseInt(str.substr(istart,ilength).trim(),10)||1)-1;istart+=ilength;var day=parseInt(str.substr(istart,ilength).trim(),10)||0;istart+=ilength,ilength=isLongFormat?4:2;var year=parseInt(str.substr(istart,ilength),10)||0;isLongFormat||(year+=year>=70?1900:2e3),date.setFullYear(year,month,day),istart+=ilength,ilength=2;var hour=parseInt(str.substr(istart,ilength),10)||0;istart+=ilength;var minute=parseInt(str.substr(istart,ilength),10)||0;return date.setHours(hour,minute),date},generateMdlDateTimeStr:function(date,useLongFormat){var s="";return s+=date.getMonth().toString().lpad(2,"0"),s+=date.getDate().toString().lpad(2,"0"),s+=useLongFormat?date.getFullYear().toString().lpad(4,"0"):(date.getFullYear()%100).toString().lpad(2,"0"),s+=date.getHours().toString().lpad(2,"0"),s+=date.getMinutes().toString().lpad(2,"0")},mdlRadicalToKekule:function(value){return value},kekuleRadicalToMdl:function(value){return value},bondTypeToKekuleOrder:function(value){switch(value){case 1:return Kekule.BondOrder.SINGLE;case 2:return Kekule.BondOrder.DOUBLE;case 3:return Kekule.BondOrder.TRIPLE;case 4:return Kekule.BondOrder.EXPLICIT_AROMATIC;default:return Kekule.BondOrder.UNSET}},kekuleBondOrderToMdlType:function(value){switch(value){case Kekule.BondOrder.SINGLE:return 1;case Kekule.BondOrder.DOUBLE:return 2;case Kekule.BondOrder.TRIPLE:return 3;case Kekule.BondOrder.EXPLICIT_AROMATIC:return 4;default:return 1}},getRxnMarkVersion:function(line){var s=line.substr(0,4);return"$RXN"!=s?null:(s=line.substr(4).trim(),s==Kekule.IO.MDL.VER3000?Kekule.IO.MdlVersion.V3000:Kekule.IO.MdlVersion.V2000)},assertIlegalForCtabOutput:function(obj){return obj instanceof Kekule.StructureFragment?!!obj.hasCtab()||(Kekule.error(Kekule.$L("ErrorMsg.MOLECULE_HAS_NO_CTAB_TO_OUTPUT")),!1):(Kekule.error(Kekule.$L("ErrorMsg.CAN_NOT_WRITE_NON_MOLECULE_TO_MOL")),!1)}},Kekule.IO.MdlStructureUtils={fillFragment:function(fragment,ctabInfo,coordMode){if(fragment.clear(),ctabInfo){var isCoord3D;if(isCoord3D=coordMode&&coordMode!=Kekule.CoordMode.UNKNOWN?coordMode==Kekule.CoordMode.COORD3D:ctabInfo.atomInfos.isCoord3D,ctabInfo.atomInfos)for(var i=0,l=ctabInfo.atomInfos.length;i<l;++i){var info=ctabInfo.atomInfos[i];if(info){var atom=Kekule.IO.MdlStructureUtils.createStructureNode(fragment,info,isCoord3D);atom?fragment.appendNode(atom):Kekule.raise(Kekule.$L("ErrorMsg.MDL_CTAB_ATOM_CANNOT_CREATE"))}}if(ctabInfo.bondInfos)for(var i=0,l=ctabInfo.bondInfos.length;i<l;++i){var info=ctabInfo.bondInfos[i];if(info){var bond=Kekule.IO.MdlStructureUtils.createStructureConnector(fragment,info);bond?fragment.appendConnector(bond):Kekule.raise(Kekule.$L("ErrorMsg.MDL_CTAB_BOND_CANNOT_CREATE"))}}if(ctabInfo.sgInfos&&ctabInfo.sgInfos.length){for(var subGroupInfo=[],i=0,l=ctabInfo.sgInfos.length;i<l;++i){var info=ctabInfo.sgInfos[i];if(info&&"SUP"==info.sgType){for(var atoms=[],j=0,k=info.atomIndexes.length;j<k;++j)atoms.push(fragment.getNodeAt(info.atomIndexes[j]));atoms.length&&subGroupInfo.push({atoms:atoms,text:info.label})}}for(var i=0,l=subGroupInfo.length;i<l;++i){var atoms=subGroupInfo[i].atoms;if(atoms.length){var subGroup=fragment.marshalSubFragment(atoms,new Kekule.SubGroup),groupText=subGroupInfo[i].text;subGroup.setFormulaText&&groupText.match(/.+\d/)?subGroup.setFormulaText(subGroupInfo[i].text):subGroup.setAbbr(subGroupInfo[i].text)}}}}return fragment},createStructureNode:function(fragment,atomInfo,isCoord3D){var result;if(atomInfo.atomListInfo||Kekule.IO.MdlUtils.isAtomListSymbol(atomInfo.symbol)){result=new Kekule.VariableAtom;var list=[];atomInfo.atomListInfo&&atomInfo.atomListInfo.symbols&&(list=list.concat(atomInfo.atomListInfo.symbols),atomInfo.atomListInfo.isAllowList?result.setAllowedIsotopeIds(list):result.setDisallowedIsotopeIds(list))}else if(Kekule.IO.MdlUtils.isRGroupSymbol(atomInfo.symbol))result=new Kekule.RGroup;else if(Kekule.IO.MdlUtils.isHeteroAtomSymbol(atomInfo.symbol))result=new Kekule.Pseudoatom(null,Kekule.PseudoatomType.HETERO);else if(Kekule.IO.MdlUtils.isUnspecifiedAtomSymbol(atomInfo.symbol))result=new Kekule.Pseudoatom(null,Kekule.PseudoatomType.ANY);else{var elemInfo=Kekule.ChemicalElementsDataUtil.getElementInfo(atomInfo.symbol);if(elemInfo){var massNumber=null;if(atomInfo.massNumber)massNumber=atomInfo.massNumber;else if(atomInfo.massDiff&&elemInfo){var naturalMass=elemInfo.naturalMass,massNumber=Math.round(naturalMass+atomInfo.massDiff),isotopeInfo=Kekule.IsotopesDataUtil.getIsotopeInfo(elemInfo.atomicNumber,massNumber);isotopeInfo||(massNumber=Math.floor(naturalMass+atomInfo.massDiff),isotopeInfo=Kekule.IsotopesDataUtil.getIsotopeInfo(elemInfo.atomicNumber,massNumber)),isotopeInfo||(massNumber=Math.ceil(naturalMass+atomInfo.massDiff),isotopeInfo=Kekule.IsotopesDataUtil.getIsotopeInfo(elemInfo.atomicNumber,massNumber)),isotopeInfo||(massNumber=null)}result=new Kekule.Atom(null,atomInfo.symbol,massNumber)}else{var isoInfo=Kekule.IsotopesDataUtil.getIsotopeInfo(atomInfo.symbol);result=isoInfo?new Kekule.Atom(null,isoInfo.atomicNumber,isoInfo.massNumber):new Kekule.Pseudoatom(null,Kekule.PseudoatomType.ANY)}}return atomInfo.charge&&result.setCharge(atomInfo.charge),atomInfo.radical&&result.setRadical(atomInfo.radical),atomInfo.parity&&result.setParity&&result.setParity(atomInfo.parity),void 0!==atomInfo.hydrongenCount&&result.setExplicitHydrogenCount&&result.setExplicitHydrogenCount(atomInfo.hydrongenCount),isCoord3D?result.setCoord3D({x:atomInfo.x,y:atomInfo.y,z:atomInfo.z}):result.setCoord2D({x:atomInfo.x,y:atomInfo.y}),result},createStructureConnector:function(fragment,bondInfo){var atom1=fragment.getNodeAt(bondInfo.atomIndex1),atom2=fragment.getNodeAt(bondInfo.atomIndex2);if(atom1&&atom2){var objs=[atom1,atom2];if(bondInfo.endAtomIndexes)for(var i=0,l=bondInfo.endAtomIndexes.length;i<l;++i){var atom=fragment.getNodeAt(bondInfo.endAtomIndexes[i]);atom&&objs.push(atom)}var result=new Kekule.Bond(null,objs,bondInfo.order);return void 0!==bondInfo.stereo&&result.setStereo(bondInfo.stereo),result}return null},isNodeVariableAtom:function(node){return node instanceof Kekule.VariableAtom},getAtomTypeStr:function(node,is2k){if(node instanceof Kekule.Atom)return node.getSymbol();if(!(node instanceof Kekule.Pseudoatom)){if(node instanceof Kekule.RGroup)return Kekule.IO.MDL.SYMBOL_RGROUP;if(node instanceof Kekule.VariableAtom){if(is2k)return Kekule.IO.MDL.SYMBOL_ATOMLIST;var s="[",ids=node.getAllowedIsotopeIds();if(ids&&ids.length||(s="NOT[",ids=node.getDisallowedIsotopeIds()),ids&&ids.length){for(var symbols=[],i=0,l=ids.length;i<l;++i){var detail=Kekule.IsotopesDataUtil.getIsotopeIdDetail(ids[i]);detail&&detail.symbol&&symbols.push(detail.symbol)}return s=s+symbols.join(",")+"]"}return Kekule.IO.MDL.SYMBOL_ATOMLIST}return"?"}switch(node.getAtomType()){case Kekule.PseudoatomType.ANY:return Kekule.IO.MDL.SYMBOL_ANYATOM;case Kekule.PseudoatomType.HETERO:return Kekule.IO.MDL.SYMBOL_HETEROATOM;default:return Kekule.IO.MDL.SYMBOL_DUMMYATOM}},getMoleculeCtabStructureInfo:function(mol){var result={};result.atoms=mol.getLeafNodes(),result.bonds=mol.getAllChildConnectors(),result.subGroups=mol.getSubFragments();for(var count2d=0,count3d=0,i=0,l=result.atoms.length;i<l;++i)result.atoms[i].hasCoord3D()&&++count3d,result.atoms[i].hasCoord2D()&&++count2d;return result.coordMode=count2d>count3d?Kekule.CoordMode.COORD2D:Kekule.CoordMode.COORD3D,result},splitConnectedNodes:function(connector){for(var result={primaryNodes:[]},count=0,objs=connector.getConnectedObjs(),i=0,l=objs.length;i<l;++i)objs[i]instanceof Kekule.ChemStructureNode&&(count<2?(result.primaryNodes.push(objs[i]),++count):(result.remainNodes||(result.remainNodes=[]),result.remainNodes.push(objs[i])));return result},generateClassicStyleCountLine:function(molInfo,mdlVersion){if(mdlVersion==Kekule.IO.MdlVersion.V3000)return"  0  0  0     0  0              0 V3000";var s="";s+=molInfo.atoms.length.toString().lpad(3),s+=molInfo.bonds.length.toString().lpad(3),s+="0".lpad(3),s+="0".lpad(3),s+="0".lpad(3),s+="0".lpad(3);for(var i=0;i<4;++i)s+="0".lpad(3);return s+="999",s+=Kekule.IO.MDL.VER2000.lpad(6)}},Kekule.IO.MdlBlockHandler=Class.create(ObjectEx,{CLASS_NAME:"Kekule.IO.MdlBlockHandler",initProperties:function(){this.defineProp("textBuffer",{dataType:"Kekule.TextLinesBuffer",serializable:!1,getter:function(){var r=this.getPropStoreFieldValue("textBuffer");return r||(r=this.createTextBuffer(),this.setPropStoreFieldValue("textBuffer",r)),r},setter:null})},createTextBuffer:function(){return new Kekule.TextLinesBuffer}}),Kekule.IO.MdlBlockReader=Class.create(Kekule.IO.MdlBlockHandler,{CLASS_NAME:"Kekule.IO.MdlBlockReader",readBlock:function(textOrLines,parentObj){return"string"==typeof textOrLines?this.getTextBuffer().setText(textOrLines):this.getTextBuffer().setLines(textOrLines),this.getTextBuffer().reset(),this.doReadBlock(this.getTextBuffer())},doReadBlock:function(textBuffer,parentObj){}}),Kekule.IO.MdlBlockWriter=Class.create(Kekule.IO.MdlBlockHandler,{CLASS_NAME:"Kekule.IO.MdlBlockWriter",writeBlock:function(obj){return this.getTextBuffer().clear(),this.doWriteBlock(obj,this.getTextBuffer()),this.getTextBuffer().getText()},doWriteBlock:function(obj,textBuffer){}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,DataType=__webpack_require__(0).DataType;module.exports=function(Kekule){return Kekule.IO.Mdl2kUtils={atomLineChargeToKekule:function(value){switch(value){case 1:return 3;case 2:return 2;case 3:return 1;case 5:return-1;case 6:return-2;case 7:return-3;default:return 0}},chargeToMdlAtomLineValue:function(value){switch(value){case 1:return 3;case 2:return 2;case 3:return 1;case-1:return 5;case-2:return 6;case-3:return 7;default:return 0}},atomLineChargeToRadical:function(value){return 4==value?Kekule.RadicalOrder.DOUBLET:0},radicalToMdlAtomLineValue:function(value){return value==Kekule.RadicalOrder.DOUBLET?4:0},chargeOrRadicalToMdlAtomLineValue:function(charge,radical){return charge?Kekule.IO.Mdl2kUtils.chargeToMdlAtomLineValue(charge):radical?Kekule.IO.Mdl2kUtils.radicalToMdlAtomLineValue(charge):0},bondStereoToKekule:function(value,bondOrder){if(bondOrder==Kekule.BondOrder.SINGLE)switch(value){case 1:return Kekule.BondStereo.UP;case 4:return Kekule.BondStereo.UP_OR_DOWN;case 6:return Kekule.BondStereo.DOWN;default:return Kekule.BondStereo.NONE}else{if(bondOrder!=Kekule.BondOrder.DOUBLE)return Kekule.BondStereo.NONE;switch(value){case 3:return Kekule.BondStereo.E_Z_BY_COORDINATES;default:return Kekule.BondStereo.NONE}}},bondStereoToMdlBondLineValue:function(value,bondOrder){if(bondOrder==Kekule.BondOrder.SINGLE)switch(value){case Kekule.BondStereo.UP:return 1;case Kekule.BondStereo.UP_OR_DOWN:return 4;case Kekule.BondStereo.DOWN:return 6;default:return 0}else{if(bondOrder!=Kekule.BondOrder.DOUBLE)return 0;switch(value){case Kekule.BondStereo.E_Z_BY_COORDINATES:return 3;default:return 0}}},coordToStr:function(value){return(value||0).toFixed(4)},getMassDiff:function(isotope){var elemInfo=Kekule.ChemicalElementsDataUtil.getElementInfo(isotope.getAtomicNumber()),naturalMass=elemInfo.naturalMass;return Math.round(isotope.getMassNumber()-naturalMass)},getAtomListPropLineValue:function(node){var s="",ids=node.getAllowedIsotopeIds();if(ids&&ids.length?s=" F ":(s=" T ",ids=node.getDisallowedIsotopeIds()),ids&&ids.length){for(var symbols=[],i=0,l=ids.length;i<l;++i){var detail=Kekule.IsotopesDataUtil.getIsotopeIdDetail(ids[i]);detail&&detail.symbol&&symbols.push(detail.symbol.rpad(4))}var sSymbols=symbols.join("");return s=symbols.length.toString().lpad(3)+s+sSymbols}return null},getCtabPropLineTag:function(propName,prefix){return(prefix||"M")+"  "+propName},getCtabPropLineCountTag:function(propName,entryCount,prefix){var r=(prefix||"M")+"  "+propName;return entryCount&&(r+=entryCount.toString().lpad(3)),r},generateCtabPropLine:function(values,propName,entryCount,prefix){return Kekule.IO.Mdl2kUtils.getCtabPropLineCountTag(propName,entryCount,prefix)+" "+values.join(" ")}},Kekule.IO.Mdl2kCTabReader=Class.create(Kekule.IO.MdlBlockReader,{CLASS_NAME:"Kekule.IO.Mdl2kCTabReader",doReadBlock:function(textBuffer,parentObj){return this.analysisCTab(textBuffer)},analysisCTab:function(textBuffer){var result={},line=textBuffer.readLine(),countInfo=this.analysisCountLine(line),atomInfos=[];atomInfos.isCoord3D=!1;for(var i=0;i<countInfo.atomCount;++i){line=textBuffer.readLine();var atomInfo=this.analysisAtomLine(line);atomInfo.z&&(atomInfos.isCoord3D=!0),atomInfos.push(atomInfo)}for(var bondInfos=[],i=0;i<countInfo.bondCount;++i){line=textBuffer.readLine();var bondInfo=this.analysisBondLine(line);bondInfos.push(bondInfo)}for(var i=0;i<countInfo.atomListCount;++i){line=textBuffer.readLine();var atomListInfo=this.analysisAtomListInfoLine(line);atomInfos[atomListInfo.atomIndex]&&(atomInfos[atomListInfo.atomIndex].atomListInfo=atomListInfo)}for(var i=0;i<countInfo.stextCount;++i)line=textBuffer.readLine(),line=textBuffer.readLine();for(var sgroupInfos=[];!textBuffer.eof();){line=textBuffer.readLine();var info=this.analysisPropertyLine(line,atomInfos,sgroupInfos);if("END"===info.prop)break;if("SKP"===info.prop)for(var i=0;i<info.count&&!textBuffer.eof();++i)line=textBuffer.readLine();else if("A"===info.leading){if(textBuffer.eof())break;var atomIndex=info.atomIndex;line=textBuffer.readLine(),atomInfos[atomIndex].symbol=line.trim()}}return result.countInfo=countInfo,result.atomInfos=atomInfos,result.bondInfos=bondInfos,result.sgInfos=sgroupInfos,result},analysisCountLine:function(line){var result={},s=line.substr(33,6).trim();return s&&s!=Kekule.IO.MDL.VER2000?(Kekule.error(Kekule.$L("ErrorMsg.NOT_MDL2000_FORMAT_DATA")),null):(s=line.substr(0,3),result.atomCount=parseInt(s,10),s=line.substr(3,3),result.bondCount=parseInt(s,10),s=line.substr(12,3),result.isChiral=0!=parseInt(s,10),s=line.substr(15,3),result.stextCount=parseInt(s,10),result)},analysisAtomLine:function(line){var result={},s=line.substr(0,10);result.x=parseFloat(s),s=line.substr(10,10),result.y=parseFloat(s),s=line.substr(20,10),result.z=parseFloat(s),s=line.substr(31,3),result.symbol=s.trim(),s=line.substr(34,2),result.massDiff=parseInt(s,10),s=line.substr(36,3);var i=parseInt(s,10),rad=Kekule.IO.Mdl2kUtils.atomLineChargeToRadical(i);rad?result.radical=rad:result.charge=Kekule.IO.Mdl2kUtils.atomLineChargeToKekule(i),s=line.substr(39,3);var i=parseInt(s,10);i&&(result.parity=i),s=line.substr(42,3);var i=parseInt(s,10);return i>0&&(result.hydrongenCount=i-1),result},analysisBondLine:function(line){var result={},s=line.substr(0,3);result.atomIndex1=parseInt(s,10)-1,s=line.substr(3,3),result.atomIndex2=parseInt(s,10)-1,s=line.substr(6,3),result.order=Kekule.IO.MdlUtils.bondTypeToKekuleOrder(parseInt(s,10)),s=line.substr(9,3);var stereo=Kekule.IO.Mdl2kUtils.bondStereoToKekule(parseInt(s,10),result.order);return stereo&&(result.stereo=stereo),result},analysisAtomListInfoLine:function(line){var result={},s=line.substr(0,3);result.atomIndex=parseInt(s,10)-1,s=line.substr(4,1),result.isAllowList="f"==s.toLowerCase(),s=line.substr(9,1);var entryCount=Math.min(parseInt(s,10),5);result.atomicNumbers=[];for(var start=11,i=0;i<entryCount;++i){start+=4*i,s=line.substr(start,3);var atomicNumber=parseInt(s,10);atomicNumber&&result.atomicNumbers.push(atomicNumber)}return result},analysisPropertyLine:function(line,atomInfos,sgroupInfos){var result={},slead=line.substr(0,1);if(result.leading=slead,"M"==slead){var spropId=line.substr(3,3).trim();result.prop=spropId;var atomIndex,sgIndex,sgInfo;if("END"===spropId)return result;if(["CHG","RAD","ISO"].indexOf(spropId)>=0){var entryCount=parseInt(line.substr(6,3).trim());result.entryCount=entryCount,result.entries=[];for(var propName="CHG"===spropId?"charge":"RAD"===spropId?"radical":"massNumber",currPos=10,i=0;i<entryCount;++i){var atomIndex=parseInt(line.substr(currPos,3).trim(),10)-1,propValue=parseInt(line.substr(currPos+4,3).trim(),10);currPos+=8,result.entries.push({atomIndex:atomIndex,propName:propValue}),atomInfos[atomIndex][propName]=propValue}}else["STY","SLB"].indexOf(spropId)>=0?(sgIndex=parseInt(line.substr(10,3),10)-1,sgInfo=sgroupInfos[sgIndex]):["SAL","SBL","SMT","SCL","SAP","SBV"].indexOf(spropId)>=0&&(sgIndex=parseInt(line.substr(7,3),10)-1,sgInfo=sgroupInfos[sgIndex]);switch(spropId){case"ALS":var atomListInfo={},satom=line.substr(7,3).trim();atomListInfo.atomIndex=parseInt(satom,10)-1,result.atomIndex=atomListInfo.atomIndex;var count=parseInt(line.substr(10,3)),s=line.substr(14,1);atomListInfo.isAllowList="f"==s.toLowerCase(),atomListInfo.symbols=[];for(var i=0;i<count;++i)s=line.substr(16+4*i,4).trim(),atomListInfo.symbols.push(s);result.atomListInfo=atomListInfo;var oldAtomListInfo=atomInfos[atomListInfo.atomIndex].atomListInfo;oldAtomListInfo?oldAtomListInfo.isAllowList!==atomListInfo.isAllowList?atomInfos[atomListInfo.atomIndex].atomListInfo=atomListInfo:oldAtomListInfo.symbols=Kekule.ArrayUtils.pushUnique(oldAtomListInfo.symbols,atomListInfo.symbols):atomInfos[atomListInfo.atomIndex].atomListInfo=atomListInfo;break;case"STY":"SUP"==line.substr(14,3)&&(sgroupInfos[sgIndex]={sgType:"SUP"});break;case"SLB":sgInfo&&(sgInfo.labelId=line.substr(14).trim());break;case"SAL":if(sgInfo){var atomCount=parseInt(line.substr(10,3));sgInfo.atomIndexes||(sgInfo.atomIndexes=[]);for(var i=0;i<atomCount;++i){var s=line.substr(14+4*i,3),atomIndex=parseInt(s)-1;sgInfo.atomIndexes.push(atomIndex)}}break;case"SBL":if(sgInfo&&"SUP"==sgInfo.sgType){var bondCount=parseInt(line.substr(10,3));sgInfo.crossBondIndexes||(sgInfo.crossBondIndexes=[]);for(var i=0;i<bondCount;++i){var s=line.substr(14+4*i,3),bondIndex=parseInt(s)-1;sgInfo.crossBondIndexes.push(bondIndex)}}break;case"SMT":sgInfo&&("SUP"==sgInfo.sgType?sgInfo.label=line.substr(11).trim():sgInfo.subscript=line.substr(11).trim());break;case"SCL":sgInfo&&(sgInfo.sgClass=line.substr(11).trim());break;case"SBV":if(sgInfo){var vecBondIndex=parseInt(line.substr(11,3),10)-1,vectorX=parseFloat(line.substr(14,10)),vectorY=parseFloat(line.substr(24,10));sgInfo.bondVectors||(sgInfo.bondVectors=[]),sgInfo.bondVectors[vecBondIndex]={bondIndex:vecBondIndex,x:vectorX,y:vectorY};var sz=line.substr(34,10).trim();if(sz){var vectorZ=parseFloat(sz)||0;sgInfo.bondVectors[vecBondIndex].z=vectorZ}}}}else if("A"===slead){var currPos=3,atomIndex=parseInt(line.substr(currPos,3).trim(),10)-1;result.atomIndex=atomIndex}else if("V"===slead);else if("G"===slead);else if("S"===slead){var spropId=line.substr(3,3).trim();result.prop=spropId,result.count=parseInt(line.substr(6,3),10)}return result}}),Kekule.IO.Mdl2kCTabWriter=Class.create(Kekule.IO.MdlBlockWriter,{CLASS_NAME:"Kekule.IO.Mdl2kCTabWriter",initialize:function($super,coordMode){$super(),this.setCoordMode(coordMode||Kekule.CoordMode.UNKNOWN)},initProperties:function(){this.defineProp("coordMode",{dataType:DataType.INT,deaultValue:Kekule.CoordMode.UNKNOWN})},doWriteBlock:function(obj,textBuffer){return Kekule.IO.MdlUtils.assertIlegalForCtabOutput(obj),this.outputCtab(obj,textBuffer)},outputCtab:function(mol,textBuffer){var atomPropLines=[],molInfo=Kekule.IO.MdlStructureUtils.getMoleculeCtabStructureInfo(mol);if(this.getCoordMode()!=Kekule.CoordMode.UNKNOWN&&(molInfo.coordMode=this.getCoordMode()),textBuffer.writeLine(this.generateCountLine(molInfo)),this.outputAtomBlock(mol,molInfo,textBuffer,atomPropLines),this.outputBondBlock(mol,molInfo,textBuffer),atomPropLines.length)for(var i=0,l=atomPropLines.length;i<l;++i)textBuffer.writeLine(atomPropLines[i]);this.outputSubgroupsPropLines(mol,molInfo,textBuffer),textBuffer.writeLine(Kekule.IO.Mdl2kUtils.getCtabPropLineTag("END"))},generateCountLine:function(molInfo){return Kekule.IO.MdlStructureUtils.generateClassicStyleCountLine(molInfo,Kekule.IO.MdlVersion.V2000)},outputAtomBlock:function(mol,molInfo,textBuffer,atomPropLines){for(var i=0,l=molInfo.atoms.length;i<l;++i){var atom=molInfo.atoms[i],line=this.generateAtomLine(i,molInfo.coordMode,atom,atomPropLines);textBuffer.writeLine(line)}},generateAtomLine:function(index,coordMode,atom,atomPropLines){var cf=Kekule.IO.Mdl2kUtils.coordToStr,s="",sAtomIndex=(index+1).toString().lpad(3),coord=coordMode==Kekule.CoordMode.COORD3D?atom.getAbsCoord3D():atom.getAbsCoord2D();if(s+=cf(coord.x).lpad(10)+cf(coord.y).lpad(10)+cf(coord.z).lpad(10),s+=" "+Kekule.IO.MdlStructureUtils.getAtomTypeStr(atom,!0).rpad(3),Kekule.IO.MdlStructureUtils.isNodeVariableAtom(atom)){var satomList=Kekule.IO.Mdl2kUtils.getAtomListPropLineValue(atom);if(satomList){var propLine=Kekule.IO.Mdl2kUtils.getCtabPropLineTag("ALS")+" "+sAtomIndex+satomList;atomPropLines.push(propLine)}}if(atom.getMassNumber&&atom.getMassNumber()){s+=(Kekule.IO.Mdl2kUtils.getMassDiff(atom.getIsotope())||0).toString().lpad(2);var propLine=Kekule.IO.Mdl2kUtils.generateCtabPropLine([sAtomIndex,atom.getMassNumber().toString().lpad(3)],"ISO",1);atomPropLines.push(propLine)}else s+="0".lpad(2);if(s+=Kekule.IO.Mdl2kUtils.chargeOrRadicalToMdlAtomLineValue(atom.getCharge?atom.getCharge():null,atom.getRadical?atom.getRadical():null).toString().lpad(3),atom.getCharge&&atom.getCharge()){var propLine=Kekule.IO.Mdl2kUtils.generateCtabPropLine([sAtomIndex,atom.getCharge().toString().lpad(3)],"CHG",1);atomPropLines.push(propLine)}if(atom.getRadical&&atom.getRadical()){var propLine=Kekule.IO.Mdl2kUtils.generateCtabPropLine([sAtomIndex,Kekule.IO.MdlUtils.kekuleRadicalToMdl(atom.getRadical()).toString().lpad(3)],"RAD",1);atomPropLines.push(propLine)}s+=(atom.getParity?atom.getParity()||0:0).toString().lpad(3);var hcount=atom.getExplicitHydrogenCount?atom.getExplicitHydrogenCount():null;s+=(Kekule.ObjUtils.isUnset(hcount)?"0":(hcount+1).toString()).lpad(3);for(var i=0,sfill="0".lpad(3);i<8;++i)s+=sfill;return s},outputBondBlock:function(mol,molInfo,textBuffer){for(var i=0,l=molInfo.bonds.length;i<l;++i){var bond=molInfo.bonds[i],line=this.generateBondLine(i,bond,molInfo.atoms);textBuffer.writeLine(line)}},generateBondLine:function(index,bond,atomList){var s="",nodeGroup=Kekule.IO.MdlStructureUtils.splitConnectedNodes(bond);return s+=(atomList.indexOf(nodeGroup.primaryNodes[0])+1).toString().lpad(3),s+=(atomList.indexOf(nodeGroup.primaryNodes[1])+1).toString().lpad(3),bond.getBondOrder?s+=Kekule.IO.MdlUtils.kekuleBondOrderToMdlType(bond.getBondOrder()).toString().lpad(3):s+="0".lpad(3),bond.getStereo&&bond.getBondOrder?s+=Kekule.IO.Mdl2kUtils.bondStereoToMdlBondLineValue(bond.getStereo(),bond.getBondOrder()).toString().lpad(3):s+="0".lpad(3),s+="0".lpad(3),s+="0".lpad(3),s+="0".lpad(3)},outputSubgroupsPropLines:function(mol,molInfo,textBuffer){for(var i=0,l=molInfo.subGroups.length;i<l;++i)for(var lines=this.generateSgroupLines(i,molInfo.subGroups[i],molInfo),j=0,k=lines.length;j<k;++j)textBuffer.writeLine(lines[j])},generateSgroupLines:function(index,subGroup,molInfo){var result=[],sIndex=(index+1).toString().lpad(3),s=Kekule.IO.Mdl2kUtils.generateCtabPropLine([sIndex,"SUP"],"STY",1);result.push(s),s=Kekule.IO.Mdl2kUtils.generateCtabPropLine([sIndex,sIndex],"SLB",1),result.push(s);var slabel=subGroup.getAbbr&&subGroup.getAbbr()||subGroup.getFormulaText&&subGroup.getFormulaText()||subGroup.getName&&subGroup.getName();slabel&&(s=Kekule.IO.Mdl2kUtils.generateCtabPropLine([sIndex,slabel],"SMT"),result.push(s));for(var atomIndexes=[],atoms=subGroup.getLeafNodes(),i=0,l=atoms.length;i<l;++i){var index=molInfo.atoms.indexOf(atoms[i]);index>=0&&atomIndexes.push((index+1).toString().lpad(3))}atomIndexes=atomIndexes.sort();for(var atomIndexGroups=Kekule.ArrayUtils.divide(atomIndexes,15),i=0,l=atomIndexGroups.length;i<l;++i){var subAtomIndexes=atomIndexGroups[i];s=Kekule.IO.Mdl2kUtils.getCtabPropLineTag("SAL")+" "+sIndex+subAtomIndexes.length.toString().lpad(3)+" "+subAtomIndexes.join(" "),result.push(s)}for(var xbonds=subGroup.getCrossConnectors(),xbondIndexes=[],xbondVectors=[],cf=Kekule.IO.Mdl2kUtils.coordToStr,i=0,l=xbonds.length;i<l;++i){var index=molInfo.bonds.indexOf(xbonds[i]);if(index>=0){xbondIndexes.push((index+1).toString().lpad(3));var vectorArray=[index+1],nodeGroup=Kekule.IO.MdlStructureUtils.splitConnectedNodes(xbonds[i]),atoms=nodeGroup.primaryNodes,vector={};2==atoms.length&&(molInfo.coordMode==Kekule.CoordMode.COORD2D?(vector=Kekule.CoordUtils.substract(atoms[0].getAbsCoord2D(),atoms[1].getAbsCoord2D()),vectorArray=vectorArray.concat([cf(vector.x).lpad(10),cf(vector.y).lpad(10)])):(vector=Kekule.CoordUtils.substract(atoms[0].getAbsCoord3D(),atoms[1].getAbsCoord3D()),vectorArray=vectorArray.concat([cf(vector.x),cf(vector.y),cf(vector.z)]))),xbondVectors.push(vectorArray)}}xbondIndexes=xbondIndexes.sort();for(var xbondIndexGroups=Kekule.ArrayUtils.divide(xbondIndexes,15),i=0,l=xbondIndexGroups.length;i<l;++i){var subXbondIndexes=xbondIndexGroups[i];s=Kekule.IO.Mdl2kUtils.getCtabPropLineTag("SBL")+" "+sIndex+subXbondIndexes.length.toString().lpad(3)+" "+subXbondIndexes.join(" "),result.push(s)}for(var i=0,l=xbondVectors.length;i<l;++i){var vectorIndex=xbondVectors[i].shift(),sVectors=xbondVectors[i].join("");s=Kekule.IO.Mdl2kUtils.getCtabPropLineTag("SBV")+" "+sIndex+" "+vectorIndex.toString().lpad(3)+sVectors,result.push(s)}return result}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},Class=__webpack_require__(0).Class,DataType=__webpack_require__(0).DataType;module.exports=function(Kekule){return Kekule.IO.Mdl3kUtils={get3kBlockStartTag:function(blockName){return"BEGIN "+blockName.toUpperCase()},get3kBlockEndTag:function(blockName){return"END "+blockName.toUpperCase()},isAtomList:function(value){var reg=/\[.+\]/;return value.search(reg)>=0},analysisAtomList:function(value){var reg=/\[(.+)\]/g,r=reg.exec(value);if(r&&r.length>=2){r=r[1].split(",");var result={};result.isAllowList=!(0==value.trim().indexOf("NOT")),result.symbols=[];for(var i=0,l=r.length;i<l;++i)result.symbols.push(r[i].trim());return result}return null},bondCfgToKekule:function(value){switch(value){case 0:return Kekule.BondStereo.NONE;case 1:return Kekule.BondStereo.UP;case 2:return Kekule.BondStereo.UP_OR_DOWN;case 3:return Kekule.BondStereo.DOWN;default:return Kekule.BondStereo.NONE}},bondStereoToMdlCfg:function(value){switch(value){case Kekule.BondStereo.UP:return 1;case Kekule.BondStereo.UP_OR_DOWN:return 2;case Kekule.BondStereo.DOWN:return 3;default:return 0}},coordToStr:function(value){return(value||0).toFixed(6)}},Kekule.IO.Mdl3kValueUtils={SEPARATOR:" ",KEYVALUE_CONNECTOR:"=",STR_QUOTE:'"',ESC_QUOTE:'""',VALUELIST_PATTERN:/\(.+\)/g,split:function(str,separator){for(var sep=separator||Kekule.IO.Mdl3kValueUtils.SEPARATOR,squote=Kekule.IO.Mdl3kValueUtils.STR_QUOTE,result=[],inQuote=!1,inBracket=!1,inParethsis=!1,curr="",i=0,l=str.length;i<l;++i){var c=str.charAt(i);c==squote?!inQuote&&str.charAt(i+1)==squote||inQuote&&str.charAt(i-1)==squote||(inQuote=!inQuote):"["==c?inBracket=!0:"]"==c?inBracket=!1:"("==c?inParethsis=!0:")"==c&&(inParethsis=!1),c==sep?inQuote||inBracket||inParethsis||!curr?curr+=c:(result.push(curr),curr=""):curr+=c}return curr&&result.push(curr),result},merge:function(strs,separator){var sep=separator||Kekule.IO.Mdl3kValueUtils.SEPARATOR;return strs.join(sep)},isKeyValuePair:function(str){return str.indexOf(Kekule.IO.Mdl3kValueUtils.KEYVALUE_CONNECTOR)>=0},splitKeyValue:function(str){var result={},connector=Kekule.IO.Mdl3kValueUtils.KEYVALUE_CONNECTOR,index=str.indexOf(connector);return index<0?result.value=str:(result.key=str.substr(0,index),result.value=str.substr(index+connector.length)),result},mergeKeyValue:function(value,key){return key?""+key+Kekule.IO.Mdl3kValueUtils.KEYVALUE_CONNECTOR+value:value},isValueList:function(str){return str.search(Kekule.IO.Mdl3kValueUtils.VALUELIST_PATTERN)>=0},splitValueList:function(str){var reg=/\((.+)\)/,r=reg.exec(str);if(r&&r.length>1){var s=r[1],arr=Kekule.IO.Mdl3kValueUtils.split(s);return arr.shift(),arr}return[str]},mergeValueList:function(values){for(var s="("+values.length,i=0,l=values.length;i<l;++i)s+=Kekule.IO.Mdl3kValueUtils.SEPARATOR+values[i];return s+=")"},unquoteValue:function(str){var quote=Kekule.IO.Mdl3kValueUtils.STR_QUOTE,result=str.trim();result.substr(0,quote.length)==quote&&(result=result.substr(quote.length)),result.substr(result.length-quote.length)==quote&&(result=result.substr(0,result.length-quote.length));var reg=new RegExp(quote+quote,"g");return result=result.replace(reg,quote),Kekule.IO.Mdl3kValueUtils.isValueList(result)&&(result=Kekule.IO.Mdl3kValueUtils.splitValueList(result)),result},quoteValue:function(str){var quote=Kekule.IO.Mdl3kValueUtils.STR_QUOTE,result=""+str,reg=new RegExp(quote,"g");return result=result.replace(reg,quote+quote),result.indexOf(Kekule.IO.Mdl3kValueUtils.SEPARATOR)>=0&&(result=quote+result+quote),result},splitValues:function(str){for(var result=[],tokens=Kekule.IO.Mdl3kValueUtils.split(str),i=0,l=tokens.length;i<l;++i){var pair=Kekule.IO.Mdl3kValueUtils.splitKeyValue(tokens[i]);pair.value&&(pair.value=Kekule.IO.Mdl3kValueUtils.unquoteValue(pair.value)),result.push(pair)}return result},mergeValues:function(pairs){for(var result,i=0,l=pairs.length;i<l;++i){var key,value,pair=pairs[i];"object"!=(void 0===pair?"undefined":_typeof(pair))||Kekule.ArrayUtils.isArray(pair)?value=pair:(key=pair.key,value=pair.value);var s;s=Kekule.ArrayUtils.isArray(value)?Kekule.IO.Mdl3kValueUtils.mergeValueList(value):Kekule.IO.Mdl3kValueUtils.quoteValue(value),key&&(s=Kekule.IO.Mdl3kValueUtils.mergeKeyValue(s,key)),result=Kekule.IO.Mdl3kValueUtils.appendToken(result,s)}return result},appendToken:function(origin,token,separator){var sep=separator||Kekule.IO.Mdl3kValueUtils.SEPARATOR,s=origin||"";return s&&s.substr(s.length-sep.length,sep.length)!=sep?s+=Kekule.IO.Mdl3kValueUtils.SEPARATOR+token:s=token,s}},Kekule.IO.Mdl3kTextBuffer=Class.create(Kekule.TextLinesBuffer,{CLASS_NAME:"Kekule.Mdl3kTextBuffer",LEADING_TAG:"M  V30 ",LINE_CONTI_MARK:"-",MAX_COL_WIDTH:80,initialize:function($super,text){$super(text)},isStartWithLeadingTag:function(line){return line.substr(0,this.LEADING_TAG.length)==this.LEADING_TAG},isEndWithContinueMark:function(line){var s=line.trim();return s.substr(s.length-this.LINE_CONTI_MARK.length)==this.LINE_CONTI_MARK},getLineWithout3kTag:function(line){var l=this.LEADING_TAG.length;return line.substr(0,l)==this.LEADING_TAG?line.substr(l):line},getLineAtEx:function(index){var line=this.getLineAt(index),count=1;if(line&&this.isEndWithContinueMark(line)&&this.isStartWithLeadingTag(this.getLines()[index])){var p=line.lastIndexOf(this.LINE_CONTI_MARK);line=line.substr(0,p);var nextResult=this.getLineAtEx(index+1);line+=nextResult.line,count+=nextResult.lineCount}return{line:line,lineCount:count}},getLineAt:function($super,index){var line=$super(index);return this.getLineWithout3kTag(line)},readLine:function(){var r=this.getLineAtEx(this.getCurrLineNo());return this.incCurrLineNo(r.lineCount),r.line},writeLine:function($super,line,not3kMode){if(not3kMode)return $super(line);var s=line;this.isStartWithLeadingTag(line)||(s=this.LEADING_TAG+s);var sexceed;if(s.length>this.MAX_COL_WIDTH){var cmark=this.LINE_CONTI_MARK,firstLineWidth=(Kekule.IO.Mdl3kValueUtils.SEPARATOR,this.MAX_COL_WIDTH-cmark.length);sexceed=s.substr(firstLineWidth),s=s.substr(0,firstLineWidth),s+=cmark}var r=$super(s);return sexceed&&(r=this.writeLine(sexceed,not3kMode)),r},writeLines:function($super,lines,not3kMode){for(var i=0,l=lines.length;i<l;++i)this.writeLine(lines[i],not3kMode)},getBlockBuffer:function(blockName,reservePos){var result,startTag=Kekule.IO.Mdl3kUtils.get3kBlockStartTag(blockName),endTag=Kekule.IO.Mdl3kUtils.get3kBlockEndTag(blockName),oldPos=this.getCurrLineNo();this.reset();for(var line=this.readLine().trim();line!=startTag&&!this.eof();)line=this.readLine().trim();if(this.eof())result=null;else{var startPos=this.getCurrLineNo(),endPos=this.getCurrLineNo();for(line=this.readLine().trim();line!=endTag&&!this.eof();)endPos=this.getCurrLineNo(),line=this.readLine().trim();if(line==endTag)var lines=this.getLines().slice(startPos,endPos);else var lines=this.getLines().slice(startPos);result=new Kekule.IO.Mdl3kTextBuffer(lines)}return reservePos&&this.setCurrLineNo(oldPos),result}}),Kekule.IO.Mdl3kBlockReader=Class.create(Kekule.IO.MdlBlockReader,{CLASS_NAME:"Kekule.IO.Mdl3kBlockReader",createTextBuffer:function(){return new Kekule.IO.Mdl3kTextBuffer},doReadBlock:function(textBuffer,parentObj){var buffer,newBuffer=!(textBuffer instanceof Kekule.IO.Mdl3kTextBuffer);newBuffer?(buffer=new Kekule.IO.Mdl3kTextBuffer,buffer.setLines(textBuffer.getUnreadLines()),buffer.reset()):buffer=textBuffer;var startLineNo=buffer.getCurrLineNo(),result=this.doRead3kBlock(buffer,parentObj),endLineNo=buffer.getCurrLineNo();if(newBuffer){var readLineCount=endLineNo-startLineNo;textBuffer.incCurrLineNo(readLineCount)}return result},doRead3kBlock:function(textBuffer,parentObj){}}),Kekule.IO.Mdl3kBlockWriter=Class.create(Kekule.IO.MdlBlockWriter,{CLASS_NAME:"Kekule.IO.Mdl3kBlockWriter",createTextBuffer:function(){return new Kekule.IO.Mdl3kTextBuffer},writeStartTag:function(blockName,textBuffer){textBuffer.writeLine(Kekule.IO.Mdl3kUtils.get3kBlockStartTag(blockName))},writeEndTag:function(blockName,textBuffer){textBuffer.writeLine(Kekule.IO.Mdl3kUtils.get3kBlockEndTag(blockName))},doWriteBlock:function(obj,textBuffer){var buffer,newBuffer=!(textBuffer instanceof Kekule.IO.Mdl3kTextBuffer);newBuffer?(buffer=new Kekule.IO.Mdl3kTextBuffer,buffer.setLines(textBuffer.getUnreadLines()),buffer.reset()):buffer=textBuffer;var result=this.doWrite3kBlock(obj,buffer);return newBuffer&&textBuffer.appendLines(newBuffer.getLines()),result},doWrite3kBlock:function(obj,textBuffer){}}),Kekule.IO.Mdl3kCTabReader=Class.create(Kekule.IO.Mdl3kBlockReader,{CLASS_NAME:"Kekule.IO.Mdl3kCTabReader",doRead3kBlock:function(textBuffer,parentObj){var buffer=textBuffer.getBlockBuffer("CTAB");return buffer||(buffer=textBuffer),this.analysisCTab(buffer)},analysisCTab:function(textBuffer){var result={},line=textBuffer.readLine(),countInfo=this.analysisCountLine(line);if(!countInfo)return null;var atomInfo,atomIndexMap=[],atomBuffer=textBuffer.getBlockBuffer("ATOM");if(!atomBuffer)return Kekule.raise(Kekule.$L("ErrorMsg.MDL3000_ATOMBLOCK_NOT_FOUND")),null;atomInfo=this.analysisAtomBlock(atomBuffer,atomIndexMap);var bondInfo,bondBuffer=textBuffer.getBlockBuffer("BOND");bondBuffer&&(bondInfo=this.analysisBondBlock(bondBuffer,atomIndexMap));var sgroupInfo,sgroupBuffer=textBuffer.getBlockBuffer("SGROUP");return sgroupBuffer&&(sgroupInfo=this.analysisSGroupBlock(sgroupBuffer,atomIndexMap)),result.countInfo=countInfo,result.atomInfos=atomInfo,result.atomIndexMap=atomIndexMap,bondInfo&&(result.bondInfos=bondInfo),sgroupInfo&&(result.sgInfos=sgroupInfo),result},analysisCountLine:function(line){var result={},values=Kekule.IO.Mdl3kValueUtils.splitValues(line);if("COUNTS"!=values.shift().value)return void Kekule.raise(Kekule.$L("ErrorMsg.MALFORMED_MDL3000_COUNTLINE"));var s=values.shift().value;return result.atomCount=parseInt(s,10),s=values.shift().value,result.bondCount=parseInt(s,10),s=values.shift().value,result.sgroupCount=parseInt(s,10),s=values.shift().value,result.isChiral=0!=parseInt(s,10),result},analysisAtomBlock:function(textBuffer,atomIndexMap){for(var coordMode=Kekule.CoordMode.COORD2D,atomInfos=[];!textBuffer.eof();){var line=textBuffer.readLine(),atomInfo=this.analysisAtomLine(line),actualIndex=atomInfos.push(atomInfo)-1;atomIndexMap[atomInfo.index]=actualIndex,atomInfo.z&&(coordMode=Kekule.CoordMode.COORD3D)}return atomInfos.coordMode=coordMode,atomInfos.isCoord3D=coordMode==Kekule.CoordMode.COORD3D,atomInfos},analysisAtomLine:function(line,atomIndexMap){var result={},values=Kekule.IO.Mdl3kValueUtils.splitValues(line);result.index=parseInt(values.shift().value,10);var s=values.shift().value.trim();if(Kekule.IO.Mdl3kUtils.isAtomList(s)){var atomListInfo=Kekule.IO.Mdl3kUtils.analysisAtomList(s);atomListInfo&&(result.atomListInfo=atomListInfo,result.symbol="L")}else result.symbol=s;result.x=parseFloat(values.shift().value),result.y=parseFloat(values.shift().value),result.z=parseFloat(values.shift().value),values.shift();for(var i=0,l=values.length;i<l;++i){var pair=values[i],key=pair.key,value=pair.value;switch(key){case"CHG":var c=parseInt(value,10);c&&(result.charge=c);break;case"RAD":var c=parseInt(value,10);c&&(result.radical=c);break;case"CFG":var c=parseInt(value,10);c&&(result.parity=c);break;case"MASS":result.massNumber=parseFloat(value);break;case"VAL":break;case"HCOUNT":var c=parseInt(value,10);c&&(result.hydrongenCount=-1==c?0:c-1);break;case"RGROUPS":var c=parseInt(value,10);c&&(result.rgroupCount=c)}}return result},analysisBondBlock:function(textBuffer,atomIndexMap){for(var bondInfos=[];!textBuffer.eof();){var line=textBuffer.readLine(),bondInfo=this.analysisBondLine(line,atomIndexMap);bondInfos[bondInfo.index]=bondInfo}return bondInfos},analysisBondLine:function(line,atomIndexMap){var result={},values=Kekule.IO.Mdl3kValueUtils.splitValues(line);result.index=parseInt(values.shift().value,10);var s=values.shift().value;result.order=Kekule.IO.MdlUtils.bondTypeToKekuleOrder(parseInt(s,10)),result.atomIndex1=atomIndexMap[parseInt(values.shift().value,10)],result.atomIndex2=atomIndexMap[parseInt(values.shift().value,10)];for(var i=0,l=values.length;i<l;++i){var key=values[i].key,value=values[i].value;switch(key){case"CFG":var c=parseInt(value,10);result.stereo=Kekule.IO.Mdl3kUtils.bondCfgToKekule(c);break;case"ENDPTS":if(Kekule.ArrayUtils.isArray(value)){result.endAtomIndexes=[];for(var j=0,k=value.length;j<k;++j)result.endAtomIndexes.push(atomIndexMap[parseInt(value[j],10)])}else result.endAtomIndexes=[atomIndexMap[parseInt(value,10)]]}}return result},analysisSGroupBlock:function(textBuffer,atomIndexMap){var sgroupInfos=[],defValues=null,pos=textBuffer.getCurrLineNo(),line=textBuffer.readLine(),values=Kekule.IO.Mdl3kValueUtils.splitValues(line);for("DEFAULT"==values.shift().value?defValues=this.fetchSGroupOptionalValues(line,atomIndexMap):textBuffer.setCurrLineNo(pos);!textBuffer.eof();){line=textBuffer.readLine();var sgInfo=this.analysisSGroupLine(line,atomIndexMap,defValues);sgroupInfos[sgInfo.index]=sgInfo}return sgroupInfos},analysisSGroupLine:function(line,atomIndexMap,defValues){var result={},values=Kekule.IO.Mdl3kValueUtils.splitValues(line);result.index=parseInt(values.shift().value,10),result.sgType=values.shift().value.trim(),result.extIndex=parseInt(values.shift().value,10);var opValues=this.fetchSGroupOptionalValues(values,atomIndexMap);return defValues&&(opValues=Object.extend(defValues,opValues)),result=Object.extend(result,opValues)},fetchSGroupOptionalValues:function(pairs,atomIndexMap){for(var result={},i=0,l=pairs.length;i<l;++i){var key=pairs[i].key,value=pairs[i].value;switch(key){case"ATOMS":result.atomIndexes=[];for(var j=0,k=value.length;j<k;j++)result.atomIndexes.push(atomIndexMap[value[j]]);break;case"XBONDS":result.crossBondIndexes=[].concat(value);break;case"SUBTYPE":result.subType=value;break;case"LABEL":result.label=value;break;case"CSTATE":result.bondVectors||(result.bondVectors=[]);var bondIndex=parseInt(value.shift(),10),x=parseFloat(value.shift())||0,y=parseFloat(value.shift())||0,z=parseFloat(value.shift())||0;result.bondVectors[bondIndex]={bondIndex:bondIndex,x:x,y:y,z:z};break;case"CLASS":result.sgClass=value}}return result}}),Kekule.IO.Mdl3kCTabWriter=Class.create(Kekule.IO.Mdl3kBlockWriter,{CLASS_NAME:"Kekule.IO.Mdl3kCTabWriter",initialize:function($super,coordMode){$super(),this.setCoordMode(coordMode||Kekule.CoordMode.UNKNOWN)},initProperties:function(){this.defineProp("coordMode",{dataType:DataType.INT,deaultValue:Kekule.CoordMode.UNKNOWN})},doWrite3kBlock:function(obj,textBuffer){return Kekule.IO.MdlUtils.assertIlegalForCtabOutput(obj),this.outputCtab(obj,textBuffer)},outputCtab:function(mol,textBuffer){var molInfo=Kekule.IO.MdlStructureUtils.getMoleculeCtabStructureInfo(mol);this.writeStartTag("CTAB",textBuffer),this.getCoordMode()!=Kekule.CoordMode.UNKNOWN&&(molInfo.coordMode=this.getCoordMode()),textBuffer.writeLine(this.generateCountLine(molInfo)),this.outputAtomBlock(mol,molInfo,textBuffer),this.outputBondBlock(mol,molInfo,textBuffer),this.outputSgroupBlock(mol,molInfo,textBuffer),this.writeEndTag("CTAB",textBuffer)},generateCompatibilityCountLine:function(molInfo){return Kekule.IO.MdlStructureUtils.generateClassicStyleCountLine(molInfo,Kekule.IO.MdlVersion.V3000)},generateCountLine:function(molInfo){var values=["COUNTS"];return values.push(molInfo.atoms.length),values.push(molInfo.bonds.length),values.push(molInfo.subGroups.length),values.push(0),values.push(0),Kekule.IO.Mdl3kValueUtils.mergeValues(values)},outputAtomBlock:function(mol,molInfo,textBuffer){this.writeStartTag("ATOM",textBuffer);for(var i=0,l=molInfo.atoms.length;i<l;++i){var atom=molInfo.atoms[i],line=this.generateAtomLine(i,molInfo.coordMode,atom);textBuffer.writeLine(line)}this.writeEndTag("ATOM",textBuffer)},generateAtomLine:function(index,coordMode,atom){var cf=Kekule.IO.Mdl3kUtils.coordToStr,values=[index+1,Kekule.IO.MdlStructureUtils.getAtomTypeStr(atom)];if(coordMode==Kekule.CoordMode.COORD2D){var coord=atom.getAbsCoord2D();values=values.concat([cf(coord.x),cf(coord.y),cf(0)])}else{var coord=atom.getAbsCoord3D();values=values.concat([cf(coord.x),cf(coord.y),cf(coord.z)])}return values.push(0),atom.getCharge&&atom.getCharge()&&values.push({key:"CHG",value:atom.getCharge()}),atom.getRadical&&atom.getRadical()&&values.push({key:"RAD",value:atom.getRadical()}),atom.getParity&&atom.getParity()&&values.push({key:"CFG",value:atom.getParity()}),atom.getMassNumber&&atom.getMassNumber()&&values.push({key:"MASS",value:atom.getMassNumber()}),atom.getExplicitHydrogenCount&&!Kekule.ObjUtils.isUnset(atom.getExplicitHydrogenCount())&&values.push({key:"HCOUNT",value:atom.getExplicitHydrogenCount()+1}),Kekule.IO.Mdl3kValueUtils.mergeValues(values)},outputBondBlock:function(mol,molInfo,textBuffer){if(!(molInfo.bonds.length<=0)){this.writeStartTag("BOND",textBuffer);for(var i=0,l=molInfo.bonds.length;i<l;++i){var bond=molInfo.bonds[i],line=this.generateBondLine(i,bond,molInfo.atoms);textBuffer.writeLine(line)}this.writeEndTag("BOND",textBuffer)}},generateBondLine:function(index,bond,atomList){var values=[index+1,Kekule.IO.MdlUtils.kekuleBondOrderToMdlType(bond.getBondOrder?bond.getBondOrder():Kekule.BondOrder.UNSET)],atoms=[],endPoints=[],nodeGroup=Kekule.IO.MdlStructureUtils.splitConnectedNodes(bond);if(atoms=[atomList.indexOf(nodeGroup.primaryNodes[0])+1,atomList.indexOf(nodeGroup.primaryNodes[1])+1],nodeGroup.remainNodes&&nodeGroup.remainNodes.length)for(var i=0,l=nodeGroup.remainNodes.length;i<l;++i)endPoints.push(atomList.indexOf(nodeGroup.remainNodes[i])+1);return values=values.concat(atoms),bond.getStereo&&bond.getStereo()&&values.push({key:"CFG",value:Kekule.IO.Mdl3kUtils.bondStereoToMdlCfg(bond.getStereo())}),endPoints.length>0&&(values.push({key:"ENDPTS",value:endPoints}),values.push({key:"ATTACH",value:"ALL"})),Kekule.IO.Mdl3kValueUtils.mergeValues(values)},outputSgroupBlock:function(mol,molInfo,textBuffer){if(!(molInfo.subGroups.length<=0)){this.writeStartTag("SGROUP",textBuffer);for(var i=0,l=molInfo.subGroups.length;i<l;++i){var line=this.generateSgroupLine(i,molInfo.subGroups[i],molInfo);textBuffer.writeLine(line)}this.writeEndTag("SGROUP",textBuffer)}},generateSgroupLine:function(index,subGroup,molInfo){for(var atomList=molInfo.atoms,bondList=molInfo.bonds,values=[index+1,"SUP",index+1],atomIndexes=[],atoms=subGroup.getLeafNodes(),i=0,l=atoms.length;i<l;++i){var index=atomList.indexOf(atoms[i]);index>=0&&atomIndexes.push(index+1)}atomIndexes=atomIndexes.sort(),values.push({key:"ATOMS",value:atomIndexes});var slabel=subGroup.getAbbr&&subGroup.getAbbr()||subGroup.getFormulaText&&subGroup.getFormulaText()||subGroup.getName&&subGroup.getName();slabel&&values.push({key:"LABEL",value:slabel});for(var xbonds=subGroup.getCrossConnectors(),xbondIndexes=[],xbondVectors=[],cf=Kekule.IO.Mdl3kUtils.coordToStr,i=0,l=xbonds.length;i<l;++i){var index=bondList.indexOf(xbonds[i]);if(index>=0){xbondIndexes.push(index+1);var vectorArray=[index+1],nodeGroup=Kekule.IO.MdlStructureUtils.splitConnectedNodes(xbonds[i]),atoms=nodeGroup.primaryNodes,vector={};2==atoms.length&&(molInfo.coordMode==Kekule.CoordMode.COORD2D?(vector=Kekule.CoordUtils.substract(atoms[0].getAbsCoord2D(),atoms[1].getAbsCoord2D()),vectorArray=vectorArray.concat([cf(vector.x),cf(vector.y),0])):(vector=Kekule.CoordUtils.substract(atoms[0].getAbsCoord3D(),atoms[1].getAbsCoord3D()),vectorArray=vectorArray.concat([cf(vector.x),cf(vector.y),cf(vector.z)]))),xbondVectors.push(vectorArray)}}xbondIndexes=xbondIndexes.sort(),values.push({key:"XBONDS",value:xbondIndexes});for(var i=0,l=xbondVectors.length;i<l;++i)values.push({key:"CSTATE",value:xbondVectors[i]});return Kekule.IO.Mdl3kValueUtils.mergeValues(values)}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},Class=__webpack_require__(0).Class,DataType=__webpack_require__(0).DataType;module.exports=function(Kekule){return Kekule.globalOptions.add("IO.mdl",{mdlVersion:Kekule.IO.MdlVersion.V2000,coordMode:Kekule.CoordMode.UNKNOWN}),Kekule.IO.MdlStructureFragmentReader=Class.create(Kekule.IO.MdlBlockReader,{CLASS_NAME:"Kekule.IO.MdlStructureFragmentReader",initialize:function($super,coordMode){$super(),this.setCoordMode(coordMode||Kekule.CoordMode.UNKNOWN)},initProperties:function(){this.defineProp("coordMode",{dataType:DataType.INT,defaultValue:Kekule.CoordMode.UNKNOWN})},createFragment:function(parentObj){},createCtabReader:function(mdlVersion){return mdlVersion==Kekule.IO.MdlVersion.V3000?new Kekule.IO.Mdl3kCTabReader:new Kekule.IO.Mdl2kCTabReader},getCtabVersion:function(textBuffer){var pos=textBuffer.getCurrLineNo(),line=textBuffer.readLine();textBuffer.setCurrLineNo(pos);var s=line.substr(33,6).trim();return"V3000"==s?Kekule.IO.MdlVersion.V3000:Kekule.IO.MdlVersion.V2000},createStructureFromJson:function(ctabInfo,parentObj){var fragment=this.createFragment();return fragment&&Kekule.IO.MdlStructureUtils.fillFragment(fragment,ctabInfo,this.getCoordMode()),fragment},doReadBlock:function($super,textBuffer,parentObj){var version=this.getCtabVersion(textBuffer);if(!version)return null;var ctabReader=this.createCtabReader(version),ctabInfo=ctabReader.doReadBlock(textBuffer,parentObj);return ctabInfo.atomInfos.coordMode&&(this._forceCoordMode=ctabInfo.atomInfos.coordMode),this.createStructureFromJson(ctabInfo,parentObj)}}),Kekule.IO.MdlStructureFragmentWriter=Class.create(Kekule.IO.MdlBlockWriter,{CLASS_NAME:"Kekule.IO.MdlStructureFragmentWriter",initialize:function($super,version,coordMode){$super(),this.setMdlVersion(version||Kekule.IO.MdlVersion.V2000),this.setCoordMode(coordMode||Kekule.CoordMode.UNKNOWN)},initProperties:function(){this.defineProp("mdlVersion",{dataType:DataType.INT,defaultValue:Kekule.IO.MdlVersion.V2000}),this.defineProp("coordMode",{dataType:DataType.INT,defaultValue:Kekule.CoordMode.UNKNOWN})},createCtabWriter:function(mdlVersion){return mdlVersion==Kekule.IO.MdlVersion.V3000?new Kekule.IO.Mdl3kCTabWriter(this.getCoordMode()):new Kekule.IO.Mdl2kCTabWriter(this.getCoordMode())},doWriteBlock:function($super,obj,textBuffer){var ctabWriter=this.createCtabWriter(this.getMdlVersion()),text=ctabWriter.writeBlock(obj);textBuffer.writeText(text)}}),Kekule.IO.Mdl3kMoleculeCTabReader=Class.create(Kekule.IO.MdlStructureFragmentReader,{CLASS_NAME:"Kekule.IO.Mdl3kMoleculeCTabReader",createFragment:function(parentObj){return new Kekule.Molecule},doReadBlock:function($super,textBuffer,parentObj){var ctabReader=this.createCtabReader(Kekule.IO.MdlVersion.V3000),ctabInfo=ctabReader.doReadBlock(textBuffer,parentObj);return this.createStructureFromJson(ctabInfo,parentObj)}}),Kekule.IO.Mdl3kMoleculeCTabWriter=Class.create(Kekule.IO.MdlStructureFragmentWriter,{CLASS_NAME:"Kekule.IO.Mdl3kMoleculeCTabWriter",initialize:function($super,coordMode){$super(Kekule.IO.MdlVersion.V3000,coordMode)},doWriteBlock:function($super,obj,textBuffer){var ctabWriter=new Kekule.IO.Mdl3kCTabWriter(this.getCoordMode()),text=ctabWriter.writeBlock(obj);textBuffer.writeText(text)}}),Kekule.IO.MdlMoleculeReader=Class.create(Kekule.IO.MdlStructureFragmentReader,{CLASS_NAME:"Kekule.IO.MdlMoleculeReader",createFragment:function(parentObj){return new Kekule.Molecule},readHeaderInfo:function(textBuffer,parentObj){var result={},name=textBuffer.readLine();name&&(result.name=name);var infoLine=textBuffer.readLine(),info=this.readInfoLine(infoLine);info&&(result=Object.extend(result,info));var comment=textBuffer.readLine();return comment&&(result.comment=comment),result},readInfoLine:function(line){var result={};if(line.trim()){var s=line.substr(0,2).trim();s&&(result.userAbbr=s),s=line.substr(2,8).trim(),s&&(result.programName=s),s=line.substr(10,10),s.trim()&&(result.date=Kekule.IO.MdlUtils.analysisMdlDateTimeStr(s,!1)),s=line.substr(20,2),result.coordMode="3D"==s?Kekule.CoordMode.COORD3D:"2D"==s?Kekule.CoordMode.COORD2D:Kekule.CoordMode.UNKNOWN}return result},doReadBlock:function($super,textBuffer,parentObj){var headerInfo=this.readHeaderInfo(textBuffer,parentObj);headerInfo&&void 0!==headerInfo.coordMode&&this.setCoordMode(headerInfo.coordMode);var mol=$super(textBuffer,parentObj);if(mol&&headerInfo&&(headerInfo.name&&mol.setName(headerInfo.name),headerInfo.userAbbr&&mol.setInfoValue("author",headerInfo.userAbbr),headerInfo.programName&&mol.setInfoValue("generator",headerInfo.programName),headerInfo.date&&mol.setInfoValue("date",headerInfo.date),headerInfo.comment&&mol.setInfoValue("comment",headerInfo.comment)),!textBuffer.eof()){"M  END"===textBuffer.getCurrLine().trim().toUpperCase()&&textBuffer.readLine()}return mol}}),Kekule.IO.MdlMoleculeWriter=Class.create(Kekule.IO.MdlStructureFragmentWriter,{CLASS_NAME:"Kekule.IO.MdlMoleculeWriter",writeHeaderInfo:function(mol,textBuffer){textBuffer.writeLine(mol.getName()||Kekule.$L("Texts.UNNAMED")||"");var infoLine=this.generateInfoLine(mol);textBuffer.writeLine(infoLine);var comment=mol.getInfoValue("comment");textBuffer.writeLine(comment||"")},generateInfoLine:function(mol){var s="",author=mol.getInfoValue("author");s+=author?author.toString().substr(0,2).rpad(2):"  ";var progName=mol.getInfoValue("generator");s+=progName?progName.toString().substr(0,8).rpad(8):Kekule.LIBNAME_CORE.rpad(8);var date=mol.getInfoValue("date")||new Date;return s+=Kekule.IO.MdlUtils.generateMdlDateTimeStr(date,!1),s+=this.getCoordMode()==Kekule.CoordMode.COORD3D?"3D":"2D"},getMolecule:function(obj){return Kekule.ChemStructureUtils.getTotalStructFragment(obj)},doWriteBlock:function($super,obj,textBuffer){var mol=this.getMolecule(obj);if(mol){var molInfo=Kekule.IO.MdlStructureUtils.getMoleculeCtabStructureInfo(mol);this.setCoordMode(molInfo.coordMode),this.writeHeaderInfo(mol,textBuffer),this.getMdlVersion()==Kekule.IO.MdlVersion.V3000&&textBuffer.writeLine(Kekule.IO.MdlStructureUtils.generateClassicStyleCountLine(molInfo,this.getMdlVersion())),$super(mol,textBuffer),this.getMdlVersion()==Kekule.IO.MdlVersion.V3000&&textBuffer.writeLine("M  END")}}}),Kekule.IO.MdlStructDataReader=Class.create(Kekule.IO.MdlBlockReader,{CLASS_NAME:"Kekule.IO.MdlStructDataReader",DATA_HEAD_PREFIX:Kekule.IO.MDL.SD_DATA_HEAD_PREFIX,DATA_DBFIELD_PATTERN:/\bDT(\d+)\b/,DATA_KEY_NAME_PATTERN:/\<(.+)\>/,MOL_DELIMITER:Kekule.IO.MDL.MOL_DELIMITER,doReadBlock:function(textBuffer,parentObj){var molReader=new Kekule.IO.MdlMoleculeReader;try{for(var currKey,currValue,mol,mols=[];!textBuffer.eof();){try{mol=molReader.doReadBlock(textBuffer,null)}catch(e){mol=null}if(!mol)break;for(mols.push(mol),currKey=null,currValue=null;!textBuffer.eof();){var lineInfo=this.analysisDataLine(textBuffer.readLine());if(lineInfo){var lineType=lineInfo.lineType;if("dataheader"===lineType)currKey=lineInfo.key;else if("datavalue"===lineType)currKey&&(currValue=lineInfo.value,mol.setInfoValue(currKey,currValue));else if("moldelimiter"===lineType)break}}}if(mols.length>1){for(var result=new Kekule.ChemObjList,i=0,l=mols.length;i<l;++i)result.append(mols[i]);return result}return mols[0]}finally{molReader.finalize()}},analysisDataLine:function(line){var lineType,key,s=line.trim();return s.startsWith(this.DATA_HEAD_PREFIX)?(lineType="dataheader",key=this.getDataHeaderKey(line),key?{lineType:lineType,key:key}:null):s.startsWith(this.MOL_DELIMITER)?{lineType:"moldelimiter"}:s?{lineType:"datavalue",value:line}:null},getDataHeaderKey:function(line){var key=null,result=this.DATA_KEY_NAME_PATTERN.exec(line);return result&&result.length>1?key=result[1]:(result=this.DATA_DBFIELD_PATTERN.exec(line),key=result&&result.length>1?result[1]:line),key},doReadDataBlock:function(textBuffer,mol){textBuffer.readLine()}}),Kekule.IO.MdlStructDataWriter=Class.create(Kekule.IO.MdlBlockWriter,{CLASS_NAME:"Kekule.IO.MdlStructDataWriter",IGNORED_INFO_FIELDS:["generator","author","date","comment"],initialize:function($super,version,coordMode){$super(),this.setMdlVersion(version||Kekule.IO.MdlVersion.V2000),this.setCoordMode(coordMode||Kekule.CoordMode.UNKNOWN)},initProperties:function(){this.defineProp("mdlVersion",{dataType:DataType.INT,defaultValue:Kekule.IO.MdlVersion.V2000}),this.defineProp("coordMode",{dataType:DataType.INT,defaultValue:Kekule.CoordMode.UNKNOWN})},doWriteBlock:function(chemObj,textBuffer){var mols=this.getChildMols(chemObj),molWriter=new Kekule.IO.MdlMoleculeWriter;molWriter.setMdlVersion(this.getMdlVersion()),molWriter.setCoordMode(this.getCoordMode());for(var i=0,l=mols.length;i<l;++i){var mol=mols[i],text=molWriter.writeBlock(mol);textBuffer.writeText(text);var data=this.getMolData(mol);this.doWriteDataBlock(data,textBuffer),textBuffer.writeLine(Kekule.IO.MDL.MOL_DELIMITER)}},doWriteDataBlock:function(data,textBuffer){for(var keys=Kekule.ObjUtils.getOwnedFieldNames(data),i=0,l=keys.length;i<l;++i){var key=keys[i];if(this.IGNORED_INFO_FIELDS.indexOf(key)<0){var header=Kekule.IO.MDL.SD_DATA_HEAD_PREFIX+" <"+key+">",value=data[key];header&&value&&(textBuffer.writeLine(header),textBuffer.writeLine(value),textBuffer.writeLine(""))}}},getChildMols:function(chemObj){for(var children=Kekule.ChemStructureUtils.getChildStructureObjs(chemObj,!0),result=[],i=0,l=children.length;i<l;++i){var child=children[i];child instanceof Kekule.StructureFragment&&result.push(child)}return result},getMolData:function(mol){return mol.getInfo?mol.getInfo()||{}:null}}),Kekule.IO.MdlBaseReactionReader=Class.create(Kekule.IO.MdlBlockReader,{CLASS_NAME:"Kekule.IO.MdlBaseReactionReader",readHeaderBlock:function(textBuffer,parentObj){var s,result={},line=textBuffer.readLine().trim();return"$RXN"!=(s=line.substr(0,4))?(Kekule.error(Kekule.$L("ErrorMsg.NOT_MDL_RXN_DATA")),null):(s=line.substr(4).trim(),result.version="V3000"==s?Kekule.IO.MdlVersion.V3000:Kekule.IO.MdlVersion.V2000,line=textBuffer.readLine().trim(),line&&(result.name=line),line=textBuffer.readLine(),s=line.substr(0,6).trim(),s&&(result.userAbbr=s),s=line.substr(6,9).trim(),s&&(result.programName=s),s=line.substr(15,10),s.trim()&&(result.date=Kekule.IO.MdlUtils.analysisMdlDateTimeStr(s,!0)),line=textBuffer.readLine().trim(),line&&(result.comment=line),result)},readSubstanceCountLine:function(line){},readMolBlock:function(textBuffer){},doReadBlock:function($super,textBuffer,parentObj){for(var headerInfo=this.readHeaderBlock(textBuffer,null),substanceInfo=this.readSubstanceCountLine(textBuffer.readLine()),result=new Kekule.Reaction,i=0;i<substanceInfo.reactantCount;++i){var mol=this.readMolBlock(textBuffer);mol&&result.appendReactant(mol)}for(var i=0;i<substanceInfo.productCount;++i){var mol=this.readMolBlock(textBuffer);mol&&result.appendProduct(mol)}return result&&headerInfo&&(headerInfo.name&&result.setName(headerInfo.name),headerInfo.userAbbr&&result.setInfoValue("author",headerInfo.userAbbr),headerInfo.programName&&result.setInfoValue("generator",headerInfo.programName),headerInfo.date&&result.setInfoValue("date",headerInfo.date),headerInfo.comment&&result.setInfoValue("comment",headerInfo.comment)),result}}),Kekule.IO.Mdl2kReactionReader=Class.create(Kekule.IO.MdlBaseReactionReader,{CLASS_NAME:"Kekule.IO.Mdl2kReactionReader",readHeaderBlock:function($super,textBuffer,parentObj){var result=$super(textBuffer,parentObj);return result.version!=Kekule.IO.MdlVersion.V2000?(Kekule.error(Kekule.$L("ErrorMsg.NOT_MDL2000_RXN_DATA")),null):result},readSubstanceCountLine:function(line){var result={};return result.reactantCount=parseInt(line.substr(0,3),10)||0,result.productCount=parseInt(line.substr(3,3),10)||0,result},readMolBlock:function(textBuffer){for(var line=textBuffer.readLine();"$MOL"!==line&&!textBuffer.eof();)line=textBuffer.readLine();if(textBuffer.eof())return null;for(var lines=[],line=textBuffer.getCurrLine();"$MOL"!==line&&!textBuffer.eof();)lines.push(line),textBuffer.incCurrLineNo(),line=textBuffer.getCurrLine();return(new Kekule.IO.MdlMoleculeReader).readBlock(lines,null)}}),Kekule.IO.Mdl3kReactionReader=Class.create(Kekule.IO.MdlBaseReactionReader,{CLASS_NAME:"Kekule.IO.Mdl3kReactionReader",createTextBuffer:function(){return new Kekule.IO.Mdl3kTextBuffer},readHeaderBlock:function($super,textBuffer,parentObj){var result=$super(textBuffer,parentObj);return result.version!=Kekule.IO.MdlVersion.V3000?(Kekule.error(Kekule.$L("ErrorMsg.NOT_MDL3000_RXN_DATA")),null):result},readSubstanceCountLine:function(line){var result={},values=Kekule.IO.Mdl3kValueUtils.splitValues(line);return"COUNTS"!=values.shift().value.trim()?(Kekule.error(Kekule.$L("ErrorMsg.NOT_MDL3000_RXN_COUNTLINE")),null):(result.reactantCount=parseInt(values.shift().value,10)||0,result.productCount=parseInt(values.shift().value,10)||0,result)},readMolBlock:function(textBuffer){if(textBuffer.getBlockBuffer){var buffer=textBuffer.getBlockBuffer("CTAB");return(new Kekule.IO.Mdl3kMoleculeCTabReader).doReadBlock(buffer)}return null}}),Kekule.IO.MdlReactionReader=Class.create(Kekule.IO.MdlBlockReader,{CLASS_NAME:"Kekule.IO.MdlReactionReader",doReadBlock:function(textBuffer,parentObj){var reader;return reader=Kekule.IO.MdlUtils.getRxnMarkVersion(textBuffer.getCurrLine())==Kekule.IO.MdlVersion.V3000?new Kekule.IO.Mdl3kReactionReader:new Kekule.IO.Mdl2kReactionReader,reader.readBlock(textBuffer.getUnreadLines(),parentObj)}}),Kekule.IO.MdlReactionWriter=Class.create(Kekule.IO.MdlBlockWriter,{CLASS_NAME:"Kekule.IO.MdlReactionWriter",initialize:function($super,version,coordMode){$super(),this.setMdlVersion(version||Kekule.IO.MdlVersion.V2000),this.setCoordMode(coordMode||Kekule.CoordMode.UNKNOWN)},initProperties:function(){this.defineProp("mdlVersion",{dataType:DataType.INT,defaultValue:Kekule.IO.MdlVersion.V2000}),this.defineProp("coordMode",{dataType:DataType.INT,defaultValue:Kekule.CoordMode.UNKNOWN})},writeHeaderBlock:function(reaction,textBuffer){var s;s="$RXN"+(this.getMdlVersion()==Kekule.IO.MdlVersion.V3000?" "+Kekule.IO.MDL.VER3000:""),textBuffer.writeLine(s),textBuffer.writeLine(reaction.getName()||""),s=(reaction.getInfoValue("author")||"").substr(0,6).rpad(6),s+=(reaction.getInfoValue("generator")||"").substr(0,9).rpad(9);var date=reaction.getInfoValue("date")||new Date;s+=Kekule.IO.MdlUtils.generateMdlDateTimeStr(date,!0),textBuffer.writeLine(s);var comment=reaction.getInfoValue("comment")||"";textBuffer.writeLine(comment)},generateSubstanceCountLine:function(reaction){return this.getMdlVersion()==Kekule.IO.MdlVersion.V3000?"M  V30 COUNTS "+Kekule.IO.Mdl3kValueUtils.mergeValues([reaction.getReactantCount(),reaction.getProductCount()]):reaction.getReactantCount().toString().lpad(3)+reaction.getProductCount().toString().lpad(3)},writeMolDelimiterLine:function(textBuffer){this.getMdlVersion()==Kekule.IO.MdlVersion.V2000&&textBuffer.writeLine("$MOL")},writeMolBlock:function(mol,textBuffer){var writer=this.getMdlVersion()==Kekule.IO.MdlVersion.V3000?new Kekule.IO.Mdl3kMoleculeCTabWriter(this.getCoordMode()):new Kekule.IO.MdlMoleculeWriter(this.getMdlVersion(),this.getCoordMode()),text=writer.writeBlock(mol);textBuffer.writeText(text)},doWriteBlock:function($super,reaction,textBuffer){var is3kMode=this.getMdlVersion()==Kekule.IO.MdlVersion.V3000;this.writeHeaderBlock(reaction,textBuffer);var substanceInfoLine=this.generateSubstanceCountLine(reaction);textBuffer.writeLine(substanceInfoLine),is3kMode&&textBuffer.writeLine("M  V30 "+Kekule.IO.Mdl3kUtils.get3kBlockStartTag("REACTANT"));for(var i=0;i<reaction.getReactantCount();++i)this.writeMolDelimiterLine(textBuffer),this.writeMolBlock(reaction.getReactantAt(i),textBuffer);is3kMode&&textBuffer.writeLine("M  V30 "+Kekule.IO.Mdl3kUtils.get3kBlockEndTag("REACTANT")),is3kMode&&textBuffer.writeLine("M  V30 "+Kekule.IO.Mdl3kUtils.get3kBlockStartTag("PRODUCT"));for(var i=0;i<reaction.getProductCount();++i)this.writeMolDelimiterLine(textBuffer),this.writeMolBlock(reaction.getProductAt(i),textBuffer);is3kMode&&(textBuffer.writeLine("M  V30 "+Kekule.IO.Mdl3kUtils.get3kBlockEndTag("PRODUCT")),textBuffer.writeLine("M  END"))}}),Kekule.IO.BaseMdlReader=Class.create(Kekule.IO.ChemDataReader,{CLASS_NAME:"Kekule.IO.BaseMdlReader",doReadData:function(data,dataType,format){return dataType!=Kekule.IO.ChemDataType.TEXT?(Kekule.error(Kekule.$L("ErrorMsg.MDL_INPUT_DATATYPE_NOT_TEXT")),null):this.doReadMdlData(data)},doReadMdlData:function(data){return null}}),Kekule.IO.BaseMdlWriter=Class.create(Kekule.IO.ChemDataWriter,{CLASS_NAME:"Kekule.IO.BaseMdlWriter",initialize:function($super,options){$super(options),options||(options={}),this.setMdlVersion(options.mdlVersion||Kekule.globalOptions.IO.mdl.mdlVersion),this.setCoordMode(options.coordMode||Kekule.globalOptions.IO.mdl.coordMode)},initProperties:function(){this.defineProp("mdlVersion",{dataType:DataType.INT,defaultValue:Kekule.IO.MdlVersion.V2000}),this.defineProp("coordMode",{dataType:DataType.INT,defaultValue:Kekule.CoordMode.UNKNOWN})},doWriteData:function($super,obj,dataType,format){var dtype=dataType||Kekule.IO.ChemDataType.TEXT;return dtype!=Kekule.IO.ChemDataType.TEXT?(Kekule.error(Kekule.$L("ErrorMsg.MDL_OUTPUT_DATATYPE_NOT_TEXT")),null):$super(obj,dtype,format)}}),Kekule.IO.MdlMolReader=Class.create(Kekule.IO.BaseMdlReader,{CLASS_NAME:"Kekule.IO.MdlMolReader",doReadMdlData:function(data){return(new Kekule.IO.MdlMoleculeReader).readBlock(data,null)}}),Kekule.IO.MdlMolWriter=Class.create(Kekule.IO.BaseMdlWriter,{CLASS_NAME:"Kekule.IO.MdlMolWriter",doWriteData:function(obj,dataType,format){return new Kekule.IO.MdlMoleculeWriter(this.getMdlVersion(),this.getCoordMode()).writeBlock(obj)}}),Kekule.IO.MdlSdReader=Class.create(Kekule.IO.BaseMdlReader,{CLASS_NAME:"Kekule.IO.MdlSdReader",doReadMdlData:function(data){return(new Kekule.IO.MdlStructDataReader).readBlock(data,null)}}),Kekule.IO.MdlSdWriter=Class.create(Kekule.IO.BaseMdlWriter,{CLASS_NAME:"Kekule.IO.MdlSdWriter",doWriteData:function(obj,dataType,format){return new Kekule.IO.MdlStructDataWriter(this.getMdlVersion(),this.getCoordMode()).writeBlock(obj)}}),Kekule.IO.MdlRxnReader=Class.create(Kekule.IO.BaseMdlReader,{CLASS_NAME:"Kekule.IO.MdlRxnReader",doReadMdlData:function(data){return(new Kekule.IO.MdlReactionReader).readBlock(data,null)}}),Kekule.IO.MdlRxnWriter=Class.create(Kekule.IO.BaseMdlWriter,{CLASS_NAME:"Kekule.IO.MdlRxnWriter",doWriteData:function(obj,dataType,format){return new Kekule.IO.MdlReactionWriter(this.getMdlVersion(),this.getCoordMode()).writeBlock(obj)}}),Kekule.IO.MdlReader=Class.create(Kekule.IO.ChemDataReader,{CLASS_NAME:"Kekule.IO.MdlReader",doReadData:function(data,dataType,format){if(dataType!=Kekule.IO.ChemDataType.TEXT)return Kekule.error(Kekule.$L("ErrorMsg.MDL_INPUT_DATATYPE_NOT_TEXT")),null;var reader;return reader="$RXN"==data.substr(0,4)?new Kekule.IO.MdlReactionReader:new Kekule.IO.MdlMoleculeReader,reader.readBlock(data,null)}}),Kekule.IO.MdlWriter=Class.create(Kekule.IO.ChemDataWriter,{CLASS_NAME:"Kekule.IO.MdlWriter",initialize:function($super,options){$super(options);var op=options||{};this.setMdlVersion(op.mdlVersion||Kekule.globalOptions.IO.mdl.mdlVersion),this.setCoordMode(op.coordMode||Kekule.globalOptions.IO.mdl.coordMode)},initProperties:function(){this.defineProp("mdlVersion",{dataType:DataType.INT,defaultValue:Kekule.IO.MdlVersion.V2000}),this.defineProp("coordMode",{dataType:DataType.INT,defaultValue:Kekule.CoordMode.UNKNOWN})},doWriteData:function(obj,dataType,format){var writer;if(obj instanceof Kekule.Reaction)writer=new Kekule.IO.MdlRxnWriter(this.getMdlVersion(),this.getCoordMode());else{if(!(obj instanceof Kekule.StructureFragment)){var className=obj&&obj.getClassName?obj.getClassName():void 0===obj?"undefined":_typeof(obj);return Kekule.error(Kekule.$L("ErrorMsg.UNABLE_TO_OUTPUT_AS_MDL").format(className)),null}writer=new Kekule.IO.MdlMolWriter(this.getMdlVersion(),this.getCoordMode())}if(writer)return writer.writeData(obj)}}),function(){Kekule.IO.DataFormat.MOL="mol",Kekule.IO.DataFormat.RXN="rxn",Kekule.IO.DataFormat.SD="sd",Kekule.IO.DataFormat.MOL3K="mol3k",Kekule.IO.DataFormat.RXN3K="rxn3k",Kekule.IO.MimeType.MDL_MOL="chemical/x-mdl-molfile",Kekule.IO.MimeType.MDL_RXN="chemical/x-mdl-rxnfile",Kekule.IO.MimeType.MDL_SD="chemical/x-mdl-sdfile",Kekule.IO.DataFormatsManager.register("mol",Kekule.IO.MimeType.MDL_MOL,"mol",Kekule.IO.ChemDataType.TEXT,"MDL Mol 2000 format"),Kekule.IO.DataFormatsManager.register("rxn",Kekule.IO.MimeType.MDL_RXN,"rxn",Kekule.IO.ChemDataType.TEXT,"MDL Reaction 2000 format"),Kekule.IO.DataFormatsManager.register("sd",Kekule.IO.MimeType.MDL_SD,["sd","sdf"],Kekule.IO.ChemDataType.TEXT,"MDL Structure-Data format"),Kekule.IO.DataFormatsManager.register("mol3k",Kekule.IO.MimeType.MDL_MOL,"mol",Kekule.IO.ChemDataType.TEXT,"MDL Mol 3000 format"),Kekule.IO.DataFormatsManager.register("rxn3k",Kekule.IO.MimeType.MDL_RXN,"rxn",Kekule.IO.ChemDataType.TEXT,"MDL Reaction 3000 format"),Kekule.IO.ChemDataReaderManager.register("MDL-mol",Kekule.IO.MdlMolReader,["mol","mol3k"]),Kekule.IO.ChemDataReaderManager.register("MDL-rxn",Kekule.IO.MdlRxnReader,["rxn","rxn3k"]),Kekule.IO.ChemDataReaderManager.register("MDL-general",Kekule.IO.MdlReader,["mol","mol3k","rxn","rxn3k"]),Kekule.IO.ChemDataReaderManager.register("MDL-sd",Kekule.IO.MdlSdReader,"sd");var suitableClasses=[Kekule.StructureFragment,Kekule.ChemObjList,Kekule.ChemStructureObjectGroup,Kekule.ChemSpaceElement,Kekule.ChemSpace];Kekule.IO.ChemDataWriterManager.register("MDL-mol",Kekule.IO.MdlMolWriter,suitableClasses,"mol"),Kekule.IO.ChemDataWriterManager.register("MDL-mol3k",Kekule.IO.MdlMolWriter,suitableClasses,"mol3k",{createOptions:{mdlVersion:Kekule.IO.MdlVersion.V3000}}),Kekule.IO.ChemDataWriterManager.register("MDL-rxn",Kekule.IO.MdlRxnWriter,[Kekule.Reaction],"rxn"),Kekule.IO.ChemDataWriterManager.register("MDL-rxn3k",Kekule.IO.MdlRxnWriter,[Kekule.Reaction],"rxn3k"),Kekule.IO.ChemDataWriterManager.register("MDL-sd",Kekule.IO.MdlSdWriter,suitableClasses,"sd")}(),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class;module.exports=function(Kekule){var AU=Kekule.ArrayUtils;Kekule.IO.SMILES={ATOM_BRACKET_LEFT:"[",ATOM_BRACKET_RIGHT:"]",ATOM_WILDCARD:"*",ATOM_H:"H",ORGAN_SUBSET_ATOMS:["B","C","N","O","S","P","F","Cl","Br","I"],AROMATIC_SUBSET_ATOMS:["B","C","N","O","S","P"],BOND_SINGLE:"-",BOND_DOUBLE:"=",BOND_TRIPLE:"#",BOND_QUAD:"$",BOND_AROMATIC:":",BOND_FAKE:".",RING_BOND_TWO_DIGIT_NO_PREFIX:"%",BRANCH_BRACKET_LEFT:"(",BRANCH_BRACKET_RIGHT:")",ROTATION_DIR_CLOCKWISE:"@@",ROTATION_DIR_ANTICLOCKWISE:"@",DIRECTION_BOND_SYMBOLS:["/","\\"]};var SMI=Kekule.IO.SMILES;Kekule.IO.SmilesUtils={createGraphDepthSpanningTreesEx:function(graph,startingVertex){for(var remainingVertexes=AU.clone(graph.getVertexes()),i=0,l=remainingVertexes.length;i<l;++i)remainingVertexes[i].setData("__$visitedEx__",!1);for(var result=[];remainingVertexes.length;){var currVertex;currVertex=startingVertex&&remainingVertexes.indexOf(startingVertex)>=0?startingVertex:remainingVertexes[0];var seq={vertexes:[],edges:[],longestPath:{vertexes:[],edges:[],length:0}},partialResult=function _doTravers(startingVertex){var result={vertexes:[],edges:[],longestPath:{vertexes:[],edges:[],length:0}},vertex=startingVertex;vertex.getData("__$visitedEx__")||(result.vertexes.push(vertex),vertex.setData("__$visitedEx__",!0));for(var longestTargetNeighborEdge,edges=vertex.getEdges(),i=0,l=edges.length;i<l;++i){var edge=edges[i],neighbor=vertex.getNeighborOnEdge(edge);if(!neighbor.getData("__$visitedEx__")){result.vertexes.push(neighbor),result.edges.push(edge),neighbor.setData("__$visitedEx__",!0);var nextResult=_doTravers(neighbor);result.vertexes=result.vertexes.concat(nextResult.vertexes),result.edges=result.edges.concat(nextResult.edges),(nextResult.longestPath.length>result.longestPath.length||!result.longestPath.length)&&(result.longestPath.vertexes=nextResult.longestPath.vertexes,result.longestPath.edges=nextResult.longestPath.edges,result.longestPath.length=nextResult.longestPath.length,longestTargetNeighborEdge=edge)}}return longestTargetNeighborEdge&&(result.longestPath.edges.unshift(longestTargetNeighborEdge),result.longestPath.length=(result.longestPath.length||0)+1),result.longestPath.vertexes.unshift(vertex),result}(currVertex);seq.vertexes=seq.vertexes.concat(partialResult.vertexes),seq.edges=seq.edges.concat(partialResult.edges),seq.longestPath.length=(seq.longestPath.length||0)+partialResult.longestPath.length,seq.longestPath.vertexes=seq.longestPath.vertexes.concat(partialResult.longestPath.vertexes),seq.longestPath.edges=seq.longestPath.edges.concat(partialResult.longestPath.edges),remainingVertexes=AU.exclude(remainingVertexes,partialResult.vertexes),result.push(seq)}return result}},Kekule.IO.SmilesMolWriter=Class.create(Kekule.IO.ChemDataWriter,{CLASS_NAME:"Kekule.IO.SmilesMolWriter",doWriteData:function(obj,dataType,format,options){var mol=this.getMolecule(obj);return this.writeStructFragment(mol,options)},getMolecule:function(obj){return Kekule.ChemStructureUtils.getTotalStructFragment(obj)},writeStructFragment:function(mol,options){if(mol.hasCtab()){var dupMol=mol.clone();dupMol.standardize&&dupMol.standardize();var aromaticNodes=[],aromaticConnectors=[];if(dupMol.getAromaticRings)for(var aromaticRings=dupMol.getAromaticRings(),i=0,l=aromaticRings.length;i<l;++i){var ring=aromaticRings[i];AU.pushUnique(aromaticNodes,ring.nodes),AU.pushUnique(aromaticConnectors,ring.connectors)}for(var result,molGraph=Kekule.GraphAdaptUtils.ctabToGraph(dupMol.getCtab(),null,{expandSubStructures:!0,ignoreBondedHydrogen:!0}),graphVertexes=molGraph.getVertexes(),startingVertex=(molGraph.getEdges(),graphVertexes[graphVertexes.length-1]),depthSpanningTrees=Kekule.IO.SmilesUtils.createGraphDepthSpanningTreesEx(molGraph,startingVertex),ringEdgeRepo=[],i=0,l=depthSpanningTrees.length;i<l;++i){var depthSpanningTree=depthSpanningTrees[i],mainChainPath=depthSpanningTree.longestPath,partResult="",currVertex=mainChainPath.vertexes[0];partResult=this._writeMolVertex(currVertex,null,mainChainPath.edges,depthSpanningTree.edges,ringEdgeRepo,aromaticNodes,aromaticConnectors,options),0===i?result=partResult:result+=SMI.BOND_FAKE+partResult}return result}return""},_writeMolVertex:function(vertex,prevEdge,mainChainEdges,spanningTreeEdges,ringEdgeRepo,aromaticNodes,aromaticRingConnectors,options){var mainChainStr,mainChainVertex,node=vertex.getData("object"),edges=vertex.getEdges(),branchStrs=[],branchVertexes=[],ringStrs=[],ringedVertexes=[],nextBondStereoStr="",ignoreBondStereo=options.ignoreStereoBond;Kekule.ObjUtils.isUnset(ignoreBondStereo)&&(ignoreBondStereo=options.ignoreStereo||!1);for(var i=edges.length-1;i>=0;--i){var edge=edges[i];if(edge!==prevEdge){var connector=edge.getData("object");if(!ignoreBondStereo&&connector.getParity&&connector.getParity()){var keyNodes=Kekule.MolStereoUtils.getStereoBondKeyNodes(connector);if(keyNodes){var nextVertex=vertex.getNeighborOnEdge(edge),nextNode=nextVertex.getData("object"),initDirSymbols=this._getStereoDoubleBondInitialDirectionSymbols(connector),dirSymbol=initDirSymbols[0];keyNodes.indexOf(nextNode)<0&&(dirSymbol=this._getInvertBondDirectionSymbol(dirSymbol))}nextBondStereoStr=dirSymbol}if(spanningTreeEdges.indexOf(edge)>=0){var nextVertex=vertex.getNeighborOnEdge(edge),str=this._writeMolVertex(nextVertex,edge,mainChainEdges,spanningTreeEdges,ringEdgeRepo,aromaticNodes,aromaticRingConnectors,options);mainChainEdges.indexOf(edge)>=0?(mainChainVertex=nextVertex,mainChainStr=str):(branchVertexes.push(nextVertex),branchStrs.push(str))}else{var ringEdgeIndex=ringEdgeRepo.indexOf(edge);ringEdgeIndex<0&&(ringEdgeIndex=ringEdgeRepo.length,ringEdgeRepo.push(edge)),ringedVertexes.push(vertex.getNeighborOnEdge(edge));var ringStr=this._outputConnectorStr(connector,edge.getVertexes()[0].getData("object"),edge.getVertexes()[1].getData("object"),aromaticNodes,aromaticRingConnectors);ringEdgeIndex+=1,ringStr+=ringEdgeIndex<10?ringEdgeIndex:SMI.RING_BOND_TWO_DIGIT_NO_PREFIX+ringEdgeIndex,ringStrs.push(ringStr)}}}var prevNode,result="",prevBondStereoStr="";if(prevEdge){nextBondStereoStr&&(result+=nextBondStereoStr);prevNode=vertex.getNeighborOnEdge(prevEdge).getData("object");var prevConnector=prevEdge.getData("object");if(!ignoreBondStereo&&prevConnector.getParity&&prevConnector.getParity()){var keyNodes=Kekule.MolStereoUtils.getStereoBondKeyNodes(prevConnector);if(keyNodes){var initDirSymbols=this._getStereoDoubleBondInitialDirectionSymbols(prevConnector),dirSymbol=initDirSymbols[1];keyNodes.indexOf(prevNode)<0&&(dirSymbol=this._getInvertBondDirectionSymbol(dirSymbol))}prevBondStereoStr+=dirSymbol}result+=this._outputConnectorStr(prevConnector,prevEdge.getVertexes()[0].getData("object"),prevEdge.getVertexes()[1].getData("object"),aromaticNodes,aromaticRingConnectors)}for(var nextNodes=[],i=0,l=ringedVertexes.length;i<l;++i)nextNodes.push(ringedVertexes[i].getData("object"));for(var i=0,l=branchVertexes.length;i<l;++i)nextNodes.push(branchVertexes[i].getData("object"));mainChainVertex&&nextNodes.push(mainChainVertex.getData("object")),result+=this._outputNodeStr(node,aromaticNodes.indexOf(node)>=0,prevNode,nextNodes,options);for(var i=0,l=ringStrs.length;i<l;++i)result+=ringStrs[i];!mainChainStr&&branchStrs.length&&(mainChainStr=branchStrs.shift());for(var i=0,l=branchStrs.length;i<l;++i)result+=SMI.BRANCH_BRACKET_LEFT+branchStrs[i]+SMI.BRANCH_BRACKET_RIGHT;return result+=prevBondStereoStr,mainChainStr&&(result+=mainChainStr),result},_outputNodeStr:function(node,isAromatic,prevNode,nextNodes,options){var result,symbol;node instanceof Kekule.Atom?(symbol=node.getSymbol(),result=symbol,isAromatic&&(result=result.toLowerCase())):result=SMI.ATOM_WILDCARD;var ignoreAtomStereo=options.ignoreStereoAtom;Kekule.ObjUtils.isUnset(ignoreAtomStereo)&&(ignoreAtomStereo=options.ignoreStereo||!1);var schiralRot;if(!ignoreAtomStereo&&node.getParity&&node.getParity()&&nextNodes&&nextNodes.length){var hcount=node.getHydrogenCount?node.getHydrogenCount(!0)||0:0,dir=Kekule.MolStereoUtils.calcTetrahedronChiralCenterRotationDirection(null,node,prevNode,nextNodes,!!hcount,!1),schiralRot=dir===Kekule.RotationDir.CLOCKWISE?SMI.ROTATION_DIR_CLOCKWISE:dir===Kekule.RotationDir.ANTICLOCKWISE?SMI.ROTATION_DIR_ANTICLOCKWISE:"";schiralRot&&(result+=schiralRot)}var explicitHCount;if(schiralRot?explicitHCount=node.getHydrogenCount?node.getHydrogenCount(!0)||0:0:!(explicitHCount=node.getExplicitHydrogenCount?node.getExplicitHydrogenCount():0)&&isAromatic&&"C"!==symbol&&node.getImplicitHydrogenCount&&(explicitHCount=node.getImplicitHydrogenCount()),explicitHCount){result+=SMI.ATOM_H;var hcount=Math.round(explicitHCount);hcount>1&&(result+=hcount)}var charge=Math.round(node.getCharge());if(charge){var chargeStr=charge>0?"+":"-";(charge>1||charge<-1)&&(chargeStr=Math.abs(charge)+chargeStr),result+=chargeStr}var massNum=node.getMassNumber?node.getMassNumber():null;massNum&&(result=Math.abs(massNum)+result);var simpleOrgAtom=!1;return explicitHCount||charge||massNum||schiralRot||(!isAromatic&&SMI.ORGAN_SUBSET_ATOMS.indexOf(symbol)>=0||isAromatic&&SMI.AROMATIC_SUBSET_ATOMS.indexOf(symbol)>=0)&&(simpleOrgAtom=!0),simpleOrgAtom||(result=SMI.ATOM_BRACKET_LEFT+result+SMI.ATOM_BRACKET_RIGHT),result},_outputConnectorStr:function(connector,connectedNode1,connectedNode2,aromaticNodes,aromaticConnectors){if(connector instanceof Kekule.Bond&&connector.getBondType()===Kekule.BondType.COVALENT){if(aromaticConnectors.indexOf(connector)>=0)return"";var connectBothAromaticNodes=aromaticNodes.indexOf(connectedNode1)>=0&&aromaticNodes.indexOf(connectedNode2)>=0,bondOrder=connector.getBondOrder(),BO=Kekule.BondOrder;return bondOrder===BO.DOUBLE?SMI.BOND_DOUBLE:bondOrder===BO.TRIPLE?SMI.BOND_TRIPLE:bondOrder===BO.QUAD?SMI.BOND_QUAD:connectBothAromaticNodes?SMI.BOND_SINGLE:""}return SMI.BOND_FAKE},_getStereoDoubleBondInitialDirectionSymbols:function(bond){return bond.getParity()===Kekule.StereoParity.EVEN?[SMI.DIRECTION_BOND_SYMBOLS[0],SMI.DIRECTION_BOND_SYMBOLS[0]]:[SMI.DIRECTION_BOND_SYMBOLS[0],SMI.DIRECTION_BOND_SYMBOLS[1]]},_getInvertBondDirectionSymbol:function(dirSymbol){return dirSymbol===SMI.DIRECTION_BOND_SYMBOLS[1]?SMI.DIRECTION_BOND_SYMBOLS[0]:SMI.DIRECTION_BOND_SYMBOLS[1]}}),Kekule.IO.MimeType.SMILES="chemical/x-daylight-smiles",Kekule.IO.DataFormat.SMILES="smi";Kekule.IO.DataFormatsManager.register(Kekule.IO.DataFormat.SMILES,Kekule.IO.MimeType.SMILES,["smi","smiles"],Kekule.IO.ChemDataType.TEXT,"SMILES format");var suitableClasses=[Kekule.StructureFragment,Kekule.ChemObjList,Kekule.ChemStructureObjectGroup,Kekule.ChemSpaceElement,Kekule.ChemSpace];return Kekule.IO.ChemDataWriterManager.register("SMILES",Kekule.IO.SmilesMolWriter,suitableClasses,[Kekule.IO.DataFormat.SMILES]),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,DataType=__webpack_require__(0).DataType,JsonUtility=__webpack_require__(1).JsonUtility,XmlUtility=__webpack_require__(1).XmlUtility,ObjSerializerFactory=__webpack_require__(2).ObjSerializerFactory;module.exports=function(Kekule){return Kekule.globalOptions.add("IO.kekuleNative",{prettyPrint:!0}),Kekule.IO.KcjReader=Class.create(Kekule.IO.ChemDataReader,{CLASS_NAME:"Kekule.IO.KcjReader",readData:function($super,data,dataType){var jsonObj,dtype=dataType||Kekule.IO.ChemDataType.TEXT;if(dtype==Kekule.IO.ChemDataType.JSON)jsonObj=data;else{if(dtype!=Kekule.IO.ChemDataType.TEXT)return Kekule.error(Kekule.$L("ErrorMsg.KCJ_INPUT_DATATYPE_NOT_JSON_OR_TEXT")),null;jsonObj=JsonUtility.parse(data)}return $super(jsonObj,Kekule.IO.ChemDataType.JSON)},doReadData:function(data,dataType){var serializer=ObjSerializerFactory.getSerializer("json");return serializer?serializer.load(null,data,Kekule):(Kekule.error(Kekule.$L("ErrorMsg.JSON_SERIALIZER_NOT_EXISTS")),null)}}),Kekule.IO.KcjWriter=Class.create(Kekule.IO.ChemDataWriter,{CLASS_NAME:"Kekule.IO.KcjWriter",initialize:function($super,options){$super(options);var op=options||{};this.setPrettyPrint(Kekule.ObjUtils.isUnset(op.prettyPrint)?Kekule.globalOptions.IO.kekuleNative.prettyPrint:op.prettyPrint)},initProperties:function(){this.defineProp("prettyPrint",{dataType:DataType.BOOL,defaultValue:!0})},writeData:function($super,obj,dataType,format,options){var dtype=dataType||Kekule.IO.ChemDataType.TEXT;if(dtype!=Kekule.IO.ChemDataType.JSON&&dtype!=Kekule.IO.ChemDataType.TEXT)return Kekule.error(Kekule.$L("ErrorMsg.KCJ_OUTPUT_DATATYPE_NOT_JSON_OR_TEXT")),null;var result=$super(obj,Kekule.IO.ChemDataType.JSON);if(dtype==Kekule.IO.ChemDataType.JSON)return result;if(dtype==Kekule.IO.ChemDataType.TEXT){var prettyPrint=options&&Kekule.ObjUtils.notUnset(options.prettyPrint)?options.prettyPrint:this.getPrettyPrint();return JsonUtility.serializeToStr(result,{prettyPrint:prettyPrint})}},doWriteData:function(obj,dataType,format,options){var serializer=ObjSerializerFactory.getSerializer("json");if(!serializer)return Kekule.error(Kekule.$L("ErrorMsg.JSON_SERIALIZER_NOT_EXISTS")),null;var jsonObj={};return serializer.save(obj,jsonObj),jsonObj}}),Kekule.IO.KcxReader=Class.create(Kekule.IO.ChemDataReader,{CLASS_NAME:"Kekule.IO.KcxReader",readData:function($super,data,dataType){var srcElem,dtype=dataType||Kekule.IO.ChemDataType.TEXT;return dtype==Kekule.IO.ChemDataType.DOM&&(srcElem=data),dtype!=Kekule.IO.ChemDataType.TEXT?(Kekule.error(Kekule.$L("ErrorMsg.KCX_INPUT_DATATYPE_NOT_DOM_OR_TEXT")),null):(srcElem=XmlUtility.parse(data).documentElement,$super(srcElem,Kekule.IO.ChemDataType.DOM))},doReadData:function(data,dataType){var serializer=ObjSerializerFactory.getSerializer("xml");return serializer?serializer.load(null,data):(Kekule.error(Kekule.$L("ErrorMsg.XML_SERIALIZER_NOT_EXISTS")),null)}}),Kekule.IO.KcxWriter=Class.create(Kekule.IO.ChemDataWriter,{CLASS_NAME:"Kekule.IO.KcxWriter",initialize:function($super,options){$super(options);var op=options||{};this.setPrettyPrint(Kekule.ObjUtils.isUnset(op.prettyPrint)?Kekule.globalOptions.IO.kekuleNative.prettyPrint:op.prettyPrint),this.setRootTag(op.rootTag||"kcx")},initProperties:function(){this.defineProp("prettyPrint",{dataType:DataType.BOOL,defaultValue:!0}),this.defineProp("rootTag",{dataType:DataType.STRING})},writeData:function($super,obj,dataType){var dtype=dataType||Kekule.IO.ChemDataType.TEXT;if(dtype!=Kekule.IO.ChemDataType.DOM&&dtype!=Kekule.IO.ChemDataType.TEXT)return Kekule.error(Kekule.$L("ErrorMsg.KCX_OUTPUT_DATATYPE_NOT_DOM_OR_TEXT")),null;var result=$super(obj,Kekule.IO.ChemDataType.DOM);if(dtype==Kekule.IO.ChemDataType.DOM)return result;if(dtype==Kekule.IO.ChemDataType.TEXT){var options={prettyPrint:this.getPrettyPrint()};return XmlUtility.serializeNode(result,options)}},doWriteData:function(obj,dataType){var serializer=ObjSerializerFactory.getSerializer("xml");if(!serializer)return Kekule.error(Kekule.$L("ErrorMsg.XML_SERIALIZER_NOT_EXISTS")),null;var doc=XmlUtility.newDocument(this.getRootTag());return serializer.save(obj,doc.documentElement),doc.documentElement}}),function(){Kekule.IO.MimeType.KEKULE_JSON="chemical/x-kekule-json",Kekule.IO.MimeType.KEKULE_XML="chemical/x-kekule-xml",Kekule.IO.DataFormat.KEKULE_JSON="Kekule-JSON",Kekule.IO.DataFormat.KEKULE_XML="Kekule-XML",Kekule.IO.DataFormatsManager.register("JSON",Kekule.IO.MimeType.JSON,"json",Kekule.IO.ChemDataType.TEXT,"JSON format"),Kekule.IO.DataFormatsManager.register(Kekule.IO.DataFormat.KEKULE_JSON,Kekule.IO.MimeType.KEKULE_JSON,"kcj",Kekule.IO.ChemDataType.TEXT,"Kekule Chemical JSON format"),Kekule.IO.DataFormatsManager.register(Kekule.IO.DataFormat.KEKULE_XML,Kekule.IO.MimeType.KEKULE_XML,"kcx",Kekule.IO.ChemDataType.TEXT,"Kekule Chemical XML format");var jsonFmtId=Kekule.IO.DataFormatsManager.findFormatId(Kekule.IO.MimeType.JSON),kcjFmtId=Kekule.IO.DataFormatsManager.findFormatId(Kekule.IO.MimeType.KEKULE_JSON),kcxFmtId=Kekule.IO.DataFormatsManager.findFormatId(Kekule.IO.MimeType.KEKULE_XML);Kekule.IO.ChemDataReaderManager.register("json",Kekule.IO.KcjReader,jsonFmtId),Kekule.IO.ChemDataReaderManager.register("kcj",Kekule.IO.KcjReader,kcjFmtId),Kekule.IO.ChemDataReaderManager.register("kcx",Kekule.IO.KcxReader,kcxFmtId),Kekule.IO.ChemDataWriterManager.register("kcj",Kekule.IO.KcjWriter,[Kekule.ChemObject],kcjFmtId,{createOptions:{prettyPrint:!1}}),Kekule.IO.ChemDataWriterManager.register("kcx",Kekule.IO.KcxWriter,[Kekule.ChemObject],kcxFmtId,{createOptions:{prettyPrint:!0}})}(),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,ClassEx=__webpack_require__(0).ClassEx,DataType=(__webpack_require__(0).ObjectEx,__webpack_require__(0).DataType);module.exports=function(Kekule){var K=Kekule,NL=Kekule.ChemStructureNodeLabels,CM=Kekule.CoordMode;ClassEx.extend(Kekule.ChemObject,{getDefCoordPos:function(coordMode){return Kekule.Render.CoordPos.CENTER},getCoordPos:function(coordMode){var result=coordMode===Kekule.CoordMode.COORD3D?this.getPropStoreFieldValue("coordPos3D"):this.getPropStoreFieldValue("coordPos2D");return Kekule.ObjUtils.isUnset(result)&&(result=this.getDefCoordPos(coordMode)),result},getOverrideRenderOptions:function(overrideItems){if(overrideItems&&overrideItems.length){for(var result={},i=0,l=overrideItems.length;i<l;++i)result=Object.extend(result,overrideItems[i]);return result}return null},_appendOverrideRenderOptionItem:function(item,targetPropName){var targetItemArray=this.getPropStoreFieldValue(targetPropName);targetItemArray||(targetItemArray=[],this.setPropStoreFieldValue(targetPropName,targetItemArray));var index=targetItemArray.indexOf(item);return index>=0&&targetItemArray.splice(index,1),targetItemArray.push(item),this.notifyPropSet(targetPropName,targetItemArray),this},_deleteOverrideRenderOptionItem:function(item,targetPropName){var targetItemArray=this.getPropStoreFieldValue(targetPropName);if(targetItemArray){var index=targetItemArray.indexOf(item);return index>=0&&(targetItemArray.splice(index,1),this.notifyPropSet(targetPropName,targetItemArray)),this}},addOverrideRenderOptionItem:function(item){return this._appendOverrideRenderOptionItem(item,"overrideRenderOptionItems")},addOverrideRender3DOptionItem:function(item){return this._appendOverrideRenderOptionItem(item,"overrideRender3DOptionItems")},removeOverrideRenderOptionItem:function(item){return this._deleteOverrideRenderOptionItem(item,"overrideRenderOptionItems")},removeOverrideRender3DOptionItem:function(item){return this._deleteOverrideRenderOptionItem(item,"overrideRender3DOptionItems")},getOverriddenRenderOptions:function(){var result=Object.create(this.getRenderOptions()||null),overrideOptions=this.getOverrideRenderOptions(this.getOverrideRenderOptionItems());return overrideOptions&&(result=Object.extend(result,overrideOptions)),result},getOverriddenRender3DOptions:function(){var result=Object.create(this.getRender3DOptions()||null),overrideOptions=this.getOverrideRenderOptions(this.getOverrideRender3DOptionItems());return overrideOptions&&(result=Object.extend(result,overrideOptions)),result},setRenderOption:function(prop,value){var o=this.getRenderOptions();o||this.setRenderOptions({});var o=this.getRenderOptions();o[prop]!==value&&(o[prop]=value,this.notifyPropSet("renderOptions",o))},setRender3DOption:function(prop,value){var o=this.getRender3DOptions();o||this.setRender3DOptions({});var o=this.getRender3DOptions();o[prop]!==value&&(o[prop]=value,this.notifyPropSet("render3DOptions",o))},getRenderOption:function(prop){var o=this.getOverriddenRenderOptions();return o?o[prop]:void 0},getRender3DOption:function(prop){var o=this.getOverriddenRender3DOptions();return o?o[prop]:void 0},getCascadedRenderOption:function(prop){var o=this.getOverriddenRenderOptions(),result=o?o[prop]:void 0;if(Kekule.ObjUtils.isUnset(result)){var parent=this.getParent?this.getParent():null;result=parent&&parent.getCascadedRenderOption?parent.getCascadedRenderOption(prop):void 0}return result},getCascadedRender3DOption:function(prop){var o=this.getOverriddenRender3DOptions(),result=o?o[prop]:void 0;if(Kekule.ObjUtils.isUnset(result)){var parent=this.getParent?this.getParent():null;result=parent&&parent.getCascadedRender3DOption?parent.getCascadedRender3DOption(prop):void 0}return result},getBaseCoord:function(coordMode,allowCoordBorrow){var coordPos=this.getCoordPos(coordMode),result=this.getCoordOfMode?this.getCoordOfMode(coordMode,allowCoordBorrow):null;if(result&&coordPos!==Kekule.Render.CoordPos.CENTER&&coordPos===Kekule.Render.CoordPos.CORNER_TL){var box=this.getExposedContainerBox(coordMode,allowCoordBorrow),delta={x:(box.x2-box.x1)/2,y:(box.y2-box.y1)/2};coordMode===CM.COORD3D&&(delta.z=(box.z2-box.z1)/2),coordMode===CM.COORD3D?result=Kekule.CoordUtils.add(result,delta):(result.x+=delta.x,result.y-=delta.y)}return result},getBaseCoord2D:function(allowCoordBorrow){return this.getBaseCoord(Kekule.CoordMode.COORD2D,allowCoordBorrow)},getBaseCoord3D:function(allowCoordBorrow){return this.getBaseCoord(Kekule.CoordMode.COORD3D,allowCoordBorrow)},getAbsBaseCoord:function(coordMode,allowCoordBorrow){var coordPos=this.getCoordPos(coordMode),result=this.getAbsCoordOfMode?this.getAbsCoordOfMode(coordMode,allowCoordBorrow):null;if(result&&coordPos!==Kekule.Render.CoordPos.CENTER&&coordPos===Kekule.Render.CoordPos.CORNER_TL){var box=this.getExposedContainerBox(coordMode,allowCoordBorrow),delta={x:(box.x2-box.x1)/2,y:(box.y2-box.y1)/2};coordMode===CM.COORD3D&&(delta.z=(box.z2-box.z1)/2),coordMode===CM.COORD3D?result=Kekule.CoordUtils.add(result,delta):(result.x+=delta.x,result.y-=delta.y)}return result},getAbsBaseCoord2D:function(allowCoordBorrow){return this.getAbsBaseCoord(Kekule.CoordMode.COORD2D,allowCoordBorrow)},getAbsBaseCoord3D:function(allowCoordBorrow){return this.getAbsBaseCoord(Kekule.CoordMode.COORD3D,allowCoordBorrow)},setAbsBaseCoord:function(value,coordMode,allowCoordBorrow){var coordPos=this.getCoordPos(coordMode),coord=Object.extend({},value);if(value&&coordPos!==Kekule.Render.CoordPos.CENTER&&coordPos===Kekule.Render.CoordPos.CORNER_TL){var box=this.getExposedContainerBox(coordMode,allowCoordBorrow),delta={x:(box.x2-box.x1)/2,y:(box.y2-box.y1)/2};coordMode===CM.COORD3D&&(delta.z=(box.z2-box.z1)/2),coordMode===CM.COORD3D?coord=Kekule.CoordUtils.substract(coord,delta):(coord.x-=delta.x,coord.y+=delta.y)}return this.setAbsCoordOfMode?this.setAbsCoordOfMode(coord,coordMode):this.setCoordOfMode&&this.setCoordOfMode(coord,coordMode),this},setAbsBaseCoord2D:function(value,allowCoordBorrow){return this.setAbsCoordOfMode(value,Kekule.CoordMode.COORD2D,allowCoordBorrow)},setAbsBaseCoord3D:function(value,allowCoordBorrow){return this.setAbsCoordOfMode(value,Kekule.CoordMode.COORD3D,allowCoordBorrow)},getExposedAncestor:function(){var p=this.getParent();return p?p.isExpanded()?this:p.getExposedAncestor():this},isExposed:function(){var p=this.getParent();return!p||p.isExpanded()},isExpanded:function(){return!0},setExpanded:function(value){},getLinkedExposedObjs:function(){for(var result=[],i=0,l=this.getLinkedConnectorCount();i<l;++i){var connector=this.getLinkedConnectorAt(i);if(connector.isExposed())for(var objs=connector.getConnectedExposedObjs(),j=0,k=objs.length;j<k;++j)objs[j]!==this&&Kekule.ArrayUtils.pushUnique(result,objs[j])}return result},getExposedContainerBox:function(coordMode,allowCoordBorrow){return this.getContainerBox(coordMode,allowCoordBorrow)},getAllAutoScaleRefLengths:function(coordMode,allowCoordBorrow){return[]},getAllContainingConnectors:function(){return this.getAllChildConnectors?this.getAllChildConnectors():[]},getConnectorLengthMedian:function(coordMode,allowCoordBorrow){var connectors=this.getAllContainingConnectors();return Kekule.ChemStructureUtils.getConnectorLengthMedian(connectors,coordMode,allowCoordBorrow)}}),ClassEx.defineProps(Kekule.ChemObject,[{name:"coordPos2D",dataType:DataType.INT,scope:Class.PropertyScope.PUBLIC,getter:function(){return this.getCoordPos(Kekule.CoordMode.COORD2D)}},{name:"coordPos3D",dataType:DataType.INT,scope:Class.PropertyScope.PUBLIC,getter:function(){return this.getCoordPos(Kekule.CoordMode.COORD3D)}},{name:"renderOptions",dataType:DataType.OBJECT},{name:"render3DOptions",dataType:DataType.OBJECT},{name:"overrideRenderOptionItems",dataType:DataType.ARRAY,scope:Class.PropertyScope.PUBLIC},{name:"overrideRender3DOptionItems",dataType:DataType.ARRAY,scope:Class.PropertyScope.PUBLIC}]),ClassEx.extend(Kekule.ChemObjList,{getAllContainingConnectors:function(){for(var result=[],i=0,l=this.getItemCount();i<l;++i){var o=this.getItemAt(i);o.getAllContainingConnectors&&(result=result.concat(o.getAllContainingConnectors()))}return result},getAllAutoScaleRefLengths:function(coordMode,allowCoordBorrow){for(var result=[],i=0,l=this.getItemCount();i<l;++i){var o=this.getItemAt(i);o.getAllAutoScaleRefLengths&&(result=result.concat(o.getAllAutoScaleRefLengths(coordMode,allowCoordBorrow)))}return result},getExposedContainerBox:function(coordMode,allowCoordBorrow){for(var result,childObjs=this.toArray(),i=0,l=childObjs.length;i<l;++i){var obj=childObjs[i];if(obj.isExposed()){var box=obj.getExposedContainerBox?obj.getExposedContainerBox(coordMode,allowCoordBorrow):obj.getContainerBox?obj.getContainerBox(coordMode,allowCoordBorrow):null;box&&(result=result?Kekule.BoxUtils.getContainerBox(result,box):Object.extend({},box))}}return result}}),Kekule.ClassDefineUtils.addStandardCoordSupport(Kekule.ChemObjList),ClassEx.extend(Kekule.ChemSpaceElement,{getAllContainingConnectors:function(){return this.getChildren().getAllContainingConnectors()},getAllAutoScaleRefLengths:function(coordMode,allowCoordBorrow){return this.getChildren().getAllAutoScaleRefLengths(coordMode,allowCoordBorrow)}}),ClassEx.extend(Kekule.ChemSpace,{getAllContainingConnectors:function(){return this.getRoot().getAllContainingConnectors()},getAllAutoScaleRefLengths:function(coordMode,allowCoordBorrow){return this.getDefAutoScaleRefLength()?[this.getDefAutoScaleRefLength()]:this.getRoot().getAllAutoScaleRefLengths(coordMode,allowCoordBorrow)}}),ClassEx.defineProps(Kekule.ChemObject,[{name:"defAutoScaleRefLength",dataType:DataType.NUMBER,scope:Class.PropertyScope.PUBLIC}]),ClassEx.extend(Kekule.BaseStructureConnector,{getBaseCoord:function(coordMode,allowCoordBorrow){for(var M=Kekule.CoordMode,result=null,coordCount=0,sum=coordMode===M.COORD2D?{x:0,y:0}:{x:0,y:0,z:0},i=0,l=this.getConnectedObjCount();i<l;++i){var obj=this.getConnectedObjAt(i),coord=obj.getBaseCoord?obj.getBaseCoord(coordMode,allowCoordBorrow):null;coord&&(sum=Kekule.CoordUtils.add(sum,coord),++coordCount)}return coordCount&&(result=Kekule.CoordUtils.divide(sum,coordCount)),result},getAbsBaseCoord:function(coordMode,allowCoordBorrow){for(var M=Kekule.CoordMode,result=null,coordCount=0,sum=coordMode===M.COORD2D?{x:0,y:0}:{x:0,y:0,z:0},i=0,l=this.getConnectedObjCount();i<l;++i){var obj=this.getConnectedObjAt(i),coord=obj.getAbsBaseCoord?obj.getAbsBaseCoord(coordMode,allowCoordBorrow):null;coord&&(sum=Kekule.CoordUtils.add(sum,coord),++coordCount)}return coordCount&&(result=Kekule.CoordUtils.divide(sum,coordCount)),result},getConnectedExposedObjs:function(){for(var objs=this.getConnectedObjs(),result=[],i=0,l=objs.length;i<l;++i){var obj=objs[i].getExposedAncestor();result.indexOf(obj)<0&&result.push(obj)}return result},getLength:function(coordMode,allowCoordBorrow){var objs=this.getConnectedObjs();if(2!==objs.length)return null;var coord1=objs[0].getAbsBaseCoord?objs[0].getAbsBaseCoord(coordMode,allowCoordBorrow):null,coord2=objs[1].getAbsBaseCoord?objs[1].getAbsBaseCoord(coordMode,allowCoordBorrow):null;return Kekule.CoordUtils.getDistance(coord1,coord2)},getLength2D:function(allowCoordBorrow){return this.getLength(Kekule.CoordMode.COORD2D,allowCoordBorrow)},getLength3D:function(allowCoordBorrow){return this.getLength(Kekule.CoordMode.COORD3D,allowCoordBorrow)}}),ClassEx.extend(Kekule.ChemStructureConnector,{getAllAutoScaleRefLengths:function(coordMode,allowCoordBorrow){return[this.getLength(coordMode,allowCoordBorrow)]}}),ClassEx.extend(Kekule.BaseStructureNode,{getBaseCoord:function(coordMode,allowCoordBorrow){return this.getCoordOfMode(coordMode,allowCoordBorrow)},getAbsBaseCoord:function(coordMode,allowCoordBorrow){return this.getAbsCoordOfMode(coordMode,allowCoordBorrow)},getExposedContainerBox:function(coordMode,allowCoordBorrow){return this.getContainerBox(coordMode,allowCoordBorrow)},getExposedContainerBox2D:function(allowCoordBorrow){var result=this.getExposedContainerBox(Kekule.CoordMode.COORD2D,allowCoordBorrow);return result.width=result.x2-result.x1,result.height=result.y2-result.y1,result},getExposedContainerBox3D:function(allowCoordBorrow){var result=this.getExposedContainerBox(Kekule.CoordMode.COORD3D,allowCoordBorrow);return result.deltaX=result.x2-result.x1,result.deltaY=result.y2-result.y1,result.deltaZ=result.z2-result.z1,result}}),ClassEx.extend(Kekule.ChemStructureNode,{getDisplayRichText:function(hydrogenDisplayLevel,showCharge,displayLabelConfigs,partialChargeDecimalsLength,chargeMarkType,distinguishSingletAndTripletRadical){var R=Kekule.Render;Kekule.ObjUtils.isUnset(showCharge)&&(showCharge=!0);var coreItem,result=R.RichTextUtils.create(),customLabel=this.getRenderOption("customLabel");return coreItem=customLabel?R.RichTextUtils.strToRichText(customLabel):this.getCoreDisplayRichTextItem(hydrogenDisplayLevel,showCharge,displayLabelConfigs,partialChargeDecimalsLength),coreItem&&(showCharge&&(coreItem=this.appendElectronStateDisplayText(coreItem,partialChargeDecimalsLength,chargeMarkType,distinguishSingletAndTripletRadical)),coreItem&&(R.RichTextUtils.append(result,coreItem),result.anchorItem=coreItem)),result},getCoreDisplayRichTextItem:function(hydrogenDisplayLevel,showCharge,displayLabelConfigs,partialChargeDecimalsLength){return null},appendElectronStateDisplayText:function(coreItem,partialChargeDecimalsLength,chargeMarkType,distinguishSingletAndTripletRadical){var R=Kekule.Render,charge=this.getCharge(),radical=this.getRadical(),section=R.ChemDisplayTextUtils.createElectronStateDisplayTextSection(charge,radical,partialChargeDecimalsLength,chargeMarkType,distinguishSingletAndTripletRadical);if(section){var group=R.RichTextUtils.createGroup();return R.RichTextUtils.append(group,coreItem),R.RichTextUtils.append(group,section),group.charDirection=Kekule.Render.TextDirection.LTR,group.anchorItem=coreItem,group}return coreItem}}),ClassEx.extend(Kekule.AbstractAtom,{getDisplayRichText:function($super,hydrogenDisplayLevel,showCharge,displayLabelConfigs,partialChargeDecimalsLength,chargeMarkType,distinguishSingletAndTripletRadical){var R=Kekule.Render;hydrogenDisplayLevel||(hydrogenDisplayLevel=R.HydrogenDisplayLevel.DEFAULT);var result=$super(hydrogenDisplayLevel,showCharge,displayLabelConfigs,partialChargeDecimalsLength,chargeMarkType,distinguishSingletAndTripletRadical),hcount=0;switch(hydrogenDisplayLevel){case R.HydrogenDisplayLevel.NONE:hcount=0;break;case R.HydrogenDisplayLevel.ALL:hcount=this.getHydrogenCount();break;case R.HydrogenDisplayLevel.EXPLICIT:hcount=this.getExplicitHydrogenCount();break;case R.HydrogenDisplayLevel.UNMATCHED_EXPLICIT:this.getImplicitHydrogenCount&&this.getImplicitHydrogenCount()!==this.getExplicitHydrogenCount()&&(hcount=this.getExplicitHydrogenCount())}return hcount&&(result=this.appendHydrogenDisplayText(result,hcount)),result},appendHydrogenDisplayText:function(richText,hcount){var R=Kekule.Render;if(hcount)if(hcount>1){var group=R.RichTextUtils.createGroup();group.charDirection=Kekule.Render.TextDirection.LTR;var item=R.RichTextUtils.appendText2(group,"H");R.RichTextUtils.appendText(group,hcount.toString(),{textType:R.RichText.SUB,refItem:item}),R.RichTextUtils.append(richText,group)}else R.RichTextUtils.appendText(richText,"H");return richText}}),ClassEx.extend(Kekule.Atom,{getCoreDisplayRichTextItem:function(hydrogenDisplayLevel,showCharge,displayLabelConfigs,partialChargeDecimalsLength){var R=Kekule.Render,result=R.RichTextUtils.createGroup(),isotopeAlias=this.getIsotopeAlias();this.getSymbol();if(isotopeAlias||this.getSymbol()!==K.Element.UNSET_ELEMENT){var section;isotopeAlias&&Kekule.ChemStructureNodeLabels.ENABLE_ISOTOPE_ALIAS?(section=R.RichTextUtils.createSection(this.getIsotopeAlias(),{charDirection:Kekule.Render.TextDirection.LTR}),result=R.RichTextUtils.append(result,section),result.anchorItem=section):(section=R.RichTextUtils.createSection(this.getSymbol(),{charDirection:Kekule.Render.TextDirection.LTR}),result=R.RichTextUtils.append(result,section),result.anchorItem=section,this.getMassNumber()!==Kekule.Isotope.UNSET_MASSNUMBER&&(result=R.RichTextUtils.insertText(result,0,this.getMassNumber().toString(),{textType:R.RichText.SUP,charDirection:Kekule.Render.TextDirection.LTR,refItem:result.anchorItem}),result.charDirection=Kekule.Render.TextDirection.LTR))}else result=R.RichTextUtils.appendText(result,displayLabelConfigs&&displayLabelConfigs.getUnsetElement()||NL.UNSET_ELEMENT);return result}}),ClassEx.extend(Kekule.Pseudoatom,{getCoreDisplayRichTextItem:function(hydrogenDisplayLevel,showCharge,displayLabelConfigs,partialChargeDecimalsLength){var s,R=Kekule.Render,D=displayLabelConfigs;return s=this.getLabel(),s||(s=D&&D.getUnsetElement()||NL.UNSET_ELEMENT),R.RichTextUtils.createSection(s,{charDirection:Kekule.Render.TextDirection.LTR})}});var appendIsotopeIdToRichText=function(richText,isotopeId,isAnchor){var massSection,R=Kekule.Render,detail=Kekule.IsotopesDataUtil.getIsotopeIdDetail(isotopeId);detail.massNumber&&(massSection=R.RichTextUtils.appendText2(richText,detail.massNumber.toString(),{textType:Kekule.Render.RichText.SUP,charDirection:Kekule.Render.TextDirection.LTR}));var symbolSection=R.RichTextUtils.appendText2(richText,detail.symbol,{charDirection:Kekule.Render.TextDirection.LTR},isAnchor);return massSection&&(massSection.refItem=symbolSection),richText.charDirection=Kekule.Render.TextDirection.LTR,richText};return ClassEx.extend(Kekule.VariableAtom,{getCoreDisplayRichTextItem:function(hydrogenDisplayLevel,showCharge,displayLabelConfigs,partialChargeDecimalsLength){var result,R=Kekule.Render,D=displayLabelConfigs;if(this.isListEmpty())return result=R.RichTextUtils.strToRichText(D&&D.getVariableAtom()||NL.VARIABLE_ATOM),result.charDirection=Kekule.Render.TextDirection.LTR,result;var isotopeIds=this.getAllowedIsotopeIds()||this.getDisallowedIsotopeIds(),isDisallowed=this.isDisallowedList();if(result=R.RichTextUtils.createGroup(),result.charDirection=Kekule.Render.TextDirection.LTR,isDisallowed&&(result=R.RichTextUtils.appendText(result,D.getIsoListDisallowPrefix())),result=R.RichTextUtils.appendText(result,D.getIsoListLeadingBracket()),isotopeIds&&isotopeIds.length)for(var i=0,l=isotopeIds.length;i<l;++i){var id=isotopeIds[i];id&&(0!=i&&(result=R.RichTextUtils.appendText(result,D.getIsoListDelimiter())),result=appendIsotopeIdToRichText(result,id,0==i))}return result=R.RichTextUtils.appendText(result,D.getIsoListTailingBracket())}}),ClassEx.extend(Kekule.StructureConnectionTable,{exposedNodesHasCoord2D:function(allowCoordBorrow){for(var nodes=this.getExposedNodes(),i=0,l=nodes.length;i<l;++i)if(nodes[i].hasCoord2D(allowCoordBorrow))return!0;return!1},exposedNodesHasCoord3D:function(allowCoordBorrow){for(var nodes=this.getExposedNodes(),i=0,l=nodes.length;i<l;++i)if(nodes[i].hasCoord3D(allowCoordBorrow))return!0;return!1},getExposedNodes:function(){for(var result=[],nodes=this.getNodes(),i=0,l=nodes.length;i<l;++i){var node=nodes[i];if(node.getExposedNodes&&node.isExpanded()){var subNodes=node.getExposedNodes();result=result.concat(subNodes)}else node.isExposed()&&result.push(node)}return result},getExposedConnectors:function(){for(var result=this.getConnectors(),nodes=this.getNodes(),i=0,l=nodes.length;i<l;++i){var node=nodes[i];if(node.getConnectors&&node.isExpanded()){var subConnectors=node.getExposedConnectors();result=result.concat(subConnectors)}}return result},getExposedContainerBox:function(coordMode,allowCoordBorrow){var nodes=this.getExposedNodes();return nodes.length?this.getNodesContainBox(nodes,coordMode,allowCoordBorrow):null},getExposedContainerBox2D:function(allowCoordBorrow){var result=this.getExposedContainerBox(Kekule.CoordMode.COORD2D,allowCoordBorrow);return result.width=result.x2-result.x1,result.height=result.y2-result.y1,result},getExposedContainerBox3D:function(allowCoordBorrow){var result=this.getExposedContainerBox(Kekule.CoordMode.COORD3D,allowCoordBorrow);return result.deltaX=result.x2-result.x1,result.deltaY=result.y2-result.y1,result.deltaZ=result.z2-result.z1,result},getConnectorLengthMedian:function(coordMode,allowCoordBorrow){var connectors=this.getAllContainingConnectors();return Kekule.ChemStructureUtils.getConnectorLengthMedian(connectors,coordMode,allowCoordBorrow)},getAllAutoScaleRefLengths:function(coordMode,allowCoordBorrow){for(var connectors=this.getAllContainingConnectors(),result=[],i=0,l=connectors.length;i<l;++i){var connector=connectors[i];if(connector&&connector.getAllAutoScaleRefLengths){var lengths=connector.getAllAutoScaleRefLengths(coordMode,allowCoordBorrow);lengths&&(result=result.concat(lengths))}}return result}}),ClassEx.extend(Kekule.ContentBlock,{getDefCoordPos:function($super,coordMode){return coordMode!==CM.COORD3D?Kekule.Render.CoordPos.CORNER_TL:$super(coordMode)}}),ClassEx.extend(Kekule.ChemMarker.ChemPropertyMarker,{getDefCoordPos:function($super,coordMode){return coordMode!==CM.COORD3D?Kekule.Render.CoordPos.CENTER:$super(coordMode)}}),ClassEx.extend(Kekule.StructureFragment,{isExpanded:function(){var o=this.getOverriddenRenderOptions();return!!o&&!!o.expanded},setExpanded:function(value){this.setRenderOption("expanded",value)},getExposedNodes:function(){return this.hasCtab()?this.getCtab().getExposedNodes():[]},getExposedConnectors:function(){return this.hasCtab()?this.getCtab().getExposedConnectors():[]},exposedNodesHasCoord2D:function(allowCoordBorrow){return!!this.hasCtab()&&this.getCtab().exposedNodesHasCoord2D(allowCoordBorrow)},exposedNodesHasCoord3D:function(allowCoordBorrow){return!!this.hasCtab()&&this.getCtab().exposedNodesHasCoord3D(allowCoordBorrow)},getExposedContainerBox:function(coordMode,allowCoordBorrow){if(this.hasCtab()){var box=this.getCtab().getExposedContainerBox(coordMode,allowCoordBorrow);return box||(box=this.getContainerBox(coordMode,allowCoordBorrow)),box}return this.getContainerBox(coordMode,allowCoordBorrow)},getConnectorLengthMedian:function(coordMode,allowCoordBorrow){return this.hasCtab()?this.getCtab().getConnectorLengthMedian(coordMode,allowCoordBorrow):null},getAutoScaleRefLength:function(coordMode,allowCoordBorrow){return this.getConnectorLengthMedian(coordMode,allowCoordBorrow)},getAllAutoScaleRefLengths:function(coordMode,allowCoordBorrow){return this.hasCtab()?this.getCtab().getAllAutoScaleRefLengths(coordMode,allowCoordBorrow):null}}),ClassEx.extend(Kekule.SubGroup,{getCoreDisplayRichTextItem:function(hydrogenDisplayLevel,showCharge,displayLabelConfigs,partialChargeDecimalsLength){var R=Kekule.Render,formula=null,caption=this.getAbbr();caption||(formula=this.getFormulaText()?Kekule.FormulaUtils.textToFormula(this.getFormulaText()):this.getFormula(!1)||this.calcFormula())&&!formula.isEmpty()||(caption=displayLabelConfigs&&displayLabelConfigs.getRgroup()||NL.SUBGROUP);var result;if(caption)if(caption.length<=3)result=R.RichTextUtils.createSection(caption),result.charDirection=Kekule.Render.TextDirection.LTR;else{var anchorIndex=this._indexOfFirstUppercaseLetter(caption);anchorIndex<0&&(anchorIndex=0),result=R.RichTextUtils.createGroup(),result.charDirection=Kekule.Render.TextDirection.LTR,anchorIndex>0&&(section=R.RichTextUtils.createSection(caption.substring(0,anchorIndex)),section.charDirection=Kekule.Render.TextDirection.INHERIT,result=R.RichTextUtils.append(result,section));var section=R.RichTextUtils.createSection(caption.charAt(anchorIndex));result=R.RichTextUtils.append(result,section),result.anchorItem=section,anchorIndex<caption.length-1&&(section=R.RichTextUtils.createSection(caption.substring(anchorIndex+1)),section.charDirection=Kekule.Render.TextDirection.INHERIT,result=R.RichTextUtils.append(result,section))}else if(formula){result=formula.getDisplayRichText(showCharge,displayLabelConfigs,partialChargeDecimalsLength);var section=R.RichTextUtils.getFirstNormalTextSection(result);section||(section=result.items[0]),result.anchorItem=section}return result},_indexOfFirstUppercaseLetter:function(str){for(var i=0,l=str.length;i<l;++i){var sChar=str.charAt(i);if(sChar>="A"&&sChar<="Z")return i}return-1},_autoSetSelfCoord:function(coordMode,allowCoordBorrow){if(!this._isAutoSettingSelfCoord&&!this.getCoordOfMode(coordMode,allowCoordBorrow)){var count=this.getAnchorNodeCount();if(!(count<=0)){this.beginUpdate();try{this._isAutoSettingSelfCoord=!0;for(var coordSum={},i=0;i<count;++i){var node=this.getAnchorNodeAt(i);node._autoSetSelfCoord&&node._autoSetSelfCoord(coordMode,allowCoordBorrow);var coord=node.getAbsCoordOfMode(coordMode,allowCoordBorrow);coord&&(coordSum=Kekule.CoordUtils.add(coordSum,coord))}var newCoord=Kekule.CoordUtils.divide(coordSum,count);this.setAbsCoordOfMode(newCoord,coordMode);for(var coordDelta=this.getCoordOfMode(coordMode)||{},count=this.getNodeCount(),i=0;i<count;++i){var node=this.getNodeAt(i),coord=node.getCoordOfMode(coordMode,allowCoordBorrow);coord&&(coord=Kekule.CoordUtils.substract(coord,coordDelta),node.setCoordOfMode(coord,coordMode))}}finally{this._isAutoSettingSelfCoord=!1,this.endUpdate()}}}},doGetAbsCoord2D:function($super,allowCoordBorrow){return this._autoSetSelfCoord(Kekule.CoordMode.COORD2D,allowCoordBorrow),$super(allowCoordBorrow)},doGetAbsCoord3D:function($super,allowCoordBorrow){return this._autoSetSelfCoord(Kekule.CoordMode.COORD3D,allowCoordBorrow),$super(allowCoordBorrow)},doSetAbsCoord2D:function($super,value){return this._autoSetSelfCoord(Kekule.CoordMode.COORD2D),$super(value)},doSetAbsCoord3D:function($super,value){return this._autoSetSelfCoord(Kekule.CoordMode.COORD3D),$super(value)}}),ClassEx.extend(Kekule.MolecularFormula,{getDisplayRichText:function(showCharge,displayLabelConfigs,partialChargeDecimalsLength,chargeMarkType,distinguishSingletAndTripletRadical){var R=Kekule.Render;return Kekule.ObjUtils.isUnset(showCharge)&&(showCharge=!0),R.ChemDisplayTextUtils.formulaToRichText(this,showCharge,null,partialChargeDecimalsLength,displayLabelConfigs,chargeMarkType,distinguishSingletAndTripletRadical)},getDisplayText:function(showCharge,displayLabelConfigs,partialChargeDecimalsLength){var richText=this.getDisplayRichText();return Kekule.Render.RichTextUtils.toText(richText)}}),ClassEx.extend(Kekule.Molecule,{afterInitialization:function(){this.setExpanded(!0)}}),ClassEx.extend(Kekule.CompositeMolecule,{getExposedContainerBox:function(coordMode,allowCoordBorrow){var result=null,subMols=this.getPropStoreFieldValue("subMolecules");if(subMols)for(var i=0,l=subMols.length;i<l;++i){var mol=subMols[i],box=mol.getExposedContainerBox(coordMode,allowCoordBorrow);box&&(result=result?Kekule.BoxUtils.getContainerBox(result,box):Object.extend({},box))}return result},getAllAutoScaleRefLengths:function(coordMode,allowCoordBorrow){var result=[],subMols=this.getPropStoreFieldValue("subMolecules");if(subMols)for(var i=0,l=subMols.getItemCount();i<l;++i){var mol=subMols.getObjAt(i),lens=mol.getAllAutoScaleRefLengths(coordMode,allowCoordBorrow);lens&&(result=result.concat(lens))}return result}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,ObjectEx=__webpack_require__(0).ObjectEx,DataType=__webpack_require__(0).DataType;module.exports=function(Kekule){return Kekule.Render={},Kekule.Render.CoordSystem={CHEM:0,CONTEXT:1,SCREEN:2},Kekule.Render.RendererType={R2D:2,R3D:3},Kekule.Render.CoordPos={CENTER:0,CORNER_TL:21,DEFAULT:0},Kekule.Render.DEF_ATOM_ATOMIC_NUM=6,Kekule.Render.MoleculeDisplayType={SKELETAL:1,CONDENSED:2,DEFAULT:1},Kekule.Render.Molecule2DDisplayType=Kekule.Render.MoleculeDisplayType,Kekule.Render.NodeLabelDisplayMode={HIDDEN:-1,SHOWN:1,SMART:0,DEFAULT:0},Kekule.Render.HydrogenDisplayLevel={NONE:0,EXPLICIT:1,UNMATCHED_EXPLICIT:2,ALL:10,DEFAULT:1},Kekule.Render.TextDirection={DEFAULT:0,LTR:1,RTL:3,TTB:2,BTT:4,INHERIT:10},Kekule.Render.TextAlign={DEFAULT:0,LEFT:1,RIGHT:2,TOP:3,BOTTOM:4,CENTER:5,LEADING:10,TRAILING:11,getAbsAlign:function(textAlign,textDirection){var result=textAlign,TA=Kekule.Render.TextAlign,TD=Kekule.Render.TextDirection;if(textAlign===TA.LEADING||textAlign===TA.TRAILING){var isLeading=textAlign==TA.LEADING;switch(textDirection){case TD.RTL:result=isLeading?TA.RIGHT:TA.LEFT;break;case TD.TTB:result=isLeading?TA.TOP:TA.BOTTOM;break;case TD.BTT:result=isLeading?TA.BOTTOM:TA.TOP;break;case TD.LTR:default:result=isLeading?TA.LEFT:TA.RIGHT}}return result}},Kekule.Render.BoxXAlignment={LEFT:0,RIGHT:1,CENTER:2},Kekule.Render.BoxYAlignment={TOP:0,BOTTOM:1,CENTER:2},Kekule.Render.TextBoxAlignmentMode={BOX:0,ANCHOR:1},Kekule.Render.BondRenderType={SINGLE:0,DOUBLE:1,TRIPLE:2,QUAD:3,DASHED:4,DASHED_DOUBLE:5,DASHED_TRIPLE:6,SOLID_DASH:7,ARROWED:8,ARROWED_INV:9,HASHED:10,BOLD:11,BOLD_DOUBLE:12,BOLD_TRIPLE:13,BOLD_QUAD:14,BOLD_DASH:16,WEDGED_SOLID:20,WEDGED_SOLID_INV:21,WEDGED_HOLLOW:22,WEDGED_HOLLOW_INV:23,WEDGED_HASHED:24,WEDGED_HASHED_INV:25,WEDGED_SOLID_BOTH:26,WEDGED_HOLLOW_BOTH:27,WAVY:30,SCISSORS_DOUBLE:40},Kekule.Render.ChargeMarkRenderType={NUM_WITH_SYMBOL:1,DEFAULT:1,CIRCLE_AROUND:3},Kekule.Render.Render3DGraphicQuality={EXTREME_LOW:1,LOW:2,MEDIUM:3,HIGH:4,EXTREME_HIGH:5},Kekule.Render.Molecule3DDisplayType={WIRE:31,STICKS:32,BALL_STICK:33,SPACE_FILL:34,DEFAULT:33},Kekule.Render.Bond3DRenderMode={NONE:0,WIRE:1,MULTI_WIRE:2,CYLINDER:3,MULTI_CYLINDER:4,isWireMode:function(mode){var M=Kekule.Render.Bond3DRenderMode;return mode===M.WIRE||mode===M.MULTI_WIRE},isCylinderMode:function(mode){var M=Kekule.Render.Bond3DRenderMode;return mode===M.CYLINDER||mode===M.MULTI_CYLINDER}},Kekule.Render.Bond3DSpliceMode={UNSPLIT:1,MID_SPLIT:2,WEIGHTING_SPLIT:3},Kekule.Render.Bond3DRenderType={SINGLE:1,DOUBLE:2,TRIPLE:3,DASH:-1,SOLID_DASH:-2},Kekule.Render.Node3DRenderMode={NONE:0,BALL:1,SPACE:2},Kekule.Render.MetaShapeType={POINT:0,CIRCLE:1,LINE:2,RECT:3,POLYGON:10,SPHERE:101,CYLINDER:102,COMPOSITE:-1},Kekule.Render.BoundShapeType=Kekule.Render.MetaShapeType,Kekule.Render.ObjectUpdateType={MODIFY:0,ADD:1,REMOVE:2,CLEAR:3},Kekule.Render.AbstractRenderer=Class.create(ObjectEx,{CLASS_NAME:"Kekule.Render.AbstractRenderer",RENDER_CACHE_FIELD:"__$renderCache$__",initialize:function($super,chemObj,drawBridge,parent){$super(),this.setPropValue("chemObj",chemObj,!0),parent&&this.setParent(parent),this.setDrawBridge(drawBridge),this.setBubbleEvent(!0),this._suspendUpdateStatus=0,this._suspendUpdateInfos=[]},finalize:function($super){this.setPropValue("chemObj",null,!0),this.setDrawBridge(null),$super()},initProperties:function(){this.defineProp("chemObj",{dataType:"Kekule.ChemObject",serializable:!1,setter:null}),this.defineProp("drawBridge",{dataType:DataType.OBJECT,serializable:!1}),this.defineProp("parent",{dateType:DataType.OBJECT,serializable:!1}),this.defineProp("parentRenderer",{dateType:"Kekule.Render.AbstractRenderer",serializable:!1,getter:function(){var p=this.getParent();return p instanceof Kekule.Render.AbstractRenderer?p:null},setter:function(value){this.setParent(value)}}),this.defineProp("redirectContext",{dataType:DataType.OBJECT,serializable:!1}),this.defineProp("canModifyTargetObj",{dataType:DataType.BOOL,serializable:!1,getter:function(){var result=this.getPropStoreFieldValue("canModifyTargetObj");if(Kekule.ObjUtils.isUnset(result)){var p=this.getParent();p&&p.getCanModifyTargetObj&&(result=p.getCanModifyTargetObj())}return result}}),this.defineEvent("clear"),this.defineEvent("updateBasicDrawObject")},isRootRenderer:function(){return!this.getParentRenderer()},getHigherLevelObj:function(){return this.getParent()},getRendererType:function(){return Kekule.Render.RendererType.R2D},getCoordMode:function(){return this.getRendererType()===Kekule.Render.RendererType.R3D?Kekule.CoordMode.COORD3D:Kekule.CoordMode.COORD2D},getRenderCache:function(context){var result=this.getExtraProp(context,this.RENDER_CACHE_FIELD);return result||(result={},this.setExtraProp(context,this.RENDER_CACHE_FIELD,result)),result},beginDraw:function(context,baseCoord,options){var b=this.getDrawBridge();b.prepareContext&&b.prepareContext(context)},endDraw:function(context,baseCoord,options){var b=this.getDrawBridge();b.renderContext&&b.renderContext(context)},updateDrawInfoInCache:function(chemObj,context,baseCoord,options,realDrawOptions){var p=this.getRenderCache(context);context&&(p.context=context),baseCoord&&(p.baseCoord=baseCoord),chemObj&&(p.chemObj=chemObj),options&&(p.options=options),realDrawOptions&&(p.realDrawOptions=realDrawOptions)},_isCurrChemObjNeedToBeDrawn:function(partialDrawObjs,context){for(var selfObj=this.getChemObj(),i=0,l=partialDrawObjs.length;i<l;++i){var obj=partialDrawObjs[i];if(obj===selfObj||obj.isChildOf(selfObj))return!0}return!1},getAutoBaseCoord:function(drawOptions){return this.doGetAutoBaseCoord(drawOptions)},doGetAutoBaseCoord:function(drawOptions){return null},getCachedDrawOptions:function(context){return this.getRenderCache(context).options},getCachedDrawnElem:function(context){return this.getRenderCache(context).drawnElem},draw:function(context,baseCoord,options){try{this.__isDrawing=!0;var parentOps,ops={},parent=this.getParentRenderer();if(parent)var parentOps=parent.getRenderCache().options;parentOps?(ops=Object.create(parentOps),ops=Object.extend(ops,options)):ops=Object.create(options||null);var chemObj=this.getChemObj(),partialDrawObjs=ops.partialDrawObjs;if(partialDrawObjs&&!this._isCurrChemObjNeedToBeDrawn(partialDrawObjs,context))return null;var renderOptionsGetter=this.getRendererType()===Kekule.Render.RendererType.R3D?"getRender3DOptions":"getRenderOptions",localOps=chemObj[renderOptionsGetter]?chemObj[renderOptionsGetter]():null;renderOptionsGetter=this.getRendererType()===Kekule.Render.RendererType.R3D?"getOverriddenRender3DOptions":"getOverriddenRenderOptions";var localOverrideOps=chemObj[renderOptionsGetter]?chemObj[renderOptionsGetter]():null;ops=Kekule.Render.RenderOptionUtils.mergeRenderOptions(localOps||{},ops),this.getRenderCache().options=ops,ops=Kekule.Render.RenderOptionUtils.mergeRenderOptions(localOverrideOps||{},ops),this.updateDrawInfoInCache(this.getChemObj(),context,baseCoord,options,ops);var isRoot=this.isRootRenderer();this.invokeEvent("prepareDrawing",{context:context,obj:this.getChemObj()}),isRoot&&this.beginDraw(context,baseCoord,ops);var result=this.doDraw(context,baseCoord,ops);this.getRenderCache(context).drawnElem=result,isRoot&&this.endDraw(context,baseCoord,ops),this.invokeEvent("draw",{context:context,obj:this.getChemObj()})}finally{this.__isDrawing=!1}return result},doDraw:function(context,baseCoord,options){return this.doDrawSelf(context,baseCoord,options)},doDrawSelf:function(context,baseCoord,options){return null},redraw:function(context){var isRoot=this.isRootRenderer();if(isRoot){var cache=this.getRenderCache(context)||{};this.beginDraw(context,cache.baseCoord,cache.options)}var result=this.doRedraw(context);return this.getRenderCache(context).drawnElem=result,isRoot&&this.endDraw(context,cache.baseCoord,cache.options),result},doRedraw:function(context){var p=this.getRenderCache(context);return this.draw(context,p.baseCoord,p.options)},canModifyGraphic:function(context){var b=this.getDrawBridge();return!!b.canModifyGraphic&&b.canModifyGraphic(context)},beginUpdateRenderer:function(){++this._suspendUpdateStatus},endUpdateRenderer:function(){--this._suspendUpdateStatus,this._suspendUpdateStatus<=0&&(this._suspendUpdateStatus=0),this.isUpdatingRenderer()||this.doEndUpdateRenderer()},doEndUpdateRenderer:function(){this.updateEx(this._suspendUpdateInfos),this._suspendUpdateInfos=[]},isUpdatingRenderer:function(){return this._suspendUpdateStatus>0},updateEx:function(updateInfos){var result=!0;if(this.isUpdatingRenderer())return this._suspendUpdateInfos||(this._suspendUpdateInfos=[]),this._mergeRendererUpdateInfo(this._suspendUpdateInfos,updateInfos),!0;if(!this.canModifyGraphic(context)){if(this.isRootRenderer()){for(var contexts=[],i=0,l=updateInfos.length;i<l;++i){var info=updateInfos[i],context=info.context;Kekule.ArrayUtils.pushUnique(contexts,context)}for(var i=0,l=contexts.length;i<l;++i){this.getDrawBridge().clearContext(context);var cache=this.getRenderCache(context);this.draw(context,cache.baseCoord,cache.options)}return!0}return this.getParentRenderer().updateEx(updateInfos)}for(var i=0,l=updateInfos.length;i<l;++i){for(var info=updateInfos[i],context=info.context,j=0,k=info.items.length;j<k;++j){var item=info.items[j];if(!(result=result&&this.doUpdate(context,item.updatedObjDetails,item.updateType)))break}if(!result)break}return result},_mergeRendererUpdateInfo:function(dest,src){for(var i=0,l=src.length;i<l;++i){var info=src[i],index=this._indexOfContextInRendererUpdateInfos(info.context,dest);if(index<0)dest.push(info);else{var old=dest[index];old.items=old.items.concat(info.items)}}return dest},_indexOfContextInRendererUpdateInfos:function(context,infos){for(var i=0,l=infos.length;i<l;++i){if(infos[i].context===context)return i}return-1},update:function(context,updatedObjDetails,updateType){for(var objDetails=[],i=0,l=updatedObjDetails.length;i<l;++i){var obj=updatedObjDetails[i].obj;this.isChemObjRenderedBySelf(context,obj)&&objDetails.push(updatedObjDetails[i])}return!objDetails.length||this.updateEx([{context:context,items:[{updateType:updateType,updatedObjDetails:objDetails}]}])},doUpdate:function(context,updateObjDetails,updateType){return this.doUpdateSelf(context,updateObjDetails,updateType)},doUpdateSelf:function(context,updatedObjDetails,updateType){if(this.canModifyGraphic(context)){for(var redrawSelf=!1,chemObj=this.getChemObj(),i=0,l=updatedObjDetails.length;i<l;++i){if(updatedObjDetails[i].obj===chemObj){redrawSelf=!0;break}}if(redrawSelf){if(updateType===Kekule.Render.ObjectUpdateType.CLEAR)return this.doClear(context);this.doClear(context);var p=this.getRenderCache(context);return this.draw(context,p.baseCoord,p.options)}}return!1},_extractObjsOfUpdateObjDetails:function(updatedObjDetails){return Kekule.Render.UpdateObjUtils._extractObjsOfUpdateObjDetails(updatedObjDetails)},_createUpdateObjDetailsFromObjs:function(updatedObjs){return Kekule.Render.UpdateObjUtils._createUpdateObjDetailsFromObjs(updatedObjs)},addNew:function(context,updatedObjs){var details=this._createUpdateObjDetailsFromObjs(updatedObjs);return this.update(context,details,Kekule.Render.ObjectUpdateType.ADD)},modify:function(context,updatedObjDetails){return this.update(context,updatedObjDetails,Kekule.Render.ObjectUpdateType.MODIFY)},remove:function(context,removedObjs){var details=this._createUpdateObjDetailsFromObjs(removedObjs);return this.update(context,details,Kekule.Render.ObjectUpdateType.REMOVE)},clear:function(context){this.doClear(context);this.invokeEvent("clear",{context:context,obj:this.getChemObj()})},doClear:function(context){return!!this.canModifyGraphic()&&this.doClearSelf(context)},doClearSelf:function(context){if(!this.canModifyGraphic())return!1;var drawnElem=this.getRenderCache(context).drawnElem;if(drawnElem)try{this.getDrawBridge().removeDrawnElem(context,drawnElem)}catch(e){}this.getRenderCache(context).drawnElem=null},estimateObjBox:function(context,options,allowCoordBorrow){var box=this.doEstimateObjBox(context,options,allowCoordBorrow);return box&&(box=this._fillBoxDefaultValue(box,this.getRendererType())),box},doEstimateObjBox:function(context,options,allowCoordBorrow){return this.doEstimateSelfObjBox(context,options,allowCoordBorrow)},doEstimateSelfObjBox:function(context,options,allowCoordBorrow){return null},estimateRenderBox:function(context,baseCoord,options,allowCoordBorrow){var box=this.doEstimateRenderBox(context,baseCoord,options,allowCoordBorrow);return box&&(box=this._fillBoxDefaultValue(box,this.getRendererType())),box},doEstimateRenderBox:function(context,baseCoord,options,allowCoordBorrow){return null},_fillBoxDefaultValue:function(box,rendererType){box||(box={});var is3D=rendererType===Kekule.Render.RendererType.R3D,r={x1:box.x1||0,x2:box.x2||0,y1:box.y1||0,y2:box.y2||0};return is3D&&(r.z1=box.z1||0,r.z2=box.z2||0),r},transformCoordToObj:function(context,chemObj,coord){return this.doTransformCoordToObj(context,chemObj,coord)},doTransformCoordToObj:function(context,chemObj,coord){return coord},transformCoordToContext:function(context,chemObj,coord){return this.doTransformCoordToContext(context,chemObj,coord)},doTransformCoordToContext:function(context,chemObj,coord){return coord},transformContextCoordToScreen:function(context,coord){return this.doTransformContextCoordToScreen(context,coord)},doTransformContextCoordToScreen:function(context,coord){var b=this.getDrawBridge();return b&&b.transformContextCoordToScreen?b.transformContextCoordToScreen(context,coord):coord},basicDrawObjectUpdated:function(context,obj,parentObj,boundInfo,updateType){this.invokeEvent("updateBasicDrawObject",{context:context,obj:obj,parentObj:parentObj,boundInfo:boundInfo,updateType:updateType})},isChemObjRenderedBySelf:function(context,obj){return obj===this.getRenderCache(context).chemObj},isChemObjRenderedDirectlyBySelf:function(context,obj){return!(!obj||!this.getRenderCache(context).chemObj)&&obj===this.getRenderCache(context).chemObj},createBoundInfo:function(boundType,coords,additionalInfos){return Kekule.Render.MetaShapeUtils.createShapeInfo(boundType,coords,additionalInfos)},createPointBoundInfo:function(coord){return this.createBoundInfo(Kekule.Render.BoundShapeType.POINT,[coord])},createCircleBoundInfo:function(coord,radius){return this.createBoundInfo(Kekule.Render.BoundShapeType.CIRCLE,[coord],{radius:radius})},createLineBoundInfo:function(coord1,coord2,width){return this.createBoundInfo(Kekule.Render.BoundShapeType.LINE,[coord1,coord2],{width:width})},createRectBoundInfo:function(coord1,coord2){return this.createBoundInfo(Kekule.Render.BoundShapeType.RECT,[coord1,coord2])},createSphereBoundInfo:function(coord,radius){return this.createBoundInfo(Kekule.Render.BoundShapeType.SPHERE,[coord],{radius:radius})},createCylinderBoundInfo:function(coord1,coord2,radius){return this.createBoundInfo(Kekule.Render.BoundShapeType.CYLINDER,[coord1,coord2],{radius:radius})}}),Kekule.ClassDefineUtils.addExtraObjMapSupport(Kekule.Render.AbstractRenderer),Kekule.Render.DummyRenderer=Class.create(Kekule.Render.AbstractRenderer,{CLASS_NAME:"Kekule.Render.DummyRenderer",draw:function(context,baseCoord,options){},redraw:function(context){}}),Kekule.Render.CompositeRenderer=Class.create(Kekule.Render.AbstractRenderer,{CLASS_NAME:"Kekule.Render.CompositeRenderer",initProperties:function(){this.defineProp("targetChildObjs",{dataType:DataType.ARRAY,serializable:!1}),this.defineProp("childRendererMap",{dataType:DataType.OBJECT,serializable:!1,getter:function(){var result=this.getPropStoreFieldValue("childRendererMap");return result||(result=new Kekule.MapEx(!0),this.setPropStoreFieldValue("childRendererMap",result)),result}})},finalize:function($super){this.reset(),$super()},doEstimateObjBox:function($super,context,options,allowCoordBorrow){for(var result=$super(context,options,allowCoordBorrow),renderers=this.prepareChildRenderers(),BU=Kekule.BoxUtils,i=0,l=renderers.length;i<l;++i){var r=renderers[i];if(r){var b=r.estimateObjBox(context,options,allowCoordBorrow);b&&(result=result?BU.getContainerBox(result,b):Object.extend({},b))}}return result},isChemObjRenderedBySelf:function($super,context,obj){var result=$super(context,obj);if(!result)for(var childRenderers=this.getChildRenderers(),i=0,l=childRenderers.length;i<l;++i){var r=childRenderers[i];if(r.isChemObjRenderedBySelf(context,obj))return!0}if(!result){this.refreshChildObjs();var objs=this.getTargetChildObjs();result=objs&&objs.indexOf(obj)>=0}return result},isChemObjRenderedDirectlyBySelf:function($super,context,obj){return $super(context,obj)},doSetRedirectContext:function($super,value){$super(value);var childRenderers=this.getChildRenderers();if(childRenderers&&childRenderers.length)for(var i=0,l=childRenderers.length;i<l;++i)childRenderers[i].setRedirectContext(value)},getChildObjs:function(){var chemObj=this.getChemObj();return chemObj&&chemObj.getAttachedMarkers?[].concat(chemObj.getAttachedMarkers()):[]},prepareChildObjs:function(){var childObjs=this.getTargetChildObjs();return childObjs||(this.setTargetChildObjs(this.getChildObjs()),this.getTargetChildObjs())},refreshChildObjs:function(){this.setTargetChildObjs(null),this.prepareChildObjs()},getChildRenderers:function(){return this.getChildRendererMap().getValues()},getRendererForChild:function(childObj,canCreate){var renderSelector=this.getRendererType()===Kekule.Render.RendererType.R3D?Kekule.Render.get3DRendererClass:Kekule.Render.get2DRendererClass,rendererMap=this.getChildRendererMap(),result=rendererMap.get(childObj);if(!result&&canCreate){var c=renderSelector(childObj)||Kekule.Render.DummyRenderer,result=c?new c(childObj,this.getDrawBridge(),this):null;rendererMap.set(childObj,result),result.setRedirectContext(this.getRedirectContext())}return result},prepareChildRenderers:function(){for(var rendererMap=this.getChildRendererMap(),childObjs=this.prepareChildObjs()||[],oldRenderedObjs=rendererMap.getKeys(),i=0,l=oldRenderedObjs.length;i<l;++i){var obj=oldRenderedObjs[i];childObjs.indexOf(obj)<0&&rendererMap.remove(obj)}for(var i=0,l=childObjs.length;i<l;++i){var childObj=childObjs[i];this.getRendererForChild(childObj,!0)}return rendererMap.getValues()},releaseChildRenderers:function(){var rendererMap=this.getChildRendererMap(),childRenderers=rendererMap.getValues();if(childRenderers){for(var i=0,l=childRenderers.length;i<l;++i)childRenderers[i].finalize();rendererMap.clear()}},hasChildRenderers:function(){var childRenderers=this.getChildRendererMap().getValues();return childRenderers&&childRenderers.length},prepare:function(){this.prepareChildObjs(),this.prepareChildRenderers()},reset:function(){this.setTargetChildObjs(null),this.releaseChildRenderers()},_needWholelyDraw:function(partialDrawObjs,context){var selfObj=this.getChemObj();return!partialDrawObjs||partialDrawObjs.indexOf(selfObj)>=0},doDraw:function($super,context,baseCoord,options){this.refreshChildObjs();var op=Object.create(options);if(options.partialDrawObjs&&this._needWholelyDraw(options.partialDrawObjs,context)&&(op.partialDrawObjs=null),this.getTargetChildObjs().length){var selfElem=this.doDrawSelf(context,baseCoord,op),group=this.doDrawChildren(context,baseCoord,op);return selfElem&&this.addToDrawGroup(selfElem,group),group}return $super(context,baseCoord,op)},doDrawChildren:function(context,baseCoord,options){var group=this.createDrawGroup(context),childRenderers=this.getChildRenderers(),ops=Object.create(options);this.getRenderCache(context).childDrawOptions=ops;for(var i=0,l=childRenderers.length;i<l;++i){var r=childRenderers[i],elem=r.draw(context,null,ops);group&&elem&&this.addToDrawGroup(elem,group)}return group},doClear:function($super,context){return $super(context),this.hasChildRenderers()&&this.doClearChildren(context),!0},doClearChildren:function(context){for(var childRenderers=this.getChildRendererMap().getValues(),i=0,l=childRenderers.length;i<l;++i)childRenderers[i]&&childRenderers[i].clear(context)},doUpdate:function($super,context,updateObjDetails,updateType){return this.refreshChildObjs(),$super(context,updateObjDetails,updateType),this.getTargetChildObjs().length&&this.doUpdateChildren(context,updateObjDetails,updateType),!0},doUpdateChildren:function(context,updateObjDetails,updateType){for(var updatedObjs=Kekule.Render.UpdateObjUtils._extractObjsOfUpdateObjDetails(updateObjDetails),directChildren=this.getTargetChildObjs()||[],childRendererMap=this.getChildRendererMap(),objs=Kekule.ArrayUtils.toArray(updatedObjs),objsMap=new Kekule.MapEx(!1),renderers=[],redrawRoot=!1,i=0,l=objs.length;i<l;++i){var obj=objs[i];this.isChemObjRenderedDirectlyBySelf(context,obj)&&(redrawRoot=!0)}if(redrawRoot)return this.doClear(context),this.redraw(context),!0;for(var i=0,l=objs.length;i<l;++i){var obj=objs[i],renderer=childRendererMap.get(obj);if(renderer)updateType===Kekule.Render.ObjectUpdateType.REMOVE?(renderer.clear(),childRendererMap.remove(obj)):(Kekule.ArrayUtils.pushUnique(renderers,renderer),olds=[obj],objsMap.set(renderer,olds));else{var rs=this._getRenderersForChildObj(context,obj);if(!rs.length&&directChildren.indexOf(obj)>=0){var r=this.getRendererForChild(obj,!0),drawnResult=r.draw(context,null,this.getRenderCache(context).childDrawOptions);if(drawnResult){var drawnElem=this.getCachedDrawnElem(context);drawnElem&&this.addToDrawGroup(drawnResult,drawnElem)}}for(var j=0,k=rs.length;j<k;++j){var renderer=rs[j],olds=objsMap.get(renderer);olds||(renderers.push(renderer),olds=[],objsMap.set(renderer,olds)),olds.push(obj)}}}for(var result=!0,i=0,l=renderers.length;i<l;++i){var renderer=renderers[i],o=objsMap.get(renderer),details=Kekule.Render.UpdateObjUtils._createUpdateObjDetailsFromObjs(o),r=renderer.update(context,details,updateType);result=result&&r}return result},_getRenderersForChildObj:function(context,childObj){for(var result=[],childRenderers=this.getChildRenderers(),i=0,l=childRenderers.length;i<l;++i){var r=childRenderers[i];r.isChemObjRenderedBySelf(context,childObj)&&result.push(r)}return result}}),Kekule.Render.Renderer2DFactory=Kekule.FactoryUtils.createSimpleFactory(Kekule.FactoryUtils.MATCH_BY_CLASS),Kekule.Render.get2DRendererClass=function(chemObj){var aClass=chemObj instanceof ObjectEx?chemObj.getClass():chemObj;return Kekule.Render.Renderer2DFactory.getClass(aClass)},Kekule.Render.Renderer3DFactory=Kekule.FactoryUtils.createSimpleFactory(Kekule.FactoryUtils.MATCH_BY_CLASS),Kekule.Render.get3DRendererClass=function(chemObj){var aClass=chemObj instanceof ObjectEx?chemObj.getClass():chemObj;return Kekule.Render.Renderer3DFactory.getClass(aClass)},Kekule.Render.DrawBridgeManager=Class.create({CLASS_NAME:"Kekule.Render.DrawBridgeManager",initialize:function(){this._items=[],this._preferredItem=null},_indexOfBridgeClass:function(bridgeClass){for(var i=0,l=this._items.length;i<l;++i){if(this._items[i].bridgeClass===bridgeClass)return i}return-1},_sortItems:function(){this._items.sort(function(item1,item2){return(item1.priorityLevel||0)-(item2.priorityLevel||0)})},_reselectPreferred:function(){this._sortItems();for(var i=this._items.length-1;i>=0;--i){var item=this._items[i];if(item.isSupported)return this._preferredItem=item,item}return this._preferredItem=null,null},register:function(bridgeClass,priorityLevel){priorityLevel||(priorityLevel=0);var item,index=this._indexOfBridgeClass(bridgeClass);return index>=0?(item=this._items[index],item.priorityLevel=priorityLevel):(item={bridgeClass:bridgeClass,priorityLevel:priorityLevel},item.isSupported=!!bridgeClass.isSupported&&bridgeClass.isSupported(),this._items.push(item)),this._sortItems(),(!this._preferredItem||this._preferredItem.priorityLevel<priorityLevel)&&item.isSupported&&(this._preferredItem=item),item},unregister:function(bridgeClass){var item=null,i=this._indexOfBridgeClass(bridgeClass);return i>=0&&(item=this._items[i],this._items.splice(i,1),item===this._preferredItem&&this._reselectPreferred()),item},getPreferredBridgeClass:function(){return this._preferredItem?this._preferredItem.bridgeClass:null},getPreferredBridgeInstance:function(){var c=this.getPreferredBridgeClass();return c?new c:null}}),Kekule.Render.DrawBridge2DMananger=new Kekule.Render.DrawBridgeManager,Kekule.Render.DrawBridge3DMananger=new Kekule.Render.DrawBridgeManager,Kekule}},function(module,exports,__webpack_require__){"use strict";module.exports=function(Kekule){var R=Kekule.Render;R.atomColorSets={jmol:["#000099","#FFFFFF","#D9FFFF","#CC80FF","#C2FF00","#FFB5B5","#909090","#3050F8","#FF0D0D","#90E050","#B3E3F5","#AB5CF2","#8AFF00","#BFA6A6","#F0C8A0","#FF8000","#FFFF30","#1FF01F","#80D1E3","#8F40D4","#3DFF00","#E6E6E6","#BFC2C7","#A6A6AB","#8A99C7","#9C7AC7","#E06633","#F090A0","#50D050","#C88033","#7D80B0","#C28F8F","#668F8F","#BD80E3","#FFA100","#A62929","#5CB8D1","#702EB0","#00FF00","#94FFFF","#94E0E0","#73C2C9","#54B5B5","#3B9E9E","#248F8F","#0A7D8C","#006985","#C0C0C0","#FFD98F","#A67573","#668080","#9E63B5","#D47A00","#940094","#429EB0","#57178F","#00C900","#70D4FF","#FFFFC7","#D9FFC7","#C7FFC7","#A3FFC7","#8FFFC7","#61FFC7","#45FFC7","#30FFC7","#1FFFC7","#00FF9C","#00E675","#00D452","#00BF38","#00AB24","#4DC2FF","#4DA6FF","#2194D6","#267DAB","#266696","#175487","#D0D0E0","#FFD123","#B8B8D0","#A6544D","#575961","#9E4FB5","#AB5C00","#754F45","#428296","#420066","#007D00","#70ABFA","#00BAFF","#00A1FF","#008FFF","#0080FF","#006BFF","#545CF2","#785CE3","#8A4FE3","#A136D4","#B31FD4","#B31FBA","#B30DA6","#BD0D87","#C70066","#CC0059","#D1004F","#D90045","#E00038","#E6002E","#EB0026","#000000","#000000"],cpk2D:["#000000","#000000","#FFC0CB","#B22222",null,"#00FF00","#000000","#8F8FFF","#F00000","#DAA520",null,"#0000FF","#228B22","#808090","#DAA520","#FFA500","#FFC832","#00FF00",null,"#0000FF","#808090","#808090","#808090","#808090","#808090","#808090","#FFA500","#A52A2A","#A52A2A","#A52A2A","#A52A2A"]};var a=R.atomColorSets.cpk2D,j=R.atomColorSets.jmol;return a[35]="#A52A2A",a[47]="#808090",a[53]="#A020F0",a[56]="#FFA500",a[79]="#DAA520",a.SubGroup=j.SubGroup="#0000CC",R.atom3DColors=Kekule.Render.atomColorSets.jmol,R.atom2DColors=Kekule.Render.atomColorSets.cpk2D,R.atomColors=[],R.atomColors[R.RendererType.R2D]=R.atom2DColors,R.atomColors[R.RendererType.R3D]=R.atom3DColors,Kekule}},function(module,exports,__webpack_require__){"use strict";var ClassEx=(__webpack_require__(0).Class,__webpack_require__(0).ClassEx),DataType=(__webpack_require__(0).ObjectEx,__webpack_require__(0).DataType);module.exports=function(Kekule){return Kekule.Render.RichText={SECTION:"section",GROUP:"group",LINES:"lines",SUP:"superscript",SUB:"subscript",NORMAL:"normal"},Kekule.Render.RichTextUtils={STYLE_PROPS:["fontSize","fontFamily","fontWeight","fontStyle","color","opacity"],create:function(){return Kekule.Render.RichTextUtils.createGroup()},createGroup:function(role,style){var result={role:role||"group",items:[]};if(style)for(var p in style)style.hasOwnProperty(p)&&(result[p]=style[p]);return result},createSection:function(text,style){var section={text:text};if(style)for(var p in style)style.hasOwnProperty(p)&&(section[p]=style[p]);return section},strToRichText:function(str,style){str||(str="");var RTU=Kekule.Render.RichTextUtils,lines=str.split("\n");if(lines.length<=1)return Kekule.Render.RichTextUtils.appendText(RTU.create(),str,style);for(var result=RTU.createGroup(Kekule.Render.RichText.LINES),i=0,l=lines.length;i<l;++i){var line=lines[i]||" ";RTU.appendText(result,line,style)}return result},insertText:function(richTextGroup,index,text,style,isAnchor){var section=Kekule.Render.RichTextUtils.createSection(text,style);return richTextGroup.items.splice(index,0,section),isAnchor&&(richTextGroup.anchorItem=section),richTextGroup},appendText:function(richTextGroup,text,style,isAnchor){var section=Kekule.Render.RichTextUtils.createSection(text,style);return richTextGroup.items.push(section),isAnchor&&(richTextGroup.anchorItem=section),richTextGroup},appendText2:function(richTextGroup,text,style,isAnchor){var section=Kekule.Render.RichTextUtils.createSection(text,style);return richTextGroup.items.push(section),isAnchor&&(richTextGroup.anchorItem=section),section},insert:function(destGroup,index,groupOrSection){return destGroup.items.splice(index,0,groupOrSection),destGroup},append:function(destGroup,groupOrSection){return destGroup.items.push(groupOrSection),destGroup},appendItems:function(destGroup,items){return destGroup.items=destGroup.items.concat(Kekule.ArrayUtils.toArray(items)),destGroup},getItemType:function(item){return item.items?item.role:Kekule.Render.RichText.SECTION},getItemRole:function(item){var R=Kekule.Render.RichText;return Kekule.Render.RichTextUtils.getItemType(item)===R.GROUP?R.GROUP:R.SECTION},getItemTextType:function(item){return item.textType||Kekule.Render.RichText.NORMAL},isSuperscript:function(item){return Kekule.Render.RichTextUtils.getItemTextType(item)==Kekule.Render.RichText.SUP},isSubscript:function(item){return Kekule.Render.RichTextUtils.getItemTextType(item)==Kekule.Render.RichText.SUB},isGroup:function(item){return Kekule.Render.RichTextUtils.getItemType(item)===Kekule.Render.RichText.GROUP},isSection:function(item){return Kekule.Render.RichTextUtils.getItemType(item)===Kekule.Render.RichText.SECTION},getFirstNormalTextSection:function(richTextGroup){for(var i=0,l=richTextGroup.items.length;i<l;++i){var item=richTextGroup.items[i];if(Kekule.Render.RichTextUtils.getItemTextType(item)===Kekule.Render.RichText.NORMAL)return item}return null},getActualRefItem:function(item,parent){var result=item.refItem;if(!result&&parent.items.length>1){var index=parent.items.indexOf(item);result=index>0?parent.items[index-1]:0==index?parent.items[1]:null}return result},getFinalAnchorItem:function(richText){return richText.anchorItem?Kekule.Render.RichTextUtils.getFinalAnchorItem(richText.anchorItem):richText},tidy:function(richText){for(var result=Kekule.Render.RichTextUtils.createGroup(richText.role),currIndex=-1,i=0,l=richText.items.length;i<l;++i){var item=richText.items[i];if(item.items){var newGroup=Kekule.Render.RichTextUtils.tidy(item);if(1==newGroup.items.length){var newItem=Object.extend({},newGroup);delete newItem.items,delete newItem.role,newItem=Object.extend(newItem,newGroup.items[0]),item=newItem}else if(newGroup.items.length>0){++currIndex,result.items.push(newGroup);continue}}var merged=!1;if(currIndex>=0){var prevItem=result.items[currIndex];prevItem.items||Kekule.ObjUtils.equal(item,prevItem,["text"])&&(prevItem.text+=item.text,merged=!0)}merged||(++currIndex,result.items.push(Object.extend({},item)))}return result},clone:function(richText){var result={};if(Object.extend(result,richText),richText.items){result.items=[];for(var i=0,l=richText.items.length;i<l;++i){var item={};item=Kekule.Render.RichTextUtils.clone(richText.items[i]),result.items.push(item)}}if(result.items){if(richText.anchorItem){var index=richText.items.indexOf(richText.anchorItem);result.anchorItem=index>=0?result.items[index]:null}for(var i=0,l=result.items.length;i<l;++i){var originItem=richText.items[i],item=result.items[i];if(originItem.refItem){var index=richText.items.indexOf(originItem.refItem);item.refItem=index>=0?result.items[index]:null}}}return result},toText:function(richText){var result="";if(!richText.items)return richText.text||"";for(var i=0,l=richText.items.length;i<l;++i){var item=richText.items[i];item.items?result+=Kekule.Render.RichTextUtils.toText(item):item.text&&(result+=item.text)}return result},_toDebugHtml:function(richText){for(var result="",i=0,l=richText.items.length;i<l;++i){var item=richText.items[i];if(item.items)result+=Kekule.Render.RichTextUtils._toDebugHtml(item);else if(item.text)switch(item.textType){case Kekule.Render.RichText.SUB:result+="<sub>"+item.text+"</sub>";break;case Kekule.Render.RichText.SUP:result+="<sup>"+item.text+"</sup>";break;default:result+=item.text}}return result},toHtml:function(doc,richText,reversedDirection){var result,reversed,RT=Kekule.Render.RichText;reversed=richText.charDirection?richText.charDirection===Kekule.Render.TextDirection.RTL||richText.charDirection===Kekule.Render.TextDirection.BTT:reversedDirection;var role=richText.role;if(role===RT.SECTION||richText.text){var textType=richText.textType,tagName=textType===RT.SUB?"sub":textType===RT.SUP?"sup":"span";result=doc.createElement(tagName);var text=richText.text;reversed&&(text=text.reverse()),Kekule.DomUtils.setElementText(result,richText.text||"")}else{var childEmbedStyleText,childEmbedTagName=null;role===RT.LINES?(result=doc.createElement("div"),childEmbedTagName="p",childEmbedStyleText="margin:0.2em 0;padding:0"):result=doc.createElement("span");for(var lastChildElem,i=0,l=richText.items.length;i<l;++i){var item=richText.items[i],childElem=Kekule.Render.RichTextUtils.toHtml(doc,item,reversed);if(childEmbedTagName){var embedElem=doc.createElement(childEmbedTagName);childEmbedStyleText&&(embedElem.style.cssText=childEmbedStyleText),embedElem.appendChild(childElem),childElem=embedElem}reversed&&lastChildElem?result.insertBefore(childElem,lastChildElem):result.appendChild(childElem),lastChildElem=childElem}}for(var elemStyle=result.style,styleProps=Kekule.Render.RichTextUtils.STYLE_PROPS,i=0,l=styleProps.length;i<l;++i){var prop=styleProps[i];richText[prop]&&(elemStyle[prop]=richText[prop])}return result},fromHtml:function(htmlElement){function _createRichTextFromHtmlNode(node,isRoot){if(node.nodeType===Node.TEXT_NODE){var text=node.nodeValue;return text=text.replace(/[\r\n]/g,""),text.trim()?RTU.createSection(text):null}if(node.nodeType===Node.ELEMENT_NODE){var stylePropNames=RTU.STYLE_PROPS;stylePropNames.push("direction");for(var styles={},i=0,l=stylePropNames.length;i<l;++i){var value,stylePropName=stylePropNames[i];value=isRoot?SU.getComputedStyle(node,stylePropName):node.style[stylePropName],value&&(styles[stylePropName]=value)}if(styles.direction?(styles.charDirection="ltr"===styles.direction?Kekule.Render.TextDirection.LTR:"rtl"===styles.direction?Kekule.Render.TextDirection.RTL:"inherit"===styles.direction?Kekule.Render.TextDirection.INHERIT:null,delete styles.direction):styles.charDirection=Kekule.Render.TextDirection.DEFAULT,DU.getFirstChildElem(node)){for(var resultRole=RT.GROUP,childNodes=DU.getChildNodesOfTypes(node,[Node.ELEMENT_NODE,Node.TEXT_NODE]),childRTs=[],hasLines=!1,i=0,l=childNodes.length;i<l;++i){var child=childNodes[i],childRT=_createRichTextFromHtmlNode(child,!1);if(child.nodeType===Node.ELEMENT_NODE){"br"===child.tagName.toLowerCase()&&(childRTs.push("br"),hasLines=!0);SU.isBlockElem(child)&&(hasLines=!0,childRT._isLine=!0)}childRT&&childRTs.push(childRT)}if(hasLines){for(var linedChildRTs=[],unpushedChildren=[],i=0,l=childRTs.length;i<l;++i){var childRT=childRTs[i];if(childRT._isLine||"br"==childRT){if(unpushedChildren.length){if(unpushedChildren.length>1){var prevGroup=RTU.createGroup();RTU.appendItems(prevGroup,unpushedChildren),linedChildRTs.push(prevGroup)}else linedChildRTs.push(unpushedChildren[0]);unpushedChildren=[]}childRT._isLine&&(delete childRT._isLine,linedChildRTs.push(childRT))}else unpushedChildren.push(childRT)}if(unpushedChildren.length)if(unpushedChildren.length>1){var prevGroup=RTU.createGroup();RTU.appendItems(prevGroup,unpushedChildren),linedChildRTs.push(prevGroup)}else linedChildRTs.push(unpushedChildren[0]);childRTs=linedChildRTs}hasLines&&(resultRole=RT.LINES);for(var result=RTU.createGroup(resultRole,styles),i=0,l=childRTs.length;i<l;++i)RTU.append(result,childRTs[i]);return result}var text=DU.getElementText(node),tagName=node.tagName.toLowerCase();return styles.textType="sub"===tagName?RT.SUB:"sup"===tagName?RT.SUP:RT.NORMAL,text?RTU.createSection(text,styles):null}}var RT=Kekule.Render.RichText,RTU=Kekule.Render.RichTextUtils,DU=Kekule.DomUtils,SU=Kekule.StyleUtils;return _createRichTextFromHtmlNode(htmlElement,!0)}},Kekule.Render.ChemDisplayTextUtils={RADICAL_LABELS:["","••","•","••"],RADICAL_TRIPLET_ALTER_LABEL:"^^",getRadicalDisplayText:function(radical,useAlterTripletRadicalMark){return useAlterTripletRadicalMark&&radical===Kekule.RadicalOrder.TRIPLET?Kekule.Render.ChemDisplayTextUtils.RADICAL_TRIPLET_ALTER_LABEL:Kekule.Render.ChemDisplayTextUtils.RADICAL_LABELS[radical]},getChargeDisplayText:function(charge,partialChargeDecimalsLength,chargeMarkType){var slabel="";if(!!charge&&(!partialChargeDecimalsLength||Math.abs(charge)>Math.pow(10,-partialChargeDecimalsLength)/2)){var chargeSign=charge>0?"+":"-",chargeAmount=Math.abs(charge);1!=chargeAmount?slabel+=partialChargeDecimalsLength?Kekule.NumUtils.toDecimals(chargeAmount,partialChargeDecimalsLength):chargeAmount.toString():chargeMarkType===Kekule.Render.ChargeMarkRenderType.CIRCLE_AROUND&&(chargeSign=charge>0?"⊕":"⊖"),slabel+=chargeSign}return slabel},createElectronStateDisplayTextSection:function(charge,radical,partialChargeDecimalsLength,chargeMarkType,useAlterTripletRadicalMark){var result=null,slabel="";return charge&&(slabel=Kekule.Render.ChemDisplayTextUtils.getChargeDisplayText(charge,partialChargeDecimalsLength,chargeMarkType)),radical&&(slabel+=Kekule.Render.ChemDisplayTextUtils.getRadicalDisplayText(radical,useAlterTripletRadicalMark)||""),slabel&&(result=Kekule.Render.RichTextUtils.createSection(slabel,{textType:Kekule.Render.RichText.SUP,charDirection:Kekule.Render.TextDirection.LTR})),result},formulaToRichText:function(formula,showCharge,showRadical,partialChargeDecimalsLength,displayConfigs,chargeMarkType,distinguishSingletAndTripletRadical){return Kekule.Render.ChemDisplayTextUtils._convFormulaToRichTextGroup(formula,!1,showCharge,showRadical,partialChargeDecimalsLength,displayConfigs,chargeMarkType,distinguishSingletAndTripletRadical)},_convFormulaToRichTextGroup:function(formula,showBracket,showCharge,showRadical,partialChargeDecimalsLength,displayConfigs,chargeMarkType,distinguishSingletAndTripletRadical){var result=Kekule.Render.RichTextUtils.createGroup(),sections=formula.getSections();if(showBracket){var bracketIndex=formula.getMaxNestedLevel()%Kekule.FormulaUtils.FORMULA_BRACKET_TYPE_COUNT,bracketStart=Kekule.FormulaUtils.FORMULA_BRACKETS[bracketIndex][0],bracketEnd=Kekule.FormulaUtils.FORMULA_BRACKETS[bracketIndex][1];result=Kekule.Render.RichTextUtils.appendText(result,bracketStart)}for(var i=0,l=sections.length;i<l;++i){var obj=sections[i].obj,charge=formula.getSectionCharge(sections[i]),subgroup=null;if(obj instanceof Kekule.MolecularFormula)subgroup=Kekule.Render.ChemDisplayTextUtils._convFormulaToRichTextGroup(obj,!0,!1,!1,partialChargeDecimalsLength,displayConfigs,chargeMarkType);else if(obj.getDisplayRichText)var subgroup=obj.getDisplayRichText(Kekule.Render.HydrogenDisplayLevel.NONE,!1,null,displayConfigs,partialChargeDecimalsLength,chargeMarkType);if(subgroup){if(1!=sections[i].count&&(subgroup=Kekule.Render.RichTextUtils.appendText(subgroup,sections[i].count.toString(),{textType:Kekule.Render.RichText.SUB}),subgroup.charDirection=Kekule.Render.TextDirection.LTR),showCharge&&charge){var chargeSection=Kekule.Render.ChemDisplayTextUtils.createElectronStateDisplayTextSection(charge,null,partialChargeDecimalsLength,chargeMarkType,distinguishSingletAndTripletRadical);chargeSection&&Kekule.Render.RichTextUtils.append(subgroup,chargeSection)}result=Kekule.Render.RichTextUtils.append(result,subgroup)}}if(showBracket&&(result=Kekule.Render.RichTextUtils.appendText(result,bracketEnd)),showCharge||showRadical){var charge=formula.getCharge(),radical=formula.getRadical(),chargeSection=Kekule.Render.ChemDisplayTextUtils.createElectronStateDisplayTextSection(charge,radical,partialChargeDecimalsLength,chargeMarkType);chargeSection&&Kekule.Render.RichTextUtils.append(result,chargeSection)}return result}},Kekule.Render.TextDrawUtils={isHorizontalLine:function(charDirection){return charDirection==Kekule.Render.TextDirection.LTR||charDirection==Kekule.Render.TextDirection.RTL||null==charDirection},isVerticalLine:function(charDirection){return charDirection==Kekule.Render.TextDirection.TTB||charDirection==Kekule.Render.TextDirection.BTT},getOppositeDirection:function(direction){var TD=Kekule.Render.TextDirection;switch(direction){case TD.LTR:return TD.RTL;case TD.RTL:return TD.LTR;case TD.TTB:return TD.BTT;case TD.BTT:return TD.TTB}},isOppositeDirection:function(direction1,direction2){return Kekule.Render.TextDrawUtils.getOppositeDirection(direction1)===direction2},getActualDirection:function(direction,parentDirection){var TD=Kekule.Render.TextDirection;return direction===TD.LINE_BREAK?parentDirection===TD.TTB||parentDirection===TD.BTT?TD.LTR:parentDirection===TD.LTR||parentDirection===TD.RTL?TD.TTB:direction:direction},getActualAlign:function(align,direction){var A=Kekule.Render.TextAlgin,D=Kekule.Render.TextDirection;switch(align){case A.LEFT:case A.RIGHT:case A.TOP:case A.BOTTOM:case A.CENTER:return align;case A.LEADING:switch(direction){case D.TTB:return A.TOP;case D.BTT:return A.BOTTOM;case D.RTL:return A.RIGHT;case D.LTR:default:return A.LEFT}case A.TRAILING:switch(direction){case D.BTT:return A.TOP;case D.TTB:return A.BOTTOM;case D.RTL:return A.LEFT;case D.LTR:default:return A.RIGHT}}}},Kekule.Render.DrawPathUtils={makePath:function(){for(var group,result=[],sMethod=null,params=[],i=0,l=arguments.length;i<l;++i){var arg=arguments[i];DataType.isArrayValue(arg)?params=params.concat(arg):"number"==typeof arg?params.push(arg):(sMethod&&(group={method:sMethod,params:params},result.push(group),sMethod=null,params=[]),sMethod=arg.toString()),i===l-1&&sMethod&&(group={method:sMethod,params:params},result.push(group))}return result}},Kekule.Render.ConnectorDrawUtils={getPossibleConnectorRenderTypes:function(connector){if(connector instanceof Kekule.Bond)return Kekule.Render.ConnectorDrawUtils.getPossibleBondRenderTypes(connector);var RT=Kekule.Render.BondRenderType;return[RT.SINGLE,RT.DASHED,RT.WAVY]},getDefConnectorRenderType:function(connector){return Kekule.Render.ConnectorDrawUtils.getPossibleConnectorRenderTypes(connector)[0]},getPossibleBondRenderTypes:function(bond){var RT=Kekule.Render.BondRenderType,BT=Kekule.BondType;switch(bond.getBondType()){case BT.HYDROGEN:return[RT.DASHED,RT.ARROWED,RT.WAVY];case BT.COORDINATE:return[RT.ARROWED,RT.SINGLE,RT.DASHED,RT.WAVY];case BT.IONIC:case BT.METALLIC:case BT.UNKNOWN:return[RT.SINGLE,RT.DASHED,RT.WAVY];case BT.COVALENT:break;default:return[RT.SINGLE,RT.DASHED,RT.ARROWED,RT.WAVY]}if(bond.getConnectedObjCount()>2)return[RT.DASHED,RT.SINGLE];var BO=Kekule.BondOrder;switch(bond.getBondOrder()){case BO.DOUBLE:var dresult=[RT.DOUBLE,RT.DASHED_DOUBLE,RT.BOLD_DOUBLE,RT.WAVY];return bond.getStereo&&[Kekule.BondStereo.E_OR_Z,Kekule.BondStereo.CIS_OR_TRANS].indexOf(bond.getStereo())>=0&&dresult.unshift(RT.SCISSORS_DOUBLE),dresult;case BO.TRIPLE:return[RT.TRIPLE,RT.BOLD_TRIPLE,RT.WAVY];case BO.QUAD:return[RT.QUAD,RT.BOLD_QUAD,RT.WAVY];case BO.EXPLICIT_AROMATIC:return[RT.SOLID_DASH,RT.WAVY];case BO.SINGLE:var BS=Kekule.BondStereo,result=[RT.SINGLE,RT.BOLD,RT.WAVY];switch(bond.getStereo()){case BS.UP:result.unshift(RT.WEDGED_SOLID,RT.WEDGED_HOLLOW);break;case BS.UP_INVERTED:result.unshift(RT.WEDGED_SOLID_INV,RT.WEDGED_HOLLOW_INV);break;case BS.DOWN:result.unshift(RT.WEDGED_HASHED,RT.DASHED);break;case BS.DOWN_INVERTED:result.unshift(RT.WEDGED_HASHED_INV,RT.DASHED);break;case BS.UP_OR_DOWN:case BS.UP_OR_DOWN_INVERTED:result=[RT.WAVY,RT.SINGLE];break;case BS.CLOSER:result=[RT.WEDGED_SOLID_BOTH,RT.WEDGED_HOLLOW_BOTH]}return result;default:return[RT.SINGLE,RT.DASHED,RT.ARROWED,RT.WAVY]}},getDefBondRenderType:function(bond){return Kekule.Render.ConnectorDrawUtils.getPossibleBondRenderTypes(bond)[0]},getConnectorRender3DType:function(connector,renderMode){var BRT=Kekule.Render.Bond3DRenderType,BRM=Kekule.Render.Bond3DRenderMode;return(!renderMode||renderMode!==BRM.WIRE&&renderMode!==BRM.CYLINDER)&&connector instanceof Kekule.Bond?Kekule.Render.ConnectorDrawUtils.getBondRender3DTypes(connector):BRT.SINGLE},getBondRender3DTypes:function(bond){var RT=Kekule.Render.Bond3DRenderType,BT=Kekule.BondType;switch(bond.getBondType()){case BT.HYDROGEN:return RT.DASH;case BT.COVALENT:break;default:return RT.SINGLE}var BO=Kekule.BondOrder;switch(bond.getBondOrder()){case BO.DOUBLE:return RT.DOUBLE;case BO.TRIPLE:return RT.TRIPLE;case BO.EXPLICIT_AROMATIC:return RT.SOLID_DASH;default:return RT.SINGLE}}},Kekule.Render.ObjUtils={getContainerBox:function(chemObj,coordMode,allowCoordBorrow){coordMode||(coordMode=Kekule.CoordMode.COORD2D);var box,o=chemObj;if(o.getExposedContainerBox)box=o.getExposedContainerBox(coordMode,allowCoordBorrow);else if(o.getContainerBox)box=o.getContainerBox(coordMode,allowCoordBorrow);else{var coord=o.getAbsCoordOfMode?o.getAbsCoordOfMode(coordMode):null;box=coord?Kekule.BoxUtils.createBox(coord,coord):null}return box}},Kekule.Render.MetaShapeUtils={createShapeInfo:function(shapeType,coords,additionalInfos){var result={};return result.shapeType=shapeType,result.coords=coords,additionalInfos&&(result=Object.extend(result,additionalInfos)),result},isCompositeShape:function(shape){return DataType.isArrayValue(shape)},inflateShape:function(originalShape,delta){if(!originalShape)return null;var T=Kekule.Render.MetaShapeType,B=Kekule.Render.MetaShapeUtils;if(B.isCompositeShape(originalShape)){for(var result=[],i=0,l=originalShape.length;i<l;++i){var oldChildShape=originalShape[i],newChildShape=B.inflateShape(oldChildShape,delta);result.push(newChildShape)}return result}var newBound;switch(originalShape.shapeType){case T.POINT:newBound=B._inflatePointShape(originalShape,delta);break;case T.CIRCLE:newBound=B._inflateCircleShape(originalShape,delta);break;case T.LINE:newBound=B._inflateLineShape(originalShape,delta);break;case T.RECT:newBound=B._inflateRectShape(originalShape,delta);break;case T.POLYGON:newBound=B._inflatePolygonShape(originalShape,delta)}return newBound},_inflatePointShape:function(originalShape,delta){return Kekule.Render.MetaShapeUtils.createShapeInfo(Kekule.Render.BoundShapeType.CIRCLE,[originalShape.coords[0]],{radius:delta})},_inflateCircleShape:function(originalShape,delta){return Kekule.Render.MetaShapeUtils.createShapeInfo(Kekule.Render.BoundShapeType.CIRCLE,[originalShape.coords[0]],{radius:originalShape.radius+delta})},_inflateLineShape:function(originalShape,delta){return Kekule.Render.MetaShapeUtils.createShapeInfo(Kekule.Render.BoundShapeType.LINE,[originalShape.coords[0],originalShape.coords[1]],{width:(originalShape.width||0)+2*delta})},_inflateRectShape:function(originalShape,delta){var newBound=Kekule.Render.MetaShapeUtils.createShapeInfo(Kekule.Render.BoundShapeType.RECT,[]),newCoords=Kekule.Render.MetaShapeUtils._inflateCoords(originalShape.coords,delta);return newBound.coords=newCoords,newBound},_inflatePolygonShape:function(originalShape,delta){var newBound=Kekule.Render.MetaShapeUtils.createShapeInfo(Kekule.Render.BoundShapeType.POLYGON,[]),newCoords=Kekule.Render.MetaShapeUtils._inflateCoords(originalShape.coords,delta);return newBound.coords=newCoords,newBound},_inflateCoords:function(coords,delta){for(var C=Kekule.CoordUtils,result=[],center=C.getCenter(coords),i=0,l=coords.length;i<l;++i){var coord=coords[i],vec=C.substract(coord,center),distance=C.getDistance(coord),deltaVec=C.multiply(vec,delta/distance),newCoord=C.add(coord,deltaVec);result.push(newCoord)}return result},getDistance:function(coord,shapeInfo,inflate){if(Kekule.Render.MetaShapeUtils.isCompositeShape(shapeInfo)){for(var result=null,i=0,l=shapeInfo.length;i<l;++i){var info=shapeInfo[i],d=Kekule.Render.MetaShapeUtils.getDistance(coord,info,inflate);(null===result||result>d)&&(result=d)}return result}var T=Kekule.Render.MetaShapeType,B=Kekule.Render.MetaShapeUtils,newBound=inflate?B.inflateShape(shapeInfo,inflate):shapeInfo;switch(shapeInfo.shapeType){case T.POINT:return inflate?B._getDistanceToCircle(coord,newBound):B._getDistanceToPoint(coord,newBound);case T.CIRCLE:return B._getDistanceToCircle(coord,newBound);case T.LINE:return B._getDistanceToLine(coord,newBound);case T.RECT:return B._getDistanceToRect(coord,newBound);case T.POLYGON:return B._getDistanceToPolygon(coord,newBound);default:return!1}},_getDistanceToPoint:function(coord,shapeInfo){return Kekule.CoordUtils.getDistance(coord,shapeInfo.coords[0])},_getDistanceToCircle:function(coord,shapeInfo){return Kekule.CoordUtils.getDistance(coord,shapeInfo.coords[0])-shapeInfo.radius},_getDistanceToLine:function(coord,shapeInfo){var SU=Kekule.Render.MetaShapeUtils,lineCoords=shapeInfo.coords,crossPoint=Kekule.Render.MetaShapeUtils._calcVerticalLineCrossPoint(coord,lineCoords[0],lineCoords[1]),NU=Kekule.NumUtils;if(NU.isFloatEqual(lineCoords[0].x,lineCoords[1].x)&&NU.isFloatEqual(lineCoords[0].y,lineCoords[1].y)){var circleInfo={coords:[shapeInfo.coords[0]],radius:shapeInfo.width};return SU._getDistanceToCircle(coord,circleInfo)}var vector=Kekule.CoordUtils.substract(lineCoords[1],lineCoords[0]);if(Math.abs(vector.y)>Math.abs(vector.x)?Math.sign(crossPoint.y-lineCoords[0].y)*Math.sign(crossPoint.y-lineCoords[1].y)<=0:Math.sign(crossPoint.x-lineCoords[0].x)*Math.sign(crossPoint.x-lineCoords[1].x)<=0){return Kekule.CoordUtils.getDistance(coord,crossPoint)-(shapeInfo.width||0)/2}var circleInfo0={coords:[shapeInfo.coords[0]],radius:shapeInfo.width||0},circleInfo1={coords:[shapeInfo.coords[1]],radius:shapeInfo.width||0},d0=SU._getDistanceToCircle(coord,circleInfo0),d1=SU._getDistanceToCircle(coord,circleInfo1);return Math.min(d0,d1)},_getDistanceToRect:function(coord,shapeInfo){var cornerCoords=shapeInfo.coords,dx0=coord.x-cornerCoords[0].x,dx1=coord.x-cornerCoords[1].x,dy0=coord.y-cornerCoords[0].y,dy1=coord.y-cornerCoords[1].y;if(dx0*dx1<=0&&dy0*dy1<=0)return-Math.min(Math.abs(dx0),Math.abs(dx1),Math.abs(dy0),Math.abs(dy1));var CU=Kekule.CoordUtils;return Math.min(CU.getDistance(coord,cornerCoords[0]),CU.getDistance(coord,cornerCoords[1]),CU.getDistance(coord,{x:cornerCoords[0].x,y:cornerCoords[1].y}),CU.getDistance(coord,{x:cornerCoords[1].x,y:cornerCoords[0].y}))},_getDistanceToPolygon:function(coord,shapeInfo){for(var SU=(Kekule.CoordUtils,Kekule.Render.MetaShapeUtils),T=Kekule.Render.MetaShapeType,inside=SU._isInsidePolygon(coord,shapeInfo),lineCoords=shapeInfo.coords,distance=null,i=0,l=lineCoords.length;i<l;++i){var coord1=lineCoords[i],coord2=lineCoords[(i+1)%l],lineShape=SU.createShapeInfo(T.LINE,[coord1,coord2],{width:0}),d=SU._getDistanceToLine(coord,lineShape);null===distance?distance=d:distance>d&&(distance=d)}return inside&&(distance=-distance),distance},isCoordInside:function(coord,shapeInfo,inflate){if(Kekule.Render.MetaShapeUtils.isCompositeShape(shapeInfo)){for(var i=0,l=shapeInfo.length;i<l;++i){var info=shapeInfo[i];if(Kekule.Render.MetaShapeUtils.isCoordInside(coord,info,inflate))return!0}return!1}var T=Kekule.Render.MetaShapeType,B=Kekule.Render.MetaShapeUtils,newBound=inflate?B.inflateShape(shapeInfo,inflate):shapeInfo;switch(shapeInfo.shapeType){case T.POINT:return inflate?B._isInsideCircle(coord,newBound):B._isInsidePoint(coord,newBound);case T.CIRCLE:return B._isInsideCircle(coord,newBound);case T.LINE:return B._isInsideLine(coord,newBound);case T.RECT:return B._isInsideRect(coord,newBound);case T.POLYGON:return B._isInsidePolygon(coord,newBound);default:return!1}},_isInsidePoint:function(coord,shapeInfo){return Kekule.CoordUtils.isEqual(coord,shapeInfo.coords[0])},_isInsideCircle:function(coord,shapeInfo){return Kekule.CoordUtils.getDistance(coord,shapeInfo.coords[0])<=shapeInfo.radius},_isInsideLine:function(coord,shapeInfo){var lineCoords=shapeInfo.coords,crossPoint=Kekule.Render.MetaShapeUtils._calcVerticalLineCrossPoint(coord,lineCoords[0],lineCoords[1]),NU=Kekule.NumUtils;if(NU.isFloatEqual(lineCoords[0].x,lineCoords[1].x)&&NU.isFloatEqual(lineCoords[0].y,lineCoords[1].y)){var circleInfo={coords:[shapeInfo.coords[0]],radius:shapeInfo.width};return Kekule.Render.MetaShapeUtils._isInsideCircle(coord,circleInfo)}var vector=Kekule.CoordUtils.substract(lineCoords[1],lineCoords[0]);if(Math.abs(vector.y)>Math.abs(vector.x)?Math.sign(crossPoint.y-lineCoords[0].y)*Math.sign(crossPoint.y-lineCoords[1].y)<=0:Math.sign(crossPoint.x-lineCoords[0].x)*Math.sign(crossPoint.x-lineCoords[1].x)<=0){return Kekule.CoordUtils.getDistance(coord,crossPoint)<=shapeInfo.width/2}return!1},_isInsideRect:function(coord,shapeInfo){var lineCoords=shapeInfo.coords;return Kekule.CoordUtils.insideRect(coord,lineCoords[0],lineCoords[1])},_isInsidePolygon:function(coord,shapeInfo){for(var C=Kekule.CoordUtils,lineCoords=shapeInfo.coords,crossCount=0,i=0,l=lineCoords.length;i<l;++i){var coord1=lineCoords[i],coord2=lineCoords[(i+1)%l],deltaVec=C.substract(coord2,coord1);if(0!==deltaVec.x){var crossCoord={x:coord.x};crossCoord.y=(crossCoord.x-coord1.x)/deltaVec.x*deltaVec.y+coord1.y,C.insideRect(crossCoord,coord1,coord2)&&++crossCount}}return crossCount%2==0},_calcVerticalLineCrossPoint:function(coord,lineCoord1,lineCoord2){var result={};if(Math.abs(lineCoord1.x-lineCoord2.x)<1e-10)result.x=lineCoord1.x,result.y=coord.y;else{var k=(lineCoord2.y-lineCoord1.y)/(lineCoord2.x-lineCoord1.x);result.x=(k*k*lineCoord1.x+k*(coord.y-lineCoord1.y)+coord.x)/(k*k+1),result.y=k*(result.x-lineCoord1.x)+lineCoord1.y}return result},getContainerBox:function(shapeInfo,inflation){var T=Kekule.Render.MetaShapeType,U=Kekule.Render.MetaShapeUtils,C=Kekule.BoxUtils,coords=shapeInfo.coords;inflation=inflation||0;var result;if(U.isCompositeShape(shapeInfo)){result=null;for(var i=0,l=shapeInfo.length;i<l;++i){var childShape=shapeInfo[i],childBox=U.getContainerBox(childShape);result=result?C.getContainerBox(result,childBox):childBox}}else switch(shapeInfo.shapeType){case T.POINT:case T.CIRCLE:var radius=shapeInfo.shapeType===T.POINT?0:shapeInfo.radius||0,coord=coords[0];result=C.createBox({x:coord.x-radius,y:coord.y-radius},{x:coord.x+radius,y:coord.y+radius});break;case T.LINE:var result=C.createBox(coords[0],coords[1]);result=Kekule.BoxUtils.inflateBox(result,(shapeInfo.width||0)/2);break;case T.RECT:result=C.createBox(coords[0],coords[1]);break;case T.POLYGON:result=C.createBox(coords[0],coords[0]);for(var i=1,l=coords.length;i<l;++i){var coord=coords[i];result={x1:Math.min(result.x1,coord.x),y1:Math.min(result.y1,coord.y),x2:Math.max(result.x2,coord.x),y2:Math.max(result.y2,coord.y)}}}return inflation&&(result=Kekule.BoxUtils.inflateBox(result,inflation)),result},isInsideBox:function(shapeInfo,box){var cbox=Kekule.Render.MetaShapeUtils.getContainerBox(shapeInfo);return Kekule.BoxUtils.isInside(cbox,box)},isIntersectingBox:function(shapeInfo,box){var U=Kekule.Render.MetaShapeUtils;if(!U.isCompositeShape(shapeInfo)){for(var coords=shapeInfo.coords,i=0,l=coords.length;i<l;++i){var coord=coords[i];if(Kekule.CoordUtils.isInsideBox(coord,box))return!0}return!1}for(var i=0,l=shapeInfo.length;i<l;++i){var childShape=shapeInfo[i];if(U.isIntersectingBox(childShape,box))return!0}}},Kekule.Render.RenderOptionUtils={mergeObjLocalRenderOptions:function(obj,options){var childOps=obj&&obj.getOverriddenRenderOptions?obj.getOverriddenRenderOptions():null;return Kekule.Render.RenderOptionUtils.mergeRenderOptions(childOps||{},options)},mergeObjLocalRender3DOptions:function(obj,options){var childOps=obj&&obj.getOverriddenRender3DOptions?obj.getOverriddenRender3DOptions():null;return Kekule.Render.RenderOptionUtils.mergeRenderOptions(childOps||{},options)},mergeRenderOptions:function(childOptions,parentOptions){var result=Object.create(parentOptions);return result=Object.extend(result,childOptions,!0,!0)},getColor:function(renderOptions){return renderOptions?renderOptions.color:null},getMoleculeDisplayType:function(renderOptions){return renderOptions?renderOptions.moleculeDisplayType:null},getNodeDisplayMode:function(renderOptions){return renderOptions?renderOptions.nodeDisplayMode:null},getHydrogenDisplayLevel:function(renderOptions){return renderOptions?renderOptions.hydrogenDisplayLevel:null},getShowCharge:function(renderOptions){return renderOptions?renderOptions.showCharge:null},getChargeDrawOptions:function(renderOptions){if(renderOptions){var props=["showCharge","chargeMarkType","chargeMarkFontSize","chargeMarkMargin","chargeMarkCircleWidth","color","opacity"];return Object.copyValues({},renderOptions,props)}return null},getNodeLabelDrawOptions:function(renderOptions){if(renderOptions){var props=["fontSize","fontFamily","supFontSizeRatio","subFontSizeRatio","superscriptOverhang","subscriptOversink","textBoxXAlignment","textBoxYAlignment","color","opacity"];return Object.copyValues({},renderOptions,props)}return null},getConnectorRenderType:function(renderOptions){return renderOptions?renderOptions.renderType:null},getConnectorDrawParams:function(renderOptions){if(renderOptions){var props=["bondLineWidth","boldBondLineWidth","hashSpacing","multipleBondSpacingRatio","multipleBondSpacingAbs","multipleBondMaxAbsSpacing","bondArrowLength","bondArrowWidth","bondWedgeWidth","bondWedgeHashMinWidth","color","opacity"];return Object.copyValues({},renderOptions,props)}return null},convertConfigsToPlainHash:function(configs){var U=Kekule.Render.RenderOptionUtils;return configs instanceof Kekule.Render.Render3DConfigs?U.convert3DConfigsToPlainHash(configs):U.convert2DConfigsToPlainHash(configs)},convert2DConfigsToPlainHash:function(render2DConfigs){var OU=Kekule.ObjUtils,result={};result._configs=render2DConfigs;var h=render2DConfigs.getGeneralConfigs().toHash();return OU.replacePropName(h,"drawOpacity","opacity"),result=Object.extend(result,h),h=render2DConfigs.getMoleculeDisplayConfigs().toHash(),OU.replacePropName(h,"defMoleculeDisplayType","moleculeDisplayType"),OU.replacePropName(h,"defNodeDisplayMode","nodeDisplayMode"),OU.replacePropName(h,"defHydrogenDisplayLevel","hydrogenDisplayLevel"),OU.replacePropName(h,"defChargeMarkType","chargeMarkType"),result=Object.extend(result,h),result.displayLabelConfigs=render2DConfigs.getDisplayLabelConfigs(),h=render2DConfigs.getTextFontConfigs().toHash(),result=Object.extend(result,h),h=render2DConfigs.getLengthConfigs().toHash(),result=Object.extend(result,h),result.unitLength=result.unitLength||1,h=render2DConfigs.getColorConfigs().toHash(),result=Object.extend(result,h)},convert3DConfigsToPlainHash:function(render3DConfigs){var OU=Kekule.ObjUtils,result={};result._configs=render3DConfigs;var h=render3DConfigs.getGeneralConfigs().toHash();OU.replacePropName(h,"drawOpacity","opacity"),result=Object.extend(result,h);var h=render3DConfigs.getEnvironmentConfigs().toHash();result=Object.extend(result,h);var h=render3DConfigs.getMoleculeDisplayConfigs().toHash();OU.replacePropName(h,"defMoleculeDisplayType","moleculeDisplayType"),OU.replacePropName(h,"defBondSpliceMode","bondSpliceMode"),OU.replacePropName(h,"defDisplayMultipleBond","displayMultipleBond"),OU.replacePropName(h,"defBondColor","bondColor"),OU.replacePropName(h,"defAtomColor","atomColor"),result=Object.extend(result,h);var h=render3DConfigs.getModelConfigs().toHash();result=Object.extend(result,h);var h=render3DConfigs.getLengthConfigs().toHash();return result=Object.extend(result,h)},getCascadeRenderOptionValueOfObjs:function(chemObjs,propName,is3DOption){for(var result,resultSet=!1,objs=Kekule.ArrayUtils.toArray(chemObjs),getFunc=is3DOption?"getCascadedRender3DOption":"getCascadedRenderOption",i=0,l=objs.length;i<l;++i){var obj=objs[i];if(obj[getFunc]){var value=obj[getFunc](propName);if(resultSet){if(result!=value)return null}else result=value,resultSet=!0}}return result},setRenderOptionValueOfObjs:function(chemObjs,options,is3DOption){for(var objs=Kekule.ArrayUtils.toArray(chemObjs),i=0,l=objs.length;i<l;++i){var obj=objs[i];if(obj.setRenderOption)for(var propNames=Kekule.ObjUtils.getOwnedFieldNames(options),j=0,k=propNames.length;j<k;++j)obj.setRenderOption(propNames[j],options[propNames[j]])}}},Kekule.Render.Render3DOptionUtils={getConnectorRenderType:function(renderOptions){return renderOptions?renderOptions.renderType:null},convertConfigsToPlainHash:function(render3DConfigs){}},Kekule.Render.RenderColorUtils={getActiveAtomColorSet:function(rendererType){return Kekule.Render.atomColors[rendererType]},setActiveAtomColorSet:function(newSetName,rendererType){var r=Kekule.Render.AtomColorSets[newSetName];return r&&(Kekule.Render.atomColorSet[rendererType]=r),r},getColor:function(atomicNumber,rendererType){var s=Kekule.Render.RenderColorUtils.getActiveAtomColorSet(rendererType),r=s[atomicNumber];return r||(r=s[0]),r}},Kekule.Render.UpdateObjUtils={_extractObjsOfUpdateObjDetails:function(updatedObjDetails){for(var result=[],i=0,l=updatedObjDetails.length;i<l;++i){var detail=updatedObjDetails[i];detail.obj&&Kekule.ArrayUtils.pushUnique(result,detail.obj)}return result},_createUpdateObjDetailsFromObjs:function(updatedObjs){for(var result=[],i=0,l=updatedObjs.length;i<l;++i)result.push({obj:updatedObjs[i]});return result}},Kekule.Render.RendererDefineUtils={CompositeObjRendererMethods:{finalize:function($super){this.reset(),$super()},doEstimateObjBox:function(context,options,allowCoordBorrow){for(var result=null,renderers=this.prepareChildRenderers(),BU=Kekule.BoxUtils,i=0,l=renderers.length;i<l;++i){var r=renderers[i];if(r){var b=r.estimateObjBox(context,options,allowCoordBorrow);b&&(result=result?BU.getContainerBox(result,b):Object.extend({},b))}}return result},isChemObjRenderedBySelf:function($super,context,obj){var result=$super(context,obj);if(!result)for(var childRenderers=this.getChildRenderers(),i=0,l=childRenderers.length;i<l;++i){var r=childRenderers[i];if(r.isChemObjRenderedBySelf(context,obj))return!0}if(!result){this.refreshChildObjs();var objs=this.getTargetChildObjs();result=objs&&objs.indexOf(obj)>=0}return result},isChemObjRenderedDirectlyBySelf:function($super,context,obj){return $super(context,obj)},getChildObjs:function(){return null},prepareChildObjs:function(){var childObjs=this.getTargetChildObjs();return childObjs||(this.setTargetChildObjs(this.getChildObjs()),this.getTargetChildObjs())},refreshChildObjs:function(){this.setTargetChildObjs(null),this.prepareChildObjs()},getChildRenderers:function(){return this.getChildRendererMap().getValues()},getRendererForChild:function(childObj,canCreate){var renderSelector=this.getRendererType()===Kekule.Render.RendererType.R3D?Kekule.Render.get3DRendererClass:Kekule.Render.get2DRendererClass,rendererMap=this.getChildRendererMap(),result=rendererMap.get(childObj);if(!result&&canCreate){var c=renderSelector(childObj)||Kekule.Render.DummyRenderer,result=c?new c(childObj,this.getDrawBridge(),this):null;rendererMap.set(childObj,result),result.setRedirectContext(this.getRedirectContext())}return result},prepareChildRenderers:function(){for(var rendererMap=this.getChildRendererMap(),childObjs=this.prepareChildObjs()||[],oldRenderedObjs=rendererMap.getKeys(),i=0,l=oldRenderedObjs.length;i<l;++i){var obj=oldRenderedObjs[i];childObjs.indexOf(obj)<0&&rendererMap.remove(obj)}for(var i=0,l=childObjs.length;i<l;++i){var childObj=childObjs[i];this.getRendererForChild(childObj,!0)}return rendererMap.getValues()},releaseChildRenderers:function(){var rendererMap=this.getChildRendererMap(),childRenderers=rendererMap.getValues();if(childRenderers){for(var i=0,l=childRenderers.length;i<l;++i)childRenderers[i].finalize();rendererMap.clear()}},hasChild:function(){return!!(this.getTargetChildObjs()||[]).length},prepare:function(){this.prepareChildObjs(),this.prepareChildRenderers()},reset:function(){this.setTargetChildObjs(null),this.releaseChildRenderers()},doDraw:function($super,context,baseCoord,options){return this.prepare(),this.hasChild()?this.doDrawChildrenAndSelf(context,baseCoord,options):$super(context,baseCoord,options)},doDrawChildrenAndSelf:function(context,baseCoord,options){var group=this.createDrawGroup(context),childRenderers=this.getChildRenderers(),ops=Object.create(options);this.getRenderCache(context).childDrawOptions=ops;for(var i=0,l=childRenderers.length;i<l;++i){var r=childRenderers[i],baseCoord=null,elem=r.draw(context,baseCoord,ops);group&&elem&&this.addToDrawGroup(elem,group)}var selfElem=this.doDrawSelf(context,baseCoord,options);return selfElem&&this.addToDrawGroup(selfElem,group),group},doDrawSelf:function($super,context,baseCoord,options){return $super(context,baseCoord,options)},doClear:function($super,context){if(this.hasChild())for(var childRenderers=this.getChildRendererMap().getValues(),i=0,l=childRenderers.length;i<l;++i)childRenderers[i]&&childRenderers[i].clear(context);return $super(context),!0},doClearSelf:function($super,context){return $super(context)},doUpdate:function($super,context,updateObjDetails,updateType){return $super(context,updateObjDetails,updateType)},doUpdateSelf:function($super,context,updateObjDetails,updateType){return $super(context,updateObjDetails,updateType)},_getRenderersForChildObj:function(context,childObj){for(var result=[],childRenderers=this.getChildRenderers(),i=0,l=childRenderers.length;i<l;++i){var r=childRenderers[i];r.isChemObjRenderedBySelf(context,childObj)&&result.push(r)}return result}},addCompositeRenderSupport:function(aClass){ClassEx.defineProp(aClass,"targetChildObjs",{dataType:DataType.ARRAY,serializable:!1}),ClassEx.defineProp(aClass,"childRendererMap",{dataType:DataType.OBJECT,serializable:!1,getter:function(){var result=this.getPropStoreFieldValue("childRendererMap");return result||(result=new Kekule.MapEx(!0),this.setPropStoreFieldValue("childRendererMap",result)),result}}),ClassEx.extend(aClass,Kekule.Render.RendererDefineUtils.CompositeObjRendererMethods)}},Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class;__webpack_require__(0).ClassEx,__webpack_require__(0).ObjectEx,__webpack_require__(0).DataType;module.exports=function(Kekule){var OT=Kekule.OBJDEF_TEXTS,PS=Class.PropertyScope;return Kekule.Render.PredefinedConfigsMap=Class.create(Kekule.ConfigPresetMap,{CLASS_NAME:"Kekule.Render.PredefinedConfigsMap"}),Kekule.Render.GeneralConfigs=Class.create(Kekule.AbstractConfigs,{CLASS_NAME:"Kekule.Render.GeneralConfigs",initProperties:function(){this.addBoolConfigProp("allowCoordBorrow",!0,{scope:PS.PUBLIC}),this.addFloatConfigProp("drawOpacity",1,{title:OT.TITLE_DRAWOPACITY,description:OT.DES_DRAWOPACITY})}}),Kekule.Render.Render2DConfigs=Class.create(Kekule.AbstractConfigs,{CLASS_NAME:"Kekule.Render.Render2DConfigs",initProperties:function(){this.addConfigProp("generalConfigs","Kekule.Render.GeneralConfigs"),this.addConfigProp("moleculeDisplayConfigs","Kekule.Render.MoleculeDisplayConfigs"),this.addConfigProp("displayLabelConfigs","Kekule.Render.DisplayLabelConfigs"),this.addConfigProp("textFontConfigs","Kekule.Render.TextFontConfigs"),this.addConfigProp("lengthConfigs","Kekule.Render.LengthConfigs"),this.addConfigProp("colorConfigs","Kekule.Render.ColorConfigs")},initPropValues:function($super){$super(),this.setPropStoreFieldValue("generalConfigs",new Kekule.Render.GeneralConfigs),this.setPropStoreFieldValue("moleculeDisplayConfigs",new Kekule.Render.MoleculeDisplayConfigs),this.setPropStoreFieldValue("displayLabelConfigs",new Kekule.Render.DisplayLabelConfigs),this.setPropStoreFieldValue("textFontConfigs",new Kekule.Render.TextFontConfigs),this.setPropStoreFieldValue("lengthConfigs",new Kekule.Render.LengthConfigs),this.setPropStoreFieldValue("colorConfigs",new Kekule.Render.ColorConfigs)},initInteractStyleMap:function(){}}),Kekule.ClassUtils.makeSingleton(Kekule.Render.Render2DConfigs),Kekule.Render.getRender2DConfigs=function(){return Kekule.Render.Render2DConfigs.getInstance()},Kekule.Render.MoleculeDisplayConfigs=Class.create(Kekule.AbstractConfigs,{CLASS_NAME:"Kekule.Render.MoleculeDisplayConfigs",initProperties:function(){this.addIntConfigProp("defMoleculeDisplayType",Kekule.Render.MoleculeDisplayType.SKELETAL,{enumSource:Kekule.Render.MoleculeDisplayType}),this.addIntConfigProp("defNodeDisplayMode",Kekule.Render.NodeLabelDisplayMode.SMART,{enumSource:Kekule.Render.NodeLabelDisplayMode}),this.addIntConfigProp("defHydrogenDisplayLevel",Kekule.Render.HydrogenDisplayLevel.EXPLICIT,{enumSource:Kekule.Render.HydrogenDisplayLevel}),this.addIntConfigProp("defChargeMarkType",Kekule.Render.ChargeMarkRenderType.DEFAULT,{enumSource:Kekule.Render.ChargeMarkRenderType}),this.addBoolConfigProp("distinguishSingletAndTripletRadical",!1),this.addIntConfigProp("partialChargeDecimalsLength",2),this.addBoolConfigProp("autoCreateChargeAndRadicalMarker",!0)}}),Kekule.Render.DisplayLabelConfigs=Class.create(Kekule.AbstractConfigs,{CLASS_NAME:"Kekule.Render.DisplayLabelConfigs",DEF_UNSET_ELEMENT:"?",DEF_DUMMY_ATOM:"Du",DEF_HETERO_ATOM:"Q",DEF_ANY_ATOM:"A",DEF_VARIABLE_ATOM:"L",DEF_RGROUP:"R",DEF_ISO_LIST_LEADING_BRACKET:"[",DEF_ISO_LIST_TAILING_BRACKET:"]",DEF_ISO_LIST_DELIMITER:",",DEF_ISO_LIST_DISALLOW_PREFIX:"NOT",initProperties:function(){var NL=Kekule.ChemStructureNodeLabels;this.addBoolConfigProp("enableIsotopeAlias",NL.ENABLE_ISOTOPE_ALIAS,{getter:function(){return NL.ENABLE_ISOTOPE_ALIAS},setter:function(value){NL.ENABLE_ISOTOPE_ALIAS=value}}),this.addStrConfigProp("unsetElement",NL.UNSET_ELEMENT,{getter:function(){return NL.UNSET_ELEMENT},setter:function(value){value&&(NL.UNSET_ELEMENT=value)}}),this.addStrConfigProp("dummyAtom",NL.DUMMY_ATOM,{getter:function(){return NL.DUMMY_ATOM},setter:function(value){value&&(NL.DUMMY_ATOM=value)}}),this.addStrConfigProp("heteroAtom",NL.HETERO_ATOM,{getter:function(){return NL.HETERO_ATOM},setter:function(value){value&&(NL.HETERO_ATOM=value)}}),this.addStrConfigProp("anyAtom",NL.ANY_ATOM,{getter:function(){return NL.ANY_ATOM},setter:function(value){value&&(NL.ANY_ATOM=value)}}),this.addStrConfigProp("variableAtom",NL.VARIABLE_ATOM,{getter:function(){return NL.VARIABLE_ATOM},setter:function(value){value&&(NL.VARIABLE_ATOM=value)}}),this.addStrConfigProp("rgroup",NL.SUBGROUP,{getter:function(){return NL.SUBGROUP},setter:function(value){value&&(NL.SUBGROUP=value)}}),this.addStrConfigProp("isoListLeadingBracket",NL.ISO_LIST_LEADING_BRACKET,{getter:function(){return NL.ISO_LIST_LEADING_BRACKET},setter:function(value){value&&(NL.ISO_LIST_LEADING_BRACKET=value)}}),this.addStrConfigProp("isoListTailingBracket",NL.ISO_LIST_TAILING_BRACKET,{getter:function(){return NL.ISO_LIST_TAILING_BRACKET},setter:function(value){value&&(NL.ISO_LIST_TAILING_BRACKET=value)}}),this.addStrConfigProp("isoListDelimiter",NL.ISO_LIST_DELIMITER,{getter:function(){return NL.ISO_LIST_DELIMITER},setter:function(value){value&&(NL.ISO_LIST_DELIMITER=value)}}),this.addStrConfigProp("isoListDisallowPrefix",NL.ISO_LIST_DISALLOW_PREFIX,{getter:function(){return NL.ISO_LIST_DISALLOW_PREFIX},setter:function(value){value&&(NL.ISO_LIST_DISALLOW_PREFIX=value)}})}}),Kekule.Render.TextFontConfigs=Class.create(Kekule.AbstractConfigs,{CLASS_NAME:"Kekule.Render.TextFontConfigs",DEF_LABEL_FONT_FAMILY:"",initProperties:function(){this.addStrConfigProp("labelFontFamily","Arial, Helvetica, sans-serif"),this.addStrConfigProp("atomFontFamily","Arial, Helvetica, sans-serif"),this.addFloatConfigProp("supFontSizeRatio",.66),this.addFloatConfigProp("subFontSizeRatio",.66),this.addFloatConfigProp("superscriptOverhang",.2),this.addFloatConfigProp("subscriptOversink",.2),this.addIntConfigProp("textCharDirection",Kekule.Render.TextDirection.LTR,{enumSource:Kekule.Render.TextDirection}),this.addIntConfigProp("textHorizontalAlign",Kekule.Render.TextAlign.LEADING,{enumSource:Kekule.Render.TextAlign}),this.addIntConfigProp("textVerticalAlign",Kekule.Render.TextAlign.LEADING,{enumSource:Kekule.Render.TextAlign}),this.addIntConfigProp("textBoxXAlignment",Kekule.Render.BoxXAlignment.LEFT,{enumSource:Kekule.Render.BoxXAlignment,scope:PS.PUBLIC}),this.addIntConfigProp("textBoxYAlignment",Kekule.Render.BoxYAlignment.TOP,{enumSource:Kekule.Render.BoxYAlignment,scope:PS.PUBLIC}),this.addIntConfigProp("textBoxAlignmentMode",Kekule.Render.TextBoxAlignmentMode.ANCHOR,{enumSource:Kekule.Render.TextBoxAlignmentMode,scope:PS.PUBLIC})}}),Kekule.Render.LengthConfigs=Class.create(Kekule.AbstractConfigs,{CLASS_NAME:"Kekule.Render.LengthConfigs",initProperties:function(){this.addFloatConfigProp("unitLength",1,{scope:PS.PUBLIC}),this.addFloatConfigProp("labelFontSize",14),this.addFloatConfigProp("atomFontSize",14),this.addFloatConfigProp("atomLabelBoxExpandRatio",1.2,{scope:PS.PUBLIC}),this.addFloatConfigProp("chargeMarkFontSize",10),this.addFloatConfigProp("chargeMarkMargin",5),this.addFloatConfigProp("chemMarkerFontSize",10),this.addFloatConfigProp("chemMarkerMargin",5),this.addFloatConfigProp("allenCenterAtomRadius",3),this.addFloatConfigProp("defBondLength",25),this.addFloatConfigProp("bondLineWidth",1),this.addFloatConfigProp("boldBondLineWidthRatio",2,{scope:PS.PUBLIC}),this.addFloatConfigProp("hashSpacing",3),this.addFloatConfigProp("multipleBondSpacingRatio",.18),this.addFloatConfigProp("multipleBondSpacingAbs",null,{scope:PS.PUBLIC}),this.addFloatConfigProp("multipleBondMaxAbsSpacing",5),this.addFloatConfigProp("bondArrowLength",6),this.addFloatConfigProp("bondArrowWidth",6),this.addFloatConfigProp("bondWedgeWidth",6),this.addFloatConfigProp("bondWedgeHashMinWidth",2),this.addFloatConfigProp("bondWavyRadius",5),this.addFloatConfigProp("glyphStrokeWidth",1),this.addFloatConfigProp("rxnMolMargin",10,{scope:PS.PUBLIC}),this.addFloatConfigProp("defScaleRefLength",.8),this.addFloatConfigProp("autofitContextPadding",45)},getActualLength:function(propName){var v=this.getPropValue(propName);return null!==v&&void 0!==v?v*this.getUnitLength():null}}),Kekule.Render.ColorConfigs=Class.create(Kekule.AbstractConfigs,{CLASS_NAME:"Kekule.Render.ColorConfigs",initProperties:function(){this.addBoolConfigProp("useAtomSpecifiedColor",!1),this.addStrConfigProp("labelColor","#000000"),this.addStrConfigProp("atomColor","#000000"),this.addStrConfigProp("bondColor","#000000"),this.addStrConfigProp("glyphStrokeColor","#999999"),this.addStrConfigProp("glyphFillColor","#999999")}}),Kekule.Render.Render3DConfigs=Class.create(Kekule.AbstractConfigs,{CLASS_NAME:"Kekule.Render.Render3DConfigs",initProperties:function(){this.addConfigProp("generalConfigs","Kekule.Render.GeneralConfigs"),this.addConfigProp("moleculeDisplayConfigs","Kekule.Render.Molecule3DDisplayConfigs"),this.addConfigProp("lengthConfigs","Kekule.Render.Length3DConfigs"),this.addConfigProp("environmentConfigs","Kekule.Render.Render3DEnvironmentConfigs"),this.addConfigProp("modelConfigs","Kekule.Render.Model3DConfigs")},initPropValues:function($super){$super(),this.setPropStoreFieldValue("generalConfigs",new Kekule.Render.GeneralConfigs),this.setPropStoreFieldValue("environmentConfigs",new Kekule.Render.Render3DEnvironmentConfigs),this.setPropStoreFieldValue("moleculeDisplayConfigs",new Kekule.Render.Molecule3DDisplayConfigs),this.setPropStoreFieldValue("modelConfigs",new Kekule.Render.Model3DConfigs),this.setPropStoreFieldValue("lengthConfigs",new Kekule.Render.Length3DConfigs)}}),Kekule.ClassUtils.makeSingleton(Kekule.Render.Render3DConfigs),Kekule.Render.getRender3DConfigs=function(){return Kekule.Render.Render3DConfigs.getInstance()},Kekule.Render.Render3DEnvironmentConfigs=Class.create(Kekule.AbstractConfigs,{CLASS_NAME:"Kekule.Render.Render3DEnvironmentConfigs",initProperties:function(){this.addIntConfigProp("graphicQuality",Kekule.Render.Render3DGraphicQuality.MEDIUM,{enumSource:Kekule.Render.Render3DGraphicQuality})}}),Kekule.Render.Molecule3DDisplayConfigs=Class.create(Kekule.AbstractConfigs,{CLASS_NAME:"Kekule.Render.Molecule3DDisplayConfigs",initProperties:function(){this.addIntConfigProp("defMoleculeDisplayType",Kekule.Render.Molecule3DDisplayType.BALL_STICK,{enumSource:Kekule.Render.Molecule3DDisplayType}),this.addIntConfigProp("defBondSpliceMode",Kekule.Render.Bond3DSpliceMode.WEIGHTING_SPLIT,{enumSource:Kekule.Render.Bond3DSpliceMode}),this.addBoolConfigProp("defDisplayMultipleBond",!0),this.addStrConfigProp("defBondColor","#FFFFFF"),this.addStrConfigProp("defAtomColor","#000099"),this.addBoolConfigProp("useAtomSpecifiedColor",!0)}}),Kekule.Render.Model3DConfigs=Class.create(Kekule.AbstractConfigs,{CLASS_NAME:"Kekule.Render.Model3DConfigs",initProperties:function(){this.addBoolConfigProp("showNodeLabel",!0,{scope:PS.PUBLIC}),this.addBoolConfigProp("hideHydrogens",!1),this.addBoolConfigProp("useVdWRadius",!0),this.addFloatConfigProp("nodeRadiusRatio",.25,{scope:PS.PUBLIC}),this.addFloatConfigProp("connectorRadiusRatio",.25,{scope:PS.PUBLIC}),this.addFloatConfigProp("multiConnectorRadiusRatio",.5),this.addFloatConfigProp("multiConnectorMarginRatio",1)}}),Kekule.Render.Length3DConfigs=Class.create(Kekule.AbstractConfigs,{CLASS_NAME:"Kekule.Render.Length3DConfigs",initProperties:function(){this.addFloatConfigProp("unitLength",1,{scope:PS.PUBLIC}),this.addFloatConfigProp("fixedNodeRadius",1.7),this.addFloatConfigProp("connectorRadius",.6),this.addFloatConfigProp("connectorLineWidth",2),this.addFloatConfigProp("defBondLength",100,{scope:PS.PUBLIC})},getActualLength:function(propName){var v=this.getPropValue(propName);return null!==v&&void 0!==v?v*this.getUnitLength():null}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,ObjectEx=__webpack_require__(0).ObjectEx;module.exports=function(Kekule){var RT=Kekule.Render.RichText,RTU=Kekule.Render.RichTextUtils,TD=Kekule.Render.TextDirection,TDU=Kekule.Render.TextDrawUtils,TA=Kekule.Render.TextAlign;return Kekule.Render.AbstractTextDrawBridge=Class.create({CLASS_NAME:"Kekule.Render.AbstractTextDrawBridge",drawText:function(context,coord,text,options){return null},canMeasureText:function(context){return!1},measureText:function(context,text,options){return{}},canMeasureDrawnText:function(context){return!1},measureDrawnText:function(context,textElem,options){return{}},canModifyText:function(context){return!1},modifyDrawnTextCoord:function(context,textElem,newCoord){},createGroup:function(context){},addToGroup:function(elem,group){},removeFromGroup:function(elem,group){}}),Kekule.Render.BaseRichTextDrawer=Class.create(ObjectEx,{CLASS_NAME:"Kekule.Render.BaseRichTextDrawer",ITEM_PARENT_FIELD:"__$parent__",initialize:function($super,bridge,options,drawConfigs){$super(),this.options=options||{},bridge&&this.setDrawBridge(bridge),drawConfigs&&this.setDrawConfigs(drawConfigs)},initProperties:function(){this.defineProp("drawBridge",{dataType:"Kekule.Render.AbstractTextDrawBridge",serializable:!1}),this.defineProp("drawConfigs",{dataType:"Kekule.Render.Render2DConfigs",serializable:!1})},fillOptions:function(renderConfig){if(renderConfig){var textFontConfig=renderConfig.getTextFontConfigs(),options=this.options;options.supFontSizeRatio=textFontConfig.getSupFontSizeRatio(),options.subFontSizeRatio=textFontConfig.getSubFontSizeRatio(),options.superscriptOverhang=textFontConfig.getSuperscriptOverhang(),options.subscriptOversink=textFontConfig.getSubscriptOversink(),options.textCharDirection=textFontConfig.getTextCharDirection(),options.textLineDirection=textFontConfig.getTextLineDirection(),options.textHorizontalAlign=textFontConfig.getTextHorizontalAlign(),options.textVerticalAlign=textFontConfig.getTextVerticalAlign(),options.textBoxXAlignment=textFontConfig.getTextBoxXAlignment(),options.textBoxYAlignment=textFontConfig.getTextBoxYAlignment(),options.textBoxAlignmentMode=textFontConfig.getTextBoxAlignmentMode()}},cloneRichText:function(src){return Kekule.Render.RichTextUtils.clone(src)},_FONT_OPTION_FIELDS:["fontSize","fontFamily","fontWeight","fontStyle","color","overhang","oversink","opacity","zoom"],_DRAW_OPTIONS_FIELDS:["textType","charDirection","defaultCharDirection","fontSize","fontFamily","fontWeight","fontStyle","color","horizontalAlign","verticalAlign","zoom"],_fillLocalDrawOptions:function(richTextItem,options){for(var result=options||{},fieldCount=0,i=0,l=this._DRAW_OPTIONS_FIELDS.length;i<l;++i){var prop=this._DRAW_OPTIONS_FIELDS[i],value=richTextItem[prop];Kekule.ObjUtils.notUnset(value)&&(result[prop]=value,++fieldCount)}return Kekule.ObjUtils.isUnset(richTextItem.charDirection)?result.charDirection=TD.DEFAULT:richTextItem.charDirection===TD.INHERIT&&(result.charDirection=options.charDirection),result},RECT_INFO_FIELD:"__rectInfo__",ACTUAL_FONT_FIELD:"__drawFont__",RENDER_TEXT_FIELD:"__renderText__",RENDER_ELEM_FIELD:"__renderElem__",LOCAL_DRAW_OPTIONS_FIELD:"__drawOptions__",_setItemRectInfo:function(richTextItem,boundRect,alignRect){richTextItem[this.RECT_INFO_FIELD]={boundRect:Object.extend({},boundRect),alignRect:Object.extend({},alignRect)}},_getItemRectInfo:function(richTextItem){return richTextItem[this.RECT_INFO_FIELD]},_setActualFontInfo:function(richTextItem,info){richTextItem[this.ACTUAL_FONT_FIELD]=info},_getActualFontInfo:function(richTextItem){return richTextItem[this.ACTUAL_FONT_FIELD]},_setRenderText:function(richTextItem,text){richTextItem[this.RENDER_TEXT_FIELD]=text},_getRenderText:function(richTextItem){return richTextItem[this.RENDER_TEXT_FIELD]||richTextItem.text},_setRenderElem:function(richTextItem,elem){richTextItem[this.RENDER_ELEM_FIELD]=elem},_getRenderElem:function(richTextItem){return richTextItem[this.RENDER_ELEM_FIELD]},_itemHasNoAlignRect:function(richTextItem){return Kekule.ObjUtils.notUnset(richTextItem._noAlignRect)?!!richTextItem._noAlignRect:RTU.isSubscript(richTextItem)||RTU.isSuperscript(richTextItem)},drawEx:function(context,coord,richText,options,drawConfigs){var ops;options?(ops=Object.create(this.options||{}),ops=Object.extend(ops,options)):ops=this.options,ops.defaultCharDirection||(ops.defaultCharDirection=ops.charDirection);var destRichText=this.cloneRichText(richText),bridge=this.getDrawBridge(),drawMode={delayDrawing:bridge.canMeasureText(),adjustDrawing:bridge.canModifyText()};return this.doPrepare(context,coord,destRichText,ops,drawMode),{drawnObj:this.doRenderRichText(context,destRichText,ops,drawMode),boundRect:this._getItemRectInfo(destRichText).boundRect}},draw:function(context,coord,richText,options,drawConfigs){return this.drawEx(context,coord,richText,options,drawConfigs).drawnObj},doPrepare:function(context,coord,richText,options,drawMode){var result=this.doPrepareItem(context,richText,options,drawMode),anchorAlignRect=null;options.textBoxAlignmentMode===Kekule.Render.TextBoxAlignmentMode.ANCHOR&&(anchorAlignRect=this.doGetRootAnchorItemAbsAlignRect(richText));var delta,rectInfo=this._getItemRectInfo(richText);if(anchorAlignRect){var newAnchorAlignRect=this.doAlignRectToCoord(coord,anchorAlignRect,options.textBoxXAlignment,options.textBoxYAlignment);delta={x:newAnchorAlignRect.left-anchorAlignRect.left,y:newAnchorAlignRect.top-anchorAlignRect.top}}else{var newAlignRect=this.doAlignRectToCoord(coord,rectInfo.alignRect,options.textBoxXAlignment,options.textBoxYAlignment);delta={x:newAlignRect.left-rectInfo.alignRect.left,y:newAlignRect.top-rectInfo.alignRect.top}}var alignRect=Kekule.RectUtils.shiftRect(rectInfo.alignRect,delta.x,delta.y),boundRect=Kekule.RectUtils.shiftRect(rectInfo.boundRect,delta.x,delta.y);return this._setItemRectInfo(richText,boundRect,alignRect),result},doAlignRectToCoord:function(coord,rect,xAlignment,yAlignment){var XA=Kekule.Render.BoxXAlignment,YA=Kekule.Render.BoxYAlignment,xAdjustRatio=xAlignment===XA.RIGHT?-1:xAlignment===XA.CENTER?-.5:0,yAdjustRatio=yAlignment===YA.TOP?0:yAlignment===YA.CENTER?-.5:-1,result=Object.extend({},rect);return result.left=coord.x+result.width*xAdjustRatio,result.top=coord.y+result.height*yAdjustRatio,result},doGetRootAnchorItemAbsAlignRect:function(richText){var curr=richText;if(curr.anchorItem){for(var currRect=this._getItemRectInfo(curr).alignRect,coord={x:currRect.left,y:currRect.top};curr.anchorItem;)curr=curr.anchorItem,currRect=this._getItemRectInfo(curr).alignRect,coord.x+=currRect.left,coord.y+=currRect.top;return Kekule.RectUtils.createRect(coord.x,coord.y,currRect.width,currRect.height)}return null},doCalcActualDrawFontInfo:function(richTextItem,ops){function _multipyFontSize(fontSize,times){if("string"==typeof fontSize){var details=Kekule.StyleUtils.analysisUnitsValue(fontSize);return details.value=Math.round(Math.max(details.value*times,1)),""+details.value+details.units}return fontSize*times}for(var result={sizeScale:1},i=0,l=this._FONT_OPTION_FIELDS.length;i<l;++i){var prop=this._FONT_OPTION_FIELDS[i];Kekule.ObjUtils.notUnset(ops[prop])&&(result[prop]=ops[prop])}return Kekule.ObjUtils.notUnset(ops.zoom)&&(result.fontSize=_multipyFontSize(result.fontSize,ops.zoom||1)),RTU.isSuperscript(richTextItem)?(result.sizeScale=ops.supFontSizeRatio,result.fontSize=_multipyFontSize(result.fontSize,ops.supFontSizeRatio),result.isSup=!0,Kekule.ObjUtils.isUnset(result.overhang)&&(result.overhang=ops.superscriptOverhang||0)):RTU.isSubscript(richTextItem)&&(result.sizeScale=ops.subFontSizeRatio,result.fontSize=_multipyFontSize(result.fontSize,ops.subFontSizeRatio),result.isSub=!0,Kekule.ObjUtils.isUnset(result.oversink)&&(result.oversink=ops.subscriptOversink||0)),result},doPrepareItem:function(context,item,options,drawMode){var itemType=RTU.getItemType(item),ops=Object.create(options);ops=this._fillLocalDrawOptions(item,ops),(ops.charDirection===TD.DEFAULT||Kekule.ObjUtils.isUnset(ops.charDirection))&&(ops.charDirection=ops.defaultCharDirection);var result;switch(itemType){case RT.SECTION:result=this.doPrepareSection(context,item,ops,drawMode);break;case RT.LINES:result=this.doPrepareLines(context,item,ops,drawMode);break;default:result=this.doPrepareGroup(context,item,ops,drawMode)}return result},doPrepareSection:function(context,section,drawOptions,drawMode){var bridge=this.getDrawBridge(),actualFontInfo=this.doCalcActualDrawFontInfo(section,drawOptions);this._setActualFontInfo(section,actualFontInfo);var text=section.text;if(TDU.isVerticalLine(drawOptions.charDirection)&&text.length>1){var group=section;group.role="group",delete group.text,group.charDirection=drawOptions.charDirection;var newDrawOptions=Object.create(drawOptions);newDrawOptions=Object.extend(newDrawOptions,actualFontInfo),group.items=[];for(var i=0,l=text.length;i<l;++i)RTU.appendText(group,text.charAt(i));return this.doPrepareItem(context,group,newDrawOptions,drawMode)}drawOptions.charDirection===TD.RTL&&(text=text.reverse()),this._setRenderText(section,text);var textDimension;if(drawMode.delayDrawing)textDimension=bridge.measureText(context,text,actualFontInfo);else{var offScreenCoord={x:-1e4,y:-1e4},drawElem=this.getDrawBridge().drawText(context,offScreenCoord,text,actualFontInfo);this._setRenderElem(section,drawElem),textDimension=bridge.measureDrawnText(context,drawElem,actualFontInfo)}var sectionRect={left:0,top:0,width:textDimension.width||0,height:textDimension.height||0};this._setItemRectInfo(section,sectionRect,sectionRect)},doPrepareLines:function(context,group,drawOptions,drawMode){for(var charDirection=drawOptions.charDirection||TD.DEFAULT,items=group.items,lineDirection=charDirection===TD.TTB?TD.RTL:charDirection===TD.BTT?TD.LTR:TD.TTB,i=0,l=items.length;i<l;++i){var item=items[i];item.charDirection||(item.charDirection=charDirection)}return group.charDirection=lineDirection,drawOptions.charDirection=lineDirection,drawOptions._originCharDirection=charDirection,this.doPrepareGroup(context,group,drawOptions,drawMode)},doPrepareGroup:function(context,group,drawOptions,drawMode){for(var items=group.items,i=0,l=items.length;i<l;++i){var item=items[i];this.doPrepareItem(context,item,drawOptions,drawMode)}var secDirAdjustRatio,direction=drawOptions.charDirection||TD.DEFAULT,charDirection=drawOptions._originCharDirection||direction,isHorizontalLine=TDU.isHorizontalLine(direction),priDirCoord=isHorizontalLine?"x":"y",secDirCoord=isHorizontalLine?"y":"x",hAlign=TA.getAbsAlign(drawOptions.horizontalAlign,charDirection),vAlign=TA.getAbsAlign(drawOptions.verticalAlign,charDirection);secDirAdjustRatio=isHorizontalLine?vAlign==TA.TOP?0:vAlign==TA.CENTER?-.5:-1:hAlign==TA.RIGHT?-1:hAlign==TA.CENTER?-.5:0;for(var offset={x:0,y:0},priDirFactor=direction===TD.RTL||direction===TD.BTT?-1:1,priDimensionDir=isHorizontalLine?"left":"top",secDimensionDir=isHorizontalLine?"top":"left",supSubItems=[],i=0,l=items.length;i<l;++i){var item=items[i],rectInfo=this._getItemRectInfo(item),boundRect=rectInfo.boundRect,alignRect=rectInfo.alignRect;if(priDirFactor>0){var deltaPriDir=offset[priDirCoord]-boundRect[priDimensionDir];boundRect[priDimensionDir]=offset[priDirCoord],alignRect[priDimensionDir]+=deltaPriDir}var dimension={x:boundRect.width,y:boundRect.height};if(offset[priDirCoord]+=dimension[priDirCoord]*priDirFactor,priDirFactor<0){var deltaPriDir=offset[priDirCoord]-boundRect[priDimensionDir];boundRect[priDimensionDir]=offset[priDirCoord],alignRect[priDimensionDir]+=deltaPriDir}var dimension={x:alignRect.width,y:alignRect.height},fontInfo=this._getActualFontInfo(item);if(!!fontInfo&&(fontInfo.isSup||fontInfo.isSub)&&RTU.getActualRefItem(item,group))supSubItems.push(item);else{var oversink=fontInfo?fontInfo.oversink||-(fontInfo.overhang||0):0;isHorizontalLine||(oversink=-oversink);var secDirPos=dimension[secDirCoord]*(secDirAdjustRatio+oversink),delta=alignRect[secDimensionDir]-secDirPos;alignRect[secDimensionDir]=secDirPos,boundRect[secDimensionDir]-=delta}}for(var i=0,l=supSubItems.length;i<l;++i){var item=supSubItems[i],refItem=RTU.getActualRefItem(item,group),fontInfo=this._getActualFontInfo(item),rectInfo=this._getItemRectInfo(item),refRect=this._getItemRectInfo(refItem).alignRect,boundRect=rectInfo.boundRect,alignRect=rectInfo.alignRect;if(fontInfo.isSup){var overhang=fontInfo.overhang;isHorizontalLine?(alignRect.top=refRect.top,alignRect.height=refRect.height,boundRect.top=refRect.top-refRect.height*overhang):(alignRect.left=refRect.left,alignRect.width=refRect.width,boundRect.left=refRect.lefy+refRect.width-boundRect.left+refRect.width*overhang)}else{var oversink=fontInfo.oversink;isHorizontalLine?(alignRect.top=refRect.top,alignRect.height=refRect.height,boundRect.top=refRect.top+refRect.height-boundRect.height+refRect.height*oversink):(alignRect.left=refRect.left,alignRect.width=refRect.width,boundRect.left=refRect.left-refRect.width*oversink)}}for(var items=group.items,gAlignRect=null,gBoundRect=null,i=0,l=items.length;i<l;++i){var item=items[i];rectInfo=this._getItemRectInfo(item),this._itemHasNoAlignRect(item)&&(gAlignRect||i!=l-1)||(gAlignRect=gAlignRect?Kekule.RectUtils.getContainerRect(gAlignRect,rectInfo.alignRect):Object.extend({},rectInfo.alignRect)),gBoundRect=gBoundRect?Kekule.RectUtils.getContainerRect(gBoundRect,rectInfo.boundRect):Object.extend({},rectInfo.boundRect)}items.length<=0&&(gAlignRect=Kekule.RectUtils.createRect(0,0,0,0),gBoundRect=Kekule.RectUtils.createRect(0,0,0,0));var delta={x:-gAlignRect.left,y:-gAlignRect.top};if(0!==delta.x||0!==delta.y){for(var i=0,l=items.length;i<l;++i)rectInfo=this._getItemRectInfo(items[i]),rectInfo.alignRect=Kekule.RectUtils.shiftRect(rectInfo.alignRect,delta.x,delta.y),rectInfo.boundRect=Kekule.RectUtils.shiftRect(rectInfo.boundRect,delta.x,delta.y);gAlignRect.left=0,gAlignRect.top=0,gBoundRect.left+=delta.x,gBoundRect.top+=delta.y}this._setItemRectInfo(group,gBoundRect,gAlignRect)},doRenderRichText:function(context,richText,options,drawMode){var bridge=this.getDrawBridge(),drawGroup=bridge.createGroup(context);return this.doRenderItem(context,{x:0,y:0},richText,drawMode,drawGroup),drawGroup},doRenderItem:function(context,baseCoord,item,drawMode,drawGroup){var result,itemType=RTU.getItemType(item);switch(itemType){case RT.SECTION:result=this.doRenderSection(context,baseCoord,item,drawMode,drawGroup);break;default:result=this.doRenderGroup(context,baseCoord,item,drawMode,drawGroup)}return result},doRenderGroup:function(context,baseCoord,group,drawMode,drawGroup){var items=group.items;if(items.length<=0)return null;for(var groupRectInfo=this._getItemRectInfo(group),shiftCoord={x:baseCoord.x+groupRectInfo.alignRect.left,y:baseCoord.y+groupRectInfo.alignRect.top},i=0,l=items.length;i<l;++i)this.doRenderItem(context,shiftCoord,items[i],drawMode,drawGroup)},doRenderSection:function(context,baseCoord,item,drawMode,drawGroup){var rectInfo=this._getItemRectInfo(item),boundRect=rectInfo.boundRect,absCoord={x:boundRect.left,y:boundRect.top};absCoord=Kekule.CoordUtils.add(absCoord,baseCoord);var textElem,text=this._getRenderText(item),fontInfo=this._getActualFontInfo(item),bridge=this.getDrawBridge();drawMode.delayDrawing?textElem=bridge.drawText(context,absCoord,text,fontInfo):drawMode.adjustDrawing&&(textElem=this._getRenderElem(item),bridge.modifyDrawnTextCoord(context,textElem,absCoord)),bridge.addToGroup(textElem,drawGroup)}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,ObjectEx=(__webpack_require__(0).ClassEx,__webpack_require__(0).ObjectEx),DataType=__webpack_require__(0).DataType;module.exports=function(Kekule){return Kekule.Render.BoundInfoRecorder=Class.create(ObjectEx,{CLASS_NAME:"Kekule.Render.BoundInfoRecorder",initialize:function($super,rendererOrPainter){$super(),this.setPropStoreFieldValue("boundInfos",new Kekule.TwoTupleMapEx(!0)),this._renderer=rendererOrPainter,this.installEventListener(rendererOrPainter)},finalize:function($super){var infos=this.getPropStoreFieldValue("boundInfos");infos&&infos.clear(),$super()},initProperties:function(){this.defineProp("boundInfos",{dataType:"Kekule.TwoTupleMapEx",serializable:!1,setter:null}),this.defineProp("targetContext",{dataType:DataType.OBJECT,serializable:!1})},needRecordOnContext:function(context){var target=this.getTargetContext();return!target||target===context},installEventListener:function(renderer){renderer.addEventListener("updateBasicDrawObject",function(e){var OT=Kekule.Render.ObjectUpdateType;if(this.needRecordOnContext(e.context)){var utype=e.updateType;utype===OT.ADD?this.add(e.context,e.obj,e.parentObj,e.boundInfo,e.target):utype===OT.MODIFY?this.modify(e.context,e.obj,e.parentObj,e.boundInfo,e.target):utype===OT.REMOVE?this.remove(e.context,e.obj):utype===OT.CLEAR&&this.clear(e.context),this.invokeEvent("updateBasicDrawObject",e)}},this),renderer.addEventListener("clear",function(e){this.needRecordOnContext(e.context)&&this.clearOnRenderer(e.context,e.target);this.getAllRecordedInfoOfContext(e.context)},this)},getInfo:function(context,obj){return this.getBoundInfos().get(context,obj)},getBelongedInfos:function(context,objOrParentObj){var info=this.getInfo(context,objOrParentObj);if(info)return[info];for(var result=[],infos=this.getAllRecordedInfoOfContext(context),i=0,l=infos.length;i<l;++i){var info=infos[i];info.obj.isChildOf(objOrParentObj)&&result.push(info)}return result},getBound:function(context,obj){var info=this.getInfo(context,obj),result=info?info.boundInfo:null;if(!result){for(var BU=Kekule.BoxUtils,MU=Kekule.Render.MetaShapeUtils,infos=this.getBelongedInfos(context,obj),containerBox=null,i=0,l=infos.length;i<l;++i){var info=infos[i],box=MU.getContainerBox(info.boundInfo,0);containerBox=containerBox?BU.getContainerBox(containerBox,box):box}containerBox&&(result=MU.createShapeInfo(Kekule.Render.MetaShapeType.RECT,[{x:containerBox.x1,y:containerBox.y1},{x:containerBox.x2,y:containerBox.y2}]))}return result},clearOnRenderer:function(context,renderer){var infos=this.getBoundInfos(),map=infos.getSecondLevelMap(context);if(map)for(var objs=map.getKeys(),infos=map.getValues(),i=objs.length-1;i>=0;--i){var obj=objs[i],info=infos[i];info.renderer===renderer&&map.remove(obj)}},clear:function(context){var infos=this.getBoundInfos(),map=infos.getSecondLevelMap(context);return map&&map.clear(),this},clearAll:function(){return this.getBoundInfos().clear(),this},add:function(context,obj,parentObj,boundInfo,renderer){return this.getBoundInfos().set(context,obj,{obj:obj,parentObj:parentObj,boundInfo:boundInfo,renderer:renderer}),this},modify:function(context,obj,parentObj,boundInfo,renderer){var item=this.getBoundInfos().get(context,obj);item||(item={},this.getBoundInfos.set(context,obj,item));var notUnset=Kekule.ObjUtils.notUnset;return notUnset(parentObj)&&(item.parentObj=parentObj),notUnset(boundInfo)&&(item.boundInfo=boundInfo),notUnset(renderer)&&(item.renderer=renderer),this},remove:function(context,obj,parentObj){return this.getBoundInfos().remove(context,obj),this},getAllRecordedInfoOfContext:function(context){var infos=this.getBoundInfos(),map=infos.getSecondLevelMap(context);return map?map.values:[]},getAllBoundInfosOfContext:function(context){for(var infos=this.getAllRecordedInfoOfContext(context),result=[],i=0,l=infos.length;i<l;++i){var boundInfo=infos[i].boundInfo;boundInfo&&result.push(boundInfo)}return result},getContainerBox:function(context){for(var BU=Kekule.BoxUtils,MU=Kekule.Render.MetaShapeUtils,result=null,infos=this.getAllBoundInfosOfContext(context),i=0,l=infos.length;i<l;++i){var box=MU.getContainerBox(infos[i],0);result=BU.getContainerBox(result,box)}return result},getIntersectionInfos:function(context,coord,refCoord,inflation,filterFunc){for(var result=[],infos=this.getAllRecordedInfoOfContext(context),i=0,l=infos.length;i<l;++i){var bound=infos[i].boundInfo;filterFunc&&!filterFunc(infos[i])||bound&&Kekule.Render.MetaShapeUtils.isCoordInside(coord,bound,inflation)&&result.push(infos[i])}return result}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,DataType=__webpack_require__(0).DataType;module.exports=function(Kekule){var RT=Kekule.Render.BondRenderType,D=Kekule.Render.TextDirection,BU=Kekule.BoxUtils,BO=Kekule.BondOrder,CU=Kekule.CoordUtils,oneOf=Kekule.oneOf;return Kekule.Render.Abstract2DDrawBridge=Class.create({CLASS_NAME:"Kekule.Render.Abstract2DDrawBridge",createContext:function(parentElem,width,height){return null},releaseContext:function(context){},getContextDimension:function(context){return{}},setContextDimension:function(context,width,height){return null},getContextElem:function(context){},setContextViewBox:function(context,x,y,w,h,changeDimension){},clearContext:function(context){return null},setClearColor:function(context,color){},transformContextCoordToScreen:function(context,coord){return coord},transformScreenCoordToContext:function(context,coord){return coord},canModifyGraphic:function(context){return!1},drawPath:function(context,path,options){},drawLine:function(context,coord1,coord2,options){},drawTriangle:function(context,coord1,coord2,coord3,options){},drawRect:function(context,coord1,coord2,options){},drawRoundRect:function(context,coord1,coord2,cornerRadius,options){},drawCircle:function(context,baseCoord,radius,options){},drawImage:function(context,src,baseCoord,size,options,callback){},drawImageElem:function(context,imgElem,baseCoord,size,options){},createGroup:function(context){return null},addToGroup:function(elem,group){},removeFromGroup:function(elem,group){},removeDrawnElem:function(context,elem){},exportToDataUri:function(context,dataType,options){}}),Kekule.Render.Base2DRenderer=Class.create(Kekule.Render.CompositeRenderer,{CLASS_NAME:"Kekule.Render.Base2DRenderer",initialize:function($super,chemObj,drawBridge,parent){$super(chemObj,drawBridge,parent),this.__$redirectContextDebug__=!1,this._richTextDrawer=null},initProperties:function(){this.defineProp("richTextDrawerClass",{dataType:DataType.CLASS,serializable:!1})},getActualTargetContext:function(context){return this.getRedirectContext()||context},getRendererType:function(){return Kekule.Render.RendererType.R2D},canMeasureText:function(context){return this.getDrawBridge().canMeasureText(context)},getAutoScaleRefDrawLength:function(drawOptions){return drawOptions.defBondLength},getAutoScaleRefObjLength:function(chemObj,allowCoordBorrow){var obj=chemObj||this.getChemObj();if(!obj.getAllAutoScaleRefLengths)return null;var lengths=obj.getAllAutoScaleRefLengths(Kekule.CoordMode.COORD2D,allowCoordBorrow);return lengths&&lengths.length?Kekule.ArrayUtils.getMedian(lengths):void 0},getRichTextDrawer:function(){if(!this._richTextDrawer){var C=this.getRichTextDrawerClass()||Kekule.Render.BaseRichTextDrawer;this._richTextDrawer=new C(this.getDrawBridge())}return this._richTextDrawer},drawPath:function(context,path,options){return this.getDrawBridge().drawPath(this.getActualTargetContext(context),path,options)},drawLine:function(context,coord1,coord2,options){if(this.__$redirectContextDebug__){var op=Object.create(options);return this.getRedirectContext()&&(op.color=op.strokeColor="#ff0000"),this.getDrawBridge().drawLine(this.getActualTargetContext(context),coord1,coord2,op)}return this.getDrawBridge().drawLine(this.getActualTargetContext(context),coord1,coord2,options)},drawArrowLine:function(context,coord1,coord2,arrowParams,options){var ctx=this.getActualTargetContext(context);if(arrowParams){var result=this.createDrawGroup(ctx),line=this.drawLine(ctx,coord1,coord2,options);this.addToDrawGroup(line,result);var dx=coord2.x-coord1.x,dy=coord2.y-coord1.y,alpha=Math.atan(dy/dx),sign=Math.sign(dx)||1,width=(arrowParams.width||6)/2,length=arrowParams.length||3,beta=Math.atan(width/length),l=Math.sqrt(Math.sqr(width)+Math.sqr(length))*sign,lcos1=Math.cos(alpha-beta)*l,lsin1=Math.sin(alpha-beta)*l,lcos2=Math.cos(alpha+beta)*l,lsin2=Math.sin(alpha+beta)*l;return line=this.drawLine(ctx,coord2,{x:coord2.x-lcos1,y:coord2.y-lsin1},options),this.addToDrawGroup(line,result),line=this.drawLine(ctx,coord2,{x:coord2.x-lcos2,y:coord2.y-lsin2},options),this.addToDrawGroup(line,result),result}return this.drawLine(ctx,coord1,coord2,options)},drawTriangle:function(context,coord1,coord2,coord3,options){return this.getDrawBridge().drawTriangle(this.getActualTargetContext(context),coord1,coord2,coord3,options)},drawRect:function(context,coord1,coord2,options){var c1={x:Math.min(coord1.x,coord2.x),y:Math.min(coord1.y,coord2.y)},c2={x:Math.max(coord1.x,coord2.x),y:Math.max(coord1.y,coord2.y)};return this.getDrawBridge().drawRect(this.getActualTargetContext(context),c1,c2,options)},drawRoundRect:function(context,coord1,coord2,cornerRadius,options){var c1={x:Math.min(coord1.x,coord2.x),y:Math.min(coord1.y,coord2.y)},c2={x:Math.max(coord1.x,coord2.x),y:Math.max(coord1.y,coord2.y)};return this.getDrawBridge().drawRoundRect(this.getActualTargetContext(context),c1,c2,cornerRadius,options)},drawCircle:function(context,baseCoord,radius,options){return this.getDrawBridge().drawCircle(this.getActualTargetContext(context),baseCoord,radius,options)},drawText:function(context,coord,text,options){var drawer=this.getRichTextDrawer(),rt=Kekule.Render.RichTextUtils.strToRichText(text,options);if(this.__$redirectContextDebug__){var op=Object.create(options||{});return this.getRedirectContext()&&(op.color=op.strokeColor="#ff0000"),drawer.drawEx(this.getActualTargetContext(context),coord,rt,op)}return drawer.drawEx(this.getActualTargetContext(context),coord,rt,options)},drawRichText:function(context,coord,richText,options){var drawer=this.getRichTextDrawer();if(this.__$redirectContextDebug__){var op=Object.create(options||{});return this.getRedirectContext()&&(op.color=op.strokeColor="#ff0000"),drawer.drawEx(this.getActualTargetContext(context),coord,richText,op)}return drawer.drawEx(this.getActualTargetContext(context),coord,richText,options)},drawImage:function(context,src,baseCoord,size,options,callback){var self=this;return this.getDrawBridge().drawImage(this.getActualTargetContext(context),src,baseCoord,size,options,callback,function(){return self.getActualTargetContext(context)})},drawImageElem:function(context,imgElem,baseCoord,size,options){if(imgElem.complete)return this.getDrawBridge().drawImageElem(this.getActualTargetContext(context),imgElem,baseCoord,size,options);var XEvent=Kekule.X.Event;if(XEvent){var self=this,unlinkImgDrawProc=function(){XEvent.removeListener(imgElem,"load",updateImgDrawing)},updateImgDrawing=function(){unlinkImgDrawProc(),self.update(self.getActualTargetContext(context),[{obj:self.getChemObj()}],Kekule.Render.ObjectUpdateType.MODIFY)};XEvent.addListener(imgElem,"load",updateImgDrawing),XEvent.addListener(imgElem,"error",unlinkImgDrawProc)}},createDrawGroup:function(context){return this.getDrawBridge().createGroup(this.getActualTargetContext(context))},addToDrawGroup:function(elem,group){return this.getDrawBridge().addToGroup(elem,group)},removeFromDrawGroup:function(elem,group){return this.getDrawBridge().removeFromGroup(elem,group)},removeDrawnElem:function(context,elem){return this.getDrawBridge().removeDrawnElem(this.getActualTargetContext(context),elem)},transformScreenCoordToContext:function(context,coord){return this.doTransformScreenCoordToContext(this.getActualTargetContext(context),coord)},doTransformScreenCoordToContext:function(context,coord){var b=this.getDrawBridge();return b&&b.transformScreenCoordToContext?b.transformScreenCoordToContext(this.getActualTargetContext(context),coord):coord}}),Kekule.Render.ChemObj2DRenderer=Class.create(Kekule.Render.Base2DRenderer,{CLASS_NAME:"Kekule.Render.ChemObj2DRenderer",doEstimateSelfObjBox:function(context,options,allowCoordBorrow){return Kekule.Render.ObjUtils.getContainerBox(this.getChemObj(),this.getCoordMode(),allowCoordBorrow)},doEstimateRenderBox:function(context,baseCoord,options,allowCoordBorrow){var objBox=this.estimateObjBox(context,options,allowCoordBorrow);if(objBox){var p=this.prepareTransformParams(context,baseCoord,options,objBox),transformParams=p;return BU.transform2D(objBox,transformParams)}return null},doGetAutoBaseCoord:function(drawOptions){var transformParams=drawOptions.transformParams;if(transformParams){var obj=this.getChemObj(),objCoord=obj.getAbsBaseCoord?obj.getAbsBaseCoord(Kekule.CoordMode.COORD2D):obj.getAbsBaseCoord2D?obj.getAbsBaseCoord2D():null;if(objCoord)return Kekule.CoordUtils.transform2D(objCoord,transformParams)}return null},doDraw:function($super,context,baseCoord,options){var medianObjRefLength=this.getAutoScaleRefObjLength(this.getChemObj(),options.allowCoordBorrow);return options.medianObjRefLength=medianObjRefLength||options.defScaleRefLength,this.prepareTransformParams(context,baseCoord,options),this.prepareGeneralOptions(context,options),$super(context,baseCoord,options)},prepareGeneralOptions:function(context,options){},prepareTransformParams:function(context,baseCoord,drawOptions,objBox){var result;if(drawOptions.transformParams)result=drawOptions.transformParams;else{var p=this.generateTransformParams(context,baseCoord,drawOptions,objBox);drawOptions.transformParams=p,result=p}var transformMatrix=Kekule.CoordUtils.calcTransform2DMatrix(result),invTransformMatrix=Kekule.CoordUtils.calcInverseTransform2DMatrix(result);return drawOptions.transformParams.transformMatrix=transformMatrix,drawOptions.transformParams.invTransformMtrix=invTransformMatrix,this.getRenderCache(context).transformParams=result,this.getRenderCache(context).transformMatrix=transformMatrix,this.getRenderCache(context).invTransformMatrix=invTransformMatrix,result},calcPreferedTransformOptions:function(context,baseCoord,drawOptions,objBox){var result={};result.allowCoordBorrow=oneOf(drawOptions.allowCoordBorrow,!1),result.unitLength=drawOptions.unitLength||1,objBox||(objBox=this.estimateObjBox(context,drawOptions,result.allowCoordBorrow));var boxCenter={x:(objBox.x1+objBox.x2)/2,y:(objBox.y1+objBox.y2)/2},O=Kekule.ObjUtils;if(O.isUnset(drawOptions.translateX)&&O.isUnset(drawOptions.translateY)?baseCoord&&(result.translateX=baseCoord.x-boxCenter.x,result.translateY=baseCoord.y-boxCenter.y):(result.translateX=drawOptions.translateX||0,result.translateY=drawOptions.translateY||0),result.zoom=drawOptions.zoom||1,drawOptions.scale||drawOptions.scaleX||drawOptions.scaleY)result.scaleX=oneOf(drawOptions.scaleX,drawOptions.scale,1),result.scaleY=oneOf(drawOptions.scaleY,drawOptions.scale,1);else if(drawOptions.autofit){var contextDim=this.getDrawBridge().getContextDimension(context);contextDim.x=contextDim.width,contextDim.y=contextDim.height,contextDim=this.getDrawBridge().transformScreenCoordToContext(context,contextDim),contextDim.width=contextDim.x,contextDim.height=contextDim.y;var padding=drawOptions.autofitContextPadding;padding*=2*result.unitLength,objBox.width=objBox.x2-objBox.x1,objBox.height=objBox.y2-objBox.y1;var sx=Math.max(contextDim.width-padding,0)/(objBox.width||1),sy=Math.max(contextDim.height-padding,0)/(objBox.height||1);O.isUnset(drawOptions.retainAspect)||drawOptions.retainAspect?result.scaleX=result.scaleY=Math.min(sx,sy):(result.scaleX=sx,result.scaleY=sy)}else{var defDrawRefLength=oneOf(drawOptions.refDrawLength,this.getAutoScaleRefDrawLength(drawOptions))||1,medianObjRefLength=drawOptions.medianObjRefLength;Kekule.ObjUtils.isUnset(medianObjRefLength)&&(medianObjRefLength=drawOptions.defScaleRefLength),result.scaleX=result.scaleY=defDrawRefLength/medianObjRefLength||1}return O.notUnset(drawOptions.rotateAngle)&&(result.rotateAngle=drawOptions.rotateAngle),O.isUnset(drawOptions.center)?result.center=boxCenter:result.center=drawOptions.center,result.drawBaseCoord=baseCoord||Kekule.CoordUtils.transform2D(boxCenter,result),result},generateTransformParams:function(context,baseCoord,drawOptions,objBox){var result=this.calcPreferedTransformOptions(context,baseCoord,drawOptions,objBox),initialTransformOptions=Object.extend({},result);return result=this.getFinalTransformParams(context,result),result.initialTransformOptions=initialTransformOptions,result},getFinalTransformParams:function(context,transformParams){var result=Object.create(transformParams);return result.zoom&&(result.scaleX*=result.zoom,result.scaleY*=result.zoom),result.scaleY=-result.scaleY,result.unitLength&&(result.translateX*=result.unitLength,result.translateY*=result.unitLength,result.drawBaseCoord.x*=result.unitLength,result.drawBaseCoord.y*=result.unitLength),result},getRenderFinalTransformParams:function(context){return this.getRenderCache(context).transformParams},getRenderInitialTransformOptions:function(context){var p=this.getRenderFinalTransformParams(context);return p?p.initialTransformOptions:null},doTransformCoordToObj:function(context,chemObj,coord){var matrix=this.getRenderCache(context).invTransformMatrix;return Kekule.CoordUtils.transform2DByMatrix(coord,matrix)},doTransformCoordToContext:function(context,chemObj,coord){var matrix=this.getRenderCache(context).transformMatrix;return Kekule.CoordUtils.transform2DByMatrix(coord,matrix)}}),Kekule.Render.RichTextBased2DRenderer=Class.create(Kekule.Render.ChemObj2DRenderer,{CLASS_NAME:"Kekule.Render.RichTextBased2DRenderer",DRAWN_OBJ_FIELD:"__$drawnObj__",initialize:function($super,chemObj,drawBridge,parent){$super(chemObj,drawBridge,parent),this.__$alwaysRecalcSize__=!1,this.__$isRecalculatingSize=!1},getDrawnObj:function(context){return this.getExtraProp(context,this.DRAWN_OBJ_FIELD)},setDrawnObj:function(context,value){this.setExtraProp(context,this.DRAWN_OBJ_FIELD,value)},getRichText:function(chemObj,drawOptions){return null},extractRichTextDrawOptions:function(options){var result=Object.create(options||{});return result.horizontalAlign=oneOf(result.horizontalAlign,result.textHorizontalAlign),result.verticalAlign=oneOf(result.verticalAlign,result.textVerticalAlign),result.charDirection=oneOf(result.charDirection,result.textCharDirection),result},getDrawTextCoord:function(context,baseCoord){return baseCoord},doDrawSelf:function($super,context,baseCoord,options){$super(context,baseCoord,options);var chemObj=this.getChemObj(),richText=(options.transformParams,this.getRichText(this.getChemObj(),options));if(!richText)return null;baseCoord||(baseCoord=this.getAutoBaseCoord(options));var textCoord=this.getDrawTextCoord(context,baseCoord),result=this.drawRichText(context,textCoord,richText,this.extractRichTextDrawOptions(options)),rect=result.boundRect,rectBoundInfo=this.createRectBoundInfo({x:rect.left,y:rect.top},{x:rect.left+rect.width,y:rect.top+rect.height});return this.basicDrawObjectUpdated(context,chemObj,chemObj,rectBoundInfo,Kekule.Render.ObjectUpdateType.ADD),this.getRenderCache(context).drawnObj=result.drawnObj,this.setDrawnObj(context,result.drawnObj),(this.getCanModifyTargetObj()&&chemObj.getNeedRecalcSize&&chemObj.getNeedRecalcSize()||this.__$alwaysRecalcSize__)&&this._autosetObjSize(context,chemObj,rectBoundInfo),result.drawnObj},_autosetObjSize:function(context,chemObj,rectBoundInfo){if(!this.__$isRecalculatingSize&&chemObj.hasProperty("size2D")&&chemObj.setNeedRecalcSize){this.__$isRecalculatingSize=!0;try{var coords=rectBoundInfo.coords,objCoord1=this.transformCoordToObj(context,chemObj,coords[0]),objCoord2=this.transformCoordToObj(context,chemObj,coords[1]),delta=Kekule.CoordUtils.substract(objCoord2,objCoord1);chemObj.setPropStoreFieldValue("size2D",{x:Math.abs(delta.x),y:Math.abs(delta.y)}),chemObj.setNeedRecalcSize(!1)}finally{this.__$isRecalculatingSize=!1}}}}),Kekule.Render.TextBlock2DRenderer=Class.create(Kekule.Render.RichTextBased2DRenderer,{CLASS_NAME:"Kekule.Render.TextBlock2DRenderer",getRichText:function(chemObj,drawOptions){return Kekule.Render.RichTextUtils.strToRichText(chemObj.getText())},doEstimateSelfObjBox:function(context,options,allowCoordBorrow){return this.getChemObj().getBox2D(allowCoordBorrow)},getDrawTextCoord:function(context,baseCoord){var chemObj=this.getChemObj(),objBox=chemObj.getExposedContainerBox(),coord1={x:objBox.x1,y:objBox.y2},coord2={x:objBox.x2,y:objBox.y1},contextCoord1=this.transformCoordToContext(context,chemObj,coord1),contextCoord2=this.transformCoordToContext(context,chemObj,coord2),size=Kekule.CoordUtils.substract(contextCoord2,contextCoord1);return{x:baseCoord.x-size.x/2,y:baseCoord.y-size.y/2}},extractRichTextDrawOptions:function($super,options){var ops=$super(options);return ops.fontSize=oneOf(ops.fontSize,ops.labelFontSize),ops.fontFamily=oneOf(ops.fontFamily,ops.labelFontFamily),ops.color=oneOf(ops.color,ops.labelColor),ops.textBoxXAlignment=Kekule.Render.BoxXAlignment.LEFT,ops.textBoxYAlignment=Kekule.Render.BoxYAlignment.TOP,ops}}),Kekule.Render.Formula2DRenderer=Class.create(Kekule.Render.RichTextBased2DRenderer,{CLASS_NAME:"Kekule.Render.Formula2DRenderer",basicDrawObjectUpdated:function($super,context,obj,parentObj,boundInfo,updateType){return obj===this.getChemObj()?$super(context,obj.getParent(),obj.getParent(),boundInfo,updateType):$super(context,obj,parentObj,boundInfo,updateType)},getRichText:function(chemObj,drawOptions){return chemObj.getDisplayRichText(!0,drawOptions.displayLabelConfigs,drawOptions.partialChargeDecimalsLength,drawOptions.chargeMarkType)},doEstimateSelfObjBox:function(context,options,allowCoordBorrow){var parent=this.getChemObj()?this.getChemObj().getParent():null;if(parent){var coord=parent?parent.getAbsBaseCoord2D(allowCoordBorrow):{x:0,y:0};return BU.createBox(coord,coord)}return null},extractRichTextDrawOptions:function($super,options){var ops=$super(options);return ops.fontSize=oneOf(ops.fontSize,ops.atomFontSize),ops.fontFamily=oneOf(ops.fontFamily,ops.atomFontFamily),ops.color=oneOf(ops.color,ops.labelColor,ops.atomColor),ops.textBoxXAlignment=Kekule.Render.BoxXAlignment.CENTER,ops.textBoxYAlignment=Kekule.Render.BoxYAlignment.CENTER,ops}}),Kekule.Render.TextBasedChemMarker2DRenderer=Class.create(Kekule.Render.RichTextBased2DRenderer,{CLASS_NAME:"Kekule.Render.TextBasedChemMarker2DRenderer",initialize:function($super,chemObj,drawBridge,parent){$super(chemObj,drawBridge,parent)},doDrawSelf:function($super,context,baseCoord,options){return $super(context,baseCoord,options)},getRichText:function(chemObj,drawOptions){var text,obj=this.getChemObj();if(obj instanceof Kekule.ChemMarker.Charge){var charge=obj.getValue();if(text=Kekule.Render.ChemDisplayTextUtils.getChargeDisplayText(charge,drawOptions.partialChargeDecimalsLength,drawOptions.chargeMarkType))return Kekule.Render.RichTextUtils.createSection(text,{charDirection:Kekule.Render.TextDirection.LTR})}else if(obj instanceof Kekule.ChemMarker.Radical){var radical=obj.getValue();if(text=Kekule.Render.ChemDisplayTextUtils.getRadicalDisplayText(radical,drawOptions.distinguishSingletAndTripletRadical))return Kekule.Render.RichTextUtils.createSection(text,{charDirection:Kekule.Render.TextDirection.LTR})}return null},doEstimateSelfObjBox:function($super,context,options,allowCoordBorrow){return $super(context,options,allowCoordBorrow)},extractRichTextDrawOptions:function($super,options){var ops=$super(options),obj=this.getChemObj();return ops.fontSize=oneOf(obj.getRenderOption("fontSize"),ops.chemMarkerFontSize,ops.fontSize,ops.atomFontSize),ops.fontFamily=oneOf(ops.fontFamily,ops.atomFontFamily),ops.color=oneOf(ops.color,ops.atomColor,ops.labelColor),ops.textBoxXAlignment=Kekule.Render.BoxXAlignment.CENTER,ops.textBoxYAlignment=Kekule.Render.BoxYAlignment.CENTER,ops}}),Kekule.Render.ImageBlock2DRenderer=Class.create(Kekule.Render.ChemObj2DRenderer,{CLASS_NAME:"Kekule.Render.ImageBlock2DRenderer",initialize:function($super,chemObj,drawBridge,parent){$super(chemObj,drawBridge,parent)},doDrawSelf:function($super,context,baseCoord,options){$super(context,baseCoord,options);var chemObj=this.getChemObj();options.transformParams;if(!chemObj||!chemObj.getSrc||!chemObj.getSrc())return null;baseCoord||(baseCoord=this.getAutoBaseCoord(options));var result,objBox=chemObj.getExposedContainerBox(),coord1={x:objBox.x1,y:objBox.y2},coord2={x:objBox.x2,y:objBox.y1},contextCoord1=this.transformCoordToContext(context,chemObj,coord1),contextCoord2=this.transformCoordToContext(context,chemObj,coord2),size=Kekule.CoordUtils.substract(contextCoord2,contextCoord1),drawCoord={x:baseCoord.x-size.x/2,y:baseCoord.y-size.y/2},imgElem=chemObj.getCacheImg();return result=imgElem?this.drawImageElem(context,imgElem,drawCoord,size,options):this.drawImage(context,chemObj.getSrc(),drawCoord,size,options),this.basicDrawObjectUpdated(context,chemObj,chemObj,this.createRectBoundInfo(drawCoord,Kekule.CoordUtils.add(drawCoord,size)),Kekule.Render.ObjectUpdateType.ADD),result}}),Kekule.Render.UnbondedElectronSetRenderer=Class.create(Kekule.Render.ChemObj2DRenderer,{CLASS_NAME:"Kekule.Render.UnbondedElectronSetRenderer",_extractActualDrawOptions:function(options){var ops=Object.create(options),obj=this.getChemObj();return ops.fontSize=oneOf(obj.getRenderOption("fontSize"),ops.chargeMarkFontSize,ops.fontSize,ops.atomFontSize),ops.color=oneOf(ops.color,ops.atomColor,ops.labelColor),ops.strokeColor=ops.color,ops.fillColor=ops.color,ops.electronGap=ops.fontSize/3*(ops.unitLength||1)*(ops.zoom||1),ops.electronRadius=ops.fontSize/12*(ops.unitLength||1)*(ops.zoom||1),ops},_drawSingleElectron:function(context,coord,radius,options){return this.drawCircle(context,coord,radius,options)},_drawElectrons:function(context,electronCount,baseCoord,centerCoord,options){var cosAngle,sinAngle,baseVector=CU.substract(baseCoord,centerCoord),distance=CU.getDistance(baseVector);if(0===distance)var cosAngle=0,sinAngle=1;else var cosAngle=baseVector.x/distance,sinAngle=baseVector.y/distance;for(var drawElem,gap=options.electronGap,eRadius=options.electronRadius,deltaVector={x:gap*sinAngle,y:-gap*cosAngle},halfCount=(electronCount-1)/2,currCoord=CU.substract(baseCoord,CU.multiply(deltaVector,halfCount)),electronCoords=[],group=electronCount>1?this.createDrawGroup(context):null,i=0;i<electronCount;++i)electronCoords.push(currCoord),drawElem=this._drawSingleElectron(context,currCoord,eRadius,options),group&&this.addToDrawGroup(drawElem,group),currCoord=CU.add(currCoord,deltaVector);var boundInfo;if(electronCoords.length<=1)boundInfo=this.createCircleBoundInfo(electronCoords[0],eRadius);else{var adjustDelta=CU.multiply(deltaVector,2*eRadius/gap),c1=CU.substract(electronCoords[0],adjustDelta),c2=CU.add(electronCoords[electronCount-1],adjustDelta);boundInfo=this.createLineBoundInfo(c1,c2,eRadius)}return{electronCoords:electronCoords,drawnElem:group||drawElem,electronRadius:eRadius,boundInfo:boundInfo}},_doGetParentCoord:function(context,parentObj,options){var transformParams=options.transformParams;if(transformParams){var obj=parentObj,objCoord=obj.getAbsBaseCoord?obj.getAbsBaseCoord(Kekule.CoordMode.COORD2D):obj.getAbsBaseCoord2D?obj.getAbsBaseCoord2D():null;if(objCoord)return CU.transform2D(objCoord,transformParams)}return null},doDrawSelf:function($super,context,baseCoord,options){$super(context,baseCoord,options);var ops=this._extractActualDrawOptions(options),chemObj=this.getChemObj(),parentObj=chemObj.getParent();options.transformParams;if(!chemObj||!parentObj||!chemObj.getElectronCount||(chemObj.getElectronCount()||0)<=0)return null;baseCoord||(baseCoord=this.getAutoBaseCoord(options));var parentCoord=this._doGetParentCoord(context,parentObj,options);if(!baseCoord||!parentCoord)return null;var drawResult=this._drawElectrons(context,chemObj.getElectronCount(),baseCoord,parentCoord,ops);drawResult.electronCoords,drawResult.electronRadius;return this.basicDrawObjectUpdated(context,chemObj,parentObj,drawResult.boundInfo,Kekule.Render.ObjectUpdateType.ADD),drawResult.drawnElem}}),Kekule.Render.Ctab2DRenderer=Class.create(Kekule.Render.ChemObj2DRenderer,{CLASS_NAME:"Kekule.Render.Ctab2DRenderer",DRAW_ELEM_FIELD:"__$drawElem__",TRANSFORM_COORD_FIELD:"__$transCoord2D__",TRANSFORM_MATRIX_FIELD:"__$transMatrix__",RENDERED_OBJS_FIELD:"__$renderedObjs__",INV_TRANSFORM_MATRIX_FIELD:"__$inverseTransMatrix__",CHILD_TRANSFORM_MATRIX_FIELD:"__$childTransMatrix__",doEstimateSelfObjBox:function(context,options,allowCoordBorrow){return this.getChemObj().getExposedContainerBox2D(allowCoordBorrow)},getObjDrawElem:function(context,obj){return this.getExtraProp2(context,obj,this.DRAW_ELEM_FIELD)},setObjDrawElem:function(context,obj,value){this.setExtraProp2(context,obj,this.DRAW_ELEM_FIELD,value)},getRenderedObjs:function(context){return this.getExtraProp(context,this.RENDERED_OBJS_FIELD)},addRenderedObj:function(context,obj){var objs=this.getRenderedObjs(context);objs?Kekule.ArrayUtils.pushUnique(objs,obj):(objs=[obj],this.setExtraProp(context,this.RENDERED_OBJS_FIELD,objs))},removeRenderedObj:function(context,obj){var objs=this.getRenderedObjs(context);objs&&Kekule.ArrayUtils.remove(objs,obj)},clearRenderedObj:function(context){this.setExtraProp(context,this.RENDERED_OBJS_FIELD,null)},prepareGeneralOptions:function($super,context,options){return $super(context,options)},doPrepare:function($super,context,chemObj,baseCoord,options){$super(context,chemObj,baseCoord,options)},handleNodeSpecifiedRenderOptions:function(currObj,parentOptions){var localOptions=(currObj.getOverriddenRenderOptions?currObj.getOverriddenRenderOptions():null)||{},result=Object.create(parentOptions);return result=Object.extend(result,localOptions)},handleConnectorSpecifiedRenderOptions:function($super,currObj,parentOptions){var localOptions=(currObj.getOverriddenRenderOptions?currObj.getOverriddenRenderOptions():null)||{},result=Object.create(parentOptions||null);return result=Object.extend(result,localOptions)},isChemObjRenderedBySelf:function($super,context,obj){var renderedObjs=this.getRenderedObjs(context);return $super(context,obj)||renderedObjs&&renderedObjs.indexOf(obj)>=0||this.getChemObj().hasChildObj(obj)&&(!obj.isExposed||obj.isExposed())},isChemObjRenderedDirectlyBySelf:function($super,context,obj){var renderedObjs=this.getRenderedObjs(context);return $super(context,obj)||renderedObjs&&renderedObjs.indexOf(obj)>=0},doDrawSelf:function($super,context,baseCoord,options){$super(context,baseCoord,options);var chemObj=this.getChemObj();this._ctab=chemObj;var transformOptions=options.transformParams;return this.getRenderCache(context).transformOptions=transformOptions,this.transformCtabCoords2DToContext(context,chemObj,transformOptions),this.doPrepare(context,chemObj,baseCoord,options),this.getRenderCache(context).appliedOptions=options,this.doDrawCore(context,chemObj,options,transformOptions)},doRedraw:function(context){var p=this.getRenderCache(context);return this.doDrawCore(context,this.getChemObj(),p.appliedOptions,p.transformOptions)},doDrawCore:function(context,chemObj,options,finalTransformOptions){this.clearRenderedObj(context);var group=this.createDrawGroup(context);return this.doDrawConnectors(context,group,chemObj,options,finalTransformOptions),this.doDrawNodes(context,group,chemObj,options,finalTransformOptions),this.setObjDrawElem(context,chemObj,group),group},doUpdateSelf:function($super,context,updatedObjDetails,updateType){if(this.canModifyGraphic(context)){var r=!1,T=Kekule.Render.ObjectUpdateType;switch(updateType){case T.ADD:r=this.doAddNew(context,updatedObjDetails);break;case T.MODIFY:r=this.doModify(context,updatedObjDetails);break;case T.REMOVE:r=this.doRemove(context,Kekule.Render.UpdateObjUtils._extractObjsOfUpdateObjDetails(updatedObjDetails));break;default:return $super(context,updatedObjDetails,updateType)}return r}return $super(context,updatedObjDetails,updateType)},doAddNew:function(context,updatedObjDetails){return!!this.canModifyGraphic()&&this.doModify(context,updatedObjDetails)},doModify:function(context,updatedObjDetails){if(this.canModifyGraphic()){var objs=this._extractObjsOfUpdateObjDetails(updatedObjDetails);this.remove(context,objs);var chemObj=this.getChemObj(),group=this.getObjDrawElem(context,chemObj),cache=this.getRenderCache(context),options=cache.appliedOptions;objs.indexOf(chemObj)>=0&&this.draw(context,cache.baseCoord,options);for(var i=0,l=objs.length;i<l;++i){var obj=objs[i];obj.isExposed&&!obj.isExposed()||(chemObj.hasConnector(obj)?this.doDrawConnector(context,group,obj,this.getChemObj(),options,cache.transformParams||{}):chemObj.hasNode(obj)&&this.doDrawNode(context,group,obj,this.getChemObj(),options,cache.transformParams))}return!0}return!1},doRemove:function(context,removedObjs){if(this.canModifyGraphic()){for(var objs=Kekule.ArrayUtils.toArray(removedObjs),i=0,l=objs.length;i<l;++i){var obj=objs[i],elem=this.getObjDrawElem(context,obj);if(elem){var group=this.getObjDrawElem(context,this.getChemObj());this.removeFromDrawGroup(elem,group),this.removeDrawnElem(context,elem)}this.removeRenderedObj(context,obj),this.removeExtraProp2(context,obj),this.basicDrawObjectUpdated(context,obj,this.getChemObj(),null,Kekule.Render.ObjectUpdateType.REMOVE)}return!0}return!1},getCoordTransformOptions:function(context){return this.getRenderCache(context).transformOptions},transformCtabCoords2DToContext:function(context,ctab,transformOptions){var allowCoordBorrow=transformOptions.allowCoordBorrow,childTransformOptions=Object.extend({},transformOptions);childTransformOptions.centerX=0,childTransformOptions.centerY=0;var coordTransformMatrix=transformOptions.transformMatrix;this.setExtraProp2(context,ctab,this.TRANSFORM_MATRIX_FIELD,coordTransformMatrix);var childCoordTransformMatrix=coordTransformMatrix;this.setExtraProp2(context,ctab,this.CHILD_TRANSFORM_MATRIX_FIELD,coordTransformMatrix);var invMatrix=transformOptions.invTransformMatrix;this.setExtraProp2(context,ctab,this.INV_TRANSFORM_MATRIX_FIELD,invMatrix);for(var i=0,l=ctab.getNodeCount();i<l;++i){var node=ctab.getNodeAt(i);this.transformObjCoord2DToContext(context,node,coordTransformMatrix,childCoordTransformMatrix,allowCoordBorrow)}},transformObjCoord2DToContext:function(context,obj,transformMatrix,childTransformMatrix,allowCoordBorrow){if(obj&&obj.getAbsBaseCoord2D){var coord=obj.getAbsBaseCoord2D(allowCoordBorrow);if(coord){var newCoord=Kekule.CoordUtils.transform2DByMatrix(coord,transformMatrix);this.setTransformedCoord2D(context,obj,newCoord)}if(obj.getNodes)for(var i=0,l=obj.getNodeCount();i<l;++i)this.transformObjCoord2DToContext(context,obj.getNodeAt(i),childTransformMatrix,childTransformMatrix,allowCoordBorrow)}},getTransformedCoord2D:function(context,obj,allowCoordBorrow){if(Kekule.ObjUtils.isUnset(allowCoordBorrow)&&(allowCoordBorrow=this.getRenderCache(context).options.transformParams.allowCoordBorrow),!(obj instanceof Kekule.BaseStructureNode&&this.getExtraProp2(context,obj,this.TRANSFORM_COORD_FIELD))){var ctab=this.getChemObj(),transformMatrix=this.getExtraProp2(context,ctab,this.TRANSFORM_MATRIX_FIELD),childTransformMatrix=this.getExtraProp2(context,ctab,this.CHILD_TRANSFORM_MATRIX_FIELD);ctab&&(ctab.hasNode(obj,!1)||ctab.hasConnector(obj,!1))?this.transformObjCoord2DToContext(context,obj,transformMatrix,childTransformMatrix,allowCoordBorrow):this.transformObjCoord2DToContext(context,obj,childTransformMatrix,childTransformMatrix,allowCoordBorrow)}return this.getExtraProp2(context,obj,this.TRANSFORM_COORD_FIELD)},setTransformedCoord2D:function(context,obj,coord){this.setExtraProp2(context,obj,this.TRANSFORM_COORD_FIELD,coord)},doTransformCoordToObj:function($super,context,chemObj,coord){var matrix=this.getExtraProp2(context,chemObj,this.INV_TRANSFORM_MATRIX_FIELD);return matrix?Kekule.CoordUtils.transform2DByMatrix(coord,matrix):$super(context,chemObj,coord)},doTransformCoordToContext:function($super,context,chemObj,coord){var matrix=this.getExtraProp2(context,chemObj,this.TRANSFORM_MATRIX_FIELD);return matrix?Kekule.CoordUtils.transform2DByMatrix(coord,matrix):$super(context,chemObj,coord)},doDrawNodes:function(context,group,ctab,options,finalTransformOptions){for(var nodes=ctab.getExposedNodes(),i=0,l=nodes.length;i<l;++i){var node=nodes[i],ops=this.handleNodeSpecifiedRenderOptions(nodes[i],options);this.doDrawNode(context,group,node,ctab,ops,finalTransformOptions)}},doDrawNode:function(context,group,node,parentChemObj,options,finalTransformOptions){},doDrawConnectors:function(context,group,ctab,options,finalTransformOptions){for(var ops=this.handleConnectorSpecifiedRenderOptions(ctab,options),connectors=ctab.getExposedConnectors(),i=0,l=connectors.length;i<l;++i){var connector=connectors[i];this.doDrawConnector(context,group,connector,ctab,ops,finalTransformOptions)}},doDrawConnector:function(context,group,connector,parentChemObj,options,finalTransformOptions){var result,objs=connector.getConnectedExposedObjs(),objCount=objs.length;if(objCount<2)return null;for(var obj1,obj2,elem,elemEx,subGroup=objCount>2?this.createDrawGroup(context):null,boundInfos=objCount>2?[]:null,renderOptions=this.handleConnectorSpecifiedRenderOptions(connector,options),i=0;i<objCount;++i)if(obj1=objs[i],this.getTransformedCoord2D(context,obj1,finalTransformOptions.allowCoordBorrow))for(var j=i+1;j<objCount;++j)if(obj2=objs[j],this.getTransformedCoord2D(context,obj2,finalTransformOptions.allowCoordBorrow)&&(elemEx=this.doDrawConnectorShape(context,connector,obj1,obj2,renderOptions,finalTransformOptions))){elem=elemEx.element,elem&&subGroup&&this.addToDrawGroup(elem,subGroup);var boundInfo=elemEx.boundInfo;boundInfos&&boundInfos.push(boundInfo)}return result=subGroup||elem,result&&group&&this.addToDrawGroup(result,group),result?this.setObjDrawElem(context,connector,result):this.setObjDrawElem(context,connector,null),this.addRenderedObj(context,connector),(boundInfo||boundInfos)&&this.basicDrawObjectUpdated(context,connector,parentChemObj,boundInfos||boundInfo,Kekule.Render.ObjectUpdateType.ADD),result},doDrawConnectorShape:function(context,connector,node1,node2,renderOptions,finalTransformOptions){}}),Kekule.ClassDefineUtils.addExtraTwoTupleObjMapSupport(Kekule.Render.Ctab2DRenderer),Kekule.Render.ChemCtab2DRenderer=Class.create(Kekule.Render.Ctab2DRenderer,{CLASS_NAME:"Kekule.Render.ChemCtab2DRenderer",OBJ_NEED_LABEL_FIELD:"__$needDrawLabel__",OBJ_NEED_DOT_FIELD:"__$needDrawDot__",getObjNeedDrawLabel:function(context,obj){var result=this.getExtraProp2(context,obj,this.OBJ_NEED_LABEL_FIELD);if(Kekule.ObjUtils.isUnset(result)){var drawOptions=this.getRenderCache(context).appliedOptions;result=!(obj instanceof Kekule.ChemStructureConnector)&&this._needNodeDrawLabel(obj,drawOptions),this.setObjNeedDrawLabel(context,obj,result)}return result},setObjNeedDrawLabel:function(context,obj,value){this.setExtraProp2(context,obj,this.OBJ_NEED_LABEL_FIELD,value)},getObjNeedDrawDot:function(context,obj){var drawOptions=this.getRenderCache(context).appliedOptions;return!(obj instanceof Kekule.ChemStructureConnector)&&this._needNodeDrawDot(context,obj,drawOptions)},doPrepare:function($super,context,chemObj,baseCoord,options){$super(context,chemObj,baseCoord,options),options.fontSize||(options.fontSize=options.atomFontSize),options.textBoxXAlignment=Kekule.Render.BoxXAlignment.CENTER,options.textBoxYAlignment=Kekule.Render.BoxYAlignment.CENTER;for(var nodes=chemObj.getExposedNodes(),i=0,l=nodes.length;i<l;++i){var node=nodes[i],needDrawLabel=this._needNodeDrawLabel(node,options);this.setObjNeedDrawLabel(context,node,needDrawLabel)}},handleNodeSpecifiedRenderOptions:function($super,currObj,parentOptions){var result=$super(currObj,parentOptions);return result.color=result.color||result.atomColor,result.fontFamily=result.fontFamily||result.atomFontFamily,result.fontSize=result.fontSize||result.atomFontSize,result},handleConnectorSpecifiedRenderOptions:function($super,currObj,parentOptions){var result=$super(currObj,parentOptions);return result.color=result.color||result.bondColor,result},doDrawNode:function(context,group,node,parentChemObj,options,finalTransformOptions){var result,boundInfo,coord=this.getTransformedCoord2D(context,node,finalTransformOptions.allowCoordBorrow),nodeRenderOptions=this.handleNodeSpecifiedRenderOptions(node,options),atomicNumber=node.getAtomicNumber?node.getAtomicNumber():0,localOptions=node.getOverriddenRenderOptions()||{},localColor=localOptions.color||localOptions.atomColor,atomSpecifiedColor=Kekule.Render.RenderColorUtils.getColor(atomicNumber,this.getRendererType());if(atomicNumber<=0){var atomTypeName=node.getClassLocalName();atomSpecifiedColor=Kekule.Render.RenderColorUtils.getColor(atomTypeName,this.getRendererType())}var defColor=localColor||(nodeRenderOptions.useAtomSpecifiedColor?atomSpecifiedColor:nodeRenderOptions.color);nodeRenderOptions.color=defColor;var needDrawCharge=(node.getCharge()||node.getRadical(),node.getCharge()&&!node.fetchChargeMarker(!1)),needDrawRadical=node.getRadical()&&!node.fetchRadicalMarker(!1),nodeWithLabel=!1;if(this.getObjNeedDrawLabel(context,node)){nodeWithLabel=!0;var hdisplayLevel=Kekule.Render.HydrogenDisplayLevel.ALL,needShowChargeInLabel=!(!needDrawCharge&&!needDrawRadical),label=node.getDisplayRichText(hdisplayLevel,needShowChargeInLabel,nodeRenderOptions.displayLabelConfigs,nodeRenderOptions.partialChargeDecimalsLength,nodeRenderOptions.chargeMarkType,nodeRenderOptions.distinguishSingletAndTripletRadical),labelCharDirection=nodeRenderOptions.charDirection?nodeRenderOptions.charDirection:this._decideNodeLabelCharDirection(context,node);nodeRenderOptions.fontSize*=nodeRenderOptions.unitLength;var actualDrawOptions=Object.create(nodeRenderOptions);actualDrawOptions.charDirection=labelCharDirection;var elemEx=this.drawRichText(context,coord,label,actualDrawOptions),elem=elemEx.drawnObj,rect=elemEx.boundRect;boundInfo=this.createRectBoundInfo({x:rect.left,y:rect.top},{x:rect.left+rect.width,y:rect.top+rect.height}),result=elem}else{var nodeCoreElem,chargeElem;if(this.getObjNeedDrawDot(context,node)&&Kekule.ObjUtils.isUnset(nodeRenderOptions.atomRadius)&&(nodeRenderOptions.atomRadius=nodeRenderOptions.allenCenterAtomRadius),nodeRenderOptions.atomRadius){var radius=nodeRenderOptions.atomRadius*nodeRenderOptions.unitLength;nodeRenderOptions.strokeColor=nodeRenderOptions.color,nodeRenderOptions.fillColor=nodeRenderOptions.color,nodeCoreElem=this.drawCircle(context,coord,radius,nodeRenderOptions),boundInfo=this.createCircleBoundInfo(coord,radius)}else boundInfo=this.createPointBoundInfo(coord);if(needDrawCharge||needDrawRadical){var elemEx=this.doDrawElectronStateMark(context,group,node,nodeRenderOptions.chargeMarkType,nodeRenderOptions.partialChargeDecimalsLength,nodeRenderOptions.distinguishSingletAndTripletRadical,nodeRenderOptions.fontFamily,nodeRenderOptions.chargeMarkFontSize*nodeRenderOptions.unitLength,nodeRenderOptions.chargeMarkMargin*nodeRenderOptions.unitLength,nodeRenderOptions.chargeMarkCircleWidth*nodeRenderOptions.unitLength,nodeRenderOptions.color,nodeRenderOptions.opacity,nodeRenderOptions.zoom||1);elemEx&&(chargeElem=elemEx.drawnObj)}nodeCoreElem&&chargeElem?(result=this.createDrawGroup(context),this.addToDrawGroup(result,nodeCoreElem),this.addToDrawGroup(result,chargeElem)):result=nodeCoreElem||chargeElem}if(node.getUnplacedMarkers(this.getCoordMode()).length>=0){var nodeLabelDirAngle,margin=nodeRenderOptions.chemMarkerMargin;if(nodeWithLabel){margin+=this._getNodeFontSize(context,node)*(finalTransformOptions.zoom||1)*nodeRenderOptions.unitLength*1/2-margin/2;var D=Kekule.Render.TextDirection,labelVector=(D.LTR,D.RTL,D.TTB,D.BTT,labelCharDirection===D.LTR?{x:1,y:0}:labelCharDirection===D.RTL?{x:-1,y:0}:labelCharDirection===D.TTB?{x:0,y:1}:labelCharDirection===D.BTT?{x:0,y:-1}:{x:0,y:0}),revTransLabelVector={x:labelVector.x*finalTransformOptions.scaleX,y:labelVector.y*finalTransformOptions.scaleY};nodeLabelDirAngle=revTransLabelVector.x>0?0:revTransLabelVector.x<0?Math.PI:revTransLabelVector.y>0?Math.PI/2:revTransLabelVector.y<0?3*Math.PI/2:null}var objMargin=margin/nodeRenderOptions.defBondLength*nodeRenderOptions.medianObjRefLength;this.doAdjustChemPropMarkerPos(node,objMargin,finalTransformOptions.allowCoordBorrow,Kekule.ObjUtils.notUnset(nodeLabelDirAngle)?[nodeLabelDirAngle]:[])}return result?(this.setObjDrawElem(context,node,result),group&&this.addToDrawGroup(result,group)):this.setObjDrawElem(context,node,null),this.addRenderedObj(context,node),this.basicDrawObjectUpdated(context,node,parentChemObj,boundInfo,Kekule.Render.ObjectUpdateType.ADD),result},_getNodeFontSize:function(context,node,drawOptions){drawOptions||(drawOptions=this.getRenderCache(context).appliedOptions||this.getRenderCache(context).options);var localLabelDrawOptions=Kekule.Render.RenderOptionUtils.getNodeLabelDrawOptions(node.getOverriddenRenderOptions())||{};return oneOf(localLabelDrawOptions.fontSize,drawOptions.fontSize,drawOptions.atomFontSize)},_getNodeHydrogenDisplayLevel:function(node,drawOptions){var localRenderOptions=node.getOverriddenRenderOptions(),localLevel=Kekule.Render.RenderOptionUtils.getHydrogenDisplayLevel(localRenderOptions);return Kekule.ObjUtils.notUnset(localLevel)?localLevel:drawOptions.moleculeDisplayType===Kekule.Render.MoleculeDisplayType.CONDENSED?Kekule.Render.HydrogenDisplayLevel.ALL:drawOptions.hydrogenDisplayLevel},_needNodeDrawDot:function(context,node,drawOptions){node.getOverriddenRenderOptions();if(node instanceof Kekule.Atom){if(node.getAtomicNumber()!==Kekule.Render.DEF_ATOM_ATOMIC_NUM)return!1;if(this.getObjNeedDrawLabel(context,node))return!1;if(2===node.getLinkedBonds().length){var bonds=node.getLinkedMultipleBonds();if(2===bonds.length&&bonds[0].getBondOrder()===bonds[1].getBondOrder()){var bondOrder=bonds[0].getBondOrder();return bondOrder>=BO.DOUBLE&&bondOrder<BO.EXPLICIT_AROMATIC}}return!1}return!1},_needNodeDrawLabel:function(node,drawOptions){var U=Kekule.Render.RenderOptionUtils,NM=Kekule.Render.NodeLabelDisplayMode,renderOps=node.getOverriddenRenderOptions(),nodeLabelMode=U.getNodeDisplayMode(renderOps)||drawOptions.nodeDisplayMode;if(!(node instanceof Kekule.ChemStructureNode))return!1;if(nodeLabelMode===NM.HIDDEN)return!1;if(nodeLabelMode===NM.SHOWN)return!0;if(drawOptions.moleculeDisplayType===Kekule.Render.MoleculeDisplayType.CONDENSED)return!0;if(node.getLinkedConnectors().length<=0)return!0;if(node instanceof Kekule.Atom&&node.getAtomicNumber()===Kekule.Render.DEF_ATOM_ATOMIC_NUM&&!node.getMassNumber()){if(node.getRenderOption("customLabel"))return!0;var hDisplayLevel=this._getNodeHydrogenDisplayLevel(node,drawOptions),HDL=Kekule.Render.HydrogenDisplayLevel;return hDisplayLevel===HDL.ALL||hDisplayLevel===HDL.NONE||(hDisplayLevel===HDL.UNMATCHED_EXPLICIT?node.getImplicitHydrogenCount()!==node.getExplicitHydrogenCount():Kekule.ObjUtils.notUnset(node.getExplicitHydrogenCount()))}return!0},_isNodeHasConnectorToDirection:function(linkedObjCoords,direction,threshold){Kekule.ObjUtils.isUnset(threshold)&&(threshold=.2);for(var i=0,l=linkedObjCoords.length;i<l;++i){var coord=linkedObjCoords[i];if(direction===D.LTR&&coord.x>threshold)return!0;if(direction===D.RTL&&coord.x<-threshold)return!0;if(direction===D.TTB&&coord.y>threshold)return!0;if(direction===D.BTT&&coord.y<-threshold)return!0}return!1},_calcConnectorVectorWeight:function(coords){for(var totalX=0,totalY=0,weightValues=function(x,y){return 0==y?100:Math.min(100,Math.pow(x/y,2))},i=0,l=coords.length;i<l;++i)totalX+=coords[i].x*weightValues(coords[i].x,coords[i].y)*1,totalY+=coords[i].y*weightValues(coords[i].y,coords[i].x)*1;return{x:totalX,y:totalY}},_calcConnectorVectorOfNode:function(context,node){for(var result={x:0,y:0},linkedObjCoords=this._getStandardizedLinkedObjRelCoords(context,node,null),i=0,l=linkedObjCoords.length;i<l;++i)result.x+=linkedObjCoords[i].x,result.y+=linkedObjCoords[i].y;return result.x===result.y===0&&(result={x:1,y:0}),result},_calcVectorAxisDirection:function(vector){return Math.abs(vector.x)>=Math.abs(vector.y)?vector.x>0?D.LTR:D.RTL:vector.y>0?D.TTB:D.BTT},_decideNodeLabelCharDirection:function(context,node){for(var linkedObjCoords=this._getStandardizedLinkedObjRelCoords(context,node,null),D=Kekule.Render.TextDirection,directions=[D.LTR,D.RTL,D.TTB,D.BTT],i=0,l=directions.length;i<l;++i)if(!this._isNodeHasConnectorToDirection(linkedObjCoords,directions[i]))return directions[i];var connectorVectorWeight=this._calcConnectorVectorWeight(linkedObjCoords);return Math.abs(connectorVectorWeight.x)>Math.abs(connectorVectorWeight.y)?connectorVectorWeight.x<=0?D.LTR:D.RTL:connectorVectorWeight.y<=0?D.TTB:D.BTT},_calcConnectorAnglesOfNode:function(context,node){for(var result=[],linkedObjCoords=this._getStandardizedLinkedObjRelCoords(context,node,null),i=0,l=linkedObjCoords.length;i<l;++i){var c=linkedObjCoords[i],angle=Math.atan2(c.y,c.x);angle<0&&(angle=2*Math.PI+angle),result.push(angle)}return result.sort(),result},_getMostEmptyDirectionAngleOfNode:function(context,node){var result,angles=this._calcConnectorAnglesOfNode(context,node),l=angles.length;if(0===l)result=0;else if(1===l)result=-angles[0];else{for(var max=0,index=0,i=0;i<l;++i){var a1=angles[i],a2=angles[(i+1)%l],delta=a2-a1;delta<0&&(delta+=2*Math.PI),delta>max&&(max=delta,index=i)}result=angles[index]+max/2}return result},doAutoAdjustAttachedMarkerPos:function(obj,marker,markerMargin,allowCoordBorrow,avoidDirectionAngles){marker&&!marker.getCoordOfMode(this.getCoordMode())&&obj.autoSetMarker2DPos(marker,markerMargin,allowCoordBorrow,avoidDirectionAngles)},doAdjustChemPropMarkerPos:function(obj,markMargin,allowCoordBorrow,avoidDirectionAngles){obj.beginUpdate();try{var chargeMarker=obj.getMarkerOfType(Kekule.ChemMarker.Charge);this.doAutoAdjustAttachedMarkerPos(obj,chargeMarker,markMargin,allowCoordBorrow,avoidDirectionAngles);var radicalMarker=obj.getMarkerOfType(Kekule.ChemMarker.Radical);this.doAutoAdjustAttachedMarkerPos(obj,radicalMarker,markMargin,allowCoordBorrow,avoidDirectionAngles);for(var markers=obj.getUnplacedMarkers(this.getCoordMode()),i=0,l=markers.length;i<l;++i)this.doAutoAdjustAttachedMarkerPos(obj,markers[i],markMargin,allowCoordBorrow,avoidDirectionAngles)}finally{obj.endUpdate()}},doDrawElectronStateMark:function(context,group,node,markType,partialChargeDecimalsLength,distinguishSingletAndTripletRadical,markFontFamily,markFontSize,markMargin,circleStrokeWidth,color,opacity,zoom){var charge=node.getCharge(),radical=node.getRadical(),slabel="";if(!partialChargeDecimalsLength||Math.abs(charge)>Math.pow(10,-partialChargeDecimalsLength)/2){var isCircled=(Kekule.Render.ChargeMarkRenderType.CIRCLE_AROUND,markType===Kekule.Render.ChargeMarkRenderType.CIRCLE_AROUND);if(1===charge)slabel=isCircled?"⊕":"+";else if(-1===charge)slabel=isCircled?"⊖":"−";else{var sCharge=partialChargeDecimalsLength?Kekule.NumUtils.toDecimals(Math.abs(charge),partialChargeDecimalsLength):Math.abs(charge).toString();slabel=sCharge+(charge>0?"+":"−")}}if(radical&&(slabel+=Kekule.Render.ChemDisplayTextUtils.getRadicalDisplayText(radical,distinguishSingletAndTripletRadical)),!slabel)return null;var coord=this.getTransformedCoord2D(context,node),dirAngle=this._getMostEmptyDirectionAngleOfNode(context,node),vector={x:Math.cos(dirAngle),y:Math.sin(dirAngle)},ratio=markMargin/1,markCoord={x:vector.x*ratio,y:vector.y*ratio};markCoord=Kekule.CoordUtils.add(coord,markCoord);var tboxXAlign,tboxYAlign,BXA=Kekule.Render.BoxXAlignment,BYA=Kekule.Render.BoxYAlignment;return tboxXAlign=BXA.CENTER,tboxYAlign=BYA.CENTER,this.drawText(context,markCoord,slabel,{fontFamily:markFontFamily,fontSize:markFontSize,color:color,opacity:opacity,textBoxXAlignment:tboxXAlign,textBoxYAlignment:tboxYAlign,zoom:zoom||1})},doDrawConnectorShape:function(context,connector,node1,node2,renderOptions,finalTransformOptions){var lineLengthScaleBaseNodeIndex,CU=Kekule.CoordUtils,coord1=Object.extend({},this.getTransformedCoord2D(context,node1,finalTransformOptions.allowCoordBorrow)),coord2=Object.extend({},this.getTransformedCoord2D(context,node2,finalTransformOptions.allowCoordBorrow)),nodes=[node1,node2],coords=[coord1,coord2],originDistance=CU.getDistance(coord1,coord2),shrinkedDistance=0,unitLength=renderOptions.unitLength||1,lineLength=Math.sqrt(Math.sqr(coord2.x-coord1.x)+Math.sqr(coord2.y-coord1.y)),lineAdjustCoordDeltas=[],lineLengthScaleRatio=renderOptions.bondLengthScaleRatio;if(Kekule.ObjUtils.notUnset(lineLengthScaleRatio)){var lineVector=CU.substract(coord2,coord1);!0,lineLengthScaleBaseNodeIndex=lineLengthScaleRatio>0?0:1;var shrinkRatio=1-Math.abs(lineLengthScaleRatio||1),sign=1===lineLengthScaleBaseNodeIndex?-1:1;lineAdjustCoordDeltas[lineLengthScaleBaseNodeIndex]=CU.multiply(lineVector,sign*shrinkRatio)}if(this.getObjNeedDrawLabel(context,node1)||this.getObjNeedDrawLabel(context,node2)){var halfLabelBoxWidth,halfLabelBoxHeight,crossOnVerticalEdge,expandRatio=renderOptions.atomLabelBoxExpandRatio,lineXPrj=coord2.x-coord1.x,lineYPrj=coord2.y-coord1.y,xSign=lineXPrj>=0?1:-1,ySign=lineYPrj>=0?1:-1,isVerticalLine=0===lineXPrj;if(!isVerticalLine)var angleTg=Math.abs(lineYPrj/lineXPrj);crossOnVerticalEdge=Math.abs(lineXPrj)>=Math.abs(lineYPrj);for(var i=0,l=nodes.length;i<l;++i){var node=nodes[i],coord=coords[i],coordDelta=null;if(this.getObjNeedDrawLabel(context,node)){if(halfLabelBoxWidth=halfLabelBoxHeight=this._getNodeFontSize(context,node)*(finalTransformOptions.zoom||1)*unitLength*expandRatio/2,coordDelta=crossOnVerticalEdge?{x:halfLabelBoxWidth*xSign,y:halfLabelBoxWidth*angleTg*ySign}:isVerticalLine?{x:0,y:halfLabelBoxHeight*ySign}:{x:halfLabelBoxHeight/angleTg*xSign,y:halfLabelBoxHeight*ySign}){var scaleCoordDelta=lineAdjustCoordDeltas[i];scaleCoordDelta&&Math.abs(lineLengthScaleRatio)<=1?(Math.abs(coordDelta.x)>Math.abs(scaleCoordDelta.x)||Math.abs(coordDelta.y)>Math.abs(scaleCoordDelta.y))&&(lineAdjustCoordDeltas[i]=coordDelta):lineAdjustCoordDeltas[i]=coordDelta}}xSign*=-1,ySign*=-1}}for(var i=0,l=coords.length;i<l;++i){var coord=coords[i],coordDelta=lineAdjustCoordDeltas[i];if(coordDelta){shrinkedDistance+=CU.getDistance(coordDelta,{x:0,y:0});var newCoord=CU.add(coord,coordDelta);coord.x=newCoord.x,coord.y=newCoord.y}}if(shrinkedDistance>=originDistance)return null;var strokeWidth=(renderOptions.bondLineWidth||renderOptions.strokeWidth||1)*(renderOptions.unitLength||1);renderOptions.strokeWidth=strokeWidth;var renderType=renderOptions.renderType,allowedTypes=Kekule.Render.ConnectorDrawUtils.getPossibleConnectorRenderTypes(connector);(Kekule.ObjUtils.isUnset(renderType)||allowedTypes.indexOf(renderType)<0)&&(renderType=allowedTypes[0]);var result;return this.isLineBasedConnector(renderType)?result=this.doDrawLineBasedConnector(context,renderType,node1,node2,coord1,coord2,lineLength,renderOptions):this.isTriangleBasedConnector(renderType)?result=this.doDrawTriangleBasedConnector(context,renderType,node1,node2,coord1,coord2,lineLength,renderOptions):this.isTriangleHashBasedConnector(renderType)?result=this.doDrawTriangleHashBasedConnector(context,renderType,node1,node2,coord1,coord2,lineLength,renderOptions):this.isRectangleBasedConnector(renderType)?result=this.doDrawRectangleBasedConnector(context,renderType,node1,node2,coord1,coord2,lineLength,renderOptions):this.isWavyBasedConnector(renderType)&&(result=this.doDrawWavyBasedConnector(context,renderType,node1,node2,coord1,coord2,lineLength,renderOptions)),result},_lineBasedConnectorTypes:[RT.SINGLE,RT.DOUBLE,RT.TRIPLE,RT.QUAD,RT.SCISSORS_DOUBLE,RT.BOLD,RT.BOLD_DOUBLE,RT.BOLD_TRIPLE,RT.DASHED,RT.DASHED_DOUBLE,RT.DASHED_TRIPLE,RT.SOLID_DASH,RT.BOLD_DASH,RT.ARROWED],_triangleBasedConnectorTypes:[RT.WEDGED_SOLID,RT.WEDGED_SOLID_INV,RT.WEDGED_HOLLOW,RT.WEDGED_HOLLOW_INV],_triangleHashBasedConnectorTypes:[RT.WEDGED_HASHED,RT.WEDGED_HASHED_INV,RT.HASHED],_rectangleBasedConnectorTypes:[RT.WEDGED_SOLID_BOTH,RT.WEDGED_HOLLOW_BOTH],isLineBasedConnector:function(renderType){return this._lineBasedConnectorTypes.indexOf(renderType)>=0},isTriangleBasedConnector:function(renderType){return this._triangleBasedConnectorTypes.indexOf(renderType)>=0},isTriangleHashBasedConnector:function(renderType){return this._triangleHashBasedConnectorTypes.indexOf(renderType)>=0},isRectangleBasedConnector:function(renderType){return this._rectangleBasedConnectorTypes.indexOf(renderType)>=0},isWavyBasedConnector:function(renderType){return RT.WAVY},doDrawLineBasedConnector:function(context,renderType,node1,node2,coord1,coord2,lineLength,options){var lineParams=[],param={isBold:!1,isDash:!1},boldParam={isBold:!0,isDash:!1},dashParam={isBold:!1,isDash:!0};switch(renderType){case RT.DOUBLE:case RT.SCISSORS_DOUBLE:for(var i=0;i<2;++i,lineParams.push(param));break;case RT.TRIPLE:for(var i=0;i<3;++i,lineParams.push(param));break;case RT.QUAD:for(var i=0;i<4;++i,lineParams.push(param));break;case RT.BOLD:lineParams.push(boldParam);break;case RT.BOLD_DOUBLE:lineParams.push(boldParam),lineParams.push(param);break;case RT.BOLD_TRIPLE:lineParams.push(boldParam);for(var i=0;i<2;++i,lineParams.push(param));break;case RT.BOLD_QUAD:lineParams.push(boldParam);for(var i=0;i<3;++i,lineParams.push(param));break;case RT.DASHED:lineParams.push(dashParam);break;case RT.DASHED_DOUBLE:for(var i=0;i<2;++i,lineParams.push(dashParam));break;case RT.DASHED_TRIPLE:for(var i=0;i<3;++i,lineParams.push(dashParam));break;case RT.SOLID_DASH:lineParams.push(param),lineParams.push(dashParam);break;case RT.BOLD_DASH:lineParams.push(boldParam),lineParams.push(dashParam);break;case RT.ARROWED:param.isArrow=!0,lineParams.push(param);break;case RT.SINGLE:default:lineParams.push(param)}var isCross=renderType===RT.SCISSORS_DOUBLE;return this.doDrawSymmetryLineConnector(context,node1,node2,coord1,coord2,lineLength,lineParams,isCross,options)},doDrawSymmetryLineConnector:function(context,node1,node2,coord1,coord2,lineLength,lineParams,isCross,options){var lineCount=lineParams.length,group=null,line=null;if(1===lineCount){var strokeWidth=options.strokeWidth;lineParams[0].isBold&&(strokeWidth*=options.boldBondLineWidthRatio);var arrowParams=null;lineParams[0].isArrow&&(arrowParams={width:options.bondArrowWidth*options.unitLength,length:options.bondArrowLength*options.unitLength});var ops={strokeWidth:strokeWidth,strokeColor:Kekule.Render.RenderOptionUtils.getColor(options),strokeDash:lineParams[0].isDash,opacity:options.opacity},line=this.drawArrowLine(context,coord1,coord2,arrowParams,ops),boundInfo=this.createLineBoundInfo(coord1,coord2,strokeWidth)}else if(lineCount>1){group=this.createDrawGroup(context);var lineGap=options.multipleBondSpacingAbs?options.multipleBondSpacingAbs:options.multipleBondSpacingRatio*lineLength;options.multipleBondMaxAbsSpacing&&(lineGap=Math.min(lineGap,options.multipleBondMaxAbsSpacing)),lineGap*=options.unitLength;var w=coord2.x-coord1.x,h=coord2.y-coord1.y,actualLineLength=Math.sqrt(Math.sqr(w)+Math.sqr(h)),angleSin=h/actualLineLength,angleCos=w/actualLineLength,adjusts=[],initialBondAlign=1;1&lineCount||(initialBondAlign=isCross?0:Kekule.ObjUtils.isUnset(lineParams.bondAlign)?this._decideEvenBondAlign(context,node1,node2):lineParams.bondAlign);for(var i=0;i<lineCount;++i)if(Kekule.ObjUtils.notUnset(lineParams[i].offsetAdjust))adjusts.push(lineParams[i].offsetAdjust);else if(0===i&&0!==initialBondAlign)adjusts.push(0);else{var sign=1&i?1:-1;if(0!==initialBondAlign)var offsetAdjust=initialBondAlign*sign*(i+1>>1);else var offsetAdjust=(1*(i>>1)+.5)*sign;adjusts.push(offsetAdjust)}var currGap=lineGap;currGap>maxGap&&(maxGap=currGap),currGap<minGap&&(minGap=currGap);for(var averCoord1={x:0,y:0},averCoord2={x:0,y:0},maxGap=0,minGap=0,realDrawParams=[],i=0;i<lineCount;++i){var localOptions=Object.create(options),deltaX=currGap*angleSin,deltaY=currGap*angleCos,newCoord1={x:coord1.x-deltaX*adjusts[i],y:coord1.y+deltaY*adjusts[i]},newCoord2={x:coord2.x-deltaX*adjusts[i],y:coord2.y+deltaY*adjusts[i]};averCoord1=Kekule.CoordUtils.add(averCoord1,newCoord1),averCoord2=Kekule.CoordUtils.add(averCoord2,newCoord2);var arrowParams=null;lineParams[i].isArrow&&(arrowParams={width:options.bondArrowWidth*options.unitLength,length:options.bondArrowLength*options.unitLength});var strokeWidth=options.strokeWidth;lineParams[i].isBold&&(strokeWidth*=options.boldBondLineWidthRatio),localOptions.strokeColor=options.color,localOptions.strokeDash=lineParams[i].isDash,realDrawParams.push({coord1:newCoord1,coord2:newCoord2,arrowParams:arrowParams,drawOptions:localOptions}),currGap=lineParams[i].isBold?lineGap+Math.floor(strokeWidth/2):lineGap}if(isCross)for(var i=0;i<lineCount;++i){var currPartParam=realDrawParams[i],counterPartParam=realDrawParams[lineCount-i-1],line=this.drawArrowLine(context,currPartParam.coord1,counterPartParam.coord2,currPartParam.arrowParams,currPartParam.drawOptions);this.addToDrawGroup(line,group)}else for(var i=0;i<lineCount;++i){var realParam=realDrawParams[i],line=this.drawArrowLine(context,realParam.coord1,realParam.coord2,realParam.arrowParams,realParam.drawOptions);this.addToDrawGroup(line,group)}averCoord1=Kekule.CoordUtils.divide(averCoord1,lineCount),averCoord2=Kekule.CoordUtils.divide(averCoord2,lineCount);var boundInfo=this.createLineBoundInfo(averCoord1,averCoord2,maxGap-minGap)}return{element:group||line,boundInfo:boundInfo}},_getStandardizedLinkedObjRelCoords:function(context,node,excludeNode){for(var result=[],baseCoord=this.getTransformedCoord2D(context,node),linkedObjs=node.getLinkedExposedObjs(),i=0,l=linkedObjs.length;i<l;++i){var obj=linkedObjs[i];if(obj!==excludeNode){var coord=this.getTransformedCoord2D(context,obj),newCoord=Kekule.CoordUtils.substract(coord,baseCoord);newCoord=Kekule.CoordUtils.standardize(newCoord),result.push(newCoord)}}return result},_decideEvenBondAlign:function(context,node1,node2){var bondVector=Kekule.CoordUtils.substract(this.getTransformedCoord2D(context,node2),this.getTransformedCoord2D(context,node1));bondVector=Kekule.CoordUtils.standardize(bondVector);for(var coords1=this._getStandardizedLinkedObjRelCoords(context,node1,node2),coords2=this._getStandardizedLinkedObjRelCoords(context,node2,node1),sumAlign=0,sumVector={x:0,y:0},i=0,l=coords1.length;i<l;++i)sumAlign+=this._calcSinglePointAlign(coords1[i],bondVector),sumVector.x+=coords1[i].x,sumVector.y+=coords1[i].y;for(var i=0,l=coords2.length;i<l;++i)sumAlign+=this._calcSinglePointAlign(coords2[i],bondVector),sumVector.x+=coords2[i].x,sumVector.y+=coords2[i].y;return 0!==sumAlign?Math.sign(sumAlign):this._calcSinglePointAlign(sumVector,bondVector)},_calcSinglePointAlign:function(coord,baseVector){var result;if(Math.abs(baseVector.x)<1e-4)return result=Math.abs(coord.x)<1e-4?0:-Math.sign(coord.x)*Math.sign(baseVector.y);var y=baseVector.y*coord.x/baseVector.x,delta=coord.y-y;return result=delta>1e-4?1:delta<-1e-4?-1:0,result*=Math.sign(baseVector.x)},doDrawTriangleBasedConnector:function(context,renderType,node1,node2,coord1,coord2,lineLength,options){var isFilled=renderType===RT.WEDGED_SOLID||renderType===RT.WEDGED_SOLID_INV,isInverted=renderType===RT.WEDGED_SOLID_INV||renderType===RT.WEDGED_HOLLOW_INV,baseCoords=isInverted?[coord2,coord1]:[coord1,coord2],w=options.bondWedgeWidth*options.unitLength,coords=this._calcTriangleBaselineCoords(baseCoords[0],baseCoords[1],w),localOptions=Object.create(options);localOptions.strokeColor=options.color,localOptions.fillColor=isFilled?options.color:null;var elem=this.drawTriangle(context,baseCoords[0],coords[0],coords[1],localOptions),result={element:elem};return result.boundInfo=this.createLineBoundInfo(baseCoords[0],baseCoords[1],w),result},doDrawTriangleHashBasedConnector:function(context,renderType,node1,node2,coord1,coord2,lineLength,options){var isInverted=renderType===RT.WEDGED_HASHED_INV,isTriangle=renderType!==RT.HASHED,baseCoords=isInverted?[coord2,coord1]:[coord1,coord2],gap=options.hashSpacing*options.unitLength,maxWidth=options.bondWedgeWidth*options.unitLength,minWidth=isTriangle?options.bondWedgeHashMinWidth*options.unitLength:maxWidth,deltaW=maxWidth-minWidth,box=Kekule.CoordUtils.substract(baseCoords[1],baseCoords[0]),totalLength=Math.sqrt(Math.sqr(box.x)+Math.sqr(box.y)),hashCount=Math.floor(totalLength/gap),group=this.createDrawGroup(context),localOptions=Object.create(options);localOptions.strokeColor=options.color;for(var i=0;i<hashCount;++i){var l=gap*i,ratio=l/totalLength,stepCoord={x:box.x*ratio,y:box.y*ratio};stepCoord=Kekule.CoordUtils.add(stepCoord,baseCoords[0]);var baselineCoords=this._calcTriangleBaselineCoords(baseCoords[0],stepCoord,deltaW*ratio+minWidth),elem=this.drawLine(context,baselineCoords[0],baselineCoords[1],localOptions);this.addToDrawGroup(elem,group)}var result={element:group};return result.boundInfo=this.createLineBoundInfo(baseCoords[0],baseCoords[1],maxWidth),result},_calcTriangleBaselineCoords:function(vertexCoord,midPointCoord,baseLineWidth){var box=Kekule.CoordUtils.substract(midPointCoord,vertexCoord),len=Math.sqrt(Math.sqr(box.x)+Math.sqr(box.y)),angleSin=box.y/len,angleCos=box.x/len,w=baseLineWidth/2,result=[];return result.push({x:midPointCoord.x+w*angleSin,y:midPointCoord.y-w*angleCos}),result.push({x:midPointCoord.x-w*angleSin,y:midPointCoord.y+w*angleCos}),result},doDrawRectangleBasedConnector:function(context,renderType,node1,node2,coord1,coord2,lineLength,options){var isFilled=renderType===RT.WEDGED_SOLID_BOTH,w=options.bondWedgeWidth*options.unitLength,coords=this._calcRectangleCornerCoords(coord1,coord2,w),localOptions=Object.create(options);localOptions.strokeColor=options.color,localOptions.fillColor=isFilled?options.color:null;var path=Kekule.Render.DrawPathUtils.makePath("M",[coords[0].x,coords[0].y],"L",[coords[1].x,coords[1].y],"L",[coords[2].x,coords[2].y],"L",[coords[3].x,coords[3].y],"Z"),elem=this.drawPath(context,path,localOptions),result={element:elem};return result.boundInfo=this.createLineBoundInfo(coord1,coord2,w),result},_calcRectangleCornerCoords:function(end1Coord,end2Coord,baseLineWidth){var box=Kekule.CoordUtils.substract(end2Coord,end1Coord),len=Math.sqrt(Math.sqr(box.x)+Math.sqr(box.y)),angleSin=box.y/len,angleCos=box.x/len,w=baseLineWidth/2,result=[],delta={x:w*angleSin,y:w*angleCos};return result.push({x:end1Coord.x+delta.x,y:end1Coord.y-delta.y}),result.push({x:end1Coord.x-delta.x,y:end1Coord.y+delta.y}),result.push({x:end2Coord.x-delta.x,y:end2Coord.y+delta.y}),result.push({x:end2Coord.x+delta.x,y:end2Coord.y-delta.y}),result},doDrawWavyBasedConnector:function(context,renderType,node1,node2,coord1,coord2,lineLength,options){for(var beginCoord,CU=Kekule.CoordUtils,refRadius=options.bondWavyRadius*options.unitLength,bondLength=CU.getDistance(coord1,coord2),arcCount=Math.round(bondLength/refRadius),coordDelta=CU.divide(CU.substract(coord2,coord1),arcCount),arcRadius=bondLength/arcCount,pathParams=[],endCoord=coord1,angle=Math.atan2(coordDelta.y,coordDelta.x)+Math.PI,controlPointDelta={x:arcRadius/1.5*Math.sin(angle),y:-arcRadius/1.5*Math.cos(angle)},sign=1,i=0;i<arcCount;++i){sign=-sign,beginCoord=endCoord,endCoord=CU.add(beginCoord,coordDelta);var c=CU.multiply(controlPointDelta,sign),ctrlCoord1=CU.add(beginCoord,c),ctrlCoord2=CU.add(endCoord,c);0===i&&(pathParams.push("M"),pathParams.push([beginCoord.x,beginCoord.y])),pathParams.push("C"),pathParams.push([ctrlCoord1.x,ctrlCoord1.y,ctrlCoord2.x,ctrlCoord2.y,endCoord.x,endCoord.y])}var path=Kekule.Render.DrawPathUtils.makePath.apply(Kekule.Render.DrawPathUtils,pathParams),localOptions=Object.create(options);localOptions.strokeColor=options.color,localOptions.fillColor=null;var elem=this.drawPath(context,path,localOptions),result={element:elem};return result.boundInfo=this.createLineBoundInfo(coord1,coord2,arcRadius),result}}),Kekule.Render.StructFragment2DRenderer=Class.create(Kekule.Render.ChemObj2DRenderer,{CLASS_NAME:"Kekule.Render.StructFragment2DRenderer",initialize:function($super,chemObj,drawBridge,parent){$super(chemObj,drawBridge,parent),this._concreteRenderer=null,this._concreteChemObj=null,this.initConcreteRenderer()},finalize:function($super){$super(),this._concreteRenderer&&(this._concreteRenderer.finalize(),this._concreteRenderer=null)},initConcreteRenderer:function(){var chemObj=this.getChemObj(),drawBridge=this.getDrawBridge();return this._isRendererMismatch(this._concreteRenderer,chemObj)&&this._concreteRenderer&&(this._concreteRenderer.finalize(),this._concreteRenderer=null,this._concreteChemObj=null),!this._concreteRenderer&&chemObj&&(chemObj.hasCtab()?(this._concreteChemObj=chemObj.getCtab(),this._concreteRenderer=new Kekule.Render.ChemCtab2DRenderer(chemObj.getCtab(),drawBridge,this)):chemObj.hasFormula()&&(this._concreteChemObj=chemObj.getFormula(),this._concreteRenderer=new Kekule.Render.Formula2DRenderer(chemObj.getFormula(),drawBridge,this))),this._concreteRenderer},_isRendererMismatch:function(renderer,chemObj){return renderer&&!chemObj||renderer instanceof Kekule.Render.ChemCtab2DRenderer&&!chemObj.hasCtab()||renderer instanceof Kekule.Render.Formula2DRenderer&&!chemObj.hasFormula()},getConcreteRenderer:function(){return this.initConcreteRenderer(),this._concreteRenderer},getRenderCache:function($super,context){return $super(context)},_getConcreteRendererDrawOptions:function(options){return options},isChemObjRenderedBySelf:function($super,context,obj){var r=this.getConcreteRenderer();return $super(context,obj)||obj===this.getChemObj()||r&&r.isChemObjRenderedBySelf(context,obj)},isChemObjRenderedDirectlyBySelf:function($super,context,obj){this.getConcreteRenderer();return $super(context,obj)||obj===this.getChemObj()||obj===this._concreteChemObj},doSetRedirectContext:function($super,value){$super(value);var r=this.getConcreteRenderer();r&&r.setRedirectContext(value)},getChildObjs:function($super){var chemObj=this.getChemObj();if(chemObj&&chemObj.getAttachedMarkers){for(var r=[],childObjs=(chemObj.getExposedNodes()||[]).concat(chemObj.getExposedConnectors()||[]),i=0,l=childObjs.length;i<l;++i){var obj=childObjs[i];r=r.concat(obj.getAttachedMarkers())}return r.concat($super())}return $super()},_needWholelyDraw:function($super,partialDrawObjs,context){var result=$super(partialDrawObjs,context);if(!result){for(var chemObj=this.getChemObj(),hasStructObjs=!1,i=0,l=partialDrawObjs.length;i<l;++i){if(partialDrawObjs[i].isChildOf(chemObj)){hasStructObjs=!0;break}}result=hasStructObjs}return result},_createChargeAndRadicalMarkerOnStructFragment:function(mol){mol.beginUpdate();try{mol.getCharge&&mol.getCharge()&&mol.fetchChargeMarker(!0);for(var i=(mol.getNodes(),0),l=mol.getNodeCount();i<l;++i){var node=mol.getNodeAt(i);node.beginUpdate();try{node.getCharge()&&node.fetchChargeMarker(!0),node.getRadical()&&node.fetchRadicalMarker(!0),node.getNodeAt&&this._createChargeAndRadicalMarkerOnStructFragment(node)}finally{node.endUpdate()}}}finally{mol.endUpdate()}},doDraw:function($super,context,baseCoord,options){var useChargeAndRadicalMarkers=!!options.autoCreateChargeAndRadicalMarker;if(this.getCanModifyTargetObj()&&useChargeAndRadicalMarkers){var mol=this.getChemObj();this._createChargeAndRadicalMarkerOnStructFragment(mol)}$super(context,baseCoord,options)},doDrawSelf:function($super,context,baseCoord,options){$super(context,baseCoord,options);var chemObj=this.getChemObj(),actualBaseCoord=baseCoord,r=this.getConcreteRenderer();if(!actualBaseCoord&&r instanceof Kekule.Render.Formula2DRenderer&&chemObj.getAbsBaseCoord2D){var coord=chemObj.getAbsBaseCoord2D(options.allowCoordBorrow);actualBaseCoord=Kekule.CoordUtils.transform2D(coord,options.transformParams)}return chemObj.hasFormula()||chemObj.hasCtab()?r?r.draw(context,actualBaseCoord,this._getConcreteRendererDrawOptions(options)):void 0:null},doRedraw:function($super,context){return $super(context)},doUpdateSelf:function(context,updatedObjDetails,updateType){if(this._extractObjsOfUpdateObjDetails(updatedObjDetails).indexOf(this.getChemObj())>=0){var p=this.getRenderCache(context);return this.doClear(context),this.draw(context,p.baseCoord,p.options)}var r=this.getConcreteRenderer();if(r)return r.doUpdate(context,updatedObjDetails,updateType)},doClearSelf:function(context){var r=this.getConcreteRenderer();if(r)return r.clear(context)},estimateRenderBox:function(context,baseCoord,options,allowCoordBorrow){var r=this.getConcreteRenderer();return r?r.estimateRenderBox(context,baseCoord,this._getConcreteRendererDrawOptions(options),allowCoordBorrow):null},transformCoordToObj:function($super,context,chemObj,coord){return $super(context,chemObj,coord)},transformCoordToContext:function($super,context,chemObj,coord){return $super(context,chemObj,coord)}}),Kekule.Render.Mol2DRenderer=Kekule.Render.StructFragment2DRenderer,Kekule.Render.CompositeObj2DRenderer=Class.create(Kekule.Render.ChemObj2DRenderer,{CLASS_NAME:"Kekule.Render.CompositeObj2DRenderer"}),Kekule.Render.CompositeMolecule2DRenderer=Class.create(Kekule.Render.CompositeObj2DRenderer,{CLASS_NAME:"Kekule.Render.CompositeMolecule2DRenderer",getChildObjs:function($super){for(var r=[],group=this.getChemObj().getSubMolecules(),i=0,l=group.getItemCount();i<l;++i){var o=group.getObjAt(i);r.push(o)}return r.concat($super())}}),Kekule.Render.ChemObjGroupList2DRenderer=Class.create(Kekule.Render.CompositeObj2DRenderer,{CLASS_NAME:"Kekule.Render.CompositeMolecule2DRenderer",getChildObjs:function($super){var obj=this.getChemObj();if(obj instanceof Kekule.ChemObjList)for(var r=[],i=0,l=obj.getItemCount();i<l;++i)r.push(obj.getItemAt(i));else obj instanceof Kekule.ChemStructureObjectGroup&&(r=obj.getAllObjs());return(r||[]).concat($super())}}),Kekule.Render.Reaction2DRenderer=Class.create(Kekule.Render.CompositeObj2DRenderer,{CLASS_NAME:"Kekule.Render.Reaction2DRenderer",getChildObjs:function($super){for(var r=[],reaction=this.getChemObj(),r=[],i=0,l=reaction.getReactantCount();i<l;++i){var o=reaction.getReactantAt(i);r.push(o)}for(var i=0,l=reaction.getProductCount();i<l;++i){var o=reaction.getProductAt(i);r.push(o)}return(r||[]).concat($super())}}),Kekule.Render.ChemSpaceElement2DRenderer=Class.create(Kekule.Render.CompositeObj2DRenderer,{CLASS_NAME:"Kekule.Render.ChemSpaceElement2DRenderer",getChildObjs:function($super){var result=$super()||[];return result=(this.getChemObj().getChildren().toArray()||[]).concat(result)}}),Kekule.Render.ChemSpace2DRenderer=Class.create(Kekule.Render.CompositeObj2DRenderer,{CLASS_NAME:"Kekule.Render.ChemSpace2DRenderer",getChildObjs:function($super){return[this.getChemObj().getRoot()].concat($super()||[])},doEstimateSelfObjBox:function($super,context,options,allowCoordBorrow){var size=this.getChemObj().getSize2D();if(size.x&&size.y&&options.useExplicitSpaceSize){return{x1:0,y1:0,x2:size.x,y2:size.y}}return $super(context,options,allowCoordBorrow)}}),Kekule.Render.Renderer2DFactory.register(Kekule.ChemMarker.Charge,Kekule.Render.TextBasedChemMarker2DRenderer),Kekule.Render.Renderer2DFactory.register(Kekule.ChemMarker.Radical,Kekule.Render.TextBasedChemMarker2DRenderer),Kekule.Render.Renderer2DFactory.register(Kekule.ChemMarker.UnbondedElectronSet,Kekule.Render.UnbondedElectronSetRenderer),Kekule.Render.Renderer2DFactory.register(Kekule.TextBlock,Kekule.Render.TextBlock2DRenderer),Kekule.Render.Renderer2DFactory.register(Kekule.ImageBlock,Kekule.Render.ImageBlock2DRenderer),Kekule.Render.Renderer2DFactory.register(Kekule.StructureFragment,Kekule.Render.StructFragment2DRenderer),Kekule.Render.Renderer2DFactory.register(Kekule.CompositeMolecule,Kekule.Render.CompositeMolecule2DRenderer),Kekule.Render.Renderer2DFactory.register(Kekule.Reaction,Kekule.Render.Reaction2DRenderer),Kekule.Render.Renderer2DFactory.register(Kekule.ChemObjList,Kekule.Render.ChemObjGroupList2DRenderer),Kekule.Render.Renderer2DFactory.register(Kekule.ChemStructureObjectGroup,Kekule.Render.ChemObjGroupList2DRenderer),Kekule.Render.Renderer2DFactory.register(Kekule.ChemSpaceElement,Kekule.Render.ChemSpaceElement2DRenderer),Kekule.Render.Renderer2DFactory.register(Kekule.ChemSpace,Kekule.Render.ChemSpace2DRenderer),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class;module.exports=function(Kekule){var NT=Kekule.Glyph.NodeType,PT=Kekule.Glyph.PathType;return Kekule.Render.BaseGlyph2DRenderer=Class.create(Kekule.Render.ChemObj2DRenderer,{CLASS_NAME:"Kekule.Render.BaseGlyph2DRenderer",doDraw:function($super,context,baseCoord,options){var ops=Object.create(options);return ops.strokeColor=options.strokeColor||options.glyphStrokeColor,ops.fillColor=options.fillColor||options.glyphFillColor,ops.strokeWidth=options.strokeWidth||options.glyphStrokeWidth,$super(context,baseCoord,ops)}}),Kekule.Render.PathGlyphCtab2DRenderer=Class.create(Kekule.Render.Ctab2DRenderer,{CLASS_NAME:"Kekule.Render.PathGlyphCtab2DRenderer",extractGlyphDrawOptions:function(renderOptions){var unitLength=renderOptions.unitLength||1;return{strokeColor:renderOptions.strokeColor||renderOptions.color||renderOptions.glyphStrokeColor,fillColor:renderOptions.fillColor||renderOptions.color||renderOptions.glyphFillColor,strokeWidth:(renderOptions.strokeWidth||renderOptions.glyphStrokeWidth)*unitLength}},doDraw:function($super,context,baseCoord,options){return $super(context,baseCoord,options)},doDrawNode:function(context,group,node,parentChemObj,options,finalTransformOptions){var boundInfo,coord=this.getTransformedCoord2D(context,node,finalTransformOptions.allowCoordBorrow),nodeType=node.getNodeType();nodeType&&nodeType!==NT.LOCATION||(boundInfo=this.createPointBoundInfo(coord)),boundInfo&&this.basicDrawObjectUpdated(context,node,parentChemObj,boundInfo,Kekule.Render.ObjectUpdateType.ADD)},doDrawConnectorShape:function(context,connector,node1,node2,renderOptions,finalTransformOptions){var startArrowParams,endArrowParams,coord1=Object.extend({},this.getTransformedCoord2D(context,node1,finalTransformOptions.allowCoordBorrow)),coord2=Object.extend({},this.getTransformedCoord2D(context,node2,finalTransformOptions.allowCoordBorrow)),drawOptions=this.extractGlyphDrawOptions(renderOptions),pathType=connector.getPathType(),pathParams=connector.getPathParams()||{},ctab=this.getChemObj(),lineGap=pathParams.lineGap||0,lineCount=lineGap?pathParams.lineCount||1:1,CU=Kekule.CoordUtils,AS=Kekule.Glyph.ArrowSide,coordDelta=CU.substract(coord2,coord1),w=coordDelta.x,h=coordDelta.y,l=CU.getDistance(coord1,coord2),angleSin=h/l,angleCos=w/l,deltaObjVector={y:lineGap*angleCos,x:lineGap*angleSin},deltaScreenCoord=CU.substract(this.transformCoordToContext(context,ctab,{x:0,y:0}),this.transformCoordToContext(context,ctab,deltaObjVector)),lineScreenGap=CU.getDistance(deltaScreenCoord,{x:0,y:0}),arrowElems=(CU.multiply(deltaScreenCoord,(lineCount-1)/2),[]);if(pathParams.startArrowType&&pathParams.startArrowWidth){var transedLengthes=this._transformArrowLength(context,pathParams.startArrowLength,pathParams.startArrowWidth);startArrowParams={arrowLength:transedLengthes.arrowLength,arrowWidth:transedLengthes.arrowWidth,arrowType:pathParams.startArrowType,arrowSide:pathParams.startArrowSide,drawOnCenter:!pathParams.startArrowSide||pathParams.startArrowSide===AS.BOTH},startArrowParams.drawOnCenter&&Kekule.ArrayUtils.pushUnique(arrowElems,this.doDrawArrowShape(context,connector,coord2,coord1,startArrowParams,drawOptions,!0))}if(pathParams.endArrowType&&pathParams.endArrowWidth){var transedLengthes=this._transformArrowLength(context,pathParams.endArrowLength,pathParams.endArrowWidth),endArrowParams={arrowLength:transedLengthes.arrowLength,arrowWidth:transedLengthes.arrowWidth,arrowType:pathParams.endArrowType,arrowSide:pathParams.endArrowSide,drawOnCenter:!pathParams.endArrowSide||pathParams.endArrowSide===AS.BOTH};endArrowParams.drawOnCenter&&Kekule.ArrayUtils.pushUnique(arrowElems,this.doDrawArrowShape(context,connector,coord1,coord2,endArrowParams,drawOptions))}for(var adjustC1,adjustC2,initialOffsetCoord=CU.multiply(deltaScreenCoord,(lineCount-1)/2),c1=CU.substract(coord1,initialOffsetCoord),c2=CU.substract(coord2,initialOffsetCoord),drawnElems=[],boundInfos=[],distance=l,midNo=(lineCount-1)/2,i=0;i<lineCount;++i){if(adjustC1=null,adjustC2=null,0!==i&&(c1=CU.add(c1,deltaScreenCoord),c2=CU.add(c2,deltaScreenCoord)),startArrowParams||endArrowParams){var offsetIndex=i-midNo,currGap=lineScreenGap*Math.abs(offsetIndex);if(startArrowParams){if(startArrowParams.drawOnCenter&&(!startArrowParams.arrowSide||startArrowParams.arrowSide===AS.SINGLE&&offsetIndex<0||startArrowParams.arrowSide===AS.REVERSED&&offsetIndex>0))var adjustLength=startArrowParams.arrowType===Kekule.Glyph.ArrowType.OPEN?startArrowParams.arrowLength*currGap/(startArrowParams.arrowWidth/2):startArrowParams.arrowLength,adjustC1=CU.add(c1,CU.multiply(coordDelta,adjustLength/distance));!startArrowParams.drawOnCenter&&(startArrowParams.arrowSide===AS.SINGLE&&0===i||startArrowParams.arrowSide===AS.REVERSED&&i===lineCount-1)&&Kekule.ArrayUtils.pushUnique(arrowElems,this.doDrawArrowShape(context,connector,c2,c1,startArrowParams,drawOptions,!0))}if(endArrowParams){if(endArrowParams.drawOnCenter&&(!endArrowParams.arrowSide||endArrowParams.arrowSide===AS.SINGLE&&offsetIndex<0||endArrowParams.arrowSide===AS.REVERSED&&offsetIndex>0))var adjustLength=endArrowParams.arrowType===Kekule.Glyph.ArrowType.OPEN?endArrowParams.arrowLength*currGap/(endArrowParams.arrowWidth/2):endArrowParams.arrowLength,adjustC2=CU.substract(c2,CU.multiply(coordDelta,adjustLength/distance));!endArrowParams.drawOnCenter&&(endArrowParams.arrowSide===AS.SINGLE&&0===i||endArrowParams.arrowSide===AS.REVERSED&&i===lineCount-1)&&Kekule.ArrayUtils.pushUnique(arrowElems,this.doDrawArrowShape(context,connector,c1,c2,endArrowParams,drawOptions))}}var lineResult;pathType===PT.LINE&&(lineResult=this.doDrawLineShape(context,connector,adjustC1||c1,adjustC2||c2,drawOptions,renderOptions)),drawnElems.push(lineResult.element),boundInfos.push(lineResult.boundInfo)}if(lineCount<=1&&!arrowElems.length)return{element:drawnElems[0],boundInfo:boundInfos[0]};for(var drawnGroup=this.createDrawGroup(context),i=0;i<lineCount;++i)this.addToDrawGroup(drawnElems[i],drawnGroup);for(var i=0,l=arrowElems.length;i<l;++i)this.addToDrawGroup(arrowElems[i],drawnGroup);return{element:drawnGroup,boundInfo:boundInfos}},_transformArrowLength:function(context,arrowLength,arrowWidth){var coord={x:arrowLength||0,y:arrowWidth||0},transformed=Kekule.CoordUtils.substract(this.transformCoordToContext(context,this.getChemObj(),coord),this.transformCoordToContext(context,this.getChemObj(),{x:0,y:0}));return{arrowLength:Math.abs(transformed.x),arrowWidth:Math.abs(transformed.y)}},doDrawArrowShape:function(context,connector,coord1,coord2,arrowParams,drawOptions,reversed){var arrowWingEnd1,arrowWingEnd2,CU=Kekule.CoordUtils,AS=Kekule.Glyph.ArrowSide,AT=Kekule.Glyph.ArrowType,coordDelta=CU.substract(coord2,coord1),distance=CU.getDistance(coord2,coord1),sinAngle=coordDelta.y/distance,cosAngle=coordDelta.x/distance,arrowLength=arrowParams.arrowLength,arrowWidth=arrowParams.arrowWidth,halfArrowWidth=arrowWidth/2,basePointCoord=CU.substract(coord2,CU.multiply(coordDelta,arrowLength/distance)),offsetCoord={x:halfArrowWidth*sinAngle,y:-halfArrowWidth*cosAngle},PU=Kekule.Render.DrawPathUtils,pathArray=[];!arrowParams.arrowSide||!reversed&&arrowParams.arrowSide===AS.SINGLE||reversed&&arrowParams.arrowSide===AS.REVERSED?(arrowWingEnd1=CU.add(basePointCoord,offsetCoord),pathArray.push("M"),pathArray.push([arrowWingEnd1.x,arrowWingEnd1.y]),pathArray.push("L"),pathArray.push([coord2.x,coord2.y])):(pathArray.push("M"),pathArray.push([coord2.x,coord2.y])),(!arrowParams.arrowSide||!reversed&&arrowParams.arrowSide===AS.REVERSED||reversed&&arrowParams.arrowSide===AS.SINGLE)&&(arrowWingEnd2=CU.substract(basePointCoord,offsetCoord),pathArray.push("L"),pathArray.push([arrowWingEnd2.x,arrowWingEnd2.y]));var doFill=!1;if(arrowParams.arrowType===AT.TRIANGLE){var endCoord=arrowWingEnd1&&arrowWingEnd2?null:basePointCoord;endCoord&&(pathArray.push("L"),pathArray.push([endCoord.x,endCoord.y])),pathArray.push("Z"),doFill=!0}var path=PU.makePath.apply(this,pathArray),drawOps=Object.create(drawOptions);return doFill||(drawOps.fillColor="transparent"),this.drawPath(context,path,drawOps)},doDrawLineShape:function(context,connector,coord1,coord2,drawOptions,renderOptions){return{element:this.drawLine(context,coord1,coord2,drawOptions),boundInfo:this.createLineBoundInfo(coord1,coord2,drawOptions.strokeWidth)}}}),Kekule.Render.PathGlyph2DRenderer=Class.create(Kekule.Render.BaseGlyph2DRenderer,{CLASS_NAME:"Kekule.Render.PathGlyph2DRenderer",initialize:function($super,chemObj,drawBridge,parent){$super(chemObj,drawBridge,parent),this._concreteChemObj=chemObj.getCtab(),this._concreteRenderer=new Kekule.Render.PathGlyphCtab2DRenderer(chemObj.getCtab(),drawBridge,this)},finalize:function($super){$super(),this._concreteRenderer&&(this._concreteRenderer.finalize(),this._concreteRenderer=null)},getRenderCache:function(context){return this._concreteRenderer.getRenderCache(context)},_getConcreteRendererDrawOptions:function(options){return options},isChemObjRenderedBySelf:function($super,context,obj){return $super(context,obj)||obj===this.getChemObj()||this._concreteRenderer.isChemObjRenderedBySelf(context,obj)},isChemObjRenderedDirectlyBySelf:function($super,context,obj){return $super(context,obj)||obj===this.getChemObj()},doSetRedirectContext:function($super,value){$super(value),this._concreteRenderer.setRedirectContext(value)},doDraw:function($super,context,baseCoord,options){$super(context,baseCoord,options);var op=(this.getChemObj(),Object.create(options));return op.partialDrawObjs&&(op.partialDrawObjs=null),this._concreteRenderer.draw(context,baseCoord,this._getConcreteRendererDrawOptions(op))},doRedraw:function(context){return this._concreteRenderer.redraw(context)},doUpdate:function(context,updatedObjDetails,updateType){if(this._extractObjsOfUpdateObjDetails(updatedObjDetails).indexOf(this.getChemObj())>=0){var p=this.getRenderCache(context);return this.doClear(context),this.draw(context,p.baseCoord,p.options)}return this._concreteRenderer.doUpdate(context,updatedObjDetails,updateType)},doClear:function(context){return this._concreteRenderer.clear(context)},estimateRenderBox:function(context,options,allowCoordBorrow){return this._concreteRenderer.estimateRenderBox(context,this._getConcreteRendererDrawOptions(options),allowCoordBorrow)},transformCoordToObj:function(context,chemObj,coord){var obj=this.getChemObj()===chemObj?this._concreteChemObj:chemObj;return this._concreteRenderer.transformCoordToObj(context,obj,coord)},transformCoordToContext:function(context,chemObj,coord){var obj=this.getChemObj()===chemObj?this._concreteChemObj:chemObj;return this._concreteRenderer.transformCoordToContext(context,obj,coord)}}),Kekule.Render.Renderer2DFactory.register(Kekule.Glyph.PathGlyph,Kekule.Render.PathGlyph2DRenderer),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class;module.exports=function(Kekule){return Kekule.Render.CanvasRendererBridge=Class.create({CLASS_NAME:"Kekule.Render.CanvasRendererBridge",DEF_DOUBLE_BUFFERED:!1,SHADOW_CANVAS_FIELD:"__$shadow_canvas__",SHADOW_CONTEXT_FIELD:"__$shadow_context__",getShadowContext:function(context){return context[this.SHADOW_CONTEXT_FIELD]},getShadowCanvas:function(context){return context[this.SHADOW_CANVAS_FIELD]},getOperatingContext:function(context){return this.getShadowContext(context)||context},createContext:function(parentElem,width,height,id,doubleBuffered){void 0===doubleBuffered&&(doubleBuffered=this.DEF_DOUBLE_BUFFERED);var canvas=(parentElem.ownerDocument,document.createElement("canvas"));id&&(canvas.id=id),parentElem.appendChild(canvas);var ctx=canvas.getContext("2d");if(doubleBuffered){var shadowCanvas=document.createElement("canvas");shadowCanvas.style.position="absolute",shadowCanvas.style.display="none",parentElem.appendChild(shadowCanvas),ctx[this.SHADOW_CANVAS_FIELD]=shadowCanvas,ctx[this.SHADOW_CONTEXT_FIELD]=shadowCanvas.getContext("2d")}return this.setContextDimension(ctx,width,height),ctx},releaseContext:function(context){var canvas=context.canvas,shadowCanvas=this.getShadowCanvas(context),parent=canvas.parentNode;parent&&(parent.removeChild(canvas),shadowCanvas&&parent.removeChild(shadowCanvas))},getContextDimension:function(context){return{width:context.canvas.width,height:context.canvas.height}},setContextDimension:function(context,width,height){var shadowCanvas=this.getShadowCanvas(context);width&&(context.canvas.width=width,context.canvas.style.width=width+"px",shadowCanvas&&(shadowCanvas.width=width,shadowCanvas.style.width=width+"px")),height&&(context.canvas.height=height,context.canvas.style.height=height+"px",shadowCanvas&&(shadowCanvas.height=height,shadowCanvas.style.height=height+"px")),this.clearContext(context)},getContextElem:function(context){return context?context.canvas:null},setContextViewBox:function(context,x,y,w,h,changeDimension){},clearContext:function(context){var elem=context.canvas;elem.width=elem.width;var shadowCanvas=this.getShadowCanvas(context);shadowCanvas&&(shadowCanvas.width=shadowCanvas.width);var clearColor=context.__$clearColor__;if(clearColor){context.save();try{var dim=this.getContextDimension(context);this.drawRect(context,{x:0,y:0},{x:dim.width,y:dim.height},{fillColor:clearColor,strokeColor:clearColor})}finally{context.restore()}}},setClearColor:function(context,color){context&&(context.__$clearColor__=color)},renderContext:function(context){var shadowCanvas=this.getShadowCanvas(context);shadowCanvas&&context.drawImage(shadowCanvas,0,0)},transformContextCoordToScreen:function(context,coord){return coord},transformScreenCoordToContext:function(context,coord){return coord},canModifyGraphic:function(context){return!1},_drawDashLine:function(context,coord1,coord2,dashLen){void 0==dashLen&&(dashLen=5),context.moveTo(coord1.x,coord1.y);for(var dX=coord2.x-coord1.x,dY=coord2.y-coord1.y,dashes=Math.floor(Math.sqrt(dX*dX+dY*dY)/dashLen),dashX=dX/dashes,dashY=dY/dashes,q=0,x1=coord1.x,y1=coord1.y;q++<dashes;)x1+=dashX,y1+=dashY,context[q%2==0?"moveTo":"lineTo"](x1,y1);context[q%2==0?"moveTo":"lineTo"](coord2.x2,coord2.y)},drawLine:function(ctx,coord1,coord2,options){var context=this.getOperatingContext(ctx);context.beginPath(),this.setDrawStyle(context,options),options.strokeDash&&!this.isLineDashSupported(context)?this._drawDashLine(context,coord1,coord2,options.strokeDash):(context.moveTo(coord1.x,coord1.y),context.lineTo(coord2.x,coord2.y)),this.doneDraw(context,options)},drawTriangle:function(ctx,coord1,coord2,coord3,options){var context=this.getOperatingContext(ctx);context.beginPath(),this.setDrawStyle(context,options),context.moveTo(coord1.x,coord1.y),context.lineTo(coord2.x,coord2.y),context.lineTo(coord3.x,coord3.y),context.closePath(),this.doneDraw(context,options)},drawRect:function(ctx,coord1,coord2,options){var context=this.getOperatingContext(ctx);context.beginPath(),this.setDrawStyle(context,options),context.rect(coord1.x,coord1.y,coord2.x-coord1.x,coord2.y-coord1.y),this.doneDraw(context,options)},drawRoundRect:function(ctx,coord1,coord2,cornerRadius,options){return this.drawRect(ctx,coord1,coord2,options)},drawCircle:function(ctx,baseCoord,radius,options){var context=this.getOperatingContext(ctx);context.beginPath(),this.setDrawStyle(context,options),context.arc(baseCoord.x,baseCoord.y,radius,0,2*Math.PI,!1),this.doneDraw(context,options)},_PATH_CMDS:["M","Z","L","C","Q"],_PATH_METHODS:["moveTo","closePath","lineTo","bezierCurveTo","quadraticCurveTo"],drawPath:function(ctx,path,options){var context=this.getOperatingContext(ctx);if(!(path.length<=0)){context.beginPath(),this.setDrawStyle(context,options);for(var pathArgs,i=0,l=path.length;i<l;++i){pathArgs=[];var method,item=path[i],c=item.method.toUpperCase(),index=this._PATH_CMDS.indexOf(c);if(index>=0){var method=this._PATH_METHODS[index];pathArgs=item.params,context[method].apply(context,pathArgs)}}this.doneDraw(context,options)}},drawImage:function(ctx,src,baseCoord,size,options,callback,ctxGetter){var context=this.getOperatingContext(ctx),contextElem=this.getContextElem(context),doc=contextElem.ownerDocument,imgElem=doc.createElement("img");imgElem.src=src;var self=this;imgElem.onload=function(){try{self.setDrawStyle(context,options);var actualCtx=ctx;ctxGetter&&(actualCtx=ctxGetter()),actualCtx=self.getOperatingContext(actualCtx),actualCtx.drawImage(imgElem,baseCoord.x,baseCoord.y,size.x,size.y),callback&&callback(!0),self.doneDraw(context,options)}catch(e){throw callback&&callback(!1),e}},imgElem.src=src},drawImageElem:function(ctx,imgElem,baseCoord,size,options){var context=this.getOperatingContext(ctx);this.setDrawStyle(context,options),context.drawImage(imgElem,baseCoord.x,baseCoord.y,size.x,size.y),this.doneDraw(context,options)},isLineDashSupported:function(context){return context.setLineDash&&"number"==typeof context.lineDashOffset},setDrawStyle:function(context,options){if(Kekule.ObjUtils.notUnset(options.strokeWidth)?context.lineWidth=options.strokeWidth:context.lineWidth=1,options.strokeColor&&(context.strokeStyle=options.strokeColor),this.isLineDashSupported(context))if(options.strokeDash){var dashStyle=!0===options.strokeDash?[5]:Kekule.ArrayUtils.isArray(options.strokeDash)?options.strokeDash:[options.strokeDash];context.setLineDash(dashStyle)}else context.setLineDash([]);options.fillColor?context.fillStyle=options.fillColor:context.fillStyle="transparent",Kekule.ObjUtils.notUnset(options.opacity)?context.globalAlpha=options.opacity:context.globalAlpha=1},doneDraw:function(context,options){context.stroke(),options.fillColor&&context.fill()},getCanvasFontStyle:function(drawOptions){var result="";return drawOptions.fontStyle&&(result+=drawOptions.fontStyle+" "),drawOptions.fontWeight&&(result+=drawOptions.fontWeight+" "),drawOptions.fontSize&&("string"==typeof drawOptions.fontSize?result+=drawOptions.fontSize+" ":result+=drawOptions.fontSize+"px "),drawOptions.fontFamily&&(result+=drawOptions.fontFamily+" "),result},drawText:function(ctx,coord,text,options){var context=this.getOperatingContext(ctx),oldFontStyle=context.font,oldFillStyle=context.fillStyle,fontStyle=this.getCanvasFontStyle(options);this.setDrawStyle(context,options),context.font=fontStyle,options.color&&(context.fillStyle=options.color),context.textBaseline="top",context.fillText(text,coord.x,coord.y),context.fontStyle=oldFontStyle,context.fillStyle=oldFillStyle},canMeasureText:function(context){return!0},measureText:function(context,text,options){var fontStyle=this.getCanvasFontStyle(options);context.font=fontStyle;var m=context.measureText(text),fontSize=options.fontSize;return"string"==typeof fontSize&&(fontSize=Kekule.StyleUtils.analysisUnitsValue(fontSize).value),{width:m.width,height:fontSize}},canMeasureDrawnText:function(context){return!1},canModifyText:function(context){return!1},createGroup:function(context){},addToGroup:function(elem,group){},removeFromGroup:function(elem,group){},exportToDataUri:function(context,dataType,options){var elem=this.getContextElem(context);return elem?elem.toDataURL(dataType,options):null}}),Kekule.Render.CanvasRendererBridge.isSupported=function(){var result=!1;return Kekule.$document&&document&&document.createElement&&(result=!!document.createElement("canvas").getContext),result},Kekule.Render.DrawBridge2DMananger.register(Kekule.Render.CanvasRendererBridge,20),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,DataType=__webpack_require__(0).DataType,XmlUtility=__webpack_require__(1).XmlUtility;module.exports=function(Kekule){if(Kekule.$jsRoot.Raphael){var Raphael=Kekule.$jsRoot.Raphael;Raphael.fn.line=function(x1,y1,x2,y2){return this.path("M"+x1+" "+y1+" L"+x2+" "+y2)},Raphael.fn.arrowLine=function(x1,y1,x2,y2,arrowParams){if(!arrowParams)return this.line(x1,y1,x2,y2);var result=this.set(),dx=x2-x1,dy=y2-y1,alpha=Math.atan(dy/dx),width=(arrowParams.width||6)/2,length=arrowParams.length||3,beta=Math.atan(width/length),l=Math.sqrt(Math.sqr(width)+Math.sqr(length));return result.push(this.path("M"+x2+" "+y2+" L"+(x2-l*Math.cos(alpha-beta))+" "+(y2-l*Math.sin(alpha-beta))+" M"+x2+" "+y2+" L"+(x2-l*Math.cos(alpha+beta))+" "+(y2-l*Math.sin(alpha+beta))),this.path("M"+x1+" "+y1+" L"+x2+" "+y2)),result},Raphael.fn.triangle=function(x1,y1,x2,y2,x3,y3){return this.path("M"+x1+" "+y1+" L"+x2+" "+y2+" L"+x3+" "+y3+" L"+x1+" "+y1)},Raphael.fn.polygon=function(coords){for(var s="M"+coords[0].x+" "+coords[0].y,i=1,l=coords.length;i<l;++i)s+=" L"+coords[i].x+" "+coords[i].y;return s+="L"+coords[0].x+" "+coords[0].y,this.path(s)},Raphael.el.translateCoord=function(delta){if(this.forEach)this.forEach(function(e){e.translateCoord(delta)});else{var coord=this.attr(["x","y"]);void 0!==coord.x&&void 0!==coord.y&&this.attr({x:coord.x+delta.x,y:coord.y+delta.y})}return this},Raphael.st.translateCoord=function(delta){return this.forEach&&this.forEach(function(e){e.translateCoord(delta)}),this},Raphael.st.remove=function(delta){this.forEach(function(elem){elem.remove()},this),this.clear()}}return Kekule.Render.RaphaelRendererBridge=Class.create({CLASS_NAME:"Kekule.Render.RaphaelRendererBridge",createContext:function(parentElem,width,height){return Raphael(parentElem,width,height)},releaseContext:function(context){context.remove()},getContextDimension:function(context){return{width:context.width,height:context.height}},setContextDimension:function(context,width,height){context.setSize(width,height),this.clearContext(context)},clearContext:function(context){context.clear();var clearColor=context.__$clearColor__;if(clearColor){var dim=this.getContextDimension(context);this.drawRect(context,{x:0,y:0},{x:dim.width,y:dim.height},{fillColor:clearColor,strokeColor:clearColor})}},setClearColor:function(context,color){context&&(context.__$clearColor__=color)},getContextElem:function(context){return context?context.canvas:null},transformContextCoordToScreen:function(context,coord){return coord},transformScreenCoordToContext:function(context,coord){return coord},canModifyGraphic:function(context){return!0},drawPath:function(context,path,options){for(var sPath="",i=0,l=path.length;i<l;++i){var item=path[i];if(sPath+=item.method,item.params&&item.params.length)for(var j=0,k=item.params.length;j<k;++j)sPath+=0===j?"":",",DataType.isArrayValue(item.params[j])?sPath+=item.params[j].join(","):sPath+=item.params[j]}var result=context.path(sPath);return this.setBasicElemAttribs(result,options),result},drawLine:function(context,coord1,coord2,options){var result=context.line(coord1.x,coord1.y,coord2.x,coord2.y);return this.setBasicElemAttribs(result,options),result},drawTriangle:function(context,coord1,coord2,coord3,options){var result=context.triangle(coord1.x,coord1.y,coord2.x,coord2.y,coord3.x,coord3.y);return this.setBasicElemAttribs(result,options),result},drawRect:function(context,coord1,coord2,options){var result=context.rect(coord1.x,coord1.y,coord2.x-coord1.x,coord2.y-coord1.y);return this.setBasicElemAttribs(result,options),result},drawRoundRect:function(context,coord1,coord2,cornerRadius,options){var result=context.rect(coord1.x,coord1.y,coord2.x-coord1.x,coord2.y-coord1.y,cornerRadius);return this.setBasicElemAttribs(result,options),result},drawCircle:function(context,baseCoord,radius,options){var result=context.circle(baseCoord.x,baseCoord.y,radius);return this.setBasicElemAttribs(result,options),result},drawImage:function(context,src,baseCoord,size,options,callback){try{var result=context.image(src,baseCoord.x,baseCoord.y,size.x,size.y);this.setBasicElemAttribs(result,options),callback&&callback(!0)}catch(e){throw callback&&callback(!1),e}return result},drawImageElem:function(context,imgElem,baseCoord,size,options){return this.drawImage(context,imgElem.src,baseCoord,size,options)},setBasicElemAttribs:function(elem,options){if(Kekule.ObjUtils.notUnset(options.strokeWidth)&&elem.attr("stroke-width",options.strokeWidth),options.strokeColor&&elem.attr("stroke",options.strokeColor),options.strokeDash){elem.attr("stroke-dasharray","- ")}options.fillColor&&elem.attr("fill",options.fillColor),options.opacity&&elem.attr({"stroke-opacity":options.opacity,"fill-opacity":options.opacity})},getRaphaelFontStyle:function(drawOptions){var result={};return drawOptions.fontStyle&&(result["font-style"]=drawOptions.fontStyle),drawOptions.fontWeight&&(result["font-weight"]=drawOptions.fontWeight),drawOptions.fontSize&&(result["font-size"]=drawOptions.fontSize+"px"),drawOptions.fontFamily&&(result["font-family"]=drawOptions.fontFamily),result},drawText:function(context,coord,text,options){text.endsWith(" ")&&(text=text.substring(0,text.length-1)+" "),text.startsWith(" ")&&(text=" "+text.substr(1));var fontStyle=this.getRaphaelFontStyle(options),elem=context.text(-1e4,-1e4,text);return elem.attr(fontStyle),options.color&&elem.attr({stroke:options.color,fill:options.color}),this.modifyDrawnTextCoord(context,elem,coord),this.setBasicElemAttribs(elem,options),elem},canMeasureText:function(context){return!1},canMeasureDrawnText:function(context){return!0},canModifyText:function(context){return!0},measureDrawnText:function(context,textElem,options){var oneOf=Kekule.oneOf,box=textElem.getBBox(),result={};return result.width=oneOf(box.width,box.x2-box.x1),result.height=oneOf(box.height,box.y2-box.y1),result},modifyDrawnTextCoord:function(context,textElem,newCoord){var dimension=this.measureDrawnText(context,textElem,null);textElem.attr({x:newCoord.x+dimension.width/2,y:newCoord.y+dimension.height/2})},createGroup:function(context){return context.set()},addToGroup:function(elem,group){return group.push(elem)},removeFromGroup:function(elem,group){return elem!==group&&group.exclude(elem)},removeDrawnElem:function(context,elem){elem.remove()},exportToDataUri:function(context,dataType,options){if(context.toSVG){var svg=context.toSVG();return"data:image/svg+xml;base64,"+btoa(svg)}if(context.canvas&&"svg"===context.canvas.tagName.toLowerCase()){var svg=XmlUtility.serializeNode(context.canvas);return"data:image/svg+xml;base64,"+btoa(svg)}}}),Kekule.Render.RaphaelRendererBridge.isSupported=function(){var result=!1;return Kekule.$jsRoot.Raphael&&(result=!(!Raphael.svg&&!Raphael.vml)),result},Kekule.Render.DrawBridge2DMananger.register(Kekule.Render.RaphaelRendererBridge,10),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class;module.exports=function(Kekule){var OU=Kekule.ObjUtils,BU=Kekule.BoxUtils,MDM=Kekule.Render.Molecule3DDisplayType,BRM=Kekule.Render.Bond3DRenderMode,BRT=Kekule.Render.Bond3DRenderType,BSM=Kekule.Render.Bond3DSpliceMode,NRM=Kekule.Render.Node3DRenderMode,oneOf=Kekule.oneOf;return Kekule.Render.Abstract3DDrawBridge=Class.create({CLASS_NAME:"Kekule.Render.Abstract3DDrawBridge",getGraphicQualityLevel:function(){return null},setGraphicQualityLevel:function(value){},transformContextCoordToScreen:function(context,coord){return{x:coord.x,y:coord.y}},canModifyGraphic:function(context){return!1},createContext:function(parentElem,width,height){return null},getContextDimension:function(context){return{}},setContextDimension:function(context,width,height){return null},clearContext:function(context){return null},setClearColor:function(context,color){},drawSphere:function(context,coord,radius,options){},drawCylinder:function(context,coord1,coord2,radius,options){},drawLine:function(context,coord1,coord2,options){},createDrawGroup:function(context){},addToDrawGroup:function(elem,group){},removeFromDrawGroup:function(elem,group){},getCameraProps:function(context){},setCameraProps:function(context,props){},exportToDataUri:function(context,dataType,options){}}),Kekule.Render.Base3DRenderer=Class.create(Kekule.Render.CompositeRenderer,{CLASS_NAME:"Kekule.Render.Base3DRenderer",initialize:function($super,chemObj,drawBridge,parent){$super(chemObj,drawBridge,parent)},getRendererType:function(){return Kekule.Render.RendererType.R3D},getActualTargetContext:function(context){return this.getRedirectContext()||context},getCameraProps:function(context){return this.getDrawBridge().getCameraProps(context)},setCameraProps:function(context,props){return this.getDrawBridge().setCameraProps(context,props)},getInitialLightPositions:function(context){return this.getDrawBridge().getInitialLightPositions&&this.getDrawBridge().getInitialLightPositions(context)},getLightCount:function(context){return this.getDrawBridge().getLightCount&&this.getDrawBridge().getLightCount(context)},getLightProps:function(context,lightIndex){return this.getDrawBridge().getLightProps&&this.getDrawBridge().getLightProps(context,lightIndex)},setLightProps:function(context,lightIndex,props){return this.getDrawBridge().setLightProps(context,lightIndex,props)},drawSphere:function(context,coord,radius,options){return this.getDrawBridge().drawSphere(this.getActualTargetContext(context),coord,radius,options)},drawCylinder:function(context,coord1,coord2,radius,options){var b=this.getDrawBridge();return b?b.drawCylinder(this.getActualTargetContext(context),coord1,coord2,radius,options):null},drawCylinderEx:function(context,coord1,coord2,radius,options){var result=null,elem=this.drawCylinder(context,coord1,coord2,radius,options);if(elem&&options.withEndCaps){result=this.createDrawGroup(context);var cap=this.drawSphere(context,coord1,radius);this.addToDrawGroup(cap,result);var cap=this.drawSphere(context,coord2,radius);this.addToDrawGroup(cap,result)}return result||elem},drawParallelCylinders:function(context,cylinderInfos,drawEndCaps){var b=this.getDrawBridge();if(b.drawParallelCylinders)return b.drawParallelCylinders(this.getActualTargetContext(context),cylinderInfos,drawEndCaps);for(var result=this.createDrawGroup(context),i=0,l=cylinderInfos.length;i<l;++i){var info=cylinderInfos[i],obj=this.drawCylinderEx(context,info.coord1,info.coord2,info.radius,{color:info.color,withEndCaps:drawEndCaps});this.addToDrawGroup(obj,result)}return result},drawLine:function(context,coord1,coord2,options){var b=this.getDrawBridge();return b?b.drawLine(this.getActualTargetContext(context),coord1,coord2,options):null},drawParallelLines:function(context,lineInfos){var b=this.getDrawBridge();if(b.drawParallelLines)return b.drawParallelLines(this.getActualTargetContext(context),lineInfos);if(b.drawLine){for(var count=lineInfos.length,result=[],i=0;i<count;++i){var info=lineInfos[i],elem=this.drawLine(context,info.coord1,info.coord2,{lineWidth:info.lineWidth,color:info.color,opacity:info.opacity});result.push(elem)}return result}},createDrawGroup:function(context){return this.getDrawBridge().createGroup(this.getActualTargetContext(context))},addToDrawGroup:function(elem,group){return this.getDrawBridge().addToGroup(elem,group)},removeFromDrawGroup:function(elem,group){return this.getDrawBridge().removeFromGroup(elem,group)},removeDrawnElem:function(context,elem){}}),Kekule.Render.ChemObj3DRenderer=Class.create(Kekule.Render.Base3DRenderer,{CLASS_NAME:"Kekule.Render.ChemObj3DRenderer",initialize:function($super,chemObj,drawBridge,parent){$super(chemObj,drawBridge,parent),this._enableTransformByCamera=!0},doEstimateSelfObjBox:function(context,options,allowCoordBorrow){return Kekule.Render.ObjUtils.getContainerBox(this.getChemObj(),this.getCoordMode(),allowCoordBorrow)},doEstimateRenderBox:function(context,baseCoord,options,allowCoordBorrow){var objBox=this.estimateObjBox(context,options,allowCoordBorrow);if(objBox){var p=this.prepareTransformParams(context,baseCoord,options,objBox),transformParams=p;return BU.transform3D(objBox,transformParams)}return null},beginDraw:function($super,context,baseCoord,options){if($super(context,baseCoord,options),this.isRootRenderer()){var b=this.getDrawBridge();if(b&&b.setGraphicQualityLevel){var level=options.graphicQuality;b.setGraphicQualityLevel(level)}}},endDraw:function($super,context,baseCoord,options){this.isRootRenderer()&&this.adjustCamera(context,options.transformParams),$super(context,baseCoord,options)},doDraw:function($super,context,baseCoord,options){return this.prepareTransformParams(context,baseCoord,options),$super(context,baseCoord,options)},changeGeometryOptions:function(context,baseCoord,newOptions){var ops=Object.create(newOptions);this.prepareTransformParams(context,baseCoord,ops).pureCameraTransform?this.endDraw(context,baseCoord,ops):(this.getDrawBridge().clearContext(context),this.draw(context,baseCoord,newOptions))},prepareTransformParams:function(context,baseCoord,drawOptions,objBox){var result;if(drawOptions.transformParams)result=drawOptions.transformParams;else{var p=this.generateTransformParams(context,baseCoord,drawOptions,objBox);drawOptions.transformParams=p,result=p}var transformMatrix=Kekule.CoordUtils.calcTransform3DMatrix(result),invTransformMatrix=Kekule.CoordUtils.calcInverseTransform3DMatrix(result);return drawOptions.transformParams.transformMatrix=transformMatrix,drawOptions.transformParams.invTransformMtrix=invTransformMatrix,this.getRenderCache(context).transformParams=result,this.getRenderCache(context).transformMatrix=transformMatrix,this.getRenderCache(context).invTransformMatrix=invTransformMatrix,this.getRenderCache(context).transformParams=result,result},canDoPureCameraTransform:function(context,transformParams){return this._enableTransformByCamera&&transformParams.scaleX===transformParams.scaleY&&transformParams.scaleY===transformParams.scaleZ&&!transformParams.rotateAngle&&!transformParams.rotateX&&!transformParams.rotateY&&!transformParams.rotateZ},generateTransformParams:function(context,baseCoord,drawOptions,objBox){var result={};result.allowCoordBorrow=oneOf(drawOptions.allowCoordBorrow,!1),result.unitLength=drawOptions.unitLength||1,objBox||(objBox=this.estimateObjBox(context,drawOptions,result.allowCoordBorrow));var boxCenter={x:(objBox.x1+objBox.x2)/2,y:(objBox.y1+objBox.y2)/2,z:(objBox.z1+objBox.z2)/2},O=Kekule.ObjUtils;O.isUnset(drawOptions.translateX)&&O.isUnset(drawOptions.translateY)&&O.isUnset(drawOptions.translateZ)?baseCoord&&(result.translateX=baseCoord.x-boxCenter.x,result.translateY=baseCoord.y-boxCenter.y,result.translateZ=baseCoord.z||0-boxCenter.z||0):(result.translateX=drawOptions.translateX||0,result.translateY=drawOptions.translateY||0,result.translateZ=drawOptions.translateZ||0),result.zoom=drawOptions.zoom||1,result.scaleX=oneOf(drawOptions.scaleX,drawOptions.scale,1),result.scaleY=oneOf(drawOptions.scaleY,drawOptions.scale,1),result.scaleZ=oneOf(drawOptions.scaleZ,drawOptions.scale,1);drawOptions.scaleX||drawOptions.scaleY||drawOptions.scaleZ||drawOptions.scale;OU.notUnset(drawOptions.rotateMatrix)?result.rotateMatrix=drawOptions.rotateMatrix:OU.notUnset(drawOptions.rotateAngle)&&OU.notUnset(drawOptions.rotateAxisVector)?result.rotateMatrix=Kekule.CoordUtils.calcRotate3DMatrix({rotateAngle:drawOptions.rotateAngle,rotateAxisVector:drawOptions.rotateAxisVector}):(result.rotateX||result.rotateY||result.rotateZ)&&(result.rotateMatrix=Kekule.CoordUtils.calcRotate3DMatrix({rotateX:drawOptions.rotateX||0,rotateY:drawOptions.rotateY||0,rotateZ:drawOptions.rotateZ||0})),O.isUnset(drawOptions.center)&&(result.center=boxCenter),result.drawBaseCoord=baseCoord||Kekule.CoordUtils.transform3D(boxCenter,result);var initialTransformOptions=Object.extend({},result);result=this.getFinalTransformParams(context,result),result.initialTransformOptions=initialTransformOptions;var doCameraTransform=this.canDoPureCameraTransform(context,result);if(result.pureCameraTransform=doCameraTransform,this.isRootRenderer()&&(drawOptions.autofit||!drawOptions.cameraPos)){var inflation=this.getAutofitObjBoxInflation(context,this.getChemObj(),drawOptions),obox=Kekule.BoxUtils.inflateBox(objBox,inflation.x,inflation.y,inflation.z),w=Math.max(obox.x2-obox.x1,obox.y2-obox.y1),cameraInfo=this.getCameraProps(context),l=w/2/Math.tan(cameraInfo.fov/2),dis=Math.sqrt(Math.sqr(l)-Math.sqr(w/2));if(doCameraTransform){dis/=result.scaleX,result.cameraWidth=w/result.scaleX,result.cameraHeight=result.cameraWidth;var vCameraPos,coordCameraPos,vCameraUp,coordCameraUp,vBaseCameraPos=Kekule.MatrixUtils.create(4,1,[0,0,1,1]),vBaseCameraUp=Kekule.MatrixUtils.create(4,1,[0,1,1,1]);if(result.rotateMatrix){var cameraRotateMatrix=Kekule.MatrixUtils.transpose(result.rotateMatrix);vCameraPos=Kekule.MatrixUtils.multiply(cameraRotateMatrix,vBaseCameraPos),vCameraUp=Kekule.MatrixUtils.multiply(cameraRotateMatrix,vBaseCameraUp),coordCameraPos={x:vCameraPos[0],y:vCameraPos[1],z:vCameraPos[2]},coordCameraUp={x:vCameraUp[0],y:vCameraUp[1],z:vCameraUp[2]}}else coordCameraPos={x:0,y:0,z:1},coordCameraUp={x:0,y:1,z:1};coordCameraPos=Kekule.CoordUtils.multiply(coordCameraPos,dis),result.cameraPos={x:coordCameraPos.x,y:coordCameraPos.y,z:coordCameraPos.z},result.cameraPos=Kekule.CoordUtils.add(result.cameraPos,result.drawBaseCoord),result.cameraUp=coordCameraUp,result.scaleX=result.scaleY=result.scaleZ=1;var initialLightPositions=this.getInitialLightPositions(context);if(cameraRotateMatrix){var lightCount=this.getLightCount(context);if(initialLightPositions&&initialLightPositions.length&&lightCount)for(var count=Math.min(initialLightPositions.length,lightCount),newLightPositions=[],i=0;i<count;++i){var pos=initialLightPositions[i];if(pos){var vOldPos=Kekule.MatrixUtils.create(4,1,[pos.x,pos.y,pos.z,1]),vNewPos=Kekule.MatrixUtils.multiply(cameraRotateMatrix,vOldPos),newPos={x:vNewPos[0],y:vNewPos[1],z:vNewPos[2]};newLightPositions.push(newPos)}}}result.lightPositions=newLightPositions||initialLightPositions,result.rotateMatrix=null}else result.cameraPos={x:result.drawBaseCoord.x,y:result.drawBaseCoord.y,z:dis+result.drawBaseCoord.z},result.cameraUp={x:0,y:1,z:1};result.cameraLookAtVector=result.drawBaseCoord||{x:0,y:0,z:0};var translateCoord={x:-result.translateX,y:-result.translateY,z:-result.translateZ};result.translateX=result.translateY=result.translateZ=0,result.cameraPos=Kekule.CoordUtils.add(result.cameraPos,translateCoord),result.cameraLookAtVector=Kekule.CoordUtils.add(result.cameraLookAtVector,translateCoord)}return result},getFinalTransformParams:function(context,transformParams){var result=Object.create(transformParams);return result.zoom&&(result.scaleX*=result.zoom,result.scaleY*=result.zoom,result.scaleZ*=result.zoom),1!==result.unitLength&&(result.translateX*=result.unitLength,result.translateY*=result.unitLength,result.translateZ*=result.unitLength,result.drawBaseCoord&&(result.drawBaseCoord=Kekule.CoordUtils.multiply(result.drawBaseCoord,result.unitLength))),result},getRenderFinalTransformParams:function(context){return this.getRenderCache(context).transformParams},getRenderInitialTransformOptions:function(context){var p=this.getRenderFinalTransformParams(context);return p?p.initialTransformOptions:null},getAutofitObjBoxInflation:function(context,chemObj,drawOptions){var r=drawOptions.fixedNodeRadius||0;return{x:r,y:r,z:r}},adjustCamera:function(context,transformParams){var w=transformParams.cameraWidth,h=transformParams.cameraHeight,options={position:transformParams.cameraPos,upVector:transformParams.cameraUp,lookAtVector:transformParams.cameraLookAtVector};if(w&&h){var hw=w/2,hh=h/2;options.left=-hw,options.right=hw,options.top=hh,options.bottom=-hh}this.setCameraProps(context,options),this.adjustLights(context,transformParams)},adjustLights:function(context,transformParams){for(var positions=transformParams.lightPositions||[],i=0,l=positions.length;i<l;++i){var pos=positions[i];pos&&this.setLightProps(context,i,{position:pos})}}}),Kekule.Render.ChemCtab3DRenderer=Class.create(Kekule.Render.ChemObj3DRenderer,{CLASS_NAME:"Kekule.Render.ChemCtab3DRenderer",TRANSFORM_COORD_FIELD:"__$transCoord3D__",DRAW_ELEM_FIELD:"__$drawElem__",DRAW_COLOR_FIELD:"__$drawColor__",BASE_RADIUS_FIELD:"__$baseRadius__",TRANSFORM_MATRIX_FIELD:"__$transMatrix__",INV_TRANSFORM_MATRIX_FIELD:"__$inverseTransMatrix__",CHILD_TRANSFORM_MATRIX_FIELD:"__$childTransMatrix__",HIDDEN_NODES_FIELD:"__$hiddenNodes__",HIDDEN_CONNECTORS_FIELD:"__$hiddenConnectors__",getObjDrawElem:function(context,obj){return this.getExtraProp2(context,obj,this.DRAW_ELEM_FIELD)},setObjDrawElem:function(context,obj,value){this.setExtraProp2(context,obj,this.DRAW_ELEM_FIELD,value)},getObjDrawColor:function(context,obj){return this.getExtraProp2(context,obj,this.DRAW_COLOR_FIELD)},setObjDrawColor:function(context,obj,value){this.setExtraProp2(context,obj,this.DRAW_COLOR_FIELD,value)},getNodeBaseRadius:function(context,obj){return this.getExtraProp2(context,obj,this.BASE_RADIUS_FIELD)},setNodeBaseRadius:function(context,obj,value){this.setExtraProp2(context,obj,this.BASE_RADIUS_FIELD,value)},getHiddenNodes:function(context){return this.getExtraProp(context,this.HIDDEN_NODES_FIELD)||[]},setHiddenNodes:function(context,value){return this.setExtraProp(context,this.HIDDEN_NODES_FIELD,value)},getHiddenConnectors:function(context){return this.getExtraProp(context,this.HIDDEN_CONNECTORS_FIELD)||[]},setHiddenConnectors:function(context,value){return this.setExtraProp(context,this.HIDDEN_CONNECTORS_FIELD,value)},doEstimateSelfObjBox:function(context,options,allowCoordBorrow){return this.getChemObj().getExposedContainerBox3D(allowCoordBorrow)},doPrepare:function(context,chemObj,baseCoord,options){var nodeMode,connectorMode,op=options,c=this.getRenderCache(context);switch(op.moleculeDisplayType){case MDM.WIRE:nodeMode=NRM.NONE,connectorMode=op.displayMultipleBond?BRM.MULTI_WIRE:BRM.WIRE;break;case MDM.STICKS:nodeMode=NRM.NONE,connectorMode=op.displayMultipleBond?BRM.MULTI_CYLINDER:BRM.CYLINDER;break;case MDM.SPACE_FILL:nodeMode=NRM.SPACE,connectorMode=BRM.NONE;break;case MDM.BALL_STICK:default:nodeMode=NRM.BALL,connectorMode=op.displayMultipleBond?BRM.MULTI_CYLINDER:BRM.CYLINDER}c.nodeRenderMode=nodeMode,c.connectorRenderMode=connectorMode,c.options=op;var nodes=chemObj.getExposedNodes(),connectors=chemObj.getExposedConnectors();return this.prepareHiddenObjects(context,nodes,connectors,op),this.prepareNodesDrawColor(context,nodes,op),this.prepareNodeBaseRadii(context,nodes,op),op},prepareHiddenObjects:function(context,nodes,connectors,renderOptions){var hiddenNodes=[];this.setHiddenNodes(context,hiddenNodes);for(var i=0,l=nodes.length;i<l;++i){var node=nodes[i];renderOptions.hideHydrogens&&node instanceof Kekule.Atom&&1===node.getAtomicNumber()&&hiddenNodes.push(node)}var hiddenConnectors=[];this.setHiddenConnectors(context,hiddenConnectors);for(var i=0,l=connectors.length;i<l;++i){var connector=connectors[i],connectedObjs=connector.getConnectedExposedObjs();Kekule.ArrayUtils.exclude(connectedObjs,hiddenNodes)<2&&hiddenConnectors.push(connector)}},prepareNodesDrawColor:function(context,nodes,renderOptions){for(var globalUseAtomSpecifiedColor=renderOptions.useAtomSpecifiedColor,i=0,l=nodes.length;i<l;++i){var node=nodes[i],localOptions=node.getOverriddenRender3DOptions()||{},color=localOptions.color||localOptions.atomColor;if(color&&!localOptions.useAtomSpecifiedColor);else if(globalUseAtomSpecifiedColor||localOptions.useAtomSpecifiedColor){var atomicNumber=node.getAtomicNumber?node.getAtomicNumber():0;color=atomicNumber>=0?Kekule.Render.RenderColorUtils.getColor(atomicNumber,this.getRendererType()):Kekule.Render.RenderColorUtils.getColor(node.getClassLocalName(),this.getRendererType())}else color=oneOf(localOptions.color||renderOptions.atomColor);this.setObjDrawColor(context,node,color)}},prepareNodeBaseRadii:function(context,nodes,renderOptions){for(var i=0,l=nodes.length;i<l;++i){var radius,node=nodes[i];radius=this.calcNodeBaseRadius(node,renderOptions),this.setNodeBaseRadius(context,node,radius)}},calcNodeBaseRadius:function(node,renderOptions){var radius,localOptions=node.getOverriddenRender3DOptions()||{},atomicNumber=node.getAtomicNumber?node.getAtomicNumber():null;if(localOptions.nodeRadius||renderOptions.nodeRadius)radius=localOptions.nodeRadius||renderOptions.nodeRadius;else if(oneOf(localOptions.useVdWRadius,renderOptions.useVdWRadius)&&atomicNumber){var radiusVdw=Kekule.ChemicalElementsDataUtil.getElementProp(atomicNumber,"radiiVdw")||localOptions.fixedNodeRadius||renderOptions.fixedNodeRadius;radius=radiusVdw}else radius=oneOf(localOptions.fixedNodeRadius,renderOptions.fixedNodeRadius);return radius},doDrawSelf:function($super,context,baseCoord,options){$super(context,baseCoord,options);var chemObj=this.getChemObj(),transformOptions=options.transformParams;this.getRenderCache(context).transformOptions=transformOptions,this.transformCtabCoords3DToContext(context,chemObj,transformOptions);var op=this.doPrepare(context,chemObj,baseCoord,options);return this.doDrawCore(context,chemObj,op,transformOptions)},doRedraw:function(context){var p=this.getRenderCache(context);return this.doDrawCore(context,this.getChemObj(),p.options,p.transformOptions)},doDrawCore:function(context,chemObj,options,finalTransformOptions){var group=this.createDrawGroup(context);return this.doDrawConnectors(context,group,chemObj,options,finalTransformOptions),this.doDrawNodes(context,group,chemObj,options,finalTransformOptions),this.setObjDrawElem(context,chemObj,group),group},transformCtabCoords3DToContext:function(context,ctab,transformOptions){var allowCoordBorrow=transformOptions.allowCoordBorrow;transformOptions.scaleX=transformOptions.scaleX||transformOptions.scale,transformOptions.scaleY=transformOptions.scaleY||transformOptions.scale,transformOptions.scaleZ=transformOptions.scaleZ||transformOptions.scale;var childTransformOptions=Object.extend({},transformOptions);childTransformOptions.centerX=0,childTransformOptions.centerY=0;var coordTransformMatrix=transformOptions.transformMatrix;this.setExtraProp2(context,ctab,this.TRANSFORM_MATRIX_FIELD,coordTransformMatrix);var childCoordTransformMatrix=coordTransformMatrix;this.setExtraProp2(context,ctab,this.CHILD_TRANSFORM_MATRIX_FIELD,coordTransformMatrix);var invMatrix=transformOptions.invTransformMatrix;this.setExtraProp2(context,ctab,this.INV_TRANSFORM_MATRIX_FIELD,invMatrix);for(var i=0,l=ctab.getNodeCount();i<l;++i){var node=ctab.getNodeAt(i);this.transformObjCoord3DToContext(context,node,coordTransformMatrix,childCoordTransformMatrix,allowCoordBorrow)}},transformObjCoord3DToContext:function(context,obj,transformMatrix,childTransformMatrix,allowCoordBorrow){if(obj&&obj.getAbsBaseCoord3D){var coord=obj.getAbsBaseCoord3D(allowCoordBorrow);if(coord){var newCoord=Kekule.CoordUtils.transform3DByMatrix(coord,transformMatrix);this.setTransformedCoord3D(context,obj,newCoord)}if(obj.getNodes)for(var i=0,l=obj.getNodeCount();i<l;++i)this.transformObjCoord3DToContext(context,obj.getNodeAt(i),childTransformMatrix,childTransformMatrix,allowCoordBorrow)}},getTransformedCoord3D:function(context,obj,allowCoordBorrow){if(Kekule.ObjUtils.isUnset(allowCoordBorrow)&&(allowCoordBorrow=this.getRenderCache(context).options.transformParams.allowCoordBorrow),!(obj instanceof Kekule.BaseStructureNode&&this.getExtraProp2(context,obj,this.TRANSFORM_COORD_FIELD))){var ctab=this.getChemObj(),transformMatrix=this.getExtraProp2(context,ctab,this.TRANSFORM_MATRIX_FIELD),childTransformMatrix=this.getExtraProp2(context,ctab,this.CHILD_TRANSFORM_MATRIX_FIELD);ctab&&(ctab.hasNode(obj,!1)||ctab.hasConnector(obj,!1))?this.transformObjCoord3DToContext(obj,transformMatrix,childTransformMatrix,allowCoordBorrow):this.transformObjCoord3DToContext(obj,childTransformMatrix,childTransformMatrix,allowCoordBorrow)}return this.getExtraProp2(context,obj,this.TRANSFORM_COORD_FIELD)},setTransformedCoord3D:function(context,obj,coord){this.setExtraProp2(context,obj,this.TRANSFORM_COORD_FIELD,coord)},doTransformCoordToObj:function(context,chemObj,coord){var matrix=this.getExtraProp2(context,chemObj,this.INV_TRANSFORM_MATRIX_FIELD);return Kekule.CoordUtils.transform3DByMatrix(coord,matrix)},doTransformCoordToContext:function(context,chemObj,coord){var matrix=this.getExtraProp2(context,chemObj,this.TRANSFORM_MATRIX_FIELD);return Kekule.CoordUtils.transform3DByMatrix(coord,matrix)},doDrawNodes:function(context,group,ctab,options,finalTransformOptions){for(var nodes=ctab.getExposedNodes(),hiddenNodes=this.getHiddenNodes(context),i=0,l=nodes.length;i<l;++i){var node=nodes[i];if(!(hiddenNodes.indexOf(node)>=0)){this.doDrawNode(context,group,node,ctab,options,finalTransformOptions)}}},doDrawNode:function(context,group,node,parentChemObj,options,finalTransformOptions){var result,nodeRenderMode=this.getRenderCache(context).nodeRenderMode;if(nodeRenderMode===NRM.NONE)return null;var ballRadius,op=Kekule.Render.RenderOptionUtils.mergeObjLocalRender3DOptions(node,options);ballRadius=this.getNodeBaseRadius(context,node),Kekule.ObjUtils.isUnset(ballRadius)&&(ballRadius=this.calcNodeBaseRadius(node,options)),nodeRenderMode===NRM.SPACE?ballRadius*=finalTransformOptions.scaleX:ballRadius*=op.nodeRadiusRatio*finalTransformOptions.scaleX;var color=this.getObjDrawColor(context,node),coord=this.getTransformedCoord3D(context,node,finalTransformOptions.allowCoordBorrow);result=this.drawSphere(context,coord,ballRadius,{color:color,opacity:op.opacity});var boundInfo=this.createSphereBoundInfo(coord,ballRadius);this.basicDrawObjectUpdated(context,node,parentChemObj,boundInfo,Kekule.Render.ObjectUpdateType.ADD),result&&(this.setObjDrawElem(context,node,result),group&&this.addToDrawGroup(result,group))},doDrawConnectors:function(context,group,ctab,options,finalTransformOptions){if(this.getRenderCache(context).connectorRenderMode===BRM.NONE)return null;for(var connectors=ctab.getExposedConnectors(),hiddenConnectors=this.getHiddenConnectors(context),i=0,l=connectors.length;i<l;++i){var connector=connectors[i];if(!(hiddenConnectors.indexOf(connector)>=0)){this.doDrawConnector(context,group,connector,ctab,options,finalTransformOptions)}}},doDrawConnector:function(context,group,connector,parentChemObj,options,finalTransformOptions){var op=Object.create(options);op=Kekule.Render.RenderOptionUtils.mergeObjLocalRender3DOptions(connector,options);var hiddenNodes=this.getHiddenNodes(context),objs=connector.getConnectedExposedObjs();objs=Kekule.ArrayUtils.exclude(objs,hiddenNodes);for(var obj1,obj2,coord1,coord2,elem,objCount=objs.length,subGroup=objCount>2?this.createDrawGroup(context):null,i=0;i<objCount;++i)if(obj1=objs[i],coord1=this.getTransformedCoord3D(context,obj1,finalTransformOptions.allowCoordBorrow))for(var j=i+1;j<objCount;++j)obj2=objs[j],(coord2=this.getTransformedCoord3D(context,obj2,finalTransformOptions.allowCoordBorrow))&&(elem=this.doDrawConnectorShape(context,connector,obj1,obj2,parentChemObj,coord1,coord2,op,finalTransformOptions))&&subGroup&&this.addToDrawGroup(elem,subGroup);return subGroup?this.addToDrawGroup(subGroup,group):this.addToDrawGroup(elem,group),subGroup||elem},doDrawConnectorShape:function(context,connector,node1,node2,parentChemObj,coord1,coord2,options,finalTransformOptions){var C=Kekule.CoordUtils,localOptions=connector.getOverriddenRender3DOptions()||{},spliceMode=(options.unitLength,oneOf(localOptions.bondSpliceMode,options.bondSpliceMode)),splicePosRatio=spliceMode===BSM.MID_SPLIT?.5:null;if(spliceMode===BSM.WEIGHTING_SPLIT){var r1=this.getNodeBaseRadius(context,node1),r2=this.getNodeBaseRadius(context,node2);splicePosRatio=r1&&r2?r1/(r1+r2):.5}var spliceCoord=null,needSplit=!1,colors=[];if(splicePosRatio){var defColor=oneOf(options.color||options.bondColor),color=oneOf(localOptions.color||localOptions.bondColor);if(needSplit=!1,color)colors.push(color);else{var color1=oneOf(this.getObjDrawColor(context,node1),defColor),color2=oneOf(this.getObjDrawColor(context,node2),defColor);color1!==color2?(colors.push(color1),colors.push(color2),needSplit=!0):colors.push(oneOf(color1,options.color,options.bondColor,options.defBondColor))}}else colors.push(oneOf(localOptions.color,localOptions.bondColor,options.color,options.bondColor,options.defBondColor));if(splicePosRatio&&needSplit){var dx=coord2.x-coord1.x,dy=coord2.y-coord1.y,dz=coord2.z-coord1.z;spliceCoord={},spliceCoord.x=coord1.x+dx*splicePosRatio,spliceCoord.y=coord1.y+dy*splicePosRatio,spliceCoord.z=coord1.z+dz*splicePosRatio}var geometryCoords=needSplit?[[coord1,spliceCoord],[spliceCoord,coord2]]:[[coord1,coord2]],connectorRenderMode=this.getRenderCache(context).connectorRenderMode,renderType=this._getBondRenderType(connector,connectorRenderMode),isMultiCylinder=!1,cylinderRadius=oneOf(localOptions.connectorRadius,options.connectorRadius)*oneOf(localOptions.connectorRadiusRatio,options.connectorRadiusRatio)*options.unitLength;cylinderRadius*=finalTransformOptions.scaleX;var lineWidth=oneOf(localOptions.connectorLineWidth,options.connectorLineWidth)*options.unitLength;renderType!==BRT.SINGLE&&renderType!==BRT.DASH?(cylinderRadius*=oneOf(localOptions.multiConnectorRadiusRatio,options.multiConnectorRadiusRatio),isMultiCylinder=connectorRenderMode===BRM.MULTI_CYLINDER):isMultiCylinder=!1;var connectorShapeInfos=[],shapeCount=1,lineCount=0;switch(renderType){case BRT.SINGLE:shapeCount=1;break;case BRT.DOUBLE:shapeCount=2;break;case BRT.TRIPLE:shapeCount=3;break;case BRT.DASH:case BRT.SOLID_DASH:}lineCount=shapeCount;var offsetStart=null;if(lineCount>1){var shapeOffsetLen=oneOf(localOptions.multiConnectorMarginRatio,options.multiConnectorMarginRatio)*cylinderRadius;isMultiCylinder&&(shapeOffsetLen+=2*cylinderRadius);var connectorLength=C.getDistance(coord1,coord2),sub=C.substract(coord2,coord1),sinAngle=sub.y/connectorLength,cosAngle=sub.x/connectorLength,shapeOffset={x:-shapeOffsetLen*sinAngle,y:shapeOffsetLen*cosAngle,z:0};offsetStart=(lineCount%2?0:.5)-Math.floor(lineCount/2);var startOffset=C.multiply(shapeOffset,offsetStart)}for(var i=0,l=geometryCoords.length;i<l;++i)if(1===lineCount){var shapeInfo={};shapeInfo.coord1=geometryCoords[i][0],shapeInfo.coord2=geometryCoords[i][1],needSplit&&(shapeInfo.jointCoordIndex=0===i?2:1),shapeInfo.color=colors[i],shapeInfo.radius=cylinderRadius,shapeInfo.lineWidth=lineWidth,shapeInfo.opacity=options.opacity,connectorShapeInfos.push(shapeInfo)}else for(var currCoord1=C.add(geometryCoords[i][0],startOffset),currCoord2=C.add(geometryCoords[i][1],startOffset),j=0;j<lineCount;++j){var shapeInfo={};shapeInfo.coord1=currCoord1,shapeInfo.coord2=currCoord2,currCoord1=C.add(currCoord1,shapeOffset),currCoord2=C.add(currCoord2,shapeOffset),needSplit&&(shapeInfo.jointCoordIndex=0===i?2:1),shapeInfo.color=colors[i],shapeInfo.radius=cylinderRadius,shapeInfo.lineWidth=lineWidth,shapeInfo.opacity=options.opacity,connectorShapeInfos.push(shapeInfo)}var boundInfo,renderMode=connectorRenderMode;return boundInfo=renderMode===BRM.WIRE||renderMode===BRM.MULTI_WIRE?this.createLineBoundInfo(coord1,coord2,{width:lineWidth}):this.createCylinderBoundInfo(coord1,coord2,{radius:cylinderRadius}),this.basicDrawObjectUpdated(context,connector,parentChemObj,boundInfo,Kekule.Render.ObjectUpdateType.ADD),this.doDrawConnectorSet(context,connectorShapeInfos,renderMode,renderType,options)},doDrawConnectorSet:function(context,connectorShapeInfos,renderMode,renderType,options){if(renderMode===BRM.WIRE||renderMode===BRM.MULTI_WIRE)return this.drawParallelLines(context,connectorShapeInfos);var drawEndCaps=this.getRenderCache(context).nodeRenderMode===NRM.NONE;return this.drawParallelCylinders(context,connectorShapeInfos,drawEndCaps)},_getBondRenderType:function(connector,renderMode){var localRenderOptions=connector.getOverriddenRender3DOptions()||{},rt=Kekule.Render.Render3DOptionUtils.getConnectorRenderType(localRenderOptions);return rt||Kekule.Render.ConnectorDrawUtils.getConnectorRender3DType(connector,renderMode)}}),Kekule.ClassDefineUtils.addExtraTwoTupleObjMapSupport(Kekule.Render.ChemCtab3DRenderer),Kekule.Render.StructFragment3DRenderer=Class.create(Kekule.Render.ChemObj3DRenderer,{CLASS_NAME:"Kekule.Render.StructFragment3DRenderer",initialize:function($super,chemObj,drawBridge,parent){$super(chemObj,drawBridge,parent),this._concreteRenderer=null,chemObj.hasCtab()?this._concreteRenderer=new Kekule.Render.ChemCtab3DRenderer(chemObj.getCtab(),drawBridge,this):(this._concreteRenderer=null,Kekule.raise(Kekule.$L("ErrorMsg.FORMULA_RENDERER_3D_NOT_AVAILABLE"))),this._concreteRenderer.setParentRenderer(this)},finalize:function($super){$super(),this._concreteRenderer&&this._concreteRenderer.finalize()},getRenderCache:function(context){return this._concreteRenderer.getRenderCache(context)},_getConcreteRendererDrawOptions:function(options){var ops=Object.create(options),chemObj=this.getChemObj(),objOptions=this.getRendererType()===Kekule.Render.RendererType.R3D?chemObj.getOverriddenRender3DOptions():chemObj.getOverriddenRenderOptions();return ops=Object.extend(ops,objOptions||{})},isChemObjRenderedBySelf:function($super,context,obj){return $super(context,obj)||obj===this.getChemObj()||this._concreteRenderer.isChemObjRenderedBySelf(context,obj)},isChemObjRenderedDirectlyBySelf:function($super,context,obj){return $super(context,obj)||obj===this.getChemObj()},doSetRedirectContext:function($super,value){$super(value),this._concreteRenderer.setRedirectContext(value)},doDrawSelf:function($super,context,baseCoord,options){return $super(context,baseCoord,options),this._concreteRenderer.draw(context,baseCoord,this._getConcreteRendererDrawOptions(options))},doRedraw:function(context){return this._concreteRenderer.redraw(context)},doUpdateSelf:function(context,updatedObjDetails,updateType){if(this._extractObjsOfUpdateObjDetails(updatedObjDetails).indexOf(this.getChemObj())>=0){var p=this.getRenderCache(context);return this.doClear(context),this.draw(context,p.baseCoord,p.options)}return this._concreteRenderer.doUpdate(context,updatedObjDetails,updateType)},doClearSelf:function(context){var r=this._concreteRenderer;if(r)return r.clear(context)},estimateRenderBox:function(context,options,allowCoordBorrow){return this._concreteRenderer.estimateRenderBox(context,this._getConcreteRendererDrawOptions(options),allowCoordBorrow)},getChildObjs:function($super){var chemObj=this.getChemObj();if(chemObj&&chemObj.getAttachedMarkers){for(var r=[],childObjs=(chemObj.getExposedNodes()||[]).concat(chemObj.getExposedConnectors()||[]),i=0,l=childObjs.length;i<l;++i){var obj=childObjs[i];r=r.concat(obj.getAttachedMarkers())}return r.concat($super())}return $super()},_needWholelyDraw:function($super,partialDrawObjs,context){var result=$super(partialDrawObjs,context);if(!result){for(var chemObj=this.getChemObj(),hasStructObjs=!1,i=0,l=partialDrawObjs.length;i<l;++i){if(partialDrawObjs[i].isChildOf(chemObj)){hasStructObjs=!0;break}}result=hasStructObjs}return result},transformCoordToObj:function(context,chemObj,coord){var obj=this.getChemObj()===chemObj?this._concreteChemObj:chemObj;return this._concreteRenderer.transformCoordToObj(context,obj,coord)},transformCoordToContext:function(context,chemObj,coord){var obj=this.getChemObj()===chemObj?this._concreteChemObj:chemObj;return this._concreteRenderer.transformCoordToContext(context,obj,coord)}}),Kekule.Render.Mol3DRenderer=Kekule.Render.StructFragment3DRenderer,Kekule.Render.CompositeObj3DRenderer=Class.create(Kekule.Render.ChemObj3DRenderer,{CLASS_NAME:"Kekule.Render.CompositeObj3DRenderer"}),Kekule.Render.CompositeMolecule3DRenderer=Class.create(Kekule.Render.CompositeObj3DRenderer,{CLASS_NAME:"Kekule.Render.CompositeMolecule3DRenderer",getChildObjs:function($super){for(var r=[],group=this.getChemObj().getSubMolecules(),i=0,l=group.getItemCount();i<l;++i){var o=group.getObjAt(i);r.push(o)}return r.concat($super())}}),Kekule.Render.ChemObjGroupList3DRenderer=Class.create(Kekule.Render.CompositeObj3DRenderer,{CLASS_NAME:"Kekule.Render.ChemObjGroupList3DRenderer",getChildObjs:function($super){var obj=this.getChemObj();if(obj instanceof Kekule.ChemObjList)for(var r=[],i=0,l=obj.getItemCount();i<l;++i)r.push(obj.getItemAt(i));else obj instanceof Kekule.ChemStructureObjectGroup&&(r=obj.getAllObjs());return(r||[]).concat($super())}}),Kekule.Render.ChemSpaceElement3DRenderer=Class.create(Kekule.Render.CompositeObj3DRenderer,{CLASS_NAME:"Kekule.Render.ChemSpaceElement3DRenderer",getChildObjs:function($super){return(this.getChemObj().getChildren().toArray()||[]).concat($super())}}),Kekule.Render.ChemSpace3DRenderer=Class.create(Kekule.Render.CompositeObj3DRenderer,{CLASS_NAME:"Kekule.Render.ChemSpace3DRenderer",getChildObjs:function($super){return[this.getChemObj().getRoot()].concat($super())}}),Kekule.Render.Renderer3DFactory.register(Kekule.StructureFragment,Kekule.Render.StructFragment3DRenderer),Kekule.Render.Renderer3DFactory.register(Kekule.CompositeMolecule,Kekule.Render.CompositeMolecule3DRenderer),Kekule.Render.Renderer3DFactory.register(Kekule.ChemObjList,Kekule.Render.ChemObjGroupList3DRenderer),Kekule.Render.Renderer3DFactory.register(Kekule.ChemStructureObjectGroup,Kekule.Render.ChemObjGroupList3DRenderer),Kekule.Render.Renderer3DFactory.register(Kekule.ChemSpaceElement,Kekule.Render.ChemSpaceElement3DRenderer),Kekule.Render.Renderer3DFactory.register(Kekule.ChemSpace,Kekule.Render.ChemSpace3DRenderer),Kekule}},function(module,exports,__webpack_require__){"use strict";function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var Class=__webpack_require__(0).Class,ObjectEx=__webpack_require__(0).ObjectEx,DataType=__webpack_require__(0).DataType,XmlUtility=__webpack_require__(1).XmlUtility;module.exports=function(Kekule){var _Class$create;if(Kekule.$jsRoot.THREE){var THREE=Kekule.$jsRoot.THREE;THREE.Object3D.prototype.clear=function(){for(var children=this.children,i=children.length-1;i>=0;i--){var child=children[i];child.clear(),this.remove(child)}},THREE.Scene.prototype.clearMesh=function(){for(var children=this.children,i=children.length-1;i>=0;i--){var child=children[i];(child instanceof THREE.Mesh||child instanceof THREE.Line||child.__objGroup__)&&(child.clear(),this.remove(child))}}}return Kekule.Render.ThreeObjectCache=Class.create({CLASS_NAME:"Kekule.Render.ThreeObjectCache",initialize:function(){this.cache=new Kekule.MapEx(!0)},finalize:function(){this.cache.finalize(),this.cache=null},createInstance:function(objClass,params){return null},isSameParams:function(params1,params2){if(params1.length!==params2.length)return!1;for(var i=0,l=params1.length;i<l;++i)if(!this.isParamEqual(params1[i],params2[i]))return!1;return!0},isParamEqual:function(param1,param2){var result=param1===param2;return result||DataType.isObjectValue(param1)&&DataType.isObjectValue(param2)&&(result=Kekule.ObjUtils.equal(param1,param2)),result},add:function(){var a=Array.prototype.slice.call(arguments),gClass=a.shift(),items=this.cache.get(gClass);items||(items=[],this.cache.set(gClass,items));var item={params:a};return item.instance=this.createInstance(gClass,a),items.push(item),item.instance},get:function(){var a=Array.prototype.slice.call(arguments),gClass=a[0],items=this.cache.get(gClass);if(items){a.shift();for(var i=0,l=items.length;i<l;++i){var params=items[i].params;if(this.isSameParams(params,a))return items[i].instance}a.unshift(gClass)}return this.add.apply(this,a)}}),Kekule.Render.ThreeGeometryCache=Class.create(Kekule.Render.ThreeObjectCache,{CLASS_NAME:"Kekule.Render.ThreeGeometryCache",createInstance:function(objClass,params){var instance=null,a=params;a[0];switch(objClass){case THREE.SphereGeometry:instance=new THREE.SphereGeometry(a[1],a[2],a[3]);break;case THREE.CylinderGeometry:instance=new THREE.CylinderGeometry(a[1],a[2],a[3],a[4],a[5],a[6])}return instance}}),Kekule.ClassUtils.makeSingleton(Kekule.Render.ThreeGeometryCache),Kekule.Render.ThreeMaterialCache=Class.create(Kekule.Render.ThreeObjectCache,{CLASS_NAME:"Kekule.Render.ThreeMaterialCache",createInstance:function(objClass,params){return new objClass(params[1])}}),Kekule.ClassUtils.makeSingleton(Kekule.Render.ThreeMaterialCache),Kekule.Render.ThreeContext=Class.create(ObjectEx,{CLASS_NAME:"Kekule.Render.ThreeContext",initialize:function($super,scene,camera,lights,renderer){$super(),this.setScene(scene),this.setCamera(camera),this.setLights(lights),this.setRenderer(renderer)},initProperties:function(){this.defineProp("scene",{dataType:DataType.OBJECT,serializable:!1}),this.defineProp("camera",{dataType:DataType.OBJECT,serializable:!1}),this.defineProp("lights",{dataType:DataType.ARRAY,serializable:!1}),this.defineProp("renderer",{dataType:DataType.OBJECT,serializable:!1}),this.defineProp("width",{dataType:DataType.INT,serializable:!1,setter:null}),this.defineProp("height",{dataType:DataType.INT,serializable:!1,setter:null})},getDimension:function(){return{width:this.getWidth(),height:this.getHeight()}},setDimension:function(width,height){this.setPropStoreFieldValue("width",width),this.setPropStoreFieldValue("height",height),this.getRenderer().setSize(width,height);var c=this.getCamera();c instanceof THREE.OrthographicCamera?(c.left=width/-2,c.right=width/2,c.top=height/2,c.bottom=height/-2):c.aspect=width/height,c.updateProjectionMatrix()}}),Kekule.Render.ThreeRendererBridge=Class.create((_Class$create={CLASS_NAME:"Kekule.Render.ThreeRendererBridge",_qualitySettings:[null,{sphereSegments:6,sphereRings:6,cylinderSegmentsRadius:6},{sphereSegments:8,sphereRings:8,cylinderSegmentsRadius:8},{sphereSegments:16,sphereRings:16,cylinderSegmentsRadius:16},{sphereSegments:32,sphereRings:32,cylinderSegmentsRadius:32},{sphereSegments:64,sphereRings:64,cylinderSegmentsRadius:64}],initialize:function(){this.geometryCache=Kekule.Render.ThreeGeometryCache.getInstance(),this.materialCache=Kekule.Render.ThreeMaterialCache.getInstance(),this._quality=null,this._modelParams={},this._webglEnabled=!0},finalize:function(){this.geometryCache=null,this.materialCache=null},getGraphicQualityLevel:function(){return this._quality},setGraphicQualityLevel:function(value){this._webglEnabled?this._quality=value:this._quality=Kekule.Render.Render3DGraphicQuality.EXTREME_LOW,this._modelParams=this.calcModelParams(this._quality)},_updateGraphicQualityLevel:function(){this._webglEnabled||this.setGraphicQualityLevel(Kekule.Render.Render3DGraphicQuality.EXTREME_LOW)},calcModelParams:function(qualityLevel){var result=this._qualitySettings[qualityLevel];return result||(result=this._qualitySettings[Kekule.Render.Render3DGraphicQuality.MEDIUM]),result},getInitialLightPositions:function(context){return[{x:5,y:5,z:10}]},createContext:function(parentElem,width,height){var BF=Kekule.BrowserFeature,renderer=BF.webgl?new THREE.WebGLRenderer({preserveDrawingBuffer:!0,alpha:!0}):BF.canvas?new THREE.CanvasRenderer:new THREE.SVGRenderer,camera=new THREE.PerspectiveCamera;camera.fov=5,this._webglEnabled=renderer instanceof THREE.WebGLRenderer,this._updateGraphicQualityLevel();var scene=new THREE.Scene;scene.add(camera),renderer.setSize(width,height);for(var lightPositions=this.getInitialLightPositions(),lights=[],i=0,l=lightPositions.length;i<l;++i){var alight=new THREE.DirectionalLight(13421772,1,10,!0),lightCoord=lightPositions[i];alight.position.set(lightCoord.x,lightCoord.y,lightCoord.z),scene.add(alight),lights.push(alight)}var alight=new THREE.AmbientLight(2105376);scene.add(alight),parentElem.appendChild(renderer.domElement);var result=new Kekule.Render.ThreeContext(scene,camera,lights,renderer);return result.setDimension(width,height),result},releaseContext:function(context){var elem=this.getContextElem(context);context.finalize(),elem&&elem.parentNode.removeChild(elem)},getContextElem:function(context){return context?context.getRenderer().domElement:null},getContextDimension:function(context){return{width:context.getWidth(),height:context.getHeight()}},setContextDimension:function(context,width,height){context.setDimension(width,height)},transformContextCoordToScreen:function(context,coord){var dim=context.getDimension();return{x:coord.x+dim.width/2,y:coord.y+dim.height/2}},transformScreenCoordToContext:function(context,coord){var dim=context.getDimension();return{x:coord.x-dim.width/2,y:coord.y-dim.height/2,z:0}},clearContext:function(context){context.clear()},canModifyGraphic:function(context){return!0}},_defineProperty(_Class$create,"transformContextCoordToScreen",function(context,coord){return{x:coord.x,y:coord.y}}),_defineProperty(_Class$create,"colorStrToHex",function(str){return Kekule.StyleUtils.colorStrToValue(str)}),_defineProperty(_Class$create,"createGroup",function(context){var r=new THREE.Object3D;return r.__objGroup__=!0,context.getScene().add(r),r}),_defineProperty(_Class$create,"addToGroup",function(elem,group){return group.add(elem),group}),_defineProperty(_Class$create,"removeFromGroup",function(elem,group){group.remove(elem)}),_defineProperty(_Class$create,"setClearColor",function(context,color){var r=context.getRenderer();r&&(r.setClearColorHex?color?context.getRenderer().setClearColorHex(this.colorStrToHex(color),1):context.getRenderer().setClearColorHex(null,0):r.setClearColor&&(color?context.getRenderer().setClearColor(this.colorStrToHex(color),1):context.getRenderer().setClearColor(null,0)))}),_defineProperty(_Class$create,"clearContext",function(context){context.getScene().clearMesh(),this.renderContext(context)}),_defineProperty(_Class$create,"renderContext",function(context){context.getRenderer().render(context.getScene(),context.getCamera())}),_defineProperty(_Class$create,"drawSphere",function(context,coord,radius,options){var segments=this._modelParams.sphereSegments,rings=this._modelParams.sphereRings,geometry=this.geometryCache.get(THREE.SphereGeometry,context.getScene(),1,segments,rings),material=this.materialCache.get(THREE.MeshLambertMaterial,context.getScene(),{color:this.colorStrToHex(options.color),opacity:options.opacity||1}),result=new THREE.Mesh(geometry,material);return result.scale.x=radius,result.scale.y=radius,result.scale.z=radius,result.position.x=coord.x,result.position.y=coord.y,result.position.z=coord.z,context.getScene().add(result),result}),_defineProperty(_Class$create,"drawLine",function(context,coord1,coord2,options){var lineMat=(this.colorStrToHex(options.color),this.materialCache.get(THREE.LineBasicMaterial,context.getScene(),{color:this.colorStrToHex(options.color),opacity:options.opacity||1,linewidth:options.lineWidth||1})),geom=new THREE.Geometry;geom.vertices.push(new THREE.Vector3(coord1.x,coord1.y,coord1.z)),geom.vertices.push(new THREE.Vector3(coord2.x,coord2.y,coord2.z));var line=new THREE.Line(geom,lineMat);return context.getScene().add(line),line}),_defineProperty(_Class$create,"drawCylinder",function(context,coord1,coord2,radius,options){var C=Kekule.CoordUtils,segmentsRadius=this._modelParams.cylinderSegmentsRadius,height=C.getDistance(coord1,coord2),geometry=this.geometryCache.get(THREE.CylinderGeometry,context.getScene(),1,1,1,segmentsRadius,1,!0),material=this.materialCache.get(THREE.MeshLambertMaterial,context.getScene(),{color:this.colorStrToHex(options.color),opacity:options.opacity||1}),result=new THREE.Mesh(geometry,material);result.scale.y=height,result.scale.x=radius,result.scale.z=radius;var quaternion=Kekule.ObjUtils.isUnset(options.quaternion)?this._calcQuaternion(coord1,coord2):options.quaternion;return quaternion&&(result.applyQuaternion?result.applyQuaternion(quaternion):(result.useQuaternion=!0,result.quaternion=quaternion,result.updateMatrix())),result.position.x=(coord1.x+coord2.x)/2,result.position.y=(coord1.y+coord2.y)/2,result.position.z=(coord1.z+coord2.z)/2,context.getScene().add(result),result}),_defineProperty(_Class$create,"drawParallelCylinders",function(context,cylinderInfos,drawEndCaps){for(var first=(Kekule.CoordUtils,cylinderInfos[0]),quaternion=this._calcQuaternion(first.coord1,first.coord2),result=this.createGroup(context),i=0,l=cylinderInfos.length;i<l;++i){var info=cylinderInfos[i],obj=this.drawCylinder(context,info.coord1,info.coord2,info.radius,{color:info.color,quaternion:quaternion,opacity:info.opacity});this.addToGroup(obj,result)}if(drawEndCaps)for(var capCoords,i=0,l=cylinderInfos.length;i<l;++i){var info=cylinderInfos[i];capCoords=Kekule.ObjUtils.isUnset(info.jointCoordIndex)?[info.coord1,info.coord2]:1===info.jointCoordIndex?[info.coord2]:[info.coord1];for(var j=0,k=capCoords.length;j<k;++j){var obj=this.drawSphere(context,capCoords[j],info.radius,{color:info.color,opacity:info.opacity});this.addToGroup(obj,result)}}return result}),_defineProperty(_Class$create,"removeDrawnElem",function(context,elem){elem.parent&&elem.parent.remove&&elem.parent.remove(elem)}),_defineProperty(_Class$create,"_calcQuaternion",function(coord1,coord2){var C=Kekule.CoordUtils,alignVector=C.substract(coord2,coord1);if(alignVector.x||alignVector.z){var crossVector={x:alignVector.z,y:0,z:-alignVector.x};crossVector=C.standardize(crossVector);var angle=Math.atan2(Math.sqrt(Math.sqr(alignVector.x)+Math.sqr(alignVector.z)),alignVector.y),halfAngle=angle/2,cosHalf=Math.cos(halfAngle),sinHalf=Math.sin(halfAngle);return new THREE.Quaternion(sinHalf*crossVector.x,sinHalf*crossVector.y,sinHalf*crossVector.z,cosHalf)}return null}),_defineProperty(_Class$create,"getLightCount",function(context){var ls=context.getLights();return ls?ls.length||0:0}),_defineProperty(_Class$create,"getLightProps",function(context,lightIndex){return{position:context.getLights()[lightIndex].position}}),_defineProperty(_Class$create,"setLightProps",function(context,lightIndex,props){var light=context.getLights()[lightIndex],p=props.position;p&&(light.position.x=p.x,light.position.y=p.y,light.position.z=p.z),light.updateMatrix()}),_defineProperty(_Class$create,"getCameraProps",function(context){var c=context.getCamera();return{position:c.position,fov:c.fov*Math.PI/180,aspect:c.aspect,left:c.left,right:c.right,top:c.top,bottom:c.bottom,lookAtVector:c.lookAtVector,upVector:c.up}}),_defineProperty(_Class$create,"setCameraProps",function(context,props){var c=context.getCamera(),notUnset=Kekule.ObjUtils.notUnset,p=props.position;if(p&&(c.position.x=p.x,c.position.y=p.y,c.position.z=p.z),notUnset(props.near)&&(c.near=props.near),notUnset(props.far)&&(c.near=props.far),props.fov&&(c.fov=180*props.fov/Math.PI),props.aspect&&(c.aspect=props.aspect),notUnset(props.left)&&(c.left=props.left),notUnset(props.top)&&(c.top=props.top),notUnset(props.bottom)&&(c.bottom=props.bottom),notUnset(props.right)&&(c.right=props.right),notUnset(props.upVector)){var v=props.upVector;c.up=new THREE.Vector3(v.x,v.y,v.z)}if(notUnset(props.lookAtVector)){var v=props.lookAtVector;c.lookAt(new THREE.Vector3(v.x,v.y,v.z))}c.updateMatrix()}),_defineProperty(_Class$create,"exportToDataUri",function(context,dataType,options){if(context.getRenderer()instanceof THREE.SVGRenderer){var domElem=context.getRenderer().domElement,svg=XmlUtility.serializeNode(domElem);return"data:image/svg+xml;base64,"+btoa(svg)}var domElem=context.getRenderer().domElement;return domElem?domElem.toDataURL(dataType,options):null}),_Class$create)),Kekule.Render.ThreeRendererBridge.isSupported=function(){var result=void 0!==Kekule.$jsRoot.THREE;if(result){var F=Kekule.BrowserFeature;result=F.webgl||F.canvas||F.svg}return!!result},Kekule.Render.DrawBridge3DMananger.register(Kekule.Render.ThreeRendererBridge,20),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,ObjectEx=(__webpack_require__(0).ClassEx,__webpack_require__(0).ObjectEx),DataType=__webpack_require__(0).DataType;module.exports=function(Kekule){return Kekule.Render.ChemObjPainter=Class.create(ObjectEx,{CLASS_NAME:"Kekule.Render.ChemObjPainter",initialize:function($super,renderType,chemObj,drawBridge,renderConfigs){$super();var rtype=renderType||Kekule.Render.RendererType.R2D;this.setPropStoreFieldValue("renderType",rtype),this.setPropStoreFieldValue("chemObj",chemObj),this.setPropStoreFieldValue("drawBridge",drawBridge||(rtype===Kekule.Render.RendererType.R3D?Kekule.Render.DrawBridge3DMananger.getPreferredBridgeInstance():Kekule.Render.DrawBridge2DMananger.getPreferredBridgeInstance())),renderConfigs&&this.setPropStoreFieldValue("renderConfigs",renderConfigs)},finalize:function($super){this.getRenderer()&&this.getRenderer().finalize(),$super()},initProperties:function(){this.defineProp("renderType",{dataType:DataType.INT,serializable:!1,setter:null}),this.defineProp("chemObj",{dataType:"Kekule.ChemObject",serializable:!1,setter:null}),this.defineProp("drawBridge",{dataType:DataType.OBJECT,serializable:!1,setter:null}),this.defineProp("renderConfigs",{dataType:DataType.OBJECT,serializable:!1,getter:function(){var result=this.getPropStoreFieldValue("renderConfigs");return result||(result=this.getRenderType()===Kekule.Render.RendererType.R3D?Kekule.Render.Render3DConfigs.getInstance():Kekule.Render.Render2DConfigs.getInstance()),result}}),this.defineProp("renderer",{dateType:"Kekule.Render.AbstractRenderer",serializable:!1,setter:null}),this.defineProp("canModifyTargetObj",{dataType:DataType.BOOL})},getDrawOptionFromConfigs:function(renderConfigs){return Kekule.Render.RenderOptionUtils.convertConfigsToPlainHash(renderConfigs)},prepareRenderer:function(){if(this.getRenderer())return this.getRenderer();var func=this.getRenderType()===Kekule.Render.RendererType.R3D?Kekule.Render.get3DRendererClass:Kekule.Render.get2DRendererClass,c=func(this.getChemObj());if(c){var r=new c(this.getChemObj(),this.getDrawBridge(),this);return this.setPropStoreFieldValue("renderer",r),r}return Kekule.error(Kekule.$L("ErrorMsg.CANNOT_FIND_SUITABLE_RENDERER_FOR_OBJ")),null},createContext:function(parentElem,width,height){return this.getDrawBridge().createContext(parentElem,width,height)},_convertContextBoxToScreen:function(context,box){if(!box)return{};var bridge=this.getDrawBridge(),coord1=bridge.transformContextCoordToScreen(context,{x:box.x1,y:box.y1}),coord2=bridge.transformContextCoordToScreen(context,{x:box.x2,y:box.y2});return Kekule.BoxUtils.createBox(coord1,coord2)},estimateObjBox:function(context,options,allowCoordBorrow){this._generateDrawOptions(options);return this.prepareRenderer(),this.getRenderer().estimateObjBox(context,options,allowCoordBorrow)},estimateRenderBox:function(context,baseCoord,options,allowCoordBorrow){var ops=this._generateDrawOptions(options);return this.prepareRenderer(),this.getRenderer().estimateRenderBox(context,baseCoord,ops,allowCoordBorrow)},estimateScreenBox:function(context,baseCoord,options,allowCoordBorrow){var box=this.estimateRenderBox(context,baseCoord,options,allowCoordBorrow);return box?this._convertContextBoxToScreen(context,box):null},_generateDrawOptions:function(inputOptions){var configs=this.getRenderConfigs(),ops=configs?this.getDrawOptionFromConfigs(configs):{};return ops=Object.extend(ops,inputOptions)},draw:function(context,baseCoord,options){this.prepareRenderer();var ops=this._generateDrawOptions(options);return this.getRenderer().draw(context,baseCoord,ops)},redraw:function(context){return this.getRenderer().redraw(context)},getActualRenderTransformParams:function(context){var r=this.getRenderer();return r?r.getRenderFinalTransformParams(context):null},getActualInitialRenderTransformOptions:function(context){var r=this.getRenderer();return r?r.getRenderInitialTransformOptions(context):null},changeGeometryOptions:function(context,baseCoord,newOptions){var r=this.getRenderer();if(r&&r.changeGeometryOptions){var ops=this._generateDrawOptions(newOptions);return r.changeGeometryOptions(context,baseCoord,ops)}return this.clearContext(context),this.draw(context,baseCoord,newOptions)},supportGeometryOptionChange:function(){var r=this.getRenderer();return r&&r.changeGeometryOptions},beginUpdatePainter:function(){return this.getRenderer().beginUpdateRenderer()},endUpdatePainter:function(){return this.getRenderer().endUpdateRenderer()},update:function(context,updatedObjs,updateType){return this.getRenderer().update(context,updatedObjs,updateType)},addNew:function(context,updatedObjs){return this.getRenderer().addNew(context,updatedObjs)},modify:function(context,updatedObjs){return this.getRenderer().modify(context,updatedObjs)},remove:function(context,removedObjs){return this.getRenderer().remove(context,removedObjs)},clear:function(context){var renderer=this.getRenderer();return renderer&&renderer.clear(context),this},clearContext:function(context){return this.getDrawBridge().clearContext(context)}}),Kekule.Render.ChemObjPainter2D=Class.create(Kekule.Render.ChemObjPainter,{CLASS_NAME:"Kekule.Render.ChemObjPainter2D",initialize:function($super,chemObj,drawBridge,renderConfigs){$super(Kekule.Render.RendererType.R2D,chemObj,drawBridge,renderConfigs)}}),Kekule.Render.ChemObjPainter3D=Class.create(Kekule.Render.ChemObjPainter,{CLASS_NAME:"Kekule.Render.ChemObjPainter3D",initialize:function($super,chemObj,drawBridge,renderConfigs){$super(Kekule.Render.RendererType.R3D,chemObj,drawBridge,renderConfigs)}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,ObjectEx=(__webpack_require__(0).ClassEx,__webpack_require__(0).ObjectEx),DataType=__webpack_require__(0).DataType;module.exports=function(Kekule){return Kekule.Operation=Class.create(ObjectEx,{CLASS_NAME:"Kekule.Operation",initialize:function($super){$super()},initProperties:function(){},isReversible:function(){return!0},execute:function(){return this.doExecute()},doExecute:function(){},reverse:function(){return this.isReversible()||Kekule.raise(Kekule.$L("ErrorMsg.COMMAND_NOT_REVERSIBLE")),this.doReverse()},doReverse:function(){}}),Kekule.Operation.State={UNEXECUTED:0,EXECUTED:1},Kekule.MacroOperation=Class.create(Kekule.Operation,{CLASS_NAME:"Kekule.MacroOperation",initialize:function($super,childOperations){$super(),this.setChildren(childOperations||[])},initProperties:function(){this.defineProp("children",{dataType:DataType.ARRAY})},isReversible:function(){for(var children=this.getChildren(),i=0,l=children.length;i<l;++i)if(!children[i].isReversible())return!1;return!0},doExecute:function(){for(var children=this.getChildren(),i=0,l=children.length;i<l;++i)children[i].execute()},doReverse:function(){for(var children=this.getChildren(),i=children.length-1;i>=0;--i)children[i].reverse()},add:function(oper){return this.getChildren().push(oper)},remove:function(oper){var opers=this.getChildren(),i=opers.indexOf(oper);return i>=0?opers.splice(i,1):null},getChildAt:function(index){return this.getChildren()[index]},getChildCount:function(){return this.getChildren().length}}),Kekule.OperationHistory=Class.create(ObjectEx,{CLASS_NAME:"Kekule.OperationHistory",initialize:function($super,capacity){$super(),this.setCapacity(capacity||null)},initProperties:function(){this.defineProp("capacity",{dataType:DataType.INT}),this.defineProp("operations",{dataType:DataType.ARRAY,getter:function(){var result=this.getPropStoreFieldValue("operations");return result||(result=[],this.setPropStoreFieldValue("operations",result)),result}}),this.defineProp("currIndex",{dataType:DataType.INT,serializable:!1}),this.defineEvent("push"),this.defineEvent("pop"),this.defineEvent("undo"),this.defineEvent("redo")},checkCapacity:function(){var c=this.getCapacity();if(c&&!(c<=0))for(var a=this.getPropStoreFieldValue("operations");a&&a.length>c;)a.shift(),this.getCurrIndex()>0&&this.setCurrIndex(this.getCurrIndex()-1)},getOperationCount:function(){return this.getOperations().length},getOperationAt:function(index){return this.getOperations()[index]},getCurrOperation:function(){var index=this.getCurrIndex();return index>=0?this.getOperations()[index]:null},clear:function(){this.setOperations([]),this.setCurrIndex(-1),this.invokeEvent("clear",{currOperIndex:this.getCurrIndex()}),this.invokeEvent("operChange")},push:function(operation){var a=this.getOperations(),index=this.getCurrIndex();index<a.length&&a.splice(index+1,a.length-index-1),a.push(operation),this.setCurrIndex(a.length-1),this.checkCapacity(),this.invokeEvent("push",{operation:operation,currOperIndex:this.getCurrIndex()}),this.invokeEvent("operChange")},pop:function(){var result,index=this.getCurrIndex();return this.canPop()?(result=this.getOperations()[index],this.setCurrIndex(--index),this.invokeEvent("pop",{operation:result,currOperIndex:this.getCurrIndex()}),this.invokeEvent("operChange")):result=null,result},canPop:function(){return this.getCurrIndex()>=0&&!!this.getOperations().length},unpop:function(){var result,index=this.getCurrIndex();this.getOperations();return this.canUnpop()?(this.setCurrIndex(++index),result=this.getOperations()[index]):result=null,result},canUnpop:function(){return this.getCurrIndex()<this.getOperations().length-1},undo:function(){var op=this.pop();return op&&op.isReversible()&&op.reverse(),this.invokeEvent("undo",{operation:op,currOperIndex:this.getCurrIndex()}),this.invokeEvent("operChange"),op},undoAll:function(){for(;this.canUndo;)this.undo()},canUndo:function(){return this.canPop()},redo:function(){var op=this.unpop();return op&&op.execute(),this.invokeEvent("redo",{operation:op,currOperIndex:this.getCurrIndex()}),this.invokeEvent("operChange"),op},canRedo:function(){return this.canUnpop()}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,ClassEx=__webpack_require__(0).ClassEx,ObjectEx=__webpack_require__(0).ObjectEx,DataType=__webpack_require__(0).DataType;module.exports=function(Kekule){Kekule.Action=Class.create(ObjectEx,{CLASS_NAME:"Kekule.Action",HTML_CLASSNAME:null,initialize:function($super){$super(),this.setPropStoreFieldValue("linkedWidgets",[]),this.setPropStoreFieldValue("enabled",!0),this.setPropStoreFieldValue("visible",!0),this.setPropStoreFieldValue("displayed",!0),this.setPropStoreFieldValue("htmlClassName",this.getInitialHtmlClassName()),this.setBubbleEvent(!0),this.reactWidgetExecuteBind=this.reactWidgetExecute.bind(this)},finalize:function($super){var owner=this.getOwner();owner&&owner.actionRemoved&&owner.actionRemoved(this),this.unlinkAllWidgets(),this.setPropStoreFieldValue("linkedWidgets",[]),$super()},initProperties:function(){this.defineProp("enabled",{dataType:DataType.BOOL,setter:function(value){value!==this.getEnabled()&&(this.setPropStoreFieldValue("enabled",value),this.updateAllWidgetsProp("enabled",value))}}),this.defineProp("visible",{dataType:DataType.BOOL,setter:function(value){value!==this.getVisible()&&(this.setPropStoreFieldValue("visible",value),this.updateAllWidgetsProp("visible",value))}}),this.defineProp("displayed",{dataType:DataType.BOOL,setter:function(value){value!==this.getDisplayed()&&(this.setPropStoreFieldValue("displayed",value),this.updateAllWidgetsProp("displayed",value))}}),this.defineProp("checked",{dataType:DataType.BOOL,setter:function(value){value!==this.getChecked()&&(this.setPropStoreFieldValue("checked",value),this.updateAllWidgetsProp("checked",value),this.checkedChanged())}}),this.defineProp("checkGroup",{dataType:DataType.STRING}),this.defineProp("hint",{dataType:DataType.STRING,setter:function(value){value&&value!==this.getHint()&&(this.setPropStoreFieldValue("hint",value),this.updateAllWidgetsProp("hint",value))}}),this.defineProp("text",{dataType:DataType.STRING,setter:function(value){value&&value!==this.getText()&&(this.setPropStoreFieldValue("text",value),this.updateAllWidgetsProp("text",value))}}),this.defineProp("htmlClassName",{dataType:DataType.STRING,setter:function(value){var old=this.getHtmlClassName();this.setPropStoreFieldValue("htmlClassName",value),this.updateAllWidgetClassName(value,old)}}),this.defineProp("owner",{dataType:DataType.OBJECT,serializable:!1,setter:null}),this.defineProp("linkedWidgets",{dataType:DataType.ARRAY,serializable:!1,setter:null}),this.defineProp("invoker",{dataType:"Kekule.Widget.BaseWidget",serializable:!1,setter:null})},getHigherLevelObj:function(){return this.getOwner()},invokeEvent:function($super,eventName,event){event||(event={}),event.invoker||(event.invoker=this.getInvoker()),$super(eventName,event)},getInitialHtmlClassName:function(){return this.HTML_CLASSNAME||null},getActionList:function(){var result=this.getOwner();return result instanceof Kekule.ActionList?result:null},checkedChanged:function(){var list=this.getActionList();list&&list.actionCheckedChanged(this)},linkWidget:function(widget){var widgets=this.getLinkedWidgets();if(widgets.indexOf(widget)<0){var text=this.getText();text&&this.updateWidgetProp(widget,"text",text);var hint=this.getHint();return hint&&this.updateWidgetProp(widget,"hint",hint),this.updateWidgetProp(widget,"enabled",this.getEnabled()),this.updateWidgetProp(widget,"displayed",this.getDisplayed()),this.updateWidgetProp(widget,"visible",this.getVisible()),this.updateWidgetProp(widget,"checked",this.getChecked()),this.updateWidgetClassName(widget,this.getHtmlClassName(),null),widget.addEventListener("execute",this.reactWidgetExecuteBind),widgets.push(widget),this}},unlinkWidget:function(widget){var widgets=this.getLinkedWidgets(),index=widgets.indexOf(widget);index>=0&&(this.updateWidgetClassName(widget,null,this.getHtmlClassName()),widget.removeEventListener("execute",this.reactWidgetExecuteBind),widgets.splice(index,1))},unlinkAllWidgets:function(){for(var widgets=this.getLinkedWidgets(),i=widgets.length-1;i>=0;--i)this.unlinkWidget(widgets[i])},reactWidgetExecute:function(e){return this.execute(e.target,e.htmlEvent)},execute:function(target,htmlEvent){var oldChecked=this.getChecked();return this.getCheckGroup()&&oldChecked||(this.doExecute(target,htmlEvent),this.getCheckGroup()&&this.setChecked(!0)),this.setPropStoreFieldValue("invoker",target),this.invokeEvent("execute",{htmlEvent:htmlEvent}),this},doExecute:function(target,htmlEvent){},update:function(){return this.doUpdate(),this},doUpdate:function(){},updateAllWidgetsProp:function(propName,propValue){for(var widgets=this.getLinkedWidgets(),i=0,l=widgets.length;i<l;++i){var w=widgets[i];this.updateWidgetProp(w,propName,propValue)}},updateWidgetProp:function(widget,propName,propValue){widget.hasProperty(propName)&&widget.setPropValue(propName,propValue)},updateWidgetClassName:function(widget,addClasses,removeClasses){removeClasses&&widget.removeClassName(removeClasses,!0),addClasses&&widget.addClassName(addClasses,!0)},updateAllWidgetClassName:function(addClasses,removeClasses){for(var widgets=this.getLinkedWidgets(),i=0,l=widgets.length;i<l;++i){var w=widgets[i];this.updateWidgetClassName(w,addClasses,removeClasses)}}}),Kekule.ActionList=Class.create(ObjectEx,{CLASS_NAME:"Kekule.ActionList",initialize:function($super){$super(),this.setPropStoreFieldValue("actions",[]),this.setPropStoreFieldValue("ownActions",!0),this.setPropStoreFieldValue("autoUpdate",!0),this.reactActionExecutedBind=this.reactActionExecuted.bind(this),this.addEventListener("execute",this.reactActionExecutedBind)},finalize:function($super){this.removeEventListener("execute",this.reactActionExecutedBind),this.clear(),this.setPropStoreFieldValue("actions",null),$super()},initProperties:function(){this.defineProp("actions",{dataType:DataType.ARRAY,serializable:!1,setter:null}),this.defineProp("ownActions",{dataType:DataType.BOOL}),this.defineProp("autoUpdate",{dataType:DataType.BOOL,setter:function(value){this.setPropStoreFieldValue("autoUpdate",value),value&&this.updateAll()}})},hasActionChecked:function(group){return!!this.getCheckedAction(group)},getCheckedAction:function(group){for(var actions=this.getActions(),i=0,l=actions.length;i<l;++i){var a=actions[i];if(a.getCheckGroup()===group&&a.getChecked())return a}return null},actionAdded:function(action){if(this.getOwnActions()){var oldOwner=action.getOwner();oldOwner&&oldOwner.actionRemoved&&oldOwner.actionRemoved(action),action.setPropStoreFieldValue("owner",this)}Kekule.ArrayUtils.pushUnique(this.getActions(),action),action.update()},actionRemoved:function(action){Kekule.ArrayUtils.remove(this.getActions(),action),action.setPropStoreFieldValue("owner",null)},actionCheckedChanged:function(action){if(action&&action.getChecked()){var group=action.getCheckGroup();if(group)for(var actions=this.getActions(),i=0,l=actions.length;i<l;++i){var a=actions[i];a!==action&&a.getCheckGroup()===group&&a.getChecked()&&a.setChecked(!1)}}},reactActionExecuted:function(e){e.target instanceof Kekule.Action&&(this.invokeEvent("execute",{action:e.target}),this.getAutoUpdate()&&this.updateAll())},getActionCount:function(){return this.getActions().length},getActionLength:function(){return this.getActions().length},getActionAt:function(index){return this.getActions()[index]},indexOfAction:function(action){return this.getActions().indexOf(action)},hasAction:function(action){return this.indexOfAction(action)>=0},add:function(action){return this.actionAdded(action),this},remove:function(action){return this.actionRemoved(action),this.getOwnActions()&&action.finalize(),this},removeAt:function(index){var actions=this.getActions(),action=actions[index];return action&&(Kekule.ArrayUtils.removeAt(actions,index),this.actionRemoved(action)),this},clear:function(){for(var actions=this.getActions(),i=actions.length-1;i>=0;--i)this.actionRemoved(actions[i]);return this.setPropStoreFieldValue("actions",[]),this},updateAll:function(){for(var actions=this.getActions(),i=0,l=actions.length;i<l;++i)actions[i].update();return this}}),Kekule.ActionFileOpen=Class.create(Kekule.Action,{CLASS_NAME:"Kekule.ChemWidget.ActionFileOpen",initialize:function($super){$super()},initProperties:function(){this.defineProp("filters",{dataType:DataType.ARRAY})},doUpdate:function($super){$super(),this.setEnabled(this.getEnabled()&&Kekule.NativeServices.showFilePickerDialog)},doExecute:function(target){var elem=target.getElement(),doc=elem.ownerDocument,self=this,invoker=this.getInvoker();this.openFilePicker(doc,function(result,firstFile,files){result&&self.fileOpened(files,invoker)})},openFilePicker:function(doc,callback){return Kekule.NativeServices.showFilePickerDialog(doc,callback,{mode:"open",filters:this.getFilters()})},fileOpened:function(files,invoker){this.doFileOpened(files,invoker),this.invokeEvent("open",{files:files,file:files[0]})},doFileOpened:function(files,invoker){}}),Kekule.ActionLoadFileData=Class.create(Kekule.Action,{CLASS_NAME:"Kekule.ChemWidget.ActionLoadFileData",initialize:function($super){$super()},initProperties:function(){this.defineProp("filters",{dataType:DataType.ARRAY})},doUpdate:function($super){$super(),this.setEnabled(this.getEnabled()&&Kekule.NativeServices.canLoadFileData())},doExecute:function(target){var elem=target.getElement(),doc=elem.ownerDocument,self=this,invoker=this.getInvoker();this.loadFileData(doc,function(result,data,fileName){self.dataLoaded(data,fileName,!!result,invoker)})},loadFileData:function(doc,callback){return Kekule.NativeServices.loadFileData(doc,callback,{filters:this.getFilters()})},reactFileLoad:function(result,data,fileName){this.dataLoaded(data,fileName,!!result)},dataLoaded:function(data,fileName,loaded,invoker){this.doDataLoaded(data,fileName,loaded,invoker),this.invokeEvent("load",{fileName:fileName,data:data,success:loaded})},doDataLoaded:function(data,fileName,loaded,invoker){}}),Kekule.ActionFileSave=Class.create(Kekule.Action,{CLASS_NAME:"Kekule.ChemWidget.ActionFileSave",initialize:function($super,data,fileName){$super(),data&&this.setData(data),fileName&&this.setFileName(fileName)},initProperties:function(){this.defineProp("data",{dataType:DataType.STRING,serializable:!1}),this.defineProp("fileName",{dataType:DataType.STRING,serializable:!1}),this.defineProp("filters",{dataType:DataType.ARRAY})},doUpdate:function($super){$super(),this.setEnabled(this.getEnabled()&&Kekule.NativeServices.canSaveFileData())},doExecute:function(target){var doc;if(target){doc=target.getElement().ownerDocument}else doc=document;Kekule.NativeServices.saveFileData(doc,this.getData(),null,{initialFileName:this.getFileName(),filters:this.getFilters()})}}),Kekule.ActionManager={_namedActionMap:null,_getNamedActionMap:function(canCreate){var result=AM._namedActionMap;return!result&&canCreate&&(result=new Kekule.MapEx,AM._namedActionMap=result),result},getRegisteredActionsOfClass:function(widgetClass,canCreate){var actionMap=AM._getNamedActionMap(canCreate);if(actionMap){var result=actionMap.get(widgetClass);return!result&&canCreate&&(result={},actionMap.set(widgetClass,result)),result}return null},registerNamedActionClass:function(name,actionClass,targetWidgetClass){AM.getRegisteredActionsOfClass(targetWidgetClass,!0)[name]=actionClass},unregisterNamedActionClass:function(name,targetWidgetClass){var actions=AM.getRegisteredActionsOfClass(targetWidgetClass,!1);actions&&actions[name]&&delete actions[name]},getActionClassOfName:function(name,widgetOrClass,checkSupClasses){var widgetClass=ClassEx.isClass(widgetOrClass)?widgetOrClass:widgetOrClass.getClass&&widgetOrClass.getClass();if(!widgetClass)return null;var actions=AM.getRegisteredActionsOfClass(widgetClass,!1),result=actions&&actions[name];if(!result&&checkSupClasses){var supClass=ClassEx.getSuperClass(widgetClass);result=supClass?AM.getActionClassOfName(name,supClass,checkSupClasses):null}return result}};var AM=Kekule.ActionManager;return Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,ClassEx=__webpack_require__(0).ClassEx,ObjectEx=__webpack_require__(0).ObjectEx,DataType=__webpack_require__(0).DataType;module.exports=function(Kekule){return Kekule.DataBingItem=Class.create(ObjectEx,{CLASS_NAME:"Kekule.DataBingItem",initialize:function($super,source,sourceName,target,targetName){$super(),this.setSource(source),this.setSourceName(sourceName),this.setTarget(target),this.setTargetName(targetName)},initProperties:function(){this.defineProp("source",{dataType:DataType.OBJECTEX,serializable:!1}),this.defineProp("sourceName",{dataType:DataType.STRING,serializable:!1}),this.defineProp("target",{dataType:DataType.OBJECTEX,serializable:!1}),this.defineProp("targetName",{dataType:DataType.STRING,serializable:!1})},updateData:function(reverseDirection){var src=this.getSource(),target=this.getTarget(),srcName=this.getSourceName(),targetName=this.getTargetName();if(src&&target&&srcName&&targetName)if(reverseDirection){var data=target.getDataByBindingName(targetName);src.setDataByBindingName(srcName,data)}else{var data=src.getDataByBindingName(srcName);target.setDataByBindingName(targetName,data)}}}),ClassEx.extend(ObjectEx,{getDataByBindingName:function(name){return this.hasProperty(name)?this.getPropValue(name):DataType.isFunctionValue(this[name])?this[name]():void 0},setDataByBindingName:function(name,value){var v=value,propInfo=this.getPropInfo(name);if(propInfo){var propType=propInfo.dataType,valueType=DataType.getType(value);propType!==valueType&&valueType===DataType.STRING&&(v=DataType.StringUtils.deserializeValue(value))}return this.setPropValue(name,v),this},createDataBinding:function(src,srcName,targetName){var result=new Kekule.DataBingItem(src,srcName,this,targetName);return this.getDataBindings(!0).push(result),result},removeDataBinding:function(bindingItem){Kekule.ArrayUtils.remove(this.getDataBindings(),bindingItem)},updateBindingData:function(reverseDirection){var items=this.getDataBindings();if(items&&items.length)for(var i=0,l=items.length;i<l;++i)items[i].updateData(reverseDirection)}}),ClassEx.defineProp(ObjectEx,"dataBindings",{dataType:DataType.ARRAY,scope:Class.PropertyScope.PRIVATE,getter:function(canCreate){var result=this.getPropStoreFieldValue("dataBindings");return!result&&canCreate&&(result=[],this.setPropStoreFieldValue("dataBindings",result)),result}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var Hammer=__webpack_require__(64),Class=__webpack_require__(0).Class,ClassEx=__webpack_require__(0).ClassEx,ObjectEx=__webpack_require__(0).ObjectEx,DataType=__webpack_require__(0).DataType,ObjSerializerFactory=__webpack_require__(2).ObjSerializerFactory;module.exports=function(Kekule){var AU=Kekule.ArrayUtils,EU=Kekule.HtmlElementUtils;Kekule.Widget={DEF_EVENT_HANDLER_PREFIX:"react_",DEF_TOUCH_GESTURE_HANDLER_PREFIX:"react_touch_",getEventHandleFuncName:function(eventName){return Kekule.Widget.DEF_EVENT_HANDLER_PREFIX+eventName},getTouchGestureHandleFuncName:function(touchGestureName){return Kekule.Widget.DEF_EVENT_HANDLER_PREFIX+touchGestureName}},Kekule.Widget.HtmlClassNames={BASE:"K-Widget",DYN_CREATED:"K-Dynamic-Created",NORMAL_BACKGROUND:"K-Normal-Background",NONSELECTABLE:"K-NonSelectable",SELECTABLE:"K-Selectable",STATE_NORMAL:"K-State-Normal",STATE_DISABLED:"K-State-Disabled",STATE_HOVER:"K-State-Hover",STATE_ACTIVE:"K-State-Active",STATE_FOCUSED:"K-State-Focused",STATE_SELECTED:"K-State-Selected",STATE_CHECKED:"K-State-Checked",SHOW_POPUP:"K-Show-Popup",SHOW_DIALOG:"K-Show-Dialog",SHOW_ACTIVE_MODAL:"K-Show-ActiveModal",PART_CONTENT:"K-Content",PART_TEXT_CONTENT:"K-Text-Content",PART_ASSOC_TEXT_CONTENT:"K-Assoc-Text-Content",PART_IMG_CONTENT:"K-Img-Content",PART_GLYPH_CONTENT:"K-Glyph-Content",PART_PRI_GLYPH_CONTENT:"K-Pri-Glyph-Content",PART_ASSOC_GLYPH_CONTENT:"K-Assoc-Glyph-Content",PART_DECORATION_CONTENT:"K-Decoration-Content",PART_ERROR_REPORT:"K-Error-Report",FIRST_CHILD:"K-First-Child",LAST_CHILD:"K-Last-Child",TEXT_NO_WRAP:"K-No-Wrap",LAYOUT_H:"K-Layout-H",LAYOUT_V:"K-Layout-V",CORNER_ALL:"K-Corner-All",CORNER_LEFT:"K-Corner-Left",CORNER_RIGHT:"K-Corner-Right",CORNER_TOP:"K-Corner-Top",CORNER_BOTTOM:"K-Corner-Bottom",CORNER_TL:"K-Corner-TL",CORNER_TR:"K-Corner-TR",CORNER_BL:"K-Corner-BL",CORNER_BR:"K-Corner-BR",CORNER_LEADING:"K-Corner-Leading",CORNER_TAILING:"K-Corner-Tailing",FULLFILL:"K-Fulfill",NOWRAP:"K-No-Wrap",HIDE_TEXT:"K-Text-Hide",HIDE_GLYPH:"K-Glyph-Hide",SHOW_TEXT:"K-Text-Show",SHOW_GLYPH:"K-Glyph-Show",MODAL_BACKGROUND:"K-Modal-Background",DUMB_WIDGET:"K-Dumb-Widget",PLACEHOLDER:"K-PlaceHolder"};var CNS=Kekule.Widget.HtmlClassNames;Kekule.Widget.Layout={HORIZONTAL:1,VERTICAL:2},Kekule.Widget.Position={AUTO:0,TOP:1,LEFT:2,BOTTOM:4,RIGHT:8,TOP_LEFT:3,TOP_RIGHT:9,BOTTOM_LEFT:6,BOTTOM_RIGHT:12},Kekule.Widget.Direction={AUTO:0,LTR:1,TTB:2,RTL:4,BTT:8,isInHorizontal:function(direction){var D=Kekule.Widget.Direction;return!!(direction&D.LTR||direction&D.RTL)},isInVertical:function(direction){var D=Kekule.Widget.Direction;return!!(direction&D.TTB||direction&D.BTT)}},Kekule.Widget.State={NORMAL:0,FOCUSED:1,HOVER:2,ACTIVE:3,DISABLED:-1};var WS=Kekule.Widget.State;Kekule.Widget.ShowHideType={DROPDOWN:1,POPUP:2,DIALOG:3,DEFAULT:0},Kekule.Widget.UiEvents=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","mousewheel","keydown","keyup","keypress","touchstart","touchend","touchcancel","touchleave","touchmove"],Kekule.Widget.UiLocalEvents=["blur","focus","mouseenter","mouseleave"],Kekule.Widget.TouchGestures=["hold","tap","doubletap","swipe","swipeup","swipedown","swipeleft","swiperight","transform","transformstart","transformend","rotate","pinch","pinchin","pinchout","touch","release"];return Kekule.Widget.BaseWidget=Class.create(ObjectEx,{CLASS_NAME:"Kekule.Widget.BaseWidget",BINDABLE_TAG_NAMES:null,DEF_PERIODICAL_EXEC_DELAY:500,DEF_PERIODICAL_EXEC_INTERVAL:100,STYLE_RES_FIELD:"__$style_resources__",initialize:function($super,parentOrElementOrDocument,isDumb){this._stateClassName=null,this._isDismissed=!1,this._pendingHtmlClassNames="",this._reactElemAttribMutationBind=this._reactElemAttribMutation.bind(this),this.setPropStoreFieldValue("inheritEnabled",!0),this.setPropStoreFieldValue("inheritStatic",!0),this.setPropStoreFieldValue("selfEnabled",!0),this.setPropStoreFieldValue("selfStatic",!1),this.setPropStoreFieldValue("periodicalExecDelay",this.DEF_PERIODICAL_EXEC_DELAY),this.setPropStoreFieldValue("periodicalExecInterval",this.DEF_PERIODICAL_EXEC_INTERVAL),this.setPropStoreFieldValue("useNormalBackground",!0),$super(),isDumb||(this.reactUiEventBind=this.reactUiEvent.bind(this)),parentOrElementOrDocument&&(parentOrElementOrDocument instanceof Kekule.Widget.BaseWidget?(this.setDocument(parentOrElementOrDocument.getDocument()),this.createElement(),this.setParent(parentOrElementOrDocument)):parentOrElementOrDocument.documentElement?(this.setDocument(parentOrElementOrDocument),this.createElement()):(this.setDocument(parentOrElementOrDocument.ownerDocument),this.setElement(parentOrElementOrDocument))),this._stateClassName=null,this._layoutClassName=null,this.getLayout()||this.setLayout(Kekule.Widget.Layout.HORIZONTAL),this.setDraggable(!1),this._periodicalExecBind=this._periodicalExec.bind(this),this.setBubbleEvent(!0),this.setInheritBubbleUiEvents(!0),this.stateChanged(),Kekule.Widget.globalManager&&Kekule.Widget.globalManager.notifyWidgetCreated(this)},initProperties:function(){this.defineProp("isDumb",{dataType:DataType.BOOL,serializable:!1,scope:Class.PropertyScope.PUBLIC,setter:function(value){if(this.getIsDumb()!=value){this.setPropStoreFieldValue("isDumb",value);var elem=this.getElement();elem&&(value?this.uninstallUiEventHandlers(elem):this.installUiEventHandlers(elem))}}}),this.defineProp("bubbleUiEvents",{dataType:DataType.BOOL,scope:Class.PropertyScope.PUBLIC}),this.defineProp("inheritBubbleUiEvents",{dataType:DataType.BOOL,scope:Class.PropertyScope.PUBLIC}),this.defineProp("parent",{dataType:"Kekule.Widget.BaseWidget",serializable:!1,scope:Class.PropertyScope.PUBLISHED,setter:function(value){var old=this.getParent();old&&old._removeChild(this),value&&value._addChild(this),this.setPropStoreFieldValue("parent",value)}}),this.defineProp("childWidgets",{dataType:DataType.ARRAY,serializable:!1,setter:null,scope:Class.PropertyScope.PUBLIC,getter:function(){var r=this.getPropStoreFieldValue("childWidgets");return r||(r=[],this.setPropStoreFieldValue("childWidgets",r)),r}}),this.defineProp("document",{dataType:DataType.OBJECT,serializable:!1,scope:Class.PropertyScope.PUBLIC}),this.defineProp("element",{dataType:DataType.OBJECT,serializable:!1,scope:Class.PropertyScope.PUBLIC,setter:function(value){var old=this.getElement();value!==old&&(this.setPropStoreFieldValue("element",value),this.elementChanged(value,old))}}),this.defineProp("observeElementAttribChanges",{dataType:DataType.BOOL,setter:function(value){!!value!=!!this.getObserveElementAttribChanges()&&(this.setPropStoreFieldValue("observeElementAttribChanges",value),this.observeElementAttribChangesChanged(!!value))}}),this.defineElemAttribMappingProp("id","id"),this.defineElemAttribMappingProp("draggable","draggable"),this.defineElemStyleMappingProp("width","width"),this.defineElemStyleMappingProp("height","height"),this.defineProp("offsetParent",{dataType:DataType.OBJECT,serializable:!1,scope:Class.PropertyScope.PUBLIC,getter:function(){return this.getElement().offsetParent},setter:null}),this.defineProp("offsetLeft",{dataType:DataType.INT,serializable:!1,getter:function(){return this.getElement().offsetLeft},setter:null}),this.defineProp("offsetTop",{dataType:DataType.INT,serializable:!1,getter:function(){return this.getElement().offsetTop},setter:null}),this.defineProp("offsetWidth",{dataType:DataType.INT,serializable:!1,getter:function(){return this.getElement().offsetWidth},setter:null}),this.defineProp("offsetHeight",{dataType:DataType.INT,serializable:!1,getter:function(){return this.getElement().offsetHeight},setter:null}),this.defineProp("innerHTML",{dataType:DataType.STRING,serializable:!1,scope:Class.PropertyScope.PUBLIC,getter:function(){return this.getElement().innerHTML},setter:function(value){this.getElement().innerHTML=value}}),this.defineProp("style",{dataType:DataType.OBJECT,serializable:!1,scope:Class.PropertyScope.PUBLIC,getter:function(){return this.getElement().style},setter:null}),this.defineProp("cssText",{dataType:DataType.STRING,serializable:!1,scope:Class.PropertyScope.PUBLIC,getter:function(){return this.getElement().style.cssText},setter:function(value){this.getElement().style.cssText=value}}),this.defineProp("htmlClassName",{dataType:DataType.STRING,serializable:!1,scope:Class.PropertyScope.PUBLIC,getter:function(){return this.getElement().className},setter:function(value){this.getElement().className=value}}),this.defineProp("customHtmlClassName",{dataType:DataType.STRING,scope:Class.PropertyScope.PUBLIC,setter:function(value){var elem=this.getElement(),old=this.getCustomHtmlClassName();elem&&old!==value&&(old&&EU.removeClass(elem,old),value&&EU.addClass(elem,value),this.setPropStoreFieldValue("customHtmlClassName",value))}}),this.defineProp("visible",{dataType:DataType.BOOL,serializable:!1,getter:function(){return Kekule.StyleUtils.isVisible(this.getElement())},setter:function(value,byPassShowStateChange){Kekule.StyleUtils.setVisibility(this.getElement(),value),byPassShowStateChange||this.widgetShowStateChanged(this.isShown())}}),this.defineProp("displayed",{dataType:DataType.BOOL,serializable:!1,getter:function(){return Kekule.StyleUtils.isDisplayed(this.getElement())},setter:function(value,byPassShowStateChange){Kekule.StyleUtils.setDisplay(this.getElement(),value),byPassShowStateChange||this.widgetShowStateChanged(this.isShown())}}),this.defineProp("showHideType",{dataType:DataType.INT,serializable:!1,scope:Class.PropertyScope.PRIVATE}),this.defineProp("showHideCaller",{dataType:"Kekule.Widget.BaseWidget",serializable:!1,scope:Class.PropertyScope.PRIVATE}),this.defineProp("showHideCallerPageRect",{dataType:DataType.HASH,serializable:!1,scope:Class.PropertyScope.PRIVATE}),this.defineProp("finalizeAfterHiding",{dataType:DataType.BOOL,scope:Class.PropertyScope.PUBLIC}),this.defineProp("layout",{dataType:DataType.INT,setter:function(value){this.getPropStoreFieldValue("layout")!==value&&(this.setPropStoreFieldValue("layout",value),this.layoutChanged())}}),this.defineProp("useCornerDecoration",{dataType:DataType.BOOL,setter:function(value){this.setPropStoreFieldValue("useCornerDecoration",value),value?this.addClassName(CNS.CORNER_ALL):this.removeClassName(CNS.CORNER_ALL)}}),this.defineProp("useNormalBackground",{dataType:DataType.BOOL,setter:function(value){this.setPropStoreFieldValue("useNormalBackground",value),value?this.addClassName(CNS.NORMAL_BACKGROUND):this.removeClassName(CNS.NORMAL_BACKGROUND)}}),this.defineProp("showText",{dataType:DataType.BOOL,setter:function(value){this.setPropStoreFieldValue("showText",value),value?(this.removeClassName(CNS.HIDE_TEXT),this.addClassName(CNS.SHOW_TEXT)):(this.addClassName(CNS.HIDE_TEXT),this.removeClassName(CNS.SHOW_TEXT))}}),this.defineProp("showGlyph",{dataType:DataType.BOOL,setter:function(value){this.setPropStoreFieldValue("showGlyph",value),value?(this.removeClassName(CNS.HIDE_GLYPH),this.addClassName(CNS.SHOW_GLYPH)):(this.addClassName(CNS.HIDE_GLYPH),this.removeClassName(CNS.SHOW_GLYPH))}}),this.defineProp("allowTextWrap",{dataType:DataType.BOOL,serialzable:!1,setter:function(value){value?this.removeClassName(CNS.TEXT_NO_WRAP):this.addClassName(CNS.TEXT_NO_WRAP)}}),this.defineProp("selfEnabled",{dataType:DataType.BOOL,scope:Class.PropertyScope.PRIVATE}),this.defineProp("inheritEnabled",{dataType:DataType.BOOL,setter:function(value){this.setPropStoreFieldValue("inheritEnabled",value),this.stateChanged()}}),this.defineProp("enabled",{dataType:DataType.BOOL,serializable:!1,getter:function(){var result=this.getPropStoreFieldValue("selfEnabled");if(this.getInheritEnabled()){var p=this.getParent();p&&(result=result&&p.getEnabled())}return result},setter:function(value){var elem=this.getElement();value?elem.removeAttribute("disabled"):elem.setAttribute("disabled","true");var elem=this.getCoreElement();elem!=this.getElement()&&(value?elem.removeAttribute("disabled"):elem.setAttribute("disabled","true")),this.setPropStoreFieldValue("selfEnabled",value),this.stateChanged()}}),this.defineProp("selfStatic",{dataType:DataType.BOOL,scope:Class.PropertyScope.PRIVATE}),this.defineProp("inheritStatic",{dataType:DataType.BOOL,setter:function(value){this.setPropStoreFieldValue("inheritStatic",value),this.stateChanged()}}),this.defineProp("static",{dataType:DataType.BOOL,serializable:!1,getter:function(){var result=this.getPropStoreFieldValue("selfStatic");if(this.getInheritStatic()){var p=this.getParent();p&&(result=result||p.getStatic())}return result},setter:function(value){this.setPropStoreFieldValue("selfStatic",value),this.stateChanged()}}),this.defineProp("inheritState",{dataType:DataType.BOOL,setter:function(value){this.setPropStoreFieldValue("inheritState",value),this.stateChanged()}}),this.defineProp("state",{dataType:DataType.INT,serializable:!1,scope:Class.PropertyScope.PUBLIC,setter:null,getter:function(){var result;if(this.getInheritState()){var p=this.getParent();p&&(result=p.getState())}else result=this.getEnabled()?this.getIsActive()?WS.ACTIVE:this.getIsHover()?WS.HOVER:this.getIsFocused()?WS.FOCUSED:WS.NORMAL:WS.DISABLED;return result}}),this.defineElemStyleMappingProp("cursor","cursor"),this.defineProp("isHover",{dataType:DataType.BOOL,serializable:!1,scope:Class.PropertyScope.PUBLIC,setter:function(value){this.setPropStoreFieldValue("isHover",value),value||this.isCaptureMouse()||this.setPropStoreFieldValue("isActive",!1),this.stateChanged()}}),this.defineProp("isActive",{dataType:DataType.BOOL,serializable:!1,scope:Class.PropertyScope.PUBLIC,setter:function(value){this.setPropStoreFieldValue("isActive",value),value&&this.focus();var m=this.getGlobalManager();m&&m.notifyWidgetActiveChanged(this,value),this.stateChanged()}}),this.defineProp("isFocused",{dataType:DataType.BOOL,serializable:!1,scope:Class.PropertyScope.PUBLIC,getter:function(){var doc=this.getDocument(),elem=this.getCoreElement();if(doc&&elem&&doc.activeElement)return doc.activeElement===elem},setter:function(value){this.setPropStoreFieldValue("isFocused",value);var m=this.getGlobalManager();m&&m.notifyWidgetFocusChanged(this,value);var elem=this.getCoreElement();elem&&(elem.focus&&value&&elem.focus(),elem.blur&&!value&&elem.blur()),this.stateChanged()}}),this.defineProp("isDialog",{dataType:DataType.BOOL,scope:Class.PropertyScope.PUBLIC}),this.defineProp("isPopup",{dataType:DataType.BOOL,scope:Class.PropertyScope.PUBLIC}),this.defineProp("popupCaller",{dataType:DataType.BOOL,scope:Class.PropertyScope.PRIVATE}),this.defineProp("modalInfo",{dataType:DataType.HASH,scope:Class.PropertyScope.PUBLIC}),this.defineProp("enablePeriodicalExec",{dataType:DataType.BOOL}),this.defineProp("periodicalExecDelay",{dataType:DataType.INT}),this.defineProp("periodicalExecInterval",{dataType:DataType.INT}),this.defineElemAttribMappingProp("hint","title"),this.defineProp("action",{dataType:"Kekule.Action",serializable:!1,setter:function(value){var old=this.getAction();old!==value&&(old&&old.unlinkWidget&&(old.unlinkWidget(this),this.unlinkAction(old)),this.setPropStoreFieldValue("action",value),value&&value.linkWidget&&(value.linkWidget(this),this.linkAction(value)))}}),this.defineProp("iaControllerMap",{dataType:DataType.OBJECT,serializable:!1,setter:null,scope:Class.PropertyScope.PUBLIC,getter:function(){var result=this.getPropStoreFieldValue("iaControllerMap");return result||(result=new Kekule.HashEx,this.setPropStoreFieldValue("iaControllerMap",result)),result}}),this.defineProp("defIaControllerId",{dataType:DataType.STRING,serializable:!1,scope:Class.PropertyScope.PUBLIC}),this.defineProp("defIaController",{dataType:DataType.STRING,serializable:!1,scope:Class.PropertyScope.PUBLIC,setter:null,getter:function(){return this.getIaControllerMap().get(this.getDefIaControllerId())}}),this.defineProp("activeIaControllerId",{dataType:DataType.STRING,serializable:!1,scope:Class.PropertyScope.PUBLIC}),this.defineProp("activeIaController",{dataType:DataType.STRING,serializable:!1,scope:Class.PropertyScope.PUBLIC,setter:null,getter:function(){return this.getIaControllerMap().get(this.getActiveIaControllerId())}})},doFinalize:function($super){this.setAction(null),this.setParent(null),this.releaseChildWidgets();var elem=this.getElement();this.setElement(null),this.destroyElement(elem),this.getGlobalManager()&&this.getGlobalManager().notifyWidgetFinalized(this),$super()},invokeEvent:function($super,eventName,event){event||(event={}),event.widget||(event.widget=this),$super(eventName,event);var m=Kekule.Widget.globalManager;m&&m.notifyWidgetEventFired(this,eventName,event)},getGlobalManager:function(){return Kekule.Widget.globalManager},getCoreElement:function(){return this.getElement()},getChildrenHolderElement:function(){return this.getCoreElement()},getTextSelectable:function(){return!1},canUsePlaceHolderOnElem:function(elem){return!1},doPropChanged:function(propName,newValue){"width"!==propName&&"height"!==propName||this.resized()},getActualBubbleUiEvents:function(){var parent=this.getParent();return!!this.getBubbleUiEvents()||(this.getInheritBubbleUiEvents()&&parent&&parent.getActualBubbleUiEvents?parent.getActualBubbleUiEvents():void 0)},releaseChildWidgets:function(){for(var children=this.getChildWidgets(),i=children.length-1;i>=0;--i)children[i].finalize()},defineElemAttribMappingProp:function(propName,elemAttribName,options){var ops=Object.extend({dataType:DataType.STRING,serializable:!1,getter:function(){return this.getElement()&&this.getElement().getAttribute(elemAttribName)},setter:function(value){this.getElement()&&this.getElement().setAttribute(elemAttribName,value)}},options||{});return this.defineProp(propName,ops)},defineElemStyleMappingProp:function(propName,stylePropName,options){var ops=Object.extend({dataType:DataType.STRING,serializable:!1,getter:function(){return this.getStyleProperty(stylePropName)},setter:function(value){this.setStyleProperty(stylePropName,value)}},options||{});return this.defineProp(propName,ops)},getHigherLevelObj:function(){return this.getParent()},linkAction:function(action){},unlinkAction:function(action){},getChildActionClass:function(actionName,checkSupClasses){return Kekule.ActionManager.getActionClassOfName(actionName,this,checkSupClasses)},linkStyleResource:function(resOrName,element){var res=resOrName instanceof Kekule.Widget.StyleResource?resOrName:Kekule.Widget.StyleResourceManager.getResource(resOrName);return res&&res.linkTo(element||this),this},unlinkStyleResource:function(resOrName,element){var res=resOrName instanceof Kekule.Widget.StyleResource?resOrName:Kekule.Widget.StyleResourceManager.getResource(resOrName);return res&&res.unlinkFrom(element||this),this},getStyleProperty:function(cssPropName,element){var elem=element||this.getElement(),styleRes=elem[this.STYLE_RES_FIELD];return styleRes&&styleRes[cssPropName]?styleRes[cssPropName]:elem.style[cssPropName]},setStyleProperty:function(cssPropName,value,element){var elem=element||this.getElement();if(elem){var res;if(value instanceof Kekule.Widget.StyleResource?res=value:DataType.getType(value)===DataType.STRING&&value.startsWith(Kekule.Widget.StyleResourceNames.PREFIX)&&(res=Kekule.Widget.StyleResourceManager.getResource(value)),res){var styleRes=elem[this.STYLE_RES_FIELD];styleRes||(styleRes={},elem[this.STYLE_RES_FIELD]=styleRes);var old=styleRes[cssPropName];old&&this.unlinkStyleResource(old,elem),res&&this.linkStyleResource(res,elem),styleRes[cssPropName]=res}else{elem.style[cssPropName]=value;var styleRes=elem[this.STYLE_RES_FIELD];styleRes&&styleRes[cssPropName]&&this.unlinkStyleResource(styleRes[cssPropName],elem)}}},removeStyleProperty:function(cssPropName,value,element){var elem=element||this.getElement();Kekule.StyleUtils.removeStyleProperty(elem.style,cssPropName)},_addChild:function(child){if(child){var ws=this.getChildWidgets();ws.indexOf(child)<0&&(ws.push(child),this.childWidgetAdded(child),this.childrenModified())}},_insertChild:function(child,refChild){if(child){var ws=this.getChildWidgets(),refIndex=refChild?ws.indexOf(refChild):ws.length;ws.indexOf(child)>=0?refIndex>=0&&this._moveChild(child,refIndex):(refIndex<0&&(refIndex=ws.length),ws.splice(refIndex,0,child),this.childWidgetAdded(child),this.childrenModified())}},_removeChild:function(child){if(child){var ws=this.getChildWidgets(),index=ws.indexOf(child);if(index>=0){ws.splice(index,1);var parentElem=this.getChildrenHolderElement(),childElem=child.getElement();childElem&&Kekule.DomUtils.isDescendantOf(childElem,parentElem)&&childElem.parentNode.removeChild(childElem),this.childWidgetRemoved(child),this.childrenModified()}}},_moveChild:function(child,newIndex){child&&Kekule.ArrayUtils.changeItemIndex(this.getChildWidgets(),child,newIndex)&&(this.childWidgetMoved(child,newIndex),this.childrenModified())},childrenModified:function(){},childWidgetAdded:function(widget){},childWidgetRemoved:function(widget){},childWidgetMoved:function(widget,newIndex){},indexOfChild:function(widget){return this.getChildWidgets().indexOf(widget)},hasChild:function(widget){return this.indexOfChild(widget)>=0},getChildAtIndex:function(index){return this.getChildWidgets()[index]},getPrevSibling:function(){var parent=this.getParent();if(parent){var index=parent.indexOfChild(this);return this.getChildAtIndex(--index)}return null},getNextSibling:function(){var parent=this.getParent();if(parent){var index=parent.indexOfChild(this);return this.getChildAtIndex(++index)}return null},_haltPrevShowHideProcess:function(){Kekule.Widget.showHideManager&&this.__$showHideTransInfo&&this.__$showHideTransInfo.halt()},show:function(caller,callback,showType){if(this.getElement()&&!this.__$isShowing)return this._haltPrevShowHideProcess(),this.doShow(caller,callback,showType),this},doShow:function(caller,callback,showType){this.__$isShowing=!0;var self=this,done=function(){self.__$showHideTransInfo=null,self.widgetShowStateDone(!0),self.__$isShowing=!1,callback&&callback()};this.setShowHideType(showType),Kekule.ObjUtils.notUnset(showType)&&(this.setIsPopup(showType===Kekule.Widget.ShowHideType.DROPDOWN||showType===Kekule.Widget.ShowHideType.POPUP),showType===Kekule.Widget.ShowHideType.DIALOG?(this.setIsDialog(!0),showType=Kekule.Widget.ShowHideType.POPUP):this.setIsDialog(!1)),this.widgetShowStateBeforeChanging(!0),showType===Kekule.Widget.ShowHideType.DROPDOWN&&Kekule.Widget.globalManager.preparePopupWidget(this,caller,showType),Kekule.Widget.showHideManager?this.__$showHideTransInfo||(this.__$showHideTransInfo=Kekule.Widget.showHideManager.show(this,caller,done,showType)):(this.setDisplayed(!0,!0),this.setVisible(!0,!0),done()),this.setShowHideCaller(caller),caller&&this.setShowHideCallerPageRect(EU.getElemPageRect(caller.getElement&&caller.getElement()||caller)),this.widgetShowStateChanged(!0)},flash:function(time,caller,callback,showType){var self=this,done=function(){callback&&callback(),setTimeout(self.hide.bind(self),time)};return this.show(caller,done,showType),this},hide:function(caller,callback,hideType,useVisible){if(this.getElement()&&!this.__$isHiding)return this.__$isHiding=!0,caller||(caller=this.getShowHideCaller()),hideType||(hideType=this.getShowHideType()),this._haltPrevShowHideProcess(),this.doHide(caller,callback,hideType,useVisible),this},doHide:function(caller,callback,hideType,useVisible){var self=this,finalizeAfterHiding=this.getFinalizeAfterHiding(),done=function(){self.__$showHideTransInfo=null,self.widgetShowStateDone(!1),hideType===Kekule.Widget.ShowHideType.DROPDOWN&&Kekule.Widget.globalManager.unpreparePopupWidget(self),self.__$isHiding=!1,callback&&callback(),finalizeAfterHiding&&self.finalize()};this.widgetShowStateBeforeChanging(!1),Kekule.Widget.showHideManager?(this.__$showHideTransInfo&&this.__$showHideTransInfo.halt(),this.__$showHideTransInfo||(this.__$showHideTransInfo=Kekule.Widget.showHideManager.hide(this,caller,done,hideType,!1,{callerPageRect:this.getShowHideCallerPageRect()}))):(useVisible?this.setVisible(!1,!0):this.setDisplayed(!1,!0),done()),this.widgetShowStateChanged(!1)},dismiss:function(caller,callback,hideType,useVisible){return this._isDismissed=!0,this.hide(caller,callback,hideType,useVisible)},isShown:function(ignoreDom){return(this.isInDomTree()||ignoreDom)&&this.getElement()&&this.getVisible()&&this.getDisplayed()},widgetShowStateBeforeChanging:function(isShown){},widgetShowStateChanged:function(isShown){Kekule.ObjUtils.isUnset(isShown)&&(isShown=this.isShown()),Kekule.ObjUtils.notUnset(this._lastShown)&&this._lastShown===isShown||(this._lastShown=isShown,isShown&&(this._isDismissed=!1),this.getIsPopup()&&(isShown?Kekule.Widget.globalManager.registerPopupWidget(this):Kekule.Widget.globalManager.unregisterPopupWidget(this)),this.getIsDialog()&&(isShown?Kekule.Widget.globalManager.registerDialogWidget(this):Kekule.Widget.globalManager.unregisterDialogWidget(this)),this.doWidgetShowStateChanged(isShown),this.invokeEvent("showStateChange",{widget:this,isShown:isShown,isDismissed:this._isDismissed}))},doWidgetShowStateChanged:function(isShown){},widgetShowStateDone:function(isShown){},isInDomTree:function(){var elem=this.getElement();return Kekule.DomUtils.isInDomTree(elem)},focus:function(){return this.setIsFocused(!0),this},blur:function(){return this.setIsFocused(!1),this},getBoundingClientRect:function(includeScroll){if(this.getDisplayed())return Kekule.HtmlElementUtils.getElemBoundingClientRect(this.getElement(),includeScroll);var d=Kekule.StyleUtils.getDisplayed(this.getElement()),v=Kekule.StyleUtils.getVisibility(this.getElement());try{this.setVisible("hidden"),this.setDisplayed("");var result=Kekule.HtmlElementUtils.getElemBoundingClientRect(this.getElement(),includeScroll)}finally{this.setDisplayed(d),this.setVisible(v)}return result},getDimension:function(){return this.getBoundingClientRect(!1)},setDimension:function(width,height,suppressResize){var doResize=!1,notUnset=Kekule.ObjUtils.notUnset;return notUnset(width)&&(this.getStyle().width="number"==typeof width?width+"px":width,doResize=!0),notUnset(height)&&(this.getStyle().height="number"==typeof height?height+"px":height,doResize=!0),doResize&&!suppressResize&&this.resized(),this.objectChange(["width","height"]),this},resized:function(){this.doResize(),this.invokeEvent("resize",{widget:this})},doResize:function(){},layoutChanged:function(){var layout=this.getLayout();this._layoutClassName&&this.removeClassName(this._layoutClassName),this._layoutClassName=this.getLayoutClassName(layout),this._layoutClassName&&this.addClassName(this._layoutClassName)},getLayoutClassName:function(layout){var WL=Kekule.Widget.Layout;return layout===WL.VERTICAL?CNS.LAYOUT_V:layout===WL.HORIZONTAL?CNS.LAYOUT_H:null},stateChanged:function(){this._stateClassName&&this.removeClassName(this._stateClassName),this._stateClassName=this.getStateClassName(this.getState()),this._stateClassName&&this.addClassName(this._stateClassName);for(var children=this.getChildWidgets(),i=0,l=children.length;i<l;++i)children[i].stateChanged()},getStateClassName:function(state){var WS=Kekule.Widget.State;return state===WS.ACTIVE?CNS.STATE_ACTIVE:state===WS.HOVER?CNS.STATE_HOVER:state===WS.FOCUSED?CNS.STATE_FOCUSED:state===WS.DISABLED?CNS.STATE_DISABLED:CNS.STATE_NORMAL},createElement:function(){var doc=this.getDocument(),result=this.doCreateRootElement(doc);return this.setElement(result),result},doCreateRootElement:function(doc){},doCreateSubElements:function(doc,rootElem){return[]},destroyElement:function(elem){var elem=elem||this.getElement();elem&&elem.parentNode&&elem.parentNode.removeChild(elem)},appendToElem:function(parentElem){return parentElem&&parentElem.appendChild(this.getElement()),this},insertToElem:function(parentElem,refElem){return parentElem.insertBefore(this.getElement(),refElem),this},appendToWidget:function(parentWidget){return this.setParent(parentWidget),this.appendToElem(parentWidget.getChildrenHolderElement()),this},insertToWidget:function(parentWidget,refWidget){return this.setParent(parentWidget),refWidget?this.insertToElem(parentWidget.getChildrenHolderElement(),refWidget.getElement()):this.appendToElem(parentWidget.getChildrenHolderElement()),this},insertedToDom:function(){return this.widgetShowStateChanged(this.isShown()),this.doInsertedToDom()},doInsertedToDom:function(){},removedFromDom:function(){return this.widgetShowStateChanged(!1),this.doRemovedFromDom()},doRemovedFromDom:function(){},domElemAdded:function(elem){return this.doDomElemAdded(elem)},doDomElemAdded:function(elem){},domElemRemoved:function(elem){return this.doDomElemRemoved(elem)},doDomElemRemoved:function(elem){},getWidgetClassName:function(){var result=Kekule.Widget.HtmlClassNames.BASE;return this.getElement()&&!Kekule.HtmlElementUtils.isFormCtrlElement(this.getCoreElement())&&this.getUseNormalBackground()&&(result+=" "+Kekule.Widget.HtmlClassNames.NORMAL_BACKGROUND),result+=" "+this.doGetWidgetClassName()},doGetWidgetClassName:function(){return""},hasClassName:function(className){return EU.hasClass(this.getElement(),className)},addClassName:function(classNames,affectCustomProp){if(this.getElement())if(affectCustomProp){var cname=this.getCustomHtmlClassName();cname=Kekule.StrUtils.addTokens(cname,classNames),this.setCustomHtmlClassName(cname)}else EU.addClass(this.getElement(),classNames);else this._pendingHtmlClassNames=Kekule.StrUtils.addTokens(this._pendingHtmlClassNames,classNames);return this},removeClassName:function(classNames,affectCustomProp){if(this.getElement())if(affectCustomProp){var cname=this.getCustomHtmlClassName();cname=Kekule.StrUtils.removeTokens(cname,classNames),this.setCustomHtmlClassName(cname)}else EU.removeClass(this.getElement(),classNames);else this._pendingHtmlClassNames=Kekule.StrUtils.removeTokens(this._pendingHtmlClassNames,classNames);return this},toggleClassName:function(classNames,affectCustomProp){if(this.getElement())if(affectCustomProp){var cname=this.getCustomHtmlClassName();cname=Kekule.StrUtils.toggleTokens(cname,classNames),this.setCustomHtmlClassName(cname)}else EU.toggleClass(this.getElement(),classNames);return this},isElementBindable:function(element){var allowedTags=this.getBindableElemTagNames();if(allowedTags){var currTag=element.tagName;return allowedTags.indexOf(currTag.toLowerCase())>=0}return!0},getBindableElemTagNames:function(){return this.getPrototype().hasOwnProperty("BINDABLE_TAG_NAMES")?this.BINDABLE_TAG_NAMES:null},bindElement:function(element){if(element){if(!this.isElementBindable(element))return void Kekule.error(Kekule.$L("ErrorMsg.WIDGET_CAN_NOT_BIND_TO_ELEM").format(this.getClassName(),element.tagName));var originClassName=element.className;originClassName&&this.setCustomHtmlClassName(this.getCustomHtmlClassName()||" "+originClassName);var DU=Kekule.DomUtils,HU=Kekule.HtmlElementUtils;!function(rootElem){for(var children=DU.getDirectChildElems(rootElem),i=children.length-1;i>=0;--i){var child=children[i];HU.hasClass(child,CNS.DYN_CREATED)&&rootElem.removeChild(child)}}(element);var subElems=this.doCreateSubElements(this.getDocument(),element);if(subElems&&subElems.length)for(var i=0,l=subElems.length;i<l;++i){var elem=subElems[i];HU.addClass(elem,CNS.DYN_CREATED)}this.doBindElement(element),Kekule.DomUtils.hasAttribute(element,"disabled")&&this.setEnabled(!1);var w=element.getAttribute("width"),h=element.getAttribute("height");(Kekule.ObjUtils.notUnset(w)||Kekule.ObjUtils.notUnset(h))&&(w=parseFloat((w||"").toString())||0,h=parseFloat((h||"").toString())||0,this.setDimension(w,h));var dataset=Kekule.DomUtils.getDataset(element);if(dataset)for(var attribName in dataset){var value=dataset[attribName];try{Kekule.Widget.Utils.setWidgetPropFromElemAttrib(this,attribName,value)}catch(e){Kekule.warn(e)}}var cname=this.getWidgetClassName();EU.addClass(element,cname),cname=this.getCustomHtmlClassName(),cname&&EU.addClass(element,cname),this.getTextSelectable()||EU.addClass(element,CNS.NONSELECTABLE),this._pendingHtmlClassNames&&(EU.addClass(element,this._pendingHtmlClassNames),this._pendingHtmlClassNames=""),this.getIsDumb()||this.installUiEventHandlers(element),element.__$kekule_widget__=this,this.invokeEvent("bind",{widget:this,element:element})}},doBindElement:function(element){},unbindElement:function(element){if(element){this.getIsDumb()||this.uninstallUiEventHandlers(element);var cname=this.getWidgetClassName();EU.removeClass(element,cname),this.doUnbindElement(element),element.__$kekule_widget__=void 0;try{delete element.__$kekule_widget__}catch(e){}this.invokeEvent("unbind",{widget:this,element:element})}},doUnbindElement:function(element){},elementChanged:function(newElem,oldElem){oldElem&&this.unbindElement(oldElem),newElem&&this.bindElement(newElem)},observeElementAttribChangesChanged:function(value){var elem=this.getElement();value?this._installAttribMutationObserver(elem):this._uninstallAttribMutationObserver(elem)},_installAttribMutationObserver:function(elem){if(Kekule.X.MutationObserver){if(!this._attribMutationObserver){var ob=new Kekule.X.MutationObserver(this._reactElemAttribMutationBind);this._attribMutationObserver=ob}this._attribMutationObserver.observe(elem,{attributes:!0})}},_uninstallAttribMutationObserver:function(elem){this._attribMutationObserver&&this._attribMutationObserver.disconnect()},_reactElemAttribMutation:function(mutations){for(var elem=this.getElement(),i=0,l=mutations.length;i<l;++i){var m=mutations[i];if("attributes"===m.type&&m.target===elem){var attribName=m.attributeName;if(attribName&&Kekule.DomUtils.isDataAttribName(attribName)){var coreName=Kekule.DomUtils.getDataAttribCoreName(attribName);if(coreName){var attribValue=elem.getAttribute(attribName);Kekule.Widget.Utils.setWidgetPropFromElemAttrib(this,coreName,attribValue)}}}}},createDecorationContent:function(parentElem,refElem){var doc=parentElem.ownerDocument,result=doc.createElement("span");return EU.addClass(result,[CNS.PART_CONTENT,CNS.PART_DECORATION_CONTENT,CNS.DYN_CREATED]),refElem?parentElem.insertBefore(result,refElem):parentElem.appendChild(result),result},createTextContent:function(text,parentElem,refElem){var doc=parentElem.ownerDocument,result=doc.createElement("span");return EU.addClass(result,[CNS.PART_CONTENT,CNS.PART_TEXT_CONTENT,CNS.DYN_CREATED]),result.innerHTML=text,refElem?parentElem.insertBefore(result,refElem):parentElem.appendChild(result),result},createGlyphContent:function(parentElem,refElem,htmlClassName){var doc=parentElem.ownerDocument,result=doc.createElement("span");return EU.addClass(result,[CNS.PART_CONTENT,CNS.PART_GLYPH_CONTENT,CNS.DYN_CREATED]),htmlClassName&&EU.addClass(result,htmlClassName),refElem?parentElem.insertBefore(result,refElem):parentElem.appendChild(result),result},installUiEventHandlers:function(element){for(var events=Kekule.Widget.UiLocalEvents,i=0,l=events.length;i<l;++i)Kekule.X.Event.addListener(element,events[i],this.reactUiEventBind)},uninstallUiEventHandlers:function(element){for(var events=Kekule.Widget.UiLocalEvents,i=0,l=events.length;i<l;++i)Kekule.X.Event.removeListener(element,events[i],this.reactUiEventBind)},reactUiEvent:function(e){if(this.getStatic());else if(this.getEnabled()){var keyCode,handled=!1,evType=e.getType(),targetElem=e.getTarget(),targetWidget=Kekule.Widget.Utils.getBelongedResponsiveWidget(targetElem),eventOnSelf=targetWidget===this,KC=Kekule.X.Event.KeyCode;if("mousemove"===evType){this.reactPointerMoving(e);var coord=this.getEventMouseRelCoord(e),cursor=this.testMouseCursor(coord,e);Kekule.ObjUtils.notUnset(cursor)&&this.getElement()&&(this.setCursor(cursor),handled=!0)}else if("touchmove"===evType)this.reactPointerMoving(e),handled=!0;else if("focus"===evType)eventOnSelf&&e.getTarget()===this.getCoreElement()&&(this.setIsFocused(!0),handled=!0);else if("blur"===evType){if(eventOnSelf&&e.getTarget()==this.getCoreElement()){var currFocusElem=this.getDocument().activeElement,elem=this.getElement();currFocusElem&&(Kekule.DomUtils.isDescendantOf(currFocusElem,elem)||currFocusElem===elem)||this.setIsFocused(!1),handled=!0}}else if("mouseover"===evType)this.setIsHover(!0),handled=!0;else if("mouseout"===evType||"touchleave"===evType){if(!e.ghostMouseEvent){var relatedTarget=e.getRelatedTarget();relatedTarget&&Kekule.DomUtils.isOrIsDescendantOf(relatedTarget,this.getCoreElement())||(this.setIsHover(!1),this.isCaptureMouse()||(this.reactDeactiviting(e),handled=!0))}}else"mousedown"===evType&&e.getButton()===Kekule.X.Event.MouseButton.LEFT||"touchstart"===evType?(eventOnSelf&&!e.ghostMouseEvent&&this.reactActiviting(e),handled=!0):"mouseup"===evType&&e.getButton()===Kekule.X.Event.MouseButton.LEFT||"touchend"===evType||"touchcancel"===evType?(eventOnSelf&&!e.ghostMouseEvent&&this.reactDeactiviting(e),handled=!0):"keydown"===evType?(keyCode=e.getKeyCode())!==KC.ENTER&&keyCode!==KC.SPACE||(eventOnSelf&&!this.getIsActive()&&this.reactActiviting(e),handled=!0):"keyup"===evType&&((keyCode=e.getKeyCode())!==KC.ENTER&&keyCode!==KC.SPACE||(eventOnSelf&&this.getIsActive()&&this.reactDeactiviting(e),handled=!0));var funcName=Kekule.Widget.getEventHandleFuncName(e.getType());handled=this[funcName]?this[funcName](e):this.dispatchEventToIaControllers(e)||handled,this.doReactUiEvent(e),this.invokeEvent(evType,{htmlEvent:e})}else e.stopPropagation();if(this.getActualBubbleUiEvents()){var parent=this.getParent();parent&&parent.reactUiEvent&&parent.reactUiEvent(e)}},doReactUiEvent:function(e){},reactTouchGesture:function(e){var funcName=Kekule.Widget.getTouchGestureHandleFuncName(e.getType());this[funcName]?this[funcName](e):this.dispatchEventToIaControllers(e)},reactActiviting:function(e){this.getIsActive()||(this.setIsActive(!0),this.doReactActiviting(e),this.invokeEvent("activate",{widget:this}))},doReactActiviting:function(e){},reactDeactiviting:function(e){this.getIsActive()&&(this.doReactDeactiviting(e),this.invokeEvent("deactivate",{widget:this}),this.setIsActive(!1))},doReactDeactiviting:function(e){},reactPointerMoving:function(e){this.doReactPointerMoving(e)},doReactPointerMoving:function(e){},dispatchEventToIaControllers:function(e){var handled=!1,controller=this.getActiveIaController();return controller&&(handled=controller.handleUiEvent(e)),handled||(controller=this.getDefIaController())&&(handled=controller.handleUiEvent(e)),handled},getEventMouseRelCoord:function(e,relElement){relElement||(relElement=this.getCoreElement());var coord={x:e.getClientX(),y:e.getClientY()},offset={x:relElement.getBoundingClientRect().left-relElement.scrollLeft,y:relElement.getBoundingClientRect().top-relElement.scrollTop};return Kekule.CoordUtils.substract(coord,offset)},testMouseCursor:function(coord,e){var result=this.doTestMouseCursor(coord,e);if(!result){var controller=this.getActiveIaController();controller&&(result=controller.testMouseCursor(coord,e)),result||(controller=this.getDefIaController())&&(result=controller.testMouseCursor(coord,e))}return result},doTestMouseCursor:function(coord,e){return null},setMouseCapture:function(capture){capture?Kekule.Widget.globalManager.setMouseCaptureWidget(this):this.isCaptureMouse()&&Kekule.Widget.globalManager.setMouseCaptureWidget(null)},isCaptureMouse:function(){return Kekule.Widget.globalManager.getMouseCaptureWidget()===this},addIaController:function(id,controller,asDefault){this.getIaControllerMap().set(id,controller),asDefault&&this.setDefIaControllerId(id),controller&&controller.setWidget(this)},removeIaController:function(id){var controller=this.getIaControllerMap().get(id);controller&&(this.getIaControllerMap().remove(id),id===this.getDefIaControllerId()&&this.setDefIaControllerId(null),id===this.getActiveIaControllerId()&&this.setActiveIaControllerId(null),controller.setWidget(null))},getIaController:function(id){return this.getIaControllerMap().get(id)},execute:function(invokerHtmlEvent){this.doExecute(invokerHtmlEvent),this.invokeEvent("execute",{widget:this,htmlEvent:invokerHtmlEvent})},doExecute:function(invokerHtmlEvent){},isPeriodicalExecuting:function(){return this._periodicalExecBind},startPeriodicalExec:function(htmlEvent){var delay=this.getPeriodicalExecDelay()||0;this._periodicalExecuting=!0,this._periodicalExecHtmlEvent=htmlEvent,setTimeout(this._periodicalExecBind,delay)},stopPeriodicalExec:function(){this._periodicalExecuting=!1,this._periodicalExecHtmlEvent=null},_periodicalExec:function(interval){this.isPeriodicalExecuting()&&(this._waitPeriodicalProcess||(this._waitPeriodicalProcess=!0,this.execute(this._periodicalExecHtmlEvent),this._waitPeriodicalProcess=!1),setTimeout(this._periodicalExecBind,this.getPeriodicalExecInterval()||20))}}),Kekule.Widget.InteractionController=Class.create(ObjectEx,{CLASS_NAME:"Kekule.Widget.InteractionController",initialize:function($super,widget){$super(),widget&&this.setWidget(widget)},doFinalize:function($super){this.setWidget(null),$super()},initProperties:function(){this.defineProp("widget",{dataType:"Kekule.Widget.BaseWidget",serializable:!1})},handleUiEvent:function(e){var eventName=e.getType(),funcName=Kekule.Widget.getEventHandleFuncName(eventName);return!!this[funcName]&&this[funcName](e)},_defEventHandler:function(e){return!1},testMouseCursor:function(coord,e){return this.doTestMouseCursor(coord,e)},doTestMouseCursor:function(coord,e){return null},_getEventMouseCoord:function(e,clientElem){var coord={x:e.getClientX(),y:e.getClientY()},elem=clientElem||this.getWidget().getElement(),offset={x:elem.getBoundingClientRect().left-elem.scrollLeft,y:elem.getBoundingClientRect().top-elem.scrollTop};return Kekule.CoordUtils.substract(coord,offset)}}),Kekule.Widget.DumbWidget=Class.create(Kekule.Widget.BaseWidget,{CLASS_NAME:"Kekule.Widget.DumbWidget",initialize:function($super,parentOrElementOrDocument){$super(parentOrElementOrDocument,!0)},doGetWidgetClassName:function($super){return $super()+" "+CNS.DUMB_WIDGET},doCreateRootElement:function(doc){return doc.createElement("span")}}),Kekule.Widget.PlaceHolder=Class.create(Kekule.Widget.BaseWidget,{CLASS_NAME:"Kekule.Widget.PlaceHolder",initialize:function($super,parentOrElementOrDocument,targetWidgetClass){this.setPropStoreFieldValue("targetWidgetClass",targetWidgetClass),$super(parentOrElementOrDocument,!0)},initProperties:function(){this.defineProp("targetWidgetClass",{dataType:DataType.CLASS,serializable:!1,getter:function(){var result=this.getPropStoreFieldValue("targetWidgetClass");if(!result){var name=this.getPropStoreFieldValue("targetWidgetClassName");name&&(result=ClassEx.findClass(name))}return result}}),this.defineProp("targetWidgetClassName",{dataType:DataType.STRING,getter:function(){var c=this.getTargetWidgetClass();return c?ClassEx.getClassName(c):this.getPropStoreFieldValue("targetWidgetClassName")},setter:function(value){this.setPropStoreFieldValue("targetWidgetClassName",value),this.setTargetWidgetClass(ClassEx.findClass(value))}}),this.defineProp("target",{dataType:DataType.STRING,getter:function(){return this.getTargetWidgetClassName()},setter:function(value){this.setTargetWidgetClassName(value)}}),this.defineProp("targetWidget",{dataType:"Kekule.Widget.BaseWidget",serializable:"false",setter:null,getter:function(){var result=this.getPropStoreFieldValue("targetWidget");return result||(result=this.createTargetWidget()),result}})},doGetWidgetClassName:function($super){var result=$super()+" "+CNS.PLACEHOLDER,targetClass=this.getTargetWidgetClass();if(targetClass){var targetHtmlClassName=ClassEx.getPrototype(targetClass).getWidgetClassName();result=Kekule.StrUtils.addTokens(result,targetHtmlClassName)}return result},doCreateRootElement:function(doc){return doc.createElement("img")},doReactUiEvent:function(e){this.createTargetWidget()},createTargetWidget:function(){var widgetClass=this.getTargetWidgetClass();if(widgetClass){try{var elem=this.getElement(),parentWidget=this.getParent();parentWidget&&parentWidget instanceof Kekule.Widget.PlaceHolder&&(parentWidget=parentWidget.createTargetWidget());var children=AU.clone(this.getChildWidgets());this.unbindElement(this.getElement()),this.setPropStoreFieldValue("element",null);var result=new widgetClass(elem);if(result){if(parentWidget){var refChild=this.getNextSibling();this.setParent(null),result.setPropStoreFieldValue("parent",parentWidget),parentWidget._insertChild(result,refChild)}if(children)for(var i=0,l=children.length;i<l;++i)children[i].setParent(result)}}finally{this.finalize()}return result}Kekule.error(Kekule.$L("ErrorMsg.WIDGET_UNAVAILABLE_FOR_PLACEHOLDER"))}}),Kekule.Widget.Utils={getWidgetOnElem:function(element,retainPlaceholder){var result=element.__$kekule_widget__;return!retainPlaceholder&&result instanceof Kekule.Widget.PlaceHolder&&(result=result.getTargetWidget()),result},getWidgetsInsideElem:function(element,checkElemInsideWidget){var result,widget=Kekule.Widget.Utils.getWidgetOnElem(element);if(result=widget?[widget]:[],!checkElemInsideWidget)return result;for(var childElems=Kekule.DomUtils.getDirectChildElems(element),i=0,l=childElems.length;i<l;++i){var elem=childElems[i],widgets=Kekule.Widget.Utils.getWidgetsInsideElem(elem,checkElemInsideWidget);result=result.concat(widgets)}return result},getWidgetById:function(id,doc){doc||(doc=document);var elem=doc.getElementById(id);return elem?Kekule.Widget.Utils.getWidgetOnElem(elem):void 0},getBelongedWidget:function(element){for(var result=null;element&&!result;)result=Kekule.Widget.Utils.getWidgetOnElem(element),element=element.parentNode;return result},getBelongedResponsiveWidget:function(element){for(var result=null;element&&!result;)result=Kekule.Widget.Utils.getWidgetOnElem(element),result&&result.getStatic()&&(result=null),element=element.parentNode;return result},createFromHash:function(parentOrElementOrDocument,defineObj){var specialFields=["widget","widgetClass","htmlClass","children"],wclass=defineObj.widgetClass||defineObj.widget;if("string"==typeof wclass&&(wclass=ClassEx.findClass(wclass)),!wclass)return Kekule.error(Kekule.$L("ErrorMsg.WIDGET_CLASS_NOT_FOUND")),null;var result=new wclass(parentOrElementOrDocument),fields=Kekule.ObjUtils.getOwnedFieldNames(defineObj,!0);fields=Kekule.ArrayUtils.exclude(fields,specialFields);for(var i=0,l=fields.length;i<l;++i){var field=fields[i],value=defineObj[field];if(field.startsWith("#")&&DataType.isFunctionValue(value)){var eventName=field.substr(1);result.addEventListener(eventName,value)}else result.hasProperty(field)&&result.setPropValue(field,value)}if(defineObj.htmlClass&&result.addClassName(defineObj.htmlClass,!0),defineObj.children){var childDefs=defineObj.children;if(DataType.isArrayValue(childDefs))for(var i=0,l=childDefs.length;i<l;++i){var def=childDefs[i],child=Kekule.Widget.Utils.createFromHash(result,def);child&&child.appendToWidget(result)}}return result},setWidgetPropFromElemAttrib:function(widget,attribName,attribValue){var propName=attribName.camelize(),dtype=widget.getPropertyDataType(propName);if(dtype)if(dtype===DataType.STRING)widget.setPropValue(propName,attribValue);else if(Kekule.PredefinedResReferer.isResValue(attribValue))Kekule.PredefinedResReferer.loadResource(attribValue,function(resInfo,success){widget.loadPredefinedResDataToProp&&widget.loadPredefinedResDataToProp(propName,resInfo,success)},null,widget.getDocument());else if(attribValue.startsWith("#")&&ClassEx.isOrIsDescendantOf(ClassEx.findClass(dtype),Kekule.Widget.BaseWidget)){var id=attribValue.substr(1).trim();Kekule.Widget.Utils._setWidgetRefPropFromId(widget,propName,id)}else{var value=JSON.parse(attribValue);if(Kekule.ObjUtils.notUnset(value)){var obj=ObjSerializerFactory.getSerializer("json").load(null,value);widget.setPropValue(propName,obj)}}},_setWidgetRefPropFromId:function(widget,propName,id){if(id){var refWidget=Kekule.Widget.getWidgetById(id,widget.getDocument());refWidget&&widget.setPropValue(propName,refWidget)}}},Kekule.Widget.getWidgetOnElem=Kekule.Widget.Utils.getWidgetOnElem,Kekule.Widget.getWidgetById=Kekule.Widget.Utils.getWidgetById,Kekule.$W=Kekule.Widget.Utils.getWidgetById,Kekule.Widget.getBelongedWidget=Kekule.Widget.Utils.getBelongedWidget,Kekule.Widget.createFromHash=Kekule.Widget.Utils.createFromHash,Kekule.Widget.GlobalManager=Class.create(ObjectEx,{CLASS_NAME:"Kekule.Widget.GlobalManager",INFO_FIELD:"__$info__",initialize:function($super,doc){$super(),this._document=doc||Kekule.$document,this._hammertime=null,this.setPropStoreFieldValue("popupWidgets",[]),this.setPropStoreFieldValue("dialogWidgets",[]),this.setPropStoreFieldValue("modalWidgets",[]),this.setPropStoreFieldValue("widgets",[]),this.setPropStoreFieldValue("preserveWidgetList",!0),this.reactTouchGestureBind=this.reactTouchGesture.bind(this),Kekule.X.domReady(this.domReadyInit.bind(this))},finalize:function($super){this.uninstallGlobalDomMutationHandlers(this._document.documentElement),this.uninstallGlobalEventHandlers(this._document.documentElement),this._hammertime=null,this.setPropStoreFieldValue("popupWidgets",null),this.setPropStoreFieldValue("widgets",null),$super()},initProperties:function(){this.defineProp("mouseCaptureWidget",{dataType:DataType.OBJECT,serializable:!1}),this.defineProp("popupWidgets",{dataType:DataType.ARRAY,serializable:!1}),this.defineProp("dialogWidgets",{dataType:DataType.ARRAY,serializable:!1}),this.defineProp("modalWidgets",{dataType:DataType.ARRAY,serializable:!1}),this.defineProp("preserveWidgetList",{dataType:DataType.BOOL,serializable:!1,setter:function(value){this.setPropStoreFieldValue("preserveWidgetList",value),value||this.setPropStoreFieldValue("widgets",[])}}),this.defineProp("widgets",{dataType:DataType.ARRAY,serializable:!1,setter:null}),this.defineProp("currActiveWidget",{dataType:"Kekule.Widget.BaseWidget",serializable:!1}),this.defineProp("currFocusedWidget",{dataType:"Kekule.Widget.BaseWidget",serializable:!1}),this.defineProp("modalBackgroundElem",{dataType:DataType.OBJECT,serializable:!1,setter:null})},domReadyInit:function(){this.installGlobalEventHandlers(this._document.documentElement),this.installGlobalDomMutationHandlers(this._document.documentElement)},notifyWidgetCreated:function(widget){this.getPreserveWidgetList()&&this.getWidgets().push(widget),this.invokeEvent("widgetCreate",{widget:widget})},notifyWidgetFinalized:function(widget){this.getWidgets()&&Kekule.ArrayUtils.remove(this.getWidgets(),widget),this.getPopupWidgets()&&Kekule.ArrayUtils.remove(this.getPopupWidgets(),widget),this.getDialogWidgets()&&Kekule.ArrayUtils.remove(this.getDialogWidgets(),widget),widget===this.getCurrActiveWidget()&&this.setCurrActiveWidget(null),widget===this.getCurrFocusedWidget()&&this.setCurrFocusedWidget(null),this.invokeEvent("widgetFinalize",{widget:widget})},notifyWidgetActiveChanged:function(widget,active){var oldWidget=this.getCurrActiveWidget();active?widget!==oldWidget&&(oldWidget&&oldWidget.setIsActive(!1),this.setCurrActiveWidget(widget)):oldWidget===widget&&this.setCurrActiveWidget(null)},notifyWidgetFocusChanged:function(widget,focused){var oldWidget=this.getCurrFocusedWidget();focused?widget!==oldWidget&&(oldWidget&&oldWidget.setIsFocused(!1),this.setCurrFocusedWidget(widget)):oldWidget===widget&&this.setCurrFocusedWidget(null)},hasPopupWidgets:function(){return!!this.getPopupWidgets().length},hasDialogWidgets:function(){return!!this.getDialogWidgets().length},getBelongedResponsiveWidget:function(element){return Kekule.Widget.Utils.getBelongedResponsiveWidget(element)},notifyWidgetEventFired:function(widget,eventName,event){var e=Object.extend({},event);e.widget=widget,this.invokeEvent(eventName,e)},installGlobalEventHandlers:function(target){if(!this._globalEventInstalled){for(var events=Kekule.Widget.UiEvents,i=0,l=events.length;i<l;++i)Kekule.X.Event.addListener(target,events[i],this.reactUiEventBind);this._globalEventInstalled=!0}},uninstallGlobalEventHandlers:function(target){for(var events=Kekule.Widget.UiEvents,i=0,l=events.length;i<l;++i)Kekule.X.Event.removeListener(target,events[i],this.reactUiEventBind)},installGlobalTouchHandlers:function(target){return Hammer(target).on(Kekule.Widget.TouchGestures.join(" "),this.reactTouchGestureBind)},uninstallGlobalTouchHandlers:function(target){this._hammertime&&this._hammertime.off(Kekule.Widget.TouchGestures.join(" "),this.reactTouchGestureBind)},installGlobalDomMutationHandlers:function(target){var self=this;if(Kekule.X.MutationObserver){var observer=new Kekule.X.MutationObserver(function(mutations){for(var i=0,l=mutations.length;i<l;++i){var m=mutations[i];if("childList"===m.type){for(var nodes=m.addedNodes,j=0,k=nodes.length;j<k;++j){var node=nodes[j];node.nodeType===Node.ELEMENT_NODE&&self._handleDomAddedElem(node)}for(var nodes=m.removedNodes,j=0,k=nodes.length;j<k;++j){var node=nodes[j];node.nodeType===Node.ELEMENT_NODE&&self._handleDomRemovedElem(node)}}}});observer.observe(target,{childList:!0,subtree:!0}),this._domMutationObserver=observer}else this._reactDomNodeInserted=function(e){var target=e.getTarget();target.nodeType===Node.ELEMENT_NODE&&self._handleDomAddedElem(target)},this._reactDomNodeRemoved=function(e){var target=e.getTarget();target.nodeType===Node.ELEMENT_NODE&&self._handleDomRemovedElem(target)},Kekule.X.Event.addListener(target,"DOMNodeInserted",this._reactDomNodeInserted),Kekule.X.Event.addListener(target,"DOMNodeRemoved",this._reactDomNodeRemoved)},uninstallGlobalDomMutationHandlers:function(target){this._domMutationObserver&&this._domMutationObserver.disconnect(),this._reactDomNodeInserted&&Kekule.X.Event.removeListener(target,"DOMNodeInserted",this._reactDomNodeInserted),this._reactDomNodeRemoved&&Kekule.X.Event.removeListener(target,"DOMNodeRemoved",this._reactDomNodeRemoved)},_handleDomAddedElem:function(elem){for(var widgets=Kekule.Widget.Utils.getWidgetsInsideElem(elem,!0),i=0,l=widgets.length;i<l;++i){var w=widgets[i];w.insertedToDom()}var w=Kekule.Widget.Utils.getBelongedWidget(elem);w&&w.domElemAdded(elem)},_handleDomRemovedElem:function(elem){for(var widgets=Kekule.Widget.Utils.getWidgetsInsideElem(elem,!0),i=0,l=widgets.length;i<l;++i){var w=widgets[i];w.removedFromDom()}var w=Kekule.Widget.Utils.getBelongedWidget(elem);w&&w.domElemRemoved(elem)},isMouseEvent:function(eventName){return eventName.startsWith("mouse")||"click"===eventName},isTouchEvent:function(eventName){return eventName.startsWith("touch")},reactUiEvent:function(e){var targetWidget,evType=e.getType();if(this.getMouseCaptureWidget()&&(this.isMouseEvent(evType)||this.isTouchEvent(evType)))targetWidget=this.getMouseCaptureWidget(),!0;else{var elem=e.getTarget();targetWidget=this.getBelongedResponsiveWidget(elem)}if("touchstart"===evType||"touchend"===evType){this._touchJustStart=!0;var self=this;setTimeout(function(){self._touchJustStart=!1},500)}else["mousedown","mouseup","mouseout","click"].indexOf(evType)>=0&&this._touchJustStart&&(e.ghostMouseEvent=!0);var funcName=Kekule.Widget.getEventHandleFuncName(e.getType());this[funcName]&&this[funcName](e),targetWidget&&targetWidget.reactUiEvent(e)},reactTouchGesture:function(e){var funcName=Kekule.Widget.getTouchGestureHandleFuncName(e.getType());this[funcName]&&this[funcName](e);var widget=Kekule.Widget.getBelongedWidget(e.target);widget&&widget.reactTouchGesture(e)},react_mousedown:function(e){if(this.hasPopupWidgets()&&!e.ghostMouseEvent){var elem=e.getTarget();this.hidePopupWidgets(elem)}},react_keydown:function(e){e.getKeyCode()===Kekule.X.Event.KeyCode.ESC&&(this.hasPopupWidgets()?this.hidePopupWidgets(null,!0):this.hasDialogWidgets()&&this.hideTopmostDialogWidget(null,!0))},react_touchstart:function(e){if(this.hasPopupWidgets()){var elem=e.getTarget();this.hidePopupWidgets(elem)}},unpreparePopupWidget:function(widget){widget.setPopupCaller(null),this.restoreElem(widget.getElement())},preparePopupWidget:function(popupWidget,invokerWidget,showType){popupWidget.setPopupCaller(invokerWidget);var posInfo,popupElem=popupWidget.getElement(),doc=popupElem.ownerDocument,topmostLayer=this.getTopmostLayer(doc,!0),isOnTopLayer=popupElem.parentNode===topmostLayer,ST=Kekule.Widget.ShowHideType;if(showType===ST.DROPDOWN&&invokerWidget?posInfo=this._calcDropDownWidgetPosInfo(popupWidget,invokerWidget):isOnTopLayer||(posInfo=this._calcPopupWidgetPosInfo(popupWidget)),isOnTopLayer||this.moveElemToTopmostLayer(popupElem),posInfo){var stylePropNames=["left","top","right","bottom","width","height"],oldStyle={},style=popupElem.style;style.position="absolute";for(var i=0,l=stylePropNames.length;i<l;++i){var name=stylePropNames[i],value=posInfo[name];value&&(oldStyle[name]=style[name]||"",style[name]=value)}this._getElemStoredInfo(popupElem).styles=oldStyle}},_calcPopupWidgetPosInfo:function(widget){var EU=Kekule.HtmlElementUtils,elem=widget.getElement();widget.isShown()||(elem.style.visible="hidden",elem.style.display="");var clientRect=EU.getElemBoundingClientRect(elem);return{top:clientRect.top+"px",left:clientRect.left+"px"}},_calcDropDownWidgetPosInfo:function(dropDownWidget,invokerWidget){var EU=Kekule.HtmlElementUtils,D=Kekule.Widget.Position,pos=invokerWidget.getDropPosition?invokerWidget.getDropPosition():null,p=invokerWidget.getParent(),layout=p&&p.getLayout()||Kekule.Widget.Layout.HORIZONTAL,invokerElem=invokerWidget.getElement(),invokerClientRect=EU.getElemBoundingClientRect(invokerElem),viewPortDim=EU.getViewportDimension(invokerElem),dropElem=dropDownWidget.getElement();dropElem.style.visible="hidden",dropElem.style.display="";var manualAppended=!1,topmostLayer=this.getTopmostLayer(dropElem.ownerDocument);dropElem.parentNode||(topmostLayer.appendChild(dropElem),manualAppended=!0),dropElem.style.position="relative";var dropOffsetDim=EU.getElemOffsetDimension(dropElem),dropScrollDim=EU.getElemScrollDimension(dropElem),dropClientRect=EU.getElemBoundingClientRect(dropElem);if(dropElem.style.position="absolute",manualAppended&&topmostLayer.removeChild(dropElem),!pos||pos===D.AUTO)if(pos=0,layout===Kekule.Widget.Layout.VERTICAL){var left=invokerClientRect.x,right=viewPortDim.width-left-invokerClientRect.width;right>=dropOffsetDim.width?pos|=D.RIGHT:pos|=left>right?D.LEFT:D.RIGHT}else{var top=invokerClientRect.y,bottom=viewPortDim.height-top-invokerClientRect.height;bottom>=dropOffsetDim.height?pos|=D.BOTTOM:pos|=top>bottom?D.TOP:D.BOTTOM}var x,SU=Kekule.StyleUtils,invokerClientRect=EU.getElemBoundingClientRect(invokerElem,!0),w=SU.getComputedStyle(dropElem,"width")||dropScrollDim.width,h=SU.getComputedStyle(dropElem,"height")||dropScrollDim.height;if(pos&D.LEFT)x=invokerClientRect.left-dropClientRect.width;else if(pos&D.RIGHT)x=invokerClientRect.right;else{var rightDistance=(viewPortDim.width,invokerClientRect.right,viewPortDim.width-invokerClientRect.left);x=rightDistance>=dropClientRect.width?invokerClientRect.left:invokerClientRect.right-dropClientRect.width}var y;if(pos&D.TOP)y=invokerClientRect.top-dropClientRect.height;else if(pos&D.BOTTOM)y=invokerClientRect.bottom;else{var bottomDistance=(viewPortDim.height,invokerClientRect.bottom,viewPortDim.height-invokerClientRect.top);y=bottomDistance>=dropClientRect.height?invokerClientRect.bottom:invokerClientRect.bottom-dropClientRect.height}x+="px",y+="px",w+="px",h+="px";var result={};return result.left=x,result.top=y,result.width=w,result.height=h,result},hidePopupWidgets:function(activateElement,isDismissed){for(var widgets=this.getPopupWidgets(),activateWidget=Kekule.Widget.getBelongedWidget(activateElement),activateWidgetCaller=activateWidget?activateWidget.getPopupCaller():null,activateWidgetCallerElem=activateWidgetCaller?activateWidgetCaller.getElement():null,i=widgets.length-1;i>=0;--i){var widget=widgets[i],elem=widget.getElement();if(elem){if(elem===activateWidgetCallerElem||Kekule.DomUtils.isDescendantOf(activateWidgetCallerElem,elem))continue;activateElement&&(elem===activateElement||Kekule.DomUtils.isDescendantOf(activateElement,elem))||(isDismissed?widget.dismiss():widget.hide())}else Kekule.ArrayUtils.remove(this.getPopupWidgets(),widget)}},hideTopmostDialogWidget:function(activateElement,isDismissed){var widgets=this.getDialogWidgets()||[],w=widgets[widgets.length-1];if(w){w.getElement()?isDismissed?w.dismiss():w.hide():Kekule.ArrayUtils.remove(this.geDialogWidgets(),w)}},registerPopupWidget:function(widget){widget.addClassName(CNS.SHOW_POPUP),Kekule.ArrayUtils.pushUnique(this.getPopupWidgets(),widget)},unregisterPopupWidget:function(widget){widget.removeClassName(CNS.SHOW_POPUP),Kekule.ArrayUtils.remove(this.getPopupWidgets(),widget)},registerDialogWidget:function(widget){widget.addClassName(CNS.SHOW_DIALOG),Kekule.ArrayUtils.pushUnique(this.getDialogWidgets(),widget)},unregisterDialogWidget:function(widget){widget.removeClassName(CNS.SHOW_DIALOG),Kekule.ArrayUtils.remove(this.getDialogWidgets(),widget)},registerModalWidget:function(widget){var prevModal=this.getCurrModalWidget();prevModal&&prevModal.removeClassName(CNS.SHOW_ACTIVE_MODAL),Kekule.ArrayUtils.pushUnique(this.getModalWidgets(),widget),widget.addClassName(CNS.SHOW_ACTIVE_MODAL)},unregisterModalWidget:function(widget){widget.removeClassName(CNS.SHOW_ACTIVE_MODAL),Kekule.ArrayUtils.remove(this.getModalWidgets(),widget);var prevModal=this.getCurrModalWidget();prevModal&&prevModal.addClassName(CNS.SHOW_ACTIVE_MODAL)},getCurrModalWidget:function(){var remainingModalWidgets=this.getModalWidgets();return remainingModalWidgets&&remainingModalWidgets.length?remainingModalWidgets[0]:null},prepareModalWidget:function(widget){var doc=widget.getDocument(),bgElem=this.getModalBackgroundElem();bgElem||(bgElem=doc.createElement("div"),bgElem.className=CNS.MODAL_BACKGROUND,this.setPropStoreFieldValue("modalBackgroundElem",bgElem));var elem=widget.getElement();widget.setModalInfo({oldParent:elem.parentNode,oldSibling:elem.nextSibling}),elem.parentNode&&elem.parentNode.removeChild(elem),bgElem.parentNode&&bgElem.parentNode.removeChild(bgElem),doc.body.appendChild(bgElem),doc.body.appendChild(elem),this.registerModalWidget(widget)},unprepareModalWidget:function(widget){widget.getDocument();this.unregisterModalWidget(widget);var parentElem=widget.getElement().parentNode;parentElem&&parentElem.removeChild(widget.getElement());var modalInfo=widget.getModalInfo();modalInfo&&(modalInfo.oldParent&&modalInfo.oldParent.insertBefore(widget.getElement(),modalInfo.oldSibling),widget.setModalInfo(null));var remainActiveModalWidget=this.getCurrModalWidget(),bgElem=this.getModalBackgroundElem();if(bgElem)if(remainActiveModalWidget){bgElem.parentNode&&bgElem.parentNode.removeChild(bgElem);var parentNode=remainActiveModalWidget.getElement().parentNode;parentNode.insertBefore(bgElem,remainActiveModalWidget.getElement())}else bgElem.parentNode&&bgElem.parentNode.removeChild(bgElem)},getTopmostLayer:function(doc,canCreate){return doc.body},_getElemStoredInfo:function(elem){var result=null;return elem&&((result=elem[this.INFO_FIELD])||(result={},elem[this.INFO_FIELD]=result)),result},_clearElemStoredInfo:function(elem){elem[this.INFO_FIELD]&&(elem[this.INFO_FIELD]=void 0)},moveElemToTopmostLayer:function(elem){var info=this._getElemStoredInfo(elem);info.parentElem=elem.parentNode,info.nextSibling=elem.nextSibling,this.getTopmostLayer(elem.ownerDocument).appendChild(elem)},restoreElem:function(elem){if(elem){var info=this._getElemStoredInfo(elem);if(info){for(var oldStyles=info.styles,names=Kekule.ObjUtils.getOwnedFieldNames(oldStyles),style=elem.style,i=0,l=names.length;i<l;++i){var name=names[i],value=oldStyles[name];value?style[name]=value:Kekule.StyleUtils.removeStyleProperty(style,name)}info.parentElem&&(info.nextSibling?info.parentElem.insertBefore(elem,info.nextSibling):info.parentElem.appendChild(elem)),elem[this.INFO_FIELD]=null}}}}),Kekule.ClassUtils.makeSingleton(Kekule.Widget.GlobalManager),Kekule.Widget.globalManager=Kekule.Widget.GlobalManager.getInstance(),Kekule}},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_RESULT__;/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */
!function(window,document,exportName,undefined){"use strict";function setTimeoutContext(fn,timeout,context){return setTimeout(bindFn(fn,context),timeout)}function invokeArrayArg(arg,fn,context){return!!Array.isArray(arg)&&(each(arg,context[fn],context),!0)}function each(obj,iterator,context){var i;if(obj)if(obj.forEach)obj.forEach(iterator,context);else if(obj.length!==undefined)for(i=0;i<obj.length;)iterator.call(context,obj[i],i,obj),i++;else for(i in obj)obj.hasOwnProperty(i)&&iterator.call(context,obj[i],i,obj)}function deprecate(method,name,message){var deprecationMessage="DEPRECATED METHOD: "+name+"\n"+message+" AT \n";return function(){var e=new Error("get-stack-trace"),stack=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",log=window.console&&(window.console.warn||window.console.log);return log&&log.call(window.console,deprecationMessage,stack),method.apply(this,arguments)}}function inherit(child,base,properties){var childP,baseP=base.prototype;childP=child.prototype=Object.create(baseP),childP.constructor=child,childP._super=baseP,properties&&assign(childP,properties)}function bindFn(fn,context){return function(){return fn.apply(context,arguments)}}function boolOrFn(val,args){return typeof val==TYPE_FUNCTION?val.apply(args?args[0]||undefined:undefined,args):val}function ifUndefined(val1,val2){return val1===undefined?val2:val1}function addEventListeners(target,types,handler){each(splitStr(types),function(type){target.addEventListener(type,handler,!1)})}function removeEventListeners(target,types,handler){each(splitStr(types),function(type){target.removeEventListener(type,handler,!1)})}function hasParent(node,parent){for(;node;){if(node==parent)return!0;node=node.parentNode}return!1}function inStr(str,find){return str.indexOf(find)>-1}function splitStr(str){return str.trim().split(/\s+/g)}function inArray(src,find,findByKey){if(src.indexOf&&!findByKey)return src.indexOf(find);for(var i=0;i<src.length;){if(findByKey&&src[i][findByKey]==find||!findByKey&&src[i]===find)return i;i++}return-1}function toArray(obj){return Array.prototype.slice.call(obj,0)}function uniqueArray(src,key,sort){for(var results=[],values=[],i=0;i<src.length;){var val=key?src[i][key]:src[i];inArray(values,val)<0&&results.push(src[i]),values[i]=val,i++}return sort&&(results=key?results.sort(function(a,b){return a[key]>b[key]}):results.sort()),results}function prefixed(obj,property){for(var prefix,prop,camelProp=property[0].toUpperCase()+property.slice(1),i=0;i<VENDOR_PREFIXES.length;){if(prefix=VENDOR_PREFIXES[i],(prop=prefix?prefix+camelProp:property)in obj)return prop;i++}return undefined}function uniqueId(){return _uniqueId++}function getWindowForElement(element){var doc=element.ownerDocument||element;return doc.defaultView||doc.parentWindow||window}function Input(manager,callback){var self=this;this.manager=manager,this.callback=callback,this.element=manager.element,this.target=manager.options.inputTarget,this.domHandler=function(ev){boolOrFn(manager.options.enable,[manager])&&self.handler(ev)},this.init()}function createInputInstance(manager){var inputClass=manager.options.inputClass;return new(inputClass||(SUPPORT_POINTER_EVENTS?PointerEventInput:SUPPORT_ONLY_TOUCH?TouchInput:SUPPORT_TOUCH?TouchMouseInput:MouseInput))(manager,inputHandler)}function inputHandler(manager,eventType,input){var pointersLen=input.pointers.length,changedPointersLen=input.changedPointers.length,isFirst=eventType&INPUT_START&&pointersLen-changedPointersLen==0,isFinal=eventType&(INPUT_END|INPUT_CANCEL)&&pointersLen-changedPointersLen==0;input.isFirst=!!isFirst,input.isFinal=!!isFinal,isFirst&&(manager.session={}),input.eventType=eventType,computeInputData(manager,input),manager.emit("hammer.input",input),manager.recognize(input),manager.session.prevInput=input}function computeInputData(manager,input){var session=manager.session,pointers=input.pointers,pointersLength=pointers.length;session.firstInput||(session.firstInput=simpleCloneInputData(input)),pointersLength>1&&!session.firstMultiple?session.firstMultiple=simpleCloneInputData(input):1===pointersLength&&(session.firstMultiple=!1);var firstInput=session.firstInput,firstMultiple=session.firstMultiple,offsetCenter=firstMultiple?firstMultiple.center:firstInput.center,center=input.center=getCenter(pointers);input.timeStamp=now(),input.deltaTime=input.timeStamp-firstInput.timeStamp,input.angle=getAngle(offsetCenter,center),input.distance=getDistance(offsetCenter,center),computeDeltaXY(session,input),input.offsetDirection=getDirection(input.deltaX,input.deltaY);var overallVelocity=getVelocity(input.deltaTime,input.deltaX,input.deltaY);input.overallVelocityX=overallVelocity.x,input.overallVelocityY=overallVelocity.y,input.overallVelocity=abs(overallVelocity.x)>abs(overallVelocity.y)?overallVelocity.x:overallVelocity.y,input.scale=firstMultiple?getScale(firstMultiple.pointers,pointers):1,input.rotation=firstMultiple?getRotation(firstMultiple.pointers,pointers):0,input.maxPointers=session.prevInput?input.pointers.length>session.prevInput.maxPointers?input.pointers.length:session.prevInput.maxPointers:input.pointers.length,computeIntervalInputData(session,input);var target=manager.element;hasParent(input.srcEvent.target,target)&&(target=input.srcEvent.target),input.target=target}function computeDeltaXY(session,input){var center=input.center,offset=session.offsetDelta||{},prevDelta=session.prevDelta||{},prevInput=session.prevInput||{};input.eventType!==INPUT_START&&prevInput.eventType!==INPUT_END||(prevDelta=session.prevDelta={x:prevInput.deltaX||0,y:prevInput.deltaY||0},offset=session.offsetDelta={x:center.x,y:center.y}),input.deltaX=prevDelta.x+(center.x-offset.x),input.deltaY=prevDelta.y+(center.y-offset.y)}function computeIntervalInputData(session,input){var velocity,velocityX,velocityY,direction,last=session.lastInterval||input,deltaTime=input.timeStamp-last.timeStamp;if(input.eventType!=INPUT_CANCEL&&(deltaTime>COMPUTE_INTERVAL||last.velocity===undefined)){var deltaX=input.deltaX-last.deltaX,deltaY=input.deltaY-last.deltaY,v=getVelocity(deltaTime,deltaX,deltaY);velocityX=v.x,velocityY=v.y,velocity=abs(v.x)>abs(v.y)?v.x:v.y,direction=getDirection(deltaX,deltaY),session.lastInterval=input}else velocity=last.velocity,velocityX=last.velocityX,velocityY=last.velocityY,direction=last.direction;input.velocity=velocity,input.velocityX=velocityX,input.velocityY=velocityY,input.direction=direction}function simpleCloneInputData(input){for(var pointers=[],i=0;i<input.pointers.length;)pointers[i]={clientX:round(input.pointers[i].clientX),clientY:round(input.pointers[i].clientY)},i++;return{timeStamp:now(),pointers:pointers,center:getCenter(pointers),deltaX:input.deltaX,deltaY:input.deltaY}}function getCenter(pointers){var pointersLength=pointers.length;if(1===pointersLength)return{x:round(pointers[0].clientX),y:round(pointers[0].clientY)};for(var x=0,y=0,i=0;i<pointersLength;)x+=pointers[i].clientX,y+=pointers[i].clientY,i++;return{x:round(x/pointersLength),y:round(y/pointersLength)}}function getVelocity(deltaTime,x,y){return{x:x/deltaTime||0,y:y/deltaTime||0}}function getDirection(x,y){return x===y?DIRECTION_NONE:abs(x)>=abs(y)?x<0?DIRECTION_LEFT:DIRECTION_RIGHT:y<0?DIRECTION_UP:DIRECTION_DOWN}function getDistance(p1,p2,props){props||(props=PROPS_XY);var x=p2[props[0]]-p1[props[0]],y=p2[props[1]]-p1[props[1]];return Math.sqrt(x*x+y*y)}function getAngle(p1,p2,props){props||(props=PROPS_XY);var x=p2[props[0]]-p1[props[0]],y=p2[props[1]]-p1[props[1]];return 180*Math.atan2(y,x)/Math.PI}function getRotation(start,end){return getAngle(end[1],end[0],PROPS_CLIENT_XY)+getAngle(start[1],start[0],PROPS_CLIENT_XY)}function getScale(start,end){return getDistance(end[0],end[1],PROPS_CLIENT_XY)/getDistance(start[0],start[1],PROPS_CLIENT_XY)}function MouseInput(){this.evEl=MOUSE_ELEMENT_EVENTS,this.evWin=MOUSE_WINDOW_EVENTS,this.pressed=!1,Input.apply(this,arguments)}function PointerEventInput(){this.evEl=POINTER_ELEMENT_EVENTS,this.evWin=POINTER_WINDOW_EVENTS,Input.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function SingleTouchInput(){this.evTarget=SINGLE_TOUCH_TARGET_EVENTS,this.evWin=SINGLE_TOUCH_WINDOW_EVENTS,this.started=!1,Input.apply(this,arguments)}function normalizeSingleTouches(ev,type){var all=toArray(ev.touches),changed=toArray(ev.changedTouches);return type&(INPUT_END|INPUT_CANCEL)&&(all=uniqueArray(all.concat(changed),"identifier",!0)),[all,changed]}function TouchInput(){this.evTarget=TOUCH_TARGET_EVENTS,this.targetIds={},Input.apply(this,arguments)}function getTouches(ev,type){var allTouches=toArray(ev.touches),targetIds=this.targetIds;if(type&(INPUT_START|INPUT_MOVE)&&1===allTouches.length)return targetIds[allTouches[0].identifier]=!0,[allTouches,allTouches];var i,targetTouches,changedTouches=toArray(ev.changedTouches),changedTargetTouches=[],target=this.target;if(targetTouches=allTouches.filter(function(touch){return hasParent(touch.target,target)}),type===INPUT_START)for(i=0;i<targetTouches.length;)targetIds[targetTouches[i].identifier]=!0,i++;for(i=0;i<changedTouches.length;)targetIds[changedTouches[i].identifier]&&changedTargetTouches.push(changedTouches[i]),type&(INPUT_END|INPUT_CANCEL)&&delete targetIds[changedTouches[i].identifier],i++;return changedTargetTouches.length?[uniqueArray(targetTouches.concat(changedTargetTouches),"identifier",!0),changedTargetTouches]:void 0}function TouchMouseInput(){Input.apply(this,arguments);var handler=bindFn(this.handler,this);this.touch=new TouchInput(this.manager,handler),this.mouse=new MouseInput(this.manager,handler),this.primaryTouch=null,this.lastTouches=[]}function recordTouches(eventType,eventData){eventType&INPUT_START?(this.primaryTouch=eventData.changedPointers[0].identifier,setLastTouch.call(this,eventData)):eventType&(INPUT_END|INPUT_CANCEL)&&setLastTouch.call(this,eventData)}function setLastTouch(eventData){var touch=eventData.changedPointers[0];if(touch.identifier===this.primaryTouch){var lastTouch={x:touch.clientX,y:touch.clientY};this.lastTouches.push(lastTouch);var lts=this.lastTouches,removeLastTouch=function(){var i=lts.indexOf(lastTouch);i>-1&&lts.splice(i,1)};setTimeout(removeLastTouch,DEDUP_TIMEOUT)}}function isSyntheticEvent(eventData){for(var x=eventData.srcEvent.clientX,y=eventData.srcEvent.clientY,i=0;i<this.lastTouches.length;i++){var t=this.lastTouches[i],dx=Math.abs(x-t.x),dy=Math.abs(y-t.y);if(dx<=DEDUP_DISTANCE&&dy<=DEDUP_DISTANCE)return!0}return!1}function TouchAction(manager,value){this.manager=manager,this.set(value)}function cleanTouchActions(actions){if(inStr(actions,TOUCH_ACTION_NONE))return TOUCH_ACTION_NONE;var hasPanX=inStr(actions,TOUCH_ACTION_PAN_X),hasPanY=inStr(actions,TOUCH_ACTION_PAN_Y);return hasPanX&&hasPanY?TOUCH_ACTION_NONE:hasPanX||hasPanY?hasPanX?TOUCH_ACTION_PAN_X:TOUCH_ACTION_PAN_Y:inStr(actions,TOUCH_ACTION_MANIPULATION)?TOUCH_ACTION_MANIPULATION:TOUCH_ACTION_AUTO}function Recognizer(options){this.options=assign({},this.defaults,options||{}),this.id=uniqueId(),this.manager=null,this.options.enable=ifUndefined(this.options.enable,!0),this.state=STATE_POSSIBLE,this.simultaneous={},this.requireFail=[]}function stateStr(state){return state&STATE_CANCELLED?"cancel":state&STATE_ENDED?"end":state&STATE_CHANGED?"move":state&STATE_BEGAN?"start":""}function directionStr(direction){return direction==DIRECTION_DOWN?"down":direction==DIRECTION_UP?"up":direction==DIRECTION_LEFT?"left":direction==DIRECTION_RIGHT?"right":""}function getRecognizerByNameIfManager(otherRecognizer,recognizer){var manager=recognizer.manager;return manager?manager.get(otherRecognizer):otherRecognizer}function AttrRecognizer(){Recognizer.apply(this,arguments)}function PanRecognizer(){AttrRecognizer.apply(this,arguments),this.pX=null,this.pY=null}function PinchRecognizer(){AttrRecognizer.apply(this,arguments)}function PressRecognizer(){Recognizer.apply(this,arguments),this._timer=null,this._input=null}function RotateRecognizer(){AttrRecognizer.apply(this,arguments)}function SwipeRecognizer(){AttrRecognizer.apply(this,arguments)}function TapRecognizer(){Recognizer.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Hammer(element,options){return options=options||{},options.recognizers=ifUndefined(options.recognizers,Hammer.defaults.preset),new Manager(element,options)}function Manager(element,options){this.options=assign({},Hammer.defaults,options||{}),this.options.inputTarget=this.options.inputTarget||element,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=element,this.input=createInputInstance(this),this.touchAction=new TouchAction(this,this.options.touchAction),toggleCssProps(this,!0),each(this.options.recognizers,function(item){var recognizer=this.add(new item[0](item[1]));item[2]&&recognizer.recognizeWith(item[2]),item[3]&&recognizer.requireFailure(item[3])},this)}function toggleCssProps(manager,add){var element=manager.element;if(element.style){var prop;each(manager.options.cssProps,function(value,name){prop=prefixed(element.style,name),add?(manager.oldCssProps[prop]=element.style[prop],element.style[prop]=value):element.style[prop]=manager.oldCssProps[prop]||""}),add||(manager.oldCssProps={})}}function triggerDomEvent(event,data){var gestureEvent=document.createEvent("Event");gestureEvent.initEvent(event,!0,!0),gestureEvent.gesture=data,data.target.dispatchEvent(gestureEvent)}var assign,VENDOR_PREFIXES=["","webkit","Moz","MS","ms","o"],TEST_ELEMENT=document.createElement("div"),TYPE_FUNCTION="function",round=Math.round,abs=Math.abs,now=Date.now;assign="function"!=typeof Object.assign?function(target){if(target===undefined||null===target)throw new TypeError("Cannot convert undefined or null to object");for(var output=Object(target),index=1;index<arguments.length;index++){var source=arguments[index];if(source!==undefined&&null!==source)for(var nextKey in source)source.hasOwnProperty(nextKey)&&(output[nextKey]=source[nextKey])}return output}:Object.assign;var extend=deprecate(function(dest,src,merge){for(var keys=Object.keys(src),i=0;i<keys.length;)(!merge||merge&&dest[keys[i]]===undefined)&&(dest[keys[i]]=src[keys[i]]),i++;return dest},"extend","Use `assign`."),merge=deprecate(function(dest,src){return extend(dest,src,!0)},"merge","Use `assign`."),_uniqueId=1,MOBILE_REGEX=/mobile|tablet|ip(ad|hone|od)|android/i,SUPPORT_TOUCH="ontouchstart"in window,SUPPORT_POINTER_EVENTS=prefixed(window,"PointerEvent")!==undefined,SUPPORT_ONLY_TOUCH=SUPPORT_TOUCH&&MOBILE_REGEX.test(navigator.userAgent),COMPUTE_INTERVAL=25,INPUT_START=1,INPUT_MOVE=2,INPUT_END=4,INPUT_CANCEL=8,DIRECTION_NONE=1,DIRECTION_LEFT=2,DIRECTION_RIGHT=4,DIRECTION_UP=8,DIRECTION_DOWN=16,DIRECTION_HORIZONTAL=DIRECTION_LEFT|DIRECTION_RIGHT,DIRECTION_VERTICAL=DIRECTION_UP|DIRECTION_DOWN,DIRECTION_ALL=DIRECTION_HORIZONTAL|DIRECTION_VERTICAL,PROPS_XY=["x","y"],PROPS_CLIENT_XY=["clientX","clientY"];Input.prototype={handler:function(){},init:function(){this.evEl&&addEventListeners(this.element,this.evEl,this.domHandler),this.evTarget&&addEventListeners(this.target,this.evTarget,this.domHandler),this.evWin&&addEventListeners(getWindowForElement(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&removeEventListeners(this.element,this.evEl,this.domHandler),this.evTarget&&removeEventListeners(this.target,this.evTarget,this.domHandler),this.evWin&&removeEventListeners(getWindowForElement(this.element),this.evWin,this.domHandler)}};var MOUSE_INPUT_MAP={mousedown:INPUT_START,mousemove:INPUT_MOVE,mouseup:INPUT_END},MOUSE_ELEMENT_EVENTS="mousedown",MOUSE_WINDOW_EVENTS="mousemove mouseup";inherit(MouseInput,Input,{handler:function(ev){var eventType=MOUSE_INPUT_MAP[ev.type];eventType&INPUT_START&&0===ev.button&&(this.pressed=!0),eventType&INPUT_MOVE&&1!==ev.which&&(eventType=INPUT_END),this.pressed&&(eventType&INPUT_END&&(this.pressed=!1),this.callback(this.manager,eventType,{pointers:[ev],changedPointers:[ev],pointerType:"mouse",srcEvent:ev}))}});var POINTER_INPUT_MAP={pointerdown:INPUT_START,pointermove:INPUT_MOVE,pointerup:INPUT_END,pointercancel:INPUT_CANCEL,pointerout:INPUT_CANCEL},IE10_POINTER_TYPE_ENUM={2:"touch",3:"pen",4:"mouse",5:"kinect"},POINTER_ELEMENT_EVENTS="pointerdown",POINTER_WINDOW_EVENTS="pointermove pointerup pointercancel";window.MSPointerEvent&&!window.PointerEvent&&(POINTER_ELEMENT_EVENTS="MSPointerDown",POINTER_WINDOW_EVENTS="MSPointerMove MSPointerUp MSPointerCancel"),inherit(PointerEventInput,Input,{handler:function(ev){var store=this.store,removePointer=!1,eventTypeNormalized=ev.type.toLowerCase().replace("ms",""),eventType=POINTER_INPUT_MAP[eventTypeNormalized],pointerType=IE10_POINTER_TYPE_ENUM[ev.pointerType]||ev.pointerType,isTouch="touch"==pointerType,storeIndex=inArray(store,ev.pointerId,"pointerId");eventType&INPUT_START&&(0===ev.button||isTouch)?storeIndex<0&&(store.push(ev),storeIndex=store.length-1):eventType&(INPUT_END|INPUT_CANCEL)&&(removePointer=!0),storeIndex<0||(store[storeIndex]=ev,this.callback(this.manager,eventType,{pointers:store,changedPointers:[ev],pointerType:pointerType,srcEvent:ev}),removePointer&&store.splice(storeIndex,1))}});var SINGLE_TOUCH_INPUT_MAP={touchstart:INPUT_START,touchmove:INPUT_MOVE,touchend:INPUT_END,touchcancel:INPUT_CANCEL},SINGLE_TOUCH_TARGET_EVENTS="touchstart",SINGLE_TOUCH_WINDOW_EVENTS="touchstart touchmove touchend touchcancel";inherit(SingleTouchInput,Input,{handler:function(ev){var type=SINGLE_TOUCH_INPUT_MAP[ev.type];if(type===INPUT_START&&(this.started=!0),this.started){var touches=normalizeSingleTouches.call(this,ev,type);type&(INPUT_END|INPUT_CANCEL)&&touches[0].length-touches[1].length==0&&(this.started=!1),this.callback(this.manager,type,{pointers:touches[0],changedPointers:touches[1],pointerType:"touch",srcEvent:ev})}}});var TOUCH_INPUT_MAP={touchstart:INPUT_START,touchmove:INPUT_MOVE,touchend:INPUT_END,touchcancel:INPUT_CANCEL},TOUCH_TARGET_EVENTS="touchstart touchmove touchend touchcancel";inherit(TouchInput,Input,{handler:function(ev){var type=TOUCH_INPUT_MAP[ev.type],touches=getTouches.call(this,ev,type);touches&&this.callback(this.manager,type,{pointers:touches[0],changedPointers:touches[1],pointerType:"touch",srcEvent:ev})}});var DEDUP_TIMEOUT=2500,DEDUP_DISTANCE=25;inherit(TouchMouseInput,Input,{handler:function(manager,inputEvent,inputData){var isTouch="touch"==inputData.pointerType,isMouse="mouse"==inputData.pointerType;if(!(isMouse&&inputData.sourceCapabilities&&inputData.sourceCapabilities.firesTouchEvents)){if(isTouch)recordTouches.call(this,inputEvent,inputData);else if(isMouse&&isSyntheticEvent.call(this,inputData))return;this.callback(manager,inputEvent,inputData)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var PREFIXED_TOUCH_ACTION=prefixed(TEST_ELEMENT.style,"touchAction"),NATIVE_TOUCH_ACTION=PREFIXED_TOUCH_ACTION!==undefined,TOUCH_ACTION_AUTO="auto",TOUCH_ACTION_MANIPULATION="manipulation",TOUCH_ACTION_NONE="none",TOUCH_ACTION_PAN_X="pan-x",TOUCH_ACTION_PAN_Y="pan-y",TOUCH_ACTION_MAP=function(){if(!NATIVE_TOUCH_ACTION)return!1;var touchMap={},cssSupports=window.CSS&&window.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(val){touchMap[val]=!cssSupports||window.CSS.supports("touch-action",val)}),touchMap}();TouchAction.prototype={set:function(value){"compute"==value&&(value=this.compute()),NATIVE_TOUCH_ACTION&&this.manager.element.style&&TOUCH_ACTION_MAP[value]&&(this.manager.element.style[PREFIXED_TOUCH_ACTION]=value),this.actions=value.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var actions=[];return each(this.manager.recognizers,function(recognizer){boolOrFn(recognizer.options.enable,[recognizer])&&(actions=actions.concat(recognizer.getTouchAction()))}),cleanTouchActions(actions.join(" "))},preventDefaults:function(input){var srcEvent=input.srcEvent,direction=input.offsetDirection;if(this.manager.session.prevented)return void srcEvent.preventDefault();var actions=this.actions,hasNone=inStr(actions,TOUCH_ACTION_NONE)&&!TOUCH_ACTION_MAP[TOUCH_ACTION_NONE],hasPanY=inStr(actions,TOUCH_ACTION_PAN_Y)&&!TOUCH_ACTION_MAP[TOUCH_ACTION_PAN_Y],hasPanX=inStr(actions,TOUCH_ACTION_PAN_X)&&!TOUCH_ACTION_MAP[TOUCH_ACTION_PAN_X];if(hasNone){var isTapPointer=1===input.pointers.length,isTapMovement=input.distance<2,isTapTouchTime=input.deltaTime<250;if(isTapPointer&&isTapMovement&&isTapTouchTime)return}return hasPanX&&hasPanY?void 0:hasNone||hasPanY&&direction&DIRECTION_HORIZONTAL||hasPanX&&direction&DIRECTION_VERTICAL?this.preventSrc(srcEvent):void 0},preventSrc:function(srcEvent){this.manager.session.prevented=!0,srcEvent.preventDefault()}};var STATE_POSSIBLE=1,STATE_BEGAN=2,STATE_CHANGED=4,STATE_ENDED=8,STATE_RECOGNIZED=STATE_ENDED,STATE_CANCELLED=16;Recognizer.prototype={defaults:{},set:function(options){return assign(this.options,options),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(otherRecognizer){if(invokeArrayArg(otherRecognizer,"recognizeWith",this))return this;var simultaneous=this.simultaneous;return otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this),simultaneous[otherRecognizer.id]||(simultaneous[otherRecognizer.id]=otherRecognizer,otherRecognizer.recognizeWith(this)),this},dropRecognizeWith:function(otherRecognizer){return invokeArrayArg(otherRecognizer,"dropRecognizeWith",this)?this:(otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this),delete this.simultaneous[otherRecognizer.id],this)},requireFailure:function(otherRecognizer){if(invokeArrayArg(otherRecognizer,"requireFailure",this))return this;var requireFail=this.requireFail;return otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this),-1===inArray(requireFail,otherRecognizer)&&(requireFail.push(otherRecognizer),otherRecognizer.requireFailure(this)),this},dropRequireFailure:function(otherRecognizer){if(invokeArrayArg(otherRecognizer,"dropRequireFailure",this))return this;otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this);var index=inArray(this.requireFail,otherRecognizer);return index>-1&&this.requireFail.splice(index,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(otherRecognizer){return!!this.simultaneous[otherRecognizer.id]},emit:function(input){function emit(event){self.manager.emit(event,input)}var self=this,state=this.state;state<STATE_ENDED&&emit(self.options.event+stateStr(state)),emit(self.options.event),input.additionalEvent&&emit(input.additionalEvent),state>=STATE_ENDED&&emit(self.options.event+stateStr(state))},tryEmit:function(input){if(this.canEmit())return this.emit(input);this.state=32},canEmit:function(){for(var i=0;i<this.requireFail.length;){if(!(this.requireFail[i].state&(32|STATE_POSSIBLE)))return!1;i++}return!0},recognize:function(inputData){var inputDataClone=assign({},inputData);if(!boolOrFn(this.options.enable,[this,inputDataClone]))return this.reset(),void(this.state=32);this.state&(STATE_RECOGNIZED|STATE_CANCELLED|32)&&(this.state=STATE_POSSIBLE),this.state=this.process(inputDataClone),this.state&(STATE_BEGAN|STATE_CHANGED|STATE_ENDED|STATE_CANCELLED)&&this.tryEmit(inputDataClone)},process:function(inputData){},getTouchAction:function(){},reset:function(){}},inherit(AttrRecognizer,Recognizer,{defaults:{pointers:1},attrTest:function(input){var optionPointers=this.options.pointers;return 0===optionPointers||input.pointers.length===optionPointers},process:function(input){var state=this.state,eventType=input.eventType,isRecognized=state&(STATE_BEGAN|STATE_CHANGED),isValid=this.attrTest(input);return isRecognized&&(eventType&INPUT_CANCEL||!isValid)?state|STATE_CANCELLED:isRecognized||isValid?eventType&INPUT_END?state|STATE_ENDED:state&STATE_BEGAN?state|STATE_CHANGED:STATE_BEGAN:32}}),inherit(PanRecognizer,AttrRecognizer,{defaults:{event:"pan",threshold:10,pointers:1,direction:DIRECTION_ALL},getTouchAction:function(){var direction=this.options.direction,actions=[];return direction&DIRECTION_HORIZONTAL&&actions.push(TOUCH_ACTION_PAN_Y),direction&DIRECTION_VERTICAL&&actions.push(TOUCH_ACTION_PAN_X),actions},directionTest:function(input){var options=this.options,hasMoved=!0,distance=input.distance,direction=input.direction,x=input.deltaX,y=input.deltaY;return direction&options.direction||(options.direction&DIRECTION_HORIZONTAL?(direction=0===x?DIRECTION_NONE:x<0?DIRECTION_LEFT:DIRECTION_RIGHT,hasMoved=x!=this.pX,distance=Math.abs(input.deltaX)):(direction=0===y?DIRECTION_NONE:y<0?DIRECTION_UP:DIRECTION_DOWN,hasMoved=y!=this.pY,distance=Math.abs(input.deltaY))),input.direction=direction,hasMoved&&distance>options.threshold&&direction&options.direction},attrTest:function(input){return AttrRecognizer.prototype.attrTest.call(this,input)&&(this.state&STATE_BEGAN||!(this.state&STATE_BEGAN)&&this.directionTest(input))},emit:function(input){this.pX=input.deltaX,this.pY=input.deltaY;var direction=directionStr(input.direction);direction&&(input.additionalEvent=this.options.event+direction),this._super.emit.call(this,input)}}),inherit(PinchRecognizer,AttrRecognizer,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[TOUCH_ACTION_NONE]},attrTest:function(input){return this._super.attrTest.call(this,input)&&(Math.abs(input.scale-1)>this.options.threshold||this.state&STATE_BEGAN)},emit:function(input){if(1!==input.scale){var inOut=input.scale<1?"in":"out";input.additionalEvent=this.options.event+inOut}this._super.emit.call(this,input)}}),inherit(PressRecognizer,Recognizer,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[TOUCH_ACTION_AUTO]},process:function(input){var options=this.options,validPointers=input.pointers.length===options.pointers,validMovement=input.distance<options.threshold,validTime=input.deltaTime>options.time;if(this._input=input,!validMovement||!validPointers||input.eventType&(INPUT_END|INPUT_CANCEL)&&!validTime)this.reset();else if(input.eventType&INPUT_START)this.reset(),this._timer=setTimeoutContext(function(){this.state=STATE_RECOGNIZED,this.tryEmit()},options.time,this);else if(input.eventType&INPUT_END)return STATE_RECOGNIZED;return 32},reset:function(){clearTimeout(this._timer)},emit:function(input){this.state===STATE_RECOGNIZED&&(input&&input.eventType&INPUT_END?this.manager.emit(this.options.event+"up",input):(this._input.timeStamp=now(),this.manager.emit(this.options.event,this._input)))}}),inherit(RotateRecognizer,AttrRecognizer,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[TOUCH_ACTION_NONE]},attrTest:function(input){return this._super.attrTest.call(this,input)&&(Math.abs(input.rotation)>this.options.threshold||this.state&STATE_BEGAN)}}),inherit(SwipeRecognizer,AttrRecognizer,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:DIRECTION_HORIZONTAL|DIRECTION_VERTICAL,pointers:1},getTouchAction:function(){return PanRecognizer.prototype.getTouchAction.call(this)},attrTest:function(input){var velocity,direction=this.options.direction;return direction&(DIRECTION_HORIZONTAL|DIRECTION_VERTICAL)?velocity=input.overallVelocity:direction&DIRECTION_HORIZONTAL?velocity=input.overallVelocityX:direction&DIRECTION_VERTICAL&&(velocity=input.overallVelocityY),this._super.attrTest.call(this,input)&&direction&input.offsetDirection&&input.distance>this.options.threshold&&input.maxPointers==this.options.pointers&&abs(velocity)>this.options.velocity&&input.eventType&INPUT_END},emit:function(input){var direction=directionStr(input.offsetDirection);direction&&this.manager.emit(this.options.event+direction,input),this.manager.emit(this.options.event,input)}}),inherit(TapRecognizer,Recognizer,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[TOUCH_ACTION_MANIPULATION]},process:function(input){var options=this.options,validPointers=input.pointers.length===options.pointers,validMovement=input.distance<options.threshold,validTouchTime=input.deltaTime<options.time;if(this.reset(),input.eventType&INPUT_START&&0===this.count)return this.failTimeout();if(validMovement&&validTouchTime&&validPointers){if(input.eventType!=INPUT_END)return this.failTimeout();var validInterval=!this.pTime||input.timeStamp-this.pTime<options.interval,validMultiTap=!this.pCenter||getDistance(this.pCenter,input.center)<options.posThreshold;this.pTime=input.timeStamp,this.pCenter=input.center,validMultiTap&&validInterval?this.count+=1:this.count=1,this._input=input;if(0===this.count%options.taps)return this.hasRequireFailures()?(this._timer=setTimeoutContext(function(){this.state=STATE_RECOGNIZED,this.tryEmit()},options.interval,this),STATE_BEGAN):STATE_RECOGNIZED}return 32},failTimeout:function(){return this._timer=setTimeoutContext(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==STATE_RECOGNIZED&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Hammer.VERSION="2.0.7",Hammer.defaults={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,preset:[[RotateRecognizer,{enable:!1}],[PinchRecognizer,{enable:!1},["rotate"]],[SwipeRecognizer,{direction:DIRECTION_HORIZONTAL}],[PanRecognizer,{direction:DIRECTION_HORIZONTAL},["swipe"]],[TapRecognizer],[TapRecognizer,{event:"doubletap",taps:2},["tap"]],[PressRecognizer]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};Manager.prototype={set:function(options){return assign(this.options,options),options.touchAction&&this.touchAction.update(),options.inputTarget&&(this.input.destroy(),this.input.target=options.inputTarget,this.input.init()),this},stop:function(force){this.session.stopped=force?2:1},recognize:function(inputData){var session=this.session;if(!session.stopped){this.touchAction.preventDefaults(inputData);var recognizer,recognizers=this.recognizers,curRecognizer=session.curRecognizer;(!curRecognizer||curRecognizer&&curRecognizer.state&STATE_RECOGNIZED)&&(curRecognizer=session.curRecognizer=null);for(var i=0;i<recognizers.length;)recognizer=recognizers[i],2===session.stopped||curRecognizer&&recognizer!=curRecognizer&&!recognizer.canRecognizeWith(curRecognizer)?recognizer.reset():recognizer.recognize(inputData),!curRecognizer&&recognizer.state&(STATE_BEGAN|STATE_CHANGED|STATE_ENDED)&&(curRecognizer=session.curRecognizer=recognizer),i++}},get:function(recognizer){if(recognizer instanceof Recognizer)return recognizer;for(var recognizers=this.recognizers,i=0;i<recognizers.length;i++)if(recognizers[i].options.event==recognizer)return recognizers[i];return null},add:function(recognizer){if(invokeArrayArg(recognizer,"add",this))return this;var existing=this.get(recognizer.options.event);return existing&&this.remove(existing),this.recognizers.push(recognizer),recognizer.manager=this,this.touchAction.update(),recognizer},remove:function(recognizer){if(invokeArrayArg(recognizer,"remove",this))return this;if(recognizer=this.get(recognizer)){var recognizers=this.recognizers,index=inArray(recognizers,recognizer);-1!==index&&(recognizers.splice(index,1),this.touchAction.update())}return this},on:function(events,handler){if(events!==undefined&&handler!==undefined){var handlers=this.handlers;return each(splitStr(events),function(event){handlers[event]=handlers[event]||[],handlers[event].push(handler)}),this}},off:function(events,handler){if(events!==undefined){var handlers=this.handlers;return each(splitStr(events),function(event){handler?handlers[event]&&handlers[event].splice(inArray(handlers[event],handler),1):delete handlers[event]}),this}},emit:function(event,data){this.options.domEvents&&triggerDomEvent(event,data);var handlers=this.handlers[event]&&this.handlers[event].slice();if(handlers&&handlers.length){data.type=event,data.preventDefault=function(){data.srcEvent.preventDefault()};for(var i=0;i<handlers.length;)handlers[i](data),i++}},destroy:function(){this.element&&toggleCssProps(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},assign(Hammer,{INPUT_START:INPUT_START,INPUT_MOVE:INPUT_MOVE,INPUT_END:INPUT_END,INPUT_CANCEL:INPUT_CANCEL,STATE_POSSIBLE:STATE_POSSIBLE,STATE_BEGAN:STATE_BEGAN,STATE_CHANGED:STATE_CHANGED,STATE_ENDED:STATE_ENDED,STATE_RECOGNIZED:STATE_RECOGNIZED,STATE_CANCELLED:STATE_CANCELLED,STATE_FAILED:32,DIRECTION_NONE:DIRECTION_NONE,DIRECTION_LEFT:DIRECTION_LEFT,DIRECTION_RIGHT:DIRECTION_RIGHT,DIRECTION_UP:DIRECTION_UP,DIRECTION_DOWN:DIRECTION_DOWN,DIRECTION_HORIZONTAL:DIRECTION_HORIZONTAL,DIRECTION_VERTICAL:DIRECTION_VERTICAL,DIRECTION_ALL:DIRECTION_ALL,Manager:Manager,Input:Input,TouchAction:TouchAction,TouchInput:TouchInput,MouseInput:MouseInput,PointerEventInput:PointerEventInput,TouchMouseInput:TouchMouseInput,SingleTouchInput:SingleTouchInput,Recognizer:Recognizer,AttrRecognizer:AttrRecognizer,Tap:TapRecognizer,Pan:PanRecognizer,Swipe:SwipeRecognizer,Pinch:PinchRecognizer,Rotate:RotateRecognizer,Press:PressRecognizer,on:addEventListeners,off:removeEventListeners,each:each,merge:merge,extend:extend,assign:assign,inherit:inherit,bindFn:bindFn,prefixed:prefixed}),(void 0!==window?window:"undefined"!=typeof self?self:{}).Hammer=Hammer,(__WEBPACK_AMD_DEFINE_RESULT__=function(){return Hammer}.call(exports,__webpack_require__,exports,module))!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)}(window,document)},function(module,exports,__webpack_require__){"use strict";__webpack_require__(0).Class,__webpack_require__(0).ClassEx,__webpack_require__(0).ObjectEx,__webpack_require__(0).DataType;module.exports=function(Kekule){var _fontDetector,_FontDetector=function(){function detect(font){var detected=!1;for(var index in baseFonts){s.style.fontFamily=font+","+baseFonts[index],h.appendChild(s);var matched=s.offsetWidth!=defaultWidth[baseFonts[index]]||s.offsetHeight!=defaultHeight[baseFonts[index]];h.removeChild(s),detected=detected||matched}return detected}var baseFonts=["monospace","sans-serif","serif"],h=document.getElementsByTagName("body")[0],s=document.createElement("span");s.style.fontSize="72px",s.innerHTML="mmmmmmmmmmlli";var defaultWidth={},defaultHeight={};for(var index in baseFonts)s.style.fontFamily=baseFonts[index],h.appendChild(s),defaultWidth[baseFonts[index]]=s.offsetWidth,defaultHeight[baseFonts[index]]=s.offsetHeight,h.removeChild(s);this.detect=detect};Kekule.Widget.FontDetector={detect:function(fontFamily){var d=_fontDetector;return d||(d=new _FontDetector,_fontDetector=d),d.detect(fontFamily)}};var _defFontList=["Arial, Helvetica, sans-serif","Georgia, Times New Roman, Times, serif","Courier New, Courier, monospace","Tahoma, Geneva, sans-serif","Trebuchet MS, Arial, Helvetica, sans-serif","Arial Black, Gadget, sans-serif","Palatino Linotype, Book Antiqua, Palatino, serif","Lucida Sans Unicode, Lucida Grande, sans-serif","MS Serif, New York, serif","Lucida Console, Monaco, monospace","Comic Sans MS, cursive"];return Kekule.Widget.FontEnumerator={getAvailableFontFamilies:function(candidateFonts){candidateFonts||(candidateFonts=_defFontList);for(var result=[],i=0,l=candidateFonts.length;i<l;++i){var fn=candidateFonts[i];Kekule.Widget.FontDetector.detect(fn)&&result.push(fn)}return result}},Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,ObjectEx=(__webpack_require__(0).ClassEx,__webpack_require__(0).ObjectEx),DataType=__webpack_require__(0).DataType,ObjSerializerFactory=__webpack_require__(2).ObjSerializerFactory;module.exports=function(Kekule){return Kekule.Widget.Clipboard=Class.create(ObjectEx,{CLASS_NAME:"Kekule.Widget.Clipboard",STORAGE_KEY:"__$kekule_widget_clipboard__",initialize:function($super){if($super(),this._data=new Kekule.MapEx(!0),Kekule.BrowserFeature.localStorage){this._crossPageStorage=window.localStorage,this.setEnableCrossPageClipboard(!0);var self=this;Kekule.X.Event.addListener(window,"storage",function(e){if(self.getEnableCrossPageClipboard()){var key=e.key,dataType=self._extractSessionDataType(key);dataType&&self.invokeEvent("setData",{dataType:dataType,data:self.deserializeData(e.newValue)})}})}},finalize:function($super){this._data.finalize(),$super()},initProperties:function(){this.defineProp("enableCrossPageClipboard",{dataType:DataType.BOOL})},_useSessionClipboard:function(){return this.getEnableCrossPageClipboard()&&Kekule.BrowserFeature.localStorage},_extractSessionDataType:function(key){return key.startsWith(this.STORAGE_KEY)?key.substr(this.STORAGE_KEY.length):null},serializeData:function(data){var result;if(DataType.isSimpleValue(data))result=JSON.stringify(data);else{var jsonObj={};ObjSerializerFactory.getSerializer("json").save(data,jsonObj),result=JSON.stringify(jsonObj)}return result},deserializeData:function(data){var jsonObj=JSON.parse(data);return DataType.isSimpleValue(jsonObj)?jsonObj:ObjSerializerFactory.getSerializer("json").load(null,jsonObj)},setData:function(dataType,data){if(this._useSessionClipboard()){var s=this.serializeData(data);this._crossPageStorage.setItem(this.STORAGE_KEY+dataType,s)}else this._data.set(dataType,data);return this.invokeEvent("setData",{dataType:dataType,data:data}),this},getData:function(dataType){if(this._useSessionClipboard()){var s=this._crossPageStorage.getItem(this.STORAGE_KEY+dataType);return s?this.deserializeData(s):null}return this._data.get(dataType)},hasData:function(dataType){return Kekule.ObjUtils.notUnset(this.getData(dataType))},clearData:function(){if(this._useSessionClipboard())for(var types=this.getTypes(),i=0,l=types.length;i<l;++i)this._crossPageStorage.removeItem(this.STORAGE_KEY+types[i]);else this._data.clear();return this.invokeEvent("setData",{dataType:null,data:null}),this},getTypes:function(){if(this._useSessionClipboard()){for(var result=[],i=0,l=this._crossPageStorage.length;i<l;++i){var key=this._crossPageStorage.key(i),dataType=this._extractSessionDataType(key);dataType&&result.push(dataType)}return result}return this._data.getKeys()},setObjects:function(dataType,objs){for(var jsonObjs=[],serializer=ObjSerializerFactory.getSerializer("json"),i=0,l=objs.length;i<l;++i){var obj=objs[i],jsonObj={};serializer.save(obj,jsonObj),jsonObjs.push(jsonObj)}var str=JSON.stringify(jsonObjs);return this.setData(dataType,str)},getObjects:function(dataType){var data=this.getData(dataType);if(DataType.isSimpleValue(data)){var jsonObjs=JSON.parse(data);DataType.isArrayValue(jsonObjs)||(jsonObjs=[jsonObjs]);for(var result=[],serializer=ObjSerializerFactory.getSerializer("json"),i=0,l=jsonObjs.length;i<l;++i){var jsonObj=jsonObjs[i],obj=serializer.load(null,jsonObj);result.push(obj)}return result}return data}}),Kekule.ClassUtils.makeSingleton(Kekule.Widget.Clipboard),Kekule.Widget.clipboard=Kekule.Widget.Clipboard.getInstance(),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,ObjectEx=(__webpack_require__(0).ClassEx,__webpack_require__(0).ObjectEx),DataType=__webpack_require__(0).DataType;module.exports=function(Kekule){Kekule.Widget.EvokeMode={ALWAYS:0,EVOKEE_CLICK:1,EVOKEE_MOUSE_ENTER:2,EVOKEE_MOUSE_LEAVE:3,EVOKEE_MOUSE_DOWN:4,EVOKEE_MOUSE_UP:5,EVOKEE_MOUSE_MOVE:6,EVOKEE_TOUCH:7,EVOKER_CLICK:11,EVOKER_MOUSE_ENTER:12,EVOKER_MOUSE_LEAVE:13,EVOKER_MOUSE_DOWN:14,EVOKER_MOUSE_UP:15,EVOKER_MOUSE_MOVE:16,EVOKER_TOUCH:17,EVOKEE_TIMEOUT:21,EVOKER_TIMEOUT:22};var EM=Kekule.Widget.EvokeMode;return Kekule.Widget.DynamicEvokeHelper=Class.create(ObjectEx,{CLASS_NAME:"Kekule.Widget.DynamicEvokeHelper",evokeEvents:["click","mouseenter","mouseleave","mousedown","mouseup","touchstart"],DEF_TIMEOUT:5e3,initialize:function($super,evokee,evoker,evokeModes,revokeModes,timeout){$super(),this._timeoutRevokeHandle=null,this.reactEvokeEventsBind=this.reactEvokeEvents.bind(this),this.checkTimeoutRevokeBind=this.checkTimeoutRevoke.bind(this),this.setTimeout(timeout||this.DEF_TIMEOUT),this.setPropStoreFieldValue("evokeModes",evokeModes||[]),this.setPropStoreFieldValue("revokeModes",revokeModes||[]),this.linkWidgets(evokee,evoker)},finalize:function($super){this.unlinkWidgets(this.getEvokee(),this.getEvoker()),$super()},initProperties:function(){this.defineProp("evokee",{dataType:"Kekule.Widget.BaseWidget",serializable:!1,setter:null}),this.defineProp("evoker",{dataType:"Kekule.Widget.BaseWidget",serializable:!1,setter:null}),this.defineProp("evokeModes",{dataType:DataType.ARRAY}),this.defineProp("revokeModes",{dataType:DataType.ARRAY}),this.defineProp("timeout",{dataType:DataType.INT}),this.defineProp("showHideType",{dataType:DataType.INT})},evoke:function(){this.getEvoker()&&(clearTimeout(this._timeoutRevokeHandle),this.getEvoker().show(this.getEvokee(),null,this.getShowHideType()),this.postponeTimeoutCheck())},revoke:function(){if(this.getEvoker()){clearTimeout(this._timeoutRevokeHandle);this.getEvoker().getDocument().body.focus(),this.getEvoker().hide(this.getEvokee(),null,this.getShowHideType())}},doObjectChange:function($super,modifiedPropNames){$super(modifiedPropNames),Kekule.ArrayUtils.intersect(modifiedPropNames,["evokeModes","revokeModes"]).length>0&&this.evokeModesChanged()},linkWidgets:function(evokee,evoker){this.setPropStoreFieldValue("evokee",evokee),this.setPropStoreFieldValue("evoker",evoker),this.installEventHandlers(evokee,this.evokeEvents,this.reactEvokeEventsBind),this.installEventHandlers(evoker,this.evokeEvents,this.reactEvokeEventsBind),this.updateOnAlwaysMode()},unlinkWidgets:function(evokee,evoker){this.uninstallEventHandlers(evokee,this.evokeEvents,this.reactEvokeEventsBind),this.uninstallEventHandlers(evoker,this.evokeEvents,this.reactEvokeEventsBind)},installEventHandlers:function(widget,events,handler){for(var i=0,l=events.length;i<l;++i)widget.addEventListener(events[i],handler)},uninstallEventHandlers:function(widget,events,handler){for(var i=0,l=events.length;i<l;++i)widget.removeEventListener(events[i],handler)},evokeModesChanged:function(){this.updateOnAlwaysMode()},updateOnAlwaysMode:function(){this.getEvokeModes().indexOf(EM.ALWAYS)>=0?this.evoke():this.getRevokeModes().indexOf(EM.ALWAYS)>=0&&this.revoke()},checkTimeoutRevoke:function(onEvoke){if(this.getEvoker()){var DU=Kekule.DomUtils,doc=this.getEvoker().getDocument(),activeElem=doc.activeElement,modes=this.getRevokeModes(),checkElems=[];modes.indexOf(EM.EVOKEE_TIMEOUT)>=0&&checkElems.push(this.getEvokee().getElement()),modes.indexOf(EM.EVOKER_TIMEOUT)>=0&&checkElems.push(this.getEvoker().getElement());for(var postpone=!1,i=0,l=checkElems.length;i<l;++i){var elem=checkElems[i];if(activeElem===elem||DU.isDescendantOf(activeElem,elem)){postpone=!0;break}}postpone?this.postponeTimeoutCheck():this.revoke()}},postponeTimeoutCheck:function(){if(this.hasTimeoutMode(this.getRevokeModes())){if(this.getEvokeModes().indexOf(EM.ALWAYS)>=0)return;this._timeoutRevokeHandle=setTimeout(this.checkTimeoutRevokeBind,this.getTimeout())}},hasTimeoutMode:function(evokeModes){return Kekule.ArrayUtils.intersect([EM.EVOKEE_TIMEOUT,EM.EVOKER_TIMEOUT],evokeModes).length>0},getEventTypeOfMode:function(evokeMode){switch(evokeMode){case EM.EVOKEE_CLICK:case EM.EVOKER_CLICK:return"click";case EM.EVOKEE_MOUSE_ENTER:case EM.EVOKER_MOUSE_ENTER:return"mouseenter";case EM.EVOKEE_MOUSE_LEAVE:case EM.EVOKER_MOUSE_LEAVE:return"mouseleave";case EM.EVOKEE_MOUSE_DOWN:case EM.EVOKER_MOUSE_DOWN:return"mousedown";case EM.EVOKEE_MOUSE_UP:case EM.EVOKER_MOUSE_UP:return"mouseup";case EM.EVOKEE_MOUSE_MOVE:case EM.EVOKER_MOUSE_MOVE:return"mousemove";case EM.EVOKEE_TOUCH:case EM.EVOKER_TOUCH:return"touchstart"}},isEvokeTargetOnEvokee:function(evokeMode){return evokeMode>=EM.EVOKEE_CLICK&&evokeMode<=EM.EVOKEE_TOUCH},reactEvokeEvents:function(e){var evtType=e.htmlEvent.getType(),target=e.target;if(target===this.getEvokee()||target===this.getEvoker()){var isOnEvokee=e.target===this.getEvokee();if(!this.getEvoker().isShown()){if(this.getRevokeModes().indexOf(EM.ALWAYS)>=0)return;for(var modes=this.getEvokeModes(),i=0,l=modes.length;i<l;++i)if(isOnEvokee===this.isEvokeTargetOnEvokee(modes[i])&&evtType===this.getEventTypeOfMode(modes[i]))return void this.evoke()}else{if(this.getEvokeModes().indexOf(EM.ALWAYS)>=0)return;for(var modes=this.getRevokeModes(),i=0,l=modes.length;i<l;++i)if(isOnEvokee===this.isEvokeTargetOnEvokee(modes[i])&&evtType===this.getEventTypeOfMode(modes[i]))return void this.revoke()}}}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,ObjectEx=(__webpack_require__(0).ClassEx,__webpack_require__(0).ObjectEx),DataType=__webpack_require__(0).DataType;module.exports=function(Kekule){var EU=Kekule.HtmlElementUtils;Kekule.Widget.StyleResource=Class.create(ObjectEx,{CLASS_NAME:"Kekule.Widget.StyleResource",initialize:function($super,name,cssClassName){$super(),this.setPropStoreFieldValue("name",name),cssClassName&&this.setCssClassName(cssClassName)},initProperties:function(){this.defineProp("name",{dataType:DataType.STRING,setter:null}),this.defineProp("cssClassName",{dataType:DataType.STRING})},linkTo:function(target){return EU.addClass(this._getElement(target),this.getCssClassName()),this},unlinkFrom:function(target){EU.removeClass(this._getElement(target),this.getCssClassName())},_getElement:function(target){return target instanceof Kekule.Widget.BaseWidget?target.getElement():target}}),Kekule.Widget.StyleResourceManager={_resources:{},register:function(resource){var name=resource.getName();return name&&(RM._resources[name]=resource),RM},unregister:function(resourceOrName){var name;return"string"==typeof resourceOrName?name=resourceOrName:resourceOrName.getName&&(name=resourceOrName.getName()),name&&delete RM._resources[name],RM},getResource:function(name){return RM._resources[name]}},Kekule.Widget.StyleResourceNames={PREFIX:"$$",CURSOR_ROTATE:"$$cursor_rotate",CURSOR_ROTATE_NE:"$$cursor_rotate_ne",CURSOR_ROTATE_NW:"$$cursor_rotate_nw",CURSOR_ROTATE_SE:"$$cursor_rotate_se",CURSOR_ROTATE_SW:"$$cursor_rotate_sw",ICON_COLOR_PICK:"$$icon_color_pick",ICON_COLOR_NOTSET:"$$icon_color_default",ICON_COLOR_MIXED:"$$icon_color_mixed",BUTTON_YES_OK:"$$btn_yes_ok",BUTTON_NO_CANCEL:"$$btn_no_cancel",BUTTON_LOAD_FILE:"$$btn_load_file"};var RM=Kekule.Widget.StyleResourceManager,SR=Kekule.Widget.StyleResource,SRN=Kekule.Widget.StyleResourceNames;return RM.register(new SR(SRN.CURSOR_ROTATE,"K-Res-Cursor-Rotate")),RM.register(new SR(SRN.CURSOR_ROTATE_NE,"K-Res-Cursor-Rotate-NE")),RM.register(new SR(SRN.CURSOR_ROTATE_NW,"K-Res-Cursor-Rotate-NW")),RM.register(new SR(SRN.CURSOR_ROTATE_SE,"K-Res-Cursor-Rotate-SE")),RM.register(new SR(SRN.CURSOR_ROTATE_SW,"K-Res-Cursor-Rotate-SW")),RM.register(new SR(SRN.ICON_COLOR_PICK,"K-Res-Icon-Color-Pick")),RM.register(new SR(SRN.ICON_COLOR_NOTSET,"K-Res-Icon-Color-NotSet")),RM.register(new SR(SRN.ICON_COLOR_MIXED,"K-Res-Icon-Color-Mixed")),RM.register(new SR(SRN.BUTTON_YES_OK,"K-Res-Button-YesOk")),RM.register(new SR(SRN.BUTTON_NO_CANCEL,"K-Res-Button-NoCancel")),RM.register(new SR(SRN.BUTTON_LOAD_FILE,"K-Res-Button-LoadFile")),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,ClassEx=__webpack_require__(0).ClassEx,ObjectEx=__webpack_require__(0).ObjectEx;__webpack_require__(0).DataType;module.exports=function(Kekule){var DU=Kekule.DomUtils;Kekule.ArrayUtils;Kekule.Widget.AutoLauncher=Class.create(ObjectEx,{CLASS_NAME:"Kekule.Widget.AutoLauncher",WIDGET_ATTRIB:"data-widget",WIDGET_ATTRIB_ALT:"data-kekule-widget",PLACEHOLDER_ATTRIB:"data-placeholder",FIELD_PARENT_WIDGET_ELEM:"__$kekule_parent_widget_elem$__",initialize:function($super){$super(),this._executingFlag=0,this._pendingWidgetRefMap=new Kekule.MapEx(!0),this._pendingElems=[],this._handlingPendings=!1,this._execOnPendingBind=this._execOnPending.bind(this);var self=this;Kekule.Widget.Utils._setWidgetRefPropFromId=function(widget,propName,id){if(id){var refWidget=Kekule.Widget.getWidgetById(id,widget.getDocument());if(refWidget)widget.setPropValue(propName,refWidget);else{var elem=widget.getDocument().getElementById(id);elem&&self.isExecuting()&&self.addPendingWidgetRefItem(elem,widget,propName)}}}},finalize:function($super){this._pendingElems=null,this._pendingWidgetRefMap=null,$super()},getPendingElems:function(){return this._pendingElems},addPendingElem:function(doc,elem,parent,widgetClass,execOnChildren){this._pendingElems.push({doc:doc,elem:elem,parent:parent,widgetClass:widgetClass,execOnChildren:execOnChildren})},handlePendingElems:function(callback){if(!this._handlingPendings){if(this._handlingPendings=!0,callback){this._pendingElems.push({callback:callback})}this.beginExec(),setTimeout(this._execOnPendingBind,0)}},_execOnPending:function(){var currItem=this._pendingElems.shift();if(currItem)try{currItem.elem?this.createWidgetOnElem(currItem.doc,currItem.elem,currItem.parent):currItem.callback&&setTimeout(currItem.callback,0)}finally{setTimeout(this._execOnPendingBind,0)}else this._handlingPendings=!1,this.endExec()},getPendingWidgetRefMap:function(){return this._pendingWidgetRefMap},addPendingWidgetRefItem:function(refElem,widget,propName){this._pendingWidgetRefMap.set(refElem,{widget:widget,propName:propName})},removePendingWidgetRefItem:function(refElem){this._pendingWidgetRefMap.remove(refElem)},handlePendingWidgetRef:function(){for(var pendingElems=this._pendingWidgetRefMap.getKeys(),i=0,l=pendingElems.length;i<l;++i){var elem=pendingElems[i],refWidget=Kekule.Widget.getWidgetOnElem(elem);if(refWidget){var setting=this._pendingWidgetRefMap.get(elem);setting.widget.setPropValue(setting.propName,refWidget)}this.removePendingWidgetRefItem(elem)}},beginExec:function(){++this._executingFlag},endExec:function(){this._executingFlag>0&&--this._executingFlag,this._executingFlag<=0&&this.handlePendingWidgetRef()},isExecuting:function(){return this._executingFlag>0},execute:function(rootElem,deferCreation,callback){var deferring=Kekule.ObjUtils.notUnset(deferCreation)?deferCreation:Kekule.Widget.AutoLauncher.deferring;deferring||this.beginExec();try{"function"==typeof rootElem.querySelector?this.executeOnElemBySelector(rootElem.ownerDocument,rootElem,null,deferring):this.executeOnElem(rootElem.ownerDocument,rootElem,null,deferring),deferring&&this.handlePendingElems(callback)}finally{deferring||(this.endExec(),callback&&callback())}},executeOnElem:function(doc,elem,parentWidgetOrElem,deferring){if(this.isElemLaunchable(elem)){var widget=null,widgetClass=this.getElemWidgetClass(elem),currParent=parentWidgetOrElem;if(deferring)widgetClass&&(this.addPendingElem(doc,elem,parentWidgetOrElem,widgetClass,!1),currParent=elem);else{var parentWidget=parentWidgetOrElem;!parentWidget||parentWidget instanceof Kekule.Widget.BaseWidget||(parentWidget=Kekule.Widget.getWidgetOnElem(parentWidgetOrElem)),widget=this.createWidgetOnElem(doc,elem,parentWidget,widgetClass),currParent=widget||elem}if(deferring&&!widgetClass||!deferring&&!widget||Kekule.Widget.AutoLauncher.enableCascadeLaunch)for(var children=DU.getDirectChildElems(elem),i=0,l=children.length;i<l;++i){var child=children[i];this.executeOnElem(doc,child,currParent,deferring)}}},executeOnElemBySelector:function(doc,rootElem,parentWidget,deferring){var selector="["+this.WIDGET_ATTRIB+"],["+this.WIDGET_ATTRIB_ALT+"]",allElems=rootElem.querySelectorAll(selector);if(this.getElemWidgetClass(rootElem)&&(allElems=Array.prototype.slice.call(allElems),allElems.unshift(rootElem)),allElems&&allElems.length){for(var i=0,l=allElems.length;i<l;++i){var elem=allElems[i],parentElem=this._findParentCandidateElem(elem,allElems,0,i-1);parentElem&&(elem[this.FIELD_PARENT_WIDGET_ELEM]=parentElem)}for(var i=0,l=allElems.length;i<l;++i){var elem=allElems[i];if(this.isElemLaunchable(elem)){var parentWidgetElem=elem[this.FIELD_PARENT_WIDGET_ELEM]||null;!Kekule.Widget.AutoLauncher.enableCascadeLaunch&&parentWidgetElem||(deferring?this.addPendingElem(doc,elem,parentWidgetElem,null,!1):this.createWidgetOnElem(doc,elem,parentWidgetElem))}}}},_findParentCandidateElem:function(elem,candidateElems,fromIndex,toIndex){for(var result=null,parent=elem.parentNode;parent&&!result;){for(var i=toIndex;i>=fromIndex;--i)if(parent===candidateElems[i])return result=candidateElems[i];result||(parent=parent.parentNode)}return result},createWidgetOnElem:function(doc,elem,parentWidgetOrElem,widgetClass){var result=null,old=Kekule.Widget.getWidgetOnElem(elem);if(old)return old;if(widgetClass||(widgetClass=this.getElemWidgetClass(elem)),widgetClass){var AL=Kekule.Widget.AutoLauncher,usingPlaceHolder=!1;if(AL.placeHolderStrategy!==AL.PlaceHolderStrategies.DISABLED){var attrPlaceholder=elem.getAttribute(this.PLACEHOLDER_ATTRIB)||"";usingPlaceHolder=AL.placeHolderStrategy===AL.PlaceHolderStrategies.EXPLICIT&&Kekule.StrUtils.strToBool(attrPlaceholder)||AL.placeHolderStrategy===AL.PlaceHolderStrategies.IMPLICIT,usingPlaceHolder=usingPlaceHolder&&ClassEx.getPrototype(widgetClass).canUsePlaceHolderOnElem(elem)}if(result=usingPlaceHolder?new Kekule.Widget.PlaceHolder(elem,widgetClass):new widgetClass(elem)){var parentWidget=parentWidgetOrElem;!parentWidget||parentWidget instanceof Kekule.Widget.BaseWidget||(parentWidget=Kekule.Widget.getWidgetOnElem(parentWidgetOrElem)),parentWidget&&result.setParent(parentWidget)}}return result},isElemLaunchable:function(elem){return!(elem.isContentEditable&&!Kekule.Widget.AutoLauncher.enableOnEditable)},getElemWidgetClass:function(elem){var result=null,widgetName=elem.getAttribute(this.WIDGET_ATTRIB);return widgetName||(widgetName=elem.getAttribute(this.WIDGET_ATTRIB_ALT)),widgetName&&(result=this.getWidgetClass(widgetName)),result},getWidgetClass:function(widgetName){return ClassEx.findClass(widgetName,void 0,Kekule)}}),Kekule.ClassUtils.makeSingleton(Kekule.Widget.AutoLauncher),Kekule.Widget.autoLauncher=Kekule.Widget.AutoLauncher.getInstance(),Kekule.Widget.AutoLauncher.PlaceHolderStrategies={DISABLED:"disabled",IMPLICIT:"implicit",EXPLICIT:"explicit"},Kekule.Widget.AutoLauncher.enabled=!0,Kekule.Widget.AutoLauncher.enableCascadeLaunch=!0,Kekule.Widget.AutoLauncher.enableDynamicDomCheck=!0,Kekule.Widget.AutoLauncher.enableOnEditable=!1,Kekule.Widget.AutoLauncher.placeHolderStrategy=Kekule.Widget.AutoLauncher.PlaceHolderStrategies.EXPLICIT,Kekule.Widget.AutoLauncher.deferring=!1,Kekule.Widget.WidgetsReady={isReady:!1,funcs:[],ready:function(fn){WR.isReady?fn():WR.funcs.push(fn)},fireReady:function(){if(!WR.isReady){WR.isReady=!0;for(var funcs=WR.funcs;funcs.length;){funcs.shift()()}}}};var WR=Kekule.Widget.WidgetsReady;Kekule.Widget.ready=WR.ready;var _doAutoLaunch=function _doAutoLaunch(){if(!_doAutoLaunch.done){if(!Kekule._isLoaded())return void Kekule._registerAfterLoadProc(_doAutoLaunch);var resumeDomReady=Kekule.Widget.AutoLauncher.deferring?function(){Kekule.X.DomReady.resume()}:null,done=function(){try{WR.fireReady()}finally{resumeDomReady&&resumeDomReady()}};if(Kekule.Widget.AutoLauncher.enabled?(Kekule.Widget.AutoLauncher.deferring&&Kekule.X.DomReady.suspend(),Kekule.Widget.autoLauncher.execute(document.body,null,done)):done(),Kekule.X.MutationObserver){new Kekule.X.MutationObserver(function(mutations){if(Kekule.Widget.AutoLauncher.enableDynamicDomCheck&&Kekule.Widget.AutoLauncher.enabled)for(var i=0,l=mutations.length;i<l;++i){var m=mutations[i];if("childList"===m.type)for(var addedNodes=m.addedNodes,j=0,k=addedNodes.length;j<k;++j){var node=addedNodes[j];node.nodeType===Node.ELEMENT_NODE&&Kekule.Widget.autoLauncher.execute(node)}}}).observe(document.body,{childList:!0,subtree:!0})}else Kekule.X.Event.addListener(document,"DOMNodeInserted",function(e){if(Kekule.Widget.AutoLauncher.enableDynamicDomCheck&&Kekule.Widget.AutoLauncher.enabled){var target=e.getTarget();target.nodeType===(Node.ELEMENT_NODE||1)&&Kekule.Widget.autoLauncher.execute(target)}});_doAutoLaunch.done=!0}};return Kekule.X.domReady(_doAutoLaunch),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,ClassEx=__webpack_require__(0).ClassEx,ObjectEx=__webpack_require__(0).ObjectEx,DataType=__webpack_require__(0).DataType;module.exports=function(Kekule){var D=Kekule.Widget.Direction,SU=Kekule.StyleUtils;Kekule.Widget.BaseTransition=Class.create(ObjectEx,{CLASS_NAME:"Kekule.Widget.BaseTransition",initialize:function($super){$super()},initProperties:function(){this.defineProp("element",{dataType:DataType.OBJECT,serializable:!1}),this.defineProp("caller",{dataType:DataType.OBJECT,serializable:!1})},canExecute:function(element,options){return!0},prepare:function(element,caller,options){},finish:function(element,caller,options){},execute:function(element,caller,callback,options){this.setElement(element),caller&&this.setCaller(caller);var ops=Object.extend({from:0,to:1},options),self=this,done=function done(){done.__$applied__||(done.__$applied__=!0,self.finish(element,caller,ops),callback&&callback())};done.__$applied__=!1,this.prepare(element,caller,ops);var self=this,result={element:element,caller:caller,callback:callback,doneCallback:done,options:options,executor:this,halt:function(){self.halt(result)}};return this.doExecute(element,caller,done,ops),result},doExecute:function(element,caller,callback,options){},halt:function(transitionInfo){transitionInfo.executor!==this?transitionInfo.executor.halt(transitionInfo):(this.doHalt(transitionInfo),transitionInfo.doneCallback&&transitionInfo.doneCallback())},doHalt:function(transitionInfo){},setElementProp:function(element,position,options){}}),Kekule.Widget.Css3Transition=Class.create(Kekule.Widget.BaseTransition,{CLASS_NAME:"Kekule.Widget.Css3Transition",initialize:function($super){$super()},initProperties:function(){this.defineProp("cssProperty",{dataType:DataType.STRING}),this.defineProp("timingFunc",{dataType:DataType.STRING})},getAffectedCssPropNames:function(transOptions){},getTransCssPropNames:function(transOptions){},storeCssInlineValues:function(element,propNames){for(var style=element.style,result={},i=0,l=propNames.length;i<l;++i){var name=propNames[i];result[name]=style[name]}return result},restoreCssInlineValues:function(element,propNames,storage){for(var style=element.style,i=0,l=propNames.length;i<l;++i){var name=propNames[i];if(storage[name])style[name]=storage[name];else try{style.removeProperty(name)}catch(e){style[name]=""}}},storeCssComputedValues:function(element,propNames){for(var result={},i=0,l=propNames.length;i<l;++i){var name=propNames[i],s=SU.getComputedStyle(element,name);result[name]=s}return result},canExecute:function(element,options){return Kekule.BrowserFeature.cssTransition},isSupported:function(){return Kekule.BrowserFeature.cssTransition},isAppear:function(options){return!!options.isAppear},isDisappear:function(options){return!!options.isDisappear},setTransitionProp:function(styleObj,propName,value){for(var propNames=["Moz"+propName.capitalizeFirst(),"Webkit"+propName.capitalizeFirst(),propName],i=0,l=propNames.length;i<l;++i)styleObj[propNames[i]]=value},getOriginCssInlineValues:function(){return this._originCssInlineValues},getComputedCssValues:function(){return this._computedCssValues},prepare:function(element,caller,options){this.setCssProperty(this.getTransCssPropNames(options).join(","));var cssPropNames=this.getAffectedCssPropNames(options);this._affectedCssPropNames=cssPropNames,this._originCssInlineValues=this.storeCssInlineValues(element,cssPropNames),this._computedCssValues=this.storeCssComputedValues(element,cssPropNames)},finish:function(element,caller,options){(1===options.to||this.isAppear(options)||this.isDisappear(options))&&this.restoreCssInlineValues(element,this._affectedCssPropNames,this._originCssInlineValues)},doExecute:function(element,caller,callback,options){var SU=Kekule.StyleUtils,style=element.style;this.isAppear(options),this.isDisappear(options);if(this.isSupported()){this.setElementProp(element,options.from,options),SU.isDisplayed(element)||SU.setDisplay(element,!0),SU.isVisible(element)||SU.setVisibility(element,!0);var s=this.getCssProperty();this.setTransitionProp(style,"transitionProperty",s),s=this.getTimingFunc(),s&&this.setTransitionProp(style,"transitionTimingFunction",s),s=options.duration.toString()+"ms",this.setTransitionProp(style,"transitionDuration",s);var fallbackTimeout,self=this,done=function done(e){Kekule.X.Event.removeListener(element,"transitionend",done),self.setTransitionProp(style,"transition",""),fallbackTimeout&&clearTimeout(fallbackTimeout),callback&&callback()};this._currEventHandler=done,Kekule.X.Event.addListener(element,"transitionend",done),fallbackTimeout=setTimeout(done,options.duration+100),setTimeout(function(){self.setElementProp(element,options.to,options)},0)}else{try{this.setElementProp(element,options.to,options)}catch(e){}callback&&setTimeout(callback,0)}},doHalt:function(transitionInfo){var elem=transitionInfo.element;elem&&this.setTransitionProp(elem.style,"transitionProperty","none")}}),Kekule.Widget.Css3OpacityTrans=Class.create(Kekule.Widget.Css3Transition,{CLASS_NAME:"Kekule.Widget.Css3OpacityTrans",getAffectedCssPropNames:function(transOptions){return["opacity"]},getTransCssPropNames:function(transOptions){return["opacity"]},setElementProp:function(element,position,options){var originOpacity=parseFloat(this._computedCssValues.opacity)||1;element.style.opacity=originOpacity*position}}),Kekule.Widget.Css3SlideTransition=Class.create(Kekule.Widget.Css3Transition,{CLASS_NAME:"Kekule.Widget.Css3SlideTransition",initialize:function($super,direction){$super(),Kekule.ObjUtils.notUnset(direction)&&this.setDirection(direction)},initProperties:function(){this.defineProp("direction",{dataType:DataType.INT})},canExecute:function($super,element,options){return!0},prepare:function($super,element,caller,options){SU.setDisplay(element,!0),this._direction=this.getActualDirection(element,options),$super(element,caller,options),element.style.overflow="hidden",this._clearDimesionConstraints(element)},_clearDimesionConstraints:function(elem){var style=elem.style;style.minWidth="0",style.minHeight="0",style.maxWidth="none",style.maxHeight="none"},setElementProp:function(element,position,options){var s,direction=this._direction;if(D.isInHorizontal(direction)){s=this.getComputedCssValues().width;var widthInfo=SU.analysisUnitsValue(s);if(element.style.width=widthInfo.value*position+widthInfo.units,s=this.getComputedCssValues().left){var leftInfo=SU.analysisUnitsValue(s);leftInfo.units===widthInfo.units&&(element.style.left=widthInfo.value*(1-position)+leftInfo.value+leftInfo.units)}}if(D.isInVertical(direction)){s=this.getComputedCssValues().height;var heightInfo=SU.analysisUnitsValue(s);if(element.style.height=heightInfo.value*position+heightInfo.units,s=this.getComputedCssValues().top){var topInfo=SU.analysisUnitsValue(s);topInfo.units===heightInfo.units&&(element.style.top=heightInfo.value*(1-position)+topInfo.value+topInfo.units)}}},getAffectedCssPropNames:function(transOptions){var result=[].concat(this.getTransCssPropNames(transOptions));return result=result.concat(["overflow","min-width","min-height","max-width","max-height"])},getTransCssPropNames:function(transOptions){var direction=this.getActualDirection(this.getElement(),transOptions),result=[];return D.isInHorizontal(direction)&&(result.push("width"),direction&D.RTL&&result.push("left")),D.isInVertical(direction)&&(result.push("height"),direction&D.BTT&&result.push("top")),result},getRefRect:function(transOptions){var result,EU=Kekule.HtmlElementUtils;return this.getCaller()?(result=EU.getElemPageRect(this.getCaller()),Kekule.RectUtils.isZero(result)&&(result=(transOptions||{}).callerPageRect||null)):result=null,result},getActualDirection:function(element,transOptions){element||(element=this.getElement());var D=Kekule.Widget.Direction,EU=Kekule.HtmlElementUtils,result=this.getDirection();if(!result||result===D.AUTO){var refRect=this.getRefRect(transOptions);if(refRect){var refCenter={x:refRect.x+refRect.width/2,y:refRect.y+refRect.height/2},selfPos=EU.getElemPagePos(element),selfDim=EU.getElemClientDimension(element),selfCenter={x:selfPos.x+(selfDim.width||0)/2,y:selfPos.y+(selfDim.height||0)/2},delta=Kekule.CoordUtils.substract(selfCenter,refCenter);if(refRect.width<1)result=delta.x>=0?D.LTR:D.RTL;else if(delta.x<1)result=delta.y>=0?D.TTB:D.BTT;else{var r1=Math.abs(refRect.height/refRect.width),r2=Math.abs(delta.y/delta.x);result=r1>r2?delta.x>=0?D.LTR:D.RTL:delta.y>=0?D.TTB:D.BTT}}else result=D.TTB}return result}}),Kekule.Widget.Css3GrowTransition=Class.create(Kekule.Widget.Css3Transition,{CLASS_NAME:"Kekule.Widget.Css3GrowTransition",initialize:function($super,baseRectOrCaller){$super(),baseRectOrCaller&&(baseRectOrCaller.ownerDocument?this.setBaseElement(baseRectOrCaller):this.setCaller(baseRectOrCaller))},initProperties:function(){this.defineProp("baseRect",{dataType:DataType.HASH})},getRefRect:function(transOptions){var EU=Kekule.HtmlElementUtils,result=null;return this.getBaseRect()?result=this.getBaseRect():this.getCaller()&&(result=EU.getElemPageRect(this.getCaller()),Kekule.RectUtils.isZero(result)&&(result=(transOptions||{}).callerPageRect||null)),result||(result={x:0,y:0,width:0,height:0}),result},canExecute:function($super,element,options){return!0},prepare:function($super,element,caller,options){SU.setDisplay(element,!0),$super(element,caller,options),element.style.overflow="hidden",Kekule.HtmlElementUtils.makePositioned(element);var refRect=this.getRefRect(options),EU=Kekule.HtmlElementUtils,opos=EU.getElemPagePos(element),odim=EU.getElemClientDimension(element),delta={x:opos.x-refRect.x,y:opos.y-refRect.y,width:odim.width-refRect.width,height:odim.height-refRect.height};this._delta=delta,this._clearDimesionConstraints(element)},_clearDimesionConstraints:function(elem){var style=elem.style;style.minWidth="0",style.minHeight="0",style.maxWidth="none",style.maxHeight="none"},setElementProp:function(element,position,options){var compStyles=this.getComputedCssValues(),delta=this._delta,ratio=1-position,style=element.style,info=SU.analysisUnitsValue(compStyles.left);"px"===info.units&&(style.left=info.value-ratio*delta.x+"px");var info=SU.analysisUnitsValue(compStyles.top);"px"===info.units&&(style.top=info.value-ratio*delta.y+"px");var info=SU.analysisUnitsValue(compStyles.width);"px"===info.units&&(style.width=info.value-ratio*delta.width+"px");var info=SU.analysisUnitsValue(compStyles.height);"px"===info.units&&(style.height=info.value-ratio*delta.height+"px")},getAffectedCssPropNames:function(transOptions){var result=[].concat(this.getTransCssPropNames(transOptions));return result=result.concat(["overflow","min-width","min-height","max-width","max-height"])},getTransCssPropNames:function(transOptions){return["left","top","width","height","position"]}}),Kekule.Widget.Css3TransitionSimpleClassCreator={create:function(className,cssProperty,timingFunc,methods){var result=Class.create(Kekule.Widget.Css3Transition,{CLASS_NAME:className,initialize:function($super){$super(),this.setCssProperty(cssProperty),this.setTimingFunc(timingFunc)}});return methods&&(result=ClassEx.extend(result,methods)),result}};Kekule.Widget.Css3TransitionSimpleClassCreator;return Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,ObjectEx=__webpack_require__(0).ObjectEx,DataType=__webpack_require__(0).DataType;module.exports=function(Kekule){Kekule.StyleUtils;Kekule.Widget.ShowHideManager=Class.create(ObjectEx,{CLASS_NAME:"Kekule.Widget.ShowHideManager",initialize:function($super){$super(),this.setEnableTransition(!0),this.setShowDuration(300),this.setHideDuration(300)},initProperties:function(){this.defineProp("enableTransition",{dataType:DataType.BOOL}),this.defineProp("transitionSelector",{dataType:"Kekule.Widget.ShowHideTransitionSelector",serializable:!1}),this.defineProp("showDuration",{dataType:DataType.INT}),this.defineProp("hideDuration",{dataType:DataType.INT})},_getCallerElement:function(caller){return caller?caller.getElement?caller.getElement():Kekule.DomUtils.isElement(caller)?caller:null:null},isUsingTransition:function(){return this.getEnableTransition()&&this.getTransitionSelector()},selectTransition:function(widget,caller,showHideType){var selector=this.getTransitionSelector();if(!selector)return null;var result=selector.selectTransition(widget,caller,showHideType);return result&&caller&&result.setCaller(this._getCallerElement(caller)),result},show:function(widget,caller,callback,showType,extraOptions){var transOptions=Object.extend(extraOptions||{},{from:0,to:1,isAppear:!0,duration:this.getShowDuration()}),transExecutor=this.selectTransition(widget,caller,showType);if(transExecutor&&this.isUsingTransition()&&transExecutor.canExecute(widget.getElement(),transOptions)){var done=function(e){widget.setVisible(!0,!0),widget.setDisplayed(!0,!0),callback&&callback()};return transExecutor.execute(widget.getElement(),this._getCallerElement(caller),done,transOptions)}return widget.setVisible(!0,!0),widget.setDisplayed(!0,!0),callback&&callback(),null},hide:function(widget,caller,callback,hideType,useVisible,extraOptions){var transOptions=Object.extend(extraOptions,{from:1,to:0,isDisappear:!0,duration:this.getHideDuration()}),useVisible=!!extraOptions.useVisible,transExecutor=this.selectTransition(widget,caller,hideType);if(transExecutor&&this.isUsingTransition()&&transExecutor.canExecute(widget.getElement(),transOptions)){var done=function(){widget&&(useVisible?widget.setVisible(!1,!0):widget.setDisplayed(!1,!0)),callback&&callback()};return transExecutor.execute(widget.getElement(),this._getCallerElement(caller),done,transOptions)}return useVisible?widget.setVisible(!1,!0):widget.setDisplayed(!1,!0),callback&&callback(),null}}),Kekule.ClassUtils.makeSingleton(Kekule.Widget.ShowHideManager),Kekule.Widget.showHideManager=Kekule.Widget.ShowHideManager.getInstance(),Kekule.Widget.ShowHideTransitionSelector=Class.create(ObjectEx,{CLASS_NAME:"Kekule.Widget.ShowHideTransitionSelector",initialize:function($super){$super(),this.setTransitionClassMap({})},initProperties:function(){this.defineProp("transitionClassMap",{dataType:DataType.OBJECT,serializable:!1})},_getTransClassOfType:function(showHideType){var map=this.getTransitionClassMap();return map[showHideType]||map[Kekule.Widget.ShowHideType.DEFAULT]},addTransitionClass:function(showHideType,transClass){this.getTransitionClassMap()[showHideType]=transClass},selectTransition:function(widget,caller,showHideType){var transClass;Kekule.Widget.ShowHideType;return transClass=caller?this._getTransClassOfType(showHideType):this._getTransClassOfType(Kekule.Widget.ShowHideType.DEFAULT),transClass?new transClass:null}});var defSelector=new Kekule.Widget.ShowHideTransitionSelector,SHT=Kekule.Widget.ShowHideType;return defSelector.addTransitionClass(SHT.DEFAULT,Kekule.Widget.Css3OpacityTrans),defSelector.addTransitionClass(SHT.DROPDOWN,Kekule.Widget.Css3SlideTransition),defSelector.addTransitionClass(SHT.POPUP,Kekule.Widget.Css3GrowTransition),defSelector.addTransitionClass(SHT.DIALOG,Kekule.Widget.Css3GrowTransition),Kekule.Widget.showHideManager.setTransitionSelector(defSelector),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,ClassEx=__webpack_require__(0).ClassEx,DataType=(__webpack_require__(0).ObjectEx,__webpack_require__(0).DataType);module.exports=function(Kekule){var EV=(Kekule.HtmlElementUtils,Kekule.X.Event),CNS=Kekule.Widget.HtmlClassNames;Kekule.Widget.HtmlClassNames=Object.extend(Kekule.Widget.HtmlClassNames,{RESIZEGRIPPER:"K-Resize-Gripper"});var PS=Class.PropertyScope;return Kekule.Widget.ResizeGripper=Class.create(Kekule.Widget.BaseWidget,{CLASS_NAME:"Kekule.Widget.ResizeGripper",BINDABLE_TAG_NAMES:["div","span"],initialize:function($super,parentOrElementOrDocument){if(this.reactMousemoveBind=this.reactMousemove.bind(this),this.reactMouseupBind=this.reactMouseup.bind(this),this.reactTouchmoveBind=this.reactTouchmove.bind(this),this.reactTouchendBind=this.reactTouchend.bind(this),$super(parentOrElementOrDocument),!this.getTarget())if(this.getParent())this.setTarget(this.getParent());else{var parentElem=this.getElement().parentNode;parentElem&&this.setTarget(parentElem)}},initProperties:function(){this.defineProp("target",{dataType:DataType.OBJECT,serializable:!1,setter:function(value){this.getTarget()!==value&&(this.setPropStoreFieldValue("target",value),this.targetChanged(value))}}),this.defineProp("retainAspectRatio",{dataType:DataType.BOOL}),this.defineProp("isUnderResizing",{dataType:DataType.BOOL,serializable:!1,setter:null,scope:PS.PRIVATE}),this.defineProp("baseCoord",{dataType:DataType.HASH,serializable:!1,scope:PS.PRIVATE}),this.defineProp("baseDimension",{dataType:DataType.HASH,serializable:!1,scope:PS.PRIVATE}),this.defineProp("baseAspectRatio",{dataType:DataType.FLOAT,serializable:!1,scope:PS.PRIVATE})},doGetWidgetClassName:function($super){return $super()+" "+CNS.RESIZEGRIPPER},doCreateRootElement:function(doc){return doc.createElement("span")},targetChanged:function(value){var elem;(elem=this.targetIsWidget(value)?value.getResizerElement?value.getResizerElement():value.getCoreElement():value)&&this.appendToElem(elem)},targetIsWidget:function(target){return target instanceof Kekule.Widget.BaseWidget},getTargetDimension:function(obj){var target=obj||this.getTarget();return this.targetIsWidget(target)?target.getDimension():Kekule.HtmlElementUtils.getElemBoundingClientRect(target,!1)},setTargetDimension:function(obj,width,height){var target=obj||this.getTarget();if(this.targetIsWidget(target))target.setDimension(width,height);else{var style=target.style;style.width=width+"px",style.height=height+"px"}},prepareResizing:function(startingCoord){if(!this.getIsUnderResizing()){var eventReceiver=this._getMoveEventReceiverElem(this.getElement());this._installEventHandlers(eventReceiver),this._setMouseCapture(this.getElement(),!0),this.setBaseCoord(startingCoord);var dim=this.getTargetDimension();this.setBaseDimension(dim),this.setBaseAspectRatio(dim.width/dim.height),this.setPropStoreFieldValue("isUnderResizing",!0)}},doneResizing:function(){this._setMouseCapture(this.getElement(),!1);var eventReceiver=this._getMoveEventReceiverElem(this.getElement());this._uninstallEventHandlers(eventReceiver),this.setBaseCoord(null),this.setBaseDimension(null),this.setPropStoreFieldValue("isUnderResizing",!1)},resizeTo:function(currCoord){var delta=Kekule.CoordUtils.substract(currCoord,this.getBaseCoord()),baseDim=this.getBaseDimension(),w=baseDim.width+delta.x,h=baseDim.height+delta.y;if(this.getRetainAspectRatio()){var baseRatio=this.getBaseAspectRatio();w/h>baseRatio?w=baseRatio*h:w/h<baseRatio&&(h=w/baseRatio)}this.setTargetDimension(this.getTarget(),w,h)},reactMousemove:function(e){if(this.getIsUnderResizing()){var coord={x:e.getScreenX(),y:e.getScreenY()};this.resizeTo(coord),e.stopPropagation(),e.preventDefault()}},reactMouseup:function(e){e.getButton()===Kekule.X.Event.MouseButton.LEFT&&this.getIsUnderResizing()&&(this.doneResizing(),e.preventDefault())},reactTouchmove:function(e){if(this.getIsUnderResizing()){var coord={x:e.getScreenX(),y:e.getScreenY()};this.resizeTo(coord),e.stopPropagation(),e.preventDefault()}},reactTouchend:function(e){this.getIsUnderResizing()&&(this.doneResizing(),e.preventDefault())},_elemSupportCapture:function(elem){return!!elem.setCapture},_setMouseCapture:function(elem,capture){elem&&(capture?elem.setCapture&&elem.setCapture(!0):elem.releaseCapture&&elem.releaseCapture())},_getMoveEventReceiverElem:function(gripperElem){return this._elemSupportCapture(gripperElem)?gripperElem:gripperElem.ownerDocument.documentElement},_installEventHandlers:function(receiver){EV.addListener(receiver,"mousemove",this.reactMousemoveBind),EV.addListener(receiver,"touchmove",this.reactTouchmoveBind),EV.addListener(receiver,"mouseup",this.reactMouseupBind),EV.addListener(receiver,"touchend",this.reactTouchendBind)},_uninstallEventHandlers:function(receiver){EV.removeListener(receiver,"mousemove",this.reactMousemoveBind),EV.removeListener(receiver,"touchmove",this.reactTouchmoveBind),EV.removeListener(receiver,"mouseup",this.reactMouseupBind),EV.removeListener(receiver,"touchend",this.reactTouchendBind)},doReactActiviting:function($super,e){$super(e);var coord={x:e.getScreenX(),y:e.getScreenY()};this.prepareResizing(coord)}}),ClassEx.extend(Kekule.Widget.BaseWidget,{resizableChanged:function(){if(this.getResizable()){var gripper=new Kekule.Widget.ResizeGripper(this);gripper.setRetainAspectRatio(this.getResizeWithAspectRatio()),this.setPropStoreFieldValue("resizeGripper",gripper)}else{var gripper=this.getResizeGripper();gripper&&gripper.finalize(),this.setPropStoreFieldValue("resizeGripper",null)}}}),ClassEx.defineProps(Kekule.Widget.BaseWidget,[{name:"resizable",dataType:DataType.BOOL,setter:function(value){value!==this.getResizable()&&(this.setPropStoreFieldValue("resizable",value),this.resizableChanged())}},{name:"resizeWithAspectRatio",dataType:DataType.BOOL,setter:function(value){this.setPropStoreFieldValue("resizeWithAspectRatio",value),this.getResizeGripper()&&this.getResizeGripper().setRetainAspectRatio(value)}},{name:"isResizing",dataType:DataType.BOOL,serializable:!1,scope:PS.PRIVATE,setter:null,getter:function(){var resizer=this.getResizeGripper();return!!resizer&&resizer.getIsUnderResizing()}},{name:"resizeGripper",dataType:"Kekule.Widget.ResizeGripper",serializable:!1,setter:null,scope:PS.PRIVATE}]),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,ClassEx=__webpack_require__(0).ClassEx,ObjectEx=__webpack_require__(0).ObjectEx,DataType=__webpack_require__(0).DataType;module.exports=function(Kekule){var EU=Kekule.HtmlElementUtils,SU=Kekule.StyleUtils,EV=Kekule.X.Event,PS=Class.PropertyScope;return Kekule.Widget.MoveHelper=Class.create(ObjectEx,{CLASS_NAME:"Kekule.Widget.MoveHelper",initialize:function($super,target,gripper){$super(),this.reactMouseDownBind=this.reactMouseDown.bind(this),this.reactMouseUpBind=this.reactMouseUp.bind(this),this.reactMouseMoveBind=this.reactMouseMove.bind(this),this.reactTouchDownBind=this.reactTouchDown.bind(this),this.reactTouchEndBind=this.reactTouchEnd.bind(this),this.reactTouchMoveBind=this.reactTouchMove.bind(this),this.__$K_initialMoverInfo__={},this.setCssPropX("left").setCssPropY("top").setMovingCursor("move").setMovingCursorDelay(500),this.setTarget(target),this.setGripper(gripper),this.setEnabled(!0)},doFinalize:function($super){this.setGripper(null),$super()},initProperties:function(){this.defineProp("enabled",{dataType:DataType.BOOL}),this.defineProp("target",{dataType:DataType.OBJECT,serializable:!1}),this.defineProp("gripper",{dataType:DataType.OBJECT,serializable:!1,getter:function(){return this.getPropStoreFieldValue("gripper")||this.getTarget()},setter:function(value){var oldValue=this.getPropStoreFieldValue("gripper");value!==oldValue&&(this.setPropStoreFieldValue("gripper",value),this.gripperChanged(value,oldValue))}}),this.defineProp("isMoving",{dataType:DataType.BOOL,serializable:!1}),this.defineProp("cssPropX",{dataType:DataType.STRING}),this.defineProp("cssPropY",{dataType:DataType.STRING}),this.defineProp("movingCursor",{dataType:DataType.STRING}),this.defineProp("movingCursorDelay",{dataType:DataType.INT}),this.defineProp("movable",{dataType:DataType.BOOL,setter:null,getter:function(){return this.getEnabled()&&this.getGripper()}})},_objIsWidget:function(obj){return obj instanceof Kekule.Widget.BaseWidget},_getElement:function(obj){return this._objIsWidget(obj)?obj.getElement():obj},getTargetElement:function(){var t=this.getTarget();return this._objIsWidget(t)?t.getElement():t},getGripperElement:function(){var g=this.getGripper();return this._objIsWidget(g)?g.getElement():g},gripperChanged:function(newGripper,oldGripper){oldGripper&&this.installEventHandlers(this._getElement(oldGripper)),newGripper&&this.installEventHandlers(this._getElement(newGripper))},installEventHandlers:function(gripperElem){gripperElem&&(EV.addListener(gripperElem,"mousedown",this.reactMouseDownBind),EV.addListener(gripperElem,"touchstart",this.reactTouchDownBind))},uninstallEventHandlers:function(gripperElem){gripperElem&&(EV.removeListener(gripperElem,"mousedown",this.reactMouseDownBind),EV.removeListener(gripperElem,"touchstart",this.reactTouchDownBind))},_elemSupportCapture:function(elem){return!!elem.setCapture},_getMoveEventReceiverElem:function(gripperElem){return this._elemSupportCapture(gripperElem)?gripperElem:gripperElem.ownerDocument.documentElement},setMouseCapture:function(capture){var gripperElem=this.getGripperElement();gripperElem&&(capture?gripperElem.setCapture&&gripperElem.setCapture(!0):gripperElem.releaseCapture&&gripperElem.releaseCapture())},beginMoving:function(initialScreenCoord){if(!this.getIsMoving()){var targetElem=this.getTargetElement();EU.makePositioned(targetElem),this.saveInitialInformation(initialScreenCoord);var moveReceiver=this._getMoveEventReceiverElem(this.getGripperElement());EV.addListener(moveReceiver,"mousemove",this.reactMouseMoveBind),EV.addListener(moveReceiver,"touchmove",this.reactTouchMoveBind),EV.addListener(moveReceiver,"mouseup",this.reactMouseUpBind),EV.addListener(moveReceiver,"touchend",this.reactTouchEndBind),this.setMouseCapture(!0),this._setCursorHandle=this.delaySetMoveCursor(),this.setIsMoving(!0)}},endMoving:function(){this.setIsMoving(!1),this.setMouseCapture(!1);var gripper=this.getGripperElement(),moveReceiver=this._getMoveEventReceiverElem(gripper);if(EV.removeListener(moveReceiver,"mousemove",this.reactMouseMoveBind),EV.removeListener(moveReceiver,"touchmove",this.reactTouchMoveBind),EV.removeListener(moveReceiver,"mouseup",this.reactMouseUpBind),EV.removeListener(moveReceiver,"touchend",this.reactTouchEndBind),this.clearCursorSetter(),gripper){var cursor=this.__$K_initialMoverInfo__.cursor;gripper.style.cursor=cursor||"",this.__$K_initialMoverInfo__.cursor=null}},moveTo:function(newPointerCoord){this.clearCursorSetter(),this.doSetMoveCursor();var elem=this.getTargetElement();if(elem){var initInfo=this.__$K_initialMoverInfo__,coordDelta=Kekule.CoordUtils.substract(newPointerCoord,initInfo.pointerCoord);"right"===(this.getCssPropX()||"").toLowerCase()?elem.style.right=initInfo.elemCoord.x-coordDelta.x+"px":elem.style.left=initInfo.elemCoord.x+coordDelta.x+"px","bottom"===(this.getCssPropY()||"").toLowerCase()?elem.style.bottom=initInfo.elemCoord.y-coordDelta.y+"px":elem.style.top=initInfo.elemCoord.y+coordDelta.y+"px"}},delaySetMoveCursor:function(){return setTimeout(this.doSetMoveCursor.bind(this),this.getMovingCursorDelay()||0)},doSetMoveCursor:function(){var gripper=this.getGripperElement();gripper&&this.getMovingCursor()&&(gripper.style.cursor=this.getMovingCursor())},clearCursorSetter:function(){this._setCursorHandle&&clearTimeout(this._setCursorHandle)},saveInitialInformation:function(pointerScreenCoord){var elem=this.getTargetElement();if(elem){this.__$K_initialMoverInfo__.pointerCoord=pointerScreenCoord;var coord,p=(SU.getComputedStyle(elem,"position")||"").toLowerCase(),cssPropX=(this.getCssPropX()||"left").toLowerCase(),cssPropY=(this.getCssPropY()||"top").toLowerCase();if("relative"===p){coord={x:SU.analysisUnitsValue(SU.getComputedStyle(elem,"left")).value||0,y:SU.analysisUnitsValue(SU.getComputedStyle(elem,"top")).value||0},cssPropX="left",cssPropY="top"}else coord={x:elem.offsetLeft,y:elem.offsetTop};var dim=EU.getElemOffsetDimension(elem);"right"===cssPropX&&(coord.x+=dim.width),"bottom"===cssPropY&&(coord.y+=dim.height),this.__$K_initialMoverInfo__.elemCoord=coord,this.getGripperElement()&&(this.__$K_initialMoverInfo__.cursor=this.getGripperElement().style.cursor)}},reactMouseDown:function(e){this.getTargetElement()&&this.getEnabled()&&e.getButton()===EV.MouseButton.LEFT&&(this.beginMoving({x:e.getScreenX(),y:e.getScreenY()},e.getTarget()),e.preventDefault())},reactMouseUp:function(e){e.getButton()===EV.MouseButton.LEFT&&this.getIsMoving()&&(this.endMoving(),e.preventDefault())},reactMouseMove:function(e){if(this.getIsMoving()){var mouseCoord={x:e.getScreenX(),y:e.getScreenY()};this.moveTo(mouseCoord),e.preventDefault()}},reactTouchDown:function(e){this.getEnabled()&&(this.beginMoving({x:e.getScreenX(),y:e.getScreenY()},e.getTarget()),e.preventDefault())},reactTouchEnd:function(e){this.getIsMoving()&&(this.endMoving(),e.preventDefault())},reactTouchMove:function(e){if(this.getIsMoving()){var coord={x:e.getScreenX(),y:e.getScreenY()};this.moveTo(coord),e.preventDefault()}}}),ClassEx.extend(Kekule.Widget.BaseWidget,{_getMoveHelper:function(canCreate){var result=this.getMoveHelper();return!result&&canCreate&&(result=new Kekule.Widget.MoveHelper(this)),result},movingGripperChanged:function(){var gripper=this.getMovingGripper();if(gripper){var helper=this._getMoveHelper(!0);helper.setGripper(gripper)}else{var helper=this._getMoveHelper(!1);helper&&helper.setGripper(null)}}}),ClassEx.defineProps(Kekule.Widget.BaseWidget,[{name:"movable",dataType:DataType.BOOL,getter:function(){return this._getMoveHelper()&&this._getMoveHelper().getMovable()},setter:function(value){if(value!==this.getMovable())if(value)this.setMovingGripper(this.getDefaultMovingGripper&&this.getDefaultMovingGripper()||this);else{var helper=this._getMoveHelper();helper&&helper.setEnabled(!1)}}},{name:"movingGripper",dataType:DataType.OBJECT,setter:function(value){value!==this.getMovingGripper()&&(this.setPropStoreFieldValue("movingGripper",value),this.movingGripperChanged())}},{name:"isMoving",dataType:DataType.BOOL,serializable:!1,scope:PS.PRIVATE,setter:null,getter:function(){var helper=this.getMoveHelper();return!!helper&&helper.getIsMoving()}},{name:"moveHelper",dataType:"Kekule.Widget.MoveHelper",serializable:!1,setter:null,scope:PS.PRIVATE}]),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,DataType=(__webpack_require__(0).ClassEx,__webpack_require__(0).ObjectEx,__webpack_require__(0).DataType);module.exports=function(Kekule){var EU=Kekule.HtmlElementUtils,CNS=Kekule.Widget.HtmlClassNames;return Kekule.Widget.Glyph=Class.create(Kekule.Widget.BaseWidget,{CLASS_NAME:"Kekule.Widget.Glyph",initialize:function($super,parentOrElementOrDocument,normalImgInfo){this._imgElem=null,$super(parentOrElementOrDocument),normalImgInfo&&this.setNormalInfo(normalImgInfo)},initProperties:function(){this.defineImgInfoProp("normalInfo",{dataType:DataType.HASH}),this.defineImgInfoProp("hoverInfo",{dataType:DataType.HASH}),this.defineImgInfoProp("focusedInfo",{dataType:DataType.HASH}),this.defineImgInfoProp("activeInfo",{dataType:DataType.HASH}),this.defineImgInfoProp("disabledInfo",{dataType:DataType.HASH})},defineImgInfoProp:function(propName,options){var ops=Object.extend({setter:function(value){value?this.setPropStoreFieldValue(propName,Object.extend({},value)):this.setPropStoreFieldValue(propName,null),this.imgInfoChanged()}},options);return this.defineProp(propName,ops)},doGetWidgetClassName:function(){return"K-Glyph"},doCreateRootElement:function(doc){return doc.createElement("span")},doBindElement:function($super,element){$super(),this.createImgContainer(element)},createImgContainer:function(parentElem,imgInfo){var doc=parentElem.ownerDocument;this._imgElem=doc.createElement("span"),this._imgElem.className=CNS.FULLFILL,parentElem.innerHTML="",parentElem.appendChild(this._imgElem)},imgInfoChanged:function(){this.updateImg()},stateChanged:function($super){$super(),this.updateImg()},updateImg:function(){var WS=Kekule.Widget.State,state=this.getState(),imgInfo=state===WS.DISABLED?this.getDisabledInfo():state===WS.ACTIVE?this.getActiveInfo()||this.getHoverInfo()||this.getFocusedInfo():state===WS.HOVER?this.getHoverInfo():state===WS.FOCUSED?this.getFocusedInfo():this.getNormalInfo();imgInfo=imgInfo||this.getNormalInfo(),this.showImgOfInfo(imgInfo)},showImgOfInfo:function(imgInfo){var elem=this._imgElem;elem&&(imgInfo?(imgInfo.className?(elem.className=CNS.FULLFILL,EU.addClass(elem,imgInfo.className)):elem.className=CNS.FULLFILL,elem.style.backgroundImage=imgInfo.src?"url("+imgInfo.src+")":"",elem.style.backgroundPosition=imgInfo.position||"",elem.style.backgroundRepeat=imgInfo.repeat||"no-repeat"):elem.style.backgroundImage="")}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,DataType=(__webpack_require__(0).ClassEx,__webpack_require__(0).ObjectEx,__webpack_require__(0).DataType);module.exports=function(Kekule){Kekule.Widget.HtmlClassNames=Object.extend(Kekule.Widget.HtmlClassNames,{CONTAINER:"K-Container",PANEL:"K-Panel",TOOLBAR:"K-Toolbar"});var CNS=(Kekule.HtmlElementUtils,Kekule.Widget.HtmlClassNames);return Kekule.Widget.Container=Class.create(Kekule.Widget.BaseWidget,{CLASS_NAME:"Kekule.Widget.Container",initialize:function($super,parentOrElementOrDocument){$super(parentOrElementOrDocument),this.reactShowStateChangeBind=this.reactShowStateChange.bind(this),this.addEventListener("showStateChange",this.reactShowStateChangeBind)},finalize:function($super){this.removeEventListener("showStateChange",this.reactShowStateChangeBind),this.clearWidgets(),$super()},initProperties:function(){this.defineChildDimensionRelatedProp("childWidth"),this.defineChildDimensionRelatedProp("childHeight"),this.defineChildDimensionRelatedProp("childMargin"),this.defineProp("firstChild",{dataType:"Kekule.Widget.BaseWidget",serializable:!1,setter:null,scope:Class.PropertyScope.PUBLIC}),this.defineProp("lastChild",{dataType:"Kekule.Widget.BaseWidget",serializable:!1,setter:null,scope:Class.PropertyScope.PUBLIC}),this.defineProp("allowChildWrap",{dataType:DataType.BOOL,serializable:!1,setter:function(value){this.setPropStoreFieldValue("allowChildWrap",value),value?this.removeClassName(CNS.NOWRAP):this.addClassName(CNS.NOWRAP)}})},initPropValues:function($super){$super(),this.setAllowChildWrap(!0)},defineChildDimensionRelatedProp:function(propName,options){var ops=Object.extend({dataType:DataType.STRING,setter:function(value){this.setPropStoreFieldValue(propName,value),this.updateChildSizes()}},options||{});return this.defineProp(propName,ops)},doGetWidgetClassName:function(){return CNS.CONTAINER},doCreateRootElement:function(doc){return doc.createElement("span")},getContainerElement:function(){return this.getElement()},appendWidget:function(widget){return widget.setParent(this),this},insertWidgetBefore:function(widget,refWidget){return widget.insertToWidget(this,refWidget),this},removeWidget:function(widget,doNotFinalize){widget.setParent(null),doNotFinalize||widget.finalize()},clearWidgets:function(doNotFinalize){for(var children=this.getChildWidgets(),i=children.length-1;i>=0;--i){var child=children[i];this.removeWidget(child,doNotFinalize)}},_insertChildWidget:function(widget,refWidget){var refElem=refWidget?refWidget.getElement():null,containerElem=this.getContainerElement();containerElem&&(refElem?containerElem.insertBefore(widget.getElement(),refElem):containerElem.appendChild(widget.getElement()))},reactShowStateChange:function(e){this.childrenModified()},childrenModified:function($super){$super();for(var widgets=this.getChildWidgets(),length=widgets.length,index=0,curr=widgets[index];curr&&!curr.isShown(!0)&&index<length;)++index,curr=widgets[index];for(var newFirst=index<length?curr:null,index=length-1,curr=widgets[length-1];curr&&!curr.isShown(!0)&&index>=0;)--index,curr=widgets[index];var newLast=index>=0?curr:null,oldFirst=this.getFirstChild(),oldLast=this.getLastChild();newFirst!==oldFirst&&(oldFirst&&oldFirst.removeClassName(CNS.FIRST_CHILD),newFirst&&newFirst.addClassName(CNS.FIRST_CHILD),this.setPropStoreFieldValue("firstChild",newFirst)),newLast!==oldLast&&(oldLast&&oldLast.removeClassName(CNS.LAST_CHILD),newLast&&newLast.addClassName(CNS.LAST_CHILD),this.setPropStoreFieldValue("lastChild",newLast))},childWidgetAdded:function($super,widget){$super(widget);var w=this.getChildWidth();w&&widget.setWidth(w);var h=this.getChildHeight();h&&widget.setHeight(h);var margin=this.getChildMargin();margin&&(widget.getStyle().margin=margin),this._insertChildWidget(widget,null)},childWidgetRemoved:function($super,widget){$super(widget)},childWidgetMoved:function($super,widget,newIndex){$super(widget,newIndex);var elem=widget.getElement(),refWidget=this.getChildWidgets()[newIndex+1],refElem=refWidget?refWidget.getElement():null;refElem?this.getContainerElement().insertBefore(elem,refElem):this.getContainerElement().appendChild(elem)},updateChildSizes:function(){for(var children=this.getChildWidgets(),w=this.getChildWidth()||"",h=this.getChildHeight()||"",margin=this.getChildMargin()||"",i=(this.getLayout(),0),l=children.length;i<l;++i){var widget=children[i];widget.setWidth(w),widget.setHeight(h),widget.getStyle().margin=margin}}}),Kekule.Widget.Panel=Class.create(Kekule.Widget.Container,{CLASS_NAME:"Kekule.Widget.Panel",initPropValues:function($super){$super(),this.setUseCornerDecoration(!0)},doGetWidgetClassName:function($super){return $super()+" "+CNS.PANEL}}),Kekule.Widget.WidgetGroup=Class.create(Kekule.Widget.Container,{CLASS_NAME:"Kekule.Widget.WidgetGroup",initialize:function($super,parentOrElementOrDocument){$super(parentOrElementOrDocument)},initPropValues:function($super){$super(),this.setUseCornerDecoration(!0)},doObjectChange:function($super,modifiedPropNames){$super(modifiedPropNames),modifiedPropNames.indexOf("useCornerDecoration")>=0&&this._updateChildStyles()},childWidgetAdded:function($super,widget){widget.setUseCornerDecoration&&widget.setUseCornerDecoration(!1),$super(widget)},layoutChanged:function($super){$super(),this._updateChildStyles()},childrenModified:function($super){$super(),this._updateChildStyles()},_updateChildStyles:function(){for(var first=(Kekule.Widget.Layout,this.getLayout(),this.getFirstChild()),last=this.getLastChild(),useCorner=this.getUseCornerDecoration(),children=this.getChildWidgets(),allRoundClasses=[CNS.CORNER_LEADING,CNS.CORNER_TAILING],i=0,l=children.length;i<l;++i){var child=children[i];child.removeClassName(allRoundClasses),child===first&&useCorner&&child.addClassName(CNS.CORNER_LEADING),child===last&&useCorner&&child.addClassName(CNS.CORNER_TAILING)}}}),Kekule.Widget.Toolbar=Class.create(Kekule.Widget.WidgetGroup,{CLASS_NAME:"Kekule.Widget.Toolbar",finalize:function($super){var map=this.getChildWidgetInternalNameMap();map&&map.finalize(),$super()},initProperties:function(){this.defineProp("childDefs",{dataType:DataType.ARRAY,setter:function(value){this.setPropStoreFieldValue("childDefs",value),this.recreateChildrenByDefs()}}),this.defineProp("childWidgetInternalNameMap",{dataType:DataType.OBJECT,serializable:!1})},doGetWidgetClassName:function($super){return $super()+" "+CNS.TOOLBAR},doSetShowText:function($super,value){$super(value),this._updateAllChildTextGlyphStyles()},doSetShowGlyph:function($super,value){$super(value),this._updateAllChildTextGlyphStyles()},childWidgetAdded:function($super,widget){$super(widget),this._updateChildTextGlyphStyles(widget)},_updateChildTextGlyphStyles:function(widget){widget.setShowText&&widget.setShowText(this.getShowText()),widget.setShowGlyph&&widget.setShowGlyph(this.getShowGlyph())},_updateAllChildTextGlyphStyles:function(){for(var children=this.getChildWidgets(),i=children.length-1;i>=0;--i)this._updateChildTextGlyphStyles(children[i])},recreateChildrenByDefs:function(){var defs=this.getChildDefs()||[];this.clearWidgets();var internalNameMap=new Kekule.MapEx(!0);this.setChildWidgetInternalNameMap(internalNameMap);for(var defWidgetClassName=this.getDefaultChildWidgetClassName(),i=0,l=defs.length;i<l;++i){var def=defs[i];def.widget||def.widgetClass||!defWidgetClassName||(def=Object.extend({widget:defWidgetClassName},def));var w=Kekule.Widget.createFromHash(this,def);w&&(w.appendToWidget(this),def.internalName&&internalNameMap.set(def.internalName,w))}},getDefaultChildWidgetClassName:function(){return null},getChildWidgetByInternalName:function(name){var map=this.getChildWidgetInternalNameMap();return map?map.get(name):null}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,DataType=(__webpack_require__(0).ClassEx,__webpack_require__(0).ObjectEx,__webpack_require__(0).DataType);module.exports=function(Kekule){var DU=Kekule.DomUtils,CNS=(Kekule.HtmlElementUtils,Kekule.Widget.HtmlClassNames);return Kekule.Widget.HtmlClassNames=Object.extend(Kekule.Widget.HtmlClassNames,{MENU:"K-Menu",POPUPMENU:"K-PopupMenu",MENUBAR:"K-MenuBar",MENUITEM:"K-MenuItem",MENUITEM_NORMAL:"K-MenuItem-Normal",MENUITEM_SEPARATOR:"K-MenuItem-Separator",SUBMENU_MARKER:"K-SubMenu-Marker",CHECKMENU_MARKER:"K-CheckMenu-Marker"}),Kekule.Widget.MenuItem=Class.create(Kekule.Widget.Container,{CLASS_NAME:"Kekule.Widget.MenuItem",BINDABLE_TAG_NAMES:["li"],SUB_MENU_TAGS:["ol","ul"],initialize:function($super,parentOrElementOrDocument,text){$super(parentOrElementOrDocument),text&&this.setText(text),this._subMenuMarker=null,this._checkMarker=null},initProperties:function(){this.defineProp("text",{dataType:DataType.STRING,getter:function(){return Kekule.HtmlElementUtils.getInnerText(this.getElement())},setter:function(value){value===Kekule.Widget.MenuItem.SEPARATOR_TEXT?this.setIsSeparator(!0):(value&&this.setIsSeparator(!1),this.changeContentText(value))}}),this.defineProp("checked",{dataType:DataType.BOOL,setter:function(value){this.getPropStoreFieldValue("checked")!==value&&(this.setPropStoreFieldValue("checked",value),this.checkChanged())}}),this.defineProp("autoCheck",{dataType:DataType.BOOL}),this.defineProp("isSeparator",{dataType:DataType.BOOL,setter:function(value){this.setPropStoreFieldValue("isSeparator",value),this.isSeparatorChanged(value)}})},initPropValues:function($super){$super(),this.setUseCornerDecoration(!1),this.setIsSeparator(!1)},doGetWidgetClassName:function($super){return $super()+" "+CNS.MENUITEM},doCreateRootElement:function(doc){return doc.createElement("li")},changeContentText:function(newText){this.getElement().innerHTML=newText||""},isSeparatorChanged:function(isSeparator){isSeparator?(this.setText("&nbsp;"),this.removeClassName(CNS.MENUITEM_NORMAL),this.addClassName(CNS.MENUITEM_SEPARATOR),this.setStatic(!0)):(this.removeClassName(CNS.MENUITEM_SEPARATOR),this.addClassName(CNS.MENUITEM_NORMAL),this.setStatic(!1))},doBindElement:function($super,element){$super(element);for(var children=DU.getDirectChildElems(element),i=0,l=children.length;i<l;++i){var child=children[i];child.nodeType===Node.ELEMENT_NODE&&this.bindSubMenu(child),child=child.nextSibling}},doDomElemAdded:function(elem){Kekule.Widget.getWidgetOnElem(elem)||this.bindSubMenu(elem)},checkChanged:function(){this.getChecked()?(this._createCheckMarker(),this.addClassName(CNS.STATE_CHECKED),this.invokeEvent("check")):this.removeClassName(CNS.STATE_CHECKED)},_createCheckMarker:function(){var result=this._checkMarker;if(!result){var result=this.getDocument().createElement("span");result.className=CNS.CHECKMENU_MARKER,this.getElement().appendChild(result),this._checkMarker=result}return result},_removeCheckMarker:function(){this._checkMarker&&(this._checkMarker.parentNode.removeChild(this._checkMarker),this._checkMarker=null)},childWidgetAdded:function($super,widget){if($super(widget),widget instanceof Kekule.Widget.Menu)widget.setIsSubMenu(!0);else if(widget instanceof Kekule.Widget.MenuItem){var menu=this.getSubMenu(!0);(function(){widget.setParent(menu),widget.appendToWidget(menu)}).defer(10)}},childrenModified:function($super){$super(),this.subMenuChanged()},bindSubMenu:function(elem){var tagName=elem.tagName.toLowerCase();if("ul"===tagName||"ol"===tagName){var result=new Kekule.Widget.PopupMenu(elem);return this.addSubMenu(result),result}},subMenuChanged:function(){var subMenu=this.getSubMenu();subMenu?this._createSubMenuMarker(subMenu):this._removeSubMenuMarker()},getSubMenu:function(canCreate){for(var children=this.getChildWidgets(),i=0,l=children.length;i<l;++i){var w=children[i];if(w instanceof Kekule.Widget.Menu)return w}return canCreate?this.createSubMenu():null},addSubMenu:function(subMenu){return subMenu.appendToWidget(this),this},removeSubMenu:function(subMenu){return subMenu.setParent(null),subMenu},createSubMenu:function(){var result=new Kekule.Widget.PopupMenu(this);return this.addSubMenu(result),result},_createSubMenuMarker:function(subMenu){var result=this._subMenuMarker;if(!result){var result=this.getDocument().createElement("span");result.className=CNS.SUBMENU_MARKER,this.getElement().appendChild(result),this._subMenuMarker=result}return result},_removeSubMenuMarker:function(){this._subMenuMarker&&(this._subMenuMarker.parentNode.removeChild(this._subMenuMarker),this._subMenuMarker=null)},isLeafItem:function(){var elem=this.getElement();return!(elem.getElementsByTagName("ul").length||elem.getElementsByTagName("ol").length)},isPeriodicalExecuting:function($super){return $super()&&this.getIsActive()},doReactActiviting:function($super,e){$super(e),this.isLeafItem()&&this.getEnablePeriodicalExec()&&this.startPeriodicalExec(e)},doReactDeactiviting:function($super,e){this.isLeafItem()&&(this.stopPeriodicalExec(),this.getIsActive()&&(this.execute(e),this.getAutoCheck()&&this.setChecked(!this.getChecked()),this.notifyDeactivated()))},notifyDeactivated:function(){var p=this.getParent();p&&p.childDeactivated&&p.childDeactivated(this)},childDeactivated:function(childWidget){var p=this.getParent();p&&p.childDeactivated&&p.childDeactivated(this)}}),Kekule.Widget.MenuItem.SEPARATOR_TEXT="-",Kekule.Widget.MenuItem.createFromHash=function(parentOrElementOrDocument,defHash){var def=defHash;return DataType.isSimpleValue(def)&&(def=def===Kekule.Widget.MenuItem.SEPARATOR_TEXT?{isSeparator:!0}:{text:def}),def.widget||def.widgetClass||(def.widget=Kekule.Widget.MenuItem),Kekule.Widget.createFromHash(parentOrElementOrDocument,def)},Kekule.Widget.Menu=Class.create(Kekule.Widget.Container,{CLASS_NAME:"Kekule.Widget.Menu",BINDABLE_TAG_NAMES:["ol","ul"],MENU_ITEM_TAG:"li",initialize:function($super,parentOrElementOrDocument){$super(parentOrElementOrDocument)},initProperties:function(){this.defineProp("isSubMenu",{dataType:DataType.BOOL,serializable:!1,setter:function(value){this.setPropStoreFieldValue("isSubMenu",value),value&&this.setLayout(Kekule.Widget.Layout.VERTICAL)}})},initPropValues:function($super){$super(),this.setUseCornerDecoration(!0)},doGetWidgetClassName:function($super){return $super()+" "+CNS.MENU},doCreateRootElement:function(doc){return doc.createElement("ul")},doBindElement:function($super,element){$super(element);for(var children=Kekule.DomUtils.getDirectChildElems(element),i=0,l=children.length;i<l;++i){var child=children[i];child.nodeType===Node.ELEMENT_NODE&&this.bindMenuItem(child),child=child.nextSibling}},doDomElemAdded:function(elem){this.bindMenuItem(elem)},bindMenuItem:function(elem){if("li"===elem.tagName.toLowerCase()){var result=new Kekule.Widget.MenuItem(elem);return result.setParent(this),result}},getSubMenuTagName:function(){return this.getElement().tagName},getMenuItems:function(rootMenuElem){rootMenuElem||(rootMenuElem=this.getElement());for(var elems=DU.getDirectChildElems(rootMenuElem,this.MENU_ITEM_TAG),result=[],i=0,l=elems.length;i<l;++i){var w=Kekule.Widget.getWidgetOnElem(elems[i]);w&&w instanceof Kekule.Widget.MenuItem&&result.push(w)}return result},insertMenuItem:function(menuItem,refItem){return menuItem.insertToWidget(this,refItem),this},appendMenuItem:function(menuItem){return menuItem.appendToWidget(this),this},removeMenuItem:function(menuItem,doNotFinalize){menuItem.setParent(null),doNotFinalize||menuItem.finalize()},clearMenuItems:function(doNotFinalize){return this.clearWidgets(doNotFinalize),this},isTopLevel:function(){var p=this.getParent();return!p||!(p instanceof Kekule.Widget.MenuItem||p instanceof Kekule.Widget.Menu)},childDeactivated:function(childWidget){var p=this.getParent();p&&p.childDeactivated&&p.childDeactivated(this)},createChildrenByDefs:function(defs){for(var i=0,l=defs.length;i<l;++i){var def=defs[i];Kekule.Widget.MenuItem.createFromHash(this,def)}return this}}),Kekule.Widget.PopupMenu=Class.create(Kekule.Widget.Menu,{CLASS_NAME:"Kekule.Widget.PopupMenu",initPropValues:function($super){$super(),this.setLayout(Kekule.Widget.Layout.VERTICAL)},doGetWidgetClassName:function($super){return $super()+" "+CNS.POPUPMENU},childDeactivated:function(childWidget){}}),Kekule.Widget.MenuBar=Class.create(Kekule.Widget.Menu,{CLASS_NAME:"Kekule.Widget.MenuBar",doGetWidgetClassName:function($super){return $super()+" "+CNS.MENUBAR}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,DataType=(__webpack_require__(0).ClassEx,__webpack_require__(0).ObjectEx,__webpack_require__(0).DataType);module.exports=function(Kekule){var EU=Kekule.HtmlElementUtils,CNS=Kekule.Widget.HtmlClassNames;return Kekule.Widget.HtmlClassNames=Object.extend(Kekule.Widget.HtmlClassNames,{BUTTON:"K-Button",BUTTON_KINDED:"K-Button-Kinded",BUTTON_GROUP:"K-Button-Group",COMPACT_BUTTON:"K-Compact-Button",BTN_COMPACT_MARK:"K-Compact-Mark"}),Kekule.Widget.Button=Class.create(Kekule.Widget.BaseWidget,{CLASS_NAME:"Kekule.Widget.Button",BINDABLE_TAG_NAMES:["input","button","a","label"],CSS_DROPDOWN_CLASS_NAME:"K-DropDownMark",DEF_GLYPH_WIDTH:"16px",DEF_GLYPH_HEIGHT:"16px",initialize:function($super,parentOrElementOrDocument,text){this._elemTextPart=null,this._elemLeadingGlyphPart=null,this._elemTailingGlyphPart=null,$super(parentOrElementOrDocument),text&&this.setText(text)},initProperties:function(){this.defineElemAttribMappingProp("actionType","type"),this.defineProp("text",{dataType:DataType.STRING,serializable:!1,getter:function(){var elem=this._elemTextPart||this.getElement();return elem?elem.innerHTML:null},setter:function(value){this.changeContentText(value)}}),this.defineProp("leadingGlyph",{dataType:"Kekule.Widget.Glyph",serializable:!1,scope:Class.PropertyScope.PUBLIC,setter:null,getter:function(canCreate){var result=this.getPropStoreFieldValue("leadingGlyph");return!result&&canCreate&&(result=this._createDefaultGlyphWidget(this._elemLeadingGlyphPart),this.setPropStoreFieldValue("leadingGlyph",result)),result}}),this.defineProp("tailingGlyph",{dataType:"Kekule.Widget.Glyph",serializable:!1,scope:Class.PropertyScope.PUBLIC,setter:null,getter:function(canCreate){var result=this.getPropStoreFieldValue("tailingGlyph");return!result&&canCreate&&(result=this._createDefaultGlyphWidget(this._elemTailingGlyphPart),this.setPropStoreFieldValue("tailingGlyph",result)),result}}),this.defineProp("showLeadingGlyph",{dataType:DataType.BOOL,scope:Class.PropertyScope.PUBLIC,setter:function(value){this.setPropStoreFieldValue("showLeadingGlyph",value),this._elemLeadingGlyphPart.style.display=value&&this.getShowGlyph()?"":"none"}}),this.defineProp("showTailingGlyph",{dataType:DataType.BOOL,scope:Class.PropertyScope.PUBLIC,setter:function(value){this.setPropStoreFieldValue("showTailingGlyph",value),this._elemTailingGlyphPart.style.display=value&&this.getShowGlyph()?"":"none"}}),this.defineProp("buttonKind",{dataType:DataType.STRING,setter:function(value){var old=this.getButtonKind();value!==old&&(this.cancelButtonKind(old),this.applyButtonKind(value),this.setPropStoreFieldValue("buttonKind",value))}})},initPropValues:function($super){$super(),this.setPropStoreFieldValue("showText",!0),this.setPropStoreFieldValue("showGlyph",!0),this.setPropStoreFieldValue("showLeadingGlyph",!0),this.setPropStoreFieldValue("showTailingGlyph",!0),this.setPropStoreFieldValue("useCornerDecoration",!0),this.setAllowTextWrap(!1)},_createDefaultGlyphWidget:function(parentElem){var g=new Kekule.Widget.Glyph(this);return g.setWidth(this.DEF_GLYPH_WIDTH).setHeight(this.DEF_GLYPH_HEIGHT),g.setStatic(!0).setInheritState(!0).setInheritStatic(!0).setInheritEnabled(!0),g.appendToElem(parentElem),g},doGetWidgetClassName:function($super){return $super()+" "+CNS.BUTTON},doCreateRootElement:function(doc){var result=doc.createElement("button");return result.setAttribute("type","button"),result},doBindElement:function($super,element){$super(element);var text=element.innerHTML||"";element.innerHTML="",this._elemTextPart=this.createTextContent(text,element),this._elemLeadingGlyphPart=this.createGlyphContent(element,this._elemTextPart,CNS.PART_PRI_GLYPH_CONTENT),this._elemTailingGlyphPart=this.createGlyphContent(element,null,CNS.PART_ASSOC_GLYPH_CONTENT),this.getUseCornerDecoration()&&EU.addClass(element,CNS.CORNER_ALL)},changeContentText:function(newText){this._elemTextPart.innerHTML=newText||""},isPeriodicalExecuting:function($super){return $super()&&this.getIsActive()},doReactActiviting:function($super,e){$super(e),this.getEnablePeriodicalExec()&&this.startPeriodicalExec(e)},doReactDeactiviting:function($super,e){this.stopPeriodicalExec(),this.getIsActive()&&this.execute(e)},cancelButtonKind:function(kind){kind&&(this.removeClassName(kind),this.removeClassName(CNS.BUTTON_KINDED))},applyButtonKind:function(kind){kind&&(this.addClassName(CNS.BUTTON_KINDED),this.addClassName(kind))}}),Kekule.Widget.Button.Kinds={DROPDOWN:"K-Kind-DropDown",POPUP:"K-Kind-Popup",SEARCH:"K-Kind-Search",EDIT:"K-Kind-Edit"},Kekule.Widget.CheckButton=Class.create(Kekule.Widget.Button,{CLASS_NAME:"Kekule.Widget.CheckButton",initialize:function($super,parentOrElementOrDocument,text){$super(parentOrElementOrDocument,text)},initProperties:function(){this.defineProp("checked",{dataType:DataType.BOOL,setter:function(value){this.getPropStoreFieldValue("checked")!==value&&(this.setPropStoreFieldValue("checked",value),this.checkChanged(),this.stateChanged())}}),this.defineProp("autoCheck",{dataType:DataType.BOOL})},initPropValues:function($super){$super(),this.setAutoCheck(!0)},checkChanged:function(){this.getChecked()?this.invokeEvent("check"):this.invokeEvent("uncheck"),this.invokeEvent("checkChange",{checked:this.getChecked()})},getStateClassName:function($super,state){return $super(this.getChecked()?Kekule.Widget.State.ACTIVE:state)},doReactDeactiviting:function($super,e){var oldChecked=this.getChecked();$super(e),this.getAutoCheck()&&this._doToggleCheckOnSelf(oldChecked)},_doToggleCheckOnSelf:function(oldChecked){this.getEnabled()&&this.setChecked(/*!this.getChecked()*/!oldChecked)}}),Kekule.Widget.RadioButton=Class.create(Kekule.Widget.CheckButton,{CLASS_NAME:"Kekule.Widget.RadioButton",initialize:function($super,parentOrElementOrDocument,text){$super(parentOrElementOrDocument,text)},initProperties:function(){this.defineProp("group",{dataType:DataType.STRING})},checkChanged:function($super){$super(),this.getChecked()&&this.uncheckSiblings()},uncheckSiblings:function(){var parent=this.getParent(),groupName=this.getGroup();if(parent)for(var ws=parent.getChildWidgets(),i=0,l=ws.length;i<l;++i){var w=ws[i];w!==this&&w.getGroup&&w.setChecked&&w.getGroup()===groupName&&w.setChecked(!1)}},doReactDeactiviting:function($super,e){$super(e)},_doToggleCheckOnSelf:function($super,oldChecked){oldChecked||$super(oldChecked)},_doCheckOnSelf:function(){this.getEnabled()&&this.setChecked(!0)}}),Kekule.Widget.DropDownButton=Class.create(Kekule.Widget.Button,{CLASS_NAME:"Kekule.Widget.DropDownButton",doFinalize:function($super){$super()},initProperties:function(){this.defineProp("dropDownWidget",{dataType:"Kekule.Widget.BaseWidget",serializable:!1,setter:function(value){this.setPropStoreFieldValue("dropDownWidget",value),value&&value.setDisplayed(!1)}}),this.defineProp("dropPosition",{dataType:DataType.INT})},doCreateRootElement:function($super,doc){return $super(doc)},calcActualDropPosition:function(){var D=Kekule.Widget.Position,pos=this.getDropPosition();if(!pos){var p=this.getParent(),layout=p?p.getLayout():Kekule.Widget.Layout.HORIZONTAL,selfClientRect=Kekule.HtmlElementUtils.getElemBoundingClientRect(this.getElement()),viewPortDim=Kekule.HtmlElementUtils.getViewportDimension(this.getElement()),dropElem=this.getDropDownWidget().getElement();dropElem.style.visible="hidden",dropElem.style.display="",this.getElement().appendChild(dropElem);var dropDim=Kekule.HtmlElementUtils.getElemOffsetDimension(dropElem);if(this.getElement().removeChild(dropElem),layout)if(layout===Kekule.Widget.Layout.VERTICAL){var left=selfClientRect.x,right=viewPortDim.width-left-selfClientRect.width;pos=right>=dropDim.width?D.RIGHT:left>right?D.LEFT:D.RIGHT}else{var top=selfClientRect.y,bottom=viewPortDim.height-top-selfClientRect.height;pos=bottom>=dropDim.height?D.BOTTOM:top>bottom?D.TOP:D.BOTTOM}}return pos},showDropDownWidget:function(){var dropWidget=this.getDropDownWidget();dropWidget.getElement().style.position="absolute";this.getElement();dropWidget.show(this,null,Kekule.Widget.ShowHideType.DROPDOWN),this.invokeEvent("dropDown",{dropDown:dropWidget})},hideDropDownWidget:function(){this.getDropDownWidget().hide(this)},isDropDownWidgetShown:function(){var w=this.getDropDownWidget();return w&&w.isShown()},doExecute:function($super,invokerHtmlEvent){this.getDropDownWidget()&&(this.isDropDownWidgetShown()?this.hideDropDownWidget():this.showDropDownWidget()),$super(invokerHtmlEvent)}}),Kekule.Widget.ButtonGroup=Class.create(Kekule.Widget.Toolbar,{CLASS_NAME:"Kekule.Widget.ButtonGroup",initialize:function($super,parentOrElementOrDocument){$super(parentOrElementOrDocument)},initPropValues:function($super){$super(),this.setPropStoreFieldValue("showText",!0),this.setPropStoreFieldValue("showGlyph",!0),this.setAllowChildWrap(!1)},doGetWidgetClassName:function($super){return $super()+" "+CNS.BUTTON_GROUP},doCreateRootElement:function(doc){return doc.createElement("span")},getDefaultChildWidgetClassName:function(){return"Kekule.Widget.Button"}}),Kekule.Widget.CompactButtonSet=Class.create(Kekule.Widget.DropDownButton,{CLASS_NAME:"Kekule.Widget.CompactButtonSet",initialize:function($super,parentOrElementOrDocument,text){this.reactSetButtonExecuteBind=this.reactSetButtonExecute.bind(this),this.setPropStoreFieldValue("showCompactMark",!0),this.setPropStoreFieldValue("cloneSelectedOutlook",!0),$super(parentOrElementOrDocument,text),this.getButtonSet()||this.initButtonGroup()},initProperties:function(){this.defineProp("buttonSet",{dataType:"Kekule.Widget.ButtonGroup",serializable:!1,setter:function(value){var old=this.getButtonSet();old!==value&&(old&&old.finalize(),this.initButtonGroup(value))}}),this.defineProp("buttonSetLayout",{dataType:DataType.INT}),this.defineProp("selected",{dataType:"Kekule.Widget.Button",serializable:!1,setter:function(value){if(value)this.getButtonSet().hasChild(value)&&(this.getCloneSelectedOutlook()&&this.cloneSetButton(value),value.setChecked&&value.setChecked(!0));else{var w=this.getSelected();w&&w.setChecked(!1)}this.setPropStoreFieldValue("selected",value)}}),this.defineProp("cloneSelectedOutlook",{dataType:DataType.BOOL}),this.defineProp("showCompactMark",{dataType:DataType.BOOL,setter:function(value){this.getShowCompactMark()!==value&&(this.setPropStoreFieldValue("showCompactMark",value),value?this.createCompactMark():this.removeCompactMark())}})},doGetWidgetClassName:function($super){return $super()+" "+CNS.COMPACT_BUTTON},doSetShowText:function($super,value){return this.getButtonSet()&&this.getButtonSet().setShowText(value),$super(value)},doSetShowGlyph:function($super,value){return this.getButtonSet()&&this.getButtonSet().setShowGlyph(value),$super(value)},createCompactMark:function(){var btnElem=this.getElement();this._compactMark&&btnElem.removeChild(this._compactMark);var mark=this.getDocument().createElement("span");return mark.className=CNS.BTN_COMPACT_MARK,btnElem.appendChild(mark),this._compactMark=mark,mark},removeCompactMark:function(){var btnElem=this.getElement();this._compactMark&&btnElem.removeChild(this._compactMark)},initButtonGroup:function(btnSet){if(btnSet)var checkedBtn=this._getCheckedButtonInGroup(btnSet);else btnSet=new Kekule.Widget.ButtonGroup(this);btnSet.setDisplayed(!1),btnSet.setShowText(this.getShowText()),btnSet.setShowGlyph(this.getShowGlyph()),this.setPropStoreFieldValue("buttonSet",btnSet),this.setDropDownWidget(btnSet),btnSet.addEventListener("execute",this.reactSetButtonExecuteBind),btnSet.addEventListener("check",this.reactSetButtonExecuteBind),checkedBtn&&this.cloneSetButton(checkedBtn)},_getCheckedButtonInGroup:function(btnGroup){for(var ws=btnGroup.getChildWidgets(),i=0,l=ws.length;i<l;++i){var w=ws[i];if(w.getChecked&&w.getChecked())return w}return null},cloneSetButton:function(btn){if(this.getCloneSelectedOutlook()){for(var thisElem=this.getElement(),setElem=this.getButtonSet().getElement(),DU=Kekule.DomUtils,thisChildren=DU.getDirectChildElems(thisElem),btnChildren=DU.getDirectChildElems(btn.getElement()),setElemInside=!1,i=0,l=thisChildren.length;i<l;++i){var child=thisChildren[i];child!==setElem?thisElem.removeChild(child):setElemInside=!0}for(var i=0,l=btnChildren.length;i<l;++i){var child=btnChildren[i].cloneNode(!0);setElemInside?thisElem.insertBefore(child,setElem):thisElem.appendChild(child)}this._clonedCustomHtmlClassName&&this.removeClassName(this._clonedCustomHtmlClassName),this._clonedCustomHtmlClassName=btn.getCustomHtmlClassName(),this._clonedCustomHtmlClassName&&this.addClassName(this._clonedCustomHtmlClassName),this._compactMark=null,this.createCompactMark()}},calcActualButtonSetLayout:function(){var L=Kekule.Widget.Layout,result=this.getButtonSetLayout();if(!result){var p=this.getParent();result=(p?p.getLayout():L.HORIZONTAL)===L.VERTICAL?L.HORIZONTAL:L.VERTICAL}return result},showDropDownWidget:function($super){var layout=this.calcActualButtonSetLayout();this.getButtonSet().setLayout(layout),$super()},reactSetButtonExecute:function(e){e.target instanceof Kekule.Widget.Button&&e.target!==this.getSelected()&&(e.target.setIsFocused(!1),e.target.setIsHover(!1),e.target.setIsActive(!1),this.setSelected(e.target),this.getButtonSet().isShown()&&this.getButtonSet().hide(),this.invokeEvent("select",{selected:e.target}))},append:function(btn,asSelected){return this.getButtonSet().appendWidget(btn),asSelected&&this.setSelected(btn),this},insertBefore:function(btn,ref,asSelected){return this.getButtonSet().insertWidgetBefore(btn),asSelected&&this.setSelected(btn),this},remove:function(btn,doNotFinalize){return this.getButtonSet().removeWidget(btn,doNotFinalize),this}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,DataType=(__webpack_require__(0).ClassEx,__webpack_require__(0).ObjectEx,__webpack_require__(0).DataType);module.exports=function(Kekule){var DU=Kekule.DomUtils,EU=Kekule.HtmlElementUtils,CNS=Kekule.Widget.HtmlClassNames,OU=Kekule.ObjUtils;return Kekule.Widget.HtmlClassNames=Object.extend(Kekule.Widget.HtmlClassNames,{OVERLAP:"K-Overlap",FORMCONTROL:"K-FormControl",CHECKBOX:"K-CheckBox",TEXTBOX:"K-TextBox",COMBOTEXTBOX:"K-ComboTextBox",COMBOTEXTBOX_ASSOC_WIDGET:"K-ComboTextBox-Assoc-Widget",BUTTONTEXTBOX:"K-ButtonTextBox",TEXTAREA:"K-TextArea",SELECTBOX:"K-SelectBox",COMBOBOX:"K-ComboBox",COMBOBOX_TEXTWRAPPER:"K-ComboBox-TextWrapper"}),Kekule.Widget.FormWidget=Class.create(Kekule.Widget.BaseWidget,{CLASS_NAME:"Kekule.Widget.FormWidget",initialize:function($super,parentOrElementOrDocument,isDumb){this.reactValueChangeBind=this.reactValueChange.bind(this),this.reactInputBind=this.reactInput.bind(this),this.setPropStoreFieldValue("isDirty",!1),$super(parentOrElementOrDocument,isDumb)},initProperties:function(){this.defineProp("name",{dataType:DataType.STRING,getter:function(){return this.getCoreElement().name},setter:function(value){this.getCoreElement().name=value}}),this.defineProp("value",{dataType:DataType.VARIANT,serializable:!1,getter:function(){return this.getCoreElement().value},setter:function(value){this.getCoreElement().value=value}}),this.defineProp("isDirty",{dataType:DataType.BOOL,serializable:!1}),this.defineProp("readOnly",{dataType:DataType.BOOL,serializable:!1,getter:function(){return this.getCoreElement().readOnly},setter:function(value){this.getCoreElement().readOnly=value}})},getTextSelectable:function(){return!0},doGetWidgetClassName:function($super){return $super()+" "+CNS.FORMCONTROL},doBindElement:function($super,element){$super(element);var coreElem=this.getCoreElement();coreElem&&(Kekule.X.Event.addListener(coreElem,"change",this.reactValueChangeBind),Kekule.X.Event.addListener(coreElem,"input",this.reactInputBind))},doUnbindElement:function($super,element){var coreElem=this.getCoreElement();coreElem&&(Kekule.X.Event.removeListener(coreElem,"change",this.reactValueChangeBind),Kekule.X.Event.removeListener(coreElem,"input",this.reactInputBind)),$super(element)},notifyValueChanged:function(){this.setIsDirty(!0),this.invokeEvent("valueChange",{widget:this})},selectAll:function(){var elem=this.getCoreElement();return elem&&elem.select&&elem.select(),this},reactValueChange:function(){this.notifyValueChanged()},reactInput:function(){this.setIsDirty(!0)}}),Kekule.Widget.CheckBox=Class.create(Kekule.Widget.FormWidget,{CLASS_NAME:"Kekule.Widget.CheckBox",BINDABLE_TAG_NAMES:["div","span"],initialize:function($super,parentOrElementOrDocument,checked){$super(parentOrElementOrDocument),Kekule.ObjUtils.notUnset(checked)&&this.setChecked(!!checked)},initProperties:function(){this.defineProp("checked",{dataType:DataType.BOOL,getter:function(){var core=this.getCoreElement();return!!core&&core.checked},setter:function(value){var core=this.getCoreElement();core&&(core.checked=!!value)}}),this.defineProp("text",{dataType:DataType.STRING,getter:function(){return Kekule.DomUtils.getElementText(this.getLabelElem())},setter:function(value){Kekule.DomUtils.setElementText(this.getLabelElem(),value)}})},getCoreElement:function(){return this.getInputElem()},doGetWidgetClassName:function($super){return $super()+" "+CNS.CHECKBOX},getInputElem:function(){var elem=this.getElement();if(elem){var inputs=elem.getElementsByTagName("input");if(inputs&&inputs.length)return inputs[0]}return null},getLabelElem:function(){var elem=this.getElement();if(elem){if("label"===elem.tagName.toLowerCase())return elem;var labels=elem.getElementsByTagName("label");if(labels&&labels.length)return labels[0]}return null},doCreateRootElement:function(doc){return doc.createElement("span")},doCreateSubElements:function(doc,rootElem){var labelElem=doc.createElement("label");rootElem.appendChild(labelElem);var inputElem=doc.createElement("input");return inputElem.setAttribute("type","checkbox"),labelElem.appendChild(inputElem),[labelElem,inputElem]}}),Kekule.Widget.TextBox=Class.create(Kekule.Widget.FormWidget,{CLASS_NAME:"Kekule.Widget.TextBox",BINDABLE_TAG_NAMES:["input"],initialize:function($super,parentOrElementOrDocument,text){$super(parentOrElementOrDocument),text&&this.setText(text)},initProperties:function(){this.defineProp("text",{dataType:DataType.STRING,getter:function(){return this.getElement().value},setter:function(value){this.getElement().value=value||""}}),this.defineProp("placeholder",{dataType:DataType.STRING,getter:function(){return this.getElement().placeholder},setter:function(value){this.getElement().placeholder=value}})},doGetWidgetClassName:function($super){return $super()+" "+CNS.TEXTBOX},doCreateRootElement:function(doc){var result=doc.createElement("input");return result.setAttribute("type","text"),result},doBindElement:function($super,element){$super(element)}}),Kekule.Widget.ComboTextBox=Class.create(Kekule.Widget.FormWidget,{CLASS_NAME:"Kekule.Widget.ComboTextBox",BINDABLE_TAG_NAMES:["div","span"],initialize:function($super,parentOrElementOrDocument,text){$super(parentOrElementOrDocument),text&&this.setText(text)},initProperties:function(){this.defineProp("text",{dataType:DataType.STRING,serializable:!1,getter:function(){var textBox=this.getTextBox();return textBox?textBox.getText():null},setter:function(value){var textBox=this.getTextBox();textBox&&textBox.setText(value)}}),this.defineProp("placeholder",{dataType:DataType.STRING,getter:function(){return this.getTextBox().getPlaceholder()},setter:function(value){this.getTextBox().setPlaceholder(value)}}),this.defineProp("overlapOnTextBox",{dataType:DataType.BOOL,setter:function(value){this.setPropStoreFieldValue("overlapOnTextBox",value),value?this.addClassName(CNS.OVERLAP):this.removeClassName(CNS.OVERLAP),this.adjustWidgetsSize()}}),this.defineProp("textBox",{dataType:"Kekule.Widget.TextBox",serializable:!1,setter:null}),this.defineProp("headingWidget",{dataType:"Kekule.Widget.BaseWidget",serializable:!1,setter:function(value){var old=this.getHeadingWidget();if(value!==old&&(this.setPropStoreFieldValue("headingWidget",value),old&&(old.setParent(null),old.removeClassName(CNS.COMBOTEXTBOX_ASSOC_WIDGET)),value)){var refElem=this.getTextBox()?this.getTextBox().getElement():this.getTailingWidget()?this.getTailingWidget().getElement():null;value.setParent(this),value.addClassName(CNS.COMBOTEXTBOX_ASSOC_WIDGET),value.insertToElem(this.getElement(),refElem)}}}),this.defineProp("tailingWidget",{dataType:"Kekule.Widget.BaseWidget",serializable:!1,setter:function(value){var old=this.getTailingWidget();value!==old&&(this.setPropStoreFieldValue("tailingWidget",value),old&&(old.setParent(null),old.removeClassName(CNS.COMBOTEXTBOX_ASSOC_WIDGET)),value&&(value.setParent(this),value.addClassName(CNS.COMBOTEXTBOX_ASSOC_WIDGET),value.appendToElem(this.getElement())))}})},finalize:function($super){this._finalizeSubWidgets(),$super()},_finalizeSubWidgets:function(){var textBox=this.getTextBox();textBox&&textBox.finalize();var widget=this.getHeadingWidget();widget&&widget.finalize();var widget=this.getTailingWidget();widget&&widget.finalize()},getCoreElement:function($super){var textBox=this.getTextBox();return textBox?textBox.getElement():$super()},doGetWidgetClassName:function($super){return $super()+" "+CNS.COMBOTEXTBOX},doCreateRootElement:function(doc){return doc.createElement("span")},doCreateSubElements:function($super,doc,rootElem){var result=$super(doc,rootElem);this._finalizeSubWidgets();var textBox=new Kekule.Widget.TextBox(this);return textBox.addClassName(CNS.TEXTBOX),textBox.appendToElem(this.getElement()),this.setPropStoreFieldValue("textBox",textBox),result.push(textBox.getElement()),result},relayEvent:function($super,eventName,event){var invokerWidget=event.widget;return invokerWidget!==this.getTextBox()&&invokerWidget!==this.getHeadingWidget()&&invokerWidget!==this.getTailingWidget()||(event.widget=this),$super(eventName,event)},doSetEnabled:function(value){var textBox=this.getTextBox();textBox&&textBox.setEnabled(value);var widget=this.getHeadingWidget();widget&&widget.setEnabled(value),(widget=this.getTailingWidget())&&widget.setEnabled(value)},doResize:function(){this.adjustWidgetsSize()},widgetShowStateChanged:function($super,isShown){$super(isShown),isShown&&this.adjustWidgetsSize()},doInsertedToDom:function(){this.isShown()&&this.adjustWidgetsSize()},assocWidgetChanged:function(){this.adjustWidgetsSize()},adjustWidgetsSize:function(){var SU=Kekule.StyleUtils,overlap=this.getOverlapOnTextBox(),position=overlap?"absolute":"relative",textElem=this.getTextBox().getElement();if(textElem){var textRect=Kekule.HtmlElementUtils.getElemBoundingClientRect(textElem),widget=this.getHeadingWidget(),elem=widget?widget.getElement():null;if(elem&&widget.isShown()){var style=elem.style;if(style.position=position,overlap){var rect=Kekule.HtmlElementUtils.getElemBoundingClientRect(elem);style.left=0,style.top=(textRect.height-rect.height)/2+"px",textElem.style.paddingLeft=rect.width+"px"}else SU.removeStyleProperty(style,"left"),SU.removeStyleProperty(style,"top"),SU.removeStyleProperty(textElem.style,"paddingLeft")}else SU.removeStyleProperty(textElem.style,"paddingLeft");var widget=this.getTailingWidget(),elem=widget?widget.getElement():null;if(elem&&widget.isShown()){var style=elem.style;if(style.position=position,overlap){var rect=Kekule.HtmlElementUtils.getElemBoundingClientRect(elem);style.right=0,style.top=(textRect.height-rect.height)/2+"px",textElem.style.paddingRight=rect.width+"px"}else SU.removeStyleProperty(style,"right"),SU.removeStyleProperty(style,"top"),SU.removeStyleProperty(textElem.style,"paddingRight")}else SU.removeStyleProperty(textElem.style,"paddingRight")}}}),Kekule.Widget.ButtonTextBox=Class.create(Kekule.Widget.ComboTextBox,{CLASS_NAME:"Kekule.Widget.ButtonTextBox",initialize:function($super,parentOrElementOrDocument,text){$super(parentOrElementOrDocument,text),this.setOverlapOnTextBox(!0)},initProperties:function(){this.defineProp("button",{dataType:"Kekule.Widget.Button",serializable:!1,setter:null,getter:function(){return this.getTailingWidget()}}),this.defineProp("buttonKind",{dataType:DataType.STRING,getter:function(){return this.getButton().getButtonKind()},setter:function(value){this.getButton().setButtonKind(value)}}),this.defineProp("buttonText",{dataType:DataType.STRING,getter:function(){return this.getButton().getText()},setter:function(value){this.getButton().setText(value)}})},doGetWidgetClassName:function($super){return $super()+" "+CNS.BUTTONTEXTBOX},doCreateSubElements:function($super,doc,rootElem){var result=$super(doc,rootElem),btn=this.createAssocButton();return btn&&result.push(btn.getElement()),result},createAssocButton:function(){var btn=new Kekule.Widget.Button(this);return this.setTailingWidget(btn),btn.addEventListener("change",this.adjustWidgetsSize,this),btn.addEventListener("execute",function(e){this.invokeEvent("buttonExecute",{widget:this})},this),btn},execBtn:function(e){var btn=this.getButton();if(btn)return btn.execute(e),!0},react_keypress:function(e){13===e.getKeyCode()&&this.execBtn(e)},react_keydown:function(e){if(this.getButtonKind()===Kekule.Widget.Button.Kinds.DROPDOWN){var KC=Kekule.X.Event.KeyCode;e.getKeyCode()===KC.DOWN&&this.execBtn(e)}}}),Kekule.Widget.TextArea=Class.create(Kekule.Widget.FormWidget,{CLASS_NAME:"Kekule.Widget.TextArea",BINDABLE_TAG_NAMES:["textarea"],initialize:function($super,parentOrElementOrDocument,text){$super(parentOrElementOrDocument),text&&this.setText(text)},initProperties:function(){this.defineProp("text",{dataType:DataType.STRING,getter:function(){return this.getValue()},setter:function(value){this.setValue(value),this.adjustAutoSize()}}),this.defineProp("placeholder",{dataType:DataType.STRING,getter:function(){return this.getElement().placeholder},setter:function(value){this.getElement().placeholder=value}}),this.defineProp("autoSizeX",{dataType:DataType.BOOL,setter:function(value){this.setPropStoreFieldValue("autoSizeX",value),this._autoSizeChanged()}}),this.defineProp("autoSizeY",{dataType:DataType.BOOL,setter:function(value){this.setPropStoreFieldValue("autoSizeY",value),this._autoSizeChanged()}}),this.defineProp("wrap",{dataType:DataType.STRING,getter:function(){return this.getElement().wrap},setter:function(value){this.getElement().wrap=value}})},doGetWidgetClassName:function($super){return $super()+" "+CNS.TEXTAREA},doCreateRootElement:function(doc){return doc.createElement("textarea")},doBindElement:function($super,element){$super(element),this.adjustAutoSize()},setValue:function($super,value){$super(value),this.adjustAutoSize()},widgetShowStateChanged:function($super,isShown){$super(isShown),isShown&&this.adjustAutoSize()},reactValueChange:function($super){this.adjustAutoSize(),$super()},react_keyup:function(){this.adjustAutoSize()},react_keypress:function(){this.adjustAutoSize()},doWidgetShowStateChanged:function(isShown){isShown&&this.adjustAutoSize()},_autoSizeChanged:function(){var style=this.getCoreElement().style;this.getAutoSizeX()?(style.overflowX="hidden",this.setWrap("off")):(style.overflowX="auto",this.setWrap("")),this.getAutoSizeY()?style.overflowY="hidden":style.overflowY="auto",this.adjustAutoSize()},adjustAutoSize:function(){(this.getAutoSizeX()||this.getAutoSizeY())&&this.adjustSizeByContent()},adjustSizeByContent:function(){var elem=this.getCoreElement(),text=this.getText(),isEmpty=!text,style=elem.style;this.getAutoSizeX()&&(style.width="1px"),this.getAutoSizeY()&&(style.height="1px");var scrollDim=Kekule.HtmlElementUtils.getElemScrollDimension(elem),clientDim=Kekule.HtmlElementUtils.getElemClientDimension(elem);this.getAutoSizeX()&&(isEmpty?style.width="1em":scrollDim.width>clientDim.width&&(style.width=scrollDim.width+"px")),this.getAutoSizeY()&&(isEmpty&&(style.height="1em"),scrollDim.height>clientDim.height&&(style.height=scrollDim.height+"px"))}}),Kekule.Widget.SelectBox=Class.create(Kekule.Widget.FormWidget,{CLASS_NAME:"Kekule.Widget.SelectBox",BINDABLE_TAG_NAMES:["select"],ITEM_DATA_FIELD:"__$item_data__",ITEM_VALUE_FIELD:"__$item_value__",initialize:function($super,parentOrElementOrDocument,items){$super(parentOrElementOrDocument),items&&this.setItems(items)},initProperties:function(){this.defineProp("items",{dataType:DataType.ARRAY,serializable:!1,getter:function(){for(var elems=this.getAllItemElems(),result=[],i=0,l=elems.length;i<l;++i){var elem=elems[i],info=this._getBoxItemInfo(elem);result.push(info)}return result},setter:function(value){var root=this.getElement();if(this.clear(),value)for(var items=Kekule.ArrayUtils.toArray(value),i=0,l=items.length;i<l;++i){var info=items[i];if(info){var elem=this._createBoxItemElem(root);this._setBoxItemInfo(elem,info)}}}}),this.defineProp("index",{dataType:DataType.INT,getter:function(){return this.getElement().selectedIndex},setter:function(value){this.getElement().selectedIndex=value}})},doGetWidgetClassName:function($super){return $super()+" "+CNS.SELECTBOX},doCreateRootElement:function(doc){return doc.createElement("select")},_createBoxItemElem:function(parentElem,refElem){var doc=parentElem.ownerDocument,result=doc.createElement("option");return refElem?parentElem.insertBefore(result,refElem):parentElem.appendChild(result),result},doBindElement:function($super,element){$super(element)},doGetValue:function(){var elem=this.getSelectedItemElem();if(elem){return this._getBoxItemInfo(elem).value}},doSetValue:function(value){for(var elems=this.getAllItemElems(),i=0,l=elems.length;i<l;++i){var elem=elems[i];if(this._getBoxItemInfo(elem).value===value)return void this.setIndex(i)}this.setIndex(-1)},getAllItemElems:function(){return DU.getDirectChildElems(this.getElement(),"option")},getSelectedItemElem:function(){for(var elems=this.getAllItemElems(),i=0,l=elems.length;i<l;++i){var elem=elems[i];if(elem.selected)return elem}return null},clear:function(){this.getElement().innerHTML=""},dropDown:function(){var event=(this.getDocument(),this.getElement(),this.getDocument().createEvent("MouseEvents"));event.initEvent("mousedown",!0,!0),this.getElement().dispatchEvent(event)},_getBoxItemInfo:function(itemElem){var result={};return result.text=EU.getInnerText(itemElem),result.value=itemElem[this.ITEM_VALUE_FIELD],OU.notUnset(itemElem.title)&&(result.title=itemElem.title),OU.notUnset(itemElem[this.ITEM_DATA_FIELD])&&(result.data=itemElem[this.ITEM_DATA_FIELD]),result},_setBoxItemInfo:function(itemElem,info){DataType.isSimpleValue(info)&&(info={value:info});var text=info.text||info.value;return OU.notUnset(text)&&Kekule.DomUtils.setElementText(itemElem,text),itemElem.value=""+info.value,itemElem[this.ITEM_VALUE_FIELD]=info.value,OU.notUnset(info.title)&&(itemElem.title=info.title),OU.notUnset(info.data)&&(itemElem[this.ITEM_DATA_FIELD]=info.data),info.selected?itemElem.setAttribute("selected","selected"):itemElem.selected=!1,this}}),Kekule.Widget.ComboBox=Class.create(Kekule.Widget.FormWidget,{CLASS_NAME:"Kekule.Widget.ComboBox",BINDABLE_TAG_NAMES:["div","span"],initialize:function($super,parentOrElementOrDocument){$super(parentOrElementOrDocument)},initProperties:function(){this.defineProp("text",{dataType:DataType.STRING,serializable:!1,getter:function(){var textBox=this.getTextBox();return textBox?textBox.getText():null},setter:function(value){var textBox=this.getTextBox();textBox&&(textBox.setText(value),this.textChanged())}}),this.defineProp("items",{dataType:DataType.ARRAY,serializable:!1,getter:function(){var selectBox=this.getSelectBox();return selectBox?selectBox.getItems():null},setter:function(value){var selectBox=this.getSelectBox();selectBox&&selectBox.setItems(value)}}),this.defineProp("textBox",{dataType:"Kekule.Widget.TextBox",serializable:!1,setter:null,scope:Class.PropertyScope.PRIVATE}),this.defineProp("selectBox",{dataType:"Kekule.Widget.SelectBox",serializable:!1,setter:null,scope:Class.PropertyScope.PRIVATE})},finalize:function($super){this._finalizeSubElements(),$super()},_finalizeSubElements:function(){var textBox=this.getTextBox();textBox&&textBox.finalize();var selectBox=this.getSelectBox();selectBox&&selectBox.finalize()},getCoreElement:function($super){var textBox=this.getTextBox();return textBox?textBox.getElement():$super()},doGetWidgetClassName:function($super){return $super()+" "+CNS.COMBOBOX},doCreateRootElement:function(doc){return doc.createElement("span")},doCreateSubElements:function(doc,rootElem){var self=this;this._finalizeSubElements();var wrapper=doc.createElement("span");wrapper.className=CNS.COMBOBOX_TEXTWRAPPER,rootElem.appendChild(wrapper);var textBox=new Kekule.Widget.TextBox(this);textBox.appendToElem(wrapper),this.setPropStoreFieldValue("textBox",textBox);var selectBox=new Kekule.Widget.SelectBox(this);return selectBox.appendToElem(rootElem),this.setPropStoreFieldValue("selectBox",selectBox),selectBox.addEventListener("valueChange",function(e){var itemElem=selectBox.getSelectedItemElem();if(itemElem){var value=itemElem.value,text=itemElem.text||itemElem.value;text!==textBox.getText()&&(textBox.setText(text),self.notifyValueChanged()),textBox.selectAll(),textBox.focus(),self.invokeEvent("valueSelect",{widget:self,value:value})}}),textBox.addEventListener("valueChange",function(e){self.textChanged()}),Kekule.X.Event.addListener(textBox.getElement(),"keydown",function(e){e.getKeyCode()===Kekule.X.Event.KeyCode.DOWN&&selectBox.dropDown()}),[wrapper]},relayEvent:function($super,eventName,event){var invokerWidget=event.widget;return invokerWidget!==this.getTextBox()&&invokerWidget!==this.getSelectBox()||(event.widget=this),$super(eventName,event)},textChanged:function(){var text=this.getText(),value=this._getValueOfText(text);this.getSelectBox().setValue(value)},_getValueOfText:function(text){for(var items=this.getSelectBox().getItems(),i=0,l=items.length;i<l;++i){var item=items[i];if(item.text&&item.text===text)return item.value}return text},doSetEnabled:function(value){var textBox=this.getTextBox();textBox&&textBox.setEnabled(value);var selectBox=this.getSelectBox();selectBox&&selectBox.setEnabled(value)},doGetValue:function($super){var text=$super();return this._getValueOfText(text)},doSetValue:function($super,value){var text=value,items=this.getSelectBox().getItems();this.getSelectBox().setIndex(-1);for(var i=0,l=items.length;i<l;++i){var item=items[i];if(item.value===value){text=item.text||item.value,this.getSelectBox().setIndex(i);break}}$super(text)}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,DataType=(__webpack_require__(0).ClassEx,__webpack_require__(0).ObjectEx,__webpack_require__(0).DataType);module.exports=function(Kekule){return Kekule.Widget.HtmlClassNames=Object.extend(Kekule.Widget.HtmlClassNames,{STATE_COLLAPSED:"K-State-Collapsed",STATE_EMPTY:"K-State-Empty",NESTED_CONTAINER:"K-NestedContainer",NESTED_CONTAINER_ITEM:"K-NestedContainer-Item"}),Kekule.Widget.NestedContainer=Class.create(Kekule.Widget.BaseWidget,{CLASS_NAME:"Kekule.Widget.NestedContainer",DEF_CONTAINER_TAG:"ul",DEF_ITEM_TAG:"li",ITEM_DATA_FIELD:"__$itemData__",initialize:function($super,parentOrElementOrDocument){$super(parentOrElementOrDocument)},initProperties:function(){this.defineProp("itemInitialExpanded",{dataType:DataType.BOOL})},doCreateRootElement:function(doc){return doc.createElement("div")},doBindElement:function($super,element){$super(element)},getContainerElemTag:function(){return this.DEF_CONTAINER_TAG},getItemElemTag:function(){return this.DEF_ITEM_TAG},_createChildItemElem:function(){var result=this.doCreateChildItemElem();return Kekule.HtmlElementUtils.addClass(result,Kekule.Widget.HtmlClassNames.NESTED_CONTAINER_ITEM),Kekule.HtmlElementUtils.addClass(result,Kekule.Widget.HtmlClassNames.STATE_EMPTY),result},doCreateChildItemElem:function(){return this.getDocument().createElement(this.getItemElemTag())},_createChildContainerElem:function(){var result=this.doCreateChildContainerElem();return Kekule.HtmlElementUtils.addClass(result,Kekule.Widget.HtmlClassNames.NESTED_CONTAINER),result},doCreateChildContainerElem:function(){return this.getDocument().createElement(this.getContainerElemTag())},getChildContainerElem:function(itemElem,canCreate){itemElem||(itemElem=this.getElement());var elems=itemElem.getElementsByTagName(this.getContainerElemTag()),result=elems.length?elems[0]:null;return!result&&canCreate&&(result=this._createChildContainerElem(),itemElem.appendChild(result)),result},getItemData:function(itemElem){return itemElem[this.ITEM_DATA_FIELD]},setItemData:function(itemElem,data){this.doSetItemData(itemElem,data),itemElem[this.ITEM_DATA_FIELD]=data;var childrenData=data.children;if(childrenData&&Kekule.ArrayUtils.isArray(childrenData)){this.clearChildItems(itemElem);for(var i=0,l=childrenData.length;i<l;++i){var childData=childrenData[i];this.appendChildItem(itemElem,childData)}}return this},doSetItemData:function(itemElem,data){},hasChildItem:function(parentItem){return this.getChildItemCount(parentItem)>0},getChildItemCount:function(parentItem){return this.getChildren(parentItem).length},getChildren:function(parentItem){var containerElem=this.getChildContainerElem(parentItem);if(containerElem){return Kekule.DomUtils.getDirectChildElems(containerElem,this.getItemElemTag())}return[]},getChildItemAt:function(parentItem,index){var children=this.getChildren(parentItem);return children.length&&children.length>index?children[index]:null},insertChildItem:function(parentItemElem,childItemElemOrData,indexOrRefItem){var result,containerElem=this.getChildContainerElem(parentItemElem,!0);if(childItemElemOrData&&Kekule.DomUtils.isElement(childItemElemOrData))result=childItemElemOrData;else{var result=this._createChildItemElem();this.getItemInitialExpanded()||Kekule.HtmlElementUtils.addClass(result,Kekule.Widget.HtmlClassNames.STATE_COLLAPSED),childItemElemOrData&&this.setItemData(result,childItemElemOrData)}var refChild=DataType.isSimpleType(indexOrRefItem)?this.getChildren(parentItemElem)[indexOrRefItem]:indexOrRefItem;return refChild?containerElem.insertBefore(result,refChild):containerElem.appendChild(result),this.childItemsChanged(parentItemElem),result},appendChildItem:function(parentItemElem,childItemElemOrData){return this.insertChildItem(parentItemElem,childItemElemOrData)},removeChildItem:function(parentItemElem,childItemElem){var container=this.getChildContainerElem(parentItemElem);return container&&(container.removeChild(childItemElem),this.hasChildItem(parentItemElem)||parentItemElem.removeChild(container),this.childItemsChanged(parentItemElem)),this},removeChildItemAt:function(parentItemElem,index){var child=this.getChildItemAt(parentItemElem,index);return child&&this.removeChildItem(parentItemElem,child),this},clearChildItems:function(parentItemElem){var container=this.getChildContainerElem(parentItemElem);parentItemElem||(parentItemElem=this.getElement()),container&&parentItemElem.removeChild(container),this.childItemsChanged(parentItemElem)},childItemsChanged:function(parentItem){if(parentItem){var c=Kekule.Widget.HtmlClassNames.STATE_EMPTY;this.hasChildItem(parentItem)?Kekule.HtmlElementUtils.removeClass(parentItem,c):Kekule.HtmlElementUtils.addClass(parentItem,c)}},expandItem:function(item){return Kekule.HtmlElementUtils.removeClass(item,Kekule.Widget.HtmlClassNames.STATE_COLLAPSED),this},collapseItem:function(item){return Kekule.HtmlElementUtils.addClass(item,Kekule.Widget.HtmlClassNames.STATE_COLLAPSED),this},toggleExpandStateOfItem:function(item){return Kekule.HtmlElementUtils.toggleClass(item,Kekule.Widget.HtmlClassNames.STATE_COLLAPSED),this},isChildItem:function(element){return Kekule.HtmlElementUtils.hasClass(element,Kekule.Widget.HtmlClassNames.NESTED_CONTAINER_ITEM)},getBelongedChildItem:function(element){for(var result=element,root=this.getElement(),body=this.getDocument().body;result!==root&&result!==body;)if(result=result.parentNode,this.isChildItem(result))return result;return null},getAllChildItems:function(rootItem){var result=[],containerElem=this.getChildContainerElem(rootItem,!1);if(containerElem)for(var children=Kekule.DomUtils.getDirectChildElems(containerElem),i=0,l=children.length;i<l;++i){var child=children[i];if(this.isChildItem(child)){result.push(child);var items=this.getAllChildItems(child);result=result.concat(items)}}return result},getChildItemRange:function(item1,item2,root){var allItems=this.getAllChildItems(root),index1=allItems.indexOf(item1),index2=allItems.indexOf(item2);if(index1>=0&&index2>=0){if(index1>index2){var reversed=!0,temp=index1;index1=index2,index2=temp}var result=allItems.slice(index1,index2+1);return reversed&&(result=result.reverse()),result}return[]}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,DataType=(__webpack_require__(0).ClassEx,__webpack_require__(0).ObjectEx,__webpack_require__(0).DataType);module.exports=function(Kekule){var CNS=(Kekule.HtmlElementUtils,Kekule.Widget.HtmlClassNames);return Kekule.Widget.HtmlClassNames=Object.extend(Kekule.Widget.HtmlClassNames,{TREEVIEW:"K-TreeView",TREEVIEW_EXPANDMARK:"K-TreeView-ExpandMark",TREEVIEW_ITEMCONTENT:"K-TreeView-ItemContent"}),Kekule.Widget.TreeView=Class.create(Kekule.Widget.NestedContainer,{CLASS_NAME:"Kekule.Widget.TreeView",BELONGED_ITEM_FIELD:"__$treeItem__",initProperties:function(){this.defineProp("selection",{dataType:DataType.ARRAY,serializable:!1,scope:Class.PropertyScope.PUBLIC,getter:function(){var result=this.getPropStoreFieldValue("selection");return result||(result=[],this.setPropStoreFieldValue("selection",result)),result},setter:function(value){this.select(value)}}),this.defineProp("selectedItem",{dataType:DataType.OBJECT,serializable:!1,getter:function(){var selection=this.getSelection();return selection.length?selection[selection.length-1]:null},setter:function(value){this.select(value)}}),this.defineProp("enableMultiSelected",{dataType:DataType.BOOL})},doGetWidgetClassName:function(){return CNS.TREEVIEW},doCreateChildItemElem:function($super){var result=$super();if(result){var marker=this.createGlyphContent(result,null,CNS.TREEVIEW_EXPANDMARK);marker[this.BELONGED_ITEM_FIELD]=result,result._expandMarkerElem=marker;var contenter=this.getDocument().createElement("span");contenter.className=CNS.TREEVIEW_ITEMCONTENT,result.appendChild(contenter),contenter[this.BELONGED_ITEM_FIELD]=result,result._contentElem=contenter}return result},doSetItemData:function(itemElem,data){this.setItemText(itemElem,data.text)},getExpandMarkerElem:function(itemElem){return itemElem._expandMarkerElem},getItemContentElem:function(itemElem){return itemElem._contentElem},getTextPartElem:function(itemElem,canCreate){var result=itemElem._textPartElem;return!result&&canCreate&&(result=this.createTextContent("",this.getItemContentElem(itemElem)),itemElem._textPartElem=result),result},setItemText:function(item,text){this.getTextPartElem(item,!0).innerHTML=text},isItemSelected:function(item){var selection=this.getSelection();return!!selection&&selection.indexOf(item)>=0},selectionChanged:function(){this.notifyPropSet("selection",this.getSelection())},clearSelection:function(){var selection=this.getSelection();if(selection.length){for(var i=0,l=selection.length;i<l;++i){var item=selection[i];Kekule.HtmlElementUtils.removeClass(this.getItemContentElem(item),CNS.STATE_SELECTED)}this.setPropStoreFieldValue("selection",[]),this.selectionChanged()}return this},removeFromSelection:function(items){if(items){var removes=Kekule.ArrayUtils.toArray(items);if(removes&&removes.length){for(var selection=this.getSelection(),i=0,l=removes.length;i<l;++i){var item=removes[i];Kekule.ArrayUtils.remove(selection,item)&&Kekule.HtmlElementUtils.removeClass(this.getItemContentElem(item),CNS.STATE_SELECTED)}this.selectionChanged()}}return this},addToSelection:function(items){if(items){var adds=Kekule.ArrayUtils.toArray(items);if(adds&&adds.length){this.getEnableMultiSelected()||(this.clearSelection(),adds=[adds[adds.length-1]]);for(var selection=this.getSelection(),i=0,l=adds.length;i<l;++i){var item=adds[i];this.isItemSelected(item)||(Kekule.HtmlElementUtils.addClass(this.getItemContentElem(item),CNS.STATE_SELECTED),selection.push(item))}this.selectionChanged()}}return this},toggleSelectionState:function(items){if(items){this.beginUpdate();try{var toggles=Kekule.ArrayUtils.toArray(items);this.getSelection();if(toggles&&toggles.length)for(var i=0,l=toggles.length;i<l;++i){var item=toggles[i];this.isItemSelected(item)?this.removeFromSelection(item):this.addToSelection(item)}}finally{this.endUpdate()}}},select:function(items){this.beginUpdate();try{if(this.clearSelection(),items)if(this.getEnableMultiSelected())this.addToSelection(items);else{var objs=Kekule.ArrayUtils.toArray(items);this.addToSelection(objs[objs.length-1])}}finally{this.endUpdate()}},react_click:function(e){var target=e.getTarget(),item=target[this.BELONGED_ITEM_FIELD];if(item&&this.isChildItem(item))this.toggleExpandStateOfItem(item);else if(item=this.getBelongedChildItem(target),e.getShiftKey()){var selected=this.getSelectedItem();if(selected){var range=this.getChildItemRange(selected,item);range.length&&(e.getCtrlKey()?this.addToSelection(range):this.select(range))}else this.select(item)}else e.getCtrlKey()?this.toggleSelectionState(item):item&&this.select(item)},react_dblclick:function(e){var target=e.getTarget(),item=this.getBelongedChildItem(target);item&&this.toggleExpandStateOfItem(item)}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,DataType=(__webpack_require__(0).ClassEx,__webpack_require__(0).ObjectEx,__webpack_require__(0).DataType);module.exports=function(Kekule){var DU=Kekule.DomUtils,SU=(Kekule.HtmlElementUtils,Kekule.StyleUtils),CNS=Kekule.Widget.HtmlClassNames;return Kekule.Widget.HtmlClassNames=Object.extend(Kekule.Widget.HtmlClassNames,{DIALOG:"K-Dialog",DIALOG_INSIDE:"K-Dialog-Inside",DIALOG_OVERFLOW:"K-Dialog-Overflow",DIALOG_CLIENT:"K-Dialog-Client",DIALOG_CAPTION:"K-Dialog-Caption",DIALOG_BTN_PANEL:"K-Dialog-Button-Panel"}),Kekule.Widget.DialogButtons={OK:"ok",CANCEL:"cancel",YES:"yes",NO:"no",isPositive:function(btn){var DB=Kekule.Widget.DialogButtons;return[DB.OK,DB.YES].indexOf(btn)>=0},isNegative:function(btn){var DB=Kekule.Widget.DialogButtons;return[DB.CANCEL,DB.NO].indexOf(btn)>=0}},Kekule.Widget.Location={DEFAULT:1,CENTER:2,FULLFILL:3,CENTER_OR_FULLFILL:4},Kekule.Widget.Dialog=Class.create(Kekule.Widget.BaseWidget,{CLASS_NAME:"Kekule.Widget.Dialog",BINDABLE_TAG_NAMES:["div","span"],BTN_NAME_FIELD:"__$btnName__",initialize:function($super,parentOrElementOrDocument,caption,buttons){this._dialogCallback=null,this._modalInfo=null,this._childButtons=[],this.setPropStoreFieldValue("location",Kekule.Widget.Location.CENTER),$super(parentOrElementOrDocument),this._dialogOpened=!1,this.setUseCornerDecoration(!0),caption&&this.setCaption(caption),buttons&&this.setButtons(buttons),this.setDisplayed(!1)},doFinalize:function($super){this.unprepareModal(),$super()},initProperties:function(){this.defineProp("caption",{dataType:DataType.STRING,getter:function(){return DU.getElementText(this.getCaptionElem())},setter:function(value){DU.setElementText(this.getCaptionElem(),value),SU.setDisplay(this.getCaptionElem(),!!value)}}),this.defineProp("buttons",{dataType:DataType.ARRAY,setter:function(value){this.setPropStoreFieldValue("buttons",value),this.getBtnPanelElem()&&SU.setDisplay(this.getBtnPanelElem(),value&&value.length),this.buttonsChanged()}}),this.defineProp("result",{dataType:DataType.STRING,serializable:!1,scope:Class.PropertyScope.PUBLIC}),this.defineProp("location",{dataType:DataType.INT}),this.defineProp("clientElem",{dataType:DataType.OBJECT,serializable:!1,setter:null,scope:Class.PropertyScope.PUBLIC}),this.defineProp("captionElem",{dataType:DataType.OBJECT,serializable:!1,setter:null,scope:Class.PropertyScope.PUBLIC}),this.defineProp("btnPanelElem",{dataType:DataType.OBJECT,serializable:!1,setter:null,scope:Class.PropertyScope.PUBLIC})},initPropValues:function($super){$super(),this.setMovable&&this.setMovable(!0)},getDefaultMovingGripper:function(){return this.getCaptionElem()},getCoreElement:function(){return this.getClientElem()},doGetWidgetClassName:function(){return CNS.DIALOG},doCreateRootElement:function(doc){return doc.createElement("div")},doCreateSubElements:function(doc,rootElem){var result=[],elem=doc.createElement("div");elem.className=CNS.DIALOG_CAPTION,rootElem.appendChild(elem),this.setPropStoreFieldValue("captionElem",elem),result.push(elem),this.setMovingGripper&&this.setMovingGripper(elem);var elem=doc.createElement("div");elem.className=CNS.DIALOG_CLIENT,rootElem.appendChild(elem),this.setPropStoreFieldValue("clientElem",elem),this.doCreateClientContents(elem),result.push(elem);var elem=doc.createElement("div");return elem.className=CNS.DIALOG_BTN_PANEL,rootElem.appendChild(elem),this.setPropStoreFieldValue("btnPanelElem",elem),result.push(elem),this.buttonsChanged(),result},doCreateClientContents:function(clientElem){},buttonsChanged:function(){for(var i=this._childButtons.length-1;i>=0;--i){this._childButtons[i].finalize()}for(var btns=this.getButtons()||[],i=0,l=btns.length;i<l;++i)this.createDialogButton(btns[i])},createDialogButton:function(btnName,btnResName,doc,btnPanel){var btnInfo=this._getPredefinedButtonInfo(btnName);if(btnInfo||(btnInfo={text:btnName}),btnInfo){var btn=new Kekule.Widget.Button(this,btnInfo.text);btn[this.BTN_NAME_FIELD]=btnName,btn.addEventListener("execute",this._reactDialogBtnExec,this),btn.appendToElem(this.getBtnPanelElem()),btn.__$name__=btnName;var resName=btnResName||this._getDialogButtonResName(btnName);return resName&&btn.linkStyleResource(resName),this._childButtons.push(btn),btn}return null},_getDialogButtonResName:function(btnName){var DB=Kekule.Widget.DialogButtons;return[DB.OK,DB.YES].indexOf(btnName)>=0?Kekule.Widget.StyleResourceNames.BUTTON_YES_OK:[DB.CANCEL,DB.NO].indexOf(btnName)>=0?Kekule.Widget.StyleResourceNames.BUTTON_NO_CANCEL:null},_reactDialogBtnExec:function(e){var DB=Kekule.Widget.DialogButtons,closeButtons=[DB.OK,DB.YES,DB.CANCEL,DB.NO],btn=e.target;if(btn){var btnName=btn.__$name__;closeButtons.indexOf(btnName)>=0&&(this.setResult(btnName),this.close(btnName))}},_getPredefinedButtonInfo:function(btnName){var DB=Kekule.Widget.DialogButtons,btnNames=[DB.OK,DB.CANCEL,DB.YES,DB.NO],btnTexts=[Kekule.$L("WidgetTexts.CAPTION_OK"),Kekule.$L("WidgetTexts.CAPTION_CANCEL"),Kekule.$L("WidgetTexts.CAPTION_YES"),Kekule.$L("WidgetTexts.CAPTION_NO")],index=btnNames.indexOf(btnName);return index>=0?{text:btnTexts[index]}:null},getDialogButton:function(btnName){for(var i=this._childButtons.length-1;i>=0;--i){var btn=this._childButtons[i];if(btn[this.BTN_NAME_FIELD]===btnName)return btn}return null},needAdjustPosition:function(){return this.getShowHideType()!==Kekule.Widget.ShowHideType.DROPDOWN},_storePositionInfo:function(){if(this.needAdjustPosition()){var elem=this.getElement(),style=elem.style;this._posInfo={left:style.left,top:style.top,right:style.right,bottom:style.bottom,width:style.width,height:style.height,position:style.position}}},_restorePositionInfo:function(){if(this.needAdjustPosition()){var elem=this.getElement(),style=elem.style,info=this._posInfo;info&&(style.left=info.left,style.top=info.top,style.right=info.right,style.bottom=info.bottom,style.width=info.width,style.height=info.height,style.position=info.position)}},adjustLocation:function(){if(this.needAdjustPosition()){this._storePositionInfo();var L=Kekule.Widget.Location,location=this.getLocation()||L.DEFAULT,overflow=!1;if(location!==L.DEFAULT){var l,t,w,h,r,b,oldDisplayed=this.getDisplayed(),oldVisible=this.getVisible();try{this.setDisplayed(!0,!0),this.setVisible(!0,!0);var viewPortDim=Kekule.DocumentUtils.getClientDimension(this.getDocument()),selfBoundingRect=Kekule.HtmlElementUtils.getElemBoundingClientRect(this.getElement()),selfWidth=selfBoundingRect.right-selfBoundingRect.left,selfHeight=selfBoundingRect.bottom-selfBoundingRect.top,parent=this.getOffsetParent();parent&&Kekule.HtmlElementUtils.getElemBoundingClientRect(parent);overflow=selfWidth>=viewPortDim.width||selfHeight>=viewPortDim.height}finally{this.setVisible(oldVisible,!0),this.setDisplayed(oldDisplayed,!0)}if(location===L.CENTER_OR_FULLFILL&&(overflow?(selfWidth>=viewPortDim.width?(l=0,r=0):l=(viewPortDim.width-selfWidth)/2,selfHeight>=viewPortDim.height?(t=0,b=0):t=(viewPortDim.height-selfHeight)/2):location=L.CENTER),location===L.FULLFILL?(l=0,t=0,r=0,b=0):location===L.CENTER&&(l=(viewPortDim.width-selfWidth)/2,t=(viewPortDim.height-selfHeight)/2),overflow){this.removeClassName(CNS.DIALOG_INSIDE),this.addClassName(CNS.DIALOG_OVERFLOW);var viewPortScrollPos=Kekule.DocumentUtils.getScrollPosition(this.getDocument());l+=viewPortScrollPos.left,t+=viewPortScrollPos.top,l<0&&(l=0),t<0&&(t=0)}else this.removeClassName(CNS.DIALOG_OVERFLOW),this.addClassName(CNS.DIALOG_INSIDE);var style=this.getElement().style,notUnset=Kekule.ObjUtils.notUnset;notUnset(l)&&(style.left=l+"px"),notUnset(t)&&(style.top=t+"px"),notUnset(r)&&(style.right=r+"px"),notUnset(b)&&(style.bottom=r+"px"),notUnset(w)&&(style.width=w+"px"),notUnset(h)&&(style.height=h+"px"),this.adjustClientSize(w,h,overflow)}this._posAdjusted=!0}},adjustClientSize:function(dialogWidth,dialogHeight,overflow){},prepareShow:function(callback){var elem=this.getElement();elem.parentNode||this.getDocument().body.appendChild(elem);var self=this;setTimeout(function(){self._dialogCallback=callback},0)},openModal:function(callback,caller){return this.getGlobalManager().prepareModalWidget(this),this.open(callback,caller)},openPopup:function(callback,caller){return this.open(callback,caller,Kekule.Widget.ShowHideType.POPUP)},open:function(callback,caller,showType){return this.prepareShow(callback),this.show(caller,null,showType||Kekule.Widget.ShowHideType.DIALOG),this._dialogOpened=!0,this},close:function(result){this.setResult(result),this.hide()},isPositiveResult:function(result){return Kekule.Widget.DialogButtons.isPositive(result||this.getResult())},isNegativeResult:function(result){return Kekule.Widget.DialogButtons.isNegative(result||this.getResult())},widgetShowStateBeforeChanging:function($super,isShown){$super(isShown),isShown&&(this.adjustLocation(),this.setResult(null))},doWidgetShowStateChanged:function($super,isShown){$super(isShown),isShown||this._dialogCallback&&(this._dialogCallback(this.getResult()),this._dialogCallback=null)},widgetShowStateDone:function($super,isShown){$super(isShown),!isShown&&this._dialogOpened&&(this.getModalInfo()&&this.getGlobalManager().unprepareModalWidget(this),this.isShown()||this._restorePositionInfo(),this._dialogOpened=!1)}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,ClassEx=__webpack_require__(0).ClassEx,DataType=(__webpack_require__(0).ObjectEx,__webpack_require__(0).DataType);module.exports=function(Kekule){var EU=Kekule.HtmlElementUtils,CNS=Kekule.Widget.HtmlClassNames;return Kekule.Widget.HtmlClassNames=Object.extend(Kekule.Widget.HtmlClassNames,{MSGPANEL:"K-MsgPanel",MSGPANEL_CONTENT:"K-MsgPanel-Content",MSGGROUP:"K-MsgGroup",MSGGROUP_FOR_WIDGET:"K-Widget-MsgGroup",MSG_NORMAL:"K-Msg-Normal",MSG_INFO:"K-Msg-Info",MSG_WARNING:"K-Msg-Warning",MSG_ERROR:"K-Msg-Error"}),Kekule.Widget.MsgType={NORMAL:"",INFO:"info",WARNING:"warning",ERROR:"error"},Kekule.Widget.MsgPanel=Class.create(Kekule.Widget.BaseWidget,{CLASS_NAME:"Kekule.Widget.MsgPanel",BINDABLE_TAG_NAMES:["span","div"],initialize:function($super,parentOrElementOrDocument,text,msgType){this._contentElem=null,this._elemTextPart=null,this._elemLeadingGlyphPart=null,this._elemTailingGlyphPart=null,this.setPropStoreFieldValue("showText",!0),$super(parentOrElementOrDocument),text&&this.setText(text),msgType&&this.setMsgType(msgType),this.setUseCornerDecoration(!0)},initProperties:function(){this.defineProp("text",{dataType:DataType.STRING,serializable:!1,getter:function(){return Kekule.HtmlElementUtils.getInnerText(this.getElement())},setter:function(value){this.changeContentText(value)}}),this.defineProp("showLeadingGlyph",{dataType:DataType.BOOL,setter:function(value){this.setPropStoreFieldValue("showLeadingGlyph",value),this._elemLeadingGlyphPart.style.display=value?"":"none"}}),this.defineProp("showTailingGlyph",{dataType:DataType.BOOL,setter:function(value){this.setPropStoreFieldValue("showTailingGlyph",value),this._elemTailingGlyphPart.style.display=value?"":"none"}}),this.defineProp("msgType",{dataType:DataType.STRING,setter:function(value){var old=this.getMsgType();if(old!==value){var oldClass=this.getClassNameForMsgType(old),newClass=this.getClassNameForMsgType(value);oldClass!==newClass&&(this.removeClassName(oldClass),this.addClassName(newClass)),this.setPropStoreFieldValue("msgType",value)}}})},doGetWidgetClassName:function($super){return $super()+" "+CNS.MSGPANEL},doCreateRootElement:function(doc){return doc.createElement("span")},doCreateSubElements:function($super,doc,rootElem){var text=EU.getInnerText(rootElem);rootElem.innerHTML="";var element=doc.createElement("span");element.className=CNS.MSGPANEL_CONTENT,rootElem.appendChild(element),this._contentElem=element,this._elemTextPart=this.createTextContent(text,element),this._elemLeadingGlyphPart=this.createGlyphContent(element,this._elemTextPart,CNS.PART_PRI_GLYPH_CONTENT),this._elemTailingGlyphPart=this.createGlyphContent(element,null,CNS.PART_ASSOC_GLYPH_CONTENT)},doSetUseCornerDecoration:function($super,value){$super(value),value?Kekule.HtmlElementUtils.addClass(this._contentElem,CNS.CORNER_ALL):Kekule.HtmlElementUtils.removeClass(this._contentElem,CNS.CORNER_ALL)},getTextSelectable:function(){return!0},changeContentText:function(newText){Kekule.DomUtils.setElementText(this._elemTextPart,newText||"")},getClassNameForMsgType:function(msgType){var MT=Kekule.Widget.MsgType;switch(msgType){case MT.INFO:return CNS.MSG_INFO;case MT.WARNING:return CNS.MSG_WARNING;case MT.ERROR:return CNS.MSG_ERROR;default:return CNS.MSG_NORMAL}}}),Kekule.Widget.MsgGroup=Class.create(Kekule.Widget.WidgetGroup,{CLASS_NAME:"Kekule.Widget.MsgGroup",BINDABLE_TAG_NAMES:["span","div"],initialize:function($super,parentOrElementOrDocument){$super(parentOrElementOrDocument),this.setLayout(Kekule.Widget.Layout.VERTICAL)},initProperties:function(){this.defineProp("reversedOrder",{dataType:DataType.BOOL}),this.defineProp("maxMsgCount",{dataType:DataType.INT,setter:function(value){this.setPropStoreFieldValue("maxMsgCount",value),this.clearExcessiveMsgs()}}),this.defineProp("msgFlashTime",{dataType:DataType.INT})},initPropValues:function($super){$super(),this.setMsgFlashTime(6e3)},doGetWidgetClassName:function($super){return $super()+" "+CNS.MSGGROUP},doCreateRootElement:function(doc){return doc.createElement("div")},addMessage:function(msg,msgType,flashTime,className){if(msg||msgType){var result=new Kekule.Widget.MsgPanel(this,msg,msgType);result.setFinalizeAfterHiding(!0),className&&result.addClassName(className);this.getReversedOrder()?result.insertToWidget(this,this.getChildAt(0)):result.appendToWidget(this);var time=Kekule.ObjUtils.isUnset(flashTime)?this.getMsgFlashTime():flashTime;return time?result.flash(time,this):result.show(this),this.clearExcessiveMsgs(),result}},clearExcessiveMsgs:function(){var maxCount=this.getMaxMsgCount();if(maxCount&&maxCount>0){var count=this.getChildWidgets().length,excessCount=count-maxCount;if(excessCount>0){var panel,index=0,self=this;!function callback(){index<excessCount&&(panel=self.getOldestMsgPanel(),self.hideMsgPanel(panel,callback),++index)}()}}},getOldestMsgPanel:function(){return this.getReversedOrder()?this.getLastChild():this.getFirstChild()},hideMsgPanel:function(panel,callback){return panel.hide(this,callback),panel}}),ClassEx.defineProp(Kekule.Widget.BaseWidget,"msgReporter",{dataType:"Kekule.Widget.MsgGroup",serializable:!1,setter:null,getter:function(canCreate){var result=this.getPropStoreFieldValue("msgReporter");return!result&&canCreate&&(result=new Kekule.Widget.MsgGroup(this),result.addClassName(CNS.MSGGROUP_FOR_WIDGET),result.appendToWidget(this),this.setPropStoreFieldValue("msgReporter",result)),result}}),ClassEx.extend(Kekule.Widget.BaseWidget,{reportMessage:function(msg,msgType,flashTime,className){var msgReporter=this.getMsgReporter(!0),result=msgReporter.addMessage(msg,msgType,flashTime||0,className);return msgReporter.setDisplayed(!0),result},flashMessage:function(msg,msgType,flashTime,className){return this.reportMessage(msg,msgType,flashTime||this.getMsgReporter(!0).getMsgFlashTime(),className)},removeMessage:function(msgPanel){msgPanel.hide()}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,DataType=(__webpack_require__(0).ClassEx,__webpack_require__(0).ObjectEx,__webpack_require__(0).DataType);module.exports=function(Kekule){var CNS=(Kekule.HtmlElementUtils,Kekule.Widget.HtmlClassNames),AU=Kekule.ArrayUtils;return Kekule.Widget.HtmlClassNames=Object.extend(Kekule.Widget.HtmlClassNames,{TABVIEW:"K-TabView",TABVIEW_TABBUTTON:"K-TabView-TabButton",TABVIEW_CLIENT:"K-TabView-Client",TABVIEW_PAGE:"K-TabView-Page",TABVIEW_ACTIVE_PAGE:"K-TabView-Active-Page",TABVIEW_TABBUTTON_CONTAINER:"K-TabView-TabButton-Container",TABVIEW_PAGE_CONTAINER:"K-TabView-Page-Container",TABBUTTONGROUP:"K-TabButtonGroup",TAB_AT_LEFT:"K-TabAtLeft",TAB_AT_RIGHT:"K-TabAtRight",TAB_AT_TOP:"K-TabAtTop",TAB_AT_BOTTOM:"K-TabAtBottom"}),Kekule.Widget.TabPage=Class.create(Kekule.Widget.BaseWidget,{CLASS_NAME:"Kekule.Widget.TabPage",initProperties:function(){this.defineProp("text",{dataType:DataType.STRING})},doGetWidgetClassName:function($super){return $super()+" "+CNS.TABVIEW_PAGE},doCreateRootElement:function(doc){return doc.createElement("div")}}),Kekule.Widget.TabButtonGroup=Class.create(Kekule.Widget.ButtonGroup,{CLASS_NAME:"Kekule.Widget.TabButtonGroup",initialize:function($super,parentOrElementOrDocument){$super(parentOrElementOrDocument),this.addEventListener("execute",function(e){var target=e.target;target instanceof Kekule.Widget.RadioButton&&this.invokeEvent("switch",{button:target})},this),this.tabButtonPosChanged()},initProperties:function(){this.defineProp("tabButtonPosition",{dataType:DataType.INT,enumSource:Kekule.Widget.Position,setter:function(value){this.getTabButtonPosition()!==value&&(this.setPropStoreFieldValue("tabButtonPosition",value),this.tabButtonPosChanged())}})},initPropValues:function($super){$super(),this.setUseCornerDecoration(!1)},doGetWidgetClassName:function($super){return $super()+" "+CNS.TABBUTTONGROUP},tabButtonPosChanged:function(){var WP=Kekule.Widget.Position,pos=this.getTabButtonPosition(),isVertical=pos&WP.LEFT||pos&WP.RIGHT,tabPosClassName=pos&WP.RIGHT?CNS.TAB_AT_RIGHT:pos&WP.BOTTOM?CNS.TAB_AT_BOTTOM:pos&WP.LEFT?CNS.TAB_AT_LEFT:CNS.TAB_AT_TOP;this._lastTabBtnPosClassName&&this.removeClassName(this._lastTabBtnPosClassName),this._lastTabBtnPosClassName=tabPosClassName,this.addClassName(this._lastTabBtnPosClassName),this.setLayout(isVertical?Kekule.Widget.Layout.VERTICAL:Kekule.Widget.Layout.HORIZONTAL)}}),Kekule.Widget.TabView=Class.create(Kekule.Widget.Container,{CLASS_NAME:"Kekule.Widget.TabView",TAB_BTN_FIELD:"__$tabButton__",initialize:function($super,parentOrElementOrDocument){this._tabBtnContainer=null,this._pageContainer=null,$super(parentOrElementOrDocument),Kekule.ObjUtils.isUnset(this.getUseCornerDecoration())&&this.setUseCornerDecoration(!0),this.tabButtonPosChanged(),this.addEventListener("change",this.reactTabPagePropChange,this)},doFinalize:function($super){this.getTabGroup()&&this.getTabGroup().finalize(),$super()},initProperties:function(){this.defineProp("tabPages",{dataType:DataType.ARRAY,serializable:!1,getter:function(){var result=this.getPropStoreFieldValue("tabPages");return result||(result=[],this.setPropStoreFieldValue("tabPages",result)),result},setter:null}),this.defineProp("activeTabPage",{dataType:"Kekule.Widget.TabPage",serializable:!1,setter:function(value){var old=this.getActiveTabPage();old!==value&&this.hasChild(value)&&(this.setPropStoreFieldValue("activeTabPage",value),old&&(old.removeClassName(CNS.TABVIEW_ACTIVE_PAGE),this._getPageTabButton(old).setChecked(!1)),value&&(value.addClassName(CNS.TABVIEW_ACTIVE_PAGE),this._getPageTabButton(value).setChecked(!0),this.invokeEvent("switchTab",{tabPage:value})))}}),this.defineProp("activeTabIndex",{dataType:DataType.INT,serializable:!1,getter:function(){return this.getTabPages().indexOf(this.getActiveTabPage())},setter:function(value){var page=this.getTabPages()[value];page&&this.setActiveTabPage(page)}}),this.defineProp("tabButtonPosition",{dataType:DataType.INT,enumSource:Kekule.Widget.Position,setter:function(value){this.getTabButtonPosition()!==value&&(this.setPropStoreFieldValue("tabButtonPosition",value),this.tabButtonPosChanged())}}),this.defineProp("showTabButtons",{dataType:DataType.BOOL,getter:function(){var t=this.getTabGroup();return t&&t.getDisplayed()},setter:function(value){var t=this.getTabGroup();t&&t.setDisplayed(value)}}),this.defineProp("tabGroup",{dataType:"Kekule.Widget.ButtonGroup",serializable:!1,setter:null,scope:Class.PropertyScope.PRIVATE})},doGetWidgetClassName:function($super){return $super()+" "+CNS.TABVIEW},doCreateRootElement:function(doc){return doc.createElement("div")},doCreateSubElements:function(doc,rootElem){var result=[],tabBtnContainer=doc.createElement("div");tabBtnContainer.className=CNS.TABVIEW_TABBUTTON_CONTAINER;var pageContainer=doc.createElement("div");return pageContainer.className=CNS.TABVIEW_PAGE_CONTAINER,this._tabBtnContainer=tabBtnContainer,this._pageContainer=pageContainer,rootElem.appendChild(tabBtnContainer),rootElem.appendChild(pageContainer),this.setPropStoreFieldValue("tabGroup",this.doCreateTabbar(doc,tabBtnContainer)),result},doCreateTabbar:function(doc,parentElem){var result=new Kekule.Widget.TabButtonGroup(doc);return result.appendToElem(parentElem),result.addEventListener("switch",function(e){var btn=e.button,page=this._getPageOfTabButton(btn);page&&this.setActiveTabPage(page)},this),result},getChildrenHolderElement:function(){return this._pageContainer},getContainerElement:function(){return this._pageContainer},_getPageTabButton:function(tabPage){return tabPage[this.TAB_BTN_FIELD]},_setPageTabButton:function(tabPage,button){tabPage[this.TAB_BTN_FIELD]=button},_getPageOfTabButton:function(button){for(var pages=this.getTabPages(),i=0,l=pages.length;i<l;++i){var p=pages[i];if(this._getPageTabButton(p)===button)return p}return null},childWidgetAdded:function($super,widget){if($super(widget),widget instanceof Kekule.Widget.TabPage){var isFirstPage=!this.getTabPages().length;widget.appendToElem(this._pageContainer),this.getTabPages().push(widget),this._insertTabButtonBefore(widget),isFirstPage&&this.setActiveTabPage(widget)}},childWidgetRemoved:function($super,widget){$super(widget),widget instanceof Kekule.Widget.TabPage&&(AU.remove(this.getTabPages(),widget),this._removeTabButton(widget))},childWidgetMoved:function($super,widget,newIndex){$super(widget,newIndex),widget instanceof Kekule.Widget.TabPage&&this._changeTabIndex(widget,newIndex)},_insertTabButtonBefore:function(tabPage,refButton){var btnGroup=this.getTabGroup(),newButton=new Kekule.Widget.RadioButton(this.getDocument());this._updateTabButton(tabPage,newButton),this._setPageTabButton(tabPage,newButton),refButton?newButton.insertToWidget(btnGroup,refButton):newButton.appendToWidget(btnGroup)},_updateTabButton:function(tabPage,button){button||(button=this._getPageTabButton(tabPage)),button.setText(tabPage.getText()||""),tabPage.getHint()&&button.setHint(tabPage.getHint())},_removeTabButton:function(tabPage){var btn=this._getPageTabButton(tabPage);btn&&btn.finalize()},_changeTabIndex:function(tabPage,newIndex){var btn=this._getPageTabButton(tabPage);this.getTabGroup()._moveChild(btn,newIndex);var pages=this.getTabPages(),oldIndex=pages.indexOf(tabPage);oldIndex>=0&&oldIndex!==newIndex&&AU.changeItemIndex(pages,tabPage,newIndex)},reactTabPagePropChange:function(e){var target=e.target;if(target instanceof Kekule.Widget.TabPage){var btn=this._getPageTabButton(target);btn&&this._updateTabButton(target,btn)}},tabButtonPosChanged:function(){var WP=Kekule.Widget.Position,pos=this.getTabButtonPosition(),isAtTailing=pos&WP.BOTTOM||pos&WP.RIGHT,tabPosClassName=(pos&WP.LEFT||WP.RIGHT,pos&WP.RIGHT?CNS.TAB_AT_RIGHT:pos&WP.BOTTOM?CNS.TAB_AT_BOTTOM:pos&WP.LEFT?CNS.TAB_AT_LEFT:CNS.TAB_AT_TOP);this._lastTabBtnPosClassName&&this.removeClassName(this._lastTabBtnPosClassName),this._lastTabBtnPosClassName=tabPosClassName,this.addClassName(this._lastTabBtnPosClassName),this.getTabGroup().setTabButtonPosition(pos),isAtTailing?this.getElement().appendChild(this._tabBtnContainer):this.getElement().insertBefore(this._tabBtnContainer,this._pageContainer)},createNewTabPage:function(title,hint,refPage){var doc=this.getDocument(),result=new Kekule.Widget.TabPage(doc);if(result.setText(title),result.setHint(hint),result.appendToWidget(this),refPage){var refIndex=this.getChildWidgets().indexOf(refPage);this._moveChild(result,refIndex)}return result}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,DataType=(__webpack_require__(0).ClassEx,__webpack_require__(0).ObjectEx,__webpack_require__(0).DataType);module.exports=function(Kekule){var DU=Kekule.DomUtils,EU=Kekule.HtmlElementUtils,CNS=Kekule.Widget.HtmlClassNames;Kekule.Widget.HtmlClassNames=Object.extend(Kekule.Widget.HtmlClassNames,{VALUELISTEDITOR:"K-ValueListEditor",VALUELISTEDITOR_ROW:"K-ValueListEditor-Row",VALUELISTEDITOR_CELL:"K-ValueListEditor-Cell",VALUELISTEDITOR_INDICATORCELL:"K-ValueListEditor-IndicatorCell",VALUELISTEDITOR_KEYCELL:"K-ValueListEditor-KeyCell",VALUELISTEDITOR_VALUECELL:"K-ValueListEditor-ValueCell",VALUELISTEDITOR_CELL_CONTENT:"K-ValueListEditor-CellContent",VALUELISTEDITOR_VALUECELL_TEXT:"K-ValueListEditor-ValueCellText",VALUELISTEDITOR_INLINE_EDIT:"K-ValueListEditor-InlineEdit",VALUELISTEDITOR_EXPANDMARK:"K-ValueListEditor-ExpandMark",VALUELISTEDITOR_ACTIVE_ROW:"K-ValueListEditor-ActiveRow"}),Kekule.Widget.ValueListEditor=Class.create(Kekule.Widget.BaseWidget,{CLASS_NAME:"Kekule.Widget.ValueListEditor",BINDABLE_TAG_NAMES:["table"],ROW_ELEM_TAG:"tr",CELL_ELEM_TAG:"td",ROW_DATA_FIELD:"__$row_data__",ROW_EDIT_INFO_FIELD:"__$row_edit_info__",initialize:function($super,parentOrElementOrDocument){$super(parentOrElementOrDocument),this._inlineEdit=null,this._isActivitingRow=!1},initProperties:function(){this.defineProp("hash",{dataType:DataType.HASH,getter:function(){return this._getTotalHash()},setter:function(value){this._setTotalHash(value),this.setPropStoreFieldValue("hash",value)}}),this.defineProp("readOnly",{dataType:DataType.BOOL}),this.defineProp("useKeyHint",{dataType:DataType.BOOL}),this.defineProp("valueDisplayMode",{dataType:DataType.INT,enumSource:Kekule.Widget.ValueListEditor.ValueDisplayMode,setter:function(value){this.getValueDisplayMode()!==value&&(this.setPropStoreFieldValue("valueDisplayMode",value),this.valueDisplayModeChanged())}}),this.defineProp("activeRow",{dataType:DataType.OBJECT,serializable:!1,scope:Class.PropertyScope.PUBLIC,setter:function(value){var old=this.getActiveRow();old!==value&&(old&&(this.finishEditing(),EU.removeClass(old,CNS.VALUELISTEDITOR_ACTIVE_ROW),this._showValueCellText(old)),this._inlineEdit&&this._inlineEdit.finalize(),value&&(EU.addClass(value,CNS.VALUELISTEDITOR_ACTIVE_ROW),this.getReadOnly()||this.createValueEditWidget(value)),this.setPropStoreFieldValue("activeRow",value),this.invokeEvent("activeRowChange",{row:value}))}})},doGetWidgetClassName:function(){return CNS.VALUELISTEDITOR},doCreateRootElement:function(doc){return doc.createElement("table")},doBindElement:function($super,element){$super(element)},getRootElem:function(){return this.getElement()},createRowElem:function(doc){var result=doc.createElement(this.ROW_ELEM_TAG);return EU.addClass(result,CNS.VALUELISTEDITOR_ROW),result},createCellElem:function(doc){var result=doc.createElement(this.CELL_ELEM_TAG);return EU.addClass(result,CNS.VALUELISTEDITOR_CELL),result},createIndicatorCellElem:function(doc){var result=this.createCellElem(doc);EU.addClass(result,CNS.VALUELISTEDITOR_INDICATORCELL);var indicator=doc.createElement("span");return result.appendChild(indicator),result},createKeyCellElem:function(doc){var result=this.createCellElem(doc);return EU.addClass(result,CNS.VALUELISTEDITOR_KEYCELL),result},createValueCellElem:function(doc){var result=this.createCellElem(doc);return EU.addClass(result,CNS.VALUELISTEDITOR_VALUECELL),result},createValueEditWidget:function(row){var result=null;if(row===this.getActiveRow()?result=this._inlineEdit:this._inlineEdit&&(this._inlineEdit.finalize(),this._inlineEdit=null),!result){result=this.doCreateValueEditWidget(row),result.setBubbleUiEvents(!0),EU.addClass(result.getElement(),CNS.VALUELISTEDITOR_INLINE_EDIT);var cell=this.getValueCell(row),contentWrapper=this.getCellContentWrapper(cell,!0);result.appendToElem(contentWrapper)}return result&&(result.focus&&result.focus(),result.selectAll&&result.selectAll(),this._inlineEdit=result,this._hideValueCellText(row)),result},doCreateValueEditWidget:function(row){var data=this.getRowData(row),value=this.getValueCellText(row,data),widgetInfo=this.getValueEditWidgetInfo(row),editClass=widgetInfo.widgetClass,result=new editClass(this);return widgetInfo.propValues&&result.setPropValues(widgetInfo.propValues),result.setValue(value),result},getDefaultValueEditWidgetInfo:function(){return{widgetClass:Kekule.Widget.TextBox}},getValueEditWidgetInfo:function(row){return this.getRowEditInfo(row)||this.getDefaultValueEditWidgetInfo()},getRowElems:function(){return this.getRootElem()?DU.getDirectChildElems(this.getRootElem(),this.ROW_ELEM_TAG):[]},getRows:function(){return this.getRowElems()},getRowCount:function(){var rows=this.getRowElems();return rows?rows.length:0},getRowAt:function(index){var rows=this.getRowElems();return rows?rows[index]:null},getPrevRow:function(row){for(var matchTag=this.ROW_ELEM_TAG.toLowerCase(),result=row.previousSibling;result&&(result.nodeType!==Node.ELEMENT_NODE||result.tagName.toLowerCase()!==matchTag);)result=result.previousSibling;return result},getNextRow:function(row){for(var matchTag=this.ROW_ELEM_TAG.toLowerCase(),result=row.nextSibling;result&&(result.nodeType!==Node.ELEMENT_NODE||result.tagName.toLowerCase()!==matchTag);)result=result.nextSibling;return result},getKeyCell:function(row){return DU.getDirectChildElems(row,this.CELL_ELEM_TAG)[1]},getCellContentWrapper:function(cell,canCreate){var children=DU.getDirectChildElems(cell),result=children?children[0]:null;return!result&&canCreate&&(result=cell.ownerDocument.createElement("span"),cell.appendChild(result),EU.addClass(result,CNS.VALUELISTEDITOR_CELL_CONTENT)),result},getValueCellTextWrapper:function(cell,canCreate){var result=null,wrapper=this.getCellContentWrapper(cell,canCreate);if(wrapper){var children=wrapper.getElementsByTagName("span");result=children?children[0]:null,!result&&canCreate&&(result=cell.ownerDocument.createElement("span"),wrapper.appendChild(result),EU.addClass(result,CNS.VALUELISTEDITOR_VALUECELL_TEXT))}return result},_hideValueCellText:function(row){var elem=this.getValueCellTextWrapper(this.getValueCell(row));elem&&(elem.style.visibility="hidden")},_showValueCellText:function(row){var elem=this.getValueCellTextWrapper(this.getValueCell(row));elem&&(elem.style.visibility="visible")},getValueCell:function(row){return DU.getDirectChildElems(row,this.CELL_ELEM_TAG)[2]},getParentCell:function(element){return DU.getNearestAncestorByTagName(element,this.CELL_ELEM_TAG,!0)},getParentRow:function(element){return DU.getNearestAncestorByTagName(element,this.ROW_ELEM_TAG,!0)},_createNewRow:function(data){var doc=this.getDocument(),result=this.createRowElem(doc);if(result){var indicatorCell=this.createIndicatorCellElem(doc);result.appendChild(indicatorCell);var keyCell=this.createKeyCellElem(doc);result.appendChild(keyCell);var valueCell=this.createValueCellElem(doc);result.appendChild(valueCell),data&&this.setRowData(result,data)}return result},insertRowBefore:function(data,refRowElem){var row=this._createNewRow(data);return row&&this.getRootElem().insertBefore(row,refRowElem||null),row},appendRow:function(data){return this.insertRowBefore(data,null)},removeRow:function(rowElem){return rowElem===this.getActiveRow()&&this.setActiveRow(null),this.getRootElem().removeChild(rowElem),this},removeRowAt:function(index){var row=this.getRowAt(index);return row&&this.removeRow(row),this},clear:function(){this.setActiveRow(null),this.getRootElem()&&Kekule.DomUtils.clearChildContent(this.getRootElem())},updateAll:function(){for(var rows=this.getRowElems(),i=0,l=rows.length;i<l;++i){var row=rows[i],data=this.getRowData(row);this.setRowData(row,data)}return this},valueDisplayModeChanged:function(){this.updateAll()},getKeyCellText:function(row,data){return data.title||data.key},getKeyCellHint:function(row,data){return data.hint||this.getKeyCellText(row,data)},getValueCellText:function(row,data){return this.getValueDisplayMode()===VDM.JSON?JSON.stringify(data.value):""+data.value},valueCellTextToValue:function(valueText,row,oldData){return this.getValueDisplayMode()===VDM.JSON?JSON.parse(valueText):valueText},setValueCellText:function(valueText,row){var oldData=this.getRowData(row),newValue=this.valueCellTextToValue(valueText,row,oldData);return oldData.value=newValue,this.setRowData(row,oldData),this},getRowData:function(row){return row[this.ROW_DATA_FIELD]},setRowData:function(row,data){row[this.ROW_DATA_FIELD]=data,this.setRowKeyCellContent(row,this.getKeyCellText(row,data),this.getKeyCellHint(row,data)),this.setRowValueCellContent(row,this.getValueCellText(row,data)),row===this.getActiveRow()&&this._inlineEdit&&this.createValueEditWidget(row)},setRowKeyCellContent:function(row,keyText,keyHint){var cell=this.getKeyCell(row),contentWrapper=this.getCellContentWrapper(cell,!0);contentWrapper.innerHTML=keyText,this.getUseKeyHint()&&(contentWrapper.title=keyHint)},setRowValueCellContent:function(row,valueText){var cell=this.getValueCell(row),textWrapper=this.getValueCellTextWrapper(cell,!0),text=valueText;""===text?textWrapper.innerHTML="&nbsp;":Kekule.DomUtils.setElementText(textWrapper,text)},getRowEditInfo:function(row){return row[this.ROW_EDIT_INFO_FIELD]},setRowEditInfo:function(row,info){row[this.ROW_EDIT_INFO_FIELD]=info,row===this.getActiveRow()&&(this.setActiveRow(null),this.setActiveRow(row))},editRow:function(row){this.setActiveRow(row)},finishEditing:function(){var row=this.getActiveRow();return row&&this._inlineEdit&&(this.setValueCellText(this._inlineEdit.getValue(),row),this.invokeEvent("editFinish",{row:row})),this},cancelEditing:function(){var row=this.getActiveRow();if(row&&this._inlineEdit){var oldData=this.getRowData(row);this.setRowData(row,oldData),this.invokeEvent("editCancel",{row:row})}return this},_getTotalHash:function(){for(var result={},rows=this.getRowElems(),i=0,l=rows.length;i<l;++i){var row=rows[i],data=this.getRowData(row);data&&(result[data.key]=data.value)}return result},_setTotalHash:function(hash){for(var rows=this.getRowElems(),oldRowCount=rows.length,keys=Kekule.ObjUtils.getOwnedFieldNames(hash),l=keys.length,i=0;i<l;++i){var row,key=keys[i],value=hash[key];i<oldRowCount?(row=this.getRowAt(i),this.setRowData(row,{key:key,value:value})):row=this.appendRow({key:key,value:value})}if(oldRowCount>l)for(var i=oldRowCount-1;i>=l;--i)this.removeRow(rows[i]);var activeRow=this.getActiveRow();return activeRow&&(this.setActiveRow(null),this.setActiveRow(activeRow)),this},react_click:function(e){var target=e.getTarget(),row=this.getParentRow(target);row&&this.setActiveRow(row)},react_keydown:function(e){var keyCode=e.getKeyCode();if(!(e.getAltKey()||e.getShiftKey()||e.getCtrlKey())){var currRow=this.getActiveRow();if(currRow){var row;keyCode===Kekule.X.Event.KeyCode.UP?row=this.getPrevRow(currRow):keyCode===Kekule.X.Event.KeyCode.DOWN&&(row=this.getNextRow(currRow)),row&&this.setActiveRow(row)}}},react_keyup:function(e){var keyCode=e.getKeyCode();keyCode===Kekule.X.Event.KeyCode.ESC?this.cancelEditing():keyCode===Kekule.X.Event.KeyCode.ENTER&&this.finishEditing()},react_blur:function(e){}}),Kekule.Widget.ValueListEditor.ValueDisplayMode={SIMPLE:0,JSON:1};var VDM=Kekule.Widget.ValueListEditor.ValueDisplayMode;return Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,DataType=(__webpack_require__(0).ClassEx,__webpack_require__(0).ObjectEx,__webpack_require__(0).DataType);module.exports=function(Kekule){var CNS=(Kekule.DomUtils,Kekule.HtmlElementUtils,Kekule.Widget.HtmlClassNames);return Kekule.Widget.HtmlClassNames=Object.extend(Kekule.Widget.HtmlClassNames,{COLORPICKER:"K-ColorPicker",COLORPICKER_HEADER:"K-ColorPicker-Header",COLORPICKER_SPEC_COLOR_PALETTE:"K-ColorPicker-Spec-Color-Palette",COLORPICKER_HEXBOX:"K-ColorPicker-HexBox",COLORPICKER_PREVIEWER:"K-ColorPicker-Previewer",COLORPICKER_INPUT:"K-ColorPicker-Input",COLORPICKER_BROWSE_BTN:"K-ColorPicker-Browse-Btn",COLORPICKER_PALETTE:"K-ColorPicker-Palette",COLORPICKER_PALETTE_LINE:"K-ColorPicker-Palette-Line",COLORPICKER_PALETTE_CELL:"K-ColorPicker-Palette-Cell",COLORPICKER_PALETTE_CELL_TRANSPARENT:"K-ColorPicker-Palette-Cell-Transparent",COLORPICKER_SPEC_COLOR_UNSET:"K-Color-Unset",COLORPICKER_SPEC_COLOR_DEFAULT:"K-Color-Default",COLORPICKER_SPEC_COLOR_MIXED:"K-Color-Mixed",COLORPICKER_SPEC_COLOR_TRANSPARENT:"K-Color-Transparent",COLORDROPTEXTBOX:"K-ColorDropTextBox",COLORDROPBUTTON:"K-ColorDropButton",COLORPREVIEWER:"K-ColorPreviewer"}),Kekule.Widget.ColorPicker=Class.create(Kekule.Widget.BaseWidget,{CLASS_NAME:"Kekule.Widget.ColorPicker",COLOR_VALUE_FIELD:"__$colorValue__",COLOR_TEXT_FIELD:"__$colorText__",COLOR_CLASS_FIELD:"__ $colorClass__",BINDABLE_TAG_NAMES:["div","span"],initialize:function($super,parentOrElementOrDocument){$super(parentOrElementOrDocument),this.setUseCornerDecoration(!0),this.setValue("#000000")},initProperties:function(){this.defineProp("value",{dataType:DataType.STRING,setter:function(value){this.setPropStoreFieldValue("value",value),this.getHexBox().innerHTML=value||"&nbsp;",this.getPreviewer().style.backgroundColor=value,this.getColorInput()&&(this.getColorInput().value=value)}}),this.defineProp("colorClassName",{dataType:DataType.STRING}),this.defineProp("specialColors",{dataType:DataType.ARRAY,setter:function(value){this.setPropStoreFieldValue("specialColors",value),this._recreateSpecialColorPaletteCells(this.getDocument(),this.getSpecialColorPalette())}}),this.defineProp("isDirty",{dataType:DataType.BOOL,serializable:!1}),this.defineProp("hexBox",{dataType:DataType.OBJECT,serializable:!1,scope:Class.PropertyScope.PRIVATE}),this.defineProp("palette",{dataType:DataType.OBJECT,serializable:!1,scope:Class.PropertyScope.PRIVATE}),this.defineProp("previewer",{dataType:DataType.OBJECT,serializable:!1,scope:Class.PropertyScope.PRIVATE}),this.defineProp("colorInput",{dataType:DataType.OBJECT,serializable:!1,scope:Class.PropertyScope.PRIVATE}),this.defineProp("specialColorPalette",{dataType:DataType.OBJECT,serializable:!1,scope:Class.PropertyScope.PRIVATE}),this.defineProp("isPicking",{dataType:DataType.BOOL,serializable:!1,scope:Class.PropertyScope.PRIVATE})},doGetWidgetClassName:function($super){return $super()+" "+CNS.COLORPICKER},doCreateRootElement:function(doc){return doc.createElement("div")},doCreateSubElements:function(doc,rootElem){var result=[];return result.push(this.doCreateHeader(doc,rootElem)),result.push(this.doCreatePalette(doc,rootElem)),result},doCreateHeader:function(doc,parentElem){var result=doc.createElement("div");result.className=CNS.COLORPICKER_HEADER,result.appendChild(this.doCreateSpecialColorPalette(doc)),result.appendChild(this.doCreateHexBox(doc)),result.appendChild(this.doCreatePreviewer(doc));var colorInputElem=this.doCreateColorInput(doc);if(colorInputElem){result.appendChild(colorInputElem);var btn=this.doCreateColorDialogBtn(doc);btn&&btn.appendToElem(result)}return parentElem.appendChild(result),result},doCreateSpecialColorPalette:function(doc){var result=doc.createElement("div");return result.className=CNS.COLORPICKER_SPEC_COLOR_PALETTE,this._recreateSpecialColorPaletteCells(doc,result),this.setSpecialColorPalette(result),result},_isPredefinedSpecialColor:function(color){var SC=Kekule.Widget.ColorPicker.SpecialColors;return[SC.UNSET,SC.DEFAULT,SC.MIXED,SC.TRANSPARENT].indexOf(color)>=0},_getPredefinedSpecialColorInfo:function(color){var SC=Kekule.Widget.ColorPicker.SpecialColors,predefines=[SC.UNSET,SC.DEFAULT,SC.MIXED,SC.TRANSPARENT],classNames=[CNS.COLORPICKER_SPEC_COLOR_UNSET,CNS.COLORPICKER_SPEC_COLOR_DEFAULT,CNS.COLORPICKER_SPEC_COLOR_MIXED,CNS.COLORPICKER_SPEC_COLOR_TRANSPARENT],texts=[Kekule.$L("WidgetTexts.S_COLOR_UNSET"),Kekule.$L("WidgetTexts.S_COLOR_DEFAULT"),Kekule.$L("WidgetTexts.S_COLOR_MIXED"),Kekule.$L("WidgetTexts.S_COLOR_TRANSPARENT")],result={value:color},index=predefines.indexOf(color);return index>=0&&(result.text=texts[index],result.className=classNames[index]),result},_recreateSpecialColorPaletteCells:function(doc,parentElem){Kekule.DomUtils.clearChildContent(parentElem);var colors=this.getSpecialColors();if(colors&&colors.length)for(var i=0,l=colors.length;i<l;++i){var elem,color=colors[i],colorInfo={};DataType.isObjectValue(color)?colorInfo=color:this._isPredefinedSpecialColor(color)?colorInfo=this._getPredefinedSpecialColorInfo(color):colorInfo.value=color,elem=this.doCreatePaletteCell(doc,colorInfo.value,colorInfo.text,colorInfo.className),colorInfo.className&&Kekule.HtmlElementUtils.addClass(elem,colorInfo.className),parentElem.appendChild(elem)}},doCreateHexBox:function(doc){var result=doc.createElement("span");return result.className=CNS.COLORPICKER_HEXBOX,result.innerHTML="&nbsp",this.setHexBox(result),result},doCreatePreviewer:function(doc){var result=doc.createElement("span");return result.className=CNS.COLORPICKER_PREVIEWER,result.innerHTML="&nbsp",this.setPreviewer(result),result},doCreateColorInput:function(doc){if(Kekule.BrowserFeature.html5Form.supportType("color")){var result=doc.createElement("input");result.setAttribute("type","color"),result.className=CNS.COLORPICKER_INPUT;var self=this;return Kekule.X.Event.addListener(result,"change",function(e){var value=result.value;self.setValue(value),self.notifyColorSet()}),this.setColorInput(result),result}return null},doCreateColorDialogBtn:function(doc){if(Kekule.BrowserFeature.html5Form.supportType("color")){var btn=new Kekule.Widget.Button(doc);return btn.setText(Kekule.$L("WidgetTexts.CAPTION_BROWSE_COLOR")),btn.setHint(Kekule.$L("WidgetTexts.HINT_BROWSE_COLOR")),btn.setShowText(!1),btn.doSetShowGlyph(!0),btn.linkStyleResource(Kekule.Widget.StyleResourceNames.ICON_COLOR_PICK),btn.addClassName(CNS.COLORPICKER_BROWSE_BTN),btn.addEventListener("execute",this.openColorDialog,this),btn}},doCreatePalette:function(doc,parentElem){var result=doc.createElement("div");result.className=CNS.COLORPICKER_PALETTE;for(var seeds=["00","00","11","22","33","44","55","66","77","88","99","AA","BB","CC","DD","EE","FF",null],seedsLength=seeds.length,lineElem=this.doCreatePaletteLine(doc),i=0;i<seedsLength;i++){var sColor=seeds[i]?"#"+seeds[i]+seeds[i]+seeds[i]:"transparent",cellElem=this.doCreatePaletteCell(doc,sColor);lineElem.appendChild(cellElem)}result.appendChild(lineElem),seeds=["00","33","66","99","CC","FF"];for(var seedsLength=seeds.length,i=0;i<seedsLength;i++){for(var lineElem=this.doCreatePaletteLine(doc),j=0;j<seedsLength>>1;j++)for(var k=0;k<seedsLength;k++){var sColor="#"+seeds[j]+seeds[i]+seeds[k],cellElem=this.doCreatePaletteCell(doc,sColor);lineElem.appendChild(cellElem)}result.appendChild(lineElem)}for(var i=0;i<seedsLength;i++){for(var lineElem=this.doCreatePaletteLine(doc),j=seedsLength>>1;j<seedsLength;j++)for(var k=0;k<seedsLength;k++){var sColor="#"+seeds[j]+seeds[i]+seeds[k],cellElem=this.doCreatePaletteCell(doc,sColor);lineElem.appendChild(cellElem)}result.appendChild(lineElem)}return parentElem.appendChild(result),this.setPalette(result),result},doCreatePaletteCell:function(doc,sColor,sText,sClassName){var result=doc.createElement("span"),className=CNS.COLORPICKER_PALETTE_CELL;if("transparent"===sColor)className+=" "+CNS.COLORPICKER_PALETTE_CELL_TRANSPARENT;else try{result.style.backgroundColor=sColor}catch(e){}return result[this.COLOR_VALUE_FIELD]=sColor,result[this.COLOR_TEXT_FIELD]=sText||sColor,result[this.COLOR_CLASS_FIELD]=sClassName,result.className=className,result.title=sText||sColor,result},doCreatePaletteLine:function(doc){var result=doc.createElement("div");return result.className=CNS.COLORPICKER_PALETTE_LINE,result},_isPaletteCellElem:function(elem){return Kekule.HtmlElementUtils.hasClass(elem,CNS.COLORPICKER_PALETTE_CELL)},openColorDialog:function(){return this.getColorInput()&&this.getColorInput().click(),this},applyColor:function(targetElem){var color=targetElem[this.COLOR_VALUE_FIELD];color&&this.setValue(color);var colorText=targetElem[this.COLOR_TEXT_FIELD];colorText&&(this.getHexBox().innerHTML=colorText);var colorClassName=targetElem[this.COLOR_CLASS_FIELD];this.setColorClassName(colorClassName)},notifyColorSet:function(){this.setIsDirty(!0),this.invokeEvent("valueSet",{value:this.getValue(),colorClassName:this.getColorClassName()}),this.invokeEvent("valueChange",{value:this.getValue(),colorClassName:this.getColorClassName()})},doReactActiviting:function($super,e){$super(e);var target=e.getTarget();if(this._isPaletteCellElem(target))return this.setIsPicking(!0),this.applyColor(target),!0},doReactDeactiviting:function($super,e){if(this.getIsPicking()){this.setIsPicking(!1);var target=e.getTarget();return this._isPaletteCellElem(target)&&this.applyColor(target),this.notifyColorSet(),!0}$super(e)},reactPointerMoving:function($super,e){if($super(e),this.getIsPicking()){var target=e.getTarget();if(e.getTouches()){var coord={x:e.getWindowX(),y:e.getWindowY()},doc=this.getDocument();target=doc.elementFromPoint&&doc.elementFromPoint(coord.x,coord.y)||target,e.preventDefault()}return target&&this._isPaletteCellElem(target)&&this.applyColor(target),!0}}}),Kekule.Widget.ColorPicker.SpecialColors={UNSET:"(unset)",DEFAULT:"(default)",MIXED:"(mixed)",TRANSPARENT:"transparent"},Kekule.Widget.ColorDropTextBox=Class.create(Kekule.Widget.ButtonTextBox,{CLASS_NAME:"Kekule.Widget.ColorDropTextBox",initialize:function($super,parentOrElementOrDocument,value){$super(parentOrElementOrDocument),this.setButtonKind(Kekule.Widget.Button.Kinds.DROPDOWN),this.addEventListener("buttonExecute",this.reactDropbuttonExecute,this),this.setShowPreview(!0),value&&this.setValue(value)},initProperties:function(){this.defineProp("showPreview",{dataType:DataType.BOOL,setter:function(value){this.getPreviewElem().style.display=value?"inherit":""}}),this.defineProp("colorClassName",{dataType:DataType.STRING,setter:function(value){var elem=this.getPreviewElem();if(elem){var old=this.getColorClassName();old&&Kekule.HtmlElementUtils.removeClass(elem,old),value&&Kekule.HtmlElementUtils.addClass(elem,value)}this.setPropStoreFieldValue("colorClassName",value)}}),this.defineProp("colorPicker",{dataType:"Kekule.Widget.ColorPicker",setter:null,serializable:!1,scope:Class.PropertyScope.PUBLIC,getter:function(){var result=this.getPropStoreFieldValue("colorPicker");return result||(result=new Kekule.Widget.ColorPicker(this),result.setDisplayed(!1),result.getElement().style.position="absolute",result.setSpecialColors(this.getSpecialColors()),result.addEventListener("valueChange",this.reactColorPickerValueSet,this),result.appendToElem(this.getElement()),this.setPropStoreFieldValue("colorPicker",result)),result}}),this.defineProp("specialColors",{dataType:DataType.ARRAY,setter:function(value){this.setPropStoreFieldValue("specialColors",value);var picker=this.getPropStoreFieldValue("colorPicker");picker&&picker.setSpecialColors(value)}})},doFinalize:function($super){var picker=this.getPropStoreFieldValue("colorPicker");picker&&picker.finalize(),$super()},doGetWidgetClassName:function($super){return $super()+" "+CNS.COLORDROPTEXTBOX},doCreateSubElements:function($super,doc,rootElem){$super(doc,rootElem);var previewWidget=new Kekule.Widget.DumbWidget(this);return previewWidget.addClassName(CNS.COLORPREVIEWER),this.setHeadingWidget(previewWidget),[previewWidget.getElement()]},getPreviewElem:function(){var widget=this.getHeadingWidget();if(widget)return widget.getElement()},showColorPicker:function(){var picker=this.getColorPicker();picker.isShown()||(picker.setValue(this.getValue()),picker.show(this,null,Kekule.Widget.ShowHideType.DROPDOWN))},hideColorPicker:function(){var picker=this.getPropStoreFieldValue("colorPicker");picker&&picker.isShown()&&picker.hide()},reactDropbuttonExecute:function(e){this.showColorPicker()},reactColorPickerValueSet:function(e){var value=e.value;this.setValue(value),this.setIsDirty(this.getIsDirty()||this.getColorPicker().getIsDirty()),this.setColorClassName(e.colorClassName),this.hideColorPicker(),e.stopPropagation()},doSetValue:function($super,value){$super(value);var elem=this.getPreviewElem();elem&&(elem.style.backgroundColor="transparent",elem.style.backgroundColor=value)}}),Kekule.Widget.ColorDropButton=Class.create(Kekule.Widget.DropDownButton,{CLASS_NAME:"Kekule.Widget.ColorDropButton",initialize:function($super,parentOrElementOrDocument,value){$super(parentOrElementOrDocument),this.setButtonKind(Kekule.Widget.Button.Kinds.DROPDOWN),this.setShowPreview(!0),value&&this.setValue(value)},initProperties:function(){this.defineProp("showPreview",{dataType:DataType.BOOL,setter:function(value){this.getPreviewElem().style.display=value?"inherit":""}}),this.defineProp("value",{dataType:DataType.STRING,getter:function(){return this.getText()},setter:function(value){this.setText(value),this.updateColorPreview(value)}}),this.defineProp("colorClassName",{dataType:DataType.STRING,setter:function(value){var elem=this.getPreviewElem();if(elem){var old=this.getColorClassName();old&&Kekule.HtmlElementUtils.removeClass(elem,old),value&&Kekule.HtmlElementUtils.addClass(elem,value)}this.setPropStoreFieldValue("colorClassName",value)}}),this.defineProp("colorPicker",{dataType:"Kekule.Widget.ColorPicker",setter:null,serializable:!1,scope:Class.PropertyScope.PUBLIC,getter:function(){var result=this.getPropStoreFieldValue("colorPicker");return result||(result=new Kekule.Widget.ColorPicker(this),result.setDisplayed(!1),result.getElement().style.position="absolute",result.setSpecialColors(this.getSpecialColors()),result.addEventListener("valueChange",this.reactColorPickerValueSet,this),this.setPropStoreFieldValue("colorPicker",result)),result}}),this.defineProp("specialColors",{dataType:DataType.ARRAY,setter:function(value){this.setPropStoreFieldValue("specialColors",value);var picker=this.getPropStoreFieldValue("colorPicker");picker&&picker.setSpecialColors(value)}}),this.defineProp("isDirty",{dataType:DataType.BOOL,serializable:!1,getter:function(){return this.getColorPicker().getIsDirty()},setter:function(value){this.getColorPicker().setIsDirty(value)}})},doFinalize:function($super){var picker=this.getPropStoreFieldValue("colorPicker");picker&&picker.finalize(),$super()},doGetWidgetClassName:function($super){return $super()+" "+CNS.COLORDROPBUTTON},doGetDropDownWidget:function(){return this.getColorPicker()},getPreviewElem:function(){return this._elemLeadingGlyphPart},showColorPicker:function(){var picker=this.getColorPicker();picker.isShown()||(picker.setValue(this.getValue()),picker.show(this,null,Kekule.Widget.ShowHideType.DROPDOWN))},hideColorPicker:function(){var picker=this.getPropStoreFieldValue("colorPicker");picker&&picker.isShown()&&picker.hide()},reactColorPickerValueSet:function(e){var value=e.value,className=e.colorClassName;this.setValue(value),this.setColorClassName(className),this.hideColorPicker(),this.invokeEvent("valueChange",{value:value}),e.stopPropagation()},updateColorPreview:function(value){var elem=this.getPreviewElem();elem&&(elem.style.backgroundColor="transparent",elem.style.backgroundColor=value)}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,DataType=(__webpack_require__(0).ClassEx,__webpack_require__(0).ObjectEx,__webpack_require__(0).DataType);module.exports=function(Kekule){var CNS=(Kekule.DomUtils,Kekule.HtmlElementUtils,Kekule.Widget.HtmlClassNames);return Kekule.Widget.HtmlClassNames=Object.extend(Kekule.Widget.HtmlClassNames,{TEXTEDITOR:"K-TextEditor",TEXTEDITOR_TOOLBAR:"K-TextEditor-Toolbar",TEXTEDITOR_TEXTAREA:"K-TextEditor-TextArea",TEXTEDITOR_FONTBOX:"K-TextEditor-FontBox",TEXTEDITOR_BTN_FONTSIZEINC:"K-TextEditor-Btn-FontSizeInc",TEXTEDITOR_BTN_FONTSIZEDEC:"K-TextEditor-Btn-FontSizeDec",TEXTEDITOR_BTN_TEXTWRAP:"K-TextEditor-Btn-TextWrap"}),Kekule.Widget.TextEditor=Class.create(Kekule.Widget.FormWidget,{CLASS_NAME:"Kekule.Widget.TextEditor",BINDABLE_TAG_NAMES:["div","span"],DEF_TOOLBAR_COMPONENTS:["fontFamily","fontSizeInc","fontSizeDec","textWrap"],initialize:function($super,parentOrElementOrDocument){this._toolCompWidgets=[],this.setPropStoreFieldValue("showToolbar",!0),$super(parentOrElementOrDocument)},initProperties:function(){this.defineProp("text",{dataType:DataType.STRING,serializable:!1,getter:function(){var textArea=this.getTextArea();return textArea?textArea.getText():null},setter:function(value){var textArea=this.getTextArea();textArea&&textArea.setText(value)}}),this.defineProp("readOnly",{dataType:DataType.BOOL,serializable:!1,getter:function(){return this.getTextArea().getReadOnly()},setter:function(value){return this.getTextArea().setReadOnly(value)}}),this.defineProp("wrap",{dataType:DataType.STRING,serializable:!1,getter:function(){return this.getTextArea().getWrap()},setter:function(value){var result=this.getTextArea().setWrap(value);return this.updateToolButtonStates(),result}}),this.defineProp("textArea",{dataType:"Kekule.Widget.TextArea",serializable:!1,setter:null,scope:Class.PropertyScope.PRIVATE,getter:function(){var result=this.getPropStoreFieldValue("textArea");return result||(result=this.createTextArea(),this.setPropStoreFieldValue("textArea",result)),result}}),this.defineProp("toolbar",{dataType:"Kekule.Widget.Toolbar",serializable:!1,setter:null,scope:Class.PropertyScope.PRIVATE,getter:function(){var result=this.getPropStoreFieldValue("toolbar");return result||this.getShowToolbar()&&(result=this.createToolbar(),this.setPropStoreFieldValue("styleToolbar",result)),result}}),this.defineProp("showToolbar",{dataType:DataType.BOOL,setter:function(value){this.setPropStoreFieldValue("showToolbar",value),this.getToolbar().setDisplayed(value)}}),this.defineProp("toolbarPos",{dataType:DataType.INT,setter:function(value){this.setPropStoreFieldValue("toolbarPos",value),this.updateChildWidgetPos()}}),this.defineProp("toolbarComponents",{dataType:DataType.ARRAY,serializable:!1,getter:function(){var result=this.getPropStoreFieldValue("toolbarComponents");return result||(result=null,this.setPropStoreFieldValue("toolbarComponents",result)),result},setter:function(value){this.setPropStoreFieldValue("toolbarComponents",value),this.recreateToolbarComponents(value)}}),this.defineProp("candidateFontFamilies",{dataType:DataType.ARRAY}),this.defineProp("fontSizeLevel",{dataType:DataType.FLOAT,setter:function(value){this.setPropStoreFieldValue("fontSizeLevel",value),this.setTextStyle({fontSize:value+"em"})}})},finalize:function($super){this._finalizeSubElements(),$super()},_finalizeSubElements:function(){var textArea=this.getTextArea();textArea&&textArea.finalize()},getCoreElement:function($super){var textArea=this.getTextArea();return textArea?textArea.getElement():$super()},doGetWidgetClassName:function($super){return $super()+" "+CNS.TEXTEDITOR},doCreateRootElement:function(doc){return doc.createElement("span")},doCreateSubElements:function(doc,rootElem){var toolbar=this.createToolbar();toolbar&&toolbar.appendToElem(rootElem);var textArea=this.createTextArea();return textArea.appendToElem(rootElem),this.updateChildWidgetPos(),[toolbar.getElement(),textArea.getElement()]},doWidgetShowStateChanged:function($super,isShown){$super(isShown),isShown&&(this.updateChildWidgetPos(),this.updateToolButtonStates())},createToolbar:function(){if(this.getShowToolbar()){var toolbar=new Kekule.Widget.Toolbar(this);return this.setPropStoreFieldValue("toolbar",toolbar),toolbar.addClassName(CNS.TEXTEDITOR_TOOLBAR),this.recreateToolbarComponents(),toolbar}return null},recreateToolbarComponents:function(comps){comps||(comps=this.getToolbarComponents());var components=comps||this.DEF_TOOLBAR_COMPONENTS,toolbar=this.getToolbar();if(toolbar){this._toolCompWidgets.length=0,toolbar.clearWidgets(),toolbar.setShowText(!1),toolbar.setShowGlyph(!0);for(var widget,i=0,l=components.length;i<l;++i){var comp=components[i];widget="fontFamily"===comp?this.createFontFamilyComboBox(toolbar):this.createToolButton(toolbar,comp),this._toolCompWidgets[comp]=widget}this.updateToolButtonStates()}},createFontFamilyComboBox:function(toolbar){for(var result=new Kekule.Widget.ComboBox(toolbar),fontFamilies=Kekule.Widget.FontEnumerator.getAvailableFontFamilies(this.getCandidateFontFamilies()),boxItems=[],i=0,l=fontFamilies.length;i<l;++i)boxItems.push({text:fontFamilies[i],value:fontFamilies[i]});return result.setHint(Kekule.$L("WidgetTexts.HINT_CHOOSE_FONT_FAMILY")),result.addClassName(CNS.TEXTEDITOR_FONTBOX),result.setItems(boxItems),result.appendToWidget(toolbar),result.addEventListener("valueChange",function(e){this.setTextStyle({fontFamily:result.getValue()})},this),result},createToolButton:function(toolbar,btnName){var caption,hint,cssClassName,btnClass="textWrap"===btnName?Kekule.Widget.CheckButton:Kekule.Widget.Button,result=new btnClass(toolbar);return result.appendToWidget(toolbar),"textWrap"===btnName?(caption=Kekule.$L("WidgetTexts.CAPTION_TOGGLE_TEXTWRAP"),hint=Kekule.$L("WidgetTexts.HINT_TOGGLE_TEXTWRAP"),cssClassName=CNS.TEXTEDITOR_BTN_TEXTWRAP,result.setChecked("off"!==this.getWrap()),result.addEventListener("checkChange",function(e){var wrap=result.getChecked();this.setWrap(wrap?"virtual":"off")},this)):"fontSizeInc"===btnName?(caption=Kekule.$L("WidgetTexts.CAPTION_INC_TEXT_SIZE"),hint=Kekule.$L("WidgetTexts.HINT_INC_TEXT_SIZE"),cssClassName=CNS.TEXTEDITOR_BTN_FONTSIZEINC,result.addEventListener("execute",this.increaseTextSize,this)):"fontSizeDec"===btnName&&(caption=Kekule.$L("WidgetTexts.CAPTION_DEC_TEXT_SIZE"),hint=Kekule.$L("WidgetTexts.HINT_DEC_TEXT_SIZE"),cssClassName=CNS.TEXTEDITOR_BTN_FONTSIZEDEC,result.addEventListener("execute",this.decreaseTextSize,this)),result.setText(caption),result.setHint(hint),result.addClassName(cssClassName),result},createToolCheckButton:function(toolbar,btnName){var result=new Kekule.Widget.CheckButton(toolbar);return result.appendToWidget(toolbar),result},createTextArea:function(){var result=new Kekule.Widget.TextArea(this);return this.setPropStoreFieldValue("textArea",result),result.addClassName(CNS.TEXTEDITOR_TEXTAREA),result},updateChildWidgetPos:function(){var toolbarPos=this.getToolbarPos(),toolbarElem=this.getToolbar().getElement(),textAreaElem=this.getTextArea().getElement(),parentElem=toolbarElem.parentNode;toolbarPos===Kekule.Widget.Position.BOTTOM?parentElem.insertBefore(textAreaElem,toolbarElem):parentElem.insertBefore(toolbarElem,textAreaElem)},updateToolButtonStates:function(){var btn=this._toolCompWidgets.textWrap;btn&&btn.setChecked("off"!==this.getWrap())},setTextStyle:function(cssStyles){var textArea=this.getTextArea();if(textArea)for(var props=Kekule.ObjUtils.getOwnedFieldNames(cssStyles),i=0,l=props.length;i<l;++i){var p=props[i];textArea.setStyleProperty(p,cssStyles[p])}return this},increaseTextSize:function(){var level=this.getFontSizeLevel()||1,newLevel=Kekule.ZoomUtils.getNextZoomInRatio(level);this.setFontSizeLevel(newLevel)},decreaseTextSize:function(){var level=this.getFontSizeLevel()||1,newLevel=Kekule.ZoomUtils.getNextZoomOutRatio(level);this.setFontSizeLevel(newLevel)}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,DataType=(__webpack_require__(0).ClassEx,__webpack_require__(0).ObjectEx,__webpack_require__(0).DataType);module.exports=function(Kekule){var AU=Kekule.ArrayUtils,SU=Kekule.StyleUtils,DU=Kekule.DomUtils,EU=Kekule.HtmlElementUtils;Kekule.Widget.HtmlClassNames=Object.extend(Kekule.Widget.HtmlClassNames,{WIDGET_GRID:"K-Widget-Grid",WIDGET_GRID_CELL:"K-Widget-Grid-Cell",WIDGET_GRID_ADD_CELL:"K-Widget-Grid-Add-Cell",WIDGET_GRID_INTERACTION_AREA:"K-Widget-Grid-Interaction-Area",WIDGET_GRID_WIDGET_PARENT:"K-Widget-Grid-Widget-Parent",WIDGET_GRID_BUTTON_REMOVE:"K-Widget-Grid-Button-Remove",WIDGET_GRID_ENABLE_CELL_INTERACTION:"K-Widget-Grid-Enable-Cell-Interaction"});var CNS=Kekule.Widget.HtmlClassNames;return Kekule.Widget.WidgetGrid=Class.create(Kekule.Widget.Container,{CLASS_NAME:"Kekule.Widget.WidgetGrid",CELL_FIELD:"__$cell__",WIDGET_FIELD:"__$cellWidget__",INTERACTION_AREA_FIELD:"__$interactionArea__",EXCEED_TOPRIGHT_FIELD:"__$exceedTopRight__",BTN_REMOVE_CELL_FIELD:"__$removeCell__",initialize:function($super,parentOrElementOrDocument){this._floatClearer=null,this.reactCellMouseEnterBind=this.reactCellMouseEnter.bind(this),this.reactCellMouseLeaveBind=this.reactCellMouseLeave.bind(this),this.reactCellClickBind=this.reactCellClick.bind(this),$super(parentOrElementOrDocument),this.addEventListener("change",this.reactChildWidgetChange,this)},initProperties:function(){this.defineProp("childWidgetClass",{dataType:DataType.CLASS,serializable:!1}),this.defineProp("cellWidth",{dataType:DataType.STRING}),this.defineProp("cellHeight",{dataType:DataType.STRING}),this.defineProp("widgetPos",{dataType:DataType.INT,enumSource:Kekule.Widget.Position}),this.defineProp("autoShrinkWidgets",{dataType:DataType.BOOL}),this.defineProp("keepWidgetAspectRatio",{dataType:DataType.BOOL}),this.defineProp("restoreWidgetSizeOnHotTrack",{dataType:DataType.BOOL}),this.defineProp("enableAdd",{dataType:DataType.BOOL,setter:function(value){if(this.setPropStoreFieldValue("enableAdd",value),value)this.setAddingCell(this.createAddCell());else{var cell=this.getAddingCell();cell&&this.getContainerElement().removeChild(cell)}}}),this.defineProp("enableRemove",{dataType:DataType.BOOL,getter:function(){return this.hasClassName(CNS.WIDGET_GRID_ENABLE_CELL_INTERACTION)},setter:function(value){value?this.addClassName(CNS.WIDGET_GRID_ENABLE_CELL_INTERACTION):this.removeClassName(CNS.WIDGET_GRID_ENABLE_CELL_INTERACTION)}}),this.defineProp("hotCell",{dataType:DataType.OBJECT,serializable:!1,setter:function(value){this.getHotCell()!==value&&(this.hotCellChanged(this.getHotCell(),value),this.setPropStoreFieldValue("hotCell",value))}}),this.defineProp("addingCell",{dataType:DataType.OBJECT,serializable:!1})},initPropValues:function(){this.setPropStoreFieldValue("autoShrinkWidgets",!0),this.setPropStoreFieldValue("keepWidgetAspectRatio",!0),this.setPropStoreFieldValue("restoreWidgetSizeOnHotTrack",!0),this.setEnableRemove(!0),this.setUseCornerDecoration(!0)},doGetWidgetClassName:function($super){return $super()+" "+CNS.WIDGET_GRID},doCreateRootElement:function(doc){return doc.createElement("div")},doSetUseCornerDecoration:function($super,value){$super(value),this.updateAllCells()},doObjectChange:function($super,modifiedPropNames){$super(modifiedPropNames),AU.intersect(modifiedPropNames,["autoShrinkWidgets","keepWidgetAspectRatio","cellWidth","cellHeight","widgetPos"]).length>0&&this.updateAllCells()},doWidgetShowStateChanged:function($super,isShown){return isShown&&this.updateAllCells(),$super(isShown)},each:function(callFunc){for(var ws=Kekule.ArrayUtils.clone(this.getChildWidgets()),i=0,l=ws.length;i<l;++i)callFunc(ws[i])},addWidget:function(widget){widget.setParent(this)},removeWidget:function(widget,doFinalize){this.hasChild(widget)&&(widget.setParent(null),doFinalize&&widget.finalize())},createWidget:function(){var result=this.doCreateNewChildWidget(this.getDocument());if(result)return result.setParent(this),result},doCreateNewChildWidget:function(doc){return null},getFloatClearer:function(){return this._floatClearer||(this._floatClearer=this.getDocument().createElement("div"),this._floatClearer.style.clear="both",this.getContainerElement().appendChild(this._floatClearer)),this._floatClearer},createCell:function(widget){var isAddCell=!widget,doc=this.getDocument(),cell=doc.createElement("div");cell.className=CNS.WIDGET_GRID_CELL+" "+CNS.DYN_CREATED+(isAddCell?" "+CNS.WIDGET_GRID_ADD_CELL:""),cell[this.WIDGET_FIELD]=widget,Kekule.X.Event.addListener(cell,"mouseenter",this.reactCellMouseEnterBind),Kekule.X.Event.addListener(cell,"mouseleave",this.reactCellMouseLeaveBind),Kekule.X.Event.addListener(cell,"click",this.reactCellClickBind);var p=doc.createElement("div");if(p.className=CNS.WIDGET_GRID_WIDGET_PARENT+" "+CNS.DYN_CREATED,p[this.WIDGET_FIELD]=widget,isAddCell&&(p.innerHTML=Kekule.$L("WidgetTexts.CAPTION_ADD_CELL"),p.title=Kekule.$L("WidgetTexts.HINT_ADD_CELL")),cell.appendChild(p),widget&&(widget.appendToElem(p),widget[this.CELL_FIELD]=cell),!isAddCell){var interElem=doc.createElement("div");interElem.className=CNS.WIDGET_GRID_INTERACTION_AREA+" "+CNS.DYN_CREATED,cell.appendChild(interElem),p[this.INTERACTION_AREA_FIELD]=interElem,cell[this.INTERACTION_AREA_FIELD]=interElem,this.createCellInteractionWidgets(interElem,cell)}return this.getAddingCell()&&!isAddCell?this.getContainerElement().insertBefore(cell,this.getAddingCell()):this.getContainerElement().insertBefore(cell,this.getFloatClearer()),this.updateCell(cell),cell},createAddCell:function(){return this.createCell(null)},createCellInteractionWidgets:function(parentElem,cellElem){var btn=new Kekule.Widget.Button(parentElem.ownerDocument);btn.setText(Kekule.$L("WidgetTexts.CAPTION_REMOVE_CELL")),btn.setHint(Kekule.$L("WidgetTexts.HINT_REMOVE_CELL")),btn.addClassName(CNS.WIDGET_GRID_BUTTON_REMOVE),btn[this.BTN_REMOVE_CELL_FIELD]=!0;var widget=this.getContainingWidget(cellElem);btn[this.WIDGET_FIELD]=widget,btn.setShowText(!1),btn.setShowGlyph(!0),btn.addEventListener("execute",function(e){var btn=e.widget,widget=btn[this.WIDGET_FIELD];this.removeWidget(widget,!0)},this),btn.appendToElem(parentElem)},getWidgetCell:function(widget){return widget[this.CELL_FIELD]},getWidgetParentElem:function(widget){var elem=widget.getElement();return elem&&elem.parentNode},getWidgetParentElemOfCell:function(cell){return cell.children[0]},getInteractionAreaElemOfCell:function(cell){return cell[this.INTERACTION_AREA_FIELD]},getContainingWidget:function(elem){return elem[this.WIDGET_FIELD]},childWidgetAdded:function($super,widget){$super(widget),this.createCell(widget)},childWidgetRemoved:function($super,widget){$super(widget);var cellElem=this.getWidgetCell(widget);this.getContainerElement().removeChild(cellElem)},childWidgetMoved:function($super,widget,newIndex){$super(widget,newIndex);var elem=this.getWidgetCell(widget),refWidget=this.getChildWidgets()[newIndex+1],refElem=refWidget?this.getWidgetCell(refWidget):null;refElem?this.getContainerElement().insertBefore(elem,refElem):this.getContainerElement().appendChild(elem)},childrenModified:function($super){this.getContainerElement().appendChild(this.getFloatClearer())},getAllCells:function(){for(var widgets=this.getChildWidgets(),result=[],i=0,l=widgets.length;i<l;++i)result.push(this.getWidgetCell(widgets[i]));return this.getAddingCell()&&result.push(this.getAddingCell()),result},updateCell:function(cellElem,isHotCell){var style=cellElem.style,w=this.getCellWidth(),h=this.getCellHeight();w?style.width=w:SU.removeStyleProperty(style,"width"),h?style.height=h:SU.removeStyleProperty(style,"height"),this.getUseCornerDecoration()?EU.addClass(cellElem,CNS.CORNER_ALL):EU.removeClass(cellElem,CNS.CORNER_ALL),this.adjustCellWidgetPos(cellElem,isHotCell),this.adjustInteractionArea(cellElem,isHotCell)},adjustCellWidgetPos:function(cellElem,isHotCell){for(var containerElem=this.getWidgetParentElemOfCell(cellElem),widgetBound=EU.getElemOffsetDimension(containerElem),cellBound=EU.getElemClientDimension(cellElem),paddingNames=["top","right","bottom","left"],paddings={},i=0,l=paddingNames.length;i<l;++i){var sv=SU.getComputedStyle(cellElem,"padding-"+paddingNames[i]);paddings[paddingNames[i]]=SU.analysisUnitsValue(sv).value||0}var cellClientBound=Object.extend({},cellBound);cellClientBound.width-=paddings.left+paddings.right,cellClientBound.height-=paddings.top+paddings.bottom;var pos=this.getWidgetPos(),WP=Kekule.Widget.Position,left=pos&WP.LEFT?paddings.left:pos&WP.RIGHT?cellBound.width-widgetBound.width-paddings.right:(cellClientBound.width-widgetBound.width)/2+paddings.left,top=pos&WP.TOP?paddings.top:pos&WP.BOTTOM?cellBound.height-widgetBound.height-paddings.bottom:(cellClientBound.height-widgetBound.height)/2+paddings.top;containerElem.style.left=left+"px",containerElem.style.top=top+"px";var interArea=this.getInteractionAreaElemOfCell(cellElem);if(interArea){var interAreaBound=EU.getElemClientDimension(interArea),right=left+widgetBound.width,exceedTopRightCorner=right+interAreaBound.width>=cellBound.width&&top<=interAreaBound.height;cellElem[this.EXCEED_TOPRIGHT_FIELD]=exceedTopRightCorner}if(this.getAutoShrinkWidgets()&&!isHotCell||!this.getRestoreWidgetSizeOnHotTrack()){var scaleX=widgetBound.width>cellClientBound.width?cellClientBound.width/widgetBound.width:null,scaleY=widgetBound.height>cellClientBound.height?cellClientBound.height/widgetBound.height:1;if(this.getKeepWidgetAspectRatio()){var scale=scaleX&&scaleY?Math.min(scaleX,scaleY):scaleX||scaleY;scaleX=scale,scaleY=scale}containerElem.style.transform="scale("+scaleX+", "+scaleY+")";var scaleOriginX=pos&WP.LEFT?"0":pos&WP.RIGHT?"100%":"50%",scaleOriginY=pos&WP.TOP?"0":pos&WP.BOTTOM?"100%":"50%";containerElem.style.transformOrigin=scaleOriginX+" "+scaleOriginY}else containerElem.style.transform="none"},adjustInteractionArea:function(cellElem,isHotCell){var areaElem=this.getInteractionAreaElemOfCell(cellElem);if(areaElem)if(isHotCell){if(cellElem[this.EXCEED_TOPRIGHT_FIELD]){var widgetParent=this.getWidgetParentElemOfCell(cellElem);widgetParent.appendChild(areaElem)}}else cellElem.appendChild(areaElem)},updateAllCells:function(){for(var cells=this.getAllCells(),i=0,l=cells.length;i<l;++i)this.updateCell(cells[i],cells[i]===this.getHotCell())},restoreCellShrink:function(cell){var elem=this.getWidgetParentElemOfCell(cell);elem&&(elem.style.transform="none")},hotCellChanged:function(oldCell,newCell){oldCell&&(this.updateCell(oldCell,!1),EU.removeClass(oldCell,CNS.STATE_HOVER)),newCell&&(EU.addClass(newCell,CNS.STATE_HOVER),this.getRestoreWidgetSizeOnHotTrack()&&(this.restoreCellShrink(newCell),this.adjustInteractionArea(newCell,!0)))},reactCellMouseEnter:function(e){var target=e.getTarget();this.setHotCell(target)},reactCellMouseLeave:function(e){var target=e.getTarget();this.getHotCell()===target&&this.setHotCell(null)},reactCellClick:function(e){var target=e.getTarget();(DU.isDescendantOf(target,this.getAddingCell())||target===this.getAddingCell())&&this.createWidget()},reactChildWidgetChange:function(e){var widget=e.widget;widget&&this.hasChild(widget)&&this.updateCell(this.getWidgetCell(widget),this.getHotCell()===this.getWidgetCell(widget))}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,ClassEx=__webpack_require__(0).ClassEx,ObjectEx=__webpack_require__(0).ObjectEx,DataType=__webpack_require__(0).DataType;module.exports=function(Kekule){var DU=Kekule.DomUtils,EU=Kekule.HtmlElementUtils,SU=Kekule.StyleUtils,CNS=Kekule.Widget.HtmlClassNames;return Kekule.Widget.HtmlClassNames=Object.extend(Kekule.Widget.HtmlClassNames,{PROPLISTEDITOR:"K-PropListEditor",PROPLISTEDITOR_PROPEXPANDMARKER:"K-PropListEditor-PropExpandMarker",PROPLISTEDITOR_PROPEXPANDED:"K-PropListEditor-PropExpanded",PROPLISTEDITOR_PROPCOLLAPSED:"K-PropListEditor-PropCollapsed",PROPLISTEDITOR_INDENTDECORATOR:"K-PropListEditor-IndentDecorator",PROPLISTEDITOR_READONLY:"K-PropListEditor-ReadOnly",OBJINSPECTOR:"K-ObjInspector",OBJINSPECTOR_SUBPART:"K-ObjInspector-SubPart",OBJINSPECTOR_OBJSINFOPANEL:"K-ObjInspector-ObjsInfoPanel",OBJINSPECTOR_PROPINFOPANEL:"K-ObjInspector-PropInfoPanel",OBJINSPECTOR_PROPINFO_TITLE:"K-ObjInspector-PropInfoPanel-Title",OBJINSPECTOR_PROPINFO_DESCRIPTION:"K-ObjInspector-PropInfoPanel-Description",OBJINSPECTOR_PROPLISTEDITOR_CONTAINER:"K-ObjInspector-PropListEditorContainer"}),Kekule.Widget.ObjPropListEditor=Class.create(Kekule.Widget.ValueListEditor,{CLASS_NAME:"Kekule.Widget.ObjPropListEditor",PARENT_ROW_FIELD:"__$parentRow__",SUB_ROWS_FIELD:"__$subRows__",initialize:function($super,parentOrElementOrDocument){$super(parentOrElementOrDocument),this.setValueDisplayMode(Kekule.Widget.ValueListEditor.ValueDisplayMode.SIMPLE),this.setPropStoreFieldValue("displayedPropScopes",[Class.PropertyScope.PUBLISHED]),this.setEnableLiveUpdate(!0),this.setSubPropNamePadding("1em"),this.setUseKeyHint(!0)},initProperties:function(){this.defineProp("objects",{dataType:DataType.ARRAY,serializable:!1,scope:Class.PropertyScope.PUBLIC,setter:function(value){var objs=Kekule.ArrayUtils.toArray(value),olds=this.getObjects();this.setPropStoreFieldValue("objects",objs),this.inspectedObjectsChanged(objs,olds)}}),this.defineProp("displayedPropScopes",{dataType:DataType.ARRAY,setter:function(value){this.setPropStoreFieldValue("displayedPropScopes",value),this.updateAll()}}),this.defineProp("enableLiveUpdate",{dataType:DataType.BOOL}),this.defineProp("subPropNamePadding",{dataType:DataType.STRING}),this.defineProp("activePropEditor",{dataType:DataType.OBJECT,serializable:!1,setter:null,scope:Class.PropertyScope.PUBLIC,getter:function(){var row=this.getActiveRow();return row?this.getRowPropEditor(row):null}}),this.defineProp("keyField",{dataType:DataType.STRING}),this.defineProp("sortField",{dataType:DataType.STRING}),this.defineProp("enableOperHistory",{dataType:DataType.BOOL,serializable:!1}),this.defineProp("operHistory",{dataType:"Kekule.OperationHistory",serializable:!1,scope:Class.PropertyScope.PUBLIC})},doFinalize:function($super){$super()},initPropValues:function($super){$super(),this.setKeyField("title"),this.setSortField("key")},doGetWidgetClassName:function($super){return $super()+" "+CNS.PROPLISTEDITOR},inspectedObjectsChanged:function(objects,oldObjects){var objs=Kekule.ArrayUtils.toArray(objects);oldObjects&&this._uninstallObjectsEventHandlers(oldObjects),objects&&this._installObjectsEventHandlers(objs),this.updateAll(objs)},_installObjectsEventHandlers:function(objects){for(var i=0,l=objects.length;i<l;++i){var obj=objects[i];obj.addEventListener&&obj.addEventListener("change",this.reactObjectsChange,this)}},_uninstallObjectsEventHandlers:function(objects){for(var i=0,l=objects.length;i<l;++i){var obj=objects[i];obj.removeEventListener&&obj.removeEventListener("change",this.reactObjectsChange,this)}},reactObjectsChange:function(e){if(this.getEnableLiveUpdate()){var changedPropNames=e.changedPropNames;this.updateValues(changedPropNames)}},getKeyCellExpandMarker:function(keyCell,canCreate){var result=null,wrapper=this.getCellContentWrapper(keyCell,canCreate);if(wrapper){for(var children=DU.getDirectChildElems(wrapper)||[],i=0,l=children.length;i<l;++i){var child=children[i];if(EU.hasClass(child,CNS.PROPLISTEDITOR_PROPEXPANDMARKER)){result=child;break}}if(!result&&canCreate){result=this.getDocument().createElement("span"),EU.addClass(result,CNS.PROPLISTEDITOR_PROPEXPANDMARKER);var refChild=DU.getChildNodesOfTypes(wrapper,[Node.ELEMENT_NODE,Node.TEXT_NODE])[0];wrapper.insertBefore(result,refChild)}}return result},getKeyCellIndentDecorator:function(keyCell,canCreate){var result=null,wrapper=this.getCellContentWrapper(keyCell,canCreate);if(wrapper){for(var children=DU.getDirectChildElems(wrapper)||[],i=0,l=children.length;i<l;++i){var child=children[i];if(EU.hasClass(child,CNS.PROPLISTEDITOR_INDENTDECORATOR)){result=child;break}}if(!result&&canCreate){result=this.getDocument().createElement("div"),EU.addClass(result,CNS.PROPLISTEDITOR_INDENTDECORATOR);var refChild=DU.getChildNodesOfTypes(wrapper,[Node.ELEMENT_NODE,Node.TEXT_NODE])[0];wrapper.insertBefore(result,refChild)}}return result},setRowKeyCellContent:function($super,row,keyText,keyHint){var result=$super(row,keyText,keyHint),cell=this.getKeyCell(row),subLevel=(this.getKeyCellExpandMarker(cell,!0),this.getRowSubLevel(row)),spadding=this.getSubPropNamePadding();if(spadding){Kekule.StyleUtils.multiplyUnitsValue(spadding,subLevel);spadding=Kekule.StyleUtils.multiplyUnitsValue(spadding,subLevel);var keyCell=this.getKeyCell(row);this.getCellContentWrapper(keyCell,!0).style.paddingLeft=spadding}return result},updateAll:function(objs){if(objs||(objs=this.getObjects()),!objs||!objs.length)return void this.clear();this.setActiveRow(null),this.collapseAllRows();var propEditors=(objs[0],this.getDisplayPropEditors(objs));this.sortPropEditors(propEditors);for(var rows=(objs.length,this.getRows()),rowCount=rows.length,l=propEditors.length,i=0,currRowIndex=0,valueDisplayMode=this.getValueDisplayMode(),i=0;i<l;++i){var propEditor=propEditors[i];if(propEditor.setValueTextMode(valueDisplayMode),this.isPropEditorVisible(propEditor)){var row=currRowIndex<rowCount?rows[currRowIndex]:this.appendRow();this.setRowPropEditor(row,propEditor),++currRowIndex}}if(rowCount>currRowIndex)for(var i=rowCount-1;i>=currRowIndex;--i)this.removeRow(rows[i]);return this},updateValues:function(propNames){for(var limitedProps=propNames&&propNames.length,rows=this.getRows(),i=0,l=rows.length;i<l;++i){var row=rows[i];if(limitedProps){var propEditor=this.getRowPropEditor(row);if(!propEditor||propNames.indexOf(propEditor.getPropertyName())<0)continue}this.updateRowPropValue(row)}},updateRowPropValue:function(row){var propEditor=this.getRowPropEditor(row),newValue=propEditor.getValueText(),data=this.getRowData(row);data.value=newValue,this.setRowData(row,data),this.updateRowExpandState(row);var subRows=this.getSubPropRows(row);if(subRows)for(var i=0,l=subRows.length;i<l;++i)this.updateRowPropValue(subRows[i])},setRowPropEditor:function(row,propEditor){var title,titleField=this.getKeyField()||"title";if(titleField)if("name"===titleField)title=propEditor.getPropertyName();else if("title"===titleField)title=propEditor.getTitle();else{var propInfo=propEditor.getPropertyInfo();title=propInfo[titleField]}title||(title=propEditor.getTitle()||propEditor.getPropertyName());var data={key:propEditor.getPropertyName(),value:propEditor.getValueText(),title:title,hint:propEditor.getHint(),propEditor:propEditor,expanded:!1};propEditor.isReadOnly()?EU.addClass(row,CNS.PROPLISTEDITOR_READONLY):EU.removeClass(row,CNS.PROPLISTEDITOR_READONLY),this.setRowData(row,data),this.updateRowExpandState(row)},getRowCascadeKey:function(row){if(row&&this.getRowData(row)){var result=this.getRowData(row).key,parentRow=this.getParentPropRow(row);return parentRow&&(result=this.getRowCascadeKey(parentRow)+"."+result),result}return null},getActiveRowCascadeKey:function(){var row=this.getActiveRow();return row&&this.getRowCascadeKey(row)},getRowPropEditor:function(row){var data=this.getRowData(row);return data?data.propEditor:null},getPropEditor:function(objClass,propInfo){var c=Kekule.PropertyEditor.findEditorClass(objClass,propInfo);return c?new c:null},getPropEditorForType:function(propType,propName){var c=Kekule.PropertyEditor.findEditorClassForType(propType,propName);return c?new c:null},isPropEditorVisible:function(propEditor){var result=!0;if(result=!(propEditor.getObjects().length>1)||propEditor.getAttributes()&Kekule.PropertyEditor.EditorAttributes.MULTIOBJS){var propInfo=propEditor.getPropertyInfo();if(propInfo){var propScope=propInfo.scope||Class.PropertyScope.DEFAULT;if(propScope){var displayScopes=this.getDisplayedPropScopes();displayScopes&&(result=displayScopes.indexOf(propScope)>=0)}}}return result},isRowExpandable:function(row){var propEditor=this.getRowPropEditor(row);return!!propEditor&&propEditor.hasSubPropertyEditors()},isRowExpanded:function(row){return!!this.getRowData(row).expanded},updateRowExpandState:function(row){var canExpand=this.isRowExpandable(row);canExpand||this.removeSubPropertyRows(row),EU.removeClass(row,CNS.PROPLISTEDITOR_PROPCOLLAPSED),EU.removeClass(row,CNS.PROPLISTEDITOR_PROPEXPANDED),canExpand&&(this.isRowExpanded(row)?EU.addClass(row,CNS.PROPLISTEDITOR_PROPEXPANDED):EU.addClass(row,CNS.PROPLISTEDITOR_PROPCOLLAPSED))},expandRow:function(row){return this._doExpandRow(row),this},_doExpandRow:function(row){if(this.isRowExpandable(row)&&!this.isRowExpanded(row)){EU.removeClass(row,CNS.PROPLISTEDITOR_PROPCOLLAPSED),EU.addClass(row,CNS.PROPLISTEDITOR_PROPEXPANDED);this.getRowData(row).expanded=!0;var propEditor=this.getRowPropEditor(row),subPropEditors=propEditor.getSubPropertyEditors(this.getDisplayedPropScopes());return row[this.SUB_ROWS_FIELD]=this.addSubPropertyRows(row,subPropEditors),row[this.SUB_ROWS_FIELD]}return null},collapseRow:function(row){if(this.isRowExpandable(row)&&this.isRowExpanded(row)){EU.removeClass(row,CNS.PROPLISTEDITOR_PROPEXPANDED),EU.addClass(row,CNS.PROPLISTEDITOR_PROPCOLLAPSED);this.getRowData(row).expanded=!1,this.removeSubPropertyRows(row)}return this},toggleRowExpandState:function(row){return this.isRowExpanded(row)?this.collapseRow(row):this.expandRow(row),this},collapseAllRows:function(){for(var rows=this.getRows(),i=0,l=rows.length;i<l;++i)this.collapseRow(rows[i]);return this},expandAllRows:function(cascade){var self=this,rows=this.getRows();return function doExpandAll(rows,cascade){for(var i=0,l=rows.length;i<l;++i){var addedRows=self._doExpandRow(rows[i]);addedRows&&cascade&&doExpandAll(addedRows,cascade)}}(rows,cascade),this},addSubPropertyRows:function(parentRow,propEditors){var refRow=this.getNextRow(parentRow),subRows=[];if(propEditors&&propEditors.length){this.sortPropEditors(propEditors);for(var i=0,l=propEditors.length;i<l;++i){var subPropEditor=propEditors[i];this.isPropEditorVisible(subPropEditor)&&subRows.push(this.addSubPropRow(parentRow,subPropEditor,refRow))}}return subRows},addSubPropRow:function(parentRow,propEditor,refRow){var result=this.insertRowBefore(null,refRow);return result[this.PARENT_ROW_FIELD]=parentRow,this.setRowPropEditor(result,propEditor),result},removeSubPropertyRows:function(parentRow){for(var subRows=this.getSubPropRows(parentRow),i=subRows.length-1;i>=0;--i)this.removeSubPropertyRows(subRows[i]),this.removeRow(subRows[i]);parentRow[this.SUB_ROWS_FIELD]=null},getSubPropRows:function(row){return row[this.SUB_ROWS_FIELD]||[]},getParentPropRow:function(row){return row[this.PARENT_ROW_FIELD]},getRowSubLevel:function(row){for(var result=0,parentRow=this.getParentPropRow(row);parentRow;)++result,parentRow=this.getParentPropRow(parentRow);return result},getValueCellText:function($super,row,data){return data.value},finishEditing:function(){var row=this.getActiveRow(),propEditor=this.getRowPropEditor(row);if(propEditor){var operHistory=this.getOperHistory(),enableHistory=this.getEnableOperHistory()&&operHistory,oldValue=propEditor.getValue();if(propEditor.saveEditValue()){if(enableHistory){var oper=new Kekule.Widget.PropEditorModifyOperation(propEditor,propEditor.getValue(),oldValue);operHistory.push(oper)}this.updateValues(),this.invokeEvent("propertyChange",{propertyEditor:propEditor,propertyInfo:propEditor.getPropertyInfo(),oldValue:oldValue,newValue:propEditor.getValue()}),this.invokeEvent("editFinish",{row:row})}}return this},doCreateValueEditWidget:function($super,row){var propEditor=this.getRowPropEditor(row),result=propEditor.createEditWidget(this);return result?propEditor.isReadOnly()&&result.setReadOnly&&result.setReadOnly(!0):result=this.doCreateDefaultValueEditWidget(row),result},doCreateDefaultValueEditWidget:function(row){var result=new Kekule.Widget.TextBox(this);result.setReadOnly(!0);var value=this.getRowData(row).value;return result.setValue(value),result},isOperHistoryAvailable:function(){return this.getOperHistory()&&this.getEnableOperHistory()},undo:function(){return this.isOperHistoryAvailable()&&this.getOperHistory().undo(),this},redo:function(){return this.isOperHistoryAvailable()&&this.getOperHistory().redo(),this},getCommonSuperClass:function(objects){return ClassEx.getCommonSuperClass(objects)},getCommonPropNames:function(objects){var result=[],superClass=this.getCommonSuperClass(objects);if(superClass)for(var propList=ClassEx.getPropListOfScopes(superClass,this.getDisplayedPropScopes()),i=0,l=propList.getLength();i<l;++i){var propInfo=propList.getPropInfoAt(i);result.push(propInfo.name)}return result},getDisplayPropNames:function(objects){return this.getCommonPropNames(objects)},getDisplayPropEditors:function(objects){var result=[],superClass=this.getCommonSuperClass(objects);if(superClass){var basePropEditor=this.getPropEditor(null,{dataType:ClassEx.getClassName(superClass)});basePropEditor&&(basePropEditor.setObjects(objects),result=result.concat(basePropEditor.getSubPropertyEditors(this.getDisplayedPropScopes())||[]))}else if(1===objects.length){var obj=objects[0];if(DataType.isObjectValue(obj)){var basePropEditor=this.getPropEditorForType("object");basePropEditor&&(basePropEditor.setObjects(obj),result=result.concat(basePropEditor.getSubPropertyEditors()||[]))}}return result},sortPropEditors:function(propEditors){var sortField=this.getSortField();if(sortField){"key"===sortField&&this.getKeyField();var getSortFieldValue=function(propInfo,sortField){return propInfo[sortField]||propInfo.name};propEditors.sort(function(a,b){var na=getSortFieldValue(a.getPropertyInfo(),sortField),nb=getSortFieldValue(b.getPropertyInfo(),sortField);return na<nb?-1:na>nb?1:0})}},getObjPropValue:function(obj,propName){return obj instanceof ObjectEx?obj.getPropValue(propName):obj instanceof Object?obj[propName]:void 0},getObjsPropValue:function(objects,propName){for(var obj=objects[0],result=this.getObjPropValue(obj,propName),i=1,l=objects.length;i<l;++i){var obj=objects[i];if(this.getObjPropValue(obj,propName)!==result)return}return result},react_click:function($super,e){var target=e.getTarget(),row=this.getParentRow(target);if(row){target===this.getKeyCellExpandMarker(this.getKeyCell(row),!1)&&this.toggleRowExpandState(row)}$super(e)},react_dblclick:function(e){var target=e.getTarget(),cell=this.getParentCell(target);if(cell){var row=this.getParentRow(cell);cell===this.getKeyCell(row)&&(this.toggleRowExpandState(row),!0)}},react_keydown:function($super,e){$super(e);var keyCode=e.getKeyCode();if(!(e.getAltKey()||e.getShiftKey()||e.getCtrlKey())){var currRow=this.getActiveRow();currRow&&(keyCode===Kekule.X.Event.KeyCode.RIGHT?this.expandRow(currRow):keyCode===Kekule.X.Event.KeyCode.LEFT&&this.collapseRow(currRow))}}}),Kekule.Widget.ObjectInspector=Class.create(Kekule.Widget.BaseWidget,{CLASS_NAME:"Kekule.Widget.ObjectInspector",initialize:function($super,parentOrElementOrDocument){this._propListElem=null,this._objsInfoElem=null,this._propInfoElem=null,this.setPropStoreFieldValue("showObjsInfoPanel",!0),this.setPropStoreFieldValue("showPropInfoPanel",!0),$super(parentOrElementOrDocument)},initProperties:function(){this.defineProp("objects",{dataType:DataType.ARRAY,scope:Class.PropertyScope.PUBLIC,setter:function(value){var objs=Kekule.ArrayUtils.toArray(value);this.setPropStoreFieldValue("objects",objs),this.inspectedObjectsChanged(objs)}}),this.defineProp("propEditor",{dataType:"Kekule.Widget.ObjPropListEditor",serializable:!1,setter:null,scope:Class.PropertyScope.PRIVATE}),this.defineProp("showObjsInfoPanel",{dataType:DataType.BOOL,setter:function(value){this.setPropStoreFieldValue("showObjsInfoPanel",value),SU.setDisplay(this._objsInfoElem,!!value),this._updateChildElemSize()}}),this.defineProp("showPropInfoPanel",{dataType:DataType.BOOL,setter:function(value){this.setPropStoreFieldValue("showPropInfoPanel",value),SU.setDisplay(this._propInfoElem,!!value),this._updateChildElemSize()}}),this.defineProp("keyField",{dataType:DataType.STRING,getter:function(){var pe=this.getPropEditor();return pe&&pe.getKeyField()},setter:function(value){var pe=this.getPropEditor();pe&&pe.setKeyField(value)}}),this.defineProp("sortField",{dataType:DataType.STRING,getter:function(){var pe=this.getPropEditor();return pe&&pe.getSortField()},setter:function(value){var pe=this.getPropEditor();pe&&pe.setSortField(value)}}),this.defineProp("activeRow",{dataType:DataType.OBJECT,serializable:!1,scope:Class.PropertyScope.PUBLIC,getter:function(){var pe=this.getPropEditor();return pe&&pe.getActiveRow()},setter:function(value){var pe=this.getPropEditor();pe&&pe.setActiveRow(value)}}),this.defineProp("enableOperHistory",{dataType:DataType.BOOL,serializable:!1,getter:function(){var propEditor=this.getPropEditor();return!!propEditor&&propEditor.getEnableOperHistory()},setter:function(value){var propEditor=this.getPropEditor();return propEditor?propEditor.setEnableOperHistory(value):null}}),this.defineProp("operHistory",{dataType:"Kekule.OperationHistory",serializable:!1,scope:Class.PropertyScope.PUBLIC,getter:function(){var propEditor=this.getPropEditor();return propEditor?propEditor.getOperHistory():null},setter:function(value){var propEditor=this.getPropEditor();return propEditor?propEditor.setOperHistory(value):null}}),this.defineProp("sortField",{dataType:DataType.STRING,getter:function(){return this.getPropEditor().getSortField()},setter:function(value){this.getPropEditor().setSortField(value)}})},doFinalize:function($super){this._finalizeChildWidgets(),$super()},getChildrenHolderElement:function($super){return this._propListElem||$super()},doGetWidgetClassName:function(){return CNS.OBJINSPECTOR},doBindElement:function($super,element){$super(element),this._updateChildElemSize()},doCreateRootElement:function(doc){return doc.createElement("div")},doCreateSubElements:function($super,doc,element){$super(doc,element);var objsInfoElem=this._createSubPartElem(doc);EU.addClass(objsInfoElem,CNS.OBJINSPECTOR_OBJSINFOPANEL),element.appendChild(objsInfoElem),this._objsInfoElem=objsInfoElem;var propInfoElem=this._createSubPartElem(doc);EU.addClass(propInfoElem,CNS.OBJINSPECTOR_PROPINFOPANEL),element.appendChild(propInfoElem),this._propInfoElem=propInfoElem;var propListEditorContainer=this._createSubPartElem(doc);return EU.addClass(propListEditorContainer,CNS.OBJINSPECTOR_PROPLISTEDITOR_CONTAINER),element.appendChild(propListEditorContainer),this._propListElem=propListEditorContainer,this._createChildWidgets(propListEditorContainer),[objsInfoElem,propInfoElem,propListEditorContainer]},_createSubPartElem:function(doc){var result=doc.createElement("div");return result.className=CNS.OBJINSPECTOR_SUBPART,result},_createChildWidgets:function(parentElem){this._finalizeChildWidgets();var propEditor=new Kekule.Widget.ObjPropListEditor(this);propEditor.appendToWidget(this);var self=this;propEditor.addEventListener("activeRowChange",function(e){self._updatePropInfo()}),this.setPropStoreFieldValue("propEditor",propEditor)},_finalizeChildWidgets:function(){var propEditor=this.getPropEditor();propEditor&&propEditor.finalize()},inspectedObjectsChanged:function(objs){var propEditor=this.getPropEditor();propEditor&&propEditor.setObjects(objs),this._updateObjectsInfo(objs),this._updatePropInfo()},_updateObjectsInfo:function(objs){if(this._objsInfoElem){var text;if(objs.length<=0)text=Kekule.$L("WidgetTexts.S_INSPECT_NONE");else if(1===objs.length){var obj=objs[0],id=obj.getId?obj.getId():null,stype=DataType.getType(obj);text=id?Kekule.$L("WidgetTexts.S_INSPECT_ID_OBJECT").format(id,stype):Kekule.$L("WidgetTexts.S_INSPECT_ANONYMOUS_OBJECT").format(stype)}else text=Kekule.$L("WidgetTexts.S_INSPECT_OBJECTS").format(objs.length);DU.setElementText(this._objsInfoElem,text)}},_updatePropInfo:function(){if(this._propInfoElem){this._propInfoElem.innerHTML="";var propEditor=this.getPropEditor().getActivePropEditor();if(propEditor){var title=propEditor.getTitle(),description=propEditor.getDescription()||propEditor.getPropertyType()||"",doc=this._propInfoElem.ownerDocument,elem=doc.createElement("div");elem.className=CNS.OBJINSPECTOR_PROPINFO_TITLE,DU.setElementText(elem,title),this._propInfoElem.appendChild(elem);var elem=doc.createElement("div");elem.className=CNS.OBJINSPECTOR_PROPINFO_DESCRIPTION,DU.setElementText(elem,description),this._propInfoElem.appendChild(elem)}}},undo:function(){return this.getPropEditor()&&this.getPropEditor().undo(),this},redo:function(){return this.getPropEditor()&&this.getPropEditor().redo(),this},getRowCascadeKey:function(row){var pe=this.getPropEditor();return pe&&pe.getRowCascadeKey(row)},getActiveRowCascadeKey:function(){var pe=this.getPropEditor();return pe&&pe.getActiveRowCascadeKey()},isRowExpandable:function(row){var pe=this.getPropEditor();return pe&&pe.isRowExpandable(row)},isRowExpanded:function(row){var pe=this.getPropEditor();return pe&&pe.isRowExpanded(row)},expandRow:function(row){var pe=this.getPropEditor();return pe&&pe.expandRow(row),this},collapseRow:function(row){var pe=this.getPropEditor();return pe&&pe.collapseRow(row),this},toggleRowExpandState:function(row){var pe=this.getPropEditor();return pe&&pe.toggleRowExpandState(row),this},collapseAllRows:function(){var pe=this.getPropEditor();return pe&&pe.collapseAllRows(),this},expandAllRows:function(cascade){var pe=this.getPropEditor();return pe&&pe.expandAllRows(cascade),this},_updateChildElemSize:function(){var self=this;setTimeout(function(){var top;top=self.getShowObjsInfoPanel()?SU.getComputedStyle(self._objsInfoElem,"height"):0;var bottom;bottom=self.getShowPropInfoPanel()?SU.getComputedStyle(self._propInfoElem,"height"):0,self._propListElem.style.top=top,self._propListElem.style.bottom=bottom},100)},setUseCornerDecoration:function($super,value){return $super(value)}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,ClassEx=__webpack_require__(0).ClassEx,ObjectEx=__webpack_require__(0).ObjectEx,DataType=__webpack_require__(0).DataType;module.exports=function(Kekule){var AU=Kekule.ArrayUtils;Kekule.Widget.PropertyEditor={},Kekule.PropertyEditor=Kekule.Widget.PropertyEditor,Kekule.PropertyEditor.BaseEditor=Class.create(ObjectEx,{CLASS_NAME:"Kekule.PropertyEditor.BaseEditor",initialize:function($super){$super(),this._editWidget=null},initProperties:function(){this.defineProp("objects",{dataType:DataType.ARRAY,serializable:!1,setter:function(value){var AU=Kekule.ArrayUtils;this.setPropStoreFieldValue("objects",AU.clone(AU.toArray(value)))}}),this.defineProp("propertyInfo",{dataType:DataType.OBJECT,serializable:!1}),this.defineProp("propertyName",{dataType:DataType.VARIANT,serializable:!1,setter:null,getter:function(){var info=this.getPropertyInfo();return info?info.name:null}}),this.defineProp("propertyType",{dataType:DataType.VARIANT,serializable:!1,setter:null,getter:function(){var info=this.getPropertyInfo();return info?info.dataType:null}}),this.defineProp("parentEditor",{dataType:"Kekule.PropertyEditor.BaseEditor",serializable:!1}),this.defineProp("valueTextMode",{dataType:DataType.INT}),this.defineProp("readOnly",{dataType:DataType.BOOL}),this.defineProp("allowEmpty",{dataType:DataType.BOOL})},finalize:function($super){this.finalizeWidget(),$super()},finalizeWidget:function(){this._editWidget&&(this._editWidget.finalize(),this._editWidget=null)},getEditWidget:function(){return this._editWidget},getObjPropValue:function(obj,propName){return Kekule.ObjUtils.isUnset(propName)?obj:obj instanceof ObjectEx?obj.getPropValue(propName):DataType.isArrayValue(obj)?obj[propName]:obj instanceof Object?obj[propName]:void 0},setObjPropValue:function(obj,propName,propValue){return obj instanceof ObjectEx?obj.setPropValue(propName,propValue):obj instanceof Object&&(obj[propName]=propValue),this},getObjsPropValue:function(objects,propName){if(objects){if(Kekule.ObjUtils.isUnset(propName))return objects;for(var obj=objects[0],result=this.getObjPropValue(obj,propName),i=1,l=objects.length;i<l;++i){var obj=objects[i];if(this.getObjPropValue(obj,propName)!==result)return}return result}},setObjsPropValue:function(objects,propName,propValue){if(!objects||!propName)return this;for(var i=0,l=objects.length;i<l;++i){var obj=objects[i];this.setObjPropValue(obj,propName,propValue)}return this},isReadOnly:function(){return!!(this.getAttributes()&PEA.READONLY)},hasSubPropertyEditors:function(){return!!(this.getAttributes()&PEA.SUBPROPS)},getAttributes:function(){var result=PEA.MULTIOBJS|PEA.SIMPLEVALUE,propInfo=this.getPropertyInfo();return Kekule.ObjUtils.isUnset(this.getReadOnly())?propInfo&&!propInfo.setter&&(result|=PEA.READONLY):this.getReadOnly()&&(result|=PEA.READONLY),result},getSubPropertyEditors:function(propScopes){return null},getTitle:function(){var info=this.getPropertyInfo();return info?info.title||info.name:""},getHint:function(){return this.getTitle()},getDescription:function(){return this.getPropertyInfo().description},getValue:function(){return this.getObjsPropValue(this.getObjects(),this.getPropertyName())},getValueText:function(){var VDM=Kekule.Widget.ValueListEditor.ValueDisplayMode,v=this.getValue(),mode=this.getValueTextMode();try{var result=mode===VDM.JSON?JSON.stringify(v):Kekule.ObjUtils.isUnset(v)?"":""+v}catch(e){return""+v}return result},setValue:function(value){var result=this.setObjsPropValue(this.getObjects(),this.getPropertyName(),value);return this.getParentEditor()&&this.getParentEditor().notifyChildEditorValueChange&&this.getParentEditor().notifyChildEditorValueChange(this.getPropertyName(),value),result},createEditWidget:function(parentWidget){var value=this.getValue(),result=this.doCreateEditWidget(parentWidget,value);return result&&result.setIsDirty&&result.setIsDirty(!1),this._editWidget=result,result},doCreateEditWidget:function(parentWidget){},saveEditValue:function(){if(this._editWidget){if(!this._editWidget.getIsDirty||this._editWidget.getIsDirty()){var result=this.doSaveEditValue();return this._editWidget.setIsDirty&&this._editWidget.setIsDirty(!1),result}return!1}return!1},doSaveEditValue:function(){},notifyChildEditorValueChange:function(fieldName,fieldValue){}}),Kekule.PropertyEditor.EditorAttributes={MULTIOBJS:1,SUBPROPS:2,SIMPLEVALUE:4,VALUELIST:8,CUSTOMEDIT:16,READONLY:32,INLINE_EDIT:128,DROP_EDIT:256,POPUP_EDIT:512};var PEA=Kekule.PropertyEditor.EditorAttributes;return Kekule.PropertyEditor.EditorMananger=Class.create({initialize:function(){this._registeredItems=[],this._defaultItems=[]},register:function(editorClass,propType,objClass,propName,matchFunc){var item={editorClass:editorClass,propType:propType,objClass:objClass,propName:propName,matchFunc:matchFunc};return this._registeredItems.push(item),propType||objClass||propName||matchFunc||this._defaultItems.push(item),this},unregister:function(editorClass){for(var items=this._registeredItems,i=items.length-1;i>=0;--i){var item=items[i];item.editorClass===editorClass&&items.splice(i,1)}for(var items=this._defaultItems,i=items.length-1;i>=0;--i){var item=items[i];item.editorClass===editorClass&&items.splice(i,1)}return this},_getDefaultItem:function(){var item=this._defaultItems;return item[item.length-1]},_getSuperiorItem:function(item1,item2){for(var fields=["matchFunc","propName","objClass","propType"],i=0,l=fields.length;i<l;++i)if(!!item1[fields]!=!!item2[fields])return item1[fields]?item1:item2;return item1},_isMatchedPropType:function(srcType,targetType){var result=srcType===targetType;if(!result&&DataType.isObjectExType(srcType,Kekule)&&DataType.isObjectExType(targetType,Kekule)){var classObj1=ClassEx.findClass(srcType,void 0,Kekule),classObj2=ClassEx.findClass(targetType,void 0,Kekule);result=ClassEx.isOrIsDescendantOf(classObj1,classObj2)}return result},_testOnPropType:function(editorItem,propInfo){return editorItem.propType&&propInfo.dataType?this._isMatchedPropType(propInfo.dataType,editorItem.propType)?1:-1:0},_testOnObjClass:function(editorItem,objClass){return editorItem.objClass&&objClass?ClassEx.isOrIsDescendantOf(objClass,editorItem.objClass)?1:-1:0},_testOnPropName:function(editorItem,propInfo){return editorItem.propName&&propInfo.name?editorItem.propName===propInfo.name?1:-1:0},_testOnMatchFunc:function(editorItem,objClass,propInfo){return editorItem.matchFunc?editorItem.matchFunc(objClass,propInfo)?1:-1:0},findEditorClass:function(objClass,propInfo){for(var result=null,items=this._registeredItems,i=items.length-1;i>=0;--i){var item=items[i],r1=this._testOnPropType(item,propInfo);if(!(r1<0)){var r2=this._testOnObjClass(item,objClass);if(!(r2<0)){var r3=this._testOnPropName(item,propInfo);if(!(r3<0)){var r4=this._testOnMatchFunc(item,objClass,propInfo);if(!(r4<0)&&r1+r2+r3+r4>0&&(result=result?this._getSuperiorItem(result,item.editorClass):item.editorClass)&&item.matchFunc)break}}}}if(!result){var item=this._getDefaultItem();result=item?item.editorClass:null}return result},findEditorClassForType:function(propType,propName){var propInfo={dataType:propType,name:propName};return this.findEditorClass(null,propInfo)}}),Kekule.ClassUtils.makeSingleton(Kekule.PropertyEditor.EditorMananger),Kekule.PropertyEditor.findEditorClass=Kekule.PropertyEditor.EditorMananger.getInstance().findEditorClass.bind(Kekule.PropertyEditor.EditorMananger.getInstance()),Kekule.PropertyEditor.findEditorClassForType=Kekule.PropertyEditor.EditorMananger.getInstance().findEditorClassForType.bind(Kekule.PropertyEditor.EditorMananger.getInstance()),Kekule.PropertyEditor.register=Kekule.PropertyEditor.EditorMananger.getInstance().register.bind(Kekule.PropertyEditor.EditorMananger.getInstance()),Kekule.PropertyEditor.unregister=Kekule.PropertyEditor.EditorMananger.getInstance().unregister.bind(Kekule.PropertyEditor.EditorMananger.getInstance()),Kekule.PropertyEditor.SimpleEditor=Class.create(Kekule.PropertyEditor.BaseEditor,{CLASS_NAME:"Kekule.PropertyEditor.SimpleEditor",convertStrToValue:function(str,targetType){return DataType.isSimpleType(targetType)?!str&&this.getAllowEmpty()?null:Kekule.StrUtils.convertToType(str,targetType):str},setValueText:function(valueText){if(valueText===this._originValueText)return!1;var value,ptype=this.getPropertyType();return!(ptype&&!DataType.isSimpleType(ptype))&&(value=ptype?this.convertStrToValue(valueText,ptype):valueText,this.setValue(value),!0)},doCreateEditWidget:function(parentWidget){var text=this.getValueText();return this._originValueText=text,new Kekule.Widget.TextBox(parentWidget,text)},doSaveEditValue:function(){return this.setValueText(this.getEditWidget().getValue())}}),Kekule.PropertyEditor.register(Kekule.PropertyEditor.SimpleEditor),Kekule.PropertyEditor.TextEditor=Class.create(Kekule.PropertyEditor.SimpleEditor,{CLASS_NAME:"Kekule.PropertyEditor.TextEditor",LINE_BREAK_REPLACER:"\\n",textToSingleLine:function(text){return text.split("\n").join(this.LINE_BREAK_REPLACER)},textToMultiLine:function(text){return text.split(this.LINE_BREAK_REPLACER).join("\n")},doCreateEditWidget:function(parentWidget){this._parentWidget=parentWidget;var text=this.getValueText();this._originValueText=text;var result=new Kekule.Widget.ButtonTextBox(parentWidget,this.textToSingleLine(text));return this._textbox=result,result.setButtonKind(Kekule.Widget.Button.Kinds.POPUP),result.addEventListener("buttonExecute",this.reactButtonExecute,this),result},reactButtonExecute:function(e){this.openPopupEditor()},openPopupEditor:function(){var dialog=this._popupDialog;dialog||(dialog=this.createPopupDialog(),this._popupDialog=dialog);var editor=this._popupEditor;editor.setValue(this.getValueText());var self=this;dialog.openPopup(function(result){result===Kekule.Widget.DialogButtons.OK&&(self._textbox.setValue(self.textToSingleLine(editor.getValue())),self._textbox.setIsDirty(!0),self.saveEditValue())},this._textbox)},createPopupDialog:function(){var doc=this._parentWidget.getDocument(),result=new Kekule.Widget.Dialog(doc,this.getPropertyName(),[Kekule.Widget.DialogButtons.OK,Kekule.Widget.DialogButtons.CANCEL]);result.setLocation(Kekule.Widget.Location.CENTER_OR_FULLFILL);var editorClass=Kekule.Widget.TextArea,textArea=new editorClass(doc),style=textArea.getElement().style;return style.width="40em",style.height="20em",textArea.appendToWidget(result),this._popupEditor=textArea,result},doSaveEditValue:function(){var text=this.getEditWidget().getValue();return(text=this.textToMultiLine(text))!==this._originValueText&&(this.setValueText(text),!0)}}),Kekule.PropertyEditor.register(Kekule.PropertyEditor.TextEditor,DataType.STRING),Kekule.PropertyEditor.BoolEditor=Class.create(Kekule.PropertyEditor.BaseEditor,{CLASS_NAME:"Kekule.PropertyEditor.BoolEditor",boolToStr:function(value){return Kekule.StrUtils.boolToStr(value)},doCreateEditWidget:function(parentWidget){this._originValue=this.getValue();var result=new Kekule.Widget.CheckBox(parentWidget,this._originValue);result.setText(this.boolToStr(this._originValue));var self=this;return result.addEventListener("valueChange",function(e){var value=result.getChecked();result.setText(self.boolToStr(value))}),result},getValueText:function($super){var v=this.getValue();return Kekule.ObjUtils.isUnset(v)?Kekule.$L("WidgetTexts.S_VALUE_UNSET"):$super()},doSaveEditValue:function(){var value=this.getEditWidget().getChecked();return value!==this._originValue&&(this.setValue(value),!0)}}),Kekule.PropertyEditor.register(Kekule.PropertyEditor.BoolEditor,DataType.BOOL),Kekule.PropertyEditor.SelectEditor=Class.create(Kekule.PropertyEditor.BaseEditor,{CLASS_NAME:"Kekule.PropertyEditor.SelectEditor",getValueText:function($super){for(var v=this.getValue(),items=this.getSelectItems()||[],i=0,l=items.length;i<l;++i){var item=items[i];if(item.value===v)return item.text}return $super()},getSelectItems:function(){return[]},doCreateEditWidget:function(parentWidget){var result=new Kekule.Widget.SelectBox(parentWidget,this.getSelectItems());return this._originalValue=this.getValue(),result.setValue(this._originalValue),result},doSaveEditValue:function(){var value=this.getEditWidget().getValue();return value!==this._originalValue&&(this.setValue(value),!0)}}),Kekule.PropertyEditor.EnumEditor=Class.create(Kekule.PropertyEditor.SelectEditor,{CLASS_NAME:"Kekule.PropertyEditor.EnumEditor",initialize:function($super){$super(),this.enumInfos=[]},setPropertyInfo:function($super,value){if($super(value),value){var enumSrc=value.enumSource;if(enumSrc&&DataType.isObjectValue(enumSrc)){var fields=Kekule.ObjUtils.getOwnedFieldNames(enumSrc);this.enumInfos=[];for(var i=0,l=fields.length;i<l;++i)this.enumInfos.push({text:fields[i],value:enumSrc[fields[i]]})}}},getSelectItems:function(){var v=this.getValue();if(Kekule.ObjUtils.isUnset(v)){var result=Kekule.ArrayUtils.clone(this.enumInfos);return result.unshift({text:Kekule.$L("WidgetTexts.S_VALUE_UNSET"),value:v}),result}return this.enumInfos}}),Kekule.PropertyEditor.register(Kekule.PropertyEditor.EnumEditor,null,null,null,function(objClass,propInfo){return!!propInfo.enumSource}),Kekule.PropertyEditor.ObjectExEditor=Class.create(Kekule.PropertyEditor.BaseEditor,{CLASS_NAME:"Kekule.PropertyEditor.ObjectExEditor",getAttributes:function($super){var result=$super();return result|=PEA.SUBPROPS},hasSubPropertyEditors:function($super){return $super()&&this.getValue()},getSubPropertyEditors:function(propScopes){var result=[],objs=this.getValue();if(objs){if(objs instanceof ObjectEx)var obj=objs,objClass=obj.getClass();else var objClass=ClassEx.getCommonSuperClass(objs);for(var propList=ClassEx.getPropListOfScopes(objClass,propScopes),i=0,l=propList.getLength();i<l;++i){var propInfo=propList.getPropInfoAt(i),editorClass=Kekule.PropertyEditor.findEditorClass(objClass,propInfo);if(editorClass){var editor=new editorClass;editor.setObjects(Kekule.ArrayUtils.toArray(objs)),editor.setPropertyInfo(propInfo),editor.setValueTextMode(this.getValueTextMode()),result.push(editor)}}}return result},getValueText:function($super){var v=this.getValue();return Kekule.ObjUtils.notUnset(v)?v.getClassName?"["+v.getClassName()+"]":$super():Kekule.$L("WidgetTexts.S_OBJECT_UNSET")}}),Kekule.PropertyEditor.register(Kekule.PropertyEditor.ObjectExEditor,"ObjectEx"),Kekule.PropertyEditor.ObjectFieldEditor=Class.create(Kekule.PropertyEditor.SimpleEditor,{CLASS_NAME:"Kekule.PropertyEditor.ObjectFieldEditor",initialize:function(){},doCreateEditWidget:function($super,parentWidget){if(!this.getPropertyType()){var value=this.getValue();this.getPropertyInfo().dataType=DataType.getType(value)}return $super(parentWidget)}}),Kekule.PropertyEditor.ObjectEditor=Class.create(Kekule.PropertyEditor.BaseEditor,{CLASS_NAME:"Kekule.PropertyEditor.ObjectEditor",initialize:function($super){$super(),this._initialObjValue=void 0},getFieldEditorClass:function(objs,fieldInfo){return Kekule.PropertyEditor.findEditorClass(null,fieldInfo)||Kekule.PropertyEditor.ObjectFieldEditor},getFieldValueType:function(obj,fieldName){var value=obj[fieldName];return Kekule.ObjUtils.notUnset(value)?DataType.getType(value):null},createFieldEditor:function(objs,fieldInfo){var c=this.getFieldEditorClass(objs,fieldInfo),result=new c;return result.setParentEditor(this),result.setReadOnly(!1),result.setAllowEmpty(this.getAllowEmpty()),result.setPropertyInfo(fieldInfo),result.setObjects(objs),result.setValueTextMode(this.getValueTextMode()),result},getObjFields:function(obj){return obj?Kekule.ObjUtils.getOwnedFieldNames(obj):[]},getObjFieldInfos:function(obj){for(var fields=this.getObjFields(obj),result=[],i=0,l=fields.length;i<l;++i){var info={name:fields[i],dataType:this.getFieldValueType(obj,fields[i])};result.push(info)}return result},notifyChildEditorValueChange:function(fieldName,fieldValue){var old=this.getValue()||this._initialObjValue;old[fieldName]=fieldValue,this.setValue(old)},getAttributes:function($super){var result=$super();return result|=PEA.SUBPROPS},hasSubPropertyEditors:function($super){return $super()&&this.getObjFieldInfos(this.getValue()).length},getValueText:function($super){var VDM=Kekule.Widget.ValueListEditor.ValueDisplayMode;return this.getValueTextMode()===VDM.JSON?$super():this.getValue()?"["+Kekule.$L("WidgetTexts.S_OBJECT")+"]":""},setValue:function($super,value){var result=$super(value);return this._initialObjValue=value,result},getSubPropertyEditors:function(propScopes){var result=[],objs=AU.toArray(this.getValue());if(objs.length>1)return[];var obj=objs[0];this._initialObjValue=obj||{};for(var fieldInfos=this.getObjFieldInfos(obj),targets=[this._initialObjValue],i=0,l=fieldInfos.length;i<l;++i){var editor=this.createFieldEditor(targets,fieldInfos[i]);result.push(editor)}return result}}),Kekule.PropertyEditor.register(Kekule.PropertyEditor.ObjectEditor,DataType.OBJECT),Kekule.PropertyEditor.ArrayEditor=Class.create(Kekule.PropertyEditor.BaseEditor,{CLASS_NAME:"Kekule.PropertyEditor.ArrayEditor",getAttributes:function($super){var result=$super();return result|=PEA.SUBPROPS},hasSubPropertyEditors:function($super){var v=this.getValue();return $super()&&v&&v.length},getSubPropertyEditors:function(propScopes){var result=[],v=this.getValue();if(DataType.isArrayValue(v)&&v.length)for(var defItemType=this.getPropertyInfo().elementType,i=0,l=v.length;i<l;++i){var item=v[i],itemType=defItemType||DataType.getType(item),editorClass=Kekule.PropertyEditor.findEditorClassForType(itemType);if(editorClass){var editor=new editorClass;editor.setParentEditor(this),editor.setObjects([v]);var fakePropInfo={name:i,title:i,dataType:itemType};editor.setPropertyInfo(fakePropInfo),editor.setValueTextMode(this.getValueTextMode()),result.push(editor)}}return result},getValueText:function($super){var v=this.getValue();return DataType.isArrayValue(v)?"["+v.length+" "+Kekule.$L("WidgetTexts.S_ITEMS")+"]":$super()}}),Kekule.PropertyEditor.register(Kekule.PropertyEditor.ArrayEditor,DataType.ARRAY),Kekule.PropertyEditor.ColorEditor=Class.create(Kekule.PropertyEditor.SimpleEditor,{CLASS_NAME:"Kekule.PropertyEditor.ColorEditor",doCreateEditWidget:function(parentWidget){this._parentWidget=parentWidget;var value=this.getValue();this._originValue=value;var result=new Kekule.Widget.ColorDropTextBox(parentWidget,value);return result.setSpecialColors([Kekule.Widget.ColorPicker.SpecialColors.UNSET]),result.addEventListener("valueSet",function(e){this.saveEditValue()},this),this._textbox=result,result},doSaveEditValue:function(){var value=this.getEditWidget().getValue();return value===Kekule.Widget.ColorPicker.SpecialColors.UNSET?value=void 0:""===value&&(value=void 0),value!==this._originValue&&(this.setValue(value),!0)}}),Kekule.PropertyEditor.register(Kekule.PropertyEditor.ColorEditor,DataType.STRING,null,null,function(objClass,propInfo){var propName=propInfo.name;return propName&&propName.toLowerCase().indexOf("color")>=0}),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,DataType=__webpack_require__(0).DataType;module.exports=function(Kekule){return Kekule.Widget.PropEditorModifyOperation=Class.create(Kekule.Operation,{CLASS_NAME:"Kekule.Widget.PropEditorModifyOperation",initialize:function($super,propEditor,newValue,oldValue){$super(),this.setPropEditor(propEditor),this.setNewValue(newValue),this.setOldValue(oldValue)},initProperties:function(){this.defineProp("propEditor",{dataType:"Kekule.PropertyEditor.BaseEditor",serializable:!1}),this.defineProp("newValue",{dataType:DataType.VARIANT,serializable:!1}),this.defineProp("oldValue",{dataType:DataType.VARIANT,serializable:!1})},doExecute:function(){var propEditor=this.getPropEditor();void 0===this.getOldValue()&&this.setOldValue(propEditor.getValue()),propEditor.setValue(this.getNewValue())},doReverse:function(){this.getPropEditor().setValue(this.getOldValue())}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,ClassEx=__webpack_require__(0).ClassEx,ObjectEx=__webpack_require__(0).ObjectEx,DataType=__webpack_require__(0).DataType;module.exports=function(Kekule){Kekule.Widget.HtmlClassNames=Object.extend(Kekule.Widget.HtmlClassNames,{WIDGET_CONFIGURATOR:"K-Widget-Configurator",WIDGET_CONFIGURATOR_CLIENT:"K-Widget-Configurator-Client",ACTION_OPEN_CONFIGURATOR:"K-Action-Open-Configurator"});var CNS=Kekule.Widget.HtmlClassNames;return Kekule.Widget.Configurator=Class.create(Kekule.Widget.Panel,{CLASS_NAME:"Kekule.Widget.Configurator",TAB_BTN_DATA_FIELD:"__$data__",DEF_TAB_POSITION:Kekule.Widget.Position.RIGHT,initialize:function($super,widget){this.setPropStoreFieldValue("widget",widget),this._objInspector=null,this._tabGroup=null,$super(widget)},initProperties:function(){this.defineProp("widget",{dataType:"Kekule.Widget.BaseWidget",serializable:!1}),this.defineProp("autoUpdate",{dataType:DataType.BOOL}),this.defineProp("tabPosition",{dataType:DataType.INT,setter:function(value){this.setPropStoreFieldValue("tabPosition",value),this._tabGroup&&this._tabGroup.setTabButtonPosition(value||this.DEF_TAB_POSITION)}})},initPropValues:function($super){$super(),this.setLayout(Kekule.Widget.Layout.HORIZONTAL)},doGetWidgetClassName:function($super){return $super()+" "+CNS.WIDGET_CONFIGURATOR},doCreateRootElement:function(doc){return doc.createElement("div")},doCreateSubElements:function($super,doc,element){var result=[],rootElem=doc.createElement("div");rootElem.className=CNS.WIDGET_CONFIGURATOR_CLIENT,result.push(rootElem);var objInspector=new Kekule.Widget.ObjectInspector(this);objInspector.setShowObjsInfoPanel(!1),objInspector.setSortField(null),objInspector.appendToElem(rootElem),this._objInspector=objInspector,objInspector.addEventListener("propertyChange",function(e){this.invokeEvent("configChange",{obj:objInspector.getObjects()[0],propertyName:e.propertyInfo.name,oldValue:e.oldValue,newValue:e.newValue})},this);var categories=this.getCategoryInfos(),tabBtnGroup=new Kekule.Widget.TabButtonGroup(this);this._tabGroup=tabBtnGroup,tabBtnGroup.setTabButtonPosition(this.getTabPosition()||this.DEF_TAB_POSITION);for(var firstBtn,i=0,l=categories.length;i<l;++i){var c=categories[i],btn=new Kekule.Widget.RadioButton(tabBtnGroup);btn.setText(c.title||c.name),btn.setHint(c.description||""),btn[this.TAB_BTN_DATA_FIELD]=c.obj,btn.appendToWidget(tabBtnGroup),0===i&&(firstBtn=btn)}return tabBtnGroup.addEventListener("execute",function(e){var btn=e.widget;btn instanceof Kekule.Widget.RadioButton&&this._switchToTab(btn)},this),tabBtnGroup.appendToElem(rootElem),categories.length<=1&&tabBtnGroup.setDisplayed("none"),firstBtn.setChecked(!0),this._switchToTab(firstBtn),element.appendChild(rootElem),result},doWidgetShowStateChanged:function($super,isShown){$super(isShown),this.getAutoUpdate()&&(isShown?this.loadConfigValues():this.saveConfigValues())},loadConfigValues:function(){},saveConfigValues:function(){},getCategoryInfos:function(){var widget=this.getWidget(),result=[],facade=widget.getSettingFacade();if(facade){var propInfo=widget.getPropInfo("settingFacade");result.push({obj:facade,name:propInfo.name,title:propInfo.title,descrption:propInfo.description})}return result},_switchToTab:function(tabBtn){var obj=tabBtn[this.TAB_BTN_DATA_FIELD];this._objInspector.setObjects(obj)}}),Kekule.Widget.ActionOpenConfigWidget=Class.create(Kekule.Action,{CLASS_NAME:"Kekule.Widget.ActionOpenConfigWidget",HTML_CLASSNAME:CNS.ACTION_OPEN_CONFIGURATOR,initialize:function($super,widget){$super(),this.setWidget(widget),this.setText(Kekule.$L("WidgetTexts.CAPTION_CONFIG")),this.setHint(Kekule.$L("WidgetTexts.HINT_CONFIG"))},initProperties:function(){this.defineProp("widget",{dataType:"Kekule.Widget.BaseWidget",serializable:!1})},doUpdate:function(){var w=this.getWidget();this.setEnabled(w&&w.getEnabled())},doExecute:function(target){this.getWidget().openConfigurator(target)}}),ClassEx.extend(Kekule.Widget.BaseWidget,{getSettingFacadeClass:function(){var c=this.getClass(),result=null;do{var className=ClassEx.getClassName(c)+".Settings";result=ClassEx.findClass(className),c=ClassEx.getSuperClass(c)}while(c&&!result);return result},getConfiguratorClass:function(){var c=this.getClass(),result=null;do{var className=ClassEx.getClassName(c)+".Configurator";result=ClassEx.findClass(className,void 0,Kekule),c=ClassEx.getSuperClass(c)}while(c&&!result);return result},createConfigurator:function(){var cclass=this.getConfiguratorClass();return console.log(cclass),new cclass(this)},getConfigurator:function(){return this._configurator||(this._configurator=this.createConfigurator()),this._configurator},openConfigurator:function(callerWidget){this.getConfigurator().show(callerWidget||this,null,Kekule.Widget.ShowHideType.DROPDOWN)}}),ClassEx.defineProp(Kekule.Widget.BaseWidget,"settingFacade",{dataType:DataType.OBJECTEX,serializable:!1,scope:Class.PropertyScope.PUBLIC,setter:null,getter:function(){var result=this.getPropStoreFieldValue("settingFacade");if(!result){var c=this.getSettingFacadeClass();c&&(result=new c(this),this.setPropStoreFieldValue("settingFacade",result))}return result}}),Kekule.Widget.BaseWidget.Settings=Class.create(ObjectEx,{CLASS_NAME:"Kekule.Widget.BaseWidget.Settings",initialize:function($super,widget){this._basedClass=null,$super(),this.setWidget(widget)},initProperties:function(){this.defineProp("widget",{dataType:"Kekule.Widget.BaseWidget",serializable:!1,scope:Class.PropertyScope.PUBLIC})},getBasedClass:function(){if(!this.hasOwnProperty("_basedClass")||!this._basedClass){var className=this.getClassName(),cascadeNames=className.split(".");cascadeNames.pop(),className=cascadeNames.join("."),this._basedClass=ClassEx.findClass(className)}return this._basedClass},defineDelegatedProp:function(propName,widgetPropName){widgetPropName||(widgetPropName=propName);var widgetPropInfo=ClassEx.getPropInfo(this.getBasedClass(),widgetPropName),propOptions=Object.create(widgetPropInfo);propOptions.setter=null,propOptions.getter=null,widgetPropInfo.getter&&(propOptions.getter=function(){return this.getWidget().getPropValue(widgetPropName)}),widgetPropInfo.setter&&(propOptions.setter=function(value){this.getWidget().setPropValue(widgetPropName,value)}),this.defineProp(propName,propOptions)},defineDelegatedProps:function(propNames,widgetPropNames){widgetPropNames||(widgetPropNames=[]);for(var i=0,l=propNames.length;i<l;++i){var propName=propNames[i],widgetPropName=widgetPropNames[i]||propName;this.defineDelegatedProp(propName,widgetPropName)}}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,ObjectEx=__webpack_require__(0).ObjectEx,DataType=__webpack_require__(0).DataType;module.exports=function(Kekule){return Kekule.Widget.BaseDataSet=Class.create(ObjectEx,{CLASS_NAME:"Kekule.Widget.BaseDataSet",PREFIX_SORT_DESC:"!",initProperties:function(){this.defineProp("enableCache",{dataType:DataType.BOOL,getter:function(){return this.getPropStoreFieldValue("enableCache")&&this.getCacheAvailable()},setter:function(value){this.setPropStoreFieldValue("enableCache",value),value||this.clearCache()}}),this.defineProp("defaultTimeout",{dataType:DataType.INT}),this.defineProp("sortFields",{dataType:DataType.ARRAY,setter:function(value){var a=value?Kekule.ArrayUtils.toArray(value):null;this.setPropStoreFieldValue("sortFields",a),this.sortFieldsChanged(a)}}),this.defineProp("cache",{dataType:DataType.ARRAY})},initPropValues:function($super){$super(),this.setEnableCache(!0),this.setCache([]),this.setDefaultTimeout(2e4)},finalize:function($super){this.clearCache(),this.setCache(null),$super()},dataChanged:function(){this.clearCache(),this.invokeEvent("dataChange")},sortFieldsChanged:function(newFields){this.clearCache(),this.doSortFieldsChanged(newFields)},doSortFieldsChanged:function(newFields){},getTotalCount:function(){return this.doGetTotalCount()||0},doGetTotalCount:function(){},totalCountChanged:function(newCount){this.invokeEvent("totalCountChange",{totalCount:newCount})},getFirstIndex:function(){return 0},getLastIndex:function(){return(this.getTotalCount()||0)-1},getCacheAvailable:function(){return!0},clearCache:function(){return this.getCache().length=0,this},saveCacheData:function(data,fromIndex){for(var cache=this.getCache(),currIndex=fromIndex,i=0;i<data.length;++i)cache[currIndex]=data[i]||null,++currIndex},loadCacheData:function(fromIndex,count){if(this.getEnableCache()){var cache=this.getCache();if(cache.length<fromIndex+count)return null;for(var result=[],i=fromIndex,l=fromIndex+count;i<l;++i){var item=cache[i];if(void 0===item)return null;result.push(item)}return result}return null},fetch:function(options){var op=Object.extend({fromIndex:0,count:0},options);if(op.timeout=op.timeout||this.getDefaultTimeout(),this.getEnableCache()){var data=this.loadCacheData(op.fromIndex,op.count);if(data)return void op.callback(data)}var self=this,timeouted=!1,done=function(data){timeouted||(timeoutId&&clearTimeout(timeoutId),options.callback&&options.callback(data),self.getEnableCache()&&self.saveCacheData(data,op.fromIndex))},error=function(err){timeouted||(timeoutId&&clearTimeout(timeoutId),options.errCallback&&options.errCallback(err))};if(op.timeout>0)var timeoutCallback=function(){timeoutId&&clearTimeout(timeoutId),timeouted=!0,op.timeoutCallback?op.timeoutCallback():options.errCallback&&options.errCallback(Kekule.$L("ErrorMsg.FETCH_DATA_TIMEOUT"))},timeoutId=setTimeout(timeoutCallback,op.timeout);op.callback=done,op.errCallback=error;this.doFetch(op.fromIndex,op.count,op.callback,op.errCallback)},doFetch:function(fromIndex,count,callback,errCallback){}}),Kekule.Widget.ArrayDataSet=Class.create(Kekule.Widget.BaseDataSet,{CLASS_NAME:"Kekule.Widget.ArrayDataSet",initialize:function($super,data){$super(),this.setData(data)},initProperties:function(){this.defineProp("data",{dataType:DataType.ARRAY,setter:function(value){this.setPropStoreFieldValue("data",value);var sortFields=this.getSortFields();sortFields&&this.doSortFieldsChanged(sortFields),this.dataChanged()}})},getCacheAvailable:function(){return!1},doSortFieldsChanged:function(newFields){var data=this.getData()||[];return Kekule.ArrayUtils.sortHashArray(data,newFields),this.dataChanged(),this},doGetTotalCount:function(){return(this.getData()||[]).length},doFetch:function(fromIndex,count,callback,errCallback){for(var result=[],data=this.getData()||[],i=fromIndex,l=Math.min(fromIndex+count,data.length);i<l;++i){var item=data[i];result.push(item)}callback(result)}}),Kekule.Widget.DataPager=Class.create(ObjectEx,{CLASS_NAME:"Kekule.Widget.DataPager",initialize:function($super,dataSet){$super(),this.setDataSet(dataSet)},initProperties:function(){this.defineProp("dataSet",{dataType:"Kekule.Widget.BaseDataSet",setter:function(value){var old=this.getDataSet();value!==old&&(this.setPropStoreFieldValue("dataSet",value),this.dataSetChange(old,value),this.switchToPage(this.getCurrPageIndex()||0))}}),this.defineProp("pageSize",{dataType:DataType.INT,setter:function(value){value!==this.getPageSize()&&(this.setPropStoreFieldValue("pageSize",value),this.pageCountChanged(this.getPageCount()),this.switchToPage(this.getCurrPageIndex()||0))}}),this.defineProp("currPageIndex",{dataType:DataType.INT}),this.defineProp("currPageData",{dataType:DataType.ARRAY}),this.defineProp("sortFields",{dataType:DataType.ARRAY,serializable:!1,getter:function(){return this.getDataSet()&&this.getDataSet().getSortFields()},setter:function(value){this.getDataSet()&&this.getDataSet().setSortFields(value)}})},initPropValues:function($super){$super(),this.setCurrPageIndex(0)},dataSetChange:function(oldDataSet,newDataSet){oldDataSet&&(oldDataSet.RemoveEventListener("dataChange",this.reactDataSetDataChange,this),oldDataSet.RemoveEventListener("totalCountChange",this.reactDataSetTotalCountChange,this)),newDataSet&&(newDataSet.addEventListener("dataChange",this.reactDataSetDataChange,this),newDataSet.addEventListener("totalCountChange",this.reactDataSetTotalCountChange,this)),this.pageCountChanged(this.getPageCount())},reactDataSetDataChange:function(e){this.dataChanged()},dataChanged:function(){this.pageCountChanged(this.getPageCount()),this.switchToPage(this.getCurrPageIndex()||0)},reactDataSetTotalCountChange:function(e){this.pageCountChanged(this.getPageCount())},getPageCount:function(){var dataset=this.getDataSet(),totalCount=dataset?dataset.getTotalCount()||0:0;return Math.ceil(totalCount/this.getPageSize())},pageCountChanged:function(newPageCount){this.invokeEvent("pageCountChange",{pageCount:newPageCount})},fetchPageData:function(options){var pageSize=this.getPageSize(),pageIndex=Kekule.ObjUtils.isUnset(options.pageIndex)?this.getCurrPageIndex():options.pageIndex,fromIndex=pageSize*pageIndex,count=this.getPageSize(),ops=Object.create(options);return Object.extend(ops,{fromIndex:fromIndex,count:count}),this.getDataSet().fetch(ops),this},switchToPage:function(pageIndex,timeout){var self=this,ops={pageIndex:pageIndex,timeout:timeout,callback:function(data){self.setCurrPageData(data),self.setCurrPageIndex(pageIndex),self.invokeEvent("dataFetched",{pageIndex:pageIndex,data:data})},errCallback:function(err){self.invokeEvent("dataError",{error:err}),Kekule.error(err)}};this.invokeEvent("pageRetrieve",{pageIndex:pageIndex}),this.fetchPageData(ops)}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,DataType=__webpack_require__(0).DataType;module.exports=function(Kekule){var DU=Kekule.DomUtils,EU=Kekule.HtmlElementUtils,CNS=Kekule.Widget.HtmlClassNames;Kekule.Widget.HtmlClassNames=Object.extend(Kekule.Widget.HtmlClassNames,{DATAGRID:"K-DataGrid",DATATABLE:"K-DataTable",DATATABLE_ROW_ODD:"K-Odd",DATATABLE_ROW_EVEN:"K-Even",DATATABLE_CELL_WRAPPER:"K-DataTable-CellWrapper",DATATABLE_HEADCELL_INTERACTABLE:"K-DataTable-HeadCellInteractable",DATATABLE_OPER_COL:"K-DataTable-OperCol",DATATABLE_OPER_CELL:"K-DataTable-OperCell",DATATABLE_CHECK_COL:"K-DataTable-CheckCol",DATATABLE_CHECK_CELL:"K-DataTable-CheckCell",DATATABLE_DATA_COL:"K-DataTable-DataCol",DATATABLE_DATA_CELL:"K-DataTable-DataCell",DATATABLE_SORTMARK:"K-DataTable-SortMark",DATATABLE_SORTASC:"K-Sort-Asc",DATATABLE_SORTDESC:"K-Sort-Desc",DATATABLE_EDIT:"K-DataTable-Edit",DATATABLE_DELETE:"K-DataTable-Delete",DATATABLE_INSERT:"K-DataTable-Insert",PAGENAVIGATOR:"K-PageNavigator",PAGENAVIGATOR_FIRST:"K-PageNavigator-First",PAGENAVIGATOR_LAST:"K-PageNavigator-Last",PAGENAVIGATOR_PREV:"K-PageNavigator-Prev",PAGENAVIGATOR_NEXT:"K-PageNavigator-Next",PAGENAVIGATOR_PAGEINDEXER:"K-PageNavigator-PageIndexer",PAGENAVIGATOR_PAGEINPUT:"K-PageNavigator-PageInput",PAGENAVIGATOR_PAGESELECTOR:"K-PageNavigator-PageSelector"}),Kekule.Widget.DataTableColNames={OPER:"OPER",CHECK:"CHECK",ALL:"*"};var TCN=Kekule.Widget.DataTableColNames;Kekule.Widget.DataTable=Class.create(Kekule.Widget.BaseWidget,{CLASS_NAME:"Kekule.Widget.DataTable",BINDABLE_TAG_NAMES:["div","span"],PREFIX_SORT_DESC:"!",COLDEF_FIELD:"__$colDef__",ROWDATA_FIELD:"__$rowData__",ROW_OPER_TOOLBAR_FIELD:"__$rowOperToolbar__",ROW_CHECKBOX_FIELD:"__$rowCheckBox__",COLNAME_OPER:TCN.OPER,COLNAME_CHECK:TCN.CHECK,COLNAME_ALL:TCN.ALL,initialize:function($super,parentOrElementOrDocument){this._displayData=null,this.setPropStoreFieldValue("showTableHead",!0),$super(parentOrElementOrDocument)},initProperties:function(){this.defineProp("data",{dataType:DataType.ARRAY}),this.defineProp("columns",{dataType:DataType.ARRAY}),this.defineProp("operColShowMode",{dataType:DataType.STRING}),this.defineProp("operWidgets",{dataType:DataType.ARRAY}),this.defineProp("sortFields",{dataType:DataType.ARRAY,setter:function(value){var a=value?Kekule.ArrayUtils.toArray(value):null;this.setPropStoreFieldValue("sortFields",a),this.getDataPager()&&this.getDataPager().setSortFields(a)}}),this.defineProp("sortFunc",{dataType:DataType.FUNCTION}),this.defineProp("showTableHead",{dataType:DataType.BOOL}),this.defineProp("enableHeadInteraction",{dataType:DataType.BOOL}),this.defineProp("enableActiveRow",{dataType:DataType.BOOL,setter:function(value){this.setPropStoreFieldValue("enableActiveRow",value),value||this.setActiveCell(null)}}),this.defineProp("activeCell",{dataType:DataType.OBJECT,setter:function(value){var old=this.getActiveCell();if(old!==value)if(old&&EU.removeClass(old,CNS.STATE_ACTIVE),this.setPropStoreFieldValue("activeCell",value),value){EU.addClass(value,CNS.STATE_ACTIVE);var row=this.getParentRow(value);row&&this.setActiveRow(row)}else this.setActiveRow(null)}}),this.defineProp("activeRow",{dataType:DataType.OBJECT,setter:function(value){var old=this.getActiveRow();old!==value&&(this.activeRowChanged(old,value),this.setPropStoreFieldValue("activeRow",value))}}),this.defineProp("hoverCell",{dataType:DataType.OBJECT,setter:function(value){var old=this.getHoverCell();if(old!==value)if(old&&EU.removeClass(old,CNS.STATE_HOVER),this.setPropStoreFieldValue("hoverCell",value),value){EU.addClass(value,CNS.STATE_HOVER);var row=this.getParentRow(value);row&&this.setHoverRow(row)}else this.setHoverRow(null)}}),this.defineProp("hoverRow",{dataType:DataType.OBJECT,setter:function(value){var old=this.getHoverRow();old!==value&&(this.hoverRowChanged(old,value),this.setPropStoreFieldValue("hoverRow",value))}}),this.defineProp("dataPager",{dataType:"Kekule.Widget.DataPager",setter:function(value){var old=this.getDataPager();old!==value&&(this.setPropStoreFieldValue("dataPager",value),this.dataPagerChanged(value,old))}})},initPropValues:function($super){$super(),this.reactOperEditBind=this.reactOperEdit.bind(this),this.reactOperDeleteBind=this.reactOperDelete.bind(this),this.reactOperInsertBind=this.reactOperInsert.bind(this)},doObjectChange:function($super,modifiedPropNames){$super(modifiedPropNames);var relatedProps=["data","columns","sortFields","sortFunc","showTableHead","enableHeadInteraction","operColShowMode","operWidgets"];Kekule.ArrayUtils.intersect(modifiedPropNames,relatedProps).length&&this.recreateChildContent()},doGetWidgetClassName:function($super){return $super()+" "+CNS.DATATABLE},doCreateRootElement:function(doc){return doc.createElement("div")},doCreateSubElements:function(doc,rootElem){return this.doCreateDataTable(doc,rootElem)},doCreateDataTable:function(doc,parentElem){var result=doc.createElement("table");return this.recreateChildContent(doc,result),parentElem.appendChild(result),result},getTableElement:function(){return this.getElement()&&this.getElement().getElementsByTagName("table")[0]},getShowOperCol:function(){return(this.getOperColShowMode()||Kekule.Widget.DataTable.OperColShowMode.NONE)!==Kekule.Widget.DataTable.OperColShowMode.NONE},recreateChildContent:function(doc,parentElem){this.setActiveCell(null),this.setHoverCell(null);var data=this.prepareData(),tableElem=parentElem||this.getTableElement(),result=[];if(tableElem){if(DU.clearChildContent(tableElem),!doc)var doc=tableElem.ownerDocument;result.push(this.doCreateDataTableColGroup(doc,tableElem,data.columns)),this.getShowTableHead()&&result.push(this.doCreateDataTableHead(doc,tableElem,data.columns)),result.push(this.doCreateDataTableBody(doc,tableElem,data.columns,data.data))}return result},doCreateDataTableColGroup:function(doc,parentElem,columns){for(var cols=columns||[],result=doc.createElement("colgroup"),i=0,l=cols.length;i<l;++i){var colDef=cols[i]||{},colElem=doc.createElement("col");colDef.colClassName&&(colElem.className=colDef.colClassName),colDef.colStyle&&(colElem.style.cssText=colDef.colStyle),result.appendChild(colElem)}return parentElem.appendChild(result),result},doCreateDataTableCellWrapper:function(doc,parentElem){var result=doc.createElement("span");return result.className=CNS.DATATABLE_CELL_WRAPPER,parentElem.appendChild(result),result},doCreateDataTableHead:function(doc,parentElem,columns){for(var cols=columns||[],headInteractable=this.getEnableHeadInteraction(),result=doc.createElement("thead"),rowElem=doc.createElement("tr"),i=0,l=cols.length;i<l;++i){var colDef=cols[i]||{};this.doCreateDataTableHeadCell(doc,rowElem,colDef,headInteractable)}return result.appendChild(rowElem),parentElem.appendChild(result),result},doCreateDataTableHeadCell:function(doc,parentElem,colDef,headInteractable){var elem=doc.createElement("th");colDef.className&&(elem.className=colDef.className),colDef.style&&(elem.style.cssText=colDef.style);var wrapperElem=this.doCreateDataTableCellWrapper(doc,elem);(Kekule.ObjUtils.notUnset(colDef.disableInteract)?!colDef.disableInteract:headInteractable)&&EU.addClass(elem,CNS.DATATABLE_HEADCELL_INTERACTABLE),DU.setElementText(wrapperElem,colDef.text||colDef.name);var sortMark=this.doCreateDataTableHeadCellSortMark(doc,elem);return 1===colDef.sorting?EU.addClass(sortMark,CNS.DATATABLE_SORTASC):-1===colDef.sorting&&EU.addClass(sortMark,CNS.DATATABLE_SORTDESC),wrapperElem.title=colDef.hint||"",elem[this.COLDEF_FIELD]=colDef,parentElem.appendChild(elem),elem},doCreateDataTableHeadCellSortMark:function(doc,parentElem){var result=doc.createElement("span");return result.className=CNS.DATATABLE_SORTMARK,parentElem.appendChild(result),result},doCreateDataTableBody:function(doc,parentElem,columns,data){var cols=columns||[],data=data||[],result=doc.createElement("tbody");if(this.getShowOperCol())var childWidgetDefinitions=this.getOperWidgetDefinitions();for(var isOdd=!0,i=0,l=data.length;i<l;++i){var rowElem=doc.createElement("tr");rowElem.className=isOdd?CNS.DATATABLE_ROW_ODD:CNS.DATATABLE_ROW_EVEN,isOdd=!isOdd;var rowData=data[i]||{};rowElem[this.ROWDATA_FIELD]=rowData;for(var j=0,k=cols.length;j<k;++j){var colDef=cols[j],key=colDef.name,value=rowData[key],cellElem=doc.createElement("td");colDef.className&&(cellElem.className=colDef.className),colDef.style&&(cellElem.style.cssText=colDef.style);var wrapperElem=this.doCreateDataTableCellWrapper(doc,cellElem);if(colDef.isOperCol){var ops={rowData:rowData,rowIndex:i,colIndex:j,childWidgetDefinitions:childWidgetDefinitions},w=this.doCreateOperCellContent(wrapperElem,ops);rowElem[this.ROW_OPER_TOOLBAR_FIELD]=w}else if(colDef.isCheckCol){var ops={rowData:rowData,rowIndex:i,colIndex:j},c=this.doCreateCheckCellContent(wrapperElem,ops);rowElem[this.ROW_CHECKBOX_FIELD]=c}else{var ops={rowData:rowData,cellKey:key,cellValue:value,rowIndex:i,colIndex:j};this.doCreateDataCellContent(wrapperElem,ops)}cellElem.appendChild(wrapperElem),rowElem.appendChild(cellElem)}result.appendChild(rowElem)}return parentElem.appendChild(result),result},doCreateDataCellContent:function(parentElem,options){var svalue="";Kekule.ObjUtils.notUnset(options.cellValue)&&(svalue=""+options.cellValue),DU.setElementText(parentElem,svalue)},doCreateCheckCellContent:function(parentElem,options){var result=new Kekule.Widget.CheckBox(this);return result.appendToElem(parentElem),result},doCreateOperCellContent:function(parentElem,options){var toolbar=this.doCreateOperToolbar(parentElem,options.childWidgetDefinitions),SM=Kekule.Widget.DataTable.OperColShowMode;return this.getOperColShowMode()!==SM.ALL&&toolbar.setVisible(!1),toolbar},doCreateOperToolbar:function(parentElem,childDefinitions){var result=new Kekule.Widget.ButtonGroup(this);return result.setChildDefs(childDefinitions),result.appendToElem(parentElem),result},getDefaultOperButtons:function(){var CS=Kekule.Widget.DataTable.Components;return[CS.EDIT,CS.DELETE]},getOperWidgetDefinitions:function(){for(var result=[],comps=this.getOperWidgets()||this.getDefaultOperButtons(),i=0,l=comps.length;i<l;++i){var comp=comps[i];if(DataType.isObjectValue(comp))result.push(comp);else{var def=this.getDefaultComponentDefinitionHash(comp);def&&result.push(def)}}return result},getDefaultComponentDefinitionHash:function(compName){var result,CS=Kekule.Widget.DataTable.Components;return compName===CS.EDIT?result={widget:"Kekule.Widget.Button",htmlClass:CNS.DATATABLE_EDIT,text:Kekule.$L("WidgetTexts.CAPTION_DATATABLE_EDIT"),hint:Kekule.$L("WidgetTexts.HINT_DATATABLE_EDIT"),"#execute":this.reactOperEditBind}:compName===CS.DELETE?result={widget:"Kekule.Widget.Button",htmlClass:CNS.DATATABLE_DELETE,text:Kekule.$L("WidgetTexts.CAPTION_DATATABLE_DELETE"),hint:Kekule.$L("WidgetTexts.HINT_DATATABLE_DELETE"),"#execute":this.reactOperDeleteBind}:compName===CS.INSERT&&(result={widget:"Kekule.Widget.Button",htmlClass:CNS.DATATABLE_INSERT,text:Kekule.$L("WidgetTexts.CAPTION_DATATABLE_INSERT"),hint:Kekule.$L("WidgetTexts.HINT_DATATABLE_INSERT"),"#execute":this.reactOperInsertBind}),result&&(result.internalName=compName),result},hasExternalDataProvider:function(){return!!this.getDataPager()},needSort:function(){return this.getSortFields()||this.getSortFunc()},sortData:function(){var data=this.getData()||[];if(this.needSort()&&!this.hasExternalDataProvider()){var dupData=Kekule.ArrayUtils.clone(data);return Kekule.ArrayUtils.sortHashArray(dupData,this.getSortFields()),dupData}return data},prepareData:function(){var result={},data=this.sortData();result.data=data;var createDefaultCols=function(data){for(var fields=[],i=0,l=data.length;i<l;++i){var currFields=Kekule.ObjUtils.getOwnedFieldNames(data[i]);Kekule.ArrayUtils.pushUnique(fields,currFields)}for(var columns=[],i=0,l=fields.length;i<l;++i)columns.push({name:fields[i],text:fields[i]});return columns};this.getColumns()?result.columns=Kekule.ArrayUtils.clone(this.getColumns()):result.columns=createDefaultCols(data);for(var i=0;i<result.columns.length;){var col=result.columns[i];if("string"==typeof col&&(col={name:col}),col.name===this.COLNAME_OPER)result.columns[i]={name:"",text:"",disableInteract:!0,isOperCol:!0,colClassName:CNS.DATATABLE_OPER_COL,className:CNS.DATATABLE_OPER_CELL};else if(col.name===this.COLNAME_CHECK)result.columns[i]={name:"",text:"",disableInteract:!0,isCheckCol:!0,colClassName:CNS.DATATABLE_CHECK_COL,className:CNS.DATATABLE_CHECK_CELL};else if(col.name===this.COLNAME_ALL){var newCols=createDefaultCols(data),arg=newCols;arg.unshift(1),arg.unshift(i),result.columns.splice.apply(result.columns,arg)}else col.colClassName=CNS.DATATABLE_DATA_COL+" "+(col.colClassName||""),col.className=CNS.DATATABLE_DATA_CELL+" "+(col.className||"");++i}if(this.needSort()&&!this.getSortFunc())for(var sortFields=this.getSortFields(),i=0,l=result.columns.length;i<l;++i){var colDef=result.columns[i],colName=colDef.name;sortFields.indexOf(colName)>=0?result.columns[i].sorting=1:sortFields.indexOf(this.PREFIX_SORT_DESC+colName)>=0?result.columns[i].sorting=-1:result.columns[i].sorting=0}return result},activeRowChanged:function(oldRow,newRow){var SM=Kekule.Widget.DataTable.OperColShowMode,operShowMode=this.getOperColShowMode();oldRow&&(EU.removeClass(oldRow,CNS.STATE_ACTIVE),operShowMode!==SM.ACTIVE&&operShowMode!==SM.HOVER||this.hideRowOperToolbar(oldRow)),newRow&&(EU.addClass(newRow,CNS.STATE_ACTIVE),operShowMode!==SM.ACTIVE&&operShowMode!==SM.HOVER||this.showRowOperToolbar(newRow))},hoverRowChanged:function(oldRow,newRow){var SM=Kekule.Widget.DataTable.OperColShowMode,operShowMode=this.getOperColShowMode();oldRow&&(EU.removeClass(oldRow,CNS.STATE_HOVER),operShowMode===SM.HOVER&&oldRow!==this.getActiveRow()&&this.hideRowOperToolbar(oldRow)),newRow&&(EU.addClass(newRow,CNS.STATE_HOVER),operShowMode===SM.HOVER&&this.showRowOperToolbar(newRow))},getParentCell:function(elem){return DU.isDescendantOf(elem,this.getElement())?DU.getNearestAncestorByTagName(elem,"td",!0):null},getParentHeadCell:function(elem){return DU.isDescendantOf(elem,this.getElement())?DU.getNearestAncestorByTagName(elem,"th",!0):null},getParentRow:function(elem){return DU.isDescendantOf(elem,this.getElement())?DU.getNearestAncestorByTagName(elem,"tr",!0):null},getColCount:function(){return(this.getColumns()||[]).length},getRowCount:function(){return(this.getData()||[]).length},getDataRows:function(){var tbody=this.getElement().getElementsByTagName("tbody")[0];return tbody&&tbody.getElementsByTagName("tr")},getCheckedRows:function(){for(var result=[],rows=this.getDataRows(),i=0,l=rows.length;i<l;++i)this.isRowChecked(rows[i])&&result.push(rows[i]);return result},getRowData:function(rowElem){return rowElem?rowElem[this.ROWDATA_FIELD]:null},isRowChecked:function(rowElem){var c=this.getRowCheckBox(rowElem);return c&&c.getChecked&&c.getChecked()},getRowCheckBox:function(rowElem){return rowElem&&rowElem[this.ROW_CHECKBOX_FIELD]},getRowOperToolbar:function(rowElem){return rowElem?rowElem[this.ROW_OPER_TOOLBAR_FIELD]:null},showRowOperToolbar:function(rowElem){var w=this.getRowOperToolbar(rowElem);w&&w.setVisible(!0)},hideRowOperToolbar:function(rowElem){var w=this.getRowOperToolbar(rowElem);w&&w.setVisible(!1)},dataPagerChanged:function(newPager,oldPager){oldPager&&(oldPager.removeEventListener("pageRetrieve",this.reactPagerRetrieve,this),oldPager.removeEventListener("dataFetched",this.reactPagerFetched,this),oldPager.removeEventListener("dataError",this.reactPagerError,this)),newPager&&(newPager.addEventListener("pageRetrieve",this.reactPagerRetrieve,this),newPager.addEventListener("dataFetched",this.reactPagerFetched,this),newPager.addEventListener("dataError",this.reactPagerError,this),this.setData(newPager.getCurrPageData()))},reactPagerRetrieve:function(e){this.reportMessage&&(this._loadingDataMsg=this.reportMessage(Kekule.$L("WidgetTexts.MSG_RETRIEVING_DATA"),Kekule.Widget.MsgType.INFO))},reactPagerFetched:function(e){this.setData(e.data),this._loadingDataMsg&&this.removeMessage&&this.removeMessage(this._loadingDataMsg)},reactPagerError:function(e){this._loadingDataMsg&&this.removeMessage&&this.removeMessage(this._loadingDataMsg),this.flashMessage&&this.flashMessage(e.error.message||e.error,Kekule.Widget.MsgType.ERROR)},reactOperEdit:function(e){return this.reactOperExecute(TCS.EDIT,e)},reactOperDelete:function(e){return this.reactOperExecute(TCS.DELETE,e)},reactOperInsert:function(e){return this.reactOperExecute(TCS.INSERT,e)},reactOperExecute:function(compName,e){var target=e.target,rowElem=this.getParentRow(target.getElement()),rowData=this.getRowData(rowElem);return this.doReactOperExecute(compName,rowData,rowElem,e)},doReactOperExecute:function(compName,rowData,rowElem,e){},react_click:function($super,e){$super(e);var elem=e.getTarget(),headCell=this.getParentHeadCell(elem);if(headCell)this._autoSortOnHeadCell(headCell);else if(this.getEnableActiveRow()){var dataCell=this.getParentCell(elem);dataCell&&this.setActiveCell(dataCell)}},react_mouseover:function($super,e){$super(e);var elem=e.getTarget();if(this.getEnableActiveRow()){var dataCell=this.getParentCell(elem);dataCell?this.setHoverCell(dataCell):this.setHoverCell(null)}},react_mouseleave:function($super,e){$super(e);e.getTarget();this.getEnableActiveRow()&&this.setHoverCell(null)},_autoSortOnHeadCell:function(headCell){if(headCell&&this.getEnableHeadInteraction()){var colDef=headCell[this.COLDEF_FIELD];if(colDef&&!colDef.disableInteract){var sortField=colDef.name;1===colDef.sorting&&(sortField=this.PREFIX_SORT_DESC+sortField),this.setSortFields([sortField])}}},load:function(data,columns,sortFields,sortFunc){this.beginUpdate();try{this.setData(data),this.setColumns(columns),this.setSortFields(sortFields?Kekule.ArrayUtils.toArray(sortFields):null),this.setSortFunc(sortFunc)}finally{this.endUpdate()}return this},reload:function(){return this.recreateChildContent(),this}}),Kekule.Widget.DataTable.OperColShowMode={NONE:"none",ACTIVE:"active",HOVER:"hover",ALL:"all"},Kekule.Widget.DataTable.Components={EDIT:"edit",DELETE:"delete",INSERT:"insert"};var TCS=Kekule.Widget.DataTable.Components;Kekule.Widget.PageNavigator=Class.create(Kekule.Widget.ButtonGroup,{CLASS_NAME:"Kekule.Widget.PageNavigator",initProperties:function(){this.defineProp("components",{dataType:DataType.ARRAY}),this.defineProp("firstIndex",{dataType:DataType.INT}),this.defineProp("lastIndex",{dataType:DataType.INT}),this.defineProp("currIndex",{dataType:DataType.INT}),this.defineProp("dataPager",{dataType:"Kekule.Widget.DataPager",setter:function(value){var old=this.getDataPager();old!==value&&(this.setPropStoreFieldValue("dataPager",value),this.dataPagerChanged(value,old))}})},initPropValues:function($super){$super(),this.setShowText(!0),this.setShowGlyph(!0),this.setFirstIndex(1),this.reactFirstBind=this.reactFirst.bind(this),this.reactLastBind=this.reactLast.bind(this),this.reactPrevBind=this.reactPrev.bind(this),this.reactNextBind=this.reactNext.bind(this),this.reactPageInputChangeBind=this.reactPageInputChange.bind(this)},doObjectChange:function($super,modifiedPropNames){$super(modifiedPropNames),Kekule.ArrayUtils.intersect(modifiedPropNames,["firstIndex","lastIndex","currIndex"]).length&&this.updateChildComponent(),modifiedPropNames.indexOf("currIndex")>=0&&this.invokeEvent("pageChange",{currIndex:this.getCurrIndex()})},doGetWidgetClassName:function($super){return $super()+" "+CNS.PAGENAVIGATOR},doCreateSubElements:function(doc,rootElem){return this.recreateChildContent(doc,rootElem)},getDefaultComponents:function(){return[PNC.FIRST,PNC.PREV,PNC.PAGESELECTOR,PNC.NEXT,PNC.LAST]},recreateChildContent:function(){for(var comps=this.getComponents()||this.getDefaultComponents(),widgetDefs=[],i=0,l=comps.length;i<l;++i){var comp=comps[i];if(DataType.isObjectValue(comp))widgetDefs.push(comp);else{var def=this.getDefaultComponentDefinitionHash(comp);def&&widgetDefs.push(def)}}this.setChildDefs(widgetDefs),this.updateChildComponent()},getDefaultComponentDefinitionHash:function(compName){var result;return result=compName===PNC.FIRST?{widget:"Kekule.Widget.Button",htmlClass:CNS.PAGENAVIGATOR_FIRST,text:Kekule.$L("WidgetTexts.CAPTION_FIRST_PAGE"),hint:Kekule.$L("WidgetTexts.HINT_FIRST_PAGE"),"#execute":this.reactFirstBind}:compName===PNC.LAST?{widget:"Kekule.Widget.Button",htmlClass:CNS.PAGENAVIGATOR_LAST,text:Kekule.$L("WidgetTexts.CAPTION_LAST_PAGE"),hint:Kekule.$L("WidgetTexts.HINT_LAST_PAGE"),"#execute":this.reactLastBind}:compName===PNC.PREV?{widget:"Kekule.Widget.Button",htmlClass:CNS.PAGENAVIGATOR_PREV,text:Kekule.$L("WidgetTexts.CAPTION_PREV_PAGE"),hint:Kekule.$L("WidgetTexts.HINT_PREV_PAGE"),"#execute":this.reactPrevBind}:compName===PNC.NEXT?{widget:"Kekule.Widget.Button",htmlClass:CNS.PAGENAVIGATOR_NEXT,text:Kekule.$L("WidgetTexts.CAPTION_NEXT_PAGE"),hint:Kekule.$L("WidgetTexts.HINT_NEXT_PAGE"),"#execute":this.reactNextBind}:compName===PNC.PAGEINPUT?{widget:"Kekule.Widget.TextBox",htmlClass:[CNS.PAGENAVIGATOR_PAGEINPUT,CNS.PAGENAVIGATOR_PAGEINDEXER],hint:Kekule.$L("WidgetTexts.HINT_CURR_PAGE"),"#valueChange":this.reactPageInputChangeBind}:compName===PNC.PAGESELECTOR?{widget:"Kekule.Widget.SelectBox",htmlClass:[CNS.PAGENAVIGATOR_PAGESELECTOR,CNS.PAGENAVIGATOR_PAGEINDEXER],hint:Kekule.$L("WidgetTexts.HINT_CURR_PAGE"),"#valueChange":this.reactPageInputChangeBind}:null,result&&(result.internalName=compName),result},getComponent:function(compName){return this.getChildWidgetByInternalName(compName)},setChildComponentEnabled:function(compName,enabled){var w=this.getComponent(compName);w&&w.setEnabled(enabled)},updateChildComponent:function(){var firstIndex=this.getFirstIndex()||0,lastIndex=this.getLastIndex()||0,currIndex=this.getCurrIndex()||0,isFirst=currIndex<=firstIndex,isLast=currIndex>=lastIndex;this.setChildComponentEnabled(PNC.FIRST,!isFirst),this.setChildComponentEnabled(PNC.PREV,!isFirst),this.setChildComponentEnabled(PNC.NEXT,!isLast),this.setChildComponentEnabled(PNC.LAST,!isLast),this.setChildComponentEnabled(PNC.PAGEINPUT,lastIndex>firstIndex),this.setChildComponentEnabled(PNC.PAGESELECTOR,lastIndex>firstIndex);var pageInput=this.getComponent(PNC.PAGEINPUT);pageInput&&pageInput.setValue(currIndex);var pageSelector=this.getComponent(PNC.PAGESELECTOR);if(pageSelector){for(var items=[],i=firstIndex;i<=lastIndex;++i)items.push({value:i});pageSelector.setItems(items),pageSelector.setValue(currIndex)}},dataPagerChanged:function(newPager,oldPager){oldPager&&(oldPager.removeEventListener("dataFetched",this.reactPagerFetched,this),newPager.removeEventListener("pageCountChange",this.reactPagerPageCountChange,this)),newPager&&(newPager.addEventListener("dataFetched",this.reactPagerFetched,this),newPager.addEventListener("pageCountChange",this.reactPagerPageCountChange,this),this.updatePageDetails(newPager),this.setCurrIndex(newPager.getCurrPageIndex()+this.getFirstIndex()))},reactPagerFetched:function(e){this.setCurrIndex(e.pageIndex+this.getFirstIndex())},reactPagerPageCountChange:function(e){this.updatePageDetails(this.getDataPager())},updatePageDetails:function(pager){var firstIndex=this.getFirstIndex();this.setLastIndex(pager.getPageCount()+firstIndex-1)},requestChangeCurrIndex:function(newIndex){var pager=this.getDataPager();pager?pager.switchToPage(newIndex-this.getFirstIndex()):this.setCurrIndex(newIndex)},reactFirst:function(e){this.requestChangeCurrIndex(this.getFirstIndex()||0)},reactLast:function(e){this.requestChangeCurrIndex(this.getLastIndex()||0)},reactPrev:function(e){var firstIndex=this.getFirstIndex()||0,currIndex=this.getCurrIndex()||0;this.requestChangeCurrIndex(Math.max(currIndex-1,firstIndex))},reactNext:function(e){var lastIndex=this.getLastIndex()||0,currIndex=this.getCurrIndex()||0;this.requestChangeCurrIndex(Math.min(currIndex+1,lastIndex))},reactPageInputChange:function(e){var value=e.target.getValue();"string"==typeof value&&(value=parseInt(value));var firstIndex=this.getFirstIndex()||0,lastIndex=this.getLastIndex()||0;value>=firstIndex&&value<=lastIndex?this.requestChangeCurrIndex(value):Kekule.error(Kekule.$L("ErrorMsg.PAGE_INDEX_OUTOF_RANGE"))}}),Kekule.Widget.PageNavigator.Components={FIRST:"first",LAST:"last",PREV:"prev",NEXT:"next",PAGEINPUT:"pageInput",PAGESELECTOR:"pageSelector"};var PNC=Kekule.Widget.PageNavigator.Components;return Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,DataType=(__webpack_require__(0).ClassEx,__webpack_require__(0).ObjectEx,__webpack_require__(0).DataType);module.exports=function(Kekule){var CNS=(Kekule.HtmlElementUtils,Kekule.Widget.HtmlClassNames);return Kekule.Widget.HtmlClassNames=Object.extend(Kekule.Widget.HtmlClassNames,{SYSMSGGROUP:"K-SysMsgGroup"}),Kekule.Widget.SysMsgGroup=Class.create(Kekule.Widget.MsgGroup,{CLASS_NAME:"Kekule.Widget.SysMsgGroup",initialize:function($super,parentOrElementOrDocument){$super(parentOrElementOrDocument)},initPropValues:function($super){$super(),this.setMaxMsgCount(6)},doGetWidgetClassName:function($super){return $super()+" "+CNS.SYSMSGGROUP}}),Kekule.Widget.ExceptionHandler=Class.create(Kekule.ExceptionHandler,{CLASS_NAME:"Kekule.Widget.ExceptionHandler",initProperties:function(){this.defineProp("document",{dataType:DataType.OBJECT,serializable:!1,getter:function(){return this.getPropStoreFieldValue("document")||document}}),this.defineProp("sysMsgGroup",{dataType:"Kekule.Widget.SysMsgGroup",serializable:!1,setter:null,getter:function(){var result=this.getPropStoreFieldValue("sysMsgGroup");return result||(result=new Kekule.Widget.SysMsgGroup(this.getDocument()),result.appendToElem(this.getDocument().body),this.setPropStoreFieldValue("sysMsgGroup",result)),result}})},throwException:function($super,e,exceptionLevel){var EL=Kekule.ExceptionLevel,MT=Kekule.Widget.MsgType;exceptionLevel||(exceptionLevel=EL.ERROR);var msg;if(msg="string"==typeof e?e:e.message){var msgType=exceptionLevel!==EL.ERROR&&exceptionLevel?exceptionLevel===EL.WARNING?MT.WARNING:exceptionLevel===EL.NOTE?MT.INFO:MT.NORMAL:MT.ERROR;this.getSysMsgGroup().addMessage(msg,msgType)}return $super(e,exceptionLevel)}}),Kekule.ClassUtils.makeSingleton(Kekule.Widget.ExceptionHandler),Kekule.X.domReady(function(){Kekule.exceptionHandler=Kekule.Widget.ExceptionHandler.getInstance()}),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,DataType=(__webpack_require__(0).ClassEx,__webpack_require__(0).ObjectEx,__webpack_require__(0).DataType);module.exports=function(Kekule){var CCNS=Kekule.Widget.HtmlClassNames;return Kekule.Widget.HtmlClassNames=Object.extend(Kekule.Widget.HtmlClassNames,{OPER_HISTORY_TREE_VIEW:"K-OperHistory-TreeView"}),Kekule.Widget.OperHistoryTreeView=Class.create(Kekule.Widget.TreeView,{CLASS_NAME:"Kekule.Widget.OperHistoryTreeView",initialize:function($super,parentOrElementOrDocument,operHistory){$super(parentOrElementOrDocument),this.setPropStoreFieldValue("objMap",new Kekule.MapEx(!0)),this.setEnableLiveUpdate(!0),this.setEnableMultiSelected(!0),this.setOperHistory(operHistory)},initProperties:function(){this.defineProp("operHistory",{dataType:"Kekule.OperationHistory",serializable:!1,setter:function(value){var oldObj=this.getPropStoreFieldValue("operHistory");this.setPropStoreFieldValue("operHistory",value),this.operHistoryChanged(value,oldObj)}}),this.defineProp("enableLiveUpdate",{dataType:DataType.BOOL}),this.defineProp("objMap",{dataType:"Kekule.MapEx",setter:null,serializable:!1})},doGetWidgetClassName:function($super){return $super()+" "+CCNS.OPER_HISTORY_TREE_VIEW},operHistoryChanged:function(newValue,oldValue){this.clearChildItems(),this.getObjMap().clear(),oldValue&&this._uninstallRootEventHandler(oldValue),newValue&&(this._fillTree(newValue),this._installRootEventHandler(newValue))},_installRootEventHandler:function(root){root.addEventListener("operChange",this.reactOperChange,this)},_uninstallRootEventHandler:function(root){root.removeEventListener("operChange",this.reactOperChange,this)},reactOperChange:function(e){if(this.getEnableLiveUpdate()){e.target;this._fillTree(e.target)}},_fillTree:function(operHistory){if(operHistory){this.clearChildItems(),this._updateTreeItem(this.appendChildItem(),operHistory);var currOper=operHistory.getCurrOperation(),currItem=currOper?this.getObjMap().get(currOper):null;this.select(currItem)}},_getOperChildCount:function(oper){return oper instanceof Kekule.OperationHistory?oper.getOperationCount():oper instanceof Kekule.MacroOperation?oper.getChildCount():0},_getChildOperAt:function(oper,index){return oper instanceof Kekule.OperationHistory?oper.getOperationAt(index):oper instanceof Kekule.MacroOperation?oper.getChildAt(index):null},_updateTreeItem:function(treeItem,oper){var title=this._getOperDisplayTitle(oper),data={text:title,obj:oper};this.setItemData(treeItem,data),this.getObjMap().set(oper,treeItem);for(var oldChildItemCount=this.getChildItemCount(treeItem),l=this._getOperChildCount(oper),i=0;i<l;++i){var childItem,child=this._getChildOperAt(oper,i);childItem=i<oldChildItemCount?this.getChildItemAt(treeItem,i):this.appendChildItem(treeItem),this._updateTreeItem(childItem,child)}if(oldChildItemCount>l)for(var i=oldChildItemCount-1;i>=l;--i)this.removeChildItemAt(treeItem,i)},_getOperDisplayTitle:function(oper){var result=oper.getClassName(),target=oper.getTarget?oper.getTarget():null;return target&&target.getId&&(result+="(target: "+target.getId()+")"),result}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,ClassEx=__webpack_require__(0).ClassEx,ObjectEx=__webpack_require__(0).ObjectEx,DataType=__webpack_require__(0).DataType;module.exports=function(Kekule){var AU=Kekule.ArrayUtils;return Kekule.GraphElement=Class.create(ObjectEx,{CLASS_NAME:"Kekule.GraphElement",initialize:function($super){$super(),this._data={}},initProperties:function(){this.defineProp("storedData",{dataType:DataType.HASH,getter:function(){return this._data},setter:function(data){this._data=data||{}}})},getData:function(keyName){return keyName?this._data[keyName]:this._data},setData:function(keyName,value){return keyName&&(this._data[keyName]=value),this},removeData:function(keyName){return this._data[keyName]&&delete this._data[keyName],this}}),Kekule.GraphVertex=Class.create(Kekule.GraphElement,{CLASS_NAME:"Kekule.GraphVertex",initialize:function($super){$super(),this.setPropStoreFieldValue("edges",[])},initProperties:function(){this.defineProp("edges",{dataType:DataType.ARRAY,serializable:!1,setter:null})},getEdgeCount:function(){return this.getEdges().length},getNeighbors:function(){for(var result=[],edges=this.getEdges(),i=0,l=edges.length;i<l;++i){var vs=edges[i].getVertexes();AU.pushUnique(result,AU.exclude(vs,this))}return result},getNeighborOnEdge:function(edge){for(var vs=edge.getVertexes(),i=0,l=vs.length;i<l;++i)if(vs[i]!==this)return vs[i]},getEdgeTo:function(neighborVertex){for(var edges=this.getEdges(),i=0,l=edges.length;i<l;++i){if(edges[i].getVertexes().indexOf(neighborVertex)>=0)return edges[i]}return null},doAppendEdge:function(edge){return Kekule.ArrayUtils.pushUnique(this.getEdges(),edge),this},doRemoveEdge:function(edge){return Kekule.ArrayUtils.remove(this.getEdges(),edge),this},doClearEdges:function(){for(var edges=this.getEdges(),i=edges.length-1;i>=0;--i)this.removeEdge(edges[i]);return this}}),Kekule.GraphEdge=Class.create(Kekule.GraphElement,{CLASS_NAME:"Kekule.GraphEdge",initialize:function($super){$super(),this.setPropStoreFieldValue("vertexes",[])},initProperties:function(){this.defineProp("vertexes",{dataType:DataType.ARRAY,serializable:!1,setter:null})}}),Kekule.GraphTraverseMode={DEPTH_FIRST:0,BREADTH_FIRST:1},Kekule.Graph=Class.create(ObjectEx,{CLASS_NAME:"Kekule.Graph",VISITED_KEY:"__$visited__",initialize:function($super){$super(),this.setPropStoreFieldValue("vertexes",[]),this.setPropStoreFieldValue("edges",[])},initProperties:function(){this.defineProp("vertexes",{dataType:DataType.ARRAY,serializable:!1,setter:null}),this.defineProp("edges",{dataType:DataType.ARRAY,serializable:!1,setter:null})},addVertex:function(vertex){return Kekule.ArrayUtils.pushUnique(this.getVertexes(),vertex),this},newVertex:function(){var result=new Kekule.GraphVertex;return this.addVertex(result),result},removeVertex:function(vertex){if(Kekule.ArrayUtils.remove(this.getVertexes(),vertex))for(var edges=vertex.getEdges(),i=0,l=edges.length;i<l;++i)this.removeEdge(edges[i])},addEdge:function(edge,vertex1,vertex2){return Kekule.ArrayUtils.pushUnique(this.getEdges(),edge)&&(edge.setPropStoreFieldValue("vertexes",[vertex1,vertex2]),vertex1.doAppendEdge(edge),vertex2.doAppendEdge(edge)),this},newEdge:function(vertex1,vertex2){var result=new Kekule.GraphEdge;return this.addEdge(result,vertex1,vertex2),result},removeEdge:function(edge){for(var vertexes=edge.getVertexes(),i=0,l=vertexes.length;i<l;++i){vertexes[i].doRemoveEdge(edge)}return Kekule.ArrayUtils.remove(this.getEdges(),edge),this},traverse:function(callback,mode,startingVertex){for(var result=[],remainingVertexes=AU.clone(this.getVertexes()),i=0,l=remainingVertexes.length;i<l;++i)remainingVertexes[i].setData(this.VISITED_KEY,!1);for(;remainingVertexes.length;){var currVertex,seq={vertexes:[],edges:[]};currVertex=startingVertex&&remainingVertexes.indexOf(startingVertex)>=0?startingVertex:remainingVertexes[0];var partialResult=this._doTravers(callback,mode,currVertex);seq.vertexes=seq.vertexes.concat(partialResult.vertexes),seq.edges=seq.edges.concat(partialResult.edges),remainingVertexes=AU.exclude(remainingVertexes,partialResult.vertexes),result.push(seq)}return result},_doTravers:function(callback,mode,startingVertex){var result={vertexes:[],edges:[]},vertex=startingVertex;vertex.getData(this.VISITED_KEY)||(result.vertexes.push(vertex),vertex.setData(this.VISITED_KEY,!0),callback&&callback(vertex,!1));for(var edges=vertex.getEdges(),unvisitedVertexes=[],breadthFirst=mode===Kekule.GraphTraverseMode.BREADTH_FIRST,i=0,l=edges.length;i<l;++i){var edge=edges[i],neighbor=vertex.getNeighborOnEdge(edge);if(!neighbor.getData(this.VISITED_KEY))if(result.vertexes.push(neighbor),result.edges.push(edge),neighbor.setData(this.VISITED_KEY,!0),callback&&(callback(edge,!0),callback(neighbor,!1)),breadthFirst)unvisitedVertexes.push(neighbor);else{var nextResult=this._doTravers(callback,mode,neighbor);result.vertexes=result.vertexes.concat(nextResult.vertexes),result.edges=result.edges.concat(nextResult.edges)}}if(breadthFirst)for(var i=0,l=unvisitedVertexes.length;i<l;++i){var v=unvisitedVertexes[i],nextResult=this._doTravers(callback,mode,v);result.vertexes=result.vertexes.concat(nextResult.vertexes),result.edges=result.edges.concat(nextResult.edges)}return result}}),Kekule.globalOptions.add("algorithm.molToGraph",{expandSubStructures:!0,ignoreBondedHydrogen:!0}),Kekule.GraphAdaptUtils={ctabToGraph:function(connTab,graph,options){var op=Object.extend(Object.extend({},Kekule.globalOptions.algorithm.molToGraph),options||{}),ctab=connTab,AU=Kekule.ArrayUtils,result=null,expandSub=op.expandSubStructures;if(ctab){for(var nodeFilter=op.nodeFilter||function(node,allConnectors){if(op.nodeClasses){var nc=node.getClass();if(!ClassEx.isOrIsDescendantOfClasses(nc,op.nodeClasses))return!1}if(op.ignoreBondedHydrogen&&node.isHydrogenAtom&&node.isHydrogenAtom()){var linkedConns=node.getLinkedConnectors();if(allConnectors&&(linkedConns=AU.intersect(linkedConns,allConnectors)),linkedConns.length<=1)return!1}return!0},connectorFilter=op.connectorFilter||function(connector,allNodes){if(op.connectorClasses){var cc=connector.getClass();if(!ClassEx.isOrIsDescendantOfClasses(cc,op.connectorClasses))return!1}return!(connector.getBondType&&op.bondTypes&&op.bondTypes.indexOf(connector.getBondType())<0)},result=graph||new Kekule.Graph,connectors=expandSub?ctab.getAllContainingConnectors():ctab.getConnectors(),nodes=expandSub?ctab.getLeafNodes():ctab.getNodes(),addedNodes=[],vertexMap=new Kekule.MapEx,i=0,l=connectors.length;i<l;++i){var connector=connectors[i];if(connectorFilter(connector))for(var connNodes=[],connectedObjs=expandSub?connector.getConnectedObjs():connector.getConnectedSiblings(),j=0,k=connectedObjs.length;j<k;++j){var connObj=connectedObjs[j];if(nodes.indexOf(connObj)>=0&&(nodeFilter(connObj,connectors)?connNodes.push(connObj):AU.pushUnique(addedNodes,connObj),connNodes.length>=2)){for(var newNodes=AU.exclude(connNodes,addedNodes),ii=0,ll=newNodes.length;ii<ll;++ii){var v=result.newVertex();v.setData("object",newNodes[ii]),vertexMap.set(newNodes[ii],v)}var e=result.newEdge(vertexMap.get(connNodes[0]),vertexMap.get(connNodes[1]));e.setData("object",connector),AU.pushUnique(addedNodes,connNodes);break}}}for(var remainingNodes=AU.exclude(nodes,addedNodes),i=0,l=remainingNodes.length;i<l;++i){var node=remainingNodes[i];if(nodeFilter(node,connectors)){var v=result.newVertex();v.setData("object",node)}}vertexMap.finalize()}return result},molToGraph:function(mol,graph,options){Kekule.ArrayUtils;if(!mol||!mol.hasCtab())return null;var ctab=mol.getCtab();return ctab?Kekule.GraphAdaptUtils.ctabToGraph(ctab,graph,options):null},chemObjToGraph:function(obj,graph,options){for(var mols=Kekule.ChemStructureUtils.getAllStructFragments(obj,!0),result=graph||new Kekule.Graph,i=0,l=mols.length;i<l;++i)Kekule.GraphAdaptUtils.molToGraph(mols[i],result,options);return result}},Kekule.GraphAlgorithmUtils={SEQ_KEY:"__$seq__",RESD_DEGREE_KEY:"__$resdDegree__",VISIT_EDGE_DEGREE_KEY:"__$visitedEdgeDegree__",TYPE_KEY:"__$type__",TYPE_CYCLE:"cycle",TYPE_BRIDGE:"bridge",VISITED_KEY:"__$visited",createSpanningTrees:function(graph,traverseMode){return graph.traverse(null,traverseMode)},findCycleBlocks:function(graph){for(var result=[],U=Kekule.GraphAlgorithmUtils,SEQ_KEY=U.SEQ_KEY,RESD_DEGREE_KEY=U.RESD_DEGREE_KEY,VISIT_EDGE_DEGREE_KEY=U.VISIT_EDGE_DEGREE_KEY,TYPE_KEY=U.TYPE_KEY,TYPE_CYCLE=U.TYPE_CYCLE,TYPE_BRIDGE=U.TYPE_BRIDGE,edges=graph.getEdges(),i=0,l=edges.length;i<l;++i)edges[i].removeData(SEQ_KEY);for(var vertexes=graph.getVertexes(),i=0,l=vertexes.length;i<l;++i)vertexes[i].removeData(TYPE_KEY);for(var edgeIndex=1,vertexIndex=1,vertexSeqs=[],edgeSeqs=[],startingVertexSeqs=[],i=(graph.traverse(function(obj,isEdge){isEdge?(obj.setData(SEQ_KEY,edgeIndex),edgeSeqs.push(obj),++edgeIndex):(obj.setData(SEQ_KEY,vertexIndex),++vertexIndex,vertexSeqs.push(obj))}),0),l=vertexSeqs.length;i<l;++i){var obj=vertexSeqs[i],connEdges=obj.getEdges();obj.setData(RESD_DEGREE_KEY,connEdges.length);for(var visitedDegree=0,j=0,k=connEdges.length;j<k;++j){connEdges[j].getData(SEQ_KEY)&&++visitedDegree}obj.setData(VISIT_EDGE_DEGREE_KEY,visitedDegree),visitedDegree<connEdges.length&&startingVertexSeqs.push(obj)}for(var getFirstVisitedEdge=function(vertex,ignoreStartingVertex){if(ignoreStartingVertex&&vertex.getData(SEQ_KEY)<=1)return null;for(var edges=vertex.getEdges(),firstEdge=null,firstEdgeSeq=null,i=0,l=edges.length;i<l;++i){var seq=edges[i].getData(SEQ_KEY);seq&&(firstEdgeSeq?seq<firstEdgeSeq&&(firstEdge=edges[i],firstEdgeSeq=seq):(firstEdge=edges[i],firstEdgeSeq=seq))}return firstEdge||null},getUnvisitedEdge=function(vertex){for(var edges=vertex.getEdges(),i=0,l=edges.length;i<l;++i)if(!edges[i].getData(SEQ_KEY)&&!edges[i].getData(TYPE_KEY))return edges[i];return null},currVertex=vertexSeqs.shift();currVertex;){if(currVertex.getData(TYPE_KEY));else{var visitedEdgeDegree=currVertex.getData(VISIT_EDGE_DEGREE_KEY);if(currVertex.getData(RESD_DEGREE_KEY)-visitedEdgeDegree>0){var partResult=function markCyclePath(startingVertex){var cycleVertexes=[],cycleEdges=[],visitedEdgeDegree=startingVertex.getData(VISIT_EDGE_DEGREE_KEY),resdEdgeDegree=startingVertex.getData(RESD_DEGREE_KEY),delta=resdEdgeDegree-visitedEdgeDegree;if(delta>0){startingVertex.setData(TYPE_KEY,TYPE_CYCLE),AU.pushUnique(cycleVertexes,startingVertex);for(var i=0;i<delta;++i){startingVertex.setData(RESD_DEGREE_KEY,resdEdgeDegree+1);var edge=getUnvisitedEdge(startingVertex);if(edge){edge.setData(TYPE_KEY,TYPE_CYCLE),AU.pushUnique(cycleEdges,edge);var nextVertex=startingVertex.getNeighborOnEdge(edge);for(nextVertex.setData(RESD_DEGREE_KEY,nextVertex.getData(RESD_DEGREE_KEY)+1),nextVertex.setData(TYPE_KEY,TYPE_CYCLE),AU.pushUnique(cycleVertexes,nextVertex);;){var visitedEdgeDegree=nextVertex.getData(VISIT_EDGE_DEGREE_KEY),resdEdgeDegree=nextVertex.getData(RESD_DEGREE_KEY);if(visitedEdgeDegree<resdEdgeDegree){var childResult=markCyclePath(nextVertex);AU.pushUnique(cycleVertexes,childResult.vertexes),AU.pushUnique(cycleEdges,childResult.edges)}var firstEdge=getFirstVisitedEdge(nextVertex,!1);if(!firstEdge)break;firstEdge.setData(TYPE_KEY,TYPE_CYCLE),AU.pushUnique(cycleEdges,firstEdge);var v=nextVertex.getNeighborOnEdge(firstEdge);if(v.getData(TYPE_KEY))break;v.setData(TYPE_KEY,TYPE_CYCLE),AU.pushUnique(cycleVertexes,v),nextVertex=v}}}}return{vertexes:cycleVertexes,edges:cycleEdges}}(currVertex);result.push(partResult)}else{currVertex.setData(TYPE_KEY,TYPE_BRIDGE);var firstEdge=getFirstVisitedEdge(currVertex,!0);firstEdge&&firstEdge.setData(TYPE_KEY,TYPE_BRIDGE)}}currVertex=vertexSeqs.shift()}return result},findEndChains:function(graph){for(var AU=Kekule.ArrayUtils,result={vertexes:[],edges:[]},remainingVertexes=AU.clone(graph.getVertexes()),initEndVertexes=[],i=0,l=remainingVertexes.length;i<l;++i){var v=remainingVertexes[i],degree=v.getEdgeCount();v.setData("__$currConnectivity__",degree),degree<=1&&initEndVertexes.push(v)}if(initEndVertexes.length){var currVertex=initEndVertexes.pop();for(AU.remove(remainingVertexes,currVertex),result.vertexes.push(currVertex);remainingVertexes.length;){var flag=!1,edges=AU.exclude(currVertex.getEdges(),result.edges);if(edges.length){result.edges=result.edges.concat(edges);var nextVertex=currVertex.getNeighborOnEdge(edges[0]),degree=nextVertex.getData("__$currConnectivity__")-1;nextVertex.setData("__$currConnectivity__",degree),degree<=1&&(currVertex=nextVertex,AU.remove(remainingVertexes,currVertex),result.vertexes.push(currVertex),flag=!0)}if(!flag){if(!initEndVertexes.length)break;var currVertex=initEndVertexes.pop();AU.remove(remainingVertexes,currVertex),result.vertexes.push(currVertex)}}}return result},removeEndChains:function(graph){for(var chainElems=Kekule.GraphAlgorithmUtils.findEndChains(graph),i=0,l=chainElems.vertexes.length;i<l;++i)graph.removeVertex(chainElems.vertexes[i]);return chainElems},findBridgeChains:function(graph){for(var vs=graph.getVertexes(),es=graph.getEdges(),cycleParts=Kekule.GraphAlgorithmUtils.findCycleBlocks(graph),i=0,l=cycleParts.length;i<l;++i)vs=AU.exclude(vs,cycleParts[i].vertexes),es=AU.exclude(es,cycleParts[i].edges);return{vertexes:vs,edges:es}},removeBridgeChains:function(graph){for(var bridgeElems=Kekule.GraphAlgorithmUtils.findBridgeChains(graph),i=0,l=bridgeElems.vertexes.length;i<l;++i)graph.removeVertex(bridgeElems.vertexes[i]);return bridgeElems},findAllRings:function(graphOrCycleBlock){var cycleParts,U=Kekule.GraphAlgorithmUtils,result=[];cycleParts=graphOrCycleBlock instanceof Kekule.Graph?U.findCycleBlocks(graphOrCycleBlock):[graphOrCycleBlock];for(var isPathEndWithVertex=function(pathVector,vertex){var vertexes=pathVector.vertexes,l=vertexes.length;return l&&(vertexes[0]===vertex||vertexes[l-1]===vertex)},isFakePathMerging=function(pv1,pv2,commonVertex){var v1=AU.clone(pv1.vertexes),v2=AU.clone(pv2.vertexes);return v1.shift(),v1.pop(),v2.shift(),v2.pop(),AU.intersect(v1,v2).length>=1},mergePathVectors=function(pv1,pv2,commonVertex){var pvs1=AU.clone(pv1.vertexes),pvs2=AU.clone(pv2.vertexes),pes1=AU.clone(pv1.edges),pes2=AU.clone(pv2.edges);pvs1[0]===commonVertex&&(pvs1.reverse(),pes1.reverse()),pvs2[pvs2.length-1]===commonVertex&&(pvs2.reverse(),pes2.reverse()),pvs1.pop();var mergedVs=pvs1.concat(pvs2),mergedEs=pes1.concat(pes2);return{vertexCount:pv1.vertexCount+pv2.vertexCount-1,vertexes:mergedVs,edges:mergedEs}},i=0,l=cycleParts.length;i<l;++i){var part=cycleParts[i];if(function(cycleBlock){return cycleBlock.vertexes.length===cycleBlock.edges.length}(part))result.push({vertexes:AU.clone(part.vertexes),edges:AU.clone(part.edges)});else for(var ringVectors=function(cycleBlock){for(var result=[],sv=AU.clone(cycleBlock.vertexes),partEdges=cycleBlock.edges,i=0,l=sv.length;i<l;++i){var v=sv[i],es=AU.intersect(v.getEdges(),partEdges);v.setData("__$vertextPartDegree__",es.length)}sv.sort(function(a,b){return a.getData("__$vertextPartDegree__")-b.getData("__$vertextPartDegree__")});for(var sp=[],i=0,l=cycleBlock.edges.length;i<l;++i){var edge=cycleBlock.edges[i],edgeVertexes=edge.getVertexes();sp.push({vertexCount:edgeVertexes.length,vertexes:[edgeVertexes[0],edgeVertexes[1]],edges:[edge]})}for(;sv.length;)for(var vx=sv.shift(),px=null,i=sp.length-1;i>=0;--i){var p=sp[i];if(isPathEndWithVertex(p,vx)){px=p;for(var j=i-1;j>=0;--j){var p=sp[j];if(isPathEndWithVertex(p,vx)&&!isFakePathMerging(px,p)){var newp=mergePathVectors(px,p,vx),newpVs=newp.vertexes;newpVs[0]===newpVs[newpVs.length-1]?(newpVs.pop(),result.push(newp)):sp.push(newp)}}sp.splice(i,1)}}return result}(part),j=0,k=ringVectors.length;j<k;++j){var ringVector=ringVectors[j];result.push({vertexes:AU.clone(ringVector.vertexes),edges:AU.clone(ringVector.edges)})}}return result},findSSSR:function(graphOrCycleBlock,allRings){var cycleParts,U=Kekule.GraphAlgorithmUtils,result=[];graphOrCycleBlock instanceof Kekule.Graph?(cycleParts=U.findCycleBlocks(graphOrCycleBlock),allRings=null):cycleParts=[graphOrCycleBlock];for(var i=0,l=cycleParts.length;i<l;++i){var part=cycleParts[i],rings=function(cycleBlock,allRings){var result=[],SSSRCount=cycleBlock.edges.length-cycleBlock.vertexes.length+1;if(SSSRCount<=0)return[];var rings=allRings?AU.clone(allRings):U.findAllRings(cycleBlock);rings.sort(function(a,b){return a.vertexes.length-b.vertexes.length});var ringVector,addRingToResult=function(ring){result.push(ring)},foundVectors=[],RU=Kekule.RingVectorUtils;RU.prepareConvertRingToVector(cycleBlock);var ring=rings.shift();for(addRingToResult(ring),ringVector=RU.convertRingToVector(ring,cycleBlock),foundVectors.push(ringVector);result.length<SSSRCount&&rings.length;)ring=rings.shift(),ringVector=RU.convertRingToVector(ring,cycleBlock),RU.isLinearDependant(ringVector,foundVectors)||(foundVectors.push(ringVector),addRingToResult(ring));return result}(part,allRings);result=result.concat(rings)}return result},analysisRings:function(graphOrCycleBlock){var cycleParts,U=Kekule.GraphAlgorithmUtils,result=[];cycleParts=graphOrCycleBlock instanceof Kekule.Graph?U.findCycleBlocks(graphOrCycleBlock):[graphOrCycleBlock];for(var i=0,l=cycleParts.length;i<l;++i){var part=cycleParts[i],allRings=U.findAllRings(part),sssrRings=U.findSSSR(part,allRings);result.push({vertexes:part.vertexes,edges:part.edges,allRings:allRings,sssrRings:sssrRings})}return result}},Kekule.RingVectorUtils={MAX_INT_BITNUM:23,EDGE_INDEX_FIELD:"__$index__",prepareConvertRingToVector:function(cycleBlock){for(var edges=cycleBlock.edges,i=0,l=edges.length;i<l;++i)edges[i][Kekule.RingVectorUtils.EDGE_INDEX_FIELD]=i},convertRingToVector:function(ring,cycleBlock){var result,edgeCount=cycleBlock.edges.length,ringEdges=ring.edges;if(edgeCount<Kekule.RingVectorUtils.MAX_INT_BITNUM){result=0;for(var i=0,l=ringEdges.length;i<l;++i){var edge=ringEdges[i],index=edge[Kekule.RingVectorUtils.EDGE_INDEX_FIELD];result+=1<<index}}else{result=[];for(var i=0,l=ringEdges.length;i<l;++i){var edge=ringEdges[i],index=edge[Kekule.RingVectorUtils.EDGE_INDEX_FIELD];result[index]=!0}}return result},vectorNotNull:function(vector){if(DataType.isSimpleValue(vector))return!!vector;for(var i=0;i<vector.length;++i)if(vector[i])return!0;return!1},getVectorLength:function(vector){return DataType.isSimpleValue(vector)?vector.toString(2).length:vector.length},ringVectorAnd:function(v1,v2){if(DataType.isSimpleValue(v1))return v1&v2;for(var result=[],l=Math.min(v1.length,v2.length),i=0;i<l;++i)result[i]=v1[i]&&v2[i];return result},ringVectorAndAll:function(vectors){if(vectors.length<2)return vectors[0];for(var RU=Kekule.RingVectorUtils,result=RU.ringVectorAnd(vectors[0],vectors[1]),i=2,l=vectors.length;i<l;++i)result=RU.ringVectorAnd(result,vectors[i]);return result},ringVectorOr:function(v1,v2){if(DataType.isSimpleValue(v1))return v1|v2;for(var result=[],l=Math.max(v1.length,v2.length),i=0;i<l;++i)result[i]=v1[i]||v2[i];return result},ringVectorOrAll:function(vectors){if(vectors.length<2)return vectors[0];for(var RU=Kekule.RingVectorUtils,result=RU.ringVectorOr(vectors[0],vectors[1]),i=2,l=vectors.length;i<l;++i)result=RU.ringVectorOr(result,vectors[i]);return result},ringVectorXor:function(v1,v2){if(DataType.isSimpleValue(v1))return v1^v2;for(var result=[],l=Math.max(v1.length,v2.length),i=0;i<l;++i)result[i]=!!(v1[i]^v2[i]);return result},ringVectorXorAll:function(vectors){if(vectors.length<2)return vectors[0];for(var RU=Kekule.RingVectorUtils,result=RU.ringVectorXor(vectors[0],vectors[1]),i=2,l=vectors.length;i<l;++i)result=RU.ringVectorXor(result,vectors[i]);return result},ringVectorNot:function(vector){if(DataType.isSimpleValue(vector))return~vector;for(var result=[],i=0,l=vector.length;i<l;++i)result[i]=!vector[i];return result},isLinearDependant:function(vector,baseVectors){var RU=Kekule.RingVectorUtils,allEdgeVector=RU.ringVectorOrAll(baseVectors),newEdges=RU.ringVectorAnd(vector,RU.ringVectorNot(allEdgeVector));if(RU.vectorNotNull(newEdges))return!1;for(var baseVectorCount=baseVectors.length,incVectorIndexValueOnPos=function incVectorIndexValueOnPos(indexes,pos,maxVectorCount){var oldValue=indexes[pos],value=++oldValue;if(value>=maxVectorCount-pos)return!(pos>=indexes.length-1)&&incVectorIndexValueOnPos(indexes,pos+1,maxVectorCount);indexes[pos]=value;for(var nv=value,i=pos-1;i>=0;--i)++nv,indexes[i]=nv;return!0},count=0,result=!1,vCount=2;vCount<=baseVectorCount;++vCount){for(var vectorIndexes=function(indexCount){for(var result=[],i=0;i<indexCount;++i)result[i]=indexCount-i-1;return result}(vCount);;){++count;for(var selVectors=[],i=0,l=vectorIndexes.length;i<l;++i)selVectors.push(baseVectors[vectorIndexes[i]]);var combineVector=RU.ringVectorXorAll(selVectors);if(!RU.vectorNotNull(RU.ringVectorXor(combineVector,vector))){result=!0;break}if(!function(indexes,maxVectorCount){return incVectorIndexValueOnPos(indexes,0,maxVectorCount)}(vectorIndexes,baseVectorCount)){result=!1;break}}if(result)break}return result},isLinearDependant_wrong:null},Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,ObjectEx=__webpack_require__(0).ObjectEx,DataType=__webpack_require__(0).DataType;module.exports=function(Kekule){return Kekule.ChemStructObjContainer=Class.create(ObjectEx,{CLASS_NAME:"Kekule.ChemStructObjContainer",initialize:function($super){$super(),this.setPropStoreFieldValue("nodes",[]),this.setPropStoreFieldValue("connectors",[])},initProperties:function(){this.defineProp("nodes",{dataType:DataType.ARRAY,serializable:!1,setter:null}),this.defineProp("connectors",{dataType:DataType.ARRAY,serializable:!1,setter:null})},clear:function(){return this.getNodes().length=0,this.getConnectors().length=0,this},add:function(obj){var a=null;return obj instanceof Kekule.ChemStructureConnector?a=this.getConnectors():obj instanceof Kekule.ChemStructureNode&&(a=this.getNodes()),a?Kekule.ArrayUtils.pushUnique(a,obj):Kekule.error(Kekule.$L("ErrorMsg.CANNOT_ADD_NON_NODE_NOR_CONNECTOR_TO_STRUCT_CONTAINER")),this},remove:function(obj){var a=null;return a=obj instanceof Kekule.ChemStructureConnector?this.getConnectors():this.getNodes(),Kekule.ArrayUtils.remove(a,obj),this}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,ClassEx=__webpack_require__(0).ClassEx,ObjectEx=__webpack_require__(0).ObjectEx,DataType=__webpack_require__(0).DataType;module.exports=function(Kekule){var AU=Kekule.ArrayUtils;return Kekule.CanonicalizationIndexer=Class.create(ObjectEx,{CLASS_NAME:"Kekule.CanonicalizationIndexer",initialize:function($super){$super()},execute:function(ctabOrStructFragment){var ctab=ctabOrStructFragment instanceof Kekule.StructureFragment?ctabOrStructFragment.getCtab():ctabOrStructFragment;return ctab?this.doExecute(ctab):null},doExecute:function(ctab){}}),Kekule.CanonicalizationNodeSorter=Class.create(ObjectEx,{CLASS_NAME:"Kekule.CanonicalizationNodeSorter",execute:function(ctabOrStructFragment){var ctab=ctabOrStructFragment instanceof Kekule.StructureFragment?ctabOrStructFragment.getCtab():ctabOrStructFragment;return ctab?this.doExecute(ctab,ctab.getNodes()):null},doExecute:function(ctab){}}),Kekule.CanonicalizationConnectorSorter=Class.create(ObjectEx,{CLASS_NAME:"Kekule.CanonicalizationConnectorSorter",execute:function(ctabOrStructFragment){var ctab=ctabOrStructFragment instanceof Kekule.StructureFragment?ctabOrStructFragment.getCtab():ctabOrStructFragment;return ctab?this.doExecute(ctab,ctab.getConnectors()):null},doExecute:function(ctab){}}),Kekule.CanonicalizationConnectorConnectedObjsSorter=Class.create(ObjectEx,{CLASS_NAME:"Kekule.CanonicalizationConnectorConnectedObjsSorter",execute:function(ctabOrStructFragment){var ctab=ctabOrStructFragment instanceof Kekule.StructureFragment?ctabOrStructFragment.getCtab():ctabOrStructFragment;return ctab?this.doExecute(ctab,ctab.getConnectors()):null},doExecute:function(ctab){}}),Kekule.CanonicalizationCustomExecutor=Class.create(ObjectEx,{CLASS_NAME:"Kekule.CanonicalizationCustomExecutor",execute:function(ctab){var newCtab=this.doExecute(ctab);return newCtab&&this.doCanonicalizeConnectedObjs(newCtab),newCtab},doExecute:function(ctab){return ctab},doCanonicalizeConnectedObjs:function(ctab){if(ctab){(new Kekule.CanonicalizationGeneralConnectorConnectedObjsSorter).execute(ctab)}}}),Kekule.CanonicalizationGeneralConnectorSorter=Class.create(Kekule.CanonicalizationConnectorSorter,{CLASS_NAME:"Kekule.CanonicalizationGeneralConnectorSorter",doExecute:function(ctab){var connectedNodeSeqMap=new Kekule.MapEx;try{for(var i=0,l=ctab.getConnectorCount();i<l;++i){for(var conn=ctab.getConnectorAt(i),connectedObjs=conn.getConnectedObjs(),mvalues=[],j=0,k=connectedObjs.length;j<k;++j){var mvalue,obj=connectedObjs[j];obj instanceof Kekule.ChemStructureNode&&(mvalue=ctab.indexOfNode(obj),mvalues.push(mvalue))}mvalues.sort(function(a,b){return a-b}),connectedNodeSeqMap.set(conn,mvalues)}ctab.sortConnectors(function(c1,c2){var mvalues1=connectedNodeSeqMap.get(c1),mvalues2=connectedNodeSeqMap.get(c2),result=AU.compare(mvalues1,mvalues2);return 0===result&&(result=-(c1.getConnectedObjCount()-c2.getConnectedObjCount())),result})}finally{connectedNodeSeqMap.finalize()}}}),Kekule.CanonicalizationGeneralConnectorConnectedObjsSorter=Class.create(Kekule.CanonicalizationConnectorConnectedObjsSorter,{CLASS_NAME:"Kekule.CanonicalizationGeneralConnectorConnectedObjsSorter",doExecute:function(ctab){var connectedNodeSeqMap=new Kekule.MapEx;try{for(var i=0,l=ctab.getConnectorCount();i<l;++i){var conn=ctab.getConnectorAt(i);if(2===conn.getConnectedObjCount()){var o1=conn.getConnectedObjAt(0),o2=conn.getConnectedObjAt(1),cIndex1=ctab.indexOfChild(o1),cIndex2=ctab.indexOfChild(o2);(cIndex1<0||cIndex2<0)&&(cIndex1=(o1.getCanonicalizationIndex?-o1.getCanonicalizationIndex():0)||0,cIndex2=(o2.getCanonicalizationIndex?-o2.getCanonicalizationIndex():0)||0),cIndex1>cIndex2&&conn.reverseConnectedObjOrder()}else conn.sortConnectedObjs(function(o1,o2){var cIndex1=ctab.indexOfChild(o1),cIndex2=ctab.indexOfChild(o2);(cIndex1<0||cIndex2<0)&&(cIndex1=(o1.getCanonicalizationIndex?-o1.getCanonicalizationIndex():0)||0,cIndex2=(o2.getCanonicalizationIndex?-o2.getCanonicalizationIndex():0)||0,result=(cIndex1||0)-(cIndex2||0));var result=ctab.indexOfChild(o1)-ctab.indexOfChild(o2);return result})}}finally{connectedNodeSeqMap.finalize()}}}),Kekule.CanonicalizationMorganIndexer=Class.create(Kekule.CanonicalizationIndexer,{CLASS_NAME:"Kekule.CanonicalizationMorganIndexer",doExecute:function(ctab){var graph=Kekule.GraphAdaptUtils.ctabToGraph(ctab,null,{expandSubStructures:!0,ignoreBondedHydrogen:!0});if(!graph)return null;var ecResult=this._calcGraphFinalECs(graph),ecMapping=ecResult.ecMapping,sortedNodes=this._sortNodeByEcMapping(graph,ecMapping);this._setCanonicalizationIndexToNodeGroups(sortedNodes)},_sortNodeByEcMapping:function(graph,ecMapping){for(var sortedNodes1st=[],vertexGroups=this._groupVertexesByEcValue(graph,ecMapping),i=0,l=vertexGroups.length;i<l;++i){var vertexGroup=vertexGroups[i],nodes=this._vertexesToNodes(vertexGroup.vertexes);if(1===nodes.length)AU.pushUnique(sortedNodes1st,nodes[0]);else{var groups=this._groupNodesWithSameEcValue(nodes,sortedNodes1st);sortedNodes1st=sortedNodes1st.concat(groups)}}for(var sortedNodes=[],handledNodes=[],i=0,l=sortedNodes1st.length;i<l;++i){var currNodes=sortedNodes1st[i];if(AU.isArray(currNodes)){var _getSortLevel=function(node){for(var i=0,l=sortedNodes.length;i<l;++i)if(AU.isArray(sortedNodes[i])){if(sortedNodes[i].indexOf(node)>=0)return i}else if(sortedNodes[i]===node)return i;return-1},_getSortLevels=function(centerNode,connectedNodes){for(var result=[],i=0,l=connectedNodes.length;i<l;++i)result.push(_getSortLevel(connectedNodes[i]));return result.sort(function(a,b){return b-a}),result},_compFunc=function(n1,n2){var connNodes1=AU.intersect(n1.getLinkedObjs(),handledNodes),connNodes2=AU.intersect(n2.getLinkedObjs(),handledNodes),result=connNodes1.length-connNodes2.length;if(0===result&&connNodes1.length>0){var sortLevels1=_getSortLevels(0,connNodes1),sortLevels2=_getSortLevels(0,connNodes2);result=AU.compare(sortLevels1,sortLevels2)}return result},groupedCurrNodes=AU.group(currNodes,_compFunc);sortedNodes=sortedNodes.concat(groupedCurrNodes)}else sortedNodes.push([currNodes]),handledNodes.push(currNodes);handledNodes=handledNodes.concat(currNodes)}for(var result=[],i=0,l=sortedNodes.length;i<l;++i){var currNodes=sortedNodes[i];AU.isArray(currNodes)&&1===currNodes.length?result.push(currNodes[0]):result.push(currNodes)}return result},_setCanonicalizationIndexToNodeGroups:function(sortedNodes){for(var i=0,l=sortedNodes.length;i<l;++i){var vIndex=i+1,item=sortedNodes[i];if(AU.isArray(item))for(var j=0,k=item.length;j<k;++j)item[j].setCanonicalizationIndex(vIndex);else item.setCanonicalizationIndex(vIndex)}},_vertexesToNodes:function(vertexes){for(var result=[],i=0,l=vertexes.length;i<l;++i){var node=vertexes[i].getData("object");result.push(node)}return result},_processECs:function(graph,newECMapping,oldECMapping,isInitialRun){for(var ecValues=[],vertexes=graph.getVertexes(),i=0,l=vertexes.length;i<l;++i){var vertex=vertexes[i],sum=0;if(isInitialRun)sum=vertex.getEdgeCount();else for(var neighbors=vertex.getNeighbors(),j=0,k=neighbors.length;j<k;++j)sum+=oldECMapping.get(neighbors[j])||0;newECMapping.set(vertex,sum),AU.pushUnique(ecValues,sum)}return ecValues.length},_calcGraphFinalECs:function(graph){var ecMappings=[new Kekule.MapEx,new Kekule.MapEx];try{for(var index=0,currECMapping=ecMappings[0],oldECMapping=ecMappings[0],ecMemberCount=this._processECs(graph,currECMapping,oldECMapping,!0),oldEcMemberCount=0;ecMemberCount>oldEcMemberCount;)oldEcMemberCount=ecMemberCount,++index,oldECMapping=currECMapping,currECMapping=ecMappings[index%2],ecMemberCount=this._processECs(graph,currECMapping,oldECMapping)}finally{currECMapping.finalize()}return{ecMapping:oldECMapping,ecCount:oldEcMemberCount}},_groupVertexesByEcValue:function(graph,ecMapping){for(var groups=[],ecValues=[],vertexes=graph.getVertexes(),i=0,l=vertexes.length;i<l;++i){var v=vertexes[i],ecValue=ecMapping.get(v);AU.pushUnique(ecValues,ecValue),groups[ecValue]||(groups[ecValue]=[]),groups[ecValue].push(v)}ecValues.sort(function(a,b){return a-b});for(var result=[],i=0,l=ecValues.length;i<l;++i){var vs=groups[ecValues[i]];result.push({ecValue:ecValues[i],vertexes:vs,vertexesCount:vs.length})}return result},_groupNodesWithSameEcValue:function(nodes,sortedNodes){var formAssocCompareArray=function(node,sortedNodes){for(var linkedObjs=node.getLinkedObjs(),linkedNodes=AU.intersect(linkedObjs,sortedNodes),ncompareValues=[],ccompareValues=[],i=0,l=linkedNodes.length;i<l;++i){var n=linkedNodes[i];ncompareValues.push(sortedNodes.indexOf(n))}ncompareValues.sort(function(a,b){return a-b});for(var i=0,l=ncompareValues.length;i<l;++i){var n=sortedNodes[ncompareValues[i]],conn=node.getConnectorTo(n),connOrder=conn.getBondOrder?conn.getBondOrder()||0:0;ccompareValues.push(connOrder)}return{nodeOrders:ncompareValues,connectorOrders:ccompareValues}};return AU.group(nodes,function(n1,n2){var result=n1.compareStructure(n2);if(0===result){var compareValue1=formAssocCompareArray(n1,sortedNodes),compareValue2=formAssocCompareArray(n2,sortedNodes);result=AU.compare(compareValue1.nodeOrders,compareValue2.nodeOrders),0===result&&(result=AU.compare(compareValue1.connectorOrders,compareValue2.connectorOrders))}return result})}}),Kekule.CanonicalizationMorganNodeSorter=Class.create(Kekule.CanonicalizationNodeSorter,{CLASS_NAME:"Kekule.CanonicalizationMorganNodeSorter",doExecute:function(ctab){var sortedNodes=this._getNodeSortedArray(ctab),sortedNodesLength=sortedNodes.length,self=this;ctab.sortNodes(function(a,b){var indexA=sortedNodes.indexOf(a),indexB=sortedNodes.indexOf(b);indexA<0&&(indexA=sortedNodesLength),indexB<0&&(indexB=sortedNodesLength);var result=indexA-indexB;return 0===result&&indexA===sortedNodesLength&&(result=self._getNeighborNodesMinIndex(a,sortedNodes)-self._getNeighborNodesMinIndex(b,sortedNodes)),result})},_getNeighborNodesMinIndex:function(node,sortedNodes){for(var neighbors=node.getLinkedChemNodes(),result=sortedNodes.length,i=0,l=neighbors.length;i<l;++i){var index=sortedNodes.indexOf(neighbors[i]);index>0&&index<result&&(result=index)}return result},_getNodeSortedArray:function(ctab){var nodeCompareFunc=function(startingNode,n1,n2){var result,cIndex1=n1.getCanonicalizationIndex(),cIndex2=n2.getCanonicalizationIndex();if(0===(result=(cIndex1||-1)-(cIndex2||-1))){if(startingNode){var connector1=startingNode.getConnectorTo(n1),connector2=startingNode.getConnectorTo(n2);result=connector1.compareStructure(connector2)}if(0===result&&n1.hasCoord3D(!0)&&n2.hasCoord3D(!0)){var deltaCoord=Kekule.CoordUtils.substract(n1.getAbsCoord3D(!0),n2.getAbsCoord3D(!0));result=deltaCoord.z||deltaCoord.y||deltaCoord.x}}return result};try{for(var currNode,currNodeIndex,remainingNodes=AU.clone(ctab.getNodes()),i=0,l=remainingNodes.length;i<l;++i){var node=remainingNodes[i];currNode?nodeCompareFunc(null,node,currNode)>0&&(currNode=node,currNodeIndex=i):(currNode=node,currNodeIndex=i)}remainingNodes.splice(currNodeIndex,1);var sortedNodes=[],sortedUnindexedNodes=[];sortedNodes.push(currNode);for(var i=0;i<sortedNodes.length;++i){var currNode=sortedNodes[i];if(0!==i){var vIndex=remainingNodes.indexOf(currNode);vIndex>=0&&(sortedNodes.push(currNode),remainingNodes.splice(vIndex,1))}var neighbors=currNode.getLinkedObjs();if(neighbors=AU.intersect(neighbors,remainingNodes),neighbors.length){neighbors.sort(function(a,b){return nodeCompareFunc(currNode,a,b)});for(var j=neighbors.length-1;j>=0;--j){var neighbor=neighbors[j];if((vIndex=remainingNodes.indexOf(neighbor))>=0){var canoIndex=neighbor.getCanonicalizationIndex();Kekule.ObjUtils.isUnset(canoIndex)?sortedUnindexedNodes.push(neighbor):sortedNodes.push(neighbor),remainingNodes.splice(vIndex,1)}}}}return sortedNodes=sortedNodes.concat(sortedUnindexedNodes)}finally{}}}),Kekule.Canonicalizer=Class.create({CLASS_NAME:"Kekule.Canonicalizer",initialize:function(){this._executorClasses={},this._executorInstances={},this._defExecutorId=null},registerExecutor:function(id,executorClasses,asDefault){AU.isArray(executorClasses)?this._executorClasses[id]={indexer:executorClasses[0],nodeSorter:executorClasses[1],connectorSorter:executorClasses[2]||Kekule.CanonicalizationGeneralConnectorSorter,connectorConnectedObjsSorter:executorClasses[3]||Kekule.CanonicalizationGeneralConnectorConnectedObjsSorter}:this._executorClasses[id]={customExecutor:executorClasses},asDefault&&(this._defExecutorId=id)},getExecutor:function(id){if(!id)return null;var result=this._executorInstances[id];if(!result){var eClasses=this._executorClasses[id];eClasses&&(result=eClasses.customExecutor?{customExecutor:new eClasses.customExecutor}:{indexer:new eClasses.indexer,nodeSorter:new eClasses.nodeSorter,connectorSorter:new eClasses.connectorSorter,connectorConnectedObjsSorter:new eClasses.connectorConnectedObjsSorter},this._executorInstances[id]=result)}return result},canonicalize:function(structFragmentOrCtab,executorId){structFragmentOrCtab.beginUpdate();try{var id=executorId||this._defExecutorId,executor=this.getExecutor(id);if(executor){var struct=structFragmentOrCtab instanceof Kekule.StructureFragment?structFragmentOrCtab:null,canoInfo=struct.getCanonicalizationInfo();if(canoInfo&&canoInfo.id===id)return structFragmentOrCtab;var ctab=structFragmentOrCtab.getCtab?structFragmentOrCtab.getCtab():structFragmentOrCtab;if(!ctab)return;var structFragment=ctab.getParent();executor.customExecutor?executor.customExecutor.execute(ctab):this._doDefaultCanonicalize(executor,ctab,structFragment),struct.setCanonicalizationInfo({id:id})}else Kekule.error(Kekule.$L("ErrorMsg.REGISTERED_CANONICALIZATION_EXECUTOR_NOT_FOUND"))}finally{structFragmentOrCtab.endUpdate()}return structFragmentOrCtab},_doDefaultCanonicalize:function(executor,ctab,structFragment){var flatternedStruct=structFragment.getFlattenedShadowFragment(),ctab=flatternedStruct.getCtab();ctab.beginUpdate();try{executor.indexer.execute(ctab),executor.nodeSorter.execute(ctab),executor.connectorSorter.execute(ctab),executor.connectorConnectedObjsSorter.execute(ctab)}finally{ctab.endUpdate()}if(!structFragment.getFlattenedShadowOnSelf()){structFragment.beginUpdate();try{this._sortSrcStructBaseOnShadow(structFragment,flatternedStruct),executor.connectorConnectedObjsSorter.execute(structFragment.getCtab())}finally{structFragment.endUpdate()}}},_sortSrcStructBaseOnShadow:function(srcStruct,shadowStruct){var getFlatternIndex=function(obj){return obj.__$flattern_index$__},setFlatternIndex=function(obj,value){obj.__$flattern_index$__=value};srcStruct.cascadeOnChildren(function(obj){obj&&setFlatternIndex(obj,null)});var shadowChildCount=shadowStruct.getChildCount();srcStruct.beginUpdate();try{for(var i=0;i<shadowChildCount;++i){var childObj=shadowStruct.getChildAt(i);if(childObj instanceof Kekule.ChemStructureNode){var shadowNode=childObj,srcNode=srcStruct.getFlatternedShadowSourceObj(shadowNode);srcNode&&(!function _setSrcNodeFlatternIndex(rootStruct,node,index,allChildrenCount){setFlatternIndex(node,index);var parent=node.getParent();if(parent.isChildOf(srcStruct)){var pIndex=getFlatternIndex(parent),newPIndex=index+allChildrenCount;(Kekule.ObjUtils.isUnset(pIndex)||pIndex>newPIndex)&&_setSrcNodeFlatternIndex(rootStruct,parent,newPIndex,allChildrenCount)}}(srcStruct,srcNode,i,shadowChildCount),srcNode.setCanonicalizationIndex(shadowNode.getCanonicalizationIndex()))}else if(childObj instanceof Kekule.ChemStructureConnector){var shadowConn=childObj,srcConn=srcStruct.getFlatternedShadowSourceObj(shadowConn);setFlatternIndex(srcConn,i)}}!function _sortSrcStructure(struct){struct.beginUpdate();try{struct.sortNodes(function(a,b){return getFlatternIndex(a)-getFlatternIndex(b)}),struct.sortConnectors(function(a,b){return getFlatternIndex(a)-getFlatternIndex(b)});for(var i=0,l=struct.getNodeCount();i<l;++i){var node=struct.getNodeAt(i);node instanceof Kekule.StructureFragment&&_sortSrcStructure(node)}}finally{struct.endUpdate()}}(srcStruct)}finally{srcStruct.endUpdate()}}}),Kekule.ClassUtils.makeSingleton(Kekule.Canonicalizer),Kekule.canonicalizer=Kekule.Canonicalizer.getInstance(),ClassEx.extend(Kekule.ChemObject,{canonicalize:function(canonicalizerId){for(var mols=Kekule.ChemStructureUtils.getAllStructFragments(this,!0),i=0,l=mols.length;i<l;++i)mols[i].canonicalize(canonicalizerId);return this}}),ClassEx.extend(Kekule.StructureConnectionTable,{canonicalize:function(canonicalizerId){return Kekule.canonicalizer.canonicalize(this),this}}),ClassEx.extend(Kekule.StructureFragment,{canonicalize:function(canonicalizerId){return Kekule.canonicalizer.canonicalize(this),this}}),ClassEx.defineProp(Kekule.ChemStructureObject,"canonicalizationIndex",{dataType:DataType.INT,serializable:!1}),Kekule.canonicalizer.registerExecutor("morgan",[Kekule.CanonicalizationMorganIndexer,Kekule.CanonicalizationMorganNodeSorter],!0),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,ClassEx=__webpack_require__(0).ClassEx,DataType=__webpack_require__(0).DataType;module.exports=function(Kekule){var GU=Kekule.GraphAlgorithmUtils,CU=Kekule.ChemStructureUtils,BT=Kekule.BondType;return Kekule.globalOptions.add("algorithm.ringSearch",{bondTypes:[BT.COVALENT]}),ClassEx.extend(Kekule.StructureConnectionTable,{getGraph:function(options){var op=Class.create(options);return op.connectorClasses=[Kekule.Bond],Kekule.GraphAdaptUtils.ctabToGraph(this,null,op)},extractStructObjs:function(graphBlock){for(var edges=graphBlock.edges,vertexes=graphBlock.vertexes,nodes=[],connectors=[],i=0,l=vertexes.length;i<l;++i){var obj=vertexes[i].getData("object");obj instanceof Kekule.BaseStructureNode&&nodes.push(obj)}for(var i=0,l=edges.length;i<l;++i){var obj=edges[i].getData("object");obj instanceof Kekule.BaseStructureConnector&&connectors.push(obj)}return{nodes:nodes,connectors:connectors}},findCycleBlocks:function(){var ringInfo=this.getRingInfo();return ringInfo?ringInfo.cycleBlocks:[]},findAllRings:function(){var ringInfos=this.getRingInfo(),result=[];if(ringInfos)for(var i=0,l=ringInfos.cycleBlocks.length;i<l;++i){var b=ringInfos.cycleBlocks[i],rings=b.allRings;result=result.concat(rings)}return result},findSSSR:function(){var ringInfos=this.getRingInfo(),result=[];if(ringInfos)for(var i=0,l=ringInfos.cycleBlocks.length;i<l;++i){var b=ringInfos.cycleBlocks[i],rings=b.sssrRings;result=result.concat(rings)}return result},analysisRings:function(options){var ops=Object.extend(Object.extend({},Kekule.globalOptions.algorithm.ringSearch),options),g=this.getGraph(ops);if(g){for(var resultBlocks=[],gBlocks=GU.analysisRings(g),i=0,l=gBlocks.length;i<l;++i){var gBlock=gBlocks[i],cBlock=this.extractStructObjs(gBlock);resultBlocks.push(cBlock),cBlock.allRings=[];for(var gAllRings=gBlock.allRings,j=0,k=gAllRings.length;j<k;++j){var gRing=gAllRings[j],cRing=this.extractStructObjs(gRing);cBlock.allRings.push(cRing)}cBlock.sssrRings=[];for(var gSSSR=gBlock.sssrRings,j=0,k=gSSSR.length;j<k;++j){var gRing=gSSSR[j],index=gAllRings.indexOf(gRing);if(index>=0)cBlock.sssrRings.push(cBlock.allRings[index]);else{var cRing=this.extractStructObjs(gRing);cBlock.sssrRings.push(cRing)}}}return{cycleBlocks:resultBlocks}}return null}}),ClassEx.defineProps(Kekule.StructureConnectionTable,[{name:"ringInfo",dataType:DataType.HASH,serializable:!1,getter:function(doNotCreate){var result=this.getPropStoreFieldValue("ringInfo");return result||doNotCreate||(result=this.analysisRings(),this.setPropStoreFieldValue("ringInfo",result)),result},setter:null}]),ClassEx.extendMethod(Kekule.StructureConnectionTable,"objectChange",function($origin,modifiedPropNames){return this.setPropStoreFieldValue("ringInfo",null),$origin(modifiedPropNames)}),ClassEx.extend(Kekule.StructureFragment,{findCycleBlocks:function(){return this.hasCtab()?this.getCtab().findCycleBlocks():null},findAllRings:function(){return this.hasCtab()?this.getCtab().findAllRings():null},findSSSR:function(){return this.hasCtab()?this.getCtab().findSSSR():null},analysisRings:function(options){return this.hasCtab()?this.getCtab().analysisRings(options):null}}),ClassEx.defineProps(Kekule.StructureFragment,[{name:"ringInfo",dataType:DataType.HASH,serializable:!1,getter:function(doNotCreate){return this.hasCtab()?this.getCtab().getRingInfo(doNotCreate):null},setter:null}]),ClassEx.extendMethod(Kekule.StructureFragment,"_copyAdditionalFragmentInfo",function($origin,shadowFragment,srcToShadowMap,shadowToSrcMap){var mapRing=function(srcRing){for(var result={nodes:[],connectors:[]},i=0,l=srcRing.nodes.length;i<l;++i){var shadowObj=srcToShadowMap.get(srcRing.nodes[i]);shadowObj&&result.nodes.push(shadowObj)}for(var i=0,l=srcRing.connectors.length;i<l;++i){var shadowObj=srcToShadowMap.get(srcRing.connectors[i]);shadowObj&&result.connectors.push(shadowObj)}return result};$origin(shadowFragment,srcToShadowMap,shadowToSrcMap);var sourceFragment=this,srcRingInfo=sourceFragment.getRingInfo(!0);if(srcRingInfo){for(var shadowRingInfo={cycleBlocks:[]},i=0,l=srcRingInfo.cycleBlocks.length;i<l;++i){for(var srcBlock=srcRingInfo.cycleBlocks[i],shadowBlock={allRings:[],sssrRings:[]},srcAllRings=srcBlock.allRings,j=0,k=srcAllRings.length;j<k;++j){var srcRing=srcAllRings[j];shadowBlock.allRings.push(mapRing(srcRing))}for(var srcSSSRs=srcBlock.sssrRings,j=0,k=srcSSSRs.length;j<k;++j){var srcRing=srcSSSRs[j];shadowBlock.sssrRings.push(mapRing(srcRing))}shadowRingInfo.cycleBlocks.push(shadowBlock)}shadowFragment.setPropStoreFieldValue("ringInfo",shadowRingInfo)}}),ClassEx.extend(Kekule.ChemStructureObject,{getBelongedSssrRings:function(){var result=[],parent=this.getParent();if(parent&&parent.findSSSR)for(var sssrRings=parent.findSSSR(),i=0,l=sssrRings.length;i<l;++i){var ring=sssrRings[i];this instanceof Kekule.BaseStructureConnector?ring.connectors.indexOf(this)>=0&&result.push(ring):ring.nodes.indexOf(this)>=0&&result.push(ring)}return result},getBelongedRingMinSize:function(){var result=null,rings=this.getBelongedSssrRings();if(rings&&rings.length)for(var i=0,l=rings.length;i<l;++i){var ring=rings[i],nodeCount=ring.nodes.length;result=result?Math.min(result,nodeCount):nodeCount}return result}}),ClassEx.extend(Kekule.ChemObject,{findCycleBlocks:function(){for(var ss=CU.getAllStructFragments(this),result=[],i=0,l=ss.length;i<l;++i){var blocks=ss[i].findCycleBlocks();blocks&&(result=result.concat(blocks))}return result.length?result:null},findAllRings:function(){for(var ss=CU.getAllStructFragments(this),result=[],i=0,l=ss.length;i<l;++i){var rings=ss[i].findAllRings();rings&&(result=result.concat(rings))}return result.length?result:null},findSSSR:function(){for(var ss=CU.getAllStructFragments(this),result=[],i=0,l=ss.length;i<l;++i){var rings=ss[i].findSSSR();rings&&(result=result.concat(rings))}return result.length?result:null},analysisRings:function(options){for(var ss=CU.getAllStructFragments(this),result=[],i=0,l=ss.length;i<l;++i){var blocks=ss[i].analysisRings(options);blocks&&(result=result.concat(blocks))}return result.length?result:null}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var ClassEx=__webpack_require__(0).ClassEx;module.exports=function(Kekule){var AU=Kekule.ArrayUtils,BT=Kekule.BondType,BO=Kekule.BondOrder,CU=Kekule.ChemStructureUtils,PElectronCountMarkers={SATURATED_CARBON:-1,ESTER_CARBON:-16,SULFONE_OR_SULFOXIDE_SULPHUR:-32};return Kekule.AromaticTypes={NONAROMATIC:0,EXPLICIT_AROMATIC:1,ANTIAROMATIC:-1,UNCERTAIN:64},ClassEx.extend(Kekule.Atom,{isSulfoneOrSulfoxideSulphur:function(){if("S"===this.getSymbol()){var mbonds=this.getLinkedMultipleBonds();if(mbonds.length>=1)for(var i=0,l=mbonds;i<l;++i)for(var connObjs=this.getLinkedObjsOnConnector(mbonds[i]),j=0,k=connObjs.length;j<k;++j){var obj=connObjs[j];if(obj instanceof Kekule.Atom&&"O"===obj.getSymbol())return!0}}return!1},isEsterCarbon:function(){if("C"===this.getSymbol())for(var foundDoubleO,foundSingleO,bonds=this.getLinkedBonds(BT.COVALENT),i=0,l=bonds.length;i<l;++i){var b=bonds[i];if(b.isBondBetween("C","O")&&(foundSingleO||b.getBondOrder()!==BO.SINGLE?foundDoubleO||b.getBondOrder()!==BO.DOUBLE||(foundDoubleO=!0):foundSingleO=!0,foundSingleO&&foundDoubleO))return!0}return!1}}),Kekule.globalOptions.add("algorithm.aromaticRingsPerception",{allowUncertainRings:!1}),ClassEx.extend(Kekule.StructureConnectionTable,{_getPossibleRingNodePiElectronCounts:function(node,ctabRingNodes,ctabRingConnectors){var _getRingElementPiElectronCount=function(elemSymbol,node,ctabRingNodes,ctabRingConnectors){var symbol=elemSymbol,isotope=Kekule.IsotopeFactory.getIsotope(symbol),charge=node.getCharge();if(!node.isSaturated||!node.isSaturated()){var multipleBonds=node.getLinkedMultipleBonds();if(node.isSulfoneOrSulfoxideSulphur&&node.isSulfoneOrSulfoxideSulphur())return PElectronCountMarkers.SULFONE_OR_SULFOXIDE_SULPHUR;if(node.isEsterCarbon&&node.isEsterCarbon())return PElectronCountMarkers.ESTER_CARBON;var multipleBondsOnRing=AU.intersect(multipleBonds,ctabRingConnectors),multipleBondOnRingCount=multipleBondsOnRing.length;if(multipleBondOnRingCount)return 2===multipleBondOnRingCount&&multipleBondsOnRing[0].getBondOrder()===Kekule.BondOrder.EXPLICIT_AROMATIC?isotope.isHetero&&isotope.isHetero()?[1,2]:1:1===multipleBondOnRingCount&&multipleBondsOnRing[0].getBondOrder()===Kekule.BondOrder.DOUBLE?1:0;if("C"===symbol){for(var hasHetero=!1,i=0,l=multipleBonds.length;i<l;++i){var bond=multipleBonds[i],linkedNodes=node.getLinkedObjsOnConnector(bond);if(1===linkedNodes.length&&linkedNodes[0].getPrimaryIsotope().isHetero()){hasHetero=!0;break}}return hasHetero?0:1}return 1}return node.getRadical&&node.getRadical()===Kekule.RadicalOrder.DOUBLET?1:isotope.isHetero()?2:"C"===symbol?charge>0?0:charge<0?2:PElectronCountMarkers.SATURATED_CARBON:0};if(node instanceof Kekule.VariableAtom){var isotopeIds=node.getAllowedIsotopeIds();if(isotopeIds&&isotopeIds.length){for(var result=[],i=0,l=isotopeIds.length;i<l;++i){var isoId=isotopeIds[i],symbol=Kekule.IsotopeFactory.getIsotopeById(isoId).getSymbol();AU.pushUnique(result,_getRingElementPiElectronCount(symbol,node,0,ctabRingConnectors))}return result}return[0,1,2]}var isotope=node.getPrimaryIsotope();if(isotope){var symbol=isotope.getSymbol();return _getRingElementPiElectronCount(symbol,node,0,ctabRingConnectors)}return[0,1,2]},_checkRingAromaticType:function(ring,piECountMap){if(piECountMap){for(var nodes=ring.nodes,nodeECounts=[],currIndexes=[],totalCount=nodes.length,i=0;i<totalCount;++i){var n=nodes[i],counts=piECountMap.get(n);AU.isArray(counts)?nodeECounts.push(counts):nodeECounts.push([counts]),currIndexes[i]=0}var incIndexesOnPos=function incIndexesOnPos(pos,indexes){var currValue=indexes[pos],newValue=++currValue;return newValue>=nodeECounts[pos].length?!(pos>=indexes.length-1)&&(indexes[pos]=0,incIndexesOnPos(pos+1,indexes)):(indexes[pos]=newValue,!0)},lastResult=null,tryCount=0;do{++tryCount;for(var eSum=0,currResult=null,i=0;i<totalCount;++i){var eCount=nodeECounts[i][currIndexes[i]];if(!(eCount>=0)){currResult=Kekule.AromaticTypes.NONAROMATIC;break}eSum+=eCount}if(null===currResult){var times=parseInt(eSum/4),mod=eSum%4;times<=5&&2!==times&&(2===mod?currResult=Kekule.AromaticTypes.EXPLICIT_AROMATIC:mod||(currResult=Kekule.AromaticTypes.ANTIAROMATIC))}if(null!==lastResult){if(lastResult!==currResult&&(lastResult===Kekule.AromaticTypes.EXPLICIT_AROMATIC||currResult===Kekule.AromaticTypes.EXPLICIT_AROMATIC))return Kekule.AromaticTypes.UNCERTAIN}else lastResult=currResult}while(function(indexes){return incIndexesOnPos(0,indexes)}(currIndexes));return lastResult}},_calcPossibleRingNodesPElectronCounts:function(piECountMap,rings,refRings){var allNodes=[],allConnectors=[],targetNodes=[];if(refRings){for(var i=0,l=refRings.length;i<l;++i)AU.pushUnique(allNodes,refRings[i].nodes),AU.pushUnique(allConnectors,refRings[i].connectors);for(var i=0,l=rings.length;i<l;++i)AU.pushUnique(targetNodes,rings[i].nodes)}else{for(var i=0,l=rings.length;i<l;++i)AU.pushUnique(allNodes,rings[i].nodes),AU.pushUnique(allConnectors,rings[i].connectors);targetNodes=allNodes}for(var i=0,l=targetNodes.length;i<l;++i){var node=targetNodes[i],eCounts=this._getPossibleRingNodePiElectronCounts(node,allNodes,allConnectors);piECountMap.set(node,eCounts)}},perceiveAromaticRings:function(allowUncertainRings,candidateRings){Kekule.ObjUtils.isUnset(allowUncertainRings)&&(allowUncertainRings=Kekule.globalOptions.algorithm.aromaticRingsPerception.allowUncertainRings);var rings=candidateRings||this.findSSSR(),result=[],piECountMap=new Kekule.MapEx;try{this._calcPossibleRingNodesPElectronCounts(piECountMap,rings,null);for(var i=0,l=rings.length;i<l;++i){var ring=rings[i],aromaticType=this._checkRingAromaticType(ring,piECountMap);(aromaticType===Kekule.AromaticTypes.EXPLICIT_AROMATIC||allowUncertainRings&&aromaticType===Kekule.AromaticTypes.UNCERTAIN)&&result.push(ring)}return result}finally{piECountMap.finalize()}},findAromaticRings:function(allowUncertainRings,candidateRings){return this.perceiveAromaticRings(allowUncertainRings,candidateRings)},getRingAromaticType:function(ring,refRings){refRings||(refRings=this.findSSSR());var result,piECountMap=new Kekule.MapEx;try{this._calcPossibleRingNodesPElectronCounts(piECountMap,[ring],refRings),result=this._checkRingAromaticType(ring,piECountMap)}finally{piECountMap.finalize()}return result}}),ClassEx.extend(Kekule.StructureFragment,{perceiveAromaticRings:function(allowUncertainRings,candidateRings){var result=this.hasCtab()?this.getCtab().perceiveAromaticRings(allowUncertainRings,candidateRings):[];return this.setAromaticRings(result||[]),result},findAromaticRings:function(allowUncertainRings,candidateRings){return this.perceiveAromaticRings(allowUncertainRings,candidateRings)},getRingAromaticType:function(ring,refRings){return this.hasCtab()?this.getCtab().getRingAromaticType(ring,refRings):null}}),ClassEx.extend(Kekule.ChemObject,{perceiveAromaticRings:function(allowUncertainRings,candidateRings){for(var ss=CU.getAllStructFragments(this),result=[],i=0,l=ss.length;i<l;++i){var rings=ss[i].perceiveAromaticRings(allowUncertainRings,candidateRings);rings&&(result=result.concat(rings))}return result.length?result:null},findAromaticRings:function(allowUncertainRings,candidateRings){return this.perceiveAromaticRings(allowUncertainRings,candidateRings)}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var ClassEx=__webpack_require__(0).ClassEx;module.exports=function(Kekule){return Kekule.globalOptions.add("algorithm.molStandardization",{unmarshalSubFragments:!0,doCanonicalization:!0,doAromaticPerception:!0,doStereoPerception:!0}),Kekule.MolStandardizer={standardize:function(structureFragment,options){var defOptions=Object.extend({},Kekule.globalOptions.algorithm.molStandardization),mol=structureFragment,op=Object.extend(defOptions,options);return op.unmarshalSubFragments&&mol.unmarshalAllSubFragments(!0),op.doCanonicalization&&Kekule.canonicalizer.canonicalize(mol,op.canonicalizerExecutorId||null),op.doAromaticPerception&&mol.perceiveAromaticRings(),op.doStereoPerception&&mol.perceiveStereos(null,!0),mol}},Object.extend(Kekule.ChemStructureUtils,{compareStructFragment:function(mol1,mol2,compareOptions){var m1=mol1.clone(!1),m2=mol2.clone(!1);m1=Kekule.MolStandardizer.standardize(m1),m2=Kekule.MolStandardizer.standardize(m2);var op=Object.create(compareOptions||{});return op.doStandardize=!1,m1.compareStructure(m2,op)},isSameStructure:function(mol1,mol2,compareOptions){return 0===Kekule.ChemStructureUtils.compareStructFragment(mol1,mol2,compareOptions)}}),ClassEx.extend(Kekule.ChemObject,{standardize:function(options){for(var mols=Kekule.ChemStructureUtils.getAllStructFragments(this,!0),i=0,l=mols.length;i<l;++i)mols[i].standardize(options);return this}}),ClassEx.extend(Kekule.StructureFragment,{standardize:function(options){return Kekule.MolStandardizer.standardize(this,options)},isSameStructureWith:function(target,compareOptions){return Kekule.ChemStructureUtils.isSameStructure(this,target,compareOptions)}}),ClassEx.extendMethod(Kekule.StructureFragment,"compare",function($origin,targetObj,options){return options.method===Kekule.ComparisonMethod.CHEM_STRUCTURE&&!1!==options.doStandardize&&targetObj instanceof Kekule.StructureFragment?Kekule.ChemStructureUtils.compareStructFragment(this,targetObj,options):$origin(targetObj,options)}),Kekule}},function(module,exports,__webpack_require__){"use strict";var ClassEx=__webpack_require__(0).ClassEx;module.exports=function(Kekule){var AU=Kekule.ArrayUtils;Kekule.globalOptions.add("algorithm.structureSearch",{doStandardize:!0}),Kekule.ChemStructureSearcher={findSubStructure:function(subStructure,sourceMol,options){var op=Object.extend(Object.extend({},Kekule.globalOptions.algorithm.structureSearch),options);if(op.exactMatch){return!!sourceMol.isSameStructureWith(subStructure,op)&&[].concat(sourceMol.getNodes()).concat(sourceMol.getConnectors())}op=Object.extend({level:Kekule.StructureComparationLevel.CONSTITUTION,compareLinkedConnectorCount:!1,compareHydrogenCount:!1,compareConnectedObjCount:!1},op),op=Kekule.ObjComparer.getStructureComparisonDetailOptions(op);var objCompareOptions=op;if(op.doStandardize){var standardizeOps={unmarshalSubFragments:!1,doCanonicalization:!0,doAromaticPerception:!0};op.compareStereo||(standardizeOps.doCanonicalization=!1),subStructure.standardize(standardizeOps),sourceMol.standardize(standardizeOps)}for(var flattenedSrcMol=sourceMol.getFlattenedShadowFragment(!0),flattenedSubStruct=subStructure.getFlattenedShadowFragment(!0),targetStartingNode=flattenedSubStruct.getNonHydrogenNodes()[0],srcNodes=flattenedSrcMol.getNonHydrogenNodes(),srcNodeCount=srcNodes.length,srcIndex=0,initComparedTargetObjs=[],initComparedSrcObjs=[],compareResult=!1;!compareResult&&srcIndex<srcNodeCount;)compareResult=SM._compareNode(targetStartingNode,srcNodes[srcIndex],initComparedTargetObjs,initComparedSrcObjs,objCompareOptions),++srcIndex;if(compareResult){var matchedObjs=AU.toUnique(compareResult);return sourceMol.getFlatternedShadowSourceObjs(matchedObjs)}return!1},_addToComparedObjs:function(obj,comparedObjs,tag){comparedObjs.push(obj)},_removeFromComparedObjs:function(obj,comparedObjs,tag){var index=comparedObjs.indexOf(obj);comparedObjs.length=index},_isSameMappedObj:function(targetObj,srcObj,comparedTargetObjs,comparedSrcObjs){var srcIndex=comparedSrcObjs.indexOf(srcObj),targetIndex=comparedTargetObjs.indexOf(targetObj);return srcIndex>=0&&srcIndex===targetIndex},_compareComparedNeighbors:function(targetObjs,srcObjs,allComparedTargetObjs,allComparedSrcObjs){if(targetObjs.length>srcObjs.length)return!1;for(var targetIndexes=[],i=0,l=targetObjs.length;i<l;++i)targetIndexes.push(allComparedTargetObjs.indexOf(targetObjs[i]));for(var srcIndexes=[],i=0,l=srcObjs.length;i<l;++i)srcIndexes.push(allComparedSrcObjs.indexOf(srcObjs[i]));for(var i=0,l=targetIndexes.length;i<l;++i)if(srcIndexes.indexOf(targetIndexes[i])<0)return!1;return!0},_compareNode:function(targetNode,srcNode,comparedTargetObjs,comparedSrcObjs,compareOptions){if(0!==targetNode.compareStructure(srcNode,compareOptions))return!1;var targetConnectors=targetNode.getLinkedNonHydrogenConnectors(),srcConnectors=srcNode.getLinkedNonHydrogenConnectors();if(targetConnectors.length>srcConnectors.length)return!1;var dupComparedTargetObjs=AU.clone(comparedTargetObjs),dupComparedSrcObjs=AU.clone(comparedSrcObjs);SM._addToComparedObjs(targetNode,dupComparedTargetObjs,"target"),SM._addToComparedObjs(srcNode,dupComparedSrcObjs,"src");var targetComparedConnectors=AU.intersect(targetConnectors,dupComparedTargetObjs),srcComparedConnectors=AU.intersect(srcConnectors,dupComparedSrcObjs),result=!0;SM._compareComparedNeighbors(targetComparedConnectors,srcComparedConnectors,dupComparedTargetObjs,dupComparedSrcObjs)?(targetConnectors=AU.exclude(targetConnectors,targetComparedConnectors),srcConnectors=AU.exclude(srcConnectors,srcComparedConnectors),targetConnectors.length>srcConnectors.length&&(result=!1)):result=!1;for(var nextComparedObjs=[];result&&targetConnectors.length;){for(var srcConn,compareResult=!1,targetConn=targetConnectors.shift(),srcIndex=0;srcConnectors.length&&!compareResult&&srcIndex<srcConnectors.length;)srcConn=srcConnectors[srcIndex],compareResult=SM._compareConnector(targetConn,srcConn,dupComparedTargetObjs,dupComparedSrcObjs,compareOptions),compareResult&&(nextComparedObjs=nextComparedObjs.concat(compareResult)),++srcIndex;if(!compareResult){result=!1;break}AU.remove(srcConnectors,srcConn)}return result&&(result=[srcNode].concat(nextComparedObjs)),result},_compareConnector:function(targetConn,srcConn,comparedTargetObjs,comparedSrcObjs,compareOptions){if(0!==targetConn.compareStructure(srcConn,compareOptions))return!1;if(targetConn.getConnectedObjCount()>srcConn.getConnectedObjCount())return!1;var dupComparedTargetObjs=AU.clone(comparedTargetObjs),dupComparedSrcObjs=AU.clone(comparedSrcObjs);SM._addToComparedObjs(targetConn,dupComparedTargetObjs,"target"),SM._addToComparedObjs(srcConn,dupComparedSrcObjs,"src");var targetConnectedObjs=AU.clone(targetConn.getConnectedObjs()),srcConnectedObjs=AU.clone(srcConn.getConnectedObjs()),targetComparedObjs=AU.intersect(targetConnectedObjs,dupComparedTargetObjs),srcComparedObjs=AU.intersect(srcConnectedObjs,dupComparedSrcObjs),result=!0;SM._compareComparedNeighbors(targetComparedObjs,srcComparedObjs,dupComparedTargetObjs,dupComparedSrcObjs)?(targetConnectedObjs=AU.exclude(targetConnectedObjs,targetComparedObjs),srcConnectedObjs=AU.exclude(srcConnectedObjs,srcComparedObjs),targetConnectedObjs.length>srcConnectedObjs.length&&(result=!1)):result=!1;for(var nextComparedObjs=[];result&&targetConnectedObjs.length;){for(var srcObj,compareResult=!1,targetObj=targetConnectedObjs.shift(),srcIndex=0;srcConnectedObjs.length&&!compareResult&&srcIndex<srcConnectedObjs.length;)srcObj=srcConnectedObjs[srcIndex],compareResult=srcObj.getClass()===targetObj.getClass()&&(srcObj instanceof Kekule.ChemStructureNode?SM._compareNode(targetObj,srcObj,dupComparedTargetObjs,dupComparedSrcObjs,compareOptions):srcObj instanceof Kekule.ChemStructureConnector&&SM._compareConnector(targetObj,srcObj,dupComparedTargetObjs,dupComparedSrcObjs,compareOptions)),compareResult&&(nextComparedObjs=nextComparedObjs.concat(compareResult)),++srcIndex;if(!compareResult){result=!1;break}AU.remove(srcConnectedObjs,srcObj)}return result&&(result=[srcConn].concat(nextComparedObjs)),result}};var SM=Kekule.ChemStructureSearcher;return ClassEx.extend(Kekule.StructureFragment,{search:function(subStructure,options){return SM.findSubStructure(subStructure,this,options)}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,ClassEx=__webpack_require__(0).ClassEx;module.exports=function(Kekule){var AU=Kekule.ArrayUtils,CU=Kekule.CoordUtils;Kekule.RotationDir={CLOCKWISE:1,ANTICLOCKWISE:-1,UNKNOWN:0};var RD=Kekule.RotationDir;return Kekule.globalOptions.add("algorithm.stereoPerception",{useFlatternedShadow:!0,perceiveStereoConnectors:!0,perceiveChiralNodes:!0,calcParity:!0}),Kekule.MolStereoUtils={FISCHER_PROJECTION_BOND_ALLOWED_ERROR:.08,getDihedralAngleOfNodes:function(n1,n2,n3,n4,coordMode,allowCoordBorrow){Kekule.ObjUtils.isUnset(allowCoordBorrow)&&(allowCoordBorrow=!0),Kekule.ObjUtils.isUnset(coordMode)&&(coordMode=n2.hasCoord3D()?Kekule.CoordMode.COORD3D:Kekule.CoordMode.COORD2D);var getNodeCoord=function(node,centerNode,centerCoord,coordMode,allowCoordBorrow,axisIsDoubleBond){if(coordMode!==Kekule.CoordMode.COORD2D)return node.getAbsCoordOfMode(coordMode,!0);var result=node.getAbsCoordOfMode(coordMode,!0);if(centerNode&&centerCoord){var connector=node.getConnectorTo(centerNode);if(connector.getStereo){var bondStereo=connector.getStereo(),BS=Kekule.BondStereo,wedgeDirs=[BS.UP,BS.UP_INVERTED,BS.DOWN,BS.DOWN_INVERTED];if(wedgeDirs.indexOf(bondStereo)>=0){connector.indexOfConnectedObj(node)-connector.indexOfConnectedObj(centerNode)<0&&(bondStereo=BS.getInvertedDirection(bondStereo));var zFactors=[1,-1,-1,1],distance=CU.getDistance(result,centerCoord);result.z=distance*zFactors[wedgeDirs.indexOf(bondStereo)]}else if([BS.UP_OR_DOWN,BS.UP_OR_DOWN_INVERTED].indexOf(bondStereo)>=0)return null}}return result.z=result.z||0,result},axisBond=n2.getConnectorTo(n3),c2=(axisBond&&axisBond.isDoubleBond&&axisBond.isDoubleBond(),getNodeCoord(n2,null,null,coordMode)),c3=getNodeCoord(n3,null,null,coordMode),c1=getNodeCoord(n1,n2,c2,coordMode),c4=getNodeCoord(n4,n3,c3,coordMode);if(c1&&c2&&c3&&c4){return Kekule.GeometryUtils.getDihedralAngleOfPoints(c1,c2,c3,c4)}return-1},getParityOfNodeSeq:function(n1,n2,n3,n4,coordMode,allowCoordBorrow){var SP=Kekule.StereoParity,angle=Kekule.MolStereoUtils.getDihedralAngleOfNodes(n1,n2,n3,n4,coordMode,allowCoordBorrow);return angle<0?SP.UNKNOWN:angle<2*Math.PI/5||angle>8*Math.PI/5?SP.ODD:angle>3*Math.PI/5&&angle<7*Math.PI/5?SP.EVEN:SP.UNKNOWN},isStereoBond:function(connector){var isUnset=Kekule.ObjUtils.isUnset;if(connector.getBelongedRingMinSize){var ringSize=connector.getBelongedRingMinSize()||0;if(ringSize>0&&ringSize<=10)return!1}var result=!1;if(connector.isDoubleBond&&connector.isDoubleBond()&&2===connector.getConnectedObjCount()){var endNodes=connector.getConnectedChemNodes();if(2===endNodes.length)for(var result=!0,i=0;i<2;++i){var node=endNodes[i],hydroCount=node.getHydrogenCount(),sideObjs=AU.exclude(node.getLinkedChemNodes(),endNodes);if(hydroCount>=2||!sideObjs.length){result=!1;break}if(1===sideObjs.length);else if(2===sideObjs.length&&(isUnset(sideObjs[0].getCanonicalizationIndex())&&isUnset(sideObjs[1].getCanonicalizationIndex())||sideObjs[0].getCanonicalizationIndex()===sideObjs[1].getCanonicalizationIndex())){result=!1;break}}}else result=!1;return result},doFindStereoBonds:function(structFragmentOrCtab,ignoreCanonicalization){var result=[];ignoreCanonicalization||Kekule.canonicalizer.canonicalize(structFragmentOrCtab,"morganEx");for(var i=0,l=structFragmentOrCtab.getConnectorCount();i<l;++i){var conn=structFragmentOrCtab.getConnectorAt(i);Kekule.MolStereoUtils.isStereoBond(conn)&&result.push(conn)}return result},getStereoBondKeyNodes:function(connector){var result=null;if(2===connector.getConnectedObjCount()){var endNodes=connector.getConnectedChemNodes();if(2===endNodes.length){for(var refNodes=[],i=0;i<2;++i){var node=endNodes[i],sideObjs=(node.getHydrogenCount(),AU.exclude(node.getLinkedChemNodes(),endNodes));if(1===sideObjs.length)refNodes.push(sideObjs[0]);else if(2===sideObjs.length){var index1=sideObjs[0].getCanonicalizationIndex(),index2=sideObjs[1].getCanonicalizationIndex();refNodes.push(index2>index1?sideObjs[1]:sideObjs[0])}}result=[refNodes[0],endNodes[0],endNodes[1],refNodes[1]]}}return result},calcStereoBondParity:function(connector,coordMode,ignoreStereoCheck){var SP=Kekule.StereoParity;if(!ignoreStereoCheck&&!Kekule.MolStereoUtils.isStereoBond(connector))return SP.NONE;if(connector.getStereo&&[Kekule.BondStereo.E_OR_Z,Kekule.BondStereo.CIS_OR_TRANS].indexOf(connector.getStereo())>=0)return SP.NONE;var result=SP.UNKNOWN,keyNodes=Kekule.MolStereoUtils.getStereoBondKeyNodes(connector);return keyNodes&&keyNodes.length&&(result=Kekule.MolStereoUtils.getParityOfNodeSeq(keyNodes[0],keyNodes[1],keyNodes[2],keyNodes[3],coordMode)),result},doPerceiveStereoConnectors:function(structFragmentOrCtab,coordMode,ignoreCanonicalization){var result=Kekule.MolStereoUtils.doFindStereoBonds(structFragmentOrCtab,ignoreCanonicalization);structFragmentOrCtab.beginUpdate();try{if(result&&result.length)for(var i=0,l=result.length;i<l;++i){var c=result[i],parity=Kekule.MolStereoUtils.calcStereoBondParity(c,coordMode,!0);c.setParity&&c.setParity(parity)}}finally{structFragmentOrCtab.endUpdate()}return result},isChiralNode:function(node){var result=!1;if(node.mayContainElement){var diffNeighborCount,maxMultiBondCount,possibleCharges=null,mayBeChiral=!1;if(node.mayContainElement("C")||node.mayContainElement("Si")?(diffNeighborCount=4,maxMultiBondCount=0,possibleCharges=[0],mayBeChiral=!0):node.mayContainElement("N")?(diffNeighborCount=4,maxMultiBondCount=0,mayBeChiral=!0):node.mayContainElement("S")||node.mayContainElement("P")?(diffNeighborCount=3,maxMultiBondCount=0,mayBeChiral=!0):node.mayContainElement("B")&&(diffNeighborCount=3,maxMultiBondCount=0,possibleCharges=[-1],mayBeChiral=!0),mayBeChiral){var neighbors=node.getLinkedChemNodes(),multibonds=node.getLinkedMultipleBonds(),hydroCount=node.getHydrogenCount?node.getHydrogenCount():0,allHydroCount=node.getHydrogenCount?node.getHydrogenCount(!0):0,charge=node.getCharge()||0;if(multibonds.length>maxMultiBondCount||allHydroCount>=2||neighbors.length+hydroCount<diffNeighborCount||possibleCharges&&possibleCharges.indexOf(charge)<0)result=!1;else{result=!0;for(var canoIndexCounts=[],i=0,l=neighbors.length;i<l;++i){var n=neighbors[i],canoIndex=n.getCanonicalizationIndex()||0;if(canoIndexCounts[canoIndex]){result=!1;break}canoIndexCounts[canoIndex]=1}}}}return result},doFindChiralNodes:function(structFragmentOrCtab,ignoreCanonicalization){var result=[];ignoreCanonicalization||Kekule.canonicalizer.canonicalize(structFragmentOrCtab,"morganEx");for(var i=0,l=structFragmentOrCtab.getNodeCount();i<l;++i){var node=structFragmentOrCtab.getNodeAt(i);Kekule.MolStereoUtils.isChiralNode(node)&&result.push(node)}return result},calcRotationDirection:function(centerCoord,refCoord,coord1,coord2,coord3,refCoordBehind){var rotateAxisVector,rotateAngle,lookingVector=refCoordBehind?CU.substract(centerCoord,refCoord):CU.substract(refCoord,centerCoord),rotateMatrix=null;0!==lookingVector.x||0!==lookingVector.y?(rotateAxisVector=Kekule.GeometryUtils.getVectorCrossProduct(lookingVector,{x:0,y:0,z:1}),rotateAngle=Kekule.GeometryUtils.getVectorIncludedAngle(lookingVector,{x:0,y:0,z:1}),lookingVector.z<0&&(rotateAngle=Math.PI-rotateAngle)):lookingVector.z<0&&(rotateAxisVector={x:1,y:0,z:0},rotateAngle=Math.PI),rotateAxisVector&&rotateAngle&&(rotateMatrix=CU.calcRotate3DMatrix({rotateAngle:rotateAngle,rotateAxisVector:rotateAxisVector,center:{x:0,y:0,z:0}}));var v1=CU.substract(coord1,centerCoord),v2=CU.substract(coord2,centerCoord),v3=CU.substract(coord3,centerCoord);rotateMatrix&&(v1=CU.transform3DByMatrix(v1,rotateMatrix),v2=CU.transform3DByMatrix(v2,rotateMatrix),v3=CU.transform3DByMatrix(v3,rotateMatrix));var rotateAngle=-Math.atan2(v1.y,v1.x),rotateMatrix=CU.calcTransform2DMatrix({rotateAngle:rotateAngle,center:{x:0,y:0,z:0}}),c2=CU.transform2DByMatrix(v2,rotateMatrix),c3=CU.transform2DByMatrix(v3,rotateMatrix);if(0===c2.x||0===c3.x)return RD.UNKNOWN;var angle2=Math.atan2(c2.y,c2.x),angle3=Math.atan2(c3.y,c3.x);return angle3<0&&(angle3=2*Math.PI+angle3),angle2<0&&(angle2=2*Math.PI+angle2),angle2<angle3?RD.ANTICLOCKWISE:angle2>angle3?RD.CLOCKWISE:RD.UNKNOWN},_getFischerProjectionInfo:function(node,siblings,options){var ops=Object.create(options||null);if(siblings.length<3||siblings.length>4)return null;if(3===siblings.length&&!ops.allowExplicitHydrogen)return null;var coordMode=Kekule.CoordMode.COORD2D,allowedError=ops.allowedError||Kekule.MolStereoUtils.FISCHER_PROJECTION_BOND_ALLOWED_ERROR;if(!ops.ignoreStructure){var isCenterLegal=node instanceof Kekule.Atom&&6===node.getAtomicNumber();if(isCenterLegal&&node.getRenderOption&&(isCenterLegal=node.getRenderOption("nodeDisplayMode")!==Kekule.Render.NodeLabelDisplayMode.SHOWN),!isCenterLegal)return null}for(var nodeCoord=node.getAbsCoordOfMode(coordMode,!0),nodeSeq=[],verticalNodeCount=0,i=0,l=siblings.length;i<l;++i){var sibling=siblings[i];if(!ops.ignoreStructure){var bond=sibling.getConnectorTo(node),bondStereo=bond.getStereo()||Kekule.BondStereo.NONE;if(!(bond instanceof Kekule.Bond&&bondStereo===Kekule.BondStereo.NONE))return null}var siblingCoord=sibling.getAbsCoordOfMode(coordMode,!0),delta=CU.substract(siblingCoord,nodeCoord),absDeltaX=Math.abs(delta.x),absDeltaY=Math.abs(delta.y);if(Kekule.NumUtils.isFloatEqual(absDeltaX,0)&&Kekule.NumUtils.isFloatEqual(absDeltaY,0))return null;var seqIndex,bondLengthRatio;if(absDeltaX>absDeltaY?(bondLengthRatio=absDeltaY/absDeltaX,seqIndex=delta.x>0?1:3):(bondLengthRatio=absDeltaX/absDeltaY,seqIndex=delta.y>0?0:2,++verticalNodeCount),bondLengthRatio>allowedError)return null;if(!function(seq,index,value){return!seq[index]&&(seq[index]=value,!0)}(nodeSeq,seqIndex,sibling))return null}if(2!==verticalNodeCount)return null;var result={horizontalSiblings:[nodeSeq[3],nodeSeq[1]],verticalSiblings:[nodeSeq[0],nodeSeq[2]]};return ops.reversedDirection?(result.towardSiblings=result.verticalSiblings,result.awaySiblings=result.horizontalSiblings):(result.towardSiblings=result.horizontalSiblings,result.awaySiblings=result.verticalSiblings),result},calcTetrahedronChiralCenterRotationDirectionEx:function(centerNode,refSibling,siblings,options){var ops=Object.extend({implicitFischerProjection:!0,allowExplicitHydrogenInFischer:!0},options),coordMode=ops.coordMode,withImplicitSibling=!!ops.withImplicitSibling,refSiblingBehind=!!ops.refSiblingBehind;ops.implicitFischerProjection;if(!coordMode){var node=centerNode||refSibling||siblings[0];if(!node)return RD.UNKNOWN;coordMode=node.hasCoord3D()?Kekule.CoordMode.COORD3D:Kekule.CoordMode.COORD2D}var is2D=coordMode===Kekule.CoordMode.COORD2D,explicitSiblingCount=siblings.length,totalSiblingCount=explicitSiblingCount;if(refSibling&&++totalSiblingCount,withImplicitSibling&&++totalSiblingCount,totalSiblingCount<4)return RD.UNKNOWN;var getNodeCoord=function(node,centerNode,centerCoord,coordMode,fischerInfo){if(coordMode!==Kekule.CoordMode.COORD2D)return node.getAbsCoordOfMode(coordMode,!0);var result=node.getAbsCoordOfMode(coordMode,!0);if(centerNode&&centerCoord){var connector=node.getConnectorTo(centerNode);if(connector.getStereo){var connDirection=connector.indexOfConnectedObj(node)-connector.indexOfConnectedObj(centerNode),BS=Kekule.BondStereo,bondStereo=connector.getStereo()||BS.NONE;bondStereo===BS.NONE&&fischerInfo&&(fischerInfo.towardSiblings.indexOf(node)>=0?bondStereo=connDirection<0?BS.UP_INVERTED:BS.UP:fischerInfo.awaySiblings.indexOf(node)>=0&&(bondStereo=connDirection<0?BS.DOWN_INVERTED:BS.DOWN));var wedgeDirs=[BS.UP,BS.UP_INVERTED,BS.DOWN,BS.DOWN_INVERTED];if(wedgeDirs.indexOf(bondStereo)>=0){connDirection<0&&(bondStereo=BS.getInvertedDirection(bondStereo));var zFactors=[1,-1,-1,1],distance=CU.getDistance(result,centerCoord);result.z=distance*zFactors[wedgeDirs.indexOf(bondStereo)]}else if([BS.UP_OR_DOWN,BS.UP_OR_DOWN_INVERTED].indexOf(bondStereo)>=0)return null}}return!result.z&&node.getZIndex2D&&(result.z=node.getZIndex2D()),result.z=result.z||0,result},centerCoord=centerNode?getNodeCoord(centerNode,null,null,coordMode):null,fischerOptions={allowedError:ops.fischerAllowedError,reversedDirection:ops.reversedFischer,allowExplicitHydrogen:ops.allowExplicitHydrogenInFischer},allAroundSiblings=[].concat(siblings);refSibling&&Kekule.ArrayUtils.pushUnique(allAroundSiblings,refSibling);for(var fischerInfo=centerNode&&ops.implicitFischerProjection?Kekule.MolStereoUtils._getFischerProjectionInfo(centerNode,allAroundSiblings,fischerOptions):null,coords=[],i=0;i<explicitSiblingCount;++i){var coord=getNodeCoord(siblings[i],centerNode,centerCoord,coordMode,fischerInfo);coords.push(coord)}var allExplicitSiblingCoords=AU.clone(coords),refCoord=refSibling?getNodeCoord(refSibling,centerNode,centerCoord,coordMode,fischerInfo):null;if(refCoord&&allExplicitSiblingCoords.push(refCoord),allExplicitSiblingCoords.indexOf(null)>=0)return RD.UNKNOWN;if(!centerCoord){for(var coordSum={},i=0,l=allExplicitSiblingCoords.length;i<l;++i)coordSum=CU.add(allExplicitSiblingCoords[i],coordSum);centerCoord=CU.divide(coordSum,allExplicitSiblingCoords.length)}for(var wedgeNodeCount=0,i=0,l=allExplicitSiblingCoords.length;i<l;++i){var oldCoord=allExplicitSiblingCoords[i],c=CU.substract(oldCoord,centerCoord);oldCoord.x=c.x,oldCoord.y=c.y,oldCoord.z=c.z,is2D&&c.z&&++wedgeNodeCount}if(is2D&&wedgeNodeCount<=0)return RD.UNKNOWN;if(centerCoord={x:0,y:0,z:0},withImplicitSibling){for(var coordSum={},i=0,l=allExplicitSiblingCoords.length;i<l;++i)coordSum=CU.add(allExplicitSiblingCoords[i],coordSum);var implicitCoord=CU.substract({x:0,y:0,z:0},coordSum);refSibling?coords.push(implicitCoord):refCoord=implicitCoord}return 3===coords.length&&coords.indexOf(null)<0?Kekule.MolStereoUtils.calcRotationDirection(centerCoord,refCoord,coords[0],coords[1],coords[2],refSiblingBehind):RD.UNKNOWN},calcTetrahedronChiralCenterRotationDirection:function(coordMode,centerNode,refSibling,siblings,withImplicitSibling,refSiblingBehind){return Kekule.MolStereoUtils.calcTetrahedronChiralCenterRotationDirectionEx(centerNode,refSibling,siblings,{coordMode:coordMode,withImplicitSibling:withImplicitSibling,refSiblingBehind:refSiblingBehind})},calcTetrahedronChiralNodeParity:function(node,coordMode,options){var ops=Object.create(options||null);coordMode||(coordMode=node.hasCoord3D()?Kekule.CoordMode.COORD3D:Kekule.CoordMode.COORD2D),ops.coordMode=coordMode,ops.refSiblingBehind=!0;var KS=Kekule.StereoParity;if(!ops.ignoreChiralCheck&&!Kekule.MolStereoUtils.isChiralNode(node))return KS.NONE;var siblings=node.getLinkedChemNodes(),hydroCount=node.getHydrogenCount();ops.withImplicitSibling=!!hydroCount||siblings.length<4,siblings.sort(function(a,b){return-((a.getCanonicalizationIndex()||0)-(b.getCanonicalizationIndex()||0))});var refSibling=ops.withImplicitSibling?null:siblings[3];siblings=siblings.slice(0,3);var rotationDir=Kekule.MolStereoUtils.calcTetrahedronChiralCenterRotationDirectionEx(node,refSibling,siblings,ops);return rotationDir===RD.CLOCKWISE?KS.ODD:rotationDir===RD.ANTICLOCKWISE?KS.EVEN:KS.UNKNOWN},doPerceiveChiralNodes:function(structFragmentOrCtab,coordMode,ignoreCanonicalization,options){var ops=Object.create(options||null),parityCalcOps=Object.create(ops);parityCalcOps.ignoreChiralCheck=!0;var result=Kekule.MolStereoUtils.doFindChiralNodes(structFragmentOrCtab,ignoreCanonicalization);structFragmentOrCtab.beginUpdate();try{if(result&&result.length)for(var i=0,l=result.length;i<l;++i){var n=result[i],parity=Kekule.MolStereoUtils.calcTetrahedronChiralNodeParity(n,coordMode,parityCalcOps);n.setParity&&n.setParity(parity)}}finally{structFragmentOrCtab.endUpdate()}return result},perceiveStereos:function(structFragmentOrCtab,coordMode,ignoreCanonicalization,options){var result,targetFragment,ops=Object.extend(Object.extend({},Kekule.globalOptions.algorithm.stereoPerception),options),srcStructFragment=structFragmentOrCtab instanceof Kekule.StructureConnectionTable?structFragmentOrCtab.getParent():structFragmentOrCtab;targetFragment=ops.useFlatternedShadow?srcStructFragment.getFlattenedShadowFragment(!0):srcStructFragment,ignoreCanonicalization||Kekule.canonicalizer.canonicalize(targetFragment,"morganEx"),targetFragment.beginUpdate();try{var stereoBonds,chiralNodes;ops.perceiveStereoConnectors&&(stereoBonds=ops.calcParity?Kekule.MolStereoUtils.doPerceiveStereoConnectors(targetFragment,coordMode,!0):Kekule.MolStereoUtils.doFindStereoBonds(targetFragment,!0)),ops.perceiveChiralNodes&&(chiralNodes=ops.calcParity?Kekule.MolStereoUtils.doPerceiveChiralNodes(targetFragment,coordMode,!0,ops):Kekule.MolStereoUtils.doFindChiralNodes(targetFragment,!0));var stereoObjs=(chiralNodes||[]).concat(stereoBonds||[]);if(ops.useFlatternedShadow&&!srcStructFragment.getFlattenedShadowOnSelf()){result=[],srcStructFragment.beginUpdate();try{for(var i=0,l=stereoObjs.length;i<l;++i){var srcObj=srcStructFragment.getFlatternedShadowSourceObj(stereoObjs[i]);srcObj&&(ops.calcParity&&srcObj.setParity(stereoObjs[i].getParity()),result.push(srcObj))}}finally{srcStructFragment.endUpdate()}}else result=stereoObjs}finally{targetFragment.endUpdate()}return result},findStereoConnectors:function(structFragmentOrCtab,ignoreCanonicalization){return Kekule.MolStereoUtils.perceiveStereos(structFragmentOrCtab,null,ignoreCanonicalization,{perceiveStereoConnectors:!0,perceiveChiralNodes:!1,calcParity:!1})},perceiveStereoConnectors:function(structFragmentOrCtab,coordMode,ignoreCanonicalization){return Kekule.MolStereoUtils.perceiveStereos(structFragmentOrCtab,coordMode,ignoreCanonicalization,{perceiveStereoConnectors:!0,perceiveChiralNodes:!1,calcParity:!0})},findChiralNodes:function(structFragmentOrCtab,ignoreCanonicalization){return Kekule.MolStereoUtils.perceiveStereos(structFragmentOrCtab,null,ignoreCanonicalization,{perceiveStereoConnectors:!1,perceiveChiralNodes:!0,calcParity:!1})},perceiveChiralNodes:function(structFragmentOrCtab,coordMode,ignoreCanonicalization,options){var ops=Object.create(options||null);return ops=Object.extend(ops,{perceiveStereoConnectors:!1,perceiveChiralNodes:!0,calcParity:!0}),Kekule.MolStereoUtils.perceiveStereos(structFragmentOrCtab,coordMode,ignoreCanonicalization,ops)}},Kekule.CanonicalizationMorganExIndexer=Class.create(Kekule.CanonicalizationMorganIndexer,{CLASS_NAME:"Kekule.CanonicalizationMorganExIndexer",doExecute:function($super,ctab){$super(ctab);var nodes=ctab.getNonHydrogenNodes(),sortedNodes=this._groupNodesByCanoIndex(nodes),stereoObjs=null,stereoObjCount=0;for(stereoObjs=Kekule.MolStereoUtils.perceiveStereos(ctab,null,!0)||[];stereoObjCount<stereoObjs.length;)sortedNodes=this._regroupSortedNodes(sortedNodes),this._setCanonicalizationIndexToNodeGroups(sortedNodes),stereoObjCount=stereoObjs.length,stereoObjs=Kekule.MolStereoUtils.perceiveStereos(ctab,null,!0)||[]},_groupNodesByCanoIndex:function(nodes){return AU.group(nodes,function(a,b){return(a.getCanonicalizationIndex()||-1)-(b.getCanonicalizationIndex()||-1)})},_regroupSortedNodes:function(sortedNodes){for(var result=[],i=0,l=sortedNodes.length;i<l;++i){var n=sortedNodes[i];if(AU.isArray(n)){var resorted=AU.group(n,function(a,b){var result=a.compareStructure(b);if(0===result){var connsA=a.getLinkedConnectors(),connsB=b.getLinkedConnectors();result=Kekule.ObjComparer.compareStructure(connsA,connsB)}return result});result=result.concat(resorted)}else result.push(n)}return result}}),Kekule.canonicalizer.registerExecutor("morganEx",[Kekule.CanonicalizationMorganExIndexer,Kekule.CanonicalizationMorganNodeSorter],!0),ClassEx.extend(Kekule.StructureFragment,{perceiveChiralNodes:function(coordMode,ignoreCanonicalization,options){return Kekule.MolStereoUtils.perceiveChiralNodes(this,coordMode,ignoreCanonicalization,options)},perceiveStereoConnectors:function(coordMode,ignoreCanonicalization){return Kekule.MolStereoUtils.perceiveStereoConnectors(this,coordMode,ignoreCanonicalization)},perceiveStereos:function(coordMode,ignoreCanonicalization,options){return Kekule.MolStereoUtils.perceiveStereos(this,coordMode,ignoreCanonicalization,options)}}),Kekule}},function(module,exports,__webpack_require__){"use strict";module.exports=function(Kekule){return Kekule.ChemWidget={},Kekule.ChemWidget.AbstractWidget=Kekule.Widget.BaseWidget,Kekule.ChemWidget.ComponentWidgetNames={menu:"menu",newDoc:"newDoc",clearObjs:"clearObjs",loadFile:"loadFile",loadData:"loadData",saveData:"saveData",zoomIn:"zoomIn",zoomOut:"zoomOut",rotateRight:"rotateRight",rotateLeft:"rotateLeft",rotateX:"rotateX",rotateY:"rotateY",rotateZ:"rotateZ",reset:"reset",molDisplayType:"molDisplayType",molDisplayTypeCondensed:"molDisplayTypeCondensed",molDisplayTypeSkeletal:"molDisplayTypeSkeletal",molDisplayTypeWire:"molDisplayTypeWire",molDisplayTypeSticks:"molDisplayTypeSticks",molDisplayTypeBallStick:"molDisplayTypeBallStick",molDisplayTypeSpaceFill:"molDisplayTypeSpaceFill",molHideHydrogens:"molHideHydrogens",openEditor:"openEditor",config:"config",objInspector:"objInspector",undo:"undo",redo:"redo",copy:"copy",cut:"cut",paste:"paste",cloneSelection:"cloneSelection",erase:"erase",manipulate:"manipulate",molBond:"bond",molAtom:"atom",molFormula:"formula",molCharge:"charge",textBlock:"textBlock",imageBlock:"imageBlock",molRing:"ring",glyph:"glyph",textImage:"textImage",fontName:"fontName",fontSize:"fontSize",color:"color",textDirection:"textDirection",textAlign:"textAlign"},Kekule.ChemWidget.HtmlClassNames={PREFIX:"K-Chem-",INNER_TOOLBAR:"K-Chem-InnerToolbar"},Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,DataType=(__webpack_require__(0).ClassEx,__webpack_require__(0).ObjectEx,__webpack_require__(0).DataType);module.exports=function(Kekule){var CCNS=(Class.PropertyScope,Kekule.ChemWidget,Kekule.Widget.HtmlClassNames,Kekule.ChemWidget.HtmlClassNames);return Kekule.ChemWidget.HtmlClassNames=Object.extend(Kekule.ChemWidget.HtmlClassNames,{DIALOG_LOADDATA:"K-Chem-Dialog-LoadData",DIALOG_LOADDATA_FORMATBOX:"K-Chem-Dialog-LoadData-FormatBox",DIALOG_LOADDATA_SRCEDITOR:"K-Chem-Dialog-LoadData-SrcEditor",DIALOG_LOADDATA_BTN_LOADFROMFILE:"K-Chem-Dialog-LoadData-Btn-LoadFromFile"}),Kekule.ChemWidget.LoadDataDialog=Class.create(Kekule.Widget.Dialog,{CLASS_NAME:"Kekule.ChemWidget.LoadDataDialog",initialize:function($super,parentOrElementOrDocument,caption,buttons){this._openFileAction=new Kekule.ActionLoadFileData,this._openFileAction.update(),this._openFileAction.addEventListener("load",this.reactFileLoad,this),this._sBtnLoadFromFile=Kekule.$L("ChemWidgetTexts.CAPTION_LOADDATA_FROM_FILE"),this._formatItems=null,$super(parentOrElementOrDocument,caption||Kekule.$L("ChemWidgetTexts.CAPTION_LOADDATA_DIALOG"),buttons||[Kekule.Widget.DialogButtons.OK,Kekule.Widget.DialogButtons.CANCEL])},finalize:function($super){this._openFileAction.finalize(),$super()},initProperties:function(){this.defineProp("chemObj",{dataType:"Kekule.ChemObject",serializable:!1,setter:null}),this.defineProp("allowedFormatIds",{dataType:DataType.ARRAY,setter:function(value){this.setPropStoreFieldValue("allowedFormatIds",value),this.updateFormatItems()}})},initPropValues:function($super){$super()},doGetWidgetClassName:function($super){return $super()+" "+CCNS.DIALOG_LOADDATA},doCreateClientContents:function($super,clientElem){$super();var doc=this.getDocument(),elem=doc.createElement("div");elem.innerHTML=Kekule.$L("ChemWidgetTexts.CAPTION_DATA_FORMAT"),clientElem.appendChild(elem),elem=doc.createElement("div"),clientElem.appendChild(elem);var formatSelector=new Kekule.Widget.SelectBox(this);formatSelector.addClassName(CCNS.DIALOG_LOADDATA_FORMATBOX),formatSelector.appendToElem(elem),this._formatSelector=formatSelector,this.updateFormatItems();var elem=doc.createElement("div");elem.innerHTML=Kekule.$L("ChemWidgetTexts.CAPTION_DATA_SRC"),clientElem.appendChild(elem),elem=doc.createElement("div"),clientElem.appendChild(elem);var dataEditor=new Kekule.Widget.TextEditor(this);dataEditor.setWrap("off"),dataEditor.setToolbarPos(Kekule.Widget.Position.BOTTOM),dataEditor.addClassName(CCNS.DIALOG_LOADDATA_SRCEDITOR),dataEditor.appendToElem(elem),this._dataEditor=dataEditor},getFormatSelectorItems:function(readerInfos){for(var result=[],formatIds=this.getAllowedFormatIds()||Kekule.IO.ChemDataReaderManager.getAllReadableFormatIds(),i=0,l=formatIds.length;i<l;++i){var idInfo=Kekule.IO.DataFormatsManager.getFormatInfo(formatIds[i]);if(idInfo){for(var fileExts=Kekule.ArrayUtils.clone(Kekule.ArrayUtils.toArray(idInfo.fileExts)),j=0,k=fileExts.length;j<k;++j)fileExts[j]="*."+fileExts[j];var sFileExt=fileExts.join(", "),text=idInfo.title;sFileExt&&(text+=" ("+sFileExt+")"),result.push({value:idInfo.mimeType,text:text,title:idInfo.mimeType,data:idInfo})}}return result.sort(function(a,b){return a.text<b.text?-1:a.text>b.text?1:0}),result},getFileFilters:function(formatItems){for(var result=[],i=0,l=formatItems.length;i<l;++i){var format=formatItems[i],info=format.data,title=format.text||format.title||format.value,exts=Kekule.ArrayUtils.toArray(info.fileExts);result.push({title:title,filter:"."+exts.join(",.")})}return result.push(Kekule.NativeServices.FILTER_ALL_SUPPORT),result.push(Kekule.NativeServices.FILTER_ANY),result},updateFormatItems:function(){this._formatItems=this.getFormatSelectorItems(),this._formatSelector.setItems(this._formatItems);var filters=this.getFileFilters(this._formatItems);this._openFileAction.setFilters(filters)},doSetButtons:function($super,value){var buttons=value||[];buttons.indexOf(this._sBtnLoadFromFile)<0&&buttons.unshift(this._sBtnLoadFromFile),$super(buttons);var btnOpenFile=this.getDialogButton(this._sBtnLoadFromFile);btnOpenFile.setAction(this._openFileAction),btnOpenFile.linkStyleResource(Kekule.Widget.StyleResourceNames.BUTTON_LOAD_FILE),btnOpenFile.addClassName(CCNS.DIALOG_LOADDATA_BTN_LOADFROMFILE),btnOpenFile.setEnabled(this._openFileAction.getEnabled())},reactFileLoad:function(e){var chemObj,data=e.data,fileName=e.fileName;try{if(e.success&&data&&fileName){chemObj=Kekule.IO.loadTypedData(data,null,fileName),this.setPropStoreFieldValue("chemObj",chemObj);var dialogResult=Kekule.Widget.DialogButtons.OK;this.close(dialogResult)}else chemObj=null}catch(err){Kekule.error(err)}},open:function($super,callback,caller,showType){return this.setPropStoreFieldValue("chemObj",null),$super(callback,caller,showType)},close:function($super,result){if(!this.getChemObj()&&this.isPositiveResult(result)){var data=this._dataEditor.getValue(),mimeType=this._formatSelector.getValue();try{var chemObj=Kekule.IO.loadTypedData(data,mimeType);chemObj?this.setPropStoreFieldValue("chemObj",chemObj):Kekule.error(Kekule.$L("ErrorMsg.LOAD_CHEMDATA_FAILED"))}catch(e){Kekule.raise(e,Kekule.ExceptionLevel.ERROR)}}return $super(result)}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,DataType=__webpack_require__(0).DataType;module.exports=function(Kekule){var DU=Kekule.DomUtils,EU=Kekule.HtmlElementUtils,CNS=Kekule.Widget.HtmlClassNames,CCNS=Kekule.ChemWidget.HtmlClassNames;return Kekule.ChemWidget.HtmlClassNames=Object.extend(Kekule.ChemWidget.HtmlClassNames,{PERIODIC_TABLE:"K-Chem-Periodic-Table",PERIODIC_TABLE_MINI:"K-Chem-Periodic-Table-Mini",PERIODIC_TABLE_LEGEND:"K-Chem-Periodic-Table-Legend",PERIODIC_TABLE_LEGEND_CONTENT:"K-Chem-Periodic-Table-Legend-Content",PERIODIC_TABLE_LEGEND_COLORS:"K-Chem-Periodic-Table-Legend-Colors",PERIODIC_TABLE_LEGEND_COLOR:"K-Chem-Periodic-Table-Legend-Color",PERIODIC_TABLE_MAINTABLE:"K-Chem-Periodic-Table-MainTable",PERIODIC_TABLE_EXTRATABLE:"K-Chem-Periodic-Table-ExtraTable",PERIODIC_TABLE_ELEM_CELL:"K-Chem-Periodic-Table-Elem-Cell",PERIODIC_TABLE_ELEM_STUBSCELL:"K-Chem-Periodic-Table-Elem-StubsCell",PERIODIC_TABLE_ELEM_CELL_CONTENT:"K-Chem-Periodic-Table-Elem-Cell-Content",PERIODIC_TABLE_LEGEND_ELEM_CELL_CONTENT:"K-Chem-Periodic-Table-Elem-Cell-Content",PERIODIC_TABLE_HEAD_CELL:"K-Chem-Periodic-Table-Head-Cell",PERIODIC_TABLE_HEAD_CELL_CONTENT:"K-Chem-Periodic-Table-Head-Cell-Content",PERIODIC_TABLE_HEAD_CELL_GROUP:"K-Chem-Periodic-Table-Head-Cell-Group",PERIODIC_TABLE_HEAD_CELL_PERIOD:"K-Chem-Periodic-Table-Head-Cell-Period",ELEM_SYMBOL:"K-Chem-Elem-Symbol",ELEM_SYMBOL_STUBS:"K-Chem-Elem-Symbol-Stubs",ELEM_NAME:"K-Chem-Elem-Name",ATOMIC_NUM:"K-Chem-Atomic-Num",ATOMIC_WEIGHT:"K-Chem-Atomic-Weight"}),Kekule.globalOptions.add("chemWidget.periodicTable",{displayedComponents:["symbol","name","atomicNumber","groupHead","legend"]}),Kekule.ChemWidget.PeriodicTable=Class.create(Kekule.ChemWidget.AbstractWidget,{CLASS_NAME:"Kekule.ChemWidget.PeriodicTable",BINDABLE_TAG_NAMES:["span","div"],ELEM_DATA_FIELD:"__$elemData__",MAX_GROUP:18,MAX_PERIOD:7,LA_SERIES:["La","Ce","Pr","Nd","Pm","Sm","Eu","Gd","Tb","Dy","Ho","Er","Tm","Yb","Lu"],AC_SERIES:["Ac","Th","Pa","U","Np","Pu","Am","Cm","Bk","Cf","Es","Fm","Md","No","Lr"],initialize:function($super,parentOrElementOrDocument,displayedComponents){this.setPropStoreFieldValue("displayedComponents",displayedComponents||this.getDefaultDisplayedComponents()),this._elemCells=[],this._selectedElemCells=[],$super(parentOrElementOrDocument),this.setEnableSelect(!0),this.setEnableMultiSelect(!0)},initProperties:function(){this.defineProp("displayedComponents",{dataType:DataType.ARRAY,getter:function(){return this.getPropStoreFieldValue("displayedComponents")||this.getDefaultDisplayedComponents()}}),this.defineProp("startingAtomNum",{dataType:DataType.INT}),this.defineProp("endingAtomNum",{dataType:DataType.INT}),this.defineProp("useMiniMode",{dataType:DataType.BOOL,setter:function(value){this.setPropStoreFieldValue("useMiniMode",value),value?this.addClassName(CCNS.PERIODIC_TABLE_MINI):this.removeClassName(CCNS.PERIODIC_TABLE_MINI)}}),this.defineProp("enableSelect",{dataType:DataType.BOOL,getter:function(){return this.getPropStoreFieldValue("enableSelect")||this.getEnableMultiSelect()}}),this.defineProp("enableMultiSelect",{dataType:DataType.BOOL}),this.defineProp("selected",{dataType:DataType.HASH,serializable:!1,setter:null,getter:function(){return this.getSelection()?this.getSelection()[0]:null}}),this.defineProp("selection",{dataType:DataType.ARRAY,serializable:!1,setter:null,getter:function(){for(var result=[],cellElems=this._selectedElemCells||[],i=0,l=cellElems.length;i<l;++i){var data=cellElems[i][this.ELEM_DATA_FIELD];data&&result.push(data)}return result}}),this.defineProp("selectedSymbol",{dataType:DataType.STRING,getter:function(){return this.getSelectedSymbols()[0]},setter:function(value){this.setSelectedSymbols([value])}}),this.defineProp("selectedSymbols",{dataType:DataType.ARRAY,getter:function(){var selection=this.getSelection();if(selection){for(var result=[],i=0,l=selection.length;i<l;++i)result.push(selection[i].symbol);return result}return[]},setter:function(value){this.selectSymbols(value)}})},doGetWidgetClassName:function($super){return $super()+" "+CCNS.PERIODIC_TABLE},doCreateRootElement:function(doc){return doc.createElement("div")},doCreateSubElements:function($super,doc,rootElem){return $super(doc,rootElem),[this.createMainTable(doc,rootElem)]},doObjectChange:function(modifiedPropNames){var props=["displayedComponents","startingAtomNum","endingAtomNum"];Kekule.ArrayUtils.intersect(modifiedPropNames,props).length&&this.recreateMainTable()},getDefaultDisplayedComponents:function(){return Kekule.globalOptions.chemWidget.periodicTable.displayedComponents},getShowElemSymbol:function(){return this.getDisplayedComponents().indexOf("symbol")>=0},getShowElemName:function(){return this.getDisplayedComponents().indexOf("name")>=0},getShowAtomicNum:function(){return this.getDisplayedComponents().indexOf("atomicNumber")>=0},getShowAtomicWeight:function(){return this.getDisplayedComponents().indexOf("atomicWeight")>=0},getShowGroupHead:function(){return this.getDisplayedComponents().indexOf("groupHead")>=0},getShowPeriodHead:function(){return this.getDisplayedComponents().indexOf("periodHead")>=0},getShowLegend:function(){return this.getDisplayedComponents().indexOf("legend")>=0},recreateMainTable:function(){this.deselectAll();var elem=this.getElement();DU.clearChildContent(elem),this.createMainTable(elem.ownerDocument,elem)},createMainTable:function(doc,parentElem){var elemData=Kekule.chemicalElementsData,cells=[];this._elemCells=[];for(var extraCells=[],series=[],result=doc.createElement("table"),row=0;row<=this.MAX_PERIOD;++row){for(var rowElem=doc.createElement("tr"),rowCells=[],col=0;col<=this.MAX_GROUP;++col){var cellElem=doc.createElement("td");rowElem.appendChild(cellElem),rowCells.push(cellElem)}result.appendChild(rowElem),cells.push(rowCells)}for(var extraTableElem=doc.createElement("table"),row=0;row<2;++row){for(var rowElem=doc.createElement("tr"),rowCells=[],col=0;col<this.LA_SERIES.length;++col){var cellElem=doc.createElement("td");rowElem.appendChild(cellElem),rowCells.push(cellElem)}extraTableElem.appendChild(rowElem),extraCells.push(rowCells)}for(var startingIndex=this.getStartingAtomNum()||0,endingIndex=this.getEndingAtomNum()||3e5,i=0,l=elemData.length;i<l;++i){var curr=elemData[i],atomNum=curr.atomicNumber;if(!(atomNum<startingIndex||atomNum>endingIndex)){var symbol=curr.symbol,period=curr.period,group=curr.group,chemSerie=curr.chemicalSerie.replace(/\s/g,"");Kekule.ArrayUtils.pushUnique(series,curr.chemicalSerie);var cellElem,laIndex=this.LA_SERIES.indexOf(symbol),acIndex=this.AC_SERIES.indexOf(symbol);laIndex>=0?cellElem=extraCells[0][laIndex]:acIndex>=0?cellElem=extraCells[1][acIndex]:period&&group&&(cellElem=cells[period][group]),cellElem&&(cellElem.className=CCNS.PERIODIC_TABLE_ELEM_CELL,cellElem.appendChild(this.createElemCellContent(doc,curr,chemSerie.upperFirst())),cellElem[this.ELEM_DATA_FIELD]=curr,this._elemCells.push(cellElem)),0!==laIndex&&0!==acIndex||(cellElem=cells[period][group],cellElem.className=CCNS.PERIODIC_TABLE_ELEM_STUBSCELL,cellElem.appendChild(this.createElemCellStubsContent(doc,curr,chemSerie.upperFirst())))}}if(this.getShowGroupHead())for(var groupHeads=["IA","IIA","IIIB","IVB","VB","VIB","VIIB","","VIII","","IB","IIB","IIIA","IVA","VA","VIA","VIIA","VIIIA"],col=1;col<=this.MAX_GROUP;++col){var row=1===col||18===col?0:2===col||col>=13?1:3,cellElem=cells[row][col];cellElem.className=CCNS.PERIODIC_TABLE_HEAD_CELL+" "+CCNS.PERIODIC_TABLE_HEAD_CELL_GROUP,cellElem.appendChild(this.createHeadContent(doc,groupHeads[col-1]))}if(this.getShowPeriodHead())for(var row=1;row<=this.MAX_PERIOD;++row){var cellElem=cells[row][0];cellElem.className=CCNS.PERIODIC_TABLE_HEAD_CELL+" "+CCNS.PERIODIC_TABLE_HEAD_CELL_PERIOD,cellElem.appendChild(this.createHeadContent(doc,row))}if(parentElem.appendChild(result),this.getShowLegend()){var legendElem=doc.createElement("a");legendElem.href="javascript:void(0)",legendElem.className=CCNS.PERIODIC_TABLE_LEGEND+" "+CNS.CORNER_ALL,DU.setElementText(legendElem,Kekule.$L("ChemWidgetTexts.LEGEND_CAPTION"));var legendContentElem=doc.createElement("div");legendContentElem.className=CCNS.PERIODIC_TABLE_LEGEND_CONTENT+" "+CNS.CORNER_ALL;var fakeInfo={symbol:Kekule.$L("ChemWidgetTexts.LEGEND_ELEM_SYMBOL"),atomicNumber:Kekule.$L("ChemWidgetTexts.LEGEND_ATOMIC_NUM"),naturalMass:Kekule.$L("ChemWidgetTexts.LEGEND_ATOMIC_WEIGHT"),name:Kekule.$L("ChemWidgetTexts.LEGEND_ELEM_NAME")},symLegendElem=this.createElemCellContent(doc,fakeInfo,CCNS.PERIODIC_TABLE_LEGEND_ELEM_CELL_CONTENT);legendContentElem.appendChild(symLegendElem);var colorLegendElem=doc.createElement("div");colorLegendElem.className=CCNS.PERIODIC_TABLE_LEGEND_COLORS;for(var i=0,l=series.length;i<l;++i){var elem=doc.createElement("div");elem.className=CCNS.PERIODIC_TABLE_LEGEND_COLOR+" "+series[i].replace(/\s/g,""),DU.setElementText(elem,series[i]),colorLegendElem.appendChild(elem)}legendContentElem.appendChild(colorLegendElem),legendElem.appendChild(legendContentElem),parentElem.appendChild(legendElem)}return parentElem.appendChild(extraTableElem),result},createElemCellContent:function(doc,elemInfo,extraClass){var result=doc.createElement("div"),className=CCNS.PERIODIC_TABLE_ELEM_CELL_CONTENT;if(extraClass&&(className+=" "+extraClass),result.className=className,this.getShowAtomicNum()&&result.appendChild(this.createElemContentComponent(doc,elemInfo.atomicNumber,CCNS.ATOMIC_NUM)),this.getShowAtomicWeight()){var mass=elemInfo.naturalMass;if(mass){var smass="number"==typeof mass?mass.toFixed(3):mass;result.appendChild(this.createElemContentComponent(doc,smass,CCNS.ATOMIC_WEIGHT))}else result.appendChild(this.createElemContentComponent(doc," ",CCNS.ATOMIC_WEIGHT))}return this.getShowElemSymbol()&&result.appendChild(this.createElemContentComponent(doc,elemInfo.symbol,CCNS.ELEM_SYMBOL)),this.getShowElemName()&&result.appendChild(this.createElemContentComponent(doc,elemInfo.name,CCNS.ELEM_NAME)),result},createElemCellStubsContent:function(doc,elemInfo,extraClass){var result=doc.createElement("div");result.className=CCNS.PERIODIC_TABLE_ELEM_CELL_CONTENT+" "+(extraClass||"");var atomicNum,symbol,name;return name=elemInfo.chemicalSerie,"La"===elemInfo.symbol?(atomicNum="57-71",symbol="La-Lu"):(atomicNum="89-103",symbol="Ac-Lr"),this.getShowAtomicNum()&&result.appendChild(this.createElemContentComponent(doc,atomicNum,CCNS.ATOMIC_NUM)),this.getShowElemSymbol()&&result.appendChild(this.createElemContentComponent(doc,symbol,CCNS.ELEM_SYMBOL_STUBS,!0)),this.getShowElemName()&&result.appendChild(this.createElemContentComponent(doc,name,CCNS.ELEM_NAME)),result},createElemContentComponent:function(doc,value,className,wrapSpan){var elem=doc.createElement("span");if(elem.className=className,wrapSpan){var wrapper=doc.createElement("span");elem.appendChild(wrapper)}return DU.setElementText(wrapper||elem,value),elem},createHeadContent:function(doc,text,extraClass){var result=doc.createElement("div");return result.className=CCNS.PERIODIC_TABLE_HEAD_CELL_CONTENT+" "+(extraClass||""),DU.setElementText(result,text),result},_getAtomCellElem:function(elem){var cellElem=DU.getNearestAncestorByTagName(elem,"td",!0);return cellElem&&this._elemCells.indexOf(cellElem)>=0?cellElem:null},_getCellElemOfSymbol:function(symbol){for(var cells=this._elemCells,i=0,l=cells.length;i<l;++i){var cell=cells[i];if(cell[this.ELEM_DATA_FIELD].symbol===symbol)return cell}return null},isCellSelected:function(cellElem){return this._selectedElemCells.indexOf(cellElem)>=0},selectCell:function(cellElem){cellElem&&(EU.addClass(cellElem,CNS.STATE_SELECTED),Kekule.ArrayUtils.pushUnique(this._selectedElemCells,cellElem),this.invokeEvent("select",{elemData:cellElem[this.ELEM_DATA_FIELD]}))},deselectCell:function(cellElem){cellElem&&(EU.removeClass(cellElem,CNS.STATE_SELECTED),Kekule.ArrayUtils.remove(this._selectedElemCells,cellElem),this.invokeEvent("deselect",{elemData:cellElem[this.ELEM_DATA_FIELD]}))},toggleCell:function(cellElem){this.isCellSelected(cellElem)?this.deselectCell(cellElem):this.selectCell(cellElem)},deselectAll:function(){for(var cells=this._selectedElemCells,i=cells.length-1;i>=0;--i)this.deselectCell(cells[i]);return this},selectSymbols:function(symbols){this.deselectAll();for(var ss=Kekule.ArrayUtils.toArray(symbols),i=0,l=ss.length;i<l;++i){var cell=this._getCellElemOfSymbol(ss[i]);cell&&this.selectCell(cell)}return this},react_click:function($super,e){if(this.getEnableSelect()){var target=e.getTarget(),cellElem=this._getAtomCellElem(target);if(cellElem)return this.getEnableMultiSelect()?this.toggleCell(cellElem):(this.deselectAll(),this.selectCell(cellElem)),!0}$super(e)}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,DataType=(__webpack_require__(0).ClassEx,__webpack_require__(0).ObjectEx,__webpack_require__(0).DataType);module.exports=function(Kekule){var PS=Class.PropertyScope,ZU=(Kekule.DomUtils,Kekule.ZoomUtils),CNS=(Kekule.ChemWidget,Kekule.Widget.HtmlClassNames),CCNS=Kekule.ChemWidget.HtmlClassNames;return Kekule.ChemWidget.HtmlClassNames=Object.extend(Kekule.ChemWidget.HtmlClassNames,{DISPLAYER_DRAWCONTEXT_PARENT:"K-Chem-Displayer-DrawContext-Parent",ACTION_MOL_DISPLAY_TYPE:"K-Chem-MolDisplayType",ACTION_MOL_DISPLAY_SKELETAL:"K-Chem-MolDisplaySkeletal",ACTION_MOL_DISPLAY_CONDENSED:"K-Chem-MolDisplayCondensed",ACTION_MOL_DISPLAY_WIRE:"K-Chem-MolDisplayWire",ACTION_MOL_DISPLAY_BALLSTICK:"K-Chem-MolDisplayBallStick",ACTION_MOL_DISPLAY_STICKS:"K-Chem-MolDisplaySticks",ACTION_MOL_DISPLAY_SPACEFILL:"K-Chem-MolDisplaySpaceFill",ACTION_MOL_HIDE_HYDROGENS:"K-Chem-MolHideHydrogens",ACTION_ZOOMIN:"K-Chem-ZoomIn",ACTION_ZOOMOUT:"K-Chem-ZoomOut",ACTION_RESET:"K-Chem-Reset",ACTION_RESET_ZOOM:"K-Chem-ResetZoom",ACTION_LOADFILE:"K-Chem-LoadFile",ACTION_LOADDATA:"K-Chem-LoadData",ACTION_SAVEFILE:"K-Chem-SaveFile",ACTION_CLEAROBJS:"K-Chem-ClearObjs",ACTION_CONFIG:"K-Chem-Config",DIALOG_CHOOSE_FILE_FORAMT:"K-Chem-Dialog-Choose-File-Format",DIALOG_CHOOSE_FILE_FORAMT_FORMATBOX:"K-Chem-Dialog-Choose-File-Format-FormatBox",DIALOG_CHOOSE_FILE_FORAMT_PREVIEWER:"K-Chem-Dialog-Choose-File-Format-Previewer"}),Kekule.ChemWidget.ChemObjDisplayerConfigs=Class.create(Kekule.AbstractConfigs,{CLASS_NAME:"Kekule.ChemWidget.ChemObjDisplayerConfigs",initProperties:function(){this.addConfigProp("ioConfigs","Kekule.ChemWidget.ChemObjDisplayerIOConfigs")},initPropValues:function($super){$super(),this.setPropStoreFieldValue("ioConfigs",new Kekule.ChemWidget.ChemObjDisplayerIOConfigs)}}),Kekule.ChemWidget.ChemObjDisplayerIOConfigs=Class.create(Kekule.AbstractConfigs,{CLASS_NAME:"Kekule.ChemWidget.ChemObjDisplayerIOConfigs",initProperties:function(){this.addBoolConfigProp("canonicalizeBeforeSave",!0)}}),Kekule.ChemWidget.ChemObjDisplayer=Class.create(Kekule.ChemWidget.AbstractWidget,{CLASS_NAME:"Kekule.ChemWidget.ChemObjDisplayer",initialize:function($super,parentOrElementOrDocument,chemObj,renderType,displayerConfigs){this._paintFlag=0,this._bgColorMap={},this._contextTransformOpsMap=new Kekule.MapEx,this.setPropStoreFieldValue("resetAfterLoad",!0),this.setPropStoreFieldValue("renderType",renderType||Kekule.Render.RendererType.R2D),$super(parentOrElementOrDocument),chemObj&&this.setChemObj(chemObj),this.setEnableLoadNewFile(!0),this.setPropStoreFieldValue("displayerConfigs",displayerConfigs||this.createDefaultConfigs())},doFinalize:function($super){this.setChemObj(null),this.getPainter().finalize();var b=this.getPropStoreFieldValue("drawBridge"),ctx=this.getPropStoreFieldValue("drawContext");ctx&&b&&b.releaseContext(ctx),b.finalize&&b.finalize(),this.setPropStoreFieldValue("drawBridge",null),this.setPropStoreFieldValue("drawContext",null),this._contextTransformOpsMap&&this._contextTransformOpsMap.finalize(),$super()},initProperties:function(){this.defineProp("displayerConfigs",{dataType:"Kekule.ChemWidget.ChemObjDisplayerConfigs",serializable:!1,scope:PS.PUBLIC}),this.defineProp("enableLoadNewFile",{dataType:DataType.BOOL}),this.defineProp("allowedInputFormatIds",{dataType:DataType.ARRAY}),this.defineProp("allowedOutputFormatIds",{dataType:DataType.ARRAY}),this.defineProp("standardizationOptions",{dataType:DataType.HASH}),this.defineProp("resetAfterLoad",{dataType:DataType.BOOL}),this.defineProp("chemObj",{dataType:"Kekule.ChemObject",serializable:!1,scope:PS.PUBLIC,setter:function(value){var oldObj=this.getPropStoreFieldValue("chemObj");this.setPropStoreFieldValue("chemObj",value),this.chemObjChanged(value,oldObj)}}),this.defineProp("chemObjLoaded",{dataType:DataType.BOOL,serializable:!1,scope:PS.PUBLIC,setter:null,getter:function(){return this.getChemObj()&&this.getPropStoreFieldValue("chemObjLoaded")}}),this.defineProp("renderType",{dataType:DataType.INT,serializable:!1,scope:PS.PUBLISHED,setter:function(value){if(!this.getAllowRenderTypeChange())return void Kekule.error(Kekule.$L("ErrorMsg.RENDER_TYPE_CHANGE_NOT_ALLOWED"));var oldValue=this.getRenderType();value!==oldValue&&(this.setPropStoreFieldValue("renderType",value),this.resetRenderType(oldValue,value))}}),this.defineProp("renderConfigs",{dataType:DataType.OBJECT,serializable:!1,scope:PS.PUBLIC,getter:function(){var result=this.getPropStoreFieldValue("renderConfigs");return result||(result=this.getRenderType()===Kekule.Render.RendererType.R3D?Kekule.Render.Render3DConfigs.getInstance():Kekule.Render.Render2DConfigs.getInstance()),result}}),this.defineProp("backgroundColor",{dataType:DataType.STRING,scope:PS.PUBLISHED,setter:function(value){this.setPropStoreFieldValue("backgroundColor",value),this._bgColorMap[this.getRenderType().toString()]=value,this.backgroundColorChanged()}}),this.defineProp("transformParams",{dataType:DataType.HASH,serializable:!1,scope:PS.PUBLIC,getter:function(){var result=Object.extend({},this.getDrawOptions());return result.screenCoordOffset=this.getBaseCoordOffset(),result},setter:function(value){var param=value||{};this.setDrawOptions(param),this.setBaseCoordOffset(param.baseCoordOffset),this.drawOptionChanged()}}),this.defineProp("drawOptions",{dataType:DataType.HASH,serializable:!1,scope:PS.PUBLIC,getter:function(){var result=this.getPropStoreFieldValue("drawOptions");return result||(result={},this.setPropStoreFieldValue("drawOptions",result)),result},setter:function(value){this.setPropStoreFieldValue("drawOptions",value),this.drawOptionChanged()}}),this.defineProp("zoom",{dataType:DataType.FLOAT,serializable:!1,getter:function(){return(this.getDrawOptions()||{}).zoom},setter:function(value){return this.zoomTo(value),this}}),this.defineProp("autofit",{dataType:DataType.BOOL,serializable:!1,getter:function(){return(this.getDrawOptions()||{}).autofit},setter:function(value){var op=this.getDrawOptions()||{};return op.autofit=value,this.setDrawOptions(op)}}),this.defineProp("moleculeDisplayType",{dataType:DataType.INT,serializable:!1,getter:function(){return(this.getDrawOptions()||{}).moleculeDisplayType},setter:function(value){return this.getDrawOptions().moleculeDisplayType=value,this.drawOptionChanged(),this}}),this.defineProp("allowCoordBorrow",{dataType:DataType.BOOL,serializable:!1,scope:PS.PUBLIC,getter:function(){return Kekule.oneOf(this.getDrawOptions().allowCoordBorrow,this.getRenderConfigs().getGeneralConfigs().getAllowCoordBorrow())}}),this.defineProp("autoSize",{dataType:DataType.BOOL,serializable:!1,setter:function(value){value!=this.getAutoSize()&&(this.setPropStoreFieldValue("autoSize",value),value&&this.allowAutoSize()&&this.drawOptionChanged())}}),this.defineProp("padding",{dataType:DataType.INT,serializable:!1,setter:function(value){value!=this.getPadding()&&(this.setPropStoreFieldValue("padding",value),this.getDrawOptions().autofitContextPadding=value,this.drawOptionChanged())}}),this.defineProp("baseCoordOffset",{dataType:DataType.Hash,serializable:!1,setter:function(value){this.setPropStoreFieldValue("baseCoordOffset",value),this.getChemObjLoaded()&&this.repaint()}}),this.defineProp("drawBridge",{dataType:DataType.OBJECT,serializable:!1,scope:PS.PRIVATE,setter:null,getter:function(slient){var result=this.getPropStoreFieldValue("drawBridge");return result||(result=this.createDrawBridge(slient),this.setPropStoreFieldValue("drawBridge",result)),result}}),this.defineProp("drawContext",{dataType:DataType.OBJECT,serializable:!1,scope:PS.PRIVATE,setter:null,getter:function(){var result=this.getPropStoreFieldValue("drawContext");if(!result){var bridge=this.getDrawBridge();if(bridge){var elem=this.getDrawContextParentElem();if(!elem)return null;var dim=Kekule.HtmlElementUtils.getElemOffsetDimension(elem);result=bridge.createContext(elem,dim.width,dim.height),this.setPropStoreFieldValue("drawContext",result)}}return result}}),this.defineProp("painter",{dataType:"Kekule.Render.ChemObjPainter",serializable:!1,scope:PS.PRIVATE,setter:null,getter:function(){var result=this.getPropStoreFieldValue("painter");return result||(result=this.createNewPainter()),result}}),this.defineProp("rootRenderer",{dataType:"Kekule.Render.AbstractRenderer",serializable:!1,scope:PS.PRIVATE,setter:null,getter:function(){var p=this.getPainter();return p?p.getRenderer():null}})},initPropValues:function($super){$super(),this.setStandardizationOptions({unmarshalSubFragments:!1})},doWidgetShowStateChanged:function($super,isShown){$super(isShown),isShown&&this.setChemObj(this.getChemObj())},getAllowRenderTypeChange:function(){return!1},resetRenderType:function(oldType,newType){var chemObj=this.getChemObj(),bridge=this.getPropStoreFieldValue("drawBridge"),context=this.getPropStoreFieldValue("drawContext");bridge&&context&&bridge.releaseContext(context),this.setPropStoreFieldValue("drawContext",null),this.setPropStoreFieldValue("drawBridge",null);var newBgColor=this.getBackgroundColorOfType(newType);this.getDrawOptions().moleculeDisplayType=this.getDefaultMoleculeDisplayType(newType),this.setPropStoreFieldValue("backgroundColor",newBgColor),this.backgroundColorChanged(!0),this.setChemObj(chemObj||null)},createDefaultConfigs:function(){return new Kekule.ChemWidget.ChemObjDisplayerConfigs},getCoordMode:function(){return this.getRenderType()===Kekule.Render.RendererType.R3D?Kekule.CoordMode.COORD3D:Kekule.CoordMode.COORD2D},setCoordMode:function(coordMode){var rType=coordMode===Kekule.CoordMode.COORD3D?Kekule.Render.RendererType.R3D:Kekule.Render.RendererType.R2D;this.setRenderType(rType)},loadPredefinedResDataToProp:function(propName,resData,success){if("chemObj"===propName)if(success)try{var chemObj=Kekule.IO.loadTypedData(resData.data,resData.resType,resData.resUri);this.setChemObj(chemObj)}catch(e){this.reportException(e)}else this.reportException(Kekule.$L("ErrorMsg.CANNOT_LOAD_RES_OF_URI")+resData.resUri||"")},reportException:function(e,exceptionLevel){Kekule.raise(e,exceptionLevel||Kekule.ExceptionLevel.ERROR)},createDrawBridge:function(slient){var M=this.getRenderType()===Kekule.Render.RendererType.R3D?Kekule.Render.DrawBridge3DMananger:Kekule.Render.DrawBridge2DMananger,result=M.getPreferredBridgeInstance();return result||slient||Kekule.error(Kekule.$L("ErrorMsg.DRAW_BRIDGE_NOT_SUPPORTED")),result},getDrawContextParentElem:function(disableAutoCreate){var result=this._drawContextParentElem;if(!result&&!disableAutoCreate){result=this.getDocument().createElement("div"),this._drawContextParentElem=result,Kekule.HtmlElementUtils.addClass(result,CNS.DYN_CREATED),Kekule.HtmlElementUtils.addClass(result,CCNS.DISPLAYER_DRAWCONTEXT_PARENT),result.style.width="100%",result.style.height="100%";var root=this.getElement(),currFirst=Kekule.DomUtils.getFirstChildElem(root);currFirst?root.insertBefore(result,currFirst):root.appendChild(result)}return result},allowAutoSize:function(){return this.getRenderType()===Kekule.Render.RendererType.R2D},canModifyPartialGraphic:function(context){var b=this.getDrawBridge();return!!b.canModifyGraphic&&b.canModifyGraphic(context||this.getDrawContext())},doInsertedToDom:function(){this.doResize()},doResize:function(){this.refitDrawContext(this.isPainting())},refitDrawContext:function(doNotRepaint){if(this.getDrawBridge(!0)&&this.getDrawContext()){var dim=Kekule.HtmlElementUtils.getElemClientDimension(this.getDrawContextParentElem()),success=this.changeContextDimension(dim);!doNotRepaint&&success&&this.repaint()}},getContextDimension:function(){return this.getDrawBridge()&&this.getDrawContext()?this.getDrawBridge().getContextDimension(this.getDrawContext()):null},changeContextDimension:function(newDimension){return!(!this.getDrawBridge()||!this.getDrawContext())&&(this.getDrawBridge().setContextDimension(this.getDrawContext(),newDimension.width,newDimension.height),!0)},clearContext:function(){var c=this.getPropStoreFieldValue("drawContext");if(c){var p=this.getPropStoreFieldValue("painter");p&&p.clear(c),this.getDrawBridge().clearContext(c)}},createNewPainter:function(chemObj){var old=this.getPropStoreFieldValue("painter");old&&old.finalize();var result=new Kekule.Render.ChemObjPainter(this.getRenderType(),chemObj,this.getDrawBridge());return this.setPropStoreFieldValue("painter",result),result},chemObjChanged:function(newObj,oldObj){this.doLoad(newObj),this.getResetAfterLoad()&&oldObj&&this.resetDisplay()},load:function(chemObj){this.setChemObj(chemObj)},doLoad:function(chemObj){this.refitDrawContext(!0),this.setPropStoreFieldValue("chemObjLoaded",!1);try{if(chemObj){this.createNewPainter(chemObj).setRenderConfigs(this.getRenderConfigs()),this.repaint(),this.setPropStoreFieldValue("chemObjLoaded",!0)}else this.clearContext();this.invokeEvent("load",{obj:chemObj})}catch(e){this.clearContext(),this.reportException(e)}finally{this.doLoadEnd(this.getChemObj())}},doLoadEnd:function(chemObj){},loadFromData:function(data,mimeType,fromUrlOrFileName){try{if(data){var chemObj=Kekule.IO.loadTypedData(data,mimeType,fromUrlOrFileName);return chemObj?this.setChemObj(chemObj):Kekule.error(Kekule.$L("ErrorMsg.LOAD_CHEMDATA_FAILED")),chemObj}return this.setChemObj(null),null}catch(e){this.reportException(e)}},loadFromFile:function(file){if(file){var self=this;try{Kekule.IO.loadFileData(file,function(chemObj,success){success&&self.setChemObj(chemObj)})}catch(e){this.reportException(e)}}else this.setChemObj(null)},getSavingTargetObj:function(){return this.getChemObj()},saveData:function(formatId,dataType,obj){var obj=obj||this.getSavingTargetObj();this.prepareSaveData(obj);var writer=Kekule.IO.ChemDataWriterManager.getWriterByFormat(formatId,null,obj);if(writer){if(this._needToCanonicalizeBeforeSaving()&&this.getDisplayerConfigs().getIoConfigs().getCanonicalizeBeforeSave()&&obj.standardize){var obj=obj.clone?obj.clone(!0):obj;obj.standardize(this.getStandardizationOptions())}if(!dataType){dataType=Kekule.IO.DataFormatsManager.getFormatInfo(formatId).dataType}return writer.writeData(obj,dataType,formatId)}return Kekule.error(Kekule.$L("ErrorMsg.NO_SUITABLE_WRITER_FOR_FORMAT")),null},_needToCanonicalizeBeforeSaving:function(){return!1},prepareSaveData:function(obj){},getDrawClientDimension:function(){return Kekule.HtmlElementUtils.getElemClientDimension(this.getCoreElement())},setDrawDimension:function(width,height){this.setDimension(width,height)},calcDrawBaseCoord:function(drawOptions){var baseCoord,newDimension,context=this.getDrawContext(),painter=this.getPainter();if(!this._isContinuousRepainting&&this.getAutoSize()&&this.allowAutoSize()){var padding=this.getPadding()||0,renderBox=painter.estimateScreenBox(context,baseCoord,drawOptions,this.getAllowCoordBorrow());if(renderBox){var width=renderBox.x2-renderBox.x1+2*padding,height=renderBox.y2-renderBox.y1+2*padding;this.changeContextDimension({width:width,height:height}),this.setDrawDimension(width,height),newDimension={width:width,height:height},baseCoord={x:width/2,y:height/2}}}else if(!(baseCoord=drawOptions?drawOptions.baseCoord:null)){var dim=this.getDrawClientDimension();baseCoord={x:dim.width/2,y:dim.height/2};var offset=this.getBaseCoordOffset();offset&&(baseCoord=Kekule.CoordUtils.add(baseCoord,offset))}return baseCoord=this.getDrawBridge().transformScreenCoordToContext(context,baseCoord),{baseCoord:baseCoord,baseCoordPos:Kekule.Render.CoordPos.CENTER,newWidgetDimension:newDimension}},getActualDrawOptions:function(){return this.getDrawOptions()},calcDrawParams:function(overrideOptions){var ops=this.getActualDrawOptions();overrideOptions&&(ops=Object.extend(ops,overrideOptions));var baseCoordResult=this.calcDrawBaseCoord(ops);return{drawOptions:ops,baseCoord:baseCoordResult.baseCoord,baseCoordPos:baseCoordResult.baseCoordPos,newWidgetDimension:baseCoordResult.newWidgetDimension}},_savePainterInitialRenderTransformOptions:function(context,painter){var actualTransformOps=painter.getActualInitialRenderTransformOptions(context);this._contextTransformOpsMap.set(context,actualTransformOps)},repaint:function(overrideOptions){this.beginPaint();try{if(overrideOptions&&overrideOptions.doNotClear||this.clearContext(),!this.getChemObj())return;var drawParams,transformOps,painter=this.getPainter(),context=this.getDrawContext(),transformOpsChanged=!0;overrideOptions&&overrideOptions.preserveTransformOptions?(transformOps=this._contextTransformOpsMap.get(context)||null,transformOpsChanged=!1,drawParams=this.calcDrawParams(transformOps)):drawParams=this.calcDrawParams(overrideOptions),this._lastBaseCoord=drawParams.baseCoord,painter.draw(context,drawParams.baseCoord,drawParams.drawOptions),transformOpsChanged&&this._savePainterInitialRenderTransformOptions(context,painter)}finally{this.endPaint()}},beginPaint:function(){this._paintFlag||(this._paintFlag=0),++this._paintFlag},endPaint:function(){this._paintFlag>0&&--this._paintFlag,this._paintFlag<0&&(this._paintFlag=0)},isPainting:function(){return this._paintFlag>0},getBackgroundColorOfType:function(renderType){return this._bgColorMap[renderType.toString()]},setBackgroundColorOfType:function(color,renderType){this._bgColorMap[renderType.toString()]=color,renderType===this.getRenderType()&&this.setBackgroundColor(color)},backgroundColorChanged:function(doNotRepaint){var color=this.getBackgroundColor();"transparent"===color&&(color=null);var drawBridge=this.getDrawBridge(!0);drawBridge&&drawBridge.setClearColor&&(drawBridge.setClearColor(this.getDrawContext(),color),doNotRepaint||this.repaint())},drawOptionChanged:function(){this.repaint()},geometryOptionChanged:function(){var painter=this.getPainter(),drawOptions=this.getDrawOptions();if(painter.supportGeometryOptionChange()){var context=this.getDrawContext();painter.changeGeometryOptions(context,drawOptions.baseCoord||this._lastBaseCoord,drawOptions),this._savePainterInitialRenderTransformOptions(context,painter)}else this.drawOptionChanged()},beginContinuousRepainting:function(){this._isContinuousRepainting=!0},endContinuousRepainting:function(){this._isContinuousRepainting&&(this._isContinuousRepainting=!1,this.repaint())},resetDisplay:function(){var op=this.getDrawOptions();return op.zoom=1,op.rotateX=0,op.rotateY=0,op.rotateZ=0,op.rotateAngle=0,op.rotateAxisVector=null,op.rotateMatrix=null,this.setBaseCoordOffset(null),this.geometryOptionChanged(),this},getCurrZoom:function(){return this.getDrawOptions().zoom||1},zoomTo:function(value,suspendRendering){return this.getDrawOptions().zoom=value,suspendRendering||this.geometryOptionChanged(),this},zoomIn:function(step){var curr=this.getCurrZoom(),ratio=ZU.getNextZoomInRatio(curr,step||1);return this.zoomTo(ratio)},zoomOut:function(step){var curr=this.getCurrZoom(),ratio=ZU.getNextZoomOutRatio(curr,step||1);return this.zoomTo(ratio)},resetZoom:function(){return this.zoomTo(1)},getDefaultMoleculeDisplayType:function(renderType){return renderType===Kekule.Render.RendererType.R3D?Kekule.Render.Molecule3DDisplayType.DEFAULT:Kekule.Render.Molecule2DDisplayType.DEFAULT},getCurrMoleculeDisplayType:function(){var result=this.getDrawOptions().moleculeDisplayType;return result||(result=this.getDefaultMoleculeDisplayType(this.getRenderType())),result},setHideHydrogens:function(newValue){return this.getDrawOptions().hideHydrogens=newValue,this.drawOptionChanged(),this},exportToDataUri:function(dataType,options){return this.getDrawBridge().exportToDataUri(this.getDrawContext(),dataType,options)},createConfigurator:function($super){var result=$super();return result.addEventListener("configChange",function(e){this.repaint()},this),result}}),Kekule.ChemWidget.ChemObjDisplayer.Settings=Class.create(Kekule.Widget.BaseWidget.Settings,{CLASS_NAME:"Kekule.ChemWidget.ChemObjDisplayer.Settings",initialize:function($super,displayer){$super(displayer)},initProperties:function(){this.defineDelegatedProps(["enableLoadNewFile"])},getDisplayer:function(){return this.getWidget()}}),Kekule.ChemWidget.ChemObjDisplayer.Configurator=Class.create(Kekule.Widget.Configurator,{CLASS_NAME:"Kekule.ChemWidget.ChemObjDisplayer.Configurator",TAB_BTN_DATA_FIELD:"__$data__",initialize:function($super,displayer){$super(displayer)},initPropValues:function($super){$super(),this.setLayout(Kekule.Widget.Layout.HORIZONTAL)},getCategoryInfos:function($super){for(var result=$super(),displayer=this.getDisplayer(),configObjs=[displayer.getDisplayerConfigs(),displayer.getRenderConfigs()],j=0,k=configObjs.length;j<k;++j)for(var config=configObjs[j],props=config.getPropListOfScopes([Class.PropertyScope.PUBLISHED]),i=0,l=props.getLength();i<l;++i){var propInfo=props.getPropInfoAt(i),obj=config.getPropValue(propInfo.name);obj&&result.push({obj:obj,name:propInfo.name,title:propInfo.title,description:propInfo.description})}return result},getDisplayer:function(){return this.getWidget()}}),Kekule.ChemWidget.ActionDisplayerLoadFile=Class.create(Kekule.ActionLoadFileData,{CLASS_NAME:"Kekule.ChemWidget.ActionDisplayerLoadFile",HTML_CLASSNAME:CCNS.ACTION_LOADFILE,initialize:function($super,displayer){$super(),this.setDisplayer(displayer),this.setText(Kekule.$L("ChemWidgetTexts.CAPTION_LOADFILE")),this.setHint(Kekule.$L("ChemWidgetTexts.HINT_LOADFILE"))},initProperties:function(){this.defineProp("displayer",{dataType:"Kekule.ChemWidget.ChemObjDisplayer",serializable:!1})},doUpdate:function($super){$super();var displayer=this.getDisplayer();this.setEnabled(this.getEnabled()&&displayer&&displayer.getEnabled()&&displayer.getEnableLoadNewFile())},doDataLoaded:function(data,fileName,loaded){loaded&&this.getDisplayer().loadFromData(data,null,fileName)}}),Kekule.ChemWidget.ActionOnDisplayer=Class.create(Kekule.Action,{CLASS_NAME:"Kekule.ChemWidget.ActionOnDisplayer",initialize:function($super,displayer,caption,hint){$super(),this.setDisplayer(displayer),this.setText(caption),this.setHint(hint)},initProperties:function(){this.defineProp("displayer",{dataType:"Kekule.ChemWidget.ChemObjDisplayer",serializable:!1})},doUpdate:function(){var displayer=this.getDisplayer();this.setEnabled(displayer&&displayer.getChemObj()&&displayer.getChemObjLoaded()&&displayer.getEnabled())}}),Kekule.ChemWidget.ActionDisplayerClear=Class.create(Kekule.ChemWidget.ActionOnDisplayer,{CLASS_NAME:"Kekule.ChemWidget.ActionDisplayerClear",HTML_CLASSNAME:CCNS.ACTION_CLEAROBJS,initialize:function($super,displayer){$super(displayer,Kekule.$L("ChemWidgetTexts.CAPTION_CLEAROBJS"),Kekule.$L("ChemWidgetTexts.HINT_CLEAROBJS"))},doUpdate:function($super){$super();var displayer=this.getDisplayer();this.setEnabled(displayer&&displayer.getEnabled()&&displayer.getChemObj())},doExecute:function(target){this.getDisplayer().setChemObj(null)}}),Kekule.ChemWidget.ActionDisplayerLoadData=Class.create(Kekule.ChemWidget.ActionOnDisplayer,{CLASS_NAME:"Kekule.ChemWidget.ActionDisplayerLoadData",HTML_CLASSNAME:CCNS.ACTION_LOADDATA,initialize:function($super,displayer){$super(displayer,Kekule.$L("ChemWidgetTexts.CAPTION_LOADDATA"),Kekule.$L("ChemWidgetTexts.HINT_LOADDATA"))},finalize:function($super){$super()},initPropValues:function($super){$super(),this.setDialogShowType(Kekule.Widget.ShowHideType.DROPDOWN)},initProperties:function(){this.defineProp("dataDialog",{dataType:"Kekule.ChemWidget.LoadDataDialog",serializable:!1,setter:null,getter:function(){var result=this.getPropStoreFieldValue("dataDialog");return result||(result=this.createDataDialog(),this.setPropStoreFieldValue("dataDialog",result)),result}}),this.defineProp("dialogShowType",{dataType:DataType.INT})},createDataDialog:function(){var doc=this.getDisplayer().getDocument();return new Kekule.ChemWidget.LoadDataDialog(doc)},doUpdate:function($super){$super();var displayer=this.getDisplayer();this.setEnabled(displayer&&displayer.getEnabled()&&displayer.getEnableLoadNewFile())},doExecute:function(target){var self=this,dialog=this.getDataDialog();dialog.setAllowedFormatIds(this.getDisplayer().getAllowedInputFormatIds()||Kekule.IO.ChemDataReaderManager.getAllReadableFormatIds());var showType=(dialog._formatSelector,this.getDialogShowType());(showType===Kekule.Widget.ShowHideType.DIALOG?dialog.openModal:dialog.open).apply(dialog,[function(result){dialog.isPositiveResult(result)&&self.getDisplayer().load(dialog.getChemObj())},target,showType])}}),Kekule.ChemWidget.ActionDisplayerSaveFile=Class.create(Kekule.ChemWidget.ActionOnDisplayer,{CLASS_NAME:"Kekule.ChemWidget.ActionDisplayerSaveFile",HTML_CLASSNAME:CCNS.ACTION_SAVEFILE,initialize:function($super,displayer){$super(displayer,Kekule.$L("ChemWidgetTexts.CAPTION_SAVEFILE"),Kekule.$L("ChemWidgetTexts.HINT_SAVEFILE")),this._saveAction=new Kekule.ActionFileSave},finalize:function($super){this._saveAction.finalize(),$super()},initPropValues:function($super){$super(),this.setDialogShowType(Kekule.Widget.ShowHideType.DROPDOWN)},initProperties:function(){this.defineProp("formatDialog",{dataType:"Kekule.Widget.Dialog",serializable:!1,setter:null,getter:function(){var result=this.getPropStoreFieldValue("formatDialog");return result||(result=this.createFormatDialog(),this.setPropStoreFieldValue("formatDialog",result)),result}}),this.defineProp("lastFormat",{dataType:DataType.STRING,serializable:!1}),this.defineProp("currSaveData",{dataType:DataType.VARIANT,serializable:!1}),this.defineProp("dialogShowType",{dataType:DataType.INT})},getChemObjSrcInfo:function(chemObj){var displayer=this.getDisplayer();return displayer.getChemObjSrcInfo?displayer.getChemObjSrcInfo(chemObj):chemObj.getSrcInfo?chemObj.getSrcInfo():null},getChemObjSrcFormat:function(chemObj){var srcInfo=this.getChemObjSrcInfo(chemObj);return srcInfo?srcInfo.format:null},createFormatDialog:function(){var doc=this.getDisplayer().getDocument(),result=new Kekule.Widget.Dialog(doc,Kekule.$L("ChemWidgetTexts.CAPTION_CHOOSEFILEFORMAT"),[Kekule.Widget.DialogButtons.OK,Kekule.Widget.DialogButtons.CANCEL]);result.addClassName(CCNS.DIALOG_CHOOSE_FILE_FORAMT);var elem=doc.createElement("div");elem.innerHTML=Kekule.$L("ChemWidgetTexts.CAPTION_SELECT_FORMAT"),result.getClientElem().appendChild(elem),elem=doc.createElement("div"),result.getClientElem().appendChild(elem);var formatSelector=new Kekule.Widget.SelectBox(result);formatSelector.addClassName(CCNS.DIALOG_CHOOSE_FILE_FORAMT_FORMATBOX),formatSelector.appendToElem(elem),formatSelector.addEventListener("valueChange",this.reactFormatSelectorChange,this),result._formatSelector=formatSelector;var elem=doc.createElement("div");elem.innerHTML=Kekule.$L("ChemWidgetTexts.CAPTION_PREVIEW_FILE_CONTENT"),result.getClientElem().appendChild(elem),elem=doc.createElement("div"),result.getClientElem().appendChild(elem);var previewTextArea=new Kekule.Widget.TextEditor(result);return previewTextArea.setReadOnly(!0),previewTextArea.setWrap("off"),previewTextArea.setToolbarPos(Kekule.Widget.Position.BOTTOM),previewTextArea.addClassName(CCNS.DIALOG_CHOOSE_FILE_FORAMT_PREVIEWER),previewTextArea.appendToElem(elem),result._previewTextArea=previewTextArea,result},getAvailableWriterInfos:function(chemObj){if(chemObj){return Kekule.IO.ChemDataWriterManager.getAvailableWriterInfos(null,chemObj)}return[]},getFormatSelectorItems:function(chemObj,writerInfos){for(var result=[],formatIds=[],srcInfo=this.getChemObjSrcInfo(chemObj),srcFormat=srcInfo?srcInfo.format:null,i=0,l=writerInfos.length;i<l;++i){var info=writerInfos[i];Kekule.ArrayUtils.pushUnique(formatIds,info.formatId)}formatIds=Kekule.ArrayUtils.intersect(this.getAllowedFormatIds(),formatIds);for(var i=0,l=formatIds.length;i<l;++i){var idInfo=Kekule.IO.DataFormatsManager.getFormatInfo(formatIds[i]);if(idInfo){for(var fileExts=Kekule.ArrayUtils.clone(Kekule.ArrayUtils.toArray(idInfo.fileExts)),j=0,k=fileExts.length;j<k;++j)fileExts[j]="*."+fileExts[j];var sFileExt=fileExts.join(", "),text=idInfo.title;sFileExt&&(text+=" ("+sFileExt+")");var selected=srcFormat?formatIds[i]===srcFormat:this.getLastFormat()?this.getLastFormat()===formatIds[i]:0===i;result.push({value:idInfo.id,text:text,title:idInfo.mimeType,data:idInfo,selected:selected})}}return result.sort(function(a,b){return a.text<b.text?-1:a.text>b.text?1:0}),result},getAllowedFormatIds:function(){return this.getDisplayer().getAllowedOutputFormatIds()||Kekule.IO.ChemDataWriterManager.getAllWritableFormatIds()},getFileFilters:function(formatItems){for(var result=[],i=0,l=formatItems.length;i<l;++i){var format=formatItems[i],info=format.data,title=format.text||format.title||format.value,exts=Kekule.ArrayUtils.toArray(info.fileExts);result.push({title:title,filter:"."+exts.join(",.")})}return result.push(Kekule.NativeServices.FILTER_ALL_SUPPORT),result.push(Kekule.NativeServices.FILTER_ANY),result},updateFormatItems:function(chemObj){this._formatItems=this.getFormatSelectorItems(chemObj,this.getAvailableWriterInfos()),this._formatSelector.setItems(this._formatItems);var filters=this.getFileFilters(this._formatItems);this._saveAction.setFilters(filters)},reactFormatSelectorChange:function(){var formatId=this.getFormatDialog()._formatSelector.getValue();this.updatePreview(formatId,this.getFormatDialog())},updatePreview:function(formatId,dialogWidget){var textArea=dialogWidget._previewTextArea;if(textArea.setValue(""),formatId){var formatInfo=Kekule.IO.DataFormatsManager.getFormatInfo(formatId),obj=this.getTargetObj(),srcInfo=this.getChemObjSrcInfo(obj);if(srcInfo&&srcInfo.format===formatId&&srcInfo.data)textArea.setValue(srcInfo.data),this.setCurrSaveData(srcInfo.data);else{var data=this.getDisplayer().saveData(formatId,formatInfo.dataType,obj);textArea.setValue(data),this.setCurrSaveData(data)}}},getTargetObj:function(formatId){return this.getDisplayer().getSavingTargetObj()},doUpdate:function($super){$super();var displayer=this.getDisplayer();this._saveAction&&this._saveAction.update(),this.setEnabled(displayer&&displayer.getEnabled()&&displayer.getChemObj())},doExecute:function(target){var self=this,dialog=this.getFormatDialog(),chemObj=this.getTargetObj(),formatSelector=dialog._formatSelector,writerInfos=this.getAvailableWriterInfos(chemObj),formatItems=this.getFormatSelectorItems(chemObj,writerInfos);formatSelector.setItems(formatItems),this.reactFormatSelectorChange();var saveEnabled=!1;this._saveAction&&(saveEnabled=this._saveAction.getEnabled());var btn=dialog.getDialogButton(Kekule.Widget.DialogButtons.OK);btn&&btn.setEnabled(saveEnabled);var showType=this.getDialogShowType();(showType===Kekule.Widget.ShowHideType.DIALOG?dialog.openModal:dialog.open).apply(dialog,[function(result){if(result===Kekule.Widget.DialogButtons.OK){var data=self.getCurrSaveData();self._saveAction.setData(data);var formatId=dialog._formatSelector.getValue();self.setLastFormat(formatId);var formatInfo=Kekule.IO.DataFormatsManager.getFormatInfo(formatId),fileExts=formatInfo.fileExts,ext=Kekule.ArrayUtils.toArray(fileExts[0]||fileExts),filters=[{title:formatInfo.title||formatInfo.mimeType,filter:"."+ext.join(",.")},Kekule.NativeServices.FILTER_ANY],fileName=Kekule.$L("ChemWidgetTexts.S_DEF_SAVE_FILENAME")+"."+ext;self._saveAction.setFileName(fileName),self._saveAction.setFilters(filters),self._saveAction.execute(target)}},target,showType])}}),Kekule.ChemWidget.ActionDisplayerReset=Class.create(Kekule.ChemWidget.ActionOnDisplayer,{CLASS_NAME:"Kekule.ChemWidget.ActionDisplayerReset",HTML_CLASSNAME:CCNS.ACTION_RESET,initialize:function($super,displayer){$super(displayer,Kekule.$L("ChemWidgetTexts.CAPTION_RESETVIEW"),Kekule.$L("ChemWidgetTexts.HINT_RESETVIEW"))},doExecute:function(){this.getDisplayer().resetDisplay()}}),Kekule.ChemWidget.ActionDisplayerZoomIn=Class.create(Kekule.ChemWidget.ActionOnDisplayer,{CLASS_NAME:"Kekule.ChemWidget.ActionDisplayerZoomIn",HTML_CLASSNAME:CCNS.ACTION_ZOOMIN,initialize:function($super,displayer){$super(displayer,Kekule.$L("ChemWidgetTexts.CAPTION_ZOOMIN"),Kekule.$L("ChemWidgetTexts.HINT_ZOOMIN"))},doExecute:function(){this.getDisplayer().zoomIn()}}),Kekule.ChemWidget.ActionDisplayerZoomOut=Class.create(Kekule.ChemWidget.ActionOnDisplayer,{CLASS_NAME:"Kekule.ChemWidget.ActionDisplayerZoomOut",HTML_CLASSNAME:CCNS.ACTION_ZOOMOUT,initialize:function($super,displayer){$super(displayer,Kekule.$L("ChemWidgetTexts.CAPTION_ZOOMOUT"),Kekule.$L("ChemWidgetTexts.HINT_ZOOMOUT"))},doExecute:function(){this.getDisplayer().zoomOut()}}),Kekule.ChemWidget.ActionDisplayerResetZoom=Class.create(Kekule.ChemWidget.ActionOnDisplayer,{CLASS_NAME:"Kekule.ChemWidget.ActionDisplayerResetZoom",HTML_CLASSNAME:CCNS.ACTION_RESETZOOM,initialize:function($super,displayer){$super(displayer,Kekule.$L("ChemWidgetTexts.CAPTION_RESETZOOM"),Kekule.$L("ChemWidgetTexts.HINT_RESETZOOM"))},doExecute:function(){this.getDisplayer().resetZoom()}}),Kekule.ChemWidget.ActionDisplayerHideHydrogens=Class.create(Kekule.ChemWidget.ActionOnDisplayer,{CLASS_NAME:"Kekule.ChemWidget.ActionDisplayerHideHydrogens",HTML_CLASSNAME:CCNS.ACTION_MOL_HIDE_HYDROGENS,initialize:function($super,displayer){$super(displayer,Kekule.$L("ChemWidgetTexts.CAPTION_HIDEHYDROGENS"),Kekule.$L("ChemWidgetTexts.HINT_HIDEHYDROGENS"))},doUpdate:function($super){$super();var displayer=this.getDisplayer(),flag=displayer&&displayer.getRenderType()===Kekule.Render.RendererType.R3D;this.setDisplayed(flag).setEnabled(this.getEnabled()&&flag)},doExecute:function(){var checked=!this.getChecked();this.setChecked(checked),this.getDisplayer().setHideHydrogens(checked)}}),Kekule.ChemWidget.ActionDisplayerChangeMolDisplayTypeBase=Class.create(Kekule.ChemWidget.ActionOnDisplayer,{CLASS_NAME:"Kekule.ChemWidget.ActionDisplayerChangeMolDisplayTypeBase",initialize:function($super,displayer,caption,hint,displayType){$super(displayer,caption,hint),this._displayType=displayType,this.setCheckGroup("__molDisplayType__")},doUpdate:function($super){$super();var displayer=this.getDisplayer();this.setChecked(displayer&&displayer.getCurrMoleculeDisplayType()===this.getMolDisplayType())},doExecute:function(){this.getDisplayer().setMoleculeDisplayType(this._displayType),this.setChecked(!0)},getMolDisplayType:function(){return this._displayType}}),Kekule.ChemWidget.ActionDisplayerChangeMolDisplayTypeBase2D=Class.create(Kekule.ChemWidget.ActionDisplayerChangeMolDisplayTypeBase,{CLASS_NAME:"Kekule.ChemWidget.ActionDisplayerChangeMolDisplayTypeBase2D",doUpdate:function($super){$super();var displayer=this.getDisplayer(),flag=displayer&&displayer.getRenderType()===Kekule.Render.RendererType.R2D;this.setDisplayed(flag).setEnabled(this.getEnabled()&&flag)}}),Kekule.ChemWidget.ActionDisplayerChangeMolDisplayTypeBase3D=Class.create(Kekule.ChemWidget.ActionDisplayerChangeMolDisplayTypeBase,{CLASS_NAME:"Kekule.ChemWidget.ActionDisplayerChangeMolDisplayTypeBase3D",doUpdate:function($super){$super();var displayer=this.getDisplayer(),flag=displayer&&displayer.getRenderType()===Kekule.Render.RendererType.R3D;this.setDisplayed(flag).setEnabled(this.getEnabled()&&flag)}}),Kekule.ChemWidget.ActionDisplayerChangeMolDisplayTypeSkeletal=Class.create(Kekule.ChemWidget.ActionDisplayerChangeMolDisplayTypeBase2D,{CLASS_NAME:"Kekule.ChemWidget.ActionDisplayerChangeMolDisplayTypeSkeletal",HTML_CLASSNAME:CCNS.ACTION_MOL_DISPLAY_SKELETAL,initialize:function($super,viewer){$super(viewer,Kekule.$L("ChemWidgetTexts.CAPTION_SKELETAL"),Kekule.$L("ChemWidgetTexts.HINT_SKELETAL"),Kekule.ChemWidget.ActionDisplayerChangeMolDisplayTypeSkeletal.TYPE)}}),Kekule.ChemWidget.ActionDisplayerChangeMolDisplayTypeSkeletal.TYPE=Kekule.Render.Molecule2DDisplayType.SKELETAL,Kekule.ChemWidget.ActionDisplayerChangeMolDisplayTypeCondensed=Class.create(Kekule.ChemWidget.ActionDisplayerChangeMolDisplayTypeBase2D,{CLASS_NAME:"Kekule.ChemWidget.ActionDisplayerChangeMolDisplayTypeCondensed",HTML_CLASSNAME:CCNS.ACTION_MOL_DISPLAY_CONDENSED,initialize:function($super,viewer){$super(viewer,Kekule.$L("ChemWidgetTexts.CAPTION_CONDENSED"),Kekule.$L("ChemWidgetTexts.HINT_CONDENSED"),Kekule.ChemWidget.ActionDisplayerChangeMolDisplayTypeCondensed.TYPE)}}),Kekule.ChemWidget.ActionDisplayerChangeMolDisplayTypeCondensed.TYPE=Kekule.Render.Molecule2DDisplayType.CONDENSED,Kekule.ChemWidget.ActionDisplayerChangeMolDisplayTypeWire=Class.create(Kekule.ChemWidget.ActionDisplayerChangeMolDisplayTypeBase3D,{CLASS_NAME:"Kekule.ChemWidget.ActionDisplayerChangeMolDisplayTypeWire",HTML_CLASSNAME:CCNS.ACTION_MOL_DISPLAY_WIRE,initialize:function($super,viewer){$super(viewer,Kekule.$L("ChemWidgetTexts.CAPTION_WIRE"),Kekule.$L("ChemWidgetTexts.HINT_WIRE"),Kekule.ChemWidget.ActionDisplayerChangeMolDisplayTypeWire.TYPE)}}),Kekule.ChemWidget.ActionDisplayerChangeMolDisplayTypeWire.TYPE=Kekule.Render.Molecule3DDisplayType.WIRE,Kekule.ChemWidget.ActionDisplayerChangeMolDisplayTypeSticks=Class.create(Kekule.ChemWidget.ActionDisplayerChangeMolDisplayTypeBase3D,{CLASS_NAME:"Kekule.ChemWidget.ActionDisplayerChangeMolDisplayTypeSticks",HTML_CLASSNAME:CCNS.ACTION_MOL_DISPLAY_STICKS,initialize:function($super,viewer){$super(viewer,Kekule.$L("ChemWidgetTexts.CAPTION_STICKS"),Kekule.$L("ChemWidgetTexts.HINT_STICKS"),Kekule.ChemWidget.ActionDisplayerChangeMolDisplayTypeSticks.TYPE)}}),Kekule.ChemWidget.ActionDisplayerChangeMolDisplayTypeSticks.TYPE=Kekule.Render.Molecule3DDisplayType.STICKS,Kekule.ChemWidget.ActionDisplayerChangeMolDisplayTypeBallStick=Class.create(Kekule.ChemWidget.ActionDisplayerChangeMolDisplayTypeBase3D,{CLASS_NAME:"Kekule.ChemWidget.ActionDisplayerChangeMolDisplayTypeBallStick",HTML_CLASSNAME:CCNS.ACTION_MOL_DISPLAY_BALLSTICK,initialize:function($super,viewer){$super(viewer,Kekule.$L("ChemWidgetTexts.CAPTION_BALLSTICK"),Kekule.$L("ChemWidgetTexts.HINT_BALLSTICK"),Kekule.ChemWidget.ActionDisplayerChangeMolDisplayTypeBallStick.TYPE)}}),Kekule.ChemWidget.ActionDisplayerChangeMolDisplayTypeBallStick.TYPE=Kekule.Render.Molecule3DDisplayType.BALL_STICK,Kekule.ChemWidget.ActionDisplayerChangeMolDisplayTypeSpaceFill=Class.create(Kekule.ChemWidget.ActionDisplayerChangeMolDisplayTypeBase3D,{CLASS_NAME:"Kekule.ChemWidget.ActionDisplayerChangeMolDisplayTypeSpaceFill",HTML_CLASSNAME:CCNS.ACTION_MOL_DISPLAY_SPACEFILL,initialize:function($super,viewer){$super(viewer,Kekule.$L("ChemWidgetTexts.CAPTION_SPACEFILL"),Kekule.$L("ChemWidgetTexts.HINT_SPACEFILL"),Kekule.ChemWidget.ActionDisplayerChangeMolDisplayTypeSpaceFill.TYPE)}}),Kekule.ChemWidget.ActionDisplayerChangeMolDisplayTypeSpaceFill.TYPE=Kekule.Render.Molecule3DDisplayType.SPACE_FILL,Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,DataType=__webpack_require__(0).DataType;module.exports=function(Kekule){var CCNS=Kekule.ChemWidget.HtmlClassNames;return Kekule.ChemWidget.HtmlClassNames=Object.extend(Kekule.ChemWidget.HtmlClassNames,{CHEM_STRUCT_TREE_VIEW:"K-Chem-Struct-TreeView",CHEM_STRUCT_TREE_VIEW_ITEM_TITLE:"K-Chem-Struct-TreeView-ItemTitle",CHEM_STRUCT_TREE_VIEW_ITEM_TYPE:"K-Chem-Struct-TreeView-ItemType"}),Kekule.ChemWidget.StructureTreeView=Class.create(Kekule.Widget.TreeView,{CLASS_NAME:"Kekule.ChemWidget.StructureTreeView",initialize:function($super,parentOrElementOrDocument,rootObj){$super(parentOrElementOrDocument),this.setPropStoreFieldValue("objMap",new Kekule.MapEx(!0)),this.setEnableLiveUpdate(!0),this.setEnableMultiSelected(!0),this.setRootObj(rootObj)},initProperties:function(){this.defineProp("rootObj",{dataType:"Kekule.ChemObject",serializable:!1,setter:function(value){var oldObj=this.getPropStoreFieldValue("rootObj");this.setPropStoreFieldValue("rootObj",value),this.rootObjChanged(value,oldObj)}}),this.defineProp("enableLiveUpdate",{dataType:DataType.BOOL}),this.defineProp("objMap",{dataType:"Kekule.MapEx",setter:null,serializable:!1})},doGetWidgetClassName:function($super){return $super()+" "+CCNS.CHEM_STRUCT_TREE_VIEW},rootObjChanged:function(newValue,oldValue){this.clearChildItems(),this.getObjMap().clear(),oldValue&&this._uninstallRootEventHandler(oldValue),newValue&&(this._fillTree(newValue),this._installRootEventHandler(newValue))},_installRootEventHandler:function(root){root.addEventListener("change",this.reactChemObjChange,this)},_uninstallRootEventHandler:function(root){root.removeEventListener("change",this.reactChemObjChange,this)},reactChemObjChange:function(e){if(this.getEnableLiveUpdate()){var obj=e.target,treeItem=this.getObjMap().get(obj);treeItem&&this._updateTreeItem(treeItem,obj)}},_fillTree:function(rootObj){rootObj&&(this.clearChildItems(),this._updateTreeItem(this.appendChildItem(),rootObj))},_updateTreeItem:function(treeItem,chemObj){var title=this._getChemObjDisplayTitle(chemObj),data={text:title,obj:chemObj};this.setItemData(treeItem,data),this.getObjMap().set(chemObj,treeItem);for(var oldChildItemCount=this.getChildItemCount(treeItem),l=chemObj.getChildCount(),i=0;i<l;++i){var child=chemObj.getChildAt(i);if(child.isSelectable()){var childItem;childItem=i<oldChildItemCount?this.getChildItemAt(treeItem,i):this.appendChildItem(treeItem),this._updateTreeItem(childItem,child)}}if(oldChildItemCount>l)for(var i=oldChildItemCount-1;i>=l;--i)this.removeChildItemAt(treeItem,i)},_getChemObjDisplayTitle:function(chemObj){var result="",id=chemObj.getId();id&&(result+='<span class="'+CCNS.CHEM_STRUCT_TREE_VIEW_ITEM_TITLE+'">'+id+"</span>");var className=chemObj.getClassName(),cnameParts=className.split("."),cname=cnameParts.length?cnameParts[cnameParts.length-1]:className;return result+'<span class="'+CCNS.CHEM_STRUCT_TREE_VIEW_ITEM_TYPE+'">('+cname+")</span>"},selectChemObjs:function(chemObjs){for(var items=[],i=0,l=chemObjs.length;i<l;++i){var obj=chemObjs[i],item=this.getObjMap().get(obj);item&&items.push(item)}return this.select(items),this},getSelectedChemObjs:function(){var result=[],items=this.getSelection();if(items&&items.length)for(var i=0,l=items.length;i<l;++i){var data=this.getItemData(items[i]);data&&data.obj&&result.push(data.obj)}return result}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,ObjectEx=__webpack_require__(0).ObjectEx,DataType=__webpack_require__(0).DataType;module.exports=function(Kekule){return Kekule.ChemWidget.AbstractUIMarker=Class.create(ObjectEx,{CLASS_NAME:"Kekule.ChemWidget.AbstractUIMarker",initialize:function($super){$super(),this.setVisible(!0)},initProperties:function(){this.defineProp("drawStyles",{dataType:DataType.OBJECT}),this.defineProp("visible",{dataType:DataType.BOOL})}}),Kekule.ChemWidget.MetaShapeUIMarker=Class.create(Kekule.ChemWidget.AbstractUIMarker,{CLASS_NAME:"Kekule.ChemWidget.MetaShapeUIMarker",initialize:function($super,shapeInfo){$super(),shapeInfo&&this.setShapeInfo(shapeInfo)},initProperties:function(){this.defineProp("shapeInfo",{dataType:DataType.OBJECT}),this.defineProp("shapeType",{dataType:DataType.INT,serializable:!1,setter:null,getter:function(){var info=this.getShapeInfo();return info?info.shapeType:null}})}}),Kekule.ChemWidget.UiMarkerCollection=Class.create(ObjectEx,{CLASS_NAME:"Kekule.ChemWidget.UiMarkerCollection",initProperties:function(){this.defineProp("markers",{dataType:DataType.ARRAY,getter:function(){var result=this.getPropStoreFieldValue("markers");return result||(result=[],this.setPropStoreFieldValue("markers",result)),result},setter:null})},getMarkerCount:function(){return this.getMarkers().length},getMarkerAt:function(index){return this.getMarkers()[index]},addMarker:function(marker){return this.getMarkers().push(marker)},indexOfMarker:function(marker){return this.getMarkers().indexOf(marker)},removeMarker:function(marker){var markers=this.getMarkers(),index=markers.indexOf(marker);index>=0&&markers.splice(index,1)},clearMarkers:function(){this.setPropStoreFieldValue("markers",[])}}),Kekule.ChemWidget.UiMarkersRenderer=Class.create(Kekule.Render.Base2DRenderer,{CLASS_NAME:"Kekule.ChemWidget.UiMarkersRenderer",DRAW_ELEM_FIELD:"__$drawElem__",initialize:function($super,obj,renderBridge){$super(obj,renderBridge),this._drawGroup=null},initProperties:function(){this.defineProp("dummy",{dataType:DataType.OBJECT,serializable:!1})},getObjDrawElem:function(context,obj){return this.getExtraProp2(context,obj,this.DRAW_ELEM_FIELD)},setObjDrawElem:function(context,obj,value){this.setExtraProp2(context,obj,this.DRAW_ELEM_FIELD,value)},doEstimateRenderBox:function(context,baseCoord,options,allowCoordBorrow){return null},doDraw:function($super,context,baseCoord,options){$super(context,baseCoord,options);var collection=this.getChemObj(),group=this.createDrawGroup(context);return this.setObjDrawElem(context,collection,group),collection.getMarkerCount()>0&&this.doDrawMarkers(context,group,collection.getMarkers(),options),group},doUpdate:function($super,context,updatedObjDetails,updateType){if(this.canModifyGraphic(context)){var r=!1,T=Kekule.Render.ObjectUpdateType;switch(updateType){case T.ADD:r=this.doAddNew(context,updatedObjDetails);break;case T.MODIFY:r=this.doModify(context,updatedObjDetails);break;case T.REMOVE:var objs=this._extractObjsOfUpdateObjDetails(updatedObjDetails);r=this.doRemove(context,objs);break;default:return $super(context,updatedObjDetails,updateType)}return r}return $super(context,updatedObjDetails,updateType)},doAddNew:function(context,updatedObjDetails){return!!this.canRemoveElem()&&this.doModify(context,updatedObjDetails)},doModify:function(context,updatedObjDetails){if(!this.canRemoveElem())return!1;var objs=this._extractObjsOfUpdateObjDetails(updatedObjDetails);this.remove(context,objs);var chemObj=this.getChemObj(),group=this.getObjDrawElem(chemObj),params=this.getDrawParams();objs.indexOf(chemObj)>=0?this.draw(context,params.baseCoord,params.options):this.doDrawMarkers(context,group,objs,params.options)},doRemove:function(context,removedObj){if(!this.canRemoveElem())return!1;var elem=this.getObjDrawElem(removedObj);if(elem){var group=this.getObjDrawElem(this.getChemObj());this.doRemoveFromGroup(elem,group),this.doRemoveElem(context,elem),this.setObjDrawElem(removedObj,null)}},doDrawMarkers:function(context,group,markers,options){for(var i=0,l=markers.length;i<l;++i){var marker=markers[i];marker.getVisible()&&this.doDrawMarker(context,group,marker,options)}},doDrawMarker:function(context,group,marker,options){var shapeInfo=marker.getShapeInfo();if(!shapeInfo)return null;var ops=Object.create(options);ops=Object.extend(marker.getDrawStyles()||{}),ops.color&&(ops.strokeColor||(ops.strokeColor=ops.color),ops.fillColor||(ops.fillColor=ops.color));var result;if(Kekule.ArrayUtils.isArray(shapeInfo))if(shapeInfo.length>1){result=this.createDrawGroup(context);for(var i=0,l=shapeInfo.length;i<l;++i){var shape=shapeInfo[i];this.doDrawShape(context,result,shape,ops)}}else{if(1!==shapeInfo.length)return null;result=this.doDrawShape(context,null,shapeInfo[0],ops)}else result=this.doDrawShape(context,null,shapeInfo,ops);return result&&(this.setObjDrawElem(context,marker,result),group&&this.addToDrawGroup(result,group)),result},doDrawShape:function(context,markerGroup,shape,options){var result,T=Kekule.Render.MetaShapeType;if(Kekule.Render.MetaShapeUtils.isCompositeShape(shape)){result=this.createDrawGroup(context);for(var i=0,l=shape.length;i<l;++i){this.doDrawShape(context,result,shape[i],options)}}else{var coords=shape.coords;switch(shape.shapeType){case T.POINT:result=this.drawCircle(context,coords[0],1,options);break;case T.CIRCLE:result=this.drawCircle(context,coords[0],shape.radius,options);break;case T.LINE:var ops=options;shape.width&&(ops=Object.create(options),ops.strokeWidth=shape.width),result=this.drawLine(context,coords[0],coords[1],ops);break;case T.RECT:result=this.drawRect(context,coords[0],coords[1],options);break;case T.POLYGON:for(var args=[],i=0,l=coords.length;i<l;++i){var sMethod=0===i?"M":"L";args.push(sMethod);var coordArray=[coords[i].x,coords[i].y];args.push(coordArray)}args.push("L"),coordArray=[coords[0].x,coords[0].y],args.push(coordArray);var path=Kekule.Render.DrawPathUtils.makePath.apply(this,args);result=this.drawPath(context,path,options)}}return markerGroup&&this.addToDrawGroup(result,markerGroup),result}}),Kekule.ClassDefineUtils.addExtraTwoTupleObjMapSupport(Kekule.ChemWidget.UiMarkersRenderer),Kekule.Render.Renderer2DFactory.register(Kekule.ChemWidget.UiMarkerCollection,Kekule.ChemWidget.UiMarkersRenderer),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,ClassEx=__webpack_require__(0).ClassEx,DataType=__webpack_require__(0).DataType;module.exports=function(Kekule){var PS=Class.PropertyScope,BNS=Kekule.ChemWidget.ComponentWidgetNames,CW=Kekule.ChemWidget,EM=Kekule.Widget.EvokeMode;Kekule.globalOptions.add("chemWidget.viewer",{toolButtons:[BNS.loadData,BNS.saveData,BNS.molDisplayType,BNS.molHideHydrogens,BNS.zoomIn,BNS.zoomOut,BNS.rotateX,BNS.rotateY,BNS.rotateZ,BNS.rotateLeft,BNS.rotateRight,BNS.reset,BNS.openEditor],menuItems:[BNS.loadData,BNS.saveData,Kekule.Widget.MenuItem.SEPARATOR_TEXT,BNS.molDisplayType,BNS.molHideHydrogens,BNS.zoomIn,BNS.zoomOut,{text:Kekule.$L("ChemWidgetTexts.CAPTION_ROTATE"),hint:Kekule.$L("ChemWidgetTexts.HINT_ROTATE"),children:[BNS.rotateLeft,BNS.rotateRight,BNS.rotateX,BNS.rotateY,BNS.rotateZ]},BNS.reset,Kekule.Widget.MenuItem.SEPARATOR_TEXT,BNS.openEditor,BNS.config]}),Kekule.ChemWidget.HtmlClassNames=Object.extend(Kekule.ChemWidget.HtmlClassNames,{VIEWER:"K-Chem-Viewer",VIEWER2D:"K-Chem-Viewer2D",VIEWER3D:"K-Chem-Viewer3D",VIEWER_CAPTION:"K-Chem-Viewer-Caption",VIEWER_EMBEDDED_TOOLBAR:"K-Chem-Viewer-Embedded-Toolbar",VIEWER_MENU_BUTTON:"K-Chem-Viewer-Menu-Button",ACTION_ROTATE_LEFT:"K-Chem-RotateLeft",ACTION_ROTATE_RIGHT:"K-Chem-RotateRight",ACTION_ROTATE_X:"K-Chem-RotateX",ACTION_ROTATE_Y:"K-Chem-RotateY",ACTION_ROTATE_Z:"K-Chem-RotateZ",ACTION_VIEWER_EDIT:"K-Chem-Viewer-Edit"});var CNS=Kekule.Widget.HtmlClassNames,CCNS=Kekule.ChemWidget.HtmlClassNames;Kekule.ChemWidget.Viewer=Class.create(Kekule.ChemWidget.ChemObjDisplayer,{CLASS_NAME:"Kekule.ChemWidget.Viewer",BINDABLE_TAG_NAMES:["div","span","img"],DEF_BGCOLOR_2D:null,DEF_BGCOLOR_3D:"#000000",DEF_TOOLBAR_EVOKE_MODES:[EM.EVOKEE_CLICK,EM.EVOKEE_MOUSE_ENTER,EM.EVOKEE_TOUCH],DEF_TOOLBAR_REVOKE_MODES:[EM.EVOKEE_MOUSE_LEAVE,EM.EVOKER_TIMEOUT],initialize:function($super,parentOrElementOrDocument,chemObj,renderType,viewerConfigs){this.setPropStoreFieldValue("renderType",renderType||Kekule.Render.RendererType.R2D),this.setPropStoreFieldValue("enableToolbar",!1),this.setPropStoreFieldValue("toolbarEvokeModes",this.DEF_TOOLBAR_EVOKE_MODES),this.setPropStoreFieldValue("toolbarRevokeModes",this.DEF_TOOLBAR_REVOKE_MODES),this.setPropStoreFieldValue("enableDirectInteraction",!0),this.setPropStoreFieldValue("enableTouchInteraction",!0),this.setPropStoreFieldValue("toolbarPos",Kekule.Widget.Position.AUTO),this.setPropStoreFieldValue("toolbarMarginHorizontal",10),this.setPropStoreFieldValue("toolbarMarginVertical",10),this.setPropStoreFieldValue("showCaption",!1),this.setPropStoreFieldValue("useCornerDecoration",!0),$super(parentOrElementOrDocument,chemObj,renderType,viewerConfigs),this.setPadding(this.getRenderConfigs().getLengthConfigs().getActualLength("autofitContextPadding")),this._isContinuousRepainting=!1;var RT=Kekule.Render.RendererType,color2D=this.getRenderType()===RT.R2D?this.getBackgroundColor()||this.DEF_BGCOLOR_2D:this.DEF_BGCOLOR_2D,color3D=this.getRenderType()===RT.R3D?this.getBackgroundColor()||this.DEF_BGCOLOR_3D:this.DEF_BGCOLOR_3D;this.setBackgroundColorOfType(color2D,RT.R2D),this.setBackgroundColorOfType(color3D,RT.R3D),this.useCornerDecorationChanged(),this.doResize(),this.addIaController("default",new Kekule.ChemWidget.ViewerBasicInteractionController(this),!0)},doFinalize:function($super){var toolBar=this.getToolbar();toolBar&&toolBar.finalize(),$super()},initProperties:function(){this.defineProp("viewerConfigs",{dataType:"Kekule.ChemWidget.ChemObjDisplayerConfigs",serializable:!1,getter:function(){return this.getDisplayerConfigs()},setter:function(value){return this.setDisplayerConfigs(value)}}),this.defineProp("allowedMolDisplayTypes",{dataType:DataType.ARRAY,scope:PS.PUBLIC,setter:function(value){this.setPropStoreFieldValue("allowedMolDisplayTypes",value),this.updateUiComps()}}),this.defineProp("enableRestraintRotation3D",{dataType:DataType.BOOL}),this.defineProp("restraintRotation3DEdgeRatio",{dataType:DataType.FLOAT}),this.defineProp("enableEdit",{dataType:DataType.BOOL,getter:function(){return this.getPropStoreFieldValue("enableEdit")&&this.getCoordMode()!==Kekule.CoordMode.COORD3D}}),this.defineProp("shareEditorInstance",{dataType:DataType.BOOL}),this.defineProp("enableEditFromVoid",{dataType:DataType.BOOL}),this.defineProp("restrainEditorWithCurrObj",{dataType:DataType.BOOL}),this.defineProp("modalEdit",{dataType:DataType.BOOL}),this.defineProp("editorProperties",{dataType:DataType.HASH}),this.defineProp("toolButtons",{dataType:DataType.ARRAY,scope:PS.PUBLIC,getter:function(){return this.getPropStoreFieldValue("toolButtons")},setter:function(value){this.setPropStoreFieldValue("toolButtons",value),this.updateToolbar()}}),this.defineProp("menuItems",{dataType:DataType.ARRAY,scope:PS.PUBLIC,setter:function(value){this.setPropStoreFieldValue("menuItems",value),this.updateMenu()}}),this.defineProp("menu",{dataType:"Kekule.Widget.Menu",serializable:!1,scope:PS.PRIVATE,setter:function(value){var old=this.getMenu();value!==old&&(old&&(old.finalize(),old=null),this.setPropStoreFieldValue("menu",value))}}),this.defineProp("toolbar",{dataType:"Kekule.Widget.ButtonGroup",serializable:!1,scope:PS.PRIVATE,setter:function(value){var old=this.getToolbar(),evokeHelper=this.getToolbarEvokeHelper();if(value!==old){if(old){old.finalize();var helper=this.getToolbarEvokeHelper();helper&&helper.finalize(),old=null}evokeHelper&&evokeHelper.finalize(),this.setPropStoreFieldValue("toolbar",value),value&&this.setPropStoreFieldValue("toolbarEvokeHelper",new Kekule.Widget.DynamicEvokeHelper(this,value,this.getToolbarEvokeModes(),this.getToolbarRevokeModes()))}}}),this.defineProp("enableToolbar",{dataType:DataType.BOOL,setter:function(value){this.setPropStoreFieldValue("enableToolbar",value),this.updateToolbar()}}),this.defineProp("toolbarPos",{dataType:DataType.INT,enumSource:Kekule.Widget.Position,setter:function(value){this.setPropStoreFieldValue("toolbarPos",value),this.adjustToolbarPos()}}),this.defineProp("toolbarMarginVertical",{dataType:DataType.INT,setter:function(value){this.setPropStoreFieldValue("toolbarMarginVertical",value),this.adjustToolbarPos()}}),this.defineProp("toolbarMarginHorizontal",{dataType:DataType.INT,setter:function(value){this.setPropStoreFieldValue("toolbarMarginHorizontal",value),this.adjustToolbarPos()}}),this.defineProp("toolbarEvokeHelper",{dataType:"Kekule.Widget.DynamicEvokeHelper",serializable:!1,setter:null,scope:PS.PRIVATE}),this.defineProp("toolbarEvokeModes",{dataType:DataType.ARRAY,scope:PS.PUBLIC,setter:function(value){this.setPropStoreFieldValue("toolbarEvokeModes",value||[]),this.getToolbarEvokeHelper()&&this.getToolbarEvokeHelper().setEvokeModes(value||[])}}),this.defineProp("toolbarRevokeModes",{dataType:DataType.ARRAY,scope:PS.PUBLIC,setter:function(value){this.setPropStoreFieldValue("toolbarRevokeModes",value||[]),this.getToolbarEvokeHelper()&&this.getToolbarEvokeHelper().setRevokeModes(value||[])}}),this.defineProp("toolbarRevokeTimeout",{dataType:DataType.INT,setter:function(value){this.setPropStoreFieldValue("toolbarRevokeTimeout",value),this.getToolbarEvokeHelper()&&this.getToolbarEvokeHelper().setTimeout(value)}}),this.defineProp("toolbarParentElem",{dataType:DataType.OBJECT,serializable:!1,setter:function(value){this.getToolbarParentElem()!==value&&(this.setPropStoreFieldValue("toolbarParentElem",value),this.updateToolbar())}}),this.defineProp("caption",{dataType:DataType.STRING,setter:function(value){this.setPropStoreFieldValue("caption",value),Kekule.DomUtils.setElementText(this.getCaptionElem(),value||""),this.captionChanged()}}),this.defineProp("showCaption",{dataType:DataType.BOOL,setter:function(value){this.setPropStoreFieldValue("showCaption",value),this.captionChanged()}}),this.defineProp("captionPos",{dataType:DataType.INT,enumSource:Kekule.Widget.Position,setter:function(value){this.setPropStoreFieldValue("captionPos",value),this.captionChanged()}}),this.defineProp("autoCaption",{dataType:DataType.BOOL,setter:function(value){this.setPropStoreFieldValue("autoCaption",value),value&&this.autoDetectCaption()}}),this.defineProp("captionElem",{dataType:DataType.OBJECT,scope:PS.PRIVATE,setter:null,getter:function(doNotAutoCreate){var result=this.getPropStoreFieldValue("captionElem");return result||doNotAutoCreate||(result=this.doCreateCaptionElem(),this.setPropStoreFieldValue("captionElem",result)),result}}),this.defineProp("actions",{dataType:"Kekule.ActionList",serializable:!1,scope:PS.PUBLIC,setter:null,getter:function(){var result=this.getPropStoreFieldValue("actions");return result||(result=new Kekule.ActionList,this.setPropStoreFieldValue("actions",result)),result}}),this.defineProp("actionMap",{dataType:"Kekule.MapEx",serializable:!1,scope:PS.PRIVATE,setter:null,getter:function(){var result=this.getPropStoreFieldValue("actionMap");return result||(result=new Kekule.MapEx(!0),this.setPropStoreFieldValue("actionMap",result)),result}}),this.defineProp("enableDirectInteraction",{dataType:DataType.BOOL}),this.defineProp("enableTouchInteraction",{dataType:DataType.BOOL})},initPropValues:function($super){this.setUseNormalBackground(!1),this.setModalEdit(!0),this.setRestrainEditorWithCurrObj(!0),this.setRestraintRotation3DEdgeRatio(.18),this.setEnableRestraintRotation3D(!0),this.setShareEditorInstance(!0)},canUsePlaceHolderOnElem:function(elem){var imgSrc=elem.getAttribute("src");return"img"===elem.tagName.toLowerCase()&&!!imgSrc},doObjectChange:function($super,modifiedPropNames){$super(modifiedPropNames),this.updateActions()},doSetElement:function($super,element){var elem=element;if(elem){"img"===elem.tagName.toLowerCase()&&(elem=Kekule.DomUtils.replaceTagName(elem,"span"))}return $super(elem)},doUnbindElement:function($super,element){return this._drawContextParentElem&&this._drawContextParentElem.parentNode&&(this._drawContextParentElem.parentNode.removeChild(this._drawContextParentElem),this._drawContextParentElem=null),$super(element)},doCreateRootElement:function(doc){return doc.createElement("div")},doGetWidgetClassName:function($super){var result=$super()+" "+CCNS.VIEWER;try{var renderType=this.getRenderType();result+=" "+this._getRenderTypeSpecifiedHtmlClassName(renderType)}catch(e){}return result},_getRenderTypeSpecifiedHtmlClassName:function(renderType){return renderType===Kekule.Render.RendererType.R3D?CCNS.VIEWER3D:CCNS.VIEWER2D},getResizerElement:function(){return this.getDrawContextParentElem()},doResize:function($super){this.adjustDrawParentDim(),this.adjustToolbarPos(),$super()},doWidgetShowStateChanged:function(isShown){isShown&&this.updateActions()},refitDrawContext:function($super,doNotRepaint){$super(doNotRepaint),this.adjustToolbarPos()},getAllowRenderTypeChange:function(){return!0},resetRenderType:function($super,oldType,newType){$super(oldType,newType);var oldHtmlClassName=this._getRenderTypeSpecifiedHtmlClassName(oldType),newHtmlClassName=this._getRenderTypeSpecifiedHtmlClassName(newType);this.removeClassName(oldHtmlClassName),this.addClassName(newHtmlClassName),this.updateUiComps()},doLoadEnd:function(chemObj){this.updateActions(),this.autoDetectCaption()},doSetUseCornerDecoration:function($super,value){$super(value),this.useCornerDecorationChanged()},useCornerDecorationChanged:function(){var elem=this.getDrawContextParentElem();if(elem){this.getUseCornerDecoration()?Kekule.HtmlElementUtils.addClass(elem,CNS.CORNER_ALL):Kekule.HtmlElementUtils.removeClass(elem,CNS.CORNER_ALL)}},adjustDrawParentDim:function(){var t,h,drawParentElem=this.getDrawContextParentElem(),parentElem=drawParentElem.parentNode,captionElem=this.getCaptionElem(!0),dimParent=Kekule.HtmlElementUtils.getElemClientDimension(parentElem);if(captionElem&&this.captionIsShown()&&captionElem.parentNode===parentElem){var dimCaption=Kekule.HtmlElementUtils.getElemClientDimension(captionElem);h=Math.max(dimParent.height-dimCaption.height,0),t=this.getCaptionPos()&Kekule.Widget.Position.TOP?dimCaption.height:0,drawParentElem.style.top=t+"px",drawParentElem.style.height=h+"px"}else Kekule.StyleUtils.removeStyleProperty(drawParentElem.style,"top"),Kekule.StyleUtils.removeStyleProperty(drawParentElem.style,"height")},getInteractionReceiverElem:function(){return this.getDrawContextParentElem()},setDrawDimension:function($super,width,height){var newHeight=height;if(this.captionIsShown()){newHeight+=Kekule.HtmlElementUtils.getElemClientDimension(this.getCaptionElem()).height||0}$super(width,newHeight)},doCreateCaptionElem:function(){var result=this.getDocument().createElement("span");return result.className=CNS.DYN_CREATED+"  "+CNS.SELECTABLE+" "+CCNS.VIEWER_CAPTION,this.getElement().appendChild(result),result},captionChanged:function(){if(this.captionIsShown()){var elem=this.getCaptionElem(),style=elem.style;this.getCaptionPos()&Kekule.Widget.Position.TOP?(style.top=0,style.bottom="auto"):(style.bottom=0,style.top="auto"),style.display="block"}else{var elem=this.getCaptionElem(!0);elem&&(elem.style.display="none")}this.doResize()},captionIsShown:function(){return this.getCaption()&&this.getShowCaption()},getAllowEditing:function(){return this.getCoordMode()!==Kekule.CoordMode.COORD3D&&this.getEnableEdit()&&(this.getChemObj()||this.getEnableEditFromVoid())},getComposerDialog:function(){var result;return result=this.getShareEditorInstance()?Kekule.ChemWidget.Viewer._composerDialog:this._composerDialog,result||Kekule.Editor.ComposerDialog&&(result=new Kekule.Editor.ComposerDialog(this,Kekule.$L("ChemWidgetTexts.CAPTION_EDIT_OBJ"),[Kekule.Widget.DialogButtons.OK,Kekule.Widget.DialogButtons.CANCEL])),this.getShareEditorInstance()?Kekule.ChemWidget.Viewer._composerDialog=result:this._composerDialog=result,result},openEditor:function(callerWidget){if(this.getAllowEditing()){var cloneObj,chemObj=this.getChemObj(),editFromVoid=!chemObj,editFromEmpty=chemObj&&chemObj.isEmpty&&chemObj.isEmpty(),restrainObj=this.getRestrainEditorWithCurrObj(),dialog=this.getComposerDialog();if(!dialog)return void Kekule.error(Kekule.$L("ErrorMsg.CAN_NOT_CREATE_EDITOR"));var composer=dialog.getComposer();composer.setEnableCreateNewDoc(editFromVoid||!restrainObj),composer.setEnableLoadNewFile(editFromVoid||!restrainObj),composer.setAllowCreateNewChild(editFromVoid||!restrainObj);var editorProperties=this.getEditorProperties();editorProperties&&composer.setPropValues(editorProperties),editFromVoid||editFromEmpty?dialog.getComposer().newDoc():(cloneObj=chemObj.clone(),dialog.setChemObj(cloneObj));var self=this,callback=function(dialogResult){if(dialogResult===Kekule.Widget.DialogButtons.OK&&dialog.getComposer().isDirty()){var newObj=dialog.getSavingTargetObj();editFromVoid?self.setChemObj(newObj.clone()):self.getRestrainEditorWithCurrObj()?(chemObj.getClass()===newObj.getClass()?chemObj.assign(newObj.clone()):chemObj.assign(cloneObj),chemObj.setSrcInfo(null),self.setChemObj(chemObj)):self.setChemObj(newObj)}};this.getModalEdit()?dialog.openModal(callback,callerWidget||this):dialog.openPopup(callback,callerWidget||this)}},resetView:function(){return this.resetDisplay()},getCurr2DRotationAngle:function(){return this.getDrawOptions().rotateAngle||0},rotate2DBy:function(delta,suspendRendering){return this.rotate2DTo(this.getCurr2DRotationAngle()+delta,suspendRendering)},rotate2DTo:function(angle,suspendRendering){return this.getDrawOptions().rotateAngle=angle,suspendRendering||this.geometryOptionChanged(),this},getCurr3DRotationInfo:function(){for(var result={},fields=["rotateMatrix","rotateX","rotateY","rotateZ","rotateAngle"],ops=this.getDrawOptions(),i=0,l=fields.length;i<l;++i){var field=fields[i];result[field]=ops[field]||0}return result.rotateAxisVector=ops.rotateAxisVector||null,result},setRotate3DMatrix:function(matrix,suspendRendering){return this.getDrawOptions().rotateMatrix=matrix,suspendRendering||this.geometryOptionChanged(),this},rotate3DBy:function(deltaX,deltaY,deltaZ,suspendRendering){var lastInfo=this.getCurr3DRotationInfo(),lastMatrix=lastInfo.rotateMatrix||Kekule.MatrixUtils.createIdentity(4),currMatrix=Kekule.CoordUtils.calcRotate3DMatrix({rotateX:deltaX,rotateY:deltaY,rotateZ:deltaZ}),matrix=Kekule.MatrixUtils.multiply(currMatrix,lastMatrix);return this.setRotate3DMatrix(matrix,suspendRendering),this},rotate3DByAxis:function(angle,axisVector,suspendRendering){var lastInfo=this.getCurr3DRotationInfo(),lastMatrix=lastInfo.rotateMatrix||Kekule.MatrixUtils.createIdentity(4),currMatrix=Kekule.CoordUtils.calcRotate3DMatrix({rotateAngle:angle,rotateAxisVector:axisVector}),matrix=Kekule.MatrixUtils.multiply(currMatrix,lastMatrix);return this.setRotate3DMatrix(matrix,suspendRendering),this},getDefaultToolBarButtons:function(){return Kekule.globalOptions.chemWidget.viewer.toolButtons},isToolbarEmbedded:function(){return!this.getToolbarParentElem()},adjustToolbarPos:function(){var toolbar=this.getToolbar();if(toolbar)if(this.isToolbarEmbedded()){var WP=Kekule.Widget.Position,viewerClientRect=Kekule.HtmlElementUtils.getElemBoundingClientRect(this.getDrawContextParentElem()),toolbarClientRect=toolbar.getBoundingClientRect(),pos=this.getToolbarPos(),hMargin=this.getToolbarMarginHorizontal(),vMargin=this.getToolbarMarginVertical(),hPosProp="left",vPosProp="top",hPosPropUnused="right",vPosPropUnused="bottom",hPosValue=(viewerClientRect.width-toolbarClientRect.width)/2,vPosValue=(viewerClientRect.height-toolbarClientRect.height)/2;if(pos===WP.AUTO||!pos){var toolbarTotalW=2*(hMargin>0?hMargin:0)+toolbarClientRect.width,toolbarTotalH=2*(vMargin>0?vMargin:0)+toolbarClientRect.height;toolbarTotalW>viewerClientRect.width?(pos|=WP.LEFT,hMargin=0):pos|=WP.RIGHT,toolbarTotalH>viewerClientRect.height/2?(pos|=WP.BOTTOM,vMargin=-1):pos|=WP.BOTTOM}pos&WP.LEFT?(hPosProp="left",hPosPropUnused="right",hPosValue=hMargin>=0?hMargin:hMargin-toolbarClientRect.width):pos&WP.RIGHT&&(hPosProp="right",hPosPropUnused="left",hPosValue=hMargin>=0?hMargin:hMargin-toolbarClientRect.width),pos&WP.TOP?(vPosProp="top",vPosPropUnused="bottom",vPosValue=vMargin>=0?vMargin:vMargin-toolbarClientRect.height):pos&WP.BOTTOM&&(vPosProp="bottom",vPosPropUnused="top",vPosValue=vMargin>=0?vMargin:vMargin-toolbarClientRect.height),toolbar.removeStyleProperty(hPosPropUnused),toolbar.removeStyleProperty(vPosPropUnused),toolbar.setStyleProperty(hPosProp,hPosValue+"px"),toolbar.setStyleProperty(vPosProp,vPosValue+"px")}else toolbar.removeStyleProperty("left"),toolbar.removeStyleProperty("top"),toolbar.removeStyleProperty("width"),toolbar.removeStyleProperty("height")},updateToolbar:function(){this.getEnableToolbar()?(this.createToolbar(),this.adjustToolbarPos()):this.setToolbar(null)},updateMenu:function(){this.createMenu()},updateUiComps:function(){this.updateToolbar(),this.updateMenu()},updateActions:function(){this.getActions()&&this.getActions().updateAll()},clearActions:function(){this.getActions().clear(),this.getActionMap().clear()},getCompActionClass:function(compName){return this.getChildActionClass(compName,!0)},_getActionOfComp:function(compNameOrComp,canCreate,defActionClass){var map=this.getActionMap(),result=map.get(compNameOrComp);if(!result&&canCreate){var c=this.getCompActionClass(compNameOrComp)||defActionClass;c&&(result=new c(this),map.set(compNameOrComp,result),this.getActions().add(result))}return result},createToolbar:function(){this.clearActions();var toolBar=new Kekule.Widget.ButtonGroup(this);toolBar.addClassName(CNS.DYN_CREATED),toolBar.setDisplayed(!1),toolBar.setShowText(!1),toolBar.doSetShowGlyph(!0);for(var btns=this.getToolButtons()||this.getDefaultToolBarButtons(),i=0,l=btns.length;i<l;++i){var name=btns[i];this.createToolButton(name,toolBar)}return toolBar.addClassName(CCNS.INNER_TOOLBAR),this.isToolbarEmbedded()&&toolBar.addClassName(CCNS.VIEWER_EMBEDDED_TOOLBAR),toolBar.appendToElem(this.getToolbarParentElem()||this.getElement()),this.setToolbar(toolBar),toolBar},createToolButton:function(btnName,parentGroup){var result=null,beginContinuousRepaintingBind=this.beginContinuousRepainting.bind(this),endContinuousRepaintingBind=this.endContinuousRepainting.bind(this),rotateBtnNames=[BNS.rotateX,BNS.rotateY,BNS.rotateZ,BNS.rotateLeft,BNS.rotateRight];if(DataType.isObjectValue(btnName)){var objDefHash=Object.extend({widget:Kekule.Widget.Button},btnName);result=Kekule.Widget.Utils.createFromHash(parentGroup,objDefHash);var actionClass=objDefHash.actionClass;if(actionClass&&"string"==typeof actionClass&&(actionClass=ClassEx.findClass(objDefHash.actionClass)),actionClass){var action=this._getActionOfComp(result,!0,actionClass);action&&result.setAction(action)}}else{if(btnName===BNS.molDisplayType)return this.createMolDisplayTypeButton(parentGroup);if(btnName===BNS.menu)return this.createMenuButton(parentGroup);var actionClass=this.getCompActionClass(btnName),btnClass=Kekule.Widget.Button;btnName===BNS.molHideHydrogens&&(btnClass=Kekule.Widget.CheckButton),result=new btnClass(parentGroup);var action=this._getActionOfComp(btnName,!0);action&&result.setAction(action),rotateBtnNames.indexOf(btnName)>=0&&(result.setPeriodicalExecInterval(20),result.setEnablePeriodicalExec(!0),result.addEventListener("activate",beginContinuousRepaintingBind),result.addEventListener("deactivate",endContinuousRepaintingBind))}return result},createMenuButton:function(parentGroup){var result=new Kekule.Widget.DropDownButton(parentGroup);return result.setText(Kekule.$L("WidgetTexts.CAPTION_MENU")).setHint(Kekule.$L("WidgetTexts.HINT_MENU")),result.addClassName(CCNS.VIEWER_MENU_BUTTON),this.getMenu()||this.createMenu(),result.setDropDownWidget(this.getMenu()),result},createMolDisplayTypeButton:function(parentGroup){var result=new Kekule.Widget.CompactButtonSet(parentGroup);result.getButtonSet().addClassName(CCNS.INNER_TOOLBAR),result.setShowText(!1);var action=this._getActionOfComp(BNS.molDisplayType,!0);result.setAction(action),this.getActions().add(action);for(var doc=this.getDocument(),allowedType=this.getAllowedMolDisplayTypes(),actionClasses=this._getUsableMolDisplayActionClasses(allowedType),i=0,l=actionClasses.length;i<l;++i){var displayType=actionClasses[i].TYPE,btn=new Kekule.Widget.RadioButton(doc),action=this._getActionOfComp(BNS.molDisplayType+displayType,!0,actionClasses[i]);btn.setAction(action),result.append(btn,displayType===this.getCurrMoleculeDisplayType())}return result},_getUsableMolDisplayActionClasses:function(allowedTypes){for(var result=[],actionClasses=this.getRenderType()===Kekule.Render.RendererType.R3D?CW.Viewer.molDisplayType3DActionClasses:CW.Viewer.molDisplayType2DActionClasses,i=0,l=actionClasses.length;i<l;++i){var displayType=actionClasses[i].TYPE;allowedTypes&&allowedTypes.indexOf(displayType)<0&&displayType!==this.getCurrMoleculeDisplayType()||result.push(actionClasses[i])}return result},getDefaultMenuItems:function(){return Kekule.globalOptions.chemWidget.viewer.menuItems},prepareMenuItems:function(items){for(var sSeparator=Kekule.Widget.MenuItem.SEPARATOR_TEXT,i=0,l=items.length;i<l;++i){var item=items[i];if("string"==typeof item){if(item!==sSeparator){var defHash=this.createPredefinedMenuItemDefHash(item);defHash&&(items[i]=defHash)}}else{if(!item.widget&&!item.widgetClass){var newItem=Object.extend({},item);newItem.widget=Kekule.Widget.MenuItem,item=newItem,items[i]=newItem}item.children&&item.children.length&&this.prepareMenuItems(item.children)}}return items},createPredefinedMenuItemDefHash:function(compName){if(compName===BNS.molDisplayType)return this.createMolDisplayMenuDefHash();var rotateCompNames=[BNS.rotateX,BNS.rotateY,BNS.rotateZ,BNS.rotateLeft,BNS.rotateRight],beginContinuousRepaintingBind=this.beginContinuousRepainting.bind(this),endContinuousRepaintingBind=this.endContinuousRepainting.bind(this),itemClass=(this.getCompActionClass(compName),Kekule.Widget.MenuItem),result=null,action=this._getActionOfComp(compName,!0);return action&&(result={widget:itemClass,action:action},rotateCompNames.indexOf(compName)>=0&&(result=Object.extend(result,{periodicalExecInterval:20,enablePeriodicalExec:!0,"#activate":beginContinuousRepaintingBind,"@deactivate":endContinuousRepaintingBind}))),result},createMolDisplayMenuDefHash:function(){for(var action=this._getActionOfComp(BNS.molDisplayType,!0),result={widget:Kekule.Widget.MenuItem,action:action},children=[],allowedType=this.getAllowedMolDisplayTypes(),actionClasses=this._getUsableMolDisplayActionClasses(allowedType),i=0,l=actionClasses.length;i<l;++i){var displayType=actionClasses[i].TYPE,action=this._getActionOfComp(BNS.molDisplayType+displayType,!0,actionClasses[i]);children.push({widget:Kekule.Widget.MenuItem,action:action})}return children.length&&(result.children=[{widget:Kekule.Widget.PopupMenu,children:children}]),result},createMenu:function(){var result=this.getMenu();result?result.clearMenuItems():(result=new Kekule.Widget.PopupMenu(this),result.addClassName(CNS.DYN_CREATED),result.setDisplayed(!1));var items=this.getMenuItems()||this.getDefaultMenuItems();return items=this.prepareMenuItems(items),result.createChildrenByDefs(items),this.setMenu(result),result},autoDetectCaption:function(){if(this.getAutoCaption()){var obj=this.getChemObj();if(obj){var info=obj&&obj.getInfo(),srcInfo=obj&&obj.getSrcInfo();if(info&&srcInfo){var caption=info.title||info.caption||obj.getName()||srcInfo.fileName;caption&&this.setCaption(caption)}}}}});var XEvent=Kekule.X.Event;Kekule.ChemWidget.ViewerBasicInteractionController=Class.create(Kekule.Widget.InteractionController,{CLASS_NAME:"Kekule.ChemWidget.ViewerBasicInteractionController",initialize:function($super,viewer){$super(viewer),this._enableMouseRotate=!0,this._transformInfo={isTransforming:!1,lastCoord:null,lastZoom:null},this._restraintCoord=null},initProperties:function(){this.defineProp("viewer",{dataType:"Kekule.ChemWidget.Viewer",serializable:!1,getter:function(){return this.getWidget()},setter:function(value){this.setWidget(value)}})},getViewerRenderType:function(){return this.getViewer().getRenderType()},getEnableInteraction:function(){var v=this.getViewer();return!!(v&&v.getEnableDirectInteraction()&&v.getChemObjLoaded())},getEnableTouchInteraction:function(){var v=this.getViewer();return!!(v&&v.getEnableDirectInteraction()&&v.getEnableTouchInteraction()&&v.getChemObjLoaded())},_initTransform:function(){var refLength,viewer=this.getViewer(),w=viewer.getOffsetWidth(),h=viewer.getOffsetHeight(),info=this._transformInfo,rc=this._restraintCoord;rc?(refLength="x"===rc?h:w,info.angleRatio=1/refLength*Math.PI*2):(refLength=Math.min(w,h),info.angleRatio=1/refLength*Math.PI)},zoomViewer:function(delta){var v=this.getViewer();v&&v.getChemObj()&&(delta>0?v.zoomIn&&v.zoomIn(delta):delta<0&&v.zoomOut&&v.zoomOut(-delta))},isEventFromInteractionArea:function(e){var target=e.getTarget(),interactionElem=this.getViewer().getInteractionReceiverElem();return target===interactionElem||Kekule.DomUtils.isDescendantOf(target,interactionElem)},_beginInteractTransformAtCoord:function(screenX,screenY,clientX,clientY){var viewer=this.getViewer();if(viewer&&viewer.getChemObj()){var info=this._transformInfo;info.isTransforming=!0,info.lastCoord={x:screenX,y:screenY},this._restraintCoord=this._calcRestraintRotateCoord(clientX,clientY),this._initTransform()}},_calcRestraintRotateCoord:function(clientX,clientY){var viewer=this.getViewer(),result=null,restraintRotateEdgeSize=this._getRestraintRotate3DEdgeSize();if(restraintRotateEdgeSize>0){var minX,minY,flagX,flagY,elem=viewer.getInteractionReceiverElem(),rect=Kekule.HtmlElementUtils.getElemBoundingClientRect(elem,!1),x1=clientX-rect.left,y1=clientY-rect.top,x2=rect.right-clientX,y2=rect.bottom-clientY;x1<=x2?(flagX=1,minX=x1):(flagX=-1,minX=x2),y1<=y2?(flagY=1,minY=y1):(flagY=-1,minY=y2);var minOffset=Math.min(minX,minY);if(minOffset>restraintRotateEdgeSize)return null;minY>minOffset?flagX<0&&(result="x"):result=flagY>0?"z":"y"}return result},_interactTransformAtCoord:function(screenX,screenY){this.getViewerRenderType()===Kekule.Render.RendererType.R3D?this.rotateByXYDistance(screenX,screenY):this.moveByXYDistance(screenX,screenY)},_getRestraintRotate3DEdgeSize:function(){var viewer=this.getViewer();if(viewer.getEnableRestraintRotation3D()&&viewer.getRenderType()===Kekule.Render.RendererType.R3D){var dim=viewer.getDimension();return Math.min(dim.width,dim.height)*(viewer.getRestraintRotation3DEdgeRatio()||0)}return 0},needReactEvent:function(e){return this.getEnableInteraction()&&this.isEventFromInteractionArea(e)},needReactToTouchEvent:function(e){var touches=e.getTouches();return this.getEnableTouchInteraction()&&touches&&touches.length>1},react_dblclick:function(e){this.needReactEvent(e)&&this.getViewer().resetDisplay()},react_mousewheel:function(e){if(this.needReactEvent(e)){var delta=e.wheelDeltaY||e.wheelDelta;return delta&&(delta/=120),this.zoomViewer(delta),e.preventDefault(),!0}},react_mousedown:function(e){this.needReactEvent(e)&&e.getButton()===XEvent.MouseButton.LEFT&&this._beginInteractTransformAtCoord(e.getScreenX(),e.getScreenY(),e.getClientX(),e.getClientY())},react_touchstart:function(e){if(this.needReactEvent(e)&&this.needReactToTouchEvent(e)){var touchInfo=e.getTouches()[0],notUnset=Kekule.ObjUtils.notUnset;touchInfo&&notUnset(touchInfo.screenX)&&notUnset(touchInfo.screenY)&&(this._beginInteractTransformAtCoord(touchInfo.screenX,touchInfo.screenY,touchInfo.clientX,touchInfo.clientY),e.stopPropagation(),e.preventDefault())}},react_mouseleave:function(e){this._transformInfo.isTransforming=!1},react_touchleave:function(e){this._transformInfo.isTransforming=!1},react_touchcancel:function(e){this._transformInfo.isTransforming=!1},react_mouseup:function(e){e.getButton()===XEvent.MouseButton.LEFT&&(this._transformInfo.isTransforming=!1)},react_touchend:function(e){this._transformInfo.isTransforming=!1},react_mousemove:function(e){this.needReactEvent(e)&&this._interactTransformAtCoord(e.getScreenX(),e.getScreenY())},react_touchmove:function(e){if(this.needReactEvent(e)&&this.needReactToTouchEvent(e)){var touchInfo=e.getTouches()[0],notUnset=Kekule.ObjUtils.notUnset;touchInfo&&notUnset(touchInfo.screenX)&&notUnset(touchInfo.screenY)&&(this._interactTransformAtCoord(touchInfo.screenX,touchInfo.screenY),e.stopPropagation(),e.preventDefault())}},moveByXYDistance:function(currX,currY){var info=this._transformInfo;if(info&&info.isTransforming&&!info.calculating){var viewer=this.getViewer();if(viewer.getRenderType()===Kekule.Render.RendererType.R3D)return;info.calculating=!0;try{var currCoord={x:currX,y:currY},delta=Kekule.CoordUtils.substract(currCoord,info.lastCoord),baseCoordOffset=viewer.getBaseCoordOffset()||{};baseCoordOffset=Kekule.CoordUtils.add(baseCoordOffset,delta),viewer.setBaseCoordOffset(baseCoordOffset),info.lastCoord=currCoord}finally{info.calculating=!1}}},rotateByXYDistance:function(currX,currY){var info=this._transformInfo;if(info&&info.isTransforming&&!info.calculating){var viewer=this.getViewer();if(viewer.getRenderType()!==Kekule.Render.RendererType.R3D)return;info.calculating=!0;try{var currCoord={x:currX,y:currY},delta=Kekule.CoordUtils.substract(currCoord,info.lastCoord);delta.y=-delta.y;var dis,rotateAngle,axisVector;if(this._restraintCoord){var rc=this._restraintCoord;"x"===rc?(dis=delta.y,axisVector={x:1,y:0,z:0}):(dis=delta.x,axisVector="y"===rc?{x:0,y:-1,z:0}:{x:0,y:0,z:1}),rotateAngle=-dis*info.angleRatio}else dis=Kekule.CoordUtils.getDistance({x:0,y:0},delta),rotateAngle=dis*info.angleRatio,axisVector={x:-delta.y,y:delta.x,z:0};viewer.rotate3DByAxis(rotateAngle,axisVector),info.lastCoord=currCoord,info.calculating=!1}catch(e){}finally{info.calculating=!1}}},doTestMouseCursor:function(coord,e){var result="";return this._transformInfo.isTransforming&&(result="move"),result}}),Kekule.ChemWidget.Viewer2D=Class.create(Kekule.ChemWidget.Viewer,{CLASS_NAME:"Kekule.ChemWidget.Viewer2D",initialize:function($super,parentOrElementOrDocument,chemObj){$super(parentOrElementOrDocument,chemObj,Kekule.Render.RendererType.R2D)},getAllowRenderTypeChange:function(){return!1}}),Kekule.ChemWidget.Viewer3D=Class.create(Kekule.ChemWidget.Viewer,{CLASS_NAME:"Kekule.ChemWidget.Viewer3D",initialize:function($super,parentOrElementOrDocument,chemObj){$super(parentOrElementOrDocument,chemObj,Kekule.Render.RendererType.R3D)},getAllowRenderTypeChange:function(){return!1}});var SM=Kekule.ObjPropSettingManager;return SM.register("Kekule.ChemWidget.Viewer.fullFunc",{enableToolbar:!0,enableDirectInteraction:!0,enableTouchInteraction:!0,enableEdit:!0,toolButtons:null}),SM.register("Kekule.ChemWidget.Viewer.basic",{enableToolbar:!0,enableDirectInteraction:!0,enableTouchInteraction:!1,toolButtons:[BNS.saveData,BNS.molDisplayType,BNS.zoomIn,BNS.zoomOut],menuItems:[BNS.saveData,"-",BNS.molDisplayType,BNS.zoomIn,BNS.zoomOut]}),SM.register("Kekule.ChemWidget.Viewer.mini",{enableToolbar:!0,enableDirectInteraction:!0,enableTouchInteraction:!1,toolButtons:[BNS.menu],menuItems:[BNS.saveData,"-",BNS.molDisplayType,BNS.zoomIn,BNS.zoomOut]}),SM.register("Kekule.ChemWidget.Viewer.static",{enableToolbar:!1,enableDirectInteraction:!1,enableTouchInteraction:!1,toolButtons:[],menuItems:[]}),SM.register("Kekule.ChemWidget.Viewer.editOnly",{enableToolbar:!0,enableEdit:!0,toolButtons:[BNS.openEditor],menuItems:[BNS.openEditor]}),Kekule.ChemWidget.Viewer.Settings=Class.create(Kekule.ChemWidget.ChemObjDisplayer.Settings,{CLASS_NAME:"Kekule.ChemWidget.Viewer.Settings",initProperties:function(){this.defineDelegatedProps(["enableDirectInteraction","enableTouchInteraction","enableToolbar","toolbarPos","toolbarMarginHorizontal","toolbarMarginVertical","enableEdit","modalEdit"])},getViewer:function(){return this.getWidget()}}),Kekule.ChemWidget.ActionOnViewer=Class.create(Kekule.ChemWidget.ActionOnDisplayer,{CLASS_NAME:"Kekule.ChemWidget.ActionOnViewer",initialize:function($super,viewer,caption,hint){$super(viewer,caption,hint)},doUpdate:function(){var displayer=this.getDisplayer();this.setEnabled(displayer&&displayer.getChemObj()&&displayer.getChemObjLoaded()&&displayer.getEnabled())},getViewer:function(){var result=this.getDisplayer();return result instanceof Kekule.ChemWidget.Viewer?result:null}}),Kekule.ChemWidget.ActionViewerRotateBase=Class.create(Kekule.ChemWidget.ActionOnViewer,{CLASS_NAME:"Kekule.ChemWidget.ActionViewerRotateBase",initialize:function($super,viewer,caption,hint){$super(viewer,caption,hint),this.setDelta(2*Math.PI/180)},initProperties:function(){this.defineProp("delta",{dataType:DataType.FLOAT})},isShiftModified:function(htmlEvent){return htmlEvent&&htmlEvent.getShiftKey()}}),Kekule.ChemWidget.ActionViewerRotateBase2D=Class.create(Kekule.ChemWidget.ActionViewerRotateBase,{CLASS_NAME:"Kekule.ChemWidget.ActionViewerRotateBase2D",doUpdate:function($super){$super();var viewer=this.getViewer(),flag=viewer&&viewer.getRenderType()===Kekule.Render.RendererType.R2D;this.setDisplayed(flag).setEnabled(this.getEnabled()&&flag)}}),Kekule.ChemWidget.ActionViewerRotateBase3D=Class.create(Kekule.ChemWidget.ActionViewerRotateBase,{CLASS_NAME:"Kekule.ChemWidget.ActionViewerRotateBase3D",doUpdate:function($super){$super();var viewer=this.getViewer(),flag=viewer&&viewer.getRenderType()===Kekule.Render.RendererType.R3D;this.setDisplayed(flag).setEnabled(this.getEnabled()&&flag)}}),Kekule.ChemWidget.ActionViewerRotateLeft=Class.create(Kekule.ChemWidget.ActionViewerRotateBase2D,{CLASS_NAME:"Kekule.ChemWidget.ActionViewerRotateLeft",HTML_CLASSNAME:CCNS.ACTION_ROTATE_LEFT,initialize:function($super,viewer){$super(viewer,Kekule.$L("ChemWidgetTexts.CAPTION_ROTATELEFT"),Kekule.$L("ChemWidgetTexts.HINT_ROTATELEFT"))},doExecute:function(target,htmlEvent){var delta=this.getDelta();this.getViewer().rotate2DBy(delta)}}),Kekule.ChemWidget.ActionViewerRotateRight=Class.create(Kekule.ChemWidget.ActionViewerRotateBase2D,{CLASS_NAME:"Kekule.ChemWidget.ActionViewerRotateRight",HTML_CLASSNAME:CCNS.ACTION_ROTATE_RIGHT,initialize:function($super,viewer){$super(viewer,Kekule.$L("ChemWidgetTexts.CAPTION_ROTATERIGHT"),Kekule.$L("ChemWidgetTexts.HINT_ROTATERIGHT"))},doExecute:function(target,htmlEvent){var delta=-this.getDelta();this.getViewer().rotate2DBy(delta)}}),Kekule.ChemWidget.ActionViewerRotateX=Class.create(Kekule.ChemWidget.ActionViewerRotateBase3D,{CLASS_NAME:"Kekule.ChemWidget.ActionViewerRotateX",HTML_CLASSNAME:CCNS.ACTION_ROTATE_X,initialize:function($super,viewer){$super(viewer,Kekule.$L("ChemWidgetTexts.CAPTION_ROTATEX"),Kekule.$L("ChemWidgetTexts.HINT_ROTATEX"))},doExecute:function(target,htmlEvent){var rev=this.isShiftModified(htmlEvent),delta=-this.getDelta();rev&&(delta=-delta),this.getViewer().rotate3DBy(delta,0,0)}}),Kekule.ChemWidget.ActionViewerRotateY=Class.create(Kekule.ChemWidget.ActionViewerRotateBase3D,{CLASS_NAME:"Kekule.ChemWidget.ActionViewerRotateY",HTML_CLASSNAME:CCNS.ACTION_ROTATE_Y,initialize:function($super,viewer){$super(viewer,Kekule.$L("ChemWidgetTexts.CAPTION_ROTATEY"),Kekule.$L("ChemWidgetTexts.HINT_ROTATEY"))},doExecute:function(target,htmlEvent){var rev=this.isShiftModified(htmlEvent),delta=-this.getDelta();rev&&(delta=-delta),this.getViewer().rotate3DBy(0,delta,0)}}),Kekule.ChemWidget.ActionViewerRotateZ=Class.create(Kekule.ChemWidget.ActionViewerRotateBase3D,{CLASS_NAME:"Kekule.ChemWidget.ActionViewerRotateZ",HTML_CLASSNAME:CCNS.ACTION_ROTATE_Z,initialize:function($super,viewer){$super(viewer,Kekule.$L("ChemWidgetTexts.CAPTION_ROTATEZ"),Kekule.$L("ChemWidgetTexts.HINT_ROTATEZ"))},doExecute:function(target,htmlEvent){var rev=this.isShiftModified(htmlEvent),delta=-this.getDelta();rev&&(delta=-delta),this.getViewer().rotate3DBy(0,0,delta)}}),Kekule.ChemWidget.ActionViewerChangeMolDisplayTypeStub=Class.create(Kekule.ChemWidget.ActionOnDisplayer,{CLASS_NAME:"Kekule.ChemWidget.ActionViewerChangeMolDisplayTypeStub",initialize:function($super,viewer){$super(viewer,Kekule.$L("ChemWidgetTexts.CAPTION_MOL_DISPLAY_TYPE"),Kekule.$L("ChemWidgetTexts.HINT_MOL_DISPLAY_TYPE"))},doExecute:function(target){}}),Kekule.ChemWidget.ActionViewerEdit=Class.create(Kekule.ChemWidget.ActionOnViewer,{CLASS_NAME:"Kekule.ChemWidget.ActionViewerEdit",HTML_CLASSNAME:CCNS.ACTION_VIEWER_EDIT,initialize:function($super,viewer){$super(viewer,Kekule.$L("ChemWidgetTexts.CAPTION_OPENEDITOR"),Kekule.$L("ChemWidgetTexts.HINT_OPENEDITOR"))},doUpdate:function($super){$super();var viewer=this.getViewer();this.setEnabled(viewer&&viewer.getAllowEditing()&&viewer.getEnabled()),this.setDisplayed(viewer&&viewer.getEnableEdit())},doExecute:function(target){this.getViewer().openEditor(target)}}),Kekule.ChemWidget.Viewer.rotate2DActionClasses=[CW.ActionViewerRotateLeft,CW.ActionViewerRotateRight],Kekule.ChemWidget.Viewer.rotate3DActionClasses=[CW.ActionViewerRotateX,CW.ActionViewerRotateY,CW.ActionViewerRotateZ],Kekule.ChemWidget.Viewer.molDisplayType2DActionClasses=[CW.ActionDisplayerChangeMolDisplayTypeSkeletal,CW.ActionDisplayerChangeMolDisplayTypeCondensed],Kekule.ChemWidget.Viewer.molDisplayType3DActionClasses=[CW.ActionDisplayerChangeMolDisplayTypeWire,CW.ActionDisplayerChangeMolDisplayTypeSticks,CW.ActionDisplayerChangeMolDisplayTypeBallStick,CW.ActionDisplayerChangeMolDisplayTypeSpaceFill],Kekule._registerAfterLoadProc(function(){var AM=Kekule.ActionManager,CW=Kekule.ChemWidget,widgetClass=Kekule.ChemWidget.Viewer,reg=AM.registerNamedActionClass;reg(BNS.loadFile,CW.ActionDisplayerLoadFile,widgetClass),reg(BNS.loadData,CW.ActionDisplayerLoadData,widgetClass),reg(BNS.saveData,CW.ActionDisplayerSaveFile,widgetClass),reg(BNS.clearObjs,CW.ActionDisplayerClear,widgetClass),reg(BNS.zoomIn,CW.ActionDisplayerZoomIn,widgetClass),reg(BNS.zoomOut,CW.ActionDisplayerZoomOut,widgetClass),reg(BNS.rotateLeft,CW.ActionViewerRotateLeft,widgetClass),reg(BNS.rotateRight,CW.ActionViewerRotateRight,widgetClass),reg(BNS.rotateX,CW.ActionViewerRotateX,widgetClass),reg(BNS.rotateY,CW.ActionViewerRotateY,widgetClass),reg(BNS.rotateZ,CW.ActionViewerRotateZ,widgetClass),reg(BNS.reset,CW.ActionDisplayerReset,widgetClass),reg(BNS.molHideHydrogens,CW.ActionDisplayerHideHydrogens,widgetClass),reg(BNS.molDisplayType,CW.ActionViewerChangeMolDisplayTypeStub,widgetClass),reg(BNS.openEditor,CW.ActionViewerEdit,widgetClass),reg(BNS.config,Kekule.Widget.ActionOpenConfigWidget,widgetClass),reg(BNS.molDisplayTypeCondensed,CW.ActionDisplayerChangeMolDisplayTypeCondensed,widgetClass),reg(BNS.molDisplayTypeSkeletal,CW.ActionDisplayerChangeMolDisplayTypeSkeletal,widgetClass),reg(BNS.molDisplayTypeWire,CW.ActionDisplayerChangeMolDisplayTypeWire,widgetClass),reg(BNS.molDisplayTypeSticks,CW.ActionDisplayerChangeMolDisplayTypeSticks,widgetClass),reg(BNS.molDisplayTypeBallStick,CW.ActionDisplayerChangeMolDisplayTypeBallStick,widgetClass),reg(BNS.molDisplayTypeSpaceFill,CW.ActionDisplayerChangeMolDisplayTypeSpaceFill,widgetClass)}),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,ClassEx=__webpack_require__(0).ClassEx,DataType=__webpack_require__(0).DataType;module.exports=function(Kekule){var PS=Class.PropertyScope;Kekule.ChemWidget.HtmlClassNames=Object.extend(Kekule.ChemWidget.HtmlClassNames,{VIEWER_GRID:"K-Chem-Viewer-Grid"});var CCNS=(Kekule.Widget.HtmlClassNames,Kekule.ChemWidget.HtmlClassNames);return Kekule.ChemWidget.ViewerGrid=Class.create(Kekule.Widget.WidgetGrid,{CLASS_NAME:"Kekule.ChemWidget.ViewerGrid",initialize:function($super,parentOrElementOrDocument,renderType,viewerConfigs){this.setPropStoreFieldValue("renderType",renderType),this.setPropStoreFieldValue("viewerConfigs",viewerConfigs),$super(parentOrElementOrDocument)},initProperties:function(){this._shadowedPropPairs=[],this.defineProp("renderType",{dataType:DataType.INT,serializable:!1,setter:null,scope:PS.PUBLIC}),this.defineProp("chemObjs",{dataType:DataType.ARRAY,serializable:!1,setter:null,getter:function(){var result=[];return this.each(function(viewer){result.push(viewer.getChemObj())}),result}}),this.defineViewerShadowProps(["drawOptions","moleculeDisplayType","zoom","autoSize","enableLoadNewFile","viewerConfigs","allowedMolDisplayTypes","enableEdit","modalEdit","toolButtons","enableToolbar","toolbarPos","toolbarMarginVertical","toolbarMarginHorizontal","toolbarEvokeModes","toolbarRevokeModes","toolbarRevokeTimeout","caption","showCaption","autoCaption","captionPos","enableDirectInteraction","enableTouchInteraction"]),this.defineViewerShadowProps(["viewerPredefinedSetting"],["predefinedSetting"]),this.defineProp("actionLoadData",{dataType:"Kekule.ChemWidget.ActionDisplayerLoadData",serializable:!1,scope:PS.PRIVATE,setter:null,getter:function(){var result=this.getPropStoreFieldValue("actionLoadData");return result||(result=new Kekule.ChemWidget.ActionDisplayerLoadData,this.setPropStoreFieldValue("actionLoadData",result)),result}})},defineViewerShadowProps:function(propNames,viewerPropNames){viewerPropNames||(viewerPropNames=[]);for(var i=0,l=propNames.length;i<l;++i){var propName=propNames[i],viewerPropName=viewerPropNames[i]||propNames[i];this.defineViewerShadowProp(propName,viewerPropName)}},defineViewerShadowProp:function(propName,viewerPropName){viewerPropName||(viewerPropName=propName);var viewerClass=Kekule.ChemWidget.Viewer,viewerPropInfo=ClassEx.getPropInfo(viewerClass,viewerPropName);if(viewerPropInfo){var propInfo=Object.create(viewerPropInfo);propInfo.getter=void 0,propInfo.setter=function(value){this.setPropStoreFieldValue(propName,value),this.each(function(viewer){viewer.setPropValue(viewerPropName,value)})},this.defineProp(propName,propInfo),this._shadowedPropPairs.push({prop:propName,viewerProp:viewerPropName})}},doGetWidgetClassName:function($super){return $super()+" "+CCNS.VIEWER_GRID},createWidget:function($super){var doc=this.getDocument(),dialog=new Kekule.ChemWidget.LoadDataDialog(doc),self=this;dialog.openModal(function(result){if(dialog.isPositiveResult(result)){var chemObj=dialog.getChemObj();if(chemObj){self.doCreateNewChildWidget(doc,chemObj).setParent(self)}}},this.getAddingCell())},doCreateNewChildWidget:function(doc,chemObj){var result=new Kekule.ChemWidget.Viewer(doc,null,this.getRenderType(),this.getViewerConfigs());return this.doSetShadowedPropValuesToViewer(result),chemObj&&result.setChemObj(chemObj),result},doSetShadowedPropValuesToViewer:function(viewer){for(var i=0,l=this._shadowedPropPairs.length;i<l;++i){var pair=this._shadowedPropPairs[i],value=this.getPropValue(pair.prop);viewer.setPropValue(pair.viewerProp,value)}},addChemObj:function(chemObj){return this.doCreateNewChildWidget(this.getDocument(),chemObj).setParent(this),this},removeChemObj:function(chemObj){var self=this;return this.each(function(viewer){viewer.getChemObj()===chemObj&&self.removeWidget(viewer,!0)}),this}}),Kekule.ChemWidget.ViewerGrid2D=Class.create(Kekule.ChemWidget.ViewerGrid,{CLASS_NAME:"Kekule.ChemWidget.ViewerGrid2D",initialize:function($super,parentOrElementOrDocument,viewerConfigs){$super(parentOrElementOrDocument,Kekule.Render.RendererType.R2D,viewerConfigs)}}),Kekule.ChemWidget.ViewerGrid3D=Class.create(Kekule.ChemWidget.ViewerGrid,{CLASS_NAME:"Kekule.ChemWidget.ViewerGrid3D",initialize:function($super,parentOrElementOrDocument,viewerConfigs){$super(parentOrElementOrDocument,Kekule.Render.RendererType.R3D,viewerConfigs)}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,ClassEx=__webpack_require__(0).ClassEx,DataType=__webpack_require__(0).DataType,JsonUtility=__webpack_require__(1).JsonUtility;module.exports=function(Kekule){var PS=Class.PropertyScope,DU=Kekule.DomUtils,AU=Kekule.ArrayUtils;Kekule.ChemWidget.HtmlClassNames=Object.extend(Kekule.ChemWidget.HtmlClassNames,{CHEMOBJSETTER:"K-Chem-Obj-Setter",CHEMOBJSETTER_TOOLBAR_AREA:"K-Chem-Obj-Setter-Toolbar-Area",CHEMOBJSETTER_CLIENT:"K-Chem-Obj-Setter-Client",CHEMOBJSETTER_VIEWER:"K-Chem-Obj-Setter-Viewer",CHEMOBJSETTER_TABGROUP:"K-Chem-Obj-Setter-TabGroup",CHEMOBJSETTER_INFOLABEL:"K-Chem-Obj-Setter-InfoLabel",CHEMOBJSETTER_REGION:"K-Chem-Obj-Setter-Region",CHEMOBJSETTER_REGION_LABEL:"K-Chem-Obj-Setter-Region-Label",CHEMOBJSETTER_LINE:"K-Chem-Obj-Setter-Line",CHEMOBJSETTER_CONFIGURATOR:"K-Chem-Obj-Setter-Configurator"});var CNS=Kekule.Widget.HtmlClassNames,CCNS=Kekule.ChemWidget.HtmlClassNames;return Kekule.ChemWidget.ChemObjInserter=Class.create(Kekule.ChemWidget.AbstractWidget,{CLASS_NAME:"Kekule.ChemWidget.ChemObjInserter",DEF_BGCOLOR_2D:"transparent",DEF_BGCOLOR_3D:"#000000",initialize:function($super,parentOrElementOrDocument,chemObj,renderType,viewerConfigs){this._configAction=new Kekule.Widget.ActionOpenConfigWidget(this),this._toolbarParentElem=null,this._infoLabel=null,this._infoLabelTemplate=Kekule.$L("ChemWidgetTexts.CAPTION_WIDTH_HEIGHT"),$super(parentOrElementOrDocument);var viewer=this.getViewer();renderType&&viewer.setRenderType(renderType),viewerConfigs&&viewer.setViewerConfigs(viewerConfigs),this.adjustChildrenSizes()},doFinalize:function($super){this._configAction&&this._configAction.finalize(),$super()},initProperties:function(){this.defineProp("viewer",{dataType:"Kekule.ChemWidget.Viewer",serializable:!1,setter:null,getter:function(){var result=this.getPropStoreFieldValue("viewer");return result||(result=this.createViewer(),this.setPropStoreFieldValue("viewer",result)),result}}),this.defineProp("chemObj",{dataType:"Kekule.ChemObject",serializable:!1,scope:PS.PUBLIC,getter:function(){var viewer=this.getPropStoreFieldValue("viewer");return viewer?viewer.getChemObj():this.getPropStoreFieldValue("chemObj")},setter:function(value){this.setPropStoreFieldValue("chemObj",value),this.getViewer()&&this.getViewer().setChemObj(value)}}),this.defineProp("renderType",{dataType:DataType.INT,serializable:!1,scope:PS.PUBLIC,setter:function(value){if(value!==this.getRenderType()){this.setPropStoreFieldValue("renderType",value),this.getViewer().setRenderType(value);var tabs=this.getTabs();if(tabs){var index=value===Kekule.Render.RendererType.R3D?1:0;tabs.getChildWidgets()[index].setChecked(!0)}}}}),this.defineProp("is3D",{dataType:DataType.BOOL,serializable:!1,getter:function(){return this.getRenderType()===Kekule.Render.RendererType.R3D},setter:function(value){this.setRenderType(value?Kekule.Render.RendererType.R3D:Kekule.Render.RendererType.R2D)}}),this.defineProp("showInfo",{dataType:DataType.BOOL,serializable:!1,getter:function(){return this._infoLabel&&Kekule.StyleUtils.isShown(this._infoLabel)},setter:function(value){this._infoLabel&&Kekule.StyleUtils.setDisplay(this._infoLabel,value)}}),this.defineProp("autoSizeExport",{dataType:DataType.BOOL}),this.defineProp("backgroundColor2D",{dataType:DataType.STRING,setter:function(value){this.setPropStoreFieldValue("backgroundColor2D",value),this.backgroundColorChange()}}),this.defineProp("backgroundColor3D",{dataType:DataType.STRING,setter:function(value){this.setPropStoreFieldValue("backgroundColor3D",value),this.backgroundColorChange()}}),this.defineProp("exportViewerPredefinedSetting",{dataType:DataType.STRING}),this.defineProp("clientPanel",{dataType:DataType.OBJECT,serializable:!1,setter:!1,scope:PS.PRIVATE}),this.defineProp("tabs",{dataType:DataType.OBJECT,serializable:!1,setter:!1,scope:PS.PRIVATE}),this._defineViewerDelegatedProp("chemObjLoaded"),this._defineViewerDelegatedProp("renderConfigs"),this._defineViewerDelegatedProp("drawOptions"),this._defineViewerDelegatedProp("allowCoordBorrow"),this._defineViewerDelegatedProp("autoSize"),this._defineViewerDelegatedProp("autofit"),this._defineViewerDelegatedProp("viewerConfigs"),this._defineViewerDelegatedProp("allowedMolDisplayTypes"),this._defineViewerDelegatedProp("enableEdit"),this._defineViewerDelegatedProp("enableEditFromVoid"),this._defineViewerDelegatedProp("modalEdit"),this._defineViewerDelegatedProp("toolButtons"),this._defineViewerDelegatedProp("enableDirectInteraction"),this._defineViewerDelegatedProp("enableTouchInteraction")},initPropValues:function($super){$super(),this.setAutoSizeExport(!0),this.setBackgroundColor3D(this.DEF_BGCOLOR_3D),this.setExportViewerPredefinedSetting("basic")},_defineViewerDelegatedProp:function(propName,viewerPropName){viewerPropName||(viewerPropName=propName);var viewerPropInfo=ClassEx.getPropInfo(Kekule.ChemWidget.Viewer,viewerPropName),propOptions=Object.create(viewerPropInfo);return propOptions.getter=null,propOptions.setter=null,viewerPropInfo.getter&&(propOptions.getter=function(){return this.getViewer().getPropValue(viewerPropName)}),viewerPropInfo.setter&&(propOptions.setter=function(value){this.getViewer().setPropValue(viewerPropName,value)}),this.defineProp(propName,propOptions)},loadPredefinedResDataToProp:function(propName,resData,success){if("chemObj"===propName)if(success){var chemObj=Kekule.IO.loadTypedData(resData.data,resData.resType,resData.resUri);this.setChemObj(chemObj)}else Kekule.error(Kekule.$L("ErrorMsg.CANNOT_LOAD_RES_OF_URI")+resData.resUri||"")},doGetWidgetClassName:function($super){return $super()+" "+CCNS.CHEMOBJSETTER},doCreateRootElement:function(doc){return doc.createElement("div")},doCreateSubElements:function($super,doc,rootElem){var result=$super(doc,rootElem);this.createToolbarParent(rootElem);var clientPanel=new Kekule.Widget.Panel(this);return clientPanel.addClassName(CCNS.CHEMOBJSETTER_CLIENT),clientPanel.setUseCornerDecoration(!1),clientPanel.appendToElem(rootElem),this.setPropStoreFieldValue("clientPanel",clientPanel),this.createViewer(clientPanel.getCoreElement()),this.createInfoLabel(rootElem,this.getViewer()),this.createTabs(rootElem),result},doResize:function($super){this.adjustChildrenSizes()},doWidgetShowStateChanged:function($super,isShown){$super(isShown),this.adjustChildrenSizes()},getResizerElement:function(){return this.getClientPanel()?this.getClientPanel().getCoreElement():this.getCoreElement()},getBackgroundColor:function(renderType){var result=renderType===Kekule.Render.RendererType.R3D?this.getBackgroundColor3D():this.getBackgroundColor2D();return result===Kekule.Widget.ColorPicker.SpecialColors.TRANSPARENT&&(result="transparent"),result},setBackgroundColor:function(color,renderType){if(renderType===Kekule.Render.RendererType.R3D){var value=color||this.DEF_BGCOLOR_3D;this.setBackgroundColor3D(value)}else{var value=color||this.DEF_BGCOLOR_2D;this.setBackgroundColor2D(value)}},backgroundColorChange:function(){var color=this.getBackgroundColor(this.getRenderType()),viewer=this.getPropStoreFieldValue("viewer");viewer&&viewer.setBackgroundColor(color)},adjustChildrenSizes:function(){var toolbarRect=(this.getBoundingClientRect(),Kekule.HtmlElementUtils.getElemBoundingClientRect(this._toolbarParentElem)),tabs=this.getTabs(),tabRect=tabs&&tabs.getBoundingClientRect(),h=tabRect.top-toolbarRect.bottom;this.getClientPanel().setHeight(h+"px"),this.getViewer().resized()},createViewer:function(rootElem){var BNS=Kekule.ChemWidget.ComponentWidgetNames,EM=Kekule.Widget.EvokeMode,result=new Kekule.ChemWidget.Viewer(this,null,this.getRenderType());result.addClassName([CNS.DYN_CREATED,CCNS.CHEMOBJSETTER_VIEWER]),result.setRenderType(Kekule.Render.RendererType.R2D),result.setEnableEdit(!0),result.setEnableEditFromVoid(!0),result.setRestrainEditorWithCurrObj(!1),result.setEnableToolbar(!0),result.setPredefinedSetting("fullFunc");var buttons=AU.exclude(result.getDefaultToolBarButtons(),BNS.config);return buttons.push({action:this._configAction}),buttons.splice(2,0,BNS.clearObjs),result.setToolbarParentElem(this._toolbarParentElem),result.setToolButtons(buttons),result.setToolbarPos(Kekule.Widget.Position.BOTTOM),result.setToolbarMarginVertical(-2),result.setToolbarEvokeModes([EM.ALWAYS]),result.addEventListener("resize",this.updateInfoLabel,this),result.appendToElem(rootElem),result.setChemObj(this.getChemObj()),this.setPropStoreFieldValue("viewer",result),this.backgroundColorChange(),result},createToolbarParent:function(rootElem){var result=rootElem.ownerDocument.createElement("div");return result.className=CCNS.CHEMOBJSETTER_TOOLBAR_AREA,rootElem.appendChild(result),this._toolbarParentElem=result,result},createTabs:function(rootElem){var tabTexts=[Kekule.$L("ChemWidgetTexts.CAPTION_2D"),Kekule.$L("ChemWidgetTexts.CAPTION_3D")],selIndex=this.getRenderType()===Kekule.Render.RendererType.R3D?1:0,result=new Kekule.Widget.TabButtonGroup(this);result.setTabButtonPosition(Kekule.Widget.Position.BOTTOM),result.addClassName([CNS.DYN_CREATED,CCNS.CHEMOBJSETTER_TABGROUP]);for(var btns=[],i=0,l=tabTexts.length;i<l;++i){var btn=new Kekule.Widget.RadioButton(result);btn.setText(tabTexts[i]),i===selIndex&&btn.setChecked(!0),btns.push(btn)}return result.addEventListener("switch",function(e){var btn=e.button,index=btns.indexOf(btn),rType=1===index?Kekule.Render.RendererType.R3D:Kekule.Render.RendererType.R2D;this.setRenderType(rType),this.backgroundColorChange()},this),result.appendToElem(rootElem),this.setPropStoreFieldValue("tabs",result),result},createInfoLabel:function(rootElem,viewer){var result=this.getDocument().createElement("div");return result.className=CNS.DYN_CREATED+" "+CCNS.CHEMOBJSETTER_INFOLABEL,viewer.getElement().appendChild(result),this._infoLabel=result,result},updateInfoLabel:function(){var viewer=this.getViewer();if(viewer&&this._infoLabel){var dim=viewer.getContextDimension(),s=dim?this._infoLabelTemplate.format(Math.round(dim.width),Math.round(dim.height)):"";Kekule.DomUtils.setElementText(this._infoLabel,s)}},getContextDimension:function(){return this.getViewer().getContextDimension()},setContextDimension:function(dimension){var oldDim=this.getContextDimension(),deltaW=dimension.width-oldDim.width,deltaH=dimension.height-oldDim.height,selfOldDim=this.getDimension(),selfNewDim={width:selfOldDim.width+deltaW,height:selfOldDim.height+deltaH};return this.setDimension(selfNewDim.width,selfNewDim.height),this},exportToDataUri:function(dataType,options){return this.getViewer().exportToDataUri(dataType,options)},exportDetails:function(dataType,options){this.getAutoSizeExport()&&this.setAutoSize(!0);var ops=this.getViewer().getActualDrawOptions(),dim=this.getViewer().getContextDimension(),result={dataUri:this.exportToDataUri(dataType,options),drawOptions:ops,drawOptionsJson:JSON.stringify(ops),chemObj:this.getChemObj(),chemObjJson:Kekule.IO.saveMimeData(this.getChemObj(),"chemical/x-kekule-json"),autoSize:this.getAutoSizeExport(),autofit:this.getAutofit(),width:Math.round(dim.width),height:Math.round(dim.height),renderType:this.getRenderType()||Kekule.Render.RendererType.R2D,backgroundColor:this.getBackgroundColor(this.getRenderType()),predefinedSetting:this.getExportViewerPredefinedSetting()};if(this.getAutoSizeExport()){this.setAutoSize(!1);var elem=this.getViewer().getElement();elem.style.width="auto",elem.style.height="auto",this.getViewer().resized()}return result},getExportImgElemAttributes:function(dataType,options){var detail=this.exportDetails(dataType,options),style="width:"+detail.width+"px; height:"+detail.height+"px",result={src:detail.dataUri,style:style,width:detail.width,height:detail.height,"data-kekule-widget":"Kekule.ChemWidget.Viewer","data-render-type":detail.renderType,"data-chem-obj":detail.chemObjJson,"data-draw-options":detail.drawOptionsJson,"data-predefined-setting":detail.predefinedSetting};return Kekule.ObjUtils.notUnset(detail.autoSize)&&(result["data-auto-size"]=detail.autoSize),Kekule.ObjUtils.notUnset(detail.autofit)&&(result["data-auto-fit"]=detail.autofit),Kekule.ObjUtils.notUnset(detail.backgroundColor)&&(result["data-background-color"]=detail.backgroundColor),result},createExportImgElement:function(doc,dataType,options){var result=doc.createElement("img"),attribs=this.getExportImgElemAttributes(dataType,options);return Kekule.DomUtils.setElemAttributes(result,attribs),result},importChemObjWithDetails:function(chemObj,detail){return this.setChemObj(chemObj),this.setRenderType(detail.renderType||Kekule.Render.RendererType.R2D),Kekule.ObjUtils.notUnset(detail.autoSize)&&this.setAutoSizeExport(!!detail.autoSize),Kekule.ObjUtils.notUnset(detail.autofit)&&this.setAutofit(!!detail.autofit),!detail.width||!detail.height||detail.autoSize&&detail.renderType!==Kekule.Render.RendererType.R3D||this.setContextDimension({width:detail.width,height:detail.height}),detail.drawOptions&&this.getViewer().setDrawOptions(detail.drawOptions),detail.backgroundColor&&this.setBackgroundColor(detail.backgroundColor,this.getRenderType()),this},importFromElemAttribs:function(attribs){attribs.width=JsonUtility.parse(attribs.width),attribs.height=JsonUtility.parse(attribs.height);var chemObjJson=attribs["data-chem-obj"],chemObj=chemObjJson?Kekule.IO.loadMimeData(chemObjJson,"chemical/x-kekule-json"):null;return attribs["data-render-type"]&&(attribs.renderType=JsonUtility.parse(attribs["data-render-type"])),attribs["data-draw-options"]&&(attribs.drawOptions=JsonUtility.parse(attribs["data-draw-options"])),attribs["data-auto-size"]&&(attribs.autoSize=JsonUtility.parse(attribs["data-auto-size"])),attribs["data-autofit"]&&(attribs.autofit=JsonUtility.parse(attribs["data-autofit"])),attribs.backgroundColor&&(attribs.backgroundColor=attribs.backgroundColor),this.importChemObjWithDetails(chemObj,attribs)},importFromElem:function(element){var dim=Kekule.HtmlElementUtils.getElemBoundingClientRect(element),attribs=Kekule.DomUtils.fetchAttributeValuesToJson(element);return attribs.width||(attribs.width=dim.width),attribs.height||(attribs.height=dim.height),this.importFromElemAttribs(attribs)}}),Kekule.ChemWidget.ChemObjInserter.Configurator=Class.create(Kekule.Widget.Configurator,{CLASS_NAME:"Kekule.ChemWidget.ChemObjInserter.Configurator",initialize:function($super,widget){this._checkBoxAutoSize=null,this._checkBoxAutofit=null,this._checkBoxShowInfo=null,this._textBoxWidth=null,this._textBoxHeight=null,this._colorPicker=null,$super(widget),this.addEventListener("valueChange",function(e){this.saveConfigValues()},this)},initPropValues:function($super){$super(),this.setAutoUpdate(!0)},doGetWidgetClassName:function($super){return $super()+" "+CCNS.CHEMOBJSETTER_CONFIGURATOR},doCreateSubElements:function(doc,element){var region=doc.createElement("div");region.className=CCNS.CHEMOBJSETTER_REGION;var checkBox=new Kekule.Widget.CheckBox(this);checkBox.setText(Kekule.$L("ChemWidgetTexts.CAPTION_AUTOSIZE")),checkBox.addClassName(CCNS.CHEMOBJSETTER_LINE),checkBox.appendToElem(region),this._checkBoxAutoSize=checkBox;var assocText=doc.createElement("span");assocText.className=CNS.PART_ASSOC_TEXT_CONTENT,DU.setElementText(assocText,Kekule.$L("ChemWidgetTexts.HINT_AUTOSIZE")),region.appendChild(assocText);var checkBox=new Kekule.Widget.CheckBox(this);checkBox.setText(Kekule.$L("ChemWidgetTexts.CAPTION_AUTOFIT")),checkBox.addClassName(CCNS.CHEMOBJSETTER_LINE),checkBox.appendToElem(region),this._checkBoxAutofit=checkBox;var assocText=doc.createElement("span");assocText.className=CNS.PART_ASSOC_TEXT_CONTENT,DU.setElementText(assocText,Kekule.$L("ChemWidgetTexts.HINT_AUTOFIT")),region.appendChild(assocText),element.appendChild(region);var region=doc.createElement("div");region.className=CCNS.CHEMOBJSETTER_REGION;var labelElem=doc.createElement("label");labelElem.className=CCNS.CHEMOBJSETTER_REGION_LABEL,DU.setElementText(labelElem,Kekule.$L("ChemWidgetTexts.CAPTION_LABEL_SIZE")),region.appendChild(labelElem),region.appendChild(doc.createElement("br"));var textBox=new Kekule.Widget.TextBox(this);textBox.setPlaceholder(Kekule.$L("ChemWidgetTexts.PLACEHOLDER_WIDTH")),textBox.appendToElem(region),this._textBoxWidth=textBox;var labelElem=doc.createElement("span");DU.setElementText(labelElem,"×"),region.appendChild(labelElem);var textBox=new Kekule.Widget.TextBox(this);textBox.setPlaceholder(Kekule.$L("ChemWidgetTexts.PLACEHOLDER_HEIGHT")),textBox.appendToElem(region),this._textBoxHeight=textBox;var checkBox=new Kekule.Widget.CheckBox(this);checkBox.setText(Kekule.$L("ChemWidgetTexts.CAPTION_SHOWSIZEINFO")),checkBox.appendToElem(region),this._checkBoxShowInfo=checkBox,element.appendChild(region);var region=doc.createElement("div");region.className=CCNS.CHEMOBJSETTER_REGION;var labelElem=doc.createElement("label");labelElem.className=CCNS.CHEMOBJSETTER_REGION_LABEL,DU.setElementText(labelElem,Kekule.$L("ChemWidgetTexts.CAPTION_BACKGROUND_COLOR")),region.appendChild(labelElem),region.appendChild(doc.createElement("br"));var colorPicker=new Kekule.Widget.ColorPicker(this);colorPicker.setSpecialColors([Kekule.Widget.ColorPicker.SpecialColors.TRANSPARENT]),colorPicker.appendToElem(region),this._colorPicker=colorPicker,element.appendChild(region)},loadConfigValues:function($super){$super();var w=this.getWidget();if(w){var is2D=!w.getIs3D();this._checkBoxAutoSize.setChecked(is2D&&w.getAutoSizeExport()),this._checkBoxAutoSize.setEnabled(is2D),this._checkBoxAutofit.setChecked(is2D&&w.getAutofit()),this._checkBoxAutofit.setEnabled(is2D),this._checkBoxShowInfo.setChecked(w.getShowInfo());var dim=w.getContextDimension();this._textBoxWidth.setText(Math.round(dim.width)),this._textBoxHeight.setText(Math.round(dim.height));var color=is2D?w.getBackgroundColor2D():w.getBackgroundColor3D();this._colorPicker.setValue(color||Kekule.Widget.ColorPicker.SpecialColors.TRANSPARENT)}},saveConfigValues:function($super){$super();var w=this.getWidget();if(w){!w.getIs3D()?(w.setAutoSizeExport(this._checkBoxAutoSize.getChecked()),w.setAutofit(this._checkBoxAutofit.getChecked()),w.setBackgroundColor2D(this._colorPicker.getValue())):w.setBackgroundColor3D(this._colorPicker.getValue()),w.setShowInfo(this._checkBoxShowInfo.getChecked());var dim={width:parseInt(this._textBoxWidth.getText()),height:parseInt(this._textBoxHeight.getText())};w.setContextDimension(dim),w.invokeEvent("configSave")}}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,ClassEx=__webpack_require__(0).ClassEx,DataType=__webpack_require__(0).DataType;module.exports=function(Kekule){var C=Kekule.CoordMode,AU=Kekule.ArrayUtils;return ClassEx.extend(Kekule.ChemObject,{isStandalone:function(){return!this.getIsAttachedToParent()},getStandaloneAncestor:function(){for(var result=this;result.isStandalone&&!result.isStandalone()&&result.getParent&&result.getParent();)result=result.getParent();return result},getCascadeDeleteObjs:function(){return[]},cascadeRemove:function(freeObj){var parent=this.getParent();parent&&parent.notifyBeforeCascadeRemove&&parent.notifyBeforeCascadeRemove(this),freeObj?this.finalize():this.removeSelf(),parent&&parent.notifyAfterCascadeRemove&&parent.notifyAfterCascadeRemove(this)},notifyBeforeCascadeRemove:function(childToBeDeleted,freeObj){},notifyAfterCascadeRemove:function(childBeDeleted,freeObj){!this.getKeepEmptyEvenOnCascadeRemove()&&this.isEmpty()&&this.cascadeRemove(freeObj)},isCoordDependent:function(){return!1},getCoordDependentObjects:function(){var result=[];return this.isCoordDependent()||result.push(this),result},getCoordDeterminateObjects:function(){var result=[];if(this.getAttachedMarkers)for(var markers=this.getAttachedMarkers(),i=0,l=markers.length;i<l;++i)result=result.concat(markers[i].getCoordDependentObjects());return result},getAllContainingConnectors:function(){return[]},getConstraintManipulationBaseObj:function(){if(this.isAttachedMarker&&this.isAttachedMarker()){var p=this.getParent();return p instanceof Kekule.StructureFragment?null:p}return null},transformAbsCoordByMatrix:function(transformMatrix,childTransformMatrix,coordMode,cascade,allowCoordBorrow,_useChildCoord){if(this.getChildCount&&(cascade||Kekule.ObjUtils.isUnset(cascade)))for(var i=0,l=this.getChildCount();i<l;++i){var child=this.getChildAt(i);child&&child.transformAbsCoordByMatrix&&child.transformAbsCoordByMatrix(childTransformMatrix,childTransformMatrix,coordMode,cascade,allowCoordBorrow,!0)}var transformFunc=coordMode===Kekule.CoordMode.COORD3D?Kekule.CoordUtils.transform3DByMatrix:Kekule.CoordUtils.transform2DByMatrix;if(_useChildCoord){if(this.getCoordOfMode&&this.setCoordOfMode){var coord=this.getCoordOfMode(coordMode,allowCoordBorrow),newCoord=transformFunc(coord,transformMatrix);this.setCoordOfMode(newCoord,coordMode)}}else if(this.getAbsCoordOfMode&&this.setAbsCoordOfMode){var coord=this.getAbsCoordOfMode(coordMode,allowCoordBorrow),newCoord=transformFunc(coord,transformMatrix);this.setAbsCoordOfMode(newCoord,coordMode)}},scaleSize:function(scale,coordMode,cascade,allowCoordBorrow){if(this.getSizeOfMode&&this.setSizeOfMode){var size=this.getSizeOfMode(coordMode,allowCoordBorrow),newSize=Kekule.CoordUtils.multiply(size,scale);this.setSizeOfMode(newSize,coordMode)}if(this.getChildCount&&(cascade||Kekule.ObjUtils.isUnset(cascade)))for(var i=0,l=this.getChildCount();i<l;++i){var child=this.getChildAt(i);child&&child.scaleSize&&child.scaleSize(scale,coordMode,cascade,allowCoordBorrow)}}}),ClassEx.extendMethod(Kekule.ChemObject,"_attachedMarkerAdded",function($origin,marker){var result=$origin(marker);return marker&&marker.setIsAttachedToParent(!0),result}),ClassEx.extendMethod(Kekule.ChemObject,"_attachedMarkerRemoved",function($origin,marker){var result=$origin(marker);return marker&&marker.setIsAttachedToParent(!1),result}),ClassEx.defineProps(Kekule.ChemObject,[{name:"keepEmptyEvenOnCascadeRemove",dataType:DataType.BOOL,scope:Class.PropertyScope.PUBLIC},{name:"isAttachedToParent",dataType:DataType.BOOL,scope:Class.PropertyScope.PUBLIC}]),ClassEx.extend(Kekule.ChemStructureObject,{getCascadeDeleteObjs:function($super){for(var result=$super(),linkedConnectors=this.getLinkedConnectors?this.getLinkedConnectors():[],i=0,l=linkedConnectors.length;i<l;++i){var connector=linkedConnectors[i];if(connector.getConnectedObjs().length<=2){Kekule.ArrayUtils.pushUnique(result,connector);var newCascadeObjs=connector.getCascadeDeleteObjs();Kekule.ArrayUtils.pushUnique(result,newCascadeObjs)}}return result},isStandalone:function($super){return!1},getCoordDeterminateObjects:function($super){for(var result=$super(),connectors=this.getLinkedConnectors(),i=0,l=connectors.length;i<l;++i){var connector=connectors[i];AU.pushUnique(result,connector),AU.pushUnique(result,connector.getCoordDeterminateObjects())}return result}}),ClassEx.extend(Kekule.BaseStructureNode,{getCascadeDeleteObjs:function($super){return $super()},isCoordDependent:function(){return!1},move:function(delta,coordMode){var oldCoord=this.getCoordOfMode(coordMode),newCoord=Kekule.CoordUtils.add(oldCoord,delta);return this.setCoordOfMode(newCoord,coordMode),newCoord},move2D:function(delta){return this.move(delta,C.COORD2D)},move3D:function(delta){return this.move(delta,C.COORD3D)}}),ClassEx.extend(Kekule.BaseStructureConnector,{getCascadeDeleteObjs:function($super){for(var result=$super(),objs=this.getConnectedObjs(),i=0,l=objs.length;i<l;++i){var obj=objs[i];obj instanceof Kekule.BaseStructureNode&&obj.getLinkedConnectors().length<=1&&Kekule.ArrayUtils.pushUnique(result,obj)}return result},isCoordDependent:function(){return!0},getCoordDependentObjects:function($super){for(var result=$super(),objs=this.getConnectedObjs(),i=0,l=objs.length;i<l;++i){var connObj,obj=objs[i];if(obj.isExposed)var connObj=obj.isExposed()?obj:obj.getExposedAncestor();else connObj=obj;connObj&&AU.pushUnique(result,connObj.getCoordDependentObjects())}return result},move:function(delta,coordMode){for(var i=0,l=this.getConnectedObjCount();i<l;++i){var obj=this.getConnectedObjAt(i);obj.move&&obj.move(delta,coordMode)}},move2D:function(delta){return this.move(delta,C.COORD2D)},move3D:function(delta){return this.move(delta,C.COORD3D)},setAbsBaseCoord:function(value,coordMode){var old=this.getAbsBaseCoord(),delta=Kekule.CoordUtils.substract(value,old);this.move(delta,coordMode)},setAbsBaseCoord2D:function(value){this.setAbsCoordOfMode(value,Kekule.CoordMode.COORD2D)},setAbsBaseCoord3D:function(value){this.setAbsCoordOfMode(value,Kekule.CoordMode.COORD3D)}}),ClassEx.extend(Kekule.ChemStructureNode,{getConstraintManipulationBaseObj:function($super){var linkedObjs=this.getLinkedObjs();return 1===linkedObjs.length?linkedObjs[0]:$super()}}),ClassEx.extend(Kekule.Glyph.PathGlyphNode,{getCascadeDeleteObjs:function($super){return[this.getParent()]}}),ClassEx.extend(Kekule.Glyph.PathGlyphConnector,{getCascadeDeleteObjs:function($super){return[this.getParent()]}}),ClassEx.extend(Kekule.StructureFragment,{isStandalone:function($super){return!this.getCrossConnectors().length},notifyBeforeCascadeRemove:function($super,childToBeDeleted,freeObj){var dependantObjs=this._getObjsNeedToBeCascadeRemoved(childToBeDeleted);if(dependantObjs&&dependantObjs.length)for(var i=dependantObjs.length-1;i>=0;--i){var obj=dependantObjs[i];freeObj?obj.finalize():obj.removeSelf()}$super(childToBeDeleted,freeObj)},getCoordDependentObjects:function($super){if(this.isExpanded&&!this.isExpanded())return $super();if(this.hasCtab()){for(var result=$super(),childCount=this.getChildCount(),i=0;i<childCount;++i){var child=this.getChildAt(i);AU.pushUnique(result,child.getCoordDependentObjects())}return result}return $super()},transformAbsCoordByMatrix:function($super,transformMatrix,childTransformMatrix,coordMode,cascade,allowCoordBorrow,_useChildCoord){if(cascade||Kekule.ObjUtils.isUnset(cascade))for(var i=0,l=this.getNodeCount();i<l;++i){var node=this.getNodeAt(i);node&&node.transformAbsCoordByMatrix&&node.transformAbsCoordByMatrix(childTransformMatrix,childTransformMatrix,coordMode,cascade,allowCoordBorrow,!0)}$super(transformMatrix,childTransformMatrix,coordMode,!1,allowCoordBorrow,_useChildCoord)}}),ClassEx.extend(Kekule.Glyph.Base,{isStandalone:function($super){return $super()}}),ClassEx.extend(Kekule.Glyph.PathGlyph,{getCoordDependentObjects:function(){for(var result=[],nodeCount=this.getNodeCount(),i=0;i<nodeCount;++i){var node=this.getNodeAt(i);result.push(node)}return result},transformAbsCoordByMatrix:function($super,transformMatrix,childTransformMatrix,coordMode,cascade,allowCoordBorrow,_useChildCoord){if(cascade||Kekule.ObjUtils.isUnset(cascade))for(var i=0,l=this.getNodeCount();i<l;++i){var node=this.getNodeAt(i);node&&node.transformAbsCoordByMatrix&&node.transformAbsCoordByMatrix(childTransformMatrix,childTransformMatrix,coordMode,cascade,allowCoordBorrow,!0)}$super(transformMatrix,childTransformMatrix,coordMode,!1,allowCoordBorrow,_useChildCoord)}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,ClassEx=__webpack_require__(0).ClassEx,DataType=__webpack_require__(0).DataType;module.exports=function(Kekule){var AU=Kekule.ArrayUtils,EU=Kekule.HtmlElementUtils,CNS=Kekule.Widget.HtmlClassNames,CCNS=Kekule.ChemWidget.HtmlClassNames;Kekule.ChemWidget.HtmlClassNames=Object.extend(Kekule.ChemWidget.HtmlClassNames,{EDITOR:"K-Chem-Editor",EDITOR_CLIENT:"K-Chem-Editor-Client",EDITOR_UIEVENT_RECEIVER:"K-Chem-Editor-UiEvent-Receiver",EDITOR2D:"K-Chem-Editor2D",EDITOR3D:"K-Chem-Editor3D"}),Kekule.ChemWidget.Editor={},Kekule.Editor=Kekule.ChemWidget.Editor,Kekule.Editor.CoordSys=Kekule.Render.CoordSystem,Kekule.Editor.BoxRegion={OUTSIDE:0,CORNER_TL:1,CORNER_TR:2,CORNER_BL:3,CORNER_BR:4,EDGE_TOP:11,EDGE_LEFT:12,EDGE_BOTTOM:13,EDGE_RIGHT:14,INSIDE:20},Kekule.Editor.BaseEditor=Class.create(Kekule.ChemWidget.ChemObjDisplayer,{CLASS_NAME:"Kekule.Editor.BaseEditor",BINDABLE_TAG_NAMES:["div","span"],initialize:function($super,parentOrElementOrDocument,chemObj,renderType,editorConfigs){this._objSelectFlag=0,this._objectUpdateFlag=0,this._uiMarkerUpdateFlag=0,this._updatedObjectDetails=[],this._operatingObjs=[],this._operatingRenderers=[],this._initialRenderTransformParams=null,this._objChanged=!1,this.setPropStoreFieldValue("enableCreateNewDoc",!0),this.setPropStoreFieldValue("enableOperHistory",!0),this.setPropStoreFieldValue("enableOperContext",!0),this.setPropStoreFieldValue("initOnNewDoc",!0),$super(parentOrElementOrDocument,chemObj,renderType),!this.getChemObj()&&this.getInitOnNewDoc()&&this.getEnableCreateNewDoc()&&this.newDoc(),this.setPropStoreFieldValue("editorConfigs",editorConfigs||this.createDefaultConfigs())},initProperties:function(){this.defineProp("editorConfigs",{dataType:"Kekule.Editor.BaseEditorConfigs",serializable:!1,getter:function(){return this.getDisplayerConfigs()},setter:function(value){return this.setDisplayerConfigs(value)}}),this.defineProp("enableCreateNewDoc",{dataType:DataType.BOOL,serializable:!1}),this.defineProp("initOnNewDoc",{dataType:DataType.BOOL,serializable:!1}),this.defineProp("enableOperHistory",{dataType:DataType.BOOL,serializable:!1}),this.defineProp("operHistory",{dataType:"Kekule.OperationHistory",serializable:!1,getter:function(){var result=this.getPropStoreFieldValue("operHistory");return result||(result=new Kekule.OperationHistory,this.setPropStoreFieldValue("operHistory",result),result.addEventListener("push",this.reactOperHistoryPush,this),result.addEventListener("pop",this.reactOperHistoryPop,this),result.addEventListener("undo",this.reactOperHistoryUndo,this),result.addEventListener("redo",this.reactOperHistoryRedo,this),result.addEventListener("clear",this.reactOperHistoryClear,this),result.addEventListener("change",this.reactOperHistoryChange,this)),result},setter:null}),this.defineProp("selection",{dataType:DataType.ARRAY,serializable:!1,getter:function(){var result=this.getPropStoreFieldValue("selection");return result||(result=[],this.setPropStoreFieldValue("selection",result)),result},setter:function(value){this.setPropStoreFieldValue("selection",value),this.selectionChanged()}}),this.defineProp("hotTrackedObjs",{dataType:DataType.ARRAY,serializable:!1,setter:function(value){var objs=value?Kekule.ArrayUtils.toArray(value):[];if(this.getEditorConfigs()&&this.getEditorConfigs().getInteractionConfigs().getEnableHotTrack()){this.setPropStoreFieldValue("hotTrackedObjs",objs);var bounds;if(objs&&objs.length){bounds=[];for(var i=0,l=objs.length;i<l;++i){var bound=this.getBoundInfoRecorder().getBound(this.getObjContext(),objs[i]);bounds&&Kekule.ArrayUtils.pushUnique(bounds,bound)}}bounds?this.changeHotTrackMarkerBounds(bounds):this.getUiHotTrackMarker().getVisible()&&this.hideHotTrackMarker()}}}),this.defineProp("hotTrackedObj",{dataType:DataType.OBJECT,serializable:!1,getter:function(){return this.getHotTrackedObjs()&&this.getHotTrackedObjs()[0]},setter:function(value){this.setHotTrackedObjs(value)}}),this.defineProp("enableOperContext",{dataType:DataType.BOOL,setter:function(value){if(this.setPropStoreFieldValue("enableOperContext",!!value),!value){var ctx=this.getPropStoreFieldValue("operContext"),b=this.getPropStoreFieldValue("drawBridge");b&&ctx&&b.releaseContext(ctx)}}}),this.defineProp("uiEventReceiverElem",{dataType:DataType.OBJECT,serializable:!1,setter:null}),this.defineProp("objContextParentElem",{dataType:DataType.OBJECT,serializable:!1,setter:null}),this.defineProp("operContextParentElem",{dataType:DataType.OBJECT,serializable:!1,setter:null}),this.defineProp("uiContextParentElem",{dataType:DataType.OBJECT,serializable:!1,setter:null}),this.defineProp("objContext",{dataType:DataType.OBJECT,serializable:!1,setter:null,getter:function(){return this.getDrawContext()}}),this.defineProp("operContext",{dataType:DataType.OBJECT,serializable:!1,setter:null,getter:function(){if(this.getEnableOperContext()){var result=this.getPropStoreFieldValue("operContext");if(!result){var bridge=this.getDrawBridge();if(bridge){var elem=this.getOperContextParentElem();if(!elem)return null;var dim=Kekule.HtmlElementUtils.getElemScrollDimension(elem);result=bridge.createContext(elem,dim.width,dim.height),this.setPropStoreFieldValue("operContext",result)}}return result}return null}}),this.defineProp("uiContext",{dataType:DataType.OBJECT,serializable:!1,getter:function(){var result=this.getPropStoreFieldValue("uiContext");if(!result){var bridge=this.getUiDrawBridge();if(bridge){var elem=this.getUiContextParentElem();if(!elem)return null;var dim=Kekule.HtmlElementUtils.getElemScrollDimension(elem);result=bridge.createContext(elem,dim.width,dim.height),this.setPropStoreFieldValue("uiContext",result)}}return result}}),this.defineProp("objDrawBridge",{dataType:DataType.OBJECT,serializable:!1,setter:null,getter:function(){return this.getDrawBridge()}}),this.defineProp("uiDrawBridge",{dataType:DataType.OBJECT,serializable:!1,setter:null,getter:function(){var result=this.getPropStoreFieldValue("uiDrawBridge");return result||(result=this.createUiDrawBridge(),this.setPropStoreFieldValue("uiDrawBridge",result)),result}}),this.defineProp("uiPainter",{dataType:"Kekule.Render.ChemObjPainter",serializable:!1,setter:null,getter:function(){var result=this.getPropStoreFieldValue("uiPainter");if(!result){var markers=this.getUiMarkers();return result=new Kekule.Render.ChemObjPainter(Kekule.Render.RendererType.R2D,markers,this.getUiDrawBridge()),result.setCanModifyTargetObj(!0),this.setPropStoreFieldValue("uiPainter",result),result}return result}}),this.defineProp("uiRenderer",{dataType:"Kekule.Render.AbstractRenderer",serializable:!1,setter:null,getter:function(){var p=this.getUiPainter();if(p){return p.getRenderer()||p.prepareRenderer(),p.getRenderer()||null}return null}}),this.defineProp("uiMarkers",{dataType:"Kekule.ChemWidget.UiMarkerCollection",serializable:!1,setter:null,getter:function(){var result=this.getPropStoreFieldValue("uiMarkers");return result||(result=new Kekule.ChemWidget.UiMarkerCollection,this.setPropStoreFieldValue("uiMarkers",result)),result}}),this._defineUiMarkerProp("uiHotTrackMarker"),this._defineUiMarkerProp("uiSelectionAreaMarker"),this._defineUiMarkerProp("uiSelectingMarker"),this.defineProp("uiSelectionAreaContainerBox",{dataType:DataType.Object,serializable:!1,scope:Class.PropertyScope.PRIVATE}),this.defineProp("objRendererMap",{dataType:"Kekule.MapEx",serializable:!1,setter:null,getter:function(){var result=this.getPropStoreFieldValue("objRendererMap");return result||(result=new Kekule.MapEx(!0),this.setPropStoreFieldValue("objRendererMap",result)),result}}),this.defineProp("boundInfoRecorder",{dataType:"Kekule.Render.BoundInfoRecorder",serializable:!1,setter:null})},_defineUiMarkerProp:function(propName,uiMarkerCollection){return this.defineProp(propName,{dataType:"Kekule.ChemWidget.AbstractUIMarker",serializable:!1,getter:function(){var result=this.getPropStoreFieldValue(propName);return result||(result=this.createShapeBasedMarker(propName,null,null,!1)),result},setter:function(value){uiMarkerCollection||(uiMarkerCollection=this.getUiMarkers());var old=this.getPropValue(propName);old&&(uiMarkerCollection.removeMarker(old),old.finalize()),uiMarkerCollection.addMarker(value),this.setPropStoreFieldValue(propName,value)}})},doFinalize:function($super){var h=this.getPropStoreFieldValue("operHistory");h&&(h.finalize(),this.setPropStoreFieldValue("operHistory",null));var b=this.getPropStoreFieldValue("objDrawBridge"),ctx=this.getPropStoreFieldValue("operContext");b&&ctx&&b.releaseContext(ctx),this.setPropStoreFieldValue("operContext",null);var b=this.getPropStoreFieldValue("uiDrawBridge"),ctx=this.getPropStoreFieldValue("uiContext");b&&ctx&&b.releaseContext(ctx),this.setPropStoreFieldValue("uiDrawBridge",null),this.setPropStoreFieldValue("uiContext",null);var r=this.getPropStoreFieldValue("boundInfoRecorder");r&&r.finalize(),this.setPropStoreFieldValue("boundInfoRecorder",null);var m=this.getPropStoreFieldValue("objRendererMap");m&&m.finalize(),this.setPropStoreFieldValue("objRendererMap",null),$super()},createDefaultConfigs:function(){return new Kekule.Editor.BaseEditorConfigs},doCreateRootElement:function(doc){return doc.createElement("div")},doCreateSubElements:function(doc,rootElem){var elem=doc.createElement("div");return elem.className=CCNS.EDITOR_CLIENT,rootElem.appendChild(elem),this._editClientElem=elem,[elem]},getCoreElement:function($super){return this._editClientElem||$super()},getEditClientElem:function(){return this._editClientElem},doGetWidgetClassName:function($super){var result=$super()+" "+CCNS.EDITOR;return result+=" "+(this.getRenderType()===Kekule.Render.RendererType.R3D?CCNS.EDITOR3D:CCNS.EDITOR2D)},doBindElement:function(element){this.createContextParentElems(),this.createUiEventReceiverElem()},changeClientSize:function(width,height,zoomLevel){this._initialRenderTransformParams=null;var elem=this.getCoreElement(),style=elem.style;zoomLevel||(zoomLevel=1);var w=width*zoomLevel,h=height*zoomLevel;w&&(style.width=w+"px"),h&&(style.height=h+"px");for(var ctxes=[this.getObjContext(),this.getOperContext(),this.getUiContext()],i=0,l=ctxes.length;i<l;++i){var ctx=ctxes[i];ctx&&this.getDrawBridge().setContextDimension(ctx,w,h)}this.repaint()},isDirty:function(){return this.getEnableOperHistory()?this.getOperHistory().getCurrIndex()>=0:this._objChanged},getChemObjSrcInfo:function(chemObj){return this.isDirty()?null:chemObj.getSrcInfo?chemObj.getSrcInfo():null},getActualDrawOptions:function($super){var old=$super();if(this._initialRenderTransformParams){var result=Object.extend({},this._initialRenderTransformParams);return result=Object.extend(result,old)}return old},repaint:function($super,overrideOptions){var ops=overrideOptions,result=$super(ops);return this._initialRenderTransformParams||(this._initialRenderTransformParams=this.getPainter().getActualInitialRenderTransformOptions(this.getObjContext())),this.recalcUiMarkers(),result},newDoc:function(){this.load(this.doCreateNewDocObj())},doCreateNewDocObj:function(){return new Kekule.Molecule},getExportableClasses:function(){var obj=this.getChemObj();return obj?obj.getClass?obj.getClass():null:[]},exportObj:function(objClass){return this.exportObjs(objClass)[0]},exportObjs:function(objClass){var obj=this.getChemObj();return objClass?obj&&obj instanceof objClass?[obj]:[]:[obj]},doLoad:function($super,chemObj){this.deselectAll(),this._initialRenderTransformParams=null,this.getObjRendererMap().clear(),this.getOperHistory()&&this.getOperHistory().clear(),$super(chemObj),this._objChanged=!1},doLoadEnd:function($super,chemObj){$super(),chemObj||(this._initialRenderTransformParams=null)},doResize:function($super){this._initialRenderTransformParams=null,$super()},geometryOptionChanged:function($super){var zoom=this.getDrawOptions().zoom;this.zoomChanged(zoom),$super()},zoomChanged:function(zoomLevel){},chemObjChanged:function($super,newObj,oldObj){$super(newObj,oldObj),newObj!==oldObj&&(oldObj&&this._uninstallChemObjEventListener(oldObj),newObj&&this._installChemObjEventListener(newObj))},_installChemObjEventListener:function(chemObj){chemObj.addEventListener("change",this.reactChemObjChange,this)},_uninstallChemObjEventListener:function(chemObj){chemObj.removeEventListener("change",this.reactChemObjChange,this)},createUiEventReceiverElem:function(){var parent=this.getCoreElement();if(parent){var result=parent.ownerDocument.createElement("div");return result.className=CCNS.EDITOR_UIEVENT_RECEIVER,parent.appendChild(result),EU.addClass(result,CNS.DYN_CREATED),this.setPropStoreFieldValue("uiEventReceiverElem",result),result}},createContextParentElems:function(){var parent=this.getCoreElement();if(parent){var doc=parent.ownerDocument;this._createContextParentElem(doc,parent,"objContextParentElem"),this._createContextParentElem(doc,parent,"operContextParentElem"),this._createContextParentElem(doc,parent,"uiContextParentElem")}},_createContextParentElem:function(doc,parentElem,contextElemPropName){var result=doc.createElement("div");return result.style.position="absolute",result.style.width="100%",result.style.height="100%",result.className=contextElemPropName+" "+CNS.DYN_CREATED,this.setPropStoreFieldValue(contextElemPropName,result),parentElem.appendChild(result),result},createNewPainter:function($super,chemObj){var result=$super(chemObj);return result&&(result.setCanModifyTargetObj(!0),this.installPainterEventHandlers(result),this.createNewBoundInfoRecorder(this.getPainter())),result},createNewBoundInfoRecorder:function(renderer){var old=this.getPropStoreFieldValue("boundInfoRecorder");old&&old.finalize();var recorder=new Kekule.Render.BoundInfoRecorder(renderer);this.setPropStoreFieldValue("boundInfoRecorder",recorder)},getDrawContextParentElem:function(){return this.getObjContextParentElem()},createUiDrawBridge:function(){var result=Kekule.Render.DrawBridge2DMananger.getPreferredBridgeInstance();return result||Kekule.error(Kekule.$L("ErrorMsg.DRAW_BRIDGE_NOT_SUPPORTED")),result},changeContextDimension:function($super,newDimension){var result=$super(newDimension);return result&&(this._resizeContext(this.getOperContext(),this.getObjDrawBridge(),newDimension.width,newDimension.height),this._resizeContext(this.getUiContext(),this.getUiDrawBridge(),newDimension.width,newDimension.height)),result},_resizeContext:function(context,bridge,width,height){context&&bridge&&bridge.setContextDimension(context,width,height)},_clearSpecContext:function(context,bridge){bridge&&context&&bridge.clearContext(context)},clearObjContext:function(){this._clearSpecContext(this.getObjContext(),this.getDrawBridge()),this.getBoundInfoRecorder()&&this.getBoundInfoRecorder().clear(this.getObjContext())},clearOperContext:function(){this._clearSpecContext(this.getOperContext(),this.getDrawBridge())},clearUiContext:function(){this._clearSpecContext(this.getUiContext(),this.getUiDrawBridge())},clearContext:function(){this.clearObjContext(),this._operatingRenderers&&this.clearOperContext()},repaintOperContext:function(ignoreUiMarker){if(this._operatingRenderers&&this._operatingObjs){this.clearOperContext();var options={partialDrawObjs:this._operatingObjs,doNotClear:!0};this.repaint(options)}},getOperatingRenderers:function(){return this._operatingRenderers||(this._operatingRenderers=[]),this._operatingRenderers},setOperatingRenderers:function(value){this._operatingRenderers=value},installPainterEventHandlers:function(painter){painter.addEventListener("prepareDrawing",this.reactChemObjPrepareDrawing,this),painter.addEventListener("clear",this.reactChemObjClear,this)},reactChemObjPrepareDrawing:function(e){var ctx=e.context,obj=e.obj;if(obj&&(ctx===this.getObjContext()||ctx===this.getOperContext())){var renderer=e.target;if(this.getObjRendererMap().set(obj,renderer),this.getEnableOperContext()){for(var operObjs=this._operatingObjs||[],needRedirect=!1,i=0,l=operObjs.length;i<l;++i)if(this._isChemObjDirectlyRenderedByRenderer(this.getObjContext(),operObjs[i],renderer)){needRedirect=!0;break}needRedirect&&(this._setRendererToOperContext(renderer),AU.pushUnique(this.getOperatingRenderers(),renderer))}}},reactChemObjClear:function(e){var ctx=e.context,obj=e.obj;if(obj&&(ctx===this.getObjContext()||ctx===this.getOperContext())){var renderer=e.target;this.getObjRendererMap().remove(obj),AU.remove(this.getOperatingRenderers(),renderer)}},reactChemObjChange:function(e){var target=e.target,propNames=e.changedPropNames||[],bypassPropNames=["owner","ownedObjs"];propNames=Kekule.ArrayUtils.exclude(propNames,bypassPropNames),!propNames.length&&e.changedPropNames||this.objectChanged(target,propNames)},reactOperHistoryPush:function(e){this.invokeEvent("operPush",e)},reactOperHistoryPop:function(e){this.invokeEvent("operPop",e)},reactOperHistoryUndo:function(e){this.invokeEvent("operUndo",e)},reactOperHistoryRedo:function(e){this.invokeEvent("operRedo",e)},reactOperHistoryClear:function(e){this.invokeEvent("operHistoryClear",e)},reactOperHistoryChange:function(e){this.invokeEvent("operChange",e)},beginUpdateObject:function(){--this._objectUpdateFlag},endUpdateObject:function(){++this._objectUpdateFlag,this.isUpdatingObject()||this._updatedObjectDetails&&this._updatedObjectDetails.length&&(this.objectsChanged(this._updatedObjectDetails),this._updatedObjectDetails=[])},isUpdatingObject:function(){return this._objectUpdateFlag<0},objectChanged:function(obj,changedPropNames){var data={obj:obj,propNames:changedPropNames},result=this.objectsChanged(data);return this.invokeEvent("editObjChanged",Object.extend({},data)),result},objectsChanged:function(objDetails){var a=DataType.isArrayValue(objDetails)?objDetails:[objDetails];this.isUpdatingObject()?Kekule.ArrayUtils.pushUnique(this._updatedObjectDetails,a):(this.doObjectsChanged(a),this.invokeEvent("editObjsUpdated",Object.extend({},objDetails))),this._objChanged=!0,this.invokeEvent("editObjsChanged",Object.extend({},objDetails))},doObjectsChanged:function(objDetails){var oDetails=Kekule.ArrayUtils.clone(objDetails),updateObjs=Kekule.Render.UpdateObjUtils._extractObjsOfUpdateObjDetails(oDetails),additionalObjs=this._getAdditionalRenderRelatedObjs(updateObjs);if(additionalObjs.length){var additionalDetails=Kekule.Render.UpdateObjUtils._createUpdateObjDetailsFromObjs(additionalObjs);Kekule.ArrayUtils.pushUnique(oDetails,additionalDetails)}Kekule.ArrayUtils.pushUnique(updateObjs,additionalObjs);var operRenderers=this._operatingRenderers,updateOperContextOnly=operRenderers&&this._isAllObjsRenderedByRenderers(this.getObjContext(),updateObjs,operRenderers);this.canModifyPartialGraphic()?(this.getRootRenderer().modify(this.getObjContext(),oDetails),this.recalcUiMarkers()):updateOperContextOnly?this.repaintOperContext():this.repaint()},_needToCanonicalizeBeforeSaving:function(){return!0},_getAdditionalRenderRelatedObjs:function(objs){for(var result=[],i=0,l=objs.length;i<l;++i){var obj=objs[i],relatedObjs=obj.getCoordDeterminateObjects?obj.getCoordDeterminateObjects():[];Kekule.ArrayUtils.pushUnique(result,relatedObjs)}return result},_isAllObjsRenderedByRenderers:function(context,objs,renders){for(var i=0,l=objs.length;i<l;++i){for(var obj=objs[i],isRendered=!1,j=0,k=renders.length;j<k;++j){if(renders[j].isChemObjRenderedBySelf(context,obj)){isRendered=!0;break}}if(!isRendered)return!1}return!0},prepareOperatingObjs:function(objs){this._operatingRenderers&&this._operatingRenderers.length&&this.endOperatingObjs(!0),this.getEnableOperContext()&&(this._prepareRenderObjsInOperContext(objs),this._operatingObjs=objs),this.repaint()},endOperatingObjs:function(noRepaint){this.getEnableOperContext()&&(this._endRenderObjsInOperContext(),this._operatingObjs=null,noRepaint||this.repaint())},_isChemObjDirectlyRenderedByRenderer:function(context,obj,renderer){var standaloneObj=obj.getStandaloneAncestor?obj.getStandaloneAncestor():obj;return renderer.isChemObjRenderedDirectlyBySelf(context,standaloneObj)},_getStandaloneRenderObjsInOperContext:function(objs){for(var standAloneObjs=[],i=0,l=objs.length;i<l;++i){var obj=objs[i];obj.getStandaloneAncestor&&(obj=obj.getStandaloneAncestor()),Kekule.ArrayUtils.pushUnique(standAloneObjs,obj)}return standAloneObjs},_prepareRenderObjsInOperContext:function(objs){for(var renderers=[],map=this.getObjRendererMap(),rs=map.getValues(),context=this.getObjContext(),standAloneObjs=this._getStandaloneRenderObjsInOperContext(objs),i=0,l=standAloneObjs.length;i<l;++i)for(var obj=standAloneObjs[i],j=0,k=rs.length;j<k;++j){var renderer=rs[j];renderer.isChemObjRenderedDirectlyBySelf(context,obj)&&Kekule.ArrayUtils.pushUnique(renderers,renderer)}if(renderers.length>0){for(var i=0,l=renderers.length;i<l;++i){var renderer=renderers[i];this._setRendererToOperContext(renderer)}this._operatingRenderers=renderers}else this._operatingRenderers=null},_endRenderObjsInOperContext:function(){var renderers=this._operatingRenderers;if(renderers&&renderers.length){for(var i=0,l=renderers.length;i<l;++i){var renderer=renderers[i];this._unsetRendererToOperContext(renderer)}this.clearOperContext()}this._operatingRenderers=null},_setRendererToOperContext:function(renderer){renderer.setRedirectContext(this.getOperContext())},_unsetRendererToOperContext:function(renderer){renderer.setRedirectContext(null)},clearBoundMap:function(){this.getBoundInfoRecorder().clear(this.getObjContext())},findTopmostBoundInfo:function(boundItems,excludeObjs){if(boundItems&&boundItems.length){var result=null,index=boundItems.length-1;for(result=boundItems[index];index>=0&&excludeObjs&&excludeObjs.indexOf(result.obj)>=0;)--index,result=boundItems[index];return result}return null},getBoundInfosAtCoord:function(screenCoord,filterFunc){var boundRecorder=this.getBoundInfoRecorder(),delta=this.getEditorConfigs().getInteractionConfigs().getObjBoundTrackInflation(),coord=this.screenCoordToContext(screenCoord),refCoord=this.getRenderType()===Kekule.Render.RendererType.R3D?{x:0,y:0}:null;return boundRecorder.getIntersectionInfos(this.getObjContext(),coord,refCoord,delta,filterFunc)},getTopmostBoundInfoAtCoord:function(screenCoord,excludeObjs){if(!this.getEditorConfigs().getInteractionConfigs().getEnableTrackOnNearest())return this.findTopmostBoundInfo(this.getBoundInfosAtCoord(screenCoord),excludeObjs);for(var result,lastShapeInfo,lastDistance,SU=Kekule.Render.MetaShapeUtils,boundInfos=this.getBoundInfosAtCoord(screenCoord),setResult=function(boundInfo,shapeInfo,distance){result=boundInfo,lastShapeInfo=shapeInfo||boundInfo.boundInfo,lastDistance=Kekule.ObjUtils.notUnset(distance)?distance:SU.getDistance(screenCoord,lastShapeInfo)},i=boundInfos.length-1;i>=0;--i){var info=boundInfos[i];if(!(excludeObjs&&excludeObjs.indexOf(info.obj)>=0))if(result){var shapeInfo=info.boundInfo;if(shapeInfo.shapeType<lastShapeInfo.shapeType)setResult(info,shapeInfo);else if(shapeInfo.shapeType===lastShapeInfo.shapeType){var currDistance=SU.getDistance(screenCoord,shapeInfo);currDistance<lastDistance&&setResult(info,shapeInfo,currDistance)}}else setResult(info)}return result},getTopmostBasicObjectAtCoord:function(screenCoord){var boundItem=this.getTopmostBoundInfoAtCoord(screenCoord);return boundItem?boundItem.obj:null},beginUpdateUiMarkers:function(){--this._uiMarkerUpdateFlag},endUpdateUiMarkers:function(){++this._uiMarkerUpdateFlag,this.isUpdatingUiMarkers()||this.repaintUiMarker()},isUpdatingUiMarkers:function(){return this._uiMarkerUpdateFlag<0},recalcUiMarkers:function(){this.beginUpdateUiMarkers();try{this.recalcHotTrackMarker(),this.recalcSelectionAreaMarker()}finally{this.endUpdateUiMarkers()}},repaintUiMarker:function(){if(!this.isUpdatingUiMarkers()){this.clearUiContext();var drawParams=this.calcDrawParams();this.getUiPainter().draw(this.getUiContext(),drawParams.baseCoord,drawParams.drawOptions)}},createShapeBasedMarker:function(markerPropName,shapeInfo,drawStyles,updateRenderer){var marker=new Kekule.ChemWidget.MetaShapeUIMarker;return shapeInfo&&marker.setShapeInfo(shapeInfo),drawStyles&&marker.setDrawStyles(drawStyles),this.setPropStoreFieldValue(markerPropName,marker),this.getUiMarkers().addMarker(marker),updateRenderer&&this.repaintUiMarker(),marker},modifyShapeBasedMarker:function(marker,newShapeInfo,drawStyles,updateRenderer){Kekule.Render.ObjectUpdateType.MODIFY;marker.setShapeInfo(newShapeInfo),drawStyles&&marker.setDrawStyles(drawStyles),updateRenderer&&this.repaintUiMarker()},hideUiMarker:function(marker,updateRenderer){marker.setVisible(!1),updateRenderer&&this.repaintUiMarker()},showUiMarker:function(marker,updateRenderer){marker.setVisible(!0),updateRenderer&&this.repaintUiMarker()},removeUiMarker:function(marker){marker&&(this.getUiMarkers().removeMarker(marker),this.repaintUiMarker())},clearUiMarkers:function(){this.getUiMarkers().clearMarkers(),this.repaintUiMarker()},changeHotTrackMarkerBounds:function(newBoundInfos){for(var infos=Kekule.ArrayUtils.toArray(newBoundInfos),styleConfigs=this.getEditorConfigs().getUiMarkerConfigs(),drawStyles={color:styleConfigs.getHotTrackerColor(),opacity:styleConfigs.getHotTrackerOpacity()},inflation=this.getEditorConfigs().getInteractionConfigs().getObjBoundTrackInflation(),bounds=[],i=0,l=infos.length;i<l;++i){var boundInfo=infos[i],bound=inflation?Kekule.Render.MetaShapeUtils.inflateShape(boundInfo,inflation):boundInfo;bound&&bounds.push(bound)}var tracker=this.getUiHotTrackMarker();return tracker.setVisible(!0),this.modifyShapeBasedMarker(tracker,bounds,drawStyles,!0),this},hideHotTrackMarker:function(){var tracker=this.getUiHotTrackMarker();return tracker&&this.hideUiMarker(tracker,!0),this},showHotTrackMarker:function(){var tracker=this.getUiHotTrackMarker();return tracker&&this.showUiMarker(tracker,!0),this},hotTrackOnCoord:function(screenCoord){return this.getEditorConfigs().getInteractionConfigs().getEnableHotTrack()&&this.setHotTrackedObj(this.getTopmostBasicObjectAtCoord(screenCoord)),this},hotTrackOnObj:function(obj){return this.setHotTrackedObj(obj),this},hideHotTrack:function(){return this.hideHotTrackMarker(),this},addHotTrackedObj:function(obj){var olds=this.getHotTrackedObjs()||[];return Kekule.ArrayUtils.pushUnique(olds,obj),this.setHotTrackedObjs(olds),this},recalcHotTrackMarker:function(){this.setHotTrackedObjs(this.getHotTrackedObjs())},changeSelectionAreaMarkerBound:function(newBoundInfo){var styleConfigs=this.getEditorConfigs().getUiMarkerConfigs(),drawStyles={strokeColor:styleConfigs.getSelectionMarkerStrokeColor(),strokeWidth:styleConfigs.getSelectionMarkerStrokeWidth(),fillColor:styleConfigs.getSelectionMarkerFillColor(),opacity:styleConfigs.getSelectionMarkerOpacity()},marker=this.getUiSelectionAreaMarker();return marker.setVisible(!0),this.modifyShapeBasedMarker(marker,newBoundInfo,drawStyles,!0),this},hideSelectionAreaMarker:function(){var marker=this.getUiSelectionAreaMarker();marker&&this.hideUiMarker(marker,!0)},showSelectionAreaMarker:function(){var marker=this.getUiSelectionAreaMarker();marker&&this.showUiMarker(marker,!0)},recalcSelectionAreaMarker:function(doRepaint){this.beginUpdateUiMarkers();try{var selection=this.getSelection(),count=selection.length;if(count<=0)this.hideSelectionAreaMarker();else{for(var bounds=[],containerBox=null,inflation=this.getEditorConfigs().getInteractionConfigs().getSelectionMarkerInflation(),i=0;i<count;++i){var obj=selection[i],infos=this.getBoundInfoRecorder().getBelongedInfos(this.getObjContext(),obj);if(infos&&infos.length)for(var j=0,k=infos.length;j<k;++j){var info=infos[j],bound=info.boundInfo;if(bound){bound=Kekule.Render.MetaShapeUtils.inflateShape(bound,inflation),bounds.push(bound);var box=Kekule.Render.MetaShapeUtils.getContainerBox(bound);containerBox=containerBox?Kekule.BoxUtils.getContainerBox(containerBox,box):box}}}if(this.setUiSelectionAreaContainerBox(containerBox),containerBox){var containerShape=Kekule.Render.MetaShapeUtils.createShapeInfo(Kekule.Render.MetaShapeType.RECT,[{x:containerBox.x1,y:containerBox.y1},{x:containerBox.x2,y:containerBox.y2}]);bounds.push(containerShape)}else this.hideSelectionAreaMarker();bounds.length&&this.changeSelectionAreaMarkerBound(bounds)}}finally{this.endUpdateUiMarkers()}},startSelectingBoxDrag:function(screenCoord,toggleFlag){this._selectingBoxStartCoord=screenCoord,toggleFlag||this.deselectAll()},dragSelectingBoxToCoord:function(screenCoord){var startCoord=this._selectingBoxStartCoord,endCoord=screenCoord;this.changeSelectingMarkerBox(startCoord,endCoord)},endSelectingBoxDrag:function(screenCoord,toggleFlag){var startCoord=this._selectingBoxStartCoord;this._selectingBoxEndCoord=screenCoord;var box=Kekule.BoxUtils.createBox(startCoord,screenCoord),enablePartial=this.getEditorConfigs().getInteractionConfigs().getEnablePartialAreaSelecting();toggleFlag?this.toggleSelectingStateOfObjectsInScreenBox(box,enablePartial):this.selectObjectsInScreenBox(box,enablePartial),this.hideSelectingMarker()},selectOnCoord:function(coord,toggleFlag){var obj=this.getTopmostBasicObjectAtCoord(coord);obj&&(toggleFlag?this.toggleSelectingState(obj):this.select(obj))},changeSelectingMarkerBound:function(newBoundInfo){var styleConfigs=this.getEditorConfigs().getUiMarkerConfigs(),drawStyles={strokeColor:styleConfigs.getSelectingMarkerStrokeColor(),strokeWidth:styleConfigs.getSelectingMarkerStrokeWidth(),strokeDash:styleConfigs.getSelectingMarkerStrokeDash(),fillColor:styleConfigs.getSelectingMarkerFillColor(),opacity:styleConfigs.getSelectingMarkerOpacity()},marker=this.getUiSelectingMarker();return marker.setVisible(!0),this.modifyShapeBasedMarker(marker,newBoundInfo,drawStyles,!0),this},changeSelectingMarkerBox:function(screenCoord1,screenCoord2){var coord1=this.screenCoordToContext(screenCoord1),coord2=this.screenCoordToContext(screenCoord2),shapeInfo=Kekule.Render.MetaShapeUtils.createShapeInfo(Kekule.Render.MetaShapeType.RECT,[{x:Math.min(coord1.x,coord2.x),y:Math.min(coord1.y,coord2.y)},{x:Math.max(coord1.x,coord2.x),y:Math.max(coord1.y,coord2.y)}]);return this.changeSelectingMarkerBound(shapeInfo)},hideSelectingMarker:function(){var marker=this.getUiSelectingMarker();marker&&this.hideUiMarker(marker,!0)},showSelectingMarker:function(){var marker=this.getUiSelectingMarker();marker&&this.showUiMarker(marker,!0)},getCoordRegionInSelectionMarker:function(screenCoord,edgeInflation){var R=Kekule.Editor.BoxRegion,CU=Kekule.CoordUtils,coord=this.screenCoordToContext(screenCoord),marker=this.getUiSelectionAreaMarker();if(marker&&marker.getVisible()){var box=this.getUiSelectionAreaContainerBox();Kekule.ObjUtils.isUnset(edgeInflation)&&(edgeInflation=this.getEditorConfigs().getInteractionConfigs().getSelectionMarkerEdgeInflation());var halfInf=edgeInflation/2||0,coord1=CU.substract({x:box.x1,y:box.y1},{x:halfInf,y:halfInf}),coord2=CU.add({x:box.x2,y:box.y2},{x:halfInf,y:halfInf});if(coord.x<coord1.x||coord.y<coord1.y||coord.x>coord2.x||coord.y>coord2.y)return R.OUTSIDE;var delta1=CU.substract(coord,coord1),delta2=CU.substract(coord2,coord),dx1=delta1.x,dx2=delta2.x,dy1=delta1.y,dy2=delta2.y;return dy1<dy2?dx1<dx2?dy1<=edgeInflation?dx1<=edgeInflation?R.CORNER_TL:R.EDGE_TOP:dx1<=edgeInflation?R.EDGE_LEFT:R.INSIDE:dy1<=edgeInflation?dx2<=edgeInflation?R.CORNER_TR:R.EDGE_TOP:dx2<=edgeInflation?R.EDGE_RIGHT:R.INSIDE:dx1<dx2?dy2<=edgeInflation?dx1<=edgeInflation?R.CORNER_BL:R.EDGE_BOTTOM:dx1<=edgeInflation?R.EDGE_LEFT:R.INSIDE:dy2<=edgeInflation?dx2<=edgeInflation?R.CORNER_BR:R.EDGE_BOTTOM:dx2<=edgeInflation?R.EDGE_RIGHT:R.INSIDE}return R.OUTSIDE},isCoordInSelectionMarkerBound:function(screenCoord){return this.getCoordRegionInSelectionMarker(screenCoord)!==Kekule.Editor.BoxRegion.OUTSIDE},getObjSelectedRenderOptions:function(){return this._selectedRenderOptions},_getObjRenderOptionItemAppendMethod:function(chemObj){return this.getRenderType()===Kekule.Render.RendererType.R3D?chemObj.addOverrideRender3DOptionItem:chemObj.addOverrideRenderOptionItem},_getObjRenderOptionItemRemoveMethod:function(chemObj){return this.getRenderType()===Kekule.Render.RendererType.R3D?chemObj.removeOverrideRender3DOptionItem:chemObj.removeOverrideRenderOptionItem},_addSelectRenderOptions:function(chemObj){return this._getObjRenderOptionItemAppendMethod(chemObj).apply(chemObj,[this.getObjSelectedRenderOptions()])},_removeSelectRenderOptions:function(chemObj){return this._getObjRenderOptionItemRemoveMethod(chemObj).apply(chemObj,[this.getObjSelectedRenderOptions()])},beginUpdateSelection:function(){this.beginUpdateObject(),--this._objSelectFlag},endUpdateSelection:function(){++this._objSelectFlag,this._objSelectFlag>=0&&this.selectionChanged(),this.endUpdateObject()},isUpdatingSelection:function(){return this._objSelectFlag<0},selectionChanged:function(){if(!this.isUpdatingSelection())return this.notifyPropSet("selection",this.getSelection()),this.invokeEvent("selectionChange"),this.doSelectionChanged()},doSelectionChanged:function(){this.recalcSelectionAreaMarker()},isInSelection:function(obj){return this.getSelection().indexOf(obj)>=0},addObjToSelection:function(obj){var selection=this.getSelection();return Kekule.ArrayUtils.pushUnique(selection,obj.getNearestSelectableObject()),this._addSelectRenderOptions(obj),this.selectionChanged(),this},removeObjFromSelection:function(obj){var selection=this.getSelection();return Kekule.ArrayUtils.remove(selection,obj),this._removeSelectRenderOptions(obj),this.selectionChanged(),this},deselectAll:function(){var selection=this.getSelection();return this.removeFromSelection(selection)},select:function(objs){this.beginUpdateSelection();try{this.deselectAll(),this.addToSelection(objs)}finally{this.endUpdateSelection()}return this},addToSelection:function(param){if(param){var objs=DataType.isArrayValue(param)?param:[param];this.beginUpdateSelection();try{for(var i=0,l=objs.length;i<l;++i)this.addObjToSelection(objs[i])}finally{this.endUpdateSelection()}return this}},removeFromSelection:function(param){if(param){var objs=DataType.isArrayValue(param)?param:[param];this.beginUpdateSelection();try{for(var i=objs.length-1;i>=0;--i)this.removeObjFromSelection(objs[i])}finally{this.endUpdateSelection()}return this}},toggleSelectingState:function(param){if(param){var objs=DataType.isArrayValue(param)?param:[param];this.beginUpdateSelection();try{for(var i=0,l=objs.length;i<l;++i){var obj=objs[i];this.isInSelection(obj)?this.removeObjFromSelection(obj):this.addObjToSelection(obj)}}finally{this.endUpdateSelection()}return this}},hasSelection:function(){return!!this.getSelection().length},deleteSelectedObjs:function(){},getObjectsInScreenBox:function(screenBox,allowPartialAreaSelecting){for(var box=this.screenBoxToContext(screenBox),objs=[],boundInfos=this.getBoundInfoRecorder().getAllRecordedInfoOfContext(this.getObjContext()),compareFunc=allowPartialAreaSelecting?Kekule.Render.MetaShapeUtils.isIntersectingBox:Kekule.Render.MetaShapeUtils.isInsideBox,i=0,l=boundInfos.length;i<l;++i){var boundInfo=boundInfos[i],shapeInfo=boundInfo.boundInfo;shapeInfo&&compareFunc(shapeInfo,box)&&objs.push(boundInfo.obj)}return objs},selectObjectsInScreenBox:function(screenBox,allowPartialAreaSelecting){var objs=this.getObjectsInScreenBox(screenBox,allowPartialAreaSelecting);return objs&&objs.length&&this.select(objs),objs},addObjectsInScreenBoxToSelection:function(screenBox,allowPartialAreaSelecting){var objs=this.getObjectsInScreenBox(screenBox,allowPartialAreaSelecting);return objs&&objs.length&&this.addToSelection(objs),objs},removeObjectsInScreenBoxFromSelection:function(screenBox,allowPartialAreaSelecting){var objs=this.getObjectsInScreenBox(screenBox,allowPartialAreaSelecting);return objs&&objs.length&&this.removeFromSelection(objs),objs},toggleSelectingStateOfObjectsInScreenBox:function(screenBox,allowPartialAreaSelecting){var objs=this.getObjectsInScreenBox(screenBox,allowPartialAreaSelecting);return objs&&objs.length&&this.toggleSelectingState(objs),objs},getObjectsContainerBox:function(objects,objBoundInflation){for(var objs=Kekule.ArrayUtils.toArray(objects),inf=objBoundInflation||0,containerBox=null,i=0,l=objs.length;i<l;++i){var obj=objs[i],infos=this.getBoundInfoRecorder().getBelongedInfos(this.getObjContext(),obj);if(infos&&infos.length)for(var j=0,k=infos.length;j<k;++j){var info=infos[j],bound=info.boundInfo;if(bound){inf&&(bound=Kekule.Render.MetaShapeUtils.inflateShape(bound,inf));var box=Kekule.Render.MetaShapeUtils.getContainerBox(bound);containerBox=containerBox?Kekule.BoxUtils.getContainerBox(containerBox,box):box}}}return containerBox},getSelectionContainerBox:function(objBoundInflation){return this.getObjectsContainerBox(this.getSelection(),objBoundInflation)},getObjSize:function(obj){return this.doGetObjSize(obj)},doGetObjSize:function(obj){var coordMode=this.getCoordMode();return obj.getSizeOfMode?obj.getSizeOfMode(coordMode):null},setObjSize:function(obj,size){this.doSetObjSize(obj,size),this.objectChanged(obj)},doSetObjSize:function(obj,size){obj.setSizeOfMode&&obj.setSizeOfMode(size,this.getCoordMode())},getObjCoord:function(obj,coordPos){return this.doGetObjCoord(obj,coordPos)},doGetObjCoord:function(obj,coordPos){var coordMode=this.getCoordMode(),allowCoordBorrow=this.getAllowCoordBorrow(),result=obj.getAbsBaseCoord?obj.getAbsBaseCoord(coordMode,allowCoordBorrow):obj.getAbsCoordOfMode?obj.getAbsCoordOfMode(coordMode,allowCoordBorrow):obj.getCoordOfMode?obj.getCoordOfMode(coordMode,allowCoordBorrow):null;if(coordMode===Kekule.CoordMode.COORD2D&&Kekule.ObjUtils.notUnset(coordPos)){if(coordPos!==Kekule.Render.CoordPos.DEFAULT){var allowCoordBorrow=this.getAllowCoordBorrow(),box=obj.getExposedContainerBox?obj.getExposedContainerBox(coordMode,allowCoordBorrow):obj.getContainerBox?obj.getContainerBox(coordMode,allowCoordBorrow):null;if(box&&coordPos===Kekule.Render.CoordPos.CORNER_TL){var delta={x:(box.x2-box.x1)/2,y:(box.y2-box.y1)/2};result.x=result.x-delta.x,result.y=result.y+delta.y}}}return result},setObjCoord:function(obj,coord,coordPos){this.doSetObjCoord(obj,coord,coordPos),this.objectChanged(obj)},doSetObjCoord:function(obj,coord,coordPos){var newCoord=Object.create(coord),coordMode=this.getCoordMode();if(coordMode===Kekule.CoordMode.COORD2D&&Kekule.ObjUtils.notUnset(coordPos)){if(coordPos!==Kekule.Render.CoordPos.DEFAULT){var allowCoordBorrow=this.getAllowCoordBorrow(),box=obj.getExposedContainerBox?obj.getExposedContainerBox(coordMode,allowCoordBorrow):obj.getContainerBox?obj.getContainerBox(coordMode,allowCoordBorrow):null;if(box){var delta={x:(box.x2-box.x1)/2,y:(box.y2-box.y1)/2};coordPos===Kekule.Render.CoordPos.CORNER_TL&&(newCoord.x=coord.x+delta.x,newCoord.y=coord.y-delta.y)}}}obj.setAbsBaseCoord?obj.setAbsBaseCoord(newCoord,coordMode):obj.setAbsCoordOfMode?obj.setAbsCoordOfMode(newCoord,coordMode):obj.setAbsCoordOfMode&&obj.setCoordOfMode(newCoord,coordMode)},getObjectContextCoord:function(obj,coordPos){var coord=this.getObjCoord(obj,coordPos);return this.objCoordToContext(coord)},setObjectContextCoord:function(obj,contextCoord,coordPos){var coord=this.contextCoordToObj(contextCoord);coord&&this.setObjCoord(obj,coord,coordPos)},getObjectScreenCoord:function(obj,coordPos){var coord=this.getObjCoord(obj,coordPos);return this.objCoordToScreen(coord)},setObjectScreenCoord:function(obj,screenCoord,coordPos){var coord=this.screenCoordToObj(screenCoord);coord&&this.setObjCoord(obj,coord,coordPos)},getCoord:function(obj,coordSys,coordPos){var objCoord=this.getObjCoord(obj,coordPos);return this.translateCoord(objCoord,Kekule.Editor.CoordSys.OBJ,coordSys)},setCoord:function(obj,value,coordSys,coordPos){var objCoord=this.translateCoord(value,coordSys,Kekule.Editor.CoordSys.OBJ);this.setObjCoord(obj,objCoord,coordPos)},getSize:function(obj,coordSys){var objSize=this.getObjSize(obj);return this.translateCoord(objSize,Kekule.Editor.CoordSys.OBJ,coordSys)},setSize:function(obj,value,coordSys){var objSize=this.translateCoord(value,coordSys,Kekule.Editor.CoordSys.OBJ);this.setObjSize(obj,objSize)},translateCoord:function(coord,fromSys,toSys){if(!coord)return null;var S=Kekule.Editor.CoordSys;if(fromSys===S.SCREEN){if(toSys===S.SCREEN)return coord;if(toSys===S.CONTEXT)return this.getObjDrawBridge().transformScreenCoordToContext(this.getObjContext(),coord);var contextCoord=this.getObjDrawBridge().transformScreenCoordToContext(this.getObjContext(),coord);return this.getRootRenderer().transformCoordToObj(this.getObjContext(),this.getChemObj(),contextCoord)}if(fromSys===S.CONTEXT)return toSys===S.SCREEN?this.getObjDrawBridge().transformContextCoordToScreen(this.getObjContext(),coord):toSys===S.CONTEXT?coord:this.getRootRenderer().transformCoordToObj(this.getObjContext(),this.getChemObj(),coord);if(toSys===S.SCREEN){var contextCoord=this.getRootRenderer().transformCoordToContext(this.getObjContext(),this.getChemObj(),coord);return this.getObjDrawBridge().transformContextCoordToScreen(this.getObjContext(),contextCoord)}return toSys===S.CONTEXT?this.getRootRenderer().transformCoordToContext(this.getObjContext(),this.getChemObj(),coord):coord},transformCoordAndSizeOfObjects:function(objects,transformParams){var coordMode=this.getCoordMode(),allowCoordBorrow=this.getAllowCoordBorrow(),matrix=coordMode===Kekule.CoordMode.COORD3D?Kekule.CoordUtils.calcTransform3DMatrix(transformParams):Kekule.CoordUtils.calcTransform2DMatrix(transformParams),childTransformParams=Object.extend({},transformParams);childTransformParams=Object.extend(childTransformParams,{translateX:0,translateY:0,translateZ:0,center:{x:0,y:0,z:0}});for(var childMatrix=coordMode===Kekule.CoordMode.COORD3D?Kekule.CoordUtils.calcTransform3DMatrix(childTransformParams):Kekule.CoordUtils.calcTransform2DMatrix(childTransformParams),i=0,l=objects.length;i<l;++i){var obj=objects[i];obj.transformAbsCoordByMatrix(matrix,childMatrix,coordMode,!0,allowCoordBorrow),obj.scaleSize(transformParams.scale,coordMode,!0,allowCoordBorrow)}},objCoordToContext:function(objCoord){var S=Kekule.Editor.CoordSys;return this.translateCoord(objCoord,S.OBJ,S.CONTEXT)},contextCoordToObj:function(contextCoord){var S=Kekule.Editor.CoordSys;return this.translateCoord(contextCoord,S.CONTEXT,S.OBJ)},objCoordToScreen:function(objCoord){var S=Kekule.Editor.CoordSys;return this.translateCoord(objCoord,S.OBJ,S.SCREEN)},screenCoordToObj:function(screenCoord){var S=Kekule.Editor.CoordSys;return this.translateCoord(screenCoord,S.SCREEN,S.OBJ)},screenCoordToContext:function(screenCoord){var S=Kekule.Editor.CoordSys;return this.translateCoord(screenCoord,S.SCREEN,S.CONTEXT)},contextCoordToScreen:function(screenCoord){var S=Kekule.Editor.CoordSys;return this.translateCoord(screenCoord,S.CONTEXT,S.SCREEN)},screenBoxToContext:function(screenBox){var coord1=this.screenCoordToContext({x:screenBox.x1,y:screenBox.y1}),coord2=this.screenCoordToContext({x:screenBox.x2,y:screenBox.y2});return{x1:coord1.x,y1:coord1.y,x2:coord2.x,y2:coord2.y}},createDefaultNode:function(coord,coordType,parent){var isoId=this.getEditorConfigs().getStructureConfigs().getDefIsotopeId(),atom=new Kekule.Atom;return atom.setIsotopeId(isoId),parent&&parent.appendNode(atom),this.setCoord(atom,coord,coordType),atom},operationDone:function(operation){this.doOperationDone(operation)},doOperationDone:function(operation){},clearOperHistory:function(){var h=this.getOperHistory();h&&h.clear()},pushOperation:function(operation,autoExec){var h=this.getOperHistory();h&&operation&&h.push(operation),autoExec&&operation.execute()},popOperation:function(autoReverse){var r,h=this.getOperHistory();if(!h)return null;r=h.pop(),autoReverse&&r.reverse()},undo:function(){var o,h=this.getOperHistory();if(h){this.beginUpdateObject();try{o=h.undo()}finally{this.endUpdateObject(),o&&this.operationDone(o)}}return o},redo:function(){var o,h=this.getOperHistory();if(h){this.beginUpdateObject();try{o=h.redo()}finally{this.endUpdateObject(),o&&this.operationDone(o)}}return o},undoAll:function(){var o,h=this.getOperHistory();if(h){this.beginUpdateObject();try{o=h.undoAll()}finally{this.endUpdateObject()}}return o},canUndo:function(){var h=this.getOperHistory();return!!h&&h.canUndo()},canRedo:function(){var h=this.getOperHistory();return!!h&&h.canRedo()},modifyObjects:function(objOrObjs,modifiedPropInfos,putInOperHistory){var objs=Kekule.ArrayUtils.toArray(objOrObjs);try{for(var macro=new Kekule.MacroOperation,i=0,l=objs.length;i<l;++i){var obj=objs[i],oper=new Kekule.ChemObjOperation.Modify(obj,modifiedPropInfos);macro.add(oper)}macro.execute()}finally{putInOperHistory&&this.getEnableOperHistory()&&macro.getChildCount()&&this.pushOperation(macro)}return this},modifyObjectsRenderOptions:function(objOrObjs,modifiedValues,is3DOption,putInOperHistory){var objs=Kekule.ArrayUtils.toArray(objOrObjs),renderPropName=is3DOption?"render3DOptions":"renderOptions",getterName=is3DOption?"getRender3DOptions":"getRenderOptions";try{for(var macro=new Kekule.MacroOperation,i=0,l=objs.length;i<l;++i){var obj=objs[i];if(obj[getterName]){var old=obj[getterName](),newOps=Object.extend({},old);newOps=Object.extend(newOps,modifiedValues);var hash={};hash[renderPropName]=newOps;var oper=new Kekule.ChemObjOperation.Modify(obj,hash);macro.add(oper)}}macro.execute()}finally{putInOperHistory&&this.getEnableOperHistory()&&macro.getChildCount()&&this.pushOperation(macro)}return this},getClientScrollPosition:function(){var elem=this.getEditClientElem().parentNode;return elem?{x:elem.scrollLeft,y:elem.scrollTop}:null},scrollClientTo:function(yPosition,xPosition){var elem=this.getEditClientElem().parentNode;return Kekule.ObjUtils.notUnset(yPosition)&&(elem.scrollTop=yPosition),Kekule.ObjUtils.notUnset(xPosition)&&(elem.scrollLeft=xPosition),this},scrollClientToTop:function(){return this.scrollClientTo(0,null)}}),Kekule.Editor.BaseEditor.Settings=Class.create(Kekule.ChemWidget.ChemObjDisplayer.Settings,{CLASS_NAME:"Kekule.Editor.BaseEditor.Settings",initProperties:function(){this.defineProp("enableCreateNewDoc",{dataType:DataType.BOOL,serializable:!1,getter:function(){return this.getEditor().getEnableCreateNewDoc()},setter:function(value){this.getEditor().setEnableCreateNewDoc(value)}}),this.defineProp("initOnNewDoc",{dataType:DataType.BOOL,serializable:!1,getter:function(){return this.getEditor().getInitOnNewDoc()},setter:function(value){this.getEditor().setInitOnNewDoc(value)}}),this.defineProp("enableOperHistory",{dataType:DataType.BOOL,serializable:!1,getter:function(){return this.getEditor().getEnableOperHistory()},setter:function(value){this.getEditor().setEnableOperHistory(value)}})},getEditor:function(){return this.getDisplayer()}}),Kekule.Editor.IaControllerManager={_controllerMap:new Kekule.MapEx(!0),register:function(controllerClass,targetEditorClass){ICM._controllerMap.set(controllerClass,targetEditorClass)},unregister:function(controllerClass){ICM._controllerMap.remove(controllerClass)},getAllControllerClasses:function(){return ICM._controllerMap.getKeys()},getAvailableControllerClasses:function(editorClass){for(var result=[],controllerClasses=ICM.getAllControllerClasses(),i=0,l=controllerClasses.length;i<l;++i){var cc=controllerClasses[i],ec=ICM._controllerMap.get(cc);ec&&!ClassEx.isOrIsDescendantOf(editorClass,ec)||result.push(cc)}return result}};var ICM=Kekule.Editor.IaControllerManager;return Kekule.Editor.BaseEditorIaController=Class.create(Kekule.Widget.InteractionController,{CLASS_NAME:"Kekule.Editor.BaseEditorIaController",initialize:function($super,editor){$super(editor)},initProperties:function(){this.defineProp("manuallyHotTrack",{dataType:DataType.BOOL,serializable:!1})},getDefId:function(){return Kekule.ClassUtils.getLastClassName(this.getClassName())},getEditor:function(){return this.getWidget()},setEditor:function(editor){return this.setWidget(editor)},getEditorConfigs:function(){var editor=this.getEditor();return editor?editor.getEditorConfigs():null},handleUiEvent:function($super,e){var handle=!1,targetElem=e.getTarget(),uiElem=this.getEditor().getUiEventReceiverElem();uiElem?(targetElem===uiElem||Kekule.DomUtils.isDescendantOf(targetElem,uiElem))&&(handle=!0):handle=!0,handle&&$super(e)},canInteractWithObj:function(obj){return!!obj},zoomEditor:function(zoomLevel){zoomLevel>0?this.getEditor().zoomIn(zoomLevel):zoomLevel<0&&this.getEditor().zoomOut(-zoomLevel)},react_mousemove:function(e){var coord=this._getEventMouseCoord(e),obj=this.getEditor().getTopmostBasicObjectAtCoord(coord);return this.getManuallyHotTrack()||(obj&&this.canInteractWithObj(obj)?this.getEditor().hotTrackOnObj(obj):this.getEditor().hotTrackOnObj(null)),!0},react_mousewheel:function(e){if(e.getCtrlKey()){var delta=e.wheelDeltaY||e.wheelDelta;return delta&&(delta/=120),this.zoomEditor(delta),e.preventDefault(),!0}},_getEventMouseCoord:function($super,e,clientElem){return $super(e,clientElem||this.getWidget().getCoreElement())}}),Kekule.Editor.BasicEraserIaController=Class.create(Kekule.Editor.BaseEditorIaController,{CLASS_NAME:"Kekule.Editor.BasicEraserIaController",initialize:function($super,widget){$super(widget),this._isExecuting=!1},canInteractWithObj:function(obj){return!!obj},removeObjs:function(objs){if(objs&&objs.length){var editor=this.getEditor();editor.beginUpdateObject();try{var actualObjs=this.doGetActualRemovedObjs(objs);this.doRemoveObjs(actualObjs)}finally{editor.endUpdateObject()}}},doRemoveObjs:function(objs){},doGetActualRemovedObjs:function(objs){return objs},removeSelection:function(){var editor=this.getEditor();this.removeObjs(editor.getSelection()),editor.deselectAll()},removeOnScreenCoord:function(coord){var obj=this.getEditor().getTopmostBasicObjectAtCoord(coord);return!!obj&&(this.removeObjs([obj]),!0)},startRemove:function(){this._isExecuting=!0},endRemove:function(){this._isExecuting=!1},isRemoving:function(){return this._isExecuting},react_mousedown:function(e){if(e.getButton()===Kekule.X.Event.MOUSE_BTN_LEFT){this.startRemove();var coord=this._getEventMouseCoord(e);this.removeOnScreenCoord(coord)}else e.getButton()===Kekule.X.Event.MOUSE_BTN_RIGHT&&this.endRemove()},react_mouseup:function(e){e.getButton()===Kekule.X.Event.MOUSE_BTN_LEFT&&this.endRemove()},react_mousemove:function($super,e){if($super(e),this.isRemoving()){var coord=this._getEventMouseCoord(e);this.removeOnScreenCoord(coord)}return!0}}),Kekule.Editor.IaControllerManager.register(Kekule.Editor.BasicEraserIaController,Kekule.Editor.BaseEditor),Kekule.Editor.BasicManipulationIaController=Class.create(Kekule.Editor.BaseEditorIaController,{CLASS_NAME:"Kekule.Editor.BasicManipulationIaController",initialize:function($super,widget){$super(widget),this.setState(Kekule.Editor.BasicManipulationIaController.State.NORMAL),this.setEnableSelect(!0),this.setEnableMove(!0),this.setEnableResize(!0),this.setEnableConstrainedResize(!0),this.setEnableRotate(!0),this._suppressConstrainedResize=!1},initProperties:function(){this.defineProp("enableSelect",{dataType:DataType.BOOL,serializable:!1}),this.defineProp("enableMove",{dataType:DataType.BOOL,serializable:!1}),this.defineProp("enableResize",{dataType:DataType.BOOL,serializable:!1}),this.defineProp("enableRotate",{dataType:DataType.BOOL,serializable:!1}),this.defineProp("state",{dataType:DataType.INT,serializable:!1}),this.defineProp("startCoord",{dataType:DataType.HASH,serializable:!1}),this.defineProp("endCoord",{dataType:DataType.HASH,serializable:!1}),this.defineProp("startBox",{dataType:DataType.HASH,serializable:!1}),this.defineProp("endBox",{dataType:DataType.HASH,serializable:!1}),this.defineProp("lastRotateAngle",{dataType:DataType.FLOAT,serializable:!1}),this.defineProp("rotateCenter",{dataType:DataType.HASH,serializable:!1,getter:function(){var result=this.getPropStoreFieldValue("rotateCenter");if(!result){var centerCoord=this._getManipulateObjsCenterCoord();result=this.getEditor().objCoordToScreen(centerCoord),this.setPropStoreFieldValue("rotateCenter",result)}return result}}),this.defineProp("resizeStartingRegion",{dataType:DataType.INT,serializable:!1}),this.defineProp("enableConstrainedResize",{dataType:DataType.BOOL,serializable:!1}),this.defineProp("rotateStartingRegion",{dataType:DataType.INT,serializable:!1}),this.defineProp("manipulateOriginObjs",{dataType:DataType.ARRAY,serializable:!1}),this.defineProp("manipulateObjs",{dataType:DataType.ARRAY,serializable:!1,setter:function(value){this.setPropStoreFieldValue("manipulateObjs",value),value?this.getEditor().prepareOperatingObjs(value):this.getEditor().endOperatingObjs()}}),this.defineProp("manipulateObjInfoMap",{dataType:DataType.OBJECT,serializable:!1,setter:null,getter:function(){var result=this.getPropStoreFieldValue("manipulateObjInfoMap");return result||(result=new Kekule.MapEx(!0),this.setPropStoreFieldValue("manipulateObjInfoMap",result)),result}}),this.defineProp("manipulateObjCurrInfoMap",{dataType:DataType.OBJECT,serializable:!1,setter:null,getter:function(){var result=this.getPropStoreFieldValue("manipulateObjCurrInfoMap");return result||(result=new Kekule.MapEx(!0),this.setPropStoreFieldValue("manipulateObjCurrInfoMap",result)),result}}),this.defineProp("manipulationType",{dataType:DataType.INT,serializable:!1}),this.defineProp("isManipulatingSelection",{dataType:DataType.BOOL,serializable:!1}),this.defineProp("moveOperations",{dataType:DataType.ARRAY,serializable:!1}),this.defineProp("objOperationMap",{dataType:"Kekule.MapEx",serializable:!1,getter:function(){var result=this.getPropStoreFieldValue("objOperationMap");return result||(result=new Kekule.MapEx(!0),this.setPropStoreFieldValue("objOperationMap",result)),result}})},doFinalize:function($super){var map=this.getPropStoreFieldValue("manipulateObjInfoMap");map&&map.clear(),map=this.getPropStoreFieldValue("objOperationMap"),map&&map.clear(),$super()},isConstrainedResize:function(){return this.getEnableConstrainedResize()&&!this._suppressConstrainedResize},getCoordOnSelectionRotationRegion:function(screenCoord){var R=Kekule.Editor.BoxRegion,editor=this.getEditor();if(editor.getCoordRegionInSelectionMarker(screenCoord)!==R.OUTSIDE)return!1;var r=editor.getEditorConfigs().getInteractionConfigs().getRotationRegionInflation(),box=editor.getUiSelectionAreaContainerBox();if(box&&editor.hasSelection()){for(var corners=[R.CORNER_TL,R.CORNER_TR,R.CORNER_BR,R.CORNER_BL],points=[{x:box.x1,y:box.y1},{x:box.x2,y:box.y1},{x:box.x2,y:box.y2},{x:box.x1,y:box.y2}],result=!1,minDis=r,i=0,l=corners.length;i<l;++i){var corner=corners[i],point=points[i],dis=Kekule.CoordUtils.getDistance(point,screenCoord);dis<=minDis&&(result=corner,minDis=dis)}return result}return!1},createManipulateOperation:function(){var opers=[];this.setMoveOperations(opers);var objs=this.getManipulateObjs(),map=this.getManipulateObjInfoMap();this.getObjOperationMap().clear();for(var i=0,l=objs.length;i<l;++i){var obj=objs[i],item=map.get(obj),sub=new Kekule.ChemObjOperation.MoveAndResize(obj,null,null,this.getEditor().getCoordMode(),!0);sub.setAllowCoordBorrow(this.getEditor().getAllowCoordBorrow()),sub.setOldCoord(item.objCoord),sub.setOldDimension(item.size),opers.push(sub)}return opers},updateChildMoveOperation:function(objIndex,obj,newObjCoord){this.getMoveOperations()[objIndex].setNewCoord(newObjCoord)},updateChildResizeOperation:function(objIndex,obj,newDimension){this.getMoveOperations()[objIndex].setNewDimension(newDimension)},getAllObjOperations:function(){return this.getMoveOperations()},getActiveOperation:function(){var opers=this.getAllObjOperations();return opers=Kekule.ArrayUtils.toUnique(opers),opers.length<=0?null:1===opers.length?opers[0]:new Kekule.MacroOperation(opers)},reverseActiveOperation:function(){return this.getActiveOperation().reverse()},addOperationToEditor:function(){var editor=this.getEditor();editor&&editor.getEnableOperHistory()&&editor.pushOperation(this.getActiveOperation())},getActualManipulatingObjects:function(objs){for(var result=[],i=0,l=objs.length;i<l;++i){var obj=objs[i],actualObjs=obj.getCoordDependentObjects?obj.getCoordDependentObjects():[obj];Kekule.ArrayUtils.pushUnique(result,actualObjs)}return result},prepareManipulating:function(manipulationType,manipulatingObjs,startScreenCoord,startBox,rotateCenter){this.setManipulationType(manipulationType);var actualObjs=this.getActualManipulatingObjects(manipulatingObjs);this.setManipulateOriginObjs(manipulatingObjs),this.setManipulateObjs(actualObjs);var map=this.getManipulateObjInfoMap();map.clear(),this.getManipulateObjCurrInfoMap().clear();for(var i=(this.getEditor(),0),l=actualObjs.length;i<l;++i){var obj=actualObjs[i],info=this.createManipulateObjInfo(obj,startScreenCoord);map.set(obj,info)}this.setStartBox(startBox),this.setRotateCenter(rotateCenter),this.setLastRotateAngle(null),this.createManipulateOperation()},cancelManipulatingObjs:function(){this.getEditor(),this.getManipulateObjs();this.reverseActiveOperation(),this.notifyCoordChangeOfObjects(this.getManipulateObjs())},_getManipulateObjsCenterCoord:function(){var objs=this.getManipulateObjs();if(!objs||!objs.length)return null;for(var coordMode=this.getEditor().getCoordMode(),allowCoordBorrow=this.getEditor().getAllowCoordBorrow(),sum={x:0,y:0,z:0},i=0,l=objs.length;i<l;++i){var obj=objs[i],objCoord=obj.getAbsBaseCoord?obj.getAbsBaseCoord(coordMode,allowCoordBorrow):obj.getAbsCoord?obj.getAbsCoord(coordMode,allowCoordBorrow):obj.getCoordOfMode?obj.getCoordOfMode(coordMode,allowCoordBorrow):null;objCoord&&(sum=Kekule.CoordUtils.add(sum,objCoord))}return Kekule.CoordUtils.divide(sum,objs.length)},_maniplateObjsFrameEnd:function(objs){},_addManipultingObjNewInfo:function(obj,newInfo){var newInfoMap=this.getManipulateObjCurrInfoMap(),info=newInfoMap.get(obj)||{};info=Object.extend(info,newInfo),newInfoMap.set(obj,info)},applyManipulatingObjsInfo:function(endScreenCoord){for(var objs=this.getManipulateObjs(),newInfoMap=this.getManipulateObjCurrInfoMap(),i=0,l=objs.length;i<l;++i){var obj=objs[i],newInfo=newInfoMap.get(obj);this.applySingleManipulatingObjInfo(i,obj,newInfo,endScreenCoord)}},applySingleManipulatingObjInfo:function(objIndex,obj,newInfo,endScreenCoord){newInfo&&(newInfo.screenCoord&&this.doMoveManipulatedObj(objIndex,obj,newInfo.screenCoord,endScreenCoord),newInfo.size&&this.doResizeManipulatedObj(objIndex,obj,newInfo.size))},_calcActualRotateAngle:function(objs,newDeltaAngle,oldAbsAngle,newAbsAngle){return newDeltaAngle},_calcManipulateObjsRotationInfo:function(manipulatingObjs,endScreenCoord){var angle,C=Kekule.CoordUtils,angleCalculated=!1,rotateCenter=this.getRotateCenter(),startCoord=this.getStartCoord(),threshold=this.getEditorConfigs().getInteractionConfigs().getRotationLocationPointDistanceThreshold();if(threshold){if(C.getDistance(startCoord,rotateCenter)<threshold)return angle=0,angleCalculated=!0,this.setStartCoord(endScreenCoord),!1;if(C.getDistance(endScreenCoord,rotateCenter)<threshold)return angle=0,angleCalculated=!0,!1}if(!angleCalculated){var vector=C.substract(endScreenCoord,rotateCenter),endAngle=Math.atan2(vector.y,vector.x);vector=C.substract(startCoord,rotateCenter);var startAngle=Math.atan2(vector.y,vector.x);angle=endAngle-startAngle,angle=this._calcActualRotateAngle(manipulatingObjs,angle,startAngle,endAngle);var lastAngle=this.getLastRotateAngle();if(Kekule.ObjUtils.notUnset(lastAngle)&&Kekule.NumUtils.isFloatEqual(angle,lastAngle,1e-5))return!1;this.setLastRotateAngle(angle)}for(var transformMatrix=Kekule.CoordUtils.calcTransform2DMatrix({center:rotateCenter,rotateAngle:angle}),i=0,l=manipulatingObjs.length;i<l;++i){var obj=manipulatingObjs[i],info=this.getManipulateObjInfoMap().get(obj);if(!info.hasNoCoord){var oldCoord=info.screenCoord,newCoord=C.transform2DByMatrix(oldCoord,transformMatrix);this._addManipultingObjNewInfo(obj,{screenCoord:newCoord})}info.size}return!0},rotateManipulatedObjs:function(endScreenCoord){var editor=(Kekule.Editor.BoxRegion,Kekule.CoordUtils,this.getEditor()),objs=this.getManipulateObjs();if(this._calcManipulateObjsRotationInfo(objs,endScreenCoord)){this.getManipulateObjCurrInfoMap(),editor.beginUpdateObject();try{this.applyManipulatingObjsInfo(endScreenCoord),this._maniplateObjsFrameEnd(objs),this.notifyCoordChangeOfObjects(objs)}finally{editor.endUpdateObject(),this.manipulateStepDone()}}},_calcManipulateObjsResizeInfo:function(manipulatingObjs,startingRegion,endScreenCoord){var scaleCenter,R=Kekule.Editor.BoxRegion,C=Kekule.CoordUtils,box=this.getStartBox(),coordDelta=C.substract(endScreenCoord,this.getStartCoord());if(startingRegion===R.EDGE_TOP)coordDelta.x=0,scaleCenter={x:(box.x1+box.x2)/2,y:box.y2};else if(startingRegion===R.EDGE_BOTTOM)coordDelta.x=0,scaleCenter={x:(box.x1+box.x2)/2,y:box.y1};else if(startingRegion===R.EDGE_LEFT)coordDelta.y=0,scaleCenter={x:box.x2,y:(box.y1+box.y2)/2};else if(startingRegion===R.EDGE_RIGHT)coordDelta.y=0,scaleCenter={x:box.x1,y:(box.y1+box.y2)/2};else{if(this.isConstrainedResize()){var widthHeightRatio=(box.x2-box.x1)/(box.y2-box.y1),currRatio=coordDelta.x/coordDelta.y;Math.abs(currRatio)>widthHeightRatio?coordDelta.x=coordDelta.y*widthHeightRatio*(Math.sign(currRatio)||1):coordDelta.y=coordDelta.x/widthHeightRatio*(Math.sign(currRatio)||1)}scaleCenter=startingRegion===R.CORNER_TL?{x:box.x2,y:box.y2}:startingRegion===R.CORNER_TR?{x:box.x1,y:box.y2}:startingRegion===R.CORNER_BL?{x:box.x2,y:box.y1}:{x:box.x1,y:box.y1}}for(var reversedX=startingRegion===R.CORNER_TL||startingRegion===R.CORNER_BL||startingRegion===R.EDGE_LEFT,reversedY=startingRegion===R.CORNER_TL||startingRegion===R.CORNER_TR||startingRegion===R.EDGE_TOP,scaleX=1+coordDelta.x/(box.x2-box.x1)*(reversedX?-1:1),scaleY=1+coordDelta.y/(box.y2-box.y1)*(reversedY?-1:1),transformOps={center:scaleCenter,scaleX:scaleX,scaleY:scaleY},transformMatrix=C.calcTransform2DMatrix(transformOps),i=0,l=manipulatingObjs.length;i<l;++i){var obj=manipulatingObjs[i],info=this.getManipulateObjInfoMap().get(obj),newInfo={};if(!info.hasNoCoord){var oldCoord=info.screenCoord,newCoord=C.transform2DByMatrix(oldCoord,transformMatrix);newInfo.screenCoord=newCoord}if(info.size){var newSize={x:info.size.x*Math.abs(scaleX),y:info.size.y*Math.abs(scaleY)};newInfo.size=newSize}this._addManipultingObjNewInfo(obj,newInfo)}},resizeManipulatedObjs:function(endScreenCoord){var editor=this.getEditor(),objs=this.getManipulateObjs();this._calcManipulateObjsResizeInfo(objs,this.getResizeStartingRegion(),endScreenCoord),editor.beginUpdateObject();this.getManipulateObjCurrInfoMap();try{this.applyManipulatingObjsInfo(endScreenCoord),this._maniplateObjsFrameEnd(objs),this.notifyCoordChangeOfObjects(objs)}finally{editor.endUpdateObject(),this.manipulateStepDone()}},_calcActualMovedScreenCoord:function(obj,info,newScreenCoord){return newScreenCoord},_calcManipulateObjsMoveInfo:function(manipulatingObjs,endScreenCoord){for(var C=Kekule.CoordUtils,i=(this.getManipulateObjCurrInfoMap(),0),l=manipulatingObjs.length;i<l;++i){var obj=manipulatingObjs[i],info=this.getManipulateObjInfoMap().get(obj);if(!info.hasNoCoord){var newScreenCoord=C.add(endScreenCoord,info.screenCoordOffset);newScreenCoord=this._calcActualMovedScreenCoord(obj,info,newScreenCoord),this._addManipultingObjNewInfo(obj,{screenCoord:newScreenCoord})}}},moveManipulatedObjs:function(endScreenCoord){var editor=(Kekule.CoordUtils,this.getEditor()),objs=this.getManipulateObjs();this._calcManipulateObjsMoveInfo(objs,endScreenCoord),editor.beginUpdateObject();this.getManipulateObjCurrInfoMap();try{this.applyManipulatingObjsInfo(endScreenCoord),this._maniplateObjsFrameEnd(objs),this.notifyCoordChangeOfObjects(objs)}finally{editor.endUpdateObject(),this.manipulateStepDone()}},doMoveManipulatedObj:function(objIndex,obj,newScreenCoord,moverScreenCoord){var editor=this.getEditor();this.updateChildMoveOperation(objIndex,obj,editor.screenCoordToObj(newScreenCoord)),editor.setObjectScreenCoord(obj,newScreenCoord)},doResizeManipulatedObj:function(objIndex,obj,newSize){this.updateChildResizeOperation(objIndex,obj,newSize),obj.setSizeOfMode&&obj.setSizeOfMode(newSize,this.getEditor().getCoordMode())},startDirectManipulate:function(manipulateType,objOrObjs,startCoord,startBox,rotateCenter){var objs=Kekule.ArrayUtils.toArray(objOrObjs);this.setState(Kekule.Editor.BasicManipulationIaController.State.MANIPULATING),this.setStartCoord(startCoord),this.setIsManipulatingSelection(!1),this.prepareManipulating(manipulateType||Kekule.Editor.BasicManipulationIaController.ManipulationType.MOVE,objs,startCoord,startBox,rotateCenter)},manipulateStepDone:function(){},stopManipulate:function(){this.setManipulateObjs(null),this.getManipulateObjInfoMap().clear(),this.getObjOperationMap().clear()},refreshManipulateObjs:function(){this.setManipulateObjs(this.getManipulateObjs())},createManipulateObjInfo:function(obj,startScreenCoord){var editor=this.getEditor(),info={objCoord:editor.getObjCoord(obj),screenCoord:editor.getObjectScreenCoord(obj),size:editor.getObjSize(obj)};return info.hasNoCoord=!info.objCoord,info.hasNoCoord||(info.screenCoordOffset=Kekule.CoordUtils.substract(info.screenCoord,startScreenCoord)),info},notifyCoordChangeOfObjects:function(objs){for(var changedObjs=[],editor=this.getEditor(),i=0,l=objs.length;i<l;++i){var obj=objs[i];Kekule.ArrayUtils.pushUnique(changedObjs,obj);var relatedObjs=obj.getCoordDeterminateObjects?obj.getCoordDeterminateObjects():[obj];Kekule.ArrayUtils.pushUnique(changedObjs,relatedObjs)}editor.objectsChanged(changedObjs)},canInteractWithObj:function(obj){return this.getState()===Kekule.Editor.BasicManipulationIaController.State.NORMAL&&obj},doTestMouseCursor:function(coord,e){var result="",c=this._getEventMouseCoord(e,this.getEditor().getEditClientElem());if(this.getState()===Kekule.Editor.BasicManipulationIaController.State.NORMAL){if(this.getEnableResize())var R=Kekule.Editor.BoxRegion,region=this.getEditor().getCoordRegionInSelectionMarker(c),result=region===R.INSIDE?"move":region===R.CORNER_TL?"nwse-resize":region===R.CORNER_TR?"nesw-resize":region===R.CORNER_BL?"nesw-resize":region===R.CORNER_BR?"nwse-resize":region===R.EDGE_TOP||region===R.EDGE_BOTTOM?"ns-resize":region===R.EDGE_LEFT||region===R.EDGE_RIGHT?"ew-resize":"";if(!result&&this.getEnableRotate()){var region=this.getCoordOnSelectionRotationRegion(c);if(region){var SN=Kekule.Widget.StyleResourceNames;result=region===R.CORNER_TL?SN.CURSOR_ROTATE_NW:region===R.CORNER_TR?SN.CURSOR_ROTATE_NE:region===R.CORNER_BL?SN.CURSOR_ROTATE_SW:region===R.CORNER_BR?SN.CURSOR_ROTATE_SE:SN.CURSOR_ROTATE}}}return result},react_mousemove:function($super,e){if($super(e),this._isBusy)return!0;var coord=this._getEventMouseCoord(e);if(this._lastMouseMoveCoord){if(Kekule.CoordUtils.getDistance(coord,this._lastMouseMoveCoord)<2)return!0}this._lastMouseMoveCoord=coord;var S=Kekule.Editor.BasicManipulationIaController.State,T=Kekule.Editor.BasicManipulationIaController.ManipulationType,state=this.getState();if(state===S.SELECTING)this.getEnableSelect()&&this.getEditor().dragSelectingBoxToCoord(coord);else if(state===S.MANIPULATING){var manipulateType=this.getManipulationType();try{this._isBusy=!0,manipulateType===T.MOVE?this.moveManipulatedObjs(coord):manipulateType===T.RESIZE?(this._suppressConstrainedResize=e.getAltKey(),this.resizeManipulatedObjs(coord)):manipulateType===T.ROTATE&&this.rotateManipulatedObjs(coord)}finally{this._isBusy=!1}}return!0},react_mousedown:function(e){var S=Kekule.Editor.BasicManipulationIaController.State,T=Kekule.Editor.BasicManipulationIaController.ManipulationType;if(e.getButton()===Kekule.X.Event.MOUSE_BTN_LEFT){this._lastMouseMoveCoord=null;var coord=this._getEventMouseCoord(e);if(this.getState()===S.NORMAL){this.setStartCoord(coord);var coordRegion=this.getEditor().getCoordRegionInSelectionMarker(coord),R=Kekule.Editor.BoxRegion,isResize=this.getEnableResize()&&coordRegion!==R.INSIDE&&coordRegion!==R.OUTSIDE,isMove=!isResize&&this.getEnableMove()&&coordRegion!==R.OUTSIDE,rotateRegion=this.getCoordOnSelectionRotationRegion(coord),isRotate=!isResize&&!isMove&&this.getEnableRotate()&&!!rotateRegion;if(isResize)this.setState(S.MANIPULATING),this.setIsManipulatingSelection(!0),this.setResizeStartingRegion(coordRegion),this.prepareManipulating(T.RESIZE,this.getEditor().getSelection(),coord,this.getEditor().getSelectionContainerBox());else if(isMove)this.setState(S.MANIPULATING),this.setIsManipulatingSelection(!0),this.prepareManipulating(T.MOVE,this.getEditor().getSelection(),coord);else if(isRotate)this.setState(S.MANIPULATING),this.setIsManipulatingSelection(!0),this.setRotateStartingRegion(rotateRegion),this.prepareManipulating(T.ROTATE,this.getEditor().getSelection(),coord,this.getEditor().getSelectionContainerBox());else{var obj=this.getEditor().getTopmostBasicObjectAtCoord(coord);if(obj)obj=obj.getNearestSelectableObject(),this.getEnableMove()&&this.startDirectManipulate(null,obj,coord);else if(this.getEnableSelect()){var shifted=e.getShiftKey();this.getEditor().startSelectingBoxDrag(coord,shifted),this.setState(S.SELECTING)}}}}else e.getButton()===Kekule.X.Event.MouseButton.RIGHT&&this.getState()===S.MANIPULATING&&(this.cancelManipulatingObjs(),this.setState(S.NORMAL),e.stopPropagation());return!0},react_mouseup:function(e){if(e.getButton()===Kekule.X.Event.MouseButton.LEFT){var coord=this._getEventMouseCoord(e);this.setEndCoord(coord);var startCoord=this.getStartCoord(),endCoord=coord,shifted=e.getShiftKey(),state=this.getState(),S=Kekule.Editor.BasicManipulationIaController.State;state===S.SELECTING?(this.getEditor().endSelectingBoxDrag(coord,shifted),this.setState(S.NORMAL)):state===S.MANIPULATING&&(Kekule.CoordUtils.isEqual(startCoord,endCoord)?this.getEnableSelect()&&this.getEditor().selectOnCoord(startCoord,shifted):this.getEnableMove()&&this.addOperationToEditor(),this.stopManipulate(),this.setState(S.NORMAL))}return!0}}),Kekule.Editor.BasicManipulationIaController.State={NORMAL:0,SELECTING:1,MANIPULATING:2},Kekule.Editor.BasicManipulationIaController.ManipulationType={MOVE:0,ROTATE:1,RESIZE:2},Kekule.Editor.IaControllerManager.register(Kekule.Editor.BasicManipulationIaController,Kekule.Editor.BaseEditor),Kekule}},function(module,exports,__webpack_require__){"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},Class=__webpack_require__(0).Class,DataType=__webpack_require__(0).DataType;module.exports=function(Kekule){return Kekule.ChemObjOperation={},Kekule.ChemObjOperation.Base=Class.create(Kekule.Operation,{CLASS_NAME:"Kekule.ChemObjOperation.Base",initialize:function($super,chemObj){$super(),this.setTarget(chemObj)},initProperties:function(){this.defineProp("target",{dataType:"Kekule.ChemObject",serializable:!1}),this.defineProp("allowCoordBorrow",{dataType:DataType.BOOL})},notifyBeforeAddingByEditor:function(obj,parent,refSibling){obj.beforeAddingByEditor&&obj.beforeAddingByEditor(parent,refSibling)},notifyBeforeRemovingByEditor:function(obj,parent){obj.beforeRemovingByEditor&&obj.beforeRemovingByEditor(parent)},notifyBeforeModifyingByEditor:function(obj,propValues){obj.beforeModifyingByEditor&&obj.beforeModifyingByEditor(propValues)},notifyAfterAddingByEditor:function(obj,parent,refSibling){obj.afterAddingByEditor&&obj.afterAddingByEditor(parent,refSibling)},notifyAfterRemovingByEditor:function(obj,parent){obj.afterRemovingByEditor&&obj.afterRemovingByEditor(parent)},notifyAfterModifyingByEditor:function(obj,propValues){obj.afterModifyingByEditor&&obj.afterModifyingByEditor(propValues)}}),Kekule.ChemObjOperation.Modify=Class.create(Kekule.ChemObjOperation.Base,{CLASS_NAME:"Kekule.ChemObjOperation.Modify",initialize:function($super,chemObj,newPropValues){$super(chemObj),newPropValues&&this.setNewPropValues(newPropValues)},initProperties:function(){this.defineProp("newPropValues",{dataType:DataType.HASH}),this.defineProp("oldPropValues",{dataType:DataType.HASH})},doExecute:function(){var oldValues={},map=this.getNewPropValues(),obj=this.getTarget();obj.beginUpdate();try{this.notifyBeforeModifyingByEditor(obj,map);for(var prop in map){var value=map[prop];oldValues[prop]=obj.getPropValue(prop),obj.setPropValue(prop,value)}this.notifyAfterModifyingByEditor(obj,map)}finally{obj.endUpdate()}this.setOldPropValues(oldValues)},doReverse:function(){var map=this.getOldPropValues(),obj=this.getTarget();obj.beginUpdate();try{this.notifyBeforeModifyingByEditor(obj,map);for(var prop in map){var value=map[prop];obj.setPropValue(prop,value)}this.notifyAfterModifyingByEditor(obj,map)}finally{obj.endUpdate()}}}),Kekule.ChemObjOperation.MoveTo=Class.create(Kekule.ChemObjOperation.Base,{CLASS_NAME:"Kekule.ChemObjOperation.MoveTo",initialize:function($super,chemObj,newCoord,coordMode,useAbsBaseCoord){$super(chemObj),newCoord&&this.setNewCoord(newCoord),this.setCoordMode(coordMode||Kekule.CoordMode.COORD2D),this.setUseAbsBaseCoord(!!useAbsBaseCoord)},initProperties:function(){this.defineProp("newCoord",{dataType:DataType.HASH}),this.defineProp("oldCoord",{dataType:DataType.HASH}),this.defineProp("coordMode",{dataType:DataType.INT}),this.defineProp("useAbsBaseCoord",{dataType:DataType.BOOL})},setObjCoord:function(obj,coord,coordMode){if(obj&&coord&&coordMode){var success=!1;if(this.getUseAbsBaseCoord()?obj.setAbsBaseCoord&&(obj.setAbsBaseCoord(coord,coordMode,this.getAllowCoordBorrow()),success=!0):obj.setCoordOfMode&&(obj.setCoordOfMode(coord,coordMode),success=!0),!success){var className=obj.getClassName?obj.getClassName():void 0===obj?"undefined":_typeof(obj);Kekule.warn(Kekule.$L("ErrorMsg.CAN_NOT_SET_COORD_OF_CLASS").format(className))}}},getObjCoord:function(obj,coordMode){if(this.getUseAbsBaseCoord()){if(obj.getAbsBaseCoord)return obj.getAbsBaseCoord(coordMode,this.getAllowCoordBorrow())}else if(obj.getCoordOfMode)return obj.getCoordOfMode(coordMode,this.getAllowCoordBorrow());return null},doExecute:function(){var obj=this.getTarget();this.getOldCoord()||this.setOldCoord(this.getObjCoord(obj,this.getCoordMode())),this.getNewCoord()&&this.setObjCoord(this.getTarget(),this.getNewCoord(),this.getCoordMode())},doReverse:function(){this.getOldCoord()&&this.setObjCoord(this.getTarget(),this.getOldCoord(),this.getCoordMode())}}),Kekule.ChemObjOperation.MoveAndResize=Class.create(Kekule.ChemObjOperation.MoveTo,{CLASS_NAME:"Kekule.ChemObjOperation.MoveAndResize",initialize:function($super,chemObj,newDimension,newCoord,coordMode,useAbsCoord){$super(chemObj,newCoord,coordMode,useAbsCoord)},initProperties:function(){this.defineProp("newDimension",{dataType:DataType.HASH}),this.defineProp("oldDimension",{dataType:DataType.HASH})},setObjSize:function(obj,dimension,coordMode){if(obj&&dimension)if(obj.setSizeOfMode)obj.setSizeOfMode(dimension,coordMode);else{var className=obj.getClassName?obj.getClassName():void 0===obj?"undefined":_typeof(obj);Kekule.warn(Kekule.$L("ErrorMsg.CAN_NOT_SET_DIMENSION_OF_CLASS").format(className))}},getObjSize:function(obj,coordMode){return obj.getSizeOfMode?obj.getSizeOfMode(coordMode,this.getAllowCoordBorrow()):null},doExecute:function($super){$super();var obj=this.getTarget();this.getOldDimension()||this.setOldDimension(this.getObjSize(obj,this.getCoordMode())),this.getNewDimension()&&this.setObjSize(this.getTarget(),this.getNewDimension(),this.getCoordMode())},doReverse:function($super){this.getOldDimension()&&this.setObjSize(this.getTarget(),this.getOldDimension(),this.getCoordMode()),$super()}}),Kekule.ChemObjOperation.Add=Class.create(Kekule.ChemObjOperation.Base,{CLASS_NAME:"Kekule.ChemObjOperation.Add",initialize:function($super,chemObj,parentObj,refSibling){$super(chemObj),this.setParentObj(parentObj),this.setRefSibling(refSibling)},initProperties:function(){this.defineProp("parentObj",{dataType:"Kekule.ChemObject",serializable:!1}),this.defineProp("refSibling",{dataType:"Kekule.ChemObject",serializable:!1})},doExecute:function(){var parent=this.getParentObj(),obj=this.getTarget();if(parent&&obj){var sibling=this.getRefSibling()||null;this.notifyBeforeAddingByEditor(obj,parent,sibling),parent.insertBefore(obj,sibling),this.notifyAfterAddingByEditor(obj,parent,sibling)}},doReverse:function(){var obj=this.getTarget(),parent=this.getParentObj();if(parent&&obj){var sibling=this.getRefSibling();sibling||(sibling=obj.getNextSibling(),this.setRefSibling(sibling)),this.notifyBeforeRemovingByEditor(obj,parent),parent.removeChild(obj),this.notifyAfterRemovingByEditor(obj,parent)}}}),Kekule.ChemObjOperation.Remove=Class.create(Kekule.ChemObjOperation.Base,{CLASS_NAME:"Kekule.ChemObjOperation.Remove",initialize:function($super,chemObj,parentObj,refSibling){$super(chemObj),this.setParentObj(parentObj),this.setRefSibling(refSibling)},initProperties:function(){this.defineProp("parentObj",{dataType:"Kekule.ChemObject",serializable:!1}),this.defineProp("ownerObj",{dataType:"Kekule.ChemObject",serializable:!1}),this.defineProp("refSibling",{dataType:"Kekule.ChemObject",serializable:!1})},doExecute:function(){var obj=this.getTarget(),parent=this.getParentObj(),owner=this.getOwnerObj();if(!parent&&obj.getParent&&(parent=obj.getParent(),this.setParentObj(parent)),!owner&&obj.getOwner&&(owner=obj.getOwner(),this.setOwnerObj(owner)),parent&&obj){if(!this.getRefSibling()){var sibling=obj.getNextSibling?obj.getNextSibling():null;this.setRefSibling(sibling)}this.notifyBeforeRemovingByEditor(obj,parent),parent.removeChild(obj),this.notifyAfterRemovingByEditor(obj,parent)}},doReverse:function(){var parent=this.getParentObj(),owner=this.getOwnerObj(),obj=this.getTarget();if(parent&&obj){var sibling=this.getRefSibling();owner&&obj.setOwner(owner),this.notifyBeforeAddingByEditor(obj,parent,sibling),parent.insertBefore(obj,sibling),this.notifyAfterAddingByEditor(obj,parent,sibling)}}}),Kekule.ChemStructOperation={},Kekule.ChemStructOperation.AddNode=Class.create(Kekule.ChemObjOperation.Add,{CLASS_NAME:"Kekule.ChemStructOperation.AddNode"}),Kekule.ChemStructOperation.RemoveNode=Class.create(Kekule.ChemObjOperation.Remove,{CLASS_NAME:"Kekule.ChemStructOperation.RemoveNode",initProperties:function(){this.defineProp("linkedConnectors",{dataType:DataType.ARRAY,serializable:!1})},doExecute:function($super){this.getLinkedConnectors()||this.setLinkedConnectors(Kekule.ArrayUtils.clone(this.getTarget().getLinkedConnectors())),$super()},doReverse:function($super){$super();var linkedConnectors=this.getLinkedConnectors();if(linkedConnectors&&linkedConnectors.length)for(var target=this.getTarget(),i=0,l=linkedConnectors.length;i<l;++i)target.appendLinkedConnector(linkedConnectors[i])}}),Kekule.ChemStructOperation.ReplaceNode=Class.create(Kekule.Operation,{CLASS_NAME:"Kekule.ChemStructOperation.ReplaceNode",initialize:function($super,oldNode,newNode,parentObj){$super(),this.setOldNode(oldNode),this.setNewNode(newNode),this.setParentObj(parentObj)},initProperties:function(){this.defineProp("oldNode",{dataType:"Kekule.ChemStructureNode",serializable:!1}),this.defineProp("newNode",{dataType:"Kekule.ChemStructureNode",serializable:!1}),this.defineProp("parentObj",{dataType:"Kekule.ChemStructureFragment",serializable:!1})},doExecute:function(){var oldNode=this.getOldNode(),newNode=this.getNewNode();if(oldNode&&newNode){var parent=this.getParentObj();parent||(parent=oldNode.getParent(),this.setParentObj(parent)),parent.replaceNode&&parent.replaceNode(oldNode,newNode)}},doReverse:function(){var oldNode=this.getOldNode(),newNode=this.getNewNode();if(oldNode&&newNode){var parent=this.getParentObj()||newNode.getParent();parent.replaceNode&&parent.replaceNode(newNode,oldNode)}}}),Kekule.ChemStructOperation.AddConnector=Class.create(Kekule.ChemObjOperation.Add,{CLASS_NAME:"Kekule.ChemStructOperation.AddConnector",initialize:function($super,chemObj,parentObj,refSibling,connectedObjs){$super(chemObj),this.setParentObj(parentObj),this.setRefSibling(refSibling),this.setConnectedObjs(connectedObjs)},initProperties:function(){this.defineProp("connectedObjs",{dataType:DataType.ARRAY,serializable:!1})},doExecute:function($super){$super();var connObjs=Kekule.ArrayUtils.clone(this.getConnectedObjs());connObjs&&connObjs.length&&this.getTarget().setConnectedObjs(connObjs)},doReverse:function($super){$super()}}),Kekule.ChemStructOperation.RemoveConnector=Class.create(Kekule.ChemObjOperation.Remove,{CLASS_NAME:"Kekule.ChemStructOperation.RemoveConnector",initProperties:function(){this.defineProp("connectedObjs",{dataType:DataType.ARRAY,serializable:!1})},doExecute:function($super){this.getConnectedObjs()||this.setConnectedObjs(Kekule.ArrayUtils.clone(this.getTarget().getConnectedObjs())),$super()},doReverse:function($super){$super();var connObjs=this.getConnectedObjs();connObjs&&connObjs.length&&this.getTarget().setConnectedObjs(connObjs)}}),Kekule.ChemStructOperation.MergeNodes=Class.create(Kekule.ChemObjOperation.Base,{CLASS_NAME:"Kekule.ChemStructOperation.MergeNodes",initialize:function($super,target,dest,enableStructFragmentMerge){$super(target),this.setDest(dest),this.setEnableStructFragmentMerge(enableStructFragmentMerge||!1),this._refSibling=null,this._nodeParent=null,this._structFragmentMergeOperation=null,this._removeConnectorOperations=[]},initProperties:function(){this.defineProp("dest",{dataType:"Kekule.ChemStructureNode",serializable:!1}),this.defineProp("changedConnectors",{dataType:DataType.ARRAY,serializable:!1}),this.defineProp("removedConnectors",{dataType:DataType.ARRAY,serializable:!1}),this.defineProp("enableStructFragmentMerge",{dataType:DataType.BOOL})},getCommonSiblings:function(node1,node2){var siblings1=node1.getLinkedObjs(),siblings2=node2.getLinkedObjs();return Kekule.ArrayUtils.intersect(siblings1,siblings2)},doExecute:function(){var fromNode=this.getTarget(),toNode=this.getDest(),structFragment=fromNode.getParentFragment(),destFragment=toNode.getParentFragment();if(structFragment!==destFragment){if(!this.getEnableStructFragmentMerge())return null;this._structFragmentMergeOperation=new Kekule.ChemStructOperation.MergeStructFragment(structFragment,destFragment),this._structFragmentMergeOperation.execute(),structFragment=destFragment}this._nodeParent=structFragment;var removedConnectors=this.getRemovedConnectors();if(!removedConnectors){var commonSiblings=this.getCommonSiblings(fromNode,toNode),removedConnectors=[];if(commonSiblings.length)for(var i=0,l=commonSiblings.length;i<l;++i){var sibling=commonSiblings[i],connector=fromNode.getConnectorTo(sibling);connector&&2==connector.getConnectedObjCount()&&removedConnectors.push(connector)}var directConnector=fromNode.getConnectorTo(toNode);directConnector&&removedConnectors.push(directConnector),this.setRemovedConnectors(removedConnectors)}var connectors=this.getChangedConnectors();if(!connectors){var connectors=Kekule.ArrayUtils.clone(fromNode.getLinkedConnectors())||[];connectors=Kekule.ArrayUtils.exclude(connectors,removedConnectors),this.setChangedConnectors(connectors)}this._refSibling=fromNode.getNextSibling();for(var i=0,l=connectors.length;i<l;++i){var connector=connectors[i],index=connector.indexOfConnectedObj(fromNode);connector.removeConnectedObj(fromNode),connector.insertConnectedObjAt(toNode,index)}this._removeConnectorOperations=[];for(var i=0,l=removedConnectors.length;i<l;++i){var connector=removedConnectors[i],oper=new Kekule.ChemStructOperation.RemoveConnector(connector);oper.execute(),this._removeConnectorOperations.push(oper)}structFragment.removeNode(fromNode)},doReverse:function(){var fromNode=this.getTarget(),toNode=this.getDest();if(this._nodeParent.insertBefore(fromNode,this._refSibling),this._removeConnectorOperations.length)for(var i=this._removeConnectorOperations.length-1;i>=0;--i){var oper=this._removeConnectorOperations[i];oper.reverse()}this._removeConnectorOperations=[];for(var connectors=this.getChangedConnectors(),i=0,l=connectors.length;i<l;++i){var connector=connectors[i],index=connector.indexOfConnectedObj(toNode);connector.removeConnectedObj(toNode),connector.insertConnectedObjAt(fromNode,index)}this._structFragmentMergeOperation&&this._structFragmentMergeOperation.reverse()}}),Kekule.ChemStructOperation.MergeNodes.canMerge=function(target,dest,canMergeStructFragment,canMergeNeighborNodes){if(target instanceof Kekule.StructureFragment||dest instanceof Kekule.StructureFragment)return!1;if(!(target instanceof Kekule.ChemStructureNode&&dest instanceof Kekule.ChemStructureNode))return!1;var targetFragment=target.getParent(),destFragment=dest.getParent(),result=targetFragment===destFragment||canMergeStructFragment;return canMergeNeighborNodes||(result=result&&!target.getConnectorTo(dest)),result},Kekule.ChemStructOperation.MergeConnectors=Class.create(Kekule.ChemObjOperation.Base,{CLASS_NAME:"Kekule.ChemStructOperation.MergeConnectors",initialize:function($super,target,dest,coordMode,enableStructFragmentMerge){$super(target),this.setDest(dest),this.setCoordMode(coordMode||Kekule.CoordMode.COORD2D),this.setEnableStructFragmentMerge(enableStructFragmentMerge||!1),this._refSibling=null,this._nodeParent=null,this._nodeMergeOperations=[]},initProperties:function(){this.defineProp("dest",{dataType:"Kekule.ChemStructureConnector",serializable:!1}),this.defineProp("enableStructFragmentMerge",{dataType:DataType.BOOL}),this.defineProp("coordMode",{dataType:DataType.INT})},doExecute:function(){Kekule.ChemStructOperation.MergeConnectors.canMerge(this.getTarget(),this.getDest(),this.getEnableStructFragmentMerge())||Kekule.error(Kekule.$L("ErrorMsg.CAN_NOT_MERGE_CONNECTORS"));for(var coordMode=this.getCoordMode(),connectors=[this.getTarget(),this.getDest()],AU=Kekule.ArrayUtils,targetNodes=AU.clone(this.getTarget().getConnectedObjs()),destNodes=AU.clone(this.getDest().getConnectedObjs()),allowCoordBorrow=this.getAllowCoordBorrow(),i=0,l=connectors.length;i<l;++i){var connector=connectors[i],coord1=connector.getConnectedObjAt(0).getAbsCoordOfMode(coordMode,allowCoordBorrow),coord2=connector.getConnectedObjAt(1).getAbsCoordOfMode(coordMode,allowCoordBorrow),coordDelta=Kekule.CoordUtils.substract(coord1,coord2),dominateDirection=Math.abs(coordDelta.x)>Math.abs(coordDelta.y)?"x":"y";Kekule.ObjUtils.notUnset(coord1.z)&&Math.abs(coordDelta.z)>Math.abs(coordDelta.x)&&(dominateDirection="z");(0===i?targetNodes:destNodes).sort(function(a,b){var coord1=a.getAbsCoordOfMode(coordMode,allowCoordBorrow),coord2=b.getAbsCoordOfMode(coordMode,allowCoordBorrow);return coord1[dominateDirection]-coord2[dominateDirection]||0})}var commonNodes=AU.intersect(targetNodes,destNodes);targetNodes=AU.exclude(targetNodes,commonNodes),destNodes=AU.exclude(destNodes,commonNodes),this._nodeMergeOperations=[];for(var i=0,l=targetNodes.length;i<l;++i){if(targetNodes[i]!==destNodes[i]){var oper=new Kekule.ChemStructOperation.MergeNodes(targetNodes[i],destNodes[i],this.getEnableStructFragmentMerge());oper.execute()}this._nodeMergeOperations.push(oper)}},doReverse:function(){for(var i=this._nodeMergeOperations.length-1;i>=0;--i){this._nodeMergeOperations[i].reverse()}this._nodeMergeOperations=[]}}),Kekule.ChemStructOperation.MergeConnectors.canMerge=function(target,dest,canMergeStructFragment){if(!canMergeStructFragment&&target.getParent()!==dest.getParent())return!1;if(target.isConnectingConnector()||dest.isConnectingConnector())return!1;var targetNodes=target.getConnectedExposedObjs(),destNodes=dest.getConnectedObjs();return targetNodes.length===destNodes.length&&(2===targetNodes.length&&!(Kekule.ArrayUtils.intersect(targetNodes,destNodes).length>=1))},Kekule.ChemStructOperation.MergeStructFragment=Class.create(Kekule.ChemObjOperation.Base,{CLASS_NAME:"Kekule.ChemStructOperation.MergeStructFragment",initialize:function($super,target,dest){$super(target),this.setDest(dest),this._removeOperation=null},initProperties:function(){this.defineProp("dest",{dataType:"Kekule.StructureFragment",serializable:!1}),this.defineProp("mergedNodes",{dataType:DataType.ARRAY,serializable:!1}),this.defineProp("mergedConnectors",{dataType:DataType.ARRAY,serializable:!1})},moveChildBetweenStructFragment:function(target,dest,nodes,connectors){Kekule.ChemStructureUtils.moveChildBetweenStructFragment(target,dest,nodes,connectors)},doExecute:function(){var target=this.getTarget(),dest=this.getDest();if(target&&dest){var nodes=Kekule.ArrayUtils.clone(target.getNodes());this.setMergedNodes(nodes);var connectors=Kekule.ArrayUtils.clone(target.getConnectors());this.setMergedConnectors(connectors),this.moveChildBetweenStructFragment(target,dest,nodes,connectors);var parent=target.getParent();parent&&(this._removeOperation=new Kekule.ChemObjOperation.Remove(target,parent),this._removeOperation.execute())}},doReverse:function(){var target=this.getTarget(),dest=this.getDest();if(target&&dest){this._removeOperation&&(this._removeOperation.reverse(),this._removeOperation=null);var nodes=this.getMergedNodes(),connectors=this.getMergedConnectors();this.moveChildBetweenStructFragment(dest,target,nodes,connectors)}}}),Kekule.ChemStructOperation.SplitStructFragment=Class.create(Kekule.ChemObjOperation.Base,{CLASS_NAME:"Kekule.ChemStructOperation.SplitStructFragment",initialize:function($super,target){$super(target)},initProperties:function(){this.defineProp("splittedFragments",{dataType:DataType.ARRAY,serializable:!1,setter:null})},doExecute:function(){var splitted=Kekule.ChemStructureUtils.splitStructFragment(this.getTarget());if(splitted.length>1){this.setPropStoreFieldValue("splittedFragments",splitted);var parent=this.getTarget().getParent(),ref=this.getTarget().getNextSibling();parent.beginUpdate();try{if(parent)for(var i=1,l=splitted.length;i<l;++i){var frag=splitted[i];parent.insertBefore(frag,ref)}}finally{parent.endUpdate()}}else this.setPropStoreFieldValue("splittedFragments",null)},doReverse:function(){var fragments=this.getSplittedFragments();if(fragments&&fragments.length)for(var target=this.getTarget(),i=0,l=fragments.length;i<l;++i){var frag=fragments[i];if(frag!==target){Kekule.ChemStructureUtils.moveChildBetweenStructFragment(frag,target,Kekule.ArrayUtils.clone(frag.getNodes()),Kekule.ArrayUtils.clone(frag.getConnectors()));var p=frag.getParent();p&&p.removeChild(frag),frag.finalize()}}}}),Kekule.ChemStructOperation.StandardizeStructFragment=Class.create(Kekule.ChemObjOperation.Base,{CLASS_NAME:"Kekule.ChemStructOperation.StandardizeStructFragment",initialize:function($super,target){$super(target),this.setEnableSplit(!0),this.setEnableRemove(!0),this._concreteOper=null},initProperties:function(){this.defineProp("enableRemove",{dataType:DataType.BOOL}),this.defineProp("enableSplit",{dataType:DataType.BOOL})},doExecute:function(){var target=this.getTarget(),nodeCount=target.getNodeCount();return this._concreteOper=null,nodeCount<=0?this.getEnableRemove()&&(this._concreteOper=new Kekule.ChemObjOperation.Remove(target)):this.getEnableSplit()&&(this._concreteOper=new Kekule.ChemStructOperation.SplitStructFragment(target)),this._concreteOper?this._concreteOper.execute():null},doReverse:function(){return this._concreteOper?this._concreteOper.reverse():null}}),Kekule}},function(module,exports,__webpack_require__){"use strict";module.exports=function(Kekule){return Kekule.Editor.StructureUtils={getCascadeDeleteObjs:function(chemStructObj){return Kekule.ChemStructureUtils.getCascadeDeleteObjs(chemStructObj)},getSurroundingObjs:function(chemObj){var objs=chemObj.getLinkedObjs();if(chemObj instanceof Kekule.ChemStructureConnector){var extraObjs=chemObj.getConnectedObjs();Kekule.ArrayUtils.pushUnique(objs,extraObjs)}return objs},calcMostEmptyDirectionAngleOfChemObj:function(obj,linkedObjs,allowCoordBorrow){var angles=[];linkedObjs||(linkedObjs=obj.getLinkedObjs());for(var baseCoord=obj.getAbsBaseCoord2D(allowCoordBorrow),i=0,l=linkedObjs.length;i<l;++i){var c=linkedObjs[i].getAbsBaseCoord2D(allowCoordBorrow);c=Kekule.CoordUtils.substract(c,baseCoord);var angle=Math.atan2(c.y,c.x);angle<0&&(angle=2*Math.PI+angle),angles.push(angle)}angles.sort();var l=angles.length;if(0===l)return 0;if(1===l)return-angles[0];for(var max=0,index=0,i=0;i<l;++i){var a1=angles[i],a2=angles[(i+1)%l],delta=a2-a1;delta<0&&(delta+=2*Math.PI),delta>max&&(max=delta,index=i)}return angles[index]+max/2},calcPreferred2DBondGrowingDirection:function(startingObj,defBondAngle,allowCoordBorrow){var startingCoord=startingObj.getAbsBaseCoord2D(allowCoordBorrow),connectedObjs=Kekule.Editor.StructureUtils.getSurroundingObjs(startingObj);switch(connectedObjs?connectedObjs.length:0){case 0:return defBondAngle;case 1:var refObj=connectedObjs[0],refCoord=refObj.getAbsBaseCoord2D(allowCoordBorrow),refVector=Kekule.CoordUtils.substract(refCoord,startingCoord),refAngle=Math.atan2(refVector.y,refVector.x),angle1=refAngle-defBondAngle,angle2=refAngle+defBondAngle;angle1<0&&(angle1+=2*Math.PI),angle2<0&&(angle2+=2*Math.PI);var finalAngle;return finalAngle=angle1!==angle2?Math.min(angle1>Math.PI?Math.abs(angle1-2*Math.PI):angle1,Math.abs(angle1-Math.PI))<=Math.min(angle2>Math.PI?Math.abs(angle2-2*Math.PI):angle2,Math.abs(angle2-Math.PI))?angle1:angle2:angle1;default:var finalAngle=Kekule.Editor.StructureUtils.calcMostEmptyDirectionAngleOfChemObj(startingObj,connectedObjs,allowCoordBorrow);return finalAngle}},calcPreferred2DBondGrowingLocation:function(startingObj,bondLength,defAngle,allowCoordBorrow){var startingCoord=startingObj.getAbsBaseCoord2D(allowCoordBorrow),direction=Kekule.Editor.StructureUtils.calcPreferred2DBondGrowingDirection(startingObj,defAngle,allowCoordBorrow);return Kekule.CoordUtils.add(startingCoord,{x:bondLength*Math.cos(direction),y:bondLength*Math.sin(direction)})}},Kekule.Editor.RepositoryStructureUtils={_calcNodeMergeAdjustRotateAngle:function(editor,mergeNode,destNode){var result=0,coordMode=editor.getCoordMode();if(coordMode!==Kekule.CoordMode.COORD3D){var allowCoordBorrow=editor.getAllowCoordBorrow(),structConfigs=editor.getEditorConfigs().getStructureConfigs(),targetSurroundingObjs=Kekule.Editor.StructureUtils.getSurroundingObjs(mergeNode),destSurroundingObjs=Kekule.Editor.StructureUtils.getSurroundingObjs(destNode);if(1===targetSurroundingObjs.length){var connector=mergeNode.getLinkedConnectorAt(0),bondOrder=connector.getBondOrder?connector.getBondOrder():0,bondAngle=structConfigs.getNewBondDefAngle(destNode,bondOrder);refAngle=Kekule.Editor.StructureUtils.calcPreferred2DBondGrowingDirection(destNode,bondAngle,allowCoordBorrow);var vector=Kekule.ChemStructureUtils.getAbsCoordVectorBetweenObjs(mergeNode,targetSurroundingObjs[0],coordMode,allowCoordBorrow);result=refAngle-Math.atan2(vector.y,vector.x)}else if(1===destSurroundingObjs.length){var connector=destNode.getLinkedConnectorAt(0),bondOrder=connector.getBondOrder?connector.getBondOrder():0,bondAngle=structConfigs.getNewBondDefAngle(mergeNode,bondOrder),refAngle=Kekule.Editor.StructureUtils.calcPreferred2DBondGrowingDirection(mergeNode,bondAngle,allowCoordBorrow),vector=Kekule.ChemStructureUtils.getAbsCoordVectorBetweenObjs(destNode,destSurroundingObjs[0],coordMode,allowCoordBorrow),destOriginAngle=Math.atan2(vector.y,vector.x);result=destOriginAngle-refAngle}else{for(var bondAngle=structConfigs.getNewBondDefAngle(destNode,null),refAngle=Kekule.Editor.StructureUtils.calcPreferred2DBondGrowingDirection(destNode,bondAngle,allowCoordBorrow),targetBondAngleRange={},i=0,l=targetSurroundingObjs.length;i<l;++i){var vector=Kekule.ChemStructureUtils.getAbsCoordVectorBetweenObjs(mergeNode,targetSurroundingObjs[i],coordMode,allowCoordBorrow),angle=Math.atan2(vector.y,vector.x);(Kekule.ObjUtils.isUnset(targetBondAngleRange.min)||angle<targetBondAngleRange.min)&&(targetBondAngleRange.min=angle),(Kekule.ObjUtils.isUnset(targetBondAngleRange.max)||angle>targetBondAngleRange.max)&&(targetBondAngleRange.max=angle)}var middleAngle=(targetBondAngleRange.max+targetBondAngleRange.min)/2;result=refAngle-middleAngle}}return result},_calcConnectorMergeTransformParams:function(editor,mergeConnector,destConnector){var targetObj0=mergeConnector.getConnectedObjAt(0),targetObj1=mergeConnector.getConnectedObjAt(1),destObj0=destConnector.getConnectedObjAt(0),destObj1=destConnector.getConnectedObjAt(1),targetCoord0=editor.getObjCoord(targetObj0),targetCoord1=editor.getObjCoord(targetObj1),destCoord0=editor.getObjCoord(destObj0),destCoord1=editor.getObjCoord(destObj1);return Kekule.CoordUtils.calcCoordGroup2DTransformParams(targetCoord0,targetCoord1,destCoord1,destCoord0)},calcRepObjInitialTransformParams:function(editor,repItem,repResult,destObj,targetCoord){var rotateAngle,repBaseCoord=repResult.baseObjCoord,editorRefLength=editor.getDefBondLength(),coordScale=editorRefLength/repItem.getRefLength(),center=repBaseCoord;if(repResult.mergeObj){var destObj=repResult.mergeDest||destObj;if(destObj)if(targetCoord=editor.getObjectScreenCoord(destObj),repResult.mergeObj instanceof Kekule.ChemStructureNode&&destObj instanceof Kekule.ChemStructureNode)rotateAngle=Kekule.Editor.RepositoryStructureUtils._calcNodeMergeAdjustRotateAngle(editor,repResult.mergeObj,destObj);else if(repResult.mergeObj instanceof Kekule.ChemStructureConnector&&destObj instanceof Kekule.ChemStructureConnector)return Kekule.Editor.RepositoryStructureUtils._calcConnectorMergeTransformParams(editor,repResult.mergeObj,destObj)}var objCoord=editor.translateCoord(targetCoord,Kekule.Editor.CoordSys.SCREEN,Kekule.Editor.CoordSys.CHEM);return repBaseCoord&&(objCoord=Kekule.CoordUtils.substract(objCoord,repBaseCoord)),{scale:coordScale,translateX:objCoord.x,translateY:objCoord.y,translateZ:objCoord.z,rotateAngle:rotateAngle,center:center}},transformChemObjectsCoordAndSize:function(editor,objects,transformParams){var coordMode=editor.getCoordMode(),allowCoordBorrow=editor.getAllowCoordBorrow(),matrix=coordMode===Kekule.CoordMode.COORD3D?Kekule.CoordUtils.calcTransform3DMatrix(transformParams):Kekule.CoordUtils.calcTransform2DMatrix(transformParams),childTransformParams=Object.extend({},transformParams);childTransformParams=Object.extend(childTransformParams,{translateX:0,translateY:0,translateZ:0,center:{x:0,y:0,z:0}});for(var childMatrix=coordMode===Kekule.CoordMode.COORD3D?Kekule.CoordUtils.calcTransform3DMatrix(childTransformParams):Kekule.CoordUtils.calcTransform2DMatrix(childTransformParams),i=0,l=objects.length;i<l;++i){var obj=objects[i];obj.transformAbsCoordByMatrix(matrix,childMatrix,coordMode,!0,allowCoordBorrow),obj.scaleSize(transformParams.scale,coordMode,!0,allowCoordBorrow)}}},Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,DataType=__webpack_require__(0).DataType;module.exports=function(Kekule){var PS=Class.PropertyScope;return Kekule.Editor.BaseEditorConfigs=Class.create(Kekule.ChemWidget.ChemObjDisplayerConfigs,{CLASS_NAME:"Kekule.Editor.BaseEditorConfigs",initProperties:function(){this.addConfigProp("uiMarkerConfigs","Kekule.EditorConfigs.UiMarkerConfigs"),this.addConfigProp("interactionConfigs","Kekule.EditorConfigs.InteractionConfigs"),this.addConfigProp("structureConfigs","Kekule.Editor.StructureConfigs")},initPropValues:function($super){$super(),this.setPropStoreFieldValue("uiMarkerConfigs",new Kekule.Editor.UiMarkerConfigs),this.setPropStoreFieldValue("interactionConfigs",new Kekule.Editor.InteractionConfigs),this.setPropStoreFieldValue("structureConfigs",new Kekule.Editor.StructureConfigs)}}),Kekule.Editor.ChemSpaceEditorConfigs=Class.create(Kekule.Editor.BaseEditorConfigs,{CLASS_NAME:"Kekule.Editor.ChemSpaceEditorConfigs",initProperties:function(){this.addConfigProp("chemSpaceConfigs","Kekule.Editor.ChemSpaceConfigs"),this.addConfigProp("styleSetterConfigs","Kekule.Editor.StyleSetterConfigs",void 0,{scope:PS.PUBLIC})},initPropValues:function($super){$super(),this.setPropStoreFieldValue("chemSpaceConfigs",new Kekule.Editor.ChemSpaceConfigs),this.setPropStoreFieldValue("styleSetterConfigs",new Kekule.Editor.StyleSetterConfigs)}}),Kekule.ClassUtils.makeSingleton(Kekule.Editor.ChemSpaceEditorConfigs),Kekule.Editor.InteractionConfigs=Class.create(Kekule.AbstractConfigs,{CLASS_NAME:"Kekule.Editor.InteractionConfigs",initProperties:function(){var degreeStep=Math.PI/180;this.addBoolConfigProp("enableTrackOnNearest",!0),this.addBoolConfigProp("enableHotTrack",!0),this.addIntConfigProp("objBoundTrackInflation",5),this.addBoolConfigProp("enablePartialAreaSelecting",!1),this.addIntConfigProp("selectionMarkerInflation",5,{scope:PS.PUBLIC}),this.addIntConfigProp("selectionMarkerEdgeInflation",5,{scope:PS.PUBLIC}),this.addIntConfigProp("rotationRegionInflation",10,{scope:PS.PUBLIC}),this.addFloatConfigProp("constrainedRotateStep",15*degreeStep,{scope:PS.PUBLIC}),this.addIntConfigProp("rotationLocationPointDistanceThreshold",10),this.addIntConfigProp("directedMoveDistanceThreshold",10),this.addIntConfigProp("clonedObjectScreenOffset",10),this.addIntConfigProp("atomSetterFontSize",14),this.addBoolConfigProp("allowUnknownAtomSymbol",!0)}}),Kekule.Editor.UiMarkerConfigs=Class.create(Kekule.AbstractConfigs,{CLASS_NAME:"Kekule.Editor.UiMarkerConfigs",initProperties:function(){this.addStrConfigProp("hotTrackerColor","#0000FF"),this.addFloatConfigProp("hotTrackerOpacity",.5),this.addStrConfigProp("selectionMarkerStrokeColor","#0000FF"),this.addFloatConfigProp("selectionMarkerStrokeWidth",2),this.addStrConfigProp("selectionMarkerFillColor","#0000FF"),this.addFloatConfigProp("selectionMarkerOpacity",.2),this.addFloatConfigProp("selectionTransformMarkerSize",8,{scope:PS.PUBLIC}),this.addFloatConfigProp("selectionTransformMarkerOpacity",.4,{scope:PS.PUBLIC}),this.addStrConfigProp("selectingMarkerStrokeColor","#000000"),this.addFloatConfigProp("selectingMarkerStrokeWidth",1),this.addStrConfigProp("selectingMarkerStrokeDash",!0),this.addStrConfigProp("selectingMarkerFillColor",null),this.addFloatConfigProp("selectingMarkerOpacity",.7)}}),Kekule.Editor.StructureConfigs=Class.create(Kekule.AbstractConfigs,{CLASS_NAME:"Kekule.Editor.StructureConfigs",initProperties:function(){this.addStrConfigProp("defBondType",Kekule.BondType.DEFAULT,{enumSource:Kekule.BondType}),this.addIntConfigProp("defBondOrder",Kekule.BondOrder.SINGLE,{enumSource:Kekule.BondOrder}),this.addFloatConfigProp("defBondLength",.8),this.addConfigProp("defBondAngles",DataType.ARRAY,void 0,{scope:PS.PUBLIC}),this.addFloatConfigProp("bondConstrainedDirectionDelta",void 0,{scope:PS.PUBLIC}),this.addConfigProp("bondConstrainedDirectionAngles",DataType.ARRAY,void 0,{scope:PS.PUBLIC}),this.addFloatConfigProp("bondConstrainedDirectionAngleThreshold",void 0,{scope:PS.PUBLIC}),this.addFloatConfigProp("initialBondDirection",void 0,{scope:PS.PUBLIC}),this.addStrConfigProp("defIsotopeId","C"),this.addConfigProp("primaryOrgChemAtoms",DataType.ARRAY,void 0,{scope:PS.PUBLIC}),this.addBoolConfigProp("enableChargeAndRadicalMarker",!0)},initPropValues:function($super){$super();var degreeStep=Math.PI/180,angles=[],BO=Kekule.BondOrder,angle120=2*Math.PI/3;angles[0]=angle120,angles[BO.EXPLICIT_AROMATIC]=[angle120],angles[BO.TRIPLE]=[Math.PI],angles[BO.DOUBLE]=[angle120],angles[BO.DOUBLE][BO.DOUBLE]=Math.PI,angles[BO.SINGLE]=[angle120],this.setDefBondAngles(angles),this.setBondConstrainedDirectionDelta(10*Math.PI/180),this.setBondConstrainedDirectionAngles([0,90*degreeStep,180*degreeStep,270*degreeStep]),this.setBondConstrainedDirectionAngleThreshold(3*degreeStep),this.setInitialBondDirection(30*degreeStep),this.setPrimaryOrgChemAtoms(["C","H","O","N","P","S","F","Cl","Br","I"])},getDefAngleOfBonds:function(bondOrder1,bondOrder2){var b1=bondOrder1||0,b2=bondOrder2||0;b1>b2&&(b1=bondOrder2||0,b2=bondOrder1||0);var angles=this.getDefBondAngles(),map=angles[b2];if(map){return map[b1]||map[0]}return angles[0]},getNewBondDefAngle:function(startObj,newBondOrder){Kekule.ObjUtils.isUnset(newBondOrder)&&(newBondOrder=this.getDefBondOrder());var result,surroundingObjs=Kekule.Editor.StructureUtils.getSurroundingObjs(startObj);if(1===surroundingObjs.length){var existingConnector=startObj.getLinkedConnectorAt(0);if(existingConnector&&existingConnector.getConnectedObjs().indexOf(surroundingObjs[0])>=0){var existingBondOrder=existingConnector.getBondOrder?existingConnector.getBondOrder():null;Kekule.ObjUtils.notUnset(existingBondOrder)&&(result=this.getDefAngleOfBonds(newBondOrder,existingBondOrder))}}else result=0===surroundingObjs.length?this.getInitialBondDirection():this.getDefAngleOfBonds(newBondOrder,0);return result}}),Kekule.Editor.ChemSpaceConfigs=Class.create(Kekule.AbstractConfigs,{CLASS_NAME:"Kekule.Editor.ChemSpaceConfigs",initProperties:function(){this.addHashConfigProp("defScreenSize2D"),this.addHashConfigProp("defScreenSize3D"),this.addNumConfigProp("defPadding",50)},initPropValues:function($super){$super(),this.setDefScreenSize2D({x:900,y:1500}),this.setDefScreenSize3D({x:600,y:600,z:600})}}),Kekule.Editor.StyleSetterConfigs=Class.create(Kekule.AbstractConfigs,{CLASS_NAME:"Kekule.Editor.StyleSetterConfigs",initProperties:function(){this.defineProp("listedFontSizes",{dataType:DataType.ARRAY}),this.defineProp("listedFontNames",{dataType:DataType.ARRAY})},initPropValues:function($super){$super(),this.setListedFontSizes([8,9,10,11,12,14,16,18,20,24,28,32,36,40,44,48,54,60,66,72,80,88,96]),this.setListedFontNames(Kekule.Widget.FontEnumerator.getAvailableFontFamilies())}}),Kekule}},function(module,exports,__webpack_require__){"use strict";module.exports=function(Kekule){return Kekule.Editor.RepositoryData={subGroups:[{name:"methyl",inputTexts:["Me","CH3"],dataFormat:"Kekule-JSON",structData:'{"id":null,"info":{"generator":"ChemDraw","date":{"__type__":"date","date":"Thu, 15 Sep 2016 15:49:02 GMT"},"__type__":"object"},"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[],"connectors":[],"__type__":"Kekule.StructureConnectionTable"},"abbr":"Me","__type__":"Kekule.SubGroup"}'},{name:"ethyl",inputTexts:["Et","C2H5"],structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":-0.34641016151377535,"y":-0.19999999999999574,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.34641016151377535,"y":0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]}],"__type__":"Kekule.StructureConnectionTable"},"abbr":"Et","__type__":"Kekule.SubGroup"}'},{name:"n-propyl",inputTexts:["n-Pr","nPr","C3H7"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":-0.6928203230275507,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0,"y":0.19999999999999574,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.6928203230275507,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,2]}],"__type__":"Kekule.StructureConnectionTable"},"abbr":"n-Pr","formulaText":"C3H7","__type__":"Kekule.SubGroup"}'},{name:"i-propyl",inputTexts:["i-Pr","iPr"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[],"coord2D":{"x":-0.6928203230275507,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":0,"y":0.19999999999999574,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[],"coord2D":{"x":0.6928203230275507,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[1],"connectors":[{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,2]}],"__type__":"Kekule.StructureConnectionTable"},"abbr":"i-Pr","__type__":"Kekule.SubGroup"}'},{name:"n-butyl",inputTexts:["n-Bu","nBu","C4H9"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":-1.039230484541326,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[],"coord2D":{"x":-0.34641016151377535,"y":0.19999999999999574,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[],"coord2D":{"x":0.34641016151377535,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":1.039230484541326,"y":0.19999999999999574,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,2]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[2,3]}],"__type__":"Kekule.StructureConnectionTable"},"abbr":"n-Bu","formulaText":"C4H9","__type__":"Kekule.SubGroup"}'},{name:"i-butyl",inputTexts:["i-Bu","iBu"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":-0.6928203230275507,"y":-0.5999999999999943,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[],"coord2D":{"x":0,"y":-0.19999999999999574,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[],"coord2D":{"x":0.6928203230275507,"y":-0.5999999999999943,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0,"y":0.6000000000000014,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,2]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,3]}],"__type__":"Kekule.StructureConnectionTable"},"abbr":"i-Bu","__type__":"Kekule.SubGroup"}'},{name:"s-butyl",inputTexts:["s-Bu","sBu"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[],"coord2D":{"x":-1.039230484541326,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":-0.34641016151377535,"y":0.19999999999999574,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[],"coord2D":{"x":0.34641016151377535,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":1.039230484541326,"y":0.19999999999999574,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[1],"connectors":[{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,2]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[2,3]}],"__type__":"Kekule.StructureConnectionTable"},"abbr":"s-Bu","__type__":"Kekule.SubGroup"}'},{name:"t-butyl",inputTexts:["t-Bu","tBu"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":0,"y":-0.3999999999999915,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.6928203230275507,"y":7.105427357601002e-15,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.6928203230275507,"y":7.105427357601002e-15,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0,"y":0.3999999999999986,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,2]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,3]}],"__type__":"Kekule.StructureConnectionTable"},"abbr":"t-Bu","__type__":"Kekule.SubGroup"}'},{name:"phenyl",inputTexts:["Ph","C6H5"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":8.881784197001252e-16,"y":-0.7999999999999972,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.6928203230275516,"y":-0.3999999999999986,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.6928203230275516,"y":0.3999999999999986,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":8.881784197001252e-16,"y":0.7999999999999972,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.6928203230275516,"y":0.3999999999999986,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.6928203230275516,"y":-0.3999999999999986,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[1,2]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[2,3]},{"__type__":"Kekule.Bond","id":null,"overrideRenderOptionItems":[],"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[3,4]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[4,5]},{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[5,0]}],"__type__":"Kekule.StructureConnectionTable"},"abbr":"Ph","formulaText":"C6H5","__type__":"Kekule.SubGroup"}'},{name:"benzyl",inputTexts:["Bn"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":8.881784197001252e-16,"y":-1.1999999999999957,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.6928203230275516,"y":-0.7999999999999972,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.6928203230275516,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":8.881784197001252e-16,"y":0.3999999999999986,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.6928203230275516,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.6928203230275516,"y":-0.7999999999999972,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":8.881784197001252e-16,"y":1.1999999999999957,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[6],"connectors":[{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[1,2]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[2,3]},{"__type__":"Kekule.Bond","id":null,"overrideRenderOptionItems":[],"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[3,4]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[4,5]},{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[5,0]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[3,6]}],"__type__":"Kekule.StructureConnectionTable"},"abbr":"Bn","__type__":"Kekule.SubGroup"}'},{name:"benzoyl",inputTexts:["Bz"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":8.881784197001252e-16,"y":-1.399999999999995,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.6928203230275516,"y":-0.9999999999999964,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.6928203230275516,"y":-0.1999999999999993,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":8.881784197001252e-16,"y":0.1999999999999993,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.6928203230275516,"y":-0.1999999999999993,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.6928203230275516,"y":-0.9999999999999964,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":8.881784197001252e-16,"y":0.9999999999999964,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.6928203230275498,"y":1.399999999999995,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"}],"anchorNodes":[6],"connectors":[{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[1,2]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[2,3]},{"__type__":"Kekule.Bond","id":null,"overrideRenderOptionItems":[],"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[3,4]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[4,5]},{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[5,0]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[3,6]},{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[6,7]}],"__type__":"Kekule.StructureConnectionTable"},"abbr":"Bz","__type__":"Kekule.SubGroup"}'},{inputTexts:["CF3"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":0,"y":-0.3999999999999986,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.6928203230275507,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"F"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.6928203230275507,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"F"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0,"y":0.3999999999999915,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"F"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,2]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,3]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"CF3","__type__":"Kekule.SubGroup"}'},{inputTexts:["CCl3"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":0,"y":-0.3999999999999986,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.6928203230275507,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"Cl"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.6928203230275507,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"Cl"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0,"y":0.3999999999999915,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"Cl"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,2]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,3]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"CCl3","__type__":"Kekule.SubGroup"}'},{inputTexts:["CBr3"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":0,"y":-0.3999999999999986,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.6928203230275507,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"Br"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.6928203230275507,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"Br"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0,"y":0.3999999999999915,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"Br"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,2]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,3]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"CBr3","__type__":"Kekule.SubGroup"}'},{inputTexts:["CI3"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":0,"y":-0.3999999999999986,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.6928203230275507,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"I"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.6928203230275507,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"I"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0,"y":0.3999999999999915,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"I"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,2]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,3]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"CI3","__type__":"Kekule.SubGroup"}'},{inputTexts:["OMe","OCH3"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.34641016151377535,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.34641016151377535,"y":0.19999999999999574,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"OMe","__type__":"Kekule.SubGroup"}'},{inputTexts:["OEt","OC2H5"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.6928203230275507,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0,"y":0.19999999999999574,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.6928203230275507,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,2]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"OEt","__type__":"Kekule.SubGroup"}'},{inputTexts:["Ot-Bu"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.6928203230275525,"y":-0.5999999999999943,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-1.7763568394002505e-15,"y":-0.19999999999999574,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.6928203230275454,"y":0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.6928203230275525,"y":-0.6000000000000014,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":1.7763568394002505e-15,"y":0.6000000000000014,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,2]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,3]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,4]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"Ot-Bu","__type__":"Kekule.SubGroup"}'},{inputTexts:["CO"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":0,"y":-0.3999999999999986,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0,"y":0.3999999999999986,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[0,1]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"CO","__type__":"Kekule.SubGroup"}'},{inputTexts:["CHO"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":0,"y":-0.3999999999999986,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0,"y":0.3999999999999986,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[0,1]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"CHO","__type__":"Kekule.SubGroup"}'},{name:"carboxyl",inputTexts:["COOH","CO2H"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":-0.34641016151377535,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.34641016151377535,"y":0.5999999999999943,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.34641016151377535,"y":-0.6000000000000014,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,2]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"COOH","__type__":"Kekule.SubGroup"}'},{inputTexts:["COOOH","CO3H","CO2OH"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":-0.6928203230275507,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.6928203230275507,"y":0.5999999999999943,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0,"y":-0.6000000000000014,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.6928203230275507,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,2]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[2,3]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"CO3H","__type__":"Kekule.SubGroup"}'},{inputTexts:["COONa"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":-0.6928203230275507,"y":-0.19999999999999574,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.6928203230275507,"y":0.6000000000000014,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0,"y":-0.5999999999999943,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.6928203230275507,"y":-0.19999999999999574,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"Na"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,2]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[2,3]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"COONa","__type__":"Kekule.SubGroup"}'},{inputTexts:["COOK"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":-0.6928203230275507,"y":-0.19999999999999574,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.6928203230275507,"y":0.6000000000000014,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0,"y":-0.5999999999999943,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.6928203230275507,"y":-0.19999999999999574,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"K"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,2]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[2,3]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"COOK","__type__":"Kekule.SubGroup"}'},{inputTexts:["COOCH3","COOMe"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":-0.6928203230275507,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.6928203230275507,"y":0.5999999999999943,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0,"y":-0.6000000000000014,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.6928203230275507,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,2]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[2,3]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"COOMe","__type__":"Kekule.SubGroup"}'},{inputTexts:["COOC2H5","COOEt"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":-1.039230484541326,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-1.039230484541326,"y":0.5999999999999943,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.34641016151377535,"y":-0.6000000000000014,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.34641016151377535,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":1.039230484541326,"y":-0.6000000000000014,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,2]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[2,3]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[3,4]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"COOEt","__type__":"Kekule.SubGroup"}'},{inputTexts:["COCl"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":-0.34641016151377535,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.34641016151377535,"y":0.5999999999999943,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.34641016151377535,"y":-0.6000000000000014,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"Cl"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,2]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"COCl","__type__":"Kekule.SubGroup"}'},{inputTexts:["COBr"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":-0.34641016151377535,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.34641016151377535,"y":0.5999999999999943,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.34641016151377535,"y":-0.6000000000000014,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"Br"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,2]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"COBr","__type__":"Kekule.SubGroup"}'},{inputTexts:["CONH2"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":-0.34641016151377535,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.34641016151377535,"y":0.5999999999999943,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.34641016151377535,"y":-0.6000000000000014,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"N"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,2]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"CONH2","__type__":"Kekule.SubGroup"}'},{inputTexts:["Ac"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":-0.34641016151377535,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.34641016151377535,"y":0.5999999999999943,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.34641016151377535,"y":-0.6000000000000014,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,2]}],"__type__":"Kekule.StructureConnectionTable"},"abbr":"Ac","__type__":"Kekule.SubGroup"}'},{inputTexts:["OAc"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":0,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0,"y":0.5999999999999943,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.6928203230275507,"y":-0.6000000000000014,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.6928203230275507,"y":-0.6000000000000014,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"}],"anchorNodes":[3],"connectors":[{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,2]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,3]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"OAc","__type__":"Kekule.SubGroup"}'},{inputTexts:["MeCO","COMe"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":0.34641016151377535,"y":-0.19999999999999574,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.3464101615137771,"y":0.6000000000000014,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.3464101615137771,"y":-0.5999999999999943,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,2]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"COMe","__type__":"Kekule.SubGroup"}'},{inputTexts:["EtCO","COEt"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":0.6928203230275507,"y":-0.19999999999999574,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.6928203230275525,"y":0.6000000000000014,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-1.7763568394002505e-15,"y":-0.5999999999999943,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.6928203230275507,"y":-0.19999999999999574,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,2]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[2,3]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"COEt","__type__":"Kekule.SubGroup"}'},{name:"hydroxymethyl",inputTexts:["CH2OH"],dataFormat:"Kekule-JSON",structData:'{"coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"coord2D":{"x":-0.3999999999999986,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0.3999999999999968,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"CH2OH","__type__":"Kekule.SubGroup"}'},{name:"amino",inputTexts:["NH2"],dataFormat:"Kekule-JSON",structData:'{"id":null,"info":{"generator":"ChemDraw","date":{"__type__":"date","date":"Thu, 15 Sep 2016 15:49:26 GMT"},"__type__":"object"},"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"N"}],"anchorNodes":[0],"connectors":[],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"NH2","name":"Untitled Document-1","__type__":"Kekule.SubGroup"}'},{inputTexts:["NMe2"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.6928203230275507,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0,"y":0.19999999999999574,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"N"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.6928203230275507,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[1],"connectors":[{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,2]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"NMe2","__type__":"Kekule.SubGroup"}'},{name:"nitro",inputTexts:["NO2"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.6928203230275507,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":0,"y":0.19999999999999574,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"N"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.6928203230275507,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"}],"anchorNodes":[1],"connectors":[{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[1,2]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"NO2","__type__":"Kekule.SubGroup"}'},{name:"nitroso",inputTexts:["NO"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[],"coord2D":{"x":-0.34641016151377535,"y":0.19999999999999574,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"N"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.34641016151377535,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[1,0]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"NO","__type__":"Kekule.SubGroup"}'},{name:"diazo",inputTexts:["N2","NN","N2 +"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"coord2D":{"x":-0.3999999999999986,"y":0,"__type__":"object"},"charge":1,"radical":0,"parity":null,"isotopeId":"N"},{"__type__":"Kekule.Atom","id":null,"coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0.3999999999999986,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"N"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":3,"electronCount":6,"isInAromaticRing":false,"connectedObjs":[0,1]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"N2 +","__type__":"Kekule.SubGroup"}'},{inputTexts:["N2Cl","NNCl","N2 +Cl-"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"coord2D":{"x":1.7763568394002505e-15,"y":0,"__type__":"object"},"charge":1,"radical":0,"parity":null,"isotopeId":"N"},{"__type__":"Kekule.Atom","id":null,"coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0.7999999999999989,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"N"},{"__type__":"Kekule.Atom","id":null,"coordPos2D":0,"coordPos3D":0,"coord2D":{"x":-0.7999999999999989,"y":0,"__type__":"object"},"charge":-1,"radical":0,"parity":null,"isotopeId":"Cl"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":3,"electronCount":6,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"parity":null,"bondType":"ionic","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,2]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"N2 +Cl-","__type__":"Kekule.SubGroup"}'},{inputTexts:["N2Br","NNBr","N2 +Br-"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"coord2D":{"x":1.7763568394002505e-15,"y":0,"__type__":"object"},"charge":1,"radical":0,"parity":null,"isotopeId":"N"},{"__type__":"Kekule.Atom","id":null,"coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0.7999999999999989,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"N"},{"__type__":"Kekule.Atom","id":null,"coordPos2D":0,"coordPos3D":0,"coord2D":{"x":-0.7999999999999989,"y":0,"__type__":"object"},"charge":-1,"radical":0,"parity":null,"isotopeId":"Br"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":3,"electronCount":6,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"parity":null,"bondType":"ionic","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,2]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"N2 +Br-","__type__":"Kekule.SubGroup"}'},{name:"nitrile group",inputTexts:["CN"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[],"coord2D":{"x":-0.34641016151377535,"y":0.19999999999999574,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.34641016151377535,"y":-0.20000000000000284,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"N"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":3,"electronCount":6,"isInAromaticRing":false,"connectedObjs":[1,0]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"CN","__type__":"Kekule.SubGroup"}'},{name:"pyridyl",inputTexts:["Py"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-8.881784197001252e-16,"y":-0.7999999999999972,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"N"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.6928203230275498,"y":-0.3999999999999986,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.6928203230275498,"y":0.3999999999999986,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-8.881784197001252e-16,"y":0.7999999999999972,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.6928203230275498,"y":0.3999999999999986,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.6928203230275498,"y":-0.3999999999999986,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[1,2]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[2,3]},{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[3,4]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[4,5]},{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[5,0]}],"__type__":"Kekule.StructureConnectionTable"},"abbr":"Py","__type__":"Kekule.SubGroup"}'},{name:"sulfonic group",inputTexts:["SO3H"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":-0.40000000000000213,"y":7.105427357601002e-15,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"S"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.40000000000000213,"y":0.8000000000000043,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.399999999999995,"y":-0.7999999999999972,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.40000000000000036,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[0,2]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,3]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"SO3H","__type__":"Kekule.SubGroup"}'},{inputTexts:["SO2Cl"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":-0.40000000000000036,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"S"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.40000000000000036,"y":0.7999999999999972,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.40000000000000036,"y":-0.7999999999999972,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.40000000000000036,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"Cl"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[0,2]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,3]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"SO2Cl","__type__":"Kekule.SubGroup"}'},{inputTexts:["SO2Br"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":-0.40000000000000036,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"S"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.40000000000000036,"y":0.7999999999999972,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":-0.40000000000000036,"y":-0.7999999999999972,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.40000000000000036,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"Br"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","id":null,"bondType":"covalent","bondOrder":2,"electronCount":4,"isInAromaticRing":false,"connectedObjs":[0,2]},{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,3]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"SO2Br","__type__":"Kekule.SubGroup"}'},{inputTexts:["MgCl"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":-0.40000000000000036,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"Mg"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.40000000000000036,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"Cl"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"MgCl","__type__":"Kekule.SubGroup"}'},{inputTexts:["MgBr"],dataFormat:"Kekule-JSON",structData:'{"id":null,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","id":null,"overrideRenderOptionItems":[null],"coord2D":{"x":-0.40000000000000036,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"Mg"},{"__type__":"Kekule.Atom","id":null,"coord2D":{"x":0.40000000000000036,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"Br"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","id":null,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]}],"__type__":"Kekule.StructureConnectionTable"},"formulaText":"MgBr","__type__":"Kekule.SubGroup"}'},{inputTexts:["TMS"],dataFormat:"Kekule-JSON",structData:'{"coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"coord2D":{"x":-0.40000000000000036,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"Si"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0.40000000000000036,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":-0.40000000000000036,"y":0.7999999999999972,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":-0.40000000000000036,"y":-0.7999999999999972,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,2]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,3]}],"__type__":"Kekule.StructureConnectionTable"},"abbr":"TMS","__type__":"Kekule.SubGroup"}'},{inputTexts:["OTMS"],dataFormat:"Kekule-JSON",structData:'{"coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"coord2D":{"x":-0.6928203230275507,"y":-0.3999999999999986,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"O"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"Si"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0.6928203230275507,"y":-0.3999999999999986,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0,"y":0.7999999999999972,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0,"y":-0.7999999999999972,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,2]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,3]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,4]}],"__type__":"Kekule.StructureConnectionTable"},"abbr":"OTMS","__type__":"Kekule.SubGroup"}'}],fragments:[{name:"methane",dataFormat:"Kekule-JSON",structData:'{"info":{"generator":"ChemDraw","date":{"__type__":"date","date":"Sat, 25 Feb 2017 04:21:08 GMT"},"__type__":"object"},"coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[0],"connectors":[],"__type__":"Kekule.StructureConnectionTable"},"name":"Untitled Document-1","__type__":"Kekule.Molecule"}'},{name:"fischer1",dataFormat:"Kekule-JSON",structData:'{"coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":-0.8000000000000007,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"coord2D":{"x":0,"y":0.8000000000000043,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0.7999999999999989,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":1.7763568394002505e-15,"y":-0.7999999999999972,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[2],"connectors":[{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,2]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,3]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,4]}],"__type__":"Kekule.StructureConnectionTable"},"__type__":"Kekule.Molecule"}'},{name:"fischer2",dataFormat:"Kekule-JSON",structData:'{"coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":-0.7999999999999972,"y":0.3999999999999986,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0,"y":0.3999999999999986,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"coord2D":{"x":-1.7763568394002505e-15,"y":1.2000000000000028,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0.7999999999999989,"y":0.3999999999999986,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0,"y":-0.3999999999999986,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0,"y":-1.2000000000000028,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":-0.8000000000000007,"y":-0.3999999999999986,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0.8000000000000007,"y":-0.3999999999999986,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[2],"connectors":[{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,2]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,3]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,4]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[4,5]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[4,6]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[4,7]}],"__type__":"Kekule.StructureConnectionTable"},"__type__":"Kekule.Molecule"}'},{name:"fischer3",dataFormat:"Kekule-JSON",structData:'{"coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":-0.7999999999999972,"y":0.7999999999999972,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0,"y":0.7999999999999972,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"coord2D":{"x":-1.7763568394002505e-15,"y":1.6000000000000014,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0.7999999999999989,"y":0.7999999999999972,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0,"y":-0.8000000000000043,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":-0.8000000000000007,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0.8000000000000007,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0.7999999999999972,"y":-0.8000000000000043,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0,"y":-1.6000000000000085,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":-0.8000000000000007,"y":-0.8000000000000043,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[2],"connectors":[{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,2]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,3]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,4]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[4,5]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[4,6]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[4,7]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[5,8]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[5,9]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[5,10]}],"__type__":"Kekule.StructureConnectionTable"},"__type__":"Kekule.Molecule"}'},{name:"sawhorseStaggered",dataFormat:"Kekule-JSON",structData:'{"info":{"generator":"ChemDraw","date":{"__type__":"date","date":"Tue, 17 Jan 2017 12:51:35 GMT"},"__type__":"object"},"coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"coord2D":{"x":0.34060000000000024,"y":-0.642199999999999,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"zIndex2D":1,"coord2D":{"x":-0.37219999999999764,"y":-1.0575999999999972,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"coord2D":{"x":-1.0877999999999997,"y":-0.648899999999994,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"coord2D":{"x":-0.3686000000000007,"y":-1.8829999999999991,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"coord2D":{"x":-0.34060000000000024,"y":0.6422000000000061,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"coord2D":{"x":1.0877999999999997,"y":0.6489000000000011,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"coord2D":{"x":0.3686000000000007,"y":1.8829999999999991,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null,null],"zIndex2D":0,"coord2D":{"x":0.3722000000000012,"y":1.0576000000000043,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[6],"connectors":[{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,2]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,3]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,7]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[7,4]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[7,5]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[6,7]}],"__type__":"Kekule.StructureConnectionTable"},"name":"Untitled Document-6","__type__":"Kekule.Molecule"}'},{name:"sawhorseEclipsed",dataFormat:"Kekule-JSON",structData:'{"info":{"generator":"ChemDraw","date":{"__type__":"date","date":"Tue, 17 Jan 2017 12:50:51 GMT"},"__type__":"object"},"coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"coord2D":{"x":-0.3022000000000009,"y":0.4405000000000001,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"zIndex2D":0,"coord2D":{"x":0.4229000000000003,"y":0.8340999999999994,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"coord2D":{"x":1.1265,"y":0.4025999999999996,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null,null],"coord2D":{"x":0.44500000000000206,"y":1.657899999999998,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"coord2D":{"x":-1.1265,"y":-1.6214000000000084,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"zIndex2D":1,"coord2D":{"x":-0.4015000000000004,"y":-1.2276999999999987,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"coord2D":{"x":0.3013999999999992,"y":-1.657899999999998,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"coord2D":{"x":-0.38010000000000055,"y":-0.4025999999999996,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[3],"connectors":[{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,2]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,3]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[4,5]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[5,6]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[5,7]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,5]}],"__type__":"Kekule.StructureConnectionTable"},"name":"Untitled Document-5","__type__":"Kekule.Molecule"}'},{name:"cyclohexaneChair1",dataFormat:"Kekule-JSON",structData:'{"info":{"generator":"ChemDraw","date":{"__type__":"date","date":"Tue, 17 Jan 2017 12:43:26 GMT"},"__type__":"object"},"coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"zIndex2D":-1,"coord2D":{"x":-0.5895,"y":0.3572,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"coord2D":{"x":-1.002,"y":-0.3572,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"zIndex2D":1,"coord2D":{"x":-0.2087,"y":-0.1305,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"zIndex2D":1,"coord2D":{"x":0.5894,"y":-0.3572,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":1.002,"y":0.3572,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"zIndex2D":-1,"coord2D":{"x":0.2086,"y":0.1306,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[1],"connectors":[{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,2]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[2,3]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[3,4]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[4,5]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[5,0]}],"__type__":"Kekule.StructureConnectionTable"},"name":"Untitled Document-1","__type__":"Kekule.Molecule"}'},{name:"cyclohexaneChair2",dataFormat:"Kekule-JSON",structData:'{"info":{"generator":"ChemDraw","date":{"__type__":"date","date":"Tue, 17 Jan 2017 12:44:10 GMT"},"__type__":"object"},"coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":-1.0019000000000005,"y":0.3572,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"zIndex2D":1,"coord2D":{"x":-0.5894000000000005,"y":-0.3572,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"zIndex2D":1,"coord2D":{"x":0.20869999999999955,"y":-0.1481,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"coord2D":{"x":1.0019000000000005,"y":-0.35719999999999885,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"zIndex2D":-1,"coord2D":{"x":0.5894999999999996,"y":0.3572,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"zIndex2D":-1,"coord2D":{"x":-0.20870000000000044,"y":0.1482,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[3],"connectors":[{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,2]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[2,3]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[3,4]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[4,5]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[5,0]}],"__type__":"Kekule.StructureConnectionTable"},"name":"Untitled Document-2","__type__":"Kekule.Molecule"}'},{name:"cyclohexaneHaworth1",dataFormat:"Kekule-JSON",structData:'{"info":{"generator":"ChemDraw","date":{"__type__":"date","date":"Tue, 17 Jan 2017 12:47:35 GMT"},"__type__":"object"},"coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"zIndex2D":-1,"coord2D":{"x":0.488900000000001,"y":0.4831000000000003,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"zIndex2D":-1,"coord2D":{"x":-0.5145999999999997,"y":0.4831000000000003,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":1.155800000000001,"y":-0.002600000000001046,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"coord2D":{"x":-1.1557999999999993,"y":-0.002600000000001046,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"zIndex2D":1,"coord2D":{"x":0.488900000000001,"y":-0.4831000000000003,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"zIndex2D":1,"coord2D":{"x":-0.5145999999999997,"y":-0.4831000000000003,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[3],"connectors":[{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,2]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,3]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[2,4]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[3,5]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[4,5]}],"__type__":"Kekule.StructureConnectionTable"},"name":"Untitled Document-3","__type__":"Kekule.Molecule"}'},{name:"cyclohexaneHaworth2",dataFormat:"Kekule-JSON",structData:'{"info":{"generator":"ChemDraw","date":{"__type__":"date","date":"Tue, 17 Jan 2017 12:47:08 GMT"},"__type__":"object"},"coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"zIndex2D":-1,"coord2D":{"x":0.488900000000001,"y":0.4831000000000003,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"zIndex2D":-1,"coord2D":{"x":-0.5145999999999997,"y":0.4831000000000003,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":1.155800000000001,"y":-0.002600000000001046,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"coord2D":{"x":-1.1557999999999993,"y":-0.002600000000001046,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"zIndex2D":1,"coord2D":{"x":0.488900000000001,"y":-0.4831000000000003,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"zIndex2D":1,"coord2D":{"x":-0.5145999999999997,"y":-0.4831000000000003,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[3],"connectors":[{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,2]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,3]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"stereo":1,"isInAromaticRing":false,"connectedObjs":[2,4]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"stereo":1,"isInAromaticRing":false,"connectedObjs":[3,5]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"stereo":10,"isInAromaticRing":false,"connectedObjs":[4,5]}],"__type__":"Kekule.StructureConnectionTable"},"name":"Untitled Document-3","__type__":"Kekule.Molecule"}'},{name:"cyclopentaneHaworth1",dataFormat:"Kekule-JSON",structData:'{"info":{"generator":"ChemDraw","date":{"__type__":"date","date":"Tue, 17 Jan 2017 12:48:11 GMT"},"__type__":"object"},"coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"zIndex2D":-1,"coord2D":{"x":0.4961500000000001,"y":0.24414999999999765,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"zIndex2D":-1,"coord2D":{"x":-0.49734999999999907,"y":0.24414999999999765,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0.8043499999999995,"y":-0.05805000000000149,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"coord2D":{"x":-0.8043499999999995,"y":-0.05805000000000149,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"zIndex2D":1,"coord2D":{"x":0.0006500000000002615,"y":-0.24414999999999765,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[3],"connectors":[{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,2]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,3]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[2,4]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[3,4]}],"__type__":"Kekule.StructureConnectionTable"},"name":"Untitled Document-4","__type__":"Kekule.Molecule"}'},{name:"cyclopentaneHaworth2",dataFormat:"Kekule-JSON",structData:'{"info":{"generator":"ChemDraw","date":{"__type__":"date","date":"Tue, 17 Jan 2017 12:48:04 GMT"},"__type__":"object"},"coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"zIndex2D":-1,"coord2D":{"x":0.496137,"y":0.24414099999999692,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"zIndex2D":-1,"coord2D":{"x":-0.4973460000000003,"y":0.24414100000000308,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[null],"coord2D":{"x":-0.804334,"y":-0.058014000000003084,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"overrideRenderOptionItems":[],"zIndex2D":1,"coord2D":{"x":0.000604,"y":-0.24414100000000308,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0.804334,"y":-0.058014000000003084,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"}],"anchorNodes":[2],"connectors":[{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[1,2]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"stereo":1,"isInAromaticRing":false,"connectedObjs":[2,3]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"stereo":1,"isInAromaticRing":false,"connectedObjs":[4,3]},{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,4]}],"__type__":"Kekule.StructureConnectionTable"},"name":"Untitled Document-4","__type__":"Kekule.Molecule"}'},{name:"substituentMark",dataFormat:"Kekule-JSON",scale:.7,structData:'{"coordPos2D":0,"coordPos3D":0,"coord2D":{"x":0,"y":0,"__type__":"object"},"charge":0,"parity":null,"ctab":{"nodes":[{"__type__":"Kekule.Atom","coordPos2D":0,"coordPos3D":0,"coord2D":{"x":-0.40000000000000036,"y":0,"__type__":"object"},"charge":0,"parity":null,"isotopeId":"C"},{"__type__":"Kekule.Pseudoatom","coordPos2D":0,"coordPos3D":0,"renderOptions":{"nodeDisplayMode":-1,"__type__":"object"},"coord2D":{"x":0.40000000000000036,"y":0,"__type__":"object"},"charge":0,"parity":null,"atomType":"any","symbol":"A"}],"anchorNodes":[0],"connectors":[{"__type__":"Kekule.Bond","coordPos2D":0,"coordPos3D":0,"renderOptions":{"opacity":0.5,"__type__":"object"},"parity":null,"bondType":"covalent","bondOrder":1,"electronCount":2,"isInAromaticRing":false,"connectedObjs":[0,1]}],"__type__":"Kekule.StructureConnectionTable"},"__type__":"Kekule.Molecule"}'}]},Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,ObjectEx=__webpack_require__(0).ObjectEx,DataType=__webpack_require__(0).DataType;module.exports=function(Kekule){Kekule.Editor.AbstractRepositoryItem=Class.create(ObjectEx,{CLASS_NAME:"Kekule.Editor.AbstractRepositoryItem",initialize:function($super){$super()},initProperties:function(){this.defineProp("name",{dataType:DataType.STRING})},getAvailableCoordModes:function(){return[]},createObjects:function(targetObj){},getScale:function(){return this.doGetScale()||1},doGetScale:function(){return 1},getRefLength:function(){return this.doGetRefLength()/(this.getScale()||1)},doGetRefLength:function(){},isOneStructureFragmentObj:function(){return!1}}),Kekule.Editor.MolRepositoryItem2D=Class.create(Kekule.Editor.AbstractRepositoryItem,{CLASS_NAME:"Kekule.Editor.MolRepositoryItem2D",initialize:function($super){$super()},initProperties:function(){this.defineProp("molScale",{dataType:DataType.FLOAT})},doGetScale:function($super){return this.getMolScale()||$super()},getAvailableCoordModes:function(){return Kekule.CoordMode.COORD2D},isOneStructureFragmentObj:function(){return!0},createObjects:function(targetObj){var mol=this.doCreateObjects(targetObj);if(!mol)return null;var mergeObj=null,mergeDest=null,baseCoord={x:0,y:0};return targetObj&&(mergeObj=targetObj instanceof Kekule.ChemStructureNode?this.doGetMergableNode(mol,targetObj):targetObj instanceof Kekule.ChemStructureConnector?this.doGetMergableConnector(mol,targetObj):null)&&(mergeDest=targetObj,baseCoord=mergeObj.getAbsBaseCoord2D()),{objects:[mol],mergeObj:mergeObj,mergeDest:mergeDest,baseObjCoord:baseCoord,centerCoord:{x:0,y:0}}},doCreateObjects:function(targetObj){return null},doGetMergableNode:function(mol,targetNode){return null},doGetMergableConnector:function(mol,targetNode){return null}}),Kekule.Editor.StoredStructFragmentRepositoryItem2D=Class.create(Kekule.Editor.MolRepositoryItem2D,{CLASS_NAME:"Kekule.Editor.StoredStructFragmentRepositoryItem2D",initialize:function($super,structData,dataFormat,defScale){$super(),this.beginUpdate();try{dataFormat&&this.setDataFormat(dataFormat),structData&&this.setStructData(structData),defScale&&this.setMolScale(defScale)}finally{this.endUpdate()}},initProperties:function(){this.defineProp("structureFragment",{dataType:"Kekule.StructureFragment",setter:null,serializable:!1}),this.defineProp("structData",{dataType:DataType.STRING}),this.defineProp("dataFormat",{dataType:DataType.STRING})},objectChange:function($super,modifiedProps){if($super(modifiedProps),modifiedProps.indexOf("structData")>=0||modifiedProps.indexOf("dataFormat")>=0){var structFragment=null;this.getStructData()&&(structFragment=this._createTemplateStructFragment()),this.setPropStoreFieldValue("structureFragment",structFragment)}},_createTemplateStructFragment:function(){var structFragment=null;return this.getStructData()&&(structFragment=Kekule.IO.loadFormatData(this.getStructData(),this.getDataFormat()||Kekule.IO.DataFormat.KEKULE_JSON)),structFragment&&this._adjustTemplateStructureFragmentCoords(structFragment),structFragment},_adjustTemplateStructureFragmentCoords:function(structFragment){structFragment.setCoord2D({x:0,y:0});var objBox=Kekule.Render.ObjUtils.getContainerBox(structFragment,Kekule.CoordMode.COORD2D,!0);if(objBox){var delta=(structFragment.getCoordOfMode&&structFragment.getCoordOfMode(Kekule.CoordMode.COORD2D,!0),{});delta.x=-(objBox.x2+objBox.x1)/2,delta.y=-(objBox.y2+objBox.y1)/2,structFragment.beginUpdate();try{for(var i=0,l=structFragment.getNodeCount();i<l;++i){var node=structFragment.getNodeAt(i),coord=node.getCoord2D(!0);coord=Kekule.CoordUtils.add(coord,delta),node.setCoord2D(coord)}}finally{structFragment.endUpdate()}}},doGetRefLength:function(){var mol=this.getStructureFragment();return mol?mol.getConnectorLengthMedian(Kekule.CoordMode.COORD2D,!0):0},doCreateObjects:function(targetObj){var structFragment=this.getStructureFragment();return structFragment?structFragment.clone():null},doGetMergableNode:function(mol,targetNode){return mol.getAnchorNodeAt(0)||mol.getNodeAt(0)},doGetMergableConnector:function(mol,targetNode){return null}}),Kekule.Editor.StoredSubgroupRepositoryItem2D=Class.create(Kekule.Editor.StoredStructFragmentRepositoryItem2D,{CLASS_NAME:"Kekule.Editor.StoredSubgroupRepositoryItem2D",initialize:function($super,structData,dataFormat,defScale){$super(structData,dataFormat,defScale)},initProperties:function(){this.defineProp("inputTexts",{dataType:DataType.STRING})},doCreateObjects:function(targetObj){var structFragment=this.getStructureFragment();if(structFragment){var result=new Kekule.SubGroup;return result.assign(structFragment,!1),result}return null},createObjects:function($super,targetObj){return $super(targetObj)},_adjustTemplateStructureFragmentCoords:function(structFragment){structFragment.setCoord2D({x:0,y:0});var anchorNode=structFragment.getCurrConnectableObj();if(anchorNode){var delta=Kekule.CoordUtils.substract({x:0,y:0},anchorNode.getCoord2D(!0));structFragment.beginUpdate();try{for(var i=0,l=structFragment.getNodeCount();i<l;++i){var node=structFragment.getNodeAt(i),coord=node.getCoord2D(!0);coord=Kekule.CoordUtils.add(coord,delta),node.setCoord2D(coord)}}finally{structFragment.endUpdate()}}}}),Kekule.Editor.StoredSubgroupRepositoryItem2D.getRepItemOfInputText=function(inputText){for(var repItems=Kekule.Editor.RepositoryItemManager.getAllItems(Kekule.Editor.StoredSubgroupRepositoryItem2D)||[],i=0,l=repItems.length;i<l;++i){var repItem=repItems[i];if((repItem.getInputTexts()||[]).indexOf(inputText)>=0)return repItem}return null},Kekule.Editor.MolRingRepositoryItem2D=Class.create(Kekule.Editor.MolRepositoryItem2D,{CLASS_NAME:"Kekule.Editor.MolRingRepositoryItem2D",initialize:function($super,ringAtomCount,bondLength){$super(),this.setRingAtomCount(ringAtomCount),this.setBondLength(bondLength||1)},initProperties:function(){this.defineProp("ringAtomCount",{dataType:DataType.INT}),this.defineProp("bondLength",{dataType:DataType.FLOAT}),this.defineProp("isAromatic",{dataType:DataType.BOOL})},doGetRefLength:function(){return this.getBondLength()},doCreateObjects:function(targetObj){return this.generateRing()},doGetMergableNode:function(mol,targetNode){return mol.getNodeAt(0)},doGetMergableConnector:function(mol,targetNode){return mol.getConnectorAt(0)},generateRing:function(targetMol,newStructFragmentClass){newStructFragmentClass||(newStructFragmentClass=Kekule.Molecule);var mol;mol=targetMol||new newStructFragmentClass;for(var lastAtom,lastAtomIndex,firstAtom,atomCount=this.getRingAtomCount(),bondLength=this.getBondLength(),halfCenterAngle=Math.PI/atomCount,sinHalfCenterAngle=Math.sin(halfCenterAngle),centerAngle=2*halfCenterAngle,centerAtomLength=bondLength/2/sinHalfCenterAngle,startingAngle=4===atomCount||8===atomCount?-Math.PI/2-centerAngle/2:-Math.PI/2,i=0;i<atomCount;++i){var atom=this._generateAtom(i),angle=startingAngle+centerAngle*i,x=centerAtomLength*Math.cos(angle),y=centerAtomLength*Math.sin(angle);if(atom.setCoord2D({x:x,y:y}),mol.appendNode(atom),0===i&&(firstAtom=atom),lastAtom){var bond=this._generateBond(lastAtomIndex,i);mol.appendConnector(bond),bond.appendConnectedObj(lastAtom),bond.appendConnectedObj(atom)}lastAtom=atom,lastAtomIndex=i}var bond=this._generateBond(atomCount-1,0);return mol.appendConnector(bond),bond.appendConnectedObj(lastAtom),bond.appendConnectedObj(firstAtom),mol},_generateAtom:function(atomIndex){return new Kekule.Atom(null,"C")},_generateBond:function(atomIndex1,atomIndex2){var bondOrder=Kekule.BondOrder.SINGLE;return this.getIsAromatic()&&atomIndex1%2&&(bondOrder=Kekule.BondOrder.DOUBLE),new Kekule.Bond(null,null,bondOrder)}}),Kekule.Editor.PathGlyphRepositoryItem2D=Class.create(Kekule.Editor.AbstractRepositoryItem,{CLASS_NAME:"Kekule.Editor.PathGlyphRepositoryItem2D",initialize:function($super,glyphClass,glyphRefLength,glyphInitialParams){$super(),this.setGlyphClass(glyphClass),this.setGlyphRefLength(glyphRefLength||1),this.setGlyphInitialParams(glyphInitialParams)},initProperties:function(){this.defineProp("glyphRefLength",{dataType:DataType.FLOAT}),this.defineProp("glyphClass",{dataType:DataType.CLASS,serializable:!1}),this.defineProp("glyphInitialParams",{dataType:DataType.HASH})},getAvailableCoordModes:function(){return Kekule.CoordMode.COORD2D},doGetRefLength:function(){return this.getGlyphRefLength()},createObjects:function(targetObj){var glyph=this.generateGlyph(),baseCoord={x:0,y:0};return{objects:[glyph],mergeObj:null,mergeDest:null,baseObjCoord:baseCoord,centerCoord:baseCoord}},generateGlyph:function(){return new(this.getGlyphClass())(null,this.getGlyphRefLength(),this.getGlyphInitialParams())}}),Kekule.Editor.RepositoryItemManager={_itemClassMap:new Kekule.MapEx(!0),_itemNameMap:new Kekule.MapEx(!0),getAllItems:function(repClass){return RM._itemClassMap.get(repClass)},getItem:function(name){return RM._itemNameMap.get(name)},register:function(repItem){var replacedItem,name=repItem.getName();name&&(replacedItem=RM.getItem(),RM._itemNameMap.set(name,repItem));var repClass=repItem.getClass(),items=RM.getAllItems(repClass);items?replacedItem?Kekule.ArrayUtils.replace(items,replacedItem,repItem):Kekule.ArrayUtils.pushUnique(items,repItem):(items=[repItem],RM._itemClassMap.set(repClass,items))},unregister:function(repItem){var repClass=repItem.getClass(),items=RM.getAllItems(repClass);items&&Kekule.ArrayUtils.remove(items,repItem);var name=repItem.getName();name&&RM._itemNameMap.remove(name)}};var RM=Kekule.Editor.RepositoryItemManager;return Kekule._registerAfterLoadProc(function(){if(Kekule.Editor.RepositoryData){for(var data=Kekule.Editor.RepositoryData.subGroups||[],i=0,l=data.length;i<l;++i){var detail=data[i],repItem=new Kekule.Editor.StoredSubgroupRepositoryItem2D(detail.structData,detail.dataFormat,detail.scale);repItem.setInputTexts(detail.inputTexts).setName(detail.name||detail.inputTexts[0]),RM.register(repItem)}for(var data=Kekule.Editor.RepositoryData.fragments||[],i=0,l=data.length;i<l;++i){var detail=data[i],repItem=new Kekule.Editor.StoredStructFragmentRepositoryItem2D(detail.structData,detail.dataFormat,detail.scale);repItem.setName(detail.name),RM.register(repItem)}}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,ClassEx=__webpack_require__(0).ClassEx,DataType=__webpack_require__(0).DataType;module.exports=function(Kekule){var AU=Kekule.ArrayUtils,CCNS=Kekule.ChemWidget.HtmlClassNames;Kekule.ChemWidget.HtmlClassNames=Object.extend(Kekule.ChemWidget.HtmlClassNames,{CHEMSPACE_EDITOR:"K-Chem-Space-Editor",CHEMSPACE_EDITOR2D:"K-Chem-Space-Editor2D",CHEMSPACE_EDITOR3D:"K-Chem-Space-Editor3D",CHEMEDITOR_TEXT_SETTER:"K-ChemEditor-Text-Setter",CHEMEDITOR_FORMULA_SETTER:"K-ChemEditor-Formula-Setter"}),Kekule.Editor.ChemSpaceEditor=Class.create(Kekule.Editor.BaseEditor,{CLASS_NAME:"Kekule.Editor.ChemSpaceEditor",initialize:function($super,parentOrElementOrDocument,chemObj,renderType,editorConfigs){this.setPropStoreFieldValue("allowCreateNewChild",!0),this.setPropStoreFieldValue("autoCreateNewStructFragment",!0),$super(parentOrElementOrDocument,chemObj,renderType,editorConfigs),this._containerChemSpace=null},initProperties:function(){this.defineProp("chemSpace",{dataType:"Kekule.ChemSpace",serializable:!1,getter:function(){return this.getChemObj()},setter:function(value){this.setChemObj(value)}}),this.defineProp("defBondLength",{dataType:DataType.FLOAT,serializable:!1,getter:function(){var result=this.getPropStoreFieldValue("defBondLength");return result||(result=this.getEditorConfigs().getStructureConfigs().getDefBondLength()),result}}),this.defineProp("autoCreateNewStructFragment",{dataType:DataType.BOOL,getter:function(){return this.getPropStoreFieldValue("autoCreateNewStructFragment")&&this.canCreateNewChild()}}),this.defineProp("allowCreateNewChild",{dataType:DataType.BOOL})},canCreateNewChild:function(){return this.getChemSpace()&&(this.getAllowCreateNewChild()||this.getChemSpace().getChildCount()<=0)},getActualDrawOptions:function($super){var result=$super();return result.useExplicitSpaceSize=!0,result},doSetChemObj:function($super,value){var old=this.getChemObj();if(old!==value)if(old&&this._containerChemSpace&&(old.finalize(),this._containerChemSpace=null),value){if(value instanceof Kekule.ChemSpace)return this._initChemSpaceDefProps(value),$super(value);var space=this.createContainerChemSpace(null,value);this._containerChemSpace=space,$super(space)}else $super(value);else $super(value)},getExportableClasses:function($super){var result=$super(),space=this.getChemSpace();if(space)for(var i=0,l=space.getChildCount();i<l;++i){var obj=space.getChildAt(i);obj&&obj.getClass&&Kekule.ArrayUtils.pushUnique(result,obj.getClass())}return result},exportObjs:function($super,objClass){var result=$super(objClass);if((!result||!result.length)&&objClass){result=[];var space=this.getChemSpace();if(space)for(var i=0,l=space.getChildCount();i<l;++i){var obj=space.getChildAt(i);obj&&obj instanceof objClass&&result.push(obj)}}return result},getSavingTargetObj:function($super){var space=this.getChemSpace();return 1===space.getChildCount()?space.getChildAt(0):$super()},createDefaultConfigs:function(){return Kekule.Editor.ChemSpaceEditorConfigs.getInstance()},doCreateNewDocObj:function(){return this.createContainerChemSpace()},doLoad:function($super,chemObj){this._supplyChemMarkersOnObj(chemObj),$super(chemObj)},doLoadEnd:function($super,chemObj){var result=$super(chemObj),defBondLength=null;if(chemObj){var connectors=chemObj.getAllContainingConnectors();if(connectors&&connectors.length){var coordMode=this.getRenderType()===Kekule.Render.RendererType.R3D?Kekule.CoordMode.COORD3D:Kekule.CoordMode.COORD2D;defBondLength=Kekule.ChemStructureUtils.getConnectorLengthMedian(connectors,coordMode,this.getAllowCoordBorrow())}}this.setDefBondLength(defBondLength);var space=this.getChemObj();if(space){var screenSize=space.getScreenSize();this.changeClientSize(screenSize.x,screenSize.y,this.getCurrZoom());var elem=this.getEditClientElem().parentNode,visibleClientSize=Kekule.HtmlElementUtils.getElemClientDimension(elem);this.scrollClientTo(0,(screenSize.x-visibleClientSize.width)/2)}return result},zoomChanged:function($super,zoomLevel){$super();var space=this.getChemObj();if(space){var screenSize=space.getScreenSize();this.changeClientSize(screenSize.x,screenSize.y,zoomLevel)}},createNewBoundInfoRecorder:function($super,renderer){$super(renderer);var recorder=this.getBoundInfoRecorder();recorder&&recorder.addEventListener("updateBasicDrawObject",this.reactUpdateBasicDrawObject,this)},reactUpdateBasicDrawObject:function(e){var obj=e.obj;if(obj&&obj instanceof Kekule.TextBlock){var boundInfo=e.boundInfo;this.updateTextBlockSize(obj,boundInfo)}},objectChanged:function($super,obj,changedPropNames){return $super(obj,changedPropNames)},updateTextBlockSize:function(textBlock,boundInfo){if(this.getCoordMode()===Kekule.CoordMode.COORD2D&&textBlock.getNeedRecalcSize()){boundInfo.shapeType;Kekule.Render.BoundShapeType.RECT}},createContainerChemSpace:function(id,containingChemObj){var result=new Kekule.ChemDocument(id);if(this._initChemSpaceDefProps(result,containingChemObj),containingChemObj){result.appendChild(containingChemObj);var coord,ratio,spaceSize=result.getSizeOfMode(this.getCoordMode(),this.getAllowCoordBorrow()),objBox=Kekule.Render.ObjUtils.getContainerBox(containingChemObj,this.getCoordMode(),this.getAllowCoordBorrow());if(this.getCoordMode()===Kekule.CoordMode.COORD2D)var padding=this.getEditorConfigs().getChemSpaceConfigs().getDefPadding(),ratio=result.getObjScreenLengthRatio();var oldObjCoord=containingChemObj.getAbsBaseCoord?containingChemObj.getAbsBaseCoord(this.getCoordMode(),this.getAllowCoordBorrow())||{}:{};if(ratio&&objBox){coord=Kekule.CoordUtils.divide(spaceSize,2);var objBoxCenter={x:(objBox.x1+objBox.x2)/2,y:(objBox.y1+objBox.y2)/2},newObjCenter={x:coord.x,y:spaceSize.y-padding*ratio-(objBox.y2-objBox.y1)/2},centerDelta=Kekule.CoordUtils.substract(newObjCenter,objBoxCenter);coord=Kekule.CoordUtils.add(oldObjCoord,centerDelta)}else coord=Kekule.CoordUtils.divide(spaceSize,2);containingChemObj.setAbsBaseCoord&&containingChemObj.setAbsBaseCoord(coord,this.getCoordMode())}return result},_initChemSpaceDefProps:function(chemSpace,containingChemObj){var configs=this.getEditorConfigs(),chemSpaceConfigs=configs.getChemSpaceConfigs();if(this.getCoordMode()===Kekule.CoordMode.COORD2D){var screenSize=chemSpace.getScreenSize();if(screenSize.x||screenSize.y||(screenSize=chemSpaceConfigs.getDefScreenSize2D(),chemSpace.setScreenSize(screenSize)),!chemSpace.getDefAutoScaleRefLength()){var refLength;if(containingChemObj&&containingChemObj.getAllAutoScaleRefLengths){var refLengths=containingChemObj.getAllAutoScaleRefLengths(this.getCoordMode(),this.getAllowCoordBorrow());refLength=refLengths&&refLengths.length?Kekule.ArrayUtils.getMedian(refLengths):null}else{var refLengths=chemSpace.getAllAutoScaleRefLengths(this.getCoordMode(),this.getAllowCoordBorrow());refLength=refLengths.length?Kekule.ArrayUtils.getMedian(refLengths):null}refLength||(refLength=configs.getStructureConfigs().getDefBondLength()),chemSpace.setDefAutoScaleRefLength(refLength)}if(!chemSpace.getSize2D()){var refScreenLength=this.getRenderConfigs().getLengthConfigs().getDefBondLength(),ratio=chemSpace.getDefAutoScaleRefLength()/refScreenLength;chemSpace.setObjScreenLengthRatio(ratio),chemSpace.setSize2D({x:screenSize.x*ratio,y:screenSize.y*ratio})}}},createNewStructFragmentAnchor:function(id){if(this.getAutoCreateNewStructFragment()){var result=new Kekule.Molecule(id);return this.getChemSpace().appendChild(result),result}return null},createStructStartingAtom:function(parentMol,id,absCoord,isotopeId){this.beginUpdateObject();try{if(parentMol){isotopeId||(isotopeId=this.getEditorConfigs().getStructureConfigs().getDefIsotopeId());var initialNode=new Kekule.Atom(null,isotopeId);return parentMol.appendNode(initialNode),initialNode.setAbsCoordOfMode(absCoord,this.getCoordMode()),initialNode}return null}finally{this.endUpdateObject()}},createNewStructFragmentAndStartingAtom:function(id,absCoord,isotopeId){this.beginUpdateObject();try{var struct;return struct=this.createNewStructFragmentAnchor(id),struct?this.createStructStartingAtom(struct,id,absCoord,isotopeId):null}finally{this.endUpdateObject()}},hasOnlyOneBlankStructFragment:function(){var result=!1;if(1===this.getChemSpace().getChildCount()){var obj=this.getChemSpace().getChildAt(0);obj instanceof Kekule.StructureFragment&&obj.getNodeCount()<=0&&obj.getConnectorCount()<=0&&!obj.hasFormula()&&(result=!0)}return result},getOnlyOneBlankStructFragment:function(){if(this.hasOnlyOneBlankStructFragment())return this.getChemSpace().getChildAt(0)},canAddNewStandaloneObject:function(){return this.getAllowCreateNewChild()||this.getChemSpace().getChildCount()<=0},canAddUnconnectedStructFragment:function(){return this.canAddNewStandaloneObject()||this.hasOnlyOneBlankStructFragment()},canCloneObjects:function(){return this.getAllowCreateNewChild()},cloneObjects:function(objects,screenCoordOffset,addToSpace){if(!this.getChemSpace())return null;for(var allowAddToSpace=this.getAllowCreateNewChild(),isParentOfOneObj=function(obj,childObjs){for(var i=0,l=childObjs.length;i<l;++i){if(childObjs[i].isChildOf(obj))return!0}return!1},targetObjs=Kekule.ArrayUtils.toArray(objects),standAloneObjs=[],childObjMap=new Kekule.MapEx,i=0,l=targetObjs.length;i<l;++i){var obj=targetObjs[i],standAloneObj=obj.getStandaloneAncestor?obj.getStandaloneAncestor():obj;if(standAloneObj.clone){Kekule.ArrayUtils.pushUnique(standAloneObjs,standAloneObj);var mapItem=childObjMap.get(standAloneObj);mapItem||(mapItem=[],childObjMap.set(standAloneObj,mapItem)),mapItem.push(obj)}}for(var space=this.getChemSpace(),clonedObjs=[],standAloneObjCount=(this.getCoordMode(),this.getAllowCoordBorrow(),standAloneObjs.length),i=0;i<standAloneObjCount;++i){var obj=standAloneObjs[i],clonedObj=obj.clone();if(clonedObj.clearIds&&clonedObj.clearIds(),function removeUnessentialChildren(rootObj,refObj,reservedChildObjs){if(reservedChildObjs.indexOf(refObj)>=0)return void AU.remove(reservedChildObjs,refObj);if(rootObj.getChildAt&&refObj.getChildAt)for(var refChildObjCount=refObj.getChildCount(),i=refChildObjCount-1;i>=0;--i){var o=rootObj.getChildAt(i);if(reservedChildObjs.length){var refChildObj=refObj.getChildAt(i);reservedChildObjs.indexOf(refChildObj)>=0?AU.remove(reservedChildObjs,refChildObj):isParentOfOneObj(refChildObj,reservedChildObjs)?refChildObj.getChildObjs&&removeUnessentialChildren(o,refChildObj,reservedChildObjs):rootObj.removeChild(o)}else rootObj.removeChild(o)}}(clonedObj,obj,childObjMap.get(obj)),addToSpace&&allowAddToSpace&&(space.appendChild(clonedObj),screenCoordOffset)){var coord=this.getObjectScreenCoord(clonedObj),newCoord=Kekule.CoordUtils.add(coord,screenCoordOffset);this.setObjectScreenCoord(clonedObj,newCoord)}clonedObjs.push(clonedObj)}return childObjMap.finalize(),clonedObjs},cloneSelection:function(coordOffset,addToSpace){void 0===coordOffset&&(coordOffset=this.getDefaultCloneScreenCoordOffset());var objs=this.getSelection(),clonedObjs=this.cloneObjects(objs,coordOffset,addToSpace);return addToSpace&&this.setSelection(clonedObjs),clonedObjs},getDefaultCloneScreenCoordOffset:function(){var screenOffset=this.getEditorConfigs().getInteractionConfigs().getClonedObjectScreenOffset()||0,coordMode=this.getCoordMode(),coordOffset={x:screenOffset,y:screenOffset};return coordMode===Kekule.CoordMode.COORD3D&&(coordOffset.z=screenOffset),coordOffset},_supplyChemMarkersOnObj:function(chemObj){if(chemObj){var structFragments=Kekule.ChemStructureUtils.getAllStructFragments(chemObj,!0);if(structFragments||structFragments.length)for(var i=0,l=structFragments.length;i<l;++i)this._createLosingChemMarkerOnStructFragment(structFragments[i])}},_createLosingChemMarkerOnStructFragment:function(mol){mol.beginUpdate();try{mol.getCharge&&mol.getCharge()&&mol.fetchChargeMarker(!0);for(var i=(mol.getNodes(),0),l=mol.getNodeCount();i<l;++i){var node=mol.getNodeAt(i);node.beginUpdate();try{node.getCharge()&&node.fetchChargeMarker(!0),node.getRadical()&&node.fetchRadicalMarker(!0),node.getNodeAt&&this._createChargeAndRadicalMarkerOnStructFragment(node)}finally{node.endUpdate()}}}finally{mol.endUpdate()}}}),Kekule.Editor.ChemSpaceEditor.Settings=Class.create(Kekule.Editor.BaseEditor.Settings,{CLASS_NAME:"Kekule.Editor.ChemSpaceEditor.Settings",initProperties:function(){this.defineProp("allowCreateNewChild",{dataType:DataType.BOOL,serializable:!1,getter:function(){return this.getEditor().getAllowCreateNewChild()},setter:function(value){this.getEditor().setAllowCreateNewChild(value)}})}}),Kekule.Editor.BasicMolEraserIaController=Class.create(Kekule.Editor.BasicEraserIaController,{CLASS_NAME:"Kekule.Editor.BasicMolEraserIaController",initialize:function($super,widget){$super(widget)},doGetActualRemovedObjs:function(objs){var result=[];Kekule.ArrayUtils.pushUnique(result,objs);for(var i=0,l=objs.length;i<l;++i){var delObjs=objs[i].getCascadeDeleteObjs?objs[i].getCascadeDeleteObjs():[];delObjs&&Kekule.ArrayUtils.pushUnique(result,delObjs)}return result},doRemoveObjs:function(objs){if(objs.length){for(var operGroup=new Kekule.MacroOperation,molParents=[],i=0,l=objs.length;i<l;++i){var oper,obj=objs[i],editor=(obj.getParent(),this.getEditor());obj instanceof Kekule.BaseStructureNode?(oper=new Kekule.ChemStructOperation.RemoveNode(obj),Kekule.ArrayUtils.pushUnique(molParents,obj.getParent())):obj instanceof Kekule.BaseStructureConnector?(oper=new Kekule.ChemStructOperation.RemoveConnector(obj),Kekule.ArrayUtils.pushUnique(molParents,obj.getParent())):oper=new Kekule.ChemObjOperation.Remove(obj),oper&&operGroup.add(oper)}for(var i=0,l=molParents.length;i<l;++i){var mol=molParents[i];if(mol&&mol instanceof Kekule.StructureFragment){var standardizeOper=new Kekule.ChemStructOperation.StandardizeStructFragment(mol);standardizeOper.setEnableSplit(this.getEditor().canCreateNewChild()),operGroup.add(standardizeOper)}}operGroup.execute(),editor&&editor.getEnableOperHistory()&&editor.pushOperation(operGroup)}}}),Kekule.Editor.IaControllerManager.register(Kekule.Editor.BasicMolEraserIaController,Kekule.Editor.ChemSpaceEditor),Kekule.Editor.BasicMolManipulationIaController=Class.create(Kekule.Editor.BasicManipulationIaController,{CLASS_NAME:"Kekule.Editor.BasicMolManipulationIaController",initialize:function($super,editor){$super(editor),this.setEnableMagneticMerge(!0),this.setEnableNodeMerge(!0),this.setEnableNeighborNodeMerge(!0),this.setEnableConnectorMerge(!0),this.setEnableStructFragmentMerge(!0),this.setEnableConstrainedMove(!0),this.setEnableConstrainedRotate(!0),this.setEnableDirectedMove(!0),this._suppressConstrainedMoving=!1,this._suppressConstrainedRotating=!1,this._isInDirectedMoving=!1,this._directedMovingDirection=null},initProperties:function(){this.defineProp("enableMagneticMerge",{dataType:DataType.BOOL}),this.defineProp("enableNodeMerge",{dataType:DataType.BOOL}),this.defineProp("enableNeighborNodeMerge",{dataType:DataType.BOOL}),this.defineProp("enableConnectorMerge",{dataType:DataType.BOOL}),this.defineProp("enableStructFragmentMerge",{dataType:DataType.BOOL}),this.defineProp("allManipulateObjsMerged",{dataType:DataType.BOOL,serializable:!1}),this.defineProp("isMergeDone",{dataType:DataType.BOOL,serializable:!1}),this.defineProp("enableConstrainedMove",{dataType:DataType.BOOL,serializable:!1}),this.defineProp("enableConstrainedRotate",{dataType:DataType.BOOL,serializable:!1}),this.defineProp("enableDirectedMove",{dataType:DataType.BOOL,serializable:!1}),this.defineProp("mergeOperations",{dataType:DataType.ARRAY,serializable:!1}),this.defineProp("mergingDests",{dataType:DataType.ARRAY,serializable:!1})},canInteractWithObj:function($super,obj){return $super(obj)||this._isMerging&&obj},doSetManipulateObjs:function($super,value){var objs=value?AU.clone(value):[];this.getMergingDests()&&AU.pushUnique(objs,this.getMergingDests()),this.setPropStoreFieldValue("manipulateObjs",value),value?this.getEditor().prepareOperatingObjs(objs):this.getEditor().endOperatingObjs()},isConstrainedMove:function(){if(!this.getEnableConstrainedMove())return!1;var objs=this.getManipulateObjs();if(1===objs.length){var obj=objs[0],selection=this.getEditor().getSelection();if(selection&&selection.indexOf(obj)<0)return obj.getConstraintManipulationBaseObj&&obj.getConstraintManipulationBaseObj()}return!1},isConstrainedRotate:function(){return this.getEnableConstrainedMove()},isDirectedMove:function(){return this.getEnableDirectedMove()&&!this.isConstrainedMove()&&this._isInDirectedMoving},createManipulateObjInfo:function($super,obj,startContextCoord){var editor=this.getEditor(),info=$super(obj,startContextCoord);if(this.isConstrainedMove()){var stubObj=obj.getConstraintManipulationBaseObj();if(stubObj&&(info.isConstrained=!0,!info.hasNoCoord)){info.originScreenCoord=editor.getObjectScreenCoord(obj),info.refScreenCoord=editor.getObjectScreenCoord(stubObj),info.connectorScreenLength=Kekule.CoordUtils.getDistance(info.screenCoord,info.refScreenCoord),info.connectorObjLength=Kekule.CoordUtils.getDistance(editor.getObjCoord(obj),editor.getObjCoord(stubObj));var delta=Kekule.CoordUtils.substract(info.originScreenCoord,info.refScreenCoord);info.originBondDirectionAngle=Math.atan2(delta.y,delta.x),info.constrainedBondDirectionDelta=this.getEditorConfigs().getStructureConfigs().getBondConstrainedDirectionDelta(),info.constrainedBondDirectionAngles=this.getEditorConfigs().getStructureConfigs().getBondConstrainedDirectionAngles(),info.constrainedBondDirectionAngleThreshold=this.getEditorConfigs().getStructureConfigs().getBondConstrainedDirectionAngleThreshold()}}return info},_calcActualMovedScreenCoord:function($super,obj,info,newScreenCoord){var result,C=Kekule.CoordUtils,screenCoord=newScreenCoord;if(info.isConstrained&&!this._suppressConstrainedMoving){var directionAngle,constrainedBondDirectionDelta=info.constrainedBondDirectionDelta||null,constrainedBondDirectionAngles=info.constrainedBondDirectionAngles||null,constrainedBondDirectionAngleThreshold=info.constrainedBondDirectionAngleThreshold||null,directionAngleResolved=!1,currVector=C.substract(newScreenCoord,info.refScreenCoord),currDirection=Math.atan2(currVector.y,currVector.x);if(constrainedBondDirectionAngles&&constrainedBondDirectionAngleThreshold)for(var i=0,l=constrainedBondDirectionAngles.length;i<l;++i){var dAngle=constrainedBondDirectionAngles[i];Math.abs(dAngle-currDirection)<=constrainedBondDirectionAngleThreshold&&(directionAngleResolved=!0,directionAngle=dAngle)}if(!directionAngleResolved&&constrainedBondDirectionDelta){var step=Math.round((currDirection-info.originBondDirectionAngle)/constrainedBondDirectionDelta);directionAngle=info.originBondDirectionAngle+step*constrainedBondDirectionDelta,directionAngleResolved=!0}directionAngleResolved||(directionAngle=currDirection),result=C.add(info.refScreenCoord,{x:info.connectorScreenLength*Math.cos(directionAngle),y:info.connectorScreenLength*Math.sin(directionAngle)})}else result=screenCoord;return result},_calcActualRotateAngle:function($super,objs,newDeltaAngle,oldAbsAngle,newAbsAngle){var isConstrained=this.isConstrainedRotate()&&!this._suppressConstrainedRotating,angleStep=isConstrained?this.getEditorConfigs().getInteractionConfigs().getConstrainedRotateStep():null;if(angleStep){return Math.floor(newDeltaAngle/angleStep)*angleStep}return $super(objs,newDeltaAngle,oldAbsAngle,newAbsAngle)},prepareManipulating:function($super,manipulationType,manipulatingObjs,startScreenCoord,startBox,rotateCenter){this.setMergeOperations([]),$super(manipulationType,manipulatingObjs,startScreenCoord,startBox,rotateCenter),this._directedMovingDirection=null,this.setManuallyHotTrack(!0)},stopManipulate:function($super){$super(),this.setManuallyHotTrack(!1)},cancelManipulatingObjs:function($super){$super(),this.setManuallyHotTrack(!1)},createManipulateOperation:function($super){$super(),this.setMergeOperations([])},getAllObjOperations:function($super){var result=$super()||[],mergeOpers=this.getMergeOperations();return mergeOpers&&mergeOpers.length&&Kekule.ArrayUtils.pushUnique(result,mergeOpers),result},_canMergeNodes:function(targetNode,destNode){var allowMolMerge=this.getEnableStructFragmentMerge(),allowNeighborNodeMerge=this.getEnableNeighborNodeMerge();return!!this.getEnableNodeMerge()&&Kekule.ChemStructOperation.MergeNodes.canMerge(targetNode,destNode,allowMolMerge,allowNeighborNodeMerge)},_canMergeConnectors:function(targetConnector,destConnector){var allowMolMerge=this.getEnableStructFragmentMerge();return!!this.getEnableConnectorMerge()&&Kekule.ChemStructOperation.MergeConnectors.canMerge(targetConnector,destConnector,allowMolMerge)},_findSuitableMergeTargetBoundInfo:function(boundInfos,excludedObjs,targetClass,checkFunc){for(var i=boundInfos.length-1;i>=0;--i){var info=boundInfos[i],obj=info.obj;if(!(excludedObjs.indexOf(obj)>=0)&&(obj instanceof targetClass&&(!checkFunc||checkFunc(obj))))return info}return null},_getMagneticNodeMergeDest:function(node,nodeScreenCoord,excludedObjs){var editor=this.getEditor(),self=this,filterFunc=function(bound){var obj=bound.obj;return node!==obj&&excludedObjs.indexOf(obj)<0&&obj instanceof Kekule.ChemStructureNode&&self._canMergeNodes(node,obj)};if(nodeScreenCoord){var boundInfos=editor.getBoundInfosAtCoord(nodeScreenCoord,filterFunc),overlapBoundInfo=boundInfos.length?boundInfos[boundInfos.length-1]:null;return overlapBoundInfo?overlapBoundInfo.obj:null}return null},moveManipulatedObjs:function($super,endScreenCoord){var actualEndCoord;if(this.isDirectedMove()){var C=Kekule.CoordUtils,startCoord=this.getStartCoord(),distance=C.getDistance(startCoord,endScreenCoord),delta=C.substract(endScreenCoord,startCoord),directedDirection=this._directedMovingDirection;this._directedMovingDirection||(directedDirection=Math.abs(delta.x)>=Math.abs(delta.y)?"x":"y",distance<this.getEditor().getEditorConfigs().getInteractionConfigs().getDirectedMoveDistanceThreshold()||(this._directedMovingDirection=directedDirection)),actualEndCoord=Object.extend({},startCoord),actualEndCoord[directedDirection]=endScreenCoord[directedDirection]}else actualEndCoord=endScreenCoord;return $super(actualEndCoord)},applyManipulatingObjsInfo:function($super,endScreenCoord){this.setAllManipulateObjsMerged(!1);var editor=this.getEditor();editor.hotTrackOnObj(null);var MT=Kekule.Editor.BasicManipulationIaController.ManipulationType,manipulateType=this.getManipulationType(),originManipulatedObjs=this.getManipulateOriginObjs(),manipulatedObjs=this.getManipulateObjs(),excludedObjs=[].concat(originManipulatedObjs);Kekule.ArrayUtils.pushUnique(excludedObjs,manipulatedObjs);var oldMergeOpers=this.getMergeOperations(),self=this,objCanBeMerged=function(obj){return!(obj instanceof Kekule.StructureFragment)&&(obj instanceof Kekule.ChemStructureNode||obj instanceof Kekule.ChemStructureConnector)},isMovingOneBond=1===originManipulatedObjs.length&&originManipulatedObjs[0]instanceof Kekule.ChemStructureConnector,isMovingOneNode=1===manipulatedObjs.length&&manipulatedObjs[0]instanceof Kekule.ChemStructureNode&&objCanBeMerged(manipulatedObjs[0]);if(!isMovingOneBond&&this.getEnableMagneticMerge()){for(var currManipulateInfoMap=this.getManipulateObjCurrInfoMap(),manipulateInfoMap=this.getManipulateObjInfoMap(),self=this,magneticMergeObjIndexes=[],magneticMergeObjs=[],magneticMergeDests=[],i=0,l=manipulatedObjs.length;i<l;++i){var obj=manipulatedObjs[i];if(objCanBeMerged(obj)){var currInfo=currManipulateInfoMap.get(obj),currCoord=currInfo.screenCoord;if(currCoord){var boundInfos=editor.getBoundInfosAtCoord(currCoord),mergeDest=this._getMagneticNodeMergeDest(obj,currCoord,excludedObjs);mergeDest&&(magneticMergeObjIndexes.push(i),magneticMergeObjs.push(obj),magneticMergeDests.push(mergeDest))}}}if(magneticMergeObjs.length){var mergedObjCount=magneticMergeObjs.length;this.setAllManipulateObjsMerged(mergedObjCount===manipulatedObjs.length);var needCreateNewMerge=mergedObjCount<=1;if(!needCreateNewMerge)for(var i=0,l=magneticMergeObjs.length;i<l;++i){var obj=magneticMergeObjs[i],dest=magneticMergeDests[i],index=magneticMergeObjIndexes[i],oldMergeOper=oldMergeOpers[index];if(!oldMergeOper||!this.isSameNodeMerge(oldMergeOper,obj,dest)){needCreateNewMerge=!0;break}}if(needCreateNewMerge){this.reverseMergeOpers();var CU=Kekule.CoordUtils;if(1===mergedObjCount||editor.getCoordMode()===Kekule.CoordMode.COORD3D){for(var currInfo=currManipulateInfoMap.get(magneticMergeObjs[0]),currCoord=currInfo.screenCoord,destCoord=editor.getObjectScreenCoord(magneticMergeDests[0]),coordTranslate=CU.substract(destCoord,currCoord),needReApply=!1,i=0,l=manipulatedObjs.length;i<l;++i){var obj=manipulatedObjs[i];if(obj!==magneticMergeObjs[0]){var info=currManipulateInfoMap.get(obj);if(info.screenCoord){var newCoord=CU.add(info.screenCoord,coordTranslate);info.screenCoord=newCoord,this._getMagneticNodeMergeDest(obj,newCoord,excludedObjs)&&(needReApply=!0)}}}if(needReApply)return this.applyManipulatingObjsInfo(endScreenCoord);for(var i=0,l=manipulatedObjs.length;i<l;++i){var obj=manipulatedObjs[i];if(obj!==magneticMergeObjs[0]){var info=currManipulateInfoMap.get(obj);this.applySingleManipulatingObjInfo(i,obj,info,endScreenCoord)}}}else if(mergedObjCount>1&&editor.getCoordMode()!==Kekule.CoordMode.COORD3D){for(var obj0=magneticMergeObjs[0],obj1=magneticMergeObjs[1],coordObj0=manipulateInfoMap.get(obj0).screenCoord,coordObj1=manipulateInfoMap.get(obj1).screenCoord,coordDest0=editor.getObjectScreenCoord(magneticMergeDests[0]),coordDest1=editor.getObjectScreenCoord(magneticMergeDests[1]),transParam=CU.calcCoordGroup2DTransformParams(coordObj0,coordObj1,coordDest0,coordDest1),matrix=CU.calcTransform2DMatrix(transParam),needReApply=!1,i=0,l=manipulatedObjs.length;i<l;++i){var obj=manipulatedObjs[i];if(magneticMergeObjs.indexOf(obj)<0){var info=manipulateInfoMap.get(obj),currInfo=currManipulateInfoMap.get(obj);if(info.screenCoord){var newCoord=CU.transform2DByMatrix(info.screenCoord,matrix);currInfo.screenCoord=newCoord,this._getMagneticNodeMergeDest(obj,newCoord,excludedObjs)&&(needReApply=!0)}info.size&&(currInfo.size=CU.multiply(info.size,transParam.scale))}}if(needReApply)return this.applyManipulatingObjsInfo(endScreenCoord);for(var i=0,l=manipulatedObjs.length;i<l;++i){var obj=manipulatedObjs[i];if(magneticMergeObjs.indexOf(obj)<0){var currInfo=currManipulateInfoMap.get(obj);this.applySingleManipulatingObjInfo(i,obj,currInfo,endScreenCoord)}}}for(var i=0,l=mergedObjCount;i<l;++i){var obj=magneticMergeObjs[i],dest=magneticMergeDests[i],index=magneticMergeObjIndexes[i],mergeOper=this.createNodeMergeOperation(obj,dest);this.getMergeOperations()[index]=mergeOper}this.executeMergeOpers()}return void editor.hotTrackOnObj(magneticMergeDests)}}if(manipulateType===MT.MOVE){if(isMovingOneBond&&this.getEnableConnectorMerge()||isMovingOneNode&&this.getEnableNodeMerge()){var boundInfos=editor.getBoundInfosAtCoord(endScreenCoord),targetClass=isMovingOneBond?Kekule.ChemStructureConnector:Kekule.ChemStructureNode,targetObj=isMovingOneBond?originManipulatedObjs[0]:manipulatedObjs[0],checkFunc=isMovingOneBond?function(obj){return self._canMergeConnectors(targetObj,obj)}:function(obj){return self._canMergeNodes(targetObj,obj)},overlapBoundInfo=this._findSuitableMergeTargetBoundInfo(boundInfos,excludedObjs,targetClass,checkFunc);if(overlapBoundInfo){var destObj=overlapBoundInfo.obj;if(destObj){this.setAllManipulateObjsMerged(!0),editor.hotTrackOnObj(destObj);var oldMergeOper=oldMergeOpers[0];if(isMovingOneBond&&this.isSameConnectorMerge(oldMergeOper,targetObj,destObj)||isMovingOneNode&&this.isSameNodeMerge(oldMergeOper,targetObj,destObj))return;oldMergeOper&&this.reverseMergeOpers();var mergeOper=isMovingOneBond?this.createConnectorMergeOperation(targetObj,destObj):this.createNodeMergeOperation(targetObj,destObj);return this.getMergeOperations()[0]=mergeOper,void this.executeMergeOpers()}}}}this.reverseMergeOpers(),$super(endScreenCoord)},doMoveManipulatedObj_old:function($super,objIndex,obj,newScreenCoord,moverScreenCoord){var editor=this.getEditor(),info=this.getManipulateObjInfoMap().get(obj),actualNewScreenCoord=newScreenCoord,manipulatedObjs=this.getManipulateOriginObjs(),manipulateType=this.getManipulationType(),isMovingBond=manipulateType===Kekule.Editor.BasicManipulationIaController.ManipulationType.MOVE&&1===manipulatedObjs.length&&manipulatedObjs[0]instanceof Kekule.ChemStructureConnector,coord=actualNewScreenCoord,mergeOper=null,mergeOpers=this.getMergeOperations(),oldMergeOper=mergeOpers[objIndex],currManipulatingObjs=this.getManipulateObjs();if(!isMovingBond&&this.getEnableMagneticMerge()&&obj instanceof Kekule.ChemStructureNode){var boundInfos=editor.getBoundInfosAtCoord(coord);if(boundInfos&&boundInfos.length){for(var i=boundInfos.length-1;i>=0;--i){var info=boundInfos[i],boundObj=info.obj;if(boundObj!==obj&&(!(currManipulatingObjs.indexOf(boundObj)>=0)&&boundObj instanceof Kekule.ChemStructureNode&&this._canMergeNodes(obj,boundObj))){if(editor.addHotTrackedObj(boundObj),this.isSameNodeMerge(oldMergeOper,obj,boundObj))return;mergeOper=this.createNodeMergeOperation(obj,boundObj);break}}mergeOper?(oldMergeOper&&this.reverseMergeOpers(objIndex),this.getMergeOperations()[objIndex]=mergeOper,this.executeMergeOpers()):editor.hotTrackOnObj(null)}}var coord=moverScreenCoord;if(manipulateType===Kekule.Editor.BasicManipulationIaController.ManipulationType.MOVE){var currObj=manipulatedObjs[0];if(manipulatedObjs&&1===manipulatedObjs.length){var boundItem=editor.getTopmostBoundInfoAtCoord(coord,[currObj]);if(boundItem){var destObj=boundItem.obj;if(destObj&&currManipulatingObjs.indexOf(destObj)<0){if(isMovingBond&&currObj instanceof Kekule.ChemStructureConnector&&destObj instanceof Kekule.ChemStructureConnector)this.getEnableConnectorMerge()&&(editor.hotTrackOnObj(destObj),(!!this.getEnableStructFragmentMerge()||currObj.getParent()===destObj.getParent())&&(mergeOper=this.createConnectorMergeOperation(currObj,destObj)));else if(currObj instanceof Kekule.ChemStructureNode&&destObj instanceof Kekule.ChemStructureNode&&this._canMergeNodes(currObj,destObj)){if(editor.hotTrackOnObj(destObj),this.isSameNodeMerge(oldMergeOper,currObj,destObj))return;mergeOper=this.createNodeMergeOperation(currObj,destObj)}if(mergeOper){var oldMergeOper=mergeOpers[objIndex];return oldMergeOper&&this.reverseMergeOpers(objIndex),this.getMergeOperations()[objIndex]=mergeOper,void this.executeMergeOpers()}}}}}if(!mergeOper){editor.hideHotTrack();/*!this._mergeReversed &&*/!!this.getMergeOperations().length&&this.reverseMergeOpers(objIndex),$super(objIndex,obj,newScreenCoord,moverScreenCoord)}},createNodeMergeOperation:function(fromNode,toNode){var allowMolMerge=this.getEnableStructFragmentMerge();if(Kekule.ChemStructOperation.MergeNodes.canMerge(fromNode,toNode,allowMolMerge,this.getEnableNeighborNodeMerge())){return new Kekule.ChemStructOperation.MergeNodes(fromNode,toNode,allowMolMerge)}return null},createConnectorMergeOperation:function(fromConnector,toConnector){var allowMolMerge=this.getEnableStructFragmentMerge();if(Kekule.ChemStructOperation.MergeConnectors.canMerge(fromConnector,toConnector,allowMolMerge)){return new Kekule.ChemStructOperation.MergeConnectors(fromConnector,toConnector,this.getEditor().getCoordMode(),allowMolMerge)}return null},isSameConnectorMerge:function(mergeOper,fromConnector,toConnector){return mergeOper&&mergeOper instanceof Kekule.ChemStructOperation.MergeConnectors&&fromConnector===mergeOper.getTarget()&&toConnector===mergeOper.getDest()},isSameNodeMerge:function(mergeOper,fromNode,toNode){return mergeOper&&mergeOper instanceof Kekule.ChemStructOperation.MergeNodes&&fromNode===mergeOper.getTarget()&&toNode===mergeOper.getDest()},executeMergeOpers:function(){for(var opers=Kekule.ArrayUtils.toUnique(this.getMergeOperations()),mergingDests=[],i=0,l=opers.length;i<l;++i)if(opers[i]){opers[i].execute();var dest=opers[i].getDest?opers[i].getDest():null;dest&&AU.pushUnique(mergingDests,dest)}this.setMergingDests(mergingDests.length?mergingDests:null),this.refreshManipulateObjs(),this._mergeJustReversed=!1},reverseMergeOpers:function(utilIndex){this.setMergingDests(null);var opers=Kekule.ArrayUtils.toUnique(this.getMergeOperations());if(opers&&opers.length){utilIndex||(utilIndex=0);for(var i=opers.length-1;i>=utilIndex;--i)opers[i]&&opers[i].reverse();this.getMergeOperations().length=utilIndex,this._mergeJustReversed=!0,this.refreshManipulateObjs()}else;},react_mousemove:function($super,e){return this._suppressConstrainedMoving=e.getAltKey(),this._suppressConstrainedRotating=e.getAltKey(),this._isInDirectedMoving=e.getShiftKey(),$super(e)}}),Kekule.Editor.IaControllerManager.register(Kekule.Editor.BasicMolManipulationIaController,Kekule.Editor.ChemSpaceEditor),Kekule.Editor.MolBondIaController=Class.create(Kekule.Editor.BasicMolManipulationIaController,{CLASS_NAME:"Kekule.Editor.MolBondIaController",initialize:function($super,editor){$super(editor),this.setState(BC.State.INITIAL),this.setBondOrder(Kekule.BondOrder.SINGLE),this.setAllowBondingToBond(!1),this.setEnableBondModification(!0),this.setEnableSelect(!1),this.setEnableMove(!0),this.setAutoSwitchBondOrder(!1),this.setEnableNeighborNodeMerge(!1)},initProperties:function(){this.defineProp("allowBondingToBond",{dataType:DataType.BOOL,serializable:!1}),this.defineProp("state",{dataType:DataType.INT,serializable:!1}),this.defineProp("enableBondModification",{dataType:DataType.BOOL,serializable:!1}),this.defineProp("autoSwitchBondOrder",{dataType:DataType.BOOL,serializable:!1}),this.defineProp("startingObj",{dataType:"Kekule.ChemStructureObject",serializable:!1}),this.defineProp("endingObj",{dataType:"Kekule.ChemStructureObject",serializable:!1}),this.defineProp("structFragment",{dataType:"Kekule.ChemStructureFragment",serializable:!1}),this.defineProp("autoCreatedStructFragment",{dataType:"Kekule.StructureFragment",serializable:!1}),this.defineProp("autoCreatedStartingObj",{dataType:"Kekule.ChemStructureObject",serializable:!1}),this.defineProp("bond",{dataType:"Kekule.Bond",serializable:!1}),this.defineProp("bondType",{dataType:DataType.STRING,serializable:!1}),this.defineProp("bondOrder",{dataType:DataType.INT,serializable:!1}),this.defineProp("bondStereo",{dataType:DataType.INT,serializable:!1}),this.defineProp("initialBondDirection",{dataType:DataType.FLOAT})},_isBondDifferent:function(bond){var stereo=this.getBondStereo(),BS=Kekule.BondStereo;return stereo===BS.UP||stereo===BS.UP_INVERTED||stereo===BS.DOWN||stereo===BS.DOWN_INVERTED||(bond.getBondType()!==this.getBondType()||bond.getBondOrder()!==this.getBondOrder()||bond.getStereo()!==this.getBondStereo())},canInteractWithObj:function($super,obj){if(this.getState()!==BC.State.INITIAL)return $super(obj);if(obj instanceof Kekule.ChemStructureNode)return!0;if(obj instanceof Kekule.ChemStructureConnector){if(this.getAllowBondingToBond())return!0;if(!this.getEnableBondModification())return!1;if(obj instanceof Kekule.Bond)return this._isBondDifferent(obj)}},doTestMouseCursor:function(coord,e){return""},isObjValidBondTerminator:function(obj){return!!obj&&(this.getAllowBondingToBond()?obj instanceof Kekule.ChemStructureNode||obj instanceof Kekule.ChemStructureConnector:obj instanceof Kekule.ChemStructureNode)},isBond:function(obj){return obj instanceof Kekule.Bond},getNewBondDefAngle:function(startObj,newBondOrder){return this.getEditorConfigs().getStructureConfigs().getNewBondDefAngle(startObj,newBondOrder)},addDefBond:function(startCoord,startObj,notifyEditor){var result,editor=this.getEditor();editor.beginUpdateObject();try{if(startObj)this.setAutoCreatedStartingObj(null),this.setAutoCreatedStructFragment(null);else{if(!this.getEditor().canAddUnconnectedStructFragment())return null;var objCoord=this.getEditor().screenCoordToObj(startCoord),baseMol=this.getEditor().getOnlyOneBlankStructFragment();baseMol?(startObj=this.getEditor().createStructStartingAtom(baseMol,null,objCoord),this.setAutoCreatedStructFragment(null),this.setAutoCreatedStartingObj(startObj)):(startObj=this.getEditor().createNewStructFragmentAndStartingAtom(null,objCoord),this.setAutoCreatedStartingObj(null),this.setAutoCreatedStructFragment(startObj?startObj.getParent():null))}if(this.isObjValidBondTerminator(startObj)){var editor=this.getEditor();this.setStartingObj(startObj);var parent=startObj.getParent();this.setStructFragment(parent);var structConfigs=this.getEditorConfigs().getStructureConfigs(),bondType=Kekule.oneOf(this.getBondType(),structConfigs.getDefBondType()),bondOrder=Kekule.oneOf(this.getBondOrder(),structConfigs.getDefBondOrder()),bondStereo=Kekule.oneOf(this.getBondStereo(),Kekule.BondStereo.NONE),bondLength=editor.getDefBondLength?editor.getDefBondLength():structConfigs.getDefBondLength(),defbondAngle=this.getNewBondDefAngle(startObj,bondOrder),endCoord=Kekule.Editor.StructureUtils.calcPreferred2DBondGrowingLocation(startObj,bondLength,defbondAngle,this.getEditor().getAllowCoordBorrow()),node=this.getEditor().createDefaultNode(endCoord,Kekule.Editor.CoordSys.OBJ,parent);this.setEndingObj(node);var bond=new Kekule.Bond;bond.setBondType(bondType),bond.setBondOrder(bondOrder),bond.setStereo(bondStereo),parent.appendConnector(bond),bond.appendConnectedObj(startObj),bond.appendConnectedObj(node),this.setBond(bond),notifyEditor&&this.getEditor().objectsChanged([bond,node]),result=endCoord}else result=null}finally{editor.endUpdateObject()}return result},addOperationToEditor:function($super){return $super()},getAllObjOperations:function($super){var result=$super()||[],op=this.getAddBondOperation();return op&&result.unshift(op),result},getAddBondOperation:function(){var group=new Kekule.MacroOperation,mol=(this.getEditor(),this.getAutoCreatedStructFragment());if(mol){var addMolOperation=new Kekule.ChemObjOperation.Add(mol,this.getEditor().getChemObj(),null);group.add(addMolOperation)}var startObj=this.getStartingObj(),endObj=this.getEndingObj(),bond=this.getBond(),parent=this.getStructFragment(),node=this.getAutoCreatedStartingObj();if(node){var addNodeOperation=new Kekule.ChemStructOperation.AddNode(node,parent);group.add(addNodeOperation)}var addNodeOperation=new Kekule.ChemStructOperation.AddNode(endObj,parent);group.add(addNodeOperation);var addConnectorOperation=new Kekule.ChemStructOperation.AddConnector(bond,parent,null,[startObj,endObj]);return group.add(addConnectorOperation),group},modifyBond:function(bond){var bondOrder,bondType=this.getBondType(),BO=Kekule.BondOrder,loopBondOrders=[BO.SINGLE,BO.DOUBLE,BO.TRIPLE];if(this.getAutoSwitchBondOrder()&&bondType===Kekule.BondType.COVALENT&&bond.getBondType===Kekule.BondType.COVALENT){var oldOrder=bond.getBondOrder(),index=loopBondOrders.indexOf(oldOrder);index=index>=0?++index%loopBondOrders.length:0,bondOrder=loopBondOrders[index]}else bondOrder=this.getBondOrder();var oldBondStereo=bond.getStereo(),bondStereo=this.getBondStereo();oldBondStereo===bondStereo&&(bondStereo=Kekule.BondStereo.getInvertedDirection(bondStereo));var newPropValues={bondType:bondType,bondOrder:bondOrder,stereo:bondStereo},needModify=!1;for(var prop in newPropValues){if(bond.getPropValue(prop)!==newPropValues[prop]){needModify=!0;break}}if(needModify){var editor=this.getEditor();editor.beginUpdateObject();try{var oper=new Kekule.ChemObjOperation.Modify(bond,newPropValues);oper.execute(),editor.pushOperation(oper);var changedObjs=[bond].concat(bond.getConnectedObjs());this.getEditor().objectsChanged(changedObjs)}finally{editor.endUpdateObject()}}},react_mousedown:function(e){if(e.getButton()===Kekule.X.Event.MOUSE_BTN_LEFT){var S=BC.State,coord=this._getEventMouseCoord(e);if(this.getState()===S.INITIAL){var boundItem=this.getEditor().getTopmostBoundInfoAtCoord(coord);if(boundItem){var obj=boundItem.obj;if(this.isObjValidBondTerminator(obj)){var endCoord=this.addDefBond(coord,obj,!0);return endCoord&&this.startDirectManipulate(null,this.getEndingObj(),coord),!0}if(this.isBond(obj)&&this.getEnableBondModification())return this.modifyBond(obj),!0}else if(this.getEditor().canAddUnconnectedStructFragment()){var endCoord=this.addDefBond(coord,null,!0);return endCoord&&this.startDirectManipulate(null,this.getEndingObj(),coord),!0}}}},react_mouseup:function($super,e){var state=this.getState(),startCoord=this.getStartCoord(),endCoord=this._getEventMouseCoord(e),S=Kekule.Editor.BasicManipulationIaController.State;return state===S.MANIPULATING&&e.getButton()===Kekule.X.Event.MOUSE_BTN_LEFT&&Kekule.CoordUtils.isEqual(startCoord,endCoord)?(this.addOperationToEditor(),this.stopManipulate(),this.setState(S.NORMAL),!0):$super(e)}}),Kekule.Editor.MolBondIaController.State={INITIAL:0,START_NODE_SET:21,ADJUSTING:22};var BC=Kekule.Editor.MolBondIaController;return Kekule.Editor.IaControllerManager.register(Kekule.Editor.MolBondIaController,Kekule.Editor.ChemSpaceEditor),Kekule.Editor.MolAtomIaController=Class.create(Kekule.Editor.BaseEditorIaController,{CLASS_NAME:"Kekule.Editor.MolAtomIaController",initialize:function($super,editor){$super(editor),this._createNonAtomLabelInfos(),this._setterShown=!1},finalize:function($super){this.getAtomSetter()&&this.getAtomSetter().finalize(),$super()},initProperties:function(){this.defineProp("currAtom",{dataType:DataType.OBJECT,serializable:!1}),this.defineProp("atomSetter",{dataType:DataType.OBJECT,serializable:!1}),this.defineProp("periodicTable",{dataType:DataType.OBJECT,serializable:!1}),this.defineProp("periodicTableDialog",{dataType:DataType.OBJECT,serializable:!1}),this.defineProp("nonAtomLabelInfos",{dataType:DataType.ARRAY,serializable:!1})},canInteractWithObj:function($super,obj){return!!this.isValidNode(obj)},isValidNode:function(obj){return obj instanceof Kekule.ChemStructureNode},getNodeLabel:function(node){var editor=this.getEditor(),labelConfigs=editor.getRenderConfigs().getDisplayLabelConfigs();if(node.getIsotopeId)return node.getIsotopeId();if(node instanceof Kekule.SubGroup){return node.getAbbr()||node.getFormulaText()||labelConfigs.getRgroup()}if(node instanceof Kekule.VariableAtom){var allowedIds=node.getAllowedIsotopeIds(),disallowedIds=node.getDisallowedIsotopeIds();return allowedIds&&allowedIds.length?this._getVarAtomListLabel():disallowedIds&&disallowedIds.length?this._getVarAtomNotListLabel():this._getVarAtomListLabel()}var ri=node.getCoreDisplayRichTextItem(null,null,labelConfigs);return Kekule.Render.RichTextUtils.toText(ri)},_getVarAtomListLabel:function(){return this.getEditor().getRenderConfigs().getDisplayLabelConfigs().getVariableAtom()},_getVarAtomNotListLabel:function(){return"~"+this.getEditor().getRenderConfigs().getDisplayLabelConfigs().getVariableAtom()},_createNonAtomLabelInfos:function(){var result=[],labelConfigs=this.getEditor().getRenderConfigs().getDisplayLabelConfigs();return result.push({nodeLabel:labelConfigs.getRgroup(),nodeClass:Kekule.RGroup,description:Kekule.$L("ChemWidgetTexts.CAPTION_RGROUP")}),result.push({nodeLabel:labelConfigs.getDummyAtom(),nodeClass:Kekule.Pseudoatom,props:{atomType:Kekule.PseudoatomType.DUMMY},description:Kekule.$L("ChemWidgetTexts.CAPTION_DUMMY_ATOM")}),result.push({nodeLabel:labelConfigs.getHeteroAtom(),nodeClass:Kekule.Pseudoatom,props:{atomType:Kekule.PseudoatomType.HETERO},description:Kekule.$L("ChemWidgetTexts.CAPTION_HETERO_ATOM")}),result.push({nodeLabel:labelConfigs.getAnyAtom(),nodeClass:Kekule.Pseudoatom,props:{atomType:Kekule.PseudoatomType.ANY},description:Kekule.$L("ChemWidgetTexts.CAPTION_ANY_ATOM")}),result.push({nodeLabel:this._getVarAtomListLabel(),nodeClass:Kekule.VariableAtom,description:Kekule.$L("ChemWidgetTexts.CAPTION_VARIABLE_ATOM")}),result.push({nodeLabel:this._getVarAtomNotListLabel(),nodeClass:Kekule.VariableAtom,description:Kekule.$L("ChemWidgetTexts.CAPTION_VARIABLE_NOT_ATOM")}),this.setNonAtomLabelInfos(result),result},_indexOfNonAtomLabel:function(nodeLabel){for(var infos=this.getNonAtomLabelInfos(),i=0,l=infos.length;i<l;++i){if(infos[i].nodeLabel===nodeLabel)return i}return-1},_getNonAtomInfo:function(nodeLabel){var index=this._indexOfNonAtomLabel(nodeLabel);return index<0?null:this.getNonAtomLabelInfos()[index]},getAtomSetterWidget:function(canCreate){var result=this.getAtomSetter();if(!result&&canCreate){var parentElem=this.getEditor().getCoreElement(),doc=parentElem.ownerDocument;result=this._createAtomSetterWidget(doc,parentElem),this.setAtomSetter(result)}return result},_createAtomSetterWidget:function(doc,parentElem){for(var result=new Kekule.Widget.ComboBox(doc),listAtoms=this.getEditor().getEditorConfigs().getStructureConfigs().getPrimaryOrgChemAtoms(),listItems=[],i=0,l=listAtoms.length;i<l;++i)listItems.push({value:listAtoms[i],data:{props:{isotopeId:listAtoms[i]}}});listItems.push({value:Kekule.$L("ChemWidgetTexts.CAPTION_ATOMLIST_PERIODIC_TABLE")});for(var nonAtomLabelInfos=this.getNonAtomLabelInfos(),i=0,l=nonAtomLabelInfos.length;i<l;++i){var info=nonAtomLabelInfos[i],listItem={value:info.nodeLabel,data:{props:info.props}};info.description&&(listItem.text=info.nodeLabel+" - "+info.description),listItems.push(listItem)}result.setItems(listItems),result.appendToElem(parentElem);var self=this;return result.addEventListener("keyup",function(e){e.htmlEvent.getKeyCode()===Kekule.X.Event.KeyCode.ENTER&&(self.applySetter(result),result.dismiss())}),result.addEventListener("valueSelect",function(e){self.applySetter(result),result.dismiss()}),result.addEventListener("showStateChange",function(e){e.isShown||e.isDismissed||self.getAtomSetter()&&self.getAtomSetter().isShown()&&self.applySetter(result)}),result},getPeriodicTableDialogWidget:function(canCreate){var result=this.getPeriodicTableDialog();if(!result&&canCreate){var parentElem=this.getEditor().getCoreElement(),doc=parentElem.ownerDocument;result=this._createPeriodicTableDialogWidget(doc,parentElem),this.setPeriodicTableDialog(result)}return result},_createPeriodicTableDialogWidget:function(doc,parentElem){var dialog=new Kekule.Widget.Dialog(doc,Kekule.$L("ChemWidgetTexts.CAPTION_PERIODIC_TABLE_DIALOG"),[Kekule.Widget.DialogButtons.OK,Kekule.Widget.DialogButtons.CANCEL]),table=new Kekule.ChemWidget.PeriodicTable(doc);return table.setUseMiniMode(!0),table.setEnableSelect(!0),table.appendToElem(dialog.getClientElem()),this.setPeriodicTable(table),dialog},openSetterUi:function(coord,obj){this.getAtomSetter();if(this.isValidNode(obj)){this.setCurrAtom(obj);var fontSize=this.getEditor().getEditorConfigs().getInteractionConfigs().getAtomSetterFontSize()||0,posAdjust=fontSize/1.5,slabel=this.getNodeLabel(obj),setter=this.getAtomSetterWidget(!0);setter.setValue(slabel),setter.setIsDirty(!1);var style=setter.getElement().style;style.position="absolute",style.fontSize=fontSize,style.left=coord.x-posAdjust+"px",style.top=coord.y-posAdjust+"px",setter._applied=!1,setter.show(null,null,Kekule.Widget.ShowHideType.POPUP),function(){setter.focus(),setter.selectAll()}.defer()}},applySetter:function(setter,atom){if(!setter._applied&&setter.getIsDirty()){atom||(atom=this.getCurrAtom());var nodeClass,periodicTableDialog,modifiedProps=null,text=setter.getValue();if(text===Kekule.$L("ChemWidgetTexts.CAPTION_ATOMLIST_PERIODIC_TABLE")){var periodicTableDialog=this.getPeriodicTableDialogWidget(!0);periodicTableDialog.setCaption(Kekule.$L("ChemWidgetTexts.CAPTION_PERIODIC_TABLE_DIALOG_SEL_ELEM"));var currSymbol=atom.getSymbol?atom.getSymbol():null;this.getPeriodicTable().setEnableSelect(!0).setEnableMultiSelect(!1).setSelectedSymbol(currSymbol)}else if(text===this._getVarAtomListLabel()||text===this._getVarAtomNotListLabel()){var notList=text===this._getVarAtomNotListLabel(),periodicTableDialog=this.getPeriodicTableDialogWidget(!0);periodicTableDialog.setCaption(Kekule.$L("ChemWidgetTexts.CAPTION_PERIODIC_TABLE_DIALOG_SEL_ELEM"));var allowedSymbols=atom.getAllowedIsotopeIds?atom.getAllowedIsotopeIds():null,disallowedSymbols=atom.getDisallowedIsotopeIds?atom.getDisallowedIsotopeIds():null;this.getPeriodicTable().setEnableSelect(!0).setEnableMultiSelect(!0).setSelectedSymbols(notList?disallowedSymbols:allowedSymbols)}if(periodicTableDialog){var self=this;return void periodicTableDialog.openModal(function(result){if(result===Kekule.Widget.DialogButtons.OK){var nodeClass,modifiedProps;if(text===Kekule.$L("ChemWidgetTexts.CAPTION_ATOMLIST_PERIODIC_TABLE")){var symbol=self.getPeriodicTable().getSelectedSymbol();nodeClass=Kekule.Atom,modifiedProps={isotopeId:symbol}}if(text===self._getVarAtomListLabel()){var symbols=self.getPeriodicTable().getSelectedSymbols();nodeClass=Kekule.VariableAtom,modifiedProps={allowedIsotopeIds:symbols,disallowedIsotopeIds:null}}if(text===self._getVarAtomNotListLabel()){var symbols=self.getPeriodicTable().getSelectedSymbols();nodeClass=Kekule.VariableAtom,modifiedProps={allowedIsotopeIds:null,disallowedIsotopeIds:symbols}}self.applyModification(atom,null,nodeClass,modifiedProps)}},this)}var newNode=null,nonAtomInfo=this._getNonAtomInfo(text);if(nonAtomInfo)nodeClass=nonAtomInfo.nodeClass,modifiedProps=nonAtomInfo.props;else{var subGroupRepositoryItem=Kekule.Editor.StoredSubgroupRepositoryItem2D.getRepItemOfInputText(text);if(subGroupRepositoryItem){var repResult=subGroupRepositoryItem.createObjects(atom)||{},repObjects=repResult.objects,transformParams=Kekule.Editor.RepositoryStructureUtils.calcRepObjInitialTransformParams(this.getEditor(),subGroupRepositoryItem,repResult,atom,null);this.getEditor().transformCoordAndSizeOfObjects(repObjects,transformParams),newNode=repObjects[0],nodeClass=newNode.getClass()}else nodeClass=Kekule.ChemStructureNodeFactory.getClassByLabel(text,null),nodeClass||this.getEditorConfigs().getInteractionConfigs().getAllowUnknownAtomSymbol()&&(nodeClass=Kekule.Pseudoatom),modifiedProps=nodeClass===Kekule.Atom?{isotopeId:text}:nodeClass===Kekule.Pseudoatom?{symbol:text}:{}}nodeClass?(this.applyModification(atom,newNode,nodeClass,modifiedProps),setter._applied=!0):Kekule.error(Kekule.$L("ErrorMsg.INVALID_ATOM_SYMBOL"))}},applyModification:function(node,newNode,newNodeClass,modifiedProps){var newNode,operGroup,oper,oldNodeClass=node.getClass();if(newNode&&!newNodeClass&&(newNodeClass=newNode.getClass()),newNode||newNodeClass!==oldNodeClass){operGroup=new Kekule.MacroOperation,newNode||(newNode=new newNodeClass);var tempNode=new Kekule.ChemStructureNode;tempNode.assign(node),newNode.assign(tempNode);var operReplace=new Kekule.ChemStructOperation.ReplaceNode(node,newNode);operGroup.add(operReplace)}else newNode=node;modifiedProps&&(oper=new Kekule.ChemObjOperation.Modify(newNode,modifiedProps),operGroup&&operGroup.add(oper));var operation=operGroup||oper;if(operation){var editor=this.getEditor();editor.beginUpdateObject();try{operation.execute()}catch(e){throw e}finally{editor.endUpdateObject()}editor&&editor.getEnableOperHistory()&&operation&&editor.pushOperation(operation)}},react_mouseup:function(e){if(e.getButton()===Kekule.X.Event.MOUSE_BTN_LEFT){this.getEditor().setSelection(null);var coord=this._getEventMouseCoord(e),boundItem=this.getEditor().getTopmostBoundInfoAtCoord(coord);if(boundItem){var obj=boundItem.obj;if(this.isValidNode(obj)){var baseCoord=this.getEditor().getObjectScreenCoord(obj);e.preventDefault(),e.stopPropagation(),this.openSetterUi(baseCoord,obj),this.getEditor().setSelection([obj])}return!0}}}}),Kekule.Editor.IaControllerManager.register(Kekule.Editor.MolAtomIaController,Kekule.Editor.ChemSpaceEditor),Kekule.Editor.RepositoryIaController=Class.create(Kekule.Editor.BasicMolManipulationIaController,{CLASS_NAME:"Kekule.Editor.RepositoryIaController",initialize:function($super,editor){$super(editor)},initProperties:function(){this.defineProp("repositoryItem",{dataType:"Kekule.AbstractRepositoryItem",serializable:!1}),this.defineProp("addRepObjsOper",{dataType:"Kekule.MacroOperation",serializable:!1})},doTestMouseCursor:function(coord,e){return""},calcInitialTransformParams:function(repItem,repResult,destObj,targetCoord){return Kekule.Editor.RepositoryStructureUtils.calcRepObjInitialTransformParams(this.getEditor(),repItem,repResult,destObj,targetCoord)},addRepositoryObj:function(targetObj,screenCoord){var editor=this.getEditor();this.setAddRepObjsOper(null);var repResult=null;editor.beginUpdateObject();try{var chemSpace=editor.getChemSpace(),repItem=this.getRepositoryItem();repResult=repItem.createObjects(targetObj)||{};var repObjects=repResult.objects,isOneStructItem=repItem.isOneStructureFragmentObj(),addToBlankMol=!1,blankMol=this.getEditor().getOnlyOneBlankStructFragment();if(!this.getEditor().canCreateNewChild()&&!repResult.mergeObj){if(!isOneStructItem||!this.getEditor().canAddUnconnectedStructFragment())return null;addToBlankMol=!0}for(var macroOper=new Kekule.MacroOperation,i=0,l=repObjects.length;i<l;++i){var oper,obj=repObjects[i];oper=addToBlankMol?new Kekule.ChemStructOperation.MergeStructFragment(obj,blankMol):new Kekule.ChemObjOperation.Add(obj,chemSpace),macroOper.add(oper)}macroOper.execute(),this.setAddRepObjsOper(macroOper);var addedObjs=addToBlankMol?[blankMol]:repObjects,transformParams=this.calcInitialTransformParams(repItem,repResult,targetObj,screenCoord);this._transformObjectsCoordAndSize(addedObjs,transformParams),repResult.objects=addedObjs}finally{editor.endUpdateObject()}return repResult},_transformObjectsCoordAndSize:function(objects,transformParams){return this.getEditor().transformCoordAndSizeOfObjects(objects,transformParams)},getAllObjOperations:function($super){var result=$super()||[],repOper=this.getAddRepObjsOper();return repOper&&result.unshift(repOper),result},addOperationToEditor:function($super){return this.getAllManipulateObjsMerged()?null:$super()},getInitManipulationType:function(){return Kekule.Editor.BasicManipulationIaController.ManipulationType.ROTATE},react_mousedown:function(e){if(e.getButton()===Kekule.X.Event.MOUSE_BTN_LEFT){var S=BC.State,coord=this._getEventMouseCoord(e);if(this.getState()===S.INITIAL){var boundItem=this.getEditor().getTopmostBoundInfoAtCoord(coord),boundObj=boundItem?boundItem.obj:null,addedResult=this.addRepositoryObj(boundObj,coord);if(addedResult){var addedObjects=addedResult.objects,rotateCenter=null,manType=this.getInitManipulationType();addedResult.mergeObj&&(rotateCenter=this.getEditor().getObjectScreenCoord(addedResult.mergeObj),manType=Kekule.Editor.BasicManipulationIaController.ManipulationType.ROTATE);var box=this.getEditor().getObjectsContainerBox(addedObjects);this.startDirectManipulate(manType,addedObjects,coord,box,rotateCenter),this.moveManipulatedObjs(coord)}return!0}}},react_mouseup:function($super,e){var state=this.getState(),startCoord=this.getStartCoord(),endCoord=this._getEventMouseCoord(e),S=Kekule.Editor.BasicManipulationIaController.State;return state===S.MANIPULATING&&e.getButton()===Kekule.X.Event.MOUSE_BTN_LEFT&&Kekule.CoordUtils.isEqual(startCoord,endCoord)?(this.addOperationToEditor(),this.stopManipulate(),this.setState(S.NORMAL),!0):$super(e)}}),Kekule.Editor.MolRingIaController=Class.create(Kekule.Editor.RepositoryIaController,{CLASS_NAME:"Kekule.Editor.MolRingIaController",initialize:function($super,editor){$super(editor),this.setRepositoryItem(new Kekule.Editor.MolRingRepositoryItem2D)},initProperties:function(){this.defineProp("ringAtomCount",{dataType:DataType.INT,getter:function(){return this.getRepositoryItem().getRingAtomCount()},setter:function(value){this.getRepositoryItem().setRingAtomCount(value)}}),this.defineProp("isAromatic",{dataType:DataType.INT,getter:function(){return this.getRepositoryItem().getIsAromatic()},setter:function(value){this.getRepositoryItem().setIsAromatic(value)}})}}),Kekule.Editor.IaControllerManager.register(Kekule.Editor.MolRingIaController,Kekule.Editor.ChemSpaceEditor),Kekule.Editor.RepositoryStructureFragmentIaController=Class.create(Kekule.Editor.RepositoryIaController,{CLASS_NAME:"Kekule.Editor.RepositoryStructureFragmentIaController",initialize:function($super,editor){$super(editor)},initProperties:function(){this.defineProp("repItemName",{dataType:DataType.STRING,setter:function(value){if(value!==this.getRepItemName()){var repItem=Kekule.Editor.RepositoryItemManager.getItem(value);repItem&&(this.setRepositoryItem(repItem),this.setPropStoreFieldValue("repItemName",value))}}})}}),Kekule.Editor.IaControllerManager.register(Kekule.Editor.RepositoryStructureFragmentIaController,Kekule.Editor.ChemSpaceEditor),Kekule.Editor.ArrowLineIaController=Class.create(Kekule.Editor.RepositoryIaController,{CLASS_NAME:"Kekule.Editor.ArrowLineIaController",initialize:function($super,editor){$super(editor),this.setRepositoryItem(new Kekule.Editor.PathGlyphRepositoryItem2D)},initProperties:function(){this.defineProp("glyphRefLength",{dataType:DataType.FLOAT,getter:function(){return this.getRepositoryItem().getGlyphRefLength()},setter:function(value){this.getRepositoryItem().setGlyphRefLength(value)}}),this.defineProp("glyphClass",{dataType:DataType.CLASS,serializable:!1,getter:function(){return this.getRepositoryItem().getGlyphClass()},setter:function(value){this.getRepositoryItem().setGlyphClass(value)}}),this.defineProp("glyphInitialParams",{dataType:DataType.HASH,getter:function(){return this.getRepositoryItem().getGlyphInitialParams()},setter:function(value){this.getRepositoryItem().setGlyphInitialParams(value)}})},getInitManipulationType:function(){return Kekule.Editor.BasicManipulationIaController.ManipulationType.MOVE},addRepositoryObj:function($super,targetObj,screenCoord){return this.getRepositoryItem().setGlyphRefLength(this.getEditor().getChemSpace().getDefAutoScaleRefLength()),$super(targetObj,screenCoord)}}),Kekule.Editor.IaControllerManager.register(Kekule.Editor.ArrowLineIaController,Kekule.Editor.ChemSpaceEditor),Kekule.Editor.FormulaIaController=Class.create(Kekule.Editor.BaseEditorIaController,{CLASS_NAME:"Kekule.Editor.FormulaIaController",initialize:function($super,editor){$super(editor),this._operAddMol=null},initProperties:function(){this.defineProp("currMol",{dataType:DataType.OBJECT,serializable:!1}),this.defineProp("textSetter",{dataType:DataType.OBJECT,serializable:!1})},canInteractWithObj:function($super,obj){return!(!obj||!this.isValidMol(obj))},isValidMol:function(obj){return obj instanceof Kekule.StructureFragment&&obj.hasFormula()&&!obj.hasCtab()},getFormulaText:function(mol){return mol.hasFormula()?mol.getFormula().getText():""},createNewMol:function(chemSpace,coord){var mol,editor=this.getEditor();if(!editor.canCreateNewChild()&&!(mol=editor.getOnlyOneBlankStructFragment()))return null;editor.beginUpdateObject();try{if(!mol)var mol=new Kekule.Molecule;mol.getFormula(!0),chemSpace.appendChild(mol),editor.setObjectScreenCoord(mol,coord);var addOperation=new Kekule.ChemObjOperation.Add(mol,chemSpace,null);this._operAddBlock=addOperation}finally{editor.endUpdateObject()}return mol},getTextSetterWidget:function(canCreate){var result=this.getTextSetter();if(!result&&canCreate){var parentElem=this.getEditor().getCoreElement(),doc=parentElem.ownerDocument;result=this._createTextSetterWidget(doc,parentElem),this.setTextSetter(result)}return result},_createTextSetterWidget:function(doc,parentElem){var result=new Kekule.Widget.TextBox(doc);result.addClassName(CCNS.CHEMEDITOR_FORMULA_SETTER),result.appendToElem(parentElem);var self=this;return result.addEventListener("keyup",function(e){var ev=e.htmlEvent,keyCode=ev.getKeyCode();keyCode===Kekule.X.Event.KeyCode.ENTER?(self.applySetter(result),result.dismiss()):keyCode===Kekule.X.Event.KeyCode.ESC&&(result.dismiss(),self.cancelSetter())}),result.addEventListener("showStateChange",function(e){e.isShown||e.isDismissed||self.applySetter(result)}),result},cancelSetter:function(){this._operAddBlock&&(this._operAddBlock.reverse(),this._operAddBlock=null)},applySetter:function(setter,mol){if(!setter._applied){mol||(mol=this.getCurrMol());var oper,text=setter.getText();if(text)var oper=new Kekule.ChemObjOperation.Modify(mol.getFormula(),{text:text});else this._operAddBlock?this.cancelSetter():oper=new Kekule.ChemObjOperation.Remove(mol,mol.getParent());if(oper){oper.execute();var editor=this.getEditor();if(editor&&editor.getEnableOperHistory())if(this._operAddBlock){var group=new Kekule.MacroOperation;group.add(this._operAddBlock),group.add(oper),editor.pushOperation(group),this._operAddBlock=null}else editor.pushOperation(oper)}setter._applied=!0}},openSetterUi:function(coord,mol){var oldSetter=this.getTextSetter();if(oldSetter&&oldSetter.isShown()&&this.applySetter(oldSetter,this.getCurrMol()),mol||(mol=this.createNewMol(this.getEditor().getChemObj(),coord)),this.isValidMol(mol)){this.setCurrMol(mol),this.getEditor().setSelection([mol]);var fontSize=mol.getCascadedRenderOption("fontSize")||this.getEditor().getEditorConfigs().getInteractionConfigs().getAtomSetterFontSize(),fontName=mol.getCascadedRenderOption("fontFamily")||"",text=this.getFormulaText(mol),setter=this.getTextSetterWidget(!0);setter._applied=!1;var slabel=text||"";setter.setValue(slabel);var style=setter.getElement().style;style.position="absolute",style.fontSize=fontSize+"px",style.left=coord.x+"px",style.top=coord.y+"px",style.fontFamily=fontName,setter.show(null,null,Kekule.Widget.ShowHideType.POPUP),setter.selectAll(),setter.focus()}},react_mouseup:function(e){if(e.getButton()===Kekule.X.Event.MOUSE_BTN_LEFT){this.getEditor().setSelection(null);var mol,coord=this._getEventMouseCoord(e),boundItem=this.getEditor().getTopmostBoundInfoAtCoord(coord);if(boundItem){var obj=boundItem.obj;this.isValidMol(obj)&&(mol=obj)}var baseCoord;return baseCoord=boundItem&&boundItem.boundInfo?boundItem.boundInfo.coords[0]:coord,e.preventDefault(),e.stopPropagation(),this.openSetterUi(baseCoord,mol),!0}}}),Kekule.Editor.IaControllerManager.register(Kekule.Editor.FormulaIaController,Kekule.Editor.ChemSpaceEditor),Kekule.Editor.ContentBlockIaController=Class.create(Kekule.Editor.BaseEditorIaController,{CLASS_NAME:"Kekule.Editor.ContentBlockIaController",initialize:function($super,editor){$super(editor)},initProperties:function(){this.defineProp("currBlock",{dataType:DataType.OBJECT,serializable:!1})},canInteractWithObj:function($super,obj){return obj&&this.isValidBlock(obj)},isValidBlock:function(obj){return obj instanceof Kekule.ContentBlock},execute:function(chemSpace,baseCoord,block){},react_mousedown:function(e){if(e.getButton()===Kekule.X.Event.MouseButton.LEFT){this.getEditor().setSelection(null);var block,coord=this._getEventMouseCoord(e),boundItem=this.getEditor().getTopmostBoundInfoAtCoord(coord);if(boundItem){var obj=boundItem.obj;this.isValidBlock(obj)&&(block=obj)}var baseCoord=block?this.getEditor().getObjectScreenCoord(block):coord;return e.preventDefault(),e.stopPropagation(),this.execute(this.getEditor().getChemObj(),baseCoord,block),!0}}}),Kekule.Editor.TextBlockIaController=Class.create(Kekule.Editor.ContentBlockIaController,{CLASS_NAME:"Kekule.Editor.TextBlockIaController",initialize:function($super,editor){$super(editor),this._operAddBlock=null},initProperties:function(){this.defineProp("textSetter",{dataType:DataType.OBJECT,serializable:!1})},isValidBlock:function(obj){return obj instanceof Kekule.TextBlock},createNewBlock:function(chemSpace,coord){var editor=this.getEditor();if(!editor.canCreateNewChild())return null;editor.beginUpdateObject();try{var block=new Kekule.TextBlock;if(block){chemSpace.appendChild(block),editor.setObjectScreenCoord(block,coord,Kekule.Render.CoordPos.CORNER_TL);var addOperation=new Kekule.ChemObjOperation.Add(block,chemSpace,null);this._operAddBlock=addOperation}}finally{editor.endUpdateObject()}return block},getBlockText:function(block){return block.getText()},execute:function(chemSpace,baseCoord,block){this.openSetterUi(baseCoord,block)},getTextSetterWidget:function(canCreate){var result=this.getTextSetter();if(!result&&canCreate){var parentElem=this.getEditor().getCoreElement(),doc=parentElem.ownerDocument;result=this._createTextSetterWidget(doc,parentElem),this.setTextSetter(result)}return result},_createTextSetterWidget:function(doc,parentElem){var result=new Kekule.Widget.TextArea(doc);result.setAutoSizeX(!0),result.setAutoSizeY(!0),result.addClassName(CCNS.CHEMEDITOR_TEXT_SETTER),result.appendToElem(parentElem);var self=this;return result.addEventListener("keyup",function(e){var ev=e.htmlEvent,keyCode=ev.getKeyCode();keyCode===Kekule.X.Event.KeyCode.ENTER&&ev.getCtrlKey()?(self.applySetter(result),result.dismiss()):keyCode===Kekule.X.Event.KeyCode.ESC&&(result.dismiss(),self.cancelSetter())}),result.addEventListener("showStateChange",function(e){e.isShown||e.isDismissed||self.applySetter(result)}),result},cancelSetter:function(){this._operAddBlock&&(this._operAddBlock.reverse(),this._operAddBlock=null)},applySetter:function(setter,block){if(!setter._applied){block||(block=this.getCurrBlock());var oper,text=setter.getText();if(text?oper=new Kekule.ChemObjOperation.Modify(block,{text:text}):this._operAddBlock?this.cancelSetter():oper=new Kekule.ChemObjOperation.Remove(block,block.getParent()),oper){oper.execute();var editor=this.getEditor();if(editor&&editor.getEnableOperHistory())if(this._operAddBlock){var group=new Kekule.MacroOperation;group.add(this._operAddBlock),group.add(oper),editor.pushOperation(group),this._operAddBlock=null}else editor.pushOperation(oper)}setter._applied=!0}},openSetterUi:function(coord,block){var oldSetter=this.getTextSetter();if(oldSetter&&oldSetter.isShown()&&this.applySetter(oldSetter,this.getCurrBlock()),block||(block=this.createNewBlock(this.getEditor().getChemObj(),coord)),this.isValidBlock(block)){this.setCurrBlock(block),this.getEditor().setSelection([block]);var setterCoord=this.getEditor().getObjectScreenCoord(block,Kekule.Render.CoordPos.CORNER_TL),fontSize=block.getCascadedRenderOption("fontSize")||this.getEditor().getEditorConfigs().getInteractionConfigs().getAtomSetterFontSize(),fontName=block.getCascadedRenderOption("fontFamily")||"",text=this.getBlockText(block),setter=this.getTextSetterWidget(!0);setter._applied=!1;var slabel=text||Kekule.$L("ChemWidgetTexts.CAPTION_TEXTBLOCK_INIT");setter.setValue(slabel);var style=setter.getElement().style;style.position="absolute",style.fontSize=fontSize+"px",style.left=setterCoord.x+"px",style.top=setterCoord.y+"px",style.fontFamily=fontName,setter.show(null,null,Kekule.Widget.ShowHideType.POPUP),setter.selectAll(),setter.focus()}}}),Kekule.Editor.IaControllerManager.register(Kekule.Editor.TextBlockIaController,Kekule.Editor.ChemSpaceEditor),Kekule.Editor.ImageBlockIaController=Class.create(Kekule.Editor.ContentBlockIaController,{CLASS_NAME:"Kekule.Editor.ImageBlockIaController",initialize:function($super,editor){$super(editor),this._operAddBlock=null,this._imgProbeElem=null,this._actionOpenFile=this.createOpenAction()},doFinalize:function(){this._actionOpenFile&&this.actionOpenFile.finalize()},initProperties:function(){},isValidBlock:function(obj){return obj instanceof Kekule.ImageBlock},createNewBlock:function(chemSpace,coord,size,src){var editor=this.getEditor();if(!editor.canCreateNewChild())return null;editor.beginUpdateObject();try{var block=new Kekule.ImageBlock;src&&block.setSrc(src),size&&block.setSize2D(size),editor.setObjectScreenCoord(block,coord,Kekule.Render.CoordPos.CORNER_TL);var addOperation=new Kekule.ChemObjOperation.Add(block,chemSpace,null);this._operAddBlock=addOperation}finally{editor.endUpdateObject()}return block},_getImgFilters:function(){return[{title:Kekule.$L("WidgetTexts.TITLE_IMG_FORMAT_PNG"),filter:".png"},{title:Kekule.$L("WidgetTexts.TITLE_IMG_FORMAT_JPG"),filter:".jpg,.jpeg"},{title:Kekule.$L("WidgetTexts.TITLE_IMG_FORMAT_GIF"),filter:".gif"},{title:Kekule.$L("WidgetTexts.TITLE_IMG_FORMAT_SVG"),filter:".svg"},Kekule.NativeServices.FILTER_ALL_SUPPORT,Kekule.NativeServices.FILTER_ANY]},createOpenAction:function(){var result=new Kekule.ActionFileOpen;return result.setFilters(this._getImgFilters()),result.on("open",this.reactImageFileOpen,this),result},reactImageFileOpen:function(e){var file=e.file;if(file){var self=this,reader=new FileReader;reader.addEventListener("load",function(){var imgElem=self._getImageProbeElem();imgElem.ownerDocument;try{delete imgElem.width,delete imgElem.height}catch(e){}imgElem.src=reader.result;var editor=self.getEditor();(function(){var size={x:imgElem.width,y:imgElem.height};if(size.x<=0||size.y<=0)return void Kekule.error(Kekule.$L("ErrorMsg.INVALID_OR_EMPTY_IMAGE"));var coord1=self._currCoord,contextCoord1=editor.objCoordToContext(coord1),contextCoord2=Kekule.CoordUtils.add(contextCoord1,size),coord2=editor.contextCoordToObj(contextCoord2),size=Kekule.CoordUtils.substract(coord2,coord1);size=Kekule.CoordUtils.absValue(size);var oper,currBlock=self.getCurrBlock(),chemSpace=editor.getChemObj();if(currBlock)oper=new Kekule.ChemObjOperation.Modify(currBlock,{src:reader.result,size2D:size});else{var block=self.createNewBlock(self.getEditor().getChemObj(),self._currCoord,size,reader.result);self.setCurrBlock(block),oper=new Kekule.ChemObjOperation.Add(block,chemSpace,null)}if(oper)try{oper.execute(),editor&&editor.getEnableOperHistory()&&editor.pushOperation(oper)}finally{}}).defer()}),reader.readAsDataURL(file)}},_getImageProbeElem:function(){if(!this._imgProbeElem){var doc=this.getEditor().getElement().ownerDocument;this._imgProbeElem=doc.createElement("img")}return this._imgProbeElem},execute:function(chemSpace,baseCoord,block){this.setCurrBlock(block),this._currCoord=baseCoord,this._actionOpenFile.execute(this.getEditor())}}),Kekule.Editor.IaControllerManager.register(Kekule.Editor.ImageBlockIaController,Kekule.Editor.ChemSpaceEditor),Kekule.Editor.AttachedMarkerIaController=Class.create(Kekule.Editor.BaseEditorIaController,{CLASS_NAME:"Kekule.Editor.AttachedMarkerIaController",initialize:function($super,editor){$super(editor)},initProperties:function(){this.defineProp("markerClass",{dataType:DataType.CLASS,serializable:!1}),this.defineProp("targetClass",{dataType:DataType.CLASS,serializable:!1}),this.defineProp("markerClassName",{dataType:DataType.STRING,getter:function(){return ClassEx.getClassName(this.getMarkerClass())},setter:function(value){this.setMarkerClass(ClassEx.findClass(value,void 0,Kekule))}}),this.defineProp("targetClassName",{dataType:DataType.STRING,getter:function(){return ClassEx.getClassName(this.getTargetClass())},setter:function(value){this.setTargetClass(ClassEx.findClass(value,void 0,Kekule))}}),this.defineProp("initialPropValues",{dataType:DataType.HASH})},canInteractWithObj:function($super,obj){return this.isValidTarget(obj)},isValidTarget:function(obj){var targetClass=this.getTargetClass();return obj instanceof targetClass||!targetClass},createMarker:function(){var result,markerClass=this.getMarkerClass();if(markerClass){result=new markerClass;var initValues=this.getInitialPropValues();initValues&&result&&result.setPropValues&&result.setPropValues(initValues)}return result},createOperations:function(targetObj){var result,marker=this.createMarker();return marker&&(result=new Kekule.ChemObjOperation.Add(marker,targetObj)),[result]},apply:function(targetObj){var operations=this.createOperations(targetObj),oper=operations.length<=0?null:1===operations.length?operations[0]:new Kekule.MacroOperation(operations);if(oper){oper.execute();var editor=this.getEditor();editor&&editor.getEnableOperHistory()&&editor.pushOperation(oper)}},react_mouseup:function(e){if(e.getButton()===Kekule.X.Event.MouseButton.LEFT){var coord=this._getEventMouseCoord(e),boundItem=this.getEditor().getTopmostBoundInfoAtCoord(coord);if(boundItem){var obj=boundItem.obj;return this.isValidTarget(obj)&&(this.apply(obj),e.preventDefault(),e.stopPropagation()),!0}}}}),Kekule.Editor.IaControllerManager.register(Kekule.Editor.AttachedMarkerIaController,Kekule.Editor.ChemSpaceEditor),Kekule.Editor.MolNodeChargeIaController=Class.create(Kekule.Editor.AttachedMarkerIaController,{CLASS_NAME:"Kekule.Editor.MolNodeChargeIaController",initialize:function($super,editor){$super(editor),this.setChargeInc(1)},initProperties:function(){this.defineProp("chargeInc",{dataType:DataType.NUMBER,serializable:!1}),this.defineProp("charge",{dataType:DataType.NUMBER,serializable:!1}),this.defineProp("radical",{dataType:DataType.INT,serializable:!1}),this.defineProp("currNode",{dataType:DataType.OBJECT,serializable:!1})},initPropValues:function($super){$super(),this.setTargetClass(Kekule.ChemStructureNode)},createOperations:function(node){var result,chargeModified=!1,radicalModified=!1,modifiedData={},charge=node.getCharge();Kekule.ObjUtils.notUnset(this.getCharge())?charge!==this.getCharge()&&(modifiedData.charge=this.getCharge(),chargeModified=!0):this.getChargeInc()&&(charge+=this.getChargeInc(),modifiedData.charge=charge,chargeModified=!0);var radical=node.getRadical();this.getRadical()!==radical&&(modifiedData.radical=this.getRadical(),radicalModified=!0);var marker,result=[],markerOperations=[];if(chargeModified){var chargeMarker=node.fetchChargeMarker(!1);0===modifiedData.charge||chargeMarker||(marker=new Kekule.ChemMarker.Charge,marker.setValue(modifiedData.charge),markerOperations.push(new Kekule.ChemObjOperation.Add(marker,node))),0===modifiedData.charge&&chargeMarker&&markerOperations.push(new Kekule.ChemObjOperation.Remove(chargeMarker))}if(radicalModified){var radicalMarker=node.fetchRadicalMarker(!1);0===modifiedData.radical||radicalMarker||(marker=new Kekule.ChemMarker.Radical,marker.setValue(modifiedData.radical),markerOperations.push(new Kekule.ChemObjOperation.Add(marker,node))),0===modifiedData.radical&&radicalMarker&&markerOperations.push(new Kekule.ChemObjOperation.Remove(radicalMarker))}result=result.concat(markerOperations);var propModifyOper;return(chargeModified||radicalModified)&&(propModifyOper=new Kekule.ChemObjOperation.Modify(node,modifiedData),result.push(propModifyOper)),result}}),Kekule.Editor.IaControllerManager.register(Kekule.Editor.MolNodeChargeIaController,Kekule.Editor.ChemSpaceEditor),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,ObjectEx=__webpack_require__(0).ObjectEx;module.exports=function(Kekule){return Kekule.Editor.EditorNexus=Class.create(ObjectEx,{CLASS_NAME:"Kekule.ChemWidget.StructureTreeView",initialize:function($super,components){$super(),this._currInvoker=null,components&&(components.editor&&this.setEditor(components.editor),components.structureTreeView&&this.setStructureTreeView(components.structureTreeView),components.objectInspector&&this.setObjectInspector(components.objectInspector))},initProperties:function(){this.defineProp("editor",{dataType:"Kekule.Editor.BaseEditor",serializable:!1,setter:function(value){var oldObj=this.getPropStoreFieldValue("editor");this.setPropStoreFieldValue("editor",value),this.editorChanged(value,oldObj)}}),this.defineProp("structureTreeView",{dataType:"Kekule.ChemWidget.StructureTreeView",serializable:!1,setter:function(value){var oldObj=this.getPropStoreFieldValue("structureTreeView");this.setPropStoreFieldValue("structureTreeView",value),this.structureTreeViewChanged(value,oldObj)}}),this.defineProp("objectInspector",{dataType:"Kekule.Widget.ObjectInspector",serializable:!1,setter:function(value){var oldObj=this.getPropStoreFieldValue("objectInspector");this.setPropStoreFieldValue("objectInspector",value),this.objectInspectorChanged(value,oldObj)}})},editorChanged:function(newValue,oldValue){oldValue&&this._uninstallEditorEventHandler(oldValue),newValue&&this._installEditorEventHandler(newValue)},structureTreeViewChanged:function(newValue,oldValue){oldValue&&this._uninstallStructureTreeViewEventHandler(oldValue),newValue&&(this._installStructureTreeViewEventHandler(newValue),this._updateByEditor())},objectInspectorChanged:function(newValue,oldValue){var editor=this.getEditor();editor&&(oldValue&&oldValue.getOperHistory()===editor.getOperHistory()&&oldValue.setOperHistory(null),newValue&&(newValue.setOperHistory(editor.getOperHistory()),newValue.setEnableOperHistory(editor.getEnableOperHistory()),this._updateByEditor()))},_installEditorEventHandler:function(editor){editor.addEventListener("change",this._reactEditorChanged,this)},_uninstallEditorEventHandler:function(editor){editor.removeEventListener("change",this._reactEditorChanged,this)},_installStructureTreeViewEventHandler:function(treeView){treeView.addEventListener("change",this._reactStructureTreeViewChanged,this)},_uninstallStructureTreeViewEventHandler:function(treeView){treeView.removeEventListener("change",this._reactStructureTreeViewChanged,this)},_reactEditorChanged:function(e){if(!this._currInvoker){var target=e.target;if(target===this.getEditor()){var propNames=e.changedPropNames;if(propNames.indexOf("chemObj")>=0&&this.changeRootObj(target.getChemObj(),target),propNames.indexOf("selection")>=0&&this.changeSelection(target.getSelection(),target),propNames.indexOf("operHistory")>=0||propNames.indexOf("enableOperHistory")>=0){var objInspector=this.getObjectInspector();objInspector&&(objInspector.setOperHistory(target.getOperHistory()),objInspector.setEnableOperHistory(target.getEnableOperHistory()))}}}},_updateByEditor:function(){this._reactEditorChanged({target:this.getEditor(),changedPropNames:["chemObj","selection","operHistory"]})},_reactStructureTreeViewChanged:function(e){if(!this._currInvoker){var target=e.target;if(target===this.getStructureTreeView()){if(e.changedPropNames.indexOf("selection")>=0){var objs=target.getSelectedChemObjs();this.changeSelection(objs,target)}}}},changeSelection:function(selection,invokerComponent){this._currInvoker=invokerComponent;try{var editor=this.getEditor();editor&&this._currInvoker!==editor&&editor.setSelection(selection);var treeView=this.getStructureTreeView();treeView&&this._currInvoker!==treeView&&treeView.selectChemObjs(selection);var objInspector=this.getObjectInspector();objInspector&&this._currInvoker!==objInspector&&objInspector.setObjects(selection)}finally{this._currInvoker=null}},changeRootObj:function(root,invokerComponent){this._currInvoker=invokerComponent;try{var editor=this.getEditor();editor&&this._currInvoker!==editor&&editor.setChemObj(root);var treeView=this.getStructureTreeView();treeView&&this._currInvoker!==treeView&&treeView.setRootObj(root)}finally{this._currInvoker=null}}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,ClassEx=__webpack_require__(0).ClassEx,DataType=__webpack_require__(0).DataType;module.exports=function(Kekule){var CNS=Kekule.Widget.HtmlClassNames,CCNS=Kekule.ChemWidget.HtmlClassNames,BNS=Kekule.ChemWidget.ComponentWidgetNames;Kekule.ChemWidget.HtmlClassNames=Object.extend(Kekule.ChemWidget.HtmlClassNames,{COMPOSER:"K-Chem-Composer",COMPOSER_EDITOR_STAGE:"K-Chem-Composer-Editor-Stage",COMPOSER_ADV_PANEL:"K-Chem-Composer-Adv-Panel",COMPOSER_TOOLBAR:"K-Chem-Composer-Toolbar",COMPOSER_COMMON_TOOLBAR:"K-Chem-Composer-Common-Toolbar",COMPOSER_ZOOM_TOOLBAR:"K-Chem-Composer-Zoom-Toolbar",COMPOSER_CHEM_TOOLBAR:"K-Chem-Composer-Chem-Toolbar",COMPOSER_ASSOC_TOOLBAR:"K-Chem-Composer-Assoc-Toolbar",COMPOSER_STYLE_TOOLBAR:"K-Chem-Composer-Style-Toolbar",COMPOSER_FONTNAME_BOX:"K-Chem-Composer-FontName-Box",COMPOSER_FONTSIZE_BOX:"K-Chem-Composer-FontSize-Box",COMPOSER_COLOR_BOX:"K-Chem-Composer-Color-Box",COMPOSER_TEXTDIRECTION_BUTTON:"K-Chem-Composer-TextDirection-Button",COMPOSER_TEXTDIRECTION_BUTTON_DEFAULT:"K-Chem-Composer-TextDirection-Button-Default",COMPOSER_TEXTDIRECTION_BUTTON_LTR:"K-Chem-Composer-TextDirection-Button-LTR",COMPOSER_TEXTDIRECTION_BUTTON_RTL:"K-Chem-Composer-TextDirection-Button-RTL",COMPOSER_TEXTDIRECTION_BUTTON_TTB:"K-Chem-Composer-TextDirection-Button-TTB",COMPOSER_TEXTDIRECTION_BUTTON_BTT:"K-Chem-Composer-TextDirection-Button-BTT",COMPOSER_TEXTALIGN_BUTTON:"K-Chem-Composer-TextAlign-Button",COMPOSER_TEXTALIGN_BUTTON_HORIZONTAL:"K-Chem-Composer-TextAlign-Button-Horizontal",COMPOSER_TEXTALIGN_BUTTON_VERTICAL:"K-Chem-Composer-TextAlign-Button-Vertical",COMPOSER_TEXTALIGN_BUTTON_DEFAULT:"K-Chem-Composer-TextAlign-Button",COMPOSER_TEXTALIGN_BUTTON_LEADING:"K-Chem-Composer-TextAlign-Button-Leading",COMPOSER_TEXTALIGN_BUTTON_TRAILING:"K-Chem-Composer-TextAlign-Button-Trailing",COMPOSER_TEXTALIGN_BUTTON_CENTER:"K-Chem-Composer-TextAlign-Button-Center",COMPOSER_TEXTALIGN_BUTTON_LEFT:"K-Chem-Composer-TextAlign-Button-Left",COMPOSER_TEXTALIGN_BUTTON_RIGHT:"K-Chem-Composer-TextAlign-Right",COMPOSER_TEXTALIGN_BUTTON_TOP:"K-Chem-Composer-TextAlign-Top",COMPOSER_TEXTALIGN_BUTTON_BOTTOM:"K-Chem-Composer-TextAlign-Bottom",COMPOSER_DIALOG:"K-Chem-ComposerDialog"}),Kekule.globalOptions.add("chemWidget.composer",{commonToolButtons:[BNS.newDoc,BNS.loadData,BNS.saveData,BNS.undo,BNS.redo,BNS.copy,BNS.cut,BNS.paste,BNS.zoomIn,BNS.reset,BNS.zoomOut,BNS.config,BNS.objInspector],chemToolButtons:[BNS.manipulate,BNS.erase,BNS.molBond,BNS.molAtom,BNS.molFormula,BNS.molRing,BNS.molCharge,BNS.glyph,BNS.textImage],styleToolComponentNames:[BNS.fontName,BNS.fontSize,BNS.color,BNS.textDirection,BNS.textAlign]}),Kekule.Editor.ComposerStyleToolbar=Class.create(Kekule.Widget.Toolbar,{CLASS_NAME:"Kekule.Editor.ComposerStyleToolbar",ATOM_COLOR_SPECIAL_VALUE_INFO:{text:"(use atom custom color)",value:"Atom",className:CNS.COLORPICKER_SPEC_COLOR_MIXED},LINKED_VALUE_FIELD:"__$value__",initialize:function($super,composer){$super(composer),this.setPropStoreFieldValue("composer",composer),this.createChildWidgets(),this.appendToWidget(composer),this._relatedPropNames=composer.getCoordMode()===Kekule.CoordMode.COORD3D?["renderOptions","render3DOptions"]:["renderOptions"],this.getEditor().addEventListener("selectionChange",function(e){this._isApplying||this.updateStyleValues()},this),this.getEditor().addEventListener("editObjChanged",function(e){var propNames=e.propNames;propNames&&propNames.length&&Kekule.ArrayUtils.intersect(this._relatedPropNames,propNames).length&&(this._isApplying||this.updateStyleValues())},this),this._isApplying=!1},doFinalize:function($super){this.clearWidgets(),$super()},initProperties:function(){this.defineProp("composer",{dataType:"Kekule.Editor.Composer",serializable:!1,setter:null}),this.defineProp("fontNameBox",{dataType:"Kekule.Widget.ComboBox",serializable:!1,setter:null}),this.defineProp("fontSizeBox",{dataType:"Kekule.Widget.ComboBox",serializable:!1,setter:null}),this.defineProp("colorBox",{dataType:"Kekule.Widget.ColorDropButton",serializable:!1,setter:null}),this.defineProp("textDirectionButtonSet",{dataType:"Kekule.Widget.CompactButtonSet",serializable:!1,setter:null}),this.defineProp("textHorizontalAlignButtonSet",{dataType:"Kekule.Widget.CompactButtonSet",serializable:!1,setter:null}),this.defineProp("textVerticalAlignButtonSet",{dataType:"Kekule.Widget.CompactButtonSet",serializable:!1,setter:null}),this.defineProp("fontName",{dataType:DataType.STRING,serializable:!1,getter:function(){return this.getFontNameBox()?this.getFontNameBox().getValue():null},setter:function(value){this.getFontNameBox()&&this.getFontNameBox().setValue(value)}}),this.defineProp("fontSize",{dataType:DataType.NUMBER,serializable:!1,getter:function(){return this.getFontSizeBox()?parseFloat(this.getFontSizeBox().getValue()):null},setter:function(value){this.getFontSizeBox()&&this.getFontSizeBox().setValue(value)}}),this.defineProp("color",{dataType:DataType.STRING,serializable:!1,getter:function(){return this.getColorBox()?this.getColorBox().getValue():void 0},setter:function(value){this.getColorBox()&&this.getColorBox().setValue(value)}}),this.defineProp("textDirection",{dataType:DataType.INT,serializable:!1,getter:function(){return this._getButtonSetLinkedValue(this.getTextDirectionButtonSet())},setter:function(value){this._setButtonSetLinkedValue(this.getTextDirectionButtonSet(),value)}}),this.defineProp("textHorizontalAlign",{dataType:DataType.INT,serializable:!1,getter:function(){return this._getButtonSetLinkedValue(this.getTextHorizontalAlignButtonSet())},setter:function(value){this._setButtonSetLinkedValue(this.getTextHorizontalAlignButtonSet(),value)}}),this.defineProp("textVerticalAlign",{dataType:DataType.INT,serializable:!1,getter:function(){return this._getButtonSetLinkedValue(this.getTextVerticalAlignButtonSet())},setter:function(value){this._setButtonSetLinkedValue(this.getTextVerticalAlignButtonSet(),value)}}),this.defineProp("componentNames",{dataType:DataType.ARRAY,serializable:!1,getter:function(){var result=this.getPropStoreFieldValue("componentNames");return result||(result=this.getDefaultComponentNames(),this.setPropStoreFieldValue("componentNames",result)),result},setter:function(value){this.setPropStoreFieldValue("componentNames",value),this.recreateComponents()}})},initPropValues:function($super){$super(),this.setShowGlyph(!0)},removeWidget:function($super,widget,doNotFinalize){widget===this.getFontNameBox()&&this.setPropStoreFieldValue("fontNameBox",null),widget===this.getFontSizeBox()&&this.setPropStoreFieldValue("fontSizeBox",null),widget===this.getColorBox()&&this.setPropStoreFieldValue("colorBox",null),widget===this.getTextDirectionButtonSet()&&this.setPropStoreFieldValue("textDirectionButtonSet",null),widget===this.getTextHorizontalAlignButtonSet()&&this.setPropStoreFieldValue("textHorizontalAlignButtonSet",null),widget===this.getTextVerticalAlignButtonSet()&&this.setPropStoreFieldValue("textVerticalAlignButtonSet",null),$super(widget,doNotFinalize)},doGetWidgetClassName:function($super){return $super()+" "+CCNS.COMPOSER_TOOLBAR+" "+CCNS.COMPOSER_STYLE_TOOLBAR},getEditor:function(){return this.getComposer().getEditor()},getEditorConfigs:function(){return this.getEditor().getEditorConfigs()},createChildWidgets:function(componentNames){componentNames||(componentNames=this.getComponentNames());for(var i=0,l=componentNames.length;i<l;++i){var name=componentNames[i];if(name===BNS.fontName){var comboBox=new Kekule.Widget.ComboBox(this);this.fillFontNameBox(comboBox),comboBox.addClassName(CCNS.COMPOSER_FONTNAME_BOX),comboBox.setHint(Kekule.$L("ChemWidgetTexts.HINT_FONTNAME")),comboBox.addEventListener("valueChange",function(e){this.applyFontName()},this),this.setPropStoreFieldValue("fontNameBox",comboBox)}else if(name===BNS.fontSize)comboBox=new Kekule.Widget.ComboBox(this),this.fillFontSizeBox(comboBox),comboBox.addClassName(CCNS.COMPOSER_FONTSIZE_BOX),comboBox.setHint(Kekule.$L("ChemWidgetTexts.HINT_FONTSIZE")),comboBox.addEventListener("valueChange",function(e){this.applyFontSize()},this),this.setPropStoreFieldValue("fontSizeBox",comboBox);else if(name===BNS.color){var colorBox=new Kekule.Widget.ColorDropButton(this);colorBox.setHint(Kekule.$L("ChemWidgetTexts.HINT_PICK_COLOR")),colorBox.setShowText(!1),colorBox.setSpecialColors([Kekule.Widget.ColorPicker.SpecialColors.UNSET,this.ATOM_COLOR_SPECIAL_VALUE_INFO]),colorBox.addClassName(CCNS.COMPOSER_COLOR_BOX),colorBox.addEventListener("valueChange",function(e){this.applyColor()},this),this.setPropStoreFieldValue("colorBox",colorBox)}else if(name===BNS.textDirection){var TD=Kekule.Render.TextDirection,childInfos=[{value:TD.DEFAULT,text:Kekule.$L("ChemWidgetTexts.CAPTION_TEXT_DIRECTION_DEFAULT"),className:CCNS.COMPOSER_TEXTDIRECTION_BUTTON_DEFAULT},{value:TD.LTR,text:Kekule.$L("ChemWidgetTexts.CAPTION_TEXT_DIRECTION_LTR"),className:CCNS.COMPOSER_TEXTDIRECTION_BUTTON_LTR},{value:TD.RTL,text:Kekule.$L("ChemWidgetTexts.CAPTION_TEXT_DIRECTION_RTL"),className:CCNS.COMPOSER_TEXTDIRECTION_BUTTON_RTL},{value:TD.TTB,text:Kekule.$L("ChemWidgetTexts.CAPTION_TEXT_DIRECTION_TTB"),className:CCNS.COMPOSER_TEXTDIRECTION_BUTTON_TTB},{value:TD.BTT,text:Kekule.$L("ChemWidgetTexts.CAPTION_TEXT_DIRECTION_BTT"),className:CCNS.COMPOSER_TEXTDIRECTION_BUTTON_BTT}],btnSet=this._createStyleButtonSet(Kekule.$L("ChemWidgetTexts.CAPTION_TEXT_DIRECTION"),Kekule.$L("ChemWidgetTexts.HINT_TEXT_DIRECTION"),CCNS.COMPOSER_TEXTDIRECTION_BUTTON,childInfos);btnSet.addEventListener("select",function(e){this.applyTextDirection()},this),this.setPropStoreFieldValue("textDirectionButtonSet",btnSet)}else if(name===BNS.textAlign){var TA=Kekule.Render.TextAlign,childInfos=[{value:TA.DEFAULT,text:Kekule.$L("ChemWidgetTexts.CAPTION_TEXT_ALIGN_DEFAULT"),className:CCNS.COMPOSER_TEXTALIGN_BUTTON_DEFAULT},{value:TA.LEADING,text:Kekule.$L("ChemWidgetTexts.CAPTION_TEXT_ALIGN_LEADING"),className:CCNS.COMPOSER_TEXTALIGN_BUTTON_LEADING},{value:TA.TRAILING,text:Kekule.$L("ChemWidgetTexts.CAPTION_TEXT_ALIGN_TRAILING"),className:CCNS.COMPOSER_TEXTALIGN_BUTTON_TRAILING},{value:TA.CENTER,text:Kekule.$L("ChemWidgetTexts.CAPTION_TEXT_ALIGN_CENTER"),className:CCNS.COMPOSER_TEXTALIGN_BUTTON_CENTER},{value:TA.LEFT,text:Kekule.$L("ChemWidgetTexts.CAPTION_TEXT_ALIGN_LEFT"),className:CCNS.COMPOSER_TEXTALIGN_BUTTON_LEFT},{value:TA.RIGHT,text:Kekule.$L("ChemWidgetTexts.CAPTION_TEXT_ALIGN_RIGHT"),className:CCNS.COMPOSER_TEXTALIGN_BUTTON_RIGHT}],btnSet=this._createStyleButtonSet(Kekule.$L("ChemWidgetTexts.CAPTION_TEXT_HORIZONTAL_ALIGN"),Kekule.$L("ChemWidgetTexts.HINT_TEXT_HORIZONTAL_ALIGN"),CCNS.COMPOSER_TEXTALIGN_BUTTON_HORIZONTAL,childInfos);btnSet.addEventListener("select",function(e){this.applyTextHorizontalAlign()},this),this.setPropStoreFieldValue("textHorizontalAlignButtonSet",btnSet);var TA=Kekule.Render.TextAlign,childInfos=[{value:TA.DEFAULT,text:Kekule.$L("ChemWidgetTexts.CAPTION_TEXT_ALIGN_DEFAULT"),className:CCNS.COMPOSER_TEXTALIGN_BUTTON_DEFAULT},{value:TA.LEADING,text:Kekule.$L("ChemWidgetTexts.CAPTION_TEXT_ALIGN_LEADING"),className:CCNS.COMPOSER_TEXTALIGN_BUTTON_LEADING},{value:TA.TRAILING,text:Kekule.$L("ChemWidgetTexts.CAPTION_TEXT_ALIGN_TRAILING"),className:CCNS.COMPOSER_TEXTALIGN_BUTTON_TRAILING},{value:TA.CENTER,text:Kekule.$L("ChemWidgetTexts.CAPTION_TEXT_ALIGN_CENTER"),className:CCNS.COMPOSER_TEXTALIGN_BUTTON_CENTER},{value:TA.TOP,text:Kekule.$L("ChemWidgetTexts.CAPTION_TEXT_ALIGN_TOP"),className:CCNS.COMPOSER_TEXTALIGN_BUTTON_TOP},{value:TA.BOTTOM,text:Kekule.$L("ChemWidgetTexts.CAPTION_TEXT_ALIGN_BOTTOM"),className:CCNS.COMPOSER_TEXTALIGN_BUTTON_BOTTOM}],btnSet=this._createStyleButtonSet(Kekule.$L("ChemWidgetTexts.CAPTION_TEXT_VERTICAL_ALIGN"),Kekule.$L("ChemWidgetTexts.HINT_TEXT_VERTICAL_ALIGN"),CCNS.COMPOSER_TEXTALIGN_BUTTON_VERTICAL,childInfos);btnSet.addEventListener("select",function(e){this.applyTextVerticalAlign()},this),this.setPropStoreFieldValue("textVerticalAlignButtonSet",btnSet)}}this.updateStyleValues()},_createStyleButtonSet:function(text,hint,className,childItemInfos){var btnSet=new Kekule.Widget.CompactButtonSet(this);if(btnSet.setText(text),btnSet.setHint(hint),btnSet.addClassName(className),btnSet.setShowText(!1),btnSet.setShowCompactMark(!1),btnSet.setButtonKind(Kekule.Widget.Button.Kinds.DROPDOWN),btnSet.getButtonSet().addClassName(CCNS.COMPOSER_STYLE_TOOLBAR),btnSet.getButtonSet().setShowText(!0),childItemInfos)for(var i=0,l=childItemInfos.length;i<l;++i){var info=childItemInfos[i],btn=new Kekule.Widget.RadioButton(btnSet,info.text||"");btn.setHint(info.hint||""),btn.addClassName(info.className),btn[this.LINKED_VALUE_FIELD]=info.value,btnSet.append(btn,info.selected)}return btnSet},_getButtonSetLinkedValue:function(btnSet){var selected=btnSet?btnSet.getSelected():null;return selected?selected[this.LINKED_VALUE_FIELD]:void 0},_setButtonSetLinkedValue:function(btnSet,value){if(btnSet){var group=btnSet.getButtonSet(),children=group.getChildWidgets();btnSet.setSelected(null);for(var i=0,l=children.length;i<l;++i){var child=children[i];if(child.hasOwnProperty(this.LINKED_VALUE_FIELD)&&child[this.LINKED_VALUE_FIELD]==value){btnSet.setSelected(child);break}}}},getDefaultComponentNames:function(){return Kekule.globalOptions.chemWidget.composer.styleToolComponentNames},recreateComponents:function(){var cnames=this.getComponentNames();this.clearWidgets(),this.createChildWidgets(cnames)},fillFontSizeBox:function(sizeComboBox){for(var listedSizes=this.getEditorConfigs().getStyleSetterConfigs().getListedFontSizes(),boxItems=[{text:Kekule.$L("ChemWidgetTexts.S_VALUE_DEFAULT"),value:void 0}],i=0,l=listedSizes.length;i<l;++i)boxItems.push({text:listedSizes[i]+" px",value:listedSizes[i]});sizeComboBox.setItems(boxItems)},fillFontNameBox:function(fontComboBox){for(var listedNames=this.getEditorConfigs().getStyleSetterConfigs().getListedFontNames(),boxItems=[{text:Kekule.$L("ChemWidgetTexts.S_VALUE_DEFAULT"),value:""}],i=0,l=listedNames.length;i<l;++i)boxItems.push({text:listedNames[i],value:listedNames[i]});fontComboBox.setItems(boxItems)},applyStyle:function(chemObjs,styles,is3DOption){this._isApplying=!0;try{this.getEditor().modifyObjectsRenderOptions(chemObjs,styles,is3DOption,!0)}finally{this._isApplying=!1}},getStyleValue:function(chemObjs,stylePropName,is3DOption){return Kekule.Render.RenderOptionUtils.getCascadeRenderOptionValueOfObjs(chemObjs,stylePropName,is3DOption)},applyStyleToEditorSelection:function(styles,is3DOption){var objs=this.getEditor().getSelection();if(objs&&objs.length)return this.applyStyle(objs,styles,is3DOption)},applyFontName:function(objs){if(objs||(objs=this.getEditor().getSelection()),objs&&objs.length){var fontName=this.getFontName();this.applyStyle(objs,{fontFamily:fontName})}},applyFontSize:function(objs){if(objs||(objs=this.getEditor().getSelection()),objs&&objs.length){var fontSize=this.getFontSize();this.applyStyle(objs,{fontSize:fontSize})}},applyColor:function(objs){if(objs||(objs=this.getEditor().getSelection()),objs&&objs.length){var color=this.getColor();color===this.ATOM_COLOR_SPECIAL_VALUE_INFO.value?this.applyStyle(objs,{useAtomSpecifiedColor:!0,color:void 0}):(color==Kekule.Widget.ColorPicker.SpecialColors.UNSET&&(color=void 0),this.applyStyle(objs,{useAtomSpecifiedColor:!1,color:color}))}},applyTextDirection:function(objs){if(objs||(objs=this.getEditor().getSelection()),objs&&objs.length){var direction=this.getTextDirection();this.applyStyle(objs,{charDirection:direction})}},applyTextHorizontalAlign:function(objs){if(objs||(objs=this.getEditor().getSelection()),objs&&objs.length){var value=this.getTextHorizontalAlign();this.applyStyle(objs,{horizontalAlign:value})}},applyTextVerticalAlign:function(objs){if(objs||(objs=this.getEditor().getSelection()),objs&&objs.length){var value=this.getTextVerticalAlign();this.applyStyle(objs,{verticalAlign:value})}},updateStyleValues:function(objs){objs||(objs=this.getEditor().getSelection()),objs&&objs.length&&(this.updateFontName(objs),this.updateFontSize(objs),this.updateColor(objs),this.updateTextDirection(objs),this.updateTextHorizontalAlign(objs),this.updateTextVerticalAlign(objs))},updateFontName:function(objs){if(objs&&objs.length&&this.getFontNameBox()){var fontName=this.getStyleValue(objs,"fontFamily");this.setFontName(fontName||"")}},updateFontSize:function(objs){if(objs&&objs.length&&this.getFontSizeBox()){var fontSize=this.getStyleValue(objs,"fontSize");this.setFontSize(fontSize||void 0)}},updateColor:function(objs){if(objs&&objs.length&&this.getColorBox()){var color,useAtomSpecified=this.getStyleValue(objs,"useAtomSpecifiedColor"),color=this.getStyleValue(objs,"color");this.getColorBox().setColorClassName(null),color?this.getColorBox().setColorClassName(null):useAtomSpecified&&(color=this.ATOM_COLOR_SPECIAL_VALUE_INFO.value,this.getColorBox().setColorClassName(this.ATOM_COLOR_SPECIAL_VALUE_INFO.className)),this.setColor(color||void 0)}},updateTextDirection:function(objs){if(objs&&objs.length&&this.getTextDirectionButtonSet()){var value=this.getStyleValue(objs,"charDirection");this.setTextDirection(value)}},updateTextHorizontalAlign:function(objs){if(objs&&objs.length&&this.getTextHorizontalAlignButtonSet()){var value=this.getStyleValue(objs,"horizontalAlign");this.setTextHorizontalAlign(value)}},updateTextVerticalAlign:function(objs){if(objs&&objs.length&&this.getTextVerticalAlignButtonSet()){var value=this.getStyleValue(objs,"verticalAlign");this.setTextVerticalAlign(value)}},updateState:function(){var editor=this.getEditor(),hasSelection=editor&&editor.hasSelection();this.getFontNameBox()&&this.getFontNameBox().setEnabled(hasSelection),this.getFontSizeBox()&&this.getFontSizeBox().setEnabled(hasSelection),this.getColorBox()&&this.getColorBox().setEnabled(hasSelection),this.getTextDirectionButtonSet()&&this.getTextDirectionButtonSet().setEnabled(hasSelection),this.getTextHorizontalAlignButtonSet()&&this.getTextHorizontalAlignButtonSet().setEnabled(hasSelection),this.getTextVerticalAlignButtonSet()&&this.getTextVerticalAlignButtonSet().setEnabled(hasSelection)}}),Kekule.Editor.Composer=Class.create(Kekule.ChemWidget.AbstractWidget,{CLASS_NAME:"Kekule.Editor.Composer",BINDABLE_TAG_NAMES:["div"],CHEM_TOOL_CHILD_FIELDS:"__$children__",initialize:function($super,parentOrElementOrDocument,editor){this.updateStyleToolbarStateBind=this.updateStyleToolbarState.bind(this),this.setPropStoreFieldValue("enableStyleToolbar",!0),this.setPropStoreFieldValue("editor",editor),this.setPropStoreFieldValue("editorNexus",new Kekule.Editor.EditorNexus),$super(parentOrElementOrDocument),this.bindEditor(editor),this.getCommonBtnGroup()||this.createCommonToolbar(),this.getChemBtnGroup()||this.createChemToolbar(),this.getZoomBtnGroup()||this.createZoomToolbar(),this.uiLayoutChanged()},doFinalize:function($super){var toolBar=this.getCommonBtnGroup();toolBar&&toolBar.finalize();var toolBar=this.getChemBtnGroup();toolBar&&toolBar.finalize();var editor=this.getPropStoreFieldValue("editor");editor&&editor.finalize(),this.getEditorNexus().finalize(),$super()},initProperties:function(){this.defineProp("editor",{dataType:"Kekule.Editor.BaseEditor",serializable:!1,setter:null,getter:function(){var result=this.getPropStoreFieldValue("editor");return result||(result=this.createDefaultEditor(),this.setPropStoreFieldValue("editor",result)),result}}),this.defineProp("showInspector",{dataType:DataType.BOOL,setter:function(value){this.getShowInspector()!==value&&(this.setPropStoreFieldValue("showInspector",value),this.showInspectorChanged())}}),this.defineProp("editorStageElem",{dataType:DataType.OBJECT,serializable:!1,setter:null}),this.defineProp("advPanelElem",{dataType:DataType.OBJECT,serializable:!1,setter:null}),this.defineProp("editorNexus",{dataType:"Kekule.Editor.EditorNexus",serializable:!1,setter:null}),this.defineProp("objInspector",{dataType:"Kekule.Widget.ObjectInspector",serializable:!1,setter:null}),this.defineProp("structureTreeView",{dataType:"Kekule.ChemWidget.StructureTreeView",serializable:!1,setter:null}),this.defineProp("commonBtnGroup",{dataType:"Kekule.Widget.ButtonGroup",serializable:!1}),this.defineProp("zoomBtnGroup",{dataType:"Kekule.Widget.ButtonGroup",serializable:!1}),this.defineProp("chemBtnGroup",{dataType:"Kekule.Widget.ButtonGroup",serializable:!1}),this.defineProp("assocBtnGroup",{dataType:"Kekule.Widget.ButtonGroup",serializable:!1}),this.defineProp("styleToolbar",{dataType:"Kekule.Widget.ButtonGroup",serializable:!1,getter:function(){var result=this.getPropStoreFieldValue("styleToolbar");return result||this.getEnableStyleToolbar()&&(result=this.createStyleToolbar(),this.setPropStoreFieldValue("styleToolbar",result)),result}}),this.defineProp("styleToolComponentNames",{dataType:DataType.ARRAY,serializable:!1,getter:function(){var toolbar=this.getStyleToolbar();return toolbar?toolbar.getComponentNames():null},setter:function(value){var toolbar=this.getStyleToolbar();return toolbar&&toolbar.setComponentNames(value),this}}),this.defineProp("enableStyleToolbar",{dataType:DataType.BOOL,setter:function(value){this.setPropStoreFieldValue("enableStyleToolbar",value),this.updateStyleToolbarState()}}),this.defineProp("commonToolButtons",{dataType:DataType.HASH,serializable:!1,getter:function(){var result=this.getPropStoreFieldValue("commonToolButtons");return result||(result=this.getDefaultCommonToolBarButtons(),this.setPropStoreFieldValue("commonToolButtons",result)),result},setter:function(value){this.setPropStoreFieldValue("commonToolButtons",value),this.updateCommonToolbar(),this.updateZoomToolbar()}}),this.defineProp("chemToolButtons",{dataType:DataType.HASH,serializable:!1,getter:function(){var result=this.getPropStoreFieldValue("chemToolButtons");return result||(result=this.getDefaultChemToolBarButtons(),this.setPropStoreFieldValue("chemToolButtons",result)),result},setter:function(value){this.setPropStoreFieldValue("chemToolButtons",value),this.updateChemToolbar()}}),this.defineProp("styleBarComponents",{dataType:DataType.ARRAY,serializable:!1,getter:function(){var result=this.getPropStoreFieldValue("styleBarComponents");return result||(result=null,this.setPropStoreFieldValue("styleBarComponents",result)),result},setter:function(value){this.setPropStoreFieldValue("styleBarComponents",value),this.getStyleToolbar()&&this.getStyleToolbar().setComponentNames(value)}}),this.defineProp("commonActions",{dataType:"Kekule.ActionList",serializable:!1,setter:null,getter:function(){var result=this.getPropStoreFieldValue("commonActions");return result||(result=new Kekule.ActionList,this.setPropStoreFieldValue("commonActions",result)),result}}),this.defineProp("zoomActions",{dataType:"Kekule.ActionList",serializable:!1,setter:null,getter:function(){var result=this.getPropStoreFieldValue("zoomActions");return result||(result=new Kekule.ActionList,this.setPropStoreFieldValue("zoomActions",result)),result}}),this.defineProp("chemActions",{dataType:"Kekule.ActionList",serializable:!1,setter:null,getter:function(){var result=this.getPropStoreFieldValue("chemActions");return result||(result=new Kekule.ActionList,this.setPropStoreFieldValue("chemActions",result)),result}}),this.defineProp("actionMap",{dataType:"Kekule.MapEx",serializable:!1,setter:null,getter:function(){var result=this.getPropStoreFieldValue("actionMap");return result||(result=new Kekule.MapEx,this.setPropStoreFieldValue("actionMap",result)),result}}),this.defineProp("allowCreateNewChild",{dataType:DataType.BOOL,getter:function(){var ed=this.getEditor();return ed&&ed.getAllowCreateNewChild?ed.getAllowCreateNewChild():null},setter:function(value){var ed=this.getEditor();return ed.setAllowCreateNewChild&&ed.setAllowCreateNewChild(value),this}}),this._defineEditorDelegatedProp("chemObj"),this._defineEditorDelegatedProp("chemObjLoaded"),this._defineEditorDelegatedProp("renderType"),this._defineEditorDelegatedProp("renderConfigs"),this._defineEditorDelegatedProp("drawOptions"),this._defineEditorDelegatedProp("allowCoordBorrow"),this._defineEditorDelegatedProp("editorConfigs"),this._defineEditorDelegatedProp("operHistory"),this._defineEditorDelegatedProp("enableOperHistory"),this._defineEditorDelegatedProp("selection"),this._defineEditorDelegatedProp("hotTrackedObjs"),this._defineEditorDelegatedProp("enableOperContext"),this._defineEditorDelegatedProp("enableCreateNewDoc"),this._defineEditorDelegatedProp("enableLoadNewFile"),this._defineEditorDelegatedProp("initOnNewDoc")},_defineEditorDelegatedProp:function(propName,editorPropName){editorPropName||(editorPropName=propName);var editorPropInfo=ClassEx.getPropInfo(Kekule.Editor.BaseEditor,editorPropName),propOptions=Object.create(editorPropInfo);return propOptions.getter=null,propOptions.setter=null,editorPropInfo.getter&&(propOptions.getter=function(){return this.getEditor().getPropValue(editorPropName)}),editorPropInfo.setter&&(propOptions.setter=function(value){this.getEditor().setPropValue(editorPropName,value)}),this.defineProp(propName,propOptions)},loadPredefinedResDataToProp:function(propName,resData,success){if("chemObj"===propName)if(success)try{var chemObj=Kekule.IO.loadTypedData(resData.data,resData.resType,resData.resUri);this.setChemObj(chemObj)}catch(e){Kekule.raise(e,Kekule.ExceptionLevel.ERROR)}else Kekule.throwException(Kekule.$L("ErrorMsg.CANNOT_LOAD_RES_OF_URI")+resData.resUri||"")},initPropValues:function($super){$super()},doCreateRootElement:function(doc){return doc.createElement("div")},doCreateSubElements:function(doc,rootElem){var result=[],elem=doc.createElement("div");elem.className=CCNS.COMPOSER_EDITOR_STAGE,rootElem.appendChild(elem),this.setPropStoreFieldValue("editorStageElem",elem),result.push(elem);var elem=doc.createElement("div");return elem.className=CCNS.COMPOSER_ADV_PANEL,rootElem.appendChild(elem),this.setPropStoreFieldValue("advPanelElem",elem),result.push(elem),result},doGetWidgetClassName:function($super){return $super()+" "+CCNS.COMPOSER},doWidgetShowStateChanged:function($super,isShown){$super(isShown),isShown&&this.adjustComponentPositions()},getResizerElement:function(){return this.getEditorStageElem()},getChildActionClass:function($super,actionName,checkSupClasses){var result=$super(actionName,checkSupClasses);return result||(result=this.getEditor().getChildActionClass(actionName,checkSupClasses)),result},getCoordMode:function(){return this.getEditor().getCoordMode()},isDirty:function(){return this.getEditor().isDirty()},newDoc:function(){return this.getEditor().newDoc()},load:function(chemObj){return this.getEditor().load(chemObj)},getSavingTargetObj:function(){var c=this.getEditor();return c?c.getSavingTargetObj():null},getExportableClasses:function(){return this.getEditor().getExportableClasses()},exportObj:function(objClass){return this.getEditor().exportObj(objClass)},exportObjs:function(objClass){return this.getEditor().exportObjs(objClass)},undo:function(){return this.getEditor().undo()},redo:function(){return this.getEditor().redo()},undoAll:function(){return this.getEditor().undoAll()},canUndo:function(){return this.getEditor().canUndo()},canRedo:function(){return this.getEditor().canRedo()},repaint:function(overrideOptions){return this.getEditor().repaint(overrideOptions),this},uiLayoutChanged:function(){this.adjustComponentPositions()},adjustComponentPositions:function(){var commonToolbarElem=this.getCommonBtnGroup()?this.getCommonBtnGroup().getElement():null,zoomToolbarElem=this.getZoomBtnGroup()?this.getZoomBtnGroup().getElement():null,chemToolbarElem=this.getChemBtnGroup()?this.getChemBtnGroup().getElement():null;if(commonToolbarElem&&chemToolbarElem){if(commonToolbarElem)var commonRect=Kekule.HtmlElementUtils.getElemBoundingClientRect(commonToolbarElem);if(zoomToolbarElem)var zoomRect=Kekule.HtmlElementUtils.getElemBoundingClientRect(zoomToolbarElem);if(chemToolbarElem)var chemRect=Kekule.HtmlElementUtils.getElemBoundingClientRect(chemToolbarElem);if(commonRect.width&&chemRect.width){var style=commonToolbarElem.style;style.top="0px",style.left=chemRect.width+"px",style=chemToolbarElem.style,style.top=commonRect.height+"px",style.left="0px";var top,left,right,bottom,rect=commonRect;top=rect.height;var rect=chemRect;left=rect.width;var bottom=zoomRect?zoomRect.height:0;if(this.getShowInspector()){var elem=this.getAdvPanelElem(),rect=Kekule.HtmlElementUtils.getElemBoundingClientRect(elem);right=rect.width}else right=0;var stageElem=this.getEditorStageElem(),style=stageElem.style;style.position="absolute",style.top=top+"px",style.left=left+"px",style.bottom=bottom+"px",style.right=right+"px",elem=this.getAdvPanelElem(),style=elem.style,style.position="absolute",style.top=top+"px",style.bottom=bottom+"px"}}},adjustAssocToolbarPositions:function(){var chemToolbarElem=this.getChemBtnGroup().getElement(),chemRect=Kekule.HtmlElementUtils.getElemBoundingClientRect(chemToolbarElem);if(this.isAssocToolbarShown()){var elem=this.getAssocBtnGroup().getElement();elem.style.left=chemRect.width+"px"}if(this.isStyleToolbarShown()){var elem=this.getStyleToolbar().getElement();elem.style.left=chemRect.width+"px"}},bindEditor:function(editor){editor?editor.setParent(this):editor=this.getEditor();var commonActions=this.getCommonActions();this.getChemActions();this.createIaControllers(editor),editor.addEventListener("load",function(e){this.updateAllActions(),this.updateUiWidgets();var actions=this.getChemActions(),action=actions.getActionAt(0);action&&action.execute()},this),editor.addEventListener("operChange",function(e){commonActions.updateAll(),this.updateUiWidgets()},this),editor.addEventListener("selectionChange",function(e){commonActions.updateAll(),this.updateUiWidgets()},this),editor.appendToElem(this.getEditorStageElem()),this.getEditorNexus().setEditor(editor)},createDefaultEditor:function(){var result=new Kekule.Editor.ChemSpaceEditor(this,null,Kekule.Render.RendererType.R2D);return result.addClassName(CNS.DYN_CREATED),result},createIaControllers:function(editor){for(var controllerClasses=Kekule.Editor.IaControllerManager.getAvailableControllerClasses(editor.getClass()),i=0,l=controllerClasses.length;i<l;++i){var c=controllerClasses[i],controller=new c(editor);editor.addIaController(controller.getDefId(),controller)}},showInspectorChanged:function(){this.getShowInspector()?(this.getObjInspector()||this.createAdvControls(),this.showAdvPanel()):this.hideAdvPanel(),this.uiLayoutChanged()},createAdvControls:function(parentElem){parentElem||(parentElem=this.getAdvPanelElem());var doc=this.getDocument(),treeView=new Kekule.ChemWidget.StructureTreeView(doc);treeView.setItemInitialExpanded(!0),treeView.appendToElem(parentElem),this.setPropStoreFieldValue("structureTreeView",treeView);var objInspector=new Kekule.Widget.ObjectInspector(doc);objInspector.setShowPropInfoPanel(!1),objInspector.appendToElem(parentElem),this.setPropStoreFieldValue("objInspector",objInspector);var nexus=this.getEditorNexus();nexus.setObjectInspector(objInspector),nexus.setStructureTreeView(treeView)},showAdvPanel:function(){this.getAdvPanelElem().style.display="block"},hideAdvPanel:function(){this.getAdvPanelElem().style.display="none"},getDefaultCommonToolBarButtons:function(){return Kekule.globalOptions.chemWidget.composer.commonToolButtons},getZoomButtonNames:function(){return[BNS.zoomIn,BNS.zoomOut,BNS.reset]},getDefaultChemToolBarButtons:function(){return Kekule.globalOptions.chemWidget.composer.chemToolButtons},getCompActionClass:function(btnName){return this.getChildActionClass(btnName,!0)},_getActionTargetWidget:function(actionClass){return ClassEx.isOrIsDescendantOf(actionClass,Kekule.Editor.ActionOnComposer)||ClassEx.isOrIsDescendantOf(actionClass,Kekule.Widget.ActionOpenConfigWidget)?this:this.getEditor()},createToolButton:function(btnName,parentGroup,actions,checkGroup){var result=null,name=DataType.isObjectValue(btnName)?btnName.name:btnName,actionClass=this.getCompActionClass(name),action=this._createToolButtonAction(btnName,actions,checkGroup);if(DataType.isObjectValue(btnName)&&!actionClass){if(!actionClass)var objDefHash=Object.extend({widget:Kekule.Widget.Button},btnName);result=Kekule.Widget.Utils.createFromHash(parentGroup,objDefHash)}else{result=new(btnName===BNS.objInspector?Kekule.Widget.CheckButton:checkGroup?Kekule.Widget.RadioButton:Kekule.Widget.Button)(parentGroup)}action&&result.setAction(action)},_createToolButtonAction:function(actionNameOrHash,defActions,checkGroup){var result,result=null,name=DataType.isObjectValue(actionNameOrHash)?actionNameOrHash.name:actionNameOrHash,children=DataType.isObjectValue(actionNameOrHash)?actionNameOrHash.attached:null,actionClass=this.getCompActionClass(name);if(DataType.isObjectValue(actionNameOrHash)&&!actionClass){var objDefHash=actionNameOrHash,actionClass=objDefHash.actionClass;actionClass&&"string"==typeof actionClass&&(actionClass=ClassEx.findClass(objDefHash.actionClass))}if(actionClass){var actionMap=this.getActionMap(),result=actionMap.get(actionClass);if(!result){var result=new actionClass(this._getActionTargetWidget(actionClass));actionMap.set(actionClass,result)}if(checkGroup&&result.setCheckGroup(checkGroup),result&&defActions&&defActions.add(result),result&&result.addAttachedAction){var subGroupName=result.getClassName(),oldAttachedActions=Kekule.ArrayUtils.clone(result.getAttachedActions().getActions()||[]),attachChildAction=function(action,childAction,oldAttachedActions,asDefault){if(!childAction)return null;var oldIndex=oldAttachedActions.indexOf(childAction);oldIndex>=0?oldAttachedActions[oldIndex]=null:action.addAttachedAction(childAction,asDefault)};if(children)for(var i=0,l=children.length;i<l;++i){var child=children[i],childAction=this._createToolButtonAction(child,null,subGroupName);attachChildAction(result,childAction,oldAttachedActions,0===i)}else{var attachedActionClasses=result.getAttachedActionClasses();if(attachedActionClasses)for(var i=0,l=attachedActionClasses.length;i<l;++i){var aClass=attachedActionClasses[i],childAction=actionMap.get(aClass);childAction||(childAction=new aClass(this._getActionTargetWidget(aClass)),childAction.setCheckGroup(subGroupName),actionMap.set(aClass,childAction)),attachChildAction(result,childAction,oldAttachedActions,0===i)}}if(oldAttachedActions.length)for(var i=0,l=oldAttachedActions.length;i<l;++i){var unusedAction=oldAttachedActions[i];unusedAction&&(result.removeAttachedAction(unusedAction),actionMap.remove(unusedAction.getClass()))}}}return result},createInnerToolbar:function(){var toolBar=new Kekule.Widget.ButtonGroup(this);return toolBar.addClassName(CCNS.COMPOSER_TOOLBAR),toolBar.addClassName(CCNS.INNER_TOOLBAR),toolBar.addClassName(CNS.DYN_CREATED),toolBar.setShowText(!1),toolBar.doSetShowGlyph(!0),toolBar.appendToElem(this.getElement()),toolBar},createCommonToolbar:function(){var toolbar=this.createInnerToolbar();toolbar.addClassName(CCNS.COMPOSER_COMMON_TOOLBAR);var btns=this.getCommonToolButtons();btns=Kekule.ArrayUtils.exclude(btns,this.getZoomButtonNames());var actions=this.getCommonActions();this.getEditor();actions.clear();for(var i=0,l=btns.length;i<l;++i){var name=btns[i];this.createToolButton(name,toolbar,actions)}return this.setCommonBtnGroup(toolbar),toolbar.addClassName(CNS.DYN_CREATED),this.updateZoomToolbar(),this.adjustComponentPositions(),toolbar},createZoomToolbar:function(){var btns=Kekule.ArrayUtils.intersect(this.getCommonToolButtons(),this.getZoomButtonNames());if(btns.length){var toolbar=this.createInnerToolbar();toolbar.addClassName(CCNS.COMPOSER_ZOOM_TOOLBAR);var actions=this.getZoomActions();this.getEditor();actions.clear();for(var i=0,l=btns.length;i<l;++i){var name=btns[i];this.createToolButton(name,toolbar,actions)}return this.setZoomBtnGroup(toolbar),toolbar.addClassName(CNS.DYN_CREATED),this.adjustComponentPositions(),toolbar}return this.setZoomBtnGroup(null),null},updateCommonToolbar:function(){var old=this.getCommonBtnGroup();old&&old.finalize(),this.createCommonToolbar()},updateZoomToolbar:function(){var old=this.getZoomBtnGroup();old&&old.finalize(),this.createZoomToolbar()},createChemToolbar:function(){var toolbar=this.createInnerToolbar();toolbar.addClassName(CCNS.COMPOSER_CHEM_TOOLBAR),toolbar.setLayout(Kekule.Widget.Layout.VERTICAL);var btns=this.getChemToolButtons(),actions=this.getChemActions();actions.clear();for(var i=0,l=btns.length;i<l;++i){var name=btns[i];this.createToolButton(name,toolbar,actions,"chemTools")}return this.setChemBtnGroup(toolbar),toolbar.addClassName(CNS.DYN_CREATED),this.bindAssocActions(null),this.adjustComponentPositions(),toolbar},updateChemToolbar:function(){var old=this.getChemBtnGroup();old&&old.finalize(),this.createChemToolbar()},createAssocToolbar:function(){var toolbar=this.createInnerToolbar();return toolbar.addClassName(CCNS.COMPOSER_ASSOC_TOOLBAR),this.setAssocBtnGroup(toolbar),this.adjustAssocToolbarPositions(),toolbar.addClassName(CNS.DYN_CREATED),toolbar},showAssocToolbar:function(){var toolbar=this.getAssocBtnGroup();toolbar||(toolbar=this.createAssocToolbar());var self=this;return toolbar.show(null,function(){self.uiLayoutChanged(),setTimeout(self.updateStyleToolbarStateBind,0)}),this},hideAssocToolbar:function(){var toolbar=this.getAssocBtnGroup();if(toolbar){var self=this;toolbar.hide(null,function(){self.uiLayoutChanged(),setTimeout(self.updateStyleToolbarStateBind,0)})}return this},isAssocToolbarShown:function(){var toolbar=this.getAssocBtnGroup();return toolbar&&toolbar.isShown()},bindAssocActions:function(actions){var toolbar=this.getAssocBtnGroup();if(toolbar||(toolbar=this.createAssocToolbar()),toolbar.clearWidgets(),actions)for(var i=0,l=actions.getActionCount();i<l;++i){var action=actions.getActionAt(i),checkGroup=action.getCheckGroup(),btnClass=checkGroup?Kekule.Widget.RadioButton:Kekule.Widget.Button,btn=new btnClass(toolbar);btn.setAction(action)}},createStyleToolbar:function(){if(this.getEnableStyleToolbar()){var toolbar=new Kekule.Editor.ComposerStyleToolbar(this);return toolbar.setComponentNames(this.getStyleBarComponents()),this.setStyleToolbar(toolbar),this.adjustAssocToolbarPositions(),this.updateStyleToolbarState(),toolbar}return null},showStyleToolbar:function(){if(this.getEnableStyleToolbar()){var toolbar=this.getStyleToolbar();if(!toolbar.isShown()){var self=this;toolbar.show(null,function(){self.uiLayoutChanged()})}}return this},hideStyleToolbar:function(){var toolbar=this.getPropStoreFieldValue("styleToolbar");if(toolbar&&toolbar.isShown()){var self=this;toolbar.hide(null,function(){self.uiLayoutChanged()})}return this},isStyleToolbarShown:function(){var toolbar=this.getPropStoreFieldValue("styleToolbar");return toolbar&&toolbar.isShown()},needShowStyleToolbar:function(){var editor=this.getEditor();return editor&&editor.hasSelection()&&!this.isAssocToolbarShown()},updateStyleToolbarState:function(){this.getEnableStyleToolbar()&&this.needShowStyleToolbar()?(this.showStyleToolbar(),this.getStyleToolbar().updateState()):this.hideStyleToolbar()},updateAllActions:function(){this.getCommonActions().updateAll(),this.getZoomActions().updateAll(),this.getChemActions().updateAll()},updateUiWidgets:function(){this.updateStyleToolbarState()},createConfigurator:function($super){var result=$super();return result.addEventListener("configChange",function(e){this.getEditor().repaint()},this),result}}),Kekule.Editor.Composer.Settings=Class.create(Kekule.Widget.BaseWidget.Settings,{CLASS_NAME:"Kekule.Editor.Composer.Settings",initialize:function($super,composer){$super(composer)},initProperties:function(){this.defineDelegatedProps(["enableCreateNewDoc","enableLoadNewFile","initOnNewDoc","enableOperHistory","allowCreateNewChild","enableStyleToolbar"])}}),Kekule.Editor.Composer.Configurator=Class.create(Kekule.Widget.Configurator,{CLASS_NAME:"Kekule.Editor.Composer.Configurator",TAB_BTN_DATA_FIELD:"__$data__",initialize:function($super,composer){$super(composer)},initPropValues:function($super){$super(),this.setLayout(Kekule.Widget.Layout.HORIZONTAL)},getCategoryInfos:function($super){for(var result=$super(),composer=this.getComposer(),editor=composer.getEditor(),configObjs=[editor.getDisplayerConfigs(),editor.getRenderConfigs()],j=0,k=configObjs.length;j<k;++j)for(var config=configObjs[j],props=config.getPropListOfScopes([Class.PropertyScope.PUBLISHED]),i=0,l=props.getLength();i<l;++i){var propInfo=props.getPropInfoAt(i),obj=config.getPropValue(propInfo.name);obj&&result.push({obj:obj,name:propInfo.name,title:propInfo.title,description:propInfo.description})}return result},getComposer:function(){return this.getWidget()},getEditor:function(){return this.getComposer().getEditor()}});var SM=Kekule.ObjPropSettingManager;return SM.register("Kekule.Editor.Composer.fullFunc",{enableStyleToolbar:!0,enableOperHistory:!0,enableLoadNewFile:!0,enableCreateNewDoc:!0,allowCreateNewChild:!0,commonToolButtons:null,chemToolButtons:null,styleToolComponentNames:null}),SM.register("Kekule.Editor.Composer.molOnly",{enableStyleToolbar:!0,enableOperHistor:!0,enableLoadNewFile:!0,enableCreateNewDoc:!0,allowCreateNewChild:!0,commonToolButtons:null,chemToolButtons:[BNS.manipulate,BNS.erase,BNS.molBond,BNS.molAtom,BNS.molFormula,BNS.molRing,BNS.molCharge],styleToolComponentNames:null}),SM.register("Kekule.Editor.Composer.compact",{enableStyleToolbar:!1,commonToolButtons:[BNS.newDoc,BNS.loadData,BNS.saveData,BNS.undo,BNS.redo],chemToolButtons:null,styleToolComponentNames:null}),SM.register("Kekule.Editor.Composer.singleObj",{allowCreateNewChild:!1}),Kekule.Editor.ComposerDialog=Class.create(Kekule.Widget.Dialog,{CLASS_NAME:"Kekule.Editor.ComposerDialog",initialize:function($super,parentOrElementOrDocument,caption,buttons){$super(parentOrElementOrDocument,caption,buttons||[Kekule.Widget.DialogButtons.OK,Kekule.Widget.DialogButtons.CANCEL])},initProperties:function(){this.defineProp("composer",{dataType:"Kekule.Editor.Composer",serializable:!1,setter:null}),this.defineProp("chemObj",{dataType:"Kekule.ChemObject",serializable:!1,getter:function(){var c=this.getComposer();return c&&c.getChemObj()},setter:function(value){var c=this.getComposer();c&&c.setChemObj(value)}})},initPropValues:function($super){$super()},doGetWidgetClassName:function($super){return $super()+" "+CCNS.COMPOSER_DIALOG},doCreateClientContents:function($super,clientElem){$super();var composer=this.doCreateComposerWidget();this.setPropStoreFieldValue("composer",composer),composer.appendToElem(clientElem)},getSavingTargetObj:function(){var c=this.getComposer();return c?c.getSavingTargetObj():null},doCreateComposerWidget:function(){var result=new Kekule.Editor.Composer(this);return result.addClassName(CNS.DYN_CREATED),result.setResizable&&result.setResizable(!0),result.getEditor().addClassName(CNS.DYN_CREATED),result}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,DataType=__webpack_require__(0).DataType;module.exports=function(Kekule){var AU=Kekule.ArrayUtils,BNS=Kekule.ChemWidget.ComponentWidgetNames,CCNS=Kekule.ChemWidget.HtmlClassNames,_editorActionRegInfo=(Kekule.ActionManager,[]);return Kekule.ChemWidget.HtmlClassNames=Object.extend(Kekule.ChemWidget.HtmlClassNames,{ACTION_UNDO:"K-Chem-Undo",ACTION_REDO:"K-Chem-Redo",ACTION_NEWDOC:"K-Chem-NewDoc",ACTION_CLONE_SELECTION:"K-Chem-Clone-Selection",ACTION_COPY:"K-Chem-Copy",ACTION_CUT:"K-Chem-Cut",ACTION_PASTE:"K-Chem-Paste",ACTION_TOGGLE_INSPECTOR:"K-Chem-Toggle-Inspector"}),Object.extend(Kekule.ChemWidget.ComponentWidgetNames,{molBondSingle:"bondSingle",molBondDouble:"bondDouble",molBondTriple:"bondTriple",molBondCloser:"bondCloser",molBondWedgeUp:"bondWedgeUp",molBondWedgeDown:"bondWedgeDown",molBondWedgeUpOrDown:"bondWedgeUpOrDown",molBondDoubleEither:"bondDoubleEither",molChargeClear:"chargeClear",molChargePositive:"chargePositive",molChargeNegative:"chargeNegative",molRadicalSinglet:"radicalSinglet",molRadicalTriplet:"radicalTriplet",molRadicalDoublet:"radicalDoublet",molElectronLonePair:"electronLonePair",molRing3:"ring3",molRing4:"ring4",molRing5:"ring5",molRing6:"ring6",molRing7:"ring7",molRing8:"ring8",molRingAr6:"ringAr6",molRingAr5:"ringAr5",molRepCyclopentaneHaworth1:"repCyclopentaneHaworth1",molRepCyclopentaneHaworth2:"repCyclopentaneHaworth2",molRepCyclohexaneHaworth1:"repCyclohexaneHaworth1",molRepCyclohexaneHaworth2:"repCyclohexaneHaworth2",molRepCyclohexaneChair1:"repCyclohexaneChair1",molRepCyclohexaneChair2:"repCyclohexaneChair2",molRepSubBondMark:"subBondMark",molRepMethane:"methane",molRepFischer1:"repFischer1",molRepFischer2:"repFischer2",molRepFischer3:"repFischer3",molRepSawhorseStaggered:"repSawhorseStaggered",molRepSawhorseEclipsed:"repSawhorseEclipsed",glyphRepLine:"repLine",glyphRepOpenArrowLine:"repOpenArrowLine",glyphRepTriangleArrowLine:"repTriangleArrowLine",glyphRepDiOpenArrowLine:"repDiOpenArrowLine",glyphRepDiTriangleArrowLine:"repDiTriangleArrowLine",glyphRepReversibleArrowLine:"repReversibleArrowLine",glyphRepOpenArrowDiLine:"repOpenArrowDiLine",glyphRepHeatSymbol:"repHeatSymbol",glyphRepAddSymbol:"repAddSymbol"}),Kekule.Editor.ActionOperUtils={addObjectsToChemSpaceEditor:function(editor,objs,coordOffset){var chemSpace=editor.getChemSpace&&editor.getChemSpace();if(editor&&chemSpace&&editor.canAddNewStandaloneObject&&editor.canAddNewStandaloneObject()){editor.beginUpdateObject();try{for(var marcoOper=new Kekule.MacroOperation,i=0,l=objs.length;i<l;++i){var obj=objs[i],oper=new Kekule.ChemObjOperation.Add(objs[i],chemSpace);marcoOper.add(oper)}if(marcoOper.execute(),coordOffset)for(var i=0,l=objs.length;i<l;++i){var obj=objs[i],coord=editor.getObjectScreenCoord(obj),newCoord=Kekule.CoordUtils.add(coord,coordOffset);editor.setObjectScreenCoord(obj,newCoord)}editor.pushOperation(marcoOper),editor.select(objs)}finally{editor.endUpdateObject()}}}},Kekule.Editor.ActionOnEditor=Class.create(Kekule.ChemWidget.ActionOnDisplayer,{CLASS_NAME:"Kekule.Editor.ActionOnEditor",initialize:function($super,editor,caption,hint){$super(editor,caption,hint)},doUpdate:function(){var displayer=this.getDisplayer();this.setEnabled(displayer&&displayer.getChemObj()&&displayer.getChemObjLoaded()&&displayer.getEnabled())},getEditor:function(){var result=this.getDisplayer();return result instanceof Kekule.Editor.BaseEditor?result:null}}),Kekule.Editor.ActionEditorUndo=Class.create(Kekule.Editor.ActionOnEditor,{CLASS_NAME:"Kekule.Editor.ActionEditorUndo",HTML_CLASSNAME:CCNS.ACTION_UNDO,initialize:function($super,editor){$super(editor,Kekule.$L("ChemWidgetTexts.CAPTION_UNDO"),Kekule.$L("ChemWidgetTexts.HINT_UNDO"))},doUpdate:function($super){$super(),this.getEnabled()&&this.setEnabled(this.getEditor().canUndo())},doExecute:function(){var editor=this.getEditor();editor&&editor.undo()}}),Kekule.Editor.ActionEditorRedo=Class.create(Kekule.Editor.ActionOnEditor,{CLASS_NAME:"Kekule.Editor.ActionEditorRedo",HTML_CLASSNAME:CCNS.ACTION_REDO,initialize:function($super,editor){$super(editor,Kekule.$L("ChemWidgetTexts.CAPTION_REDO"),Kekule.$L("ChemWidgetTexts.HINT_REDO"))},doUpdate:function($super){$super(),this.getEnabled()&&this.setEnabled(this.getEditor().canRedo())},doExecute:function(){var editor=this.getEditor();editor&&editor.redo()}}),Kekule.Editor.ActionEditorNewDoc=Class.create(Kekule.Editor.ActionOnEditor,{CLASS_NAME:"Kekule.Editor.ActionEditorNewDoc",HTML_CLASSNAME:CCNS.ACTION_NEWDOC,initialize:function($super,editor){$super(editor,Kekule.$L("ChemWidgetTexts.CAPTION_NEWDOC"),Kekule.$L("ChemWidgetTexts.HINT_NEWDOC"))},doUpdate:function(){var editor=this.getDisplayer();this.setEnabled(editor&&editor.getEnabled()&&editor.getEnableCreateNewDoc())},doExecute:function(){var editor=this.getEditor();editor&&editor.newDoc()}}),Kekule.Editor.ActionCloneSelection=Class.create(Kekule.Editor.ActionOnEditor,{CLASS_NAME:"Kekule.Editor.ActionCloneSelection",HTML_CLASSNAME:CCNS.ACTION_CLONE_SELECTION,initialize:function($super,editor){$super(editor,Kekule.$L("ChemWidgetTexts.CAPTION_CLONESELECTION"),Kekule.$L("ChemWidgetTexts.HINT_CLONE_SELECTION"))},_hasCloneMethod:function(){var editor=this.getEditor();return editor&&editor.cloneSelection},doUpdate:function($super){$super(),this.getEnabled()&&this.setEnabled(this._hasCloneMethod()&&this.getEditor().hasSelection()),this.setDisplayed(this._hasCloneMethod()&&this.getEditor().canCloneObjects())},doExecute:function(){var editor=this.getEditor();if(editor&&editor.getChemSpace){var coordOffset=editor.getDefaultCloneScreenCoordOffset&&editor.getDefaultCloneScreenCoordOffset(),objs=editor.cloneSelection();Kekule.Editor.ActionOperUtils.addObjectsToChemSpaceEditor(editor,objs,coordOffset)}}}),Kekule.Editor.ActionCopySelection=Class.create(Kekule.Editor.ActionOnEditor,{CLASS_NAME:"Kekule.Editor.ActionCopySelection",HTML_CLASSNAME:CCNS.ACTION_COPY,initialize:function($super,editor){$super(editor,Kekule.$L("ChemWidgetTexts.CAPTION_COPY"),Kekule.$L("ChemWidgetTexts.HINT_COPY"))},doUpdate:function($super){$super(),this.getEnabled()&&this.setEnabled(this.getEditor().hasSelection())},doExecute:function(){var editor=this.getEditor(),chemSpace=editor.getChemSpace&&editor.getChemSpace();if(editor&&chemSpace){var objs=editor.cloneSelection();Kekule.Widget.clipboard.setObjects(Kekule.IO.MimeType.JSON,objs)}}}),Kekule.Editor.ActionCutSelection=Class.create(Kekule.Editor.ActionOnEditor,{CLASS_NAME:"Kekule.Editor.ActionCutSelection",HTML_CLASSNAME:CCNS.ACTION_CUT,initialize:function($super,editor){$super(editor,Kekule.$L("ChemWidgetTexts.CAPTION_CUT"),Kekule.$L("ChemWidgetTexts.HINT_CUT"))},doUpdate:function($super){$super(),this.getEnabled()&&this.setEnabled(this.getEditor().hasSelection())},doExecute:function(){var editor=this.getEditor(),chemSpace=editor.getChemSpace&&editor.getChemSpace();if(editor&&chemSpace){var objs=editor.cloneSelection();Kekule.Widget.clipboard.setObjects(Kekule.IO.MimeType.JSON,objs);var controller=editor.getIaController("BasicMolEraserIaController");controller&&controller.removeSelection()}}}),Kekule.Editor.ActionPaste=Class.create(Kekule.Editor.ActionOnEditor,{CLASS_NAME:"Kekule.Editor.ActionPaste",HTML_CLASSNAME:CCNS.ACTION_PASTE,initialize:function($super,editor){$super(editor,Kekule.$L("ChemWidgetTexts.CAPTION_PASTE"),Kekule.$L("ChemWidgetTexts.HINT_PASTE")),Kekule.Widget.clipboard.addEventListener("setData",this._reactClipboardChange,this)},finalize:function($super){Kekule.Widget.clipboard.removeEventListener("setData",this._reactClipboardChange,this),$super()},_reactClipboardChange:function(){this.update()},doUpdate:function($super){$super(),this.getEnabled()&&this.setEnabled(Kekule.Widget.clipboard.hasData(Kekule.IO.MimeType.JSON)&&this.getEditor().canAddNewStandaloneObject())},getObjsCenterScreenCoord:function(editor,objects){for(var BU=Kekule.BoxUtils,CU=Kekule.CoordUtils,containerBox=null,i=0,l=objects.length;i<l;++i){var box=Kekule.Render.ObjUtils.getContainerBox(objects[i],editor.getCoordMode(),editor.getAllowCoordBorrow());containerBox=containerBox?BU.getContainerBox(box,containerBox):box}var coords=BU.getMinMaxCoords(containerBox),screenCoords={min:editor.objCoordToScreen(coords.min),max:editor.objCoordToScreen(coords.max)},result=CU.add(screenCoords.min,screenCoords.max),result=CU.divide(result,2);return result},doExecute:function(){var editor=this.getEditor();if(editor&&editor.getChemSpace){var objs=Kekule.Widget.clipboard.getObjects(Kekule.IO.MimeType.JSON),coordOffset=null,selObjs=editor.getSelection();if(selObjs&&selObjs.length){coordOffset=editor.getDefaultCloneScreenCoordOffset?editor.getDefaultCloneScreenCoordOffset():null;var originalSelectedObjs=AU.clone(selObjs);if(originalSelectedObjs&&originalSelectedObjs.length&&coordOffset){var originCenterCoord=this.getObjsCenterScreenCoord(editor,originalSelectedObjs),targetCenterCoord=this.getObjsCenterScreenCoord(editor,objs),deltaCoord=Kekule.CoordUtils.substract(originCenterCoord,targetCenterCoord);coordOffset=Kekule.CoordUtils.add(coordOffset,deltaCoord)}}Kekule.Editor.ActionOperUtils.addObjectsToChemSpaceEditor(editor,objs,coordOffset)}}}),Kekule.Editor.ActionOnComposer=Class.create(Kekule.Action,{CLASS_NAME:"Kekule.Editor.ActionOnComposer",initialize:function($super,composer,caption,hint){$super(),this.setText(caption),this.setHint(hint),this.setComposer(composer)},initProperties:function(){this.defineProp("composer",{dataType:"Kekule.Editor.Composer",serializable:!1})},doUpdate:function(){var composer=this.getComposer(),editor=this.getEditor();this.setEnabled(composer&&composer.getEnabled()&&editor&&editor.getChemObj()&&editor.getChemObjLoaded()&&editor.getEnabled())},getEditor:function(){var composer=this.getComposer();return composer?composer.getEditor():null}}),Kekule.Editor.ActionOnComposerAdv=Class.create(Kekule.Editor.ActionOnComposer,{CLASS_NAME:"Kekule.Editor.ActionOnComposerAdv",initialize:function($super,composer,caption,hint){var actions=new Kekule.ActionList;actions.setOwnActions(!0),this.setPropStoreFieldValue("attachedActions",actions),$super(composer,caption,hint)},finalize:function($super){this.getAttachedActions().finalize(),$super()},initProperties:function(){this.defineProp("attachedActionClasses",{dataType:DataType.ARRAY,serializable:!1,setter:null}),this.defineProp("attachedActions",{dataType:"Kekule.ActionList",serializable:!1,setter:null}),this.defineProp("defaultAttachedAction",{dataType:"Kekule.Action",serializable:!1})},checkedChanged:function($super){$super();var checked=this.getChecked();if(this.hasAttachedActions()){var composer=this.getComposer();if(composer)if(checked){var attachedActions=this.getAttachedActions();composer.bindAssocActions(attachedActions),composer.showAssocToolbar();var checkedChild=attachedActions.getCheckedAction(this.getClassName());checkedChild||(checkedChild=this.getDefaultAttachedAction()),checkedChild&&(checkedChild.setChecked(!1),checkedChild.execute())}else composer.hideAssocToolbar()}},hasAttachedActions:function(){return!!this.getAttachedActions().getActionCount()},addAttachedAction:function(action,asDefault){return this.getAttachedActions().add(action),asDefault&&this.setDefaultAttachedAction(action),this},removeAttachedAction:function(action){return this.getDefaultAttachedAction()===action&&this.setDefaultAttachedAction(null),this.getAttachedActions().remove(action),this},clearAttachedActions:function(){this.setDefaultAttachedAction(null),this.getAttachedActions().clear()},doExecute:function(){},update:function($super){$super(),this.getAttachedActions().updateAll()}}),Kekule.Editor.ActionComposerToggleInspector=Class.create(Kekule.Editor.ActionOnComposer,{CLASS_NAME:"Kekule.Editor.ActionComposerToggleInspector",HTML_CLASSNAME:CCNS.ACTION_TOGGLE_INSPECTOR,initialize:function($super,composer){$super(composer,Kekule.$L("ChemWidgetTexts.CAPTION_TOGGLE_INSPECTOR"),Kekule.$L("ChemWidgetTexts.HINT_TOGGLE_INSPECTOR"))},doUpdate:function(){var composer=this.getComposer();composer&&this.setChecked(composer.getShowInspector())},doExecute:function(){var composer=this.getComposer();composer&&(this.setChecked(!this.getChecked()),composer.setShowInspector(this.getChecked()))}}),Kekule.Editor.ActionComposerSetIaController=Class.create(Kekule.Editor.ActionOnComposerAdv,{CLASS_NAME:"Kekule.Editor.ActionComposerSetIaController",initialize:function($super,composer,caption,hint,controllerId){$super(composer,caption,hint),this.setPropStoreFieldValue("iaControllerId",controllerId)},initProperties:function(){this.defineProp("iaControllerId",{dataType:DataType.STRING,serializable:!1,setter:null})},doExecute:function(){this.getEditor().setActiveIaControllerId(this.getIaControllerId())}}),Kekule.Editor.createComposerIaControllerActionClass=function(className,caption,hint,iaControllerId,htmlClassName,specifiedProps,attachedActionClasses,methods,actionRegName,actionTargetClass){htmlClassName||(htmlClassName=iaControllerId),htmlClassName.startsWith(Kekule.ChemWidget.HtmlClassNames.PREFIX)||(htmlClassName=Kekule.ChemWidget.HtmlClassNames.PREFIX+htmlClassName);var data={CLASS_NAME:className,HTML_CLASSNAME:htmlClassName,initialize:function($super,composer){$super(composer,caption,hint,iaControllerId),this.initAttachedActions&&this.initAttachedActions()}};specifiedProps&&(data.doExecute=function($super){var editor=this.getEditor(),controller=editor.getIaController(iaControllerId);controller&&controller.setPropValues(specifiedProps),$super()}),methods&&(data=Object.extend(data,methods)),attachedActionClasses&&(data.initAttachedActions=function(){this.setPropStoreFieldValue("attachedActionClasses",attachedActionClasses)});var result=Class.create(Kekule.Editor.ActionComposerSetIaController,data);return actionRegName&&_editorActionRegInfo.push({name:actionRegName,actionClass:result,widgetClass:actionTargetClass}),result},Kekule.Editor.ActionComposerSetManipulateController=Kekule.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetManipulateController",Kekule.$L("ChemWidgetTexts.CAPTION_MANIPULATE"),Kekule.$L("ChemWidgetTexts.HINT_MANIPULATE"),"BasicMolManipulationIaController",null,null,null,null,BNS.manipulate),Kekule.Editor.ActionComposerSetEraserController=Kekule.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetEraserController",Kekule.$L("ChemWidgetTexts.CAPTION_ERASE"),Kekule.$L("ChemWidgetTexts.HINT_ERASE"),"BasicMolEraserIaController",null,null,null,{doExecute:function($super){$super();var editor=this.getEditor();editor.hasSelection()&&editor.getActiveIaController().removeSelection()}},BNS.erase),Kekule.Editor.ActionComposerSetBondControllerSingle=Kekule.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetBondControllerSingle",Kekule.$L("ChemWidgetTexts.CAPTION_MOL_BOND_SINGLE"),Kekule.$L("ChemWidgetTexts.HINT_MOL_BOND_SINGLE"),"MolBondIaController","MolBondIaController-Single",{bondType:Kekule.BondType.COVALENT,bondOrder:Kekule.BondOrder.SINGLE,bondStereo:Kekule.BondStereo.NONE},null,null,BNS.molBondSingle),Kekule.Editor.ActionComposerSetBondControllerDouble=Kekule.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetBondControllerDouble",Kekule.$L("ChemWidgetTexts.CAPTION_MOL_BOND_DOUBLE"),Kekule.$L("ChemWidgetTexts.HINT_MOL_BOND_DOUBLE"),"MolBondIaController","MolBondIaController-Double",{bondType:Kekule.BondType.COVALENT,bondOrder:Kekule.BondOrder.DOUBLE,bondStereo:Kekule.BondStereo.NONE},null,null,BNS.molBondDouble),Kekule.Editor.ActionComposerSetBondControllerTriple=Kekule.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetBondControllerTriple",Kekule.$L("ChemWidgetTexts.CAPTION_MOL_BOND_TRIPLE"),Kekule.$L("ChemWidgetTexts.HINT_MOL_BOND_TRIPLE"),"MolBondIaController","MolBondIaController-Triple",{bondType:Kekule.BondType.COVALENT,bondOrder:Kekule.BondOrder.TRIPLE,bondStereo:Kekule.BondStereo.NONE},null,null,BNS.molBondTriple),Kekule.Editor.ActionComposerSetBondControllerCloser=Kekule.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetBondControllerCloser",Kekule.$L("ChemWidgetTexts.CAPTION_MOL_BOND_CLOSER"),Kekule.$L("ChemWidgetTexts.HINT_MOL_BOND_CLOSER"),"MolBondIaController","MolBondIaController-Closer",{bondType:Kekule.BondType.COVALENT,bondOrder:Kekule.BondOrder.SINGLE,bondStereo:Kekule.BondStereo.CLOSER},null,null,BNS.molBondCloser),Kekule.Editor.ActionComposerSetBondControllerWedgeUp=Kekule.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetBondControllerWedgeUp",Kekule.$L("ChemWidgetTexts.CAPTION_MOL_BOND_WEDGEUP"),Kekule.$L("ChemWidgetTexts.HINT_MOL_BOND_WEDGEUP"),"MolBondIaController","MolBondIaController-WedgeUp",{bondType:Kekule.BondType.COVALENT,bondOrder:Kekule.BondOrder.SINGLE,bondStereo:Kekule.BondStereo.UP},null,null,BNS.molBondWedgeUp),Kekule.Editor.ActionComposerSetBondControllerWedgeDown=Kekule.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetBondControllerWedgeDown",Kekule.$L("ChemWidgetTexts.CAPTION_MOL_BOND_WEDGEDOWN"),Kekule.$L("ChemWidgetTexts.HINT_MOL_BOND_WEDGEDOWN"),"MolBondIaController","MolBondIaController-WedgeDown",{bondType:Kekule.BondType.COVALENT,bondOrder:Kekule.BondOrder.SINGLE,bondStereo:Kekule.BondStereo.DOWN},null,null,BNS.molBondWedgeDown),Kekule.Editor.ActionComposerSetBondControllerWedgeUpOrDown=Kekule.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetBondControllerWedgeUpOrDown",Kekule.$L("ChemWidgetTexts.CAPTION_MOL_BOND_WAVY"),Kekule.$L("ChemWidgetTexts.HINT_MOL_BOND_WAVY"),"MolBondIaController","MolBondIaController-WedgeUpOrDown",{bondType:Kekule.BondType.COVALENT,bondOrder:Kekule.BondOrder.SINGLE,bondStereo:Kekule.BondStereo.UP_OR_DOWN},null,null,BNS.molBondWedgeUpOrDown),Kekule.Editor.ActionComposerSetBondControllerDoubleEither=Kekule.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetBondControllerDoubleEither",Kekule.$L("ChemWidgetTexts.CAPTION_MOL_BOND_DOUBLE_EITHER"),Kekule.$L("ChemWidgetTexts.HINT_MOL_BOND_DOUBLE_EITHER"),"MolBondIaController","MolBondIaController-Double-Either",{bondType:Kekule.BondType.COVALENT,bondOrder:Kekule.BondOrder.DOUBLE,bondStereo:Kekule.BondStereo.E_OR_Z},null,null,BNS.molBondDoubleEither),Kekule.Editor.ActionComposerSetRepositoryFischer1Controller=Kekule.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryFischer1Controller",Kekule.$L("ChemWidgetTexts.CAPTION_REPOSITORY_FISCHER1"),Kekule.$L("ChemWidgetTexts.HINT_REPOSITORY_FISCHER1"),"RepositoryStructureFragmentIaController","RepositoryStructureFragmentIaController-Fischer1",{repItemName:"fischer1"},null,null,BNS.molRepFischer1),Kekule.Editor.ActionComposerSetRepositoryFischer2Controller=Kekule.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryFischer2Controller",Kekule.$L("ChemWidgetTexts.CAPTION_REPOSITORY_FISCHER2"),Kekule.$L("ChemWidgetTexts.HINT_REPOSITORY_FISCHER2"),"RepositoryStructureFragmentIaController","RepositoryStructureFragmentIaController-Fischer2",{repItemName:"fischer2"},null,null,BNS.molRepFischer2),Kekule.Editor.ActionComposerSetRepositoryFischer3Controller=Kekule.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryFischer3Controller",Kekule.$L("ChemWidgetTexts.CAPTION_REPOSITORY_FISCHER3"),Kekule.$L("ChemWidgetTexts.HINT_REPOSITORY_FISCHER3"),"RepositoryStructureFragmentIaController","RepositoryStructureFragmentIaController-Fischer3",{repItemName:"fischer3"},null,null,BNS.molRepFischer3),Kekule.Editor.ActionComposerSetRepositorySawhorseStaggeredController=Kekule.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositorySawhorseStaggeredController",Kekule.$L("ChemWidgetTexts.CAPTION_REPOSITORY_SAWHORSE_STAGGERED"),Kekule.$L("ChemWidgetTexts.HINT_REPOSITORY_SAWHORSE_STAGGERED"),"RepositoryStructureFragmentIaController","RepositoryStructureFragmentIaController-SawhorseStaggered",{repItemName:"sawhorseStaggered"},null,null,BNS.molRepSawhorseStaggered),Kekule.Editor.ActionComposerSetRepositorySawhorseEclipsedController=Kekule.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositorySawhorseEclipsedController",Kekule.$L("ChemWidgetTexts.CAPTION_REPOSITORY_SAWHORSE_ECLIPSED"),Kekule.$L("ChemWidgetTexts.HINT_REPOSITORY_SAWHORSE_ECLIPSED"),"RepositoryStructureFragmentIaController","RepositoryStructureFragmentIaController-SawhorseEclipsed",{repItemName:"sawhorseEclipsed"},null,null,BNS.molRepSawhorseEclipsed),Kekule.Editor.ActionComposerSetRepositoryMethaneController=Kekule.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryMethaneController",Kekule.$L("ChemWidgetTexts.CAPTION_REPOSITORY_METHANE"),Kekule.$L("ChemWidgetTexts.HINT_REPOSITORY_METHANE"),"RepositoryStructureFragmentIaController","RepositoryStructureFragmentIaController-Methane",{repItemName:"methane"},null,null,BNS.molRepMethane),Kekule.Editor.ActionComposerSetRepositorySubBondMarkController=Kekule.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositorySubBondMarkController",Kekule.$L("ChemWidgetTexts.CAPTION_REPOSITORY_SUBBOND_MARK"),Kekule.$L("ChemWidgetTexts.HINT_REPOSITORY_SUBBOND_MARK"),"RepositoryStructureFragmentIaController","RepositoryStructureFragmentIaController-SubBondMark",{repItemName:"substituentMark"},null,null,BNS.molRepSubBondMark),Kekule.Editor.ActionComposerSetBondController=Kekule.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetBondController",Kekule.$L("ChemWidgetTexts.CAPTION_MOL_BOND"),Kekule.$L("ChemWidgetTexts.HINT_MOL_BOND"),"MolBondIaController",null,null,[Kekule.Editor.ActionComposerSetBondControllerSingle,Kekule.Editor.ActionComposerSetBondControllerDouble,Kekule.Editor.ActionComposerSetBondControllerTriple,Kekule.Editor.ActionComposerSetBondControllerCloser,Kekule.Editor.ActionComposerSetBondControllerWedgeUp,Kekule.Editor.ActionComposerSetBondControllerWedgeDown,Kekule.Editor.ActionComposerSetBondControllerWedgeUpOrDown,Kekule.Editor.ActionComposerSetBondControllerDoubleEither,Kekule.Editor.ActionComposerSetRepositoryMethaneController,Kekule.Editor.ActionComposerSetRepositoryFischer1Controller,Kekule.Editor.ActionComposerSetRepositoryFischer2Controller,Kekule.Editor.ActionComposerSetRepositoryFischer3Controller,Kekule.Editor.ActionComposerSetRepositorySawhorseStaggeredController,Kekule.Editor.ActionComposerSetRepositorySawhorseEclipsedController],null,BNS.molBond),Kekule.Editor.ActionComposerSetAtomController=Kekule.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetAtomController",Kekule.$L("ChemWidgetTexts.CAPTION_MOL_ATOM"),Kekule.$L("ChemWidgetTexts.HINT_MOL_ATOM"),"MolAtomIaController",null,null,null,null,BNS.molAtom),Kekule.Editor.ActionComposerSetFormulaController=Kekule.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetFormulaController",Kekule.$L("ChemWidgetTexts.CAPTION_MOL_FORMULA"),Kekule.$L("ChemWidgetTexts.HINT_MOL_FORMULA"),"FormulaIaController",null,null,null,null,BNS.molFormula),Kekule.Editor.ActionComposerSetAttachedMarkerIaControllerLonePair=Kekule.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetAttachedMarkerIaControllerLonePair",Kekule.$L("ChemWidgetTexts.CAPTION_MOL_ELECTRON_LONEPAIR"),Kekule.$L("ChemWidgetTexts.HINT_MOL_ELECTRON_LONEPAIR"),"AttachedMarkerIaController","AttachedMarkerIaController-LonePair",{markerClass:Kekule.ChemMarker.UnbondedElectronSet,targetClass:Kekule.AbstractAtom,initialPropValues:{electronCount:2}},null,null,BNS.molElectronLonePair),Kekule.Editor.ActionComposerSetNodeChargeControllerClear=Kekule.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetNodeChargeControllerClear",Kekule.$L("ChemWidgetTexts.CAPTION_MOL_CHARGE_CLEAR"),Kekule.$L("ChemWidgetTexts.HINT_MOL_CHARGE_CLEAR"),"MolNodeChargeIaController","MolNodeChargeIaController-Clear",{charge:0,chargeInc:0,radical:Kekule.RadicalOrder.NONE},null,null,BNS.molChargeClear),Kekule.Editor.ActionComposerSetNodeChargeControllerPositive=Kekule.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetNodeChargeControllerPositive",Kekule.$L("ChemWidgetTexts.CAPTION_MOL_CHARGE_POSITIVE"),Kekule.$L("ChemWidgetTexts.HINT_MOL_CHARGE_POSITIVE"),"MolNodeChargeIaController","MolNodeChargeIaController-Positive",{charge:null,chargeInc:1,radical:Kekule.RadicalOrder.NONE},null,null,BNS.molChargePositive),Kekule.Editor.ActionComposerSetNodeChargeControllerNegative=Kekule.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetNodeChargeControllerNegative",Kekule.$L("ChemWidgetTexts.CAPTION_MOL_CHARGE_NEGATIVE"),Kekule.$L("ChemWidgetTexts.HINT_MOL_CHARGE_NEGATIVE"),"MolNodeChargeIaController","MolNodeChargeIaController-Negative",{charge:null,chargeInc:-1,radical:Kekule.RadicalOrder.NONE},null,null,BNS.molChargeNegative),Kekule.Editor.ActionComposerSetNodeChargeControllerRadicalSinglet=Kekule.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetNodeChargeControllerRadicalSinglet",Kekule.$L("ChemWidgetTexts.CAPTION_MOL_CHARGE_SINGLET"),Kekule.$L("ChemWidgetTexts.HINT_MOL_CHARGE_SINGLET"),"MolNodeChargeIaController","MolNodeChargeIaController-Singlet",{charge:null,chargeInc:0,radical:Kekule.RadicalOrder.SINGLET},null,null,BNS.molRadicalSinglet),Kekule.Editor.ActionComposerSetNodeChargeControllerRadicalTriplet=Kekule.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetNodeChargeControllerRadicalTriplet",Kekule.$L("ChemWidgetTexts.CAPTION_MOL_CHARGE_TRIPLET"),Kekule.$L("ChemWidgetTexts.HINT_MOL_CHARGE_TRIPLET"),"MolNodeChargeIaController","MolNodeChargeIaController-Triplet",{charge:null,chargeInc:0,radical:Kekule.RadicalOrder.TRIPLET},null,null,BNS.molRadicalTriplet),Kekule.Editor.ActionComposerSetNodeChargeControllerRadicalDoublet=Kekule.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetNodeChargeControllerRadicalDoublet",Kekule.$L("ChemWidgetTexts.CAPTION_MOL_CHARGE_DOUBLET"),Kekule.$L("ChemWidgetTexts.HINT_MOL_CHARGE_DOUBLET"),"MolNodeChargeIaController","MolNodeChargeIaController-Doublet",{charge:null,chargeInc:0,radical:Kekule.RadicalOrder.DOUBLET},null,null,BNS.molRadicalDoublet),Kekule.Editor.ActionComposerSetNodeChargeController=Kekule.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetNodeChargeController",Kekule.$L("ChemWidgetTexts.CAPTION_MOL_CHARGE"),Kekule.$L("ChemWidgetTexts.HINT_MOL_CHARGE"),"MolNodeChargeIaController",null,null,[Kekule.Editor.ActionComposerSetNodeChargeControllerClear,Kekule.Editor.ActionComposerSetNodeChargeControllerPositive,Kekule.Editor.ActionComposerSetNodeChargeControllerNegative,Kekule.Editor.ActionComposerSetNodeChargeControllerRadicalSinglet,Kekule.Editor.ActionComposerSetNodeChargeControllerRadicalTriplet,Kekule.Editor.ActionComposerSetNodeChargeControllerRadicalDoublet,Kekule.Editor.ActionComposerSetAttachedMarkerIaControllerLonePair],null,BNS.molCharge),Kekule.Editor.ActionComposerSetTextBlockController=Kekule.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetTextBlockController",Kekule.$L("ChemWidgetTexts.CAPTION_TEXT_BLOCK"),Kekule.$L("ChemWidgetTexts.HINT_TEXT_BLOCK"),"TextBlockIaController",null,null,null,null,BNS.textBlock),Kekule.Editor.ActionComposerSetImageBlockController=Kekule.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetImageBlockController",Kekule.$L("ChemWidgetTexts.CAPTION_IMAGE_BLOCK"),Kekule.$L("ChemWidgetTexts.HINT_IMAGE_BLOCK"),"ImageBlockIaController",null,null,null,null,BNS.imageBlock),Kekule.Editor.ActionComposerSetTextImageController=Kekule.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetTextImageController",Kekule.$L("ChemWidgetTexts.CAPTION_TEXT_IMAGE"),Kekule.$L("ChemWidgetTexts.HINT_TEXT_IMAGE"),"TextImageIaController","TextImageIaController",null,[Kekule.Editor.ActionComposerSetTextBlockController,Kekule.Editor.ActionComposerSetImageBlockController],null,BNS.textImage),Kekule.Editor.ActionComposerSetRepositoryRing3Controller=Kekule.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryRing3Controller",Kekule.$L("ChemWidgetTexts.CAPTION_REPOSITORY_RING_3"),Kekule.$L("ChemWidgetTexts.HINT_REPOSITORY_RING_3"),"MolRingIaController","MolRingIaController-3",{ringAtomCount:3,isAromatic:!1},null,null,BNS.molRing3),Kekule.Editor.ActionComposerSetRepositoryRing4Controller=Kekule.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryRing4Controller",Kekule.$L("ChemWidgetTexts.CAPTION_REPOSITORY_RING_4"),Kekule.$L("ChemWidgetTexts.HINT_REPOSITORY_RING_4"),"MolRingIaController","MolRingIaController-4",{ringAtomCount:4,isAromatic:!1},null,null,BNS.molRing4),Kekule.Editor.ActionComposerSetRepositoryRing5Controller=Kekule.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryRing5Controller",Kekule.$L("ChemWidgetTexts.CAPTION_REPOSITORY_RING_5"),Kekule.$L("ChemWidgetTexts.HINT_REPOSITORY_RING_5"),"MolRingIaController","MolRingIaController-5",{ringAtomCount:5,isAromatic:!1},null,null,BNS.molRing5),Kekule.Editor.ActionComposerSetRepositoryRing6Controller=Kekule.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryRing6Controller",Kekule.$L("ChemWidgetTexts.CAPTION_REPOSITORY_RING_6"),Kekule.$L("ChemWidgetTexts.HINT_REPOSITORY_RING_6"),"MolRingIaController","MolRingIaController-6",{ringAtomCount:6,isAromatic:!1},null,null,BNS.molRing6),Kekule.Editor.ActionComposerSetRepositoryRing7Controller=Kekule.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryRing7Controller",Kekule.$L("ChemWidgetTexts.CAPTION_REPOSITORY_RING_7"),Kekule.$L("ChemWidgetTexts.HINT_REPOSITORY_RING_7"),"MolRingIaController","MolRingIaController-7",{ringAtomCount:7,isAromatic:!1},null,null,BNS.molRing7),Kekule.Editor.ActionComposerSetRepositoryRing8Controller=Kekule.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryRing8Controller",Kekule.$L("ChemWidgetTexts.CAPTION_REPOSITORY_RING_8"),Kekule.$L("ChemWidgetTexts.HINT_REPOSITORY_RING_8"),"MolRingIaController","MolRingIaController-8",{ringAtomCount:8,isAromatic:!1},null,null,BNS.molRing8),Kekule.Editor.ActionComposerSetRepositoryRingAr6Controller=Kekule.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryRingAr6Controller",Kekule.$L("ChemWidgetTexts.CAPTION_REPOSITORY_RING_AR_6"),Kekule.$L("ChemWidgetTexts.HINT_REPOSITORY_RING_AR_6"),"MolRingIaController","MolRingIaController-Ar-6",{ringAtomCount:6,isAromatic:!0},null,null,BNS.molRingAr6),Kekule.Editor.ActionComposerSetRepositoryRingAr5Controller=Kekule.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryRingAr5Controller",Kekule.$L("ChemWidgetTexts.CAPTION_REPOSITORY_RING_AR_5"),Kekule.$L("ChemWidgetTexts.HINT_REPOSITORY_RING_AR_5"),"MolRingIaController","MolRingIaController-Ar-5",{ringAtomCount:5,isAromatic:!0},null,null,BNS.molRingAr5),Kekule.Editor.ActionComposerSetRepositoryCyclopentaneHaworth1Controller=Kekule.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryCyclopentaneHaworth1Controller",Kekule.$L("ChemWidgetTexts.CAPTION_REPOSITORY_CYCLOPENTANE_HARWORTH1"),Kekule.$L("ChemWidgetTexts.HINT_REPOSITORY_CYCLOPENTANE_HARWORTH1"),"RepositoryStructureFragmentIaController","RepositoryStructureFragmentIaController-CyclopentaneHaworth1",{repItemName:"cyclopentaneHaworth1"},null,null,BNS.molRepCyclopentaneHaworth1),Kekule.Editor.ActionComposerSetRepositoryCyclopentaneHaworth2Controller=Kekule.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryCyclopentaneHaworth2Controller",Kekule.$L("ChemWidgetTexts.CAPTION_REPOSITORY_CYCLOPENTANE_HARWORTH2"),Kekule.$L("ChemWidgetTexts.HINT_REPOSITORY_CYCLOPENTANE_HARWORTH2"),"RepositoryStructureFragmentIaController","RepositoryStructureFragmentIaController-CyclopentaneHaworth2",{repItemName:"cyclopentaneHaworth2"},null,null,BNS.molRepCyclopentaneHaworth2),Kekule.Editor.ActionComposerSetRepositoryCyclohexaneHaworth1Controller=Kekule.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryCyclohexaneHaworth1Controller",Kekule.$L("ChemWidgetTexts.CAPTION_REPOSITORY_CYCLOHEXANE_HARWORTH1"),Kekule.$L("ChemWidgetTexts.HINT_REPOSITORY_CYCLOHEXANE_HARWORTH1"),"RepositoryStructureFragmentIaController","RepositoryStructureFragmentIaController-CyclohexaneHaworth1",{repItemName:"cyclohexaneHaworth1"},null,null,BNS.molRepCyclohexaneHaworth1),Kekule.Editor.ActionComposerSetRepositoryCyclohexaneHaworth2Controller=Kekule.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryCyclohexaneHaworth2Controller",Kekule.$L("ChemWidgetTexts.CAPTION_REPOSITORY_CYCLOHEXANE_HARWORTH2"),Kekule.$L("ChemWidgetTexts.HINT_REPOSITORY_CYCLOHEXANE_HARWORTH2"),"RepositoryStructureFragmentIaController","RepositoryStructureFragmentIaController-CyclohexaneHaworth2",{repItemName:"cyclohexaneHaworth2"},null,null,BNS.molRepCyclohexaneHaworth2),Kekule.Editor.ActionComposerSetRepositoryCyclohexaneChair1Controller=Kekule.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryCyclohexaneChair1Controller",Kekule.$L("ChemWidgetTexts.CAPTION_REPOSITORY_CYCLOHEXANE_CHAIR1"),Kekule.$L("ChemWidgetTexts.HINT_REPOSITORY_CYCLOHEXANE_CHAIR1"),"RepositoryStructureFragmentIaController","RepositoryStructureFragmentIaController-CyclohexaneChair1",{repItemName:"cyclohexaneChair1"},null,null,BNS.molRepCyclohexaneChair1),Kekule.Editor.ActionComposerSetRepositoryCyclohexaneChair2Controller=Kekule.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryCyclohexaneChair2Controller",Kekule.$L("ChemWidgetTexts.CAPTION_REPOSITORY_CYCLOHEXANE_CHAIR2"),Kekule.$L("ChemWidgetTexts.HINT_REPOSITORY_CYCLOHEXANE_CHAIR2"),"RepositoryStructureFragmentIaController","RepositoryStructureFragmentIaController-CyclohexaneChair2",{repItemName:"cyclohexaneChair2"},null,null,BNS.molRepCyclohexaneChair2),Kekule.Editor.ActionComposerSetRepositoryRingController=Kekule.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryRingController",Kekule.$L("ChemWidgetTexts.CAPTION_REPOSITORY_RING"),Kekule.$L("ChemWidgetTexts.HINT_REPOSITORY_RING"),"MolRingIaController",null,null,[Kekule.Editor.ActionComposerSetRepositoryRing3Controller,Kekule.Editor.ActionComposerSetRepositoryRing4Controller,Kekule.Editor.ActionComposerSetRepositoryRing5Controller,Kekule.Editor.ActionComposerSetRepositoryRing6Controller,Kekule.Editor.ActionComposerSetRepositoryRing7Controller,Kekule.Editor.ActionComposerSetRepositoryRing8Controller,Kekule.Editor.ActionComposerSetRepositoryRingAr6Controller,Kekule.Editor.ActionComposerSetRepositoryRingAr5Controller,Kekule.Editor.ActionComposerSetRepositoryCyclopentaneHaworth1Controller,Kekule.Editor.ActionComposerSetRepositoryCyclopentaneHaworth2Controller,Kekule.Editor.ActionComposerSetRepositoryCyclohexaneHaworth1Controller,Kekule.Editor.ActionComposerSetRepositoryCyclohexaneHaworth2Controller,Kekule.Editor.ActionComposerSetRepositoryCyclohexaneChair1Controller,Kekule.Editor.ActionComposerSetRepositoryCyclohexaneChair2Controller],null,BNS.molRing),Kekule.Editor.ActionComposerSetRepositoryPathLineController=Kekule.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryPathGlyphLineController",Kekule.$L("ChemWidgetTexts.CAPTION_REPOSITORY_GLYPH_LINE"),Kekule.$L("ChemWidgetTexts.HINT_REPOSITORY_GLYPH_LINE"),"ArrowLineIaController","ArrowLineIaController-Line",{glyphClass:Kekule.Glyph.StraightLine,glyphInitialParams:null,lineLength:1.5},null,null,BNS.glyphRepLine),Kekule.Editor.ActionComposerSetRepositoryPathOpenArrowLineController=Kekule.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryPathOpenArrowLineController",Kekule.$L("ChemWidgetTexts.CAPTION_REPOSITORY_GLYPH_OPEN_ARROW_LINE"),Kekule.$L("ChemWidgetTexts.HINT_REPOSITORY_GLYPH_OPEN_ARROW_LINE"),"ArrowLineIaController","ArrowLineIaController-OpenArrowLine",{glyphClass:Kekule.Glyph.StraightLine,glyphInitialParams:{endArrowType:Kekule.Glyph.ArrowType.OPEN,endArrowWidth:.25,endArrowLength:.25,lineLength:1.5}},null,null,BNS.glyphRepOpenArrowLine),Kekule.Editor.ActionComposerSetRepositoryPathTriangleArrowLineController=Kekule.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryPathTriangleArrowLineController",Kekule.$L("ChemWidgetTexts.CAPTION_REPOSITORY_GLYPH_TRIANGLE_ARROW_LINE"),Kekule.$L("ChemWidgetTexts.HINT_REPOSITORY_GLYPH_TRIANGLE_ARROW_LINE"),"ArrowLineIaController","ArrowLineIaController-TriangleArrowLine",{glyphClass:Kekule.Glyph.StraightLine,glyphInitialParams:{endArrowType:Kekule.Glyph.ArrowType.TRIANGLE,endArrowWidth:.25,endArrowLength:.25,lineLength:1.5}},null,null,BNS.glyphRepTriangleArrowLine),Kekule.Editor.ActionComposerSetRepositoryPathDiOpenArrowLineController=Kekule.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryPathDiOpenArrowLineController",Kekule.$L("ChemWidgetTexts.CAPTION_REPOSITORY_GLYPH_DI_OPEN_ARROW_LINE"),Kekule.$L("ChemWidgetTexts.HINT_REPOSITORY_GLYPH_DI_OPEN_ARROW_LINE"),"ArrowLineIaController","ArrowLineIaController-DiOpenArrowLine",{glyphClass:Kekule.Glyph.StraightLine,glyphInitialParams:{startArrowType:Kekule.Glyph.ArrowType.OPEN,startArrowWidth:.25,startArrowLength:.25,endArrowType:Kekule.Glyph.ArrowType.OPEN,endArrowWidth:.25,endArrowLength:.25,lineLength:1.5}},null,null,BNS.glyphRepDiOpenArrowLine),Kekule.Editor.ActionComposerSetRepositoryPathDiTriangleArrowLineController=Kekule.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryPathDiTriangleArrowLineController",Kekule.$L("ChemWidgetTexts.CAPTION_REPOSITORY_GLYPH_DI_TRIANGLE_ARROW_LINE"),Kekule.$L("ChemWidgetTexts.HINT_REPOSITORY_GLYPH_DI_TRIANGLE_ARROW_LINE"),"ArrowLineIaController","ArrowLineIaController-DiTriangleArrowLine",{glyphClass:Kekule.Glyph.StraightLine,glyphInitialParams:{startArrowType:Kekule.Glyph.ArrowType.TRIANGLE,startArrowWidth:.25,startArrowLength:.25,endArrowType:Kekule.Glyph.ArrowType.TRIANGLE,endArrowWidth:.25,endArrowLength:.25,lineLength:1.5}},null,null,BNS.glyphRepDiTriangleArrowLine),Kekule.Editor.ActionComposerSetRepositoryPathReversibleArrowLineController=Kekule.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryPathReversibleArrowLineController",Kekule.$L("ChemWidgetTexts.CAPTION_REPOSITORY_GLYPH_REV_ARROW_LINE"),Kekule.$L("ChemWidgetTexts.HINT_REPOSITORY_GLYPH_REV_ARROW_LINE"),"ArrowLineIaController","ArrowLineIaController-ReversibleArrowLine",{glyphClass:Kekule.Glyph.StraightLine,glyphInitialParams:{startArrowType:Kekule.Glyph.ArrowType.OPEN,startArrowSide:Kekule.Glyph.ArrowSide.REVERSED,startArrowWidth:.25,startArrowLength:.25,endArrowType:Kekule.Glyph.ArrowType.OPEN,endArrowSide:Kekule.Glyph.ArrowSide.SINGLE,endArrowWidth:.25,endArrowLength:.25,lineLength:1.5,lineGap:.1,lineCount:2}},null,null,BNS.glyphRepReversibleArrowLine),Kekule.Editor.ActionComposerSetRepositoryPathOpenArrowDblLineController=Kekule.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryPathOpenArrowDblLineController",Kekule.$L("ChemWidgetTexts.CAPTION_REPOSITORY_GLYPH_OPEN_ARROW_DILINE"),Kekule.$L("ChemWidgetTexts.HINT_REPOSITORY_GLYPH_OPEN_ARROW_DILINE"),"ArrowLineIaController","ArrowLineIaController-OpenArrowDiLine",{glyphClass:Kekule.Glyph.StraightLine,glyphInitialParams:{endArrowType:Kekule.Glyph.ArrowType.OPEN,endArrowWidth:.25,endArrowLength:.25,lineLength:1.5,lineGap:.1,lineCount:2}},null,null,BNS.glyphRepOpenArrowDiLine),Kekule.Editor.ActionComposerSetRepositoryHeatSymbolController=Kekule.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryHeatSymbolController",Kekule.$L("ChemWidgetTexts.CAPTION_REPOSITORY_HEAT_SYMBOL"),Kekule.$L("ChemWidgetTexts.HINT_REPOSITORY_HEAT_SYMBOL"),"ArrowLineIaController","ArrowLineIaController-HeatSymbol",{glyphClass:Kekule.Glyph.HeatSymbol,glyphInitialParams:{lineLength:1}},null,null,BNS.glyphRepHeatSymbol),Kekule.Editor.ActionComposerSetRepositoryAddSymbolController=Kekule.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryAddSymbolController",Kekule.$L("ChemWidgetTexts.CAPTION_REPOSITORY_ADD_SYMBOL"),Kekule.$L("ChemWidgetTexts.HINT_REPOSITORY_ADD_SYMBOL"),"ArrowLineIaController","ArrowLineIaController-AddSymbol",{glyphClass:Kekule.Glyph.AddSymbol,glyphInitialParams:{lineLength:1}},null,null,BNS.glyphRepAddSymbol),Kekule.Editor.ActionComposerSetRepositoryGlyphController=Kekule.Editor.createComposerIaControllerActionClass("Kekule.Editor.ActionComposerSetRepositoryGlyphController",Kekule.$L("ChemWidgetTexts.CAPTION_REPOSITORY_ARROWLINE"),Kekule.$L("ChemWidgetTexts.HINT_REPOSITORY_ARROWLINE"),"ArrowLineIaController",null,null,[Kekule.Editor.ActionComposerSetRepositoryPathOpenArrowLineController,Kekule.Editor.ActionComposerSetRepositoryPathTriangleArrowLineController,Kekule.Editor.ActionComposerSetRepositoryPathDiOpenArrowLineController,Kekule.Editor.ActionComposerSetRepositoryPathDiTriangleArrowLineController,Kekule.Editor.ActionComposerSetRepositoryPathReversibleArrowLineController,Kekule.Editor.ActionComposerSetRepositoryPathOpenArrowDblLineController,Kekule.Editor.ActionComposerSetRepositoryPathLineController,Kekule.Editor.ActionComposerSetRepositoryHeatSymbolController,Kekule.Editor.ActionComposerSetRepositoryAddSymbolController],null,BNS.glyph),Kekule._registerAfterLoadProc(function(){var AM=Kekule.ActionManager,CW=Kekule.ChemWidget,CE=Kekule.Editor,widgetClass=Kekule.Editor.ChemSpaceEditor,reg=AM.registerNamedActionClass;reg(BNS.newDoc,CE.ActionEditorNewDoc,widgetClass),reg(BNS.loadFile,CW.ActionDisplayerLoadFile,widgetClass),reg(BNS.loadData,CW.ActionDisplayerLoadData,widgetClass),reg(BNS.saveData,CW.ActionDisplayerSaveFile,widgetClass),reg(BNS.zoomIn,CW.ActionDisplayerZoomIn,widgetClass),reg(BNS.zoomOut,CW.ActionDisplayerZoomOut,widgetClass),reg(BNS.reset,CW.ActionDisplayerReset,widgetClass),reg(BNS.config,Kekule.Widget.ActionOpenConfigWidget,widgetClass),reg(BNS.undo,CE.ActionEditorUndo,widgetClass),reg(BNS.redo,CE.ActionEditorRedo,widgetClass),reg(BNS.cloneSelection,CE.ActionCloneSelection,widgetClass),reg(BNS.copy,CE.ActionCopySelection,widgetClass),reg(BNS.cut,CE.ActionCutSelection,widgetClass),reg(BNS.paste,CE.ActionPaste,widgetClass),reg(BNS.objInspector,CE.ActionComposerToggleInspector,widgetClass);for(var i=0,l=_editorActionRegInfo.length;i<l;++i){var info=_editorActionRegInfo[i];reg(info.name,info.actionClass,info.widgetClass||widgetClass)}}),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,ClassEx=__webpack_require__(0).ClassEx,DataType=__webpack_require__(0).DataType;module.exports=function(Kekule){var PEA=Kekule.PropertyEditor.EditorAttributes;return Kekule.PropertyEditor.ChemIdEditor=Class.create(Kekule.PropertyEditor.SimpleEditor,{CLASS_NAME:"Kekule.PropertyEditor.ChemIdEditor",getAttributes:function($super){var result=$super();return result&PEA.MULTIOBJS&&(result^=PEA.MULTIOBJS),result}}),Kekule.PropertyEditor.register(Kekule.PropertyEditor.ChemIdEditor,null,Kekule.ChemObject,"id"),Kekule.PropertyEditor.ChemCoordSizeFieldEditor=Class.create(Kekule.PropertyEditor.SimpleEditor,{CLASS_NAME:"Kekule.PropertyEditor.ChemCoordSizeFieldEditor",initProperties:function(){this.defineProp("parentObjects",{dataType:DataType.Object,serializable:!1}),this.defineProp("parentPropName",{dataType:DataType.STRING,serializable:!1})},getCoordFieldValue:function(objs,propName,field){if(objs.length){var coordV=objs[0].getPropValue(propName);if(coordV){for(var result=coordV[field],i=1,l=objs.length;i<l;++i){if(objs[i].getPropValue(propName)[field]!==result)return}return result}}},getValue:function($super){var parentObjs=this.getParentObjects(),parentPropName=this.getParentPropName();return parentObjs&&parentPropName?this.getCoordFieldValue(parentObjs,parentPropName,this.getPropertyName()):$super()}}),Kekule.PropertyEditor.ChemCoordEditor=Class.create(Kekule.PropertyEditor.ObjectEditor,{CLASS_NAME:"Kekule.PropertyEditor.ChemCoordEditor",is3DCoord:function(){return this.getPropertyName().indexOf("3")>=0},getFieldEditorClass:function(objs,fieldName){return Kekule.PropertyEditor.ChemCoordSizeFieldEditor},createFieldEditor:function($super,objs,fieldInfo){var result=$super(objs,fieldInfo);return result.setParentObjects&&result.setParentObjects(this.getObjects()),result.setParentPropName&&result.setParentPropName(this.getPropertyName()),result},getFieldValueType:function(obj,fieldName){return DataType.FLOAT},getObjFields:function(obj){return this.is3DCoord()?["x","y","z"]:["x","y"]},getValueText:function($super){var VDM=Kekule.Widget.ValueListEditor.ValueDisplayMode;if(this.getValueTextMode()===VDM.JSON)return $super();var value=this.getValue();if(value){for(var fields=this.getObjFields(),result="",i=0,l=fields.length;i<l;++i){var v=value[fields[i]];Kekule.ObjUtils.notUnset(v)&&(result&&(result+=", "),result+=fields[i]+": "+v)}return"{"+result+"}"}return""}}),Kekule.PropertyEditor.register(Kekule.PropertyEditor.ChemCoordEditor,null,Kekule.ChemObject,"coord2D"),Kekule.PropertyEditor.register(Kekule.PropertyEditor.ChemCoordEditor,null,Kekule.ChemObject,"coord3D"),Kekule.PropertyEditor.register(Kekule.PropertyEditor.ChemCoordEditor,null,Kekule.ChemObject,"absCoord2D"),Kekule.PropertyEditor.register(Kekule.PropertyEditor.ChemCoordEditor,null,Kekule.ChemObject,"absCoord3D"),Kekule.PropertyEditor.ChemSizeEditor=Class.create(Kekule.PropertyEditor.ObjectEditor,{CLASS_NAME:"Kekule.PropertyEditor.ChemSizeEditor",is3DSize:function(){return this.getPropertyName().indexOf("3")>=0},getFieldEditorClass:function(objs,fieldName){return Kekule.PropertyEditor.ChemCoordSizeFieldEditor},createFieldEditor:function($super,objs,fieldInfo){var result=$super(objs,fieldInfo);return result.setParentObjects&&result.setParentObjects(this.getObjects()),result.setParentPropName&&result.setParentPropName(this.getPropertyName()),result},getFieldValueType:function(obj,fieldName){return DataType.FLOAT},getObjFields:function(obj){return this.is3DSize()?["x","y","z"]:["x","y"]},getValueText:function($super){var VDM=Kekule.Widget.ValueListEditor.ValueDisplayMode;if(this.getValueTextMode()===VDM.JSON)return $super();var value=this.getValue();if(value){for(var fields=this.getObjFields(),result="",i=0,l=fields.length;i<l;++i){var v=value[fields[i]];Kekule.ObjUtils.notUnset(v)&&(result&&(result+=", "),result+=fields[i]+": "+v)}return"{"+result+"}"}return""}}),Kekule.PropertyEditor.register(Kekule.PropertyEditor.ChemSizeEditor,null,Kekule.ChemObject,"size2D"),Kekule.PropertyEditor.register(Kekule.PropertyEditor.ChemSizeEditor,null,Kekule.ChemObject,"size3D"),Kekule.PropertyEditor.register(Kekule.PropertyEditor.ChemSizeEditor,null,Kekule.ChemObject,"screenSize"),Kekule.PropertyEditor.ChemOptionObjectEditor=Class.create(Kekule.PropertyEditor.ObjectEditor,{CLASS_NAME:"Kekule.PropertyEditor.ChemOptionObjectEditor",CHILD_FIELD_INFOS:null,initialize:function($super){$super(),this.setAllowEmpty(!0)},getObjFieldInfos:function(obj){for(var baseClass=ClassEx.getCommonSuperClass(this.getObjects()),result=[],infos=this.CHILD_FIELD_INFOS,i=0,l=infos.length;i<l;++i){var info=infos[i];info.targetClass&&baseClass&&!ClassEx.isOrIsDescendantOf(baseClass,info.targetClass)||result.push(info)}return result.sort(function(a,b){return a.name>b.name?1:a.name<b.name?-1:0}),result},notifyChildEditorValueChange:function($super,fieldName,fieldValue){var old=this.getValue()||this._initialObjValue;old=Object.extend({},old),Kekule.ObjUtils.notUnset(fieldValue)?old[fieldName]=fieldValue:delete old[fieldName],this.setValue(old)}}),Kekule.PropertyEditor.ChemRender2DOptionsEditor=Class.create(Kekule.PropertyEditor.ChemOptionObjectEditor,{CLASS_NAME:"Kekule.PropertyEditor.ChemRender2DOptionsEditor",CHILD_FIELD_INFOS:[{name:"expanded",dataType:DataType.BOOL,targetClass:Kekule.StructureFragment},{name:"unitLength",dataType:DataType.FLOAT,targetClass:Kekule.ChemObject},{name:"moleculeDisplayType",dataType:DataType.INT,enumSource:Kekule.Render.MoleculeDisplayType,targetClass:Kekule.StructureFragment},{name:"renderType",dataType:DataType.INT,enumSource:Kekule.Render.BondRenderType,targetClass:Kekule.ChemStructureConnector},{name:"nodeDisplayMode",dataType:DataType.INT,enumSource:Kekule.Render.NodeLabelDisplayMode,targetClass:Kekule.ChemStructureNode},{name:"hydrogenDisplayLevel",dataType:DataType.INT,enumSource:Kekule.Render.HydrogenDisplayLevel,targetClass:Kekule.ChemStructureNode},{name:"showCharge",dataType:DataType.BOOL,targetClass:Kekule.ChemStructureNode},{name:"chargeMarkType",dataType:DataType.INT,enumSource:Kekule.Render.ChargeMarkRenderType,targetClass:Kekule.ChemStructureNode},{name:"chargeMarkFontSize",dataType:DataType.FLOAT,targetClass:Kekule.ChemStructureNode},{name:"chargeMarkMargin",dataType:DataType.FLOAT,targetClass:Kekule.ChemStructureNode},{name:"chemMarkerFontSize",dataType:DataType.FLOAT,targetClass:Kekule.ChemStructureNode},{name:"chemMarkerMargin",dataType:DataType.FLOAT,targetClass:Kekule.ChemStructureNode},{name:"distinguishSingletAndTripletRadical",dataType:DataType.BOOL,targetClass:Kekule.ChemStructureNode},{name:"fontSize",dataType:DataType.NUMBER},{name:"fontFamily",dataType:DataType.STRING},{name:"supFontSizeRatio",dataType:DataType.FLOAT},{name:"subFontSizeRatio",dataType:DataType.FLOAT},{name:"superscriptOverhang",dataType:DataType.FLOAT},{name:"subscriptOversink",dataType:DataType.FLOAT},{name:"textBoxXAlignment",dataType:DataType.INT,enumSource:Kekule.Render.BoxXAlignment},{name:"textBoxYAlignment",dataType:DataType.INT,enumSource:Kekule.Render.BoxYAlignment},{name:"horizontalAlign",dataType:DataType.INT,enumSource:Kekule.Render.TextAlign},{name:"verticalAlign",dataType:DataType.INT,enumSource:Kekule.Render.TextAlign},{name:"charDirection",dataType:DataType.INT,enumSource:Kekule.Render.TextDirection},{name:"customLabel",dataType:DataType.STRING,targetClass:Kekule.ChemStructureNode},{name:"bondLineWidth",dataType:DataType.NUMBER,targetClass:Kekule.ChemStructureObject},{name:"boldBondLineWidth",dataType:DataType.NUMBER,targetClass:Kekule.ChemStructureObject},{name:"hashSpacing",dataType:DataType.NUMBER,targetClass:Kekule.ChemStructureObject},{name:"multipleBondSpacingRatio",dataType:DataType.NUMBER,targetClass:Kekule.ChemStructureObject},{name:"multipleBondSpacingAbs",dataType:DataType.NUMBER,targetClass:Kekule.ChemStructureObject},{name:"multipleBondMaxAbsSpacing",dataType:DataType.NUMBER,targetClass:Kekule.ChemStructureObject},{name:"bondArrowLength",dataType:DataType.NUMBER,targetClass:Kekule.ChemStructureObject},{name:"bondArrowWidth",dataType:DataType.NUMBER,targetClass:Kekule.ChemStructureObject},{name:"bondWedgeWidth",dataType:DataType.NUMBER,targetClass:Kekule.ChemStructureObject},{name:"bondWedgeHashMinWidth",dataType:DataType.NUMBER,targetClass:Kekule.ChemStructureObject},{name:"bondLengthScaleRatio",dataType:DataType.NUMBER,targetClass:Kekule.ChemStructureObject},{name:"color",dataType:DataType.STRING},{name:"atomColor",dataType:DataType.STRING,targetClass:Kekule.ChemStructureNode},{name:"bondColor",dataType:DataType.STRING,targetClass:Kekule.ChemStructureObject},{name:"useAtomSpecifiedColor",dataType:DataType.BOOL,targetClass:Kekule.ChemStructureObject},{name:"opacity",dataType:DataType.FLOAT,targetClass:Kekule.ChemObject},{name:"fillColor",dataType:DataType.STRING},{name:"strokeColor",dataType:DataType.STRING},{name:"strokeWidth",dataType:DataType.NUMBER},{name:"atomRadius",dataType:DataType.NUMBER,targetClass:Kekule.ChemStructureObject}]}),Kekule.PropertyEditor.register(Kekule.PropertyEditor.ChemRender2DOptionsEditor,null,Kekule.ChemObject,"renderOptions"),Kekule.PropertyEditor.ChemRender3DOptionsEditor=Class.create(Kekule.PropertyEditor.ChemOptionObjectEditor,{CLASS_NAME:"Kekule.PropertyEditor.ChemRender3DOptionsEditor",CHILD_FIELD_INFOS:[{name:"displayMultipleBond",dataType:DataType.BOOL,targetClass:Kekule.ChemStructureNode},{name:"useVdWRadius",dataType:DataType.BOOL,targetClass:Kekule.ChemStructureNode},{name:"nodeRadius",dataType:DataType.NUMBER,targetClass:Kekule.ChemStructureNode},{name:"connectorRadius",dataType:DataType.NUMBER,targetClass:Kekule.ChemStructureObject},{name:"nodeRadiusRatio",dataType:DataType.NUMBER,targetClass:Kekule.ChemStructureNode},{name:"connectorRadiusRatio",dataType:DataType.NUMBER,targetClass:Kekule.ChemStructureObject},{name:"connectorLineWidth",dataType:DataType.NUMBER,targetClass:Kekule.ChemStructureObject},{name:"color",dataType:DataType.STRING},{name:"atomColor",dataType:DataType.STRING,targetClass:Kekule.ChemStructureObject},{name:"bondColor",dataType:DataType.STRING,targetClass:Kekule.ChemStructureObject},{name:"useAtomSpecifiedColor",dataType:DataType.BOOL,targetClass:Kekule.ChemStructureObject},{name:"hideHydrogens",dataType:DataType.BOOL,targetClass:Kekule.StructureFragment},{name:"bondSpliceMode",dataType:DataType.INT,enumSource:Kekule.Render.Bond3DSpliceMode,targetClass:Kekule.ChemStructureObject}]}),Kekule.PropertyEditor.register(Kekule.PropertyEditor.ChemRender3DOptionsEditor,null,Kekule.ChemObject,"render3DOptions"),Kekule.PropertyEditor.GlyphPathParamsEditor=Class.create(Kekule.PropertyEditor.ChemOptionObjectEditor,{CLASS_NAME:"Kekule.PropertyEditor.GlyphPathParamsEditor",CHILD_FIELD_INFOS:[{name:"lineCount",dataType:DataType.INT,targetClass:Kekule.Glyph.PathGlyphConnector},{name:"lineGap",dataType:DataType.FLOAT,targetClass:Kekule.Glyph.PathGlyphConnector},{name:"startArrowType",dataType:DataType.STRING,enumSource:Kekule.Glyph.ArrowType,targetClass:Kekule.Glyph.PathGlyphConnector},{name:"startArrowSide",dataType:DataType.INT,enumSource:Kekule.Glyph.ArrowSide,targetClass:Kekule.Glyph.PathGlyphConnector},{name:"startArrowLength",dataType:DataType.FLOAT,targetClass:Kekule.Glyph.PathGlyphConnector},{name:"startArrowWidth",dataType:DataType.FLOAT,targetClass:Kekule.Glyph.PathGlyphConnector},{name:"endArrowType",dataType:DataType.INT,enumSource:Kekule.Glyph.ArrowType,targetClass:Kekule.Glyph.PathGlyphConnector},{name:"endArrowSide",dataType:DataType.INT,enumSource:Kekule.Glyph.ArrowSide,targetClass:Kekule.Glyph.PathGlyphConnector},{name:"endArrowLength",dataType:DataType.FLOAT,targetClass:Kekule.Glyph.PathGlyphConnector},{name:"endArrowWidth",dataType:DataType.FLOAT,targetClass:Kekule.Glyph.PathGlyphConnector}]}),Kekule.PropertyEditor.register(Kekule.PropertyEditor.GlyphPathParamsEditor,null,Kekule.Glyph.PathGlyphConnector,"pathParams"),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class,ObjectEx=__webpack_require__(0).ObjectEx,DataType=__webpack_require__(0).DataType;module.exports=function(Kekule){Kekule.Calculator={},Kekule.Calculator.getWorkerBasePath=function(){var isMin=Kekule.scriptSrcInfo.useMinFile,path=isMin?"workers/":"calculation/workers/";return path=Kekule.scriptSrcInfo.path+path},Kekule.Calculator.Base=Class.create(ObjectEx,{CLASS_NAME:"Kekule.Calculator.Base",initProperties:function(){this.defineProp("async",{dataType:DataType.BOOL}),this.defineProp("worker",{dataType:DataType.OBJECT,setter:null})},initPropValues:function($super){$super(),this.setAsync(!0),this.reactWorkerMessageBind=this.reactWorkerMessage.bind(this),this.reactWorkerErrorBind=this.reactWorkerError.bind(this)},getWorkerBasePath:function(){return Kekule.Calculator.getWorkerBasePath()},execute:function(callback,errCallback,msgCallback){if(this._doneCallback=callback,this._errCallback=errCallback,this._msgCallback=msgCallback,this.getAsync()&&this.isWorkerSupported()&&this.createWorker()){var w=this.getWorker();this.workerStartCalc(w)}else{var err,executed;try{executed=this.executeSync(callback)}catch(e){err=e}err?(Kekule.error(err),this.error(err)):executed&&(err?this.error(err):this.done())}},executeSync:function(callback){},error:function(err){Kekule.error(err),this._errCallback&&this._errCallback(err)},done:function(){this._doneCallback&&this._doneCallback.apply(this,arguments),this.workerJobDone()},halt:function(){var w=this.getWorker();w&&(w.terminate(),this.error(Kekule.$L("ErrorMsg.CALC_TERMINATED_BY_USER")))},isWorkerSupported:function(){return Kekule.BrowserFeature.workers},createWorker:function(){if(this.isWorkerSupported()){var url=this.getWorkerScriptFile();if(url){var w=new Worker(url);return w.addEventListener("message",this.reactWorkerMessageBind),w.addEventListener("error",this.reactWorkerErrorBind),this.setPropStoreFieldValue("worker",w),w}}},getWorkerScriptFile:function(){return null},importWorkerScriptFile:function(url){this.postWorkerMessage({type:"importScript",url:url})},postWorkerMessage:function(msg){var w=this.getWorker();w&&w.postMessage(msg)},reactWorkerMessage:function(e){return this._msgCallback&&this._msgCallback(e.data),this.doReactWorkerMessage(e.data,e)},doReactWorkerMessage:function(data,e){},reactWorkerError:function(e){Kekule.error(e.message),this.error(e.message)},workerStartCalc:function(worker){},workerJobDone:function(){var w=this.getWorker();w&&(w.terminate(),this.setPropStoreFieldValue("worker",null))}}),Kekule.Calculator.AbstractStructure3DGenerator=Class.create(Kekule.Calculator.Base,{CLASS_NAME:"Kekule.Calculator.AbstractStructure3DGenerator",initProperties:function(){this.defineProp("sourceMol",{dataType:"Kekule.StructureFragment",serializable:!1}),this.defineProp("generatedMol",{dataType:"Kekule.StructureFragment",serializable:!1}),this.defineProp("options",{dataType:DataType.HASH,getter:function(){var result=this.getPropStoreFieldValue("options");return result||(result={},this.setPropStoreFieldValue("options",result)),result}})}}),Kekule.Calculator.ServiceManager={_services:{},_getServiceClasses:function(serviceName,canCreate){var result=CS._services[serviceName];return!result&&canCreate&&(result=[],CS._services[serviceName]=result),result},register:function(serviceName,serviceClass){var classes=CS._getServiceClasses(serviceName,!0),index=classes.indexOf(serviceClass);index>=0&&classes.splice(index,1),classes.push(serviceClass)},unregister:function(serviceName,serviceClass){var classes=CS._getServiceClasses(serviceName,!0),index=classes.indexOf(serviceClass);index>=0&&classes.splice(index,1)},getServiceClass:function(serviceName){var result=null,classes=CS._getServiceClasses(serviceName);return classes&&classes.length&&(result=classes[classes.length-1]),result}};var CS=Kekule.Calculator.ServiceManager;return Kekule.Calculator.Services={GEN3D:"3D structure generator"},Kekule.Calculator.generate3D=function(sourceMol,options,callback,errCallback,msgCallback){var serviceName=Kekule.Calculator.Services.GEN3D,c=CS.getServiceClass(serviceName);if(c){var o=new c;try{var done=function(){callback&&callback(o.getGeneratedMol())},error=function(err){errCallback&&errCallback(err)},onMsg=function(msgData){msgCallback&&msgCallback(msgData)};try{o.setSourceMol(sourceMol),o.setOptions(options),o.execute(done,error,onMsg)}catch(e){error(e)}}catch(e){}return o}var errMsg=Kekule.$L("ErrorMsg.CALC_SERVICE_UNAVAILABLE").format(serviceName);return callback&&callback(errMsg),null},Kekule}},function(module,exports,__webpack_require__){"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};module.exports=function(Kekule){Kekule.EmscriptenUtils={DEF_MODULE_NAME:"Module",_createdModules:{},_getActualModule:function(moduleName){return Kekule[moduleName||EU.DEF_MODULE_NAME]},isSupported:function(moduleName){return void 0!==EU._getActualModule(moduleName)},getRootModule:function(moduleName,creationOptions){var name=EU._getActualModule(moduleName),result=EU._createdModules[name];if(result)return result;var m=EU._getActualModule(moduleName);return result=m,"function"==typeof m&&(result=m(creationOptions),EU._createdModules[name]=result),result},getModuleObj:function(moduleNameOrObj){return"object"===(void 0===moduleNameOrObj?"undefined":_typeof(moduleNameOrObj))?moduleNameOrObj:EU.getRootModule(moduleNameOrObj)},getClassCtor:function(className,moduleNameOrObj){return(EU.getModuleObj(moduleNameOrObj)||{})[className]},cwrap:function(funcName,retType,inTypes,moduleNameOrObj){var m=EU.getModuleObj(moduleNameOrObj);return m&&m.cwrap&&m.cwrap(funcName,retType,inTypes)},loadScript:function(url,callback,doc){doc||(doc=document),Kekule.ScriptFileUtils.appendScriptFile(doc,url,callback)}};var EU=Kekule.EmscriptenUtils;return Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class;module.exports=function(Kekule){var EU=Kekule.EmscriptenUtils,inchiInitOptions={usingModulaize:!0,moduleName:"InChIModule"};Kekule.InChI={_autoEnabled:!0,_scriptLoadedBySelf:!1,_module:null,_enableFuncs:[],SCRIPT_FILE:"inchi.js",isScriptLoaded:function(){return EU.isSupported(inchiInitOptions.moduleName)},getModule:function(){return InChI._module||(InChI._module=EU.getRootModule(inchiInitOptions.moduleName)),InChI._module},getInChIPath:function(){var isMin=Kekule.scriptSrcInfo.useMinFile,path=isMin?"extra/":"_extras/InChI/";return path=Kekule.scriptSrcInfo.path+path},getInChIScriptUrl:function(){var result=InChI.getInChIPath()+InChI.SCRIPT_FILE;return Kekule.scriptSrcInfo.useMinFile||(result+=".dev"),result},loadInChIScript:function(doc,callback){if(doc||(doc=document),InChI.isScriptLoaded()||InChI._scriptLoadedBySelf)InChI._scriptLoadedBySelf=!0,callback&&callback();else{var filePath=InChI.getInChIScriptUrl();EU.loadScript(filePath,callback,doc),InChI._scriptLoadedBySelf=!0}},molDataToInChI:function(molData,options){var convFunc=InChI._molToInChI;convFunc||(convFunc=InChI.getModule().cwrap("molToInchiJson","string",["string","string"]));var sInChIResult=convFunc(molData,options);return JSON.parse(sInChIResult)},getInChIInfo:function(molecule){var molData=Kekule.IO.saveFormatData(molecule,Kekule.IO.DataFormat.MOL);return InChI.molDataToInChI(molData)},enable:function(callback){InChI.isScriptLoaded()?(InChI._enableAllFunctions(),callback&&callback()):InChI.loadInChIScript(document,function(){InChI._enableAllFunctions(),callback&&callback()})},_enableAllFunctions:function(){if(InChI.isScriptLoaded())for(var funcs=InChI._enableFuncs,i=0,l=funcs.length;i<l;++i){var func=funcs[i];func&&func()}}};var InChI=Kekule.InChI;return Kekule.IO.InChIWriter=Class.create(Kekule.IO.ChemDataWriter,{CLASS_NAME:"Kekule.IO.InChIWriter",doWriteData:function(obj){var info=InChI.getInChIInfo(obj);if(info&&info.inchi){var result=info.inchi;return info.auxInfo&&(result+="\n"+info.auxInfo),result}return null},isAllowedObj:function(obj){var classes=Kekule.IO.InChIWriter.ALLOWED_CLASSES;return Kekule.ObjUtils.isInstanceOf(obj,classes)}}),Kekule.IO.InChIWriter.ALLOWED_CLASSES=[Kekule.StructureFragment,Kekule.Reaction,Kekule.ChemObjList,Kekule.ChemStructureObjectGroup,Kekule.ChemSpaceElement,Kekule.ChemSpace],Kekule.IO.registerAllInChIFormats=function(){if(InChI.isScriptLoaded()){Kekule.IO.DataFormat.INCHI="inchi",Kekule.IO.MimeType.INCHI="chemical/x-inchi",Kekule.IO.DataFormatsManager.register("inchi",Kekule.IO.MimeType.INCHI,"inchi",Kekule.IO.ChemDataType.TEXT,"InChI format"),Kekule.IO.ChemDataWriterManager.register("inchi",Kekule.IO.InChIWriter,Kekule.IO.InChIWriter.ALLOWED_CLASSES,"inchi")}},Kekule.IO.enableInChIFormats=function(){InChI.enable()},InChI._enableFuncs.push(Kekule.IO.registerAllInChIFormats),Kekule._registerAfterLoadProc(function(){InChI._autoEnabled&&InChI._enableAllFunctions()}),Kekule}},function(module,exports,__webpack_require__){"use strict";module.exports=function(Kekule){return Kekule.LOCAL_RES=!0,Kekule.Localization.setCurrModule("extra.openbabel"),Kekule.Localization.addResource("en","ErrorMsg",{OpenBabel:{CHEM_NODE_TYPE_NOT_SUITABLE:"Unsuitable node type",CHEM_CONNECTOR_TYPE_NOT_SUITABLE:"Unsuitable connector type",ONLY_STR_INPUT_DATA_ALLOWED:"Input data must be text",ONLY_STR_OUTPUT_DATA_ALLOWED:"Output data must be text",FAIL_TO_GENERATE_3D_STRUCTURE:"Fail to generate 3D structure coordinates"}}),Kekule}},function(module,exports,__webpack_require__){"use strict";module.exports=function(Kekule){var EU=Kekule.EmscriptenUtils,obInitOptions={usingModulaize:!0,moduleName:"OpenBabelModule"};Kekule.OpenBabel={_autoEnabled:!0,_module:null,SCRIPT_FILE:"openbabel.js",_enableFuncs:[],BondOrder:{SINGLE:1,DOUBLE:2,TRIPLE:3,EXPLICIT_AROMATIC:5},getObInitOptions:function(){return obInitOptions},getModule:function(){return OB._module||(OB._module=EU.getRootModule(obInitOptions.moduleName)),OB._module},getClassCtor:function(className){return EU.getClassCtor(className,OB.getModule())},isScriptLoaded:function(){return EU.isSupported(obInitOptions.moduleName)},enable:function(callback){OB.isScriptLoaded()?(OB._enableAllFunctions(),callback&&callback()):OB.loadObScript(document,function(){OB._enableAllFunctions(),callback&&callback()})},_enableAllFunctions:function(){if(OB.isScriptLoaded())for(var funcs=OB._enableFuncs,i=0,l=funcs.length;i<l;++i){var func=funcs[i];func&&func()}}},Kekule._registerAfterLoadProc(function(){OB._autoEnabled&&OB._enableAllFunctions()}),Kekule.OpenBabel.getObPath=function(){var isMin=Kekule.scriptSrcInfo.useMinFile,path=isMin?"extra/":"_extras/OpenBabel/";return path=Kekule.scriptSrcInfo.path+path},Kekule.OpenBabel.getObScriptUrl=function(){var result=Kekule.OpenBabel.getObPath()+Kekule.OpenBabel.SCRIPT_FILE;return Kekule.scriptSrcInfo.useMinFile||(result+=".dev"),result},Kekule.OpenBabel.loadObScript=function(doc,callback){if(doc||(doc=document),OB._obScriptLoadedBySelf||OB.isScriptLoaded())OB._obScriptLoadedBySelf=!0,callback&&callback();else{var filePath=Kekule.OpenBabel.getObScriptUrl();EU.loadScript(filePath,callback,doc),OB._obScriptLoadedBySelf=!0}};var OB=Kekule.OpenBabel;return Kekule.OpenBabel.AdaptUtils={DEF_ATOM_ID_PREFIX:"A",DEF_BOND_ID_PREFIX:"B",DEF_MOL_ID_PREFIX:"M",wrapCFuncs:function(){if(!Kekule.OpenBabel._funcInited){var funcs={};Object.extend(Kekule.OpenBabel,funcs),Kekule.OpenBabel._funcInited=!0}},isAvailable:function(){return void 0!==OB.getClassCtor("ObBaseHelper")},obObjToKekule:function(obObj){var AU=Kekule.OpenBabel.AdaptUtils,obName=Kekule.ObjUtils.getPrototypeOf(obObj).constructor.name;return("OBReaction"===obName?AU.obReactionToKekule:"OBMol"===obName?AU.obMolToKekule:"OBAtom"===obName?AU.obAtomToKekule:"OBBond"===obName?AU.obBondToKekule:AU.obBaseToKekule)(obObj)},kObjToOB:function(kChemObj){var AU=Kekule.OpenBabel.AdaptUtils,convFunc=kChemObj instanceof Kekule.Reaction?AU.kReactionToOB:kChemObj instanceof Kekule.StructureFragment?AU.kMolToOB:kChemObj instanceof Kekule.ChemStructureNode?AU.kChemNodeToOB:kChemObj instanceof Kekule.ChemStructureConnector?AU.kBondToOB:null;return convFunc?convFunc(kChemObj):null},kIdToOB:function(id){var v=parseInt(id,10);return v||null},obBondOrderToKekule:function(obBondOrder){return obBondOrder<=3?obBondOrder:obBondOrder===Kekule.OpenBabel.BondOrder.EXPLICIT_AROMATIC?Kekule.BondOrder.EXPLICIT_AROMATIC:Kekule.BondOrder.OTHER},kBondOrderToOB:function(kBondOrder){return kBondOrder<=3?kBondOrder:kBondOrder===Kekule.BondOrder.EXPLICIT_AROMATIC?Kekule.OpenBabel.BondOrder.EXPLICIT_AROMATIC:0},obBaseToKekule:function(obBase,kChemObj){var result=kChemObj||new Kekule.ChemObject,helper=new(OB.getClassCtor("ObBaseHelper"))(obBase),title=helper.getTitle();title&&result.setName&&result.setName(title);var dataSize=helper.getDataSize();if(dataSize)for(var info=result.getInfo(!0),i=0;i<dataSize;++i){var data=helper.getDataAt(i);if(data){var key=data.GetAttribute(),value=data.GetValue();key&&value&&(info[key]=value)}}return result},kChemObjToOB:function(kChemObj,obBase){var result=obBase||new(OB.getClassCtor("OBBase"));kChemObj.getName&&result.SetTitle&&result.SetTitle(kChemObj.getName());var info=kChemObj.getInfo();if(info)for(var keys=Kekule.ObjUtils.getOwnedFieldNames(info),i=0,l=keys.length;i<l;++i){var key=keys[i],value=info[key];if(key&&value){var data=new(OB.getClassCtor("OBPairData"));data.SetAttribute(""+key),data.SetValue(""+value),result.SetData(data)}}},obAtomToKekule:function(obAtom,kNode,coordMode){var atomicNum=obAtom.GetAtomicNum(),preferredClass=atomicNum?Kekule.Atom:Kekule.SubGroup;!kNode||kNode instanceof preferredClass||Kekule.Error(Kekule.$L("ErrorMsg.OpenBabel.CHEM_NODE_TYPE_NOT_SUITABLE"));var result=kNode||new preferredClass;Kekule.OpenBabel.AdaptUtils.obBaseToKekule(obAtom,result);var v;return v=obAtom.GetId(),Kekule.ObjUtils.notUnset(v)&&result.setId(Kekule.OpenBabel.AdaptUtils.DEF_ATOM_ID_PREFIX+v),v=obAtom.GetFormalCharge(),v&&result.setCharge(v),v=obAtom.GetSpinMultiplicity(),v&&result.setRadical(v),v={x:obAtom.GetX(),y:obAtom.GetY()},coordMode===Kekule.CoordMode.COORD3D&&(v.z=obAtom.GetZ()),result.setAbsCoordOfMode?result.setAbsCoordOfMode(v,coordMode):result.setCoordOfMode(v,coordMode),result instanceof Kekule.Atom&&(atomicNum&&result.setAtomicNumber(atomicNum),v=obAtom.GetIsotope(),v&&result.setMassNumber(v),(v=obAtom.GetHyb())&&result.setHybridizationType(v)),result},kChemNodeToOB:function(kNode,obAtom,coordMode){var v,result=obAtom||new(OB.getClassCtor("OBAtom"));if(v=kNode.getId(),v=Kekule.OpenBabel.AdaptUtils.kIdToOB(v),Kekule.ObjUtils.notUnset(v)&&result.SetId(v),v=kNode.getCharge())if(parseInt(v,10)===parseFloat(v))result.SetFormalCharge(v);else{var i=parseInt(v,10),f=v-i;result.SetFormalCharge(i),result.SetPartialCharge(f)}return v=kNode.getRadical(),v&&result.SetSpinMultiplicity(v),v=kNode.getAbsCoordOfMode?kNode.getAbsCoordOfMode(coordMode):kNode.getCoordOfMode(coordMode),result.SetVector(v.x||0,v.y||0,v.z||0),kNode instanceof Kekule.Atom?(result.SetAtomicNum(kNode.getAtomicNumber()),v=kNode.getMassNumber(),v&&result.SetIsotope(v),(v=kNode.getHybridizationType())&&result.SetHyb(v)):result.SetAtomicNum(0),result},obBondToKekule:function(obBond,kBond,atomMapping){var result=kBond||new Kekule.Bond;Kekule.OpenBabel.AdaptUtils.obBaseToKekule(obBond,result);var v;v=obBond.GetId(),Kekule.ObjUtils.notUnset(v)&&result.setId(Kekule.OpenBabel.AdaptUtils.DEF_BOND_ID_PREFIX+v),v=obBond.GetBondOrder(),result.setBondOrder(Kekule.OpenBabel.AdaptUtils.obBondOrderToKekule(v));var BS=Kekule.BondStereo;if(v=obBond.IsWedge()?BS.UP:obBond.IsHash()?BS.DOWN:obBond.IsWedgeOrHash()?BS.UP_OR_DOWN:obBond.IsCisOrTrans()?BS.CIS_OR_TRANS:obBond.IsDoubleBondGeometry()?BS.E_Z_BY_COORDINATES:BS.NONE,result.setStereo(v),atomMapping){v=null;for(var atoms=[obBond.GetBeginAtom(),obBond.GetEndAtom()],i=0,l=atoms.length;i<l;++i){var atom=atoms[i];atom&&(v=atomMapping.get(atom.GetIdx()))&&result.appendConnectedObj(v)}}return result},kBondToOB:function(kBond,obBond,atomMapping,obMol){var result=obBond||new(OB.getClassCtor("OBBond"));Kekule.OpenBabel.AdaptUtils.kChemObjToOB(kBond,result);var v;v=Kekule.OpenBabel.AdaptUtils.kIdToOB(kBond.getId()),Kekule.ObjUtils.notUnset(v)&&result.SetId(v),v=kBond.getBondOrder(),v&&(result.SetBondOrder(Kekule.OpenBabel.AdaptUtils.kBondOrderToOB(v)),v===Kekule.BondOrder.EXPLICIT_AROMATIC&&result.SetAromatic()),result.UnsetHash(),result.UnsetWedge(),result.UnsetUp(),result.UnsetDown(),result.UnsetAromatic();var BS=Kekule.BondStereo;if(v=kBond.getStereo(),v===BS.UP?result.SetWedge():v===BS.DOWN?result.SetHash():v===BS.UP_OR_DOWN&&result.SetWedgeOrHash(),atomMapping)for(var curr=0,i=0,l=kBond.getConnectedObjCount();i<l;++i){var obj=kBond.getConnectedObjAt(i);if(obj&&obj instanceof Kekule.ChemStructureNode){var v=atomMapping.get(obj);if(v&&(0===curr?result.SetBegin(v):1===curr&&result.SetEnd(v),++curr),curr>1)break}}return result},obMolToKekule:function(obMol,kMol){var result=kMol||new Kekule.Molecule;Kekule.OpenBabel.AdaptUtils.obBaseToKekule(obMol,result);var coordMode=obMol.Has3D()?Kekule.CoordMode.COORD3D:Kekule.CoordMode.COORD2D;result.clearNodes(),result.clearConnectors();for(var atomMapping=new Kekule.MapEx(!0),count=obMol.NumAtoms(),i=0;i<count;++i){var obAtom=obMol.GetAtom(i+1);if(obAtom){var kNode=Kekule.OpenBabel.AdaptUtils.obAtomToKekule(obAtom,null,coordMode);kNode&&(result.appendNode(kNode),atomMapping.set(obAtom.GetIdx(),kNode))}}for(var count=obMol.NumBonds(),i=0;i<count;++i){var obBond=obMol.GetBond(i);if(obBond){var kBond=Kekule.OpenBabel.AdaptUtils.obBondToKekule(obBond,null,atomMapping);kBond&&result.appendConnector(kBond)}}return atomMapping.finalize(),atomMapping=null,result},kMolToOB:function(kMol,obMol){var coordMode=kMol.nodesHasCoord3D()?Kekule.CoordMode.COORD3D:Kekule.CoordMode.COORD2D,result=obMol||new(OB.getClassCtor("OBMol"));obMol&&result.Clear();for(var atomMapping=new Kekule.MapEx(!1),i=0,l=kMol.getNodeCount();i<l;++i){var kNode=kMol.getNodeAt(i);if(kNode){var obAtom=Kekule.OpenBabel.AdaptUtils.kChemNodeToOB(kNode,result.NewAtom(),coordMode);obAtom&&atomMapping.set(kNode,obAtom)}}for(var i=0,l=kMol.getConnectorCount();i<l;++i){var kBond=kMol.getConnectorAt(i);if(kBond&&kBond instanceof Kekule.Bond){Kekule.OpenBabel.AdaptUtils.kBondToOB(kBond,result.NewBond(),atomMapping,result)}}return atomMapping.finalize(),atomMapping=null,result},obReactionToKekule:function(obReaction,kReaction){var result=kReaction||new Kekule.Reaction;result.clearAll(),Kekule.OpenBabel.AdaptUtils.obBaseToKekule(obReaction,result),result.setDirection(obReaction.IsReversible()?Kekule.ReactionDirection.BIDIRECTION:Kekule.ReactionDirection.FORWARD);for(var i=0,l=obReaction.NumReactants();i<l;++i){var obMol=obReaction.GetReactant(i),kMol=Kekule.OpenBabel.AdaptUtils.obMolToKekule(obMol);result.appendReactant(kMol)}for(var i=0,l=obReaction.NumProducts();i<l;++i){var obMol=obReaction.GetProduct(i),kMol=Kekule.OpenBabel.AdaptUtils.obMolToKekule(obMol);result.appendProduct(kMol)}return result},kReactionToOB:function(kReaction,obReaction){var result=obReaction||new(OB.getClassCtor("OBReaction"));result.Clear(),Kekule.OpenBabel.AdaptUtils.kChemObjToOB(kReaction,result);var isReversed=!1,direction=kReaction.getDirection();direction===Kekule.ReactionDirection.BIDIRECTION?result.SetReversible(!0):direction===Kekule.ReactionDirection.BACKWARD&&(isReversed=!0);for(var i=0,l=kReaction.getReactantCount();i<l;++i){var kMol=kReaction.getReactantAt(i);if(kMol){var obMol=Kekule.OpenBabel.AdaptUtils.kMolToOB(kMol);isReversed?result.AddProduct(obMol):result.AddReactant(obMol)}}for(var i=0,l=kReaction.getProductCount();i<l;++i){var kMol=kReaction.getProductAt(i);if(kMol){var obMol=Kekule.OpenBabel.AdaptUtils.kMolToOB(kMol);isReversed?result.AddReactant(obMol):result.AddProduct(obMol)}}}},Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class;module.exports=function(Kekule){var OB=(Kekule.EmscriptenUtils,Kekule.OpenBabel),AU=Kekule.OpenBabel.AdaptUtils;return Kekule.IO.OpenBabelReader=Class.create(Kekule.IO.ChemDataReader,{CLASS_NAME:"Kekule.IO.OpenBabelReader",initialize:function($super,options){$super()},finalize:function($super){$super()},getFormatTargetObClassName:function(obFormatWrapper){return obFormatWrapper.getTypeName().toLowerCase().indexOf("reaction")>=0?"OBReaction":"OBMol"},doReadData:function(data,dataType,format){this._obConv=new(OB.getClassCtor("ObConversionWrapper"));try{var fInfo=Kekule.IO.DataFormatsManager.getFormatInfo(format),mimeType=fInfo.mimeType,fileExt=fInfo.fileExts[0],fmt=this._obConv.setInFormat(mimeType,fileExt),obClassName=this.getFormatTargetObClassName(fmt);try{var kObjs=[];this._obConv.setInStr(data);for(var kObj,obObj=new(OB.getClassCtor(obClassName)),hasObj=this._obConv.readFromInput(obObj);hasObj;){if(obObj.NumAtoms&&obObj.NumAtoms()>0){var kObj=AU.obObjToKekule(obObj);kObjs.push(kObj)}hasObj=this._obConv.readFromInput(obObj)}var length=kObjs.length;if(length<=0)return null;if(1===length)return kObjs[0];for(var result=new Kekule.ChemObjList,i=0;i<length;++i)result.append(kObjs[i]);return result}finally{obObj&&(obObj.delete(),obObj=null)}}finally{this._obConv&&(this._obConv.delete(),this._obConv=null)}}}),Kekule.IO.OpenBabelWriter=Class.create(Kekule.IO.ChemDataWriter,{CLASS_NAME:"Kekule.IO.OpenBabelWriter",initialize:function($super,options){$super(options)},finalize:function($super){$super()},doWriteData:function(obj,dataType,format){this._obConv=new(OB.getClassCtor("ObConversionWrapper"));try{var fInfo=Kekule.IO.DataFormatsManager.getFormatInfo(format),mimeType=fInfo.mimeType,fileExt=fInfo.fileExts[0];this._obConv.setOutFormat(mimeType,fileExt);for(var kObjs=Kekule.ChemStructureUtils.getChildStructureObjs(obj,!0),i=0,l=kObjs.length;i<l;++i){var kObj=kObjs[i];if(kObj){var obObj=AU.kObjToOB(kObj);if(obObj)try{if(!this._obConv.writeToOutput(obObj))break}finally{obObj.delete(),obObj=null}}}return this._obConv.getOutStr()}finally{this._obConv&&this._obConv.delete()}},isAllowedObj:function(kObj){var classes=Kekule.IO.OpenBabelWriter.ALLOWED_CLASSES;return Kekule.ObjUtils.isInstanceOf(kObj,classes)}}),Kekule.IO.OpenBabelWriter.ALLOWED_CLASSES=[Kekule.StructureFragment,Kekule.Reaction,Kekule.ChemObjList,Kekule.ChemStructureObjectGroup,Kekule.ChemSpaceElement,Kekule.ChemSpace],Kekule.OpenBabel.IORegHelper=Class.create({listFormatInfo:function(ioType,converter){var formatListStr,result=[];formatListStr="in"===ioType?converter.getSupportedInputFormatsStr("\n"):converter.getSupportedOutputFormatsStr("\n");for(var basicStrArray=formatListStr.split("\n"),i=0,l=basicStrArray.length;i<l;++i){var s=basicStrArray[i],pos=s.indexOf("--");if(pos>0){var id=s.substring(0,pos).trim(),info=converter.getFormatInfoById(id);result.push(info)}}return result},registerByInfos:function(infos,ioType){for(var formatManager=Kekule.IO.DataFormatsManager,handleIds=[],i=0,l=infos.length;i<l;++i){var info=infos[i],id=info.id,mimeType=info.mimeType,fmtId=formatManager.findFormatId(mimeType);if(fmtId&&(fmtId=formatManager.findFormatId(null,id)),!fmtId)var fmtInfo=formatManager.register(id,mimeType,id,Kekule.IO.ChemDataType.UNKNOWN,info.description,info.description,{specificationUrl:info.specificationURL}),fmtId=fmtInfo.id;("in"===ioType?Kekule.IO.ChemDataReaderManager.getReaderInfoByFormat(fmtId):Kekule.IO.ChemDataWriterManager.getWriterInfoByFormat(fmtId))||Kekule.ArrayUtils.pushUnique(handleIds,fmtId)}handleIds.length&&("in"===ioType?Kekule.IO.ChemDataReaderManager.register("openbabel",Kekule.IO.OpenBabelReader,handleIds):Kekule.IO.ChemDataWriterManager.register("openbabel",Kekule.IO.OpenBabelWriter,Kekule.IO.OpenBabelWriter.ALLOWED_CLASSES,handleIds))},registerAll:function(){var converter=new(OB.getClassCtor("ObConversionWrapper"));try{var infos=this.listFormatInfo("in",converter);this.registerByInfos(infos,"in");var infos=this.listFormatInfo("out",converter);this.registerByInfos(infos,"out")}finally{converter.delete()}}}),Kekule.IO.registerAllOpenBabelFormats=function(){if(Kekule.OpenBabel.AdaptUtils.isAvailable())try{var helper=new Kekule.OpenBabel.IORegHelper;helper.registerAll()}finally{helper=null}},Kekule.OpenBabel._enableFuncs.push(Kekule.IO.registerAllOpenBabelFormats),Kekule.IO.enableOpenBabelFormats=function(){Kekule.OpenBabel.AdaptUtils.isAvailable()?Kekule.IO.registerAllOpenBabelFormats():Kekule.OpenBabel.loadObScript(document,function(){Kekule.IO.registerAllOpenBabelFormats()})},Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class;module.exports=function(Kekule){var OB=(Kekule.EmscriptenUtils,Kekule.OpenBabel),AU=Kekule.OpenBabel.AdaptUtils;return Kekule.OpenBabel.StructUtils={generate3DStructure:function(mol,forceFieldName){var _obGen=new(OB.getClassCtor("OB3DGenWrapper"));try{var data=Kekule.IO.saveMimeData(mol,"chemical/x-mdl-molfile");try{var obMol=_obGen.generate3DStructureFromMolData(data,forceFieldName||"");if(obMol)var mol3D=AU.obObjToKekule(obMol);else Kekule.raise(Kekule.$L("ErrorMsg.OpenBabel.FAIL_TO_GENERATE_3D_STRUCTURE"));obMol.delete()}finally{}}finally{_obGen.delete()}return mol3D}},Kekule.Calculator&&(Kekule.Calculator.ObStructure3DGenerator=Class.create(Kekule.Calculator.AbstractStructure3DGenerator,{CLASS_NAME:"Kekule.Calculator.ObStructure3DGenerator",getObInitOptions:function(){return Kekule.OpenBabel.getObInitOptions()},getForceField:function(){return this.getOptions().forceField},createWorker:function($super){var w=$super();if(w){var url=Kekule.OpenBabel.getObScriptUrl();this.importWorkerScriptFile(url);var initOps=this.getObInitOptions();this.postWorkerMessage({type:"obInit",usingModulaize:initOps.usingModulaize,moduleName:initOps.moduleName})}return w},getWorkerScriptFile:function(){return Kekule.OpenBabel.getObPath()+"workers/kekule.worker.obStructure3DGenerator.js"},doReactWorkerMessage:function($super,data,e){if($super(data,e),"output3D"===data.type){var genData=data.molData;if(genData){var m=Kekule.IO.loadMimeData(genData,"chemical/x-mdl-molfile");this.setGeneratedMol(m),this.done()}}},workerStartCalc:function(worker){var mol=this.getSourceMol(),molData=Kekule.IO.saveMimeData(mol,"chemical/x-mdl-molfile");this.postWorkerMessage({type:"gen3D",molData:molData,forceField:this.getForceField()})},executeSync:function(callback){if(Kekule.OpenBabel&&document){var self=this;Kekule.OpenBabel.loadObScript(document,function(){var err;try{var mol=Kekule.OpenBabel.StructUtils.generate3DStructure(self.getSourceMol(),self.getForceField());self.setGeneratedMol(mol)}catch(e){err=e}callback&&callback(err)})}else Kekule.error(Kekule.$L("ErrorMsg.MODULE_NOT_LOADED").format("OpenBabel"));return!1}}),Kekule.Calculator.ServiceManager.register(Kekule.Calculator.Services.GEN3D,Kekule.Calculator.ObStructure3DGenerator)),Kekule}},function(module,exports,__webpack_require__){"use strict";module.exports=function(Kekule){var EU=Kekule.EmscriptenUtils,indigoInitOptions={usingModulaize:!0,moduleName:"IndigoModule",indigoAdaptFuncName:"CreateIndigo"};Kekule.Indigo={_autoEnabled:!0,_module:null,_indigo:null,SCRIPT_FILE:"indigo.js",HELPER_SCRIPT_FILE:"indigoAdapter.js",_enableFuncs:[],isScriptLoaded:function(){return EU.isSupported(indigoInitOptions.moduleName)&&void 0!==Kekule.$jsRoot[indigoInitOptions.indigoAdaptFuncName]},getModule:function(){return KI._module||(KI._module=EU.getRootModule(indigoInitOptions.moduleName)),KI._module},getIndigo:function(){if(!KI._indigo){var module=KI.getModule();module&&(KI._indigo=Kekule.$jsRoot[indigoInitOptions.indigoAdaptFuncName](module))}return KI._indigo},getClassCtor:function(className){return EU.getClassCtor(className,KI.getModule())},isAvailable:function(){return KI.getModule()&&KI.getIndigo()},enable:function(callback){KI.isScriptLoaded()?(KI._enableAllFunctions(),callback&&callback()):KI.loadIndigoScript(document,function(){KI._enableAllFunctions(),callback&&callback()})},_enableAllFunctions:function(){if(KI.isScriptLoaded())for(var funcs=KI._enableFuncs,i=0,l=funcs.length;i<l;++i){var func=funcs[i];func&&func()}}},Kekule.Indigo.loadIndigoScript=function(doc,callback){KI._scriptLoadedBySelf||KI.isScriptLoaded()?(KI._scriptLoadedBySelf=!0,callback&&callback()):(Kekule.Indigo.getIndigo(),callback&&callback(),KI._scriptLoadedBySelf=!0)};var KI=Kekule.Indigo;return Kekule.Indigo.AdaptUtils={},Kekule._registerAfterLoadProc(function(){KI._autoEnabled&&KI._enableAllFunctions()}),Kekule}},function(module,exports,__webpack_require__){"use strict";var Class=__webpack_require__(0).Class;module.exports=function(Kekule){var KI=Kekule.Indigo;return Kekule.IO.IndigoReader=Class.create(Kekule.IO.ChemDataReader,{CLASS_NAME:"Kekule.IO.InChIWriter",doReadData:function(data,dataType,format){var Indigo=KI.getIndigo(),iMol=Indigo.loadMoleculeFromString(data);if(iMol>=0){format===Kekule.IO.DataFormat.SMILES&&(Indigo.setOption("smart-layout","true"),Indigo.layout(iMol));var molData=Indigo.molfile(iMol);Indigo.free(iMol);return Kekule.IO.loadFormatData(molData,Kekule.IO.DataFormat.MOL)}return null}}),Kekule.IO.registerAllIndigoFormats=function(){KI.isAvailable()&&Kekule.IO.ChemDataReaderManager.register("Indigo-smiles",Kekule.IO.IndigoReader,Kekule.IO.DataFormat.SMILES)},Kekule.IO.enableIndigoFormats=function(){KI.isAvailable()?Kekule.IO.registerAllIndigoFormats():KI.loadIndigoScript(document,function(){Kekule.IO.registerAllIndigoFormats()})},KI._enableFuncs.push(Kekule.IO.registerAllIndigoFormats),Kekule}}]);